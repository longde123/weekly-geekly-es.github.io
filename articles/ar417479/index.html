<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ ๐๐ป ๐ผ ุณูุณูุฉ ูุชุณูุณูุฉ ุฃุณุฑุน ุงูุนููุง ุจููุณู ูู Go ๐ฌ ๐ง๐ป ๐ฉ๐ฟโ๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูููู ุณูุนูู ุนูู ุชุณุฑูุน ุฑุจุท ุงูุฎุทูุท ุงููุตูุฑุฉ ูู Go ุจูุณุจุฉ 30ูช. ูููุฐุง ูู ูุญุชุงุฌ ุฅูู ุชุนุฏูู Go ููุณูุง ุ ุณูุชู ุชูููุฐ ูู ูุฐุง ูููุชุจุฉ ุฎุงุฑุฌูุฉ . 


 ุชุญุช ุงูุฎูุถ ุฃูุชุธุฑ: 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุณูุณูุฉ ูุชุณูุณูุฉ ุฃุณุฑุน ุงูุนููุง ุจููุณู ูู Go</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417479/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/36/bi/u0/36biu0kvugh_maxmmyhmuvqlrs8.png"></p><br><p style=";text-align:right;direction:rtl">  ุงูููู ุณูุนูู ุนูู ุชุณุฑูุน ุฑุจุท ุงูุฎุทูุท ุงููุตูุฑุฉ ูู Go ุจูุณุจุฉ 30ูช.  ูููุฐุง ูู ูุญุชุงุฌ ุฅูู ุชุนุฏูู Go ููุณูุง ุ ุณูุชู ุชูููุฐ ูู ูุฐุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุชุจุฉ ุฎุงุฑุฌูุฉ</a> . </p><br><p style=";text-align:right;direction:rtl">  ุชุญุช ุงูุฎูุถ ุฃูุชุธุฑ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> ููุงุฑูุฉ ุจูู <code>strings.Builder</code> <code>+</code> ุ <code>strings.Builder</code> ูุงูุชุณูุณู ุงูุฃุตูู </li><li style=";text-align:right;direction:rtl">  ุงุฐูุจ ุฅูู ุชูุงุตูู ุงูุตู ุงูุฏุงุฎูู </li><li style=";text-align:right;direction:rtl">  ูููู ูู ุงููุฌูุน </li></ul><br><p style=";text-align:right;direction:rtl">  ูููู ุงุนุชุจุงุฑ ูุฐู ุงูููุงูุฉ ุฃูุถูุง ุนุฐุฑูุง ูููุงูุดุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CL123256: ููุช ุงูุชุดุบูู ุ cmd / compile: ุชุฎุตุต concatstring2</a> .  ูุฑุญุจ ุจุฃููุงุฑ ุชุญุณูู ูุงุฆูุฉ ุงูุชุบููุฑ ูุฐู. </p><a name="habracut"></a><br><h1 id="srazu-rezultaty" style=";text-align:right;direction:rtl">  ูุชุงุฆุฌ ููุฑูุฉ </h1><br><p style=";text-align:right;direction:rtl">  ุชูุช ุงูููุงุฑูุฉ ูุน ุฅุตุฏุงุฑ <code>go tip</code> (ุงูุฑุฆูุณู) ูููุชุฑุฌู.  ููููู ุงูุญุตูู ุนูู ูุชุงุฆุฌ ููุงุซูุฉ ูู ุงูุฅุตุฏุงุฑุงุช ุญูู Go 1.5.  ูุงู ุขุฎุฑ ุชุบููุฑ ููู ูู ุฏุงูุฉ <code>concatstrings</code> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CL3120: cmd / gc: ุชุฎุตูุต ุงููุฎุงุฒู ุงููุคูุชุฉ ููุณูุงุณู ุบูุฑ ุงูููุฌุฒุฉ ุนูู ุงูููุฏุณ</a> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">BenchmarkConcat2Operator<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">83.8</span></span> ns/op BenchmarkConcat2Builder<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">70.9</span></span> ns/op BenchmarkConcat2<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">62.1</span></span> ns/op BenchmarkConcat3Operator<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">104</span></span> ns/op BenchmarkConcat3Builder<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">89.9</span></span> ns/op BenchmarkConcat3<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">82.1</span></span> ns/op</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุณุชุฎุฏู <code>ConcatOperator</code> <code>+</code> . <br>  ูุณุชุฎุฏู <code>ConcatBuilder</code> ุงููุณุจู ุงูุตุญูุญ. <br>  ุชุณุชุฎุฏู <code>Concat</code> ุงููุธููุฉ ุงูุชู <code>Concat</code> ูุฌุฒุก ูู ูุฐู ุงููุตุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุงุฑูุฉ ุนุจุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุตุฉ ุงูุฅุญุตุงุก</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta Concat2<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-number"><span class="hljs-number">84.2</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-number"><span class="hljs-number">62.7</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">2</span></span>% <span class="hljs-number"><span class="hljs-number">-25.49</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">9</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) Concat3<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">83</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">4</span></span>% <span class="hljs-number"><span class="hljs-number">-19.83</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">9</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชูููุฐ ุงููุฌููุน ุชุญุช <code>GOARCH=AMD64</code> ุฃุณุฑุน ููููุงู ููุฏูู ุชุญุณูู ุฅุถุงูู ุ ููู ููุฌูุฏ ูู ุนุงูู ุงูุชุดุบูู ุงููุฏูุฌ <code>+</code> ุ ูููู ุฃูุซุฑ ุนูู ุฐูู ุฃุฏูุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta Concat2<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-number"><span class="hljs-number">84.2</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-number"><span class="hljs-number">57.1</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">-32.20</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">9</span></span>+<span class="hljs-number"><span class="hljs-number">9</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุฃุฎุฐ ูุธููุฉ ุงููุฌูุน ูุฃุฏุงุก 100ูช (ุจุงููุณุจุฉ ุฅูู ุจุงูู ุงูุชุทุจููุงุช ุงููุฏุฑูุณุฉ). </p><br><blockquote style=";text-align:right;direction:rtl">  ูููู ุฑุคูุฉ ูุชุงุฆุฌ ุงูุฎุทูุท ุงูุฃุทูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">README.md</a> .  ูููุง ูุงูุช ุงูุณูุณูุฉ ุฃุทูู ุ ูููุง ูู ุงููุฑู ุจูู ุนูููุงุช ุงูุชูููุฐ. </blockquote><br><h1 id="naivnaya-konkatenaciya" style=";text-align:right;direction:rtl">  ุชุณูุณู ุณุงุฐุฌ </h1><br><p style=";text-align:right;direction:rtl">  ุงูุญู ุงูุฃุณูู ูู ุงุณุชุฎุฏุงู ุนุงูู ุงูุชุดุบูู <code>+</code> . </p><br><p style=";text-align:right;direction:rtl">  ุฏูุงูุงุช ูุฐุง ุงูุจูุงู ููุง ููู: ุฎุฐ ุณุทุฑูู ูุฅุฑุฌุงุน ุณูุณูุฉ ูุชูุฌุฉ ุชุญุชูู ุนูู ุณูุณูุฉ ูู ููุง ุงูุณุทุฑูู.  ููุณ ููุงู ูุง ูุถูู ุนูุฏุฉ ุฎุท ุฌุฏูุฏ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ููุงู ุณูุณูุฉ ูู ุณูุณูุฉ ูุงุฑุบุฉ ูุฃู ุณูุณูุฉ ุฃุฎุฑู ุ ููุฏ ูุนุฑุถ ููุช ุงูุชุดุบูู ูุณูุทุฉ ุบูุฑ ูุงุฑุบุฉ ุ ูุชุฌูุจ ุงูุญุงุฌุฉ ุฅูู ุชุฎุตูุต ุฐุงูุฑุฉ ุฌุฏูุฏุฉ ููุณุฎ ุงูุจูุงูุงุช ููุงู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุ ููุง ูุชุจูู ูู ุงููุชุงุฆุฌ ูู ุจุฏุงูุฉ ุงูููุงู ุ ูุฅู ูุฐู ูู ุฃุจุทุฃ ุทุฑููุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concat2operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุชูููู ุงูุฃุฏุงุก: <strong>67.8ูช</strong> . </blockquote><br><h1 id="stringsbuilder" style=";text-align:right;direction:rtl">  ุณูุงุณู ุจุงูู </h1><br><p style=";text-align:right;direction:rtl">  ููุฐ ููุช ููุณ ุจุจุนูุฏ ุ ุชูุช ุฅุถุงูุฉ ููุน ุฌุฏูุฏ ุฅูู Go - <a href="">strings.Builder</a> .  ูุฐุง ุชูุงุธุฑู <code>bytes.Buffer</code> ุ ูููู ุนูุฏ ุงุณุชุฏุนุงุก ุงูุฃุณููุจ <code>String()</code> ุ ูุง ูุชู ุฅุนุงุฏุฉ ุชุฎุตูุต ุงูุฐุงูุฑุฉ ููุง ูุชู ูุณุฎ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุนูุณ <code>bytes.Buffer</code> ุ ูุง <code>bytes.Buffer</code> ุงูุจุงูู <code>bytes.Buffer</code> <a href="">ูุคูุช ุตุบูุฑ</a> ุ ูุจุงูุชุงูู ุ ุชู ุชุฎุตูุต ุฐุงูุฑุฉ ูุณุจููุง ูุณูุณูุฉ.  ุฅุฐุง ููุช ูุง ุชุณุชุฎุฏู ุทุฑููุฉ <code>Grow</code> ุ ูุณูููู ุงูุฃุฏุงุก ุฃุณูุฃ ูู <code>bytes.Buffer</code> .  ุชุญุฏุซ ุงูุนุฏูุฏ ูู ุงูุงูุญุฏุงุฑุงุช ูู Go 1.11 ุจุณุจุจ ูุฐู ุงูููุฒุฉ ุงููุญุฏุฏุฉ (ุงูุธุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CL113235</a> ). </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุฏ ุงูุฎุงุต ุจูุง ุ ูู ุฃุฌู ููุงุก ุงูุชุฌุฑุจุฉ ุ ุณูุชุฌูุจ ูุฐุง ุงูุฎุทุฃ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concat2builder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> builder strings.Builder builder.Grow(<span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(x) + <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(y)) <span class="hljs-comment"><span class="hljs-comment">//      builder.WriteString(x) builder.WriteString(y) return builder.String() }</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุชูููู ุงูุฃุฏุงุก: <strong>80.5ูช</strong> (+ 12.7). </blockquote><br><h1 id="kodogeneraciya-dlya-konkatenacii" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฑูุฒ ุงูุชุณูุณู </h1><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุธุฑูุง ุฅูู ุงูุฑูุฒ ุงูุฐู ููุดุฆู ุงููุญูู ุงูุจุฑูุฌู ูุนุงูู ุงูุชุดุบูู <code>+</code> ุ <code>concatstring2</code> ููุงููุงุช ุฅูู ูุธุงุฆู <code>concatstring3</code> ู <code>concatstring3</code> ููุง ุฅูู ุฐูู (ุญุชู <code>concatstring5</code> ุถููุงู). </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concat2codegen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y } <span class="hljs-comment"><span class="hljs-comment">// =&gt; CALL runtime.concatstring2(SB) func concat3codegen(x, y, z) string { return x + y + z } // =&gt; CALL runtime.concatstring3(SB)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <a href="">ุฃูู</a> ูุธุฑุฉ ุนูู <a href="">runtime / string.go ููุณูุง</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concatstring2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buf *tmpBuf, a [2]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> concatstrings(buf, a[:]) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concatstring3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buf *tmpBuf, a [3]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> concatstrings(buf, a[:]) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ูุจูู ุชุนูู ูุธููุฉ <code>concatstrings</code> . <br>  ูุงุฆูุฉ ูุงููุฉ ูุชุงุญุฉ ุฃุฏูุงู ุชุญุช ุงูููุณุฏ ุ ูููู ููุง ูุตู ุนุงูู ุงููุณุชูู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฏ ุชููู ุงููุนููุฉ <code>buf</code> <code>nil</code> .  ูุชู ุชุฎุตูุต ูุฐุง ุงููุฎุฒู ุงููุคูุช ูู ูุจู ุงููุชุฑุฌู ุฅุฐุง ูู "ููุฑุจ" ุงูุณุทุฑ ูู ุชุนุฑููู.  ุฅุฐุง ูุงูุช ุงูุณูุณูุฉ ุชุนูุด ููุชุฑุฉ ุฃุทูู ูู ุงูุฅุทุงุฑ ุ ูุฅู ูุฐุง ุงููุฎุฒู ุงููุคูุช ุณูููู ุฏุงุฆููุง <code>nil</code> (ููุง ูุญุฏุซ ูู ุฃุบูุจ ุงูุฃุญูุงู).  ููุน ุฐูู ุ ุฅุฐุง ูุงู ูุฐุง ุงููุฎุฒู ุงููุคูุช ูุชุงุญูุง ุ ูุณูููู ูู ุงููููู ุชุฌูุจ ุงูุชุฎุตูุต ูู ุญุงูุฉ ุงุฎุชุฑุงู ุงููุชูุฌุฉ ููู (ุญุฌูู 32 ุจุงูุช). </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ูุงูุฉ ุงูุฃุณุทุฑ ุจุงุณุชุซูุงุก ุณุทุฑ ูุงุฑุบ ุ ุณุชูุฑุฌุน ุงูุฏุงูุฉ ูุฐุง ุงูุณุทุฑ.  ูููู ูู ุงูููุช ููุณู ุ ุชุชุฌุงูุฒ ุงูุฎุทูุท ุงููุญุฏุฏุฉ ุนูู ุงูููุฏุณ ูุชุชุฑู ุฅุทุงุฑูุง ูุฐุง ุงูุชุญุณูู ุจุญูุซ ูุง ูุชููู ุงููุชุตู ุฐุงูุฑุฉ ูุญุฑุฑุฉ ุจุงููุนู. </li><li style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุนูู ุฐูู ุ ูุชู ูุณุฎ ุฌููุน ุงูุฎุทูุท ุฅูู ุงูุฐุงูุฑุฉ ุงูุฌุฏูุฏุฉ. </li></ol><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงุฆูุฉ ูุงููุฉ ุจูุธููุฉ concatstrings</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// concatstrings implements a Go string concatenation x+y+z+... // The operands are passed in the slice a. // If buf != nil, the compiler has determined that the result does not // escape the calling function, so the string data can be stored in buf // if small enough. func concatstrings(buf *tmpBuf, a []string) string { idx := 0 l := 0 count := 0 for i, x := range a { n := len(x) if n == 0 { continue } if l+n &lt; l { throw("string concatenation too long") } l += n count++ idx = i } if count == 0 { return "" } // If there is just one string and either it is not on the stack // or our result does not escape the calling frame (buf != nil), // then we can return that string directly. if count == 1 &amp;&amp; (buf != nil || !stringDataOnStack(a[idx])) { return a[idx] } s, b := rawstringtmp(buf, l) for _, x := range a { copy(b, x) b = b[len(x):] } return s }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุฑู ููุง ุนุฏุฉ ุฃูุงูู ูู ุขู ูุงุญุฏ ูููู ุชุญุณูููุง ูุญุงูุฉ ูุนููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>buf</code> ูุนุธู ุงูุฃุญูุงู ูุงุฑุบุฉ.  ุนูุฏูุง ูุง ูุชููู ุงููุชุฑุฌู ูู ุฅุซุจุงุช ุฃู ุงูุณูุณูุฉ ุขููุฉ ููุถุนูุง ุนูู ุงูููุฏุณ ุ ูุฅู ุชูุฑูุฑ ูุนููุฉ ุฅุถุงููุฉ ูุงูุชุญูู ูู <code>nil</code> ูุฌูุฏ <code>nil</code> ุฏุงุฎู ุงููุธููุฉ ูุนุทู ููุท ุญูููุง ุนููููุง. </li><li style=";text-align:right;direction:rtl">  ููุญุงูุฉ ุงูุฎุงุตุฉ ูุน <code>len(a) == 2</code> ูุง ูุญุชุงุฌ ุฅูู ุฏูุฑุฉ ููููู ุชุจุณูุท ุงูุญุณุงุจุงุช.  ููุฐุง ูู ุงูุดูู ุงูุฃูุซุฑ ุดููุนูุง ููุชุณูุณู. </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุญุตุงุฆูุงุช ุงูุชุณูุณู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุนูุฏ ุชูููุฐ <code>./make.bash</code> ( <code>./make.bash</code> ูุชุฑุฌู Go ู stdlib) ูุฑู 445 ุณูุณูุฉ ูุน ุงุซููู ูู ุงููุนุงููุงุช: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  398 ูุชูุฌุฉ ุชูุฑุจ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุชุฎุตุตูุง ููุทูููุง. </li><li style=";text-align:right;direction:rtl">  47 ุงููุชุงุฆุฌ ูุง ุชุชุฑู ุงูุฅุทุงุฑ ุงูุฎุงุต ุจู. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุญุตู <strong>89 ูช ูู</strong> ุงูุณูุงุณู ุงููุชุณูุณูุฉ ูู ุญุฌุชูู ุนูู ุชุญุณูู ุงูุนุฑู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู ุฃุฏุงุฉ <code>go</code> ุ ูุฏููุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  501 ููุงููุงุช concatstring2 </li><li style=";text-align:right;direction:rtl">  194 ููุงููุงุช concatstring3 </li><li style=";text-align:right;direction:rtl">  ููุงููุงุช 55 concatstring4 </li></ul></div></div><br><h1 id="versiya-dlya-vseh-arhitektur" style=";text-align:right;direction:rtl">  ูุณุฎุฉ ูุฌููุน ุงููุนูุงุฑูุงุช </h1><br><p style=";text-align:right;direction:rtl">  ูุชูููุฐ ุงูุชุฎุตุต ุ ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููููุฉ ุชูุซูู ุงูุฎุทูุท ูู Go.  ุงูุชูุงูู ุงูุซูุงุฆู ููู ุจุงููุณุจุฉ ููุง ุ ูู ุญูู ุฃูู ุบูุฑ <code>unsafe.Pointer</code> ุงุณุชุจุฏุงู <code>unsafe.Pointer</code> ุจู <code>*byte</code> ุฏูู ุฃู ุชุถุญูุงุช. </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> stringStruct <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { str *<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-built_in"><span class="hljs-built_in">len</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ ุงูุซุงูู ุงูููู ุงูุฐู ูููููุง ุงุณุชุฎูุงุตู ูู ููุช ุงูุชุดุบูู: ุชุจุฏุฃ ุงูุฎุทูุท ุญูุงุชูู ูุงุจูุฉ ููุชุบููุฑ.  ูุชู ุชุฎุตูุต ุฌุฒุก ูู ุงูุฐุงูุฑุฉ ูุชู ุงูุฑุฌูุน ุฅููู ุจูุงุณุทุฉ <code>[]byte</code> ุ ุญูุซ ุชุชู ูุชุงุจุฉ ูุญุชููุงุช ุงูุณุทุฑ ุงูุฌุฏูุฏ ุ ูุจุนุฏ ุฐูู ููุท <code>[]byte</code> ุชุฌุงูู <code>[]byte</code> ุ ููุชู ุชุฎุฒูู ุงูุฐุงูุฑุฉ ุงูุชู ุชุดูุฑ ุฅูููุง ูู <code>stringStruct</code> . </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุฃููุฆู ุงูุฐูู ูุฑูุฏูู ุงููุฒูุฏ ูู ุงูุชูุงุตูู ุ ููุชุฑุญ ุฏุฑุงุณุฉ ูุธุงุฆู <code>rawstringtmp</code> ู <code>rawstring</code> . </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุช ุงูุชุดุบูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// rawstring allocates storage for a new string. The returned // string and byte slice both refer to the same storage. // The storage is not zeroed. Callers should use // b to set the string contents and then drop b. func rawstring(size int) (s string, b []byte) { p := mallocgc(uintptr(size), nil, false) stringStructOf(&amp;s).str = p stringStructOf(&amp;s).len = size *(*slice)(unsafe.Pointer(&amp;b)) = slice{p, size, size} return }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูููููุง ุชุญุฑูู ููุณูุง ุชูุฑูุจูุง ุ ุจุงุณุชุฎุฏุงู ุงูุฌุงูุจ ุงููุธูู ูู ุงูุญุฒูุฉ <code>unsafe</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concat2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { length := <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(x) + <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(y) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> length == <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> } b := <span class="hljs-built_in"><span class="hljs-built_in">make</span></span>([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>, length) <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span>(b, x) <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span>(b[<span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(x):], y) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> goString(&amp;b[<span class="hljs-number"><span class="hljs-number">0</span></span>], length) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุณูุท ุงูุถูุก ุนูู <code>[]byte</code> ุ ูุงูุฐู ูุณุชุฎุฏูู ูุชุดููู ูุญุชููุงุช ุณุทุฑ ุฌุฏูุฏ.  ุซู ูููููุง ุฅููุงุก ุงูุฎุท ููุท ูู ุฎูุงู ุฅุญุถุงุฑู ุฅูู ุชูุซูู ููุช ุงูุชุดุบูู ุงููุชููุน.  ูุธููุฉ <code>goString</code> ูุณุคููุฉ ุนู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ptr *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, length </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { s := stringStruct{str: ptr, <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>: length} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *(*<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)(unsafe.Pointer(&amp;s)) }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุชูููู ุงูุฃุฏุงุก: <strong>91.9ูช</strong> (+ 10.9). </blockquote><br><h1 id="versiya-dlya-amd64" style=";text-align:right;direction:rtl">  ุฅุตุฏุงุฑ AMD64 </h1><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูุง ูุญุชูู ุงูุฅุตุฏุงุฑ ุงูุณุงุจู ูู ุงููุธููุฉ ุนูู ุชุญุณูู ููุชุณูุณู ุจุณูุณูุฉ ูุงุฑุบุฉ ุ ููููู ุฃูุถูุง ุจุฅุฌุฑุงุก ุนุฏุฏ ูู ุงูุญุณุงุจุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ ุจุณุจุจ ุนุฏู ุงููุฏุฑุฉ ุนูู ุชุฎุตูุต ุงูุฐุงูุฑุฉ ูุจุงุดุฑุฉ ุ ุนูููุง ุงูุนูู ูุน ุดุฑูุญุฉ ุงูุจุงูุช. </p><br><p style=";text-align:right;direction:rtl">  ุฅุญุฏู ุงูููุฒุงุช ุงููุซูุฑุฉ ููุงูุชูุงู ูู ุฃุฏุงุฉ ุงูุชุฌููุน Go ูู ุฃููุง ุชุณูุญ ูู ุจุงูุงุชุตุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจูุธุงุฆู ููุช ุงูุชุดุบูู ุบูุฑ ุงููุงุจูุฉ ููุชุตุฏูุฑ.  ูููููุง ุงุณุชุฏุนุงุก <code>runtimeยทmallocgc</code> ูู ุฑูุฒ ุงูุชุฌููุน ุญุชู ูู ูู ููู ุฌุฒุกูุง ูู ุญุฒูุฉ <code>runtime</code> .  ุณูู ูุณุชุฎุฏู ูุฐู ุงูุฎุงุตูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููููุง ุฃูุถูุง ุงูุชุญูู ูู ููููุฉ ุฎุทูุท ุฐุงูุฑุฉ ุงูููุฏุณ ุ ููุง ูุฌุนููุง ุขููุฉ ูุชุญุณูู ุนูุฏุฉ ุฅุญุฏู ุงููุณูุทุงุช ูุชูุฌุฉ ูุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุฑุถ ุฃู ุฏุงูุฉ ุชู ุงุณุชุฏุนุงุคูุง ุจุงุณุชุฎุฏุงู ูุณูุทุงุช <code>concat2("", "123")</code> .  <code>x</code> ุนุจุงุฑุฉ ุนู ุณูุณูุฉ ูุงุฑุบุฉ ุ ูุฅุฐุง ูู <code>y</code> ุชุฎุตูุต <code>y</code> ุนูู ุงูููุฏุณ ุ ููููููุง ุฅุฑุฌุงุนูุง ููุชูุฌุฉ ููุชุณูุณู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/; ,  x  y   stringStruct. /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/; CX - y.str. /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/; SI - y.len. maybe_return_y: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/;      . MOVQ (TLS), AX /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/; *g CMPQ CX, (AX) JL return_y /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/;  y_str &lt; g.stack.lo CMPQ CX, 8(AX) JGE return_y /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/;  y_str &gt;= g.stack.hi JMP concatenate /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/; y  ,    return_y: MOVQ CX, ret+32(FP) /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/; stringStruct.len MOVQ SI, ret+40(FP) /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/; stringStruct.str RET</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <code>MOVQ (TLS), AX</code> <a href="">* g</a> ุฅูู ุณุฌู <code>AX</code> .  ุงููุฑุงุกุฉ ุนูุฏ ุงูุฅุฒุงุญุฉ ุงูุตูุฑูุฉ ุณุชุนุทู ุญูู <code>g.stack.lo</code> ุ ููุจุฏุฃ <code>g.stack.hi</code> ุจุงูุจุงูุช ุงูุซุงูู (ูููุตุฉ 64 ุจุช). </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { stack <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { lo <span class="hljs-keyword"><span class="hljs-keyword">uintptr</span></span> <span class="hljs-comment"><span class="hljs-comment">// 0(AX) hi uintptr // 8(AX) } stackguard0 uintptr // 16(AX) stackguard1 uintptr // 24(AX) // ...   }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฎุตุต ุงูุฌุณู <code>concatenate</code> ุงูุฐุงูุฑุฉ ููููุฃูุง ุจููุง ุงูุฎุทูู ููุนูุฏ ุณุทุฑูุง ุฌุฏูุฏูุง. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุงุฆูุฉ ุงููุงููุฉ ูุน ุงูุชุนูููุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"textflag.h"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"funcdata.h"</span></span> <span class="hljs-type"><span class="hljs-type">TEXT</span></span> ยท<span class="hljs-type"><span class="hljs-type">Strings</span></span>(<span class="hljs-type"><span class="hljs-type">SB</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">$4</span></span>8<span class="hljs-number"><span class="hljs-number">-48</span></span> <span class="hljs-type"><span class="hljs-type">NO_LOCAL_POINTERS</span></span> //    . <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> x+<span class="hljs-number"><span class="hljs-number">0</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">DX</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> x+<span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">DI</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> y+<span class="hljs-number"><span class="hljs-number">16</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">CX</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> y+<span class="hljs-number"><span class="hljs-number">24</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">SI</span></span> <span class="hljs-type"><span class="hljs-type">TESTQ</span></span> <span class="hljs-type"><span class="hljs-type">DI</span></span>, <span class="hljs-type"><span class="hljs-type">DI</span></span> <span class="hljs-type"><span class="hljs-type">JZ</span></span> maybe_return_y // x -  ,   y <span class="hljs-type"><span class="hljs-type">TESTQ</span></span> <span class="hljs-type"><span class="hljs-type">SI</span></span>, <span class="hljs-type"><span class="hljs-type">SI</span></span> <span class="hljs-type"><span class="hljs-type">JZ</span></span> maybe_return_x // y -  ,   x concatenate: <span class="hljs-type"><span class="hljs-type">LEAQ</span></span> (<span class="hljs-type"><span class="hljs-type">DI</span></span>)(<span class="hljs-type"><span class="hljs-type">SI</span></span>*<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-type"><span class="hljs-type">R8</span></span> // len(x) + len(y) //     . <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">R8</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-string"><span class="hljs-string">$0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVB</span></span> <span class="hljs-string"><span class="hljs-string">$0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">CALL</span></span> runtimeยทmallocgc(<span class="hljs-type"><span class="hljs-type">SB</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>), <span class="hljs-type"><span class="hljs-type">AX</span></span> //     <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">AX</span></span>, newstr<span class="hljs-number"><span class="hljs-number">-8</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) //  x. <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> x+<span class="hljs-number"><span class="hljs-number">0</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">DX</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> x+<span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">DI</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">AX</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">DX</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">DI</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">CALL</span></span> runtimeยทmemmove(<span class="hljs-type"><span class="hljs-type">SB</span></span>) //  y   len(x). <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> x+<span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">DI</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> y+<span class="hljs-number"><span class="hljs-number">16</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">CX</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> y+<span class="hljs-number"><span class="hljs-number">24</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">SI</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> newstr<span class="hljs-number"><span class="hljs-number">-8</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>), <span class="hljs-type"><span class="hljs-type">AX</span></span> <span class="hljs-type"><span class="hljs-type">LEAQ</span></span> (<span class="hljs-type"><span class="hljs-type">AX</span></span>)(<span class="hljs-type"><span class="hljs-type">DI</span></span>*<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-type"><span class="hljs-type">BX</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">BX</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">CX</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">SI</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>) <span class="hljs-type"><span class="hljs-type">CALL</span></span> runtimeยทmemmove(<span class="hljs-type"><span class="hljs-type">SB</span></span>) //   . <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> newstr<span class="hljs-number"><span class="hljs-number">-8</span></span>(<span class="hljs-type"><span class="hljs-type">SP</span></span>), <span class="hljs-type"><span class="hljs-type">AX</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> x+<span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">R8</span></span> <span class="hljs-type"><span class="hljs-type">ADDQ</span></span> y+<span class="hljs-number"><span class="hljs-number">24</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>), <span class="hljs-type"><span class="hljs-type">R8</span></span> <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">AX</span></span>, ret+<span class="hljs-number"><span class="hljs-number">32</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">R8</span></span>, ret+<span class="hljs-number"><span class="hljs-number">40</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>) <span class="hljs-type"><span class="hljs-type">RET</span></span> maybe_return_y: //      . <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> (<span class="hljs-type"><span class="hljs-type">TLS</span></span>), <span class="hljs-type"><span class="hljs-type">AX</span></span> // *g <span class="hljs-type"><span class="hljs-type">CMPQ</span></span> <span class="hljs-type"><span class="hljs-type">CX</span></span>, (<span class="hljs-type"><span class="hljs-type">AX</span></span>) <span class="hljs-type"><span class="hljs-type">JL</span></span> return_y //  y_ptr &lt; stk.lo <span class="hljs-type"><span class="hljs-type">CMPQ</span></span> <span class="hljs-type"><span class="hljs-type">CX</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">AX</span></span>) <span class="hljs-type"><span class="hljs-type">JGE</span></span> return_y //  y_ptr &gt;= stk.hi <span class="hljs-type"><span class="hljs-type">JMP</span></span> concatenate // y  ,    return_y: <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">CX</span></span>, ret+<span class="hljs-number"><span class="hljs-number">32</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">SI</span></span>, ret+<span class="hljs-number"><span class="hljs-number">40</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>) <span class="hljs-type"><span class="hljs-type">RET</span></span> maybe_return_x: //      . <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> (<span class="hljs-type"><span class="hljs-type">TLS</span></span>), <span class="hljs-type"><span class="hljs-type">AX</span></span> // *g <span class="hljs-type"><span class="hljs-type">CMPQ</span></span> <span class="hljs-type"><span class="hljs-type">DX</span></span>, (<span class="hljs-type"><span class="hljs-type">AX</span></span>) <span class="hljs-type"><span class="hljs-type">JL</span></span> return_x //  x_ptr &lt; stk.lo <span class="hljs-type"><span class="hljs-type">CMPQ</span></span> <span class="hljs-type"><span class="hljs-type">DX</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>(<span class="hljs-type"><span class="hljs-type">AX</span></span>) <span class="hljs-type"><span class="hljs-type">JGE</span></span> return_x //  x_ptr &gt;= stk.hi <span class="hljs-type"><span class="hljs-type">JMP</span></span> concatenate // x  ,    return_x: <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">DX</span></span>, ret+<span class="hljs-number"><span class="hljs-number">32</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>) <span class="hljs-type"><span class="hljs-type">MOVQ</span></span> <span class="hljs-type"><span class="hljs-type">DI</span></span>, ret+<span class="hljs-number"><span class="hljs-number">40</span></span>(<span class="hljs-type"><span class="hljs-type">FP</span></span>) <span class="hljs-type"><span class="hljs-type">RET</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ููุชููุง ุจุทุจูุนุฉ <code>NO_LOCAL_POINTERS</code> ูู ูุฐุง ุงูุฑูุฒ ุ ูููููู ูุฑุงุกุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุธููุฉ ุงูุงุชุตุงู ุจู Go ูู asm ("ุฎุทุฃ ูุงุฏุญ: ููููุฏ stackmap")</a> . </p></div></div><br><blockquote style=";text-align:right;direction:rtl">  ุชูููู ุงูุฃุฏุงุก: <strong>100ูช</strong> (+8.6). </blockquote><br><h1 id="v-kachestve-zaklyucheniya" style=";text-align:right;direction:rtl">  ูู ุงูุฎุชุงู </h1><br><p style=";text-align:right;direction:rtl">  ูุชู ุชูููุฑ ุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุญุฒูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">concat</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุนุงูู ุฌุงูุฒ ููุซู ูุฐุง ุงูุชุณูุณู ุงูุณุฑูุนุ  ูู ูุฏุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุฏุงูุฉ ุงูููุงู ุ ุชู ุฐูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CL123256</a> .  ูุฏูู ุงูุนุฏูุฏ ูู ูุณุงุฑุงุช ุงูุชุทููุฑ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชุฎุตุต ุงููุชุบูุฑ ููุญุงูุฉ ุนูุฏูุง ูุง ูููู ุงููุญูู ุงูุจุฑูุฌู ุจุชุฎุตูุต ูุฎุฒู ูุคูุช.  ููุงู ููู ุฃูู ููู ุญุงูุฉ ุ ููููู ูุบุทู ุงููุฒูุฏ ูู ุฃููุงุน ุงูุชุณูุณู ููุง ูุฒูุฏ ุนููููุง ูู ุญุฌู ุงูุดูุฑุฉ (ูู ูู ุงูุฌูุงุฒ ูุฑูุฒ Go). </li><li style=";text-align:right;direction:rtl">  ุงููุฒูุฏ ูู ุงูุชุฎุตุตุงุช ููุญุงูุงุช ุงูุฎุงุตุฉ.  ูููู ุฃู ุชุคุฐู ุงูููุงุณุจ ุงูุฃุนูู ุ ูููู ุงููุฒูุฏ ูู ููุฏ ุงูุขูุฉ ุ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุฅุฑุดุงุฏุงุช. </li><li style=";text-align:right;direction:rtl">  ุทู ูู ููุฏ ุงูุขูุฉ ุ ููู ุญุงูุฉ ุฎุงุตุฉ ููุฐูุฑุฉ ูุชุฎุตุตุฉ ุ ุจุทุฑููุฉ ููููุฉ ุงูููุงู ุจุฐูู ูู glibc.  ููุง ุชูุดุฃ ุจุดูู ุฑุฆูุณู ุฃุณุฆูุฉ ุงูููุนูุฉ. </li></ol><br><p style=";text-align:right;direction:rtl">  ูุณุฑุน ุงูุฎูุงุฑ ุงูููุชุฑุญ ุงูุญุงูู ููุท ุงูุญุงูุฉ ุงูุฃูุซุฑ ุดููุนูุง ูุฃุจุณุทูุง ูุณูุณูุฉ ูู ุงูุณูุงุณู (arity = 2). </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ููุจู Go ูุฐุง ุงูุชุบููุฑ ุ ููููู ุชุญููู ุชุณุงุฑุน ููุงุซู ูู ุฎูุงู ุชูููุฐ ุนูููุงุช ุงูุณูุณูุฉ ูู ุดูู ููุชุจุฉ ุฎุงุฑุฌูุฉ.  ุฃูู ููุงุกูุฉ ูุฌูููุฉ ูุฃูููุฉ ุ ููููุง ุชุนูู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar417479/">https://habr.com/ru/post/ar417479/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../486164/index.html">Coronavirus 2019-nCoV. Preguntas frecuentes sobre protecciรณn respiratoria y desinfecciรณn</a></li>
<li><a href="../486174/index.html">Tengo cero rotaciรณn</a></li>
<li><a href="../ar417473/index.html">ุชุฎุฒูู ููุซูู ุจู ูุน DRBD9 ู Proxmox (ุงูุฌุฒุก 1: NFS)</a></li>
<li><a href="../ar417475/index.html">Glusterfs + ุชุดููุฑ ุงููุญู: ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุงููุซูุฑ ุ ูุฑุฎูุตุฉ ูููุซููุฉ</a></li>
<li><a href="../ar417477/index.html">ููุชุจ ุณุงุฎู</a></li>
<li><a href="../ar417481/index.html">ุญูู ุงููููุฏุงุช ูู JavaScript ES6 ุ ูููุงุฐุง ูููู ุงุฎุชูุงุฑููุง ูุฏุฑุงุณุชูุง</a></li>
<li><a href="../ar417483/index.html">ููุงุฑูุฉ ุฃุทุฑ JS: React ู Vue ู Hyperapp</a></li>
<li><a href="../ar417487/index.html">ุงูููุงู ุงูุฐู ุจุฏุฃุช ููู ุงูุฅูุชุฑูุช ุงูุฑูุณูุฉ</a></li>
<li><a href="../ar417489/index.html">ุชูุฑูุฑ ูุงุฏู ุฑููุง 2018 ุ ุงููุตู 3.4: "ุงูุทุงูุฉ ุงููุงูุฑูุฒูุฉ"</a></li>
<li><a href="../ar417493/index.html">ููููุฉ ุถุบุท ูุญูู ุงูุฅููุงุน ูู STM8 ูุญุฌู 18 ุจุงูุช ูู ุฐุงูุฑุฉ ููุงุด</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>