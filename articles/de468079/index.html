<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ô•Ô∏è üëê ‚ùî Benutzerdefinierte Dimensionen in Google Analytics, die uns mehr als einmal gespeichert haben üèáüèæ üóΩ üì±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beim Einrichten von Analysen √ºber Google Analytics (GA) werden Benutzerparameter oder CD ( benutzerdefinierte Dimensionen ) h√§ufig ignoriert. Dies lie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Benutzerdefinierte Dimensionen in Google Analytics, die uns mehr als einmal gespeichert haben</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468079/">  Beim Einrichten von Analysen √ºber Google Analytics (GA) werden Benutzerparameter oder CD ( <i>benutzerdefinierte Dimensionen</i> ) h√§ufig ignoriert.  Dies liegt an der Schwierigkeit, ihren Umfang zu verstehen: Es ist unklar, wie die CDs beim Sammeln und Analysieren von Daten helfen k√∂nnen und wie sie konfiguriert sind.  Dieser Artikel beschreibt die Haupt-CDs, die wir in Adventum f√ºr viele Projekte verwenden, und den Einrichtungsprozess. <br><br><h1>  Was sind Benutzeroptionen? </h1><br>  Um einen Bericht in Google Analytics zu erstellen, stehen mehr als 200 verschiedene Parameter und Metriken zur Verf√ºgung, z. B. "Quelle", "Stadt", "Browser", "Betriebssystem" und viele andere.  Standardparameter reichen jedoch nicht immer f√ºr die Analyse aus. Daher hat Google den Nutzern die M√∂glichkeit gegeben, eigene Parameter zu erstellen.  Der Wert der CD kann mit jedem Treffer des Benutzers √ºbertragen werden.  Mithilfe benutzerdefinierter Parameter k√∂nnen Sie beispielsweise die Leistung der Site im Kontext von Adaptiven analysieren. <br><br>  Insgesamt gibt es 4 CD-Aktionsbereiche: <br><br><ul><li>  Hit </li><li>  Sitzung </li><li>  Benutzer </li><li>  Produkt </li></ul><br>  Zum Beispiel haben wir eine CD, auf der der Benutzerautorisierungsparameter gespeichert ist (0 - nicht autorisiert, 1 - autorisiert).  Zu Beginn der Sitzung sind nicht alle Benutzer berechtigt.  Mal sehen, was passiert, wenn sich dieser Parameter nach der Eingabe √§ndert, abh√§ngig vom Umfang der CD. <br><br><img src="https://habrastorage.org/webt/yo/ef/tr/yoeftruoaljptzlnl3xtngigfbq.jpeg"><br><br><ul><li>  Bei einer CD mit dem Bereich "Treffer" wird die Einheit dem Autorisierungsparameter in dem Treffer zugewiesen, in dem die Autorisierung stattgefunden hat. </li><li>  Bei einer CD mit dem Umfang der Sitzung wird der Autorisierungsparameter f√ºr alle Treffer der Sitzung, in der das Ereignis aufgetreten ist, gleich 1 (√úberschreiben der alten Werte der CD in dieser Sitzung). </li><li>  Bei einer CD mit dem Bereich Benutzer wird der Autorisierungsparameter f√ºr alle Benutzersitzungen gleich 1, beginnend mit der, in der die Anmeldung vorgenommen wurde. </li></ul><a name="habracut"></a><br>  Manchmal m√ºssen Sie die Merkmale eines Produkts analysieren, dessen Unterst√ºtzung nicht in den grundlegenden Parametern von Google Analytics festgelegt ist: z. B. Gewicht.  Da Informationen √ºber mehrere Produkte mit einem Schlag √ºbertragen werden k√∂nnen, ben√∂tigen wir einen zus√§tzlichen Bereich mit detaillierteren Informationen.  F√ºr diese Granularit√§t wird der Bereich "Produkt" verwendet: <br><br><img src="https://habrastorage.org/webt/me/9m/s4/me9ms4-kjwvsn-pgj1yzdn6uxbi.jpeg"><br><br><h1>  CD-Setup </h1><br>  Das Einrichten eines Benutzerparameters besteht aus zwei Schritten: Erstellen eines Parameters in GA und Senden von Daten von der Site.  Als n√§chstes beschreiben wir die Abfolge der Schritte zum Einrichten der CD. <br><br><h2>  Erstellen einer CD in Google Analytics </h2><br><ol><li>  Gehen Sie zum Abschnitt "Administrator" </li><li>  W√§hlen Sie in den Ressourceneinstellungen im Abschnitt "Benutzerparameter" den Unterabschnitt "Spezielle Parameter" aus: <br><img src="https://habrastorage.org/webt/pc/b3/pp/pcb3ppb_6lwiyyxpe8ctui2qe18.jpeg"></li><li>  Klicken Sie auf die Schaltfl√§che "+ Spezialparameter" <br><img src="https://habrastorage.org/webt/ak/k8/iy/akk8iyzg0rbrvrq-tawj3u-uwue.jpeg"></li><li>  Das Formular wird ge√∂ffnet: <br><img src="https://habrastorage.org/webt/82/jf/3o/82jf3oy-kbvheuwjrntj4ooxecw.jpeg"><br>  W√§hlen Sie den Parameterbereich: <br><br><ul><li>  Hit </li><li>  Sitzung </li><li>  Benutzer </li><li>  Produkt </li></ul><br>  Lassen Sie das H√§kchen neben "Aktiv", damit Daten erfasst werden und die CD in den Berichten angezeigt wird. </li></ol><blockquote>  <b>Empfehlungen f√ºr CD-Titel</b> <br>  Wir haben ein eigenes System zur Benennung von Benutzerparametern entwickelt. <br>  Zu Beginn jeder CD f√ºgen wir ein Symbol f√ºr den Bereich hinzu.  F√ºr Treffer ist es h_ (zum Beispiel h_hitId), f√ºr Sitzung - s_ (zum Beispiel s_sessionId).  Dies hilft uns, durch die Benutzerparameter zu navigieren und deren Umfang immer zu kennen, ohne die Z√§hlereinstellungen zu √ºberpr√ºfen.  Manchmal m√ºssen zwei Parameter mit demselben Namen, aber einem anderen Bereich erstellt werden.  Zum Beispiel f√ºhren wir einen A / B-Test durch und m√∂chten √ºberpr√ºfen, ob er korrekt konfiguriert ist. √Ñndert sich die Testvariante w√§hrend der Sitzung?  Erstellen Sie dazu zwei Parameter mit demselben Wert: Name + Testversion, auf die der Benutzer zugegriffen hat, von denen jedoch einer getroffen wird, die zweite Sitzung.  In diesem Fall ist die vorgeschlagene Benennung sehr praktisch. <br></blockquote><br><h2>  Einrichten von Google Tag Manager </h2><br>  Es gibt zwei M√∂glichkeiten, die Sendeparameter von der Site aus zu konfigurieren: <br><br><ul><li>  direkt √ºber den HTML-Code auf der Website. </li><li>  √ºber Google Tag Manager (GTM). </li></ul><br>  F√ºr beide Methoden ben√∂tigen wir den CD-Index in Google Analytics.  Sie k√∂nnen es im Abschnitt "Spezielle Einstellungen" sehen: <br><br><img src="https://habrastorage.org/webt/z3/el/gs/z3elgs7abwc7vnaibkvlssffe08.jpeg"><br><br>  <b>Senden √ºber HTML auf der Website</b> <br><br>  Aktualisieren Sie die Konfiguration der Ressource im Google Analytics-Tracking-Code, indem <font color="green">Sie</font> dort <font color="green">custom_map</font> hinzuf√ºgen (Sie m√ºssen hinzuf√ºgen, was auf beiden Seiten durch Kommentare hervorgehoben wird): <br><br><pre><code class="javascript hljs">gtag(<span class="hljs-string"><span class="hljs-string">'config'</span></span>, <span class="hljs-string"><span class="hljs-string">'GA_MEASUREMENT_ID'</span></span> , <span class="hljs-comment"><span class="hljs-comment">//  { 'custom_map': {'dimension&lt;Index&gt;': 'dimension_name'} } //  );</span></span></code> </pre> <br>  Dabei ist <font color="green">GA_MEASUREMENT_ID</font> Ihre Analytics-Z√§hler- <font color="green">ID</font> .  Ersetzen Sie <font color="green">&lt;Index&gt;</font> durch den Index des Parameters in GA und geben Sie anstelle von <font color="green">dimension_name</font> dessen Namen an. <br><br>  Wenn Sie mehrere Benutzerparameter haben, muss <font color="green">'dimension &lt;Index&gt;'</font> : <font color="green">'dimension_name'</font> f√ºr jeden mit einem Komma angegeben werden. <br><br>  Zum Beispiel: <br><br><pre> <code class="javascript hljs">gtag(<span class="hljs-string"><span class="hljs-string">'config'</span></span>, <span class="hljs-string"><span class="hljs-string">'UA-XXXXXXXXX'</span></span>, { <span class="hljs-string"><span class="hljs-string">'custom_map'</span></span>: {<span class="hljs-string"><span class="hljs-string">'dimension1'</span></span>: <span class="hljs-string"><span class="hljs-string">'projectName'</span></span>, <span class="hljs-string"><span class="hljs-string">'dimension2'</span></span>: <span class="hljs-string"><span class="hljs-string">'hitId'</span></span>, <span class="hljs-string"><span class="hljs-string">'dimension3'</span></span>: <span class="hljs-string"><span class="hljs-string">'sessionId'</span></span>, <span class="hljs-string"><span class="hljs-string">'dimension4'</span></span>: <span class="hljs-string"><span class="hljs-string">'screenWindow'</span></span>} });</code> </pre> <br>  Um eine CD zusammen mit einer Seitenansicht zu senden, m√ºssen Sie diese Parameter dem gew√ºnschten Wert <b>vor dem oben angegebenen Code</b> zuweisen: <br><br><pre> <code class="javascript hljs">gtag(<span class="hljs-string"><span class="hljs-string">'set'</span></span>, { <span class="hljs-string"><span class="hljs-string">'dimension_name'</span></span>: <span class="hljs-string"><span class="hljs-string">'dimension_value'</span></span>});</code> </pre> <br>  Dabei sollte <font color="green">dimension_name</font> mit den in <font color="green">'custom_map'</font> angegebenen <font color="green">√ºbereinstimmen</font> , und <font color="green">dimension_value sollte</font> der Wert <font color="green">sein</font> , den Sie auf die CD √ºbertragen m√∂chten. <br><br>  Zum Beispiel: <br><br><pre> <code class="javascript hljs">gtag(<span class="hljs-string"><span class="hljs-string">'set'</span></span>, {<span class="hljs-string"><span class="hljs-string">'projectName'</span></span>: <span class="hljs-string"><span class="hljs-string">'shop'</span></span>, <span class="hljs-string"><span class="hljs-string">'hitId'</span></span>: <span class="hljs-string"><span class="hljs-string">'1121243'</span></span>});</code> </pre> <br>  Wenn Sie einen CD-Wert zusammen mit dem Ereignis senden, m√ºssen Sie den folgenden Code senden: <br><pre> <code class="javascript hljs">gtag(<span class="hljs-string"><span class="hljs-string">'event'</span></span>, <span class="hljs-string"><span class="hljs-string">'action_value'</span></span>, {<span class="hljs-string"><span class="hljs-string">'event_category'</span></span>: <span class="hljs-string"><span class="hljs-string">'category_value'</span></span>, <span class="hljs-string"><span class="hljs-string">'event_label'</span></span>: <span class="hljs-string"><span class="hljs-string">'label_value'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>: <span class="hljs-string"><span class="hljs-string">'event_value'</span></span>, <span class="hljs-string"><span class="hljs-string">'dimension_name'</span></span>: <span class="hljs-string"><span class="hljs-string">'dimension_value'</span></span>});</code> </pre> <br>  wo statt: <br><br>  <font color="green">action_value</font> - Ereignisaktion <br>  <font color="green">category_value</font> - Ereigniskategorie <br>  <font color="green">label_value</font> - Ereignisbezeichnung <br>  <font color="green">event_value</font> - Ereigniswert (nicht negative Ganzzahl) <br>  <font color="green">Dimensionsname</font> - Der Name des Parameters, den wir im vorherigen Code angegeben haben <br>  <font color="green">dimension_value</font> - Wert der CD <br><br>  Ein Beispiel: <br><br><pre> <code class="javascript hljs">gtag(<span class="hljs-string"><span class="hljs-string">'event'</span></span>, <span class="hljs-string"><span class="hljs-string">'clickButton'</span></span>, {<span class="hljs-string"><span class="hljs-string">'event_category'</span></span>: <span class="hljs-string"><span class="hljs-string">'conversion'</span></span>, <span class="hljs-string"><span class="hljs-string">'event_label'</span></span>: <span class="hljs-string"><span class="hljs-string">'registration'</span></span>, <span class="hljs-string"><span class="hljs-string">'projectName'</span></span>: <span class="hljs-string"><span class="hljs-string">'shop'</span></span>, <span class="hljs-string"><span class="hljs-string">'hitId'</span></span>: <span class="hljs-string"><span class="hljs-string">'1121243'</span></span>});</code> </pre> <br>  Bei unseren Projekten verwenden wir die zweite Option - das Tuning √ºber GTM.  Betrachten wir es genauer. <br><br>  <b>Senden von CDs mit Hits an GA √ºber GTM</b> <br><br>  Das Einrichten des Sendens von CDs zusammen mit Treffern (Seitenaufrufen, Ereignissen) in GA erfolgt in einer Variablen vom Typ "Google Analytics-Einstellungen".  Wenn Sie diese Variable bereits konfiguriert haben, √∂ffnen Sie sie.  Wenn nicht, m√ºssen Sie es erstellen.  Gehen Sie zum Abschnitt "Erweiterte Einstellungen", dem Unterabschnitt "Spezielle Einstellungen".  Hier m√ºssen Sie alle Benutzerparameter hinzuf√ºgen, die Sie zuvor in GA erstellt haben: <br><br><img src="https://habrastorage.org/webt/v5/u2/jc/v5u2jc6kqqsi7e1zwozl71iy2yc.jpeg"><br><br>  Die Tracking-ID muss die GA-Z√§hlernummer enthalten.  Schreiben Sie in das Feld "Index" die Kennung der CD von GA, auf die Sie Daten √ºbertragen m√∂chten. <br><br>  Im Feld "Parameterwert" m√ºssen Sie den Wert angeben, der mit dem angegebenen Index auf die CD √ºbertragen wird.  Dieser Wert kann auf zwei Arten angegeben werden: <br><br><ul><li>  manuell, wenn es f√ºr alle Ereignisse gleich ist; </li><li>  Verwenden der Variablen, in der der Wert dieses Parameters gespeichert ist (sein Name wird in doppelte geschweifte Klammern geschrieben).  Zum Beispiel {{SCREEN_WINDOW}} - "Browserfenstergr√∂√üe". </li></ul><br><img src="https://habrastorage.org/webt/ov/we/fi/ovwefildb093dmfjzur0duaxfvk.jpeg"><br><br>  Bei dieser Einstellung der Benutzerparameter ist Folgendes zu beachten: <br><br><ol><li>  Bei der ersten Verarbeitung des Tags wird noch kein Cookie mit der Google-Benutzer-ID (clientID) erstellt.  Wenn wir die √úbertragung dieses Parameters auf CD konfigurieren m√∂chten, k√∂nnen wir dies beim ersten Anzeigen von Seiten nicht tun. </li><li>  Wenn wir beim Senden von Daten an verschiedene Benutzerparameter dieselbe Variable verwenden m√∂chten, wird diese Variable f√ºr jeden Benutzerparameter erneut berechnet.  Wenn Sie beispielsweise einen Tag-Zeitstempel an zwei verschiedene Benutzerparameter senden, stellen Sie m√∂glicherweise einen Wertunterschied von einigen Millisekunden fest. </li></ol><br>  Sie k√∂nnen diese Schwierigkeiten mit customTask vermeiden. <br><br><h3>  Verwenden von customTask </h3><br>  customTask ist die Funktion mit der h√∂chsten Priorit√§t, deren Code und Logik Sie selbst definieren.  Vor nicht allzu langer Zeit gab Google die M√∂glichkeit, diese Funktion in GTM zu verwenden. <br><br>  customTask verwendet Daten aus dem Modellobjekt (das alle Felder des Verfolgungsz√§hlers enth√§lt), dem Cookie usw.  Die Priorit√§t dieser Funktion ist h√∂her als die aller anderen und funktioniert f√ºr das Tag.  Dank dessen k√∂nnen Sie das Senden der Benutzer-ID vom ersten Aufruf der Seite an konfigurieren. <br><br>  Um die CD √ºber customTask zu konfigurieren, erstellen Sie eine GTM-Variable mit dem Namen JS_customTask und dem Typ "Native JavaScript-Code": <br><br><img src="https://habrastorage.org/webt/mt/xt/m3/mtxtm3rarxslutrgoniz_ynobig.jpeg"><br><br>  F√ºgen Sie nun die von uns erstellte JS_customTask zur Variablen "Google Analytics-Einstellungen" im Abschnitt "Zu setzende Felder" hinzu: <br><br><ul><li>  Schreiben <b>Sie in</b> " <b>Feldname</b> " <b>customTask</b> ; </li><li>  Schreiben Sie in den Wert den Namen der Variablen, die wir oben erstellt haben.  Alle Variablen m√ºssen in doppelten Klammern geschrieben werden. </li></ul><br><img src="https://habrastorage.org/webt/qp/tg/pc/qptgpciskueuoh_81xbxicmdjbi.jpeg"><br><br>  In einem GTM-Tag kann nur eine benutzerdefinierte Aufgabe definiert werden.  Daher werden alle CDs, die mit dieser Methode ermittelt werden k√∂nnen, in die zuvor erstellte Variable JS_customTask geschrieben. <br><br><h1>  H√§ufig verwendete CDs </h1><br><h2>  Benutzer-ID </h2><br>  <b>Herausforderung.</b>  Der Z√§hler hat einen gro√üen Sprung in der Anzahl der Sitzungen aufgezeichnet.  Gleichzeitig ist die Anzahl der Nutzer leicht gestiegen.  Es gab eine Hypothese √ºber den Bot-Verkehr, die von einigen Benutzern stammt.  Standardm√§√üig ist es nicht m√∂glich, die Merkmale einzelner Benutzer in GA in einem praktischen Format anzuzeigen. <br><br>  <b>L√∂sung.</b>  Google Analytics weist jedem Besucher der Website eine eindeutige Kennung zu - Kunden-ID.  Sie k√∂nnen es in der Google Analytics-Oberfl√§che nur in einem Bericht anzeigen - "Benutzerstatistik" (Benutzer-Explorer).  Die Verwendung ist unpraktisch, da auf einem Bildschirm die Abfolge der Aktionen nur eines Benutzers angezeigt wird und Sie dem Bericht keine zus√§tzlichen Parameter hinzuf√ºgen k√∂nnen. <br><br>  Eine ideale L√∂sung w√§re die M√∂glichkeit, die Client-ID als separaten Parameter in einem Standard- oder Benutzerbericht anzuzeigen.  Und das kann mit GTM gemacht werden. <br><br>  <b>Technikeinstellungen.</b>  Als ClientId verwenden wir die Ziffernfolge aus der Benutzer-ID in GA (sie wird in einem Cookie mit dem Namen _ga gespeichert. Beispiel: _ga = GA1.2.1111111111.111111111, wobei ClientId = 111111111.1111111).  Um diesen Wert anzuzeigen, klicken Sie mit der rechten Maustaste auf die Site-Seite und w√§hlen Sie "Code anzeigen": <br><br><img src="https://habrastorage.org/webt/e2/fn/ew/e2fnewovy0uvqtij9k4krzez1ve.jpeg"><br><br>  W√§hlen Sie dann auf der Registerkarte Anwendung im Men√º auf der linken Seite Cookies und den Namen der Site aus und suchen Sie in der Tabelle nach der Variablen _ga: <br><br><img src="https://habrastorage.org/webt/g8/gs/qi/g8gsqiboktqwl0qw0bdmvzabn64.jpeg"><br><br>  Zus√§tzlich zum Cookie wird die GA-Benutzer-ID im Modellobjekt gespeichert und kann mit der Methode .get ('clientId') abgerufen werden.  Wir verwenden customTask, um diesen Wert abzurufen und an GA zu √ºbergeben.  F√ºgen Sie der Variablen JS_customTask den folgenden Code hinzu: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> customDimensionIndex_client = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">model</span></span></span><span class="hljs-function">) </span></span>{ model.set(<span class="hljs-string"><span class="hljs-string">'dimension'</span></span> + customDimensionIndex_client, model.get(<span class="hljs-string"><span class="hljs-string">'clientId'</span></span>)); } }</code> </pre> <br>  Nach dem Gleichheitszeichen f√ºr die Variable customDimensionIndex_client m√ºssen Sie den CD-Index angeben, der der ClientId in GA entspricht.  Auf diese Weise haben wir die Client-ID vom Z√§hler erhalten und an den Benutzerparameter gesendet. <br><br>  <b>Ergebnis.</b>  Wir haben einen Bericht √ºber einzelne Benutzer erstellt und festgestellt, dass einige von ihnen tats√§chlich tausend Sitzungen hatten.  Alle Sitzungen hatten eine Absprungrate von 100% und hatten eindeutig keinen Wert f√ºr uns.  Wir haben ein Segment eingerichtet, um diese Benutzer auszuschlie√üen, und konnten die Verkehrsdynamik ohne unn√∂tige Besuche analysieren. <br><br><h2>  Hit id </h2><br>  <b>Herausforderung.</b>  Sie m√ºssen sehen, wie sich der Benutzer auf der Site verh√§lt, welche Aktionen er ausf√ºhrt und in welcher Reihenfolge.  Basierend auf diesen Daten k√∂nnten Hypothesen f√ºr die Gesch√§ftsentwicklung aufgestellt werden. <br><br>  <b>L√∂sung.</b>  Erstellen Sie in jeder Sitzung Ihre eigene CD mit der Trefferzahl des Benutzers.  Wenn wir in aufsteigender Reihenfolge der Treffer sortieren, k√∂nnen wir die Wege der Benutzer sehen. <br><br>  <b>Technikeinstellungen.</b>  Der Einfachheit halber √ºbergeben wir als HitId die ClientId + Trefferzeit im Zeitstempelformat.  F√ºr jedes Ereignis, jede Seitenansicht und jede Transaktion gibt es einen Wert.  Dieser Parameter kann √ºber customTask (√§hnlich wie ClientId) konfiguriert werden. <br><br>  In einem einzelnen GTM-Tag kann nur eine benutzerdefinierte Aufgabe definiert werden.  Daher f√ºgen wir der zuvor erstellten Variablen "Custom JavaScript" den Code hinzu, der auf beiden Seiten durch Kommentare hervorgehoben ist, wobei der CD-Index mit dem Namen h_HitId von GA in der Variablen customDimensionIndex_hit gespeichert wird: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> customDimensionIndex_client = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    var customDimensionIndex_hit = 2; var now = new Date(); //    return function(model) { model.set('dimension' + customDimensionIndex_client, model.get('clientId')); //    model.set('dimension' + customDimensionIndex_hit, model.get('clientId').concat('_', now.getTime())); //    } }</span></span></code> </pre> <br>  Der Parametertyp wird getroffen.  Aufgrund der Tatsache, dass es auch Zeit im Zeitstempelformat enth√§lt, k√∂nnen alle Benutzer- / Sitzungstreffer nach der Reihenfolge ihrer Ausf√ºhrung sortiert werden, ohne zus√§tzliche Parameter zu verwenden. <br><br>  Wenn Sie genau die gleichen Einstellungen vornehmen, w√§hlen Sie nur in GA den Bereich des Parameters - session. Dann erhalten wir eine CD, auf der die Sitzungskennung des Benutzers gespeichert wird. <br><br>  <b>Ergebnis.</b>  Zwei Berichte erstellt: <br><br><ul><li>  Benutzer-ID, Treffer-ID, Ereigniskategorie, Ereignisaktion, Ereignisbezeichnung, Hinzuf√ºgen.  Parameter. </li><li>  Benutzer-ID, Treffer-ID, Hinzuf√ºgen.  Parameter. </li></ul><br>  Dann entladen sie diese Daten aus GA und kombinieren sie in Excel (oder einer Datenbank).  Wenn wir die Zeilen nach ClientId und dann nach HitId sortieren, erhalten wir den Pfad jedes Benutzers auf der Site.  Jetzt k√∂nnen wir Pivot-Tabellen erstellen und visualisieren. <br><br><h2>  A / B-Tests </h2><br>  <b>Herausforderung.</b>  Das Unternehmen beschloss, einen AB-Test durchzuf√ºhren.  Die Einstellungen wurden von Entwicklern ohne Verwendung von Google Optimize vorgenommen.  Es stellte sich die Frage, wie Testoptionen an Google Analytics √ºbertragen werden k√∂nnen, um die Wirksamkeit des Experiments zu analysieren. <br><br>  <b>L√∂sung.</b>  In diesem Fall helfen uns die CDs, die Testergebnisse in GA zu vergleichen.  Es reicht aus, einen Benutzerparameter zu konfigurieren, der Werte mit der Kennung des Tests und der Option annimmt, in die der Benutzer gefallen ist.  So k√∂nnen wir das Publikum nach Testoptionen in Gruppen einteilen und die Ergebnisse vergleichen. <br><br>  <b>Technikeinstellungen.</b>  Erstellen Sie einen benutzerdefinierten Parameter in GA, √§hnlich dem zuvor konfigurierten.  Wir w√§hlen als "Bereich" - einen Treffer, damit es m√∂glich ist, Ereignisse vor und nach dem Test in vom Benutzer festgelegte Ereignisse zu unterteilen.  Nennen Sie es zum Beispiel h_AB-Test.  Es ist m√∂glich, Daten durch mehrere Tests gleichzeitig auf eine CD zu √ºbertragen.  Sie k√∂nnen sie durch ein Symbol trennen, das nicht im Namen und in der Version des Tests enthalten ist, z. B. "|". <br><br>  Wenn Sie den Test selbst durchf√ºhren und die Daten dar√ºber in einem Cookie speichern, ben√∂tigen Sie eine Variable wie "Native JavaScript Code", um sie zu extrahieren: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cookie_name =<span class="hljs-string"><span class="hljs-string">'{{test_variant}}'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matches = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.cookie.match(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">RegExp</span></span>( <span class="hljs-string"><span class="hljs-string">"(?:^|; )"</span></span> + cookie_name.replace(<span class="hljs-regexp"><span class="hljs-regexp">/([\.$?*|{}\(\)\[\]\\\/\+^])/g</span></span>, <span class="hljs-string"><span class="hljs-string">'\\$1'</span></span>) + <span class="hljs-string"><span class="hljs-string">"=([^;]*)"</span></span> )); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> matches ? <span class="hljs-built_in"><span class="hljs-built_in">decodeURIComponent</span></span>(matches[<span class="hljs-number"><span class="hljs-number">1</span></span>]) : <span class="hljs-string"><span class="hljs-string">'(not set)'</span></span>; }</code> </pre> <br>  Dabei m√ºssen Sie anstelle von {{test_variant}} den Namen des Cookies angeben, in dem der Name und die Variante des Tests gespeichert sind.  Vergessen Sie nicht, es der GA-Einstellungsvariablen hinzuzuf√ºgen. <br><br>  Durch Hinzuf√ºgen des Parameters h_AB-Test zum Bericht sehen wir in Google Analytics, zu welcher Testoption die Sitzung geh√∂rt.  Abh√§ngig vom Wert dieses Parameters k√∂nnen Sie Benutzer segmentieren. <br><br>  <b>Ergebnis.</b>  Wir erstellen so viele Segmente wie es Testf√§lle mit der Bedingung h_AB-Test gab.  Es muss mit dem Wert "Name + Testfall" √ºbereinstimmen.  Wir betrachten die Ereignisse, die f√ºr uns von Interesse sind, in den Berichten. <br><br><h2>  Ganzseitige Adresse </h2><br>  <b>Herausforderung.</b>  Der kontextbezogene Werbeleiter startete eine Werbekampagne in Yandex.Direct.  Einige Tage sp√§ter ging er zum GA-Quellenbericht und stellte fest, dass die Anzahl der Benutzersitzungen, die aus der von ihm erstellten Werbekampagne stammten, viel geringer war als das Klicken auf Anzeigen in Yandex.Direct. <br><br>  <b>L√∂sung.</b>  Google Analytics verf√ºgt √ºber einen erforderlichen Parameter f√ºr die Verfolgung von Anzeigen - utm_source.  Wenn dies der Fall ist, wird sein Wert zum Standardparameter "Kampagnenquelle" hinzugef√ºgt.  Ebenso arbeitet Google mit anderen UTM-Tags f√ºr die Aufzeichnung in den entsprechenden Parametern. <br><br>  Alle UTM-Tags werden automatisch aus dem Bericht auf den Websiteseiten gel√∂scht und k√∂nnen dort nicht analysiert werden.  In diesem Fall l√∂scht Google einfach alle UTM-Tags, die im Bericht auf den Seiten gefunden wurden, und zeichnet deren Inhalt nicht in den entsprechenden integrierten Parametern auf, wenn die Bezeichnung utm_source nicht festgelegt wurde. <br><br>  Wir konfigurieren den Parameter mit der vollst√§ndigen Seitenadresse, um alle Tags anzuzeigen, auch wenn die Werbung falsch konfiguriert ist.  Nennen wir es h_fullPage. <br><br>  <b>Technikeinstellungen.</b>  Erstellen wir eine Variable mit dem Typ "JavaScript-Variable" im Abschnitt "Name der globalen Variablen" und geben Sie document.URL an: <br><br><img src="https://habrastorage.org/webt/bp/pw/ww/bppwwwv7021ewdjqxxhaymypmzs.jpeg"><br><br>  Als Umfang der Variablen set - hit. <br><br>  <b>Ergebnis.</b>  Die folgende Folge von UTM-Tags wurde w√§hrend der gesamten Werbekampagne verwendet: utm_medium, utm_source, utm_campaign.  Bei Betrachtung der vollst√§ndigen Adresse der Seiten haben wir festgestellt, dass ein kaufm√§nnisches Und zwischen den Anzeigen utm_medium und utm_source √ºbersprungen wurde.  Da utm_source ein obligatorisches utm-Tag f√ºr jede Werbekampagne ist und Google Analytics es nach Sonderzeichen (?, &amp;) Nicht gefunden hat, wurde der Klick auf diese Anzeige im direkten Verkehr aufgezeichnet.  Dank des Parameters h_fullPage konnte das Problem erkannt und in den Einstellungen des Werbefeldes behoben werden. <br><br><h2>  Ereignisoptionen </h2><br>  Zwei weitere n√ºtzliche Parameter (ohne Beschreibung ihrer Einstellungen): <br><br><ul><li>  <b>Herausforderung.</b>  Wir markieren die Site selbst durch GTM.  Es wurde ein Fehler gefunden, der schnell behoben wurde, aber Ereignisse mit dem Fehler kommen weiterhin in GA an. <br><br>  <b>L√∂sung.</b>  Um die Ursache des Problems schnell zu finden, k√∂nnen Sie mit jedem Ereignis eine CD √ºbertragen: <br>  Der Name des Containers (falls mehrere auf der Site vorhanden sind) - die integrierte Variable GTM; <br>  Die Containerversion ist die in GTM integrierte Variable. <br>  Tag-Name - Sie m√ºssen ihn selbst konfigurieren. <br><br>  Sie k√∂nnen diese drei Parameter durch ein beliebiges Trennzeichen in einer Variablen vom Typ ‚ÄûKonstante‚Äú √ºbergeben: <br><br><img src="https://habrastorage.org/webt/2m/j4/dp/2mj4dpgyy_ierrk8-ndngyd17rk.jpeg"><br><br>  Der Umfang des Parameters wird getroffen. <br><br>  <b>Ergebnis.</b>  Bei Verwendung der konfigurierten Variablen haben wir festgestellt, dass einige Benutzer immer noch die alte Version des Containers haben, sodass weiterhin Ereignisse gesendet werden.  H√∂chstwahrscheinlich haben Benutzer die Seite einfach nicht aktualisiert oder sie wurde zwischengespeichert, sodass Sie etwas warten m√ºssen. </li><li>  <b>Herausforderung.</b>  Wir kennzeichnen die Seite durch die Entwickler.  Sie haben eine neue Anweisung eingef√ºhrt, die von uns geschrieben wurde.  Nach der √úberpr√ºfung stellte sich heraus, dass einige Ereignisse mit einem Fehler gesendet wurden. <br><blockquote>  <b>Wichtig:</b> <br><br><ul><li>  Senden Sie keine Testereignisse an die GA-Arbeitsansicht, wenn wir Ereignisse auf der Testwebsite √ºberpr√ºfen. </li><li>  Wenn wir nach dem Rollout zum Kampf festgestellt haben, dass wir falsch markierte Ereignisse √ºberpr√ºft haben / nachdem die Site aktualisiert wurde, ist etwas kaputt gegangen, ist es wichtig, das Senden von Ereignissen an die Arbeitsansicht schnell zu beenden. </li></ul><br></blockquote>  <b>L√∂sung.</b>  Wir werden Ereignisse in neue / falsch funktionierende und korrekt gekennzeichnete Ereignisse unterteilen.  Der erste kann als Test markiert werden, der zweite als Test. <br><br>  Lassen Sie dazu die Entwickler Daten zum dataLayer hinzuf√ºgen, und wir werden sie abrufen und an GA senden.  Jeder Push sieht folgenderma√üen aus: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> dataLayer.push({ </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'event'</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'{{ }}'</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'event_id'</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'{{id }}'</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'eventCategory'</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'{{ }}'</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'eventAction'</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'{{  }}'</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'eventLabel'</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'{{ }}'</span></span></span><span class="actionscript">, }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Dabei stehen in doppelten geschweiften Klammern die Namen der Variablen, in denen die Daten auf der Seite der Entwickler gespeichert sind. <br><br>  Wir m√ºssen die Variable "Nachschlagetabelle" erstellen, um Ereignisse zu trennen: <br><br><img src="https://habrastorage.org/webt/uz/ct/9j/uzct9jqlhgg1u0neld1n9zljzao.jpeg"><br><br>  {{event_id}} ist eine Variable, die die Ereigniskennung aus dem DataLayer abruft. <br><br>  Wir setzen ein H√§kchen vor "Standardwert festlegen" und in der Spalte "Standardwert" einen Schreibtest.  Daher ist diese Variable zun√§chst f√ºr alle Ereignisse gleich test.  Nachdem Sie sichergestellt haben, dass das Ereignis korrekt markiert ist, f√ºgen Sie seine event_id zur Zelle ‚ÄûInput‚Äú hinzu.  Im Feld "Ergebnis" senden wir prod. <br><br>  Also haben wir alle Ereignisse in richtig markierte und neue / falsch markierte unterteilt.  Wir empfehlen Ihnen, eine separate Ansicht in Google Analytics zu erstellen, in der nur Ereignisse mit der Produktbezeichnung angezeigt werden (dies kann √ºber den Filter "Ansichten" erfolgen). Dort werden nur korrekt markierte Ereignisse angezeigt. <br><br>  <b>Ergebnis.</b>  Da die Fehler beim Markup von Ereignissen aus den Anweisungen beseitigt wurden, haben wir den Parameterwert f√ºr diese Ereignisse in GTM von test auf prod ge√§ndert.  Dank dieses Parameters nehmen wir nur korrekt markierte Ereignisse mit dem Label prod in die Berichte auf. </li></ul><br>  Die Funktionalit√§t von benutzerdefinierten Dimensionen ist breit und nicht auf die beschriebenen Konfigurations- und Anwendungsmethoden beschr√§nkt.  F√ºr jede Art von Gesch√§ft, Analyse und Hypothese finden Sie Ihre eigene Anwendung von benutzerdefinierten Parametern. Die beschriebenen Konfigurationsmethoden erleichtern diesen Prozess. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468079/">https://habr.com/ru/post/de468079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468067/index.html">So funktioniert Alpha Compositing</a></li>
<li><a href="../de468071/index.html">Eduard Medwedew, CTO bei Tungsten Labs: ‚ÄûWir sind so weit gewachsen, dass Technologie massiven Schaden anrichten kann.‚Äú</a></li>
<li><a href="../de468073/index.html">Andrei Terekhov: "Sie k√∂nnen so viel sagen, wie Sie m√∂chten, dass Amerikaner besser sind, aber unser Auto bricht nie zusammen."</a></li>
<li><a href="../de468075/index.html">Die Verwendung von siamesischen neuronalen Netzen bei der Suche</a></li>
<li><a href="../de468077/index.html">Posit-Tests f√ºr Erwachsene. Spektralanalyse</a></li>
<li><a href="../de468081/index.html">"Anonyme Daten" oder was in 152-FZ geplant ist</a></li>
<li><a href="../de468083/index.html">Android Camera2 API aus dem Wasserkocher</a></li>
<li><a href="../de468085/index.html">Das Buch "Safe DevOps. Effizienter Systembetrieb</a></li>
<li><a href="../de468087/index.html">Bisektionale Teilungsmethode beim Testen</a></li>
<li><a href="../de468089/index.html">Edition-basierte Neudefinition: Ist das in der Produktion m√∂glich?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>