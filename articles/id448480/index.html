<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§š ğŸ‘©ğŸ¼â€ğŸ¨ ğŸ–ğŸ» Pengguna di Docker â˜¹ï¸ ğŸ‘©â€âš•ï¸ ğŸ¤›ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Andrey Kopylov , direktur teknis kami, mencintai, secara aktif menggunakan dan mempromosikan Docker. Dalam artikel baru, ia berbicara tentang cara mem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengguna di Docker</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448480/"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Andrey Kopylov</a> , direktur teknis kami, mencintai, secara aktif menggunakan dan mempromosikan Docker.  Dalam artikel baru, ia berbicara tentang cara membuat pengguna di Docker.  Benar bekerja dengan mereka, mengapa pengguna tidak dapat dibiarkan dengan hak akses root dan bagaimana menyelesaikan masalah ketidakcocokan pengidentifikasi di Dockerfile. </p><a name="habracut"></a><br><p>  Semua proses dalam wadah akan berjalan sebagai root, kecuali ditentukan secara khusus.  Tampaknya sangat nyaman, karena pengguna ini tidak memiliki batasan.  Itulah sebabnya bekerja di bawah root salah dari sudut pandang keamanan.  Jika pada komputer lokal tidak ada orang waras yang bekerja dengan hak root, maka banyak yang memulai proses di bawah root dalam wadah. </p><br><p>  Selalu ada bug yang memungkinkan malware keluar dari wadah dan sampai ke komputer host.  Dengan asumsi yang terburuk, kita harus memastikan bahwa proses dimulai di dalam wadah dari pengguna yang tidak memiliki hak apa pun pada mesin host. </p><br><h2>  Pembuatan Pengguna </h2><br><p>  Membuat pengguna di sebuah wadah tidak berbeda dengan membuatnya di distribusi Linux.  Namun, untuk gambar dasar yang berbeda, tim dapat bervariasi. </p><br><p>  Untuk distribusi berbasis debian di Dockerfile, Anda harus menambahkan: </p><br><br><pre><code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">RUN</span></span> groupadd --gid <span class="hljs-number"><span class="hljs-number">2000</span></span> node \ &amp;&amp; useradd --uid <span class="hljs-number"><span class="hljs-number">2000</span></span> --gid node --shell /bin/bash --create-home node</code> </pre> <br><p>  Untuk alpine: </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">RUN</span></span> addgroup -g <span class="hljs-number"><span class="hljs-number">2000</span></span> node \ &amp;&amp; adduser -u <span class="hljs-number"><span class="hljs-number">2000</span></span> -G node -s /bin/sh -D node</code> </pre><br><h2>  Mulai proses dari pengguna </h2><br><p>  Untuk memulai semua proses selanjutnya dari pengguna dengan UID 2000, jalankan: </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">USER</span></span> <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre> <br><p>  Untuk memulai semua proses selanjutnya dari simpul pengguna, jalankan: </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">USER</span></span> node</code> </pre> <br><p>  Lebih detail dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> . </p><br><h2>  Mount volume </h2><br><p>  Saat memasang volume di dalam wadah, berikan pengguna kemampuan untuk membaca dan / atau menulis file.  Untuk ini, UID (GID) dari pengguna dalam wadah dan pengguna di luar wadah yang memiliki hak akses yang sesuai untuk file harus sesuai.  Dalam hal ini, nama pengguna tidak masalah. </p><br><p>  Seringkali pada komputer Linux, pengguna UID dan GID adalah 1000. Pengidentifikasi ini ditugaskan untuk pengguna komputer pertama. </p><br><p>  Mendapatkan pengenal Anda mudah: </p><br><pre> <code class="nginx hljs">id</code> </pre> <br><p>  Anda akan menerima informasi lengkap tentang pengguna Anda. <br>  Ganti 2000 contoh dengan pengenal Anda dan semuanya akan baik-baik saja. </p><br><h2>  Tetapkan UID dan GID Pengguna </h2><br><p>  Jika pengguna dibuat sebelumnya, tetapi perlu untuk mengubah pengidentifikasi, maka Anda dapat melakukannya seperti ini: </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">RUN</span></span> usermod -u <span class="hljs-number"><span class="hljs-number">1000</span></span> node \ &amp;&amp; groupmod -g <span class="hljs-number"><span class="hljs-number">1000</span></span> node</code> </pre><br><p>  Jika Anda menggunakan gambar alpine dasar, Anda harus menginstal paket bayangan: </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">RUN</span></span> apk add â€”<span class="hljs-literal"><span class="hljs-literal">no</span></span>-cache shadow</code> </pre> <br><h2>  Melewati ID pengguna di dalam wadah saat membuat gambar </h2><br><p>  Jika pengidentifikasi Anda dan pengidentifikasi semua orang yang bekerja di proyek adalah sama, maka cukup tentukan pengidentifikasi ini di Dockerfile.  Namun, seringkali pengidentifikasi pengguna tidak cocok. </p><br><p>  Cara mewujudkan yang diinginkan tidak segera jelas.  Bagi saya itu yang paling sulit dalam proses menguasai buruh pelabuhan.  Banyak pengguna buruh pelabuhan tidak berpikir bahwa ada tahapan yang berbeda dalam kehidupan suatu gambar.  Pertama, gambar dikumpulkan untuk ini menggunakan Dockerfile.  Saat memulai sebuah wadah dari gambar Dockerfile, itu tidak lagi digunakan. </p><br><p>  Penciptaan pengguna harus terjadi saat membangun gambar.  Hal yang sama berlaku untuk definisi pengguna dari mana proses diluncurkan.  Ini berarti bahwa kita harus mengoper UID (GID) entah bagaimana ke dalam wadah. </p><br><p>  Arahan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ENV</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ARG</a> digunakan untuk menggunakan variabel eksternal di Dockerfile.  Perbandingan rinci arahan ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </p><br><p>  Dockerfile </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">ARG</span></span> UID=<span class="hljs-number"><span class="hljs-number">1000</span></span> ARG GID=<span class="hljs-number"><span class="hljs-number">1000</span></span> ENV UID=<span class="hljs-variable"><span class="hljs-variable">${UID}</span></span> ENV GID=<span class="hljs-variable"><span class="hljs-variable">${GID}</span></span> RUN usermod -u <span class="hljs-variable"><span class="hljs-variable">$UID</span></span> node \ &amp;&amp; groupmod -g <span class="hljs-variable"><span class="hljs-variable">$GID</span></span> node</code> </pre><br><p>  Anda dapat memberikan argumen melalui komposisi buruh pelabuhan seperti ini: </p><br><p>  buruh pelabuhan-menulis </p><br><pre> <code class="nginx hljs">build: context: ./src/<span class="hljs-attribute"><span class="hljs-attribute">backend</span></span> args: UID: <span class="hljs-number"><span class="hljs-number">1000</span></span> GID: <span class="hljs-number"><span class="hljs-number">1000</span></span></code> </pre><br><p>  PS Untuk menguasai semua trik buruh pelabuhan, tidak cukup membaca dokumentasi atau artikel.  Anda perlu banyak berlatih, Anda perlu merasakan buruh pelabuhan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448480/">https://habr.com/ru/post/id448480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448470/index.html">Pemasaran Konten di AS, Amerika Latin dan Asia: Kiat, Tautan dan Alat yang Berguna untuk Promosi Anggaran</a></li>
<li><a href="../id448472/index.html">Bagaimana PROCESS_DUP_HANDLE berubah menjadi PROCESS_ALL_ACCESS</a></li>
<li><a href="../id448474/index.html">Kami mencari kebocoran memori dalam aplikasi Python</a></li>
<li><a href="../id448476/index.html">Perpanjang Fungsi WDS: Tambahkan Kemampuan Unduhan ke UEFI</a></li>
<li><a href="../id448478/index.html">Misi Lunar "Bereshit" - penyebab awal kecelakaan diumumkan</a></li>
<li><a href="../id448482/index.html">Pengujian pabrik terhadap pusat data modular</a></li>
<li><a href="../id448484/index.html">Root mikroba</a></li>
<li><a href="../id448486/index.html">"Pada November 2018, kami keliru jatuh ke dalam spam di semua lini." Bagaimana saya menyimpan surat dari perusahaan dengan basis juta</a></li>
<li><a href="../id448488/index.html">Ketakutan dan Membenci DevSecOps</a></li>
<li><a href="../id448490/index.html">Cara memulai transformasi DevOps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>