<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÖ üíù ü•ë Jet frontend. A hist√≥ria de como reescrevemos tudo novamente üì† üå°Ô∏è üòè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√°, aqui √© a Katya da Yandex.Money novamente. Continuo minha hist√≥ria sobre como parei de fazer as pazes e comecei a viver. Na primeira parte, contei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jet frontend. A hist√≥ria de como reescrevemos tudo novamente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/414183/">  Ol√°, aqui √© a Katya da Yandex.Money novamente.  Continuo minha hist√≥ria sobre como parei de fazer as pazes e comecei a viver.  Na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">primeira</a> parte, contei como cheguei aqui e o que nossos desenvolvedores front-end fazem.  Hoje - sobre a pilha da frente, de onde √© o React e para onde foi o BEM. <br><br>  Spoiler: O BEM n√£o foi a lugar algum ¬Ø \ _ („ÉÑ) _ / ¬Ø.  Vamos l√°! <br><br><img src="https://habrastorage.org/webt/en/f4/oz/enf4ozorjurjqvgcr5nozsfcmfi.jpeg"><br><br>  Aten√ß√£o: alta concentra√ß√£o de front-end.  Muito texto, fotos e c√≥digo, como prometido. <br><a name="habracut"></a><br><h1>  Parte 2. Sobre tecnologia </h1><br>  At√© 2016. Tentando escrever em React, o resultado √© bastante toler√°vel.  Ainda n√£o suspeito que em um ano transferirei servi√ßos inteiros para o React.  2017 come√ßa com o Yandex. Dinheiro, eu tenho um BEM do c√©rebro e ainda n√£o suspeito. <br><br><h1>  Backend no Node.js, minha primeira vez </h1><br>  Para se familiarizar com o projeto, um novo desenvolvedor recebe uma tarefa de teste.  Eu tive sorte: eu tive essa tarefa do backlog.  E no primeiro dia encontrei o Node.js. <br><br>  O front-end no Yandex.Money √© respons√°vel n√£o apenas pelo lado do cliente, mas tamb√©m pela camada do servidor como um aplicativo Node.js.  A tarefa do aplicativo √© orquestrar dados do back-end Java para prepara√ß√£o em um formato orientado √† exibi√ß√£o, bem como renderiza√ß√£o e roteamento do servidor.  Voc√™ teria dito isso h√° alguns anos atr√°s, eu n√£o teria entendido nada e tudo √© muito simples: quando uma solicita√ß√£o √© enviada do navegador para o servidor, o Node.js gera solicita√ß√µes HTTP para o back-end, recebe os dados e as p√°ginas de modelos necess√°rias.  Usamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Express</a> como a estrutura do servidor e, para desenvolver aplicativos internos sem um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link</a> herdado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,</a> decidimos usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Koa2</a> .  Os desenvolvedores adoraram o design da estrutura e decidimos n√£o fazer o downgrade para o Express, ent√£o o Koa2 permaneceu na pilha.  Mas n√£o lan√ßamos o c√≥digo Koa2 para usu√°rios externos: a estrutura n√£o possui suporte suficiente, mas existem vulnerabilidades abertas. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">J√° escrevemos</a> sobre o lugar do Node.js em nosso front-end, mas desde ent√£o algo mudou.  O Node.js 8 tornou-se LTS e j√° est√° sendo executado em nossos servidores de produ√ß√£o.  Tamb√©m queremos abandonar os servidores Nginx, que criamos em cada host para distribuir estat√≠sticas - eles ser√£o substitu√≠dos por servidores separados pelo Nginx e pela CDN algum dia. <br><br>  Para separar o c√≥digo entre os projetos, mas n√£o para torn√°-lo dispon√≠vel ao p√∫blico, usamos todo um conjunto de ferramentas: armazene os m√≥dulos no Bitbucket e colete-os no Jenkins.  Tamb√©m usamos o registro local de pacotes e, gra√ßas a isso, n√£o vamos √† rede externa - isso acelera a montagem e aumenta a seguran√ßa de todo o sistema.  Essa abordagem nos foi sugerida pelos javistas, eles s√£o legais.  Ame seus backenders;) <br><br>  Tamb√©m conduzimos um experimento - introduzimos um gerenciador de processos em um dos aplicativos, o que simplificou a administra√ß√£o de servi√ßos no Node.js.  Ele ajudou no cluster e tamb√©m nos salvou de um script bash antigo que executava aplicativos. <br><br><h1>  E toda a pilha n√£o √© suficiente </h1><br>  Temos javascript em todos os lugares no frontend.  E no servidor, e no cliente, e sob o cap√¥ de ferramentas internas.  Conhecemos outras l√≠nguas, mas o javascript faz um √≥timo trabalho. <br><br>  Mas o BEM, no √¢mbito de nossas tarefas, n√£o lida com tudo. <br><br><div class="spoiler">  <b class="spoiler_title">O que √© o BEM?</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O BEM</a> √© uma abordagem de desenvolvimento da Web inventada pelo Yandex durante a vida √∫til de p√°ginas HTML est√°ticas e cascatas CSS.  Ainda n√£o havia uma abordagem componente e era necess√°rio manter a uniformidade de muitos servi√ßos.  O Yandex n√£o ficou surpreso e desenvolveu sua pr√≥pria abordagem de componentes, que hoje permite criar componentes isolados e escrever c√≥digo declarativo flex√≠vel. <br><br>  O BEM n√£o √© apenas uma metodologia, mas tamb√©m um grande conjunto de tecnologias e bibliotecas.  Alguns deles s√£o adaptados √†s especificidades do BEM, e alguns podem muito bem ser usados ‚Äã‚Äãisoladamente da arquitetura do BEM.  Se voc√™ precisar de um poderoso mecanismo de modelo ou um exemplo digno de abstra√ß√£o de componente sobre o DOM em seu projeto, voc√™ sabe onde encontr√°-los;) <br></div></div><br>  Portanto, come√ßamos a transferir servi√ßos para o React.  Alguns deles j√° vivem em dois aplicativos criados em pilhas diferentes: <br><br>  - uma plataforma espec√≠fica para o Yandex BEM; <br>  - Reagir ecossistema jovem e elegante. <br><br><h1>  Yandex Technologies </h1><br>  √â hora de lhe dizer por que me apaixonei pelo BEM. <br><br><h2>  N√≠veis de redefini√ß√£o </h2><br>  N√≠veis, n√≠veis, n√≠veis ... BEM!  Lucro! <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os n√≠veis superiores</a> s√£o uma das principais caracter√≠sticas da metodologia BEM.  Para entender como eles funcionam, veja a figura: <br><img src="https://habrastorage.org/webt/qs/a5/yd/qsa5yducqqeejyft1ymikcjhaxy.gif"><br><br>  A imagem √© formada sobrepondo camadas.  Cada camada altera a imagem final, mas n√£o altera as outras camadas.  A camada pode ser facilmente puxada ou adicionada e a imagem muda. <br>  Os n√≠veis de substitui√ß√£o fazem o mesmo com o c√≥digo: <br><img src="https://habrastorage.org/webt/yt/x3/gt/ytx3gt_yik0xil0lw281v6xmjhy.gif"><br><br>  O comportamento do componente √© formado durante a montagem do c√≥digo.  Para adicionar um comportamento adicional, basta conectar o n√≠vel desejado √† montagem.  O c√≥digo do m√≥dulo de diferentes n√≠veis, como se estivessem em camadas uns sobre os outros.  Nesse caso, o c√≥digo fonte n√£o muda, mas temos um comportamento diferente, combinando n√≠veis diferentes. <br><br><div class="spoiler">  <b class="spoiler_title">Quais s√£o os n√≠veis</b> <div class="spoiler_text">  A imagem acima mostra v√°rios n√≠veis de redefini√ß√£o: <br><ul><li>  O n√≠vel b√°sico - a biblioteca - fornece o m√≥dulo de c√≥digo-fonte; <br></li><li>  O pr√≥ximo n√≠vel - o projeto - modifica este m√≥dulo para as necessidades do projeto; <br></li><li>  Um n√≠vel superior - plataforma - torna o mesmo m√≥dulo espec√≠fico para diferentes dispositivos; <br></li><li>  A cereja no bolo - o n√≠vel das experi√™ncias - altera o m√≥dulo para o teste A / B. <br></li></ul><br><br>  O n√≠vel do projeto √© independente do n√≠vel da biblioteca, portanto, √© f√°cil atualizar a biblioteca.  O n√≠vel da plataforma permite que voc√™ use uma montagem diferente para diferentes dispositivos.  E o n√≠vel do experimento √© conectado para testes em usu√°rios e tamb√©m √© desativado facilmente quando os resultados s√£o obtidos. <br><br>  O pr√≥prio desenvolvedor decide quais n√≠veis ele precisa: voc√™ pode criar um n√≠vel com um tema ou um n√≠vel com o mesmo c√≥digo em uma estrutura diferente. <br></div></div><br>  Os n√≠veis permitem escrever m√≥dulos complexos baseados em simples, combinar facilmente o comportamento e atrapalhar o mesmo c√≥digo entre os servi√ßos.  E esse c√≥digo √© coletado pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ENB</a> - Webpack no mundo BEM. <br><br>  Quando me familiarizei com o BEM, fiquei especialmente satisfeito com as bibliotecas da interface do usu√°rio nas quais os componentes prontos est√£o.  Estamos expandindo esses componentes dentro da estrutura de novas bibliotecas e os compartilhando entre projetos.  Isso facilita a vida: raramente fa√ßo maquiagem, n√£o escrevo o mesmo tipo de JS e montei rapidamente interfaces a partir de blocos prontos. <br><br><img src="https://habrastorage.org/webt/wq/rg/gp/wqrggp5qnt1zkunnz73xagsgjpk.png"><br><br>  Agora, examinaremos mais de perto as ferramentas da plataforma BEM para entender o que o BEM n√£o faz bem o suficiente e por que n√£o se adequou √†s nossas tarefas. <br><br><h2>  BEM-XJST </h2><br>  Come√ßarei com meu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mecanismo de</a> modelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bem-xjst</a> favorito.  Antes do Yandex.Money, eu usava Jade, e Bem-xjst ilustrava perfeitamente os pontos negativos de Jade, que eu n√£o via na √©poca.  Os modelos bem-xjst s√£o declarativos [1], n√£o possuem o inferno [2] e atendem perfeitamente aos requisitos da abordagem de componentes [3].  Tudo isso √© visto claramente no exemplo: <br><br><img src="https://habrastorage.org/webt/d_/hh/bz/d_hhbzkdjx9uj-fpr9olmhe8xty.png"><br><br>  Na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">caixa de areia,</a> voc√™ pode ver o resultado do modelo e brincar com ele. <br><br><div class="spoiler">  <b class="spoiler_title">Como isso funciona?</b>  <b class="spoiler_title">Dentro √© o segredo da arquitetura perfeita;)</b> <div class="spoiler_text"><ul><li>  escreva BEMJSON.  BEMJSON √© um JSON que descreve uma √°rvore BEM.  Uma √°rvore BEM √© uma representa√ß√£o da √°rvore DOM como componentes independentes; <br></li><li>  O bem-xjst aceita BEMJSON como entrada e aplica padr√µes.  Esse processo pode ser comparado √† renderiza√ß√£o em um navegador.  O navegador ignora a √°rvore do DOM e aplica gradualmente regras CSS aos seus n√≥s do DOM: tamanho, cor do texto, recuo.  O Bem-xjst tamb√©m ignora o BEMJSON, procura por modelos correspondentes aos seus n√≥s e os aplica gradualmente: tag, atributos, conte√∫do.  "Aplicar um modelo" significa gerar uma string HTML a partir dele.  A gera√ß√£o de HTML do BEMJSON √© manipulada por um dos mecanismos de modelo - BEMHTML. <br></li></ul><br><br>  Escrever modelos √© simples: selecione a entidade e escreva as fun√ß√µes que o mecanismo de modelos chamar√° para renderizar partes da string HTML.  O mais dif√≠cil √© destacar a ess√™ncia.  Entidades corretas s√£o a chave para uma boa arquitetura! <br><br>  Quanto mais longa a barba, maior a chance de voc√™ j√° ter notado uma refer√™ncia no nome do modelo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">XSLT</a> (eXtensible Stylesheet Language Transformations) =&gt; XJST (eXtensible JavaScript Transformations).  Ele usa os princ√≠pios do XSLT e, portanto, √© t√£o declarativo.  Se voc√™ n√£o sabe o que √© XSLT, considere-se com sorte :) <br></div></div><br>  Bem-xjst √© isom√≥rfico.  N√≥s renderizamos p√°ginas HTML no servidor e as alteramos dinamicamente no cliente.  Para modelagem em tempo de execu√ß√£o, o bem-xjst fornece uma API que usamos ao escrever o c√≥digo javascript do lado do cliente. <br><br><h2>  Eu-bem </h2><br>  Com o bem-xjst, descrevemos a vis√£o e a l√≥gica com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">i-bem</a> .  I-bem √© uma abstra√ß√£o sobre o DOM que fornece uma API de alto n√≠vel para trabalhar com componentes.  Simplificando, vamos escrever o seguinte: <br><br><img src="https://habrastorage.org/webt/nb/mv/en/nbmvenurba_qz14drptqcrp_wmc.png"><br><br>  em vez disso: <br><br><img src="https://habrastorage.org/webt/ev/2e/5g/ev2e5ggz8xgrzwhc6pfsqrjowiq.png"><br><br>  Para escrever c√≥digo, voc√™ n√£o precisa saber sobre a implementa√ß√£o interna do componente.  Operamos com entidades que descrevemos no modelo: de qualquer maneira, ser√° um seletor jQuery ou um elemento DOM.  Podemos criar eventos personalizados adequados para um modelo de objeto espec√≠fico e trabalhar com eventos e interfaces nativos ficar√° oculto na implementa√ß√£o interna.  A l√≥gica de baixo n√≠vel tamb√©m √© descrita aqui, o que significa que n√£o carregamos o c√≥digo com a l√≥gica principal com verifica√ß√µes desnecess√°rias.  Como resultado, o c√≥digo √© f√°cil de ler e n√£o depende de uma tecnologia espec√≠fica. <br><br>  I-bem permite que voc√™ descreva a l√≥gica do componente como um conjunto de estados [1].  Este √© um javascript declarativo.  O I-bem implementa seu pr√≥prio emissor de eventos: quando os estados mudam, os componentes geram automaticamente eventos aos quais outro componente pode se inscrever [2]. <br><br>  √â assim que a maioria do c√≥digo javascript do lado do cliente BEM se parece: <br><br><img src="https://habrastorage.org/webt/fm/_j/bl/fm_jbln_7fjprukofbrmlj_ycrq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Como isso funciona</b> <div class="spoiler_text"><ul><li>  pelo evento domReady i-bem, ele encontra componentes (blocos) na √°rvore DOM e os inicializa - cria um objeto js na mem√≥ria do navegador que corresponde ao bloco; <br></li><li>  ap√≥s a ocorr√™ncia dos eventos necess√°rios, definimos os marcadores de bloco que refletem o estado.  O papel dos marcadores √© desempenhado pelas classes CSS.  Por exemplo, quando clicamos na entrada, adicionamos a ela a classe ‚Äúinput_focused‚Äù, que serve como marcador; <br></li><li>  Ao definir esses marcadores, o i-bem inicia os retornos de chamada especificados na implementa√ß√£o javascript do bloco. <br></li></ul><br>  A l√≥gica de escrita √© simples: voc√™ precisa descrever os poss√≠veis estados do bloco (os mesmos marcadores) e definir manipuladores para alterar esses estados (os mesmos retornos de chamada). <br></div></div><br>  Com o i-bem, podemos redefinir facilmente o comportamento dos componentes, criar uma API bem formada para a intera√ß√£o deles e alter√°-los dinamicamente em tempo de execu√ß√£o.  Ent√£o o que est√° faltando? <br>  Adoramos o BEM pela declaratividade, f√°cil escalabilidade e abstra√ß√µes de alto n√≠vel, mas n√£o estamos mais prontos para suportar suas limita√ß√µes.  Abaixo, consideraremos o problema de renderiza√ß√£o do cliente, armazenamento de dados e outras limita√ß√µes da plataforma BEM.  Com o tempo, esses problemas podem ser resolvidos pelos colaboradores do BEM, mas n√£o estamos prontos para esperar. <br><br>  Web moderna com SPA e adaptabilidade para dispositivos m√≥veis tamb√©m requerem adaptabilidade de n√≥s.  Portanto, decidimos mudar para nossa pr√≥pria pilha.  E eles escolheram Reagir. <br><br><h1>  Nova pilha React Maple </h1><br>  Reagir trouxe para nossas vidas um DOM virtual, recarga quente, CSS em JS e uma grande comunidade da qual nos tornamos parte. <br><br>  A migra√ß√£o de nossos servi√ßos para o React est√° em pleno andamento, alguns aplicativos j√° foram total ou parcialmente reescritos para o React.  Conhecemos novas abordagens e ferramentas e melhoramos a arquitetura de nossos aplicativos. <br><br><h2>  Bibliotecas </h2><br>  O particionamento de entidades da interface em blocos BEM independentes √© muito amig√°vel com a abordagem do componente React.  Os desenvolvedores do Yandex escreveram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bem-react-core</a> e transferiram a biblioteca de interface do usu√°rio do componente base para o React.  Escrevemos uma biblioteca de adaptadores que leva em conta as especificidades desses componentes e as fornece como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HOC</a> : <br><br><img src="https://habrastorage.org/webt/2y/yg/26/2yyg26edgfevpttq3qpgl8s-alg.png"><br><br>  Essas bibliotecas est√£o conectadas n√£o no aplicativo, mas na biblioteca principal do componente: <br><br><img src="https://habrastorage.org/webt/wc/xh/h9/wcxhh9dhwnp-qmd30tnrazsjlko.png"><br><br>  O aplicativo depende apenas da biblioteca principal e obt√©m todos os componentes: <br><br><img src="https://habrastorage.org/webt/ub/rs/4-/ubrs4-p8-pedgu7lqrqvx81-vlu.png"><br><br>  Isso reduz o n√∫mero de depend√™ncias de aplicativos e as bibliotecas n√£o entram no pacote configur√°vel duas vezes em vers√µes diferentes. <br><br><h2>  Tecnologia </h2><br>  O React n√£o est√° vinculado a tecnologias espec√≠ficas e n√≥s escolhemos ferramentas e bibliotecas.  Existem axios, redux, redux form, redux thunk, componentes estilizados, TypeScript, flow, gracejo e outras coisas legais no meu armamento.  Para evitar o zool√≥gico, coordenamos o uso de novas tecnologias com outros desenvolvedores - enviamos uma solicita√ß√£o de recebimento a um reposit√≥rio especial com uma an√°lise de qu√£o √∫til √© a tecnologia e por que ela foi escolhida. <br><br><h2>  O front-end entra no bar e o barman diz a ele </h2><br>  Para aplicativos no React, estamos criando uma plataforma que reunir√° bibliotecas e processos para criar e dar suporte a eles.  O cora√ß√£o desta plataforma √© o utilit√°rio do console Frontend Bar.  Bar pode cozinhar muitos peda√ßos deliciosos. <br><br>  No menu: <br><br><ol><li>  Configurar com ice: bar mistura e sacode suas vari√°veis ‚Äã‚Äãyml e prepara um modelo de configura√ß√£o para ansible. <br></li><li>  Suco com o aroma dos configuradores: bar criar√° uma nova aplica√ß√£o baseada em um espa√ßo em branco modular - Suco. <br></li><li>  Conjunto de configura√ß√µes b√°sicas da biblioteca.  Em breve. <br></li></ol><br>  Agora, √© f√°cil criar um aplicativo interessante - o frontend-bar faz suco.  Fa√ßa suco, n√£o guerra!  Quando o Bar implementa um novo aplicativo, ele executa um conjunto de configura√ß√µes do Juice: package.json, .babelrc √© gerado, middleware chave e c√≥digo de rotas, c√≥digo do componente raiz.  O Frontend Bar facilitar√° a aloca√ß√£o de novos microsservi√ßos e ajudar√° a cumprir regras uniformes para escrever c√≥digo. <br><br>  Ao mudar para uma nova pilha, come√ßamos a melhorar a arquitetura de aplicativos do servidor - escrevemos um novo criador de logs para o cliente e uma biblioteca com um conjunto de abstra√ß√µes para implementar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MVC</a> .  Hoje decidimos qual ser√° a nova arquitetura de servidor. <br><br><img src="https://habrastorage.org/webt/qd/wb/ib/qdwbib4ee20flundgjx-3d1m4q0.png"><br><br>  Spoiler: escolha cebola. <br><br><h1>  O que aconteceu e ficou melhor?  Vamos entender </h1><br><h2>  Interfaces din√¢micas </h2><br><h4>  Was </h4><br>  Eu escrevi acima que o bem-xjst fornece uma API para modelagem em tempo de execu√ß√£o.  O I-bem, por sua vez, pode trabalhar com a √°rvore DOM.  N√≥s os tornaremos amigos e poderemos gerar e modificar dinamicamente HTML.  Vamos tentar mudar o bot√£o por evento: <br><br><img src="https://habrastorage.org/webt/bg/9b/4d/bg9b4d3tz7svwiifnivmacarf38.png"><br><img src="https://habrastorage.org/webt/bo/y5/1e/boy51ea8-l77moeaa4ogstifwz8.png"><br><br>  Neste exemplo, o lado fraco do BEM √© vis√≠vel: o i-bem n√£o quer ser amigo de bem-xjst e n√£o quer saber nada sobre modelos.  Ele adiciona uma classe ao bloco, mas n√£o aplica o modelo [1].  Re-renderizamos o componente manualmente [2]: <br><br><ul><li>  descrever um novo peda√ßo da √°rvore BEM [3]; </li><li>  em seguida, aplique um novo modelo [4]; </li><li>  e inicialize outro componente no n√≥ DOM atual [5]. </li></ul><br>  Al√©m disso, o i-bem n√£o cria diff de √°rvores BEM; portanto, todo o componente √© renderizado, n√£o as partes que foram alteradas.  Considere um exemplo simples: renderize novamente o conte√∫do de uma janela modal sob demanda.  √â composto por tr√™s elementos: <br><br><img src="https://habrastorage.org/webt/47/zo/it/47zoit3kwi5fq9idjqxluxuube0.png"><br><br>  Para simplificar, assumimos que apenas um elemento pode mudar. <br><br><img src="https://habrastorage.org/webt/fe/kv/cf/fekvcf9j8mxnenc8v01lj29rgjm.png"><br><br>  Eu quero fazer [1] e relaxar.  Mas o i-bem n√£o entender√° o que mudou, renderiza completamente todo o componente e tamb√©m relaxa.  Neste exemplo, n√£o haver√° conseq√º√™ncias s√©rias, mas e se todos os formul√°rios forem renderizados incorretamente dessa maneira?  Isso piora o desempenho e causa efeitos colaterais desagrad√°veis: em algum lugar a entrada pisca, a dica de ferramenta sem dono fica em algum lugar.  Por isso, ficamos tristes e controlamos manualmente as partes dos componentes para criar um renderizador de pontos [2].  Isso complica o desenvolvimento, e novamente estamos tristes. <br><br><h4>  Tornou-se </h4><br>  Reagir veio e arruinou tudo.  Ele pr√≥prio monitora o estado dos componentes, n√£o gerenciamos mais a renderiza√ß√£o manual e n√£o pensamos em interagir com o DOM.  React cont√©m uma implementa√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">virtual do DOM</a> .  Chamar React.createElement cria um objeto js do n√≥ DOM com suas propriedades e descendentes - o DOM virtual desse componente, armazenado dentro do React.  Quando um componente √© alterado, o React calcula o novo DOM virtual e, em seguida, o diff do novo e salvo, al√©m de atualizar apenas a parte do DOM que foi alterada.  Tudo voa, e s√≥ podemos otimizar l√≥gica complexa usando shouldComponentUpdate.  √â um sucesso! <br><br><h2>  Armazenamento de dados </h2><br><h4>  Was </h4><br>  No BEM, preparamos todos os dados no servidor e os transferimos para os componentes da p√°gina: <br><br><img src="https://habrastorage.org/webt/2b/c5/kj/2bc5kjxp0jasbh4l3q4ympbiuki.png"><br><br>  Os componentes s√£o isolados e n√£o compartilham dados entre si, o que significa que os mesmos dados dever√£o ser lan√ßados em diferentes componentes [1].  N√£o poderemos obt√™-los no cliente; portanto, cada componente aceita antecipadamente um conjunto de dados necess√°rios para todos os cen√°rios poss√≠veis de sua opera√ß√£o.  Isso significa que carregamos o componente com dados que podem n√£o ser necess√°rios [2]. <br><br>  √Äs vezes, uma entidade global nos resgata, na qual parte dos dados comuns √© armazenada, mas o armazenamento global de vari√°veis ‚Äã‚Äãn√£o se encaixa bem no conceito BEM.  Portanto, escrevemos um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bem-redux</a> que adapta o Redux ao BEM.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Redux</a> √© um gerente de estado que gerencia o fluxo de dados.  Ele gerencia perfeitamente nossos dados em interfaces simples, mas ao desenvolver um componente complexo, encontramos o problema de renderiza√ß√£o que descrevi acima.  Redux n√£o √© amig√°vel com o i-bem, corrigimos bugs e estamos tristes. <br><br><h4>  Tornou-se </h4><br>  <i>Redux + React = &lt;3</i> <br>  O Redux armazena dados para todo o aplicativo em um √∫nico local [1]: <br><br><img src="https://habrastorage.org/webt/xv/k8/if/xvk8ifh8_9faxrwnmoeddps_wtm.png"><br><br>  O componente em si decide quando e de quais dados ele precisa [2]: <br><br><img src="https://habrastorage.org/webt/wj/5j/l_/wj5jl_ffgk5f-7ql1mhno59hnd0.png"><br><br>  Precisamos apenas descrever os cen√°rios do componente [3] e indicar onde obter os dados para sua execu√ß√£o [4]: <br><br><img src="https://habrastorage.org/webt/jx/jh/kl/jxjhklr4appyvnlmv9r23jde3x0.png"><br><br>  E o React far√° o resto [5]: <br><br><img src="https://habrastorage.org/webt/zw/2t/iu/zw2tiux44khisns5fuem8ny7av8.png"><br><br>  Essa abordagem permite que voc√™ siga o princ√≠pio da responsabilidade √∫nica e encapsule a l√≥gica do componente no pr√≥prio componente, em vez de espalh√°-lo no c√≥digo da p√°gina.  √â um sucesso! <br><br><h2>  Voc√™ tem que pagar por tudo </h2><br>  Para ter sucesso, pagamos uma grande quantidade de legado no React.  √â doloroso ver como seu c√≥digo, escrito apenas alguns meses atr√°s, se transforma em obsoleto. <br><br>  O fato √© que o React √© uma biblioteca de camadas de exibi√ß√£o, n√£o uma estrutura completa.  Voc√™ pode selecionar todas as ferramentas, mas <i>precisar√°</i> selecionar todas as ferramentas.  E tamb√©m para organizar voc√™ mesmo o c√≥digo, formular abordagens para resolver problemas t√≠picos, desenvolver um conjunto de acordos e escrever os plugins ausentes.  Escrevemos nossos pr√≥prios validadores para formul√°rios redux e ainda n√£o aprendemos a trabalhar com anima√ß√µes complexas.  E tentamos jogar fora, escrever e reescrever.  E n√£o estamos reescrevendo sempre, e √© por isso que nossa carteira de pedidos est√° crescendo. <br><br>  O React √© jovem o suficiente e n√£o est√° pronto para o desenvolvimento da empresa, diferentemente do BEM.  E enquanto aprend√≠amos a cozinh√°-lo, estragamos toda a cozinha e n√≥s mesmos bagun√ßamos at√© o cotovelo.  E ainda estamos debatendo se precisamos de fluxo ou n√£o, e ainda n√£o entendemos completamente o que armazenar na loja e o que est√° na loja local.  Escrevemos conforme necess√°rio e vamos a confer√™ncias para descobrir como.  Vencemos os cones, mas avan√ßamos com confian√ßa. <br><br><h1>  P√£ezinhos inesperados </h1><br>  A nova pilha nos permitiu dar uma nova olhada em v√°rias tarefas e forneceu maneiras simples de resolv√™-las. <br><br><h2>  CSS em JS </h2><br><h4>  Was </h4><br>  Considere um caso simples da vida: colorir e animar um √≠cone por um evento, algo como isto: <br><br><img src="https://habrastorage.org/webt/vf/py/hx/vfpyhxhdazg6fjxqoehf7rrxatk.png"><br><br>  O c√≥digo n√£o √© nada: <br><br><img src="https://habrastorage.org/webt/ep/8c/ft/ep8cfthhe8trsxv3hes_vnblydu.png"><br><br>  √â verdade que, de acordo com as regras do BEM, voc√™ ter√° que distribu√≠-lo j√° em tr√™s diret√≥rios: <br><br><img src="https://habrastorage.org/webt/5y/7g/vg/5y7gvgsg4rg--bdw4ksuqymoyuq.png"><br><br>  Sobrecarga?  Um ponto discut√≠vel.  Mais importante, em js, adicionamos essas classes manualmente quando os eventos necess√°rios ocorrem.  A situa√ß√£o usual, mas quanto mais personalizada ou complexa a interface, mais frequentemente voc√™ precisar√° adicionar e remover classes.  E se voc√™ precisar alterar n√£o apenas o √≠cone, mas tamb√©m o texto?  N√£o √© exatamente a l√≥gica que voc√™ deseja ver no c√≥digo js: <br><br><img src="https://habrastorage.org/webt/ft/u9/bn/ftu9bn7g6ghzbepl6gomyezebyy.png"><br><br>  Mas e se a dura√ß√£o da anima√ß√£o depender de algo e for definida dinamicamente?  Em seguida, reescreveremos a anima√ß√£o CSS no jQuery e ficaremos um pouco tristes. <br><br><h4>  Tornou-se </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Componentes estilizados</a> , eu te amo!  CSS em JS - um amor!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meu compositor interno se alegra: A </font></font><br><br><img src="https://habrastorage.org/webt/pi/gp/b_/pigpb_it2ewws2q0ehn_oxsu_p8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modularidade √© preservada, a anima√ß√£o CSS funciona e nenhum trabalho manual com classes. </font><font style="vertical-align: inherit;">Um bom b√¥nus para a nova pilha.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Digita√ß√£o </font></font></h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Was </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Costum√°vamos escrever toneladas de jsDoc. </font><font style="vertical-align: inherit;">Vamos ver se √© √∫til: </font></font><br><br><img src="https://habrastorage.org/webt/9-/fd/nf/9-fdnf3jssnze_gloxnkforgp6u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este exemplo √© retirado do c√≥digo de produ√ß√£o. </font><font style="vertical-align: inherit;">O que o estado cont√©m? </font><font style="vertical-align: inherit;">Eu n√£o tenho ideia. </font><font style="vertical-align: inherit;">Sim, existe um leia-me, mas, infelizmente, est√° um pouco desatualizado. </font><font style="vertical-align: inherit;">Sim, temos vergonha, mas com documenta√ß√£o e coment√°rios isso geralmente acontece, eles n√£o s√£o confi√°veis. </font><font style="vertical-align: inherit;">Ter√° que investigar o c√≥digo. </font><font style="vertical-align: inherit;">Ou n√£o v√° fundo e acidentalmente quebre tudo. </font><font style="vertical-align: inherit;">Estamos com pressa, n√£o se aprofundem, quebre e se sintam tristes.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tornou-se </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A digita√ß√£o veio em socorro. </font><font style="vertical-align: inherit;">"Tyk" no tipo, e todos os detalhes do m√©todo diante dos meus olhos. </font><font style="vertical-align: inherit;">Com pregui√ßa de entender? </font><font style="vertical-align: inherit;">O verificador Precommit come√ßar√° o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fluxo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e voc√™ ainda precisar√° descobrir. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o gostei do fluxo √† primeira vista. </font><font style="vertical-align: inherit;">As datas est√£o ativadas, o gerente faz ping e voc√™ "n√£o pode obter propriedade" e aqui "falta a propriedade". </font><font style="vertical-align: inherit;">Mas recentemente me disseram que os tipos podem ser projetados por O_o. Como projetar por tipos? </font><font style="vertical-align: inherit;">Algo assim: </font></font><br><br><img src="https://habrastorage.org/webt/_d/ud/_4/_dud_4ofrwr_idp9qdxmqoejdlg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meu mundo virou de cabe√ßa para baixo. </font><font style="vertical-align: inherit;">O fluxo n√£o √© mais um pesadelo. </font><font style="vertical-align: inherit;">Era conveniente e √∫til descrever os m√≥dulos da API com tipos antes de escrever o c√≥digo. </font><font style="vertical-align: inherit;">C√≥digo confi√°vel - um √≥timo b√¥nus!</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ent√£o n√£o h√° mais BEM? </font></font></h1><br>  N√£o.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O BEM est√° ativo e continuamos a oferecer suporte a aplicativos na pilha do BEM. </font><font style="vertical-align: inherit;">Com o tempo, eles tamb√©m mudar√£o para o React, mas por enquanto estamos preparando o caminho para isso: traduzimos as bibliotecas de componentes, formamos um conjunto de ferramentas e acordos e aprendemos a planejar datas de migra√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No BEM, nosso mecanismo de modelo de boletim informativo por email √© implementado. </font><font style="vertical-align: inherit;">Preparamos cartas no servidor e as limita√ß√µes da plataforma BEM descritas acima n√£o afetam esse aplicativo. </font><font style="vertical-align: inherit;">Usar o BEM para desenvolv√™-lo √© uma solu√ß√£o elegante e apropriada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, nossos designers </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prototipam usando o BEM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, √†s vezes, trazem-nos componentes pr√©-montados em vez de layouts. </font><font style="vertical-align: inherit;">E mesmo se pararmos de escrever no BEM, ele ainda nos encontrar√° :)</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu li a primeira parte. </font><font style="vertical-align: inherit;">E os codificadores?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Participei da tradu√ß√£o de uma das aplica√ß√µes do BEM para o React e descobri uma coisa importante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de ingressar no Yandex.Money, eu era um tip√≥grafo simples e passava mais de um ano, quil√¥metros de toneladas de HTML e JSX. N√£o levei a s√©rio a comunidade front-end e seu mundo em transforma√ß√£o. N√£o entendi por que estudar o primeiro Angular para esquec√™-lo amanh√£ e estudar o segundo. N√£o entendi por que alterar o jQuery.Ajax para Fetch e, em seguida, substituir Fetch por Axios.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificou-se que quando voc√™ transfere um projeto de uma estrutura para outra, voc√™ n√£o est√° apenas portando o c√≥digo. </font><font style="vertical-align: inherit;">Temos que analisar e melhorar a arquitetura do aplicativo, endireitar a l√≥gica, refatorar. </font><font style="vertical-align: inherit;">Uma mudan√ßa constante de ferramentas n√£o √© uma tentativa de aproveitar a onda de hype, mas uma busca constante pela melhor solu√ß√£o que atenda aos requisitos da √©poca. </font><font style="vertical-align: inherit;">Um campo de desenvolvimento din√¢mico como nada contribui para o desenvolvimento do seu produto e o desenvolvimento profissional, respectivamente. </font><font style="vertical-align: inherit;">E o frontend √© exatamente essa √°rea. </font><font style="vertical-align: inherit;">Vamos lutar por isso juntos! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reagir a todos!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414183/">https://habr.com/ru/post/pt414183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414173/index.html">Difus√£o da luz atmosf√©rica em menos de quatro kilobytes</a></li>
<li><a href="../pt414175/index.html">Extrair entidades do texto com a Stanford NLP do zero</a></li>
<li><a href="../pt414177/index.html">Transi√ß√µes animadas em aplicativos m√≥veis</a></li>
<li><a href="../pt414179/index.html">Oh, meu c√≥digo: como se tornar um l√≠der de TI</a></li>
<li><a href="../pt414181/index.html">Impressora 3D CreatBot D600 grande</a></li>
<li><a href="../pt414185/index.html">Chave da c√©lula: como abrir um port√£o de membrana vivo</a></li>
<li><a href="../pt414187/index.html">Por que ir para um mestre de TI</a></li>
<li><a href="../pt414189/index.html">The Boring Company conecta o centro de Chicago ao aeroporto atrav√©s de t√∫neis</a></li>
<li><a href="../pt414195/index.html">Cisco StealthWatch ou recursos cl√°ssicos de seguran√ßa de rede corporativa (FW, IPS, ACL, NAC, AV, SIEM)?</a></li>
<li><a href="../pt414197/index.html">Marca preta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>