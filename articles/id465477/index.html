<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📶 🈁 👼🏻 Bagaimana saya mengajar seekor ular untuk bermain sendiri menggunakan Q-Network 🎙️ 👤 🔴</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suatu ketika, menjelajahi kedalaman Internet, saya menemukan sebuah video di mana seseorang melatih ular menggunakan algoritma genetika. Dan saya meng...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana saya mengajar seekor ular untuk bermain sendiri menggunakan Q-Network</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465477/"><p>  Suatu ketika, menjelajahi kedalaman Internet, saya menemukan sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">video di</a> mana seseorang melatih ular menggunakan algoritma genetika.  Dan saya menginginkan hal yang sama.  Tetapi hanya untuk mengambil semua yang sama dan menulis dengan python tidak akan menarik.  Dan saya memutuskan untuk menggunakan pendekatan yang lebih modern untuk sistem agen pelatihan, yaitu Q-network.  Tapi mari kita mulai dari awal. </p><br><h2 id="obuchenie-s-podkrepleniem">  Pelatihan penguatan </h2><br><p>  Dalam pembelajaran mesin, RL (Reinforcement Learning) sangat berbeda dari daerah lain.  Perbedaannya adalah bahwa algoritma ML klasik belajar dari data yang sudah jadi, sementara RL, dapat dikatakan, menciptakan data ini untuk dirinya sendiri.  Gagasan RL adalah bahwa selain algoritma itu sendiri, yang disebut agen, ada lingkungan di mana agen ini ditempatkan.  Pada setiap tahap, agen harus melakukan beberapa tindakan (aksi), dan lingkungan merespons dengan hadiah (hadiah) dan statusnya (negara), atas dasar di mana agen melakukan tindakan. </p><a name="habracut"></a><br><h2 id="dqn">  Dqn </h2><br><p>  Seharusnya ada penjelasan tentang bagaimana algoritma bekerja, tetapi saya akan meninggalkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">tautan</a> ke tempat orang pintar menjelaskannya. </p><br><h2 id="realizaciya-zmeyki">  Implementasi ular </h2><br><p>  Setelah kami menemukan c rl, kami perlu menciptakan lingkungan di mana kami akan menempatkan agen.  Untungnya, tidak perlu menemukan kembali roda, karena perusahaan seperti open-ai telah menulis perpustakaan gym, yang dengannya Anda dapat menulis lingkungan Anda sendiri.  Di perpustakaan mereka sudah dalam jumlah besar.  Dari game atari sederhana hingga model 3d kompleks.  Namun di antara semua ini tidak ada ular.  Oleh karena itu, kami melanjutkan pembuatannya. </p><br><p>  Saya tidak akan menjelaskan semua momen menciptakan lingkungan di gym, tetapi saya hanya akan menunjukkan kelas utama, di mana diperlukan untuk mengimplementasikan beberapa fungsi. </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gym <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Env</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(gym.Env)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, action)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    .    ,      """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""        """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, mode=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'human'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" """</span></span></code> </pre> <br><p>  Tetapi untuk mengimplementasikan fungsi-fungsi ini, kita perlu membuat sistem penghargaan dan dalam bentuk apa kita akan memberikan informasi tentang lingkungan. </p><br><h3 id="sostoyanie">  Ketentuan </h3><br><p>  Dalam video itu, seorang pria memberi ular jarak ke dinding, ular dan apel di 8 arah.  Itu adalah 24 angka.  Saya memutuskan untuk mengurangi jumlah data, tetapi sedikit menyulitkan mereka.  Pertama, saya akan menggabungkan jarak ke dinding dengan jarak ke ular.  Sederhananya, kami akan memberi tahu dia jarak ke objek terdekat yang bisa membunuh dalam tabrakan.  Kedua, hanya akan ada 3 arah dan mereka akan bergantung pada arah pergerakan ular.  Misalnya, ketika mulai, ular itu melihat ke atas, jadi kami akan memberi tahu jarak ke dinding atas, kiri dan kanan.  Tetapi ketika kepala ular berbelok ke kanan, maka kita sudah akan melaporkan jarak ke dinding kanan, atas dan bawah.  Demi kesederhanaan, saya akan memberikan gambar. </p><br><p><img src="https://habrastorage.org/webt/jv/sf/i9/jvsfi9tk6aavphdvn3impizyfrm.jpeg"></p><br><p>  Saya juga memutuskan untuk bermain dengan apel.  Kami akan menyajikan informasi tentang hal itu dalam bentuk (x, y) koordinat dalam sistem koordinat, yang berasal dari kepala ular.  Sistem koordinat juga akan mengubah orientasinya di belakang kepala ular.  Setelah gambar, saya pikir itu pasti menjadi jelas. </p><br><p><img src="https://habrastorage.org/webt/dg/7p/ct/dg7pct5efnwcsvzrdbem7p8usb4.jpeg"></p><br><h3 id="nagrada">  Hadiah </h3><br><p>  Jika Anda dapat memunculkan beberapa fitur dengan keadaan dan berharap bahwa jaringan saraf akan mengetahuinya, maka dengan penghargaan semuanya menjadi lebih rumit.  Tergantung padanya apakah agen akan belajar dan apakah dia akan belajar apa yang kita inginkan. </p><br><p>  Saya akan segera memberikan sistem penghargaan yang dengannya saya telah mencapai pelatihan yang stabil. </p><br><ul><li>  Pada setiap langkah, hadiahnya adalah -0,25. </li><li>  Saat kematian -10. </li><li>  Setelah kematian, hingga 15 langkah -100. </li><li>  Saat makan apel sqrt ( <em>jumlah apel dimakan</em> ) * 3.5. </li></ul><br><p>  Dan juga memberikan contoh apa yang mengarah pada sistem penghargaan yang buruk. </p><br><ul><li>  Jika Anda tidak memberikan hadiah yang cukup kecil untuk kematian di beberapa langkah pertama, maka ular akan lebih memilih untuk membunuh di dinding.  Ini lebih mudah daripada mencari apel :) </li><li>  Jika Anda memberikan hadiah positif untuk langkah-langkahnya, maka ular akan mulai berputar tanpa akhir.  Karena menurutnya itu akan lebih menguntungkan daripada mencari apel. </li><li>  Dan banyak kasus lain di mana ular tidak mau belajar. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Nah, contoh dari apa yang dipelajari ular dalam 2000 episode</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/oj/j2/kd/ojj2kdxlcmslxzlvfqx8cpv-k14.gif"></p></div></div><br><h2 id="itog">  Ringkasan </h2><br><p>  Ketertarikan utama dalam menulis ular adalah untuk melihat bagaimana ular itu belajar dengan mengetahui sedikit tentang lingkungannya.  Dan dia belajar dengan baik, karena rata-rata apel yang dimakan mencapai 23, yang menurut saya, tidak terlalu buruk.  Karena itu, percobaan dapat dianggap berhasil. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Kode sumber</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id465477/">https://habr.com/ru/post/id465477/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id465461/index.html">Pengetikan statis dalam aplikasi Bereaksi</a></li>
<li><a href="../id465463/index.html">Bagus tidak pernah murah. Tapi ini gratis</a></li>
<li><a href="../id465467/index.html">Seluruh kebenaran tentang RTOS. Artikel # 32. Migrasi Nucleus SE: Fitur dan Kompatibilitas yang Tidak Direalisasikan</a></li>
<li><a href="../id465471/index.html">Sudahkah Anda mencoba mendaftarkan situs Anda sebagai publikasi jaringan di Roskomnadzor?</a></li>
<li><a href="../id465475/index.html">Wawancara mini dengan Oleg Anastasiev: toleransi kesalahan di Apache Cassandra</a></li>
<li><a href="../id465479/index.html">Pixel Lo-fi di Persatuan</a></li>
<li><a href="../id465483/index.html">Antiquities: Windows 3.1 dan hidup tanpa tombol start</a></li>
<li><a href="../id465485/index.html">Cetak permadani Game of Thrones pada printer fiskal menggunakan Python</a></li>
<li><a href="../id465487/index.html">Bangun platform kubernetes di Pinterest</a></li>
<li><a href="../id465489/index.html">Daftar Periksa Kesiapan Produksi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>