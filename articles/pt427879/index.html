<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèß üç™ üì¨ Como mudei de Python para Julia (e por que) üôÖüèø üßëüèø‚Äçü§ù‚ÄçüßëüèΩ üë§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um pouco de conhecimento sobre Python 
 Python √© uma √≥tima linguagem. Eu tentei v√°rias l√≠nguas antes: Pascal na escola; C, C com aulas, C ++ na univer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como mudei de Python para Julia (e por que)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427879/"><h3>  Um pouco de conhecimento sobre Python </h3><br>  Python √© uma √≥tima linguagem.  Eu tentei v√°rias l√≠nguas antes: Pascal na escola;  C, C com aulas, C ++ na universidade.  Os dois √∫ltimos (tr√™s) instilaram uma forte avers√£o √† programa√ß√£o: em vez de resolver o problema, voc√™ mexe com aloca√ß√µes e destruidores (palavras assustadoras do passado), pensa em termos de primitivos de baixo n√≠vel.  Minha opini√£o √© que C n√£o √© adequado para resolver problemas educacionais e cient√≠ficos (em qualquer caso, no campo da matem√°tica).  Tenho certeza de que eles v√£o se opor a mim, mas n√£o estou tentando impor nada a ningu√©m, estou apenas expressando minha opini√£o. <br><br>  Python j√° foi uma revela√ß√£o.  Pela primeira vez na minha vida, escrevi v√°rios n√≠veis de abstra√ß√£o mais altos do que o habitual em C.  A dist√¢ncia entre a tarefa e o c√≥digo foi reduzida como nunca antes. <br><br>  Provavelmente eu teria feito isso a vida toda em Python se n√£o tivesse que implementar de repente os testes estat√≠sticos do NIST.  Parece que a tarefa √© muito simples: existe uma matriz de v√°rios megabytes (&gt; = 10), existe um conjunto de testes que devem ser aplicados a essa matriz. <br><a name="habracut"></a><br><h3>  O que √© bom numpy? </h3><br>  Existe um bom pacote numpy em python para trabalhar com matrizes, que √© essencialmente uma interface de alto n√≠vel para bibliotecas r√°pidas como LAPACK.  Parece que todo o conjunto de cavalheiros da computa√ß√£o cient√≠fica est√° dispon√≠vel (Sympy, Numpy, Scipy, Matplotlib), o que mais voc√™ poderia querer? <br><br>  Todo mundo que lidou com entorpecido sabe que ele √© bom, mas n√£o em tudo.  Tamb√©m precisamos tentar garantir que as opera√ß√µes sejam vetorizadas (como em R), ou seja,  de certa forma, uniforme para toda a matriz.  Se de repente seu problema, por algum motivo, n√£o se encaixar nesse paradigma, ent√£o voc√™ tem problemas. <br><br>  De que tipo de tarefas n√£o vetorizadas eu estou falando?  Sim, pelo menos use o mesmo NIST: calcule o comprimento do registro de deslocamento linear usando o algoritmo Berlekamp-Messi;  calcule o comprimento da subsequ√™ncia mais longa de unidades consecutivas e assim por diante.  N√£o excluo a possibilidade de que exista algum tipo de solu√ß√£o engenhosa que reduza o problema a um vetorizado. <br><br><div class="spoiler">  <b class="spoiler_title">Ast√∫cia?</b> <div class="spoiler_text">  Como exemplo do mesmo NIST: era necess√°rio calcular o n√∫mero de "comutadores" da sequ√™ncia, onde, por "comuta√ß√£o", eu significava mudar unidades consecutivas (... 1111 ...) para zeros consecutivos (... 000 ... ) e vice-versa.  Para fazer isso, voc√™ pode pegar a sequ√™ncia original sem o √∫ltimo elemento (x [: -1]) e subtrair a sequ√™ncia deslocada por 1 (x [2:]) e, em seguida, calcular o n√∫mero de elementos diferentes de zero na nova sequ√™ncia resultante.  Todos juntos ter√£o a seguinte apar√™ncia: <br><br><pre><code class="python hljs">np.count_nonzero(x[:<span class="hljs-number"><span class="hljs-number">-1</span></span>] - x[<span class="hljs-number"><span class="hljs-number">1</span></span>:])</code> </pre> <br>  Pode parecer um exerc√≠cio divertido para a mente, mas essencialmente algo antinatural est√° acontecendo aqui, um truque que n√£o ser√° √≥bvio para o leitor ap√≥s um curto per√≠odo de tempo.  Sem mencionar que isso ainda √© lento - ningu√©m cancelou a aloca√ß√£o de mem√≥ria. <br></div></div><br>  As opera√ß√µes n√£o vetorizadas em Python s√£o demoradas.  Como lidar com eles se o sono n√£o √© suficiente?  Geralmente eles oferecem v√°rias solu√ß√µes: <br><br><ol><li>  <b>Numba JIT.</b>  Se ela trabalhou como descrito na p√°gina de t√≠tulo do Numba, acho que valeria a pena terminar a hist√≥ria.  Eu tinha esquecido um pouco no passado que o que havia dado errado com ela;  o ponto principal √© que a acelera√ß√£o n√£o foi t√£o impressionante quanto eu esperava, infelizmente. </li><li>  <b>Cython.</b>  OK, levante a m√£o daqueles que acreditam que o cython √© uma solu√ß√£o realmente bonita e elegante que n√£o destr√≥i o pr√≥prio significado e esp√≠rito do Python?  Eu acho que n√£o;  se voc√™ acessa o Cython, j√° pode parar de se enganar e mudar para algo menos sofisticado, como C ++ e C. </li><li>  Reescreva os gargalos em C e retire-os do seu amado Python.  OK, mas e se eu tiver todo o programa - √© tudo sobre c√°lculos e gargalos?  Xi n√£o oferece!  N√£o estou falando do fato de que nesta solu√ß√£o voc√™ precisa conhecer n√£o apenas uma, mas duas linguagens - Python e C. </li></ol><br><h3>  A√≠ vem a JULIA! </h3><br>  Tendo sido contemplado com solu√ß√µes existentes e n√£o encontrado (incapaz de programar) nada de bom, decidi reescrev√™-lo com algo "mais r√°pido".  De fato, se voc√™ escrever "debulhadora de n√∫meros" no s√©culo 21 com suporte normal a matrizes, opera√ß√µes vetorizadas "prontas para uso", etc.  etc., sua escolha n√£o √© muito densa: <br><br><ol><li>  <b>Fortran</b> .  E n√£o ria, qual de n√≥s n√£o tirou o BLAS / LAPACK dos nossos idiomas favoritos?  O Fortran √© uma linguagem realmente boa (melhor SI!) Para computa√ß√£o CIENT√çFICA.  N√£o entendi pela raz√£o de que desde o tempo do Fortran muitas coisas foram inventadas e adicionadas √†s linguagens de programa√ß√£o;  Eu esperava algo mais moderno. </li><li>  <b>R</b> sofre dos mesmos problemas que o Python (vetoriza√ß√£o). </li><li>  <b>Matlab</b> - provavelmente sim, infelizmente n√£o tenho dinheiro para verificar. </li><li>  <b>Julia</b> - o cavalo est√° escuro, decola, n√£o decola (e era natural at√© a vers√£o est√°vel 1.0) </li></ol><br><h3>  Algumas vantagens √≥bvias de Julia </h3><br><ol><li>  Parece com o Python, pelo menos o mesmo de "alto n√≠vel", com a capacidade, se necess√°rio, de reduzir os bits em n√∫meros. </li><li>  Sem problemas com aloca√ß√µes de mem√≥ria e afins. </li><li>  Sistema de tipo poderoso.  Os tipos s√£o prescritos opcionalmente e muito doseados.  Um programa pode ser escrito sem especificar um √∫nico tipo - e, se voc√™ fizer, ele poder√° faz√™-lo rapidamente.  Mas existem nuances. </li><li>  √â f√°cil escrever tipos personalizados que ser√£o t√£o r√°pidos quanto os tipos internos. </li><li>  Despacho m√∫ltiplo.  Voc√™ pode falar sobre isso por horas, mas, na minha opini√£o - √© o melhor que Julia tem, √© a base do design de todos os programas e, em geral, a base da filosofia da linguagem. <br>  Gra√ßas ao envio m√∫ltiplo, muitas coisas s√£o escritas de maneira muito uniforme. <br><br><div class="spoiler">  <b class="spoiler_title">V√°rios exemplos de despacho</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>() #       <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) #   <span class="hljs-number"><span class="hljs-number">10</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>) #   <span class="hljs-number"><span class="hljs-number">3</span></span>  <span class="hljs-number"><span class="hljs-number">5</span></span>   .... using Distributions d = Normal() #     <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(d) #     <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(d, <span class="hljs-number"><span class="hljs-number">10</span></span>) #   <span class="hljs-number"><span class="hljs-number">10</span></span> ...   </code> </pre><br>  Ou seja, o primeiro argumento pode ser qualquer distribui√ß√£o (unidimensional) de Distribui√ß√µes, mas a chamada de fun√ß√£o permanecer√° literalmente a mesma.  E n√£o apenas distribui√ß√£o (√© poss√≠vel transmitir o RNG em si como um objeto MersenneTwister e muito mais).  Outro exemplo (na minha opini√£o, ilustrativo) √© a navega√ß√£o em DataFrames sem loc / iloc. <br></div></div></li><li>  6. Matrizes s√£o nativas, internas.  Vetoriza√ß√£o fora da caixa. <br></li></ol><br><h3>  Contras de ficar calado sobre o que seria um crime! </h3><br><ol><li>  Novo idioma.  Por um lado, √© claro, um sinal de menos.  Em algo, talvez imaturo.  Por outro lado, ele levou em conta o rake de muitas l√≠nguas passadas, est√° "nos ombros de gigantes", absorveu muitas coisas interessantes e novas. </li><li>  √â improv√°vel que programas imediatamente r√°pidos gravem.  Existem algumas coisas n√£o √≥bvias que s√£o muito f√°ceis de lidar: voc√™ entra no rake, pede ajuda √† comunidade, entra novamente ... etc.  Essas s√£o principalmente instabilidade de tipo, instabilidade de tipo e vari√°veis ‚Äã‚Äãglobais.  Em geral, at√© onde eu sei, um programador que deseja escrever rapidamente em Julia passa por v√°rios est√°gios: a) escreve em Python.  Isso √© √≥timo, e tamb√©m √©, mas √†s vezes haver√° problemas de desempenho.  b) escreve como em C: prescrevendo manualmente tipos sempre que poss√≠vel.  c) entende gradualmente onde √© necess√°rio (muito medido) prescrever tipos e onde eles interferem. </li><li>  Ecossistema  Alguns pacotes s√£o brutos, no sentido de que em algum lugar constantemente algo cai;  alguns s√£o maduros, mas inconsistentes entre si (√© necess√°ria a convers√£o para outros tipos, por exemplo).  Por um lado, isso √© obviamente ruim;  por outro lado, Julia tem muitas id√©ias interessantes e ousadas apenas porque "estamos nos ombros dos gigantes" - acumulamos uma tremenda experi√™ncia de pisar em um ancinho e "como n√£o faz√™-lo", e isso √© levado em conta (parcialmente) pelos desenvolvedores de pacotes. </li><li>  Numerando matrizes de 1. Ha, brincando, √© claro que isso √© uma vantagem!  N√£o, bem, s√©rio, qual √© o problema? Com ‚Äã‚Äãque √≠ndice come√ßa a numera√ß√£o?  Voc√™ se acostuma em 5 minutos.  Ningu√©m reclama que n√∫meros inteiros s√£o chamados de n√∫mero inteiro, n√£o inteiro.  Todas essas s√£o quest√µes de gosto.  E sim, use pelo menos o mesmo Cormen de acordo com os algoritmos - tudo √© numerado de um l√°, e √†s vezes √© inconveniente refaz√™-lo no Python, pelo contr√°rio. </li></ol><br><h3>  Bem, por que velocidade? </h3><br>  √â hora de lembrar por que tudo foi iniciado. <br><br>  Nota: Esqueci o Python com seguran√ßa, ent√£o escreva suas melhorias nos coment√°rios. Tentarei execut√°-las no meu laptop e ver o tempo de execu√ß√£o. <br><br>  Ent√£o, dois pequenos exemplos com marcas de micropigmenta√ß√£o. <br><br><div class="spoiler">  <b class="spoiler_title">Algo vetorizado</b> <div class="spoiler_text">  Problema: um vetor X de 0 e 1. √© alimentado na entrada da fun√ß√£o.√â necess√°rio convert√™-lo em um vetor de 1 e (-1) (1 -&gt; 1, 0 -&gt; -1) e calcular quantos coeficientes da transformada de Fourier desse vetor s√£o o valor absoluto excede o limite. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, boundary)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.count_nonzero(np.abs(np.fft.fft(<span class="hljs-number"><span class="hljs-number">2</span></span>*x<span class="hljs-number"><span class="hljs-number">-1</span></span>)) &gt; boundary) %timeit process_fft(x, <span class="hljs-number"><span class="hljs-number">2000</span></span>) <span class="hljs-number"><span class="hljs-number">84.1</span></span> ms ¬± <span class="hljs-number"><span class="hljs-number">335</span></span> ¬µs per loop (mean ¬± std. dev. of <span class="hljs-number"><span class="hljs-number">7</span></span> runs, <span class="hljs-number"><span class="hljs-number">10</span></span> loops each)</code> </pre><br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, boundary)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t -&gt; t &gt; boundary, abs.(fft(2*x.-1)</span></span></span><span class="hljs-function">)) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">benchmark</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, 2000)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BenchmarkTools</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Trial</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memory</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">106</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">81</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MiB</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">allocs</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">61</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minimum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">80</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">233</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4.75% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">median</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">80</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">746</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4.70% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">85</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">000</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(8.67% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maximum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">205</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">831</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(52.27% GC)</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">samples</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">59</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evals</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span></span></code> </pre><br>  N√£o veremos nada de surpreendente aqui - mesmo assim, eles n√£o consideram isso por si mesmos, mas o transmitem para programas fortran bem otimizados. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Algo n√£o vetoriz√°vel</b> <div class="spoiler_text">  Uma matriz de 0 e 1. √© alimentada na entrada.Encontre o comprimento da subsequ√™ncia mais longa de unidades consecutivas. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">longest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> maxLen = <span class="hljs-number"><span class="hljs-number">0</span></span> currLen = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment"># This will count the number of ones in the block for bit in x: if bit == 1: currLen += 1 maxLen = max(maxLen, currLen) else: maxLen = max(maxLen, currLen) currLen = 0 return max(maxLen, currLen) %timeit longest(x) 599 ms ¬± 639 ¬µs per loop (mean ¬± std. dev. of 7 runs, 1 loop each)</span></span></code> </pre><br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">longest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maxLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">This</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">will</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">the</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">number</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ones</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">the</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bit</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bit</span></span></span><span class="hljs-function"> == </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currLen</span></span></span><span class="hljs-function"> += </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maxLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(maxLen, currLen)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maxLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(maxLen, currLen)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(maxLen, currLen)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">benchmark</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">longest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BenchmarkTools</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Trial</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memory</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bytes</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">allocs</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minimum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">094</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">median</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">248</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">319</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maximum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">12</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">177</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">samples</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">536</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evals</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span></span></code> </pre><br>  A diferen√ßa √© √≥bvia a olho nu.  Dicas para "finalizar" e / ou vetorizar a vers√£o numpy s√£o bem-vindas.  Eu tamb√©m quero observar que os programas s√£o quase id√™nticos.  Por exemplo, eu n√£o registrei um √∫nico tipo em Julia (compare com o anterior) - mesmo assim, tudo funciona rapidamente. <br></div></div><br>  Tamb√©m quero observar que as vers√µes apresentadas n√£o foram inclu√≠das no programa final, mas foram otimizadas ainda mais;  aqui eles s√£o dados como exemplo e sem complica√ß√µes desnecess√°rias (encaminhando mem√≥ria adicional em Julia para executar rfft no local, etc.). <br><br><h3>  O que saiu no final? </h3><br>  N√£o mostrarei o c√≥digo final para Python e Julia: isso √© um segredo (pelo menos por enquanto).  No momento em que parei para finalizar a vers√£o python, funcionou todos os testes do NIST em uma matriz de 16 megabytes de caracteres bin√°rios em ~ 50 segundos.  Na Julia no momento, todos os testes s√£o executados no mesmo volume ~ 20 segundos.  Pode ser que eu seja um tolo, e havia espa√ßo para otimiza√ß√µes etc.  etc.  Mas este sou eu, como sou, com todas as suas vantagens e desvantagens e, na minha opini√£o, n√£o √© a velocidade esf√©rica dos programas no v√°cuo nas linguagens de programa√ß√£o que deve ser considerada, mas como eu pessoalmente posso program√°-lo (sem erros realmente graves). <br><br><h3>  Por que eu escrevi tudo isso? </h3><br>  As pessoas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ficaram interessadas;  Eu decidi escrever quando a hora aparecer.  No futuro, acho que vou passar por Julia mais detalhadamente, com um exemplo de solu√ß√£o de alguns problemas t√≠picos.  Porque  Mais idiomas, bons e diferentes, e permita que todos que queiram encontrar algo que lhe conv√©m pessoalmente. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427879/">https://habr.com/ru/post/pt427879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427869/index.html">Semin√°rio on-line aberto ‚ÄúMultithreading in Java. Al√©m da notifica√ß√£o de sincroniza√ß√£o ¬ª</a></li>
<li><a href="../pt427871/index.html">Pirataria no Espa√ßo sideral: - Comerciantes Armados e Patrulhas Militares - Parte II</a></li>
<li><a href="../pt427873/index.html">Impressora de constru√ß√£o 3D para Faculdade de Tecnologia Moderna</a></li>
<li><a href="../pt427875/index.html">Hist√≥rico: ‚ÄúInternet Archive‚Äù - hist√≥rico de cria√ß√£o, miss√£o e projetos subsidi√°rios</a></li>
<li><a href="../pt427877/index.html">Linguagem de programa√ß√£o Rockstar: quando o c√≥digo se parece com texto de sucesso de rock</a></li>
<li><a href="../pt427883/index.html">Apresentando a virtualiza√ß√£o, cont√™ineres e Kubernetes: 18 recursos de nuvem</a></li>
<li><a href="../pt427889/index.html">Errado, errado, errado! m√©todos de mitiga√ß√£o de DDoS</a></li>
<li><a href="../pt427891/index.html">Milh√µes de pessoas podem ser atacadas por vulnerabilidade na plataforma Cisco WebEx Conference</a></li>
<li><a href="../pt427893/index.html">Lola sangrenta em Omega 2 ou Python sufocante no Halloween</a></li>
<li><a href="../pt427895/index.html">Removendo dados de um banco de dados fragment√°vel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>