<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎿 👩‍❤️‍👨 🙅🏿 Wie Sie RTSP 2020 auf Ihrer Website kochen oder warum die Eber keine Chance haben, davonzulaufen 🥞 👨🏾‍✈️ 🕵🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RTSP ist ein einfaches Signalisierungsprotokoll, das sie schon seit vielen Jahren nicht mehr ersetzen können, und es muss zugegeben werden, dass sie s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie Sie RTSP 2020 auf Ihrer Website kochen oder warum die Eber keine Chance haben, davonzulaufen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/479008/"><p><img src="https://habrastorage.org/webt/0o/qj/i7/0oqji7xkok-ssze_oqdnr2kmfcg.jpeg"></p><br><p>  RTSP ist ein einfaches Signalisierungsprotokoll, das sie schon seit vielen Jahren nicht mehr ersetzen können, und es muss zugegeben werden, dass sie sich nicht wirklich anstrengen. </p><br><p>  Zum Beispiel haben wir eine IP-Kamera, die RTSP unterstützt.  Jeder, der jemals den Datenverkehr mit einem Sharkwire-Kabel getestet hat, wird Ihnen mitteilen, dass zuerst DESCRIBE, dann PLAY und dann der Datenverkehr direkt über RTP oder beispielsweise über den TCP-Kanal übertragen wird. </p><a name="habracut"></a><br><p>  Ein typisches Schema zum Herstellen einer RTSP-Verbindung sieht folgendermaßen aus: </p><br><p><img src="https://habrastorage.org/webt/yi/i9/kw/yii9kwulxpxxz1dywpppxqdy0ko.png"></p><br><p>  Es ist denkbar, dass die Unterstützung des RTSP-Protokolls für Browser nicht erforderlich ist und ungefähr so ​​häufig genutzt wird wie das fünfte Rad. Daher haben Browser es nicht eilig, es in großem Umfang zu implementieren, und das wird so gut wie nie passieren.  Auf der anderen Seite könnten Browser direkte TCP-Verbindungen herstellen, und das würde die Aufgabe lösen, aber jetzt stößt es auf Sicherheitsprobleme: Haben Sie jemals einen Browser gesehen, mit dem ein Skript Transportprotokolle direkt verwenden kann? </p><br><p>  Die Leute fordern jedoch, dass Streams in „jedem Browser ohne Installation zusätzlicher Software“ verfügbar sind, und die Start-Supper schreiben auf ihren Websites: „Sie müssen nichts installieren, es funktioniert in allen Browsern sofort“ möchte einen Stream von einer IP-Kamera anzeigen. </p><br><p>  In diesem Artikel werden wir untersuchen, wie dies erreicht werden kann.  Und da das kommende Jahr eine runde Zahl enthält, wollen wir unseren Artikel etwas aktueller gestalten und ein Label mit 2020 darauf kleben, zumal es wirklich so ist. </p><br><p>  Welche Video-Display-Technologien für eine Webseite müssen im Jahr 2020 also vergessen werden?  Es ist Flash im Browser.  Es ist tot  Es existiert nicht mehr, streichen Sie es von der Liste. </p><br><h3 id="three-useful-methods">  Drei nützliche Methoden </h3><br><p>  Die Tools, mit denen Sie heute einen Videostream in Ihrem Browser ansehen können, sind: </p><br><ol><li>  WebRTC </li><li>  Hls </li><li>  Websocket + MSE </li></ol><br><h4 id="what-is-wrong-with-webrtc">  Was ist los mit WebRTC </h4><br><p>  In zwei Worten: Es ist ressourcenintensiv und kompliziert. </p><br><p>  Sie werden wegwinken: "Was meinen Sie mit ressourcenintensiv?". Da die CPUs heutzutage leistungsstark sind, ist der Speicher billig. Wo liegt also das Problem?  Erstens ist die Verschlüsselung des gesamten Datenverkehrs obligatorisch, auch wenn Sie ihn nicht benötigen.  Zweitens ist WebRTC eine komplizierte bidirektionale Verbindung und ein Peer-to-Peer-Feedback-Austausch über die Kanalqualität (in diesem Fall Peer-to-Server): Zu jedem Zeitpunkt wird die Bitrate berechnet, Paketverluste erkannt und Entscheidungen getroffen Die Umleitung und die Audio-Video-Synchronisation werden in Bezug auf all das berechnet, das sogenannte Lipsync, bei dem die Lippen des Sprechers mit den Worten übereinstimmen.  All diese Berechnungen sowie der eingehende Datenverkehr auf dem Server weisen in Echtzeit Gigabyte RAM zu und geben sie frei, und wenn etwas schief geht, kann ein 256-Gigabyte-Server mit einer 48-Kern-CPU trotz allem schnell aus dem Ruder laufen alle Gigaherz, Nanometer und DDR 10 an Bord. </p><br><p>  Es ist also eine Art Eichhörnchen mit einer Iskander-Rakete zu jagen.  Alles, was wir brauchen, ist ein RTSP-Stream, der dann angezeigt wird. WebRTC sagt: "Ja, komm schon, aber du musst dafür bezahlen." </p><br><h4 id="why-webrtc-is-good">  Warum WebRTC gut ist </h4><br><p> Die Latenz.  Es ist wirklich niedrig.  Wenn Sie bereit sind, die Leistung und Komplexität für die geringe Latenz zu opfern, ist WebRTC die am besten geeignete Variante für Sie. </p><br><h4 id="why-hls-is-good">  Warum HLS gut ist </h4><br><p>  Mit zwei Worten: Es kann überall funktionieren </p><br><p>  HLS ist ein langsamer Offroader in der Welt der Anzeige von Live-Inhalten.  Es kann aufgrund zweier Dinge überall funktionieren: des HTTP-Transports und der Schirmherrschaft von Apple.  In der Tat ist das HTTP-Protokoll allgegenwärtig, ich kann es sogar spüren, wenn ich diese Zeilen schreibe.  Ganz gleich, wo Sie sich gerade befinden und mit welchem ​​alten Tablet Sie im Internet surfen, mit HLS (HTTP Live Streaming) können Sie das Video sicher auf Ihrem Bildschirm anzeigen. </p><br><p>  Es ist alles gut genug, aber ... </p><br><h4 id="why-hls-is-bad">  Warum HLS schlecht ist </h4><br><p>  Die Latenz.  Es gibt zum Beispiel Projekte zur Videoüberwachung von Baustellen.  Eine Anlage ist seit Jahren im Bau, und während dieser ganzen Zeit zeichnet die schlechte Kamera Tag und Nacht rund um die Uhr Videos von der Baustelle auf.  Dies ist ein Beispiel für eine Situation, in der die niedrige Latenz nicht benötigt wird. </p><br><p>  Ein anderes Beispiel sind Eber.  Echte Eber.  Die Bauern in Ohio leiden unter einer Invasion von Wildschweinen, die sich von der Ernte ernähren und sie wie Heuschrecken niederstampfen, was das finanzielle Wohlergehen der Farmen gefährdet.  Unternehmer haben ein Videoüberwachungssystem von RTSP-Kameras gestartet, das das Gelände in Echtzeit überwacht und eine Falle auslöst, wenn die Eindringlinge einmarschieren.  In diesem Fall ist die niedrige Latenz von entscheidender Bedeutung. Wenn HLS (mit einer Latenz von 15 Sekunden) verwendet wird, laufen die Eber weg, bevor die Falle aktiviert wird. </p><br><p><img src="https://habrastorage.org/webt/g4/ha/iw/g4haiwkwu7jqrhh65c804phjt-q.jpeg"></p><br><p>  Hier ist ein weiteres Beispiel: Videopräsentationen, in denen Ihnen jemand ein Produkt vorführt und eine schnelle Antwort erwartet.  Im Falle einer hohen Latenz zeigen sie Ihnen das Produkt auf der Kamera und fragen dann: „Wie gefällt es Ihnen?“. Das wird Sie in nur 15 Sekunden erreichen.  Innerhalb von 15 Sekunden kann das Signal 12 Mal zum Mond und zurück gesendet werden.  Nein, wir wollen keine solche Latenz.  Es sieht eher nach einem aufgezeichneten Video aus als nach Live.  Voraufgezeichnetes Video, so wie HLS funktioniert: Es zeichnet Teile eines Videos auf einer Disc oder im Speicher des Servers auf und der Player lädt die aufgezeichneten Teile herunter.  So funktioniert HTTP Live, das überhaupt nicht Live ist. </p><br><p>  Warum passiert es?  Die globale Präsenz des HTTP-Protokolls und seine Einfachheit führen zu seiner Trägheit, da HTTP ursprünglich nicht zum schnellen Herunterladen und Anzeigen von Tausenden großer Videofragmente (HLS-Segmente) gedacht war.  Sie werden natürlich in hoher Qualität heruntergeladen und wiedergegeben, aber sehr langsam: Es dauert mindestens 15 Sekunden, bis sie heruntergeladen, gepuffert und dekodiert sind. </p><br><p>  Hier muss angemerkt werden, dass Apple im Herbst 2019 seine HLS Low Latency angekündigt hat, aber das ist schon eine andere Geschichte.  Schauen wir uns die Ergebnisse später genauer an.  Und jetzt haben wir auch MSE auf Lager. </p><br><h4 id="why-mse-is-good">  Warum MSE gut ist </h4><br><p>  Media Source Extension ist eine native Unterstützung für die Wiedergabe von Paketvideos im Browser.  Es kann als systemeigener Player für H.264 und AAC bezeichnet werden, dem Sie Videosegmente zuführen können und der im Gegensatz zu HLS nicht an ein Transportprotokoll gebunden ist.  Aus diesem Grund können Sie den Transport über das Websockets-Protokoll auswählen.  Mit anderen Worten, die Segmente werden nicht mehr mithilfe der alten Request-Response-Technologie (HTTP) heruntergeladen, sondern können problemlos über die Websockets-Verbindung übertragen werden, die fast ein direkter TCP-Kanal ist.  Dies ist eine große Hilfe im Hinblick auf die Verringerung der Verzögerungen, die bis zu 3-5 Sekunden betragen können.  Eine solche Latenz ist nicht fantastisch, aber für die meisten Projekte geeignet, die keine harte Echtzeit erfordern.  Die Komplexität und Ressourcenintensität ist ebenfalls relativ gering, da ein TCP-Kanal geöffnet ist und fast die gleichen HLS-Segmente durchlaufen, die vom Player gesammelt und zum Spielen gesendet werden. </p><br><h4 id="why-mse-is-bad">  Warum ist MSE schlecht </h4><br><p>  Es kann nicht überall funktionieren.  Ähnlich wie bei WebRTC ist die Durchdringung der Browser geringer.  iPhones (iOS) haben eine besonders bemerkenswerte Vergangenheit, in der MSE nicht gespielt wurde, weshalb MSE kaum als alleinige Lösung für ein Startup geeignet ist. <br>  Es ist in den folgenden Browsern vollständig verfügbar: Edge, Firefox, Chrome, Safari, Android-Browser, Opera Mobile, Chrome für Android, Firefox für Android, UC-Browser für Android. </p><br><p><img src="https://habrastorage.org/webt/xt/oq/wn/xtoqwnjdoosqb6fhopu9rvoxsxy.png"></p><br><p>  Die eingeschränkte Unterstützung von MSE wurde vor einiger Zeit in iOS Safari eingeführt, beginnend mit iOS 13. </p><br><p><img src="https://habrastorage.org/webt/fl/wd/-n/flwd-nksnux1tlprjriupeajyvm.png"></p><br><h3 id="rtsp-leg">  RTSP-Bein </h3><br><p>  Wir haben die Lieferung in Richtung Videoserver&gt; Browser besprochen.  Außerdem benötigen Sie diese beiden Dinge: </p><br><p>  1) So senden Sie Ihr Video von der IP-Kamera an den Server. <br>  2) Das Video in eines der oben beschriebenen Formate / Protokolle konvertieren. </p><br><p>  Hier kommt die Serverseite ins Spiel. </p><br><p>  Ta-dah ... Lernen Sie <a href="https://flashphoner.com/">Web Call Server 5</a> (oder einfach WCS für Freunde) kennen.  Jemand muss den RTSP-Verkehr empfangen, das Video korrekt entpacken, in WebRTC, HLS oder MSE konvertieren, vorzugsweise ohne vom Transcoder überkomprimiert zu werden, und es in ansehnlicher Form, ohne durch Artefakte und Einfrierungen verfälscht, an den Browser senden. </p><br><p>  Die Aufgabe ist auf den ersten Blick nicht kompliziert, aber es kann so viele versteckte Fallstricke, chinesische Kameras und Konvertierungsnuancen geben, dass es wirklich schrecklich ist.  Ohne Hacks ist das eigentlich nicht möglich, aber es funktioniert und funktioniert gut.  In der Produktion. </p><br><h4 id="the-delivery-scheme">  Das Lieferschema </h4><br><p>  Infolgedessen nimmt ein vollständiges Schema für die Bereitstellung von RTSP-Inhalten mit Konvertierung auf einem Zwischenserver Gestalt an. </p><br><p><img src="https://habrastorage.org/webt/jm/7e/oj/jm7eojlfeztudqtrwzjebgu4t9e.png"></p><br><p>  Eine der am häufigsten gestellten Fragen unserer indischen Kollegen lautet: „Ist es möglich?  Direkt ohne Server? ”.  Nein, das ist es nicht.  Sie benötigen die Serverseite, die die Arbeit erledigt.  In der Cloud, auf Hardware, auf Corei7 in Ihrem Balkon, aber darauf können Sie nicht verzichten. </p><br><h4 id="lets-get-back-to-our-year-2020">  Kommen wir zurück zu unserem Jahr 2020 </h4><br><p>  Also, hier ist das Rezept zum Kochen eines RTSP in Ihrem Browser: </p><br><ol><li>  <a href="">Nimm ein frisches WCS (Web Call Server)</a> . </li><li>  Fügen Sie nach Belieben WebRTC, HLS oder MSE hinzu. </li><li><p>  Servieren Sie sie auf der Webseite. </p><br><p>  Guten Appetit! </p><br></li></ol><br><h3 id="no-this-isnt-all-yet">  Nein, das ist noch nicht alles. </h3><br><p>  Die anfragenden Neuronen werden definitiv diese Frage stellen wollen: „Wie?  Wirklich, <a href="https://flashphoner.com/embedding-html5-rtsp-player-into-a-web-page/">wie kann das gemacht werden</a> ?  Wie wird es im Browser aussehen? “ </p><br><p>  Wir möchten Sie auf den minimalistischen WebRTC-Player aufmerksam machen, der als Küchentisch zusammengestellt wurde. </p><br><p>  1) Verbinden Sie das Haupt-API-Skript flashphoner.js und das Skript my_player.js, die wir später erstellen, mit der Webseite. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  2) Initialisieren Sie die API im Hauptteil der Webseite </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  3) Fügen Sie der Seite div hinzu, das als Container für die Videos dient.  Stellen Sie die Größen und die Grenze dafür ein. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  4) Fügen Sie die Wiedergabetaste hinzu, auf die geklickt wird, um die Verbindung zum Server herzustellen und das Video abzuspielen </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><p>  5) Jetzt erstellen wir das Skript my_player.js, das den Hauptcode unseres Players enthält.  Beschreiben Sie die Konstanten und Variablen </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session;</code> </pre> <br><p>  6) API initialisieren, wenn eine HTML-Seite geladen wird </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_api</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"init api"</span></span>); Flashphoner.init({ }); }</code> </pre> <br><p>  7) Stellen Sie über WebSocket eine Verbindung zum WCS-Server her.  Ersetzen Sie "wss: //demo.flashphoner.com" durch Ihre WCS-Adresse, damit alles ordnungsgemäß funktioniert </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ session = Flashphoner.createSession({<span class="hljs-attr"><span class="hljs-attr">urlServer</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://demo.flashphoner.com"</span></span>}).on(SESSION_STATUS.ESTABLISHED, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">session</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"connection established"</span></span>); playStream(session); }); }</code> </pre> <br><p>  8) Übertragen Sie anschließend die folgenden beiden Parameter, "name" und "display", wobei "name" die RTSP-URL des wiedergegebenen Streams ist und "display" das Element von myVideo ist, in das unser Player installiert wird.  Stelle auch hier die URL deines Streams ein, anstatt unserer. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">"rtsp://b1.dnsdojo.com:1935/live/sys2.stream"</span></span>,<span class="hljs-attr"><span class="hljs-attr">display</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"myVideo"</span></span>)}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stream = session.createStream(options).on(STREAM_STATUS.PLAYING, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"playing"</span></span>); }); stream.play(); }</code> </pre> <br><p>  Speichern Sie die Dateien und versuchen Sie, den Player zu starten.  Wird Ihr RTSP-Stream abgespielt? </p><br><p>  Als wir es <a href="https://flashphoner.com/testing-rtsp-html5-player/">getestet haben</a> , wurde dieses gespielt: rtsp: //b1.dnsdojo.com: 1935 / live / sys2.stream. </p><br><p>  Und so sieht es aus: </p><br><p>  Der Spieler vor der Play-Schaltfläche wird angeklickt </p><br><p><img src="https://habrastorage.org/webt/pe/ej/6n/peej6nfw2lthkmmnsrypojl6bzq.png"></p><br><p>  Der Player mit einem Video gestartet </p><br><p><img src="https://habrastorage.org/webt/w3/h8/yo/w3h8yozn6madl2tolxx_xg3yljs.png"></p><br><p>  Es gibt nicht viel Code: </p><br><p>  HTML </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Javascript </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//Status constants var SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; var STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; //Websocket session var session; //Init Flashphoner API on page load function init_api() { console.log("init api"); Flashphoner.init({ }); } //Connect to WCS server over websockets function connect() { session = Flashphoner.createSession({urlServer: "wss://demo.flashphoner.com"}).on(SESSION_STATUS.ESTABLISHED, function(session){ console.log("connection established"); playStream(session); }); } //Playing stream with given name and mount the stream into myVideo div element function playStream() { var options = {"rtsp://b1.dnsdojo.com:1935/live/sys2.stream",display:document.getElementById("myVideo")}; var stream = session.createStream(options).on(STREAM_STATUS.PLAYING, function(stream) { console.log("playing"); }); stream.play(); }</span></span></code> </pre> <br><p>  Als Server wird demo.flashphoner.com verwendet.  Der vollständige Code des Beispiels ist unten am Fuß der Seite mit den Links verfügbar. <br>  Viel Spaß beim Streamen! </p><br><h3 id="links">  Links </h3><br><p>  <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_api-2.0/examples/demo/streaming/player">Spielercode auf Github</a> </p><br><p>  <a href="https://flashphoner.com/ip-camera-streaming-via-rtsp-for-webrtc-and-websocket-browsers/">Integration eines RTSP-Players in eine Webseite oder eine mobile Anwendung</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479008/">https://habr.com/ru/post/de479008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de478998/index.html">Warum wollen wir immer den goldenen Schnitt sehen? Versuchte (erfolglose) evolutionäre Analyse mit neuronalen C ++ - Netzwerken</a></li>
<li><a href="../de479000/index.html">Parallels-Praktikum mit 14 Jahren</a></li>
<li><a href="../de479002/index.html">Gamification von Geschäftsprozessen. Wie funktioniert es</a></li>
<li><a href="../de479004/index.html">Kann man sich vor lästigen Personalvermittlern schützen?</a></li>
<li><a href="../de479006/index.html">Die Chroniken des Buchhungers II</a></li>
<li><a href="../de479012/index.html">SviMik: "In OSM gibt es zwei gegensätzliche Meinungen dazu"</a></li>
<li><a href="../de479016/index.html">5 Schritte zum Schutz von Geschäftsgeheimnissen</a></li>
<li><a href="../de479018/index.html">Docker für das Frontend. Teil 2. Was bist du?</a></li>
<li><a href="../de479020/index.html">Die Geschichte, wie Google Play in einer Stunde zehn Jahre meiner Arbeit gekreuzt hat</a></li>
<li><a href="../de479022/index.html">Smart-Fernseher Samsung, LG, Vizio und TCL nehmen jede Sekunde "Fingerabdrücke" vom Bildschirm und senden sie an den Server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>