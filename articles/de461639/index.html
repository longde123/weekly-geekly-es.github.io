<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîù üë©üèø‚Äçüî¨ ‚ÜîÔ∏è Ihr Ausweg, Grafik: Wie wir keine gute Netzwerkgrafik gefunden und unsere eigene erstellt haben üñåÔ∏è üêë ü•ã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Group-IB-Experten untersuchen F√§lle mit Phishing, Botnetzen, betr√ºgerischen Transaktionen und kriminellen Hacker-Gruppen und verwenden seit vielen Jah...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ihr Ausweg, Grafik: Wie wir keine gute Netzwerkgrafik gefunden und unsere eigene erstellt haben</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/461639/"><img src="https://habrastorage.org/webt/5w/z_/im/5wz_imjcrurw4gk_wubv6gqanig.jpeg"><br><br>  Group-IB-Experten untersuchen F√§lle mit Phishing, Botnetzen, betr√ºgerischen Transaktionen und kriminellen Hacker-Gruppen und verwenden seit vielen Jahren eine Diagrammanalyse, um alle Arten von Verbindungen zu identifizieren.  Verschiedene F√§lle haben ihre eigenen Datenfelder, ihre eigenen Verbindungsidentifikationsalgorithmen und Schnittstellen, die auf bestimmte Aufgaben zugeschnitten sind.  Alle diese Tools waren eine interne Entwicklung von Group-IB und standen nur unseren Mitarbeitern zur Verf√ºgung. <br><br>  Die Diagrammanalyse der Netzwerkinfrastruktur ( <i>Netzwerkdiagramm</i> ) war das erste interne Tool, das wir in alle √∂ffentlichen Produkte des Unternehmens integriert haben.  Bevor wir unser eigenes Netzwerkdiagramm erstellt haben, haben wir viele √§hnliche Entwicklungen auf dem Markt analysiert und kein einziges Produkt gefunden, das unseren eigenen Anforderungen entspricht.  In diesem Artikel werden wir dar√ºber sprechen, wie wir das Netzwerkdiagramm erstellt haben, wie es verwendet wird und auf welche Schwierigkeiten wir gesto√üen sind. <br><br>  <b>Dmitry Volkov,</b> CTO Group-IB und Leiter Cyber ‚Äã‚ÄãIntelligence <a name="habracut"></a><br><br><h1>  <font color="#e63619">Was kann ein Group-IB-Netzwerkdiagramm tun?</font> </h1><br><h3>  Untersuchungen </h3><br>  Seit der Gr√ºndung von Group-IB im Jahr 2003 bis heute haben Identifikation, Dekanat und Rechenschaftspflicht von Cyberkriminellen die Hauptpriorit√§t unserer Arbeit.  Keine Untersuchung von Cyberangriffen k√∂nnte ohne eine Analyse der Netzwerkinfrastruktur des Angreifers auskommen.  Zu Beginn unserer Reise war es ziemlich m√ºhsam, ‚Äûmanuelle Arbeit‚Äú zu finden, um Beziehungen zu finden, mit denen Kriminelle identifiziert werden k√∂nnen: Informationen zu Domainnamen, IP-Adressen, digitalen Fingerabdr√ºcken von Servern usw. <br><br>  Die meisten Angreifer versuchen, im Netzwerk so anonym wie m√∂glich zu agieren.  Wie alle Menschen machen sie jedoch Fehler.  Die Hauptaufgabe dieser Analyse besteht darin, die "wei√üen" oder "grauen" historischen Projekte von Angreifern zu finden, die sich mit der sch√§dlichen Infrastruktur √ºberschneiden, die in dem tats√§chlich untersuchten Vorfall verwendet wird.  Wenn es m√∂glich ist, "wei√üe Projekte" zu erkennen, wird das Auffinden des Angreifers in der Regel zu einer trivialen Aufgabe.  Im Fall von "Graut√∂nen" erfordert die Suche mehr Zeit und M√ºhe, da ihre Besitzer versuchen, Registrierungsdaten zu anonymisieren oder zu verbergen, aber die Chancen bleiben recht hoch.  In der Regel achten Angreifer zu Beginn ihrer kriminellen Aktivit√§ten weniger auf ihre eigene Sicherheit und machen mehr Fehler. Je tiefer wir in die Geschichte eintauchen k√∂nnen, desto h√∂her sind die Chancen auf eine erfolgreiche Untersuchung.  Aus diesem Grund ist ein Netzwerkgraph mit einer guten Historie ein √§u√üerst wichtiges Element einer solchen Untersuchung.  Einfach ausgedr√ºckt, je tiefer die historischen Daten eines Unternehmens sind, desto besser ist seine Grafik.  Angenommen, eine Geschichte von 5 Jahren kann dazu beitragen, 1-2 von 10 Verbrechen unter Auflagen zu l√∂sen, und eine Geschichte von 15 Jahren gibt die Chance, alle zehn zu l√∂sen. <br><br><h3>  Erkennen von Phishing und Betrug </h3><br>  Jedes Mal, wenn wir einen verd√§chtigen Link zu Phishing-, betr√ºgerischen oder raubkopierten Ressourcen erhalten, erstellen wir automatisch ein Diagramm der zugeh√∂rigen Netzwerkressourcen und √ºberpr√ºfen alle gefundenen Hosts auf √§hnliche Inhalte.  Auf diese Weise k√∂nnen Sie sowohl alte Phishing-Sites finden, die aktiv, aber unbekannt waren, als auch brandneue, die f√ºr zuk√ºnftige Angriffe vorbereitet wurden, aber noch nicht verwendet werden.  Ein elementares Beispiel, das h√§ufig genug ist: Wir haben eine Phishing-Site auf einem Server mit nur 5 Sites gefunden.  Indem wir jeden von ihnen √ºberpr√ºfen, finden wir Phishing-Inhalte auch auf anderen Websites, was bedeutet, dass wir 5 statt 1 blockieren k√∂nnen. <br><br><h3>  Backend-Suche </h3><br>  Dieser Vorgang ist erforderlich, um festzustellen, wo sich der sch√§dliche Server tats√§chlich befindet. <br>  99% der Kartengesch√§fte, Hacking-Foren, viele Phishing-Ressourcen und andere b√∂sartige Server verstecken sich sowohl hinter ihren eigenen Proxyservern als auch hinter Proxys legitimer Dienste, beispielsweise Cloudflare.  Das Wissen √ºber das echte Backend ist f√ºr Untersuchungen sehr wichtig: Es wird bekannt, von welchem ‚Äã‚ÄãHosting-Anbieter Sie den Server entfernen k√∂nnen, und es wird m√∂glich, Verbindungen zu anderen sch√§dlichen Projekten aufzubauen. <br><br>  Sie haben beispielsweise eine Phishing-Site zum Sammeln von Bankkartendaten, die in die IP-Adresse 11/11/11/11 aufgel√∂st werden, und eine Kartengesch√§ftsadresse, die in die IP-Adresse 22.22.22.22 aufgel√∂st wird.  W√§hrend der Analyse kann sich herausstellen, dass sowohl die Phishing-Site als auch der Kartenladen eine gemeinsame Backend-IP-Adresse haben, z. B. 33.33.33.33.  Mit diesem Wissen k√∂nnen Sie eine Verbindung zwischen Phishing-Angriffen und einem Kartengesch√§ft herstellen, in dem m√∂glicherweise Bankkartendaten verkauft werden. <br><br><h3>  Ereigniskorrelation </h3><br>  Wenn Sie zwei verschiedene Ausl√∂ser (z. B. auf IDS) mit unterschiedlicher Malware und unterschiedlichen Servern haben, um den Angriff zu steuern, werden Sie diese als zwei unabh√§ngige Ereignisse betrachten.  Wenn jedoch eine gute Verbindung zwischen b√∂swilligen Infrastrukturen besteht, wird deutlich, dass es sich nicht um unterschiedliche Angriffe handelt, sondern um Phasen eines komplexeren mehrstufigen Angriffs.  Und wenn eines der Ereignisse bereits einer Gruppe von Angreifern zugeordnet ist, kann das zweite auch derselben Gruppe zugeordnet werden.  Nat√ºrlich ist der Zuschreibungsprozess viel komplexer. Behandeln Sie das Schreiben daher als einfaches Beispiel. <br><br><h3>  Anreicherungsindikatoren </h3><br>  Wir werden dem nicht viel Aufmerksamkeit schenken, da dies das h√§ufigste Szenario f√ºr die Verwendung von Diagrammen in der Cybersicherheit ist: Sie geben der Eingabe einen Indikator und Sie erhalten eine Reihe verwandter Indikatoren am Ausgang. <br><br><h3>  Mustererkennung </h3><br>  Die Identifizierung von Mustern ist f√ºr eine effektive Jagd unerl√§sslich.  Mithilfe von Diagrammen k√∂nnen Sie nicht nur verwandte Elemente finden, sondern auch gemeinsame Eigenschaften aufdecken, die einer bestimmten Gruppe von Hackern eigen sind.  Wenn Sie solche einzigartigen Funktionen kennen, k√∂nnen Sie die Infrastruktur des Angreifers bereits in der Vorbereitungsphase erkennen, ohne dass Beweise f√ºr den Angriff vorliegen, z. B. Phishing-E-Mails oder Malware. <br><br><h1>  <font color="#e63619">Warum haben wir unser eigenes Netzwerkdiagramm erstellt?</font> </h1><br>  Ich wiederhole, dass wir L√∂sungen von verschiedenen Lieferanten in Betracht gezogen haben, bevor wir zu dem Schluss kamen, dass wir unser eigenes Tool entwickeln m√ºssen, das das kann, was in keinem vorhandenen Produkt zu finden ist.  Die Erstellung hat mehrere Jahre gedauert. In dieser Zeit haben wir sie mehr als einmal vollst√§ndig ge√§ndert.  Trotz der langen Entwicklungszeit haben wir noch kein einziges Analogon gefunden, das unseren Anforderungen entspricht.  Mit unserem eigenen Produkt konnten wir fast alle Probleme l√∂sen, die wir in vorhandenen Netzwerkgraphen gefunden haben.  Nachfolgend betrachten wir diese Probleme im Detail: <br><br><div class="scrollable-table"><table><tbody><tr><th width="350">  Das Problem </th><th width="350">  L√∂sung </th></tr><tr><td>  Fehlen eines Anbieters mit unterschiedlichen Datensammlungen: Dom√§nen, passives DNS, passives SSL, DNS-Eintr√§ge, offene Ports, Ausf√ºhren von Diensten auf Ports, Dateien, die mit Dom√§nennamen und IP-Adressen interagieren.  Erkl√§rung.  Lieferanten stellen normalerweise separate Datentypen zur Verf√ºgung. Um ein vollst√§ndiges Bild zu erhalten, m√ºssen Sie Abonnements von allen kaufen.  Trotzdem ist es nicht immer m√∂glich, alle Daten abzurufen: Einige passive SSL-Anbieter stellen nur Daten zu Zertifikaten bereit, die von vertrauensw√ºrdigen Zertifizierungsstellen ausgestellt wurden, und die Abdeckung selbstsignierter Zertifikate ist √§u√üerst gering.  Andere stellen Daten zu selbstsignierten Zertifikaten bereit, erfassen diese jedoch nur √ºber Standardports. </td><td>  Wir haben alle oben genannten Sammlungen selbst gesammelt.  Um beispielsweise Daten zu SSL-Zertifikaten zu erfassen, haben wir einen eigenen Dienst geschrieben, der diese von vertrauensw√ºrdigen Zertifizierungsstellen erfasst und den gesamten IPv4-Bereich durchsucht.  Zertifikate wurden nicht nur von IP, sondern auch von allen Domains und Subdomains aus unserer Datenbank gesammelt: Wenn Sie die Domain example.com und ihre Subdomain <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.example.com haben</a> und alle in IP 1.1.1.1 aufgel√∂st werden, versuchen Sie, SSL- zu erhalten. Zertifikat von Port 443 nach IP, Domain und Subdomain erhalten Sie drei verschiedene Ergebnisse.  Um Daten √ºber offene Ports zu sammeln und Dienste auszuf√ºhren, musste ich mein eigenes verteiltes Scansystem erstellen, da f√ºr andere Dienste die IP-Adressen von Scanservern h√§ufig auf den ‚Äûschwarzen Listen‚Äú standen.  Unsere Scan-Server sind ebenfalls auf der schwarzen Liste, aber das Ergebnis der Suche nach den von uns ben√∂tigten Diensten ist h√∂her als bei denen, die einfach so viele Ports wie m√∂glich scannen und den Zugriff auf diese Daten verkaufen. </td></tr><tr><td>  Fehlender Zugriff auf die gesamte Datenbank historischer Aufzeichnungen.  Erkl√§rung.  Jeder normale Lieferant hat eine gute akkumulierte Historie, aber aus nat√ºrlichen Gr√ºnden konnten wir als Kunde nicht auf alle historischen Daten zugreifen.  Das hei√üt,  Sie k√∂nnen die gesamte Geschichte √ºber einen separaten Datensatz abrufen, z. B. nach Domain oder IP-Adresse. Sie k√∂nnen jedoch nicht die gesamte Geschichte anzeigen - und ohne diese k√∂nnen Sie nicht das gesamte Bild anzeigen. </td><td>  Um so viele historische Aufzeichnungen wie m√∂glich nach Domain zu sammeln, haben wir verschiedene Datenbanken gekauft, viele offene Ressourcen analysiert, die diese Historie besa√üen (es ist gut, dass es viele davon gab), und uns mit Domainnamen-Registraren einverstanden erkl√§rt.  Alle Aktualisierungen in unseren eigenen Sammlungen werden nat√ºrlich mit einer vollst√§ndigen √Ñnderungshistorie gespeichert. </td></tr><tr><td>  Mit allen vorhandenen L√∂sungen k√∂nnen Sie ein Diagramm im manuellen Modus erstellen.  Erkl√§rung.  Angenommen, Sie haben viele Abonnements von allen m√∂glichen Datenanbietern gekauft (normalerweise werden sie als "Anreicherung" bezeichnet).  Wenn Sie ein Diagramm erstellen m√ºssen, geben Sie den Befehl "hands" ein, um aus dem gew√ºnschten Kommunikationselement zu erstellen. W√§hlen Sie dann aus den angezeigten Elementen die erforderlichen aus und geben Sie den Befehl ein, um die Verbindungen von ihnen aus herzustellen, und so weiter.  In diesem Fall liegt die Verantwortung daf√ºr, wie gut das Diagramm erstellt wird, vollst√§ndig bei der Person. </td><td>  Wir haben automatisch grafisch dargestellt.  Das hei√üt,  Wenn Sie ein Diagramm erstellen m√ºssen, werden Verbindungen vom ersten Element automatisch erstellt, weiter von allen nachfolgenden.  Der Spezialist gibt nur die Tiefe an, mit der das Diagramm erstellt werden soll.  Das automatische Ausf√ºllen von Diagrammen ist einfach, aber andere Anbieter implementieren es nicht, da es eine Vielzahl irrelevanter Ergebnisse liefert, und wir mussten auch diesen Nachteil ber√ºcksichtigen (siehe unten). </td></tr><tr><td>  Viele irrelevante Ergebnisse sind das Problem aller Diagramme auf Netzwerkelementen.  Erkl√§rung.  Beispielsweise ist eine ‚Äûfehlerhafte Dom√§ne‚Äú (die an dem Angriff teilgenommen hat) einem Server zugeordnet, dem in den letzten 10 Jahren 500 andere Dom√§nen zugeordnet wurden.  Wenn Sie ein Diagramm manuell hinzuf√ºgen oder automatisch erstellen, sollten alle diese 500 Dom√§nen auch in das Diagramm kriechen, obwohl sie nicht mit dem Angriff zusammenh√§ngen.  Oder Sie √ºberpr√ºfen beispielsweise die IP-Anzeige im Sicherheitsbericht des Anbieters.  In der Regel werden solche Berichte mit einer erheblichen Verz√∂gerung ver√∂ffentlicht und decken h√§ufig ein Jahr oder l√§nger ab.  In dem Moment, in dem Sie den Bericht lesen, ist der Server mit dieser IP-Adresse h√∂chstwahrscheinlich bereits an andere Personen mit anderen Verbindungen vermietet, und die Erstellung des Diagramms f√ºhrt dazu, dass Sie erneut irrelevante Ergebnisse erhalten haben. </td><td>  Wir haben das System geschult, um irrelevante Elemente nach der gleichen Logik wie unsere Experten von Hand zu identifizieren.  Sie √ºberpr√ºfen beispielsweise die fehlerhafte Domain example.com, die jetzt in IP 11.11.11.11 und vor einem Monat in IP 22.22.22.22 aufgel√∂st wird.  Zus√§tzlich zur Domain example.com ist example.ru IP 11.11.11.11 zugeordnet, und 25.000 andere Domains sind IP 22.22.22.22 zugeordnet.  Das System versteht wie eine Person, dass es sich bei 11.11.11.11 h√∂chstwahrscheinlich um einen dedizierten Server handelt. Da die Domain example.ru in der Schreibweise example.com √§hnelt, sind sie mit hoher Wahrscheinlichkeit verbunden und sollten in der Grafik angezeigt werden.  IP 22.22.22.22 geh√∂rt jedoch zum Shared Hosting, sodass Sie nicht alle Domains in das Diagramm einf√ºgen m√ºssen, wenn keine anderen Verbindungen vorhanden sind, aus denen hervorgeht, dass eine dieser 25.000 Domains ebenfalls entfernt werden muss (z. B. example.net).  Bevor das System erkennt, dass die Verbindungen unterbrochen werden m√ºssen und einige der Elemente nicht in das Diagramm aufgenommen werden sollten, ber√ºcksichtigt es die vielen Eigenschaften der Elemente und Cluster, in denen diese Elemente kombiniert werden, sowie die St√§rke der aktuellen Verbindungen.  Wenn wir beispielsweise einen kleinen Cluster (50 Elemente) in der Grafik haben, der eine fehlerhafte Dom√§ne enth√§lt, und einen weiteren gro√üen Cluster (5.000 Elemente) und beide Cluster durch eine Verbindung (Linie) mit sehr geringer St√§rke (Gewicht) verbunden sind, wird diese Verbindung unterbrochen und Elemente aus dem gro√üen Cluster werden gel√∂scht.  Wenn es jedoch viele Verbindungen zwischen kleinen und gro√üen Clustern gibt und deren St√§rke allm√§hlich zunimmt, wird in diesem Fall die Verbindung nicht unterbrochen und die erforderlichen Elemente aus beiden Clustern verbleiben im Diagramm. <br></td></tr><tr><td>  Das Eigentumsintervall des Servers und der Dom√§ne wird nicht ber√ºcksichtigt.  Erkl√§rung.  Die Registrierung von "fehlerhaften Domains" l√§uft fr√ºher oder sp√§ter ab und sie werden f√ºr b√∂swillige oder legitime Zwecke erneut gekauft.  Selbst beim kugelsicheren Hosting werden Server an verschiedene Hacker vermietet. Daher ist es wichtig, das Intervall zu kennen und zu ber√ºcksichtigen, in dem eine bestimmte Domain / ein bestimmter Server unter der Kontrolle eines Eigent√ºmers stand.  Wir sto√üen h√§ufig auf eine Situation, in der ein Server mit IP 11.11.11.11 jetzt als C &amp; C f√ºr einen Bankbot verwendet wird und Ransomware vor zwei Monaten verwaltet wurde.  Wenn Sie eine Verbindung aufbauen, ohne die Eigentumsintervalle zu ber√ºcksichtigen, sieht es so aus, als ob eine Verbindung zwischen den Eigent√ºmern des Bank-Botnetzes und der Ransomware besteht, obwohl dies tats√§chlich nicht der Fall ist.  In unserer Arbeit ist ein solcher Fehler kritisch. </td><td>  Wir haben dem System beigebracht, die Eigentumsintervalle zu bestimmen.  F√ºr Domains ist dies relativ einfach, da whois h√§ufig Start- und Enddaten f√ºr Registrierungen anzeigt. Wenn eine vollst√§ndige Historie der whois-√Ñnderungen vorliegt, ist das Bestimmen von Intervallen einfach.  Wenn die Domain nicht abgelaufen ist, ihre Verwaltung jedoch auf andere Eigent√ºmer √ºbertragen wurde, k√∂nnen Sie sie auch nachverfolgen.  Es gibt kein solches Problem f√ºr SSL-Zertifikate, da es einmal ausgestellt, nicht erneuert und nicht √ºbertragen wird.  Bei selbstsignierten Zertifikaten k√∂nnen Sie den in den Ablaufdaten des Zertifikats angegebenen Daten nicht vertrauen, da Sie heute ein SSL-Zertifikat erstellen und das Startdatum des Zertifikats ab 2010 angeben k√∂nnen.  Am schwierigsten ist es, die Eigentumsintervalle f√ºr die Server zu bestimmen, da nur die Hosting-Anbieter die Daten und Mietvertr√§ge haben.  Um die Besitzdauer des Servers zu bestimmen, haben wir begonnen, die Ergebnisse des Port-Scans zu verwenden und Fingerabdr√ºcke von ausgef√ºhrten Diensten auf den Ports zu erstellen.  Anhand dieser Informationen k√∂nnen wir ziemlich genau sagen, wann sich der Serverbesitzer ge√§ndert hat. </td></tr><tr><td>  Nur wenige Verbindungen.  Erkl√§rung.  Jetzt ist es kein Problem mehr, eine kostenlose Liste von Domains mit einer bestimmten E-Mail-Adresse zu erhalten oder alle Domains herauszufinden, die einer bestimmten IP-Adresse zugeordnet waren.  Wenn es jedoch um Hacker geht, die alles tun, um die Verfolgung zu erschweren, sind zus√§tzliche ‚ÄûTricks‚Äú erforderlich, um neue Eigenschaften zu finden und neue Verbindungen aufzubauen. </td><td>  Wir haben viel Zeit damit verbracht, zu untersuchen, wie Daten abgerufen werden k√∂nnen, die nicht auf die √ºbliche Weise verf√ºgbar sind.  Wir k√∂nnen hier aus offensichtlichen Gr√ºnden nicht beschreiben, wie dies funktioniert, aber unter bestimmten Umst√§nden machen Hacker Fehler bei der Registrierung von Domains oder beim Mieten und Einrichten von Servern, mit denen Sie E-Mail-Adressen, Hacker-Aliase und Backend-Adressen herausfinden k√∂nnen.  Je mehr Verbindungen Sie extrahieren, desto genauer k√∂nnen Sie Diagramme erstellen. <br></td></tr></tbody></table></div><br><h1>  <font color="#e63619">Wie unser Diagramm funktioniert</font> </h1><br>  Um das Netzwerkdiagramm verwenden zu k√∂nnen, m√ºssen Sie die Dom√§ne, IP-Adresse, E-Mail-Adresse oder den Fingerabdruck des SSL-Zertifikats in das Suchfeld eingeben.  Es gibt drei Bedingungen, die ein Analyst steuern kann: Zeit, Schritttiefe und Reinigung. <br><br><img src="https://habrastorage.org/webt/tc/dp/fy/tcdpfyhagm1jh52ksaklg5ohsko.png"><br><br><h4>  Zeit </h4><br>  Uhrzeit - Datum oder Intervall, in dem das Suchelement f√ºr b√∂swillige Zwecke verwendet wurde.  Wenn Sie diesen Parameter nicht angeben, ermittelt das System das letzte Besitzintervall dieser Ressource.  Am 11. Juli ver√∂ffentlichte Eset beispielsweise einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht</a> dar√ºber, wie Buhtrap einen 0-Tage-Exploit f√ºr Cyberspionage einsetzt.  Am Ende des Berichts stehen 6 Indikatoren.  Eine davon, Secure-Telemetry [.] Net, wurde am 16. Juli erneut registriert.  Wenn Sie nach dem 16. Juli ein Diagramm erstellen, erhalten Sie daher irrelevante Ergebnisse.  Wenn Sie jedoch angeben, dass diese Domain vor diesem Datum verwendet wurde, werden 126 neue Domains und 69 IP-Adressen, die nicht im Eset-Bericht aufgef√ºhrt sind, in der Grafik angezeigt: <br><br><ul><li>  ukrfreshnews [.] com </li><li>  unian-search [.] com </li><li>  vesti-world [.] info </li><li>  runewsmeta [.] com </li><li>  foxnewsmeta [.] biz </li><li>  sobesednik-meta [.] info </li><li>  rian-ua [.] net </li><li>  usw. </li></ul><br>  Zus√§tzlich zu den Netzwerkindikatoren finden wir sofort Links zu sch√§dlichen Dateien mit Links zu dieser Infrastruktur und Tags, die uns mitteilen, dass Meterpreter, AZORult verwendet wurden. <br><br>  Das Tolle ist, dass Sie dieses Ergebnis in einer Sekunde erhalten und keine Tage mehr damit verbringen m√ºssen, die Daten zu analysieren.  Nat√ºrlich reduziert dieser Ansatz manchmal die Zeit f√ºr Untersuchungen um ein Vielfaches, was oft kritisch ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/oi/an/h4oianoutpvnbrb2f3hhukxxtge.png"></div><br><h4>  Die Anzahl der Schritte oder die Rekursionstiefe, mit der das Diagramm erstellt wird </h4><br>  Standardm√§√üig ist die Tiefe 3. Dies bedeutet, dass alle direkt verwandten Elemente aus dem erforderlichen Element gefunden werden, dann jedes neue Element neue Verbindungen zu anderen Elementen erstellt wird und aus den neuen Elementen aus dem letzten Schritt neue Elemente erstellt werden. <br><br>  Nehmen Sie ein Beispiel, das nicht mit APT und 0-Tage-Exploits zusammenh√§ngt.  K√ºrzlich hat Habr√© einen interessanten Fall mit Betrug im Zusammenhang mit Kryptow√§hrungen beschrieben.  Der Bericht erw√§hnt die Domain - themcx [.] Co, die von Betr√ºgern verwendet wird, um die Site des angeblich austauschbaren Miner Coin Exchange und die Telefonsuche [.] Xyz zu hosten, um den Verkehr anzuziehen. <br><br>  Aus der Beschreibung geht hervor, dass das System eine ausreichend gro√üe Infrastruktur erfordert, um den Verkehr auf betr√ºgerische Ressourcen zu lenken.  Wir haben uns entschlossen, diese Infrastruktur zu betrachten, indem wir in 4 Schritten ein Diagramm erstellt haben.  Die Ausgabe war ein Diagramm mit 230 Dom√§nen und 39 IP-Adressen.  Als N√§chstes unterteilen wir die Dom√§nen in zwei Kategorien: diejenigen, die den Diensten f√ºr die Arbeit mit Kryptow√§hrungen √§hnlich sind, und diejenigen, die den Datenverkehr √ºber die Telefon√ºberpr√ºfungsdienste abfangen sollen: <br><div class="scrollable-table"><table><tbody><tr><th width="350">  Kryptow√§hrung bezogen </th><th width="350">  Verbunden mit Telefon-Stanzdiensten </th></tr><tr><td>  M√ºnzhalter [.] cc </td><td>  Caller-Record [.] Site. </td></tr><tr><td>  mcxwallet [.] co </td><td>  Telefonaufzeichnungen [.] Speicherplatz </td></tr><tr><td>  btcnoise [.] com </td><td>  Fone-Uncover [.] xyz </td></tr><tr><td>  Cryptominer [.] beobachten </td><td>  nummer aufdecken [.] info </td></tr></tbody></table></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/cj/ve/yqcjvezppd6oulazlfojthyfqwk.png"></div><br><h4>  Reinigung </h4><br>  Standardm√§√üig ist die Option "Diagramm l√∂schen" aktiviert und alle irrelevanten Elemente werden aus dem Diagramm gel√∂scht.  √úbrigens wurde es in allen vorhergehenden Beispielen verwendet.  Ich sehe eine nat√ºrliche Frage voraus: Wie kann sichergestellt werden, dass etwas Wichtiges nicht verschwindet? :  ,     ,         = 1.                 . <br><br>         whois, DNS,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/wd/yz/hcwdyzowhht2vljiyxzcspjdgaa.png"></div><br><h3>   </h3><br>     APT- ,               .       ,      ,        ,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8b/6v/st/8b6vstloohn7p-vq4wqngh-_ara.png"></div><br>         .      ‚Äî lloydsbnk-uk[.]com,          3 ,    250  ,       2015    .       ,     ,       . <br><br>          2 . <br><br> ,    2019               -,          . ,  swift-department.com, saudconsultancy.com, vbgrigoryanpartners.com. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/vs/5s/kvvs5sma6yo7kym8lq3fomys67e.png"></div><br><h3> Cobalt gang </h3><br>   2018    Cobalt,      ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/gs/57/gqgs57x9zvmfioavsfo5u-04p1k.png"></div><br>      hXXps://nationalbank.bz/Doc/Prikaz.doc.    ,  powershell,        hXXp://wateroilclub.com/file/dwm.exe  %Temp%\einmrmdmy.exe.  %Temp%\einmrmdmy.exe aka dwm.exe ‚Äî CobInt stager,      hXXp://admvmsopp.com/rilruietguadvtoefmuy. <br><br> ,               .     nationalbank[.]bz       ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wa/yv/rg/wayvrgnysrvft9tjv8p_apiwis4.png"></div><br>     IP- 46.173.219[.]152           .    40 , , bl0ckchain[.]ug <br> paypal.co.uk.qlg6[.]pw <br> cryptoelips[.]com <br><br>    ,       ,    ,              ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/he/au/mt/heaumtr6jhhfktfn6qgjttwkzt0.png"></div><br>      nationalbank[.]bz,     ,      500             Cobalt,    . ,      : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pz/kc/f4/pzkcf4fyxxhaqmem5jzwb9ituti.png"></div><br><h1>  <font color="#e63619">Fazit</font> </h1><br>     ,    ,             ,         .          .    ,        ,     ,   .      ‚Äú‚Äù   ,   .       ,         .               .          Group-IB        .        .  ,   ,         ,   ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461639/">https://habr.com/ru/post/de461639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461625/index.html">Die Zusammenfassung interessanter Materialien f√ºr den mobilen Entwickler # 308 (22. - 28. Juli)</a></li>
<li><a href="../de461629/index.html">12 Schritte, um Remote-Arbeit zu finden</a></li>
<li><a href="../de461631/index.html">17 M√∂glichkeiten, in das interne Netzwerk des Unternehmens einzudringen</a></li>
<li><a href="../de461633/index.html">Digitale Veranstaltungen in Moskau vom 29. Juli bis 4. August</a></li>
<li><a href="../de461637/index.html">Der saudische Prinz plant den Bau einer Stadt der Zukunft mit k√ºnstlichem Regen, intelligenten Systemen und genetischer Medizin</a></li>
<li><a href="../de461641/index.html">Probleml√∂sung mit pwnable.kr 11-coin1, 12-blackjack, 13-lotto. Fehler in der Anwendungslogik</a></li>
<li><a href="../de461643/index.html">Wie sind Sie zur Alfa Bank School of System Analysis gekommen?</a></li>
<li><a href="../de461645/index.html">Einf√ºhrung in SwiftUI: Erstellen einer einfachen Anwendung mit TableView</a></li>
<li><a href="../de461647/index.html">5 wichtige und fehlende F√§higkeiten, die der beste Entwickler ben√∂tigt</a></li>
<li><a href="../de461649/index.html">Wie werde ich die Welt retten?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>