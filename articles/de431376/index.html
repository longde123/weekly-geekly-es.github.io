<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚵🏼 👅 💫 Datenmigration im blutigen Unternehmen: Was zu analysieren ist, um das Projekt nicht zu überfordern 👐🏾 🥫 ↘️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein für uns typisches Systemintegrationsprojekt sieht folgendermaßen aus: Der Kunde verfügt über einen Systemtransport für Buchhaltungskunden. Die Auf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Datenmigration im blutigen Unternehmen: Was zu analysieren ist, um das Projekt nicht zu überfordern</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/431376/"><img src="https://habrastorage.org/webt/yk/_w/ry/yk_wry8j7irc6ma2zn65mdw0ulq.jpeg"><br><br>  Ein für uns typisches Systemintegrationsprojekt sieht folgendermaßen aus: Der Kunde verfügt über einen Systemtransport für Buchhaltungskunden. Die Aufgabe besteht darin, Kundenkarten in einer einzigen Datenbank zu sammeln.  Und nicht nur zum Sammeln, sondern auch zum Entfernen von Duplikaten und Müll.  Um saubere, strukturierte und vollständige Kundenkarten zu erhalten. <br><br>  Für Anfänger werde ich erklären, dass die Migration nach diesem Schema verläuft: <i>Quellen → Datenkonvertierung ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ETL</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bus</a> antwortet) → Empfänger</i> . <br><br>  Bei einem Projekt haben wir drei Monate verloren, nur weil ein Drittanbieter-Team von Integratoren die Daten in den Quellsystemen nicht untersucht hat.  Das nervigste war, dass dies hätte vermieden werden können. <br><a name="habracut"></a><br>  Sie arbeiteten so: <br><br><ol><li>  Systemintegratoren passen den ETL-Prozess an. </li><li>  ETL transformiert die Quelldaten und gibt sie mir. </li><li>  Ich studiere das Entladen und sende Fehler an Integratoren. </li><li>  Integratoren korrigieren ETLs und starten die Migration erneut. </li></ol><br>  In dem Artikel werde ich zeigen, wie Daten während der Systemintegration analysiert werden.  Ich habe ETL-Uploads studiert, es war sehr nützlich.  Bei den Quelldaten würden dieselben Techniken die Arbeit jedoch zweimal beschleunigen. <br><br>  Tipps sind nützlich für Tester, Implementierer von Unternehmensprodukten, Systemintegratoren und Analysten.  Empfänge sind universell für relationale Datenbanken und werden vollständig auf Volumina von einer Million Kunden offengelegt. <br><br>  Aber zuerst über einen der Hauptmythen der Systemintegration. <br><br><h2>  Die Dokumentation und der Architekt helfen (eigentlich nicht) </h2><br>  Integratoren untersuchen Daten häufig nicht vor der Migration - sie sparen Zeit.  Sie lesen die Dokumentation, schauen sich die Struktur an, sprechen mit dem Architekten - und das reicht.  Danach planen sie bereits die Integration. <br><br>  Es stellt sich als schlecht heraus.  Nur eine Analyse zeigt, was wirklich in der Datenbank vor sich geht.  Wenn Sie nicht mit hochgekrempelten Ärmeln und einer Lupe in die Daten gelangen, geht die Migration schief. <br><br>  <b>Die Dokumentation lügt.</b>  Ein typisches Unternehmenssystem läuft 5–20 Jahre.  In all den Jahren wurden Änderungen von verschiedenen Abteilungen und Auftragnehmern dokumentiert.  Jedes mit einem eigenen Glockenturm.  Daher gibt es keine Integrität in der Dokumentation, niemand versteht die Logik und Struktur der Datenspeicherung vollständig.  Ganz zu schweigen davon, dass die Fristen immer eingehalten werden und nicht genügend Zeit für die Dokumentation vorhanden ist. <br><br>  Eine gemeinsame Geschichte: In der Kundentabelle befindet sich ein Feld „SNILS“, auf dem Papier ist es sehr wichtig.  Aber wenn ich mir die Daten ansehe, sehe ich - das Feld ist leer.  Infolgedessen stimmt der Kunde zu, dass die Zielbasis auf ein Feld für SNILS verzichten wird, da noch keine Daten vorhanden sind. <br><br>  Ein Sonderfall der Dokumentation sind Vorschriften und Beschreibungen von Geschäftsprozessen: Wie gelangen die Daten unter welchen Umständen in welchem ​​Format in die Datenbank?  All dies wird auch nicht helfen. <br><br>  <b>Geschäftsprozesse sind nur auf dem Papier perfekt.</b>  Am frühen Morgen kommt der verschlafene Operator Anatoly in das Büro der Bank am Stadtrand von Vyksa.  Unter dem Fenster schrien sie die ganze Nacht und am Morgen hatte Anatoly einen Streit mit dem Mädchen.  Er hasst die ganze Welt. <br><br>  Die Nerven sind noch nicht in Ordnung gebracht, und Anatoly treibt den Namen des neuen Kunden vollständig in das Feld für den Nachnamen.  Er vergisst seinen Geburtstag völlig - der Standardwert „01.01.1900 g“ bleibt in der Form.  Ich kümmere mich nicht um Vorschriften, wenn alles so wütend ist !!! <br><br>  Chaos erobert Geschäftsprozesse, die auf dem Papier sehr gut proportioniert sind. <br><br>  <b>Ein Systemarchitekt weiß nicht alles.</b>  Es geht wieder um die ehrwürdige Lebensdauer von Unternehmenssystemen.  Im Laufe der Jahre, in denen sie arbeiten, haben sich die Architekten verändert.  Selbst wenn Sie mit dem aktuellen sprechen, werden die Entscheidungen der vorherigen während des Projekts als Überraschungen erscheinen. <br><br>  Und seien Sie sicher: Selbst ein angenehmer Architekt wird in jeder Hinsicht seine Fälschung und Krücken des Systems geheim halten. <br><br>  Die Integration "durch Instrumente" ohne Datenanalyse ist ein Fehler.  Ich werde zeigen, wie wir bei HFLabs Daten durch Systemintegration lernen.  Im letzten Projekt habe ich nur ETL-Uploads analysiert.  Wenn der Kunde jedoch Zugriff auf die Quelldaten gewährt, überprüfe ich diese auf jeden Fall nach denselben Grundsätzen. <br><br><h2>  Gefüllte Felder und Nullwerte </h2><br>  Die einfachsten Überprüfungen betreffen die Vollständigkeit der Tabellen insgesamt und die Vollständigkeit einzelner Felder.  Ich fange mit ihnen an. <br><br>  <b>Wie viele Zeilen insgesamt sind in der Tabelle.</b>  Die einfachste Anfrage möglich. <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt;;</code> </pre> <br>  Ich bekomme das erste Ergebnis. <br><div class="scrollable-table"><table><tbody><tr><th>  Einzelpersonen </th><th>  Menge </th></tr><tr><td>  Insgesamt </td><td>  99 966 324 </td></tr></tbody></table></div>  Hier schaue ich auf die Angemessenheit der Daten.  Wenn nur zwei Millionen Kunden für eine große Bank zum Entladen kamen, stimmt etwas eindeutig nicht.  Aber während alles wie erwartet aussieht, geht es weiter. <br><br>  <b>Wie viele Zeilen werden für jedes Feld separat ausgefüllt?</b>  Ich überprüfe alle Spalten der Tabelle. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt;, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> &lt;column_name&gt; cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre> <br>  Der erste stieß auf ein Happy Birthday-Feld und war sofort neugierig: Aus irgendeinem Grund kamen die Daten überhaupt nicht. <br><div class="scrollable-table"><table><tbody><tr><th>  Einzelpersonen </th><th>  Menge </th></tr><tr><td>  Insgesamt </td><td>  99 966 324 </td></tr><tr><td>  DR </td><td>  0 </td></tr></tbody></table></div>  Wenn alle Werte im Feld beim Upload "NULL" sind, sehe ich mir zuerst das Quellsystem an.  Möglicherweise werden die Daten dort ordnungsgemäß gespeichert, sie gingen jedoch während der Migration verloren. <br><br>  Ich sehe, dass im Quellsystem die Geburtstage vorhanden sind.  Ich gehe zu den Integratoren: Leute, Fehler.  Es stellte sich heraus, dass im ETL-Prozess die Dekodierungsfunktion nicht richtig funktionierte.  Der Code wurde behoben, beim nächsten Upload werden wir die Änderungen überprüfen. <br><br>  Ich gehe mit der TIN weiter zum Feld. <br><div class="scrollable-table"><table><tbody><tr><th>  Einzelpersonen </th><th>  Menge </th></tr><tr><td>  Insgesamt </td><td>  99 966 324 </td></tr><tr><td>  DR </td><td>  0 </td></tr><tr><td>  Zinn </td><td>  65 136 </td></tr></tbody></table></div>  Die Datenbank enthält 100 Millionen Menschen, und nur 65.000 sind mit TINs gefüllt - das sind 0,07%.  Eine solch schwache Belegung ist ein Signal dafür, dass das Feld in der Empfängerbasis möglicherweise überhaupt nicht notwendig ist. <br><br>  Ich überprüfe das Quellsystem, alles ist korrekt: Die TIN ähnelt den tatsächlichen, aber es gibt fast keine.  Es geht also nicht um Migration.  Es bleibt abzuwarten, ob der Kunde ein fast leeres Feld unter der TIN in der Zieldatenbank benötigt. <br><br>  Ich bin zum Client-Entfernungsflag gekommen. <br><div class="scrollable-table"><table><tbody><tr><th>  Einzelpersonen </th><th>  Menge </th></tr><tr><td>  Insgesamt </td><td>  99 966 324 </td></tr><tr><td>  DR </td><td>  0 </td></tr><tr><td>  Zinn </td><td>  65 136 </td></tr><tr><td>  Flag löschen </td><td>  0 </td></tr></tbody></table></div>  Flaggen sind leer.  Aber was, das Unternehmen entfernt keine Kunden?  Ich schaue auf das Quellsystem und spreche mit dem Kunden.  Es stellt sich heraus, dass ja: Die Flagge ist formal, anstatt Kunden zu löschen, werden ihre Konten gelöscht.  Keine Konten - als ob der Client gelöscht worden wäre. <br><br>  Im Zielsystem ist das Remote-Client-Flag erforderlich. Dies ist ein Merkmal der Architektur.  Wenn der Client also keine Konten im Empfängersystem hat, muss er durch zusätzliche Logik geschlossen oder überhaupt nicht importiert werden.  Dann, wie der Kunde entscheidet. <br><br>  Als nächstes ist das Adressschild.  Normalerweise stimmt etwas mit solchen Tabellen nicht, da Adressen eine komplizierte Sache sind und auf unterschiedliche Weise eingegeben werden. <br><br>  Ich überprüfe die Vollständigkeit der Komponenten der Adresse. <br><div class="scrollable-table"><table><tbody><tr><th>  Adressen </th><th>  Menge </th></tr><tr><td>  Insgesamt </td><td>  254 803 976 </td></tr><tr><td>  Land </td><td>  229 256 090 </td></tr><tr><td>  Index </td><td>  46 834 777 </td></tr><tr><td>  Stadt </td><td>  6 474 841 </td></tr><tr><td>  Straße </td><td>  894.040 </td></tr><tr><td>  Haus </td><td>  20 903 </td></tr></tbody></table></div>  Die Adressen sind nicht einheitlich ausgefüllt, aber es ist noch zu früh, um Schlussfolgerungen zu ziehen: Zuerst frage ich den Kunden, wofür sie bestimmt sind.  Wenn für die Segmentierung nach Ländern alles in Ordnung ist: Es gibt genügend Daten.  Wenn für Mailinglisten, dann ist das Problem: Die Häuser sind fast leer, es gibt keine Wohnungen. <br><br>  Infolgedessen stellte der Kunde fest, dass die ETL Adressen von einem alten und irrelevanten Tablet abnahm.  Sie ist in der Basis wie ein Denkmal.  Aber es gibt noch eine andere Tabelle, neu und gut, die Daten müssen daraus entnommen werden. <br><br>  Während der Analyse fülle ich die Felder, die mit Verzeichnissen verknüpft sind, besonders aus.  Die Bedingung "IST NICHT NULL" funktioniert bei ihnen nicht: Anstelle von "NULL" ist die Zelle normalerweise "0".  Überprüfen Sie daher die Referenzfelder separat. <br><br>  <b>Änderungen beim Ausfüllen von Feldern.</b>  Also habe ich die Gesamtbelegung und die Belegung jedes Feldes überprüft.  Gefundene Probleme, Integratoren haben den ETL-Prozess behoben und die Migration erneut gestartet. <br><br>  Ich führe das zweite Entladen für alle oben aufgeführten Schritte aus.  Ich schreibe Statistiken in dieselbe Datei, um die Änderungen zu sehen. <br><br>  Vollständigkeit aller Bereiche. <br><div class="scrollable-table"><table><tbody><tr><th>  Einzelpersonen </th><th>  Entladen 1 </th><th>  Entladen 2 </th><th>  Delta </th></tr><tr><td>  Insgesamt </td><td>  99 966 324 </td><td>  94 847 160 </td><td>  -5 119 164 </td></tr></tbody></table></div>  Zwischen den Uploads sind 5 Millionen Datensätze verschwunden.  Ich gehe zu den Integratoren und stelle typische Fragen: <br><br><ul><li>  "Warum gingen die Aufzeichnungen verloren?"; </li><li>  "Welche Daten wurden herausgefiltert?"; </li><li>  "Welche Daten haben Sie hinterlassen?" </li></ul><br>  Es stellt sich heraus, dass es kein Problem gibt: Sie haben einfach die „technischen“ Kunden aus dem neuen Entladen entfernt.  Sie sind in der Datenbank für Tests, sie sind keine lebenden Menschen.  Bei gleicher Wahrscheinlichkeit können die Daten jedoch versehentlich verloren gehen. <br><br>  Aber die Geburtstage beim neuen Entladen erschienen, wie ich erwartet hatte. <br><div class="scrollable-table"><table><tbody><tr><th>  Einzelpersonen </th><th>  Entladen 1 </th><th>  Entladen 2 </th><th>  Delta </th></tr><tr><td>  Insgesamt </td><td>  99 966 324 </td><td>  94 847 160 </td><td>  -5 119 164 </td></tr><tr><td>  DR </td><td>  0 </td><td>  77 046 780 </td><td>  77 046 780 </td></tr></tbody></table></div>  Aber!  Nicht unbedingt gut, wenn zuvor fehlende Daten plötzlich in einem neuen Upload angezeigt wurden.  Zum Beispiel könnten Geburtstage mit Standarddaten gefüllt sein - es gibt nichts, worüber man sich freuen könnte.  Deshalb überprüfe ich immer, welche Daten gekommen sind. <br><br>  <i>Was zu überprüfen, auf den Punkt gebracht.</i> <i><br><br></i> <ol><li>  <i>Die Gesamtzahl der Einträge in den Tabellen.</i>  <i>Entspricht diese Menge den Erwartungen?</i> </li><li>  <i>Die Anzahl der ausgefüllten Zeilen in jedem Feld.</i> </li><li>  <i>Das Verhältnis der Anzahl der gefüllten Zeilen in jedem Feld zur Anzahl der Zeilen in der Tabelle.</i>  <i>Wenn es zu klein ist, ist dies eine Gelegenheit, darüber nachzudenken, ob das Feld auf die Zielbasis gezogen werden soll.</i> </li></ol> <i><br></i>  <i>Wiederholen Sie die ersten drei Schritte für jeden Upload.</i>  <i>Folgen Sie der Dynamik: Wo und warum hat sie zugenommen oder abgenommen.</i> <br><br><h2>  Länge der Werte in Zeichenfolgenfeldern </h2><br>  Ich folge einer der Grundregeln des Testens - ich überprüfe die Grenzwerte. <br><br>  <b>Welche Werte sind zu kurz.</b>  Zu den kürzesten Werten gehört Junk, daher ist es interessant, hier zu graben. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;) &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> <br>  Auf diese Weise überprüfe ich den Namen, die Telefonnummer, die TIN, OKVED und die Website-Adressen.  Unsinn erscheint wie "A * 1", "0", "11", "-" und "...". <br><br>  <b>Ist alles in Ordnung mit Maximalwerten.</b>  Das Nahfeld ist ein Hinweis darauf, dass die Daten während der Übertragung nicht passten und automatisch abgeschnitten wurden.  MySQL knackt dies berühmt ohne Vorwarnung.  Gleichzeitig scheint die Migration reibungslos verlaufen zu sein. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;) = <span class="hljs-number"><span class="hljs-number">65</span></span>;</code> </pre> <br>  Auf diese Weise fand ich im Feld mit der Art des Dokuments die Zeile "Bescheinigung über die Registrierung des Antrags des Einwanderers auf Anerkennung von ihm".  Sie sagte den Integratoren, die Feldlänge sei korrigiert worden. <br><br>  <b>Wie die Werte über die Länge verteilt sind.</b>  In HFLabs rufen wir die Längenverteilungstabelle für die Zeilen auf. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;), <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(&lt;column_name&gt;) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;);</code> </pre> <br>  Hier suche ich nach Anomalien in der Verteilung entlang der Länge.  Hier ist beispielsweise eine Häufigkeit für eine Tabelle mit Postanschriften. <br><div class="scrollable-table"><table><tbody><tr><th>  Länge </th><th>  Menge </th></tr><tr><td>  122 </td><td>  120 </td></tr><tr><td>  123 </td><td>  90 </td></tr><tr><td>  124 </td><td>  130 </td></tr><tr><td>  125 </td><td>  1100 </td></tr><tr><td>  126 </td><td>  70 </td></tr></tbody></table></div>  Werte mit einer Länge von 125 sind zu viele.  Ich schaue in die Quellendatenbank und stelle fest, dass einige der Adressen vor drei Jahren aus irgendeinem Grund auf 125 Zeichen gekürzt wurden.  In anderen Jahren ist alles in Ordnung.  Ich gehe mit diesem Problem zum Kunden und zu den Integratoren, wir verstehen. <br><br>  <i>Was zu überprüfen, auf den Punkt gebracht.</i> <i><br><br></i> <ol><li>  <i>Die kürzesten Werte in Zeichenfolgenfeldern.</i>  <i>Oft sind Zeilen mit weniger als drei Zeichen Müll.</i> </li><li>  <i>Werte, die entlang der Länge der Feldbreite „anliegen“.</i>  <i>Oft werden sie beschnitten.</i> </li><li>  <i>Anomalien in der Verteilung der Zeilen entlang der Länge.</i> </li></ol><br><h2>  Beliebte Werte </h2><br>  Ich teile die Werte, die zu den beliebtesten gehören, in drei Kategorien ein: <br><br><ul><li>  <i>sehr häufig</i> , wie der Name "Tatyana" oder der zweite Vorname "Vladimirovich".  Hier muss daran erinnert werden, dass Tatyana im allgemeinen Fall nicht 100-mal populärer sein sollte als Anna, und Ismail kann kaum populärer sein als Egor; </li><li>  <i>Müll</i> , wie ".", "1", "-" und dergleichen; </li><li>  <i>Standard</i> auf dem Eingabeformular, als "01/01/1900" für Daten. </li></ul><br>  Zwei von drei Fällen sind Marker für das Problem. Es ist nützlich, nach ihnen zu suchen. <br><br>  Ich suche nach beliebten Werten in drei Arten von Feldern: <br><br><ol><li>  Gewöhnliche Zeichenfolgenfelder. </li><li>  Referenzzeichenfolgenfelder.  Dies sind gewöhnliche Zeichenfolgenfelder, aber die Anzahl der verschiedenen Werte in ihnen ist natürlich geregelt.  In diesen Feldern werden Länder, Städte, Monate und Telefontypen gespeichert. </li><li>  Klassifiziererfelder - Sie enthalten einen Link zu einem Eintrag in einer Klassifizierertabelle eines Drittanbieters. </li></ol><br>  Ich studiere die Felder jedes dieser Typen etwas anders. <br><br>  <b>Für Zeichenfolgenfelder - Was sind die 100 beliebtesten Werte?</b>  Wenn Sie möchten, können Sie mehr nehmen, aber in den ersten hundert Werten werden normalerweise alle Anomalien platziert. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt;, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWNUM</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br>  Ich überprüfe die Felder folgendermaßen: <br><br><ul><li>  Vollständiger Name sowie separate Nachnamen, Vornamen und Patronymien; </li><li>  Geburtsdaten und im Allgemeinen alle Daten; </li><li>  Adressen  Sowohl die vollständige Adresse als auch die einzelnen Komponenten, sofern diese in der Datenbank gespeichert sind; </li><li>  Telefone </li><li>  Serie, Nummer, Art, Ausstellungsort der Dokumente. </li></ul><br>  Fast immer unter den populären - Test- und Standardwerten, einige Stubs. <br><br><img src="https://habrastorage.org/webt/hl/sg/cr/hlsgcrpcy9y1i-gpyfoead8byzg.png"><br><br>  Es kommt vor, dass das gefundene Problem überhaupt kein Problem ist.  Einmal fand ich eine verdächtig beliebte Telefonnummer in der Datenbank.  Es stellte sich heraus, dass die Kunden diese Nummer als funktionierend angaben und sich einfach viele Mitarbeiter in derselben Datenbank befanden. <br><br>  Auf dem Weg dorthin zeigt eine solche Analyse versteckte Referenzfelder.  Logischerweise sollen diese Felder keine Verzeichnisse sein, sondern befinden sich tatsächlich in der Datenbank.  Zum Beispiel wähle ich beliebte Werte aus dem Feld "Position" aus, und es gibt nur fünf davon. <br><div class="scrollable-table"><table><tbody><tr><th>  Berufsbezeichnung </th></tr><tr><td>  Regisseur </td></tr><tr><td>  Buchhalter </td></tr><tr><td>  Spezialist </td></tr><tr><td>  Sekretär </td></tr><tr><td>  Systemadministrator </td></tr></tbody></table></div>  Vielleicht dient das Unternehmen nur fünf Berufen.  Nicht sehr wahr, oder?  Vielmehr haben sie im Formular für die Operatoren anstelle einer Zeile ein Verzeichnis erstellt und vergessen, Werte auszugeben.  Die wichtige Frage hier ist: Ist es sinnvoll, Beiträge überhaupt über das Verzeichnis auszufüllen?  Durch die Datenanalyse gehe ich auf mögliche Probleme mit der Bedienersoftware ein. <br><br>  <b>Für Referenzfelder und Klassifikatoren überprüfe ich die Beliebtheit aller Werte.</b>  Zunächst finde ich heraus, welche Felder Verzeichnisse sind.  Mit Skripten kommt man nicht zurecht, ich nehme die Dokumentation und gebe vor, es zu sein.  In der Regel werden Verzeichnisse für Werte erstellt, deren Anzahl natürlich und relativ gering ist: <br><br><ul><li>  Länder </li><li>  Sprachen </li><li>  Währungen </li><li>  Monate </li><li>  die Stadt. </li></ul><br>  In einer idealen Welt ist der Inhalt von Referenzfeldern klar und konsistent.  Aber unsere Welt ist nicht so, also überprüfe ich mit einer Anfrage. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt;, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;</code> </pre> <br>  Normalerweise liegt dies in Zeichenfolgenfeldern von Verzeichnissen. <br><div class="scrollable-table"><table><tbody><tr><th>  Geburtsort </th><th>  Menge </th></tr><tr><td>  Tadschikistan </td><td>  467 599 </td></tr><tr><td>  Tadschikistan </td><td>  410 484 </td></tr><tr><td>  Russland </td><td>  292,585 </td></tr><tr><td>  TAJIKISTAN </td><td>  234,465 </td></tr><tr><td>  Russland </td><td>  158 163 </td></tr><tr><td>  RUSSLAND </td><td>  76 367 </td></tr></tbody></table></div>  Häufige Probleme: <br><br><ul><li>  Tippfehler; </li><li>  Räume </li><li>  anderer Fall. </li></ul><br>  Nachdem ich ein Durcheinander gefunden habe, gehe ich mit Beispielen zu den Integratoren.  Lassen Sie sie Müll in der Quelle lassen und beseitigen Sie die Unstimmigkeiten.  Dann ist es in der Zieldatenbank möglich, die Referenzlinien in Klassifikatoren umzuwandeln. <br><br>  Ich überprüfe die gängigen Werte in den Klassifikatorfeldern, um den Mangel an Optionen festzustellen.  Angesichts solcher Fälle. <br><div class="scrollable-table"><table><tbody><tr><th>  Geschlecht </th><th>  Telefontyp </th></tr><tr><td><ol><li>  Weiblich </li><li>  Nicht definiert </li></ol></td><td><ol><li>  Zuhause </li></ol></td></tr></tbody></table></div>  Solche Klassifikatoren sehen sehr seltsam aus, sie sollten dem Kunden gezeigt werden.  Jedes Mal, wenn ich einen Fehler hinter solchen Fällen hatte: Entweder stimmt etwas in der Datenbank nicht oder die Daten wurden von der falschen Stelle heruntergeladen. <br><br>  <i>Was zu überprüfen, auf den Punkt gebracht.</i> <i><br><br></i> <ol><li>  <i>Welche Zeichenfolgenfelder sind Referenz und welche nicht.</i> </li><li>  <i>Bei einfachen Zeichenfolgenfeldern die beliebtesten Werte.</i>  <i>Normalerweise im oberen Müll und Standarddaten.</i> </li><li>  <i>Bei Zeichenfolgenreferenzfeldern die Verteilung aller Werte nach Beliebtheit.</i>  <i>Die Auswahl zeigt Abweichungen in den Referenzwerten.</i> </li><li>  <i>Für Klassifizierer - gibt es genügend Optionen in der Datenbank.</i> </li></ol><br><h2>  Konsistenz und gegenseitige Versöhnung </h2><br>  Von der Analyse der Daten in Tabellen wende ich mich der Analyse der Beziehungen zu. <br><br>  <b>Gibt an, ob Daten miteinander verknüpft sein müssen.</b>  Wir nennen diesen Parameter "Konsistenz".  Ich nehme den untergeordneten Tisch zum Beispiel mit Telefonen.  Dazu in einem Paar - die übergeordnete Tabelle der Kunden.  Und ich sehe, wie viele Clients in der untergeordneten Tabelle Bezeichner sind, die nicht im übergeordneten Element enthalten sind. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;ID1&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name_1&gt;) <span class="hljs-keyword"><span class="hljs-keyword">MINUS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;ID2&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name_2&gt;));</code> </pre> <br>  Wenn die Anfrage ein Delta ergab, bedeutet dies kein Glück - der Upload enthält nicht verwandte Daten.  Also überprüfe ich die Tische mit Telefonen, Verträgen, Adressen, Rechnungen und so weiter.  Einmal fand sie während eines Projekts 23 Millionen Nummern, die einfach in der Luft hingen. <br><br>  Es funktioniert auch in die entgegengesetzte Richtung - ich suche Kunden, die aus irgendeinem Grund keinen einzigen Vertrag, keine einzige Adresse und keine einzige Telefonnummer haben.  Manchmal ist es in Ordnung - der Kunde hat keine Adresse.  Hier müssen Sie vom Kunden erfahren, dass die Dokumentation leicht täuscht. <br><br>  <b>Gibt es Duplikate von Primärschlüsseln in verschiedenen Tabellen?</b>  Manchmal werden identische Entitäten in verschiedenen Tabellen gespeichert.  Zum Beispiel heterosexuelle Kunden.  (Niemand weiß warum, weil Breschnew immer noch die Struktur beansprucht.) Die Tabelle ist jedoch im Empfänger einzeln, und bei der Migration treten Client-IDs in Konflikt. <br><br>  Ich drehe meinen Kopf um und betrachte die Struktur der Basis: wo eine Fragmentierung ähnlicher Entitäten möglich ist.  Dies können Kundentabellen, Kontakttelefone, Pässe usw. sein. <br><br>  Wenn es mehrere Tabellen mit ähnlichen Entitäten gibt, mache ich eine Gegenprüfung: Ich überprüfe den Schnittpunkt von Bezeichnern.  Schneiden - Kleben Sie einen Patch.  Zum Beispiel sammeln wir Bezeichner für eine einzelne Tabelle gemäß dem Schema „Name der Quelltabelle + ID“. <br><br>  <i>Was zu überprüfen, auf den Punkt gebracht.</i> <i><br><br></i> <ol><li>  <i>Wie viele nicht verwandte Daten befinden sich in verknüpften Tabellen?</i> </li><li>  <i>Gibt es potenzielle Primärschlüsselkonflikte?</i> </li></ol><br><h2>  Was noch zu überprüfen </h2><br>  <b>Gibt es lateinische Zeichen, zu denen sie nicht gehören?</b>  Zum Beispiel in Nachnamen. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REGEXP_LIKE</span></span>(&lt;column_name&gt;, <span class="hljs-string"><span class="hljs-string">'[AZ]'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span>);</code> </pre> <br>  Also fange ich den wunderbaren lateinischen Buchstaben "C", der mit dem Kyrillischen übereinstimmt.  Der Fehler ist unangenehm, da der Bediener laut dem Namen mit dem lateinischen "C" niemals einen Kunden finden wird. <br><br>  <b>Gibt es in den Zeichenfolgenfeldern, die für Zahlen vorgesehen sind, überflüssige Zeichen?</b> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REGEXP_LIKE</span></span>(&lt;column_name&gt;, <span class="hljs-string"><span class="hljs-string">'[^0-9]'</span></span>);</code> </pre> <br>  In den Feldern treten Probleme mit der Passnummer der Russischen Föderation oder der TIN auf.  Telefone sind die gleichen, aber dort erlaube ich Plus, Klammern und Bindestriche.  Die Anfrage zeigt auch den Buchstaben "O", der anstelle von Null gesetzt wurde. <br><br>  <b>Wie angemessen sind die Daten?</b>  Sie wissen nie, wo das Problem auftauchen wird, deshalb bin ich immer auf der Hut.  Ich habe solche Fälle getroffen: <br><br><ul><li>  <i>Ist „Sofya Vladimirovna“ ein Kunde mit 50.000 Telefonen - ist das normal?</i>  Antwort: nicht normal.  Der Kunde ist technisch versiert, er gibt ihm "inhaberlose" Telefonnummern, um SMS-Mailings zu machen.  Es ist nicht erforderlich, den Client auf eine neue Basis zu ziehen. </li><li>  <i>TINs sind gefüllt, tatsächlich enthält die Spalte "79853617764", "89109462345", "4956780966" und so weiter.</i>  Was für Telefone, okuda?  Wo ist das Gasthaus?  Antwort: Welche Art von Zahlen - es ist nicht bekannt, wer sie ausdrückt - ist unklar.  Niemand benutzt sie.  Die aktuelle TIN wird in einem anderen Feld einer anderen Tabelle gespeichert und von dort übernommen. </li><li>  <i>Das Feld „Adresse in einer Zeile“ entspricht nicht den Feldern, in denen die Adresse in Teilen gespeichert ist.</i>  Warum sind die Adressen unterschiedlich?  Antwort: Sobald die Bediener die Adressen mit einer Zeile gefüllt haben und das externe System die Adressen in separate Felder sortiert hat.  Zur Segmentierung.  Im Laufe der Zeit änderten die Leute ihre Adressen.  Die Betreiber haben sie regelmäßig aktualisiert, jedoch nur als Zeichenfolge: Die Adresse blieb teilweise alt. </li></ul><br><h2>  Sie benötigen lediglich SQL und Excel </h2><br>  Für die Analyse von Daten wird keine teure Software benötigt.  Genug gutes altes Excel und SQL-Kenntnisse. <br><br>  Excel Ich verwende, um eine lange Abfrage zu kompilieren.  Zum Beispiel überprüfe ich die Felder auf Vollständigkeit und es gibt 140 in der Tabelle. Ich werde mit meinen Händen vor der Karottenverschwörung schreiben, also sammle ich die Anfrage mit den Formeln in der Excel-Platte. <br><br><img src="https://habrastorage.org/webt/ww/m3/br/wwm3br0qxpp7gudattxhkxnx1fm.png"><br>  <sub>In der Spalte "A" füge ich die Namen der Felder ein, ich nehme sie in die Dokumentation oder Servicetabellen.</sub>  <sub>In Spalte "B" - eine Formel zum Kleben einer Anfrage</sub> <br><br>  Ich füge die Namen der Felder ein, schreibe die erste Formel in Spalte "B", ziehe an der Ecke - und fertig. <br><br><img src="https://habrastorage.org/webt/1r/ld/ct/1rldctxhypv2xw3era05-lkixhu.gif"><br>  <sub>Funktioniert in Excel, in Google Text &amp; Tabellen und in Excel Online (verfügbar auf Yandex.Disk)</sub> <br><br>  Die Datenanalyse spart dem Auto Zeit und die Nerven der Manager.  Damit ist es einfacher, die Frist einzuhalten.  Wenn das Projekt groß ist, spart die Analyse Millionen Rubel und einen guten Ruf. <br><br><h2>  Keine Zahlen, sondern Schlussfolgerungen </h2><br>  Sie formulierte eine Regel für sich selbst: Wenn Sie dem Kunden keine bloßen Zahlen zeigen möchten, erhalten Sie immer noch nicht den Effekt.  Meine Aufgabe ist es, die Daten zu analysieren, Schlussfolgerungen zu ziehen und die Zahlen als Beweismittel beizufügen.  Schlussfolgerungen sind primär, Zahlen sind sekundär. <br><br>  Was ich für den Bericht sammle: <br><br><ul><li>  <i>der Wortlaut der Probleme in Form einer Hypothese oder Frage</i> : „Die TIN ist zu 0,07% gefüllt.  Wie verwenden Sie diese Daten, wie relevant sind sie, wie sind sie zu interpretieren?  Gibt es nur eine INN in einer Tabelle? "  Sie können nicht beschuldigen: "Ihre TIN ist überhaupt nicht gefüllt."  Als Antwort erhalten Sie nur Aggression; </li><li>  <i>Beispiele für Probleme.</i>  Dies sind die Tabletten, die so viele in dem Artikel sind; </li><li>  <i>Optionen für</i> die Vorgehensweise <i>:</i> "Es könnte sich lohnen, die TIN von der Zielbasis zu entfernen, um keine leeren Felder zu erzeugen." </li></ul><br>  Ich habe kein Recht zu entscheiden, was genau aus der Quellendatenbank ausgewählt und wie Daten während der Migration geändert werden sollen.  Daher gehe ich mit dem Bericht zum Kunden oder zu den Integratoren, und wir finden heraus, wie wir vorgehen sollen. <br><br>  Manchmal antwortet der Kunde, wenn er das Problem sieht: „Mach dir keine Sorgen, pass nicht auf.  Wir werden ein zusätzliches Terabyte Speicher kaufen, das ist alles.  Es ist billiger als zu optimieren. "  Sie können dem nicht zustimmen: Wenn Sie alles hintereinander nehmen, hat der Empfänger keine Qualität.  Dieselben müllredundanten Daten werden migriert. <br><br>  Deshalb fragen wir sanft, aber stetig: "Sagen Sie uns, wie Sie diese bestimmten Daten im Zielsystem verwenden werden."  Nicht "warum Sie brauchen", sondern "wie Sie verwenden werden".  Die Antworten "Dann kommen wir auf" oder "Nur für den Fall" sind nicht geeignet.  Früher oder später versteht der Kunde, auf welche Daten verzichtet werden kann. <br><br>  Die Hauptsache ist, alle Probleme zu finden und zu lösen, bis das System in prod gestartet wird.  Wenn Sie die Architektur und das Datenmodell lebendig ändern, verlieren Sie den Verstand. <br><br>  Das ist alles mit grundlegenden Überprüfungen, studieren Sie die Daten! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de431376/">https://habr.com/ru/post/de431376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de431360/index.html">Erklären Sie die Hintertür im Event-Stream</a></li>
<li><a href="../de431362/index.html">Wie kann ein Designer die Routine loswerden und das Interesse an seinem Job behalten?</a></li>
<li><a href="../de431370/index.html">Die schnellsten Berichte im wilden Westen. Und noch eine Handvoll Bugs ...</a></li>
<li><a href="../de431372/index.html">Interrupts von externen Geräten in einem x86-System. Teil 2. Startoptionen für den Linux-Kernel</a></li>
<li><a href="../de431374/index.html">Letztes Urteil: Analyse der Finanzindikatoren des Spiels beim frühen Zugriff</a></li>
<li><a href="../de431378/index.html">Die ganze Wahrheit über RTOS. Artikel 23. Warteschlangen: Einführung und Grundversorgung</a></li>
<li><a href="../de431380/index.html">Mitap Netologiya und Skyeng über Soft Skills „Was ein Entwickler außer Code wissen muss“</a></li>
<li><a href="../de431382/index.html">Ergebnisse der JVM-Ökosystemumfrage</a></li>
<li><a href="../de431384/index.html">CLion 2018.3: Remote-Entwicklung, Code-Profilerstellung, Leistung und mehr</a></li>
<li><a href="../de431388/index.html">Die Welt mit den Augen eines Autos. Wie sehen ihn Drohnen?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>