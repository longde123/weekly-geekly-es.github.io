<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👊🏻 ☂️ 🚔 Sekali lagi tentang OpenSSL 🙁 🦋 🛠️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam praktik saya yang masih kecil di bidang keamanan informasi, saya harus menghadapi beberapa masalah kriptografi, atau lebih tepatnya enkripsi, ya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sekali lagi tentang OpenSSL</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417069/">  Dalam praktik saya yang masih kecil di bidang keamanan informasi, saya harus menghadapi beberapa masalah kriptografi, atau lebih tepatnya enkripsi, yang sulit saya temukan jawabannya.  Oleh karena itu, saya memutuskan untuk menulis artikel pendek tentang dasar-dasar bekerja dengan OpenSSL. <br><br>  Artikel ini akan membahas masalah pembuatan kunci yang terkenal, serta masalah kurang dikenal mengenkripsi ukuran file besar.  Sertifikasi tidak ada pertanyaan di sini. <br><a name="habracut"></a><br>  Mari kita mulai.  Faktanya, semuanya sederhana sejauh ini. <br><br>  Buat kunci pribadi dengan perintah. <br><br><pre><code class="hljs powershell">openssl genrsa <span class="hljs-literal"><span class="hljs-literal">-out</span></span> key.pem <span class="hljs-literal"><span class="hljs-literal">-aes</span></span><span class="hljs-literal"><span class="hljs-literal">-256</span></span><span class="hljs-literal"><span class="hljs-literal">-cfb</span></span> <span class="hljs-literal"><span class="hljs-literal">-rand</span></span> /var/log/messages <span class="hljs-number"><span class="hljs-number">4096</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/kh/8f/pm/kh8fpmllta6ay9cwvgxdfbcc5qy.png"><br><br>  Di sini: <br><br>  <i>genrsa</i> - parameter yang menunjukkan pembuatan kunci oleh algoritma enkripsi RSA. <br>  <i>keluar</i> - tempat membuat kunci. <br>  <i>4096</i> adalah panjang kunci. <br>  Secara umum, ini cukup untuk membuat kunci.  Tetapi kunci pribadi lebih baik untuk dienkripsi. <br>  <i>aes-256-cfb</i> - algoritma dan mode enkripsi. <br>  <i>rand / var / log / messages</i> - nilai acak dari folder mana pun, lebih baik mengambil log, karena  dengan / dev / random atau / dev / urandom semuanya bisa bertahan, saya sudah memilikinya. <br>  Saat membuat kunci, kata sandi akan diminta.  Kata sandi adalah dasar dari perlindungan apa pun, jadi cobalah untuk menyelidikinya.  Dan ingatlah. <br><cut></cut><br>  Kami punya kunci.  Pribadi  Jangan pernah menunjukkan dan bersembunyi kepada siapa pun sesuai dengan prinsip Koshchei the Immortal. <br><br>  Berdasarkan itu, kami akan membuat tampilan publik yang dapat dipajang di depan umum, setidaknya di dahi. <br><br><pre> <code class="hljs powershell">openssl rsa <span class="hljs-operator"><span class="hljs-operator">-in</span></span> privatkey.pem <span class="hljs-literal"><span class="hljs-literal">-pubout</span></span> <span class="hljs-literal"><span class="hljs-literal">-out</span></span> publickey.pem</code> </pre> <br><img src="https://habrastorage.org/webt/rt/w6/97/rtw697jfacjjr1ll5bzmjhm_pyg.png"><br><br>  Sekarang kami memiliki sepasang kunci.  Anda dapat mengunggah yang publik ke server untuk terhubung melalui ssh menggunakan kunci pribadi Anda.  Atau untuk mengenkripsi sejumlah kecil data, misalnya, token atau frasa sandi, dll. <br><br>  Tugas mengenkripsi file besar memiliki solusi yang berbeda. <br><br>  Untuk mengenkripsi sejumlah besar data, kami menggunakan, misalnya, file pdf ini dengan ukuran 1,8 Mbytes. <br><br><img src="https://habrastorage.org/webt/e7/pu/j3/e7puj3mtbjua621dlfjgvgxkzek.png"><br><br>  Sejumlah besar data dienkripsi dengan algoritma enkripsi simetris, seperti AES.  Di sini kita akan menggunakan enkripsi asimetris untuk mengirimkan kunci simetris, yang dengannya kita akan mengenkripsi teks. <br><br>  Mari kita mulai. <br><br>  Buat kunci sesi simetris (satu kali) dengan urutan karakter acak dan tulis ke file dalam representasi base64. <br><br><pre> <code class="hljs matlab">openssl <span class="hljs-built_in"><span class="hljs-built_in">rand</span></span> -base64 <span class="hljs-number"><span class="hljs-number">32</span></span> &gt; key.bin</code> </pre> <br>  Selanjutnya, kami mengenkripsi file dengan kunci ini: <br><br><pre> <code class="hljs powershell">openssl enc <span class="hljs-literal"><span class="hljs-literal">-aes</span></span><span class="hljs-literal"><span class="hljs-literal">-256</span></span><span class="hljs-literal"><span class="hljs-literal">-cfb</span></span> <span class="hljs-literal"><span class="hljs-literal">-salt</span></span> <span class="hljs-operator"><span class="hljs-operator">-in</span></span> OWASP_Top_10<span class="hljs-literal"><span class="hljs-literal">-2017_</span></span>\(en\).pdf <span class="hljs-literal"><span class="hljs-literal">-out</span></span> OWASP_Top_10<span class="hljs-literal"><span class="hljs-literal">-2017_</span></span>\(en\).pdf.enc <span class="hljs-literal"><span class="hljs-literal">-pass</span></span> file:./key.bin</code> </pre> <cut></cut><br><img src="https://habrastorage.org/webt/gx/cz/hb/gxczhblrlqfyup8zdle-mwywnho.png"><br><br>  <i>aes-256-cfb</i> - algoritma dan mode enkripsi.  Saya tidak akan berbicara tentang mode di sini.  Ini yang terbaik. <br>  <i>garam</i> - garam untuk kekuatan kriptografi yang lebih besar. <br>  <i>pass file: ./ key.bin</i> - kunci enkripsi. <br><br>  Selanjutnya, kami mengenkripsi kunci simetris dengan kunci publik "asimetris" kami. <br><br><pre> <code class="hljs powershell">openssl rsautl <span class="hljs-literal"><span class="hljs-literal">-encrypt</span></span> <span class="hljs-literal"><span class="hljs-literal">-inkey</span></span> publickey.pem <span class="hljs-literal"><span class="hljs-literal">-pubin</span></span> <span class="hljs-operator"><span class="hljs-operator">-in</span></span> key.bin <span class="hljs-literal"><span class="hljs-literal">-out</span></span> key.bin.enc</code> </pre> <br><img src="https://habrastorage.org/webt/yz/qe/oz/yzqeozpp3fg-9hcumrfba8q1m3w.png"><br><br>  Punya file yang dienkripsi dan kunci simetris.  Anda dapat mengirimkannya ke teman Anda untuk dekripsi.  Tetapi kami akan mengirimkannya kepada diri kami sendiri, karena ini adalah pekerjaan rumah bagi kami sendiri. <br><br>  Sekarang hapus kunci simetris yang asli!  Sehingga tidak ada yang akan menemukannya. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">shred</span></span> -u key.bin</code> </pre> <br>  Pada gambar di bawah ini sudah tidak ada lagi. <br><br><img src="https://habrastorage.org/webt/bz/fe/wc/bzfewchtkwxpjpz-jcrqjdy9twq.png"><br><br>  Sekarang kita mendekripsi kunci simetris dengan kunci asimetris pribadi kita. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">openssl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsautl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-decrypt</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-inkey</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">privatkey</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pem</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">key</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.enc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-out</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">key</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span></code> </pre> <br>  Dan kami, yang beruntung, sekali lagi memiliki kunci simetris untuk mendekripsi teks kami, yang masih dienkripsi. <br><br>  Gambarnya lagi di bawah, ada kunci lagi. <br><br><img src="https://habrastorage.org/webt/0-/yd/v-/0-ydv-wqdoblfm9sjmf0ntdymx4.png"><br><br>  Sekarang kita mendekripsi file yang dienkripsi dengan cipher enkripsi simetris dengan yang baru dienkripsi, tetapi kemudian didekripsi menggunakan cipher enkripsi asimetris, kunci simetris. <br><br><pre> <code class="hljs powershell">openssl enc <span class="hljs-literal"><span class="hljs-literal">-d</span></span> <span class="hljs-literal"><span class="hljs-literal">-aes</span></span><span class="hljs-literal"><span class="hljs-literal">-256</span></span><span class="hljs-literal"><span class="hljs-literal">-cfb</span></span> <span class="hljs-operator"><span class="hljs-operator">-in</span></span> OWASP_Top_10<span class="hljs-literal"><span class="hljs-literal">-2017_</span></span>\(en\).pdf.enc <span class="hljs-literal"><span class="hljs-literal">-out</span></span> OWASP_Top_10<span class="hljs-literal"><span class="hljs-literal">-2017_</span></span>\(en\)decrypt.pdf <span class="hljs-literal"><span class="hljs-literal">-pass</span></span> file:./key.bin</code> </pre> <br>  Bukti di bawah ini. <br><br><img src="https://habrastorage.org/webt/3j/_l/ow/3j_lowucixi7upo1q9ahbhq20vi.png"><br><br>  Sekarang: Mengapa begitu rumit?  Mengapa Anda tidak dapat mengambil dan melakukan segalanya dengan enkripsi asimetris? <br><br>  Kami mencoba, langsung ke penggaruk;) <br>  Kami punya! <br><br>  File dan kunci. <br><br><img src="https://habrastorage.org/webt/zr/kh/kj/zrkhkjprmdfg3qutmejnn88htky.png"><br><br>  Kami mengenkripsi. <br><br><pre> <code class="hljs powershell">openssl rsautl <span class="hljs-literal"><span class="hljs-literal">-encrypt</span></span> <span class="hljs-literal"><span class="hljs-literal">-inkey</span></span> publickey.pem <span class="hljs-literal"><span class="hljs-literal">-pubin</span></span> <span class="hljs-operator"><span class="hljs-operator">-in</span></span> OWASP_Top_10<span class="hljs-literal"><span class="hljs-literal">-2017_</span></span>\(en\).pdf <span class="hljs-literal"><span class="hljs-literal">-out</span></span> OWASP_Top_10<span class="hljs-literal"><span class="hljs-literal">-2017_</span></span>\(en\).pdf.enc</code> </pre> <br>  POW - POW - POOOOOOOOOOOOH.  Kesalahannya.  Terlalu banyak data untuk ukuran kunci.  Untuk enkripsi asimetris, ukuran kunci harus lebih besar atau sama dengan plaintext. <br>  OpenSSL, seperti dalam kesepakatan dengan iblis, memberi Anda apa yang Anda minta, tetapi bukan apa yang Anda inginkan.  Benar, file yang dienkripsi kosong. <br><br><img src="https://habrastorage.org/webt/rm/4o/kk/rm4okk8wukgzju8nv-e2f4kgiwi.png"><br><br>  Tetapi Anda dapat mengenkripsi file yang lebih kecil dari kuncinya.  Ayo kita coba. <br><br>  Buat file kecil. <br><br>  Sebagai contoh, saya melakukan ini: <br><br><pre> <code class="hljs pgsql">echo "hellow world my name is admin is a secret text nobody know it hahahahaahah" &gt; <span class="hljs-type"><span class="hljs-type">text</span></span>.txt</code> </pre> <br><img src="https://habrastorage.org/webt/ey/5g/m6/ey5gm69wehxctaesq9ye3d6e_5y.png"><br><br>  Kami akan mengenkripsi dengan kunci publik kami, yang semua orang tahu di dunia! <br><br><pre> <code class="hljs powershell">openssl rsautl <span class="hljs-literal"><span class="hljs-literal">-encrypt</span></span> <span class="hljs-literal"><span class="hljs-literal">-inkey</span></span> publickey.pem <span class="hljs-literal"><span class="hljs-literal">-pubin</span></span> <span class="hljs-operator"><span class="hljs-operator">-in</span></span> text.txt <span class="hljs-literal"><span class="hljs-literal">-out</span></span> text.txt.enc</code> </pre> <br>  Seperti yang Anda lihat di gambar bawah, file dienkripsi.  Tidak ada yang jelas!  Siapa yang mengerti siapa kamu? <br><br><img src="https://habrastorage.org/webt/a_/f5/sn/a_f5sn9rowfgx2ljydo4cnpvsyy.png"><br><br>  Sekarang kami mendekripsi, setelah sebelumnya menghapus file sumber untuk kemurnian percobaan. <br><br><pre> <code class="hljs pgsql">openssl rsautl -decrypt -inkey privatkey.pem -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>.txt.enc -<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>.txt</code> </pre> <br><img src="https://habrastorage.org/webt/1r/ic/gz/1ricgzasvowe3ia0xo3eqfwfki4.png"><br><br>  Kami memiliki file yang didekripsi.  Semuanya bagus. <br><br>  Untuk mentransfer semua barang terenkripsi ini, lebih baik untuk menyandikan yang terakhir di base64.  Oleh karena itu, sebelum mendekripsi, Anda harus mendekode terlebih dahulu. <br>  Dikodekan. <br><br><pre> <code class="hljs pgsql">openssl enc -base64 -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>.txt.enc -<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>.txt.bs64</code> </pre> <br><img src="https://habrastorage.org/webt/jm/dg/cp/jmdgcp7dwf5t02vt9rtyrj7_nbg.png"><br><br>  Diterjemahkan. <br><br><pre> <code class="hljs pgsql">openssl enc -base64 -d -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>.txt.bs64 -<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>.txt.enc</code> </pre> <br><img src="https://habrastorage.org/webt/1u/tt/mu/1uttmupoe0muyrjnihhizcc-pdy.png"><br><br>  Dan lagi kita memiliki beleberd yang tidak ada yang mengerti!  Jika Anda mengerti, maka dokumen ini bukan untuk Anda! <br><br>  Ini adalah cara kerja enkripsi saat membuat kunci dan enkripsi data menggunakan utilitas OpenSSL sebagai contoh. <br><br>  Nanti saya akan menjelaskan mode enkripsi blok cipher simetris. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id417069/">https://habr.com/ru/post/id417069/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id417053/index.html">Pencetakan matriks, cetakan</a></li>
<li><a href="../id417055/index.html">SAP Leonardo TV Show - Langsung di Internet of Things, Blockchain, Pembelajaran Mesin dan Big Data</a></li>
<li><a href="../id417059/index.html">Meningkatkan unduhan konten tanpa segel</a></li>
<li><a href="../id417063/index.html">Jaringan saraf untuk yang terkecil</a></li>
<li><a href="../id417065/index.html">Splunk How-to, atau How dan Where to Learn Splunk</a></li>
<li><a href="../id417071/index.html">Jumat PHP: Webinar Skillbox Gratis</a></li>
<li><a href="../id417073/index.html">Hari Pengembang Seluler Uber</a></li>
<li><a href="../id417075/index.html">API Cat CSS</a></li>
<li><a href="../id417079/index.html">Package Manager untuk Kubernetes - Helm: Past, Present, Future</a></li>
<li><a href="../id417081/index.html">Utara, akan, berharap, negara tanpa batas, atau Bagaimana proyek dibuat dalam kondisi Siberia yang parah</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>