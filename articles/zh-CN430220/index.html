<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏿 🚝 🤲🏻 如何将“百年纪念” USB集线器变成智能托管并节省300美元 🚒 🔤 ♂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="不知何故，我需要一个集线器很长时间，最好有大量的端口并且形状相当方便，适合于在3.5英寸托架中代替软盘驱动器嵌入。 快速浏览跳蚤市场时，您会发现D-link DUB-H7型号，甚至是“ 1价格2”组合。 外部检查没有什么特别的，集线器做为集线器，主打“打印机” USB AM-BM位于背面，电源为3A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何将“百年纪念” USB集线器变成智能托管并节省300美元</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430220/"><p> 不知何故，我需要一个集线器很长时间，最好有大量的端口并且形状相当方便，适合于在3.5英寸托架中代替软盘驱动器嵌入。 快速浏览跳蚤市场时，您会发现D-link DUB-H7型号，甚至是“ 1价格2”组合。 外部检查没有什么特别的，集线器做为集线器，主打“打印机” USB AM-BM位于背面，电源为3A。 与往常一样，我整理出的第一件事是对少量的空地方而不是元素感到满意，再加上高质量的焊接和镇定。 没错，以防万一，我去了互联网，看看它是什么样的中心，是否有参与的有趣项目。 没有项目，用户评论通常为50/50，没有动态。 该集线器在5到7年的时间内运行良好并完成了任务，然后平稳地移动到电子垃圾箱中，很可能会与未知的适配器，适配器等一起消失。但是我生命中发生了一件事情让我在装满旧垃圾的袋子里四处逛逛，结果发现这是一个独特的D型链环，然后甩掉灰尘，将其提取成上帝的光芒。 如果您有兴趣了解原因，欢迎减少。 </p><br><img src="https://habrastorage.org/getpro/habr/post_images/3a7/fdf/977/3a7fdf977a4d085c2fcb08c4491a000f.gif" alt="眨眼"><a name="habracut"></a><br><h4> 介绍或哭泣贪婪的USB集线器制造商 </h4><br><p> 随着小型，便捷的SoC路由器的问世（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关“调节”流行的中国微型路由器Hame A15（也</a>称其为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ A5-V11”</a>商标）的教程），并且广泛引入了openwrt来管理主机设备（绝大多数）的情况下，这些是通过USB连接的设备），控制各种调制解调器，读卡器，usb-rs232转换器等的电源就变得非常紧迫，与GSM-mo一起工作时需要控制端口  EMAMI（重新启动，例如）。 原则上，人民已经做出了足够的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">决定</a> 。 为此，从在路由器中使用免费的GPIO引脚到现成的继电器。 有来自第三方制造商的解决方案。 例如，这是一个用于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Acroname的</a> 4个端口的可编程USB集线器，它具有丰富的软件和硬件，但售价约为300美元。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5cb/cdd/540/5cbcdd5404d816d47e2a6917b9639f98.jpg" alt="图片"></div><br><p> 有一个更便宜的选择，一个名为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Yupkit YKUSH</a>的智能可切换集线器，仅售35€： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0d/7f4/44d/f0d7f444dbf40fd96967cd8a4900d783.png" alt="图片"></div><br><p> 最经济的可以使用一堆最便宜的USB集线器，常闭5V继电器以及任何Arduino-k来断开USB端口的电源（如有必要）。 这种解决方案的成本不到10美元，这不包括焊接和编程Arduino所花费的时间。 </p><br><p> 这似乎是一个死胡同。 要么昂贵而美丽，要么只是朴实而<s>卑鄙</s> 。 但是事实证明，还有第三种选择。 此外，该解决方案已经过时，因为其中描述了集线器的<a href="https://web.archive.org/web/20120207112406/" rel="nofollow">USB 2.0规范</a> 。 </p><br><div class="spoiler">  <b class="spoiler_title">USB电源管理规范摘录</b> <div class="spoiler_text"><p> 自供电的集线器可能具有电源开关，用于控制面向下游端口的电源传输，但这不是必需的。 总线供电的集线器必须具有电源开关。 具有电源开关的集线器可以将电源作为一个组/成组切换到所有端口，也可以分别切换到每个端口，或者具有一个或多个端口的任意数量的成组切换。 集线器通过wHubCharacteristics中的“逻辑电源切换模式”字段的设置指示它是否支持电源切换。 如果集线器支持每个端口的电源切换，则在收到端口的SetPortFeature（PORT_POWER）请求时，将打开端口的电源。 当端口处于“已关闭电源”或“未配置”状态时，将关闭端口电源。 如果集线器支持组合电源开关，则当组合中的任何端口接收到SetPortFeature（PORT_POWER）请求时，将打开组合中所有端口的电源。 除非组中的所有端口都处于“已关闭电源”或“未配置”状态，否则不会关闭组的电源。 <br>  ... <br> 尽管不需要自供电集线器来实现电源切换，但集线器必须支持所有端口的“ Powered-off”状态。 此外，即使集线器没有可通过USB系统软件控制的电源开关，集线器也必须实现PortPwrCtrlMask（所有位均设置为1B）。 </p></div></div><br><p> 译成俄语，事实证明USB标准已经定义了使用所谓的“控制端口电源”的功能。  <b>每端口电源交换（PPPS）</b> ，但要满足支持此功能的设备的要求不仅困难，而且非常困难。 要实现PPPS功能，需要其他组件（场效应晶体管和布线），这些组件没有安装在集线器中以节省成本。 </p><br><p> 一些制造商对市场需求敏感地做出了反应，在轮毂的规格中指出了PPPS功能，但实际上这并不超出包装盒上的铭文。 基本上，很难找到故障，因为集线器内部的许多芯片都支持此功能，但是如果没有其他开关（晶体管）（大多数USB端口直接连接到+ 5V线路）就无法实现。 </p><br><p> 我什至专门拆卸了几个打算与A5-V11路由器一起使用的小型USB集线器。 里面有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">GL850G</a>芯片和深受中国<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">FE1.1s</a>喜爱的芯片。 自然地，只在内部发现了最少细节的控制器本身。 由于电路板的尺寸很小，即使采用铰链安装，也很难放置晶体管及其连接的零件。 我不得不冷静下来。 尽管取决于芯片，但如果在数据手册中提到<i>过电流检测和单独或联合电源控制</i> ，则可以通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">本文中</a>描述的方法对此类设备进行智能操作。 一个朋友使用晶体管和一堆电阻器的组合来在其集线器中启用PPPS功能。 </p><br><div class="spoiler">  <b class="spoiler_title">设备的更改方案和外观</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/0b1/202/831/0b1202831fd6a456a90f8ab01c9ed48e.jpg" alt="图片"><br><img src="https://habrastorage.org/getpro/habr/post_images/a5d/e65/b11/a5de65b1118b764b9fda1d32a1fb47f9.jpg" alt="图片"></div></div><br><p> 另外，在阅读文档时，您会发现不存在，不存在，并且提到可以通过在电路中添加一些AIC1526-0或MIC2026（双通道配电开关）来实现端口控制模式。 </p><br><div class="spoiler">  <b class="spoiler_title">数据表中的方案不会撒谎</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vn/vy/ar/vnvyarpe24tec4a6skp0irp8grk.jpeg"><br><img src="https://habrastorage.org/webt/wc/s5/yd/wcs5ydopgtt5n8xwwovr1vbdld8.jpeg"></div></div><br><h4> 部分主要还是要切入点 </h4><br><p> 关于购买功能不明的中国集线器（“戳中的猪”）的忧郁想法以及无法进行初步检查的想法使我不知所措，我无意间碰到了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">一篇</a>有关设置openwrt来控制USB集线器功能的文章，而且，该文章同样被废弃了，灰色情况下忘记了<b>D-Link DUB-H7</b> 。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b9/3o/hv/b93ohvaf-wfvgk0hy2qltlxldlk.jpeg"></div><br><p> 在研究了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">材料之后，</a>很明显，在集线器上，除了相当先进的飞利浦ISP1521BE控制器外，还有一大堆相同的<i>双通道配电开关</i> AIC1528-0用于全功率开关。 尽管根据数据表判断，但具有最小主体套件的芯片本身可以控制下游端口的功率（并且那里还没有实现很多功能，例如，使用GoodLink技术指示上游端口活动，或者USB 1.1主机正确支持2.0和1.1的混合使用）下游端口等）。 </p><br><p> 顺便说一句，对于那些决定重复我走过的路的人，我必须立即说，D-Link DUB-H7的现代版本（在光滑的黑色情况下）不再像旧的灰色版本那样有用。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o8/ll/uc/o8llucurzvykxpwzgd9d9shxh88.jpeg"></div><br><p> 根据wikidevi.com（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">1，2，3，4</a> ）的信息，此集线器有多个版本，板载了一组不同的组件，因此具有不同的功能（A1 / A5-ISP1521BE 7端口，B1-2xGL854G 4端口， C1-2xGL850Z 4端口）。 </p><br><p> 还请注意D-Link DUB-H7，因为它具有良好的功能，它也是我们地区最实惠的选择（无论是价格还是流行程度）。 在“每端口电源切换”过程中可能提到的模型中，我们还可以另外注意以下内容： </p><br><ul><li>  Linksys USB2HUB4 USB 2.0集线器。 </li><li>  D-Link DFB-H7组合式集线器 </li><li>  Elecom U2H-G4S </li><li> 三和供应USB-HUB14GPH </li><li>  Targus Inc.  PAUH212 </li><li> 霍金技术UH214 </li></ul><br><p> 我没有机会寻找上述设备，因为我曾经很幸运A5版本的版本。 事实是，现在，如果我必须购买这样的集线器，我会尝试找到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">B1</a>版本，因为除了控制端口的功能之外，构建该集线器的芯片（GL854G）内还包含有<b>Multi Transaction Translator</b>这样的东西。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bn/cc/bu/bnccbuuo1tpqxp7bq7eob8lloq0.jpeg"></div><br><h4>  USB集线器中具有多事务翻译器（MTT）的重要性 </h4><br><p> 为了说明这个多事务翻译器（MTT）是什么以及为什么它如此重要和必要，我们做了一个小小的题外话。 事务发送器（TT）是任何高速集线器的重要组件，可在集线器的上游和下游端口之间提供通信，尤其是当这些端口以不同的数据速率运行时。 实际上，TT将低速和中速设备与高速设备（例如，纯USB 2.0）分开，并负责以USB 1.1的速度工作。 </p><br><p> 操作发送器可以有两种类型-单个（英语，单事务翻译器，STT）或多个（英语，多事务翻译器，MTT）。 在STT的情况下，所有端口都使用一个发送器，在MTT的情况下，每个端口都有其自己的发送器。 显然，第一个选项更便宜，更简单，该选项的主要缺点来自哪里-如果将多个USB 1.1端口连接到集线器，它们将全部通过一个瓶颈工作。 我想您可以想象交换速度会发生什么。 </p><br><img src="https://habrastorage.org/webt/g7/ei/ba/g7eibabozthfur42lw3je15r_tk.jpeg"><br><p> 简而言之，STT集线器对可同时使用的设备数量有所限制。 否则，由于数据传输计划中的冲突，集线器超载（尤其是在主动交换数据的设备（例如声卡）的情况下），它会充满数据包丢失。 因此，最好选择集线器以立即关注具有MTT的设备，而不是稍后查找工作不稳定的原因。 如果您已经有一个集线器，但不幸的是事实证明它是与STT一起使用的，则只需仔细检查连接到该集线器的设备的标准，并在可能的情况下减少连接到一个集线器的USB 1.1的数量。 </p><br><p> 不幸的是，绝大多数基于廉价芯片的低成本集线器（我的A5集线器的fe1.1s，GL850G和ISP1521BE）都带有STT，价格更高且更先进（GL852G，GL854G（D-link DUB-H7的B1修订版正在讨论中）， GL3520，VL812，VL813，SMSC USB2514）正在运行MTT。 </p><br><p> 您可以通过阅读芯片上的数据表（但中国人常常不能或不想告诉芯片的品牌）来检查操作变送器的类型，或者通过将集线器连接到* nix计算机并执行lsusb -v命令并查找与正在研究的集线器相关的一条服务信息（通过名称）。  <b>DeviceProtocol</b>行将指示<i>Single TT</i>或<i>Multi TT</i> 。 很明显，只有使用Multi才能更好地购买：) </p><br><div class="spoiler">  <b class="spoiler_title">lsusb团队发布的中心特征描述</b> <div class="spoiler_text"><p> 总线001设备005：ID 2001：f103 D-Link Corp.  DUB-H7 7端口USB 2.0集线器 <br> 无法打开设备，某些信息将丢失 <br> 设备描述符： <br>  b长度18 <br>  bDescriptorType 1 <br>  bcdUSB 2.00 <br>  bDeviceClass 9集线器 <br>  bDeviceSubClass 0未使用 <br>  bDeviceProtocol 1单TT <br>  bMaxPacketSize0 64 <br>  idVendor 0x2001 D-Link Corp. <br>  idProduct 0xf103 DUB-H7 7端口USB 2.0集线器 <br>  bcdDevice 1.00 <br>  iManufacturer 0 <br>  iProduct 0 <br>  iSerial 0 <br>  bNumConfigurations 1 <br> 配置描述符： <br>  b长度9 <br>  bDescriptorType 2 <br>  wTotalLength 25 <br>  bNumInterfaces 1 <br>  bConfigurationValue 1 <br>  iConfiguration 0 <br>  bmAttributes 0xe0 <br> 自供电 <br> 远程唤醒 <br> 最大功率0mA <br> 接口描述符： <br>  b长度9 <br>  bDescriptorType 4 <br>  bInterfaceNumber 0 <br>  bAlternateSetting 0 <br>  bNumEndpoints 1 <br>  bInterfaceClass 9集线器 <br>  bInterfaceSubClass 0未使用 <br>  bInterfaceProtocol 0全速（或根）集线器 <br>  iInterface 0 <br> 端点描述符： <br>  b长度7 <br>  bDescriptorType 5 <br>  bEndpointAddress 0x81 EP 1输入 <br>  bmAttributes 3 <br> 传输类型中断 <br> 同步类型无 <br> 使用类型数据 <br>  wMaxPacketSize 0x0001 1x 1字节 <br>  b间隔12 </p></div></div><br><p> 运行<i>lsusb -v -t</i>命令时，您可以看到连接的USB设备的漂亮层次结构。 </p><br><img src="https://habrastorage.org/webt/qq/yv/7h/qqyv7hfnj27vnwtux7eebnwadia.jpeg"><br><p> 代替lsusb，可以将<i>hwinfo</i>实用程序与<i>--usb开关一起使用</i> （建议通过<i>sudo apt-get install hwinfo</i>进行预<i>安装</i> ）。 然后，有关USB设备的信息输出将看起来有些不同： </p><br><div class="spoiler">  <b class="spoiler_title">hwinfo发布的信息</b> <div class="spoiler_text"><p> 实验室@实验室G：〜$ hwinfo --usb <br>  23：USB 00.0：10a00集线器 <br>  [在usb.122创建] <br> 唯一ID：zFuK.sOcBcpBDhs4 <br> 父编号：k4bc.9T1GDCLyFd9 <br>  SysFS ID：/devices/pci0000:00/0000:00:1d.7/usb1/1-8/1-8:1.0 <br>  SysFS总线ID：1-8：1.0 <br> 硬件类别：集线器 <br> 型号：“ D-Link DUB-H7 7端口USB 2.0集线器” <br> 热插拔：USB <br> 供应商：usb 0x2001“ D-Link” <br> 设备：usb 0xf103“ DUB-H7 7端口USB 2.0集线器” <br> 修订：“ 1.00” <br> 司机：“枢纽” <br> 驱动程序模块：“ usbcore” <br> 速度：480 Mbps <br> 模块别名：“ usb：v2001pF103d0100dc09dsc00dp01ic09isc00ip00in00” <br> 配置状态：cfg =新建，可用性=是，需要=否，有效=未知 <br> 附加至：＃21（枢纽） </p></div></div><br><p> 总的来说，我们简要地了解了低速设备的功能，现在是时候进行软件部分了。 </p><br><h4> 管理USB端口电源 </h4><br><p> 我将马上说，我找不到在Windows环境中实现PPPS功能的方法（至少出于闲置的目的）。 最大值是使用<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">devcon</a></i>实用程序启用/禁用设备。 如果其中一位读者予以纠正和补充，我将感到高兴。 同时，所有过程都以Ubuntu为例（在openwrt的情况下-算法相似，尽管在最后一个主干中它应该已经包含在“发行版”中）。 </p><br><p> 因此，使用<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">集线器</a></b> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">-ctrl</a></b>程序或其后代<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">uhubctrl</a></b>在<u>具有</u>对此功能的<u>硬件支持的</u>集线器<u>上</u>实现了<i>每端口电源切换（PPPS）</i>或“端口电源切换”的<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">可能性</a></b> 。 我将依次考虑它们。 </p><br><h4> 集线器 </h4><br><p> 该程序是由日本<s>独立战斗机</s>工程师<b>Niibe Yutaka</b>于2006年编写的。 但是现在它可以正常工作了。 对于安装，我们需要任何* nix和<i>libusb-dev</i>库。 对于Ubuntu 16.04 LTS，算法如下： </p><br><blockquote><pre> 安装添加。 软件包：sudo apt-get update &amp;&amp; sudo apt-get install libusb-dev git gcc
下载源：git clone https://github.com/codazoda/hub-ctrl.c
与gcc一起编译：cd hub-ctrl.c &amp;&amp; gcc -o hub-ctrl hub-ctrl.c -lusb </pre></blockquote><p> 如果地址不可用，则可以<a href="" rel="nofollow">从此处</a>或<a href="" rel="nofollow">从此处</a>手动下载源<a href="" rel="nofollow">，</a>并使用上述命令进行编译。 </p><br><p> 该程序具有相当简单的命令行语法，适合以下描述： </p><br><p>  ./ <b>hub-ctrl</b> [{-h HUBNUM |  -b BUSNUM -d DEVNUM}] \ [-P PORT] [{-p [VALUE] |  -l [VALUE]} <br> 其中HUBNUM-集线器号，BUSNUM总线号，DEVNUM设备号，PORT端口号 </p><br><p> 为了找出这些参数，只需运行<i>lsusb</i>命令： </p><br><img src="https://habrastorage.org/webt/pp/ob/tz/ppobtz0tg81cjzgnvla8ej1vw5s.jpeg"><br><p> 顺便说一句，集线器-ctrl程序可以充当USB集线器的“探针”，因为它具有管理端口电源的能力。 使用-v开关运行它就足够了。 我们获得系统中可用的受支持集线器的列表（INFO行）和端口状态（在我的情况下，所有端口均已关闭）。 </p><br><blockquote>  lab @ lab-G：〜/ hub $ sudo ./hub-ctrl -v <br> 集线器＃0在001：006 <br>  INFO：单独电源开关。 <br> 警告：不支持端口指示灯。 <br> 集线器端口状态： <br> 端口1：0000.0000 <br> 端口2：0000.0000 <br> 端口3：0000.0000 <br> 端口4：0000.0000 <br> 端口5：0000.0000 <br> 端口6：0000.0000 <br> 端口7：0000.0000 </blockquote><p> 这是打开所有端口时的配置外观： </p><br><blockquote>  lab @ lab-G：〜/ hub $ sudo ./hub-ctrl -v <br> 集线器＃0在001：006 <br>  INFO：单独电源开关。 <br> 警告：不支持端口指示灯。 <br> 集线器端口状态： <br> 端口1：0000.0100电源 <br> 端口2：0000.0100电源 <br> 端口3：0000.0100电源 <br> 端口4：0000.0100电源 <br> 端口5：0000.0100电源 <br> 端口6：0000.0100电源 <br> 端口7：0000.0100电源 </blockquote><p> 要启用其中一个端口，您需要运行<i>sudo命令./hub-ctrl -h 0 -P 1 -p 1</i> ，其中-h指示我们使用的是哪个集线器（本例中为第0个），-P表示哪个端口（1-第一个端口），-p指示状态（0-off，1-on）。 </p><br><img src="https://habrastorage.org/webt/ko/4r/wl/ko4rwlpq2_uxinhoukzh-xltvfc.jpeg"><br><p> 要获得上图所示的配置，必须依次执行以下命令（对于最初禁用的端口）： </p><br><p> 须藤./hub-ctrl -h 0 -P 2 -p 1 <br> 须藤./hub-ctrl -h 0 -P 4 -p 1 <br> 须藤./hub-ctrl -h 0 -P 6 -p 1 </p><br><p> 因此，编写脚本以使LED以期望的顺序闪烁有趣并不困难。 这样的例子已经存在并且可以成功运行： <br>  USB集线器， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">圣诞节花环</a>等上的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">摩尔斯电码</a> 等 对我而言，从hub-ctrl的功能来看，循环切换功能不足以实现我的瞬时照明幻想（以免浪费时间编写脚本等）。 在后继者uhubctl中消除了此烦人的缺陷。 </p><br><h4> 联合大学 </h4><br><p>  uhubctl程序是优化的hub-ctrl模拟程序，具有一些外观差异（当然，它支持更多设备）。 </p><br><div class="spoiler">  <b class="spoiler_title">使用uhubctl工作：</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pn/qg/dw/pnqgdwes-bvg0n35yepl4pjjsp0.jpeg"></div></div><br><p> 从理论上讲，该实用程序可以编译为在Windows环境中运行，但是...但是，到目前为止，它是通过winusb.sys驱动程序与实用程序进行交互的，该驱动程序无法直接访问集线器。 该程序还声称支持USB 3.0（顺便说一句，支持Per-Port电源切换的USB 3.0集线器比具有类似功能的USB 2.0集线器要多得多）。 当使用连接到USB 3.0上游端口的USB 3.0集线器时，程序将其定义为两个独立的虚拟集线器：USB 2.0和USB 3.0，并且USB设备本身将根据其功能和连接速度连接到其中一个。 。 因此，要管理此类设备，该程序默认情况下启用/禁用虚拟集线器的电源（您可以通过在启动命令中添加-e开关将实用程序切换为手动模式）。 </p><br><p>  <u>重要说明：</u> USB端口<u>的</u>寻址系统可能会造成一些混乱（对于hub-ctrl和uhubctl来说是相似的）。 在工作时，它使用与Linux内核中相同的寻址方法：bx.yz，其中b是USB总线号，而x，y，z是主机链的端口号，从此总线的根USB集线器开始。 如果有多个受管USB集线器，则可以通过使用-l（位置）选项运行uhubctl来确定正确的选项。 我注意到该寻址是半稳定的-如果断开USB设备并将其重新连接回同一物理端口，则该寻址将不会改变。 </p><br><p> 该程序的编译算法类似于hub-ctrl的算法。 唯一的例外是，您需要使用常用的<i>sudo apt-get install libusb-1.0-0-dev</i>命令安装libusb-1.0库（1.0.12版或更高版本），然后使用<i>make</i>命令编译二进制文件。 </p><br><p> 启动程序的语法如下。 </p><br><p>  uhubctl -a off -p 2 </p><br><p> 此命令关闭端口2（-p 2）的电源（-a关闭或-a 0）。 支持关闭/打开/循环（或0/1/2）命令。  <i>循环</i>开关关闭电源，等待一会儿（由-d开关确定），然后重新打开。 即 现在，集线器可以轻松更换微控制器以进行闪烁。 </p><br><h4> 从这一切得出的结论是什么 </h4><br><p> 因此，D-Link的旧集线器中的“秘密”就在那里。 如果您需要远程控制连接到USB总线的一系列设备，则使用所述技术（PPPS）是合理的。 此外，此方法已用于禁用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">硬盘驱动器</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">网络摄像头</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">GSM调制解调器</a> （例如图片中）： </p><br><img src="https://habrastorage.org/getpro/habr/post_images/d29/99a/e9b/d2999ae9b1938357484853650973e9b0.png" alt="图片"><br><p> 尽管，对于我提到的调制解调器和D-link DUB-H7，有些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">人</a>对这种捆绑包的可操作性表示怀疑（使用hub-ctrl程序时）。 </p><br><div class="spoiler">  <b class="spoiler_title">原因是...</b> <div class="spoiler_text"><p>  “ ...使用Dlink DUB H-7进行的实验表明，hub-ctrl -p 0仅将电压降低至1.47V。但是，将调制解调器插入这样的“禁用端口”后，LED不会闪烁，但是文件/ dev / ttyUSBx    .     .            ." </p></div></div><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当选择下一个USB集线器时，本文中描述的实用程序（lsusb，hwinfo，hub-ctrl）可能是一个很好的帮助，尤其是在您无权查看内部设备的情况下。</font><font style="vertical-align: inherit;">关于habr用户，已经描述了理想的USB集线器的想法和期望（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">我认为，所描述的用于检查现有集线器的算法将完美地补充和淡化作者描述的方法。</font><font style="vertical-align: inherit;">因此，此后，从电路解决方案的角度来看，我认为本文的英雄（D-link DUB-H7版本A5）看起来非常好。</font><font style="vertical-align: inherit;">也许，我在向SIM卡鞠躬：)</font></font></p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/s3/5l/vm/s35lvmfuuc9jd67i9gvfk5s67n0.jpeg"></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为向Habr社区成员提出问题，他们突然之间偶然地躺在与我的D-link DUB-H7一样的灰色箱子里。</font></font><p></p><br><img src="https://habrastorage.org/webt/_j/jb/pk/_jjbpk6wn6mj9ftl9m2i8wscjgo.jpeg"><br><p>        (   -   )?    RP1...RP2 (     0- c). </p><br><p> <u></u> :   -     EEPROM 24C02,     : </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/67/_w/zm/67_wzmql8dpwcrzyjeybmwvvxaa.jpeg"></div><br><p> <u>!</u> 现在可以在我的电报频道<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">lab66中</a></b>看到所有更新和临时注释，然后可以轻松地形成habr文章。 订阅以免期望下一篇文章，而立即了解所有研究信息：) </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://simple-is-beauty.blogspot.com/2017/12/usb-port-control.html</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://askubuntu.com/questions/149242/is-it-possible-to-power-up-ports-on-a-usb-hub-from-ubuntu</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.ibuyopenwrt.com/index.php/15-yun-compatible/hardware-yun/36-usb-hub-per-port-power-switching-2</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.joeldare.com/wiki/usb_powered_animated_christmas_lights</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://michaelbluejay.com/batteries/dc-christmas-lights.html</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://forum.archive.openwrt.org/viewtopic.php?id=49012</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://atotto.hatenadiary.jp/entry/linux-sugoi-usb-hub-power-ctrl</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://hant.helplib.com/GitHub/article_111870</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.quaxio.com/hub_ctrl/</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://forum.ixbt.com/topic.cgi?id=13:40305-4</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">http://www.cypress.com/file/124006/download</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">https://github.com/mvp/uhubctl</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">https://github.com/crazystick/py-hub-ctrl</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">http://atc-ip.ru/info/29/1.html</a> </li></ol></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN430220/">https://habr.com/ru/post/zh-CN430220/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN430208/index.html">麻省理工学院的课程“计算机系统安全”。 讲座18：“私人互联网浏览”，第3部分</a></li>
<li><a href="../zh-CN430210/index.html">Check Point安全学院测试我的耐心</a></li>
<li><a href="../zh-CN430212/index.html">OpenSceneGraph：场景几何基础</a></li>
<li><a href="../zh-CN430216/index.html">据我了解，我吃了很多甜食，或者按申请中的支票分类商品</a></li>
<li><a href="../zh-CN430218/index.html">能源优化STM32：实用指南</a></li>
<li><a href="../zh-CN430222/index.html">寻找工作的高级工程师。 我如何接受20次人力资源采访以​​及对此的看法</a></li>
<li><a href="../zh-CN430224/index.html">精神分裂症：内在外观</a></li>
<li><a href="../zh-CN430226/index.html">从var b到面试</a></li>
<li><a href="../zh-CN430228/index.html">X形标记是使用来自两颗科学卫星SENTINEL-1的开放数据分析进行雷达识别的方法</a></li>
<li><a href="../zh-CN430230/index.html">如何在成长中的初创企业中保持一席之地</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>