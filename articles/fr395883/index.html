<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‼️ 🚝 👂🏽 Prise intelligente REDMOND Prise intelligente SkyPlug RSP-100S (partie 2). Le principal inconvénient de la sortie et de son élimination 🙅🏻 🙏🏼 👨🏿‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Donc, j'ai finalement «terminé» la deuxième partie sur la prise intelligente Redmond SkyPlug RSP-100S. 
 
 Comme je l'ai dit dans la première partie -...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prise intelligente REDMOND Prise intelligente SkyPlug RSP-100S (partie 2). Le principal inconvénient de la sortie et de son élimination</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395883/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donc, j'ai finalement «terminé» la deuxième partie sur la prise intelligente Redmond SkyPlug RSP-100S. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai dit dans la première partie - l'article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Smart socket Redmond SkyPlug RSP-100S. Analyse du schéma de conception et du circuit électrique. Identification des défauts »</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , j'ai été contraint de dessiner un schéma de cette prise afin de le finaliser. Je n'ai vraiment pas aimé un de plus, à mon avis, le principal inconvénient de cette prise intelligente, dont je n'ai pas parlé dans la première partie. En fait, j'aime modifier quelque chose, mes collègues de travail plaisantent même que si quelque chose n'est pas développé par moi, alors ce quelque chose n'est pas le mien. :)</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous allons annoncer cette lacune, et cela, si beaucoup n'ont pas deviné en regardant le schéma, c'est le manque de source d'alimentation autonome. Le fait est que le circuit intégré nRF51822 a une horloge en temps réel, et ils fonctionnent, c'est-à-dire ils ne comptent le temps que lorsque le réseau est alimenté, car Il n'y a pas de source d'alimentation interne, pas de batterie, pas de batterie ou même une ionistance. Et cela signifie que si une panne de courant se produit, même pendant une courte période, l'horloge sera réinitialisée et les programmes d'activation / désactivation précédemment enregistrés deviendront non pertinents. À l'aide d'une prise intelligente, j'ai immédiatement attiré l'attention sur cette lacune et y ai attaché une grande importance, car L'électricité de ma ville est souvent coupée. Surtout souvent, il y a des coupures de courant pendant un orage, etc. Et un autre inconvénient est que le socket ne sauvegarde pas l'état actuel,et s'il était à l'état «On» pendant une panne de courant, alors après avoir fourni de l'électricité, il commence à fonctionner à l'état «Off».</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'une manière ou d'une autre, j'ai dû quitter la maison pendant quelques semaines et j'ai demandé à une merveilleuse personne de venir chez moi pour nourrir les poissons d'aquarium. Et un jour, elle m'appelle et me dit que l'éclairage de l'aquarium est éteint. J'ai demandé à voir si les heures sur le micro-ondes indiquaient l'heure, à laquelle j'ai reçu une réponse - non, et c'est mon indicateur de panne de courant. J'ai immédiatement réalisé qu'il y avait une panne de courant, et lorsque l'alimentation a été rétablie, la prise intelligente ne s'est pas allumée, car elle ne prévoyait pas le stockage du dernier état dans le firmware. Mais même si la condition était stockée, en raison du manque d'heure exacte, cette condition pourrait ne pas être pertinente, par exemple, si l'électricité était coupée pendant la journée et rétablie tard dans la nuit, lorsque l'éclairage dans le même aquarium n'est plus nécessaire.Ici, l'idée est venue de modifier une prise intelligente et d'y introduire une source d'alimentation autonome. Pour ce faire, je devais connaître le principe de fonctionnement et, par conséquent, connaître le schéma électrique d'une prise intelligente: quelles sont les tensions d'alimentation, quels composants, quel contrôleur Bluetooth, où sont stockés les programmes marche / arrêt et où sont comptés l'heure et les jours de la semaine, et probablement et les dates. Le timing de toute la logique du socket aurait dû être intégré, car Les programmes d'activation / désactivation via le smartphone sont définis par le jour de la semaine et pendant un certain temps, et la connexion Bluetooth avec le smartphone n'est pas toujours prise en charge et, par conséquent, la prise intelligente n'a pas de synchronisation constante de l'heure et des programmes. À la suite du travail décrit dans la première partie, j'ai déterminéque les programmes marche / arrêt sont stockés dans la mémoire du contrôleur Bluetooth lui-même et qu'il a également une horloge en temps réel, et que l'horloge est synchronisée lorsque la prise intelligente est connectée via Bluetooth à un smartphone, c'est-à-dire le temps est pris depuis le smartphone à chaque connexion.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, il est devenu clair qu'une protection contre la perte d'électricité dans le réseau d'éclairage électrique était nécessaire, au moins pendant quelques heures, et cela ne peut être résolu que par l'introduction des dispositifs ci-dessus: une batterie, une batterie ou un ionistor. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 RECHERCHE D'UNE MÉTHODE D'ALIMENTATION HORS LIGNE</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, j'ai décidé d'essayer la chose la plus simple - l'ionistor, car cet appareil n'a pas besoin d'entrer dans des circuits de charge, et il suffit de le connecter en parallèle avec les sorties de puissance du contrôleur Bluetooth, et l'ionistor serait chargé de la source d'alimentation à la tension de cette source. J'ai soudé les broches 1 et 4 du siège pour la prise XP1 (je me souviens que cette fiche n'est pas sur la carte, mais il y a un endroit et des trous pour elle, les broches extrêmes dont 1 et 4 sont des broches connectées aux circuits d'alimentation du contrôleur Bluetooth, et il devrait y avoir tension 3,3 V). L'ionistor a été chargé à la tension d'alimentation du contrôleur Bluetooth, mais après avoir déconnecté la prise intelligente du réseau, l'ionistor a été déchargé en environ une minute. L'énergie accumulée par l'ionistor n'était pas suffisante pour maintenir le courant pendant quelques heures, caril y a des cas de coupures de courant pendant 1 à 2 heures. Je dois dire que l'ionistor que je mets n'est pas de très grande capacité, seulement 0,33 F, car De plus grandes capacités, les ionistors avaient déjà des dimensions assez décentes et il ne serait pas facile de les insérer dans les prises. Et, comme la pratique l'a montré, même si vous mettez l'ionistor à 1,0 F, cela ne durerait pas aussi longtemps que nous le souhaiterions, mais, bien sûr, il conviendrait parfaitement aux coupures de courant à court terme.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'ionistor, il y avait une idée de mettre quelque chose comme une batterie au lithium, de type similaire aux ordinateurs - CR2032, mais pas de cette taille, mais plus petite - CR1620. Mais, cette idée a été éliminée presque immédiatement, car la batterie est de courte durée - elle va rapidement s'asseoir et ne peut pas être chargée, et il est également difficile de la connecter - le soudage des conducteurs n'est pas une bonne idée, car Vous pouvez surchauffer et cela échouera. Je n'ai pas trouvé de batteries de petite taille avec des bornes soudées dans ma ville à vendre, mais même si je le faisais, je devrais démonter la prise à chaque fois ou la remplacer, ce qui augmenterait les dimensions de la prise intelligente et perdrait son aspect esthétique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque je cherchais des ionistors et des batteries, dans l'un des magasins de radio sur la fenêtre, j'ai remarqué des batteries Li-Pol de petite taille, en forme de parallélépipède rectangulaire et, surtout, de dimensions appropriées, à mon avis. Le magasin avait des batteries d'une capacité de 20, 40, 65 et 100 mAh. J'ai alors compris qu'il semblait être le mieux adapté pour 65 mAh dans les dimensions globales, mais j'ai quand même dû regarder à l'intérieur de la prise et évaluer l'espace sous la batterie afin de ne pas être déçu en achetant le mauvais, et le prix est plutôt élevé: à partir de 200 jusqu'à 350 roubles et, comme le mal, 65 mAh - le plus cher. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 FONCTIONNEMENT DE LA PUISSANCE AUTONOME SUR LA BASE DE LA BATTERIE</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis qu'il a été décidé de mettre la batterie, il y avait maintenant un problème dans l'application du circuit de charge de cette batterie et l'organisation de l'alimentation de la puce du contrôleur Bluetooth, car il a une tension de fonctionnement admissible de 3,6 V, selon la fiche technique, et une batterie Li-Pol entièrement chargée produit une tension de 4,2 V.Pour charger la batterie, en particulier avec une si petite capacité, un petit courant est nécessaire, et il était nécessaire de faire un circuit de charge avec limitation de courant . Le circuit du TP4056 IC m'est immédiatement venu à l'esprit. Mouchoirs prêts à l'emploi - chargeurs pour batteries Li-Ion, sur la base de ce microcircuit, j'ai commandé sur un site bien connu il n'y a pas si longtemps, et quand ils sont arrivés, ils n'ont pas été immédiatement utilisés, et ils ont été envoyés en toute sécurité à la boîte, où ils attendaient leur sort. Ils n'ont pas dû attendre longtemps pour au moins l'un d'entre eux. Le tableau ressemble à la photo ci-dessous,il contient le TP4056 IC, les LED d'indication de mode et le reste du faisceau. Bien que cette puce soit également destinée aux batteries Li-Ion, je pense qu'elle le fera également pour Li-Pol.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b88/7d9/524/b887d9524fe84d80a4ae8b6e800dbba0.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 1 - Contrôleur de charge de batterie basé sur l'IC TP4056</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon la description sur le site Web du vendeur, cette instance est conçue pour un courant de charge de 1 A, cela s'explique par la valeur de résistance appliquée installée entre le fil commun (IN-) et la broche 2 du microcircuit, sur la photo, cette résistance est inférieure à - 1,2 kOhm, ce qui correspond à la limitation de la fiche technique courant de charge de 1 A. Selon la fiche technique, dans laquelle un tableau des courants de charge était donné en fonction de la résistance nominale, je ne pouvais pas prendre une résistance qui donnerait un courant de charge inférieur à 130 mA, ce qui est deux fois plus que la capacité de la batterie, et les batteries ne se chargent généralement pas avec du courant plus de 0,2 de C (où C est la capacité de la batterie). Dans ce cas, j'ai suggéré qu'une batterie d'une capacité de 65 mAh me convient, c'est-à-dire C = 65 mAh, d'où nous déterminons le courant de charge 13 mA. Pour assurer une telle limitation de courant, il a fallu sélectionner une résistance entre le fil commun et la broche 2 du microcircuit.Sur la base des valeurs de résistance disponibles et des courants correspondants, j'ai fait un graphique sur lequel j'ai continué conditionnellement la ligne dans le sens d'augmenter la résistance de la résistance et déterminé approximativement la valeur souhaitée au courant requis, j'ai choisi la résistance de 62 kOhm. Ensuite, selon la fiche technique, la résistance provenant de l'alimentation de la broche IC TP4056 (broche 4) devrait être de 0,2 à 0,5 Ohms, mais comme la résistance était de 0 Ohms (cavalier) sur la carte, j'ai décidé de suivre la fiche technique et à partir des résistances de surface de petite taille disponibles, j'ai trouvé une sur 1 Ohm et deux sur 1,5 Ohm, les ai toutes soudées en parallèle et ainsi gagné une résistance d'environ 0,43 Ohm. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.sur lequel j'ai continué conditionnellement la ligne dans le sens d'augmenter la résistance de la résistance et déterminé approximativement la valeur souhaitée au courant requis, j'ai choisi la résistance de 62 kOhm. Ensuite, selon la fiche technique, la résistance provenant de l'alimentation de la broche IC TP4056 (broche 4) devrait être de 0,2 à 0,5 Ohms, mais comme la résistance était de 0 Ohms (cavalier) sur la carte, j'ai décidé de suivre la fiche technique et à partir des résistances de surface de petite taille disponibles, j'ai trouvé une sur 1 Ohm et deux sur 1,5 Ohm, les ai toutes soudées en parallèle et ainsi gagné une résistance d'environ 0,43 Ohm. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.sur lequel j'ai continué conditionnellement la ligne dans le sens d'augmenter la résistance de la résistance et déterminé approximativement la valeur souhaitée au courant requis, j'ai choisi la résistance de 62 kOhm. Ensuite, selon la fiche technique, la résistance provenant de l'alimentation de la broche IC TP4056 (broche 4) devrait être de 0,2 à 0,5 Ohms, mais comme la résistance était de 0 Ohms (cavalier) sur la carte, j'ai décidé de suivre la fiche technique et à partir des résistances de surface de petite taille disponibles, j'ai trouvé une sur 1 Ohm et deux sur 1,5 Ohm, les ai toutes soudées en parallèle et ainsi gagné une résistance d'environ 0,43 Ohm. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.selon la fiche technique, la résistance provenant de l'alimentation de la broche IC TP4056 (broche 4) devrait être de 0,2 à 0,5 Ohms, mais comme la résistance était de 0 Ohms (cavalier) sur la carte, j'ai décidé de suivre la fiche technique de J'ai trouvé l'une des petites résistances de surface, une sur 1 Ohm et deux sur 1,5 Ohm, les ai toutes soudées en parallèle et ainsi gagné une résistance d'environ 0,43 Ohm. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.selon la fiche technique, la résistance provenant de l'alimentation de la broche IC TP4056 (broche 4) devrait être de 0,2 à 0,5 Ohms, mais comme la résistance était de 0 Ohms (cavalier) sur la carte, j'ai décidé de suivre la fiche technique de J'ai trouvé l'une des petites résistances de surface, une sur 1 Ohm et deux sur 1,5 Ohm, les ai toutes soudées en parallèle et ainsi gagné une résistance d'environ 0,43 Ohm. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.ils les ont tous soudés en parallèle et ont ainsi acquis une résistance d'environ 0,43 ohms. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.ils les ont tous soudés en parallèle et ont ainsi acquis une résistance d'environ 0,43 ohms. Honnêtement, je ne sais pas pourquoi, cette résistance, car à en juger par le circuit, cette résistance n'est pas un shunt, mais, peut-être, elle tient lieu en cas de court-circuit dans la batterie pour limiter le courant.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, lorsque les résistances ont été sélectionnées et soudées, il était nécessaire de couper l'excédent de la carte contrôleur de charge, à savoir la zone où le connecteur mini-USB est soudé, cette zone ne permettrait pas à la carte d'être insérée à l'endroit prévu pour elle dans le cas, et si elle était coupée, puis le tableau est clairement placé là où je l'ai défini. Donc, nous démontons la prise mini-USB afin qu'il soit plus pratique de couper l'excédent avec des ciseaux pour le métal. Ci-dessous dans l'image, vous pouvez voir à quoi ressemble le tableau une fois terminé. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d14/b37/3d3/d14b373d3af54b1bbd0843f75d4f72cb.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2 - Contrôleur de charge de batterie modifié </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais sur cette image, vous pouvez voir où vous pouvez placer la carte du contrôleur de charge dans le boîtier de prise intelligente: </font></font><br>
<br>
<img src="https://habrastorage.org/files/4ed/ee9/c9b/4edee9c9bf0249eda12f00a0a0e917ba.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 3 - Placement du contrôleur de charge de batterie dans le boîtier de prise intelligente</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le problème suivant est survenu. Maintenant, nous devons alimenter le contrôleur de charge avec quelque chose, car l'alimentation sans transformateur de la prise intelligente a été conçue pour 12 V, dans le mode lorsque le relais est éteint, et le contrôleur de charge TP4056, selon la fiche technique, n'est alimenté que par 8 V.Par conséquent, vous ne pouvez pas charger directement le contrôleur de charge , et il était nécessaire de baisser la tension pour assurer le bon fonctionnement du TP4056. Mais il vaut mieux être alimenté en 5 V, car c'est une tension plus courante, et en plus il y avait une mini-prise USB sur la carte, ce qui impliquait une alimentation à partir de 5 V. La chose la plus simple et la plus petite que j'ai pu trouver pour obtenir 5 V était de mettre un stabilisateur linéaire dans le boîtier SOT-23 ou SOT-89, parce que les courants de charge (charge) ne dépasseront pas 100 mA, pour lesquels de tels stabilisateurs de petite taille sont généralement conçus.De l'arsenal existant, il y avait un microcircuit L78L05ABUTR dans le boîtier SOT-89, que j'ai décidé d'utiliser, mais il devait être installé quelque part et souder une telle bagatelle est lourd de montage - il était possible de rompre les conclusions, et il y avait un risque de fermer quelque chose quelque part quelque part , car il n'y a pas beaucoup d'espace libre sur la carte d'une prise intelligente. Par conséquent, il a rapidement fabriqué un mouchoir pour cette puce, sur laquelle il a également prévu l'installation de condensateurs en céramique.</font></font><br>
<br>
<img src="https://habrastorage.org/files/991/482/c2f/991482c2f12b44beb6999c6f4b403a4e.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 4 - Régulateur de tension linéaire pour 5 V </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, quand il y avait un contrôleur de charge et une carte d'alimentation pour le contrôleur de charge, j'ai pu évaluer le lieu de leur installation, et maintenant c'était déjà visible - où l'une des batteries serait appréciée. J'ai visité à nouveau ce magasin, j'ai tout regardé à nouveau, et pourtant j'ai choisi celui qui était à 65 mAh, on peut le voir dans l'image ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/files/b2e/d0f/864/b2ed0f864f2d4bf9b9feedc15952a444.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 5 - Batterie Li-Pol LP451124 </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 ASSEMBLAGE D'UN SYSTÈME D'ALIMENTATION ÉLECTRIQUE</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Il y a maintenant une batterie, un circuit de charge, un régulateur de tension pour un circuit de charge, nous le connectons tous dans l'ordre correspondant et obtenons la conception comme dans l'image ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/files/1fe/7a2/995/1fe7a2995c7246ed8a353872e4ccba0a.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 6 - Batterie avec contrôleur de charge</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous vérifions cet assemblage au travail. Nous appliquons une tension légèrement supérieure à 5 V au stabilisateur et examinons la tension à la sortie du stabilisateur puis sur la batterie. Dans mon cas, tout a fonctionné immédiatement, le courant de charge a circulé vers la batterie et la LED rouge était allumée. Ayant un peu résisté et maîtrisé le courant de charge, j'ai conclu que la charge se fait lentement, qu'il faudrait augmenter le courant de charge. Encore une fois, j'ai regardé la fiche technique de la batterie et il a été dit que le courant de charge standard de cette batterie est de 0,5 • C, ce qui correspond à un courant de 27,5 mA. Ensuite, j'ai réduit la résistance de la résistance, qui définit le courant de charge à 47 kOhm, ce qui a permis de charger la batterie plus rapidement et une LED verte sur le contrôleur s'est allumée, indiquant la fin de la charge.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une batterie, un contrôleur de charge et un stabilisateur de tension pour le contrôleur de charge, maintenant nous devons considérer le circuit d'alimentation du contrôleur Bluetooth nRF51822 afin de ne pas dépasser la tension d'alimentation de 3,6 V sur celui-ci, et encore mieux de ne pas dépasser 3,0 - 3,3 V, auquel cas Le fabricant garantit un fonctionnement normal. Pour cela, la chose la plus simple et la plus petite à laquelle vous pouvez penser est de mettre la tension de la batterie à travers deux diodes connectées en série du type 1N4148, sur lesquelles 0,5 - 0,6 V chutent chacune, en conséquence, après les diodes, nous obtenons une tension de 3,0 - 3 , 2 V, ce qui est acceptable pour le fonctionnement du CI nRF51822. De plus, les diodes ne permettront pas à la batterie de se décharger lorsqu'il y a de la tension dans le réseau, la sortie du stabilisateur linéaire DD1 dans le cadre du circuit natif de la prise intelligente aura une tension de 3,3 V,en conséquence, les diodes se fermeront et la tension n'ira pas à la batterie et la tension de la batterie n'ira pas non plus à nRF51822 quand il y a de la tension dans le réseau. Même dans la fiche technique du nRF51822, il est dit que la tension de fonctionnement minimale est de 1,8 V, ce qui, lorsque la batterie est déchargée à 2,8 - 3 V, nous permettra de soutenir le fonctionnement du nRF51822 en l'absence d'énergie électrique dans le réseau, ce qui signifie que l'horloge en temps réel n'est toujours pas remise à zéro sera maintenu dans l'état «On» ou «Off» - comme avant une coupure de courant, et cet état sera maintenu jusqu'à ce que le programme s'exécute, si le moment vient s'il a été réglé, ou jusqu'à ce que la batterie s'épuise.Même dans la fiche technique du nRF51822, il est dit que la tension de fonctionnement minimale est de 1,8 V, ce qui, lorsque la batterie est déchargée à 2,8 - 3 V, nous permettra de soutenir le fonctionnement du nRF51822 en l'absence d'énergie électrique dans le réseau, ce qui signifie que l'horloge en temps réel n'est toujours pas réinitialisée sera maintenu dans l'état "On" ou "Off" - comme avant une coupure de courant, et cet état sera maintenu jusqu'à ce que le programme s'exécute, si le moment vient s'il a été réglé, ou jusqu'à ce que la batterie s'épuise.Même dans la fiche technique du nRF51822, il est dit que la tension de fonctionnement minimale est de 1,8 V, ce qui, lorsque la batterie est déchargée à 2,8 - 3 V, nous permettra de prendre en charge le fonctionnement du nRF51822 en l'absence d'énergie électrique dans le réseau, ce qui signifie que l'horloge en temps réel n'a pas été réinitialisée à ce point et la charge sera maintenu dans l'état «On» ou «Off» - comme avant une coupure de courant, et cet état sera maintenu jusqu'à ce que le programme s'exécute, si le moment vient s'il a été réglé, ou jusqu'à ce que la batterie s'épuise.et cet état sera maintenu jusqu'à ce que le programme s'exécute, le moment venu, s'il a été défini ou jusqu'à ce que la batterie soit épuisée.et cet état sera maintenu jusqu'à ce que le programme s'exécute, le moment venu, s'il a été défini ou jusqu'à ce que la batterie soit épuisée.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 CIRCUIT CIRCUIT ÉLECTRIQUE D'UNE PRISE INTELLIGENTE AVEC ALIMENTATION AUTONOME</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous construisons un nouveau schéma électrique d'une prise intelligente modifiée, une source d'alimentation autonome basée sur une batterie Li-Pol. Le diagramme est présenté dans la figure ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/files/276/ce6/7cb/276ce67cb6c84f5f8bb4879adbc8db97.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 7 - Représentation schématique du raffinement électrique d'une prise intelligente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le schéma, des diodes supplémentaires du type 1N4148 ont les désignations de position D1 et D2 et sont également entourées par une ligne en pointillés dans la carte A1 pour faciliter la recherche. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 INSTALLATION DU SYSTÈME D'ALIMENTATION AUTONOME SUR LA BASE DE LA BATTERIE. ASSEMBLAGE DU NOUVEAU DESIGN DE LA SMART SOCKET</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon le schéma, des diodes supplémentaires doivent être installées sur la carte de prise intelligente, puis la batterie, le contrôleur de charge et le stabilisateur doivent être installés dans le boîtier de la prise intelligente aux endroits prescrits et dessouder toutes les entrées et sorties. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous réglons le contrôleur de charge et le stabilisateur comme indiqué dans l'image ci-dessous. Nous insérons simplement la carte du contrôleur de charge dans l'espace entre le support pour la vis et la saillie de la prise sous la fiche, elle y est insérée relativement fermement - elle ne dépasse pas et ne sort pas, et nous plaçons la carte du régulateur de tension pour le contrôleur sur la colle thermofusible avec les éléments vers la prise. On voit également que j'ai à moitié collé le support de mise à la terre avec du ruban adhésif résistant à la chaleur, pour lequel il deviendra clair ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/files/816/84c/e02/81684ce024e84159a68c7863a43edcd0.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 8 - Installation du contrôleur de charge Nous </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
installons la batterie en place, comme indiqué sur la photo ci-dessous:</font></font><br>
<br>
<img src="https://habrastorage.org/files/004/403/8cd/0044038cd6284fbbbf97c9c849b95142.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 9 - Installation de la batterie</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La photo montre que la batterie est installée dans l'ouverture de l'un des coins de la prise sur un côté du support de mise à la terre. Pour l'isolation, j'ai collé ce support avec deux couches de ruban résistant à la chaleur, d'une part, il isole les bornes de la batterie, et d'autre part, il y aura une isolation supplémentaire de phase et de terre, car La batterie a une tension de phase ouverte. Les conducteurs de la polarité correspondante sont soudés aux bornes de la batterie, qui vont de la carte du contrôleur de charge, et de la carte du contrôleur de charge, les conducteurs vont alimenter le contrôleur Bluetooth via des diodes sur la carte de prise, comme indiqué dans le schéma de circuit. J'ai isolé les bornes de la batterie avec des conducteurs soudés avec un tube thermorétractable et j'ai plié les bornes et une partie de la coque sans mouvements brusques à un angle de 90 ° jusqu'à la base de la prise où le support de mise à la terre est installé.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le câblage de l'alimentation du stabilisateur et de la sortie de la batterie, ainsi que l'installation de diodes supplémentaires D1 et D2, peuvent être effectués comme indiqué sur la photo ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/files/1e0/748/fe4/1e0748fe47ba4812bedba86bc9d90649.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 10 - Câblage des circuits de batterie et des diodes supplémentaires</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette installation de la batterie, du contrôleur de charge et du régulateur de tension pour le contrôleur de charge vous permet d'assembler librement la prise, c.-à-d. la batterie et les cartes supplémentaires après assemblage n'interfèrent pas du tout avec la carte principale: rien ne repose et ne se soucie pas. Mais néanmoins, pour plus de fiabilité, j'ai isolé avec un ruban résistant à la chaleur l'endroit de la soudure du fil de terre allant au support de mise à la terre de la charge du support de mise à la terre. Et vous devez également faire attention aux conducteurs flexibles, qui, lors du montage, doivent être rentrés afin qu'ils ne traversent pas les ouvertures de contact de la fiche secteur. Peut-être, dans mon cas, il sera nécessaire de les saisir quelque part avec de la colle chaude. Soit dit en passant, comme les conducteurs, j'ai utilisé le fil MGTF-0,12, il est suffisamment résistant pour une panne à haute tension et l'isolation ne fond pas lorsqu'elle est soudée.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b9b/2ab/e13/b9b2abe139b348f290c6cdd8fb801bf0.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 11 - Emballage des conducteurs autour de la sortie de la prise </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir installé la batterie, j'ai remarqué que le support qui met à la terre la charge, si vous insérez la fiche de charge dans la prise intelligente, sera fortement appuyé contre la batterie, ce qui pourrait endommager ou court-circuiter la batterie, donc ce support doit être finaliser, à savoir plier, comme indiqué sur la photo ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/files/34a/929/4b3/34a9294b375a4e889f480f011754d34f.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 12 - Formation des contacts du support de mise à la terre </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, vous pouvez retirer complètement ce support, mais il est plus sûr avec la terre si vous disposez d'un réseau d'alimentation à trois fils. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 VÉRIFICATION DU TRAVAIL ET RÉALISATION DES ESSAIS PRÉLIMINAIRES DE LA DOUILLE SMART DÉVELOPPÉE</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, après le travail effectué et l'assemblage, nous avons une prise plus intelligente, c'est-à-dire déjà moins dépendante d'une panne de courant, avec la batterie et le contrôleur de charge de la batterie à bord, et même à travers le boîtier, vous pouvez voir la lueur des LED du contrôleur de charge, rouge - la charge est allumée, verte - la charge est terminée. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e3b/72c/b7c/e3b72cb7c9124964aca76bb1c1b3bc41.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 13 - Indication du mode de charge</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'assemblage, un test a été effectué, la charge a été effectuée, au fil du temps, une LED verte s'allume, indiquant la fin de la charge, l'horloge en temps réel considère que l'état «On» / «Off», respectivement, est également pris en charge, mais sinon pour un «mais». Il s'est avéré que si pendant la panne de courant il y avait un état "On", c'est-à-dire que le transistor VT2 est resté ouvert, après que l'électricité a été restaurée dans le réseau, la prise a été allumée et il est clair que la LED VD6 est "On", mais puisque le transistor est ouvert, Au moment de l'alimentation, le courant provenant de la sortie du pont de diodes traverse immédiatement la bobine de relais et le transistor, par conséquent, le condensateur n'a pas le temps de charger jusqu'à 12 V et la tension est immédiatement comprimée jusqu'à 5 - 6 V, ce qui n'était pas suffisant pour garantir le fonctionnement du relais. Il s'est avéréqui semble être une prise à l'état "On", et le relais ne s'allume pas - l'alimentation est faible, et il faudrait augmenter sa puissance.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7 MODIFICATIONS SUPPLÉMENTAIRES DE LA SOURCE D'ALIMENTATION D'UNE PRISE INTELLIGENTE. ESSAIS FINAUX </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai commencé à découvrir quel type de condensateurs de ballast C3 et C5 étaient utilisés dans cette prise afin de trouver les mêmes et de les ajouter si possible. J'ai mesuré leur capacité, j'ai obtenu environ 0,47 microfarad chacun, pour un total d'environ 1 microfarad. Mais il n'est pas possible de mesurer la tension, mais à en juger par la taille des condensateurs et la tension dans le réseau, elle aurait dû être d'environ 400 à 500 V. Les tailles typiques de ces condensateurs ont une tension de 500 V pour de tels condensateurs, mais selon les informations trouvées </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur le site Web de Murata à des condensateurs similaires</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, à des tensions de 220 V environ, la capacité de ces condensateurs est bien inférieure à leur valeur nominale à basse tension. À partir de cela, il est devenu clair pourquoi ces condensateurs ne permettent pas de fournir une puissance suffisante pour qu'il n'y ait pas de chute de tension significative à la sortie de cette source d'alimentation. Et puis le circuit de charge de la batterie a été ajouté, qui a également pris un peu de courant, environ 10 - 20 mA, jusqu'à ce que la batterie soit chargée. Étant donné que ces condensateurs ne fonctionnent pas très bien à des tensions élevées, j'ai décidé d'essayer de trouver un condensateur à film métallique de petite taille, au moins 400 V et avec une capacité moins normale. J'ai commencé à me plonger dans les anciennes cartes de divers appareils et j'ai trouvé sur l'une des cartes un condensateur à film métallique importé de petite taille à 450 V et une capacité de 0,47 uF.</font></font><br>
<br>
<img src="https://habrastorage.org/files/100/eb8/cc1/100eb8cc192744dfae4a323b7d700f46.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 14 - Condensateur à film métallique 450 V - 0,47 μF. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai retiré ce condensateur, examiné la carte d'une prise intelligente et il s'est avéré qu'il y avait un endroit très approprié pour cela. </font></font><br>
<br>
<img src="https://habrastorage.org/files/a9c/7b4/e9c/a9c7b4e9c6924ff297266d5f8c5655f8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 15 - Vérification de la possibilité de placer un condensateur supplémentaire Le </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
condensateur s'est approché de la hauteur et de l'épaisseur au même endroit que dans l'image ci-dessus, et il a été décidé de l'appliquer - soudez en parallèle avec les condensateurs de ballast C3 et C5, et vous pouvez le fixer avec un adhésif thermofusible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai soudé les segments de fil MGTF-0.2 aux bornes du condensateur, isolé le ravageur des fils soudés avec un tube thermorétractable et en outre un adhésif thermofusible. Ensuite, le condensateur a collé le relais au relais avec de la colle chaude et a soudé les conducteurs parallèlement au condensateur C3. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e6b/22f/a8e/e6b22fa8ea04440d84c95eecc7d68dcc.jpg"><br>
<img src="https://habrastorage.org/files/ccc/295/fb7/ccc295fb7fdf4ad89035d006dea3f679.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 16 - Installation d'un condensateur de ballast supplémentaire</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir installé ce condensateur, j'ai immédiatement vérifié l'opérabilité de la prise intelligente dans un tel allumage, à savoir, dans l'état "On", j'ai inséré cette prise dans le réseau, à la suite de quoi le relais a fonctionné, les contacts fermés, la tension aux bornes du condensateur C4 était réglée à environ 9 V, ce qui était suffisant pour démarrer le relais et pour le fonctionnement des organes restants de la sortie. Bien sûr, avec une telle tension, la consommation de courant de la bobine de relais est plus élevée, ce qui signifie que la consommation d'énergie de la prise a augmenté, j'ai mesuré avec un wattmètre numérique, la puissance au ralenti était de 2,2 watts. Vous pouvez essayer d'optimiser et de réduire davantage la tension à un niveau auquel le relais sera garanti de fonctionner et la consommation de courant sera minime, mais à ce stade, je n'ai pas encore dérangé, l'essentiel est qu'il existe maintenant une prise de courant autonome,ce qui signifie que l'horloge ne s'égarera pas lorsque la tension secteur tombe en panne jusqu'à ce que la batterie soit épuisée et que l'état soit «On» ou «Off». Une expérience a également été menée sur la durée de vie de la batterie, qui s'est élevée à 10 - 11 heures, ce qui est assez, car L'électricité est rarement coupée pendant cette période ou plus longtemps.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 CIRCUIT FINAL ÉLECTRIQUE PRINCIPAL D'UNE PRISE INTELLIGENTE AVEC UNE ALIMENTATION AUTONOME</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eh bien, après toutes les modifications, le circuit final d'une prise intelligente ressemble à ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/files/aba/bea/ba6/ababeaba6ccf455384d24249350efc3a.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 17 - Circuit électrique d'une prise intelligente avec alimentation autonome </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce circuit, un condensateur de ballast supplémentaire est </font><b><font style="vertical-align: inherit;">représenté par C, parallèle à C</font></b><font style="vertical-align: inherit;"> , Cb et pointillé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C’est tout, le deuxième point de vente, je vais peut-être le finaliser en quelque sorte. </font><font style="vertical-align: inherit;">Les critiques et peut-être des recommandations supplémentaires sont les bienvenues. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci de votre attention!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr395883/">https://habr.com/ru/post/fr395883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr395871/index.html">Les scientifiques mettent en garde contre les effets secondaires d'une mauvaise stimulation électrique du cerveau</a></li>
<li><a href="../fr395873/index.html">Les scientifiques ont d'abord étudié et décrit le mécanisme d'activation d'une chaîne de neurones cérébraux responsables d'une tendance à l'agression</a></li>
<li><a href="../fr395875/index.html">Suppression de lignes téléphoniques à l'aide de passerelles VoIP Grandstream</a></li>
<li><a href="../fr395879/index.html">Discussion: les traders HFT aiment-ils leur travail?</a></li>
<li><a href="../fr395881/index.html">Parasitica (histoire)</a></li>
<li><a href="../fr395887/index.html">La construction d'ITER est en avance sur le calendrier. Le premier plasma est prévu pour 2025</a></li>
<li><a href="../fr395889/index.html">La vie secrète des géants</a></li>
<li><a href="../fr395891/index.html">La console de jeu Sega Saturn a piraté la protection DRM après 20 ans</a></li>
<li><a href="../fr395893/index.html">Présentation du nouveau IP-PBX Yeastar S20</a></li>
<li><a href="../fr395895/index.html">Chimie: contrefaçon alimentaire suisse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>