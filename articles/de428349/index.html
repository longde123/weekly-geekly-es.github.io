<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì© üëò üÉè Gurke in der Cloud: Verwenden von BDD-Skripten f√ºr Produktstresstests üçû üë©üèº‚Äçüíª ‚úçüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine weitere Abschrift des Berichts mit Pixonic DevGAMM Talks . Anton Kosyakin ist technischer Produktmanager und arbeitet an der ALICE-Plattform (wie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gurke in der Cloud: Verwenden von BDD-Skripten f√ºr Produktstresstests</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/428349/">  Eine weitere Abschrift des Berichts mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pixonic DevGAMM Talks</a> .  Anton Kosyakin ist technischer Produktmanager und arbeitet an der ALICE-Plattform (wie einem Jira f√ºr Hotels).  Er erkl√§rte, wie sie die vorhandenen Testtools in das Projekt integriert haben, warum Lasttests erforderlich sind, welche Tools die Community anbietet und wie diese Tools in der Cloud ausgef√ºhrt werden.  Unten finden Sie eine Pr√§sentation und den Text des Berichts. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/fJCPRMld29c" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <a name="habracut"></a><br>  Wir stellen ein Produkt namens ALICE Platform her und ich werde Ihnen jetzt erkl√§ren, wie sie das Problem der Lasttests gel√∂st haben. <br><br><img src="https://habrastorage.org/webt/yl/ni/ab/ylniab7e6clwettmlag_khwc99u.png"><br><br>  ALICE ist Jira f√ºr Hotels.  Wir schaffen eine Plattform, die ihnen hilft, mit ihrem Inneren umzugehen.  Concierge, Rezeptionist, Reinigungskr√§fte - sie brauchen auch Tickets.  Zum Beispiel: Ein Gast ruft an&gt; sagt, dass Sie den Raum reinigen m√ºssen&gt; der Mitarbeiter erstellt ein Ticket&gt; die Leute, die putzen, wissen, auf wen die Aufgabe gestellt wird&gt; ausf√ºhren&gt; den Status √§ndern. <br><br>  Wir haben B2B, daher sind die Zahlen m√∂glicherweise nicht beeindruckend - nur 1.000 Hotels, 5.000 DAUs.  F√ºr Spiele ist das nicht viel, aber f√ºr uns ist es sehr cool, weil es bis zu 8 Prod-Server gibt und sie mit diesen 5.000 aktiven Benutzern kaum fertig werden k√∂nnen.  Da passieren etwas andere Dinge unter der Haube - eine Reihe von Datenbanken, Transaktionen usw. <br><br><img src="https://habrastorage.org/webt/n4/km/xj/n4kmxj-v1475vowxyzeeuudht_w.png"><br><br>  Das Wichtigste: Im vergangenen Jahr sind wir zweimal gewachsen, jetzt haben wir ein Engineering-Team in der Region von 50 Mitarbeitern und planen, die Anwenderbasis 2019 zu verdoppeln.  Und das ist die gr√∂√üte Herausforderung, vor der wir stehen. <br><br>  Ein Beispiel aus dem Leben.  Am Freitagabend, nachdem ich eine 60-Stunden-Woche gearbeitet hatte, beendete ich um 23:00 Uhr den letzten Anruf, beendete die Pr√§sentation schnell, stieg in den Zug und kam hierher.  Und vor ungef√§hr f√ºnf Minuten habe ich meine Pr√§sentation ein wenig √ºberarbeitet.  Jetzt funktioniert alles f√ºr uns, weil wir ein Startup sind und es cool ist.  W√§hrend ich fuhr, versuchte ein Teil des technischen Teams (wir nennen es Feuer in der Produktion) sicherzustellen, dass das System nicht ausfiel, und gleichzeitig bemerkten die Benutzer dies nicht.  Sie haben es geschafft und wir sind gerettet. <br><br>  Wie Sie sehen, schlafen wir nachts bisher nicht sehr gut.  Wir wissen mit Sicherheit, dass unsere Infrastruktur sinken wird.  Wir stellen uns der Wahrheit und verstehen dies.  Eine Frage: wann?  So haben wir verstanden, dass Lasttests der Schl√ºssel zur Erl√∂sung sind.  Darum m√ºssen wir uns k√ºmmern. <br><br><img src="https://habrastorage.org/webt/wk/id/oi/wkidoi8iwdp-aafxeo8zgtpjrcy.png"><br><br>  Was sind unsere Ziele?  Zun√§chst m√ºssen wir jetzt genau verstehen, wie gut und leistungsf√§hig unser System ist und wie gut es f√ºr aktuelle Benutzer funktioniert.  Und dies sollte geschehen, bevor der Benutzer den Vertrag mit uns bricht (und dies kann ein Kunde f√ºr 150 Hotels und viel Geld sein), da etwas nicht funktioniert oder sehr langsam ist.  Dar√ºber hinaus hat die Vertriebsabteilung einen Plan: doppeltes Wachstum im n√§chsten Jahr.  Und so kam es, dass wir unseren Hauptkonkurrenten gekauft und seine Benutzer zu uns selbst migriert haben. <br><br>  Und wir m√ºssen wissen, dass all dies standhalten kann.  Wissen Sie im Voraus, bevor diese Benutzer kommen und alles fallen wird. <br><br>  Wir machen auch Ver√∂ffentlichungen.  Jede Woche.  Am Montag.  Nat√ºrlich erweitern nicht alle Releases die Funktionalit√§t, irgendwo Wartung, irgendwo Fehlerbehebungen, aber wir m√ºssen verstehen, dass Benutzer dies nicht bemerken und ihre Erfahrung nicht schlechter wird. <br><br>  Aber wir als gute Entwickler sind faule Leute und arbeiten nicht gerne.  Daher fragten sie die Community und Google, welche Dienste / L√∂sungen es f√ºr Lasttests gibt.  Es gab viele von ihnen.  Es gibt einige einfache Dinge, wie Apache Bench, die einfach eine Site in hundert Threads in URL kicken.  Es gibt eine b√∂se und seltsame Version von Bees with Machine Guns, bei der alles gleich ist, aber die Instanzen gestartet werden, die fliegen und Ihre Anwendungen platzieren.  Es gibt JMeter, dort k√∂nnen Sie einige Skripte schreiben, die in der Cloud ausgef√ºhrt werden. <br><br><img src="https://habrastorage.org/webt/z6/rr/ux/z6rruxzrgzypyfjac_hafhyetnk.png"><br><br>  Alles scheint in Ordnung zu sein, aber nachdem wir nachgedacht hatten, wurde uns klar, dass wir wirklich arbeiten und zuerst einige Probleme l√∂sen m√ºssen. <br><br><img src="https://habrastorage.org/webt/gz/bk/rc/gzbkrcuzhngbzajpyfghlwn50t8.png"><br><br>  Zun√§chst m√ºssen Sie reale Szenarien schreiben, die eine vollst√§ndige Auslastung simulieren.  Auf einigen Systemen ist es ausreichend, zuf√§llige API-Aufrufe mit zuf√§lligen Daten zu generieren.  In unserem Fall handelt es sich um lange Benutzerszenarien: Ich habe einen Anruf erhalten, einen Bildschirm ge√∂ffnet, alle Daten (wer hat angerufen, was er will) abgerufen und gespeichert.  Dann erscheint es in der mobilen Anwendung einer anderen Person, die die Anfrage ausf√ºhren wird.  Nicht die trivialste Aufgabe. <br><br>  Und ich m√∂chte Sie daran erinnern, ver√∂ffentlicht jede Woche.  Die Funktionalit√§t wird aktualisiert, die Skripte m√ºssen wirklich relevant sein.  Zuerst m√ºssen Sie sie schreiben und dann auch unterst√ºtzen. <br><br>  Das war aber nicht das gr√∂√üte Problem.  Nehmen Sie zum Beispiel Flut.io.  Als cooles Tool k√∂nnen Sie Selenium darin ausf√ºhren. Wenn Chrome gestartet wird, k√∂nnen Sie es steuern und es wird eine Art Skript ausgef√ºhrt.  Sie k√∂nnen darin JMeter-Skripte ausf√ºhren.  Aber wenn wir Selenium in JMeter-Skripten ausf√ºhren wollen, f√§llt pl√∂tzlich alles auseinander, weil die Leute, die es zusammengestellt haben, eine Reihe von architektonischen Entscheidungen getroffen haben.  Einige Dienste k√∂nnen beispielsweise JUnit ausf√ºhren - es ist einfach und unkompliziert, aber einer dieser Dienste hat seine eigene JUnit geschrieben und einige Dinge einfach ignoriert. <br><br><img src="https://habrastorage.org/webt/x9/uc/hr/x9uchrzxys03kzih_vblmszbqnm.png"><br><br>  Das Problem der Lastgenerierung ist dringend, da jedes Tool auf seine eigene Weise nach der Generierung fragt.  Und selbst wenn Sie es geschafft haben, sicherzustellen, dass die Szenarien angemessen sind, stellt sich die Frage: Wie l√§uft man 2-4 mal mehr?  Es scheint zu sein: rennen und alles ist in Ordnung.  Aber nein.  Diese Anforderungen enthalten alle Arten von IDs - wir erstellen etwas, erhalten eine neue ID, √§ndern die alte ID und der Test, der die Entit√§t nach ID l√§dt, √§ndert ihr Feld in ein anderes.  Und 10 Tests, bei denen dieselbe Entit√§t zehnmal geladen wird, sind nicht sehr interessant.  Weil es 10 Mal notwendig ist, verschiedene Entit√§ten zu laden und diese Last korrekt zu skalieren. <br><br>  OK, wir m√∂chten das Problem der Lasttests l√∂sen, um genau zu verstehen, wie vielen Benutzern die Anwendung standhalten wird und ob unsere Pl√§ne mit den Pl√§nen der Verkaufsabteilung √ºbereinstimmen.  Wir haben die auf dem Markt befindlichen L√∂sungen analysiert und anschlie√üend eine Bestandsaufnahme unserer Nudeln und Sticks durchgef√ºhrt. <br><br>  Da wir jede Woche Releases ver√∂ffentlichen, haben wir nat√ºrlich einige Tests automatisiert - Integration und etwas anderes.  Daf√ºr verwenden wir Gurke.  Dies ist ein BDD-Framework f√ºr die verhaltensgesteuerte Entwicklung.  Das hei√üt,  Wir fragen einige Skripte, die aus Schritten bestehen. <br><br><img src="https://habrastorage.org/webt/up/qv/jf/upqvjffahbzzeidc9qfaszvlefy.png"><br><br>  Dank unserer Infrastruktur konnten wir Integrations- und Funktionstests in zwei Modi ausf√ºhren: einfach das Backend starten, die API zucken oder Chrome √ºber Selenium ausf√ºhren und verwalten. <br><br>  Wir lieben NewRelic.  Es kann einfach den Server √ºberwachen, die Hauptindikatoren.  Es wird in die JVM integriert und f√§ngt alle Aufrufe an die Controller und die Endpoint-API ab.  Sie haben auch eine L√∂sung f√ºr den Browser, und da wir die meisten Funktionen dort haben, macht es auch etwas im Browser und gibt eine Art von Metriken. <br><br><img src="https://habrastorage.org/webt/dl/uu/ia/dluuiasy_dqrx5vb0y_fsermccs.png"><br><br>  Dementsprechend m√ºssen Sie alles zusammenf√ºgen.  Wir haben die Hauptszenarien bereits automatisiert.  Unsere Szenarien (weil es wie BDD ist) ahmen echte Benutzer nach und die Last √§hnelt der realen Produktion.  Gleichzeitig k√∂nnen wir es skalieren.  Da dies Teil des Freigabeprozesses ist, wird es immer auf dem neuesten Stand gehalten. <br><br><img src="https://habrastorage.org/webt/gs/kr/sk/gskrsk9z456bx3fwkruz_p4mtoi.png"><br><br>  Nehmen wir nun jedes Werkzeug, das derzeit auf dem Markt ist.  Sie arbeiten mit denselben Grundelementen: http, API-Aufrufe auf http, JSON, JUnit, das ist alles.  Aber sobald wir versuchen, unsere Tests auf Gurke zu beschr√§nken, machen sie dasselbe, arbeiten mit denselben Dingen, aber nichts funktioniert.  Wir begannen zu √ºberlegen, wie wir mit dieser Aufgabe umgehen sollten. <br><br>  Ein kleiner Exkurs, da BDD in der Spieleentwicklung kein sehr beliebter Begriff ist, eher f√ºr Unternehmensl√∂sungen. <br><br><img src="https://habrastorage.org/webt/pw/ud/s-/pwuds-iym4yapjojuso5ch5efxw.png"><br><br>  Alle Szenarien beschreiben wirklich ein Verhalten.  Das Format der Szenariobeschreibung ist sehr einfach: Gegeben, wann, dann - in Bezug auf BDD namens Gurke.  Cucumber ordnet dies mithilfe von Anmerkungen und Attributen Java-Code zu.  Er tut, was er im Szenario sieht: Sie m√ºssen der Person einen Apfel geben, lassen Sie uns eine Methode finden, in der dies implementiert wird. <br><br><img src="https://habrastorage.org/webt/cy/eq/yt/cyeqytn1ychkth8n2_0njfagew0.png"><br><br>  Dann haben wir ein Konzept wie Functional Robot eingef√ºhrt.  Dies ist ein bestimmter Client f√ºr die Anwendung. Er verf√ºgt √ºber Methoden zum Anmelden eines Benutzers, Abmelden, Erstellen eines Tickets, Anzeigen einer Liste von Tickets usw.  Und es kann in drei Modi funktionieren: mit einer mobilen Anwendung, einer Webanwendung und nur API-Aufrufen. <br><br><img src="https://habrastorage.org/webt/3v/b-/iq/3vb-iqzd_dgobdompwj0jfmxzai.png"><br><br>  Kurz gesagt das Gleiche auf den Folien.  Feature-Dateien sind in Skripte unterteilt, es gibt Schritte und all dies ist in Englisch geschrieben. <br><br><img src="https://habrastorage.org/webt/wx/x0/f7/wxx0f7drcwrdfbwr_m7-u0bqqv4.png"><br><br>  Dann kommt Cucumber, der Java-Code, ins Spiel. Er ordnet diese Skripte dem Code zu, der tats√§chlich ausgef√ºhrt wird. <br><br><img src="https://habrastorage.org/webt/4t/b5/0y/4tb50yvejfg-jkmyz4kwfgodhxe.png"><br><br>  Dieser Code verwendet unsere Anwendung. <br><br><img src="https://habrastorage.org/webt/95/al/vt/95alvtpnyfosxqkrxys7-34nm-i.png"><br><br>  Und je nachdem, was wir gew√§hlt haben: Entweder √ºber Selenium geht Chrome zur ALICE-Anwendung. <br><br><img src="https://habrastorage.org/webt/eb/ik/ko/ebikko_fjkp71aesloejwbf8-ng.png"><br><br>  Oder dasselbe √ºber die http-API. <br><br><img src="https://habrastorage.org/webt/e7/4w/0p/e74w0pudnq0kdupfnkny9f_-tta.png"><br><br>  Und dann (dank der Jungs von Yandex f√ºr Allure Reports) wird uns all dies wundersch√∂n gezeigt - wie viel Zeit es gedauert hat, welche Tests umgedreht wurden, in welchem ‚Äã‚ÄãSchritt und sogar einen Screenshot anwenden, wenn etwas schief gelaufen ist. <br><br><img src="https://habrastorage.org/webt/54/a9/ub/54a9ubss0p28nik3j60p1si5qi0.png"><br><br>  Hier ist eine kurze Zusammenfassung dessen, was wir bereits hatten. <br><br><img src="https://habrastorage.org/webt/6h/85/fq/6h85fqwod5qxdniwmx7kiawelgc.png"><br><br>  Wie kann man daraus Lasttests erstellen?  Wir hatten Jenkins, der die Gurkensuite leitete.  Dies sind unsere Tests und sie gingen zu ALICE.  Was war das Hauptproblem?  Jenkins f√ºhrt Tests lokal durch, sie k√∂nnen nicht f√ºr immer skaliert werden.  Ja, wir werden in Amazon gehostet, in der Cloud k√∂nnen wir nach einem extra gro√üen Computer fragen.  Wie auch immer, irgendwann werden wir zumindest ins Netzwerk gelangen.  Es ist notwendig, diese Last irgendwie zu laden.  Danke Amazon, dachte er f√ºr uns.  Wir k√∂nnen unsere Cucumber Suite in einen Docker-Container packen und den AWS-Service (Fargate) verwenden, um zu sagen: "Und starten Sie sie bitte."  Das Problem ist behoben, wir k√∂nnen unsere Tests bereits in der Cloud ausf√ºhren. <br><br><img src="https://habrastorage.org/webt/ef/4o/eu/ef4oeujt2xrfawvtrcc9wkd8cpk.png"><br><br>  F√ºhren Sie dann, da wir uns in der Cloud befinden, die Cucumber Suite 5-10-20 aus.  Aber es gibt eine Nuance: Jeder Durchlauf aller unserer Funktionstests generiert einen Bericht.  Einmal haben wir 400 Tests durchgef√ºhrt und 400 Berichte erstellt. <br><br>  Nochmals vielen Dank an die Jungs von Yandex f√ºr Open Source. Wir haben die Dokumentation und den Quellcode gelesen und festgestellt, dass es M√∂glichkeiten gibt, alle 400 Berichte zu einem zusammenzufassen.  Wir haben die Daten leicht korrigiert, einige unserer Erweiterungen geschrieben und alles hat geklappt. <br><br><img src="https://habrastorage.org/webt/0p/by/by/0pbybykmkhnxqbbwgqoybxslqme.png"><br><br>  Jetzt von Jenkins sagen wir: "Gib uns 200 Instanzen."  Unser bestimmtes Orchestrierungsskript geht an Amazon und sagt "400 Container starten".  Jeder von ihnen enth√§lt unsere Integrationstests, sie generieren einen Bericht, der Bericht wird √ºber Aggregator in einem St√ºck gesammelt, in Jenkins abgelegt, auf den Job angewendet, es funktioniert super. <br><br>  Aber. <br><br>  Ich bin mir sicher, dass viele von Ihnen seltsame Dinge von Testern erhalten haben, wie "Ich habe ein Spiel gespielt, bin 10 Mal gesprungen, w√§hrend dieser Zeit habe ich das Schie√üen gedr√ºckt und versehentlich die Abschalttaste gedr√ºckt - der Charakter begann zu blinken, in der Luft zu frieren und dann schaltete sich der Computer aus." damit umgehen. "  Sie k√∂nnen immer noch einer Person zustimmen und sagen, es ist unm√∂glich zu reproduzieren.  Aber wir haben seelenlose Maschinen, sie erledigen alles sehr schnell und irgendwo, wo die Daten nicht geladen wurden, irgendwo, wo sie nicht sehr schnell gerendert werden, versuchen sie, einen Knopf zu dr√ºcken, aber es gibt noch keinen Knopf oder es werden einige Daten verwendet, die noch nicht vom Server heruntergeladen wurden .  Alles bricht zusammen und der Test ist fehlerhaft.  Obwohl (ich m√∂chte mich darauf konzentrieren) wir Java-Code haben, der Chrome ausf√ºhrt, der √ºber einen Wrapper eine Verbindung zu einem anderen Java herstellt und etwas tut und trotzdem blitzschnell arbeitet. <br><br>  Nun, das offensichtliche Problem, das sich daraus ergibt: Wir haben 5.000 Benutzer, und wir haben nur 100 Instanzen unserer Funktionstests gestartet und dieselbe Last erstellt.  Dies ist nicht genau das, was wir wollten, da wir planen, dass wir n√§chsten Monat 6.000 Benutzer haben werden.  Es ist schwer zu verstehen, wie viele Threads gestartet werden m√ºssen. <br><br>  OK, lassen Sie uns unser System humanisieren.  So sieht die Benutzeroberfl√§che aus: <br><br><img src="https://habrastorage.org/webt/88/rn/xe/88rnxekdkmigjc9fms0bsdbmjay.png"><br><br>  Jemand ruft an, der Concierge m√∂chte auf die Schaltfl√§che "Neues Ticket erstellen" klicken, ein Fenster erscheint f√ºr ihn und er muss alle Felder ausf√ºllen. <br><br><img src="https://habrastorage.org/webt/xg/cd/xc/xgcdxci2xifa0pd85jkm1qbiu9i.png"><br><br>  Dies geschieht jedoch nicht sofort.  Die reale Person, bis sie die Maus erreicht, bis sie mit dem Tippen beginnt, bis sie etwas ausw√§hlt, w√§hrend sie auf Speichern klickt.  Lassen Sie uns also unsere Tests verlangsamen. <br><br><img src="https://habrastorage.org/webt/rz/7y/5f/rz7y5fqhtai1h0ekjh2k1buocv8.png"><br><br>  Wir haben es Human Mode genannt.  Sie m√ºssen nur messen, wie lange der Schritt dauert, und ein wenig "schlafen", wenn er zu schnell war.  Gleichzeitig k√∂nnen wir messen, wie viel dieser Schritt im Prinzip gedauert hat - wenn 5 Minuten, dann ist hier wahrscheinlich die Benutzererfahrung unterbrochen. <br><br>  Da wir einige Tests hatten, haben wir nicht begonnen, jeden unter dieser Sache neu zu schreiben.  Sie haben AspectJ genommen, es auf unseren Code gezogen, 5 weitere Codezeilen hinzugef√ºgt, es funktioniert gro√üartig. <br><br>  Kurze Demo. <br><br><img src="https://habrastorage.org/webt/q7/95/x6/q795x6n2x0vwebvkaznad_6ndda.png"><br><br><img src="https://habrastorage.org/webt/2c/3k/iw/2c3kiwa4yskdjo2bk7mxyipwfem.png"><br><br><img src="https://habrastorage.org/webt/eb/ie/bv/ebiebvzalkiqzpc9qt1dnwltmcw.png"><br><br>  Dies ist ein Timeline-Lauf.  Gr√ºne Tests sind gut, irgendwo ist schlecht.  Allure zeigt uns die Details, wo es kippt. <br><br>  Und hier ist die Zeitleiste, die zeigt, dass wir viele Instanzen hatten.  Sie f√ºhrten einen Test durch, irgendwo fiel etwas. <br><br><img src="https://habrastorage.org/webt/re/3g/tm/re3gtm_ueprckhhazzmefmehpze.png"><br><br>  Das System funktioniert wirklich - letzte Woche haben wir die ersten Tests zur Kampfproduktion durchgef√ºhrt. <br><br>  Nun zu den n√§chsten Schritten, wie wir glauben, kann verbessert werden. <br><br><img src="https://habrastorage.org/webt/er/mk/6h/ermk6hs7p-3zmqulgoxxobcugja.png"><br><br>  Vor allem m√∂chten wir, dass die Benutzer eine coole Benutzererfahrung haben.  Die Idee ist, dass wir eine gro√üe Last f√ºr unsere Anwendung generieren k√∂nnen und alles einfach zu sein scheint - wir haben die Leistung jeder Anforderung an den Server trivial gemessen, unabh√§ngig davon, ob sie weiterhin schnell reagiert oder Leistungseinbu√üen einsetzten (der Server begann, eingehende Anforderungen langsamer zu verarbeiten).  Aber nein.  In der Realit√§t kann der Client / die Anwendung mehrere Anforderungen gleichzeitig an den Server senden.  Und warten Sie, bis alle verarbeitet sind.  Und wenn eine der Anfragen, die l√§ngste, wie sie 5 Sekunden lang funktioniert hat und 5 Sekunden lang weiterarbeitet, ist es uns absolut egal, wie alle anderen funktionieren - so schnell oder auf 4 Sekunden verlangsamt.  Immerhin werden wir noch die l√§ngsten f√ºnf Sekunden warten.  Oder Sie haben ein Ticket erstellt, alles hat in einer Millisekunde funktioniert, aber das Ticket wurde aufgrund interner Index-Caches zu sp√§t im System angezeigt.  Der √ºbliche Ansatz wird dieses Problem nicht l√∂sen. Daher m√∂chten wir versuchen, alle Szenarien zu messen und festzustellen, um wie viel sich das Skript zur Ticketerstellung wirklich verschlechtert hat. <br><br>  Weil  Wir haben alle Szenarien, die auf Uskeys basieren. Wir k√∂nnen sie nachahmen, indem wir eine Person an der Rezeption und 10 Reinigungskr√§fte ausf√ºhren.  Dann 20 oder 30 Reiniger.  Aber die Front der Menschen ist immer noch dieselbe.  Das hei√üt,  Wir k√∂nnen durch Verhaltensmuster eine reale Last erzeugen, die einer realistischen Last sehr nahe kommt. <br><br>  Auch multiregionale Tests.  Unser System wird auf der ganzen Welt verwendet (obwohl alles in Amerika gehostet wird) und daher k√∂nnen wir sowohl aus Russland als auch aus Amerika eine Last erzeugen, um zu sehen, welche von ihnen schneller langsamer werden. <br><br><h3>  Fragen aus dem Publikum </h3><br><br>  <b>- Sie sind gezwungen, eine gro√üe Menge an Logik zu schreiben, und wenn sich etwas ein wenig √§ndert, brechen Sie in Funktionstests viele Dinge.</b>  <b>Es stellt sich heraus, dass Sie fast mehr Zeit ben√∂tigen, um die Tests zu unterst√ºtzen, als um sie zu entwickeln?</b> <br><br>  "Ja, aber nein."  Dies ist BDD, dies sind keine Funktionstests, sie sind n√§her an Integrationstests.  Und was auch immer wir √§ndern, das Szenario bleibt das gleiche.  Ich dr√ºcke einen Knopf, sehe ein Fenster, gebe die Nummer des Raumes ein, in dem die Anfrage eingegangen ist, den Namen der Person und das Datum, an dem ein Tisch reserviert werden soll.  Wenn sich das Layout √§ndert, werden die Felder umgekehrt, wenn etwas im Backend passiert, wird der Test gespeichert, da wir uns auf einer sehr hohen Ebene befinden, klicken wir auf die Schaltfl√§chen im Browser.  Daher sind wir vor einer Vielzahl von √Ñnderungen gesch√ºtzt.  Es gibt Zeiten, in denen alles kaputt gehen kann.  Daher sind diejenigen, die ein neues Feature schreiben, im Release-Verfahren daf√ºr verantwortlich, dass etwas kaputt geht und repariert wird.  Bisher gab es solche Probleme jedoch nicht in gro√üer Zahl. <br><br>  <b>- Und Sie hatten keine Situation, in der nach einem Wechsel alle Tests rot werden.</b> <br><br>  - War es nicht.  Theoretisch kann dies passieren, wenn das Skript keine Schaltfl√§che hat, aber eine andere M√∂glichkeit, ein Fenster zur Eingabe von Ticketinformationen zu √∂ffnen.  Wie ich bereits gezeigt habe, bestehen alle unsere Szenarien aus Schritten.  Schritte sind eine Menge von allem, und wenn wir 100 Skripte haben, die auf dieselbe Schaltfl√§che klicken, ist der Schritt immer noch einer.  Und wenn aufgrund dieses speziellen Schritts alles schief gelaufen ist, korrigieren wir es, schreiben es neu und alle Tests werden sofort gr√ºn. <br><br>  Obwohl es uns einmal passiert ist, als wir versehentlich etwas kaputt gemacht haben.  Nur 40% des Gr√ºns blieben √ºbrig, zuvor waren es 99%.  Das war eine kleine Ver√§nderung.  Wir haben einen Schritt (Codezeile) korrigiert und alles wurde wieder gr√ºn. <br><br>  <b>- Obwohl Sie keine Integrationstests haben, sind diese nicht vollst√§ndig funktionsf√§hig.</b>  <b>Auf die eine oder andere Weise ist dies eine Art grafische Oberfl√§che, in der Tasten gedr√ºckt werden. Eine Art Interaktion findet speziell mit der externen Shell statt.</b>  <b>Ich verstehe, dass Sie Tests in dieser Form haben, Sie starten einfach viele Threads gleichzeitig.</b>  <b>Und was passte nicht zu den Abfragen, die von Standardtools generiert werden: JMeter, Gatling, die in keiner Weise mit der externen Shell interagieren, sondern einfach Anfragen an den Server senden?</b> <br><br>  - Alles ist sehr einfach.  Was ist die Architektur unserer Anwendung?  Wir haben ein Backend, wir haben ein Frontend.  Frontend ist das Web.  Es gibt eine mobile Anwendung.  Und wenn ich ein Ticket erstelle, ist mein Frontend beispielsweise auch mit Ereignisservern verbunden.  Ich erstelle ein Ticket im Backend und alle Leute, die im selben Hotel sitzen, schauen sich Tickets im selben Hotel an. Sie werden von Event-Servern ankommen: Die Jungs werden aktualisieren, die Daten haben sich dort ge√§ndert.  Und um alles zusammenzusetzen, haben wir einen einzigen Punkt - das ist der Kunde.  Es stellt eine Verbindung zu einer gro√üen Anzahl verschiedener Komponenten her. Entweder programmieren wir mit unseren H√§nden, dass wir im Backend ein Ticket erstellt haben, und stellen dann eine Verbindung zum Ereignisserver her, registrieren uns darauf und warten auf einige Ereignisse.  Oder sie haben einfach einen Browser gestartet, in dem bereits alles zusammengestellt wurde, dieser Code bereits geschrieben ist und wir alles tun, was wir brauchen. <br><br>  <b>- Aber das sind verschiedene Ans√§tze?</b>  <b>Oder wir arbeiten speziell mit dem Server oder mit dem Fenster.</b>  <b>Sie k√∂nnen Anforderungen an mehrere Server gleichzeitig simulieren.</b> <br><br>  - Deshalb habe ich Ihnen gesagt, dass wir funktionierende Roboter haben, die aus Tests aufgerufen werden.  Es gibt solche, die Chrome aufgreifen und Klicks auf hoher Ebene ausf√ºhren.  Es gibt solche, die nicht auf die Schaltfl√§che klicken, es passiert nichts, aber zum Zeitpunkt der Erstellung des Tickets sendet er eine Anfrage an den Server, und wir k√∂nnen dies oder das ausf√ºhren.  Wir haben uns aus einem einfachen Grund f√ºr Chrome entschieden: Wir m√∂chten echte Benutzer so simulieren, wie sie es wirklich verwenden.  W√§hrend seine Seite geladen wurde, w√§hrend alles f√ºr ihn gerendert wurde, w√§hrend Java-Skripte und so weiter funktionierten.  Wir m√∂chten so nah wie m√∂glich am Benutzer sein, und das ist echtes Web. <br><br>  <b>- Aber viele Dinge h√§ngen davon ab, welche Art von Benutzer das Internet ist, welche Umgebung.</b>  <b>Die Funktionsweise der Anwendung h√§ngt jedoch bereits von Ihnen und Ihrer Seite ab.</b> <b>,   :     -  ?</b> <br><br> ‚Äî  ,     - .       , , ,     .      ,      ,    .       YouTube    ,       .           ,   .    , . <br><br> <b>‚Äî   .    - Selenium Grid   ?     - .</b> <br><br> ‚Äî   Cucumber':    JAR, JAR   Docker image  Fargate' ,   image  .  flood.io  grid  Selenium      ,     . <br><br> <b>‚Äî      ?  ,    Chrome,     .     Internet Explorer 4 ( - ),    ?   -    Android   -.</b> <br><br> ‚Äî  ,  enterprise.  enterprise     ,   requirements.     ‚Äî      ,     ,  web view.   Android   web view    ,     . <br><br> <b>‚Äî  ,   ,    Load-?   ?</b> <br><br> ‚Äî  . <br><br><img src="https://habrastorage.org/webt/q7/95/x6/q795x6n2x0vwebvkaznad_6ndda.png"><br><br>  Environment   .     .    ,      Load,    .     4- ,   ,    aliceapp.com.    Load-    ,      .  ,      504,     ,     MySQL     ElasticSearch. <br><br> <b>‚Äî      ( ),    ,       ?          .</b> <br><br> ‚Äî  Load-        ,         .  Das hei√üt,   . <br><br> <b>‚Äî      ,     ?</b> <br><br> ‚Äî ,   .  ,      ,  ,      . <br><br> <b>‚Äî    ,         , ..   html       API?</b> <br><br> ‚Äî    Selenium      DOM-  :   ,     ,   key down  ,     ‚Äî .      . <br><br> <b>‚Äî   ? , ?</b> <br><br> ‚Äî      .    ,  .   QC,    ,  QC.    Smoke-   -.        ¬´  -,   ¬ª.   ‚Äî          ,    ,   ,           . <br><br><h3>    Pixonic DevGAMM Talks </h3><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> Consul   stateful-</a> ( , DevOps   BIT.GAMES); </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CICD:        </a> ( ,   Pixonic); </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">     -  Quake Champions</a> ( , backend- Saber Interactive); </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> -  - Tacticool</a> ( , Lead Software Engineer  PanzerDog); </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> ECS, C# Job System  SRP    </a> ( , Field Engineer  Unity); </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> KISS  </a> ( , Lead Game Programmer  1C Game Studios); </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">      </a> ( , Deputy Technical Officer  Pixonic). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428349/">https://habr.com/ru/post/de428349/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428339/index.html">Automatisieren Sie es nicht: Schlechte Gesch√§ftstipps</a></li>
<li><a href="../de428341/index.html">Qsan RAID EE-Technologie</a></li>
<li><a href="../de428343/index.html">Ein interessantes Puzzle in C.</a></li>
<li><a href="../de428345/index.html">Anforderungen mit F√§llen abdecken. SuperJob Realit√§ten</a></li>
<li><a href="../de428347/index.html">Die Zukunft von WebAssembly als ‚ÄûSkill Tree‚Äú</a></li>
<li><a href="../de428357/index.html">Absorption in der Praxis: eine Lebensgeschichte</a></li>
<li><a href="../de428361/index.html">A la perfecci√≥n: Verbesserung von WordPress mit AMP f√ºr WordPress- und Setka Editor-Plugins</a></li>
<li><a href="../de428363/index.html">Jetpack / Hoverboard bauen: Rettungssysteme</a></li>
<li><a href="../de428365/index.html">Die Geschichte, wie sich die Google-Abrechnung ge√§ndert hat oder wie unn√∂tige Kosten vermieden werden k√∂nnen</a></li>
<li><a href="../de428367/index.html">Wir haben das kleinste Sonarmodem der Welt hergestellt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>