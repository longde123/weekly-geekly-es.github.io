<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙎 ☎️ 🏂🏻 Operation TA505: Gruppieren der Netzwerkinfrastruktur. Teil 3 😓 ⛳️ ⌚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Analyse der Netzwerkinfrastruktur spielt eine große Rolle bei der Untersuchung bösartiger Kampagnen. Informationen darüber, welche IP-Adressen in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Operation TA505: Gruppieren der Netzwerkinfrastruktur. Teil 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/472936/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/62a/aa0/0c2/62aaa00c24efe0e4797c29ebcff2e241.jpg" alt="Bild"></a> <br><br>  Die Analyse der Netzwerkinfrastruktur spielt eine große Rolle bei der Untersuchung bösartiger Kampagnen.  Informationen darüber, welche IP-Adressen in verschiedenen Intervallen einem Domänennamen entsprachen, ermöglichen es Ihnen, neue Angreifer-Server zu identifizieren.  Wenn Sie das gegenteilige Problem lösen (eine Retrospektive von Domänen, die in eine bestimmte IP-Adresse aufgelöst wurden), erhalten Sie neue Domänen, für die Sie den Suchvorgang wiederholen und die Kette immer weiter drehen können.  Alle erhaltenen Informationen helfen dabei, sich ein Bild von der Geografie der Knoten zu machen, die „bevorzugten“ Hoster und Registrare hervorzuheben und die charakteristischen Werte der Felder zu notieren, die der Angreifer angibt, wenn er die nächste Domain registriert. <br><br>  Auf den ersten Blick können nutzlose Metainformationen nach einigen Tagen, Wochen und sogar Monaten nützlich sein.  Tatsächlich stellt sich im Verlauf der Malware-Analyse früher oder später die Frage nach der Zuordnung eines Instruments zu der einen oder anderen kriminellen Gruppe: Hier helfen alle indirekten Anzeichen, einschließlich Daten zu Netzwerkindikatoren. <br><br>  In diesem Artikel werden wir die charakteristischsten Merkmale der TA505-Netzwerkinfrastruktur untersuchen und Schnittpunkte mit einer anderen Hacker-Gruppe, Buhtrap, zeigen. <a name="habracut"></a><br><br><h2>  Domainnamen-Registrare </h2><br>  Insgesamt haben wir 372 Domänen der Gruppe analysiert und 22 Organisationen identifiziert, die Dienste zur Erfassung von Domänennamen anbieten.  Die folgenden Ressourcen waren für Angreifer von größtem Interesse: <br><br><ul><li>  WhoisGuard, Inc.  - 28 Domainnamen, </li><li>  Eranet International Limited - 26 Domainnamen. </li></ul><br>  Die panamaische Organisation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WhoisGuard</a> bietet die Möglichkeit, ihre Registrierungsdaten vor dem öffentlichen Zugriff zu verbergen.  Dies ist keineswegs der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erste Fall</a> , in dem die Dienste dieses Unternehmens zur Anonymisierung und Komplikation von Ermittlungen genutzt werden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cf/c1b/bd9/8cfc1bbd9346e5e8b9b23f3008b525d7.jpg" alt="Bild"><br><br>  <i>Verteilung von TA505-Domains, die mit dem WhoisGuard-Dienst registriert wurden, durch die Malware-Familien der Gruppe</i> <br><br>  Darüber hinaus haben wir die Nutzung anderer ähnlicher Dienste festgestellt - PROTECTSERVICE, LTD, Whois-Datenschutzstiftung, Domains by Proxy, LLC - jedoch in geringerem Umfang. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eranet International Limited</a> ist einer der größten Registrare in Hongkong.  Es ist anzumerken, dass die Angreifer bei der Registrierung der meisten Domains bei diesem Anbieter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dynamisches DNS verwendeten.</a> Infolgedessen änderten sich die IP-Adressen, in die der Domainname aufgelöst wurde, sehr oft, was es schwierig machte, weitere Traces zu finden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/ca5/b7c/e8aca5b7c0b10afc53b893afb74a92e3.jpg" alt="Bild"><br><br>  <i>Die Verteilung von TA505-Domains, die mit dem Eranet International Limited-Dienst registriert wurden, durch die Malware-Familien der Gruppe</i> <br><br><h2>  Domain Name Registranten </h2><br>  Während der Untersuchung der WHOIS-Informationen zu Domainnamen konnten in einigen Fällen eindeutige Werte für einige Felder erhalten werden. <br><br>  Domänenname der TA505-Gruppe WHOIS-Informationen: <br><br><img src="https://habrastorage.org/webt/fl/lx/ar/fllxarhuijeyaveiyb_gzzqzgfm.png"><br><br>  Natürlich kann nicht allen Feldern blind vertraut werden.  Die Werte einiger von ihnen können jedoch interessante Informationen liefern.  Beispielsweise können Sie per E-Mail an <b>ctouma2@gmail.com</b> zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Liste</a> anderer Domains <b>wechseln,</b> die mit demselben Wert registriert sind.  Ein weiteres Postfach <b>0141.koppe.pan@gmail.com</b> führt zu vielen verschiedenen Ressourcen: einem Konto bei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Steam</a> , dem japanischen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hackerforum Qiita</a> mit einem Link zu einer bösartigen Domain im Profil, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">YouTube-Kanal</a> , Skype-Konto (live: 141.koppe). Pfanne) usw. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c7/9ba/a39/8c79baa39e2887fcb36bf43ea842c1a2.jpg" alt="Bild"><br><br>  <i>Verdächtige Domain-Registrierungsseite im Qiita-Hacker-Forum</i> <br><br>  Wir werden eine eingehende Analyse der WHOIS-Daten hinterlassen, die über den Rahmen dieses Artikels hinausgeht.  Wir stellen nur fest, dass Angreifer in der ersten Phase häufig auf gehackte legitime Ressourcen zurückgreifen, um Malware zu hosten.  Nachfolgend finden Sie Beispiele für solche Domänen: <br><br><ul><li>  greenthumbsup [.] jp </li><li>  fakers.co [.] jp </li><li>  nanepashemet [.] com </li><li>  nagomi-753 [.] jp </li><li>  iluj [.] in </li></ul><br><h2>  Autonome Systeme (AS) </h2><br>  Der Vollständigkeit halber geben wir die Spitze der autonomen Systeme (AS) an, denen die IP-Adressen der Verwaltungsserver gehören.  Natürlich hat ein einziges autonomes System viele Hosts: sowohl legitime als auch nicht legitime, einschließlich verschiedener Malware-Familien sehr unterschiedlicher Herkunft.  Die folgenden Statistiken sollten als Merkmal der Präferenzen des Angreifers verstanden werden.  Zusammen mit anderen Tatsachen kann es für die Zuschreibung wesentlich sein. <br><br>  Autonome Systeme, die häufig von der TA505-Gruppe verwendet werden: <br><br><img src="https://habrastorage.org/webt/qw/l6/5y/qwl65ykvpoanzfvn4siffg0uzem.png"><br><br><h2>  Kreuzung mit der Buhtrap Group </h2><br>  Am 11. Juli 2019 veröffentlichten unsere ESET-Kollegen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Artikel</a> über einen kürzlich erfolgten Angriff der Buhtrap-Gruppe unter Verwendung einer Zero-Day-Sicherheitsanfälligkeit in der Win32k-Windows-Komponente.  Eines der beschriebenen Module war das sogenannte Grabber-Modul zum Stehlen von Benutzerkennwörtern von E-Mail-Clients, Browsern usw. Nach einiger Zeit fanden wir ein Modul ähnlich dem beschriebenen (MD5: c6e9d7280f77977a6968722e8124f51c) mit demselben Verwaltungsserver im Body (redmond.corp-) Microsoft [.] com). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1d/2a8/537/b1d2a8537215501e256a0af7a0614ecb.jpg" alt="Bild"><br><br>  <i>Server im Buhtrap Grabber-Modul verwalten</i> <br><br>  Laut der <a href="">PaSiveTotal-</a> Ressource wird dieser Host ab dem 6. Juni 2019 in die IP-Adresse 95 [.] 179.159.170 aufgelöst. <br><br>  Etwas früher, am 2. Juli 2019, berichteten unsere Kollegen von Proofpoint <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">über</a> die neuen Tools der TA505-Gruppe, von denen eines Andromut (auch als Gelup bekannt) heißt und der FlawedAmmyy RAT-Bootloader ist.  Eine der Bootloader-Varianten (MD5: 0cbeb424d96e5c268ec2525d603f64eb), die wir kennengelernt haben, verwendet die Net-Domäne compatexchange-cloudapp [.] Als Verwaltungsserver. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cb/414/26a/6cb41426af25ba135796772487c350ac.jpg" alt="Bild"><br><br>  <i>Gelup Management Server von TA505 nach Entschlüsselung</i> <br><br>  Laut <a href="">der</a> PaSiveTotal-Ressource wird dieser Host ab dem 8. Juni 2019 in die IP-Adresse 95 [.] 179.159.170 aufgelöst. <br><br>  Beide Domains sind mit einer Differenz von zwei Tagen bei demselben Registrar (Tucows Domains Inc.) registriert und werden unter derselben IP-Adresse aufgelöst.  In Anbetracht der Tatsache, dass beide Gruppen im Juni regelmäßig Angriffe durchgeführt haben, schließen wir, dass Buhtrap und TA505 einen gemeinsamen Host als Verwaltungsserver verwenden. <br><br>  Wir fügen hinzu, dass die Domäne compatexchange-cloudapp [.] Net nicht nur im obigen Bootloader verwendet wurde, sondern auch in älteren Versionen von Buhtrap-Komponenten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/232/bf8/cd3/232bf8cd3aade1f7bc858671124e3536.jpg" alt="Bild"><br><br>  <i>Die erste Kreuzung von TA505 und Buhtrap in der Infrastruktur</i> <br><br>  Nach einiger Zeit trafen wir auf eine andere ähnliche Kreuzung: Diesmal trafen sich die Domänen eines anderen Grabbers von Buhtrap und des Smoke Loader von TA505 auf dieselbe Weise: Domain Test-Service012505 [.] Com Smoke Loader (MD5: 5fc6f24d43bc7ca45a81d159291955d1) und Secure-Telemetry [. ] Net Grabber (MD5: 79d1a836423c7ee57b6127cf2930a9d9) vom 17. bzw. 16. Juli 2019 werden in die IP-Adresse 194 [.] 4.56.252 aufgelöst. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/19c/d1f/e23/19cd1fe236f22164d0b33d0af9a0e851.jpg" alt="Bild"><br><br>  <i>Die zweite Kreuzung von TA505 und Buhtrap in der Infrastruktur</i> <br><br><h2>  Schlussfolgerungen </h2><br>  Wir haben die Funktionen der Netzwerkinfrastruktur der TA505-Gruppe kennengelernt.  Wir haben die Eigenschaften von Domainnamen-Registraren und -Hostern für Verwaltungsserver untersucht.  Wir haben die merkwürdigen Merkmale der Kundeninformationen festgestellt, die bei der Domainregistrierung angegeben wurden.  Dies kann als Ausgangspunkt für detailliertere Untersuchungen dienen.  Wir haben die Infrastrukturkreuzungen zwischen den Gruppen TA505 und Buhtrap untersucht.  Die Situation mit gemeinsam genutzten Servern kann auf verschiedene Arten erklärt werden: Gruppen können Server nach Vereinbarung gemeinsam nutzen.  Gruppen können eine einzige Verwaltungseinheit haben, die ihre Aktionen koordiniert.  Beide Gruppen können Server von Dritten mieten (und diese sparen wiederum Ressourcen).  Wir werden weiterhin die Aktivitäten beider Gruppen überwachen und nach neuen Informationen über ihre möglichen Verbindungen und gemeinsamen Aktivitäten suchen. <br><br>  <b>Autoren</b> : Alexey Vishnyakov und Maxim Anfinogenov, Positive Technologies <br><br><div class="spoiler">  <b class="spoiler_title">IOCs</b> <div class="spoiler_text">  TA505 C2: <br>  0141koppepan [.] Com <br>  bigpresense [.] top <br>  elast [.] pw <br>  fakers.co [.] jp <br>  greenthumbsup [.] jp <br>  iluj [.] in <br>  kentona [.] su <br>  koppepan [.] app <br>  makosoft [.] hu <br>  microsoftsyncservice [.] biz <br>  nagomi-753 [.] jp <br>  nanepashemet [.] com <br>  newfolder2-service [.] space <br>  office365onlinehome [.] com <br>  Solsin [.] oben <br>  test-service012505 [.] com <br>  Windows-mehrere-Update [.] com <br>  windows-update-02-de [.] com <br>  c6e9d7280f77977a6968722e8124f51c - Buhtrap Grabber-Modul <br>  redmond.corp-microsoft [.] com - Grabber C &amp; C. <br>  0cbeb424d96e5c268ec2525d603f64eb - Gelup-Downloader von TA505 <br>  compatexchange-cloudapp [.] net - Gelup C &amp; C. <br>  95.179.159 [.] 170 - TA505 und Buhtrap Shared Host <br>  79d1a836423c7ee57b6127cf2930a9d9 - Buhtrap Grabber-Modul <br>  Secure-Telemetry-Netz [.] - Grabber C &amp; C. <br>  5fc6f24d43bc7ca45a81d159291955d1 - Smoke Loader Downloader von TA505 <br>  test-service012505 [.] com - Rauchlader C &amp; C. <br>  194 [.] 4.56.252 - TA505 und Buhtrap Shared Host </div></div><br><h3>  Vorherige Artikel in der Reihe: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Operation TA505: Wie wir die neuen Tools der Entwickler von Trojan Dridex, Locky Ransomware und Neutrino Botnet analysiert haben</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Operation TA505, Teil 2: Lernen der ServHelper-Backdoor mit NetSupport RAT</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de472936/">https://habr.com/ru/post/de472936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de472926/index.html">Das Gesetz der Beschleunigung der Rendite (Teil 1)</a></li>
<li><a href="../de472928/index.html">Hoch geladener GPU-Computerdienst</a></li>
<li><a href="../de472930/index.html">Silicon Valley Astrophysiker Quantifizierung der Mode</a></li>
<li><a href="../de472932/index.html">IntelliJ IDEA Static Analysis vs Human Mind</a></li>
<li><a href="../de472934/index.html">Was ist ein Zero Trust? Sicherheitsmodell</a></li>
<li><a href="../de472940/index.html">Über Betrüger und Menschen</a></li>
<li><a href="../de472944/index.html">Data as a Service: Was ist das, technische Schwierigkeiten und wie können Sie diese mithilfe von residenten Proxys umgehen?</a></li>
<li><a href="../de472946/index.html">Ein guter Entwickler ist weise, nicht brillant</a></li>
<li><a href="../de472950/index.html">10 Möglichkeiten zum Schutz des geistigen Eigentums eines IT-Startups</a></li>
<li><a href="../de472956/index.html">Die Geschichte des Baus eines Raupenroboters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>