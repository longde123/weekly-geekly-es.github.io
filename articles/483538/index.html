<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜé üë©üèΩ‚Äçüéì ü§æ Conexi√≥n de una pantalla ER-TFT101-1 de 10 "al STM32F429 a trav√©s de FMC üì• üóÑÔ∏è üë©üèø‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buen dia a todos. En este art√≠culo analizaremos la conexi√≥n de la pantalla TFT ER-TFT101-1 (10 pulgadas, controlador RA8876) a la placa de descubrimie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conexi√≥n de una pantalla ER-TFT101-1 de 10 "al STM32F429 a trav√©s de FMC</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483538/">  Buen dia a todos.  En este art√≠culo analizaremos la conexi√≥n de la pantalla TFT ER-TFT101-1 (10 pulgadas, controlador RA8876) a la placa de descubrimiento STM32F429L a trav√©s de una interfaz paralela 8080 de 16 bits utilizando el m√≥dulo FMC (controlador de memoria flexible). <br><br><img src="https://habrastorage.org/webt/cp/ut/gd/cputgdq9cwztakwkxazqyzraay0.jpeg"><br><img src="https://habrastorage.org/webt/2m/om/jf/2momjfwxhdkw_lmxfx76jxeelpw.jpeg"><br><br><h4>  Acerca del ensamblaje de la pantalla </h4><br>  El ER-TFT101-1 de EastRising es un conjunto de una matriz TFT de 10 pulgadas con una resoluci√≥n de 1024x600 y una placa con un controlador RA8876.  En la placa base con el controlador, se enruta toda la potencia necesaria, hay una memoria SD-RAM de 16 megabytes (bus de 16 bits, frecuencia m√°xima de 166 MHz, capacidad m√°xima de 64 MB), hay una ranura para tarjeta microSD est√°ndar.  Hay huellas vac√≠as debajo de EEPROM con fuentes externas y debajo de memoria flash para im√°genes con conectores de salida para programarlas.  Adem√°s, opcionalmente se puede instalar un panel t√°ctil resistivo o capacitivo en el conjunto. <br><a name="habracut"></a><br>  En la placa est√° el controlador RAiO RA8876 de gama alta con una frecuencia m√°xima de funcionamiento de 120 MHz, que, si se desea, puede funcionar como un microcontrolador de control.  Puede escribir un peque√±o programa (solo 12 instrucciones) y guardarlo en una memoria flash externa.  Cuando se inicia la pantalla, este programa comenzar√° a ejecutarse en primer lugar, esencialmente duplicando todas las opciones de control a trav√©s de la interfaz externa. <br><br><img src="https://habrastorage.org/webt/pf/up/ld/pfupldlxpv0p0xzjk1uliqmypeo.png"><br><br>  RA8876 no tiene su propia RAM y, por lo tanto, utiliza una memoria SD-RAM externa.  Puede leer im√°genes de la memoria flash usando DMA y cargarlo en su b√∫fer de cuadros y tiene una configuraci√≥n muy flexible.  El controlador est√° conectado a la matriz misma mediante una interfaz RGB est√°ndar de 18 bits de ancho.  Solo se utilizan 6 bits por canal rojo, 6 bits por canal verde y 6 bits por canal azul.  Los dos bits inferiores de cada canal no se utilizan, lo que en teor√≠a da 262.144 colores. <br><br>  El m√≥dulo DMA del RA8876 es muy similar al DMA2D de STM: puede copiar secciones rectangulares de memoria de un lugar a otro, con conversi√≥n de color, transparencia y otros chips. <br><br>  RA8876 tambi√©n tiene fuentes incorporadas en ingl√©s y chino (8x16,12x24,16x32 p√≠xeles) con configuraciones flexibles para su visualizaci√≥n (rotaci√≥n, escala, etc.) y una interfaz de matriz separada (5 x 5) para botones de hardware (para dispositivos independientes y no solo usar) con un mont√≥n de configuraciones, como presionar larga y brevemente, activar la pantalla presionando un bot√≥n y presionando varios botones al mismo tiempo. <br><br>  Hay una funci√≥n de imagen en imagen (sin soporte de transparencia) para mostrar las ventanas emergentes y los men√∫s. <br><br>  El propio controlador puede dibujar primitivas gr√°ficas, como cuadrado, c√≠rculo, curva, √≥valo, tri√°ngulo, cuadrado redondeado, con y sin relleno.  Por cierto, en RA8875 y RA8876 hay un peque√±o error para llenar el tri√°ngulo, y cada controlador tiene el suyo.  Pero a RAiO no le import√≥ nada desde el alto campanario ... Intent√© escribirles una carta de alguna manera, as√≠ que ni siquiera respondieron.  Dibujar tales primitivas le permite crear hermosos gr√°ficos incluso con un microcontrolador lento. <br><br>  Con el mundo exterior, el RA8876 se comunica a trav√©s de 8080/6800 8/16 bit, 3/4 hilos SPI e interfaces I2C.  Adem√°s, el chip del controlador en s√≠ puede actuar como un maestro SPI e I2C.  En RA8876, hay dos salidas PWM que se pueden usar para un control flexible de la luz de fondo.  La frecuencia m√°xima de SPI CLK se declara a 66 MHz con una frecuencia de controlador de 120 MHz, que en teor√≠a proporciona 6 cuadros por segundo de una actualizaci√≥n de pantalla completa (a 1024 x 600 x 16 bits).  Esta conexi√≥n fue probada por m√≠ y demostr√≥ que tiene derecho a la vida si no mostramos el video en la pantalla. <br><br>  En nuestro caso, conectaremos la pantalla utilizando el protocolo 8080 con un ancho de 16 bits al STM32F429ZIT6 a trav√©s del m√≥dulo FMC (controlador de memoria flexible), lo que nos permitir√° obtener m√°s velocidad de llenado de pantalla y menos carga en el microcontrolador. <br><br><h4>  Configuraci√≥n de pines 8080 y FMC </h4><br>  Observaremos el diagrama de conexi√≥n para 8080 en la hoja de datos en la pantalla: <br><br><img src="https://habrastorage.org/webt/cu/6f/hq/cu6fhqbkgfnugnpjk7pxxy5k5ts.png"><br><br>  Observamos los pines necesarios para conectarse al STM32 en CubeMX.  Estamos interesados ‚Äã‚Äãen el banco # 1 (NOR Flash / PSRAM / SRAM / ROM / LDC 1). <br><br><img src="https://habrastorage.org/webt/9u/rr/dt/9urrdt8fmvcz-6d10pblahs24te.png"><br><br>  Con respecto a XnWAIT en la hoja de datos, puede leer lo siguiente: <br><blockquote>  <i>La velocidad de escritura continua de datos determina la velocidad de actualizaci√≥n de la pantalla.</i>  <i>El intervalo de ciclo a ciclo debe ser mayor que 5 del per√≠odo de reloj del sistema si el usuario no adopta XnWait para insertar el estado de espera.</i>  <i>Si se supera la especificaci√≥n, los datos se perder√°n o la funci√≥n fallar√° si no se utiliza el mecanismo xnwait.</i> </blockquote>  Literalmente, entre los ciclos operativos del protocolo 8080, se debe insertar un retraso de 5 fragmentos del sistema RA8876 si el usuario no utiliza el mecanismo XnWAIT para esperar el lanzamiento de RA8876.  Usaremos este pin una vez m√°s, como  En la pr√°ctica, trat√© de insertar un retraso de cinco ciclos, y no funcion√≥. <br><br>  En lugar de un bus de direcci√≥n completa para la unidad FMC, usamos solo un pin A16. <br><br><ol><li>  Configuramos los pines de datos (D0 - D15) como una funci√≥n alternativa # 12, como el grupo de empuje, la velocidad m√°xima y sin ning√∫n tipo de tirantes. </li><li>  Los pines XnWAIT, XnWR, XnRD, XA0 y XnCS est√°n configurados como una funci√≥n alternativa n. ¬∞ 12, como push-pull con elevaci√≥n al plus (PULL UP). </li><li>  Configuramos XnRST como un GPIO normal sin un tirante (est√° en el tablero). </li><li>  XnINTR es configurable como un GPIO a la entrada con una elevaci√≥n al plus. </li></ol><br>  Tambi√©n conect√© la luz de fondo al 100% sin controlarla a trav√©s de PWM.  Para hacer esto, el pin # 14 en el conector del ensamblaje de la pantalla est√° conectado a VDD. <br><br>  No proporciono el c√≥digo de configuraci√≥n para los pines,  Utilizo mis propias bibliotecas de configuraci√≥n, y la configuraci√≥n de GPIO en s√≠ ya ha sido masticada cientos de veces en el concentrador y en otras fuentes. <br><br>  <a href="https://github.com/Yoda49/RA8876-Driver-for-STM32F429ZIT6-FMC" rel="nofollow">La biblioteca de inicializaci√≥n est√° aqu√≠</a> . <br><br><h4>  Configuraciones de FMC </h4><br>  Tres bancos para cada banco son responsables de configurar los bancos del m√≥dulo FMC (NOR Flash / PSRAM / SRAM / ROM / LDC 1).  Estos son FMC_BCRx, FMC_BTRx y FMC_BWTRx.  En el STM32F429 MK define, los registros FMC_BCRx y FMC_BTRx se combinan en una matriz com√∫n llamada FMC_BTCR con ocho elementos, donde el elemento cero es FMC_BCR1, el primer elemento es FMC_BTR1, el segundo elemento es FMC_BCR2, y as√≠ sucesivamente.  FMC_BWTRx se combinan en una matriz FMC_BWTR con siete elementos, aunque deber√≠a haber cuatro.  No me preguntes por qu√© ... <br><br>  FMC_BCRx contiene configuraciones b√°sicas, FMC_BTRx contiene temporizaciones generales y FMC_BWTRx contiene temporizaciones separadas para la lectura, si el dispositivo lo requiere. <br><br>  Diagrama de tiempos y tiempos para la interacci√≥n de STM32F429 y RA8876. <br><br><img src="https://habrastorage.org/webt/fc/q5/sx/fcq5sxlxvbr0tqg1bz0mthfgzpm.png"><br><br>  Para facilitar la configuraci√≥n, insertaremos los tiempos del protocolo 8080 en constantes.  Eleg√≠ los tiempos emp√≠ricamente, reduciendo un poco el valor, porque  La tabla de tiempos con una hoja de datos es m√°s como un caballo esf√©rico en el vac√≠o. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ADDSET = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ADDHLD = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> DATAST = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> BUSTURN = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> CLKDIV = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> DATLAT = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ACCMOD = <span class="hljs-number"><span class="hljs-number">0</span></span>; RCC-&gt;AHB3ENR |= RCC_AHB3ENR_FMCEN; <span class="hljs-comment"><span class="hljs-comment">//  FMC FMC_Bank1-&gt;BTCR[0] = 0; //    FMC_Bank1-&gt;BTCR[0] |= FMC_BCR1_MWID_0; //    16  FMC_Bank1-&gt;BTCR[0] |= FMC_BCR1_WREN; //    FMC_Bank1-&gt;BTCR[0] |= FMC_BCR1_WAITEN; //   XnWAIT FMC_Bank1-&gt;BTCR[0] |= FMC_BCR1_ASYNCWAIT; // XnWAIT    FMC_Bank1-&gt;BTCR[0] |= FMC_BCR1_WAITCFG; //  XnWAIT FMC_Bank1-&gt;BTCR[1] = 0; //    FMC_Bank1-&gt;BTCR[1] |= (ADDSET &lt;&lt; 0) | (ADDHLD &lt;&lt; 4) | (DATAST &lt;&lt; 8) | (BUSTURN &lt;&lt; 16) | (CLKDIV &lt;&lt; 20) | (DATLAT &lt;&lt; 24) | (ACCMOD &lt;&lt; 28); //   FMC_Bank1-&gt;BTCR[0] |= 1; //   </span></span></code> </pre> <br>  El valor del registro FMC_BTCRx despu√©s del restablecimiento es 0x0FFF FFFF, es decir  Se establecen los tiempos m√°ximos.  Si tiene una nueva pantalla o memoria, simplemente reduzca los tiempos e intente ejecutar. <br><br><h4>  Visualizaci√≥n de inicializaci√≥n </h4><br>  Trabajar con la pantalla se reduce a leer o escribir en ciertas √°reas de la memoria.  FMC se encarga del resto del trabajo.  Para simplificar el trabajo, definimos dos definiciones: <br><br><pre> <code class="plaintext hljs">#define LCD_DATA 0x60020000 #define LCD_REG 0x60000000</code> </pre> <br>  Y ahora describimos las funciones de bajo nivel: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LCD_CmdWrite</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cmd)</span></span></span><span class="hljs-function"> </span></span>{ *(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(LCD_REG) = cmd; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LCD_DataWrite</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data)</span></span></span><span class="hljs-function"> </span></span>{ *(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(LCD_DATA)= data; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LCD_StatusRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> data = *(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(LCD_REG); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LCD_DataRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> data = * (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(LCD_DATA); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)data; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LCD_RegisterWrite</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cmd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data)</span></span></span><span class="hljs-function"> </span></span>{ *(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(LCD_REG) = cmd; *(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(LCD_DATA) = data; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LCD_RegisterRead</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cmd)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> data = <span class="hljs-number"><span class="hljs-number">0</span></span>; LCD_CmdWrite (cmd); data = LCD_DataRead (); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; };</code> </pre> <br>  Adem√°s, la funci√≥n de inicializaci√≥n de la pantalla en s√≠.  El c√≥digo se toma del proveedor de pantallas y se redise√±√≥ ligeramente para adaptarse a sus necesidades.  Las subfunciones ocupan una gran cantidad y en este art√≠culo no las dar√©. <br><br>  <a href="" rel="nofollow">Enlace al conductor en el github</a> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RA8876_Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ RA8876_PLL_Init (); <span class="hljs-comment"><span class="hljs-comment">//   RA8876  120  RA8876_SDRAM_Init (); //  SDRAM  166  TFT_24bit (); //    24   ??? Host_Bus_16bit (); //   16  RGB_16b_16bpp (); //   16  MemWrite_Left_Right_Top_Down (); //       . Graphic_Mode (); //    Memory_Select_SDRAM (); //   SDRAM /*  RGB     RA8876 */ HSCAN_L_to_R (); VSCAN_T_to_B (); PDATA_Set_RGB (); PCLK_Falling (); DE_High_Active (); HSYNC_High_Active (); VSYNC_High_Active (); LCD_HorizontalWidth_VerticalHeight (1024, 600); LCD_Horizontal_Non_Display (160); LCD_HSYNC_Start_Position (160); LCD_HSYNC_Pulse_Width (70); LCD_Vertical_Non_Display (23); LCD_VSYNC_Start_Position (12); LCD_VSYNC_Pulse_Width (10); //   Frame_Buffer_Start_Address (PAGE0_START_ADDR); Frame_Buffer_Width (1024); Frame_Buffer_Start_XY (0, 0); Frame_Buffer_Color_Mode_16bpp (); //   Canvas_Window_Start_Address (PAGE0_START_ADDR); Canvas_Window_Width (1024); Canvas_Window_Start_XY (0, 0); Canvas_Window_WH (1024, 600); Canvas_Memory_XY_Mode (); Canvas_Window_Color_Mode_16bpp (); }</span></span></code> </pre><br>  Sobre framebuffer y √°rea activa un poco m√°s.  Para estas dos configuraciones, definimos las siguientes definiciones: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE0_START_ADDR 0 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE1_START_ADDR (1024 * 600 * 2 * 1) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE2_START_ADDR (1024 * 600 * 2 * 2) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE3_START_ADDR (1024 * 600 * 2 * 3) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE4_START_ADDR (1024 * 600 * 2 * 4) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE5_START_ADDR (1024 * 600 * 2 * 5) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE6_START_ADDR (1024 * 600 * 2 * 6) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE7_START_ADDR (1024 * 600 * 2 * 7) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE8_START_ADDR (1024 * 600 * 2 * 8) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE9_START_ADDR (1024 * 600 * 2 * 9) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE10_START_ADDR (1024 * 600 * 2 * 10) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE11_START_ADDR (1024 * 600 * 2 * 11) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> PAGE12_START_ADDR (1024 * 600 * 2 * 12)</span></span></code> </pre> <br>  Cada p√°gina (PAGEx_START_ADDR) es la direcci√≥n de inicio en la SDRAM.  En 16 megabytes de memoria, podemos colocar 13 capas completas en tama√±o 1228800 bytes (1024 * 600 * 2). <br>  La funci√≥n Frame_Buffer_Start_Address establece el √°rea de memoria inicial para el framebuffer (lo que se muestra actualmente). <br><br>  La funci√≥n Canvas_Window_Start_Address establece el √°rea de memoria inicial para el lienzo.  Adem√°s, el lienzo puede ser m√°s grande que el framebuffer, por lo que puede desplazar la imagen en la pantalla.  Por ejemplo, para un juego de plataformas, puede hacer un lienzo largo que mida 13312 x 600 p√≠xeles y luego desplazarse horizontalmente moviendo el framebuffer horizontalmente a trav√©s de √©l. <br><br>  Si compara la salida de gr√°ficos con LTDM de STM32, entonces no todo es tan color de rosa aqu√≠.  Al mismo tiempo, el controlador mismo puede mostrar solo una capa final (buffer) y LTDC a la vez dos, mezcl√°ndolas, sin requerir su participaci√≥n en este proceso. <br><br><h4>  Dibujando primitivas </h4><br>  C√≥digo de un proveedor de pantallas con caracter√≠sticas preconstruidas: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Line</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Triangle</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Triangle_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Line_Start_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Line_End_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Triangle_Point1_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Triangle_Point2_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Triangle_Point3_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Square_Start_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Square_End_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Circle_or_Ellipse</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Circle_or_Ellipse_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Left_Down_Curve</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Left_Up_Curve</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Right_Up_Curve</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Right_Down_Curve</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Left_Down_Curve_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Left_Up_Curve_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Right_Up_Curve_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Right_Down_Curve_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Square</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Square_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Circle_Square</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start_Circle_Square_Fill</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Circle_Center_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ellipse_Center_XY</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Circle_Radius_R</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ellipse_Radius_RxRy</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Circle_Square_Radius_RxRy</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> WX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HY)</span></span></span></span>;</code> </pre> <br>  Por ejemplo, para dibujar un tri√°ngulo relleno, establecemos tres puntos: Triangle_Point1_XY, Triangle_Point2_XY, Triangle_Point2_XY y ejecutamos la funci√≥n Start_Triangle_Fill. <br><br><h4>  Trabajar con DMA </h4><br>  Por conveniencia, escrib√≠ mi funci√≥n con una estructura como par√°metro pasado: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GFX_BTE_options</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> layer_s0_addr; <span class="hljs-comment"><span class="hljs-comment">//     0 unsigned long layer_s1_addr; //     1 unsigned long layer_d_addr; //     unsigned short layer_s0_width; //    0 unsigned short layer_s1_width; //    1 unsigned short layer_d_width; //    unsigned short layer_s0_start_x; //     0 unsigned short layer_s0_start_y; //   Y  0 unsigned short layer_s1_start_x; //   X  1 unsigned short layer_s1_start_y; //   Y  1 unsigned short layer_d_start_x; //   X   unsigned short layer_d_start_y; //   Y   unsigned short window_size_x; //     unsigned short window_size_y; //     unsigned char rop_code; //  ROP unsigned char operation_code; //   DMA };       DMA: void GFX_BTE_operation (struct GFX_BTE_options options) { BTE_S0_Color_16bpp (); BTE_S0_Memory_Start_Address (options.layer_s0_addr); BTE_S0_Image_Width (options.layer_s0_width); BTE_S0_Window_Start_XY (options.layer_s0_start_x, options.layer_s0_start_y); BTE_S1_Color_16bpp (); BTE_S1_Memory_Start_Address (options.layer_s1_addr); BTE_S1_Image_Width (options.layer_s1_width); BTE_S1_Window_Start_XY (options.layer_s1_start_x, options.layer_s1_start_y); BTE_Destination_Color_16bpp (); BTE_Destination_Memory_Start_Address (options.layer_d_addr); BTE_Destination_Image_Width (options.layer_d_width); BTE_Destination_Window_Start_XY (options.layer_d_start_x, options.layer_d_start_y); BTE_Window_Size (options.window_size_x, options.window_size_y); BTE_ROP_Code (options.rop_code); BTE_Operation_Code (options.operation_code); BTE_Enable (); Check_BTE_Busy (); }</span></span></code> </pre> <br>  <u>Descripci√≥n de los c√≥digos de operaci√≥n (C√ìDIGO DE OPERACI√ìN):</u> <br><br>  0000: escribir en la memoria con ROP usando MK. <br>  0001: Leer memoria sin ROP usando MK. <br>  0010: Copie un bloque de memoria hacia adelante usando ROP. <br>  0011: Copiar un bloque de memoria en la direcci√≥n inversa usando ROP. <br>  0100: Escribir en la memoria (con transparencia) sin ROP usando MK. <br>  0101: Copie (mueva) un bloque de memoria (con transparencia) en direcci√≥n hacia adelante sin ROP. <br>  0110: Rellenar con un patr√≥n usando ROP. <br>  0111: Rellene la plantilla con chromakey. <br>  1000: extensi√≥n de color <br>  1001: color mejorado con transparencia <br>  1010: mover un bloque de memoria hacia adelante con mezcla alfa <br>  1011: Escribir en la memoria con mezcla alfa con MK. <br>  1100: llena el √°rea de memoria con un color s√≥lido. <br>  1101: reservado <br>  1110: Reservado <br>  1111: reservado <br><br>  <u>Descripci√≥n de c√≥digos r√°ster (C√ìDIGO ROP):</u> <br><br>  0000b: 0 (negro) <br>  0001b: ~ S0 „Éª ~ S1 o ~ (S0 + S1) <br>  0010b: ~ S0 „Éª S1 <br>  0011b: ~ S0 <br>  0100b: S0 „Éª ~ S1 <br>  0101b: ~ S1 <br>  0110b: S0 ^ S1 <br>  0111b: ~ S0 + ~ S1 o ~ (S0 „Éª S1) <br>  1000b: S0 „Éª S1 <br>  1001b: ~ (S0 ^ S1) <br>  1010b: S1 <br>  1011b: ~ S0 + S1 <br>  1100b: S0 <br>  1101b: S0 + ~ S1 <br>  1110b: S0 + S1 <br>  1111b: 1 (blanco) <br><br>  S0 es la capa cero, S1 es la primera capa.  La interacci√≥n entre ellos ocurre mediante operaciones aritm√©ticas y de bits. <br><br><h4>  Salida de fuente en l√≠nea </h4><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GFX_Show_String_TMODE</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *ptr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> charColor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bkColor)</span></span></span><span class="hljs-function"> </span></span>{ Foreground_color_65k (charColor); Background_color_65k (bkColor); CGROM_Select_Internal_CGROM (); Font_Select_12x24_24x24 (); Text_Mode (); Goto_Text_XY (x, y); LCD_CmdWrite (<span class="hljs-number"><span class="hljs-number">0x04</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (*ptr != <span class="hljs-string"><span class="hljs-string">'\0'</span></span>) { LCD_DataWrite (*ptr); Check_Mem_WR_FIFO_not_Full (); ++ptr; } Check_2D_Busy (); Graphic_Mode (); <span class="hljs-comment"><span class="hljs-comment">//back to graphic mode }</span></span></code> </pre> <br>  <a href="https://github.com/Yoda49/RA8876-Driver-for-STM32F429ZIT6-FMC" rel="nofollow">La versi√≥n completa del controlador se puede encontrar en el github en el enlace</a> <br><br>  Gracias a todos por leer! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/483538/">https://habr.com/ru/post/483538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483526/index.html">Administrar el estado de la aplicaci√≥n con RxJS / Immer como una alternativa simple a Redux / MobX</a></li>
<li><a href="../483528/index.html">REST API debe basarse en hipertexto</a></li>
<li><a href="../483530/index.html">C√≥mo hicimos un juego de mesa. ¬øPor qu√© y por qu√©?</a></li>
<li><a href="../483532/index.html">Conferencia DefCon 27: Detr√°s de escena de la creaci√≥n de insignias electr√≥nicas Parte 1</a></li>
<li><a href="../483536/index.html">La historia del microprocesador y la computadora personal: 1974 - 1980</a></li>
<li><a href="../483540/index.html">ChaiScript: lenguaje de script para C ++</a></li>
<li><a href="../483542/index.html">Resumen de telecomunicaciones: materiales sobre el trabajo de los proveedores</a></li>
<li><a href="../483544/index.html">Nueva suposici√≥n clave de refutaci√≥n de datos de energ√≠a oscura</a></li>
<li><a href="../483550/index.html">Servicio y desarrollo de IaaS: una compilaci√≥n de nube, almacenamiento de datos y evoluci√≥n de 1cloud</a></li>
<li><a href="../483552/index.html">MVVM y selecci√≥n de elementos en el adaptador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>