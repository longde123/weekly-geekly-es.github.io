<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÇ üëàüèº üôèüèΩ Wie ich einer Schlange beigebracht habe, sich mit Q-Network selbst zu spielen üè¶ ‚õÑÔ∏è üë®üèΩ‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als ich einmal die Tiefen des Internets erkundete, stie√ü ich auf ein Video, in dem eine Person eine Schlange mithilfe eines genetischen Algorithmus tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich einer Schlange beigebracht habe, sich mit Q-Network selbst zu spielen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465477/"><p>  Als ich einmal die Tiefen des Internets erkundete, stie√ü ich auf ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Video,</a> in dem eine Person eine Schlange mithilfe eines genetischen Algorithmus trainiert.  Und ich wollte das gleiche.  Aber es w√§re nicht interessant, trotzdem zu nehmen und in Python zu schreiben.  Und ich entschied mich f√ºr einen moderneren Ansatz f√ºr das Training von Agentensystemen, n√§mlich Q-Network.  Aber fangen wir von vorne an. </p><br><h2 id="obuchenie-s-podkrepleniem">  Verst√§rkungstraining </h2><br><p>  Beim maschinellen Lernen unterscheidet sich RL (Reinforcement Learning) erheblich von anderen Bereichen.  Der Unterschied besteht darin, dass der klassische ML-Algorithmus bereits auf die fertigen Daten trainiert ist, w√§hrend der RL diese Daten sozusagen f√ºr sich selbst erstellt.  Die Idee von RL ist, dass es zus√§tzlich zu dem Algorithmus selbst, der als Agent bezeichnet wird, eine Umgebung gibt, in der dieser Agent platziert ist.  In jeder Phase muss der Agent eine Aktion (Aktion) ausf√ºhren, und die Umgebung antwortet mit einer Belohnung (Belohnung) und ihrem Status (Status), auf deren Grundlage der Agent die Aktion ausf√ºhrt. </p><a name="habracut"></a><br><h2 id="dqn">  Dqn </h2><br><p>  Es sollte eine Erkl√§rung geben, wie der Algorithmus funktioniert, aber ich werde einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Link</a> hinterlassen, wo kluge Leute ihn erkl√§ren. </p><br><h2 id="realizaciya-zmeyki">  Schlangenimplementierung </h2><br><p>  Nachdem wir c rl herausgefunden haben, m√ºssen wir eine Umgebung erstellen, in der wir den Agenten platzieren.  Gl√ºcklicherweise muss das Rad nicht neu erfunden werden, da ein Unternehmen wie open-ai bereits die Fitness-Bibliothek geschrieben hat, mit der Sie Ihre eigene Umgebung schreiben k√∂nnen.  In der Bibliothek sind sie bereits in gro√üer Zahl.  Von einfachen Atari-Spielen bis hin zu komplexen 3D-Modellen.  Aber unter all dem gibt es keine Schlange.  Deshalb fahren wir mit seiner Schaffung fort. </p><br><p>  Ich werde nicht alle Momente der Schaffung einer Umgebung im Fitnessstudio beschreiben, sondern nur die Hauptklasse zeigen, in der mehrere Funktionen implementiert werden m√ºssen. </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gym <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Env</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(gym.Env)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, action)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    .    ,      """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""        """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, mode=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'human'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" """</span></span></code> </pre> <br><p>  Um diese Funktionen zu implementieren, m√ºssen wir jedoch ein Belohnungssystem entwickeln und in welcher Form wir Informationen √ºber die Umgebung geben. </p><br><h3 id="sostoyanie">  Zustand </h3><br><p>  In dem Video gab ein Mann der Schlange den Abstand zur Wand, Schlange und Apfel in 8 Richtungen.  Das sind 24 Zahlen.  Ich habe beschlossen, die Datenmenge zu reduzieren, sie aber etwas zu komplizieren.  Zuerst werde ich den Abstand zu den W√§nden mit dem Abstand zur Schlange kombinieren.  Einfach ausgedr√ºckt, wir werden ihr die Entfernung zum n√§chsten Objekt mitteilen, das bei einer Kollision t√∂ten kann.  Zweitens gibt es nur drei Richtungen, die von der Bewegungsrichtung der Schlange abh√§ngen.  Zum Beispiel schaut die Schlange beim Starten nach oben, sodass wir den Abstand zur oberen, linken und rechten Wand angeben.  Wenn sich der Kopf der Schlange nach rechts dreht, werden wir bereits den Abstand zur rechten, oberen und unteren Wand angeben.  Der Einfachheit halber werde ich ein Bild geben. </p><br><p><img src="https://habrastorage.org/webt/jv/sf/i9/jvsfi9tk6aavphdvn3impizyfrm.jpeg"></p><br><p>  Ich habe auch beschlossen, mit dem Apfel zu spielen.  Wir werden Informationen dar√ºber in Form von (x, y) -Koordinaten im Koordinatensystem pr√§sentieren, das am Kopf der Schlange entsteht.  Das Koordinatensystem √§ndert auch seine Ausrichtung hinter dem Kopf der Schlange.  Nach dem Bild denke ich, dass es definitiv klar werden sollte. </p><br><p><img src="https://habrastorage.org/webt/dg/7p/ct/dg7pct5efnwcsvzrdbem7p8usb4.jpeg"></p><br><h3 id="nagrada">  Belohnung </h3><br><p>  Wenn Sie mit dem Staat eine Art von Funktionen entwickeln k√∂nnen und hoffen, dass das neuronale Netzwerk dies herausfindet, dann ist mit der Auszeichnung alles komplizierter.  Es h√§ngt von ihr ab, ob der Agent lernen wird und ob er lernen wird, was wir wollen. </p><br><p>  Ich werde sofort das Belohnungssystem geben, mit dem ich ein stabiles Training erreicht habe. </p><br><ul><li>  Bei jedem Schritt betr√§gt die Belohnung -0,25. </li><li>  Beim Tod -10. </li><li>  Nach dem Tod bis zu 15 Schritte -100. </li><li>  Beim Verzehr eines Apfels ( <em>Anzahl der verzehrten √Ñpfel</em> ) * 3.5. </li></ul><br><p>  Und geben Sie auch Beispiele daf√ºr, was zu einem schlechten Belohnungssystem f√ºhrt. </p><br><ul><li>  Wenn Sie in den ersten Schritten nicht gen√ºgend Belohnung f√ºr den Tod geben, wird die Schlange es vorziehen, gegen die Wand zu t√∂ten.  Es ist einfacher als nach √Ñpfeln zu suchen :) </li><li>  Wenn Sie eine positive Belohnung f√ºr die Schritte geben, beginnt sich die Schlange endlos zu drehen.  Denn ihrer Meinung nach wird es rentabler sein, als nach √Ñpfeln zu suchen. </li><li>  Und viele andere F√§lle, in denen die Schlange einfach nicht lernt. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Nun, ein Beispiel daf√ºr, was die Schlange in 2000 Folgen gelernt hat</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/oj/j2/kd/ojj2kdxlcmslxzlvfqx8cpv-k14.gif"></p></div></div><br><h2 id="itog">  Zusammenfassung </h2><br><p>  Das Hauptinteresse beim Schreiben der Schlange war zu sehen, wie die Schlange lernt, indem sie so wenig √ºber ihre Umgebung wei√ü.  Und sie hat gut gelernt, da die durchschnittliche Rate der verzehrten √Ñpfel 23 erreichte, was meiner Meinung nach nicht sehr schlecht ist.  Daher kann das Experiment als erfolgreich angesehen werden. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Quellcode</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465477/">https://habr.com/ru/post/de465477/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465461/index.html">Statische Eingabe in einer React-Anwendung</a></li>
<li><a href="../de465463/index.html">Gut ist niemals billig. Aber es ist kostenlos</a></li>
<li><a href="../de465467/index.html">Die ganze Wahrheit √ºber RTOS. Artikel 32. Nucleus SE-Migration: Nicht realisierte Funktionen und Kompatibilit√§t</a></li>
<li><a href="../de465471/index.html">Haben Sie versucht, Ihre Site als Netzwerkpublikation in Roskomnadzor zu registrieren?</a></li>
<li><a href="../de465475/index.html">Mini-Interview mit Oleg Anastasiev: Fehlertoleranz bei Apache Cassandra</a></li>
<li><a href="../de465479/index.html">Pixel Lo-Fi in Unity</a></li>
<li><a href="../de465483/index.html">Antiquit√§ten: Windows 3.1 und Leben ohne Startknopf</a></li>
<li><a href="../de465485/index.html">Drucken Sie mit Python einen Wandteppich Game of Thrones auf einem Steuerdrucker</a></li>
<li><a href="../de465487/index.html">Erstellen Sie eine Kubernetes-Plattform auf Pinterest</a></li>
<li><a href="../de465489/index.html">Checkliste f√ºr die Produktionsbereitschaft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>