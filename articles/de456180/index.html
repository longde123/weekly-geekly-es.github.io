<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌯 👨🏻‍🍳 👩🏿‍⚖️ Wie habe ich meine erste Sicherheitslücke gefunden? 🦈 🏑 🌽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vorwort 
 Hallo an alle. Ich bin 20 Jahre alt. Bis vor kurzem habe ich am Lyceum studiert und mich auf den Eintritt in eine medizinische Universität v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie habe ich meine erste Sicherheitslücke gefunden?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456180/"><h3>  Vorwort </h3><br>  Hallo an alle.  Ich bin 20 Jahre alt.  Bis vor kurzem habe ich am Lyceum studiert und mich auf den Eintritt in eine medizinische Universität vorbereitet. Jetzt bin ich ein Full-Stack-Entwickler in einem amerikanischen Unternehmen.  Tatsächlich bin ich sehr froh, dass ich mit Medizin keinen Erfolg hatte - Programmieren war mein Hobby, und jetzt kann ich es die ganze Zeit tun.  Jetzt möchte ich lieber nicht über den Erfolg in der IT schreiben.  Im Moment möchte ich darüber sprechen, wie ich ein paar Bücher über Schwachstellen gelesen habe (um meine Projekte zu schützen), und ich habe es geschafft, dieses Wissen in die Praxis umzusetzen. <br><br><h3>  Haftungsausschluss </h3><br>  Alle Materialien, Screenshots sowie Links zu Ressourcen Dritter werden zu Bildungszwecken veröffentlicht.  Der Autor ist nicht verantwortlich für die Verwendung durch andere Besucher des Habr.  Das Unternehmen wurde im Voraus über 48 Stunden über die Sicherheitsanfälligkeit informiert und erhielt genügend Daten, um diese zu beheben. <br><a name="habracut"></a><br><h2>  Wie alles begann </h2><br>  Es war ein sehr gewöhnlicher Tag.  Ich erledigte mehrere Aufgaben bei der Arbeit und kochte eine Tasse Kaffee.  Gleichzeitig habe ich beschlossen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Artikel</a> über die Bereitstellung der Anwendung in AWS zu lesen, den ich einmal in VK für mich selbst neu gepostet habe (den Artikel habe ich übrigens nie gelesen).  In der Spalte rechts neben dem Artikel werden mehrere andere Artikel und ein <b>Partnerbanner für den Hosting-Anbieter</b> angezeigt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f8/47a/a34/8f847aa343de32b3f8e385a1d691259b.png" alt="Bild"><br><br>  Ich kann mich nicht erinnern, warum ich genau auf die Website gegangen bin, aber während des Übergangs habe ich eine interessante Funktion bemerkt: Der Link führt zur Registrierungsseite und füllte sofort ein Feld aus - einen Aktionscode. <br><br>  Wenn wir den Aktionscode vergleichen, der sich im Eingabefeld und in der Adressleiste befindet, sehen wir, dass sie vollständig übereinstimmen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/458/0be/bcc/4580bebcc578ee1a923cd2973093c0d9.png" alt="Bild"><br><br><h2>  Was können wir dagegen tun? </h2><br>  Es ist üblich, zu versuchen, sich zu ändern.  Wenn der Aktionscode mit dem Wert in der Datenbank verglichen wird, erhalten wir mit hoher Wahrscheinlichkeit einen Fehler.  Beim Ändern der Eingabe erfolgt jedoch keine Anforderung an den Server, und es stellt sich heraus, dass die Eingabe nur überprüft wird, wenn Sie auf die Registrierungsschaltfläche klicken. <br><br>  Ich denke, hier können Sie bereits etwas Interessanteres tun: Ändern Sie unseren Aktionscode direkt in der Adressleiste und sehen Sie, was passiert.  Wenn sie keinen Promotion-Code speziell für den Habr haben, den ich sofort erraten habe, <s>sowie hundert verschiedene Zeichensätze</s> , können wir die Werte des Eingabefelds definitiv über den Adresslink ändern. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b5/dad/ca0/2b5dadca07aa57c01f7af71162effabf.png" alt="Bild"><br><br>  Der nächste Schritt besteht darin, den HTML-Code zu beobachten.  RMB im Eingabefeld -&gt; Artikelcode anzeigen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e5/76c/6f0/1e576c6f0af03c3e06c7db8f0374af68.png" alt="Bild"><br><br>  Hier sehen Sie sofort, dass wir den Wert des Eingabefeldes ändern.  Versuchen wir es zu beenden und zum Beispiel einen Link hinzuzufügen.  Dazu müssen wir nur den Link ändern und können den Inhalt der Seite ändern: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f36/e33/a28/f36e33a28083d6c544d340f54ba51676.png" alt="Bild"><br><br>  Ergebnis: Wir haben gerade eine xss-Sicherheitslücke auf der Website des Hosting-Anbieters gefunden. <br><br><h2>  Und was dann? </h2><br>  Ich denke, es lohnt sich, tiefer zu gehen.  Der Link ist irgendwie flach und nicht interessant.  Wir möchten dies alles den Eigentümern des Dienstes mitteilen und im Idealfall eine Belohnung erhalten (das Unternehmen hat übrigens keine Bug Bounty, was bedeutet, dass all dies nicht bezahlt wird, aber dann wusste ich nichts davon).  Versuchen wir, den Block zu platzieren, zu stabilisieren und das Bild einzufügen.  Was wird dafür benötigt?  egal - URL ändern. <br><br>  Ich denke, dass es sich nicht lohnt, HTML und CSS zu beschreiben, also habe ich hier nur angegeben, was passiert ist.  Habr blockiert einen Teil von Tags, verwirft andere - ich kann den Linkcode hier nicht einfügen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4d/22c/2e0/e4d22c2e0478fcd98e3804d8125792bc.png" alt="Bild"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://upcloud.com/signup/%3Fpromo%3D%2522%253E%2B%253Cdiv%2520class%3Dblack%2520style%3Dwidth:100%25%3Bheight:400px%3Bbackground-color:red%3Bpadding:10px%3Bopacity:0.7%3Bborder:5px%3Bborder-style:solid%3Bborder-color:teal%3Bborder-radius:10px%253EYour%2520WebSite%2520have%2520been%2520hacked!%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cimg%2520src%3D">Ich werde hier einen Link posten.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://upcloud.com/signup/%3Fpromo%3D%2522%253E%2B%253Cdiv%2520class%3Dblack%2520style%3Dwidth:100%25%3Bheight:400px%3Bbackground-color:red%3Bpadding:10px%3Bopacity:0.7%3Bborder:5px%3Bborder-style:solid%3Bborder-color:teal%3Bborder-radius:10px%253EYour%2520WebSite%2520have%2520been%2520hacked!%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cimg%2520src%3D">Ich weiß nicht, ob sie im Moment arbeitet, aber als sie den Beitrag gepostet hat, hat sie gearbeitet.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://upcloud.com/signup/%3Fpromo%3D%2522%253E%2B%253Cdiv%2520class%3Dblack%2520style%3Dwidth:100%25%3Bheight:400px%3Bbackground-color:red%3Bpadding:10px%3Bopacity:0.7%3Bborder:5px%3Bborder-style:solid%3Bborder-color:teal%3Bborder-radius:10px%253EYour%2520WebSite%2520have%2520been%2520hacked!%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cimg%2520src%3D">Wer es braucht - zieht den Link heraus und analysiert.</a> <br><br><h3>  Vergütung </h3><br>  Denken Sie nicht, dass upCloud sich vollständig geweigert hat zu zahlen.  Stattdessen boten sie ihre Dienste kostenlos an.  Aber ich habe diese Art der Zahlung abgelehnt, da ich jetzt nicht daran interessiert bin, einen Server zu mieten. <br><br><h3>  Wie kann diese Sicherheitsanfälligkeit ausgenutzt werden? </h3><br>  Hier ist alles einfach: Sie können zunächst Daten von allen neuen Benutzern sammeln, mit Phishing-Sites enden und das Hosting eines anderen als Ihr eigenes verwenden.  Sie können alle Links auf der Seite durch Ihre eigenen ersetzen oder das Formular durch Benutzer ersetzen.  Es reicht aus, sie als Empfehlungen zu senden.  Natürlich können Sie eine Anfrage aus dem Formular an den Server ersetzen, damit der Aktionscode nicht überprüft wird (bei der Registrierung wird der Aktionscode überprüft und die Antwort wird mit einem Fehler an den Client zurückgegeben, dies wird jedoch durch Aktivieren von zhs behoben). <br><br><h2>  Was die Entwickler vergessen haben: </h2><br>  Es ist ganz einfach: Benutzereingaben validieren.  SQL-Inj funktioniert dort nicht - der Dienst hängt an WordPress und verarbeitet wiederum eingehende Zeilen. <br><br>  Deshalb können wir: <br><br><ol><li>  Überprüfen Sie den Promo-Code mit der Basis, wenn Sie die Seite rendern <br><br>  Es ist langsam und nicht gerechtfertigt.  Die Datenbank wird nicht zusätzlich belastet, und dies hat keinen Sinn, wenn sie bei der Registrierung noch überprüft wird. <br></li><li>  Fahren Sie den Aktionscode durch die reguläre Saison <br><br>  / ^ [A-Z0-9] + $ / - reicht aus, um Werte zu validieren und vor Schwachstellen zu schützen.  Und es funktioniert schneller als das Abfragen der Datenbank, und der Effekt ist nicht schlechter - XSS wird entfernt. <br></li></ol><br><h2>  Fazit </h2><br>  Die Eigentümer des Dienstes wurden 48 Stunden + 2 Tage zuvor darüber informiert, dass ich per E-Mail und LinkedIn mit denen verhandelte, die zumindest irgendwie mit der Entwicklung zu tun hatten.  Alle Gespräche kamen zu: "Bitte sagen Sie uns, wie Sie es gemacht haben, aber wir werden natürlich nicht für Schwachstellen bezahlen."  Ich möchte auch hinzufügen, dass die Website auf die gleiche Weise JS-Skripte von Drittanbietern akzeptiert: sowohl über eine Quelle von Drittanbietern als auch durch direktes Schreiben von Code. Im zweiten Fall erkennt Google Chrome jedoch automatisch xss und rendert eine Fehlerseite anstelle einer Serviceseite. <br><br>  Ich hoffe, jeder Programmierer wird alle Eingabedaten validieren und das Querystring nicht vergessen.  Und ich bin mir auch sicher, dass der Artikel jemandem helfen wird, dies im Voraus zu bemerken und dieses Problem zu Hause zu beheben. <br><br>  Vielen Dank für Ihre Aufmerksamkeit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456180/">https://habr.com/ru/post/de456180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456168/index.html">Wo war dein Haus vor Millionen von Jahren?</a></li>
<li><a href="../de456170/index.html">So erstellen Sie eine Finanzanwendung: 5 APIs, die dem Entwickler helfen</a></li>
<li><a href="../de456172/index.html">Teil 2: RocketChip: RAM verbinden</a></li>
<li><a href="../de456174/index.html">Wie man als Student einen Hackathon organisiert 101. Teil Zwei</a></li>
<li><a href="../de456178/index.html">Android-Themen und -Stile ohne Magie. Und wie man sie mit SwitchCompat kocht</a></li>
<li><a href="../de456182/index.html">Audio über Bluetooth: Detaillierteste Informationen zu Profilen, Codecs und Geräten</a></li>
<li><a href="../de456184/index.html">Software Defined Radio - wie funktioniert es? Teil 8</a></li>
<li><a href="../de456188/index.html">Token, Token aktualisieren und einen asynchronen Wrapper für eine REST-Anforderung erstellen</a></li>
<li><a href="../de456192/index.html">Von Monolithen zu Microservices: die Erfahrung von M.Video-Eldorado und MegaFon</a></li>
<li><a href="../de456194/index.html">Go Datenstrukturen Spickzettel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>