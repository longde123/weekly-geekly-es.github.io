<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöô üò° üëéüèæ Invitation dangereuse ou Fonctionnement de la charge de combat pour un e-mail de phishing üìÄ üí§ üòö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="R√©cemment, des sp√©cialistes PT ESC ont d√©couvert un document au format Publisher appel√© ¬´Invitation 29-30 novembre 2018.pub¬ª (1edd5b6a02ec82cec381c1a1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Invitation dangereuse ou Fonctionnement de la charge de combat pour un e-mail de phishing</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432172/"><img src="https://habrastorage.org/webt/hh/mj/f1/hhmjf18rranoihy6liikn8gvlq0.jpeg"><br><br>  R√©cemment, des sp√©cialistes PT ESC ont d√©couvert un document au format Publisher appel√© ¬´Invitation 29-30 novembre 2018.pub¬ª (1edd5b6a02ec82cec381c1a1ec74a67e).  Dans cet article, nous vous expliquerons comment un document d'aspect ordinaire se transforme en cheval de Troie, permettant √† un attaquant de capturer une image √† partir de webcams, d'enregistrer le son par commande ou lorsqu'une fen√™tre Skype est d√©tect√©e, d'ex√©cuter des scripts PowerShell, de prendre des captures d'√©cran, de copier des fichiers √† partir d'appareils multim√©dias. <a name="habracut"></a><br><br>  Ainsi, lorsque vous ouvrez le document, une fen√™tre appara√Æt avec un talon de document flou et une demande pour inclure le script Microsoft Publisher. <br><br><img src="https://habrastorage.org/webt/6z/gx/0e/6zgx0evgnzve3k9tdrjtlkqhvhe.png"><br><br>  Une fois que l'utilisateur l'a activ√©, le script int√©gr√© au document s'ex√©cute en JavaScript.  Cela ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/wt/ig/pt/wtigptknnjdcp4noozibkmcisci.png"><br><br>  Le r√©sultat du script sera le d√©codage de deux fichiers, PDF et EXE, √† partir de Base64.  Les deux fichiers seront √©crits dans C: \ Users \ {Username} \ AppData \ Roaming \ DBFUpdate.  En cons√©quence, les deux fichiers seront ex√©cut√©s et l'utilisateur verra un tel talon sur l'√©cran du document: <br><br><img src="https://habrastorage.org/webt/oc/az/v_/ocazv_kws7t4hvkhq4r5jpqw6xi.png"><br><br><h2>  Treasure Hunter RAT </h2><br>  Les attaquants utilisent un RAT multi-module avec un large √©ventail de fonctions qui fournit un acc√®s complet √† la machine infect√©e. <br><br>  Caract√©ristiques du code: <br><br><ol><li>  Enti√®rement √©crit en C ++ avec un grand nombre de constructions STL utilis√©es en interne. </li><li>  Application de la biblioth√®que boost, en particulier JSON et Archive. </li><li>  Fonctions de d√©bogage (plus dans la section sur le stager). </li></ol><br><h2>  Cheval de Troie principal </h2><br>  Le cheval de Troie principal est fix√© sur la machine de la victime et est une plate-forme sur laquelle des modules malveillants sont charg√©s √† partir de C2. <br><br>  Tout d'abord, stager initialise le r√©pertoire de travail, qui stockera ensuite les informations collect√©es par les modules, les utilitaires n√©cessaires au fonctionnement des modules, etc. <br><br><img src="https://habrastorage.org/webt/_h/qg/ba/_hqgbarp_rsej6ubiv1v8zuy32c.png"><br><br>  Ci-dessous se trouve l'initialisation des chemins de cr√©ation du r√©pertoire de travail: <br><br><img src="https://habrastorage.org/webt/78/tg/ot/78tgotzxv4jl_vrucszwktoaef4.png"><br><br>  Une fois les r√©pertoires n√©cessaires cr√©√©s, le cheval de Troie principal collecte des informations sur la machine infect√©e et les envoie au serveur de contr√¥le. <br><br>  Troyan s'int√©resse √† ces donn√©es: <br><br><ul><li>  identifiant de la version du syst√®me d'exploitation sur lequel le cheval de Troie principal s'ex√©cute; </li><li>  La langue d'interface par d√©faut </li><li>  Le num√©ro de version principal du Service Pack OS; </li><li>  nom d'ordinateur et identifiant de la machine (pour plus de d√©tails sur l'obtention d'un identifiant de machine, voir la section sur le protocole r√©seau). </li></ul><br>  Voici comment les informations sur la machine infect√©e sont collect√©es: <br><br><img src="https://habrastorage.org/webt/0n/rn/xn/0nrnxnxdov8bp85g6dmlwzzvwzs.png"><br><br>  Ensuite, le cheval de Troie principal est fix√© sur la machine infect√©e par la modification de la valeur dans le registre √† HKCU \ Environment \ UserInitMprLogonScript.  Il s'agit du nom du fichier ex√©cutable qui a √©t√© allou√© lors de l'initialisation du r√©pertoire de travail, dans ce cas il est √©gal √† "DCTHOST.exe".  Cette m√©thode est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©crite sur le blog Hexacorn</a> et a √©galement √©t√© utilis√©e par APT28 et le groupe Cobalt dans leur ComDLLDroper. <br><br><img src="https://habrastorage.org/webt/j3/tl/0g/j3tl0gm0n3zb3vzxfpps_abdgq0.png"><br><br>  Et la derni√®re √©tape de l'initialisation du cheval de Troie principal consiste √† copier le fichier ex√©cutable de son emplacement actuel vers le r√©pertoire de travail avec le m√™me nom qui a √©t√© s√©lectionn√© lors de l'initialisation du r√©pertoire de travail. <br><br>  Une fois le cheval de Troie principal initialis√©, la pr√©paration de la r√©ception des commandes est effectu√©e.  Le module Core est ajout√© √† la liste des modules en cours d'ex√©cution, qui est le principal cheval de Troie.  Ensuite, une commande est lanc√©e √† partir du module Core avec l'identifiant 0. Il n'y a pas d'impl√©mentation de cette commande dans le module principal, mais √† la place, c'est juste un stub.  Le constructeur de l'objet du module Core est pr√©sent√© ci-dessous. <br><br><img src="https://habrastorage.org/webt/mi/hy/us/mihyuspzzqd5fwesqr1em7jyiqu.png"><br><br>  √Ä la fin, deux threads commencent.  L'un des threads d√©marre une minuterie, qui se r√©veille par d√©faut toutes les secondes et essaie de demander une commande √† C2. <br><br><img src="https://habrastorage.org/webt/o9/53/um/o953um8yermaycyqre2jugxbzly.png"><br><br>  Le deuxi√®me flux charge des biblioth√®ques et des modules standard suppl√©mentaires.  Les biblioth√®ques, comme les modules, ont un identifiant, mais contrairement aux modules, les identifiants de biblioth√®que sont n√©gatifs, commencez par ‚Äì1, augmentez vers des nombres inf√©rieurs.  Vous trouverez ci-dessous une liste des biblioth√®ques t√©l√©charg√©es depuis C2. <br><br><img src="https://habrastorage.org/webt/8n/bl/pj/8nblpjayad6etstkkqxvwtaplts.png"><br><br><h2>  Fonctions de d√©bogage du cheval de Troie principal </h2><br>  Au tout d√©but de son travail, imm√©diatement apr√®s l'initialisation, le cheval de Troie principal d√©finit un gestionnaire d'exceptions via SetUnhandledExceptionFilter, qui contient des fonctionnalit√©s int√©ressantes.  Lorsque des exceptions se produisent, elles tombent dans le gestionnaire, qui √©crit le mini vidage de l'application, tout en enregistrant √©galement des informations sur l'exception.  Ensuite, il red√©marre.  Sur l'√©cran - cr√©ation d'un mini vidage: <br><br><img src="https://habrastorage.org/webt/1w/sw/3j/1wsw3jy1hd8wpgcvfw0yliwt_yy.png"><br><br><h2>  Protocole r√©seau </h2><br>  L'√©change entre le logiciel et C2 s'effectue √† l'aide d'un protocole binaire auto-√©crit.  Chaque message est d√©crit √† l'aide de BinPackage (nom tir√© de RTTI).  Chaque BinPackage est essentiellement un wrapper sur std :: vector, qui stocke l'ensemble PackageRecord (le nom est invent√©).  PackageRecord est l'unit√© minimale de stockage des donn√©es. <br><br><pre><code class="bash hljs">struct PackageRecord { _DWORD dataId; _DWORD datatype; _DWORD szData; char[] data; };</code> </pre> <br>  En savoir plus sur les domaines de cette structure: <br><br><ul><li>  <b>dataId</b> - indique le type d'enregistrement.  Soit l'entr√©e est un identifiant de module, soit un identifiant de commande, soit une charge utile. </li><li>  <b>szData</b> - la taille des donn√©es stock√©es dans l'enregistrement. </li><li>  <b>type de donn√©es</b> est un type de donn√©es. </li></ul><br>  Au total, l'utilisation de trois types de donn√©es a √©t√© enregistr√©e: <br><ul><li>  Une valeur de "0" signifie que les donn√©es stock√©es dans l'enregistrement doivent √™tre interpr√©t√©es comme un DWORD. </li><li>  La valeur "1" - les donn√©es stock√©es dans l'enregistrement doivent √™tre interpr√©t√©es comme une cha√Æne ASCIIZ. </li><li>  La valeur "2" - les donn√©es stock√©es dans l'enregistrement doivent √™tre interpr√©t√©es comme des donn√©es crypt√©es / tampon brut. </li></ul><br><br>  Lors de l'envoi de BinPackage au serveur de contr√¥le, l'identifiant de la machine lui est ajout√©.  L'identifiant est le GUID de la section √† partir de laquelle tous les caract√®res sp√©ciaux sont coup√©s.  Dans la figure - obtenir l'identifiant de la machine: <br><br><img src="https://habrastorage.org/webt/iw/kn/le/iwknleyhgrfk7tfu2fxiggdx_7w.png"><br><br>  Avant l'envoi, tous les enregistrements stock√©s dans BinPackage sont collect√©s s√©quentiellement dans un seul tampon et sont crypt√©s.  Pour le chiffrement, la biblioth√®que <a href="">WinAES</a> est <a href="">utilis√©e</a> , en particulier AES-128-CBC. <br><br>  √Ä l'aide de CryptoAPI Windows, deux tableaux pseudo-al√©atoires de 16 octets sont g√©n√©r√©s.  Un pour IV, l'autre pour la cl√©.  Le chiffrement est effectu√© et les donn√©es chiffr√©es sont ajout√©es √† BinPackage, qui contient le paquet chiffr√© et se compose de trois entr√©es: <br><br><ul><li>  enregistrement avec l'ID 0x777 - contient la cl√© utilis√©e pour le cryptage; </li><li>  enregistrement avec l'ID 0x555 - contient l'IV utilis√© pour le cryptage; </li><li>  enregistrement avec l'ID 0x999 - contient des donn√©es crypt√©es (en g√©n√©ral, un enregistrement avec cet ID indique une charge utile et est utilis√© non seulement pour stocker des donn√©es crypt√©es). </li></ul><br>  Une fois le processus de chiffrement termin√©, le BinPackage g√©n√©r√© est √† nouveau collect√© dans un seul tampon et envoy√© via une requ√™te HTTP POST au serveur de gestion 151.80.237.222. <br><br><img src="https://habrastorage.org/webt/zj/8b/dd/zj8bdd1d7hlb1ozmxarkmmkf60q.png"><br><br>  Voici un exemple de package contenant des informations sur la machine: <br><br><img src="https://habrastorage.org/webt/ma/gu/du/magudufvut9bwna3qk9g8atebju.png"><br><br>  Et ceci est un exemple de paquet chiffr√© avec des informations syst√®me: <br><br><img src="https://habrastorage.org/webt/tv/rm/0s/tvrm0sniivu5dxahli4lfnsnfwa.png"><br><br><h2>  Modules </h2><br>  Chaque module, √† l'exception de Core, est charg√© √† partir du serveur de contr√¥le.  Tous les modules peuvent √™tre divis√©s en deux cat√©gories: les modules charg√©s automatiquement et les modules charg√©s √† la demande du serveur de contr√¥le. <br><br>  Un exemple de package demandant un module: <br><br><img src="https://habrastorage.org/webt/zw/_o/mw/zw_omw8mqjoa74a0gouuylkgnk8.png"><br><br>  R√©ponse √† la demande de module: <br><br><img src="https://habrastorage.org/webt/9u/2g/qc/9u2gqcvb1mhw4kuky3fl6f1zljq.png"><br><br>  Chaque module poss√®de une interface simple compos√©e de trois fonctions: appel√©e lors du chargement du module Init, appel√©e lors de l'ach√®vement de fini, et une fonction qui modifie la configuration du module.  Chaque module a √©galement une exportation nomm√©e GetModule, qui construit un objet repr√©sentant ce module et le renvoie au cheval de Troie principal.  Tous les modules que nous avons d√©couverts sont lanc√©s en m√©moire par chargement r√©fl√©chissant. <br><br><img src="https://habrastorage.org/webt/p7/rz/qk/p7rzqkvwrfbybtduak7hfttchgy.png"><br><br>  De plus, les noms des modules sont donn√©s sous la forme dans laquelle ils sont pr√©sents dans RTTI en tant que noms de classe. <br><br><h2>  Module CCore </h2><br>  Ce module repr√©sente les fonctionnalit√©s de base et est int√©gr√© directement dans le cheval de Troie principal.  Son constructeur peut √™tre vu dans le tableau ci-dessous: <br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="6">  0 </td><td>  0 </td><td>  Fondamentalement, un cheval de Troie au lieu d'une commande est un talon, et son objectif exact n'a pas pu √™tre √©tabli </td></tr><tr><td>  1 </td><td>  Modifier la configuration du module </td></tr><tr><td>  2 </td><td>  Demander des informations sur l'ordinateur </td></tr><tr><td>  3 </td><td>  T√©l√©chargez l'utilitaire depuis le serveur de contr√¥le </td></tr><tr><td>  4 </td><td>  Demander la liste d'un r√©pertoire contenant des utilitaires </td></tr><tr><td>  5 </td><td>  T√©l√©chargez le module et ex√©cutez-le </td></tr></tbody></table><br><h2>  Module CShell </h2><br>  Ce module fournit un shell distant √† une machine infect√©e.  Lorsque le module est initialis√©, le processus cmd.exe est cr√©√©, auquel deux tuyaux sont attach√©s: un pour l'entr√©e standard et un pour la sortie standard, via lesquels les commandes sont re√ßues et transmises depuis le serveur de contr√¥le et vice versa.  √âgalement √† ce moment, un thread d√©marre, qui prend automatiquement toute la sortie et l'envoie au serveur de contr√¥le.  La figure montre l'initialisation du module CShell. <br><br><img src="https://habrastorage.org/webt/73/g3/6v/73g36vgr-tbimku5nrr-x1r8l1u.png"><br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="4">  2 </td><td>  0 </td><td>  Envoyer la commande au shell </td></tr><tr><td>  1 </td><td>  Imprimez le fichier.  Un fichier est lu, dont le chemin est transmis depuis le serveur de contr√¥le, et le contenu de ce fichier est t√©l√©charg√© sur le serveur de contr√¥le </td></tr><tr><td>  2 </td><td>  Obtenez une liste de tous les disques existants dans le syst√®me.  Les donn√©es sont envoy√©es au serveur de contr√¥le au format JSON </td></tr><tr><td>  3 </td><td>  T√©l√©chargez le fichier depuis le serveur de contr√¥le.  Le chemin o√π enregistrer le fichier et les donn√©es sont re√ßues du serveur de contr√¥le </td></tr></tbody></table><br><h2>  Module CFileSystemBrowser </h2><br>  Il s'agit d'un module passif qui, sur demande, vous permet de recevoir des informations sur la structure du syst√®me de fichiers.  Voici comment l'initialisation du module CFileSystemBrowser se produit: <br><br><img src="https://habrastorage.org/webt/sm/as/pn/smaspn0xpx9jmukbwfsupllke88.png"><br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="4">  3 </td><td>  0 </td><td>  Obtenez une liste de tous les disques existants dans le syst√®me.  Les donn√©es sont envoy√©es √† C2 au format JSON </td></tr><tr><td>  1 </td><td>  Obtenez la liste des r√©pertoires.  La liste est g√©n√©r√©e au format JSON </td></tr><tr><td>  2 </td><td>  Imprimez le fichier.  Un fichier est lu, dont le chemin est transf√©r√© depuis C2 et le contenu de ce fichier est t√©l√©charg√© vers C2 </td></tr><tr><td>  3 </td><td>  Supprimer le fichier.  Le chemin d'acc√®s au fichier est transf√©r√© depuis C2 </td></tr></tbody></table><br><h2>  Module CScreenShot </h2><br>  Ce module vous permet de prendre des captures d'√©cran ou de capturer des images √† partir d'une webcam.  Il peut le faire √† la fois sur demande et avec une p√©riode sp√©cifique dans la minuterie. <br><img src="https://habrastorage.org/webt/nw/km/qg/nwkmqgynrgbuywc05kwjrvkq1ye.png"><br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="4">  4 </td><td>  0 </td><td>  Prenez une capture d'√©cran et envoyez-la au serveur de contr√¥le </td></tr><tr><td>  1 </td><td>  Ex√©cutez une minuterie, apr√®s quoi une capture d'√©cran est prise √† partir de l'√©cran de la machine.  Les captures d'√©cran r√©sultantes sont emball√©es dans BinPackage et enregistr√©es dans le dossier des journaux.  Les noms des fichiers sont g√©n√©r√©s √† l'aide de l'API GetTempFileName avec le pr√©fixe ¬´MS_¬ª. </td></tr><tr><td>  2 </td><td>  Obtenez des vid√©os des appareils disponibles sur une machine infect√©e </td></tr><tr><td>  3 </td><td>  Capturez un cadre de la webcam et envoyez-le au serveur de contr√¥le </td></tr></tbody></table><br><h2>  Module CSender </h2><br>  Ce module n'est pas initialement activ√©.  Il t√©l√©charge le contenu du dossier logs sur le serveur de contr√¥le.  Il est activ√© lorsqu'une demande de modification de la configuration contient la p√©riode de v√©rification. <br><br><img src="https://habrastorage.org/webt/wd/64/0e/wd640e65m5umn66eyqrg1vuwolu.png"><br><br><h2>  Module CKeylogger </h2><br>  Ce module n'est pas non plus activ√© initialement.  Il est activ√© lorsqu'une demande de modification de configuration arrive contenant la taille du tampon dans lequel le journal est stock√©.  L'interception des entr√©es est effectu√©e via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rawinput</a> .  De plus, l'enregistreur de frappe surveille la fen√™tre dans laquelle l'utilisateur effectue une entr√©e et enregistre son titre. <br><br><img src="https://habrastorage.org/webt/wu/ek/r6/wuekr6dftcwhuubqmce3h5n49vg.png"><br><br><h2>  Module CDictaphone </h2><br>  Ce module enregistre le son par commande ou lors de la d√©tection d'une fen√™tre Skype.  Une fois lanc√©, il d√©marre un thread qui r√©pertorie toutes les fen√™tres et leurs fen√™tres enfants dans le syst√®me et recherche la fen√™tre parmi les classes dont le nom de classe est TLiveConversation ou TCallMonitorControl.  Si une telle fen√™tre a √©t√© trouv√©e, l'enregistrement d√©marre.  Ci-dessous, l'initialisation du module CDictaphone: <br><br><img src="https://habrastorage.org/webt/y7/kq/e0/y7kqe0xqb1lytearyqn--ojslpu.png"><br><br>  Et recherche de fen√™tre Skype <br><br><img src="https://habrastorage.org/webt/6j/49/br/6j49brec889qzpw8hqqd0mjo-5g.png"><br><br>  L'enregistrement se fait via le MCI en envoyant des commandes sp√©ciales.  Voici √† quoi ressemble le cycle d'√©criture du module CDictaphone: <br><br><img src="https://habrastorage.org/webt/nh/ef/zk/nhefzkr0smgjs0xpnabh9oglqzy.png"><br><br>  Apr√®s avoir ferm√© la fen√™tre ou re√ßu une commande pour terminer l'enregistrement, les donn√©es re√ßues sont enregistr√©es dans un dossier temporaire, apr√®s quoi elles sont encod√©es par l'encodeur MP3 boiteux (il est consid√©r√© comme un utilitaire et devrait d√©j√† √™tre charg√©, il n'a pas √©t√© possible de les obtenir du serveur de contr√¥le).  Le fichier encod√© est enregistr√© dans le dossier logs.  La g√©n√©ration d'un nom de dossier est similaire √† la g√©n√©ration de noms pour les captures d'√©cran. <br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="3">  7 </td><td>  0 </td><td>  Commencez l'enregistrement et terminez-le apr√®s 15 minutes </td></tr><tr><td>  1 </td><td>  Arr√™ter l'enregistrement </td></tr><tr><td>  2 </td><td>  V√©rifier l'√©tat: l'enregistrement est en cours </td></tr></tbody></table><br><h2>  Module CProcessesManager </h2><br>  Il s'agit d'un module passif, capable de renvoyer une liste de processus sur demande ou de se terminer par le PID qui lui est transmis. <br><br><img src="https://habrastorage.org/webt/us/if/sf/usifsfffgu9i_sfbbus6xc5_ch4.png"><br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="2">  8 </td><td>  0 </td><td>  Renvoie une liste de processus: leurs noms, PID et le nom de l'utilisateur propri√©taire du processus. </td></tr><tr><td>  1 </td><td>  Ach√®vement du processus PID </td></tr></tbody></table><br><h2>  Module CDownloader </h2><br>  Le module est con√ßu pour t√©l√©charger des fichiers volumineux sur le serveur de contr√¥le.  Effectue la transmission de donn√©es par morceaux, dont la taille est √©tablie par sa configuration.  Le module lit les donn√©es d'un fichier, le chemin vers lequel il re√ßoit du serveur de contr√¥le, et emballe des morceaux dans BinPackage.  Pour chaque BinPackage contenant le bloc, une entr√©e avec l'identifiant 0x888 est ajout√©e, y compris le chemin d'acc√®s au fichier.  Apr√®s avoir pass√© chaque morceau, le sommeil est effectu√© pendant 5 secondes. <br><img src="https://habrastorage.org/webt/ch/-1/wj/ch-1wjtsdqiwbglodlmf25cp3om.png"><br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td rowspan="3">  9 </td><td>  0 </td><td>  Stub, impossible de d√©finir la valeur exacte </td></tr><tr><td>  1 </td><td>  Il transf√®re une grande quantit√© de donn√©es (0x500000 octets), apr√®s quoi il mesure le temps pass√© sur la transmission et envoie cette valeur √† C2 </td></tr><tr><td>  2 </td><td>  T√©l√©charger un fichier depuis une machine </td></tr></tbody></table><br><h2>  Module CPS </h2><br>  Ce module vous permet d'ex√©cuter des scripts PowerShell. <br><br><img src="https://habrastorage.org/webt/ua/nn/vn/uannvn5wtvk7p2jnfaz6exur2ia.png"><br><table><tbody><tr><th width="100">  Identifiant du module </th><th width="100">  ID d'√©quipe </th><th>  La description </th></tr><tr><td>  10 </td><td>  0 </td><td>  Re√ßoit un script PowerShell de C2 et l'ex√©cute </td></tr></tbody></table><br><h2>  Module CDeviceMonitor </h2><br>  Un module passif qui surveille les p√©riph√©riques multim√©dias connect√©s et copie des fichiers √† partir d'eux.  Il utilise les messages de diffusion WM_DEVICECHANGE pour d√©tecter la connectivit√© du p√©riph√©rique.  Apr√®s avoir connect√© l'appareil au serveur de contr√¥le, des informations sont envoy√©es sur le moment o√π l'appareil a √©t√© connect√©, son √©tiquette de volume et le chemin d'acc√®s √† l'appareil.  Le code utilis√© pour obtenir le chemin vers le p√©riph√©rique est tr√®s similaire √† celui-ci.  Tous les fichiers sont copi√©s dans le dossier logs.  Les noms sont g√©n√©r√©s de la m√™me mani√®re que pour les captures d'√©cran.  Le fichier fsIndex.dat est cr√©√© s√©par√©ment, dans lequel se trouve le dictionnaire s√©rialis√© avec boost :: archive.  Ce dictionnaire stocke les chemins d'origine vers les fichiers qui ont √©t√© copi√©s et leurs hachages MD5.  Vous trouverez ci-dessous la r√©ception de DevicePath: <br><br><img src="https://habrastorage.org/webt/3y/k0/ap/3yk0apdk8elf3rhhjqnsako0zne.png"><br><br>  En √©pilogue, plusieurs recommandations: <br><br><ul><li>  Pas besoin d'ouvrir les pi√®ces jointes dans les lettres de destinataires inconnus, et encore moins d'inclure un script Microsoft Publisher. </li><li>  Il n'est pas moins dangereux de cliquer sur les liens dans les lettres des exp√©diteurs inconnus.  Le site o√π vous allez peut h√©berger des logiciels malveillants qui seront automatiquement t√©l√©charg√©s sur votre PC. </li><li>  Vous devez r√©guli√®rement mettre √† jour le logiciel, en particulier Microsoft Windows et Microsoft Office, ce qui fermera l'acc√®s √† un large √©ventail de logiciels malveillants. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432172/">https://habr.com/ru/post/fr432172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432160/index.html">Vid√©o d'Android Kolesa Mobile: sur le d√©veloppement modulaire, l'interface utilisateur pilot√©e par le backend et l'int√©gration continue</a></li>
<li><a href="../fr432162/index.html">¬´Nous essayons de raconter des histoires r√©elles¬ª: √† propos du programme Heisenbug 2018 Moscou</a></li>
<li><a href="../fr432166/index.html">Apache NiFi: de quoi s'agit-il et un bref aper√ßu des fonctionnalit√©s</a></li>
<li><a href="../fr432168/index.html">Les autorit√©s chinoises collectent des informations sur les v√©hicules √©lectriques des citoyens du pays</a></li>
<li><a href="../fr432170/index.html">Transportez un centre de donn√©es en 14 400 secondes</a></li>
<li><a href="../fr432174/index.html">Comment d√©velopper avec comp√©tence et efficacit√© un produit logiciel</a></li>
<li><a href="../fr432176/index.html">Comment nous avons doubl√© la vitesse de travail avec Float en Mono</a></li>
<li><a href="../fr432178/index.html">... et une garantie pour les projecteurs - augmenter</a></li>
<li><a href="../fr432180/index.html">Comment pomper votre carri√®re via GitHub</a></li>
<li><a href="../fr432182/index.html">Nous r√©cup√©rons le courrier sans sms ni inscription</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>