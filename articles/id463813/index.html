<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🆖 ☪️ 📇 Multivan dan perutean pada Mikrotik RouterOS 🙆🏻 🥨 🏈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dengan koreksi dan penambahan 02/11/2020 
 Pendahuluan 
 Selain kesombongan, frekuensi pertanyaan yang menyedihkan tentang topik ini dalam kelompok-ke...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Multivan dan perutean pada Mikrotik RouterOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463813/">  Dengan koreksi dan penambahan 02/11/2020 <br><h4>  Pendahuluan </h4><br>  Selain kesombongan, frekuensi pertanyaan yang menyedihkan tentang topik ini dalam kelompok-kelompok yang relevan dari komunitas telegram berbahasa Rusia mendorong saya untuk mengambil artikel itu.  Artikel ini ditujukan untuk administrator pemula Mikrotik RouterOS (selanjutnya disebut ROS).  Itu hanya mempertimbangkan multivan, dengan penekanan pada routing.  Bonus mencakup pengaturan yang memadai minimal untuk memastikan operasi yang aman dan nyaman.  Mereka yang mencari pengungkapan antrian tersebut, penyeimbangan muatan, vlan, jembatan, analisis mendalam multi-tahap tentang kondisi saluran dan sejenisnya - tidak dapat membuang waktu dan upaya membaca. <br><a name="habracut"></a><br><h4>  Sumber data </h4><br>  Sebagai subjek uji, router lima port Mikrotik dengan ROS versi 6.45+ dipilih.  Ini akan merutekan lalu lintas antara dua jaringan area lokal (LAN1 dan LAN2) dan tiga penyedia (ISP1, ISP2, ISP3).  Saluran ke ISP1 memiliki alamat "abu-abu" statis, ISP2 adalah "putih" diterima melalui DHCP, ISP3 adalah "putih" dengan otentikasi PPPoE.  Diagram koneksi ditunjukkan pada gambar: <br><br><img src="https://habrastorage.org/webt/pd/di/mv/pddimv_vbwqmityow2oe2oxngam.jpeg"><br><br>  Tugasnya adalah mengkonfigurasi router MTK berdasarkan skema sehingga: <br><br><ol><li>  Berikan peralihan otomatis ke penyedia cadangan.  Penyedia utama adalah ISP2, cadangan pertama adalah ISP1, cadangan kedua adalah ISP3. </li><li>  Untuk mengatur akses LAN1 ke Internet hanya melalui ISP1. </li><li>  Memberikan kemampuan untuk merutekan lalu lintas dari jaringan lokal ke Internet melalui penyedia yang dipilih berdasarkan daftar alamat. </li><li>  Untuk memberikan kemungkinan layanan penerbitan dari jaringan area lokal ke Internet (DSTNAT) </li><li>  Konfigurasikan filter firewall untuk memberikan keamanan minimum yang cukup dari Internet. </li><li>  Router dapat mengeluarkan traffic sendiri melalui salah satu dari tiga penyedia, tergantung pada alamat sumber yang dipilih. </li><li>  Berikan perutean paket respons ke saluran asal mereka (termasuk LAN). </li></ol><br>  <i><b>Komentar.</b></i>  <i>Kami akan mengonfigurasi perute “dari awal” untuk menjamin bahwa tidak ada kejutan dalam memulai konfigurasi “di luar kotak” yang berubah dari versi ke versi.</i>  <i>Winbox dipilih sebagai alat konfigurasi, di mana perubahan akan ditampilkan secara visual.</i>  <i>Pengaturan itu sendiri akan diatur oleh perintah di terminal Winbox.</i>  <i>Koneksi fisik untuk konfigurasi adalah melalui koneksi langsung ke antarmuka Ether5.</i> <br><br><h4>  Sebuah diskusi kecil tentang apa multivan itu, apakah itu masalah atau orang pintar yang cerdik menenun jaringan konspirasi di sekitar </h4><br>  Admin yang ingin tahu dan penuh perhatian, yang mengatur skema ini atau itu sendiri, tiba-tiba tiba-tiba menyadari bahwa itu berfungsi secara normal.  Ya, ya, tanpa tabel perutean kustom Anda dan aturan rute lainnya, yang penuh dengan sebagian besar artikel tentang topik ini.  Lihat itu? <br><br>  Bisakah kita mengonfigurasi pengalamatan pada antarmuka dan gateway default?  Ya: <br><br>  Alamat dan gateway dengan <b>distance = 2</b> dan <b>check-gateway = ping</b> terdaftar di ISP1 <b>.</b> <br>  Pada ISP2, pengaturan default dhcp untuk klien adalah jarak, masing-masing, sama dengan satu. <br>  Pada ISP3 dalam pengaturan pppoe klien dengan <b>add-default-route = yes</b> set <b>default-route-distance = 3</b> . <br><br>  Jangan lupa mendaftarkan NAT untuk hasilnya: <br><br>  <b>/ ip firewall nat add action = rantai masquerade = srcnat out-interface-list = WAN</b> <br><br>  Akibatnya, pengguna LAN bersenang-senang seal dimuat melalui penyedia ISP2 utama dan ada reservasi saluran menggunakan mekanisme <b>gateway check</b> <sup>. Lihat Catatan 1</sup> <br><br>  Poin 1 dari tugas diimplementasikan.  Di mana multivan dengan tag-nya?  Tidak ... <br><br>  Lebih jauh  Anda perlu melepaskan klien tertentu dari LAN melalui ISP1: <br><br>  <b>/ ip firewall mangle add action = rute rantai = prerouting dst-address-list =! BOGONS \</b> <b><br></b>  <b>passthrough = ya route-dst = 100.66.66.1 src-address-list = Via_ISP1</b> <b><br></b>  <b>/ ip firewall mangle add action = rute rantai = prerouting dst-address-list =! BOGONS \</b> <b><br></b>  <b>passthrough = tidak ada rute-dst = 100.66.66.1 src-address = 192.168.88.0 / 24</b> <br><br>  Item 2 dan 3 dari tugas diimplementasikan.  Tag, perangko, aturan rute, di mana Anda?! <br><br>  Perlu memberikan akses ke server OpenVPN favorit Anda dengan alamat 172.17.17.17 untuk klien dari Internet?  Tolong: <br><br>  <b>/ ip cloud set ddns-enabled = yes</b> <br><br>  Kami memberikan hasil keluaran kepada klien sebagai sebuah pesta: " <b>: masukkan [ip cloud get dns-name]</b> " <br><br>  Kami mendaftarkan penerusan port dari Internet: <br><br>  <b>/ ip firewall nat tambahkan aksi = dst-nat chain = dstnat dst-port = 1194 \</b> <b><br></b>  <b>dalam-antarmuka-daftar = protokol WAN = udp ke-address = 172.17.17.17</b> <br><br>  Poin 4 sudah siap. <br><br>  Kami menyiapkan firewall dan keamanan lainnya untuk poin 5, pada saat yang sama kami senang bahwa semuanya berfungsi untuk pengguna dan meraih wadah dengan minuman favorit ... <br>  Ah!  Terowongan masih dilupakan. <br><br>  Klien l2tp yang dikonfigurasi sesuai dengan artikel yang di-google naik ke VDS Belanda tercinta?  Ya <br>  l2tp-server dengan IPsec rose dan klien dengan nama DNS dari IP Cloud (lihat di atas.) menempel?  Ya <br>  Bersandar, menyesap minuman, kami iseng memeriksa item 6 dan 7 dari masalahnya.  Kami pikir - apakah kami membutuhkannya?  Semuanya berfungsi seperti itu ... Jadi, jika itu tidak perlu, itu saja.  Multivan diimplementasikan. <br><br>  <b>Apa itu multivan?</b>  <b>Ini adalah koneksi beberapa saluran Internet ke satu router.</b> <br><br>  Anda tidak dapat membaca artikel lebih lanjut, karena apa yang bisa ada selain pamer penerapan diragukan? <br><br>  Dengan mereka yang tetap, yang tertarik pada poin 6 dan 7 dari tugas, dan juga merasakan gatal perfeksionisme, kami menyelam lebih dalam. <br><br>  Tugas paling penting dalam mengimplementasikan multivan adalah perutean lalu lintas yang benar.  Yaitu: terlepas dari mana (atau yang) <sup>Lihat Catatan 3,</sup> saluran penyedia melihat rute default pada router kami, itu harus mengembalikan jawaban tepat ke saluran dari mana paket itu berasal.  Tugasnya jelas.  Di mana masalahnya?  Memang, dalam jaringan lokal yang sederhana tugasnya sama, tetapi tidak ada yang mengganggu dengan pengaturan tambahan dan tidak merasa kesulitan.  Perbedaannya adalah bahwa setiap node yang dirutekan di Internet dapat diakses melalui masing-masing saluran kami, dan tidak melalui yang sangat spesifik, seperti pada LAN sederhana.  Tetapi "masalahnya" adalah bahwa jika kami menerima permintaan untuk alamat IP ISP3, maka dalam kasus kami jawabannya akan melalui saluran ISP2, karena gateway default diarahkan ke sana.  Itu akan pergi dan dibuang oleh penyedia sebagai salah.  Kami memutuskan masalahnya.  Bagaimana cara mengatasinya? <br><br>  Solusinya dibagi menjadi tiga tahap: <br><br><ol><li>  <b>Pra-konfigurasi</b>  Pada tahap ini, pengaturan dasar router akan ditetapkan: jaringan lokal, firewall, daftar alamat, hairpin NAT, dll. </li><li>  <b>Multivan.</b>  Pada tahap ini, koneksi yang diperlukan akan ditandai dan diurutkan sesuai dengan tabel routing. </li><li>  <b>Koneksi ke ISP.</b>  Pada tahap ini, antarmuka yang menyediakan koneksi Internet akan dikonfigurasikan, perutean dan mekanisme reservasi saluran Internet akan dilibatkan. </li></ol><br>  <i><b>Komentar.</b></i>  <i>Tiga jenis koneksi ke ISP dipilih secara khusus untuk menunjukkan bahwa tidak ada yang tidak dapat diselesaikan dalam mengatur multivan dengan alamat dinamis dan menunjukkan salah satu opsi solusi.</i> <br>  <u><b>Penting!</b></u>  Untuk berpindah saluran sesuai dengan algoritma yang ditentukan menggunakan biaya rute <b>jarak</b> , mekanisme <b>check gateway</b> digunakan <b>.</b>  <sup>Lihat catatan 1</sup> <br>  Skrip yang diberikan dalam artikel tidak ada hubungannya dengan reservasi saluran. <br><br><h4>  1. Preset </h4><br>  1.1.  Kami menghapus konfigurasi router dengan perintah: <br><br><pre><code class="plaintext hljs">/system reset-configuration skip-backup=yes no-defaults=yes</code> </pre> <br>  setuju dengan “ <b>Berbahaya!</b>  <b>Setel ulang?</b>  <b>[y / T]:</b> ”dan, setelah reboot, kami terhubung ke Winbox melalui MAC.  Pada tahap ini, konfigurasi dan basis pengguna dihapus. <br><br>  1.2.  Buat pengguna baru: <br><br><pre> <code class="plaintext hljs">/user add group=full name=knight password=ultrasecret comment="Not horse"</code> </pre> <br>  login di bawahnya dan hapus default: <br><br><pre> <code class="plaintext hljs">/user remove admin</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Ini adalah penghapusan dan bukan pemutusan dari pengguna default yang penulis anggap lebih aman dan merekomendasikan untuk digunakan.</i> <br><br>  1.3.  Kami membuat daftar antarmuka dasar untuk kenyamanan beroperasi di firewall, pengaturan penemuan dan server MAC lainnya: <br><br><pre> <code class="plaintext hljs">/interface list add name=WAN comment="For Internet" /interface list add name=LAN comment="For Local Area"</code> </pre> <br>  Kami menandatangani antarmuka dengan komentar <br><br><pre> <code class="plaintext hljs">/interface ethernet set ether1 comment="to ISP1" /interface ethernet set ether2 comment="to ISP2" /interface ethernet set ether3 comment="to ISP3" /interface ethernet set ether4 comment="to LAN1" /interface ethernet set ether5 comment="to LAN2"</code> </pre> <br>  dan isi daftar antarmuka: <br><br><pre> <code class="plaintext hljs">/interface list member add interface=ether1 list=WAN comment=ISP1 /interface list member add interface=ether2 list=WAN comment=ISP2 /interface list member add interface=ether3 list=WAN comment="to ISP3" /interface list member add interface=ether4 list=LAN comment="LAN1" /interface list member add interface=ether5 list=LAN comment="LAN2"</code> </pre><br>  <i><b>Komentar.</b></i>  <i>Menulis komentar yang jelas sepadan dengan waktu yang dihabiskan untuk ini plus sangat memudahkan Troubleshoot dan memahami konfigurasi.</i> <i><br><br></i>  <i>Penulis menganggap perlu, untuk alasan keamanan, untuk menambahkan antarmuka ether3 ke daftar antarmuka "WAN", meskipun pada kenyataannya protokol ip tidak akan melewatinya.</i> <i><br><br></i>  <i>Jangan lupa bahwa setelah antarmuka PPP dinaikkan pada ether3, itu juga perlu ditambahkan ke daftar antarmuka "WAN"</i> <br><br>  1.4.  Kami menyembunyikan router dari deteksi kedekatan dan kontrol dari jaringan penyedia oleh MAC: <br><br><pre> <code class="plaintext hljs">/ip neighbor discovery-settings set discover-interface-list=!WAN /tool mac-server set allowed-interface-list=LAN /tool mac-server mac-winbox set allowed-interface-list=LAN</code> </pre> <br>  1.5.  Kami membuat seperangkat aturan filter firewall minimum yang cukup untuk melindungi router: <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=accept chain=input \ comment="Related Established Untracked Allow" \ connection-state=established,related,untracked</code> </pre> <br>  (aturan tersebut memberikan izin untuk koneksi yang dibuat dan yang terkait yang dimulai dari jaringan yang terhubung dan oleh router itu sendiri) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=accept chain=input \ comment="ICMP from ALL" protocol=icmp</code> </pre> <br>  (ping dan bukan hanya ping. Semua icmp diizinkan masuk. Sangat berguna untuk menemukan masalah dengan MTU) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=drop chain=input comment="All other WAN Drop" \ in-interface-list=WAN</code> </pre> <br>  (aturan yang menutup rantai input melarang segala hal lain yang datang dari Internet) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=accept chain=forward \ comment="Established, Related, Untracked allow" \ connection-state=established,related,untracked</code> </pre> <br>  (aturan tersebut memungkinkan koneksi yang dibuat dan terkait yang melewati router) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=drop chain=forward comment="Invalid drop" \ connection-state=invalid</code> </pre> <br>  (aturan menjatuhkan koneksi, dengan koneksi-state = tidak valid, melewati router. Ini sangat direkomendasikan oleh Mikrotik, tetapi dalam beberapa situasi yang jarang dapat memblokir lalu lintas yang berguna) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=drop chain=forward \ comment="Drop all from WAN not DSTNATed" connection-nat-state=!dstnat \ connection-state=new in-interface-list=WAN</code> </pre> <br>  (aturan tersebut melarang paket yang pergi dari Internet dan tidak melalui prosedur dstnat melalui router. Ini akan melindungi jaringan lokal dari penyusup yang, yang berada dalam domain siaran yang sama dengan jaringan eksternal kami, akan mendaftarkan IP eksternal kami sebagai gateway dan, dengan demikian, mencoba "Jelajahi" jaringan area lokal kami.) <br><br>  <i><b>Komentar.</b></i>  <i>Mari kita asumsikan bahwa LAN1 dan LAN2 adalah jaringan tepercaya dan lalu lintas di antara mereka dan dari mereka tidak disaring.</i> <br><br>  1.6.  Buat daftar dengan daftar jaringan non-routable: <br><br><pre> <code class="plaintext hljs">/ip firewall address-list add address=0.0.0.0/8 comment="\"This\" Network" list=BOGONS add address=10.0.0.0/8 comment="Private-Use Networks" list=BOGONS add address=100.64.0.0/10 comment="Shared Address Space. RFC 6598" list=BOGONS add address=127.0.0.0/8 comment=Loopback list=BOGONS add address=169.254.0.0/16 comment="Link Local" list=BOGONS add address=172.16.0.0/12 comment="Private-Use Networks" list=BOGONS add address=192.0.0.0/24 comment="IETF Protocol Assignments" list=BOGONS add address=192.0.2.0/24 comment=TEST-NET-1 list=BOGONS add address=192.168.0.0/16 comment="Private-Use Networks" list=BOGONS add address=198.18.0.0/15 comment="Network Interconnect Device Benchmark Testing"\ list=BOGONS add address=198.51.100.0/24 comment=TEST-NET-2 list=BOGONS add address=203.0.113.0/24 comment=TEST-NET-3 list=BOGONS add address=224.0.0.0/4 comment=Multicast list=BOGONS add address=192.88.99.0/24 comment="6to4 Relay Anycast" list=BOGONS add address=240.0.0.0/4 comment="Reserved for Future Use" list=BOGONS add address=255.255.255.255 comment="Limited Broadcast" list=BOGONS</code> </pre> <br>  (Ini adalah daftar alamat dan jaringan yang tidak dialihkan ke Internet dan, karenanya, kami juga akan mengikuti ini.) <br><br>  <i><b>Komentar.</b></i>  <i>Daftar ini dapat berubah, jadi saya menyarankan Anda untuk memeriksa relevansinya secara berkala.</i> <br><br>  1.7.  Konfigurasikan DNS untuk router itu sendiri: <br><br><pre> <code class="plaintext hljs">/ip dns set servers=1.1.1.1,8.8.8.8</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Dalam versi ROS saat ini, server dinamis lebih diutamakan daripada yang ditentukan secara statis.</i>  <i>Permintaan resolusi nama dikirim ke server pertama dalam urutan dalam daftar.</i>  <i>Transisi ke server berikutnya terjadi ketika yang saat ini tidak tersedia.</i>  <i>Batas waktu besar - lebih dari 5 detik.</i>  <i>Kembali kembali ketika "server yang jatuh" dilanjutkan kembali tidak secara otomatis terjadi.</i>  <i>Dengan algoritma ini dan keberadaan multivan, penulis merekomendasikan untuk tidak menggunakan server yang dikeluarkan oleh penyedia.</i> <br><br>  1.8.  Konfigurasikan jaringan lokal. <br>  1.8.1.  Konfigurasikan alamat IP statis pada antarmuka LAN: <br><br><pre> <code class="plaintext hljs">/ip address add interface=ether4 address=192.168.88.254/24 comment="LAN1 IP" /ip address add interface=ether5 address=172.16.1.0/23 comment="LAN2 IP"</code> </pre> <br>  1.8.2.  Kami menetapkan aturan untuk rute ke jaringan lokal kami melalui tabel perutean utama: <br><br><pre> <code class="plaintext hljs">/ip route rule add dst-address=192.168.88.0/24 table=main comment="to LAN1" /ip route rule add dst-address=172.16.0.0/23 table=main comment="to LAN2"</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Ini adalah salah satu cara termudah dan tercepat untuk mengakses alamat jaringan lokal dengan alamat IP eksternal dari antarmuka router di mana rute default tidak pergi.</i> <br><br>  1.8.3.  Jika perlu, aktifkan Hairpin NAT untuk LAN1 dan LAN2: <br><br><pre> <code class="plaintext hljs">/ip firewall nat add action=src-nat chain=srcnat comment="Hairpin to LAN1" \ out-interface=ether4 src-address=192.168.88.0/24 to-addresses=192.168.88.254 /ip firewall nat add action=src-nat chain=srcnat comment="Hairpin to LAN2" \ out-interface=ether5 src-address=172.16.0.0/23 to-addresses=172.16.1.0</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Ini memungkinkan pengguna dari LAN1 dan LAN2 untuk mengakses melalui IP eksternal (dstnat) ke server yang terletak dengan pengguna di segmen jaringan yang sama.</i> <br><br><h4>  2. Sebenarnya, implementasi multivan yang benar </h4><br>  Untuk mengatasi masalah "menjawab dari tempat mereka bertanya", kami akan menggunakan dua alat ROS: <b>tanda koneksi</b> dan <b>tanda rute</b> .  <b>Tanda koneksi</b> memungkinkan Anda menandai koneksi yang diinginkan dan terus bekerja dengan label ini sebagai syarat untuk menerapkan <b>tanda rute</b> .  Dan sudah dengan <b>tanda rute</b> mungkin untuk bekerja di <b>ip route</b> dan <b>aturan rute</b> .  Kami menemukan alatnya, sekarang kami harus memutuskan koneksi mana yang akan ditandai - satu, di mana tepatnya untuk menandai - dua. <br><br>  Dengan yang pertama, semuanya sederhana - kita harus menandai semua koneksi yang datang ke router dari Internet melalui saluran yang sesuai.  Dalam kasus kami, ini akan menjadi tiga label (sesuai dengan jumlah saluran): "conn_isp1", "conn_isp2" dan "conn_isp3". <br><br>  Nuansa dengan yang kedua adalah bahwa koneksi yang masuk akan dari dua jenis: transit dan yang ditujukan untuk router itu sendiri.  Mekanisme tanda koneksi berfungsi di tabel <b>mangle</b> .  Pertimbangkan pergerakan paket pada diagram yang disederhanakan, silakan dikumpulkan oleh spesialis sumber mikrotik-trainings.com (bukan iklan): <br><br><img src="https://habrastorage.org/webt/gg/yc/u4/ggycu4_z4ps93z-crahvri9pshw.jpeg"><br><br>  Mengikuti panah, kita melihat bahwa paket yang tiba di " <b>antarmuka input</b> " melewati rantai " <b>Prerouting</b> " dan hanya kemudian dibagi menjadi transit dan lokal di blok " <b>Keputusan Routing</b> ".  Oleh karena itu, untuk membunuh dua burung dengan satu batu, gunakan <b>Tanda Koneksi</b> di tabel <b>Prerouting Mangle</b> dari rantai <b>Prerouting</b> . <br><br>  <i><b>Komentar</b> .</i>  <i>Dalam ROS, label "Tanda perutean" ditunjukkan di bagian Ip / Rute / Aturan sebagai "Tabel", dan di bagian lainnya sebagai "Tanda Perutean".</i>  <i>Ini dapat menyebabkan beberapa kebingungan dalam pemahaman, tetapi, pada kenyataannya, itu adalah satu dan sama, dan merupakan analog dari rt_tables di iproute2 di linux.</i> <br><br>  2.1.  Kami menandai koneksi yang masuk dari masing-masing penyedia: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-connection chain=prerouting \ comment="Connmark in from ISP1" connection-mark=no-mark in-interface=ether1 \ new-connection-mark=conn_isp1 passthrough=no /ip firewall mangle add action=mark-connection chain=prerouting \ comment="Connmark in from ISP2" connection-mark=no-mark in-interface=ether2 \ new-connection-mark=conn_isp2 passthrough=no /ip firewall mangle add action=mark-connection chain=prerouting \ comment="Connmark in from ISP3" connection-mark=no-mark in-interface=pppoe-isp3 \ new-connection-mark=conn_isp3 passthrough=no</code> </pre> <br>  <i><b>Komentar.</b></i> <i><br></i>  <i>Pembaca yang mencoba secara harfiah dan dalam urutan membaca mengulangi pengaturan yang disarankan dalam artikel, ketika memasukkan perintah ketiga, mereka akan menghadapi kesalahan: "input tidak cocok dengan nilai antarmuka".</i>  <i>Ini karena tidak adanya antarmuka "pppoe-isp3", yang akan dikonfigurasi pada Bagian 3.3.2.</i>  <i>Pada titik ini, Anda dapat memasukkan "ether3" alih-alih "pppoe-isp3".</i>  <i>Setelah menyelesaikan paragraf 3.3.2, Anda harus kembali dan meletakkan nama antarmuka saat ini.</i> <i><br><br></i>  <i>Agar tidak menandai koneksi yang sudah ditandai, saya menggunakan kondisi connection-mark = no-mark sebagai ganti connection-state = new.</i> <i><br><br></i>  <i>passthrough = tidak - karena dalam metode implementasi ini, penandaan ulang dikecualikan, dan untuk mempercepat Anda dapat mengganggu penghitungan aturan setelah pertandingan pertama.</i> <br><br>  Harus diingat bahwa kita masih tidak mengganggu routing.  Sekarang hanya ada tahap persiapan.  Tahap implementasi selanjutnya adalah pemrosesan lalu lintas transit, yang dikembalikan melalui koneksi yang stabil dari penerima di jaringan lokal.  Yaitu  paket-paket yang (lihat diagram) melalui router di sepanjang jalan: <br><br>  <b>“Input Interface” =&gt; ”Prerouting” =&gt; ”Keputusan Routing” =&gt; ”Maju” =&gt; ”Post Routing” =&gt; ”Output Interface”</b> dan sampai ke tujuannya di jaringan lokal. <br><br>  <u><b>Penting!</b></u>  Dalam ROS tidak ada pembagian logis ke antarmuka eksternal dan internal.  Jika kita melacak lintasan paket respons dalam diagram di bawah, itu akan mengikuti lintasan logis yang sama dengan permintaan: <br><br>  <b>“Input Interface” =&gt; ”Prerouting” =&gt; ”Keputusan Routing” =&gt; ”Forward” =&gt; ”Post Routing” =&gt; ”Output Interface”</b> hanya untuk permintaan “ <b>Input Interface</b> ” ada antarmuka ISP, dan untuk jawabannya itu adalah LAN <br><br>  2.2.  Kami mengarahkan lalu lintas transit kembali ke tabel routing yang sesuai: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-routing chain=prerouting \ comment="Routemark transit out via ISP1" connection-mark=conn_isp1 \ dst-address-type=!local in-interface-list=!WAN new-routing-mark=to_isp1 passthrough=no /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Routemark transit out via ISP2" connection-mark=conn_isp2 \ dst-address-type=!local in-interface-list=!WAN new-routing-mark=to_isp2 passthrough=no /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Routemark transit out via ISP3" connection-mark=conn_isp3 \ dst-address-type=!local in-interface-list=!WAN new-routing-mark=to_isp3 passthrough=no</code> </pre> <br>  <i><b>Komentar.</b></i>  <i><b>in-interface-list =! WAN - kami hanya bekerja dengan lalu lintas dari jaringan lokal dan tipe-alamat-dst =! lokal tanpa alamat tujuan dari alamat antarmuka router itu sendiri.</b></i> <i><b><br></b></i> <br><br>  Hal yang sama untuk paket lokal yang datang ke router di sepanjang jalan: <br><br>  <b>“Input Interface” =&gt; ”Prerouting” =&gt; ”Keputusan Routing” =&gt; ”Input” =&gt; ”Proses Lokal”</b> <br><br>  <u><b>Penting!</b></u>  Jawabannya akan mengikuti jalur berikut: <br><br>  <b>”Proses Lokal” =&gt; ”Keputusan Routing” =&gt; ”Output” =&gt; ”Post Routing” =&gt; ”Output Interface”</b> <b><br></b> <br>  2.3.  Kami mengarahkan respons lalu lintas lokal ke tabel routing yang sesuai: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-routing chain=output \ comment="Routemark local out via ISP1" connection-mark=conn_isp1 \ dst-address-type=!local new-routing-mark=to_isp1 passthrough=no /ip firewall mangle add action=mark-routing chain=output \ comment="Routemark local out via ISP2" connection-mark=conn_isp2 \ dst-address-type=!local new-routing-mark=to_isp2 passthrough=no /ip firewall mangle add action=mark-routing chain=output \ comment="Routemark local out via ISP3" connection-mark=conn_isp3 \ dst-address-type=!local new-routing-mark=to_isp3 passthrough=no</code> </pre> <br>  Pada tahap ini, tugas mempersiapkan untuk mengirim respons ke saluran Internet dari mana permintaan datang dapat dianggap diselesaikan.  Semuanya ditandai, ditandai dan siap untuk dirutekan. <br>  Efek "samping" yang sangat baik dari konfigurasi ini adalah kemampuan untuk meneruskan port DSNAT dari kedua penyedia (ISP2, ISP3) secara bersamaan.  Tidak sama sekali, karena pada ISP1 kami tidak memiliki alamat routable.  Efek ini penting, misalnya, untuk server surat dengan dua MX yang melihat saluran Internet yang berbeda. <br><br>  Untuk menghilangkan nuansa jaringan lokal yang berfungsi dengan router IP eksternal, kami menggunakan solusi dari paragraf.  1.8.2 dan 3.1.2.6. <br><br>  Selain itu, Anda dapat menggunakan alat dengan tanda dan untuk menyelesaikan paragraf 3 masalah.  Kami menerapkannya seperti ini: <br><br>  2.4.  Kami mengarahkan lalu lintas dari klien lokal dari daftar rute ke tabel terkait: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-routing chain=prerouting \ comment="Address List via ISP1" dst-address-list=!BOGONS new-routing-mark=to_isp1 \ passthrough=no src-address-list=Via_ISP1 /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Address List via ISP2" dst-address-list=!BOGONS new-routing-mark=to_isp2 \ passthrough=no src-address-list=Via_ISP2 /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Address List via ISP3" dst-address-list=!BOGONS new-routing-mark=to_isp3 \ passthrough=no src-address-list=Via_ISP3</code> </pre> <br>  Hasilnya, tampilannya seperti ini (gambar dapat diklik): <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/jw/bt/of/jwbtofiohmdeunznqgpnamyuhrm.jpeg"></a> <br><br><h4>  3. Konfigurasikan konektivitas ISP dan aktifkan perutean berbasis merek </h4><br>  3.1.  Konfigurasikan koneksi ke ISP1: <br>  3.1.1.  Konfigurasikan alamat IP statis: <br><br><pre> <code class="plaintext hljs">/ip address add interface=ether1 address=100.66.66.2/30 comment="ISP1 IP"</code> </pre> <br>  3.1.2.  Konfigurasikan perutean statis: <br>  3.1.2.1.  Tambahkan rute darurat default: <br><br><pre> <code class="plaintext hljs">/ip route add comment="Emergency route" distance=254 type=blackhole</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Rute ini memungkinkan lalu lintas dari proses lokal untuk melalui tahap Keputusan Rute terlepas dari kondisi saluran dari penyedia mana pun.</i>  <i>Nuansa lalu lintas lokal keluar adalah agar paket bergerak setidaknya di suatu tempat, perutean aktif ke gateway default harus ada dalam tabel perutean utama.</i>  <i>Jika tidak, maka paket hanya akan dihancurkan.</i> <br><br>  Sebagai perpanjangan dari alat <b>gateway pemeriksaan</b> untuk analisis yang lebih dalam dari status saluran, saya mengusulkan menggunakan metode rute rekursif.  Inti dari metode ini adalah kita memberi tahu router untuk mencari jalur ke gateway-nya tidak secara langsung, tetapi melalui gateway perantara.  Dengan demikian gateway "test", 4.2.2.1, 4.2.2.2 dan 4.2.2.3 akan dipilih untuk masing-masing ISP1, ISP2 dan ISP3. <br><br>  3.1.2.2.  Rute ke alamat "verifikasi": <br><br><pre> <code class="plaintext hljs">/ip route add check-gateway=ping comment="For recursion via ISP1" \ distance=1 dst-address=4.2.2.1 gateway=100.66.66.1 scope=10</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Nilai lingkup dikurangi menjadi default dalam lingkup target ROS, untuk menggunakan 4.2.2.1 lebih lanjut sebagai gateway rekursif.</i>  <i>Saya menekankan: ruang lingkup rute ke alamat "verifikasi" harus kurang dari atau sama dengan cakupan target rute yang akan merujuk pada verifikasi.</i> <br><br>  3.1.2.3.  Rute rekursif default untuk lalu lintas tanpa tanda rute: <br><br><pre> <code class="plaintext hljs">/ip route add check-gateway=ping comment="Unmarked via ISP1" \ distance=2 gateway=4.2.2.1</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Nilai distance = 2 digunakan karena ISP1 dinyatakan sebagai siaga pertama berdasarkan ketentuan tugas.</i> <br><br>  3.1.2.4.  Rute rekursif default untuk lalu lintas dengan tanda perutean “to_isp1”: <br><br><pre> <code class="plaintext hljs">/ip route add comment="Marked via ISP1 Main" distance=1 gateway=4.2.2.1 \ routing-mark=to_isp1</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Sebenarnya, di sini kita akhirnya mulai menggunakan buah dari pekerjaan persiapan yang dilakukan pada ayat 2.</i> <i><br><br></i>  <i>Pada rute ini, semua lalu lintas yang menandai rute "to_isp1" akan diarahkan ke gateway penyedia pertama, terlepas dari mana gateway default untuk tabel utama saat ini aktif.</i> <br><br>  3.1.2.5.  Rute rekursif default fallback pertama untuk lalu lintas berlabel dari penyedia ISP2 dan ISP3: <br><br><pre> <code class="plaintext hljs">/ip route add comment="Marked via ISP2 Backup1" distance=2 gateway=4.2.2.1 \ routing-mark=to_isp2 /ip route add comment="Marked via ISP3 Backup1" distance=2 gateway=4.2.2.1 \ routing-mark=to_isp3</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Rute ini juga diperlukan untuk memesan lalu lintas dari jaringan lokal, yang merupakan anggota dari daftar alamat “to_isp *” '</i> <br><br>  3.1.2.6.  Kami menulis rute untuk lalu lintas router lokal ke Internet melalui ISP1: <br><br><pre> <code class="plaintext hljs">/ip route rule add comment="From ISP1 IP to Inet" src-address=100.66.66.2 table=to_isp1</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>Dalam kombinasi dengan aturan dari klausa 1.8.2, disediakan saluran keluar ke saluran yang diinginkan dengan sumber yang diberikan.</i>  <i>Ini sangat penting untuk pembangunan terowongan di mana alamat IP dari sisi lokal (EoIP, IP-IP, GRE) ditentukan.</i>  <i>Karena aturan dalam aturan rute ip dijalankan dari atas ke bawah, hingga kondisinya cocok untuk pertama kalinya, aturan ini harus sesuai dengan aturan dalam klausa 1.8.2.</i> <br><br>  3.1.3.  Kami menulis aturan NAT untuk lalu lintas keluar: <br><br><pre> <code class="plaintext hljs">/ip firewall nat add action=src-nat chain=srcnat comment="NAT via ISP1" \ ipsec-policy=out,none out-interface=ether1 to-addresses=100.66.66.2</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>NAT adalah segala yang berjalan, kecuali bahwa itu jatuh ke dalam kebijakan IPsec.</i>  <i>Saya mencoba untuk tidak menggunakan action = masquerade kecuali benar-benar diperlukan.</i>  <i>Ini lebih lambat dan lebih banyak sumber daya daripada src-nat karena menghitung alamat untuk NAT untuk setiap koneksi baru.</i> <br><br>  3.1.4.  Kami mengirim klien dari daftar yang dilarang untuk keluar melalui penyedia lain langsung ke gateway penyedia ISP1. <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=route chain=prerouting \ comment="Address List via ISP1 only" dst-address-list=!BOGONS passthrough=no \ route-dst=100.66.66.1 src-address-list=Via_only_ISP1 place-before=0</code> </pre> <br>  <i><b>Komentar.</b></i>  <i>action = rute memiliki prioritas lebih tinggi dan diterapkan lebih awal dari aturan perutean lainnya.</i> <i><br><br></i>  <i>place-before = 0 - menempatkan aturan kami di urutan pertama dalam daftar.</i> <br><br>  3.2.  Kami mengkonfigurasi koneksi ke ISP2. <br><br>  Karena penyedia ISP2 memberi kita pengaturan melalui DHCP, masuk akal untuk membuat perubahan yang diperlukan dengan skrip yang dimulai ketika klien DHCP dipicu: <br><br><pre> <code class="plaintext hljs">/ip dhcp-client add add-default-route=no disabled=no interface=ether2 script=":if (\$bound=1) do={\r\ \n /ip route remove [ find gateway=\"4.2.2.2\" ]; /ip route remove \ [ find where dst-address ~\"4.2.2.2\" ]\r\ \n /ip route add check-gateway=ping comment=\"For recursion via ISP2\" \ distance=1 dst-address=4.2.2.2/32 gateway=\$\"gateway-address\" scope=10\r\ \n /ip route add check-gateway=ping comment=\"Unmarked via ISP2\" \ distance=1 gateway=4.2.2.2\r\ \n /ip route add comment=\"Marked via ISP2 Main\" distance=1 gateway=4.2.2.2 \ routing-mark=to_isp2\r\ \n /ip route add comment=\"Marked via ISP1 Backup1\" distance=2 \ gateway=4.2.2.2 routing-mark=to_isp1\r\ \n /ip route add comment=\"Marked via ISP3 Backup2\" distance=3 \ gateway=4.2.2.2 routing-mark=to_isp3\r\ \n /ip firewall nat add action=src-nat chain=srcnat ipsec-policy=out,none \ out-interface=\$\"interface\" to-addresses=\$\"lease-address\" \ comment=\"NAT via ISP2\"\r\ \n /ip route rule add comment=\"From ISP2 IP to Inet\" \ src-address=\$\"lease-address\" table=to_isp2 \r\ \n} else={\r\ \n /ip route remove [ find gateway=\"4.2.2.2\" ]; /ip route remove \ [ find where dst-address ~\"4.2.2.2\" ]\r\ \n /ip firewall nat remove [find comment=\"NAT via ISP2\"]\r\ \n /ip route rule remove [find comment=\"From ISP2 IP to Inet\"]\r\ \n}\r\ \n" use-peer-dns=no use-peer-ntp=no</code> </pre> <br>  Script itu sendiri di jendela Winbox (dapat diklik): <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/dz/_f/hh/dz_fhhyltpdet5oush5wqwpud2e.jpeg"></a> <br>  <i><b>Komentar.</b></i>  <i>Bagian pertama dari skrip dipicu ketika leasing berhasil diterima, yang kedua - setelah leasing dirilis.</i>  <sup>Lihat catatan 2</sup> <br><br>  3.3.  Kami mengkonfigurasi koneksi ke penyedia ISP3. <br><br>  Karena penyedia konfigurasi memberi kita dinamis, masuk akal untuk membuat perubahan yang diperlukan dengan skrip yang dimulai setelah naik dan setelah jatuhnya antarmuka ppp. <br><br>  <i><b>Komentar.</b></i>  <i>Antarmuka ppp dapat ditentukan sebagai gateway alih-alih alamat IP.</i>  <i>Namun, dalam hal ini, rute rekursif tidak dapat diaktifkan.</i>  <i>Oleh karena itu, kami memasukkan alamat IP sisi penyedia ke dalam variabel dan menggunakannya lebih lanjut dengan cara yang sama seperti untuk penyedia lainnya</i> <br><br>  3.3.1.  Pertama, konfigurasikan profil: <br><br><pre> <code class="plaintext hljs">/ppp profile add comment="for PPPoE to ISP3" interface-list=WAN name=isp3_client \ on-down="/ip route remove [ find gateway=\"4.2.2.3\" ]\r\ \n/ip route remove [ find where dst-address ~\"4.2.2.3\" ]\r\ \n/ip firewall nat remove [find comment=\"NAT via ISP3\"]\r\ \n/ip route rule remove [find comment=\"From ISP3 IP to Inet\"]" \ on-up="/ip route remove [ find gateway=\"4.2.2.3\" ]; /ip route remove \ [ find where dst-address ~\"4.2.2.3\" ]\r\ \n/ip route add check-gateway=ping comment=\"For recursion via ISP3\" distance=1 \ dst-address=4.2.2.3/32 gateway=\$\"remote-address\" scope=10\r\ \n/ip route add check-gateway=ping comment=\"Unmarked via ISP3\" distance=3 \ gateway=4.2.2.3\r\ \n/ip route add comment=\"Marked via ISP3 Main\" distance=1 gateway=4.2.2.3 \ routing-mark=to_isp3\r\ \n/ip route add comment=\"Marked via ISP1 Backup2\" distance=3 gateway=4.2.2.3 \ routing-mark=to_isp1\r\ \n/ip route add comment=\"Marked via ISP2 Backup2\" distance=3 gateway=4.2.2.3 \ routing-mark=to_isp2\r\ \n/ip firewall mangle set [find comment=\"Connmark in from ISP3\"] \ in-interface=\$\"interface\"\r\ \n/ip firewall nat add action=src-nat chain=srcnat ipsec-policy=out,none \ out-interface=\$\"interface\" to-addresses=\$\"local-address\" \ comment=\"NAT via ISP3\"\r\ \n/ip route rule add comment=\"From ISP3 IP to Inet\" \ src-address=\$\"local-address\" table=to_isp3 "</code> </pre><br>  Script itu sendiri di jendela Winbox (dapat diklik): <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/oz/tz/it/oztzitzzxgl5jz0g9jxskvtf3us.jpeg"></a> <br>  <i><b>Komentar.</b></i>  <i>Tali</i> <i><br></i>  <i><b>/ ip firewall mangle set [find comment = "Connmark in from ISP3"] in-interface = $ "interface";</b></i> <i><br></i>  <i>Memungkinkan Anda memproses penggantian nama antarmuka dengan benar, karena ia bekerja dengan kode dan bukan nama tampilan.</i> <br><br>  3.3.2.  Sekarang, menggunakan profil, buat koneksi ppp: <br><br><pre> <code class="plaintext hljs">/interface pppoe-client add allow=mschap2 comment="to ISP3" disabled=no \ interface=ether3 name=pppoe-isp3 password=isp3_pass profile=isp3_client \ user=isp3_client</code> </pre> <br><br>  <i><b>Komentar.</b></i>  <i>Beberapa penyedia "lupa" untuk memberikan parameter "alamat jarak jauh".</i>  <i>Dalam hal ini, ketika terhubung, skrip konfigurasi tidak akan berfungsi dengan benar, dan dalam log Anda akan melihat kesalahan berikut:</i> <i><br></i>  <i>pppoe, ppp, info pppoe-isp3: tidak dapat menentukan alamat jarak jauh, menggunakan xxx.xxx.xxx.xxx</i> <i><br></i>  <i>Untuk mengatasi masalah ini, Anda perlu mengatur alamat secara manual di profil ppp (boneka apa pun):</i> <i><br></i> <pre> <i><code class="plaintext hljs">/ppp profile set isp3_client remote-address=169.254.69.96</code></i> </pre> <i><br></i>  <i>Tali</i> <i><br></i>  <i><b>/ ip firewall mangle set [find comment = "Connmark in from ISP3"] in-interface = $ "interface";</b></i> <i><br></i>  <i>Memungkinkan Anda memproses penggantian nama antarmuka dengan benar, karena ia bekerja dengan kode dan bukan nama tampilan.</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sebagai sentuhan terakhir, atur jam: </font></font><br><br><pre> <code class="plaintext hljs">/system ntp client set enabled=yes \ server-dns-names=0.pool.ntp.org,1.pool.ntp.org,2.pool.ntp.org</code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bagi mereka yang membaca sampai akhir </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode yang diusulkan untuk mengimplementasikan multivan adalah preferensi pribadi penulis dan bukan satu-satunya yang mungkin. </font><font style="vertical-align: inherit;">Toolkit ROS luas dan fleksibel, yang di satu sisi menyebabkan kesulitan bagi pemula, di sisi lain - alasan popularitas. </font><font style="vertical-align: inherit;">Jelajahi, coba, temukan alat dan solusi baru. </font><font style="vertical-align: inherit;">Sebagai contoh, sebagai aplikasi dari pengetahuan yang diperoleh, dimungkinkan dalam implementasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multivan ini</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengganti alat </font><b><font style="vertical-align: inherit;">check-gateway</font></b><font style="vertical-align: inherit;"> dengan rute rekursif dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netwatch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Catatan </font></font></h4><br><ol><li> <i><b>Check-gateway</b> — ,             .     10 ,   . ,       20-30 .       —     <b>Netwatch</b> ,      . <br>  <b>Check-gateway</b>        . <br><br> <u><b>!</b></u>          ,    .     <b>check-gateway=ping</b>  .</i> </li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itu terjadi bahwa kegagalan terjadi dalam mekanisme operasi DHP, yang terlihat seperti klien yang menggantung dalam keadaan pembaruan. </font><font style="vertical-align: inherit;">Dalam hal ini, bagian kedua skrip tidak akan berfungsi, tetapi tidak akan mengganggu lalu lintas untuk berjalan dengan benar, karena negara memantau rute rekursif yang sesuai.</font></font></i> </li><li> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECMP (Equal Cost Multi-Path)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ROS memiliki kemampuan untuk menentukan rute dengan banyak gateway dan jarak yang sama. </font><font style="vertical-align: inherit;">Dalam hal ini, koneksi akan didistribusikan melalui saluran menggunakan algoritma round robin, sebanding dengan jumlah gateway yang ditentukan.</font></font></i> </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk dorongan untuk menulis artikel, bantu dalam membentuk strukturnya dan memberikan penekanan - terima kasih pribadi kepada Eugene </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@jscar</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id463813/">https://habr.com/ru/post/id463813/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id463799/index.html">Apa yang saya tidak suka tentang Windows 10</a></li>
<li><a href="../id463801/index.html">3 kualitas utama untuk manajer produk yang sukses: Anton Stozhko</a></li>
<li><a href="../id463803/index.html">Hari kelima saya dengan Haiku: mari kita port beberapa program</a></li>
<li><a href="../id463805/index.html">Tujuh buku untuk mereka yang ingin menjadi desainer game</a></li>
<li><a href="../id463811/index.html">Mempersiapkan aplikasi untuk Android Q. Bagian 1</a></li>
<li><a href="../id463815/index.html">Mengapa bank asing tertarik dengan sumber dana Anda?</a></li>
<li><a href="../id463817/index.html">20 manajer produk dan struktur matriks paling multi-dimensi dari semua. Percakapan dengan Skyeng</a></li>
<li><a href="../id463819/index.html">Kunci PostgreSQL: 2. Kunci string</a></li>
<li><a href="../id463821/index.html">AMO, Bitrix, 1C, dan lainnya: bagaimana memilih di mana untuk memulai?</a></li>
<li><a href="../id463823/index.html">Rilis Rust 1.37.0: Optimalisasi Terpandu Profil, konstanta tanpa nama dan vendor kargo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>