<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò≤ üë®üèø‚Äçüéì ü§õüèæ Desarrollo de un banco de energ√≠a para una computadora port√°til. Desde el dise√±o hasta el producto terminado. La segunda parte üë∏ ‚öñÔ∏è üë≥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En la √∫ltima parte del art√≠culo sobre el desarrollo de PowerBank para una computadora port√°til, nos decidimos por un dise√±o fabricado, medimos la efic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de un banco de energ√≠a para una computadora port√°til. Desde el dise√±o hasta el producto terminado. La segunda parte</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/386899/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la √∫ltima parte del art√≠culo sobre el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desarrollo de PowerBank para una computadora port√°til,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos decidimos por un dise√±o fabricado, medimos la eficiencia y entendimos qu√© hacer a continuaci√≥n. </font><font style="vertical-align: inherit;">Y luego fue necesario revivir la pieza de hierro. </font><font style="vertical-align: inherit;">Por lo tanto, presento a su atenci√≥n la segunda parte: dise√±o de software.</font></font><br>
<img src="https://habrastorage.org/files/368/fcc/f59/368fccf5979c4932a392b911139c892b.png"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La ruptura entre las partes result√≥ ser bastante grande: todas las fuerzas se lanzaron sobre el proyecto de una bater√≠a externa de carga r√°pida, que ahora est√° reuniendo apoyo en </font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">boomstarter</font></a></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Continuemos. </font><font style="vertical-align: inherit;">
Para comprender qu√© microcircuitos tendremos que programar, veremos el diagrama de bloques del dise√±o. </font><font style="vertical-align: inherit;">
Desde aqu√≠ est√° claro que tendremos que escribir software para el control MK (STM32F042), as√≠ como configurar el sistema de control de bater√≠a de iones de litio + cargador (BQ40Z60). Comenc√© con el segundo, porque consideraba esta parte la m√°s dif√≠cil. </font><font style="vertical-align: inherit;">
Para programar el controlador BQ40Z60, necesitamos: </font><font style="vertical-align: inherit;">
 - El adaptador EV2400 y EV2300 ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">listo</font></a><font style="vertical-align: inherit;"> o hecho en casa). He dejado el EV2300 de proyectos anteriores, as√≠ que lo us√©. </font><font style="vertical-align: inherit;">
 - programa</font></font><b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<img src="https://habrastorage.org/files/87a/3e9/68e/87a3e968e1dc4112a6e96f5375e7b2f8.png"><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estudio de gesti√≥n de la bater√≠a (bqStudio)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El adaptador est√° conectado a trav√©s de SMBus, para la conexi√≥n dej√© puntos de soldadura en las l√≠neas SMBD y SMBC. (No es la soluci√≥n m√°s pr√°ctica, luego me di cuenta de que ten√≠a que instalar el conector). </font></font><br>
<img src="https://habrastorage.org/files/90a/c7d/ddf/90ac7dddfa184d8498d418b786c853fa.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de bailar con una pandereta, el BQ40Z60 se decidi√≥ por Battery Management Studio. La raz√≥n de esto fue el modo de suspensi√≥n en el que el controlador ingresa cuando no hay pull-up en el bus SMBus y no hay acceso al mismo. Se despierta cuando conecta la memoria. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, ajustaremos directamente el chip BQ40Z60. Decir que tiene muchos registros es no decir nada. Un mill√≥n de configuraciones. Dado que la configuraci√≥n es un proceso largo y complicado (se requiere un art√≠culo separado para la descripci√≥n) lo describir√© brevemente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de comenzar, aparece la ventana principal de Battery Management Studio.</font></font><br>
<img src="https://habrastorage.org/files/8c5/bb5/610/8c5bb561090943eebcb578c4b6891727.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pesta√±a Memoria de datos contiene una gran cantidad de campos en los que debemos ingresar los par√°metros de la bater√≠a y los modos de operaci√≥n del controlador. </font></font><br>
<img src="https://habrastorage.org/files/d9a/b9a/c2a/d9ab9ac2ac5140debab0ccb00a154b92.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la pesta√±a Qu√≠mica, puede intentar encontrar calibraciones listas para las celdas utilizadas. </font></font><br>
<img src="https://habrastorage.org/files/fad/140/d49/fad140d49cbd4e4d8837098da6af29f1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para mi YOKU LP 5558115 3500mAh, no hab√≠a calibraciones listas (por cierto, las calibraciones se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actualizan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constantemente </font><font style="vertical-align: inherit;">). Encontramos similares YOKU LP 656193 4000mAh. Al darme cuenta de que todav√≠a no s√© nada sobre los paquetes disponibles, eleg√≠ este perfil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, en la pesta√±a Memoria de datos, configur√©: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calibraci√≥n:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valores de calibraci√≥n para volt√≠metros (celdas, bater√≠as y un adaptador externo), resistencia del sensor de corriente, valores de calibraci√≥n para el sensor de temperatura. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraciones:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inclusi√≥n de protecciones, termistores, LED, modo de suspensi√≥n, configuraci√≥n de bater√≠a. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protecciones:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuraci√≥n de umbrales de protecci√≥n (tensi√≥n, tiempo, temperatura), configuraci√≥n de umbrales de tensi√≥n del adaptador externo. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Falla permanente:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> establecer umbrales para errores irreversibles (de modo que no sea posible el funcionamiento de la bater√≠a). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritmo de carga avanzado:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuraci√≥n del cargador (corrientes, voltajes para diferentes rangos de temperatura, se√±al del final de la carga, balanceo). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medici√≥n de gas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuraci√≥n de la unidad para determinar el nivel de carga (capacidad de la placa de identificaci√≥n / voltaje de la celda, resistencia del cable, estad√≠sticas). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Potencia:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuraci√≥n de modos de funcionamiento del controlador. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estado de PF:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estado de falla permanente estado de bit </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datos del sistema:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> campos para datos del fabricante. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraci√≥n de SBS:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuraci√≥n de umbrales de activaci√≥n para la activaci√≥n de alarma, informaci√≥n b√°sica de la bater√≠a (n√∫mero de serie, fecha de producci√≥n, fabricante, nombre, qu√≠mica). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soporte LED:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuraci√≥n del modo de luz indicadora LED. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuadro</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> negro </font><b><font style="vertical-align: inherit;">:</font></b><font style="vertical-align: inherit;"> cuadro negro (historial de cambios en los bits de estado de protecci√≥n). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vida</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √∫til </font><b><font style="vertical-align: inherit;">:</font></b><font style="vertical-align: inherit;"> estad√≠sticas de la bater√≠a. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabla Ra: una</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tabla de resistencias celulares internas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante el proceso de configuraci√≥n, no cambi√© todos los campos, pero esto fue suficiente para comenzar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con esta parte del circuito, solo hab√≠a una jamba de hardware conectada a la salida del microcircuito 21-AFEFUSE. La cosa fue as√≠:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estaba arrancando el circuito de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placa de depuraci√≥n a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> excepci√≥n del microcircuito de protecci√≥n secundario y el fusible quemado. El BQ40Z60 tiene 21 pines AFEFUSE para quemar un fusible (como pens√©). As√≠ que mir√© la p√°gina 5 de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hoja de datos BQ40Z60</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vi el </font></font><br>
<img src="https://habrastorage.org/files/f1c/964/667/f1c964667aa042cdae2a1d63122e9b67.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tipo de salida Salida </font><font style="vertical-align: inherit;">en la tabla </font><font style="vertical-align: inherit;">y, con la conciencia tranquila, la dej√© colgando en el aire. Los problemas surgieron despu√©s de soldar la placa: clasifiqu√© todas las configuraciones (y en ese momento hab√≠a muchas dudas), pero no funcion√≥: los transistores de carga y descarga no se encendieron. Despu√©s de 2 d√≠as de duda / reflexi√≥n / prueba y error, not√© que el bit FUSE_EN no estaba configurado y decid√≠ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"preguntar a la gente"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y cuando publiqu√© una pregunta, recib√≠ una idea.</font></font><br>
<img src="https://habrastorage.org/files/13b/a37/caf/13ba37caf5564b55896121eb247369e0.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mirando la placa de circuito de la placa de depuraci√≥n, suger√≠ que el pin AFEFUSE tambi√©n puede ser una entrada, lo que se confirm√≥ en la secci√≥n 9.3.2.4 p.24, que dice que si el pin no se usa, debe conectarse a tierra. Lo hice con pinzas y funcion√≥. Despu√©s de 5 minutos, me respondieron en e2e.com - la respuesta es clara y correcta, expres√© mi "phi" sobre el error en la tabla de resultados - prometieron arreglarlo en futuras versiones de la documentaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para poner fin a la configuraci√≥n del controlador, ejecut√© 2 ciclos de entrenamiento de carga / descarga completa + relajaci√≥n (tom√≥ un total de 30 horas). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora pasemos a programar el STM32F042. En la etapa simulada, este procesador no requer√≠a mucho: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Controlar el convertidor de voltaje, procesar los botones.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Duerma lo m√°s posible para no descargar la bater√≠a. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Lea los par√°metros principales de la bater√≠a del controlador (voltaje, corriente, nivel de carga, temperatura, estado actual, n√∫mero de ciclos, tiempo de carga / descarga completa) y env√≠elos a la PC a trav√©s de USART (ya que el convertidor CP2102 ya estaba en la placa). Aunque el procesador contiene USB a bordo, no lo us√© en el dise√±o, y se realiz√≥ un dise√±o para 051 MK, pero no pude comprarlo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El control del convertidor se redujo a dos conclusiones (encendido y modo de funcionamiento), suministrando el PWM (con filtrado RC posterior) a la salida de la configuraci√≥n de frecuencia de conversi√≥n del chip LTC3780 (como resultado, establezca la frecuencia a un m√°ximo de 400 kHz) y la entrada de monitoreo de se√±al PowerGood. Pero incluso aqu√≠ logr√© pisar el rastrillo. El error estaba flotando y ocurri√≥ cuando Power Bank permaneci√≥ durante mucho tiempo, expresado en el hecho de que simplemente no se encendi√≥. El problema fue que primero encend√≠ la interrupci√≥n a la se√±al PowerGood del LTC3780, y luego encend√≠ el chip (EN). Result√≥ que la interrupci√≥n se dispar√≥ incluso antes del inicio del convertidor y lo apag√≥. Reorganiz√≥ los eventos en lugares y agreg√≥ un retraso: el problema desapareci√≥. De lo contrario, esta funcionalidad fue f√°cil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se decidi√≥ hacer una interfaz de usuario con 1 bot√≥n y 5 (6) LED (aunque hab√≠a 2 botones y 10 LED en la placa de dise√±o). Funciona de la siguiente manera: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
el dispositivo est√° apagado -&gt; pulsaci√≥n corta (&lt;500 ms) - animaci√≥n del nivel de carga en 4 LED. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El dispositivo est√° apagado -&gt; pulsaci√≥n larga (&gt; 500 ms) - encienda el dispositivo (se enciende el 5¬∫ LED). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El dispositivo se apaga -&gt; conectando la memoria -&gt; animaci√≥n del nivel de carga en 4 LED hasta el final del proceso de carga. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El dispositivo est√° encendido -&gt; pulsaci√≥n corta - animaci√≥n del nivel de carga en 4 LED. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dispositivo encendido -&gt; pulsaci√≥n larga - apaga el dispositivo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dispositivo apagado -&gt; consumo de corriente inferior a 50 mA durante m√°s de 3 min. - apague el dispositivo.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto permiti√≥ eliminar 27 elementos del dispositivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya ten√≠a experiencia en la implementaci√≥n de modos de suspensi√≥n en STM32F0xx, as√≠ que no cont√© con un gran rastrillo aqu√≠. Para optimizar el consumo, primero reemplac√© el LDO 3.3V por mcp1703 con una baja corriente de mi propio consumo (era necesario no arrancar la depuraci√≥n, sino instalarlo de inmediato). Tama√±o, precio, consumo, kit de carrocer√≠a, todo menos que el LP2951. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gracias a </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardegor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por editar LDO para Li-ion 4s. Mcp1703 no se puede usar debido al bajo voltaje de entrada. Us√© LiFePo4 para la qu√≠mica, no hay tal problema. ¬°¬°¬°Ten cuidado!!!</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Cuando el dispositivo est√° apagado, el MK est√° en modo EN ESPERA y responde solo al presionar un bot√≥n o la conexi√≥n de la memoria. El consumo en este modo es de 108 ŒºA (100 de ellos consumen BQ40Z60). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Cuando el dispositivo est√° encendido, el procesador la mayor parte del tiempo (a excepci√≥n de los momentos de indicaci√≥n y sondeo del BQ40Z60) est√° en modo STOP con un consumo de 1,5 mA (1 mA es un LED). En el momento de la interrogaci√≥n y la indicaci√≥n, el consumo de corriente var√≠a de 4.5 a 9 mA. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Cuando se conecta un USB MK en modo RUN de 48 MHz, el consumo es de 15 mA. En el futuro, alimentar√© el MK en este modo desde USB.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El mayor problema potencial fue la encuesta BQ40Z60. No trabaj√© con SMBus y hasta el √∫ltimo esperaba que SMBus fuera I2C 1v1 (esto se debe en parte a que el nivel f√≠sico es el mismo para ellos), pero result√≥ que el nivel del canal es muy diferente y esto cre√≥ una serie de dificultades. Aqu√≠ no describir√© las diferencias entre SMBus e I2C, pero proporcionar√© un enlace a un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bastante competente </font><font style="vertical-align: inherit;">. En la etapa de dise√±o, no me involucr√© en la lucha contra SMBus (por cierto, como programador, soy mucho m√°s d√©bil que un dise√±ador de circuitos) y como los comandos de env√≠o y recepci√≥n de bytes en SMBus e I2C eran completamente id√©nticos, solo los utilic√©. Como resultado, le√≠ SOC, SOH, Current, CellVolt, TimeToFull, TimeToEmpty de BQ40Z60. Dependiendo de los valores de los registros, el modo de operaci√≥n cambi√≥ (se emitieron advertencias, se produjo cualquier apagado).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, en el lado de la PC, por supuesto, se necesitaba un programa que pudiera mostrar los datos le√≠dos de la bater√≠a de forma conveniente. Como solo pod√≠a usar GUI en Borland C ++ Builder y lo hice durante mucho tiempo, le ped√≠ al programador que dibujara una depuraci√≥n simple para m√≠. Para un l√°tigo r√°pido, sali√≥ lo siguiente:</font></font><br>
<img src="https://habrastorage.org/files/62e/18d/c55/62e18dc550c04870a8d51acb5dda6691.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este es todo el trabajo que se realiz√≥ en la etapa de dise√±o. </font><font style="vertical-align: inherit;">Adem√°s en los planes (y dado que describo las operaciones que ya se han completado, parte del trabajo ya se ha realizado), la transferencia de especificaciones t√©cnicas al dise√±ador para el desarrollo / fabricaci√≥n del paquete PowerBank, correcci√≥n / revisi√≥n de errores del circuito, alteraci√≥n de la placa para el caso, revisi√≥n de software. </font><font style="vertical-align: inherit;">Despu√©s de eso, el dispositivo ser√° similar a un producto y, una vez completado, se convertir√° en un producto en el sentido literal de la palabra. </font><font style="vertical-align: inherit;">En las siguientes partes del art√≠culo, consideraremos las etapas y las principales dificultades de la transici√≥n de un dise√±o a un producto terminado, trabajaremos en el empaque, consideraremos los costos de varias soluciones y operaciones, la optimizaci√≥n y tambi√©n veremos el resultado final.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es386899/">https://habr.com/ru/post/es386899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es386883/index.html">C√≥mo borramos el borde de la realidad</a></li>
<li><a href="../es386891/index.html">El teclado UHK es a√∫n mejor y m√°s c√≥modo: ahora con m√≥dulos opcionales y un reposamanos ergon√≥mico.</a></li>
<li><a href="../es386893/index.html">La nueva tecnolog√≠a de proceso reduce el costo de grafeno en 100 veces</a></li>
<li><a href="../es386895/index.html">Pre-realidad - hermosa, seguridad - rentable</a></li>
<li><a href="../es386897/index.html">¬øEscardar malezas? Nada es m√°s f√°cil, c√°rgalo a Bosch</a></li>
<li><a href="../es386901/index.html">Energ√≠a natural</a></li>
<li><a href="../es386903/index.html">El creador de bot Stormbuddy para WOW culpa a Blizzard por robar el c√≥digo fuente</a></li>
<li><a href="../es386905/index.html">Australia proh√≠be el almacenamiento de archivos para la impresi√≥n 3D de armas de fuego</a></li>
<li><a href="../es386911/index.html">Sony Xperia Z5 revisi√≥n</a></li>
<li><a href="../es386915/index.html">La diferencia en el tiempo de despertar entre semana y fines de semana est√° asociada con problemas de salud.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>