<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨 👩🏽‍🎨 👨🏿‍🤝‍👨🏾 Über GOSTs Code, Grasshopper, seine SBox und verlorene Samen 👨🏼‍💻 👨🏽‍💻 🤙🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo% Benutzername%! 



 Wir sind kürzlich von der EuroCrypt 2019-Konferenz zurückgekehrt, bei der wir äußerst kluge Leute getroffen und gleichzeiti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Über GOSTs Code, Grasshopper, seine SBox und verlorene Samen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/virgilsecurity/blog/453254/">  Hallo% Benutzername%! <br><br><img src="https://habrastorage.org/webt/ok/wd/9a/okwd9aqadlndqsx3pvwzmqswkio.png"><br><br>  Wir sind kürzlich von der EuroCrypt 2019-Konferenz zurückgekehrt, bei der wir äußerst kluge Leute getroffen und gleichzeitig neue, äußerst anstößige Fakten über GOST SBox erfahren haben. <br><br>  Dies ist also der zweite Ansatz für das Projektil.  Korrigiert und ergänzt. <br><br>  Dieses Mal wird es keine unverständlichen rot-blauen Folien geben, aber es wird Originaldokumente des ISO-Komitees mit Erklärungen der Autoren von Grasshopper geben. <br><br>  Und sogar die Herausforderung am Ende! <br><br>  Lass uns gehen. <br><a name="habracut"></a><br>  Erstes Bildungsprogramm.  Im vorherigen Artikel war es nicht, diesmal korrigiere ich. <br><br><h2>  Ausgewählter Plaintext Attack (CPA) </h2><br>  Wir beginnen mit dem grundlegenden Angriffsmodell für Blockchiffren. <br><br>  In diesem Modell weiß der Angreifer alles über das Kryptosystem außer dem Verschlüsselungsschlüssel.  Er kann beliebige Klartexte erstellen, die entsprechenden Chiffretexte abrufen und seine Aufgabe ist es, den Schlüssel zu berechnen, weil  Dies ist die einzige Variable. <br><br>  Die Blockverschlüsselung kann in dieser Situation als pseudozufällige Substitution betrachtet werden.  Eine Funktion, die einen Klartextblock einem Chiffretextblock so zuordnet, dass die Beziehung zwischen ihnen nicht bestimmt werden kann. <br><br>  Eine ideale Blockchiffre kann man sich als große Tabelle vorstellen, in der horizontal alle möglichen Schlüssel von 000 ... 000 bis 111 ... 111 vertikal vorhanden sind - alle möglichen offenen Texte auch von 000 ... 000 bis 111 ... 111 und an der Stelle ihrer Schnittmenge - zufällig erzeugte Chiffretexte, die ein Paar von "Schlüssel - Klartext" eindeutig zuordnen würden.  Das Erstellen einer solchen Tabelle im wirklichen Leben ist aufgrund ihrer Größe nicht möglich, daher wird sie unter Verwendung verschiedener Blockverschlüsselungsalgorithmen emuliert. <br><br>  Der Angriff auf die Blockverschlüsselung kann als erfolgreich bezeichnet werden, wenn wir die „Zufälligkeit“ bestimmen können, mit der der Algorithmus Chiffretexte auswählt, die Klartexten entsprechen.  Diese Zufälligkeit ermöglicht es im schlimmsten Fall, den Verschlüsselungsschlüssel zu berechnen. <br><br><h2>  (Nicht-) Linearität </h2><br>  Der Verschlüsselungsprozess in der Blockverschlüsselung kann durch eine einfache Formel dargestellt werden <br>  C = M x K. <br>  Dabei ist C Chiffretext, M Klartext, K der Verschlüsselungsschlüssel und x die Blockchiffre. <br><br>  Diese Formel ähnelt visuell der Schulformel der linearen Gleichung y = kx + b, deren Graph eine gerade Linie ist. <br><br>  Jede gerade Linie kann in nur zwei Punkten wiederhergestellt werden.  Gleichzeitig <b>möchten wir wirklich nicht,</b> dass Sie in zwei Paaren von Klartext - Chiffretext - den Verschlüsselungsschlüssel wiederherstellen können.  Zu diesem Zweck werden den Verschlüsselungsalgorithmen spezielle Schichten hinzugefügt, die für die Nichtlinearität verantwortlich sind.  Diese Ebenen sollen verhindern, dass die Beziehung zwischen Klartext, Chiffretext und Schlüssel berechnet werden kann. <br><br>  <b>Ihre Qualität ist entscheidend für die Sicherheit des Algorithmus.</b> <br><br><h2>  Was ist SBox? </h2><br>  Dies ist dieselbe nichtlineare Schicht.  Eine Funktion, die im Fall von Grasshopper und einigen anderen Chiffren ein Byte eindeutig einem anderen Byte zuordnet. <br><br>  Sehr oft wird es durch eine einfache Korrespondenztabelle festgelegt, zum Beispiel <br><br><img src="https://habrastorage.org/webt/vv/hb/wz/vvhbwz-91dzodczyffdxskuivpg.png"><br><br>  Weil es sonst nicht beschrieben werden kann.  Auf den ersten Blick. <br><br><h2>  Warum ist SBox wichtig? </h2><br>  Weil es die <b>einzige</b> nichtlineare Funktion in der gesamten Chiffre ist.  Ohne sie ist das Brechen einer Chiffre nicht einfach, aber sehr einfach, da sie als lineares Gleichungssystem dargestellt wird.  Daher hat die Substitutionsfunktion so viel Aufmerksamkeit.  Es gibt sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">praktische</a> Übungen zum Hacken von AES mit linearer SBox. <br><br><h2>  Warum können Sie überhaupt keine sichere SBox erstellen? </h2><br>  Das Problem ist, dass Kryptographie keine exakte Wissenschaft ist.  Der einzige nachweislich starke Verschlüsselungsalgorithmus ist ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einmaliges Pad</a> .  Der Rest sind schüchterne Versuche, sich in das uns zur Verfügung stehende Wissensspektrum einzufügen, dessen Menge nicht so groß ist. <br>  Wir wissen nicht genau, ob RSA- oder AES- oder elliptische Kurven resistent sind, aber wir wissen, dass solche und solche Dinge <b>definitiv nicht möglich sind</b> .  Alles dazwischen ist Kreativität. <br><br>  Daher die ständige Paranoia über die verschiedenen „magischen Konstanten“ und andere Punkte, die die Autoren der Algorithmen als sicher präsentieren, aber <b>nicht beweisen können</b> . <br><br><h2>  Wie erstelle ich SBox? </h2><br>  Die verschiedenen SBox-Varianten sind 256!, Was ungefähr 2 <sup>1684 entspricht</sup> .  Die Auswahl ist groß und im Laufe der Jahre der Kryptoanalyse wurden Metriken und Eigenschaften entwickelt, die SBox besitzen sollte und die gegen die heute bekannten Angriffe resistent sind.  Natürlich denken die Schöpfer der Tabellen über Jahre hinweg nach und versuchen, Substitutionen zu schaffen, die selbst gegen Angriffe, die in 5-10 Jahren erfunden wurden, resistent sind.  Dies ist jedoch mehr aus der Kategorie Magie und Schamanismus. <br><br>  Es gibt zwei grundlegend unterschiedliche Ansätze zur Erstellung von SBox. <br><br>  Die erste ist eine zufällige Suche.  Entwickler generieren zufällige Tabellen, überprüfen ihre Eigenschaften und filtern diejenigen heraus, die nicht geeignet sind.  Dies geht so lange weiter, bis die Entwickler mit dem, was sie gefunden haben, zufrieden sind. <br><br>  In der zivilisierten Welt geschieht dies beispielsweise wie folgt: <br><br><ol><li>  Ein Anfangswert ist beispielsweise ein Zitat aus einem Buch oder die ersten Ziffern von Pi </li><li>  Läuft durch einen Hash </li><li>  Das Hash-Ergebnis wird als Daten zur Bildung der SBox verwendet. </li><li>  Wenn SBox nicht passt, nehmen Sie den aktuellen Hash und kehren Sie zu Schritt 2 zurück </li></ol><br>  So kann jeder diesen Prozess reproduzieren und sicherstellen, dass mindestens die Mindestanforderungen für die pseudozufällige Suche erfüllt sind. <br><br>  Wissen Sie, wohin die Samen des wichtigsten symmetrischen Algorithmus des Landes gehen?  <b>Verloren</b> !  Ich dachte, sie hätten es ihnen nicht ausdrücklich verraten, das Geheimnis ist da oder so, aber russische Kollegen von EuroCrypt sagten, dass während der Entwicklung des Algorithmus im Jahr 2007 aus irgendeinem Grund niemand dachte, dass es notwendig wäre, das Design der Nachschlagetabelle zu rechtfertigen, und dass die Werte, aus denen es hervorging, für immer waren verloren.  Die Geschichte ist wunderschön, vergessen Sie nur nicht, dass der Algorithmus nicht in der Schule in einer Pause erstellt wurde, sondern im Darm des FSB. <br><br>  Die zweite Möglichkeit besteht darin, die SBox selbst zu erstellen, wobei Sie sich an den verfügbaren mathematischen Geräten orientieren.  Das haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die</a> Autoren von AES getan, und sie haben es ziemlich gut gemacht.  Wenn wir die Nichtlinearität von SBox AES, SM4 (chinesischer Standard) und Grasshopper (es verwendet dieselbe SBox wie der Stribog-Hash) vergleichen, wird das Ergebnis nicht für letztere sprechen <br><blockquote>  AES-Nichtlinearität (min, max) = (112,0, 112,0) <br>  SM4-Nichtlinearität (min, max) = (112,0, 112,0) <br>  Streebog-Nichtlinearität (min, max) = (102,0, 110,0) <br></blockquote>  Der Nichtlinearitätsberechnungscode verwendet die Walsh-Transformation und ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> verfügbar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> <br><br><h2>  Docs </h2><br>  Ich habe zwei Dokumente von ISO erhalten.  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ersten Teil</a> erklären Grasshopper-Designer, wie sie SBox erstellt haben, im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">anderen</a> Fall erörtert <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das</a> Komitee ihre Argumente. <br><br><img src="https://habrastorage.org/webt/y9/m5/b-/y9m5b-hsbz7pz4y-fka76fnaqxi.png"><br><br>  Ab dem ersten Dokument interessieren uns zwei Zitate: <br><br><img src="https://habrastorage.org/webt/re/8h/wi/re8hwia__7b85vmttakf3i4mfu8.png"><br><br>  und <br><br><img src="https://habrastorage.org/webt/ay/nh/z2/aynhz2dnfulplcfqj1aj0nyqcps.png"><br><br>  Ich hoffe, das Thema mit „Leo Perrin selbst kam auf die Idee, dass die Autoren zufällig nach SBox gesucht haben“ ist jetzt geschlossen. <br><br>  Aus den Erklärungen der Designer folgt daraus <br><br><ol><li>  Sie haben die SBox wirklich pseudozufällig gesucht (gegebene Sicherheitskriterien) </li><li>  Es wurde angeblich keine versteckte Struktur hineingelegt. </li></ol><br>  Und an diesem Ort haben sie es gründlich vermasselt. <br><br><h2>  Was ist eine Struktur? </h2><br>  Eine Struktur, wie sie auf eine Nachschlagetabelle angewendet wird, ist ein Algorithmus, der diese Tabelle beschreibt. <br><br>  Das Dokument erwähnte AES.  Die Nachschlagetabelle für AES wurde jedoch ursprünglich nicht durch zufällige Suche erstellt, sondern mithilfe mehrerer mathematischer Techniken, mit denen wir eine nichtlineare Ebene mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mehreren Formeln beschreiben konnten</a> .  Dies ist übrigens die Einzigartigkeit von AES. <br><br>  Im Gegenteil, wenn Sie zufällig nach SBox suchen, sollte es <b>keine</b> solchen Strukturen geben, und das Problem bei Grasshopper SBox ist, dass sich die Wörter der Algorithmus-Designer stark von den Fakten unterscheiden.  Ich habe in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">früheren Artikel</a> über die Struktur einer Heuschrecke namens TKLog geschrieben. Dieses Mal wollen wir über Strukturen im Allgemeinen sprechen. <br><br><h2>  Kolmogorov Komplexität </h2><br>  Dies ist das Ergebnis von Untersuchungen aus Leo Perrins <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neuestem Artikel</a> über die Heuschrecke. <br><br>  Das Hauptgegenargument zu Artikeln über Strukturen in Grasshopper SBox ist, dass "in fast jeder SBox eine Struktur gefunden werden kann, wenn Sie möchten".  Und "obwohl die Wahrscheinlichkeit, die von Leo gefundene Struktur zu finden, vernachlässigbar ist, würde es eine andere SBox geben, wenn es eine andere SBox gäbe, auch mit einer unbedeutenden Wahrscheinlichkeit." <br><br>  Nehmen wir an, das ist so.  Aber.  Wie sich herausstellte, ist es möglich, einen bestimmten „Grad an Strukturiertheit“ von SBox abzuleiten, der nicht von der Wahrscheinlichkeit abhängt, in die eine oder andere Struktur zu fallen. <br><br>  Dies hängt jedoch von der Größe des Algorithmus ab, der zur Generierung dieser SBox benötigt wird! <br><br>  Dies nennt man die Kolmogorov-Komplexität. <br><br>  Wenn Sie sich SBox als eine Zeichenfolge von Bytes vorstellen, sollte es im Fall einer zufälligen Zeichenfolge keinen Algorithmus geben, der diese Zeichenfolge generiert und gleichzeitig kleiner als diese Zeichenfolge ist. <br><br><h2>  Für eine Heuschrecke </h2><br>  Die Größe von SBox beträgt also 256 Bytes.  Hier ist eine lesbare Version des Autorencodes von Leo Perrin, der die Grasshopper-Tabelle implementiert.  Am Eingang befindet sich das Quellbyte, am Ausgang das entsprechende Byte von der Grasshopper SBox.  Die Hauptbedingung für einen solchen Algorithmus ist ein Verbot der Verwendung von Sprach- oder Plattformstrukturen, die die Größe des Programms betrügerisch reduzieren.  Wenn sich beispielsweise irgendwo in der Standardbibliothek eine Konstante befindet, die die Hälfte von SBox enthält, können Sie sie nicht verwenden. <br><br>  Herausforderung - Schreiben Sie ein Programm, das kleiner als SBox ist. <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x)</span></span></span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>
        s[]={<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">221</span></span>,<span class="hljs-number"><span class="hljs-number">146</span></span>,<span class="hljs-number"><span class="hljs-number">79</span></span>,<span class="hljs-number"><span class="hljs-number">147</span></span>,<span class="hljs-number"><span class="hljs-number">153</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">68</span></span>,<span class="hljs-number"><span class="hljs-number">214</span></span>,<span class="hljs-number"><span class="hljs-number">215</span></span>,<span class="hljs-number"><span class="hljs-number">78</span></span>,<span class="hljs-number"><span class="hljs-number">220</span></span>,<span class="hljs-number"><span class="hljs-number">152</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">69</span></span>},
        k[]={<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">34</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">54</span></span>,<span class="hljs-number"><span class="hljs-number">36</span></span>,<span class="hljs-number"><span class="hljs-number">52</span></span>,<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>};    
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(x) {
        <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> l=<span class="hljs-number"><span class="hljs-number">1</span></span>, a=<span class="hljs-number"><span class="hljs-number">2</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(a!=x) {
            a=(a&lt;&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>)^(a&gt;&gt;<span class="hljs-number"><span class="hljs-number">7</span></span>)*<span class="hljs-number"><span class="hljs-number">29</span></span>;
            l++;
        }
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l%<span class="hljs-number"><span class="hljs-number">17</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">252</span></span>^k[l%<span class="hljs-number"><span class="hljs-number">17</span></span>]^s[l/<span class="hljs-number"><span class="hljs-number">17</span></span>];
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">252</span></span>^k[l/<span class="hljs-number"><span class="hljs-number">17</span></span>];
    }
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">252</span></span>;
}
</code></pre><br>
  ,   SBox   «» , ,        SBox.    416 ,   .<br>
<br>
          ,    :<br>
<br>
<pre><code class="cpp hljs">p(x){
  <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>
      *t=<span class="hljs-string"><span class="hljs-string">"@`rFTDVbpPBvdtfR@\xacp?\xe2&gt;4\xa6\xe9{z\xe3q5\xa7\xe8"</span></span>,
      a=<span class="hljs-number"><span class="hljs-number">2</span></span>,l=<span class="hljs-number"><span class="hljs-number">0</span></span>,b=<span class="hljs-number"><span class="hljs-number">17</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(x &amp;&amp; (l++,a^x)) a=<span class="hljs-number"><span class="hljs-number">2</span></span>*a^a/<span class="hljs-number"><span class="hljs-number">128</span></span>*<span class="hljs-number"><span class="hljs-number">29</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l%b ? t[l%b]^t[b+l/b]^b : t[l/b]^<span class="hljs-number"><span class="hljs-number">188</span></span>;
}
</code></pre><br>
    196 ,    23%    SBox.    .       ,           :<br>
<br>
<pre><code class="cpp hljs">p(x){<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*k=<span class="hljs-string"><span class="hljs-string">"@`rFTDVbpPBvdtfR@\xacp?\xe2&gt;4\xa6\xe9{z\xe3q5\xa7\xe8"</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> l=<span class="hljs-number"><span class="hljs-number">256</span></span>,b=<span class="hljs-number"><span class="hljs-number">17</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(--l*x^l)x=<span class="hljs-number"><span class="hljs-number">2</span></span>*x^x/<span class="hljs-number"><span class="hljs-number">128</span></span>*<span class="hljs-number"><span class="hljs-number">285</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l%b?k[l%b]^k[b+l/b]^b:k[l/b]^<span class="hljs-number"><span class="hljs-number">188</span></span>;}
</code></pre><br>
    SBox     :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; i++){
       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i % <span class="hljs-number"><span class="hljs-number">16</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>){
           <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>);
       }
    <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"%d, "</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)p(i));    
   }
}
</code></pre><br>
   ,       SBox .<br>
     153 .     —  ANSI,       7 ,   8.    1071   ~134 .        ,      .<br>
<br>
   ,    Cortex-M4       <b>80 </b> (    ).<br>
<br>
   ,      <b>  64 </b>.<br>
<br>
<h2> ,   ?</h2><br>
,         ,      .<br>
<br>
  ,  4    Sbox,     SBox ,         .<br>
<br>
 . <b>    ,  « »     AES</b> (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">60 </a>, GolfScript),        .<br>
<br>
      —   .   ,    —   .<br>
<br>
<h2></h2><br>
           — SBox.   ,          .    ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>.<br>
<br>
   (       ),      <b>,    4  ,   SBox</b>. ,  —         ,     .       4    ,   ,       ,  . ,  ,         ,  11            ,           ,    .   ,  side project    ¯\_(ツ)_/¯.<br>
<br>
<h2></h2><br>
  ISO        .             .        .<br>
<br>
  ,     ,      ,       SBox     .        . ,   , .<br>
<br>
      Curve25519 Daniel J. Bernstein  Tanja Lange,     ISO    .  ,     ,    ,     SBox.             .  .<br>
<br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>       ,      .<br>
<br>
    ,        .     ISO,     ,      EuroCrypt.<br>
<br>
 ,              (   SBox),    RFC 7801,    . <br>
<br>
    ,     SBox,           (,   ).    ,      ,      ,   .     V2     .<br>
<br>
    .          ,  «          ,    ».<br>
<br>
       ,    ?   ,  AES -     .<br>
<br>
          ,       , ,  , . .<br>
<br>
<h2>Challenge!</h2><br>
    SBox ,       ,      .    ,    256 .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>.       .   — ,        .<br>
<br>
  — <b>58 </b>   Stax.       « » SBox.<br>
<br>
  .</div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de453254/">https://habr.com/ru/post/de453254/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de453238/index.html">Lauflicht am Relais</a></li>
<li><a href="../de453242/index.html">Spielplatz für Sommerveranstaltungen</a></li>
<li><a href="../de453246/index.html">ERP - Continuous Degradation System</a></li>
<li><a href="../de453248/index.html">Artemis Lunar Mission - Produktion des Hauptelements der Mondorbitalstation Lunar Gateway gestartet</a></li>
<li><a href="../de453252/index.html">Wie wir das Sportmaster Club Programm gemacht haben</a></li>
<li><a href="../de453256/index.html">SObjectizer-5.6.0: Live schneiden, um weiter zu wachsen</a></li>
<li><a href="../de453258/index.html">Erstellen eines Reverb-Pedals mit PT2399-Chips (Teil 1)</a></li>
<li><a href="../de453260/index.html">DPI-Einstellungsfunktionen</a></li>
<li><a href="../de453262/index.html">Wo sind Ihre Konstanten auf dem CortexM-Mikrocontroller gespeichert (am Beispiel des C ++ IAR-Compilers)?</a></li>
<li><a href="../de453264/index.html">Virtuali-Tee: Ein „medizinisches T-Shirt“, das nicht bedeckt, sondern freilegt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>