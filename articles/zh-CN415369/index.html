<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💱 👩🏼‍⚖️ 🕶️ 重构价格 📣 👐🏻 😓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="主观上：重构是一个年轻的“疾病”。 根据个人观察，26年后的某个地方开始放手。 就像那句老话：“他年轻时就不是革命者-他没有一颗心，他没有成为成熟的保守主义者-他没有头脑。” 因此，在我最终放手之前，我将尝试描述重构用户案例以及使用它可以实现的可能目标。 
 启发者 


在下一次查看对150多个文...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>重构价格</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415369/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/2g/am/9h/2gam9hcz7vw9kp-513utyr0ezum.png" height="500"></div> 主观上：重构是一个年轻的“疾病”。 根据个人观察，26年后的某个地方开始放手。 就像那句老话：“他年轻时就不是革命者-他没有一颗心，他没有成为成熟的保守主义者-他没有头脑。” 因此，在我最终放手之前，我将尝试描述重构用户案例以及使用它可以实现的可能目标。 <a name="habracut"></a><br><h2 id="vdohnoviteli"> 启发者 </h2><br><p>在下一次查看对150多个文件的拉取请求之后，我开始写东西，其中激烈地涉及新功能和对现有功能的重构。 重构不仅是表面上的，而且是逻辑上的，这造成了最大的痛苦。 例如，在Ruby中， <code>amount == 0</code>替换为<code>amount.zero?</code> 在没有考虑到数量<code>nil</code>的情况下<code>amount</code>这些构造是不等效的。 所有这些都大致解释如下：“但是根据代码，标准是这样假设的！” 对于逻辑问题“将代码遵循标准的目的是什么，总的来说，您作为开发人员的目标是什么？” 这个男人锁住了自己，并再次犯了些罪恶感，“但是按照代码标准，你必须这样写……”，看上去像一个金发碧眼的服装店，无法应付欲望 <del> 重构 </del> 买东西。 </p><br><h2 id="opredelenie"> 定义 </h2><br><p> 该主题很敏感，因此您需要特别注意“谁是谁”这个问题。 因此， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">根据Wiki</a> ，重构是更改程序内部结构的过程，该过程<u>不影响</u>程序<u>的外部行为</u> ，并且旨在促进对程序工作的理解。 </p><br><p> 就我而言，我想缩小界限并定义重构（从最糟糕的意义上来说）是指与解决的问题不直接相关且不改变系统外部行为的任何更改，而是作为原始任务的一部分执行的。 </p><br><p> 也就是说，我不想谈论代码库的计划变更（已概述了工作范围并已设定特定目标），而是谈论在开发过程中发生的自发修改。 </p><br><h2 id="cennost-produkta"> 产品价值 </h2><br><p> 现在，我将从远处开始。 源代码既不是目标也不是价值。 当然，从美学或艺术角度讲，它可能会引起人们的兴趣，但这是例外。 通常，代码是用于创建任何人都可以使用的软件产品的工具。 因此，对于初学者而言，最好确定产品中的值是多少。 </p><br><h3 id="pryamye-cennosti-produkta"> 直接产品价值 </h3><br><p> 这里的一切都很简单。 他们使用产品，因此直接价值就是用户清楚地感受到/看到/感觉到的东西。 即： </p><br><ol><li> 各种产品功能； </li><li> 可用性（UI / UX，性能，容错等）。 </li></ol><br><p> 第二点可能引起一些讨论。 毕竟，许多人认为这不是主要内容。 由于该功能是否良好，封装在哪都无所谓。 没有理智的UI / UX功能的好例子： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redmine</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SAP</a> 。 但是，我不同意这种看法，并且对<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">艾伦·库珀</a>同志和他的“病人手中的精神病学医院”持不同的看法。 </p><br><h3 id="kosvennye-cennosti-produkta"> 间接产品价值 </h3><br><p> 这些是本身不会影响用户的值。 但是它们可以“射击”或“累积”，并会对产品或其功能产生影响（程度不同）。 </p><br><ol><li> 虫子。 值的临界情况。 它们是次要的，因为值本身并不携带，而是从相邻要素中获取。 </li><li> 清洁度。 这与可读性，模块化，传入组件的最小化，接口的标准化和统一有关。 </li><li> 文献资料 这是关于开发人员的代码和说明，而不是业务说明或用户帐户。 一个采访中一个开朗的农民的话很好地说明了这一点：“数据库中的逻辑就像一本书一样写。” </li><li> 可伸缩性/安全性/安全性。 用户只有在发生不良情况时才能看到它们。 </li></ol><br><h3 id="cennosti-dlya-razrabotchika"> 开发者价值观 </h3><br><p> 这是许多人忽略的非常重要的类别，但它始终会影响结果。 </p><br><ol><li> 按标准代码。 </li><li> 缩进风水。 </li><li> 有良知的其他交易。 毕竟，代码已经编写好了，所以每天都有结果，因此有好处。 </li><li> 符合内部世界规范。 </li></ol><br><p> 但说实话。 所有这些都与与产品和最终用户关联的值无关。 这与心理学和个人蟑螂有关。 </p><br><h2 id="vzglyad-so-storony-biznesa"> 从业务角度看 </h2><br><p> 为了完整起见，必须从业务的角度而不是软件产品的角度来看所有这些。 在这种情况下，直接和间接价值的划分变得很平庸：直接-显然带来了金钱，您可以进行明确的定量评估； 间接的-他们不带钱和/或很难量化； 开发人员的价值不会带来任何形式的收益（甚至可能带走收益）。 </p><br><p> 举个例子 </p><br><ul><li> 带有OAuth增强功能的新功能使注册数量增加了10％，我们获得了+ 1k $。 </li><li> 根据单一责任模式，我们将计费模块分为几个独立的部分。 似乎维护起来更容易了，但是却无法测量。 </li><li> 我们使代码库与代码标准保持一致，而...却一无所获。 </li></ul><br><p> 值得注意的是，根据以上估计，随着心爱的业务加速，普遍的匆忙和不愿将时间投入到除功能性和可能的​​错误修复之外的任何事情上，人们的脚步越来越长。 实际上，可以估计和“出售”直接值，而间接值则非常困难或不可能。 事实证明，间接价值要么通过工程背景实现，要么在直观的水平上被理解，要么被抛为“毫无价值”。 </p><br><p> 公平地讲，在这里我们需要回顾使能器的概念，该实现器为实现所需功能“铺平了道路”，但对用户没有明显的好处。 但这是另一个故事。 </p><br><h2 id="prichyom-tut-refaktoring"> 那重构呢？ </h2><br><p> 至少尽管他只能影响产品的间接价值。 因此，用户不会因任何重构而感觉更好。 </p><br><p> 记住熵也很重要。 重构总是将其最小化。 为了减少熵，理想情况下，您需要一个在设计阶段使熵最小的建筑师团队。 引用《神话人月》中的一篇文章： </p><br><blockquote> 系统编程是一个减少熵的过程，因此其中具有亚稳定性。 程序维护是一个增加熵的过程，即使最熟练的维护也只能延迟系统陷入无望的过时。 </blockquote><p> 因此，如果我们认为重构是程序维护过程的一部分，那么重构次数越少，无需重写的代码将存在的时间越长。 </p><br><h2 id="kakie-celi-mogut-byt-u-refaktoringa"> 重构可以有哪些目标？ </h2><br><p> 让我提醒您，我所说的是功能实施过程中的自发变化，而不是计划中的变化。 在这种情况下，目标的定义完全取决于开发人员。 他必须问自己主要的问题“为什么？”，然后回答，然后朝着预期的目标迈进。 </p><br><h3 id="za-entropiyu"> 为了熵！ </h3><br><p> 自己做很难。 进行审查通常是不现实的。 目标当然是好的：清除取得新成就的桥头堡，并清除产品支持期间积聚的毒素和毒素。 但是，从头开始铲几个模块而又不丢失任何东西并不是一件容易的事。 如果有的话，应该与业务分析师和架构师一起解决。 因此，很少有人冒着自愿进行此操作的风险。 </p><br><h3 id="za-dokumentaciyu"> 对于文档！ </h3><br><p> 这已经很容易了。 重命名变量/函数的原则是“先在框内，然后在框内”，由于语言和库的功能，简化设计，在不明显的地方添加注释等。 这可以单独完成，也可以通过正确的方法对自己和对未来的同事都做得很好。 </p><br><h3 id="za-bystrodeystvie"> 为了速度！ </h3><br><p> 老实说，应将此类工作突出显示为一项单独的任务。 由于该系统的当前功能足以满足您的需要，而您无需执行任何操作，或者您确切知道加速所需的内容和数量。 </p><br><p> 一切都属于此类：从对N +1的无害校正到由于运算算法的更改而导致的严重加速。 整个问题在于错误的“奇偶性”总是处于高速状态。 举个例子：在一个事务中推送数据库中的数据，在同一事务中，在Sidekiq中设置任务；  Sidekiq在Redis中的队列，该事务不适用于它； 当队列速度增加时，有时会在提交数据之前执行任务； 您可以自己想象后果和调试过程。 </p><br><h3 id="za-refaktoring"> 为了重构！ </h3><br><p> 想象一下您使用了公寓清洁服务。 他们来了，开始打扫卫生，但是，一路上，他们把公寓里的所有家具都搬走了，并从客厅到浴缸勾勒出窗帘的轮廓，理由是“在这样的条件下，清洁工做得更好。” 图片来自“ WTF？！” 您可以自己想象。 </p><br><p> 我希望您了解，您不必考虑自己，而应该考虑为谁服务。 </p><br><h2 id="smirenie-i-prinyatie"> 谦虚与接受 </h2><br><p> 总而言之，有必要在重构之前给出一份“手册”。 的确，这不是TODO列表，而是您需要达成共识并接受或不采取行动的事实列表。 </p><br><ol><li> 我正在增加该项目中的错误数量，并且可以为其提供铃鼓。 </li><li> 我成为重构代码的所有者，关于它的所有问题首先将被发送给我。 </li><li> 通过我的行动，我不会为最终用户带来任何有价值的东西。 </li></ol><br><p> 一点解释。 </p><br><ol><li> 对代码进行的任何更改都有非零的机会生成错误。 而且由于此操作与最终功能无关，因此您只需生成错误而无需生成核心价值。 意识到这一点很高兴，不要在遇到问题时假装成软管。 </li><li> 诸如“注释先前的注释”之类的借口非常惨，因为在同一个github / gitlab中没有此类功能。 另外，前一位作者确认，一切都可以在他的配置下进行，并且他对您的更改不承担任何责任，并且丢失了部分正在发生的情况。 更确切地说，您将它与责任一并带走。 </li><li> 用户确实并不关心重构，他对稳定性和功能感兴趣，而重构与之无关。 </li></ol><br><p> 再说一遍：如果您不同意其中至少一项，请不要开始重构。 更好地阅读Habr，Lurk，喝茶，或者最糟的是从仪表板上阅读下一个功能。 </p><br><h2 id="konec"> 结束 </h2><br><p> 不要严格判断。 如果可能，进行建设性批评。 并始终考虑您的行动目的。 谢谢啦 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN415369/">https://habr.com/ru/post/zh-CN415369/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN415359/index.html">PHP 8：期望什么。 Zeev Surasky的信</a></li>
<li><a href="../zh-CN415361/index.html">Firefox将使用k-匿名化方法检查受感染的密码</a></li>
<li><a href="../zh-CN415363/index.html">印度将在2022年之前将绿色能源的生产增加100吉瓦</a></li>
<li><a href="../zh-CN415365/index.html">走吧 或有关设计日期选择器界面的一些知识</a></li>
<li><a href="../zh-CN415367/index.html">如果外星人变成具有人工智能的机器怎么办？</a></li>
<li><a href="../zh-CN415371/index.html">加密货币隐私</a></li>
<li><a href="../zh-CN415373/index.html">Python中的NumPy。 第4部分</a></li>
<li><a href="../zh-CN415375/index.html">藏羊与印刷考古学</a></li>
<li><a href="../zh-CN415377/index.html">JS的工作原理：类和继承，Babel和TypeScript中的转译</a></li>
<li><a href="../zh-CN415381/index.html">与Kubernetes一起玩-熟悉K8s的服务</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>