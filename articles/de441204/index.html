<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öîÔ∏è üë®üèº‚Äç‚úàÔ∏è ‚úäüèø Ein fortschrittlicher Ansatz zum Erkennen von Grenzen am Beispiel von Schiffsw√§nden üßôüèª üôÜ ‚èπÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Interessante Informationen 
 Die folgende Abbildung zeigt eine dreidimensionale Rekonstruktion des Herzens, die als Ergebnis der Arbeit eines modernen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ein fortschrittlicher Ansatz zum Erkennen von Grenzen am Beispiel von Schiffsw√§nden</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inobitec/blog/441204/"><h2>  Interessante Informationen </h2><br>  Die folgende Abbildung zeigt eine dreidimensionale Rekonstruktion des Herzens, die als Ergebnis der Arbeit eines modernen Tomographen erhalten wurde: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uy/7v/fc/uy7vfcx7nzqfq_kqcnmu7xhzipq.png"></div><br>  F√ºr die Skalierung betr√§gt die Dicke des Aortenkolbens 3,2 cm, denken Sie nur!  Wenn Menschen jedoch Herzprobleme aufgrund von Blutgef√§√üen haben, sprechen wir in der Regel nicht √ºber so gro√üe.  Das Bild zeigt, dass das Herz von kleineren Gef√§√üen umgeben ist und einige von ihnen direkt von den gro√üen Arterien abzweigen.  Dies sind die sogenannten Koronararterien, die das Herz direkt mit Blut versorgen.  Wenn bei ihnen beispielsweise aufgrund der Bildung von Kalzium eine Verengung des Lumens (Stenose) auftritt, nimmt der Blutfluss ab.  Wenn eine Stenose ausgepr√§gt ist, tritt eine Gewebenekrose auf, dh ein Herzinfarkt.  Als n√§chstes werde ich √ºber unseren Ansatz zur Berechnung der Grenzen von Blutgef√§√üen sprechen, der es Ihnen erm√∂glicht, die Verengung automatisch zu finden und ihnen eine Sch√§tzung zu geben. <br><a name="habracut"></a><br>  Um das Material zu verstehen, m√ºssen Sie das Volumen, die Voxel und ihre Intensit√§ten oberfl√§chlich verstehen.  Sie k√∂nnen dies herausfinden, indem Sie den Anfang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses Artikels</a> lesen. <br><br>  Um die Verengung eines Gef√§√ües beurteilen zu k√∂nnen, m√ºssen wir das Lumen des Gef√§√ües oder seine innere Grenze kennen.  Erkennen Sie dazu mindestens das gesamte Kalzium.  Wir finden auch die √§u√üere Grenze, weil es m√∂glich ist, die Wandst√§rke abzusch√§tzen, was ebenfalls n√ºtzlich ist.  Schauen wir uns zun√§chst das vollst√§ndige Grenzerkennungsschema an und analysieren dann jede Phase im Detail: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bl/cw/va/blcwvavrk6rpr7dncjp0ydgtxfo.png"></div><br><h2>  Zeichnen der Mittellinie </h2><br>  Die schwierigste Phase in Bezug auf die Implementierung (zumindest hat es die meiste Zeit gedauert).  Die Methode basiert auf der Verwendung einer hessischen Matrix (Multi-Scale Vessel Segmentation Using Hessian Matrix Enhancement).  Weitere Details im bereits erw√§hnten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> . <br><br><h2>  Schneiden </h2><br>  Wir haben nur eine Mittellinie und brauchen r√§umlich abh√§ngige Intensit√§ten von Voxeln, mit denen bequem gearbeitet werden kann.  Um sie zu bekommen, geht ein ‚ÄûStapel‚Äú Scheiben.  F√ºr den Anfang werden Punkte √ºber feste Abst√§nde auf der Mittellinie gesetzt.  Dann wird aus jedem Punkt eine Senkrechte konstruiert <img src="https://habrastorage.org/getpro/habr/post_images/629/d90/498/629d904983c27d11c1874e959481ac0e.svg">  .  Nach ist die zweite Senkrechte <img src="https://habrastorage.org/getpro/habr/post_images/c49/6e6/18d/c496e618db88f915ed3d3fe3e8ffebf5.svg">  .  Wo <img src="https://habrastorage.org/getpro/habr/post_images/715/6f4/21f/7156f421f73f84d8f74072c47d8feb40.svg">  - die Richtung der Mittellinie an einem Punkt.  Beide Senkrechten sind normalisiert.  Zu jedem Zeitpunkt <img src="https://habrastorage.org/getpro/habr/post_images/d76/c4d/c2b/d76c4dc2b17f00a09c864bf2d24ab365.svg">  Mittellinienvektor <img src="https://habrastorage.org/getpro/habr/post_images/ccc/5f9/fa9/ccc5f9fa9ba4fd68b9d82f5f64c964a5.svg">  bilden ein 2d Koordinatensystem.  So werden Scheiben gebildet: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1i/u3/fy/1iu3fy_dalyttcp8pm_5tbmvblu.png"></div><br>  Die Voxelposition ist definiert als <img src="https://habrastorage.org/getpro/habr/post_images/61a/d30/8c1/61ad308c13008a755317c1e29b64d2c5.svg">  wo <img src="https://habrastorage.org/getpro/habr/post_images/038/a72/de3/038a72de3b3aa84f6df45501491024e0.svg">  hier <img src="https://habrastorage.org/getpro/habr/post_images/c85/e97/693/c85e97693d356905ea98d6f6cbacc674.svg">  Sind die reellen Koordinaten des Voxels, ist k die Schichtnummer.  Inverse Formel f√ºr reelle Koordinaten: <img src="https://habrastorage.org/getpro/habr/post_images/797/f2e/fae/797f2efaeb13453aa8d76293b288bd73.svg">  .  Wenn Sie zu einem neuen Koordinatensystem wechseln, wird der durch die Schichten gebildete Raum vereinfacht: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pj/c3/cq/pjc3cqpbmjzhvsb2ioyumlgilam.png"></div><br>  Was wir brauchen! <br><br><h2>  Bau der Au√üengrenze des Schiffes </h2><br>  Schauen wir uns das Diagramm an: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gm/ii/i2/gmiii2tsk4iqtvaolp9y3fhvd9c.png"></div><br>  Wir schneiden unseren Stapel von Scheiben, die wir in der vorherigen Phase erhalten haben, in acht Ebenen (√§hnlich wie beim Schneiden eines Kuchens) und f√ºhren alle Berechnungen im Raum von Ebenen durch: <br><br><div class="spoiler">  <b class="spoiler_title">Schneiden</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ov/jd/db/ovjddbzkgm-vdtrv6gcwzzuao1o.png"></div><br></div></div><br>  Wenn Sie die normalisierten Werte der Intensit√§ten der Voxel anzeigen, die auf die Schnittebene treffen, erhalten Sie das folgende Bild: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ue/nf/km/uenfkmqzel_cvnooctxzi9cl-3m.png"></div><br>  Um die Grenzen des Gef√§√ües zu erkennen, wird der klassische Ansatz (Kantenerkennung durch Gradienten) in Verbindung mit der Suche nach dem Pfad verwendet.  Schema: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kw/tu/ox/kwtuox6hip2d3cu0t65wj_z4fqc.png"></div><br>  1. Wenden Sie die Gau√üsche Gl√§ttung mit einem kleinen Wert an <img src="https://habrastorage.org/getpro/habr/post_images/77c/f13/7bb/77cf137bb0d151fa8fc5a4eb4a7f21e0.svg">  L√§rm unterdr√ºcken: <br>  F√ºr einen Punkt mit Koordinaten <img src="https://habrastorage.org/getpro/habr/post_images/733/058/d18/733058d18a17c8fcbb58bb5b1879082a.svg">  :: <br><img src="https://habrastorage.org/getpro/habr/post_images/2a4/722/67f/2a472267fd4f70baed2798401c41edd6.svg">  wo <img src="https://habrastorage.org/getpro/habr/post_images/7ec/a6c/c6a/7eca6cc6aeb64ba5e76063f0019d9542.svg">  Gibt den Intensit√§tswert an einem Punkt zur√ºck <img src="https://habrastorage.org/getpro/habr/post_images/65c/c1e/d7f/65cc1ed7f6ce98859b0f80176a24fc08.svg">  ;;  r nimmt normalerweise den Wert an <img src="https://habrastorage.org/getpro/habr/post_images/d02/f53/56b/d02f5356b7b9c5234d7c2975efd6a994.svg">  ( <img src="https://habrastorage.org/getpro/habr/post_images/1b6/903/f11/1b6903f1101a871ba3ba64fe1924f873.svg">  - Aufrunden); <img src="https://habrastorage.org/getpro/habr/post_images/77c/f13/7bb/77cf137bb0d151fa8fc5a4eb4a7f21e0.svg">  - Gl√§ttungskoeffizient. <br><br>  2. An jedem Punkt finden wir den Gradienten und seinen Wert, die Berechnungen werden mit gegl√§tteten Intensit√§tswerten durchgef√ºhrt: <br><img src="https://habrastorage.org/getpro/habr/post_images/9d3/c90/939/9d3c9093937e8aff5520ded5071984ac.svg">  , <br>  wo <img src="https://habrastorage.org/getpro/habr/post_images/698/280/401/6982804016ef30ecdc8ac8fddeb72c4e.svg">  - private Derivate.  Sie werden nach der Finite-Differenzen-Methode gefunden: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/791/209/8dc/7912098dc806f588c1458ad8b9faabdc.svg">  , <br>  wo <img src="https://habrastorage.org/getpro/habr/post_images/b20/94b/690/b2094b69077bfe82f7dca9f140480d0b.svg">  - Intensit√§t an einem Punkt <img src="https://habrastorage.org/getpro/habr/post_images/65c/c1e/d7f/65cc1ed7f6ce98859b0f80176a24fc08.svg">  nach dem Gl√§tten. <br>  Als n√§chstes brauchen wir die Richtung des Gradienten <img src="https://habrastorage.org/getpro/habr/post_images/341/0a9/910/3410a9910584413131b3320a186f314b.svg">  ( <img src="https://habrastorage.org/getpro/habr/post_images/64b/66b/58e/64b66b58e46e62b07ecb6e7b86851d21.svg">  Ist die Normalisierung des Vektors) und der Wert des Gradienten <img src="https://habrastorage.org/getpro/habr/post_images/e64/fb2/3c8/e64fb23c8f2225d8f538813e1fe4cbb3.svg">  ( <img src="https://habrastorage.org/getpro/habr/post_images/06d/0ad/537/06d0ad537ee5254e1af0392adeb5008d.svg">  Ist die L√§nge des Vektors) <br><br>  3. Die Richtung des Gradienten wird in Grad oder Bogenma√ü umgerechnet: <br><img src="https://habrastorage.org/getpro/habr/post_images/89d/fd2/c8a/89dfd2c8ab531ad40fd223765fac9596.svg">  (atan2 () ist die Funktion der Bogen-Tangente in C ++, nicht zu verwechseln mit atan ()). Dann runden wir den Winkel so, dass er 4 Werte in Schritten von 45 Grad haben kann, d. h.  oben und unten werden in die gleiche Richtung betrachtet: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/t3/tq/jx/t3tqjxxfdgjsdqubxdputqzbh8w.jpeg"></div><br>  4. F√ºhren Sie die Unterdr√ºckung von Nichtmaxima durch.  Ist der Gradientenwert <img src="https://habrastorage.org/getpro/habr/post_images/e64/fb2/3c8/e64fb23c8f2225d8f538813e1fe4cbb3.svg">  Wenn mindestens einer von zwei benachbarten Punkten (entsprechend der Richtung des Gradienten) gr√∂√üer oder gleich dem Gradientenwert am aktuellen Punkt ist, kann ein solcher Punkt nicht zur Grenze geh√∂ren: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bf/0d/tf/bf0dtfvisx3vymgm2fjjpj7cbxe.png"></div><br>  5. Alle verbleibenden Voxel gelten als Grenzen.  Basierend auf dem Wert des Gradienten, der Kalziumschwelle (die nicht sofort verf√ºgbar ist) und der N√§he zum ‚Äûvertikalen‚Äú Zentrum werden jedem Punkt bestimmte Kosten zugewiesen (je heller das Voxel, desto h√∂her ist seine Priorit√§t bei der Suche nach einem Pfad): <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ad/wn/ng/adwnng9jtvu5knuetwbngyhubq8.png"></div><br>  In dieser Form sind die Grenzen des Gef√§√ües fast eindeutig definiert. <br><br>  6, 7. Um Grenzen zu bilden, verwenden wir die Suche nach dem Pfad.  Die n√§chstgelegenen Extrempunkte mit den geringsten Kosten werden als Anfangs- und Endpunkt genommen.  Verwenden Sie zum Suchen nach einem Pfad eine einfache Breitensuche, bei der die Grenzpunkte mit den geringsten Kosten ausgew√§hlt werden.  Spr√ºnge sind ebenfalls verf√ºgbar, aber ihr Preis ist hoch.  Die oberen und unteren Grenzen des Gef√§√ües werden getrennt durchsucht und anschlie√üend gegl√§ttet: <br><br><div class="spoiler">  <b class="spoiler_title">Ergebnis</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/t_/67/_u/t_67_u6vbtpbn5nthgj1uzfglle.png"></div><br></div></div><br>  Diese Prozedur wird f√ºr jede Ebene durchgef√ºhrt, was zu Ringen mit 16 Segmenten f√ºr jede Scheibe im Stapel f√ºhrt.  Diese Ringe bilden die √§u√üeren R√§nder des Gef√§√ües. <br><br>  Wie Sie auf dem Bild sehen k√∂nnen, gibt es Bereiche, in denen die R√§nder falsch erkannt werden.  Dies ist auf das Vorhandensein von Kalzium zur√ºckzuf√ºhren, das zum Nachweis von Kalziumgrenzen und nicht von Gef√§√ügrenzen f√ºhrt.  Um dies nach dem ersten Erkennen von Grenzen zu verhindern, muss die Kalziumschwelle bestimmt werden (dazu sp√§ter mehr) und anschlie√üend die zweite Erkennung von Grenzen durchgef√ºhrt werden, wobei die mit Kalzium verbundenen Voxel ignoriert werden.  Dann bekommen wir: <br><br><div class="spoiler">  <b class="spoiler_title">Gutes Ergebnis</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/we/tz/7pwetz2lmrhzbikdhjpjmwsc7rw.png"></div><br><h2>  Erkennung von Schwellenwerten f√ºr innere, √§u√üere Grenzen und Kalziumschwellen </h2><br>  Nachdem die Au√üengrenze bekannt ist, m√ºssen wir statistische Informationen sammeln.  N√§mlich die Intensit√§ten aller Voxel, die sich im Gef√§√ü befinden. <br></div></div><br><h2>  Schwellenwerterkennung </h2><br>  Betrachten Sie nun die Maximierung der Clustering-Algorithmus-Erwartung (im Folgenden als EM bezeichnet).  Beginnen wir mit der Normalverteilungsfunktion: Sie zeichnet sich durch eine mathematische Erwartung aus <img src="https://habrastorage.org/getpro/habr/post_images/849/a42/16c/849a4216c1bc55877bc86f4a97513f7a.svg">  und Standardabweichung <img src="https://habrastorage.org/getpro/habr/post_images/77c/f13/7bb/77cf137bb0d151fa8fc5a4eb4a7f21e0.svg">  .  So wirken sie sich auf die Art der Verteilung aus: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1f/vg/gj/1fvggjfo2r_nz87bzdb3kngomri.gif"></div><br><br>  Angenommen, wir haben Daten (Punkte), die aus einer ‚Äûgelben‚Äú Quelle und aus einer ‚Äûblauen‚Äú Quelle stammen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rw/9q/er/rw9qern6glz7e696mx7k1sviuom.png"></div><br>  Dann finden wir unter Verwendung von Standardformeln leicht den Mittelwert und die Standardabweichung f√ºr jede Quelle.  Formeln f√ºr Quelle "a": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c13/a5b/94d/c13a5b94d8d81bc4353b884bc8970aeb.svg"><br><img src="https://habrastorage.org/getpro/habr/post_images/154/906/8ae/1549068ae55c21dcb6e7efa2d3185f56.svg"><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4x/js/jx/4xjsjxajyvozdnueljew75whnyg.png"></div><br>  Was aber, wenn wir die Anzahl der Quellen kennen, aber nicht wissen, welche Punkte zu welcher Quelle geh√∂ren?  Was ist, wenn wir so ein Bild haben? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ei/cb/9a/eicb9atkan-akjv2zgp9rodyow0.png"></div><br>  Wenn jemand kam und uns die Verteilungsparameter mitteilte, konnten wir leicht die Wahrscheinlichkeit berechnen, dass jeder Punkt zu jeder der Quellen geh√∂rt.  Die Wahrscheinlichkeit, dass der Punkt zur Quelle ‚Äûa‚Äú geh√∂rt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c24/2eb/8d9/c242eb8d94d7b7a7ad237c8509b54d65.svg">  wo <br><br><img src="https://habrastorage.org/getpro/habr/post_images/75c/129/b81/75c129b8112508e711b04727e48b05d3.svg"><br><img src="https://habrastorage.org/getpro/habr/post_images/7b0/a47/b22/7b0a47b2227447f62daaf67a8fc519b0.svg"><br><br>  Und wenn wir die Quellparameter berechnen m√ºssen, kennen wir die Wahrscheinlichkeiten: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb6/eee/7f9/cb6eee7f9578ca134c470c445f69bdd6.svg"><br><img src="https://habrastorage.org/getpro/habr/post_images/bf3/2e7/ed5/bf32e7ed508e6dcd536ee3fe6ab63f32.svg"><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ws/ok/gf/wsokgf4bevva43d9cxzhktmzzws.png"></div>  So entsteht ein Teufelskreis: Wenn wir die Parameter der Quellen kennen w√ºrden, w√ºrden wir berechnen, welcher Punkt zu welcher Quelle geh√∂rt, aber wir kennen die Parameter nicht.  Und wenn wir w√ºssten, welcher Punkt zu welcher Quelle geh√∂rt, w√ºrden wir ihre Parameter berechnen, aber wir wissen nicht, welcher Punkt zu welcher Quelle geh√∂rt.  Das Abw√§gen zwischen diesen Tatsachen ist genau das, was der EM-Algorithmus tut. <br><br>  Beim Start erh√§lt EM einige vordefinierte Parameter f√ºr Quellen, die einfach zuf√§llig ausgew√§hlt werden k√∂nnen.  Wenn die Parameter bekannt sind, k√∂nnen wir nat√ºrlich die Wahrscheinlichkeit berechnen, dass jeder Punkt zu jeder der Quellen geh√∂rt.  Nachdem die Wahrscheinlichkeiten bekannt sind, k√∂nnen wir neue genauere Parameter berechnen.  Dann geht es wieder von vorne los, aber mit neuen Parametern.  Nach jedem Zyklus werden die Parameter der Quellen genauer. <br><br>  Wie k√∂nnen wir dieses Wissen in Bezug auf Schiffe nutzen?  Werfen wir einen Blick auf die Struktur eines von ihnen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/il/st/gqilstduy1jpu4f_e7wiu0hns2g.png"></div>  In Diagrammen wird dieser Punkt normalerweise weggelassen, es k√∂nnen jedoch auch Fett- und Kalziumbildungen im Gef√§√ü vorhanden sein.  Somit geh√∂rt jedes Voxel zu einem der Gewebe.  Nach den Experimenten stellte sich heraus, dass es ausreicht, folgende Unterteilungen vorzunehmen: <br><br>  - Fett <br>  - Wand Nr. 1 <br>  - Wand Nr. 2 <br>  - Kontrastmittel <br>  - Kalzium <br><br>  Die Verteilung der Voxelintensit√§ten ist jeweils normal.  Das hei√üt,  Wir haben alles, was wir brauchen, um mit EM die Parameter jeder Quelle zu finden. <br><br><div class="spoiler">  <b class="spoiler_title">Die Ergebnisse sind gut genug</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f3/ht/_o/f3ht_obxm187_gnzmu8aue4sbbg.png"></div><br>  Die gr√ºne Linie ist ein Histogramm der Intensit√§ten, die rote Linie ist das resultierende mathematische Modell. <br></div></div><br>  Nachdem wir die Parameter jeder Quelle kennen, k√∂nnen wir die Schwellenwerte berechnen - die Werte der Intensit√§ten, an deren Schnittpunkt sich die Voxelmitgliedschaft von einer Quelle zur anderen √§ndert.  Wir interessieren uns f√ºr: <br><br>  1. Die Schwelle der Au√üengrenze des Schiffes.  Wenn die Voxelintensit√§t unter diesem Wert liegt, wird angenommen, dass sie √ºberhaupt nicht zum Gef√§√ü geh√∂rt; <br><br>  2. Die Schwelle der inneren Grenze des Schiffes.  Wenn die Voxelintensit√§t gr√∂√üer als dieser Wert ist, dann ist es <br>  bezieht sich auf das Lumen des Gef√§√ües, d.h.  zu einer Mischung aus Blut und Kontrastmittel; <br><br>  3. Die Schwelle von Kalzium.  Wenn der Wert der Voxelintensit√§t gr√∂√üer als dieser Wert ist, bezieht er sich auf Calcium. <br><br><h2>  Konstruktion der inneren Grenze des Schiffes </h2><br>  Beginnen wir wie immer mit dem Diagramm: F√ºr jedes Slice werden Berechnungen durchgef√ºhrt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8a/-m/9v/8a-m9vgz6e1vywymf8xsnckgm4m.png"></div><br><br>  Wenn Sie die Daten gem√§√ü den im vorherigen Schritt ermittelten Schwellenwerten visuell anzeigen, erhalten Sie das folgende Bild: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gi/qr/uf/giqrufs9lrd7j1rup_-8ckjkpww.png"></div><br><br>  Rote Farbe ist die Wand des Gef√§√ües.  Gr√ºne Farbe - Abstand.  Wei√ü ist Kalzium. <br><br>  Das erste, was auff√§llt, ist das ‚Äûh√§ngende‚Äú Kalzium, das an keine der W√§nde angrenzt.  Dies wird als normal angesehen und ergibt sich aus der vom Tomographen selbst angewendeten Gl√§ttung. <br><br>  Zuerst m√ºssen Sie die Grenzen gem√§√ü den Schwellenwerten ermitteln, und hierf√ºr wird der Algorithmus f√ºr Marschquadrate verwendet.  Es kann gesagt werden, geht in zwei Stufen.  Zun√§chst wird die Fl√§che durch ein diskretes Gitter geteilt, und die Quadrate, in denen die Intensit√§tswerte gr√∂√üer oder gleich dem Schwellenwert sind, werden als "positiv" betrachtet, der Rest als "negativ". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3q/4f/rq/3q4frqwpj7hnj5nu-mu2fintttq.png"></div>  Jedes Mal befinden wir uns in einer Art Knoten und m√ºssen eine Kontur um die ‚Äûpositiven‚Äú Quadrate zeichnen.  Um eine Entscheidung zu treffen, betrachten wir die Vorzeichen von vier benachbarten Quadraten: oben links, unten links, oben rechts, unten rechts.  Ohne Symmetrie interessieren uns drei F√§lle. <br><br>  1. Drei Quadrate mit einem Zeichen und einem gegen√ºberliegenden, die Bewegung der Kontur erfolgt diagonal: <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/j7/si/y_/j7siy_5nyv_vu-zjkt6lrxwtgwi.png"><br></div></div><br>  2. Zwei Quadrate mit demselben Vorzeichen und zwei gegen√ºberliegenden und die Quadrate mit demselben Vorzeichen befinden sich auf einer Seite. Die Bewegung der Kontur ist vertikal oder horizontal: <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ky/4u/0c/ky4u0chgxifkj8cbmysyygdmcwg.png"><br></div></div><br>  3. Zwei Quadrate mit demselben Zeichen und zwei gegen√ºberliegende Quadrate mit demselben Zeichen werden auf gegen√ºberliegenden Seiten platziert: <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ak/jc/fn/akjcfnqk3ekjhnynsk8gaqlpgu0.png"><br></div></div><br>  Dies ist ein Ausnahmefall. Um eine Entscheidung zu treffen, wird der Durchschnittswert der Intensit√§t in allen vier Quadraten ermittelt. Wenn er gr√∂√üer oder gleich dem Schwellenwert ist, ist das Zentrum positiv, in anderen F√§llen negativ.  Es ist auch wichtig, welcher Knoten gerade aktuell ist: <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8r/qd/5m/8rqd5mrjzqmdivmw_dpyxpqbkbu.png"><img src="https://habrastorage.org/webt/tp/uf/y9/tpufy92j4dfe3vtindh4blsi-su.png"><br></div></div><br>  Der Marschquadrat-Algorithmus konstruiert genau und eindeutig eine Kontur.  Im folgenden Beispiel habe ich die Linie absichtlich von der Mitte der Seite verschoben, sodass jeder Schritt deutlich sichtbar war. <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/gg/41/ld/gg41ldwyplhod11zpgqblopf7ho.png"></div>  Insbesondere der erste und der zweite Fall: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fa/wq/oy/fawqoy8amtn9paiodwj6jowzql8.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ra/1l/md/ra1lmdd4wobzgjt9tgyp7rzxznc.png"></div><br></div></div><br>  F√ºr jeden Abschnitt des Schiffes finden wir zwei Hauptkonturen - dies ist die Kontur des √§u√üeren Randes und die Kontur des inneren Randes.  Wir ‚Äûschneiden‚Äú sofort die Au√üenkontur mit unserer anderen Au√üenkontur, die wir am Anfang des Artikels gefunden haben, indem wir nach Pfaden gesucht haben.  Dies geschieht, um die Zweige des Schiffes zu ignorieren.  Wir ignorieren die Konturen von Kalzium, die zu weit von der Innenwand entfernt sind, als ob sie √ºberhaupt nicht existieren. Wir finden den Rest und verwenden sie in Zukunft.  Wenn sich das Zentrum des Gef√§√ües innerhalb des Kalziums befindet, verschieben wir es in die Richtung, die dem Kalziumkreislauf am n√§chsten liegt, bis sich das Zentrum im Lumen befindet (im gr√ºnen Bereich).  Solch ein aktualisiertes Zentrum werde ich die Startposition nennen. <br><br>  Nach dem Schema kann es zwei F√§lle geben: einfache und komplexe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ac/qq/1c/acqq1c5bc1mqei30gplmu2z2gok.png"></div><br>  Befindet sich die Startposition innerhalb einer geschlossenen Kalziumschleife (z. B. wenn ein Stent installiert ist), setzen wir den inneren Rand sofort dieser Schleife gleich.  Die Dinge sind komplizierter, wenn sich das Zentrum au√üerhalb von Kalzium befindet.  In diesem Fall m√ºssen wir den Startkreis erweitern, damit er reibungslos um Kalzium und die innere Grenze flie√üt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mz/ds/5w/mzds5whlkw7e3tffnl5crfvd-vk.gif"></div><br>  Um das gew√ºnschte Ergebnis zu erzielen, wurde ein spezieller Algorithmus entwickelt, der auf Ideen basiert, die in physikalischen 2D-Engines verwendet werden, insbesondere auf der L√∂sung von Polygonkollisionen und dem Satz √ºber separate Achsen. <br><br>  Zwei grundlegende Konzepte, auf die nicht verzichtet werden kann: F√ºr sich √ºberschneidende konvexe Polygone ist der MTV-Vektor (minimaler Translationsvektor) die kleinste Verschiebung eines der Polygone, nach der der Schnittpunkt stoppt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/yh/_9/nsyh_9qufvxdkohpt_fsjejwdx8.png"></div>  Wir brauchen auch die Polygonnormalen - in 2D stehen sie senkrecht zu den Fl√§chen und zeigen "out" an: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y3/fc/fi/y3fcfiywkig3dbgrxkhw9twh1gk.png"></div>  Um den Artikel nicht lang zu machen, werde ich den Rest der Details zu physischen Motoren weglassen.  Das einzige, was ich bemerke, ist, dass w√§hrend jeder Iteration jeder Punkt in der Kontur den Einfluss von Kr√§ften auf sich selbst in Form eines Vektors akkumuliert und sich am Ende jeder Iteration um die L√§nge dieses Vektors in seine Richtung verschiebt.  Betrachten Sie die Kr√§fte: <br><br>  1. Auf jeden Scheitelpunkt der Startkontur wirken zwei Kr√§fte in Richtung benachbarter Scheitelpunkte, und die Kr√§fte sind direkt proportional zum Abstand zu diesen Scheitelpunkten.  Dadurch schrumpft der Umriss und versucht, eine abgerundete Form beizubehalten. <br><br>  2. Wenn der Scheitelpunkt der Seitenkontur in die Startkontur f√§llt, wird der Versatz proportional zum Scheitelpunkt-MTV-Vektor des Scheitelpunkts auf die n√§chste Fl√§che der Startkontur angewendet. <br><br>  3. Befindet sich die Oberseite der Startkontur innerhalb der Seitenkontur, wird ein Versatz proportional zum Scheitelpunkt-MTV-Vektor des Scheitelpunkts auf die Oberseite der Startkontur angewendet.  Zusammen mit dem vorherigen Absatz erlaubt dies nicht, dass die Schaltung die Grenzen anderer Schaltungen √ºberschreitet; <br><br>  4. Wenn die F√§lle 2 und 3 f√ºr den Scheitelpunkt nicht funktionierten, wird eine Kraft in der gemittelten Richtung der beiden Normalen benachbarter Fl√§chen auf ihn ausge√ºbt.  Dies stellt das Wachstum der Kontur "in der Breite" sicher. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lz/by/zx/lzbyzx2rujiluinvtom2jj6tana.png"></div>  Wichtig: Sie k√∂nnen einen Scheitelpunkt oder eine Fl√§che nicht vollst√§ndig um die L√§nge des MTV-Vektors verschieben - er wird mit einem bestimmten Koeffizienten im Bereich von 0,2 bis 0,8 multipliziert.  Die Koeffizienten f√ºr jede Kraft in den √ºbrigen F√§llen werden experimentell ausgew√§hlt. <br><br>  Dank dieses Ansatzes finden wir das Lumen des Gef√§√ües unter Ber√ºcksichtigung der Tatsache, dass Kalzium nicht in der N√§he der W√§nde angrenzt.  Kombinieren Sie nun einfach die Ergebnisse aus allen Abschnitten und erhalten Sie die inneren und √§u√üeren R√§nder des Schiffes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/4z/z7/gv4zz7jnpkx4jdrb1ojm8xojcce.png"></div><br>  Die offensichtliche Ungenauigkeit der Grenze nach dem Stent wird durch eine anomale Gabelung verursacht: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ub/i-/cx/ubi-cxfe-hfuys8ufibs97o8xes.png"></div><br>  Der Bereich des inneren Randes am Schnitt kennzeichnet genau den Abstand, an dem wir letztendlich interessiert sind.  Die weitere Verwendung dieser Daten halte ich f√ºr trivial und bedarf keiner Ber√ºcksichtigung.  Zum Schluss lasse ich das Bild des exportierten inneren Randes in 3D: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bl/cv/g4/blcvg4klqzx9imn2qcgw6cizyay.png"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de441204/">https://habr.com/ru/post/de441204/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de441192/index.html">Verwendung der Rechenleistung von R zum Testen der Hypothese der Mittelgleichheit</a></li>
<li><a href="../de441194/index.html">Buch "GraphQL: Abfragesprache f√ºr moderne Webanwendungen"</a></li>
<li><a href="../de441196/index.html">Auf wen und f√ºr was werden Boten "klopfen"</a></li>
<li><a href="../de441198/index.html">Spiraldynamik von Scrum und Graves: Wie man nicht auf Riffe st√∂√üt</a></li>
<li><a href="../de441202/index.html">Tr√§umen Dienstleistungsunternehmen von ihren Produkten? Gespr√§ch mit Maxilect</a></li>
<li><a href="../de441206/index.html">Wolfensteiny 3D - Reverse Engineering 251 Bytes JavaScript</a></li>
<li><a href="../de441208/index.html">Wie wir die Kreditvergabe auf 2 Klicks reduziert haben</a></li>
<li><a href="../de441210/index.html">Cluster-Speicher Schrittmacher + DRBD (Dual Primary) + Samba</a></li>
<li><a href="../de441212/index.html">Arbeiten Sie mit kryptografischem Informationsschutz und Hardwareschl√ºsseltr√§gern unter Linux</a></li>
<li><a href="../de441214/index.html">Kibana Benutzerhandbuch. Visualisierung. Teil 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>