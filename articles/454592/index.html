<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äç‚öïÔ∏è üß† üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø WAF a trav√©s de los ojos de los hackers üë®üèº‚Äçüç≥ üë®‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® ü¶Ñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy vamos a hablar sobre uno de los mecanismos de seguridad modernos para aplicaciones web, a saber, Web Application Firewall (WAF). Analizaremos los ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>WAF a trav√©s de los ojos de los hackers</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/454592/"><img align="left" src="https://habrastorage.org/webt/nx/mm/yz/nxmmyzb6nr39jk_zmiu5wcnylbm.png">  Hoy vamos a hablar sobre uno de los mecanismos de seguridad modernos para aplicaciones web, a saber, Web Application Firewall (WAF).  Analizaremos los WAF modernos y en qu√© se basan, as√≠ como las t√©cnicas de derivaci√≥n, c√≥mo usarlos y por qu√© nunca debe confiar completamente en WAF.  Estamos hablando desde la perspectiva de los pentesters;  nunca desarrollamos WAF y solo recopilamos datos de fuentes abiertas.  Por lo tanto, solo podemos referirnos a nuestra propia experiencia y podemos desconocer algunas peculiaridades de los WAF. <br clear="left"><a name="habracut"></a><br><hr><br><br>  <i>Descargo de responsabilidad: esta es una traducci√≥n del art√≠culo del ruso al ingl√©s, el art√≠culo fue lanzado a fines de 2017, respectivamente, alguna informaci√≥n podr√≠a quedar desactualizada.</i> <br><br><h4>  Contenido </h4><br><ol><li>  Introduccion </li><li>  El moderno WAF </li><li>  Identificando WAF </li><li>  Hoja de trucos de bypass WAF </li><li>  WAF bypass en la pr√°ctica </li><li>  Conclusi√≥n </li></ol><br>  <i>Si sabe por qu√© se utilizan WAF y c√≥mo funcionan, puede saltar directamente a la secci√≥n de derivaci√≥n.</i> <br><br><h2>  Introduccion </h2><br>  Los WAF se han vuelto muy populares recientemente.  Los proveedores ofrecen varias soluciones en diferentes rangos de precios, kits de distribuci√≥n y opciones, dirigidos a diferentes clientes, desde peque√±as empresas hasta grandes empresas.  Los WAF son populares porque son una soluci√≥n compleja para proteger aplicaciones web, que cubre todo un espectro de tareas.  Es por eso que los desarrolladores de aplicaciones web pueden confiar en WAF en algunos aspectos de seguridad.  Aunque, los WAF no pueden otorgar seguridad total. <br><br><img src="https://habrastorage.org/webt/59/e3/95/59e395af93092095133873.png"><br><br>  Entonces, ¬øde qu√© debe ser capaz un WAF para justificar su implementaci√≥n en un proyecto?  Su funci√≥n principal es detectar y bloquear cualquier solicitud que, seg√∫n el an√°lisis de WAF, tenga alguna anomal√≠a o un vector de ataque.  El an√°lisis no debe obstaculizar la interacci√≥n entre usuarios leg√≠timos y la aplicaci√≥n web, al mismo tiempo, debe detectar de manera precisa y oportuna cualquier intento de ataque.  Para implementar dicha funcionalidad, los desarrolladores de WAF utilizan expresiones regulares, tokenizadores, an√°lisis de comportamiento, an√°lisis de reputaci√≥n y, por supuesto, aprendizaje autom√°tico.  A menudo, todas estas tecnolog√≠as se usan juntas.  WAF tambi√©n puede implementar otras funciones: protecci√≥n DDoS, prohibici√≥n de las IP de los atacantes, monitoreo de IP sospechosas, agregar encabezados de seguridad (X-XSS-Protection, X-Frame-Options, etc.), agregar banderas de solo http a la cookie, implementaci√≥n de El mecanismo HSTS y los tokens CSRF.  Adem√°s, algunos WAF tienen m√≥dulos del lado del cliente JavaScript para sitios web. <br><br>  Por supuesto, los WAF crean algunos obst√°culos para los hackers y pentesters.  WAF hace que la b√∫squeda y explotaci√≥n de vulnerabilidades sea m√°s intensiva en recursos (excepto si el atacante conoce m√©todos efectivos de omisi√≥n de 0 d√≠as para un WAF espec√≠fico).  Los esc√°neres autom√°ticos son pr√°cticamente in√∫tiles al analizar aplicaciones web protegidas por WAF.  WAF es una protecci√≥n confiable contra "scriptkiddies".  Sin embargo, un hacker experimentado o un investigador sin suficiente motivaci√≥n probablemente no querr√≠a perder el tiempo tratando de encontrar formas de evitarlo.  Cabe se√±alar que cuanto m√°s compleja es la aplicaci√≥n web, mayor es su superficie de ataque y m√°s f√°cil es encontrar un m√©todo de derivaci√≥n. <br><br>  En nuestras auditor√≠as recientes, a menudo encontramos diferentes WAF.  Hablaremos de algunos de ellos m√°s tarde.  Ya hemos probado dos WAF patentados en dos escenarios principales: <br><br><ul><li>  Sabemos que hay una cierta vulnerabilidad en una aplicaci√≥n web y tratamos de evitar el WAF para explotarla; </li><li>  No conocemos ninguna vulnerabilidad, por lo que debemos encontrar una a pesar del WAF y luego explotarla sin pasar por WAF. </li></ul><br>  Pero primero, echemos un vistazo m√°s de cerca a los mecanismos b√°sicos detr√°s de WAF y veamos qu√© problemas tienen. <br><br><h2>  El moderno WAF </h2><br>  Para poder encontrar efectivamente varias formas de evitar WAF, primero, necesitamos encontrar mecanismos modernos de clasificaci√≥n de solicitudes.  Cada WAF es espec√≠fico y est√° construido de manera √∫nica, pero existen algunos m√©todos generales de an√°lisis.  Echemos un vistazo a esos. <br><br><img src="https://habrastorage.org/webt/59/e3/95/59e395af93c4f468367566.png"><br><br><h4>  Reglas basadas en expresiones regulares </h4><br>  La mayor√≠a de los WAF existentes usan reglas basadas en expresiones regulares.  El desarrollador investiga un cierto conjunto de ataques conocidos para identificar estructuras sint√°cticas clave que podr√≠an apuntar a un ataque.  En base a estos datos, el desarrollador crea expresiones regulares que encuentran tales estructuras sint√°cticas.  Suena simple, pero este m√©todo tiene ciertos inconvenientes.  Primero, una expresi√≥n regular se puede aplicar a una sola solicitud, o incluso a un solo par√°metro de solicitud, lo que obviamente reduce la eficiencia de tales reglas y deja algunos puntos ciegos.  En segundo lugar, la sintaxis de las expresiones regulares y la l√≥gica compleja de los protocolos de texto, que permite el reemplazo de estructuras equivalentes y el uso de diferentes representaciones de s√≠mbolos, generan errores al crear estas reglas. <br><br>
<h4>  Construcci√≥n de puntajes </h4><br>  Aquellos que saben c√≥mo funcionan los firewalls y los antivirus de la red deben estar familiarizados con este mecanismo.  No detecta ataques, pero complementa otros mecanismos haci√©ndolos m√°s precisos y flexibles.  La cuesti√≥n es que una estructura "sospechosa" en una solicitud no es una condici√≥n suficiente para detectar un ataque y puede generar muchos falsos positivos.  Este problema se resuelve implementando un sistema de calificaci√≥n.  Cada regla basada en expresiones regulares se complementa con la informaci√≥n sobre su criticidad;  Despu√©s de identificar todas las reglas activadas, se resume su criticidad.  Si la criticidad total alcanza el valor umbral, se detecta el ataque y se bloquea la solicitud.  A pesar de su simplicidad, este mecanismo demostr√≥ ser eficiente y es ampliamente utilizado para tales tareas. <br><br><h4>  Tokenizadores </h4><br>  Este m√©todo de detecci√≥n se present√≥ en Black Hat 2012 como una biblioteca de C / C + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libinjection</a> , que permite identificar inyecciones SQL r√°pidamente y con precisi√≥n.  En este momento, hay muchos puertos de libinjection para diferentes lenguajes de programaci√≥n, como PHP, Lua, Python, etc.  Este mecanismo busca firmas presentadas como un conjunto de tokens.  Un cierto n√∫mero de firmas est√° en la lista negra, y se consideran no deseadas y maliciosas.  En otras palabras, antes de analizar alguna solicitud, se traduce en un conjunto de tokens.  Los tokens se dividen en ciertos tipos, como variable, cadena, operador regular, desconocido, n√∫mero, comentario, operador tipo uni√≥n, funci√≥n, coma, etc.  Una de las principales desventajas del m√©todo es que es posible construir una estructura que conduzca a la formaci√≥n incorrecta de tokens, por lo tanto, la firma de la solicitud ser√° diferente de la esperada.  Estas estructuras generalmente se denominan rompe fichas, y las discutiremos m√°s adelante <br><br><h4>  An√°lisis de comportamiento. </h4><br>  Detectar y bloquear los intentos de explotaci√≥n en las solicitudes no es la √∫nica tarea para los WAF.  Tambi√©n es importante identificar el proceso de b√∫squeda de vulnerabilidades y el WAF debe reaccionar en consecuencia.  Puede manifestarse como intentos de escaneo, fuerza bruta de directorio, borrado de par√°metros y otros m√©todos autom√°ticos.  Los WAF avanzados pueden crear cadenas de solicitudes t√≠picas para el comportamiento normal normal y bloquear los intentos de enviar solicitudes inusuales.  Este m√©todo no detecta tanto los ataques, ya que dificulta el proceso de b√∫squeda de vulnerabilidades.  Limitar el n√∫mero de solicitudes por minuto no afectar√≠a a un usuario habitual, pero ser√≠a un serio obst√°culo para los esc√°neres, que funcionan en m√∫ltiples hilos. <br><br><h4>  An√°lisis de reputaci√≥n </h4><br>  Este es otro mecanismo heredado directamente de firewalls y antivirus.  Hoy en d√≠a, casi cualquier WAF incluye listas de direcciones de VPN, anonimizadores, nodos Tor y botnets para bloquear las solicitudes de esos.  Los WAF avanzados pueden actualizar autom√°ticamente sus bases y complementarlas con entradas adicionales basadas en el tr√°fico analizado. <br><br><h4>  Aprendizaje autom√°tico </h4><br>  Este es uno de los aspectos m√°s cuestionables de WAF.  Tengamos en cuenta que el t√©rmino "aprendizaje autom√°tico" es bastante amplio e incluye muchas tecnolog√≠as y m√©todos.  Adem√°s, es solo una de las clases de la IA.  La "implementaci√≥n" del aprendizaje autom√°tico o el "uso de la IA" son frases de marketing muy populares.  No siempre est√° claro qu√© algoritmos se usan exactamente, y a veces parece un simple galimat√≠as.  Los proveedores que realmente usan el aprendizaje autom√°tico y lo hacen de manera efectiva no est√°n dispuestos a compartir su experiencia.  Eso dificulta que un extra√±o intente resolver la situaci√≥n.  Sin embargo, tratemos de hacer algunos puntos basados ‚Äã‚Äãen la informaci√≥n disponible. <br><br>  Primero, el aprendizaje autom√°tico depende completamente de los datos en los que se form√≥, lo que plantea un cierto problema.  Un desarrollador debe tener una base de ataques actualizada y completa, lo cual es dif√≠cil de lograr.  Es por eso que muchos desarrolladores registran minuciosamente los resultados de sus WAF y cooperan con los proveedores que proporcionan sistemas IDS y SIEM para obtener ejemplos de ataques del mundo real.  Segundo, un modelo entrenado en una aplicaci√≥n web abstracta puede resultar completamente ineficaz en una aplicaci√≥n web real.  Para obtener una mejor calidad, se recomienda capacitar adicionalmente un modelo en la etapa de implementaci√≥n, que requiere muchos recursos y mucho tiempo, y a√∫n as√≠ no otorga los mejores resultados. <br><br><h2>  Identificando WAF </h2><br>  Los desarrolladores de WAF utilizan diferentes formas de notificar al usuario que la solicitud fue bloqueada.  Por lo tanto, podemos identificar el WAF analizando la respuesta a nuestra solicitud de ataque.  Esto generalmente se conoce como huella digital WAF.  Las huellas digitales pueden ayudar si un WAF no se actualiza por alguna raz√≥n (se aplica principalmente a proyectos de c√≥digo abierto).  Los desarrolladores de WAF propietarios se preocupan por sus clientes e implementan actualizaciones autom√°ticas.  Adem√°s, una vez que hemos identificado el WAF, que result√≥ ser actualizado, a√∫n podemos usar la informaci√≥n sobre √©l para aprender algo sobre su l√≥gica. <br><br>  Aqu√≠ hay una lista de posibles huellas digitales WAF: <br><br><ul><li>  Cookies adicionales </li><li>  Encabezados adicionales a cualquier respuesta o solicitud </li><li>  Contenido de la respuesta (en caso de solicitud bloqueada) </li><li>  C√≥digo de respuesta (en caso de solicitud bloqueada) </li><li>  Direcci√≥n IP (Cloud WAF) </li><li>  M√≥dulo del lado del cliente JS (WAF del lado del cliente) </li></ul><br>  Vamos a ilustrarlo con algunos ejemplos. <br><br>  <b>PT AF</b> <br>  C√≥digo de respuesta para solicitud bloqueada: 403 <br>  Puede insertar el m√≥dulo de cliente waf.js en la p√°gina de respuesta <br>  Cuerpo de la respuesta: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Forbidden<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pre</span></span></span><span class="hljs-tag">&gt;</span></span>Request ID: 2017-07-31-13-59-56-72BCA33A11EC3784<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pre</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Un encabezado adicional que agrega waf.js: <br><br><pre> <code class="xml hljs">X-RequestId: cbb8ff9a-4e91-48b4-8ce6-1beddc197a30</code> </pre> <br>  <b>Nemesida waf</b> <br>  C√≥digo de respuesta para solicitud bloqueada: 403 <br>  Cuerpo de la respuesta: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font-size: 16px; align: center;"</span></span></span><span class="hljs-tag">&gt;</span></span> Suspicious activity detected. Access to the site is blocked. If you think that is's an erroneous blocking, please email us at <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mailto:nwaf@pentestit.ru"</span></span></span><span class="hljs-tag">&gt;</span></span>nwaf@pentestit.ru<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> and specify your IP-address. <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  <b>Wallarm</b> <br>  C√≥digo de respuesta para solicitud bloqueada: 403 <br>  Encabezado adicional: nginx-wallarm <br><br>  <b>Citrix NetScaler AppFirewall</b> <br>  Cookie adicional: <br><br><pre> <code class="xml hljs">ns_af=31+LrS3EeEOBbxBV7AWDFIEhrn8A000; ns_af_.target.br_%2F_wat=QVNQU0VTU0lP TklEQVFRU0RDU0Nf?6IgJizHRbTRNuNoOpbBOiKRET2gA</code> </pre> <br>  <b>Mod_Security ver.</b>  <b>2.9</b> <br>  C√≥digo de respuesta para solicitud bloqueada: 403 <br>  Cuerpo de respuesta: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>403 Forbidden<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Forbidden<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>You don't have permission to access /form.php on this server.<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  <b>Mod_Security ver.</b>  <b>&lt;2.9</b> <br>  C√≥digo de respuesta para solicitud bloqueada: 406 o 501 <br>  En el cuerpo de respuesta, puede encontrar mod_security, Mod_Security o NOYB <br><br>  <b>Barniz cortafuegos</b> <br>  Agrega los siguientes encabezados a la respuesta: <br><br><pre> <code class="plaintext hljs">X-Varnish: 127936309 131303037. X-Varnish: 435491096 Via: 1.1 varnish-v4</code> </pre> <br>  Los desarrolladores de WAF deciden ellos mismos qu√© c√≥digo de respuesta devolver en caso de una solicitud bloqueada;  Tambi√©n hay algunos c√≥digos espec√≠ficos.  Por ejemplo, Web_Knight WAF devuelve el c√≥digo 999 y dotDefender devuelve el c√≥digo 200 con un cuerpo de respuesta vac√≠o o con un mensaje de error.  Adem√°s de eso, los desarrolladores pueden hacer una p√°gina de respuesta personalizada con alg√∫n otro contenido. <br><br>  WAF, como cualquier otra aplicaci√≥n, evoluciona y cambia.  Por eso es importante verificar constantemente la relevancia de las huellas digitales que tiene. <br><br><h2>  WAF bypass hoja de trucos </h2><br>  La idea general detr√°s de encontrar formas de evitar WAF es transformar la solicitud que necesitamos para que siga siendo v√°lida para la aplicaci√≥n web pero no para WAF o parezca inofensiva.  Es importante que un tipo de WAF pueda servir muchos tipos diferentes de servidores, incluidos los "ex√≥ticos", como Unicorn, Tornado, Weblogic, Lighttpd, etc.  Cada servidor puede percibir casos exclusivos de an√°lisis de solicitudes HTTP de una manera diferente, que WAF tambi√©n debe considerar.  Por lo tanto, un atacante puede usar las especificaciones de los servidores del an√°lisis de solicitudes HTTP para encontrar una manera de evitar el WAF. <br><br><img src="https://habrastorage.org/webt/59/e3/95/59e395afb9650235665851.png"><br><br>  Es dif√≠cil clasificar todas las formas posibles de eludir WAF, ya sea por los mecanismos de seguridad de WAF o por el campo de uso.  Las mismas formas de derivaci√≥n pueden interactuar y afectar simult√°neamente diferentes componentes de un WAF.  Las t√©cnicas que se describen a continuaci√≥n se obtuvieron de fuentes abiertas o se descubrieron durante nuestra propia investigaci√≥n y demostraron estar entre las m√°s efectivas. <br><br><h4>  Agregar s√≠mbolos especiales </h4><br>  Varios s√≠mbolos especiales pueden violar la l√≥gica de an√°lisis de un WAF y al mismo tiempo ser v√°lidos interpretados por el servidor.  Las variaciones de estos s√≠mbolos pueden ser diferentes: pueden transformarse en c√≥digo urlen (aunque la mayor√≠a de los WAF pueden manejar eso) u otras codificaciones.  Tambi√©n es posible insertar s√≠mbolos especiales en una solicitud sin ninguna codificaci√≥n, en formato sin formato, lo que puede ser una sorpresa para un WAF.  Por ejemplo, <b>\ r \ n \ r \ n</b> en esta presentaci√≥n puede percibirse como el final de un cuerpo de solicitud HTTP, y un byte nulo puede violar la l√≥gica de an√°lisis de expresiones regulares y analizadores de datos por completo.  Adem√°s, otros s√≠mbolos especiales de los primeros veinte s√≠mbolos de la tabla ASCII pueden ser √∫tiles. <br>  Ejemplos: <br><br><ul><li>  0x00 - Byte nulo; </li><li>  0x0D - retorno de carro; </li><li>  0x0A: avance de l√≠nea; </li><li>  0x0B - Pesta√±a vertical; </li><li>  0x09 - Pesta√±a horizontal; </li><li>  0x0C - Nueva p√°gina </li></ul><br>  Mientras busca un bypass, es √∫til insertar s√≠mbolos especiales en diferentes lugares en el cuerpo de la solicitud y no solo en los valores de los par√°metros.  Por ejemplo, si una solicitud est√° en formato JSON, podemos insertar un byte NULO tanto en un par√°metro como entre par√°metros, tanto al principio como al final de JSON.  Lo mismo se aplica a otros formatos del cuerpo de una solicitud POST.  En general, recomendamos investigar y divertirse, buscar lugares que WAF pueda monitorear y analizar e intentar usar diferentes s√≠mbolos especiales all√≠. <br><br>  Por ejemplo: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">1337</span></span>,<span class="hljs-attr"><span class="hljs-attr">"string0x00"</span></span>:<span class="hljs-string"><span class="hljs-string">"test' or sleep(9)#"</span></span>} {<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">1337</span></span>,<span class="hljs-attr"><span class="hljs-attr">"string"</span></span>:<span class="hljs-string"><span class="hljs-string">"test'/*0x00*/ or sleep(9)#"</span></span>} {<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">1337</span></span>,<span class="hljs-attr"><span class="hljs-attr">"string"</span></span>0x0A0x0D:<span class="hljs-string"><span class="hljs-string">"test' or sleep(9)#"</span></span>}</code> </pre> <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ja0x09vas0x0A0x0Dcript:alert(1)"</span></span></span><span class="hljs-tag">&gt;</span></span>clickme<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">0x00</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:alert(1)"</span></span></span><span class="hljs-tag">&gt;</span></span>clickme<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">0x00</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert(1)"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="sql hljs">id=1337<span class="hljs-comment"><span class="hljs-comment">/*0x0C*/</span></span>1 UNION <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>(), <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>() <span class="hljs-comment"><span class="hljs-comment">--</span></span></code> </pre> <br>  <i>Para mayor claridad, hemos reemplazado s√≠mbolos especiales con su presentaci√≥n hexadecimal.</i> <br><br><h4>  Sustituci√≥n de s√≠mbolos espaciales </h4><br>  En la mayor√≠a de las sintaxis, las palabras clave y los operadores deben separarse, pero los s√≠mbolos de espacio preferibles no se especifican.  Por lo tanto, en lugar del <b>0x20</b> com√∫n (Espacio), puede usar <b>0x0B</b> (Pesta√±a vertical) o <b>0x09</b> (pesta√±a Horizontal).  Reemplazar espacios con estructuras divisorias sin su propio significado cae en la misma categor√≠a.  En SQL, es <b>/ ** /</b> (comentarios SQL de varias l√≠neas), <b># \ r \ n</b> (comentario SQL de una l√≠nea, que finaliza con avance de l√≠nea), <b>- \ r \ n</b> (comentario SQL alternativo de una l√≠nea, finalizando con avance de l√≠nea).  Aqu√≠ hay algunos ejemplos: <br><br><pre> <code class="html hljs xml">http://test.com/test?id=1%09union/**/select/**/1,2,3 http://test.com/test?id=1%09union%23%0A%0Dselect%2D%2D%0A%0D1,2,3</code> </pre> <br>  Adem√°s, podemos transformar una expresi√≥n para eliminar espacios utilizando la sintaxis del lenguaje.  Por ejemplo, en SQL, podemos usar par√©ntesis: <br><br><pre> <code class="sql hljs">UNION(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-number"><span class="hljs-number">6</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">Users</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span>(login=<span class="hljs-string"><span class="hljs-string">'admin'</span></span>))</code> </pre> <br>  Y en JS, use <b>/</b> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">confirm(1)</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h4>  Cambiar codificaci√≥n </h4><br>  Este m√©todo se basa en el uso de diferentes codificaciones para evitar que WAF decodifique datos en ciertos lugares.  Por ejemplo, si un s√≠mbolo se reemplaza con su c√≥digo URL, WAF no podr√° comprender que tiene que decodificar datos y pasar√° la solicitud.  Al mismo tiempo, la aplicaci√≥n web aceptar√° y decodificar√° con √©xito el mismo par√°metro. <br><br>  La forma decimal de un s√≠mbolo HTML es <b>&amp; # 106</b> o <b>&amp; # 0000106</b> .WAF puede conocer la versi√≥n corta y no conocer la versi√≥n con ceros adicionales (no debe haber m√°s de 7 s√≠mbolos en total).  Del mismo modo, la forma hexadecimal de un s√≠mbolo HTML es <b>&amp; # x6A</b> o <b>&amp; # x000006A</b> . <br><br>  Tambi√©n hay un truco con caracteres de escape con una barra invertida <b>\</b> , por ejemplo: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on</span></span></span><span class="hljs-tag">\</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">load</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">a\lert(1)</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Sin embargo, depende de c√≥mo una aplicaci√≥n web procese dichos datos de entrada.  Entonces, la secuencia <b>\ l</b> ser√° procesada como una <b>l</b> y transformada en un solo s√≠mbolo;  WAF puede procesar cada s√≠mbolo por separado y puede romper expresiones regulares u otra l√≥gica WAF.  Por lo tanto, WAF perder√° las palabras clave.  Con esta t√©cnica no podemos escapar de los caracteres <b>\ n</b> , <b>\ r</b> , <b>\ t</b> , ya que se transformar√°n en caracteres diferentes: nueva l√≠nea, retorno de carro y tabulaci√≥n. <br><br>  La codificaci√≥n HTML se puede usar dentro de los atributos de la etiqueta, por ejemplo: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript&amp;colon;alert(1)"</span></span></span><span class="hljs-tag">&gt;</span></span>clickme<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onmouseover</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript&amp;colon;confirm&amp;lpar;1rpar;"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Estos caracteres se pueden reemplazar f√°cilmente por otras representaciones HTML de los caracteres de destino.  Puedes buscar diferentes transformaciones de personajes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Adem√°s de la codificaci√≥n HTML, podemos insertar caracteres con <b>\ u</b> : <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:\u0061lert(1)"</span></span></span><span class="hljs-tag">&gt;</span></span>Clickme<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">confir\u006d(1)</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Veamos tambi√©n el vector relacionado con la inserci√≥n de caracteres especiales.  Rompamos la carga √∫til con codificaci√≥n HTML: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ja&amp;Tab;vas&amp;#x0000A;cript:alert(1)"</span></span></span><span class="hljs-tag">&gt;</span></span>clickme<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  En este caso, tambi√©n podemos colocar otros caracteres de separaci√≥n. <br><br>  Por lo tanto, recomendamos combinar diferentes codificaciones con otros m√©todos, por ejemplo, para codificar caracteres especiales. <br><br><h4>  Buscar estructuras sint√°cticas equivalentes at√≠picas </h4><br>  Este m√©todo tiene como objetivo encontrar una forma de explotaci√≥n no considerada por los desarrolladores de WAF, o un vector que no estaba presente en la muestra de capacitaci√≥n de aprendizaje autom√°tico.  Ejemplos simples ser√≠an funciones de JavaScript: <b>this, top self, parent, frames;</b>  atributos de etiqueta: <b>enlace de datos, ontoggle, onfilterchange, onbeforescriptexecute, onpointerover, srcdoc;</b>  y operadores SQL: <b>lpad, campo, bit_count</b> . <br><br>  Aqu√≠ hay algunos ejemplos: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">[</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'alert'</span></span></span><span class="javascript">](</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">)</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript">parent[</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'alert'</span></span></span><span class="actionscript">](</span><span class="hljs-number"><span class="actionscript"><span class="hljs-number">1</span></span></span><span class="actionscript">)</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript">self[</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'alert'</span></span></span><span class="actionscript">](</span><span class="hljs-number"><span class="actionscript"><span class="hljs-number">2</span></span></span><span class="actionscript">)</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">LPAD</span></span>(<span class="hljs-string"><span class="hljs-string">' '</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">version</span></span>())=<span class="hljs-string"><span class="hljs-string">'5.7'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">sleep</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>),<span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre> <br>  Tambi√©n puede usar la representaci√≥n no simb√≥lica de expresiones JavaScript: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JSFuck</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jjencode</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Xchars.js</a> . </li></ul><br>  Un problema obvio con eso son las largas cargas √∫tiles. <br><br>  La omisi√≥n de WAF con esta t√©cnica depende del ataque y la pila de tecnolog√≠as explotadas.  El famoso exploit ImageTragick es un buen ejemplo de eso.  La mayor√≠a de los WAF que protegen de este ataque ten√≠an palabras clave en la lista negra como <b>url</b> , <b>capacidad</b> y <b>etiqueta,</b> ya que esas palabras se mencionaron en la mayor√≠a de los documentos y PoC que describen esta vulnerabilidad.  Aunque pronto se revel√≥ que tambi√©n se pueden usar otras palabras clave, por ejemplo, <b>ef√≠mero</b> y <b>pango</b> .  Como resultado, los WAF podr√≠an evitarse con el uso de estas palabras clave. <br><br><h4>  Contaminaci√≥n de par√°metros HTTP (HPP) y fragmentaci√≥n de par√°metros HTTP (HPF) </h4><br>  El ataque HPP se basa en c√≥mo un servidor interpreta los par√°metros con los mismos nombres.  Aqu√≠ hay algunos posibles desv√≠os: <br><br><ul><li>  El servidor usa el √∫ltimo par√°metro recibido, y WAF verifica solo el primero; </li><li>  El servidor une el valor de par√°metros similares, y WAF los verifica por separado. </li></ul><br>  Puede comparar c√≥mo diferentes servidores procesan los mismos par√°metros en la tabla a continuaci√≥n: <br><br><img src="https://habrastorage.org/webt/59/e3/77/59e3770e949f3269504620.png"><br><br>  A su vez, el ataque de HPF se basa en un principio diferente.  Si la l√≥gica de una aplicaci√≥n web une dos y m√°s par√°metros en una solicitud, el adversario puede dividir la solicitud para evitar ciertas comprobaciones WAF. <br>  La siguiente inyecci√≥n SQL es un ejemplo de tal ataque: <br><br><pre> <code class="html hljs xml">http://test.com/url?a=1+select&amp;b=1+from&amp;c=base</code> </pre> <br>  HPF y HPP son muy similares, pero el primero apunta a una aplicaci√≥n web y el segundo al entorno en el que opera.  La combinaci√≥n de estas t√©cnicas aumenta la posibilidad de evitar un WAF. <br><br><h4>  Normalizaci√≥n Unicode </h4><br>  La normalizaci√≥n Unicode es una caracter√≠stica de Unicode destinada a comparar s√≠mbolos Unicode que se parecen.  Por ejemplo, los s√≠mbolos <b>'¬™'</b> y <b>'·µÉ'</b> tienen c√≥digos diferentes pero, de lo contrario, son muy similares, por lo que despu√©s de la normalizaci√≥n, ambos se ver√°n como una simple <b>'a'</b> y se considerar√°n iguales.  La normalizaci√≥n permite transformar algunos s√≠mbolos Unicode complejos en sus alternativas m√°s simples.  Hay una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tabla de normalizaci√≥n Unicode</a> con todos los s√≠mbolos Unicode y sus posibles normalizaciones.  Al usarlo, puede hacer diferentes cargas √∫tiles y combinarlas con otros m√©todos.  Sin embargo, no funciona para todas las aplicaciones web y depende mucho del entorno. <br><br>  Por ejemplo, en la tabla anterior, podemos ver que los s√≠mbolos <b><code>Ôºú</code></b> y <b><code>Ôπ§</code></b> transforman en simple <b><code>&lt;</code></b> .  Si una aplicaci√≥n usa codificaci√≥n HTML despu√©s de la normalizaci√≥n, lo m√°s probable es que el s√≠mbolo normalizado <b><code>&lt;</code></b> se codifique en <b><code>&amp;lt;</code></b>  .  Pero, en otros casos, los desarrolladores pueden haber pasado por alto esta caracter√≠stica y no codificar s√≠mbolos Unicode.  Por lo tanto, obtenemos s√≠mbolos <b>&lt;</b> y <b>&gt;</b> no codificados en HTML, que pueden convertirse en ataques XSS.  WAF puede tener problemas para comprender los s√≠mbolos de Unicode; es posible que simplemente no tenga reglas para tales trucos, y el aprendizaje autom√°tico tambi√©n puede ser in√∫til.  Al encontrar un bypass en las aplicaciones web con normalizaci√≥n Unicode, podemos reemplazar no solo <b>&lt;&gt;</b> sino tambi√©n otros s√≠mbolos de la carga √∫til. <br><br>  Por ejemplo: <br><br><pre> <code class="html hljs xml">Ôºúimg srcÔπ¶x onerrorÔºùalertÔ∏µ1)&gt;</code> </pre> <br>  Recientemente, este problema se encontr√≥ en el programa Rockstar BugBounty en HackerOne.  No hab√≠a WAF, solo un estricto filtrado de entrada del usuario: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hackerone.com/reports/231444</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hackerone.com/reports/231389</a> <br><br><h4>  Rompedores de fichas </h4><br>  Los ataques a los tokenizadores intentan romper la l√≥gica de dividir una solicitud en tokens con la ayuda de los llamados rompedores de tokens.  Los interruptores de fichas son s√≠mbolos que permiten afectar la correspondencia entre un elemento de una cadena y una determinada ficha y, por lo tanto, omiten la b√∫squeda por firma.  Pero cuando se utiliza el interruptor de token, la solicitud debe seguir siendo v√°lida.  La siguiente solicitud es un ejemplo de un ataque utilizando un interruptor de fichas <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>-@<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">version</span></span>()</code> </pre> <br>  donde <b>- @</b> es el interruptor de fichas. <br><br>  Hay una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hoja de chear</a> que fue adquirida por mysql borrando y verificando los resultados en libinjection. <br><br>  M√°s sobre c√≥mo encontrar problemas en libinjection: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Otro fuzzer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuzz para evitar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo evitar la libinyecci√≥n</a> <br><br><h4>  Usando las caracter√≠sticas de RFC </h4><br>  En las especificaciones para el protocolo HTTP / 1.1 y varios tipos de solicitud (por ejemplo, multipart / form-data), podemos encontrar algunas cosas curiosas relacionadas con los casos l√≠mite y trucos de procesamiento de encabezados y par√°metros.  Los desarrolladores de WAF a menudo no consideran tales problemas, por lo tanto, un WAF puede analizar una solicitud de forma incorrecta y perder la parte de los datos, donde se oculta un vector de ataque.  La mayor√≠a de los problemas en WAF est√°n relacionados con el procesamiento de datos multiparte / formulario y valores espec√≠ficos del par√°metro l√≠mite, que especifica los l√≠mites del par√°metro en tales solicitudes.  Adem√°s de eso, los desarrolladores de servidores tambi√©n pueden equivocarse y no admitir las especificaciones por completo, por lo que puede haber caracter√≠sticas no documentadas en el analizador HTTP de un servidor. <br><br>  En una solicitud HTTP con datos multiparte / formulario, el l√≠mite de par√°metro se encarga de la segregaci√≥n de diferentes par√°metros en el cuerpo de una solicitud.  Seg√∫n el RFC, se debe colocar un l√≠mite previamente especificado con un prefijo que contenga "-" antes de cada nuevo par√°metro POST, para que el servidor pueda discriminar los diferentes par√°metros de una solicitud. <br><br><pre> <code class="plaintext hljs">POST /vuln.php HTTP/1.1 Host: test.com Connection: close Content-Type: multipart/form-data; boundary=1049989664 Content-Length: 192 --1049989664 Content-Disposition: form-data; name="id" 287356 --1049989664--</code> </pre> <br>  El ataque tambi√©n puede basarse en el hecho de que un servidor y un WAF manejan de manera diferente una situaci√≥n en la que el l√≠mite se deja vac√≠o.  Seg√∫n el RFC, en este caso, "-" es el l√≠mite entre los par√°metros.  Sin embargo, un WAF puede usar un analizador que no lo tenga en cuenta y, como resultado, el WAF pasar√° la solicitud porque los datos de los par√°metros de una solicitud POST no aparecer√≠an en el analizador.  El servidor web puede analizar dicha solicitud sin problemas y entregar los datos para su posterior procesamiento. <br>  Aqu√≠ hay algunos ejemplos m√°s interesantes. <br><br><pre> <code class="plaintext hljs">POST /vuln.php HTTP/1.1 Host: test.com Connection: close Content-Type: multipart/form-data; boundary= Content-Length: 192 -- Content-Disposition: form-data; name="id" 123' or sleep(20)# ----</code> </pre> <br>  Le daremos algunos ejemplos m√°s interesantes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diapositivas</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bo0oM</a> en ZeroNights 2016 y lo explicaremos: <br><br><pre> <code class="plaintext hljs">POST /vuln.php HTTP/1.1 Host: test.com Content-Type: multipart/form-data; boundary=FIRST; Content-Type: multipart/form-data; boundary=SECOND; Content-Type: multipart/form-data; boundary=THIRD; --THIRD Content-Disposition: form-data; name=param UNION SELECT version() --THIRD--</code> </pre><br>  En este ataque, estamos tratando de definir cu√°l de los par√°metros de l√≠mite ser√° aceptado por el WAF y cu√°l por el servidor web.  Por lo tanto, si aceptan diferentes par√°metros, es posible realizar un ataque especificando un l√≠mite que el WAF no ver√°.  Este ataque es algo parecido a HPP. <br><br><pre> <code class="plaintext hljs">POST /vuln.php HTTP/1.1 Host: test.com Content-Type: multipart/form-data; xxxboundaryxxx=FIRST; boundary=SECOND; --FIRST Content-Disposition: form-data; name=param UNION SELECT version() --FIRST--</code> </pre><br>  Este ataque se basa en el supuesto de que existe una diferencia en el an√°lisis de una solicitud HTTP por parte de WAF y del servidor web.  A saber, el analizador del servidor web busca la primera entrada 'l√≠mite', y luego el s√≠mbolo '=', y solo despu√©s de eso define el valor del l√≠mite.  El analizador WAF, a su vez, solo busca la entrada "boundary =" y luego define el l√≠mite.  Si se cumplen estas condiciones, el WAF no encontrar√° el l√≠mite en la solicitud y, por lo tanto, no podr√° encontrar ni analizar el par√°metro.  Por el contrario, el servidor web obtendr√° la solicitud y procesar√° el par√°metro.  Este ataque tambi√©n funcionar√° al rev√©s: el analizador del servidor web busca "l√≠mite =", y el analizador WAF busca solo "l√≠mite".  En este caso, solo tendremos que cambiar el l√≠mite real de PRIMERO a SEGUNDO. <br><br><pre> <code class="plaintext hljs">POST /somepage.php HTTP/1.1 Host: test.com Content-Type: multipart/form-data; boundary=Test0x00othertext; --Test Content-Disposition: form-data; name=param Attack --Test--</code> </pre><br>  Este ataque tambi√©n usa caracteres especiales.  En el par√°metro de l√≠mite, agregamos NULL-byte para que el servidor web lo corte, pero el WAF lo acepte por completo.  En este caso, WAF no puede analizar el par√°metro porque no puede encontrar sus l√≠mites. <br><br><h4>  Sin pasar por el aprendizaje autom√°tico </h4><br>  La l√≥gica es simple: tenemos que componer un ataque que satisfaga los par√°metros del modelo estad√≠stico entrenado.  Pero eso depende en gran medida de c√≥mo se form√≥ el WAF y qu√© modelo de capacitaci√≥n se us√≥.  A veces es posible encontrar una escapatoria, y a veces no.  Por lo general, en la etapa de implementaci√≥n, un WAF con aprendizaje autom√°tico necesita capacitaci√≥n adicional basada en la solicitud de la aplicaci√≥n web del cliente.  Eso plantea un problema para los pentesters: los par√°metros que se parecen y no cambian mucho de una solicitud a otra no se pueden probar, ya que cualquier digresi√≥n del formato de par√°metro habitual se considerar√≠a una anomal√≠a.  Supongamos que tiene una solicitud para <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">api.test.com/getuser?id=123</a></b> .  La identificaci√≥n del par√°metro siempre es num√©rica, y fue num√©rica en la muestra de entrenamiento.  Si el m√≥dulo de aprendizaje autom√°tico encuentra algo m√°s que n√∫meros en este par√°metro, lo m√°s probable es que decida que es una anomal√≠a.  Otro ejemplo: suponga que WAF fue entrenado para clasificar la solicitud POST en <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">api.test.com/setMarkDown</a></b> con par√°metros POST que tienen texto de reducci√≥n.  Obviamente, puede haber comillas, s√≠mbolos especiales y b√°sicamente cualquier cosa en la rebaja.  En este caso, es mucho m√°s f√°cil pasar por alto el m√≥dulo de aprendizaje autom√°tico porque el WAF tolera comillas y s√≠mbolos especiales. <br><br>  Adem√°s, en los ejemplos de nuestra pr√°ctica, mostraremos que no siempre llega tan lejos como el m√≥dulo de aprendizaje autom√°tico debido a los problemas con el an√°lisis de los par√°metros causados ‚Äã‚Äãpor los m√©todos de derivaci√≥n descritos anteriormente. <br><br>  En general, tenemos que considerar los detalles de una solicitud probada y sus par√°metros, presumir las posibles opciones de los valores de los par√°metros, que WAF puede ser tolerante, y construir sobre ellos. <br><br><h4>  Cuando WAF es in√∫til? </h4><br>  WAF analiza las solicitudes y busca comportamientos an√≥malos en ellas, pero hay algunas clases de vulnerabilidades que no puede descubrir.  Por ejemplo, vulnerabilidades l√≥gicas, que no tienen anomal√≠as pero tienen algunas acciones que interrumpen la l√≥gica de una aplicaci√≥n web.  Lo m√°s probable es que WAF tambi√©n sea in√∫til en caso de condici√≥n de carrera, IDOR y autenticaci√≥n de usuario insegura. <br><br><h4>  Utilidades existentes </h4><br>  Existen algunas herramientas autom√°ticas para encontrar derivaciones WAF, escritas por los entusiastas en este campo.  Aqu√≠ est√°n los m√°s famosos y dignos: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lightbulb-framework</a> : un marco completo para probar aplicaciones web protegidas con WAF.  Est√° escrito en Python y adicionalmente portado como un complemento para Burp Suite.  Sus caracter√≠sticas principales son estos dos algoritmos: <br><br><ul><li>  GOFA: un algoritmo de aprendizaje autom√°tico activo que permite analizar la filtraci√≥n y la desinfecci√≥n de par√°metros en una aplicaci√≥n web. </li><li>  SFADiff: algoritmo de prueba de caja negra deferente, basado en el entrenamiento con aut√≥matas finitos simb√≥licos (SFA).  Permite encontrar diferencias en el comportamiento de las aplicaciones web, lo que ayuda a identificar WAF y encontrar un bypass. </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bypass WAF</a> : un complemento para Burp Suite, que permite configurar el cambio autom√°tico de los elementos en el cuerpo de una solicitud de acuerdo con diferentes reglas y cambios de codificaci√≥n.  Tambi√©n puede automatizar un ataque HPP. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WAFW00F</a> - una herramienta para la identificaci√≥n WAF, escrita en Python.  Tiene una base WAF decente y todav√≠a se est√° actualizando.  Sin embargo, los resultados pueden ser imprecisos porque muchos WAF se actualizan con m√°s frecuencia que el proyecto en s√≠. <br><br><h2>  Sin pasar por waf en la pr√°ctica </h2><br><img src="https://habrastorage.org/webt/59/e4/fc/59e4fc4eee061363676501.png"><br><br>  Hemos estado realizando pruebas de penetraci√≥n en una tienda en l√≠nea, que estaba protegida por <b>PT AF</b> (firewall de aplicaciones de tecnolog√≠as positivas).  Fue dif√≠cil encontrar un punto d√©bil, que podr√≠a ser una base para un bypass.  Pero pronto descubrimos un comportamiento inusual en el lado de la aplicaci√≥n web, que no fue filtrada por el WAF.  La anomal√≠a se encontr√≥ en la b√∫squeda en la historia de los bienes comprados.  La solicitud se envi√≥ en formato JSON y se ve√≠a as√≠: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"request"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"Count"</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-attr"><span class="hljs-attr">"Offset"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-attr"><span class="hljs-attr">"ItemName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Phone"</span></span>}}</code> </pre> <br>  <b>Colocamos</b> los valores <b>Phone '</b> y <b>Phone' + '</b> en el par√°metro <b>ItemName</b> y descubrimos que el servidor devolvi√≥ respuestas diferentes para estas dos solicitudes.  En el primer caso, la respuesta fue vac√≠a;  en el segundo caso, conten√≠a datos sobre otros productos con la palabra <b>Tel√©fono</b> en su nombre, como si el par√°metro <b>ItemName</b> tuviera <b>Tel√©fono</b> como su valor.  Este tipo de comportamiento es bien conocido entre los piratas inform√°ticos y los pentesters y se√±ala que la aplicaci√≥n tiene un problema con la filtraci√≥n de la entrada del usuario, lo que lleva a la inyecci√≥n de SQL, entre otros. <br><br>  Veamos por qu√© sucede esto con un ejemplo de inyecci√≥n SQL.  Si se encuentra dicho comportamiento en una aplicaci√≥n web, es muy probable que los datos de una solicitud SQL est√©n en concatenaci√≥n con la solicitud misma.  En el primer caso, con <b>el</b> par√°metro <b>Phone '</b> , tendremos la siguiente consulta SQL: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> items <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> item_name=<span class="hljs-string"><span class="hljs-string">'Phone''</span></span></code> </pre> <br>  Obviamente, no se ejecutar√° debido a una sintaxis incorrecta y no devolver√° ning√∫n resultado.  La segunda solicitud, con <b>el</b> par√°metro <b>Tel√©fono '+'</b> , se ver√° as√≠: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> items <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> item_name=<span class="hljs-string"><span class="hljs-string">'Phone'</span></span>+<span class="hljs-string"><span class="hljs-string">''</span></span></code> </pre> <br>  Su sintaxis es correcta, por lo que seleccionar√° productos por el nombre <b>Tel√©fono</b> .  Este m√©todo de detecci√≥n de vulnerabilidades tiene una gran ventaja al probar una aplicaci√≥n web protegida por WAF.  El s√≠mbolo de comillas simples no se considera una anomal√≠a suficiente en un par√°metro por la mayor√≠a de los WAF modernos, por lo que pasan una solicitud con √©l. <br><br>  Hemos descrito la detecci√≥n de vulnerabilidades, pero ¬øqu√© pasa con evitar WAF y explotar la vulnerabilidad?  Despu√©s de pasar por algunos desv√≠os, encontramos un problema en el WAF.  Result√≥ que este WAF es vulnerable a los caracteres especiales agregados a los par√°metros JSON.  De hecho, si agregamos s√≠mbolos JSON <b>0x0A, 0x0D</b> (\ r \ n o carrige reutrn y nueva l√≠nea) en formato sin formato, sin ninguna codificaci√≥n, en ning√∫n campo de texto, el WAF lo pasar√≠a y la aplicaci√≥n web lo considerar√≠a como ser correcto y procesarlo.  Lo m√°s probable es que el problema estuviera en el analizador JSON, que no se cre√≥ para s√≠mbolos especiales y analiz√≥ JSON justo hasta el lugar donde aparecer√≠an estos s√≠mbolos.  Por lo tanto, el analizador WAF no obtendr√≠a la solicitud completa, por lo que podr√≠amos insertar cualquier vector de ataque despu√©s de caracteres especiales.  Adem√°s del salto de l√≠nea, otros caracteres (por ejemplo, NULL-byte) tambi√©n funcionar√≠an.  Como resultado, podr√≠amos escribir la siguiente solicitud, que apagar√≠a el WAF al intentar verificar esta solicitud (el salto de l√≠nea y el retorno de carro se reemplazaron con su representaci√≥n textual): <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"request"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"kill-waf"</span></span>:<span class="hljs-string"><span class="hljs-string">"die0x0A0x0D"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Count"</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-attr"><span class="hljs-attr">"Offset"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-attr"><span class="hljs-attr">"ItemName"</span></span>:[<span class="hljs-string"><span class="hljs-string">"'+(SELECT 'Phone'+CHAR(ASCII(substring(@@version,1,1))-24))+'"</span></span>]}}</code> </pre> <br>  <i>0x0A y 0x0D son bytes sin procesar.</i> <br><br>  Por lo tanto, podr√≠amos probar f√°cil y r√°pidamente todos los par√°metros para detectar vulnerabilidades (algunos de ellos se encontraron en otros par√°metros).  Pasar por alto WAF y explotar esta inyecci√≥n nos permiti√≥ comprometer totalmente a todos los usuarios de la aplicaci√≥n web. <br><br>  Los mismos problemas tambi√©n se encontraron en <b>Nemesida WAF</b> .  La √∫nica diferencia es que la solicitud no estaba en codificaci√≥n JSON, pero era una solicitud POST habitual con par√°metros, y un par√°metro se concataba a la consulta SQL como un n√∫mero.  Si se colocaron algunos s√≠mbolos en una solicitud en codificaci√≥n url, por ejemplo, <b>% 03% 04,</b> entonces WAF bloquea una solicitud, pero si los s√≠mbolos se colocaron en forma cruda sin codificaci√≥n url, WAF pasa por alto esta solicitud.  Vale la pena se√±alar que la expresi√≥n SQL normal se coloc√≥ para solicitar, as√≠ como en WAF anterior.  La expresi√≥n SQL era simple <b>'UNION SELECT'</b> sin ninguna ofuscaci√≥n adicional, lo que significa que WAF simplemente no pod√≠a analizar la solicitud correctamente y transmitir el an√°lisis m√°s adelante.  Pero hay un problema: ¬øc√≥mo hacer correcta la sintaxis de consulta SQL?  Porque el uso de caracteres especiales como <b>% 03% 04</b> en la consulta SQL no es correcto.  La respuesta es simple: solo necesitamos usar comentarios / ** /.  Entonces, la solicitud de resultado se ve√≠a as√≠: <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/*0x03 0x04*/</span></span>1 UNION <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>(), <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>() <span class="hljs-comment"><span class="hljs-comment">--</span></span></code> </pre> <br>  <i>0x03 y 0x04 son bytes sin procesar.</i> <br><br>  Adem√°s, se encontr√≥ otro problema en Nemesida WAF.  Estaba relacionado con el procesamiento incorrecto de solicitudes POST con datos multiparte / formulario.  Como describimos a continuaci√≥n, en una solicitud HTTP con datos multiparte / formulario, el <b>l√≠mite de</b> par√°metro se encarga de la segregaci√≥n de diferentes par√°metros en el cuerpo de una solicitud.  Seg√∫n el RFC, se debe colocar un l√≠mite previamente especificado con un prefijo que contenga <b>"-"</b> antes de cada nuevo par√°metro POST, para que el servidor pueda discriminar los diferentes par√°metros de una solicitud. <br>  Entonces, el problema era que el servidor y WAF manejaban la situaci√≥n de manera diferente cuando el par√°metro de l√≠mite estaba vac√≠o.  Seg√∫n el RFC, en tal situaci√≥n, el l√≠mite entre los par√°metros ser√° una secuencia de caracteres <b>"-"</b> .  Sin embargo, WAF utiliz√≥ un analizador que no tiene en cuenta esta caracter√≠stica, por lo que WAF nuevamente pasa la solicitud, porque los datos de los par√°metros de solicitud POST simplemente no entraron en el m√≥dulo analizador, y el servidor analiz√≥ esta situaci√≥n sin ning√∫n problema y transfiri√≥ los datos a√∫n m√°s al procesamiento.  Esta es una solicitud de muestra para este ataque: <br><br><pre> <code class="plaintext hljs">POST /wp-content/plugins/answer-my-question/modal.php HTTP/1.1 Host: example.com Content-Type: multipart/form-data; boundary= Content-Length: 209 -- Content-Disposition: form-data; name="id" 1 UNION SELECT 1,2,3,CONVERT(version() USING utf8) AS name,CONVERT(user() USING utf8) AS name,6,7,8,9,10,11,12 FROM wp_users WHERE id=1 ----</code> </pre><br>  Ambos problemas se informaron a Pentestit, los muchachos pagaron una recompensa por su programa de recompensas de errores para Nemesida WAF y solucionaron los problemas lo antes posible.  Gracias por eso. <br><br>  Como podemos ver, los WAF pueden ser modernos e inteligentes, pero a veces es posible evitarlos simplemente agregando un √∫nico car√°cter especial.  Hoy no podemos prever todos los tipos posibles de datos de entrada para todos los servidores en la etapa de desarrollo, y el aprendizaje autom√°tico, implementado para hacer exactamente eso, se topa con analizadores que se atascan con caracteres especiales. <br><br><h2>  Conclusi√≥n </h2><br><img align="left" src="https://habrastorage.org/webt/59/e5/54/59e55464f2331285132470.png">  Entonces, ¬ødeber√≠amos confiar completamente en WAF?  <b>La respuesta es NO.</b> <br><br>  En una de nuestras auditor√≠as, descubrimos un bypass WAF que nos permiti√≥ explotar algunas vulnerabilidades.  Al final result√≥ que, los desarrolladores ya hab√≠an realizado una auditor√≠a de la aplicaci√≥n web, antes de que fuera protegida por WAF, y revel√≥ las mismas vulnerabilidades.  En lugar de arreglarlos, decidieron comprar un WAF moderno equipado con aprendizaje autom√°tico.  Es una pena que el proveedor de WAF no haya insistido en corregir las vulnerabilidades primero;  o quiz√°s los propios desarrolladores pensaron que WAF ser√≠a una mejor opci√≥n.  Sin embargo, no lo sabemos con certeza.  De cualquier manera, este es un ejemplo de una muy mala pr√°ctica, tanto por parte de los desarrolladores como del proveedor.  Tambi√©n debe tenerse en cuenta que el aprendizaje autom√°tico sigue siendo una caja negra y se parece m√°s a un dispositivo de marketing que a una defensa real. <br><br>  En general, WAF es una soluci√≥n de seguridad moderna, y no le har√° da√±o tenerla con sus aplicaciones web.  Aunque hoy en d√≠a, solo puede obstaculizar el proceso de b√∫squeda y explotaci√≥n de vulnerabilidades, pero no puede protegerlos por completo.  Tal como est√°n las cosas, este es el estado del arte durante bastante tiempo.  Las vulnerabilidades en las aplicaciones web solo se pueden corregir corrigiendo el c√≥digo relacionado con ellas, y esa es la √∫nica soluci√≥n infalible. <br><br>  <b>Colaboradores</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ilia Bulatov</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">barracud4</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Denis Rybin</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">thefaeriedragon</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Alexander Romanov</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">web_rock</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/454592/">https://habr.com/ru/post/454592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454582/index.html">¬øSe debe almacenar la longitud de la matriz en una variable local en C #?</a></li>
<li><a href="../454584/index.html">Escuela de desarrollo de interfaz: an√°lisis de tareas para Minsk y un nuevo conjunto en Mosc√∫</a></li>
<li><a href="../454586/index.html">Resolver crucigramas japoneses con PÃ∂yÃ∂tÃ∂hÃ∂oÃ∂Ã∂nÃ∂ Rust y WebAssembly</a></li>
<li><a href="../454588/index.html">Gazprom Neft te invita a visitar: GPN Data Science Meetup</a></li>
<li><a href="../454590/index.html">Zimbra Collaboration Suite y control m√≥vil con ABQ</a></li>
<li><a href="../454596/index.html">Modelos mentales en seguridad de la informaci√≥n.</a></li>
<li><a href="../454598/index.html">Arquitectura sin servidor y microservicios: ¬øla combinaci√≥n perfecta?</a></li>
<li><a href="../454600/index.html">C√≥mo hicimos un trato seguro en Freelansim: elija, reduzca funciones, compare comisiones</a></li>
<li><a href="../454604/index.html">Generando una aplicaci√≥n React con un backend GraphQL en minutos</a></li>
<li><a href="../454606/index.html">Caracter√≠sticas del atributo inputmode para SO y navegadores m√≥viles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>