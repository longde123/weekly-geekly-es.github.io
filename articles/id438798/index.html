<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗜️ 🏬 🐐 Cara bekerja dengan data intelijen dunia maya: kami belajar mengumpulkan dan mengidentifikasi indikator kompromi sistem ⛹🏾 🐒 🧛🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sepanjang tahun lalu, topik intelijen dunia maya atau Ancaman Intelijen telah semakin meningkat popularitasnya dalam perlombaan senjata dunia maya ant...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara bekerja dengan data intelijen dunia maya: kami belajar mengumpulkan dan mengidentifikasi indikator kompromi sistem</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/438798/">  Sepanjang tahun lalu, topik intelijen dunia maya atau Ancaman Intelijen telah semakin meningkat popularitasnya dalam perlombaan senjata dunia maya antara penyerang dan pembela.  Jelas, secara proaktif mendapatkan informasi tentang ancaman cyber adalah hal yang sangat berguna, tetapi itu tidak akan melindungi infrastruktur dengan sendirinya.  Penting untuk membangun suatu proses yang akan membantu untuk mengelola dengan baik informasi tentang metode serangan yang mungkin, dan waktu yang tersedia untuk mempersiapkannya.  Dan syarat utama untuk pembentukan proses semacam itu adalah kelengkapan informasi tentang ancaman cyber. <br><br><img src="https://habrastorage.org/webt/xs/up/0s/xsup0shlxsxdrtgzjnomu86flea.jpeg"><br><br>  Data primer Ancaman Intelijen dapat diperoleh dari berbagai sumber.  Ini bisa berupa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">langganan gratis</a> , informasi dari mitra, tim investigasi teknis perusahaan, dll. <br><a name="habracut"></a><br>  Ada tiga tahap utama bekerja dengan informasi yang diperoleh melalui proses Intelijen Ancaman (meskipun kami, sebagai pusat pemantauan dan menanggapi serangan dunia maya, memiliki tahap keempat - memberi tahu pelanggan tentang ancaman tersebut): <br><br><ol><li>  Mendapatkan informasi, pemrosesan primer. </li><li>  Deteksi indikator kompromi (Indikator Kompromi, IOC). </li><li>  Verifikasi retrospektif. </li></ol><br><h3>  Akuisisi informasi, pemrosesan primer </h3><br>  Tahap pertama bisa disebut yang paling kreatif.  Memahami deskripsi ancaman baru dengan tepat, menyoroti indikator yang relevan, menentukan penerapannya ke organisasi tertentu, menyaring informasi yang tidak perlu tentang serangan (misalnya, ditargetkan secara sempit ke wilayah tertentu) - semua ini seringkali merupakan tugas yang sulit.  Pada saat yang sama, ada sumber yang menyediakan data yang terverifikasi secara eksklusif dan relevan yang dapat ditambahkan ke database secara otomatis. <br><br>  Untuk pendekatan sistematis terhadap pemrosesan informasi, kami sarankan untuk membagi indikator yang diperoleh dalam kerangka Threat Intelligence menjadi dua kelompok besar - tuan rumah dan jaringan.  Deteksi indikator jaringan tidak berarti kompromi yang jelas dari sistem, tetapi deteksi indikator host, sebagai suatu peraturan, andal menandakan keberhasilan serangan. <br><br>  Indikator jaringan meliputi domain, URL, alamat surat, satu set alamat IP dan porta.  Indikator host sedang menjalankan proses, perubahan pada cabang dan file registry, jumlah hash. <br><br>  Indikator diterima sebagai bagian dari peringatan ancaman tunggal, masuk akal untuk bergabung dalam satu kelompok.  Dalam hal deteksi indikator, ini sangat memudahkan penentuan jenis serangan, dan juga memudahkan untuk memeriksa sistem yang berpotensi dikompromikan untuk semua indikator yang mungkin dari laporan ancaman tertentu. <br><br>  Namun, kita sering harus berurusan dengan indikator, deteksi yang tidak memungkinkan kita untuk benar-benar berbicara tentang sistem yang dikompromikan.  Ini bisa berupa alamat IP milik perusahaan besar dan jaringan hosting, domain surat dari layanan pengiriman iklan, nama dan jumlah hash dari file yang dapat dieksekusi yang sah.  Contoh paling sederhana adalah alamat IP Microsoft, Amazon, CloudFlare, yang sering terdaftar, atau proses yang sah yang muncul dalam sistem setelah menginstal paket perangkat lunak, misalnya, pageant.exe, agen untuk menyimpan kunci.  Untuk menghindari sejumlah besar kesalahan positif, lebih baik untuk menyaring indikator tersebut, tetapi, katakanlah, jangan membuangnya - kebanyakan dari mereka tidak sepenuhnya tidak berguna.  Jika ada kecurigaan dari sistem yang dikompromikan, pemeriksaan penuh dilakukan pada semua indikator, dan deteksi bahkan indikator tidak langsung dapat mengkonfirmasi kecurigaan ini. <br><br>  Karena tidak semua indikator sama-sama bermanfaat, kami di Solar JSOC menggunakan apa yang disebut bobot indikator.  Dengan konvensi, deteksi peluncuran file, jumlah hash yang bertepatan dengan hash file executable berbahaya, memiliki bobot ambang batas.  Deteksi indikator seperti itu langsung mengarah pada terjadinya peristiwa keamanan informasi.  Akses tunggal ke alamat IP dari host yang berpotensi berbahaya pada port non-spesifik tidak akan mengarah ke peristiwa IB, tetapi akan jatuh ke profil khusus yang mengakumulasi statistik, dan deteksi panggilan lebih lanjut juga akan mengarah pada penyelidikan. <br><br>  Pada saat yang sama, ada mekanisme yang tampaknya masuk akal bagi kami pada saat penciptaan, tetapi pada akhirnya diakui sebagai tidak efektif.  Misalnya, pada awalnya ditetapkan bahwa beberapa jenis indikator akan memiliki masa hidup yang terbatas, setelah itu mereka akan dinonaktifkan.  Namun, seperti yang ditunjukkan oleh praktik, saat menyambung ke infrastruktur baru, host terkadang ditemukan yang telah terinfeksi berbagai jenis malware selama bertahun-tahun.  Misalnya, sekali ketika menghubungkan pelanggan, virus Corkow terdeteksi pada mesin kepala layanan IS (indikator lebih dari lima tahun pada waktu itu), dan penyelidikan lebih lanjut mengungkapkan backdoor dan keylogger yang dieksploitasi pada host. <br><br><h3>  Deteksi indikator kompromi </h3><br>  Kami bekerja dengan banyak pemasangan berbagai sistem SIEM, namun, struktur umum catatan yang termasuk dalam basis data indikator distandarisasi dan terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/rg/1m/cg/rg1mcgffhwd2sfncfwwcfx7gxey.png"><br><br>  Misalnya, mengurutkan indikator dengan TIReportID, Anda dapat menemukan semua indikator yang muncul dalam deskripsi ancaman tertentu, dan dengan mengklik tautan URL Anda bisa mendapatkan deskripsi terperinci tentang itu. <br><br>  Ketika membangun proses Intelijen Ancaman, sangat penting untuk menganalisis sistem informasi yang terhubung dengan SIEM dalam hal kegunaannya untuk mengidentifikasi indikator kompromi. <br><br>  Faktanya adalah bahwa deskripsi serangan biasanya mencakup berbagai jenis indikator kompromi - misalnya, jumlah hash dari malware, alamat IP dari server SS yang diketuk, dan sebagainya.  Tetapi jika alamat IP yang diakses oleh tuan rumah dimonitor dengan banyak cara perlindungan, maka informasi tentang jumlah hash jauh lebih sulit diperoleh.  Oleh karena itu, kami mempertimbangkan semua sistem yang dapat berfungsi sebagai sumber log apa pun dari sudut pandang indikator apa yang dapat mereka lacak: <br><table><tbody><tr><td>  Jenis indikator <br></td><td>  Jenis sumber <br></td></tr><tr><td>  Domain <br></td><td rowspan="2">  Server proxy, NGFW, server DNS <br></td></tr><tr><td>  URL <br></td></tr></tbody><tbody><tr><td>  Soket <br></td><td>  Proxy, NGFW, FW <br></td></tr><tr><td>  Mail <br></td><td>  Server Surat, Antispam, DLP <br></td></tr><tr><td>  Proses <br></td><td>  Log dari host, DB AVPO, Sysmon <br></td></tr><tr><td>  Daftar <br></td><td>  Log dari tuan rumah <br></td></tr><tr><td>  Hash sum <br></td><td>  Log dari host, DB AVPO, Sysmon, Sandboxes CMDB <br></td></tr></tbody></table><br>  Secara skematis, proses mendeteksi indikator kompromi dapat direpresentasikan sebagai berikut: <br><br><img src="https://habrastorage.org/webt/ze/sl/va/zeslvaahq-enqif5tbxrujabrza.png"><br><br>  Saya sudah berbicara tentang dua poin pertama di atas, sekarang lebih banyak tentang cek basis data IOC.  Sebagai contoh, kami akan mengambil acara yang berisi informasi tentang alamat IP.  Aturan korelasi untuk setiap acara melakukan empat kemungkinan pemeriksaan berdasarkan indikator: <br><br><img src="https://habrastorage.org/webt/4q/w_/pn/4qw_pn-hh3tq6xm1k9aeitrz6-s.png"><br><br>  Pencarian dilakukan oleh indikator yang relevan dari tipe Socket, sementara desain keseluruhan alamat IP dan port yang sesuai diperiksa untuk kesesuaian dengan indikator.  Karena  dalam informasi tentang ancaman, port spesifik tidak selalu ditunjukkan, IP: setiap konstruk memeriksa keberadaan alamat dengan port yang tidak ditentukan dalam database. <br><br>  Desain serupa diimplementasikan dalam aturan yang mendeteksi indikator kompromi dalam peristiwa perubahan registri.  Dalam informasi yang masuk sering tidak ada data pada kunci atau nilai tertentu, oleh karena itu, ketika indikator dimasukkan ke dalam database, data yang tidak diketahui atau tidak memiliki nilai pasti diganti dengan 'apa pun'.  Opsi pencarian terakhir adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/qw/4e/6z/qw4e6zjcm95uxkv0g3iwl12p1hi.png"><br><br>  Setelah menemukan indikator kompromi dalam log, aturan korelasi menciptakan peristiwa korelasi yang ditandai dengan kategori yang diproses aturan kejadian (kami membahas ini secara rinci dalam artikel " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dapur BENAR</a> "). <br><br>  Selain kategori, peristiwa korelasi akan dilengkapi dengan informasi tentang peringatan atau laporan indikator ini muncul, beratnya, data ancaman dan tautan ke sumber.  Pemrosesan lebih lanjut dari peristiwa deteksi indikator dari semua jenis dilakukan oleh aturan kejadian.  Karyanya dapat disajikan secara skematis sebagai berikut: <br><br><img src="https://habrastorage.org/webt/di/2c/6b/di2c6b7rnrhldtltmiam3kgekoi.png"><br><br>  Tetapi, tentu saja, Anda harus mengingat pengecualian: di hampir semua infrastruktur ada perangkat yang tindakannya sah, meskipun fakta bahwa mereka secara resmi mengandung tanda-tanda sistem yang dikompromikan.  Perangkat seperti itu paling sering termasuk kotak pasir, berbagai pemindai, dll. <br><br>  Kebutuhan untuk mengkorelasikan kejadian deteksi indikator dari berbagai jenis juga disebabkan oleh kenyataan bahwa indikator heterogen paling sering hadir dalam informasi tentang ancaman. <br>  Dengan demikian, pengelompokan peristiwa deteksi indikator dapat memungkinkan Anda untuk melihat seluruh rantai serangan dari saat penetrasi ke operasi. <br><br>  Kami mengusulkan untuk mempertimbangkan implementasi salah satu skenario berikut sebagai peristiwa keamanan informasi: <br><br><ol><li>  Deteksi indikator kompromi yang sangat relevan. </li><li>  Deteksi dua indikator berbeda dari satu laporan. </li><li>  Mencapai ambang batas. </li></ol><br>  Dengan dua opsi pertama, semuanya jelas, dan yang ketiga diperlukan ketika kita tidak memiliki data selain aktivitas jaringan sistem. <br><br><h3>  Pemeriksaan retrospektif dari indikator kompromi </h3><br>  Setelah menerima informasi tentang ancaman, mengidentifikasi indikator dan mengatur identifikasi mereka, ada kebutuhan untuk pemeriksaan retrospektif yang memungkinkan Anda untuk mendeteksi kompromi yang telah terjadi. <br><br>  Jika saya sedikit lebih dalam tentang bagaimana ini bekerja di SOC, saya dapat mengatakan bahwa proses ini membutuhkan jumlah waktu dan sumber daya yang sangat besar.  Pencarian untuk indikator kompromi dalam log selama setengah tahun memaksa kami untuk menjaga jumlah yang mengesankan dari mereka tersedia untuk cek online.  Selain itu, hasil pemeriksaan harus tidak hanya informasi tentang keberadaan indikator, tetapi juga data umum tentang perkembangan serangan.  Saat menghubungkan sistem informasi pelanggan baru, data dari mereka juga harus diperiksa untuk indikator.  Untuk ini, perlu untuk terus memperbaiki apa yang disebut "konten" SOC - aturan korelasi dan indikator kompromi. <br><br>  Untuk sistem ArcSight SIEM, bahkan pencarian seperti itu selama beberapa minggu terakhir dapat memakan waktu lama.  Oleh karena itu, diputuskan untuk mengambil keuntungan dari tren. <br><blockquote>  "Tren adalah sumber daya ESM yang menentukan bagaimana dan selama periode waktu apa data akan dikumpulkan dan dievaluasi untuk kecenderungan atau arus yang berlaku.  Tren mengeksekusi permintaan tertentu pada jadwal dan durasi waktu yang ditentukan. " <br><br>  ESM_101_Guide <br></blockquote><br>  Setelah beberapa tes pada sistem dimuat, algoritma berikut untuk menggunakan tren dikembangkan: <br><br><img src="https://habrastorage.org/webt/rn/v9/ef/rnv9efyjnwkryekyyzpy5vzdc8o.png"><br><br>  Aturan profil yang mengisi lembar aktif terkait dengan data berguna memungkinkan Anda untuk mendistribusikan total beban pada SIEM.  Setelah menerima indikator, permintaan dibuat dalam lembaran dan tren yang sesuai, berdasarkan laporan yang akan dibuat, yang pada gilirannya akan didistribusikan di seluruh instalasi.  Bahkan, tetap hanya menjalankan laporan dan memproses hasilnya. <br><br>  Perlu dicatat bahwa proses pemrosesan dapat terus ditingkatkan dan diotomatisasi.  Misalnya, kami telah memperkenalkan platform untuk menyimpan dan memproses indikator kompromi MISP, yang saat ini memenuhi persyaratan kami untuk fleksibilitas dan fungsionalitas.  Analoginya secara luas terwakili di pasar sumber terbuka - YETI, asing - Anomali ThreatStream, ThreatConnect, ThreatQuotinet, EclecticIQ, Rusia - TI.Platform, R-Vision Threat Intelligence Platform.  Sekarang kami sedang melakukan tes akhir pembongkaran acara otomatis langsung dari database SIEM.  Ini akan sangat mempercepat pelaporan indikator kompromi. <br><br><h3>  Unsur utama intelijen cyber </h3><br>  Namun demikian, tautan terakhir dalam pemrosesan baik indikator itu sendiri maupun laporannya adalah para insinyur dan analis, dan alat-alat yang tercantum di atas hanya membantu dalam membuat keputusan.  Di negara kita, kelompok respons bertanggung jawab untuk menambahkan indikator, dan kelompok pemantauan bertanggung jawab atas kebenaran laporan. <br><br>  Tanpa orang, sistem tidak akan bekerja dengan cukup baik, Anda tidak dapat melihat semua hal kecil dan pengecualian.  Sebagai contoh, kami mencatat panggilan ke alamat IP dari node TOR, tetapi dalam laporan untuk pelanggan kami berbagi aktivitas host yang dikompromikan dan host di mana Browser TOR diinstal.  Dimungkinkan untuk mengotomatiskannya, tetapi agak sulit untuk memikirkan semua poin tersebut di muka saat menyiapkan aturan.  Jadi ternyata kelompok respons, sesuai dengan berbagai kriteria, menghilangkan indikator yang akan membuat sejumlah besar positif palsu.  Dan sebaliknya - indikator spesifik dapat ditambahkan yang sangat relevan untuk beberapa pelanggan (misalnya, sektor keuangan). <br><br>  Kelompok pemantauan dapat menghapus aktivitas kotak pasir dari laporan akhir, memeriksa administrator untuk berhasil memblokir sumber berbahaya, tetapi menambahkan aktivitas tentang pemindaian eksternal yang tidak berhasil, menunjukkan kepada pelanggan bahwa infrastrukturnya sedang diperiksa oleh penyerang.  Mesin tidak akan membuat keputusan seperti itu. <br><br><img src="https://habrastorage.org/webt/o6/zb/c8/o6zbc8wr2lgj2oyy33a1isd9g7m.png"><br><br><h3>  Alih-alih output </h3><br>  Mengapa kami merekomendasikan metode ini untuk bekerja dengan Threat Intelligence?  Pertama-tama, ini memungkinkan Anda untuk keluar dari skema, ketika untuk setiap serangan baru Anda perlu membuat aturan korelasi yang terpisah.  Ini membutuhkan waktu yang sangat lama dan hanya mengungkapkan serangan yang sedang berlangsung. <br><br>  Metode yang dijelaskan memanfaatkan sebagian besar kemampuan TI - Anda hanya perlu menambahkan indikator, dan ini adalah maksimum 20 menit dari saat mereka muncul, dan kemudian melakukan pemeriksaan retrospektif penuh log.  Jadi Anda akan mengurangi waktu respons, dan mendapatkan hasil tes yang lebih lengkap. <br><br>  Jika Anda memiliki pertanyaan, silakan komentar. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id438798/">https://habr.com/ru/post/id438798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id438788/index.html">Pemantauan lingkungan di ruang server (Bolid + Zabbix)</a></li>
<li><a href="../id438790/index.html">Pertukaran cryptocurrency QuadrigaCX tidak akan memberikan $ 137 juta. Hanya direktur yang tahu kata sandi dari toko, dan dia meninggal</a></li>
<li><a href="../id438792/index.html">Menggunakan AccelStor Semua Array Flash dalam Proyek VDI</a></li>
<li><a href="../id438794/index.html">Detail Objek JavaScript</a></li>
<li><a href="../id438796/index.html">Mempelajari Docker Bagian 1: Dasar-Dasarnya</a></li>
<li><a href="../id438800/index.html">PHP Pear Diretas dan Tidak Tersedia</a></li>
<li><a href="../id438802/index.html">Program musim panas untuk 2019 untuk mengajar program remaja di luar negeri</a></li>
<li><a href="../id438804/index.html">Menunggu semua orang di CocoaHeads Meetup berikutnya</a></li>
<li><a href="../id438806/index.html">Masalah terjemahan sastra</a></li>
<li><a href="../id438808/index.html">ModelMapper: pulang pergi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>