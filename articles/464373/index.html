<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游꼜 游닏 游녿游낕 Edge-to-edge en Android: hacerlo bien 游냢 游녡游낗 游녞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El pasado Google I / O 2019 trajo muchas innovaciones sensacionales, muchas de las cuales afectar치n a la industria del desarrollo m칩vil en los pr칩ximo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Edge-to-edge en Android: hacerlo bien</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/464373/">  El pasado Google I / O 2019 trajo muchas innovaciones sensacionales, muchas de las cuales afectar치n a la industria del desarrollo m칩vil en los pr칩ximos a침os.  No fue menos interesante seguir las tendencias emergentes.  Primero, las teclas de control mec치nico pasaron a la historia, las pantallas de los tel칠fonos inteligentes se hicieron m치s grandes y los marcos laterales se volvieron m치s discretos.  Los gestos reemplazaron los botones del sistema en pantalla, dejando m치s y m치s espacio para el consumo de contenido.  Las aplicaciones se muestran en toda la superficie visible de la pantalla, desde el marco inferior al superior, sin restringirse a los l칤mites condicionales de la barra de estado y el panel de navegaci칩n.  Estamos al borde de una era de borde a borde. <br><br><img src="https://habrastorage.org/webt/xu/3i/ny/xu3inyrvy6ruyd_uj5j5l97pnf0.png"><br><a name="habracut"></a><br>  쯈u칠 es de borde a borde?  Entendido literalmente, esto significa que su aplicaci칩n debe mostrarse en toda la superficie visible de la pantalla, desde la parte inferior hasta el marco superior, sin restringirse a la barra de estado y los botones de navegaci칩n inferiores. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/119/459/053/11945905307bf673c909e4a75a270ba0.jpg"></div><br>  <i>Borde a borde en el ejemplo del shell del sistema Android.</i> <br><br>  Cuando se trata de Android, una idea simple est치 lejos de ser siempre f치cil de implementar.  En este art칤culo, hablaremos sobre c칩mo maximizar el uso de todo el espacio disponible en la pantalla de cualquier dispositivo, independientemente del fabricante, la versi칩n del sistema y la variedad de configuraciones que los fabricantes de dispositivos del Reino Medio (y no solo) adoran complacer a los usuarios.  El c칩digo presentado en el art칤culo fue probado personalmente en m치s de 30 dispositivos, y en 231 dispositivos diferentes por 100 mil usuarios de nuestras aplicaciones. <br><br>  El problema de crear una interfaz de borde a borde no es nuevo en s칤 mismo y era relevante mucho antes de I / O 2019. Seguramente, cada uno de ustedes recordar치 c칩mo google칩 por primera vez algo de la categor칤a: <i>"barra de estado transparente de Android"</i> o <i>"gradiente de barra de estado de Android" "</i> . <br><br>  Los criterios principales para que la aplicaci칩n coincida con el t칤tulo de borde a borde son: <br><br><ul><li>  barra de estado transparente; </li><li>  Barra de navegaci칩n transparente. </li></ul><br>  Lea m치s sobre ellos en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">material.io</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a20/18b/3a3/a2018b3a34a0d61b30d940f2c50c44fe.png"></div><br>  <i>La aplicaci칩n Deezer no se preocupa por el cumplimiento de borde a borde</i> <i><br></i> <br>  Es importante tener en cuenta que no estamos hablando de eliminarlos por completo, como en el " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modo de pantalla completa</a> ".  Dejamos al usuario la oportunidad de ver informaci칩n importante del sistema y utilizar la navegaci칩n familiar. <br><br>  Un requisito igualmente importante para una soluci칩n es la escalabilidad y la extensibilidad.  Hay varios otros: <br><br><ul><li>  Cambie correctamente la pantalla sobre el teclado sin romper el soporte para los indicadores de ajuste de tama침o de actividad; </li><li>  Evite superponer la barra de estado y la barra de navegaci칩n en los elementos de la interfaz de usuario de la aplicaci칩n, mientras muestra el fondo correspondiente debajo de ellos; </li><li>  Trabaja en todos los dispositivos con versiones actuales de Android y tiene un aspecto id칠ntico. </li></ul><br><h1>  Poco de teor칤a </h1><br>  De manera inesperada, puede tomar mucho tiempo encontrar una soluci칩n para una tarea aparentemente simple, que no ser치 f치cil de explicar para el gerente del proyecto.  Y cuando QA todav칤a encuentra el tel칠fono inteligente desafortunado, en el que su pantalla no se ve "seg칰n los c치nones" ... <br>  En nuestro proyecto, nos equivocamos varias veces.  Solo un mes despu칠s, despu칠s de pasar por una larga serie de prueba y error, resolvimos el problema de una vez por todas. <br><br>  En primer lugar, debe comprender c칩mo Android dibuja los paneles del sistema.  Comenzando con Android 5.0, se proporcion칩 una API conveniente para trabajar con sangr칤as del sistema a lo largo de los bordes horizontales de la pantalla.  Se llaman WindowInsets, y en la imagen a continuaci칩n est치n coloreados en rojo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd4/f76/d86/bd4f76d86dd3508a88edf9618eab7a1b.png"></div><br>  Adem치s, los desarrolladores del equipo de Android han agregado escuchas que le permiten suscribirse a los cambios en estas sangr칤as, por ejemplo, cuando aparece el teclado.  Estrictamente hablando, WindowInsets son los m치rgenes de su archivo de dise침o desde los bordes de la pantalla.  Al cambiar el tama침o de su actividad (modo de pantalla dividida, apariencia del teclado), el recuadro tambi칠n cambiar치.  Por lo tanto, para admitir borde a borde, debemos asegurarnos de que estas sangr칤as no est칠n all칤.  Una pantalla con WindowInsets nulos se ver치 as칤: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/197/cca/01d/197cca01df6de4ab8707131a70f8c993.png"></div><br><h1>  Implementaci칩n </h1><br>  En nuestra implementaci칩n, operaremos activamente en Windows y sus banderas. <br>  Todos los ejemplos se escribir치n en Kotlin, pero puede implementarlos f치cilmente en Java, utilizando utilidades en lugar de funciones de extensi칩n. <br><br>  Lo primero que debe hacer con el elemento de dise침o ra칤z es establecer expl칤citamente el indicador: <br><br><pre><code class="kotlin hljs">android:fitsSystemWindows=<span class="hljs-string"><span class="hljs-string">"true"</span></span></code> </pre> <br>  Esto es necesario para garantizar que la Vista ra칤z se dibuje debajo de los elementos del sistema, as칤 como para las medidas correctas de Inset al suscribirse a su cambio. <br>  Ahora pasamos a lo m치s importante: 춰eliminamos los bordes de la pantalla!  Sin embargo, esto debe hacerse con mucho cuidado.  Y aqu칤 est치 el por qu칠: <br><br><ol><li>  Poniendo a cero el recuadro inferior, corremos el riesgo de perder la reacci칩n de la ventana a la apariencia del teclado: hay muchos consejos en StackOverflow para restablecer el recuadro superior, pero los inferiores son delicadamente silenciosos.  Debido a esto, la barra de navegaci칩n no resulta ser completamente transparente.  Al restablecer el recuadro inferior, el indicador de ajuste de tama침o deja de funcionar. <br><br>  <b>Soluci칩n:</b> cada vez que cambie el recuadro, determine si la altura m치s baja del teclado est치 contenido en 칠l y solo rein칤cielo de lo contrario. </li><li>  Cuando reinicia el recuadro, las partes visibles de la vista aparecer치n debajo de la barra de estado y la barra de navegaci칩n.  Seg칰n el concepto de dise침o de materiales (y sentido com칰n), no deben ubicarse elementos activos en las 치reas del sistema.  Es decir, en esta 치rea no debe haber botones, campos para ingresar texto, casillas de verificaci칩n, etc. <br><br>  <b>Soluci칩n:</b> agregaremos un oyente al oyente, de modo que cuando cambie WindowInsets, traduzca las sangr칤as del sistema a la Actividad y responda a ellas internamente configurando los rellenos y m치rgenes correctos para la Vista. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3bd/73e/10e/3bd73e10ee50b6e2ae8a2da1b1bb2808.png"></div><br>  Este comportamiento no debe permitirse (la barra de herramientas se arrastra en la barra de estado). <br><br>  La funci칩n <i>removeSystemInsets () se</i> ve as칤: <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeSystemInsets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params">, listener: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">OnSystemInsetsChangedListener</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { ViewCompat.setOnApplyWindowInsetsListener(view) { _, insets -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> desiredBottomInset = calculateDesiredBottomInset( view, insets.systemWindowInsetTop, insets.systemWindowInsetBottom, listener ) ViewCompat.onApplyWindowInsets( view, insets.replaceSystemWindowInsets(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, desiredBottomInset) ) } }</code> </pre><br>  La funci칩n CalculateDesiredBottomInset <i>() calcula el</i> recuadro inferior con o sin el teclado, dependiendo de la configuraci칩n actual del dispositivo. <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateDesiredBottomInset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params">, topInset: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, bottomInset: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, listener: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">OnSystemInsetsChangedListener</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> hasKeyboard = isKeyboardAppeared(view, bottomInset) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> desiredBottomInset = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasKeyboard) bottomInset <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> listener(topInset, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasKeyboard) <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> bottomInset) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> desiredBottomInset }</code> </pre><br>  Use el m칠todo <i>isKeyboardAppeared ()</i> para verificar la altura del teclado <i>.</i>  Confiamos en la hip칩tesis de que el teclado no puede ocupar menos de un cuarto de la altura de la pantalla.  Si lo desea, puede modificar la l칩gica de verificaci칩n a su gusto. <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> View.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isKeyboardAppeared</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(bottomInset: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = bottomInset / resourdisplayMetrics.heightPixels.toDouble() &gt; .<span class="hljs-number"><span class="hljs-number">25</span></span></code> </pre> <br>  El m칠todo <i>removeSystemInsets ()</i> usa un escucha.  En realidad, estos son solo typealias para una expresi칩n lambda.  Su c칩digo completo: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> OnSystemBarsSizeChangedListener = (statusBarSize: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, navigationBarSize: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span></code> </pre> <br>  El siguiente paso es establecer la transparencia en las barras del sistema: <br><br><pre> <code class="kotlin hljs">window.statusBarColor = Color.TRANSPARENT window.navigationBarColor = Color.TRANSPARENT</code> </pre> <br>  Una vez compilado todo lo anterior, obtenemos el siguiente m칠todo: <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Activity.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setWindowTransparency</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( listener: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">OnSystemInsetsChangedListener</span></span></span></span><span class="hljs-function"><span class="hljs-params"> = { _, _ -&gt; } )</span></span></span></span> { InsetUtil.removeSystemInsets(window.decorView, listener) window.navigationBarColor = Color.TRANSPARENT window.statusBarColor = Color.TRANSPARENT }</code> </pre> <br>  Ahora, para habilitar el modo de borde a borde de la Actividad deseada, solo necesita llamar a la siguiente funci칩n en el m칠todo <i>onCreate ()</i> : <br><br><pre> <code class="kotlin hljs">setWindowTransparency { statusBarSize, navigationBarSize -&gt; <span class="hljs-comment"><span class="hljs-comment">//  }</span></span></code> </pre> <br>  Por lo tanto, en menos de 30 l칤neas de c칩digo, hemos logrado un efecto de "borde a borde", sin violar ning칰n principio de UX y sin privar al usuario de los controles habituales del sistema.  Tal implementaci칩n puede parecer simple y trivial para alguien, pero es eso lo que garantiza el funcionamiento confiable de su aplicaci칩n en cualquier dispositivo. <br>  Puede lograr el efecto de "borde a borde" de aproximadamente cien formas diferentes (el n칰mero de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">consejos</a> en StackOverflow es una clara confirmaci칩n de esto), pero muchos de ellos conducen a un comportamiento incorrecto en diferentes versiones de Android, o no tienen en cuenta par치metros como la necesidad de mostrar por mucho tiempo listas, o rompa el tama침o de la pantalla al mostrar el teclado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/955/a21/a0a/955a21a0a5422a4463fa0908c0427990.gif"></div><br><hr><br><h1>  Volar en la pomada </h1><br>  La soluci칩n descrita en este art칤culo es adecuada para todos los dispositivos actuales.  Real significa dispositivos en Android Lollipop (5.0) y superior.  Para ellos, la soluci칩n anterior funcionar치 perfectamente.  Pero para las versiones anteriores de Android, necesitar치 su propia implementaci칩n, ya que no se sab칤a nada sobre WindowInsets en esos d칤as. <br><br>  La buena noticia es que en Android KitKat (4.4), la transparencia de los paneles del sistema todav칤a es compatible.  Pero las versiones anteriores no admiten tal belleza en absoluto, ni siquiera puedes intentarlo. <br><br>  Centr칠monos en el cambio de Insets en Android 4.4.  Esto se puede hacer en el m칠todo <i>fitSystemWindows ()</i> .  Por lo tanto, el elemento principal en su dise침o debe ser un contenedor con un m칠todo anulado fitSystemWindows que contenga exactamente la misma implementaci칩n que nuestro oyente en el ejemplo para las versiones actuales de Android. <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KitkatTransparentSystemBarsFrame</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@JvmOverloads</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( context: Context, attrs: AttributeSet? = <span class="hljs-literal"><span class="hljs-literal">null</span></span>, defStyleAttr: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> = -<span class="hljs-number"><span class="hljs-number">1</span></span> ) : FrameLayout(context, attrs, defStyleAttr), KitkatTransparentSystemBarsContainer { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onSystemInsetsChangedListener: OnSystemInsetsChangedListener = { _, _ -&gt; } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fitSystemWindows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(insets: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Rect</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { insets ?: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> desiredBottomInset = InsetUtil.calculateDesiredBottomInset( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, insets.top, insets.bottom, onSystemInsetsChangedListener ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.fitSystemWindows(Rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, desiredBottomInset)) }</code> </pre><br>  En dispositivos con Android 4.4, solo la transparencia parcial funciona mediante la configuraci칩n de indicadores transl칰cidos: <br><br><pre> <code class="kotlin hljs">window.addFlags( WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS or WindowManager.LayoutParams.FLAG_TRANSLUCENT_NAVIGATION )</code> </pre> <br>  Estas banderas hacen que las barras del sistema sean transl칰cidas, agregando un ligero gradiente que, desafortunadamente, no se puede eliminar.  Sin embargo, el gradiente se puede convertir en una barra de color transl칰cida usando esta biblioteca: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/jgilfelt/SystemBarTint</a> .  Ella nos ha rescatado m치s de una vez en el pasado.  Los 칰ltimos cambios se realizaron en la biblioteca hace 5 a침os, por lo que solo revelar치 su encanto a las verdaderas ciudades retr칩gradas. <br><br>  Todo el proceso de marcado para Kitkat se ver치 as칤: <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Activity.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setWindowTransparencyKitkat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( rootView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">KitkatTransparentSystemBarsContainer</span></span></span></span><span class="hljs-function"><span class="hljs-params">, listener: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">OnSystemBarsSizeChangedListener</span></span></span></span><span class="hljs-function"><span class="hljs-params"> = { _, _ -&gt; } )</span></span></span></span> { rootView.onSystemBarsSizeChangedListener = listener window.addFlags( WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS or WindowManager.LayoutParams.FLAG_TRANSLUCENT_NAVIGATION ) }</code> </pre> <br>  Con esto en mente, escribimos un m칠todo universal que puede hacer que las barras del sistema sean transparentes (o al menos transl칰cidas), independientemente de qu칠 aplicaci칩n se ejecute en un dispositivo con qu칠 versi칩n de Android: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP -&gt; setWindowTransparency(::updateMargins) Build.VERSION.SDK_INT == Build.VERSION_CODES.KITKAT -&gt; setWindowTransparencyKitkat(root_container, ::updateMargins) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; { <span class="hljs-comment"><span class="hljs-comment">/*do nothing*/</span></span> } }</code> </pre><br>  Debajo del spoiler a continuaci칩n, puede ver c칩mo se ve la muestra presentada en el art칤culo en algunos de los dispositivos problem치ticos: <br><br><div class="spoiler">  <b class="spoiler_title">Capturas de pantalla</b> <div class="spoiler_text">  Huawei Honor 8, Android 7.0 <br><br><img src="https://habrastorage.org/webt/vb/iq/vb/vbiqvbaw6ncicr9zaramjgp7rw4.png"><br><br>  Xiaomi Redmi Note 4, Android 6.1 <br><br><img src="https://habrastorage.org/webt/oa/qz/09/oaqz09dbvoqd9lvdrqmvd_db2lq.png"><br><br>  HTC Desire Dual Sim, Android 4.4.2 <br><br><img src="https://habrastorage.org/webt/qa/tj/og/qatjogphzqsrtj59iep-bnnqdyw.png"><br><br>  Samsung J3, Android 7.0 <br><br><img src="https://habrastorage.org/webt/_u/tm/gj/_utmgjk86esswybhkri_ropcghw.jpeg"><br><br>  Meizu M3s, Android 5.1 <br><br><img src="https://habrastorage.org/webt/5m/9b/7f/5m9b7f0wc6g3vodq2jimsaqichm.jpeg"><br><br>  Asus Zenfone 3 Max, Android 6.0 <br><br><img src="https://habrastorage.org/webt/ye/t5/9l/yet59l_2qgcqsdbnps2jgwgvx3g.jpeg"><br><br>  Umi Rome, Android 5.0 <br><br><img src="https://habrastorage.org/webt/qn/th/zp/qnthzp8jdtsobkl2t5c_et3iada.png"><br><br>  Nexus 5X, Android 8.0 <br><br><img src="https://habrastorage.org/webt/t7/9j/mo/t79jmolqrgeimm_0ylppf3nwwrk.png"><br><br>  Samsung Galaxy S8, Android 9.0 <br><br><img src="https://habrastorage.org/webt/to/cg/ab/tocgabznqxu36_wp1-d9aou0hbe.jpeg"><br></div></div><br><hr><br>  En conclusi칩n, quiero decir que la soluci칩n incluso a una tarea aparentemente tan simple como establecer la transparencia para los elementos de la interfaz de usuario del sistema puede arrastrarlo a lo largo de toda la variedad de trampas y, en 칰ltima instancia, no conducir al resultado deseado, sino que causar치 errores desagradables.  Qu칠 bueno que tienes este art칤culo ahora. <br><br>  Puede encontrar una lista completa del programa y una muestra de trabajo en nuestro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">repositorio de git</a> . <br><br>  El material est치 inspirado en el informe de Chris Banes "Convertirse en un instalador de ventanas maestro". <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/_mGDMVRO3iE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Expreso mi gratitud al estudio de Surf y Evgeny Saturov por su ayuda en la preparaci칩n del material. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/464373/">https://habr.com/ru/post/464373/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../464361/index.html">Intel Quartz Canyon - NUC para profesionales</a></li>
<li><a href="../464365/index.html">Semana de la seguridad 34: vulnerabilidades extraordinarias en Windows</a></li>
<li><a href="../464367/index.html">Y otro Steam Windows Client Local Privilege Escalation 0day</a></li>
<li><a href="../464369/index.html">쯈u칠 bloqueador usas? Resultados</a></li>
<li><a href="../464371/index.html">/etc/resolv.conf para pods Kubernetes, opci칩n ndots: 5, ya que esto puede afectar negativamente el rendimiento de la aplicaci칩n</a></li>
<li><a href="../464375/index.html">C칩mo funcionan los motores de b칰squeda</a></li>
<li><a href="../464377/index.html">Ensamblador sucio piratea 6502</a></li>
<li><a href="../464381/index.html">Viaje a Alaska, o KDD'19 a trav칠s de los ojos de un testigo ocular</a></li>
<li><a href="../464383/index.html">C칩mo pongo las cosas en orden en un proyecto donde hay un bosque de manos directas (configuraci칩n tslint, m치s bonita, etc.)</a></li>
<li><a href="../464385/index.html">Python como el 칰ltimo caso de C ++. Parte 1/2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>