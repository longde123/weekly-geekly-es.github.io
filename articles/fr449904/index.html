<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∫ ‚õé üà∂ Cr√©ation d'une DLL de proxy pour les v√©rifications des op√©rations de DLL de piratage üëäüèæ üèÇüèº ‚ò£Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque j'examine la s√©curit√© des logiciels, l'un des points √† v√©rifier est de travailler avec des biblioth√®ques dynamiques. Les attaques comme la DLL...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cr√©ation d'une DLL de proxy pour les v√©rifications des op√©rations de DLL de piratage</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/449904/">  Lorsque j'examine la s√©curit√© des logiciels, l'un des points √† v√©rifier est de travailler avec des biblioth√®ques dynamiques.  Les attaques comme la DLL de piratage (¬´usurpation de DLL¬ª ou ¬´interception de DLL¬ª) sont tr√®s rares.  Tr√®s probablement, cela est d√ª au fait que les d√©veloppeurs Windows ajoutent des m√©canismes de s√©curit√© pour emp√™cher les attaques, et les d√©veloppeurs de logiciels sont plus attentifs √† la s√©curit√©.  Mais la situation est d'autant plus int√©ressante que le logiciel cible est vuln√©rable. <br><br>  D√©crivant bri√®vement l'attaque, la DLL de piratage cr√©e une situation dans laquelle un ex√©cutable essaie de charger la DLL, mais l'attaquant intervient dans ce processus, et au lieu de la biblioth√®que attendue, une DLL sp√©cialement pr√©par√©e est charg√©e avec la charge utile de l'attaquant.  En cons√©quence, le code de la DLL sera ex√©cut√© avec les droits de l'application lanc√©e, par cons√©quent, les applications avec des droits plus √©lev√©s sont g√©n√©ralement s√©lectionn√©es comme cible. <br><br>  Pour que la biblioth√®que se charge correctement, un certain nombre de conditions doivent √™tre remplies: la taille en bits du fichier ex√©cutable et la biblioth√®que doivent correspondre, et si la biblioth√®que est charg√©e au d√©marrage de l'application, la DLL doit exporter toutes les fonctions que cette application s'attend √† importer.  Souvent, une seule importation ne suffit pas - il est tr√®s souhaitable que l'application continue son travail apr√®s le chargement de la DLL.  Pour cela, il est n√©cessaire que les fonctions de la biblioth√®que pr√©par√©e fonctionnent de la m√™me mani√®re que l'original.  La fa√ßon la plus simple de proc√©der consiste √† simplement passer les appels de fonction d'une biblioth√®que √† une autre.  Ce sont les DLL appel√©es DLL proxy. <br><br><img src="https://habrastorage.org/webt/9l/cw/yb/9lcwyb3oo0wolz45digsbnh6wmw.jpeg"><br><br>  Sous la coupe, il y aura plusieurs options pour cr√©er de telles biblioth√®ques - √† la fois sous forme de code et d'utilitaires. <br><a name="habracut"></a><br>
<h2>  <font color="orange">Une petite revue th√©orique</font> </h2><br>  Les biblioth√®ques sont plus souvent charg√©es √† l'aide de la fonction LoadLibrary, dans laquelle le nom de la biblioth√®que est transmis.  Si, au lieu du nom, vous passez le chemin complet, l'application essaiera de charger la biblioth√®que sp√©cifi√©e.  Par exemple, l'appel √† LoadLibrary (¬´C: \ Windows \ system32 \ version.dll¬ª) chargera la DLL sp√©cifi√©e.  Ou, si la biblioth√®que n'existe pas, elle ne sera pas charg√©e. <br><br><div class="spoiler">  <b class="spoiler_title">Un peu d'ennui</b> <div class="spoiler_text">  Si une DLL est d√©j√† charg√©e dans l'application, elle ne sera pas charg√©e √† nouveau.  √âtant donn√© que version.dll est charg√© au d√©but de presque n'importe quel fichier exe, en fait, l'appel ci-dessus ne chargera rien.  Mais nous consid√©rons toujours le cas g√©n√©ral, consid√©rons l'exemple comme un appel √† une biblioth√®que abstraite. <br></div></div><br>  C'est tout autre chose si vous √©crivez LoadLibrary (¬´version.dll¬ª).  Dans une situation normale, le r√©sultat sera exactement le m√™me que dans le cas pr√©c√©dent - C: \ Windows \ system32 \ version.dll se chargera, mais pas si simple. <br><br>  Tout d'abord, une biblioth√®que sera recherch√©e, qui ira dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ordre</a> suivant: <br><br><ol><li>  Dossier ex√©cutable </li><li>  Dossier C: \ Windows \ System32 </li><li>  Dossier C: \ Windows \ System </li><li>  Dossier C: \ Windows </li><li>  Le dossier d√©fini comme courant pour l'application </li><li>  Dossiers de la variable d'environnement PATH </li></ol><br><div class="spoiler">  <b class="spoiler_title">Un peu plus d'ennui</b> <div class="spoiler_text">  Lors du d√©marrage d'applications 32 bits sur un syst√®me 64 bits, tous les appels √† C: \ Windows \ system32 seront transf√©r√©s vers C: \ Windows \ SysWOW64.  C'est juste pour la pr√©cision de la description, du point de vue de l'attaquant, la diff√©rence n'est pas particuli√®rement importante. <br></div></div><br>  Lorsque vous ex√©cutez le fichier exe, le syst√®me d'exploitation charge toutes les biblioth√®ques √† partir de la section d'importation de fichiers.  Dans un sens g√©n√©ral, nous pouvons supposer que le syst√®me d'exploitation force le fichier √† appeler LoadLibrary, en passant tous les noms de biblioth√®que qui sont √©crits dans la section d'importation.  √âtant donn√© que dans 99,9% des cas, il existe des noms et non des chemins, au d√©marrage de l'application, toutes les biblioth√®ques charg√©es seront recherch√©es dans le syst√®me. <br><br>  Dans la liste des emplacements de recherche de DLL, deux points sont vraiment importants pour nous - 1 et 6. Si nous mettons version.dll dans le m√™me dossier √† partir duquel le fichier est lanc√©, alors au lieu du syst√®me, celui charg√© sera charg√©.  Cette situation n'est presque jamais rencontr√©e, car s'il est possible de mettre une biblioth√®que, il est tr√®s probable qu'il soit possible de remplacer le fichier ex√©cutable lui-m√™me.  Mais encore, de telles situations sont possibles.  Par exemple, si le fichier ex√©cutable se trouve dans un dossier accessible en √©criture et est un service avec un d√©marrage automatique, il ne peut pas √™tre modifi√© pendant que le service lui-m√™me est en cours d'ex√©cution.  Ou le fichier lanc√© est v√©rifi√© en externe par somme de contr√¥le avant de commencer, puis le remplacement du fichier n'est toujours pas une option.  Mais mettre la biblioth√®que √† c√¥t√© sera bien r√©el. <br><br>  Vous ne pourrez peut-√™tre pas cr√©er de fichiers √† c√¥t√© de fichiers ex√©cutables, mais vous pouvez cr√©er des dossiers.  Dans cette situation, le m√©canisme de redirection WinSxS (alias ¬´DotLocal¬ª) peut fonctionner. <br><br><div class="spoiler">  <b class="spoiler_title">En bref sur DotLocal</b> <div class="spoiler_text">  Le manifeste du fichier peut contenir une d√©pendance √† la biblioth√®que d'une version sp√©cifique.  Dans ce cas, lors du d√©marrage du fichier ex√©cutable (par exemple, que ce soit application.exe), le syst√®me d'exploitation v√©rifie l'existence d'un dossier nomm√© application.exe.local dans le m√™me dossier que le fichier lui-m√™me.  Ce dossier doit avoir un sous-dossier avec un nom complexe comme amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.9600.19291_none_6248a9f3ecb5e89b √† l'int√©rieur duquel se trouve d√©j√† une biblioth√®que comctl32.dll.  Le nom de la biblioth√®que et les informations pour le nom du dossier doivent √™tre indiqu√©s dans le manifeste, voici juste un exemple du premier processus rencontr√©.  S'il n'y a pas de dossiers ou de fichiers, la biblioth√®que sera extraite de C: \ Windows \ WinSxS.  Dans l'exemple, C: \ Windows \ WinSxS \ amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.9600.19291_none_6248a9f3ecb5e89b \ comctl32.dll. <br></div></div><br>  Mais c'est plus l'exception que la r√®gle.  Mais les situations o√π la recherche de DLL atteint le 6e num√©ro de la liste sont bien r√©elles.  Si l'application essaie de charger une DLL qui ne se trouve pas sur le syst√®me ou √† c√¥t√© du fichier, toutes les recherches iront jusqu'√† 6 points, qui pourraient √™tre des dossiers accessibles en √©criture. <br><br>  Par exemple, une installation Python typique se produit le plus souvent dans le dossier C: \ Python (ou fermer).  Le programme d'installation de python lui-m√™me sugg√®re d'ajouter ses dossiers √† la variable syst√®me PATH.  En cons√©quence, nous avons un bon tremplin pour d√©marrer une attaque - le dossier est accessible en √©criture par tous les utilisateurs et toute tentative de chargement d'une biblioth√®que inexistante ira √† la recherche de chemin √† partir de PATH. <br><br>  Maintenant que la th√©orie est termin√©e, consid√©rez la cr√©ation de la charge utile - les biblioth√®ques proxy elles-m√™mes. <br><br><h2>  <font color="orange">La premi√®re option.</font>  <font color="orange">Biblioth√®que de proxy honn√™te</font> </h2><br>  Commen√ßons par une solution relativement simple - nous cr√©erons une biblioth√®que de proxy honn√™te.  L'honn√™tet√© dans ce cas implique que toutes les fonctions de la dll seront explicitement enregistr√©es, et pour chaque fonction un appel de fonction avec le m√™me nom de la biblioth√®que d'origine sera √©crit.  Travailler avec une telle biblioth√®que sera compl√®tement transparent pour le code appel√©: s'il appelle une fonction, il recevra la bonne r√©ponse, le r√©sultat et tout ce qui devrait arriver c√¥te √† c√¥te. <br><br>  Voici un lien vers l'exemple fini ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> ) de la biblioth√®que version.dll. <br><br>  Points saillants du code: <br><br><ul><li>  Tous les prototypes de fonctions de la table d'exportation de la biblioth√®que d'origine sont honn√™tement d√©crits. </li><li>  La biblioth√®que d'origine est charg√©e et tous les appels √† nos fonctions y sont lanc√©s. </li></ul><br>  <b>De fa√ßon pratique</b> , l'application continue de fonctionner correctement, sans aucun "effet sp√©cial".  <b>Il n'est pas pratique</b> que j'ai d√ª √©crire un tas de code uniforme pour chacune des fonctions, en plus, en v√©rifiant soigneusement la co√Øncidence des prototypes. <br><br><h2>  <font color="orange">La deuxi√®me option.</font>  <font color="orange">Simplifiez l'√©criture de code</font> </h2><br>  Lorsqu'il s'agit d'une biblioth√®que comme version.dll, o√π la table d'importation est petite, il n'y a que 17 fonctions et les prototypes sont simples, alors une biblioth√®que proxy honn√™te est un bon choix. <br><br><img src="https://habrastorage.org/webt/ws/cl/yv/wsclyv4uqz71puco7dp5jhsrhgq.png"><br><br>  Mais si le proxy de la biblioth√®que, par exemple, bcrypt, alors tout est plus compliqu√©.  Voici sa table d'importation: <br><br><img src="https://habrastorage.org/webt/b7/1v/5e/b71v5exl1zruqbn_0xlidadlpfs.png"><br><br>  57 fonctionnalit√©s!  Et voici quelques exemples de prototypes: <br><br><img src="https://habrastorage.org/webt/_5/du/ve/_5duve7awc84bk3btklrsqq6wzq.png"><br><img src="https://habrastorage.org/webt/7p/kq/5x/7pkq5xz7uxvpju2zcc3q4q78zcs.png"><br><br>  Disons simplement que rien n'est impossible, mais faire un proxy honn√™te pour une telle biblioth√®que n'est pas tr√®s agr√©able. <br><br>  Vous pouvez simplifier le code si vous trichez un peu avec les fonctions.  Nous d√©clarerons toutes les fonctions de la biblioth√®que comme __declspec (nu), et dans le corps, nous utiliserons du code assembleur qui cr√©e simplement jmp sur la fonction de la biblioth√®que d'origine.  Cela nous permettra de ne pas utiliser de longs prototypes, mais de mettre des annonces simples partout sans param√®tres d'affichage: <br><br>  void foo () <br><br>  Lorsque l'application appelle notre fonction, la biblioth√®que proxy n'effectuera aucune manipulation avec le registre et la pile, permettant √† la fonction d'origine de faire tout le travail comme il se doit. <br><br>  Un exemple ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> ) de la biblioth√®que version.dll avec cette approche. <br><br>  Faits saillants: <br><br><ul><li>  La biblioth√®que d'origine est charg√©e et tous les appels √† nos fonctions y sont lanc√©s.  Les corps de fonction et le chargement sont envelopp√©s dans des macros. </li></ul><br>  Fonctionnement <b>pratique</b> et correct de l'application et le fait que m√™me un grand nombre de fonctions sont facilement d√©crites, gr√¢ce aux macros.  <b>Il est g√™nant</b> ce r√¢teau plut√¥t inattendu en x64.  Visual Studio (quelque part depuis 2012, si je me souviens bien) interdit d'utiliser des insertions nues et asm dans du code 64 bits.  Lors de l'√©criture d'un proxy √† partir de z√©ro, il est n√©cessaire que chaque fonction v√©rifie qu'elle est d√©crite dans le fichier def, que l'original est charg√© et que le corps de la fonction est d√©crit. <br><br><h2>  <font color="orange">La troisi√®me option.</font>  <font color="orange">On jette le corps en g√©n√©ral</font> </h2><br>  Utiliser nu sugg√®re une autre option.  Vous pouvez cr√©er une table d'importation qui, pour toutes les fonctions, fera r√©f√©rence √† une vraie ligne de code: <br><br>  void nop () {} <br><br>  Une telle biblioth√®que sera charg√©e par l'application, mais ne fonctionnera pas.  Lors de l'appel de l'une des fonctions, la pile sera tr√®s probablement d√©chir√©e ou une autre boue se produira.  Mais ce n'est pas toujours mauvais - si, par exemple, le but d'une injection de DLL est d'ex√©cuter simplement le code avec les droits n√©cessaires, alors il suffit d'ex√©cuter la charge utile √† partir de la biblioth√®que proxy DllMain et de terminer l'application imm√©diatement en silence.  Dans ce cas, il n'y aura pas de v√©ritable appel aux fonctions et il n'y aura pas de plantage d'erreur. <br><br>  Un exemple sur un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> , encore pour version.dll. <br><br>  Points saillants du code: <br><br><ul><li>  Toutes les fonctions du fichier def se r√©f√®rent √† une fonction nop. </li></ul><br>  <b>De mani√®re pratique</b> , une telle biblioth√®que proxy est √©crite juste pour quelques minutes.  <b>Il n'est pas pratique</b> que l'application appel√©e cesse de fonctionner. <br><br><h2>  <font color="orange">La quatri√®me option.</font>  <font color="orange">Prenez des utilitaires pr√™ts √† l'emploi</font> </h2><br>  L'√©criture d'une DLL est bonne, mais pas toujours pratique et pas tr√®s rapide, vous devriez donc envisager des options automatis√©es. <br><br>  Vous pouvez suivre le chemin des anciens virus - prenez la biblioth√®que dont nous voulons cr√©er les proxys, cr√©ez-y une section ex√©cutable de code, notez-y la charge utile et modifiez le point d'entr√©e dans cette section.  Ce n'est pas le moyen le plus simple, car vous pouvez accidentellement casser quelque chose, vous devez √©crire dans l'assembleur, n'oubliez pas le p√©riph√©rique du fichier PE.  Ce n'est pas notre chemin. <br><br>  Pour faire fonctionner le d√©tournement de DLL, nous ajouterons un autre d√©tournement de DLL. <br><br><img src="https://habrastorage.org/webt/lo/rr/ux/lorruxyxi0m-fjomp-j22b18are.jpeg"><br><br>  C'est relativement facile √† faire.  Nous copions la biblioth√®que dont nous voulons cr√©er le proxy et ajoutons une DLL avec une fonction arbitraire √† la table d'importation de cette copie.  Maintenant, le t√©l√©chargement suivra la cha√Æne - au d√©but du fichier ex√©cutable, la DLL du proxy sera charg√©e, qui chargera la biblioth√®que sp√©cifi√©e elle-m√™me. <br><br>  ¬´H√©, tu as remplac√© le chargement d'une biblioth√®que par une autre.  √Ä quoi √ßa sert?  Il faudra tout de m√™me coder dll! ".  Tout est correct, mais il y a toujours un sens.  Il y aura d√©sormais moins d'exigences pour une biblioth√®que avec une charge utile.  Vous pouvez sp√©cifier n'importe quel nom, l'essentiel est d'exporter une seule fonction, qui peut avoir n'importe quel prototype.  Entrez le nom principal de la biblioth√®que et de la fonction dans la table d'importation. <br><br>  Une biblioth√®que avec une charge utile peut √™tre une pour toutes les occasions. <br><br>  Vous pouvez modifier la table d'importation avec de nombreux √©diteurs PE, par exemple CFF explorer ou pe-bear.  Pour ma part, j'ai √©crit un petit utilitaire en C # qui corrige une table sans gestes inutiles.  Sources sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> , binar dans la section <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Release</a> . <br><br><h2>  <font color="orange">Conclusion</font> </h2><br>  Dans l'article, j'ai essay√© de divulguer les m√©thodes de base pour cr√©er une DLL proxy, que j'ai moi-m√™me utilis√©es.  Il ne reste plus qu'√† dire comment se d√©fendre. <br><br>  Il n'y a pas beaucoup de recommandations universelles: <br><br><ul><li>  Ne stockez pas de fichiers ex√©cutables, en particulier ceux ex√©cut√©s avec des autorisations √©lev√©es, dans des dossiers accessibles en √©criture aux utilisateurs. </li><li>  Il est pr√©f√©rable de rechercher et de v√©rifier d'abord l'existence de la biblioth√®que avant d'effectuer LoadLibrary. </li><li>  Regardez les m√©thodes de protection existantes disponibles dans le syst√®me d'exploitation.  Par exemple, dans Windows 10, vous pouvez d√©finir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'indicateur PreferSystem32 afin</a> que la recherche dll ne commence pas par le dossier de fichiers ex√©cutables, mais par system32. </li></ul><br>  Merci de votre attention, je serai heureux d'entendre des questions, des souhaits, des suggestions et des commentaires. <br><br>  <b>UPD:</b> Sur les conseils des commentateurs, je vous rappelle que vous devez choisir soigneusement et soigneusement une biblioth√®que.  Si la biblioth√®que est incluse dans la liste KnownDlls ou si le nom est similaire √† MinWin (ApiSetSchema, api-ms-win-core-console-l1-1-0.dll - c'est tout), il est tr√®s probable qu'il ne sera pas possible de l'intercepter en raison des fonctionnalit√©s de traitement ces DLL dans le syst√®me d'exploitation. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr449904/">https://habr.com/ru/post/fr449904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr449888/index.html">Physique quantique: d√©coh√©rence</a></li>
<li><a href="../fr449890/index.html">Comment sont les sections algorithmiques lors des entretiens dans Yandex</a></li>
<li><a href="../fr449896/index.html">Comment faire pa√Ætre le (s) chat (s), ou conseils √† un jeune programmeur</a></li>
<li><a href="../fr449898/index.html">Nouvelles √† l'envers</a></li>
<li><a href="../fr449902/index.html">R√©seaux de t√©l√©vision par c√¢ble pour les plus petits. Partie 2: Composition et forme d'onde</a></li>
<li><a href="../fr449906/index.html">Serveur REST auto-document√© (Node.JS, TypeScript, Koa, Joi, Swagger)</a></li>
<li><a href="../fr449908/index.html">DDR3 ou DDR4? Pourquoi avons-nous offert le Dell R420 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps pour 99 $ aux Pays-Bas?</a></li>
<li><a href="../fr449910/index.html">GitLab Shell Runner. Lancement concurrentiel de services de test √† l'aide de Docker Compose</a></li>
<li><a href="../fr449916/index.html">5 fa√ßons de d√©ployer du code PHP dans des conditions de surcharge</a></li>
<li><a href="../fr449918/index.html">Thermom√®tre infrarouge avec capteur MLX90614</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>