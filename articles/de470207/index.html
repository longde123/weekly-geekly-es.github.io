<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏪 🥌 👩🏽‍🎨 1C Developer Tales: Epicafe 🏆 🧑🏽‍🤝‍🧑🏼 🚉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir alle lieben es, über unsere Erfolge zu sprechen und sprechen nicht wirklich gern über Misserfolge. Die Erfahrung von Fehlern ist jedoch oft wertvo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>1C Developer Tales: Epicafe</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470207/">  Wir alle lieben es, über unsere Erfolge zu sprechen und sprechen nicht wirklich gern über Misserfolge.  Die Erfahrung von Fehlern ist jedoch oft wertvoller als der Gewinn aus einem erfolgreich abgeschlossenen Geschäft.  Deshalb möchte ich heute nur über solche Fälle sprechen.  Also lass uns gehen ... <br><a name="habracut"></a><br><h2>  Topf, nicht kochen! </h2><br>  Diese Geschichte ereignete sich vor einigen Jahren, ganz am Anfang meiner Karriere als 1C-Entwickler. <br><br>  In unserem Unternehmen ist ein Projekt erschienen, um den Betrieb einer sehr stark belasteten Basis eines sehr großen und angesehenen Kunden zu optimieren.  Der Client war mit einem so paranoiden Sicherheitsdienst ausgestattet, dass es keinen Remotezugriff auf die Server von außen gab und gab.  Um eine direkte Verbindung zu den Basen zu unserem Büro herzustellen, wurde ein separates lokales Netzwerk mit Hardware-VPN installiert und Workstations mit streng ausgehandelter Software wurden installiert.  Natürlich ohne die Rechte eines lokalen Administrators. <br><br>  Wie jedes andere Projekt dieser Art begann es mit der Datenerfassung.  Es wurde davon ausgegangen, dass wir zunächst innerhalb eines Monats verschiedene Indikatoren erfassen und dann die Informationsbasis selbst optimieren werden.  Wie und wie viel Zeit in diesem bürokratischen Umfeld für die Einrichtung des Kundencenters benötigt wurde, ist Material für eine separate Geschichte.  Aber jetzt, irgendwann, wurde das Kundencenter konfiguriert und gestartet.  Danach stieg der Experte, der dieses Projekt durchgeführt hatte (Dima, hi!), In sein luxuriöses Auto und reiste durch unser riesiges Land und dann weiter in die Nachbarländer.  Tatsächlich wusste ich immer noch wenig und wusste wie, aber ich wurde bereits als verantwortungsbewusster Entwickler angesehen.  Daher wies mich Dmitry vor meiner Abreise eine sehr wichtige und ernste Aufgabe an: 2 Mal am Tag musste ich zum Zeitpunkt der Spitzenlast zu diesem sehr geheimen Computer gehen, Messungen im Kundencenter starten und sie nach einer Stunde ausschalten.  Die Anweisungen waren äußerst einfach und klar: <br><br>  - Sieh mal, du drückst diese kleine grüne Taste "Wiedergabe", verschiedene Charts laufen, wartest eine Stunde, dann drückst du diese Taste - "Stopp".  Das ist alles. <br><br>  Was könnte einfacher sein, oder?  Vergebens habe ich 5 Jahre an der Mathematikfakultät studiert? <br><br>  Die ganze Woche habe ich dieses Ritual morgens und abends genau eingehalten.  Und bis zum letzten Tag war alles in Ordnung.  Nach dem Mittagessen begann ich wie üblich am Freitag mit dem Sammeln von Daten und dann ... Nun, Sie wissen, wie es passiert ... Freitag, Abend, müssen wir einige dringende Dinge erledigen, einige Aufgaben erledigen, nach der Arbeit meine Frau zu meiner Schwiegermutter bringen in ein Geschäft, ein zweites usw. fallen.  Im Allgemeinen habe ich die Arbeit verlassen und dieses unglückliche Kundencenter völlig vergessen. <br><br>  Der Samstagmorgen begann mit einem Anruf.  Wir haben ALLE 1C-te Basis beim Kunden.  Achtung und Katastrophe!  Unser Experte befindet sich irgendwo zwischen Dzheyrakh und Pasanauri außerhalb des Netzwerkzugangsbereichs.  Der Hauptadministrator des Kunden befindet sich ebenfalls in einem Landhaus und ist nicht erreichbar.  Was ist der Grund, um am Telefon herauszufinden?  Irgendwie stellt sich heraus, dass der Speicherplatz aufgebraucht ist und der 1C-Agentendienst aufgerufen wurde.  Hier begann ich schon etwas zu ahnen ... <br><br>  Wie Sie sich erinnern, gibt es keine Udalenka.  Der Computer ist nicht nur vom Internet isoliert, sondern auch außerhalb unseres lokalen Netzwerks.  Nichts zu tun - zur Arbeit gehen.  Während der Vorbereitung und des Fahrens stellten die Administratoren fest, dass der gesamte Platz von den MCC-Protokollen eingenommen wurde, und taten, was sie für am vernünftigsten hielten - sie schnitten es durch den Task-Manager ab.  Mach weiter.  Sie können nicht nur Protokolle von der Festplatte löschen - wir verlieren die Messdaten.  Irgendwie fanden sie genug Speicherplatz auf der Netzwerkfreigabe und kopierten die Dateien dort.  Die Arbeit scheint wieder aufgenommen worden zu sein. <br><br>  Der Sonntagmorgen begann mit einem Anruf.  Wir haben ALLE 1C-te Basis beim Kunden.  Achtung und Katastrophe brauchen zwei!  Die ganze Panik ist vorbei - der Ort ist vorbei.  Aber wie so?  MCC ausgeschaltet?  In Eile werde ich wieder arbeiten und die Protokolle werfen, um Speicherplatz freizugeben.  Und sie alle wachsen und wachsen, verdammt noch mal!  Aus Angst vor den perversesten Hinrichtungen verboten mir die Administratoren, irgendetwas zu starten oder überhaupt etwas zu konfigurieren.  Den Rest des Sonntags saß ich am Computer und kopierte die Protokolle auf den Ball, damit die Basen nicht wieder aufstanden. <br><br>  Erst spät in der Nacht meldete sich Dima und sagte, dass Sie nur eine kleine Datei auf dem 1C-Server löschen müssen.  Später, ein paar Wochen später, las ich in einem bekannten "Schreibtisch" -Buch über ihn, aber an diesem Tag gingen die Gefolterten erschöpft nach Hause, um zu schlafen. <br><br>  Am Montagmorgen wurde unser Konto gesperrt, bis Dmitry aus dem Urlaub zurückkehrte, und es wurde ganz klar zu meinem Konto gesagt: "Damit wir ihn nicht wiedersehen!" <br><br>  So endete mein erstes Optimierungsprojekt für mich. <br><br><h2>  Zweimal in einem Trichter </h2><br>  Großer Betrieb.  18 Informationsbasen mit identischer Konfiguration im ganzen Land.  Das Update findet einmal pro Woche statt und ist das gleiche Ritual: Die Lieferdatei muss im Voraus vorbereitet und in die Cloud hochgeladen werden. Stellen Sie sicher, dass sie in allen Filialen heruntergeladen wurde (selbst im Jahr 2018 ist das Internet in einigen Regionen langsamer als das typische 1C: ERP). Überprüfen Sie, ob überall Backups erstellt wurden (wir scheinen nicht dafür verantwortlich zu sein, aber die bittere Erfahrung hat uns gelehrt, sicher zu sein). Führen Sie dann in jedem Zweig das Aktualisierungsskript manuell aus und stellen Sie sicher, dass es fehlerfrei funktioniert.  Oft wird im letzten Moment festgestellt, dass eine weitere Aufgabe in die Lieferung aufgenommen werden muss, und dies ist eine geringfügige Korrektur, da das nächste Update erst in einer Woche erfolgt. <br><br>  So war es damals.  Ein erfahrener Entwickler mit langjähriger Erfahrung in Eile machte einen Fehler in einer Zeile, als er eine Aufgabe auf eine Kampfstrecke übertrug.  Der Fehler stellte sich als kritisch heraus und wurde nach dem Aktualisieren aller Datenbanken entdeckt. <br><br>  Was tun?  Der Entwickler repariert den Code schnell.  Lässt niemanden testen: <br><br>  - Ja, es gibt Müll ... Ich kann nicht zweimal in einer Zeile einen Fehler machen? <br><br>  Eine Stunde später wurden 18 Filialen zum dritten Mal aktualisiert. <br><br><h2>  Entwickler, der könnte </h2><br>  Die Geschichte eines Kollegen über Skype. <br>  [Kollege]: Es war einmal ein "Entwickler, der konnte!"  Er hatte ein Entwicklungsoutfit.  Er wollte einen Test eröffnen, verpasste aber und eröffnete einen produktiven ... <br>  [Kollege]: Aber könnte dies den "Entwickler, der könnte" aufhalten?  Nein! <br>  [I]: Und als er aktualisiert wurde, verstand er nicht, dass dort sozusagen Leute saßen?  ))) <br>  [Kollege]: Außerdem sieht er, dass der Konf unterstützt wird ... Aber glauben Sie, dass dies den "Entwickler, der könnte" aufhalten könnte?  Nein! <br>  [Kollege]: Er entfernt die Konfiguration vom Support (!) Und sägt seinen Mod unter Umgehung aller Repositories ... <br>  [I]: Das ist es nicht!  Beende die Geschichte, dynamisches Update))) <br>  [Kollege]: Updates ... Das System sagt: "Es gibt 18 aktive Sitzungen in der Datenbank!".  Aber wie könnte dies den "Entwickler, der könnte" aufhalten?  Nein und wieder nein! <br>  [Kollege]: Er aktualisiert die Datenbank und übergibt die Aufgabe an den Test ... <br>  [Kollege]: Der Berater kann das Outfit nicht finden ... und erst dann merkt er nach langer Zeit, dass er es verpasst hat. <br>  [Kollege]: Ich musste ihn schelten ... <br>  [Kollege]: Ich rufe ihn an ... und ich lache ins Telefon ... <br>  [Kollege]: Ich verstehe einfach nicht ... WIE ??? <br><br><h2>  Transportkollaps </h2><br>  Die Geschichte von einem Kollegen erzählt und aus seinen Worten aufgezeichnet. <br><br>  Es geschah in einem großen Logistikunternehmen.  Die meisten Geschäftsprozesse konzentrieren sich auf eine Informationsbasis.  Wettbewerbsfähige Nutzer für 2012 - rund 3.000 Menschen aus allen Regionen des Landes. <br><br>  Stellen Sie eine einfache Aufgabe ein.  Demnach hat er ein eigenes Informationsregister erstellt, in das Daten geschrieben werden, wenn bestimmte Dokumente veröffentlicht werden.  Obwohl es nicht viele Arten von Dokumenten gibt, ist die Anzahl dieser Dokumente pro Tag enorm.  Theoretisch sollte die Schreiboperation, die ich dem Register hinzugefügt habe, das System nicht stark belasten.  Bei der Implementierung der Aufgabe gab es jedoch eine Nuance: Beim Aufzeichnen eines Satzes wurde die Eigenschaft Überschreiben auf Falsch gesetzt.  Das heißt, jedes Dokument enthält hinzugefügte Einträge im Register.  Dies war je nach den Bedingungen des Problems notwendig, hatte aber praktisch keinen Einfluss auf die Leistung, weil  Entsprechend den Auswahlbedingungen gab es immer 1-10 Einträge. <br><br>  Funktionstests waren erfolgreich.  Wir haben mehrere Dutzend Dokumente durchgeführt, sichergestellt, dass die Einträge im Register korrekt waren, nichts Verdächtiges bemerkt und sie an das Produktiv gesendet. <br><br>  An diesem unglücklichen Freitagmorgen haben wir die Kampfbasis aktualisiert und die Benutzer haben begonnen zu arbeiten.  3000 Menschen füllten fröhlich Dokumente und das Register wurde mit Daten gefüllt.  Nachdem wir überprüft hatten, ob alles gut lief, gingen wir einige Stunden später mit einer ruhigen Seele nach Hause (wir arbeiten in verschiedenen Zeitzonen mit den Hauptnutzern der Informationsbasis). <br><br>  Es ist anzumerken, dass die Server, auf denen der IS lief, fast zu den leistungsstärksten in Russland gehören, die unter 1C verwendet wurden.  Aber nach ein paar Stunden ist „etwas schief gelaufen“ (c). <br><br>  Die Benutzer bemerkten einen Rückgang der Systemleistung.  Alle Operationen begannen sich zu verlangsamen.  Die Reaktionen auf Aktionen wurden länger.  Die Belastung der Geräte nahm stetig zu.  Während die IT-Abteilung verstand, was vor sich ging, wurde die Arbeit im System fast eingestellt.  Die Ausrüstung konnte nicht bewältigen, die Warteschlangen auf den Festplatten waren länger als in den Postämtern Russlands.  Wenn die Ausrüstung schwächer wäre, würde das Problem fast sofort erkannt.  Aber die mächtigsten Server widerstanden einen halben Tag lang heldenhaft meinen krummen Händen. <br><br>  "Aus den Worten" von MSSQL wurde die schwerwiegendste Anfrage plötzlich zu einer Leseanforderung in meinem Register.  Obwohl ich keine Lesungen gemacht habe.  Im 1C-Code wurde schnell ein Problem entdeckt.  Ich habe vergessen, eine Auswahl für eine Reihe von Datensätzen festzulegen.  Wenn die Eigenschaft "Überschreiben" auf "Wahr" gesetzt würde, würde ich sofort einen Fehler finden, weil  Jeder Eintrag würde das gesamte Register löschen.  In unserem Fall ist dies jedoch nicht geschehen.  Am Beispiel eines Dutzend Dokumente haben wir natürlich keinen Leistungsverlust festgestellt.  Aber als sich das Register mit Zehntausenden von Zeilen füllte, musste das System jedes Mal das gesamte Register auf übereinstimmende Datensätze überprüfen. <br><br>  Zu diesem Zeitpunkt war nach Ansicht einiger Benutzer bereits ein Transportkollaps aufgetreten, weil  Autos erhielten keine Dokumente von 1C und konnten die Entladepunkte nicht verlassen. <br><br>  Also habe ich „nur“ vergessen, eine Auswahl in das Recordset aufzunehmen, und eine der größten 1C-Datenbanken in Russland eingerichtet. <br><br><h2>  PS Siehe auch: </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1C Developer Tales: admin</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de470207/">https://habr.com/ru/post/de470207/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de470193/index.html">Universeller Schutz gegen xss-Angriffe und SQL-Injektionen</a></li>
<li><a href="../de470195/index.html">F # 4: Lassen / Verwenden / Tun</a></li>
<li><a href="../de470197/index.html">Kann ich Haz? Betrachten Sie das Has-Muster</a></li>
<li><a href="../de470199/index.html">Memo an einen unerfahrenen Computerspielentwickler</a></li>
<li><a href="../de470203/index.html">Die Nadel der Zustimmung zum Karma als Spiegel der Entwicklung des Homo</a></li>
<li><a href="../de470209/index.html">Code-Transformation in Android 2. AST-Analyse</a></li>
<li><a href="../de470215/index.html">CAGR als Fluch auf Spezialisten oder Fehler bei der Vorhersage exponentieller Prozesse</a></li>
<li><a href="../de470217/index.html">Gefälschter DS18B20 wasserdicht: Was tun?</a></li>
<li><a href="../de470219/index.html">F # 5: Operatoren</a></li>
<li><a href="../de470221/index.html">Holivar. Geschichte von Runet. Teil 3. Suchmaschinen: Yandex vs Rambler. Wie man keine Investition tätigt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>