<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ ๐ง๐ผโ๐คโ๐ง๐ป ๐ ุชุทุจููุงุช ูููุฏูุฒ ุงูุฃุตููุฉ ูุฃูุฑูููุณ ุงุณุชุนุงุฏุฉ ูุดุทุฉ ๐ฉ๐ผโ๐คโ๐จ๐ฝ ๐ฆ ๐ฆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุงุตู ุงูููู ูุตุฉ ููู ูููู ุ ูุน ุฑูุงู ุฌุงูุนุฉ Innopolis ุ ุจุชุทููุฑ ุชูููุฉ Active Restore ููุณูุงุญ ูููุณุชุฎุฏู ุจุงูุจุฏุก ูู ุงูุนูู ุนูู ุฃุฌูุฒุชู ูู ุฃูุฑุจ ููุช ูููู ุจุนุฏ ุงููุดู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุทุจููุงุช ูููุฏูุฒ ุงูุฃุตููุฉ ูุฃูุฑูููุณ ุงุณุชุนุงุฏุฉ ูุดุทุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/481382/" style=";text-align:right;direction:rtl">  ููุงุตู ุงูููู ูุตุฉ ููู ูููู ุ ูุน ุฑูุงู ุฌุงูุนุฉ Innopolis ุ ุจุชุทููุฑ ุชูููุฉ Active Restore ููุณูุงุญ ูููุณุชุฎุฏู ุจุงูุจุฏุก ูู ุงูุนูู ุนูู ุฃุฌูุฒุชู ูู ุฃูุฑุจ ููุช ูููู ุจุนุฏ ุงููุดู.  ุณูุชุญุฏุซ ุนู ุชุทุจููุงุช Windows ุงูุฃุตููุฉ ุ ุจูุง ูู ุฐูู ููุฒุงุช ุฅูุดุงุฆูุง ูุฅุทูุงููุง.  ุชุญุช ุงููุต - ููููุง ุนู ูุดุฑูุนูุง ุ ูุถูุง ุนู ุฏููู ุนููู ุญูู ููููุฉ ูุชุงุจุฉ ุงูุชุทุจููุงุช ุงูุฃุตููุฉ. <br><br><img src="https://habrastorage.org/webt/rc/bv/yl/rcbvylee_0ylshzywkrdlip0c9o.jpeg"><br><a name="habracut"></a><br>  ูู ุงูููุดูุฑุงุช ุงูุณุงุจูุฉ ุ ุชุญุฏุซูุง ุจุงููุนู ุนู ูุงููุฉ <a href="https://habr.com/ru/company/acronis/blog/477658/">Active Restore</a> ูููู ูุทูุฑ ุงูุทูุงุจ ูู Innopolis <a href="https://habr.com/ru/company/acronis/blog/479524/">ุงูุฎุฏูุฉ</a> .  ุงูููู ุฃุฑูุฏ ุฃู ุฃุฑูุฒ ุนูู ุงูุชุทุจููุงุช ุงูุฃุตููุฉ ุ ุงูุชู ูุฑูุฏ "ุฏูู" ุฎุฏูุฉ ุงูุงุณุชุฑุฏุงุฏ ุงููุดุทุฉ ุงูุฎุงุตุฉ ุจูุง.  ุฅุฐุง ูุฌุญ ูู ุดูุก ุ ููููููุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุจู ุฐูู ุจูุซูุฑ ูุจุฏุก ุงูุฎุฏูุฉ ููุณูุง </li><li style=";text-align:right;direction:rtl">  ูุจู ุฐูู ุจูุซูุฑ ููุงุชุตุงู ุจุงูุณุญุงุจุฉ ุงูุชู ูููู ุงููุณุฎ ุงูุงุญุชูุงุทู </li><li style=";text-align:right;direction:rtl">  ูู ุงูุณุงุจู ูุฃูุงูู ููู ุงููุถุน ูู ุงููุธุงู - ุงูุชูููุฏ ุงูุนุงุฏู ุฃู ุงูุงุณุชุฑุฏุงุฏ </li><li style=";text-align:right;direction:rtl">  ูุงุณุชุนุงุฏุฉ ุงููููุงุช ุฃูู ุจูุซูุฑ ููุฏูุง </li><li style=";text-align:right;direction:rtl">  ุงุณูุญ ูููุณุชุฎุฏู ุจุงูุจุฏุก ุจุดูู ุฃุณุฑุน. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู ุงูุชุทุจูู ุงูุฃุตูู ุจุดูู ุนุงูุ </h3><br>  ููุฅุฌุงุจุฉ ุนูู ูุฐุง ุงูุณุคุงู ุ ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุณูุณูุฉ ุงูููุงููุงุช ุงูุชู ูุฌุฑููุง ุงููุธุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ุญุงูู ูุจุฑูุฌ ูู ุชุทุจููู ุฅูุดุงุก ููู. <br><br><img src="https://habrastorage.org/webt/gb/d_/a7/gbd_a7c7l1d-6dlo4zh-fygf5dm.jpeg"><br>  <i>ุจุงูู ููุณูููููุชุด - ุจุฑูุฌุฉ Windows Kernel (2019)</i> <br><br>  ูุณุชุฎุฏู ุงููุจุฑูุฌ ุงูุฏุงูุฉ <a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea">CreateFile</a> ุ ูุงูุชู ุชู ุงูุชุตุฑูุญ ุนููุง ูู ููู ุฑุฃุณ fileapi.h ููุชู ุชูููุฐูุง ูู Kernel32.dll.  ููุน ุฐูู ุ ูุง ุชูุดุฆ ูุฐู ุงููุธููุฉ ููุณูุง ููููุง ุ ููู ุชุชุญูู ููุท ูู ุงููุณุงุฆุท ุนูุฏ ุงูุฅุฏุฎุงู <a href="https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntcreatefile">ูุชุณุชุฏุนู</a> ุงูุฏุงูุฉ <a href="https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntcreatefile">NtCreateFile</a> (ุชุดูุฑ ุจุงุฏุฆุฉ Nt ููุท ุฅูู ุฃู ุงููุธููุฉ ุฃุตููุฉ).  ูุชู ุงูุฅุนูุงู ุนู ูุฐู ุงููุธููุฉ ูู ููู ุงูุฑุฃุณ winternl.h ููุชู ุชูููุฐูุง ูู ntdll.dll.  ุฅููุง ุชุณุชุนุฏ ููููุฒ ุฅูู ุงููุถุงุก ุงููููู ุ ูุจุนุฏ ุฐูู ุชููู ุจุฅุฌุฑุงุก ููุงููุฉ ูุธุงู ูุฅูุดุงุก ููู.  ูู ูุฐู ุงูุญุงูุฉ ุ ุงุชุถุญ ุฃู Kernel32 ูุฌุฑุฏ ุบูุงู ูู Ntdll.  ุฃุญุฏ ุงูุฃุณุจุงุจ ูุฑุงุก ุฐูู ุ ูุฏู Microsoft ุงููุฏุฑุฉ ุนูู ุชุบููุฑ ูุธุงุฆู ุงูุนุงูู ุงูุฃุตูู ุ ูููู ูุง ุชููุณ ุงููุงุฌูุงุช ุงูููุงุณูุฉ.  ูุง ุชูุตู Microsoft ุจุงุณุชุฏุนุงุก ุงููุธุงุฆู ุงูุฃุตููุฉ ูุจุงุดุฑุฉู ููุง ุชูุซู ูุนุธููุง.  ุจุงูููุงุณุจุฉ ุ ูููู ุงูุนุซูุฑ ุนูู ููุฒุงุช ุบูุฑ ููุซูุฉ <a href="http://undocumented.ntinternals.net/">ููุง</a> . <br><br>  ุงูููุฒุฉ ุงูุฑุฆูุณูุฉ ููุชุทุจููุงุช ุงูุฃุตููุฉ ูู ุฃู ntdll ูุชู ุชุญูููู ูู ุงููุธุงู ูู ููุช ุฃุจูุฑ ุจูุซูุฑ ูู kernel32.  ูุฐุง ููุทูู ุ ูุฃู kernel32 ูุชุทูุจ Ntdll ููุนูู.  ูุชูุฌุฉ ูุฐูู ุ ูููู ุฃู ุชุจุฏุฃ ุงูุชุทุจููุงุช ุงูุชู ุชุณุชุฎุฏู ุงููุธุงุฆู ุงูุฃุตููุฉ ูู ุงูุนูู ูุจู ุฐูู ุจูุซูุฑ. <br><br>  ูุจุงูุชุงูู ุ ูุฅู ุชุทุจููุงุช Windows ุงูุฃุตููุฉ ูู ุจุฑุงูุฌ ูููู ุชุดุบูููุง ูู ูุฑุญูุฉ ูุจูุฑุฉ ูู ุชุดุบูู Windows.  ูุณุชุฎุฏููู ูุธุงุฆู ููุท ูู Ntdll.  ูุซุงู ุนูู ูุซู ูุฐุง ุงูุชุทุจูู: <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/autochk">autochk</a> ุงูุฐู ูููุฐ <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/chkdsk">ุฃุฏุงุฉ chkdisk</a> ููุญุต ุงููุฑุต ุจุญุซูุง ุนู ุงูุฃุฎุทุงุก ูุจู ุจุฏุก ุงูุฎุฏูุงุช ุงูุฑุฆูุณูุฉ.  ูู ูุฐุง ุงููุณุชูู ูุฑูุฏ ุฃู ูุฑู ุงุณุชุนุงุฏุฉ ูุดุทุฉ ูุฏููุง. <br><br><h3 style=";text-align:right;direction:rtl">  ูุงุฐุง ูุญุชุงุฌุ </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/other-wdk-downloads">DDK</a> (ูุฌููุนุฉ ุชุทููุฑ ุจุฑุงูุฌ ุงูุชุดุบูู) ุ ุงููุนุฑููุฉ ุงูุขู ุจุงุณู WDK 7 (ูุฌููุนุฉ ุจุฑุงูุฌ ุชุดุบูู Windows). </li><li style=";text-align:right;direction:rtl">  ุขูุฉ ุงูุชุฑุงุถูุฉ (ูุซู windows 7 x64) </li><li style=";text-align:right;direction:rtl">  ููุณ ุจุงูุถุฑูุฑุฉ ุ ูููู ูููู ุชูุฒูู ูููุงุช ุงูุฑุฃุณ <a href="https://github.com/arizvisa/ndk">ููุง.</a> </li></ul><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู ูู ุงูููุฏุ </h3><br>  ูููุงุฑุณ ุจุนุถ ุงูุดูุก ุ ูุนูู ุณุจูู ุงููุซุงู ุณููุชุจ ุทูุจูุง ุตุบูุฑูุง: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุนุฑุถ ุฑุณุงูุฉ ุนูู ุงูุดุงุดุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฎุตุต ุงููููู ูู ุงูุฐุงูุฑุฉ </li><li style=";text-align:right;direction:rtl">  ูู ุงูุชุธุงุฑ ุฅุฏุฎุงู ููุญุฉ ุงูููุงุชูุญ </li><li style=";text-align:right;direction:rtl">  ุชุญุฑุฑ ุฐุงูุฑุฉ ูุดุบูู </li></ol><br>  ูู ุงูุชุทุจููุงุช ุงูุฃุตููุฉ ุ ููุณุช ููุทุฉ ุงูุฅุฏุฎุงู ูู ุงูุนูุตุฑ ุงูุฑุฆูุณู ุฃู ูุธุงู ุงูุชุดุบูู ุงูุฑุฆูุณู ุ ูููู ูุธููุฉ NtProcessStartup ุ ูุฃููุง ูุจุฏุฃ ุจุงููุนู ุงูุนูููุฉ ุงูุฌุฏูุฏุฉ ูุจุงุดุฑุฉ ูู ุงููุธุงู. <br><br>  ููุจุฏุฃ ุจุนุฑุถ ุงูุฑุณุงูุฉ ุนูู ุงูุดุงุดุฉ.  ููููุงู ุจุฐูู ุ ูุฏููุง ุฏุงูุฉ ุฃุตููุฉ <a href="https://undocumented.ntinternals.net/index.html%3Fpage%3DUserMode%252FUndocumented%2520Functions%252FError%252FNtDisplayString.html">NtDisplayString</a> ุ ูุงูุชู ุชุฃุฎุฐ ููุณูุทุฉ ูุคุดุฑ ุฅูู ูุงุฆู ุจููุฉ UNICODE_STRING.  ุณูู RtlInitUnicodeString ูุณุงุนุฏุชูุง ูู ุงูุชููุฆุฉ.  ูุชูุฌุฉ ูุฐูู ุ ูุนุฑุถ ุงููุต ุนูู ุงูุดุงุดุฉ ุ ูููููุง ูุชุงุจุฉ ูุซู ูุฐู ุงููุธููุฉ ุงูุตุบูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//usage: WriteLn(L"Here is my text\n"); void WriteLn(LPWSTR Message) { UNICODE_STRING string; RtlInitUnicodeString(&amp;string, Message); NtDisplayString(&amp;string); }</span></span></code> </pre> <br>  ูุธุฑูุง ูุฃู ูุธุงุฆู ntdll ูุชุงุญุฉ ููุท ููุง ุ ููุง ุชูุฌุฏ ููุชุจุงุช ุฃุฎุฑู ูู ุงูุฐุงูุฑุฉ ุจุนุฏ ุ ูุจุงูุชุฃููุฏ ุณููุงุฌู ูุดููุงุช ูู ููููุฉ ุชุฎุตูุต ุงูุฐุงูุฑุฉ.  ุงููุดุบู ุงูุฌุฏูุฏ ุบูุฑ ููุฌูุฏ ุญุชู ุงูุขู (ูุฃูู ูุฃุชู ูู ุนุงูู C ++ ุนุงูู ุงููุณุชูู) ุ ููุง ูุง ุชูุฌุฏ ูุธููุฉ malloc (ูุญุชุงุฌ ุฅูู ููุชุจุงุช ููุช ุงูุชุดุบูู C).  ููููู ุจุงูุทุจุน ุงุณุชุฎุฏุงู ููุท ุงูููุฏุณ.  ูููู ุฅุฐุง ููุง ุจุญุงุฌุฉ ุฅูู ุชุฎุตูุต ุฐุงูุฑุฉ ุจุดูู ุญููู ุ ูุณูุชุนูู ุนูููุง ุงูููุงู ุจุฐูู ุนูู ุงููููุฉ (ุฃู ุงููููุฉ).  ูุฐูู ุ ุฏุนููุง ููุดุฆ ุญููุฉ ูุฃููุณูุง ูุณูุชุฎุฐ ูููุง ุฐุงูุฑุฉ ุนูุฏูุง ูุญุชุงุฌ ุฅูููุง. <br><br>  ูุธููุฉ <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlcreateheap">RtlCreateHeap</a> ููุงุณุจุฉ ููุฐู ุงููููุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ุจุงุณุชุฎุฏุงู RtlAllocateHeap ู RtlFreeHeap ุ ุณูุญุชู ุงูุฐุงูุฑุฉ ุงูุฎุงููุฉ ุนูุฏูุง ูุญุชุงุฌ ุฅูููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">PVOID memory = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; PVOID buffer = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; ULONG bufferSize = <span class="hljs-number"><span class="hljs-number">42</span></span>; <span class="hljs-comment"><span class="hljs-comment">// create heap in order to allocate memory later memory = RtlCreateHeap( HEAP_GROWABLE, NULL, 1000, 0, NULL, NULL ); // allocate buffer of size bufferSize buffer = RtlAllocateHeap( memory, HEAP_ZERO_MEMORY, bufferSize ); // free buffer (actually not needed because we destroy heap in next step) RtlFreeHeap(memory, 0, buffer); RtlDestroyHeap(memory);</span></span></code> </pre> <br>  ุฏุนูุง ููุชูู ุฅูู ุงูุชุธุงุฑ ุฅุฏุฎุงู ููุญุฉ ุงูููุงุชูุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// https://docs.microsoft.com/en-us/windows/win32/api/ntddkbd/ns-ntddkbd-keyboard_input_data typedef struct _KEYBOARD_INPUT_DATA { USHORT UnitId; USHORT MakeCode; USHORT Flags; USHORT Reserved; ULONG ExtraInformation; } KEYBOARD_INPUT_DATA, *PKEYBOARD_INPUT_DATA; //... HANDLE hKeyBoard, hEvent; UNICODE_STRING skull, keyboard; OBJECT_ATTRIBUTES ObjectAttributes; IO_STATUS_BLOCK Iosb; LARGE_INTEGER ByteOffset; KEYBOARD_INPUT_DATA kbData; // inialize variables RtlInitUnicodeString(&amp;keyboard, L"\\Device\\KeyboardClass0"); InitializeObjectAttributes(&amp;ObjectAttributes, &amp;keyboard, OBJ_CASE_INSENSITIVE, NULL, NULL); // open keyboard device NtCreateFile(&amp;hKeyBoard, SYNCHRONIZE | GENERIC_READ | FILE_READ_ATTRIBUTES, &amp;ObjectAttributes, &amp;Iosb, NULL, FILE_ATTRIBUTE_NORMAL, 0, FILE_OPEN,FILE_DIRECTORY_FILE, NULL, 0); // create event to wait on InitializeObjectAttributes(&amp;ObjectAttributes, NULL, 0, NULL, NULL); NtCreateEvent(&amp;hEvent, EVENT_ALL_ACCESS, &amp;ObjectAttributes, 1, 0); while (TRUE) { NtReadFile(hKeyBoard, hEvent, NULL, NULL, &amp;Iosb, &amp;kbData, sizeof(KEYBOARD_INPUT_DATA), &amp;ByteOffset, NULL); NtWaitForSingleObject(hEvent, TRUE, NULL); if (kbData.MakeCode == 0x01) // if ESC pressed { break; } }</span></span></code> </pre> <br>  ูู ูุง ูุญุชุงุฌ ุฅููู ูู ุงุณุชุฎุฏุงู <a href="https://undocumented.ntinternals.net/index.html%3Fpage%3DUserMode%252FUndocumented%2520Functions%252FNT%2520Objects%252FFile%252FNtReadFile.html">NtReadFile</a> ุนูู ุฌูุงุฒ ููุชูุญ ุ ูุงูุชุธุฑ ุญุชู ุชุฑุฌุน ููุญุฉ ุงูููุงุชูุญ ุฅูููุง.  ูู ุญุงูุฉ ุงูุถุบุท ุนูู ููุชุงุญ ESC ุ ุณููุงุตู ุงูุนูู.  ููุชุญ ุงูุฌูุงุฒ ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฏุนุงุก ูุธููุฉ NtCreateFile (ุณุชุญุชุงุฌ ุฅูู ูุชุญ \ Device \ KeyboardClass0).  ุณูู ูุชุตู ุฃูุถูุง ุจู <a href="https://undocumented.ntinternals.net/index.html%3Fpage%3DUserMode%252FUndocumented%2520Functions%252FNT%2520Objects%252FEvent%252FNtCreateEvent.html">NtCreateEvent</a> ูุชููุฆุฉ ุงููุงุฆู ููุงูุชุธุงุฑ.  ุณูุนูู ุจุดูู ูุณุชูู ุนู ุจููุฉ KEYBOARD_INPUT_DATA ุชูุซู ุจูุงูุงุช ููุญุฉ ุงูููุงุชูุญ.  ูุฐุง ุณูุณูู ุนูููุง. <br><br>  ููุชูู ุงูุชุทุจูู ุงูุฃุตูู ุจุฏุนูุฉ ุฅูู ุงูุฏุงูุฉ <a href="https://undocumented.ntinternals.net/index.html%3Fpage%3DUserMode%252FUndocumented%2520Functions%252FNT%2520Objects%252FProcess%252FNtTerminateProcess.html">NtTerminateProcess</a> ุ ูุฃููุง ููุชู ุนูููุชูุง ููุท. <br><br>  ูู ุฑูุฒ ุชุทุจูู ุตุบูุฑ ูุฏููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ntifs.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// \WinDDK\7600.16385.1\inc\ddk #include "ntdef.h" //------------------------------------ // Following function definitions can be found in native development kit // but I am too lazy to include `em so I declare it here //------------------------------------ NTSYSAPI NTSTATUS NTAPI NtTerminateProcess( IN HANDLE ProcessHandle OPTIONAL, IN NTSTATUS ExitStatus ); NTSYSAPI NTSTATUS NTAPI NtDisplayString( IN PUNICODE_STRING String ); NTSTATUS NtWaitForSingleObject( IN HANDLE Handle, IN BOOLEAN Alertable, IN PLARGE_INTEGER Timeout ); NTSYSAPI NTSTATUS NTAPI NtCreateEvent( OUT PHANDLE EventHandle, IN ACCESS_MASK DesiredAccess, IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, IN EVENT_TYPE EventType, IN BOOLEAN InitialState ); // https://docs.microsoft.com/en-us/windows/win32/api/ntddkbd/ns-ntddkbd-keyboard_input_data typedef struct _KEYBOARD_INPUT_DATA { USHORT UnitId; USHORT MakeCode; USHORT Flags; USHORT Reserved; ULONG ExtraInformation; } KEYBOARD_INPUT_DATA, *PKEYBOARD_INPUT_DATA; //---------------------------------------------------------- // Our code goes here //---------------------------------------------------------- // usage: WriteLn(L"Hello Native World!\n"); void WriteLn(LPWSTR Message) { UNICODE_STRING string; RtlInitUnicodeString(&amp;string, Message); NtDisplayString(&amp;string); } void NtProcessStartup(void* StartupArgument) { // it is important to declare all variables at the beginning HANDLE hKeyBoard, hEvent; UNICODE_STRING skull, keyboard; OBJECT_ATTRIBUTES ObjectAttributes; IO_STATUS_BLOCK Iosb; LARGE_INTEGER ByteOffset; KEYBOARD_INPUT_DATA kbData; PVOID memory = NULL; PVOID buffer = NULL; ULONG bufferSize = 42; //use it if debugger connected to break //DbgBreakPoint(); WriteLn(L"Hello Native World!\n"); // inialize variables RtlInitUnicodeString(&amp;keyboard, L"\\Device\\KeyboardClass0"); InitializeObjectAttributes(&amp;ObjectAttributes, &amp;keyboard, OBJ_CASE_INSENSITIVE, NULL, NULL); // open keyboard device NtCreateFile(&amp;hKeyBoard, SYNCHRONIZE | GENERIC_READ | FILE_READ_ATTRIBUTES, &amp;ObjectAttributes, &amp;Iosb, NULL, FILE_ATTRIBUTE_NORMAL, 0, FILE_OPEN,FILE_DIRECTORY_FILE, NULL, 0); // create event to wait on InitializeObjectAttributes(&amp;ObjectAttributes, NULL, 0, NULL, NULL); NtCreateEvent(&amp;hEvent, EVENT_ALL_ACCESS, &amp;ObjectAttributes, 1, 0); WriteLn(L"Keyboard ready\n"); // create heap in order to allocate memory later memory = RtlCreateHeap( HEAP_GROWABLE, NULL, 1000, 0, NULL, NULL ); WriteLn(L"Heap ready\n"); // allocate buffer of size bufferSize buffer = RtlAllocateHeap( memory, HEAP_ZERO_MEMORY, bufferSize ); WriteLn(L"Buffer allocated\n"); // free buffer (actually not needed because we destroy heap in next step) RtlFreeHeap(memory, 0, buffer); RtlDestroyHeap(memory); WriteLn(L"Heap destroyed\n"); WriteLn(L"Press ESC to continue...\n"); while (TRUE) { NtReadFile(hKeyBoard, hEvent, NULL, NULL, &amp;Iosb, &amp;kbData, sizeof(KEYBOARD_INPUT_DATA), &amp;ByteOffset, NULL); NtWaitForSingleObject(hEvent, TRUE, NULL); if (kbData.MakeCode == 0x01) // if ESC pressed { break; } } NtTerminateProcess(NtCurrentProcess(), 0); }</span></span></span></span></code> </pre> <br>  <b>PS:</b> ูููููุง ุจุณูููุฉ ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ DbgBreakPoint () ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุฅููุงู ูู ุงููุตุญุญ.  ุตุญูุญ ุ ุณูู ุชุญุชุงุฌ ุฅูู ุชูุตูู WinDbg ุฅูู ุงูุฌูุงุฒ ุงูุธุงูุฑู ูุชุตุญูุญ ุฃุฎุทุงุก kernel.  ูููู ุงูุนุซูุฑ ุนูู ุชุนูููุงุช ุญูู ููููุฉ ุงูููุงู ุจุฐูู <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/setting-up-kernel-mode-debugging-in-windbg--cdb--or-ntsd">ููุง</a> ุฃู ููุท ุงุณุชุฎุฏุงู <a href="http://sysprogs.com/legacy/virtualkd/">VirtualKD</a> . <br><br><h3 style=";text-align:right;direction:rtl">  ุชุฌููุน ูุงูุชุฌูุน </h3><br>  ุฃุณูู ุทุฑููุฉ ูุฅูุดุงุก ุชุทุจูู ุฃุตูู ูู ุงุณุชุฎุฏุงู <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/other-wdk-downloads">DDK</a> (ูุฌููุนุฉ ุชุทููุฑ ุจุฑุงูุฌ ุงูุชุดุบูู).  ูุญุชุงุฌ ุฅูู ุงูุฅุตุฏุงุฑ ุงูุณุงุจุน ุงููุฏูู ุชูุงููุง ุ ูุธุฑูุง ูุฃู ุงูุฅุตุฏุงุฑุงุช ุงูุฃุญุฏุซ ููุง ููุฌ ูุฎุชูู ููููุงู ูุชุนูู ุนู ูุฑุจ ูุน Visual Studio.  ุฅุฐุง ุงุณุชุฎุฏููุง DDK ุ ูุฅู ูุดุฑูุนูุง ูุญุชุงุฌ ููุท ุฅูู Makefile ูุงููุตุงุฏุฑ. <br><br>  <i>ูุงูููููู</i> <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">!INCLUDE $(NTMAKEENV)\makefile.def</code> </pre> <br>  <i>ูุตุงุฏุฑ:</i> <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">TARGETNAME = MyNative TARGETTYPE = PROGRAM UMTYPE = nt BUFFER_OVERFLOW_CHECKS = 0 MINWIN_SDK_LIB_PATH = $(SDK_LIB_PATH) SOURCES = source.c INCLUDES = $(DDK_INC_PATH); \ C:\WinDDK\7600.16385.1\ndk; TARGETLIBS = $(DDK_LIB_PATH)\ntdll.lib \ $(DDK_LIB_PATH)\nt.lib USE_NTDLL = 1</code> </pre> <br>  ุณูููู Makefile ุงูุฎุงุต ุจู ูู ููุณู ุชูุงููุง ุ ูููู ุฏุนูุง ูุชุนูู ูู ุงููุตุงุฏุฑ ุจูุฒูุฏ ูู ุงูุชูุงุตูู.  ูุญุชูู ูุฐุง ุงูููู ุนูู ูุตุงุฏุฑ ุงูุจุฑูุงูุฌ (ูููุงุช .c) ูุฎูุงุฑุงุช ุงูุฅูุดุงุก ูุงููุนููุงุช ุงูุฃุฎุฑู. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  TARGETNAME - ุงุณู ุงูููู ุงููุงุจู ููุชูููุฐ ุ ูุงูุฐู ูุฌุจ ุฃู ูููู ุงููุชูุฌุฉ. </li><li style=";text-align:right;direction:rtl">  TARGETTYPE - ููุน ุงูููู ุงููุงุจู ููุชูููุฐ ุ ูููู ุฃู ูููู ุจุฑูุงูุฌ ุชุดุบูู (.sys) ุ ุซู ูุฌุจ ุฃู ุชููู ูููุฉ ุงูุญูู ูู DRIVER ุ ุฅุฐุง ูุงูุช ุงูููุชุจุฉ (.lib) ุ ูุฅู ุงููููุฉ ูู LIBRARY.  ูู ุญุงูุชูุง ุ ูุญุชุงุฌ ุฅูู ููู ูุงุจู ููุชูููุฐ (.exe) ุ ูุฐูู ูููุง ุจุชุนููู ุงููููุฉ ุฅูู PROGRAM. </li><li style=";text-align:right;direction:rtl">  UMTYPE - ุงูููู ุงูููููุฉ ููุฐุง ุงูุญูู: ูุญุฏุฉ ุชุญูู ูุชุทุจูู ูุญุฏุฉ ุงูุชุญูู ุ ููุงูุฐ ููุนูู ูู ูุถุน ุงูุฅุทุงุฑุงุช.  ููููุง ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุงูุฅูููู ุงูุดูุงูู ููุญุตูู ุนูู ุงูุชุทุจูู ุงูุฃุตูู. </li><li style=";text-align:right;direction:rtl">  BUFFER_OVERFLOW_CHECKS - ุงูุชุญูู ูู ุชูุฏุณ ุงููุฎุฒู ุงููุคูุช ูุชุฌุงูุฒ ุณุนุฉ ุงููุฎุฒู ุงููุคูุช ุ ูููุฃุณู ููุณ ูู ุญุงูุชูุง ุ ุฃููู ุชุดุบููู. </li><li style=";text-align:right;direction:rtl">  MINWIN_SDK_LIB_PATH - ุชุดูุฑ ูุฐู ุงููููุฉ ุฅูู ุงููุชุบูุฑ SDK_LIB_PATH ุ ูุง ุชููู ูู ุฃูู ูู ุชุนูู ุนู ูุซู ูุฐุง ุงููุชุบูุฑ ูู ุงููุธุงู ุ ููู ุงููุญุธุฉ ุงูุชู ูุฏูุฑ ูููุง ุนูููุฉ ุงูุฅูุดุงุก ุงููุญุฏุฏุฉ ูู DDK ุ ุณูุชู ุงูุฅุนูุงู ุนู ูุฐุง ุงููุชุบูุฑ ูุณูุดูุฑ ุฅูู ุงูููุชุจุงุช ุงููุงุฒูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงููุตุงุฏุฑ - ูุงุฆูุฉ ุงููุตุงุฏุฑ ูุจุฑูุงูุฌู. </li><li style=";text-align:right;direction:rtl">  ูุชุถูู - ูููุงุช ุฑุฃุณ ุงููุงุฒูุฉ ููุชุฌููุน.  ุชุดูุฑ ุนุงุฏุฉู ุฅูู ุงููุณุงุฑ ุฅูู ุงููููุงุช ุงููุฑููุฉ ูุน DDK ุ ูููู ููููู ุชุญุฏูุฏ ุฃู ูููุงุช ุฃุฎุฑู ุจุดูู ุงุฎุชูุงุฑู. </li><li style=";text-align:right;direction:rtl">  TARGETLIBS - ูุงุฆูุฉ ุงูููุชุจุงุช ุงูุชู ุชุญุชุงุฌ ุฅูู ุฑุจุท. </li><li style=";text-align:right;direction:rtl">  USE_NTDLL ูู ุญูู ูุทููุจ ูุฌุจ ุชุนูููู ุนูู ุงูููุถุน 1. ูุฃุณุจุงุจ ูุงุถุญุฉ. </li><li style=";text-align:right;direction:rtl">  USER_C_FLAGS - ุฃู ุฅุดุงุฑุงุช ููููู ุงุณุชุฎุฏุงููุง ูู ุชูุฌููุงุช ุงููุนุงูุฌ ุงูุฃููู ุนูุฏ ุฅุนุฏุงุฏ ุฑูุฒ ุงูุชุทุจูู. </li></ul><br>  ููุจูุงุก ุ ูุญุชุงุฌ ุฅูู ุชุดุบูู ุงูุฅุตุฏุงุฑ x86 (ุฃู x64) ุชู ุงูุชุญูู ููู ุ ูุชุบููุฑ ุฏููู ุงูุนูู ุฅูู ูุฌูุฏ ุงููุดุฑูุน ูุชูููุฐ ุงูุฃูุฑ Build.  ุชูุถุญ ุงููุชูุฌุฉ ูู ููุทุฉ ุงูุดุงุดุฉ ุฃููุง ุฌูุนูุง ููููุง ูุงุจูุงู ููุชูููุฐ. <br><br><img src="https://habrastorage.org/webt/9a/aj/hp/9aajhpa858ohtthlkjnenl1nnic.jpeg" alt="ุจูุงุก"><br><br>  ูุง ูููู ุชุดุบูู ูุฐุง ุงูููู ุจูู ุจุณุงุทุฉ ุ ุญูุซ ููุณู ุงููุธุงู ููุฑุณููุง ููุชูููุฑ ูู ุณูููู ุจุณุจุจ ุงูุฎุทุฃ ุงูุชุงูู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/zw/ev/zu/zwevzuxrc6zc8fvgye_msqa0k6y.jpeg" alt="ุฎุทุฃ"></div><br><br><h3 style=";text-align:right;direction:rtl">  ููููุฉ ุชุดุบูู ุชุทุจูู ุฃุตููุ </h3><br>  ูู ุจุฏุงูุฉ autochk ุ ูุชู ุชุญุฏูุฏ ุชุณูุณู ุจุฏุก ุชุดุบูู ุงูุจุฑุงูุฌ ุญุณุจ ูููุฉ ููุชุงุญ ุงูุชุณุฌูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">HKLM\System\CurrentControlSet\Control\Session Manager\BootExecute</code> </pre> <br>  ูููู ูุฏูุฑ ุงูุฌูุณุฉ ุจุชูููุฐ ุงูุจุฑุงูุฌ ูู ูุฐู ุงููุงุฆูุฉ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู.  ูุจุญุซ ูุฏูุฑ ุงูุฌูุณุฉ ููุณู ุนู ุงููููุงุช ุงููุงุจูุฉ ููุชูููุฐ ูู ุงูุฏููู system32.  ุชูุณูู ูููุฉ ููุชุงุญ ุงูุชุณุฌูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">autocheck autochk *MyNative</code> </pre> <br>  ูุฌุจ ุฃู ุชููู ุงููููุฉ ุจุงูุชูุณูู ุงูุณุช ุนุดุฑู ุ ูููุณ ุจุงูุชูุณูู ASCII ุงููุนุชุงุฏ ุ ูุฐูู ุ ุณูููู ุงูููุชุงุญ ุงููุนุฑูุถ ุฃุนูุงู ุจุงูุชูุณูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">61,75,74,6f,63,68,65,63,6b,20,61,75,74,6f,63,68,6b,20,2a,00,4d,79,4e,61,74,69,76,65,00,00</code> </pre> <br>  ูุชุญููู ุงูุงุณู ุ ููููู ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุนุจุฑ ุงูุฅูุชุฑูุช ุ ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://www.rapidtables.com/convert/number/ascii-to-hex.html">ูุฐู ุงูุฎุฏูุฉ</a> . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ii/ky/sn/iikysns0tim-qpz91mbazv4uepa.jpeg"></div><br>  ุงุชุถุญ ุฃูู ูุชุดุบูู ุงูุชุทุจูู ุงูุฃุตูู ุ ูุญุชุงุฌ ุฅูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุณุฎ ุงูููู ุงููุงุจู ููุชูููุฐ ุฅูู ูุฌูุฏ system32 </li><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ููุชุงุญ ุฅูู ุงูุชุณุฌูู </li><li style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฌูุงุฒ </li></ol><br>  ููุฑุงุญุฉ ุ ุฅููู ูุต ุจุฑูุฌู ุฌุงูุฒ ูุชุซุจูุช ุชุทุจูู ุฃุตูู: <br><br>  <i>install.bat</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off copy MyNative.exe %systemroot%\system32\. regedit /s add.reg <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Native Example Installed pause</code> </pre> <br>  <i>add.reg</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">REGEDIT4 [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager] <span class="hljs-string"><span class="hljs-string">"BootExecute"</span></span>=hex(7):61,75,74,6f,63,68,65,63,6b,20,61,75,74,6f,63,68,6b,20,2a,00,4d,79,4e,61,74,69,76,65,00,00</code> </pre> <br>  ุจุนุฏ ุงูุชุซุจูุช ูุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ุญุชู ูุจู ุธููุฑ ุดุงุดุฉ ุงุฎุชูุงุฑ ุงููุณุชุฎุฏู ุ ูุญุตู ุนูู ุงูุตูุฑุฉ ุงูุชุงููุฉ: <br><br><img src="https://habrastorage.org/webt/yi/5p/7_/yi5p7_4vygq1wttxg_edlw-keqi.jpeg" alt="ูุคุฏู"><br><br><h3 style=";text-align:right;direction:rtl">  ูุคุฏู </h3><br>  ุจุงุณุชุฎุฏุงู ูุซุงู ูุฐุง ุงูุชุทุจูู ุงูุตุบูุฑ ุ ููุง ููุชูุนูู ุฃูู ูู ุงููููู ุชูุงููุง ุชุดุบูู ุงูุชุทุจูู ุนูู ูุณุชูู Windows ุงูุฃุตูู.  ุนูุงูุฉ ุนูู ุฐูู ุ ุณูุณุชูุฑ ุดุจุงุจ ุฌุงูุนุฉ Innopolis ูู ุฅูุดุงุก ุฎุฏูุฉ ูู ุดุฃููุง ุฃู ุชุจุฏุฃ ุนูููุฉ ุงูุชูุงุนู ูุน ุงูุณุงุฆู ูู ููุช ุฃุจูุฑ ุจูุซูุฑ ูู ุงูุฅุตุฏุงุฑ ุงูุณุงุจู ูู ูุดุฑูุนูุง.  ููุน ุธููุฑ ุบูุงู win32 ุ ุณูููู ูู ุงูููุทูู ููู ุงูุชุญูู ุฅูู ุฎุฏูุฉ ูุงููุฉ ุชู ุชุทููุฑูุง ุจุงููุนู (ุงููุฒูุฏ ุญูู ูุฐุง <a href="https://habr.com/ru/company/acronis/blog/479524/">ููุง</a> ). <br><br>  ูู ุงูููุงูุฉ ุงูุชุงููุฉ ุ ุณูุชุทุฑู ุฅูู ูููู ุขุฎุฑ ูู ุฎุฏูุฉ Active Restore ุ ููู ุจุฑูุงูุฌ ุชุดุบูู UEFI.  ุงุดุชุฑู ูู ุจููู ูุฏููุง ูุง ุชููุช ูุธููุฉ ุงูููุจู. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar481382/">https://habr.com/ru/post/ar481382/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar481370/index.html">ุบุฑูุชุง Tunberg ูู ุงูุตุญูุญุ ุงูุทุงุฆุฑุงุช VS ุงููุทุงุฑุงุช</a></li>
<li><a href="../ar481372/index.html">ุซูุงุฆู ุดุฌุฑุฉ ููุฑุณุฉ</a></li>
<li><a href="../ar481374/index.html">Habr Weekly # 32 / ุฃุนุทู Rambler ุงูุธูุฑ ุ ูุงูุชูุงุนุจ ูู ุงูุนูู ุ ูููููุฉ ุญูุงูุฉ ูุดุฑูุน ุงูุญููุงูุงุช ุงูุฃูููุฉ ุ ูุงูุฃุฏูุงุช ุชุฃุฎุฐ ุตูุฑ ุดุฎุตูุฉ ุจูุฏูุก</a></li>
<li><a href="../ar481376/index.html">ุชุญููู ุงูุฏุฑูุณ ุงูุชู ุชู ุชุฏุฑูุณูุง ูููุฌุชูุน ูู ุฎูุงู ูุถุน NGINX</a></li>
<li><a href="../ar481378/index.html">ููููุฉ ุชุญุณูู ุชุทููุฑ ุงูุชุทุจูู</a></li>
<li><a href="../ar481386/index.html">ุงูุชุฏุฑุฌ: ุฅุดุงุฑุฉ ุตุงุฎุจุฉ ูุชุญุณููู</a></li>
<li><a href="../ar481388/index.html">ููู ุชุจูู ุนูููุงุช ุชุจุงุฏู ุงูุนููุฉ ุงููุดูุฑุฉ ุนูุจุงุช ุชุชุญุฏู DeFi</a></li>
<li><a href="../ar481390/index.html">ุฃุฎุจุงุฑ ูู ุฎุฑูุทุฉ ุงูุดุงุฑุน ุงูููุชูุญ ุฑูู 490 (12/03/2019 - 09/12/2019)</a></li>
<li><a href="../ar481392/index.html">ููุง ูุชุจุช cryptocurrency ูู PHP. (ุงูุฌุฒุก ุงูุฃูู - ุงูููุฎุตุงุช ุงูุฃุณุงุณูุฉ + ุงูุจุฏุงูุฉ ุงูุณุฑูุนุฉ)</a></li>
<li><a href="../ar481394/index.html">ุฅุนุงุฏุฉ ูู ูุนุจุฉ ุฌุฏูุฏุฉ ูุง ุฃุญุจุจูุง ุงููุฏูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>