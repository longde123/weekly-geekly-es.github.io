<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüåæ ü§ôüèª üìÜ Ne cr√©ez pas votre propre JL (DSL) pour √©tendre les fonctionnalit√©s de l'application üòß üö¥üèø üêÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque vous souhaitez donner √† l'utilisateur la possibilit√© d'√©crire des plugins pour votre application, vous √™tes confront√© au choix de la mani√®re d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ne cr√©ez pas votre propre JL (DSL) pour √©tendre les fonctionnalit√©s de l'application</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436682/"><p>  Lorsque vous souhaitez donner √† l'utilisateur la possibilit√© d'√©crire des plugins pour votre application, vous √™tes confront√© au choix de la mani√®re de fournir l'API.  Sous la coupe, je montrerai pourquoi la pire solution serait d'inventer votre propre langage de programmation et d'analyser les codes source, ainsi que les meubles ici. </p><br><p><img src="https://habrastorage.org/webt/mm/z3/fl/mmz3flzbwecfpjejtazzand6dfs.png" alt="CPAP"></p><a name="habracut"></a><br><h2 id="yap--eto-ne-osnovnaya-funkciya-prilozheniya">  PL n'est pas la fonction principale de l'application </h2><br><p> Imaginez que nous ouvrions la production de mobilier modulaire.  Il y a quelques √©l√©ments de base: comptoirs, sous-verres, tables de chevet, etc.  Il existe une ligne de production associ√©e √† la transformation du bois: machines-outils, scies, vernis, le tout avec les derni√®res technologies.  Mais tout cela doit d'une mani√®re ou d'une autre √™tre maintenu.  Nous savons qu'il y a 100 500 entreprises sp√©cialis√©es dans la fabrication de quincaillerie et boulons, il existe des normes pour les fixations de meubles qui ont √©t√© invent√©es par une communaut√© de professionnels pour faciliter la vie de leurs clients.  Quelle sera la d√©cision √† long terme de d√©ployer une ligne suppl√©mentaire pour la production de ses propres boulons, √©crous et angles? </p><br><p>  Que pouvons-nous gagner? </p><br><ul><li>  De cette fa√ßon, nous pouvons <abbr title="Si votre piano Steinway a au moins une partie qui n'est pas de Steinway, ce n'est pas Steinway">marquer notre produit</abbr> afin que le hamster ressente son "originalit√©" et porte plus d'argent. </li><li>  Peut-√™tre que cela nous permettra de ne pas payer de droits d'auteur pour aucun des boulons ou de r√©soudre le probl√®me de logistique. </li><li>  Nous pouvons entrer sur un nouveau march√© pour les boulons et les √©crous, en √©tablissant notre propre norme, qui est <abbr title="Eh bien, o√π est le 2,5 mm TRS (Jack) maintenant?">plus rapide, meilleure et plus √©lev√©e.</abbr> </li></ul><br><p>  Mais soyons propres. </p><br><ul><li>  L'illitisme est l'≈ìuvre des vendeurs.  Le vendeur fera ou ne fera pas de la marque une Elite avec ou sans nouvelle ligne de production. </li><li>  Le droit d'auteur, en r√®gle g√©n√©rale (pas toujours, bien s√ªr), est moins cher que le d√©veloppement √† partir de z√©ro.  Et en r√©solvant le probl√®me de la livraison d'un √©l√©ment en d√©ployant une nouvelle ligne de production, vous ne faites que l'exacerber. </li><li>  Si nous voulons essayer un nouveau domaine d'activit√© pour nous-m√™mes, nous n'avons pas besoin de le connecter avec ce dans quoi nous sommes d√©j√† des pros.  Il peut sembler plus facile de pousser les boulons avec les meubles, mais si les boulons ne volent pas vers le haut, ils entra√Æneront les meubles avec eux.  Au moins ce qui co√ªte d√©j√† aux clients. </li></ul><br><p>  Revenons √† nos moutons: si vous cr√©ez un √©cosyst√®me pour les extensions de votre application, alors vous avez une <strong>application</strong> .  Il fait quelque chose de bien, quelque chose que vous √™tes bon. </p><br><h2 id="ksp--kontakt-script-processor-ili-liniya-proizvodstva-boltov-v-mire-digital-audio">  KSP - Processeur de scripts Kontakt, ou ligne de production de boulons dans le monde audio num√©rique </h2><br><p><img src="https://habrastorage.org/webt/e1/ky/8h/e1ky8heowpw6mhn41blmegpt6os.png" alt="Kontakt"></p><br><p>  Je vais vous raconter une histoire sur une telle langue: </p><br><p>  <strong>Kontakt</strong> est une barboteuse (√©chantillonneur) de la soci√©t√© autrichienne <strong>Native Instruments</strong> .  Il est actuellement tr√®s difficile de trouver un projet √† l'aide d'outils virtuels dans lequel il n'est pas utilis√©.  Au cours des 10 derni√®res ann√©es, Kontakt a occup√© la majeure partie du march√© des instruments √©chantillonn√©s.  Le secret est simple: √† une √©poque, Kontakt a propos√© deux innovations qui ont r√©volutionn√© le d√©veloppement d'instruments virtuels √©chantillonn√©s. </p><br><p>  La premi√®re innovation √©tait directement li√©e √† sa fonction principale: il manipulait la m√©moire tr√®s soigneusement (et les √©chantillons en wav sont le m√™me mangeur, √† la fois HDD et RAM).  <strong>NI a</strong> cr√©√© un format de compression <em>sans</em> perte avec d√©codage rapide et a √©crit un syst√®me de mise en m√©moire tampon audio r√©volutionnaire pour l'√©poque. </p><br><h3 id="vtoroy-innovaciey-stal-ksp">  La deuxi√®me innovation √©tait KSP </h3><br><p>  Avant le contact, il y avait deux fa√ßons d'organiser fonctionnellement les √©chantillons enregistr√©s dans un instrument contr√¥l√© par MIDI: </p><br><ul><li>  √âcrivez votre propre moteur √† partir de z√©ro en C ++, ou dans un autre langage qui peut utiliser le SDK VST de Steinberg (et il existe d'autres formats de plug-in, par exemple, AAX). </li><li>  Utilisez un √©chantillonneur pr√™t √† l'emploi con√ßu pour les musiciens qui ne sont pas familiers avec la programmation, mais qui ont des sons qui doivent √™tre organis√©s en une sorte de syst√®me.  Disons <strong>Giga Studio</strong> .  Mais de tels romperms, en r√®gle g√©n√©rale, √©taient ferm√©s, ou pour terminer leur travail, ils n√©cessitaient pas moins de personnel que le simple d√©veloppement sous le SDK VST. </li></ul><br><p>  Le contact a appr√©ci√© ceci et cela: pour un prototypage rapide, il existe une interface graphique pratique qui est compr√©hensible pour tout musicien qui a lu le manuel, et pour plus de raffinement, il n'y a pas moins <strong>un langage de programmation</strong> , avec des conditions, des fonctions (√† partir de la version 4) et une biblioth√®que standard repr√©sentant l'API √† la plupart des fonctionnalit√©s impl√©ment√©es via l'interface graphique, ainsi qu'aux param√®tres de lecture directe des √©chantillons.  Entre autres choses, √† partir de la version 2, il est devenu possible de personnaliser l'interface avec toutes sortes de sifflets et de faux, ce qui a permis de montrer son caract√®re unique √† une √©chelle presque illimit√©e.  Et le code d√©veloppeur est cach√© deux fois: obfuscation et protection contre les changements d' <abbr title="oui, cela ne fonctionne pas dans la version warez">outils</abbr> . </p><br><p>  Compte tenu de la popularit√© croissante du moteur, ainsi que d'une p√©riode impressionnante de d√©veloppement actif de la barboteuse, Kontakt est aujourd'hui une sorte de fusil d'assaut Kalachnikov dans le monde de l'audio num√©rique.  Il est facile √† apprendre, fiable comme un r√©servoir, a la capacit√© de dopilka dans des limites raisonnables pour vous-m√™me bien-aim√©, et d√©tient un √©norme march√© pour les utilisateurs satisfaits. </p><br><h3 id="ne-vse-tak-raduzhno">  Tout n'est pas si rose </h3><br><p>  L'in√©vitable s'est produit: l'innovation sous forme de KSP est devenue un fl√©au.  En essayant de rendre la syntaxe accessible aux mannequins, qui sont des musiciens, au lieu de r√©soudre l'impl√©mentation de l'API dans le langage humain, Nativs a √©crit son propre interpr√®te de leur propre langage, dont l'architecture ne pr√©supposait pas au d√©part une telle vague orageuse d'imagination des d√©veloppeurs d'outils, dont nous assistons maintenant.  D√©j√† par la version 3, les autochtones ont perdu tout espoir de suivre l'app√©tit des utilisateurs et ont simplement commenc√© √† rivaliser avec les nouvelles fonctions de la biblioth√®que standard, permettant aux utilisateurs de d√©couvrir par eux-m√™mes l'environnement de d√©veloppement du code. </p><br><p> De plus, m√™me alors, <strong>Nils Lieberg KScriptEditor est apparu</strong> , bifurqu√© avec <strong>Scintilla</strong> , qui a longtemps servi d'IDE principal pour KSP.  C'est ridicule √† dire, mais quand les indig√®nes se sont rendu compte que le contact ne pouvait pas faire face √† la taille de la source aliment√©e, ils ont introduit des fonctions dans le langage, sans m√™me prendre la peine de leur passer des arguments.  Et un mois plus tard, un taskfunc est apparu dans <code>taskfunc</code> , transmettant des arguments aux fonctions qui ne prennent aucun argument. </p><br><p>  Apr√®s un certain temps, Niels s'est rendu compte qu'il marchait sur le rake des autochtones: il n'y avait aucun sens √† d√©velopper son propre IDE.  Il a port√© le compilateur et impl√©ment√© la fonctionnalit√© IDE sur SublimeText2, et a salu√©.  Pour le moment, les r√™nes de SublimeKSP sont port√©es par le d√©veloppeur, semble-t-il, de <abbr title="Soci√©t√© de d√©veloppement d'outils Kontakt">Fluffy Audio</abbr> . </p><br><p><img src="https://habrastorage.org/webt/6j/fg/yx/6jfgyxlkmajwlnkdxnibbd-f8zg.png" alt="La troisi√®me fois sur le m√™me r√¢teau"></p><br><h3 id="nu-vy-ponyali">  Eh bien, vous comprenez) </h3><br><p>  Et encore une fois, d√©j√† un g√©n√©rateur de code, qui n'est rien de moins qu'un langage, avec un syst√®me d'importations, un analyseur, un compilateur, une syntaxe diff√©rente de KSP, mais qui supporte toujours la compatibilit√© descendante avec lui, pour des raisons inconnues de la science, il s'av√®re √™tre une terrible montagne de b√©quilles qui ne peuvent pas √™tre jet√©es en raison de la compatibilit√© descendante des projets des d√©veloppeurs de biblioth√®ques qui d√©veloppent leurs moteurs KSP depuis des ann√©es. </p><br><p>  Supposons que le syst√®me d'importation fonctionne globalement par rapport au fichier √† partir duquel la compilation est lanc√©e.Par cons√©quent, pour compiler un module situ√© dans un sous-dossier, il est n√©cessaire de changer compl√®tement ses chemins dans les importations, conform√©ment √† sa position dans la structure du projet.  Et le gars qui le soutient serait heureux de changer cela, mais alors il rompra les projets du m√™me <abbr title="une autre entreprise d√©veloppe des outils pour Kontakt">Spitfire Audio</abbr> longtemps et pour longtemps.  Et ce fait √† lui seul complique les tests modulaires (ne disons rien sur les unit√©s) en enfer. </p><br><p>  Il semblerait que la solution au probl√®me soit d'utiliser des liens symboliques, mais quelque part quelque part, cela ne fonctionne pas comme pr√©vu et les liens symboliques ne fonctionnent que partiellement.  Ce genre de probl√®me n'est pas une chose.  Entre autres choses, apr√®s Niels, le d√©veloppement n'a pas √©t√© effectu√© en modifiant le compilateur lui-m√™me, qui re√ßoit du code d√©j√† analys√©.  Et, encore une fois, pour des raisons de compatibilit√© descendante, en ajoutant des plug-ins de syntaxe √©tendue, dont chacun re√ßoit les sources initialement coup√©es en lignes, les analyse de leur propre chef et apporte des modifications. </p><br><p>  √âtant donn√© que la plupart de la logique du pr√©processeur repose sur des macros et des fonctions en ligne qui d√©ploient le code sur un immense canevas qui stocke 80% des conditions toujours vraies ou toujours fausses (en substituant les constantes √† l'entr√©e de la condition), qui sont r√©duites √† l'√©tape en analysant AST, le temps de compilation de la source "correcte" est comparable √† celui des projets. Dans un langage interpr√©t√© pour les nuls. </p><br><p>  Dire que KSP est devenu une douleur pour les d√©veloppeurs, c'est ne rien dire. </p><br><h3 id="ne-kontaktom-edinym">  Pas un seul contact. </h3><br><p>  Je ne peux pas donner d'exemples provenant d'autres domaines, mais ici de la port√©e de DigitalAudio: </p><br><ul><li>  <strong>Lemur</strong> est une application de pelle avec un √©diteur de bureau qui vous permet de cr√©er rapidement de belles interfaces pour communiquer des pelles en utilisant le protocole <abbr title="Open Sound Control est un protocole de contr√¥le d'appareils et de programmes qui a remplac√© le MIDI dans le domaine de l'automatisation des param√®tres audio: par exemple, les boutons de volume et les panoramas.">OSC</abbr> .  Il poss√®de son propre PL, qui peut √™tre utilis√© dans des objets de <em>script</em> sp√©ciaux dispers√©s dans l'arborescence du projet.  Il n'y a aucun moyen de faire un compilateur comme cela a √©t√© fait pour KSP. </li><li>  <strong>Reaper</strong> - <abbr title="Station de travail num√©rique. L'outil principal pour les ing√©nieurs du son et les arrangeurs">DAW</abbr> avec un √©cosyst√®me d√©velopp√© de d√©veloppement d'extension.  Par cons√©quent, dans la mesure du possible, j'ai dupliqu√© mon <abbr title="version tronqu√©e de JavaScript (apparemment, pour la vitesse d'analyse)"><em>code de langage JSFX (ReaScript) en</em></abbr> tant <abbr title="version tronqu√©e de JavaScript (apparemment, pour la vitesse d'analyse)"><em>qu'API</em></abbr> pour C ++, lua et Python. </li><li>  <strong>HISE</strong> est un jeune √©crivain et <strong>constructeur</strong> <abbr title="Format de plugin DAW universel d√©velopp√© par Steinberg">VST \ VSTi</abbr> qui tuera Kontakt du d√©veloppeur su√©dois <em>Christoph Haart</em> t√¥t ou tard.  √Ä l'int√©rieur de l'√©diteur lui-m√™me, il vous permet d'√©crire en JavaScript modifi√©, qui est analys√© et compil√© dans le binaire par des objets C ++.  L'id√©e avec votre propre analyseur pour introduire des entit√©s suppl√©mentaires (par exemple, enregistrer des variables, si j'ai traduit correctement) a fonctionn√© jusqu'√† ce que les utilisateurs transf√®rent leur code de l'√©diteur HISE vers leurs IDE pr√©f√©r√©s avec la coloration syntaxique, l'analyse statique et les <em>outils de</em> formatage <em>JsPrettier</em> .  Christophe a maintenant esquiss√© quelques fichiers d'en-t√™te pour la compilation de biblioth√®ques statiques en C ++, qui peuvent ensuite √™tre utilis√©es comme modules dans l'√©diteur.  En parall√®le, il continue de compl√©ter HISEScript (car JavaScript ne peut plus √™tre appel√© ainsi) avec de nouvelles fonctions, mais nous savons que ... </li></ul><br><h1 id="vyvod">  Conclusion </h1><br><p>  √âcrivez votre propre application, en vous consacrant √† ses principales fonctionnalit√©s, ne perdez pas de temps sur l'analyseur, la s√©mantique et la syntaxe.  C'est int√©ressant pendant que vous commencez, mais avec une probabilit√© √©lev√©e, cela entra√Ænera une impasse.  Le langage de programmation ne peut pas faire partie de l'application: c'est une sorte de ligne de production distincte qui n√©cessite beaucoup de temps pour maintenir, modifier et soutenir la communaut√©.  √Ä son tour, si vous esp√©rez abaisser le seuil pour les nuls, laissez-le tomber.  Une vraie th√©i√®re, en r√®gle g√©n√©rale, a peur d'imprimer quoi que ce soit et ne se souciera pas de votre syntaxe simple. </p><br><p>  Dans le m√™me temps, pour les d√©veloppeurs de plug-ins d√©butants pour votre programme, vous pouvez simplement cr√©er un petit <em>QuickStartGuide</em> , leur pr√©senter les concepts de base de votre PL choisi pour √©tendre les fonctionnalit√©s et lui alimenter lentement votre API, qui fait partie de l'√©cosyst√®me de ce langage. </p><br><p>  <em>PS Non, √©crire votre propre analyseur pour un PL pr√™t √† l'emploi est √©galement une mauvaise id√©e.</em> </p><br><p>  Je serai heureux de toute critique de l'article, de la premi√®re cr√™pe et de toutes choses. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436682/">https://habr.com/ru/post/fr436682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436664/index.html">Pr√©sentation de la s√©rie .NET Community Standup</a></li>
<li><a href="../fr436668/index.html">Les statistiques peuvent-elles √™tre lues avec une petite quantit√© de donn√©es?</a></li>
<li><a href="../fr436670/index.html">Comment rouler automatiquement les mises √† jour en production</a></li>
<li><a href="../fr436674/index.html">Reverse Engineering Fantastic Dizzy</a></li>
<li><a href="../fr436676/index.html">Comment faire DDoS dans tout le pays</a></li>
<li><a href="../fr436684/index.html">Anniversaire Android 10 (Q). Que sait-on maintenant?</a></li>
<li><a href="../fr436686/index.html">JPEG du monde 3D. Qu'est-ce que glTF?</a></li>
<li><a href="../fr436688/index.html">Le g√©ant informatique quitte le march√© des puces pour les centres de donn√©es - dites-nous ce que cela signifie pour l'industrie</a></li>
<li><a href="../fr436690/index.html">[Demande - r√©ponse] sur la propri√©t√© intellectuelle et la protection des donn√©es</a></li>
<li><a href="../fr436692/index.html">(in) Guerre finie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>