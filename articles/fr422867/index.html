<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ğŸ» ğŸ ğŸ’£ DÃ©termination du nombre d'Ã©tages d'une maison Ã  partir de sa photo sans apprentissage automatique âœ”ï¸ ğŸ¥§ ğŸ‘±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je donnerai, Ã  mon avis, une solution intÃ©ressante au problÃ¨me de la reconnaissance informatique des objets dans une image sans util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DÃ©termination du nombre d'Ã©tages d'une maison Ã  partir de sa photo sans apprentissage automatique</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422867/"><p><img src="https://habrastorage.org/webt/cj/m6/ap/cjm6ap1__gr044luewh6bnieg90.png"></p><br><p>  Dans cet article, je donnerai, Ã  mon avis, une solution intÃ©ressante au problÃ¨me de la reconnaissance informatique des objets dans une image sans utiliser de formation. </p><a name="habracut"></a><br><p>  TÃ¢che: avoir une photo d'un immeuble Ã  plusieurs Ã©tages, essayer de dÃ©terminer le nombre d'Ã©tages qu'il contient. </p><br><p>  Une bonne estimation du nombre d'Ã©tages peut donner le nombre de fenÃªtres Ã  la verticale de la maison.  Les fenÃªtres, les balcons et autres objets sont de bonnes caractÃ©ristiques des sols (en particulier dans les bÃ¢timents rÃ©sidentiels).  Je considÃ©rerai les bÃ¢timents rÃ©sidentiels dont les images sont faciles Ã  trouver sur le rÃ©seau.  Une limitation importante doit Ãªtre notÃ©e Ã  l'avance: la maison dans l'image doit Ãªtre montrÃ©e complÃ¨tement verticalement, afin qu'il soit possible de dÃ©tecter visuellement tous les Ã©tages. </p><br><p>  La tÃ¢che est rationnellement divisÃ©e en deux Ã©tapes: </p><br><ol><li>  Recherchez la Â«bandeÂ» verticale des fenÃªtres Ã  compter.  Deux sous-tÃ¢ches: premiÃ¨rement, vous devez rechercher des fenÃªtres dans la zone d'image occupÃ©e par la maison, et deuxiÃ¨mement, il y a beaucoup de fenÃªtres dans les bÃ¢timents rÃ©sidentiels, cela n'a aucun sens de les analyser toutes.  Il est nÃ©cessaire de mettre en Ã©vidence parmi eux la sÃ©quence verticale la mieux adaptÃ©e Ã  une analyse ultÃ©rieure. </li><li>  DÃ©termination du nombre d'Ã©tages (fenÃªtres ou autres objets caractÃ©ristiques) par la zone sÃ©lectionnÃ©e de la maison. </li></ol><br><p>  Cet article est principalement consacrÃ© Ã  la premiÃ¨re Ã©tape de la solution.  La deuxiÃ¨me Ã©tape est encore en dÃ©veloppement, mais je donnerai Ã©galement quelques rÃ©sultats de sa solution. </p><br><h2 id="shag-1-poisk-oblasti-s-oknami">  Ã‰tape 1. Recherchez la zone avec des fenÃªtres </h2><br><p>  L'idÃ©e principale est qu'une sÃ©rie d'objets identiques (tels que des fenÃªtres) qui se distinguent bien sur une maison dans une rangÃ©e d'objets identiques crÃ©ent une sÃ©quence pÃ©riodique de luminositÃ© des pixels.  C'est prÃ©cisÃ©ment la sÃ©quence Ã  trouver.  Voici les principales Ã©tapes de l'algorithme. </p><br><p>  Nous traduisons d'abord l'image en nuances de gris et la mettons Ã  l'Ã©chelle (j'ai utilisÃ© des images 400x600px) <br><img src="https://habrastorage.org/webt/u0/et/u1/u0etu1wqvivumyejtlrnabusalq.png" alt="image"><br>  <em>Fig.1 Image originale n / b</em> </p><br><p>  Plus loin dans la boucle: </p><br><ol><li>  SÃ©lection sur l'image d'une bande relativement Ã©troite (40px) sur toute la hauteur (Fig.2, image infÃ©rieure sans points) </li><li>  Moyenne de la luminositÃ© sur la largeur de la bande.  Il s'avÃ¨re que la ligne w de la distribution de la luminositÃ© moyenne sur la hauteur de la maison (Fig.2 graphique supÃ©rieur).  Il a une structure pÃ©riodique clairement visible caractÃ©ristique de la zone oÃ¹ il y a des fenÃªtres.  Les fenÃªtres situÃ©es Ã  l'ombre sont moins reconnaissables, mais cela ne fera pas de mal. </li><li>  La diffÃ©rence dw des valeurs de w et w dÃ©calÃ©es de la distance sh est calculÃ©e.  La mÃ©thode de recherche utilise une telle valeur de dÃ©calage sh pour atteindre la rÃ©duction maximale de la mÃ©diane des diffÃ©rences dw (figure 2, graphique infÃ©rieur). <br><img src="https://habrastorage.org/webt/9h/-a/vu/9h-avuydpoc8snu7eebt0dro2ny.png" alt="image"><br><img src="https://habrastorage.org/webt/9f/l5/im/9fl5imoofp3wriyh9clqraz_zga.png" alt="image"><br>  <em>Fig.2 "Bande" de fenÃªtres</em> </li></ol><br><p>  Cependant, il ne suffit pas de trouver la bande de l'image sur laquelle la mÃ©diane a Ã©tÃ© la plus fortement rÃ©duite.  Le fait est que les zones de verdure ou de ciel, avec de faibles valeurs de cisaillement, peuvent donner une diminution plus importante que les fenÃªtres.  Mais si nous traÃ§ons la dÃ©pendance de la valeur mÃ©diane sur la valeur de dÃ©calage pour les bandes avec et sans fenÃªtres, nous pouvons remarquer une diffÃ©rence clÃ©: pour les valeurs de dÃ©calage proches de la hauteur des sols, le graphique avec les fenÃªtres prÃ©sente des extrema clairement visibles.  Ainsi, il n'est pas nÃ©cessaire de mesurer le niveau absolu atteignable de la mÃ©diane, mais sa diminution maximale par rapport au maximum dans le processus d'augmentation du dÃ©calage pour chaque fenÃªtre.  Ceci est un point clÃ©. </p><br><table><thead><tr><th>  sans fenÃªtres </th><th>  avec fenÃªtres </th></tr></thead><tbody><tr><td><img src="https://habrastorage.org/webt/yt/xa/6z/ytxa6zixd0e_zwzd64wecqc2ilg.png" alt="image"></td><td><img src="https://habrastorage.org/webt/5h/op/o7/5hopo7xr4ngt33e7ypwikb7y9ou.png" alt="image"></td></tr></tbody></table><br><p>  <em>Fig. 3 Changement de la mÃ©diane de la luminositÃ© moyenne avec un dÃ©calage croissant</em> </p><br><p>  Ci-dessous, le code python3 avec des commentaires. </p><br><pre><code class="hljs pgsql">image = Image.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>("raf_data/32.jpg").resize((<span class="hljs-number"><span class="hljs-number">600</span></span>,<span class="hljs-number"><span class="hljs-number">400</span></span>)) # . img = np.<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(image.convert("L"), dtype=<span class="hljs-type"><span class="hljs-type">float</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span> SEARCH_WIDTH = <span class="hljs-number"><span class="hljs-number">40</span></span> #    x_opt = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] #    :      sh_range = range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>) #    kmax = <span class="hljs-number"><span class="hljs-number">0</span></span> #       <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, img.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]-SEARCH_WIDTH, <span class="hljs-type"><span class="hljs-type">int</span></span>(SEARCH_WIDTH/<span class="hljs-number"><span class="hljs-number">2</span></span>)): amax = <span class="hljs-number"><span class="hljs-number">0</span></span> amin = <span class="hljs-number"><span class="hljs-number">1</span></span> #      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sh <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sh_range: #    w = img[:,x:x+SEARCH_WIDTH].mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) aim = (pd.DataFrame(w)-pd.DataFrame(w).shift(sh))[sh:].abs().median().<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] #    aim    sh <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim&gt;amax: amax = aim amin = amax <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim&lt;amin: amin = aim aim_k = amax/amin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim_k&gt;kmax: x_opt = [x, sh, w] kmax = aim_k print(<span class="hljs-string"><span class="hljs-string">' : {0},  : {1}'</span></span>.format(x_opt[<span class="hljs-number"><span class="hljs-number">0</span></span>], x_opt[<span class="hljs-number"><span class="hljs-number">1</span></span>]))</code> </pre> <br><p>  La figure 2 marque les points dÃ©finis Ã  la distance du dÃ©calage trouvÃ©.  Comme vous pouvez le voir, ils marquent bien chaque fenÃªtre.  C'est-Ã -dire  nous connaissons dÃ©jÃ  la hauteur du sol! <br>  L'algorithme considÃ©rÃ© trouve de bonnes zones rÃ©guliÃ¨res sur les faÃ§ades de divers bÃ¢timents rÃ©sidentiels (Fig. 4). <br><img src="https://habrastorage.org/webt/xh/vl/h5/xhvlh5ukzlxnwpi5iugar7f2x4u.png" alt="image"><br><img src="https://habrastorage.org/webt/nk/lg/oa/nklgoakyvddkiunj1l-wqyr0npu.png" alt="image"><br><img src="https://habrastorage.org/webt/5f/ty/vb/5ftyvboxmvu_klg5mozu9x07w0a.png" alt="image"><br>  <em>Fig.4 Exemple</em> </p><br><h2 id="shag-2-podschyot-chisla-etazhey">  Ã‰tape 2. Compter le nombre d'Ã©tages </h2><br><p>  A ce stade, les principales difficultÃ©s commencent.  D'autres actions peuvent Ãªtre les suivantes: </p><br><ol><li>  Estimer la hauteur de la maison en analysant la courbe des diffÃ©rences de luminositÃ© moyenne ou en utilisant le machine learning).  Divisez la hauteur de la maison par la hauteur du sol et obtenez le nombre d'Ã©tages. </li><li>  Dans la fenÃªtre trouvÃ©e Ã  la premiÃ¨re Ã©tape, recherchez des objets similaires aux fenÃªtres et comptez-les directement, par exemple, Ã  des points spÃ©cifiques. </li></ol><br><p>  Il semble naturel d'essayer d'abord la premiÃ¨re mÃ©thode: une fois la hauteur des sols connue, il reste Ã  dÃ©terminer la hauteur de la maison.  Cependant, des schÃ©mas similaires Ã  ceux illustrÃ©s Ã  l'Ã©tape 1 s'avÃ¨rent mal adaptÃ©s pour dÃ©terminer la hauteur de la maison, en tenant compte de toutes les limites et transitions possibles.  Dans certains cas, il est possible d'obtenir de bons exemples de travail, mais pour un bon rÃ©sultat constant, des approches utilisant l'apprentissage automatique sont nÃ©cessaires. </p><br><p><img src="https://habrastorage.org/webt/qq/8c/eg/qq8ceg0kmzuzhxqfshishxoiyac.png" alt="image"><br>  <em>Fig. 5 DÃ©termination de la hauteur de la maison Ã  l'aide d'une forÃªt alÃ©atoire</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422867/">https://habr.com/ru/post/fr422867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422857/index.html">ImplÃ©mentation de votre conteneur IoC</a></li>
<li><a href="../fr422859/index.html">Le ministÃ¨re des Communications a proposÃ© de passer aux cartes SIM avec cryptage du FSB</a></li>
<li><a href="../fr422861/index.html">Ã€ propos de la construction de JDK 8 sur Ubuntu, la qualitÃ© du code Hotspot et pourquoi tout Ã©choue en C ++</a></li>
<li><a href="../fr422863/index.html">Tribus, guildes, build train et no TDD: comment fonctionne le dÃ©veloppement mobile dans Uber, Spotify, Odnoklassniki et Avito</a></li>
<li><a href="../fr422865/index.html">Java Enterprise Open Lesson "CDI en action"</a></li>
<li><a href="../fr422869/index.html">Nous maÃ®trisons de nouveaux langages de programmation, en nous appuyant sur les acquis</a></li>
<li><a href="../fr422871/index.html">Identifier des profils significatifs dans VK</a></li>
<li><a href="../fr422873/index.html">Pizza ala semi-supervisÃ©e</a></li>
<li><a href="../fr422875/index.html">Pourquoi ne pas louer un VPS / VDS pour 200 roubles ou comment choisir le bon serveur virtuel</a></li>
<li><a href="../fr422877/index.html">"Est-ce l'IdO?" - apprenez Ã  ne pas appeler l'internet des objets d'affilÃ©e</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>