<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏻 🐝 💣 Détermination du nombre d'étages d'une maison à partir de sa photo sans apprentissage automatique ✔️ 🥧 👱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je donnerai, à mon avis, une solution intéressante au problème de la reconnaissance informatique des objets dans une image sans util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Détermination du nombre d'étages d'une maison à partir de sa photo sans apprentissage automatique</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422867/"><p><img src="https://habrastorage.org/webt/cj/m6/ap/cjm6ap1__gr044luewh6bnieg90.png"></p><br><p>  Dans cet article, je donnerai, à mon avis, une solution intéressante au problème de la reconnaissance informatique des objets dans une image sans utiliser de formation. </p><a name="habracut"></a><br><p>  Tâche: avoir une photo d'un immeuble à plusieurs étages, essayer de déterminer le nombre d'étages qu'il contient. </p><br><p>  Une bonne estimation du nombre d'étages peut donner le nombre de fenêtres à la verticale de la maison.  Les fenêtres, les balcons et autres objets sont de bonnes caractéristiques des sols (en particulier dans les bâtiments résidentiels).  Je considérerai les bâtiments résidentiels dont les images sont faciles à trouver sur le réseau.  Une limitation importante doit être notée à l'avance: la maison dans l'image doit être montrée complètement verticalement, afin qu'il soit possible de détecter visuellement tous les étages. </p><br><p>  La tâche est rationnellement divisée en deux étapes: </p><br><ol><li>  Recherchez la «bande» verticale des fenêtres à compter.  Deux sous-tâches: premièrement, vous devez rechercher des fenêtres dans la zone d'image occupée par la maison, et deuxièmement, il y a beaucoup de fenêtres dans les bâtiments résidentiels, cela n'a aucun sens de les analyser toutes.  Il est nécessaire de mettre en évidence parmi eux la séquence verticale la mieux adaptée à une analyse ultérieure. </li><li>  Détermination du nombre d'étages (fenêtres ou autres objets caractéristiques) par la zone sélectionnée de la maison. </li></ol><br><p>  Cet article est principalement consacré à la première étape de la solution.  La deuxième étape est encore en développement, mais je donnerai également quelques résultats de sa solution. </p><br><h2 id="shag-1-poisk-oblasti-s-oknami">  Étape 1. Recherchez la zone avec des fenêtres </h2><br><p>  L'idée principale est qu'une série d'objets identiques (tels que des fenêtres) qui se distinguent bien sur une maison dans une rangée d'objets identiques créent une séquence périodique de luminosité des pixels.  C'est précisément la séquence à trouver.  Voici les principales étapes de l'algorithme. </p><br><p>  Nous traduisons d'abord l'image en nuances de gris et la mettons à l'échelle (j'ai utilisé des images 400x600px) <br><img src="https://habrastorage.org/webt/u0/et/u1/u0etu1wqvivumyejtlrnabusalq.png" alt="image"><br>  <em>Fig.1 Image originale n / b</em> </p><br><p>  Plus loin dans la boucle: </p><br><ol><li>  Sélection sur l'image d'une bande relativement étroite (40px) sur toute la hauteur (Fig.2, image inférieure sans points) </li><li>  Moyenne de la luminosité sur la largeur de la bande.  Il s'avère que la ligne w de la distribution de la luminosité moyenne sur la hauteur de la maison (Fig.2 graphique supérieur).  Il a une structure périodique clairement visible caractéristique de la zone où il y a des fenêtres.  Les fenêtres situées à l'ombre sont moins reconnaissables, mais cela ne fera pas de mal. </li><li>  La différence dw des valeurs de w et w décalées de la distance sh est calculée.  La méthode de recherche utilise une telle valeur de décalage sh pour atteindre la réduction maximale de la médiane des différences dw (figure 2, graphique inférieur). <br><img src="https://habrastorage.org/webt/9h/-a/vu/9h-avuydpoc8snu7eebt0dro2ny.png" alt="image"><br><img src="https://habrastorage.org/webt/9f/l5/im/9fl5imoofp3wriyh9clqraz_zga.png" alt="image"><br>  <em>Fig.2 "Bande" de fenêtres</em> </li></ol><br><p>  Cependant, il ne suffit pas de trouver la bande de l'image sur laquelle la médiane a été la plus fortement réduite.  Le fait est que les zones de verdure ou de ciel, avec de faibles valeurs de cisaillement, peuvent donner une diminution plus importante que les fenêtres.  Mais si nous traçons la dépendance de la valeur médiane sur la valeur de décalage pour les bandes avec et sans fenêtres, nous pouvons remarquer une différence clé: pour les valeurs de décalage proches de la hauteur des sols, le graphique avec les fenêtres présente des extrema clairement visibles.  Ainsi, il n'est pas nécessaire de mesurer le niveau absolu atteignable de la médiane, mais sa diminution maximale par rapport au maximum dans le processus d'augmentation du décalage pour chaque fenêtre.  Ceci est un point clé. </p><br><table><thead><tr><th>  sans fenêtres </th><th>  avec fenêtres </th></tr></thead><tbody><tr><td><img src="https://habrastorage.org/webt/yt/xa/6z/ytxa6zixd0e_zwzd64wecqc2ilg.png" alt="image"></td><td><img src="https://habrastorage.org/webt/5h/op/o7/5hopo7xr4ngt33e7ypwikb7y9ou.png" alt="image"></td></tr></tbody></table><br><p>  <em>Fig. 3 Changement de la médiane de la luminosité moyenne avec un décalage croissant</em> </p><br><p>  Ci-dessous, le code python3 avec des commentaires. </p><br><pre><code class="hljs pgsql">image = Image.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>("raf_data/32.jpg").resize((<span class="hljs-number"><span class="hljs-number">600</span></span>,<span class="hljs-number"><span class="hljs-number">400</span></span>)) # . img = np.<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(image.convert("L"), dtype=<span class="hljs-type"><span class="hljs-type">float</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span> SEARCH_WIDTH = <span class="hljs-number"><span class="hljs-number">40</span></span> #    x_opt = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] #    :      sh_range = range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>) #    kmax = <span class="hljs-number"><span class="hljs-number">0</span></span> #       <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, img.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]-SEARCH_WIDTH, <span class="hljs-type"><span class="hljs-type">int</span></span>(SEARCH_WIDTH/<span class="hljs-number"><span class="hljs-number">2</span></span>)): amax = <span class="hljs-number"><span class="hljs-number">0</span></span> amin = <span class="hljs-number"><span class="hljs-number">1</span></span> #      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sh <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sh_range: #    w = img[:,x:x+SEARCH_WIDTH].mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) aim = (pd.DataFrame(w)-pd.DataFrame(w).shift(sh))[sh:].abs().median().<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] #    aim    sh <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim&gt;amax: amax = aim amin = amax <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim&lt;amin: amin = aim aim_k = amax/amin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim_k&gt;kmax: x_opt = [x, sh, w] kmax = aim_k print(<span class="hljs-string"><span class="hljs-string">' : {0},  : {1}'</span></span>.format(x_opt[<span class="hljs-number"><span class="hljs-number">0</span></span>], x_opt[<span class="hljs-number"><span class="hljs-number">1</span></span>]))</code> </pre> <br><p>  La figure 2 marque les points définis à la distance du décalage trouvé.  Comme vous pouvez le voir, ils marquent bien chaque fenêtre.  C'est-à-dire  nous connaissons déjà la hauteur du sol! <br>  L'algorithme considéré trouve de bonnes zones régulières sur les façades de divers bâtiments résidentiels (Fig. 4). <br><img src="https://habrastorage.org/webt/xh/vl/h5/xhvlh5ukzlxnwpi5iugar7f2x4u.png" alt="image"><br><img src="https://habrastorage.org/webt/nk/lg/oa/nklgoakyvddkiunj1l-wqyr0npu.png" alt="image"><br><img src="https://habrastorage.org/webt/5f/ty/vb/5ftyvboxmvu_klg5mozu9x07w0a.png" alt="image"><br>  <em>Fig.4 Exemple</em> </p><br><h2 id="shag-2-podschyot-chisla-etazhey">  Étape 2. Compter le nombre d'étages </h2><br><p>  A ce stade, les principales difficultés commencent.  D'autres actions peuvent être les suivantes: </p><br><ol><li>  Estimer la hauteur de la maison en analysant la courbe des différences de luminosité moyenne ou en utilisant le machine learning).  Divisez la hauteur de la maison par la hauteur du sol et obtenez le nombre d'étages. </li><li>  Dans la fenêtre trouvée à la première étape, recherchez des objets similaires aux fenêtres et comptez-les directement, par exemple, à des points spécifiques. </li></ol><br><p>  Il semble naturel d'essayer d'abord la première méthode: une fois la hauteur des sols connue, il reste à déterminer la hauteur de la maison.  Cependant, des schémas similaires à ceux illustrés à l'étape 1 s'avèrent mal adaptés pour déterminer la hauteur de la maison, en tenant compte de toutes les limites et transitions possibles.  Dans certains cas, il est possible d'obtenir de bons exemples de travail, mais pour un bon résultat constant, des approches utilisant l'apprentissage automatique sont nécessaires. </p><br><p><img src="https://habrastorage.org/webt/qq/8c/eg/qq8ceg0kmzuzhxqfshishxoiyac.png" alt="image"><br>  <em>Fig. 5 Détermination de la hauteur de la maison à l'aide d'une forêt aléatoire</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422867/">https://habr.com/ru/post/fr422867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422857/index.html">Implémentation de votre conteneur IoC</a></li>
<li><a href="../fr422859/index.html">Le ministère des Communications a proposé de passer aux cartes SIM avec cryptage du FSB</a></li>
<li><a href="../fr422861/index.html">À propos de la construction de JDK 8 sur Ubuntu, la qualité du code Hotspot et pourquoi tout échoue en C ++</a></li>
<li><a href="../fr422863/index.html">Tribus, guildes, build train et no TDD: comment fonctionne le développement mobile dans Uber, Spotify, Odnoklassniki et Avito</a></li>
<li><a href="../fr422865/index.html">Java Enterprise Open Lesson "CDI en action"</a></li>
<li><a href="../fr422869/index.html">Nous maîtrisons de nouveaux langages de programmation, en nous appuyant sur les acquis</a></li>
<li><a href="../fr422871/index.html">Identifier des profils significatifs dans VK</a></li>
<li><a href="../fr422873/index.html">Pizza ala semi-supervisée</a></li>
<li><a href="../fr422875/index.html">Pourquoi ne pas louer un VPS / VDS pour 200 roubles ou comment choisir le bon serveur virtuel</a></li>
<li><a href="../fr422877/index.html">"Est-ce l'IdO?" - apprenez à ne pas appeler l'internet des objets d'affilée</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>