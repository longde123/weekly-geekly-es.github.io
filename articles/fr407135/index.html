<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👈 💴 🏑 Comment configurer la diffusion sur un site à partir de n'importe quelle caméra de surveillance 🙇 🏬 👨🏻‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Début 2016, le service de diffusion Line a subi un test de résistance inattendu. Et tout cela grâce aux événements du parc safari, où vivaient dans le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment configurer la diffusion sur un site à partir de n'importe quelle caméra de surveillance</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/devline/blog/407135/">  Début 2016, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">service de diffusion Line a</a> subi un test de résistance inattendu.  Et tout cela grâce aux événements du parc safari, où vivaient dans le même enclos le tigre et la chèvre les plus tenaces du pays.  Le 31 décembre 2015, une diffusion en direct a été annoncée à la télévision nationale, qui a été organisée à l'aide de notre service.  Presque immédiatement après cela, le site du parc et nos serveurs n'ont pas pu supporter la charge. <br><br>  En quelques heures, la diffusion a été rétablie, les capacités nécessaires ont été ajoutées pour plus de 2 500 000 connexions aux caméras IP.  Au cours de la semaine suivante, des serveurs aux Pays-Bas et aux États-Unis ont été ajoutés au service, la fonction de protection de la diffusion a été développée.  En général, nous avons tout fait pour que notre service puisse résister à n'importe quel nombre de personnes souhaitant regarder une émission populaire.  Dans cet exemple particulier, le public était plus de 10 millions de personnes. <br><br><img src="https://habrastorage.org/webt/59/d2/40/59d24061dd105139145639.jpeg"><br><br>  Depuis lors, la popularité de ce service ne fait que croître.  Non seulement c'est un excellent outil de marketing qui peut être utilisé dans n'importe quelle entreprise, mais il apporte également des bonus agréables sous la forme d'une amélioration des caractéristiques comportementales d'un site et d'une confiance accrue dans une entreprise, un produit ou un service. <br><br>  Outre Amur et Timur, dans notre pratique, il existe de nombreux exemples intéressants.  Il s'agit d'un réseau de magasins de fleurs et d'une clinique hospitalière pour animaux de compagnie et événements sportifs.  En général, pour les entreprises, ce n'est qu'un magasin d'idées que nous avons examinées en détail et avec des exemples dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> . <br><br>  <b>De l'idée à la mise en œuvre.</b>  <b>Comment tout organiser de la manière la plus rentable possible</b> <br><a name="habracut"></a><br>  Les flux de caméras «prêts à l'emploi» ne sont pas destinés à être diffusés sur le site, il est donc préférable d'utiliser un logiciel de vidéosurveillance.  Ceux qui ont déjà installé un tel système auront des coûts supplémentaires au minimum ou pas du tout. <br><br>  Les autres peuvent utiliser la version de démonstration gratuite du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programme de vidéosurveillance Line pour Linux</a> .  Pour la diffusion, vous n'avez besoin que d'une caméra avec laquelle nous prendrons le flux et le serveur vidéo sous Linux. <br><br>  De plus, le serveur physique n'est pas du tout un élément obligatoire.  Vous pouvez définir la "Ligne" sur le VPS.  De nombreuses critiques vous aideront à choisir le bon serveur virtuel, à la fois sur Geektimes et Habrahabr, ainsi que dans d'autres sources. <br><br>  La configuration de la diffusion est possible à l'aide du client Line pour Windows.  Même dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">démo</a> du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">logiciel,</a> nous mettons de nombreuses fonctionnalités utiles, y compris la possibilité d'alerter lorsque le signal de la caméra est perdu. <br><br>  <b>Diffusion sur le site</b> <br><br>  Après avoir installé et vérifié tous les composants du système, vous pouvez placer la diffusion sur votre site.  Vous pouvez créer votre propre conception de lecteur en utilisant les capacités de html5 video + css. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'API du système de vidéosurveillance «Line»</a> vous permet de recevoir à la fois la trame actuelle et le flux H.264 (hls, flv). <br><br>  Mais la solution idéale pour toutes les plateformes n'existe pas.  Donc, Internet Explorer ne peut lire que flv, Chrome a récemment bloqué activement le flash, hls.js. ne fonctionne pas sous iOS <br><br>  Vous pouvez résoudre ce problème en écrivant un gestionnaire en JavaScript ou PHP, ou utilisez notre solution prête à l'emploi - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">a.devline.ru/html5</a> . <br><br><img src="https://habrastorage.org/webt/59/d2/41/59d2418021334368821137.jpeg"><br><br>  <b>La sécurité passe avant tout</b> <br><br>  Considérez une situation dans laquelle votre idée de diffusion a «tourné», et maintenant des milliers de personnes du monde entier viennent sur votre site toutes les heures.  Certains d'entre eux ne sont pas du tout bien intentionnés, vous devez donc vous protéger du lien hypertexte, masquer les données d'autorisation et l'adresse IP du serveur, configurer la mise en cache, etc. <br><br>  Ici nginx vient à la rescousse, nous écrivons quelques lignes dans la config, et le serveur ne donnera accès que par le lien du formulaire suivant: <br><br><pre><code class="hljs powershell">http://demo.devline.ru:<span class="hljs-number"><span class="hljs-number">3333</span></span>/O0deKdmC0j2xLqRqM490Mw/<span class="hljs-number"><span class="hljs-number">1504967831</span></span>/streaming/<span class="hljs-number"><span class="hljs-number">0</span></span>/sub.m3u8 location / { rewrite /([<span class="hljs-type"><span class="hljs-type">a</span></span>-<span class="hljs-type"><span class="hljs-type">zA</span></span>-<span class="hljs-type"><span class="hljs-type">Z0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-type"><span class="hljs-type">_</span></span>\-]*)/([<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span>]*)/([<span class="hljs-type"><span class="hljs-type">a</span></span>-<span class="hljs-type"><span class="hljs-type">zA</span></span>-<span class="hljs-type"><span class="hljs-type">Z0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-type"><span class="hljs-type">_</span></span>\-]*)/([<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span>]*)/(.*)\.(.*)<span class="hljs-variable"><span class="hljs-variable">$</span></span> /<span class="hljs-variable"><span class="hljs-variable">$3</span></span>/<span class="hljs-variable"><span class="hljs-variable">$4</span></span>/<span class="hljs-variable"><span class="hljs-variable">$5</span></span>.<span class="hljs-variable"><span class="hljs-variable">$6</span></span>?secl=<span class="hljs-variable"><span class="hljs-variable">$1</span></span>&amp;sect=<span class="hljs-variable"><span class="hljs-variable">$2</span></span>&amp;secq=<span class="hljs-variable"><span class="hljs-variable">$4</span></span>&amp;secm=<span class="hljs-variable"><span class="hljs-variable">$3</span></span>; secure_link <span class="hljs-variable"><span class="hljs-variable">$arg_secl</span></span>,<span class="hljs-variable"><span class="hljs-variable">$arg_sect</span></span>; secure_link_md5 devline<span class="hljs-variable"><span class="hljs-variable">$arg_secq</span></span><span class="hljs-variable"><span class="hljs-variable">$arg_sect</span></span><span class="hljs-variable"><span class="hljs-variable">$remote_addr</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$secure_link</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">403</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$secure_link</span></span> = <span class="hljs-string"><span class="hljs-string">"0"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">404</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$arg_secm</span></span> = <span class="hljs-string"><span class="hljs-string">"image"</span></span>) {rewrite /([<span class="hljs-type"><span class="hljs-type">a</span></span>-<span class="hljs-type"><span class="hljs-type">zA</span></span>-<span class="hljs-type"><span class="hljs-type">Z0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-type"><span class="hljs-type">_</span></span>\-]*)/([<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span>]*)/(.*)\.(.*)<span class="hljs-variable"><span class="hljs-variable">$</span></span> /cameras/<span class="hljs-variable"><span class="hljs-variable">$2</span></span>/<span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;} rewrite /([<span class="hljs-type"><span class="hljs-type">a</span></span>-<span class="hljs-type"><span class="hljs-type">zA</span></span>-<span class="hljs-type"><span class="hljs-type">Z0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-type"><span class="hljs-type">_</span></span>\-]*)/([<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span>]*)/(.*)\.(.*)<span class="hljs-variable"><span class="hljs-variable">$</span></span> /cameras/<span class="hljs-variable"><span class="hljs-variable">$2</span></span>/<span class="hljs-variable"><span class="hljs-variable">$1</span></span>/<span class="hljs-variable"><span class="hljs-variable">$3</span></span>.<span class="hljs-variable"><span class="hljs-variable">$4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; proxy_pass http://<span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.1</span></span>:<span class="hljs-number"><span class="hljs-number">9786</span></span>; proxy_set_header Authorization <span class="hljs-string"><span class="hljs-string">"Basic YWRtaW46"</span></span>; }     PHP: <span class="hljs-variable"><span class="hljs-variable">$camid</span></span> = <span class="hljs-string"><span class="hljs-string">"0"</span></span>; <span class="hljs-variable"><span class="hljs-variable">$secret</span></span> = <span class="hljs-string"><span class="hljs-string">'devline'</span></span>; <span class="hljs-variable"><span class="hljs-variable">$time_expires</span></span> = time() + <span class="hljs-number"><span class="hljs-number">90800</span></span>; //life <span class="hljs-number"><span class="hljs-number">24</span></span> hours <span class="hljs-variable"><span class="hljs-variable">$key</span></span> = str_replace(<span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, strtr(base64_encode(md5(<span class="hljs-variable"><span class="hljs-variable">$secret</span></span>.<span class="hljs-variable"><span class="hljs-variable">$camid</span></span>.<span class="hljs-variable"><span class="hljs-variable">$time_expires</span></span>.getenv(<span class="hljs-string"><span class="hljs-string">"REMOTE_ADDR"</span></span>), TRUE)), <span class="hljs-string"><span class="hljs-string">"+/"</span></span>, <span class="hljs-string"><span class="hljs-string">"-_"</span></span>)); echo <span class="hljs-string"><span class="hljs-string">"/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$key</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time_expires</span></span></span><span class="hljs-string">/streaming/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$camid</span></span></span><span class="hljs-string">/sub.m3u8"</span></span>; ?&gt;</code> </pre> <br>  <b>Nous avons tout fait pour toi.</b> <br><br>  Tout ce qui précède, vous ne pouvez pas le faire vous-même, mais utilisez simplement notre solution prête à l'emploi - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rtsp.me.</a>  Pour que le service fonctionne, vous n'avez pas besoin d'être un utilisateur du logiciel Line, il suffit d'avoir une caméra IP ou un DVR qui prend en charge les flux RTSP.  L'équipement doit être doté d'une adresse IP statique et de ports redirigés. <br><br><img src="https://habrastorage.org/webt/59/d2/41/59d2417fa5bc5685076236.jpeg"><br><br>  Vous obtenez une diffusion sécurisée avec prise en charge du son, la possibilité de basculer entre le premier et le deuxième flux.  Les visiteurs du site ne verront pas le vrai nom d'utilisateur et le mot de passe de votre serveur vidéo, le répéteur dupliquera la vidéo s'il y en a plusieurs. <br><br>  Et la présence d'un petit logo au bas du lecteur vous permet de fournir des services gratuitement.  Le logo peut être supprimé en choisissant l'un des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tarifs</a> payés. <br><br>  En outre, les utilisateurs du service peuvent utiliser la fonction Timelapse - vidéo d'une série d'images de votre caméra de surveillance.  Dix jours avec enregistrement en boucle, chaque image se fait toutes les dix minutes.  Le fichier est créé une fois toutes les 24 heures, le débit binaire de la vidéo de sortie est de 2 Mb / s.  Il existe une version payante avec une profondeur d'archivage illimitée dans la période payante, ainsi que des paramètres individuels pour la fréquence de création d'images, l'heure de création d'un enregistrement et le débit binaire vidéo. <br><br>  Quelle option de diffusion choisiriez-vous?  Peut-être avez-vous déjà une diffusion sur le site?  Qu'est-ce que c'est et combien cela vous coûte-t-il? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr407135/">https://habr.com/ru/post/fr407135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr407125/index.html">Les physiciens ont avancé un nouvel argument pour lequel l'Univers ne peut pas être une simulation informatique: les anomalies gravitationnelles</a></li>
<li><a href="../fr407127/index.html">Ligne directe de Washington</a></li>
<li><a href="../fr407129/index.html">Tests de collision: des porcs aux diagnostics par rayons X</a></li>
<li><a href="../fr407131/index.html">Le MIT a créé un robot origami multifonctionnel avec des exosquelettes interchangeables</a></li>
<li><a href="../fr407133/index.html">Le rôle des technologies de l'IA dans l'humanisation des services bancaires numériques</a></li>
<li><a href="../fr407137/index.html">Les voitures électriques aujourd'hui et demain</a></li>
<li><a href="../fr407139/index.html">Vous voulez garder une trace des employés? Commencez par vous-même</a></li>
<li><a href="../fr407141/index.html">Un drone lance-flammes aide à nettoyer la ligne électrique des débris</a></li>
<li><a href="../fr407143/index.html">Sur l'effet des cyanobactéries sur les fonctions vocales du président</a></li>
<li><a href="../fr407145/index.html">Tambour audio du lieutenant Schmidt: quelques mots sur les fractales, les diffuseurs et les miracles de la suggestion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>