<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéóÔ∏è üßìüèø üëÜ Programmation et transmission de donn√©es √† Arduino par voie a√©rienne √† l'aide de l'ESP8266. Troisi√®me partie. Bonjour, ANDROID üïß üßìüèø üë¶üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je vous propose, chers lecteurs de GeekTimes, un autre article du cycle sur l'utilisation de la puce ESP8266 comme pont sans fil pour les microcontr√¥l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmation et transmission de donn√©es √† Arduino par voie a√©rienne √† l'aide de l'ESP8266. Troisi√®me partie. Bonjour, ANDROID</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409107/">  Je vous propose, chers lecteurs de GeekTimes, un autre article du cycle sur l'utilisation de la puce ESP8266 comme pont sans fil pour les microcontr√¥leurs AVR, en utilisant la plate-forme mat√©rielle Arduino Uno (Nano) comme exemple.  Cette fois, <s>pour le vol vers la lune pour</s> contr√¥ler la plateforme, nous utilisons un appareil bas√© sur ANDROID au lieu d'un ordinateur.  Eh bien, par exemple, un smartphone. <br><br><img src="https://habrastorage.org/webt/lq/eo/as/lqeoas8icifnezwk-g6ufh6pdhc.png"><br><br>  D√©tails sous la coupe: <br><a name="habracut"></a><br>  Pour notre travail, nous utiliserons les outils d√©crits dans l'article pr√©c√©dent - le programmateur sans fil BABUINO et le module MPDE (module de programmation et d'√©change de donn√©es) pour flasher en ESP8266. <br><br>  Comme il s'est av√©r√© des commentaires des utilisateurs, le programmeur lui-m√™me, en g√©n√©ral, est venu au tribunal et certaines personnes l'ont m√™me utilis√© avec succ√®s.  Eh bien, fondamentalement, la chose est vraiment pratique;  J'ai lanc√© l'application sous Windows, s√©lectionn√© le fichier hexad√©cimal dans le dossier souhait√© et c'est tout - en quelques secondes, le programme dans le bon appareil sans aucun fil.  Une autre chose est qu'en vain, avec une ardeur excessive, j'ai attaqu√© les utilisateurs du logiciel ARDUINO qui √©crivent dans Wiring C et utilisent l'ARDUINO IDE avec ses croquis et biblioth√®ques.  Bien s√ªr, tout le monde fait ce qui lui convient - que ce soit dans Arduin Wiring C ou C du studio AVR.  Mais au final, certains utilisateurs pour une raison quelconque ont imm√©diatement d√©cid√© que le programmeur n'√©tait en aucune fa√ßon compatible avec le logiciel ARDUINO. <br><br>  En fait, il n'y a bien s√ªr aucun probl√®me de compatibilit√©.  Compilez √©galement votre croquis o√π il vous convient √† l'√©tat d'un fichier hexad√©cimal et envoyez-le tout aussi facilement via un programmeur sans fil √† votre Arduino UNO ou NANO. <br><br>  L'√©change de donn√©es sous le logiciel ARDUINO ne pose pas non plus de probl√®me.  √âcrivez les lignes magiques: <br><br>  <b>Serial.begin (9600);</b> <br><br>  puis quelque chose comme: <br><br>  <b>receiveByte = Serial.read ();</b>  // lit l'octet du tampon <br><br>  ou: <br><br>  <b>Serial.write (receiveByte);</b>  // enregistrement d'octets <br><br>  Et vous pouvez √©changer des flux d'octets sur WI-FI tr√®s calmement.  Pour le microcontr√¥leur AVR envoie √† ESP8266 et re√ßoit des octets √† partir de l√† via le port s√©rie UART, qui, comme nous pouvons le voir, tout humanitaire peut configurer le travail avec lequel dans Arduino. <br><br>  Revenons maintenant au sujet de cet article.  Afin de contr√¥ler le robot via un smartphone, vous devez bien s√ªr √©crire l'application appropri√©e pour ce smartphone. <br><br>  En tant que personne qui a pr√©sent√© ce processus il y a un mois de fa√ßon extr√™mement vague, je peux maintenant d√©clarer en toute responsabilit√© que la question n'est essentiellement pas compliqu√©e.  Sauf si bien s√ªr, vous avez au moins quelques connaissances de base dans le domaine de Java. <br><br>  Pour l'√©criture d'applications Android, le code source est √©crit en Java, puis compil√© en bytecode Java standard √† l'aide d'outils Java traditionnels.  Ensuite, d'autres choses int√©ressantes arrivent au code, mais nous n'avons pas besoin de ces d√©tails ici. <br><br>  Il semble qu'il y ait encore des possibilit√©s d'√©crire des applications en C pour les travailleurs hardcore notoires qui marquent en nanosecondes, et aussi quelque part il y a une sorte de package pour traduire votre code √† partir de Python, mais je ne peux rien dire ici, car j'ai fait le bon choix depuis longtemps . <br><br>  Ainsi, Java et le progiciel Android Studio - un environnement de d√©veloppement int√©gr√© (IDE) pour travailler avec la plate-forme Android bas√©e sur le logiciel IntelliJ IDEA de JetBrains, l'outil de d√©veloppement officiel pour les applications Android. <br><br><img src="https://habrastorage.org/webt/mi/vo/b5/mivob5v-pisjrb1qvojlg1pgsf0.png"><br><br>  Si vous travaillez d√©j√† avec le logiciel IntelliJ IDEA, vous serez agr√©ablement surpris par l'interface famili√®re. <br><br>  Je me suis familiaris√© avec les bases de la construction d'applications √† partir du livre de B. Phillips et C. Stewart - Programmation ¬´ANDROID¬ª pour les professionnels. "Si je comprends bien, les professionnels consid√®rent les lecteurs qui sont au moins un peu familiers avec Java SE. Quelque chose d'archi-complexe dans ce livre Je n'ai pas trouv√©, et pour nos besoins, les dix premiers chapitres du livre suffiront, heureusement, tous les exemples de code y sont donn√©s lorsque vous travaillez avec Android Studio susmentionn√©. <br><br>  Le d√©bogage des applications peut √™tre effectu√© soit sur un √©mulateur logiciel soit directement sur un smartphone en le basculant en ¬´mode d√©veloppeur¬ª. <br><br>  Dans un article pr√©c√©dent, le contr√¥le du chariot via une application Windows sur Windows a √©t√© d√©crit.  Autrement dit, tout le code pour cr√©er des connexions HTTP et UDP, ainsi que la logique de contr√¥le, est d√©j√† pr√©sent en th√©orie.  Par cons√©quent, apr√®s avoir adopt√© le slogan d'Oracle ¬´Il est √©crit en un seul endroit, il fonctionne partout¬ª, nous transf√©rons simplement ces classes vers un nouveau programme pour les applications Android.  Mais l'interface graphique est une interface utilisateur graphique, pour des raisons √©videntes, vous devez laisser o√π elle √©tait.  Mais d'un autre c√¥t√©, sur Android, tout se fait de mani√®re tr√®s similaire et assez rapidement, donc nous ne resterons pas dans le perdant. <br><br>  <b>Piquez un doigt sur l'√©cran</b> <br><br><img src="https://habrastorage.org/webt/yh/ec/kw/yheckwfcoqj3p01duei5y84mcle.jpeg"><br><br>  Nous cr√©ons donc un nouveau projet ¬´FourWheelRobotControl¬ª dans Android Studio. <br>  Ceci est une application simple et consistera en une activit√© <br><br><div class="spoiler">  <b class="spoiler_title">Classe MainActivity.java</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Sensor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.MotionEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ImageButton; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonUP; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonDOWN; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonLEFT; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonRIGHT; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HTTP_client(<span class="hljs-number"><span class="hljs-number">40000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Udp_client(); mButtonUP = (ImageButton) findViewById(R.id.imageButtonUP); mButtonUP.setOnTouchListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnTouchListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v, MotionEvent event)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_DOWN) { direction = <span class="hljs-number"><span class="hljs-number">3</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_UP) { direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }); mButtonDOWN = (ImageButton) findViewById(R.id.imageButtonDown); mButtonDOWN.setOnTouchListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnTouchListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v, MotionEvent event)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_DOWN) { direction = <span class="hljs-number"><span class="hljs-number">4</span></span>; Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span> + direction, Toast.LENGTH_SHORT).show(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_UP) { direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }); mButtonLEFT = (ImageButton) findViewById(R.id.imageButtonLeft); mButtonLEFT.setOnTouchListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnTouchListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v, MotionEvent event)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_DOWN) { direction = <span class="hljs-number"><span class="hljs-number">1</span></span>; Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span> + direction, Toast.LENGTH_SHORT).show(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_UP) { direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }); mButtonRIGHT = (ImageButton) findViewById(R.id.imageButtonRight); mButtonRIGHT.setOnTouchListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnTouchListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v, MotionEvent event)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_DOWN) { direction = <span class="hljs-number"><span class="hljs-number">2</span></span>; Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span> + direction, Toast.LENGTH_SHORT).show(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.getAction() == MotionEvent.ACTION_UP) { direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }); }</code> </pre> </div></div><br>  et mise en page: <br><br><div class="spoiler">  <b class="spoiler_title">mise en page</b> <div class="spoiler_text"><pre> <code class="xml hljs"> /spoiler/ activity_main.xml <span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mikhail_akhmetov.fourweelsrobotcontrol.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ImageButton</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/imageButtonRight"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Widget.Holo.ImageButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:color/holo_orange_dark"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/linearLayout"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.417"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/imageButtonLeft"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintRight_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.513"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:srcCompat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:drawable/ic_media_ff"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ImageButton</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/imageButtonUP"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Widget.ImageButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:color/holo_orange_dark"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/imageButtonDown"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintRight_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.486"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:srcCompat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:drawable/arrow_up_float"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ImageButton</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/imageButtonDown"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Widget.ImageButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"57dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:color/holo_orange_dark"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:fadingEdge</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/linearLayout"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.487"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintRight_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:srcCompat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:drawable/arrow_down_float"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ImageButton</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/imageButtonLeft"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Widget.ImageButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"52dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"94dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"94dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:color/holo_orange_dark"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/linearLayout"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.513"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:srcCompat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:drawable/ic_media_rew"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/linearLayout"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"368dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"227dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"11dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:weightSum</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintRight_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/textViewX"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.28"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/textViewY"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.28"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/textViewZ"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.23"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Il n'est pas n√©cessaire d'√©crire avec des stylos, il est g√©n√©r√© automatiquement apr√®s vos cr√©ations dans l'√©diteur. <br><br>  Maintenant, nous transf√©rons simplement deux classes du programme donn√© dans l'article pr√©c√©dent: <br><br><div class="spoiler">  <b class="spoiler_title">HTTP_client.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStreamReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.OutputStreamWriter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.PrintWriter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.InetAddress; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.Socket; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HTTP_client</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Thread</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> port; String s; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String host_address=<span class="hljs-string"><span class="hljs-string">"192.168.1.138"</span></span>;<span class="hljs-comment"><span class="hljs-comment">//    public String Greetings_from_S; HTTP_client(int port) { this.port = port; start(); } public void run() { try (Socket socket = new Socket(host_address,port)){ PrintWriter pw = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()), true); BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream())); pw.println("stop data\r");//  ,    pw.println("data\r");// Greetings with SERVER Greetings_from_S = br.readLine(); if (Greetings_from_S.equals("ready")) { new Udp_client(); } } catch (Exception e) { e.printStackTrace(); } } }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Udp_clent.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.DatagramPacket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.DatagramSocket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.InetAddress; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Udp_client</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Thread</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i =<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> [] data = {<span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> udp_port=<span class="hljs-number"><span class="hljs-number">50000</span></span>; InetAddress addr; DatagramSocket ds; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Udp_client</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DatagramSocket(); addr = InetAddress.getByName(HTTP_client.host_address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { } start(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> temp = MainActivity.direction; String s = <span class="hljs-string"><span class="hljs-string">""</span></span> + MainActivity.direction; data = s.getBytes(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(temp!=<span class="hljs-number"><span class="hljs-number">100</span></span> ) { DatagramPacket pack = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DatagramPacket(data, data.length, addr, udp_port); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ds.send(pack); i=<span class="hljs-number"><span class="hljs-number">0</span></span>; Thread.sleep(<span class="hljs-number"><span class="hljs-number">200</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(i==<span class="hljs-number"><span class="hljs-number">0</span></span>) { s = <span class="hljs-string"><span class="hljs-string">""</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>; data = s.getBytes(); DatagramPacket pack = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DatagramPacket(data, data.length, addr, udp_port); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ds.send(pack); Thread.sleep(<span class="hljs-number"><span class="hljs-number">200</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { } } i=<span class="hljs-number"><span class="hljs-number">1</span></span>;<span class="hljs-comment"><span class="hljs-comment">//     } } } }</span></span></code> </pre></div></div><br>  L'essence du programme reste la m√™me.  MainActivity lance d'abord les clients HTTP et UDP, puis intercepte les pressions sur les boutons et les d√©pressions, envoyant un code push de direction pour former un paquet UDP.  Et √† partir de l√†, tout est d√©j√† - "avant", "arri√®re", "gauche", "droite" et lorsque vous appuyez sur "stop", ils partent via WI-FI dans un panier. <br><br>  En plus de tout cela, nous devons l√©g√®rement modifier le fichier du soi-disant manifeste, qui, encore une fois, est principalement g√©n√©r√© par lui-m√™me. <br><br><blockquote>  Un manifeste est un fichier XML avec des m√©tadonn√©es d√©crivant votre application Android.  Le fichier manifeste est toujours appel√© AndroidManifest.xml et se trouve dans le r√©pertoire app / manifest de votre projet. </blockquote><br>  Certes, il y a tr√®s peu de travail pour nous. <br><br>  interdire la rotation de l'√©cran: <br><br><pre> <code class="xml hljs">android:screenOrientation="portrait"</code> </pre><br>  Nous autorisons le travail sur Internet: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  Et ici, tout est compl√®tement. <br><br><div class="spoiler">  <b class="spoiler_title">AndroidManifest.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mikhail_akhmetov.fourweelsrobotcontrol"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:roundIcon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher_round"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:supportsRtl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/AppTheme"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Au d√©marrage, nous devrions voir quelque chose comme: <br><br><img src="https://habrastorage.org/webt/up/nv/yr/upnvyrkc5r2ti2kuzm7e0ktjswa.png"><br><br>  C'est essentiellement tout.  Maintenant, le chariot peut √™tre contr√¥l√© √† partir d'un t√©l√©phone mobile.  L'application est extr√™mement simple, car il s'agit d'une application de d√©monstration sans ¬´sifflets et contrefa√ßons¬ª, comme la recherche d'un panier sur un r√©seau domestique, la connexion, la d√©connexion et d'autres fonctionnalit√©s utiles qui facilitent la vie, mais rendent le code difficile √† comprendre. <br><br>  D'un autre c√¥t√©, le fonctionnement avec les boutons √† l'√©cran est le m√™me <blockquote>  "Comment boire juste de la vodka, m√™me du cou - il n'y a rien d'autre que languissant d'esprit et d'agitation." </blockquote>  Et Venya Erofeev avait raison, bien s√ªr. <br><br>  Il est beaucoup plus int√©ressant, par exemple, de diriger un chariot √† l'aide d'acc√©l√©rom√®tres standard du m√™me smartphone. <br><br>  De plus, cette fonctionnalit√© est √©galement mise en ≈ìuvre tr√®s simplement, √† travers les soi-disant intentions.  Il est vrai que la cr√©ation de vos propres intentions est plus difficile que l'utilisation de celles toutes faites.  Heureusement, personne n'interdit d'utiliser des pr√™ts √† l'emploi. <br><br>  <b>ACC√âL√âROM√àTRE EN MASSES</b> <br><br><img src="https://habrastorage.org/webt/n5/tr/_n/n5tr_nioum4avgw97qqcsqm63zi.jpeg"><br><br>  Par cons√©quent, notre code dans MainActivity (et uniquement dans celui-ci) changera de mani√®re minimale. <br><br>  Ajoutez des variables pour l'acc√©l√©rom√®tre: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SensorManager mSensorManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Sensor mOrientation; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> xy_angle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> xz_angle;</code> </pre><br>  Nous obtenons le capteur lui-m√™me du syst√®me et l'enregistrons en tant qu'auditeur. <br><br><pre> <code class="java hljs">mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE); <span class="hljs-comment"><span class="hljs-comment">//    mOrientation = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER); //    mSensorManager.registerListener(this, mOrientation, SensorManager.SENSOR_DELAY_NORMAL);</span></span></code> </pre><br>  Nous impl√©mentons l'interface d'√©coute elle-m√™me: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SensorEventListener</span></span></span></span></code> </pre><br>  Et nous √©crirons quatre m√©thodes obligatoires dont nous n'utiliserons que la derni√®re.  Une m√©thode qui fonctionne lors du changement des lectures de l'acc√©l√©rom√®tre.  En fait, je voulais interroger l'acc√©l√©rom√®tre moi-m√™me, comme des p√©riph√©riques normaux avec une p√©riode d'environ 100 ms, car il y avait un soup√ßon (en raison du nom onChanged) que la m√©thode fonctionnait trop souvent.  Mais l√† tout est priv√© et fig√© pour les interfaces que vous traverserez. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onAccuracyChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sensor sensor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> accuracy)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    } @Override protected void onResume() { super.onResume(); } @Override protected void onPause() { super.onPause(); } @Override public void onSensorChanged(SensorEvent event) {} //  </span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Par cons√©quent, MainActivity.java prendra la forme suivante</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.SensorEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.SensorEventListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.SensorManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Sensor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ImageButton; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SensorEventListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonUP; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonDOWN; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonLEFT; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonRIGHT; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SensorManager mSensorManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Sensor mOrientation; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> xy_angle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> xz_angle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView xyView; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView xzView; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView zyView; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HTTP_client(<span class="hljs-number"><span class="hljs-number">40000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Udp_client(); mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE); <span class="hljs-comment"><span class="hljs-comment">//    mOrientation = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER); //    mSensorManager.registerListener(this, mOrientation, SensorManager.SENSOR_DELAY_NORMAL); xyView = (TextView) findViewById(R.id.textViewX); // xzView = (TextView) findViewById(R.id.textViewY); //       zyView = (TextView) findViewById(R.id.textViewZ);//   "direction" mButtonUP = (ImageButton) findViewById(R.id.imageButtonUP); mButtonDOWN = (ImageButton) findViewById(R.id.imageButtonDown); mButtonLEFT = (ImageButton) findViewById(R.id.imageButtonLeft); mButtonRIGHT = (ImageButton) findViewById(R.id.imageButtonRight); //    } @Override public void onAccuracyChanged(Sensor sensor, int accuracy) { //    } @Override protected void onResume() { super.onResume(); } @Override protected void onPause() { super.onPause(); } @Override public void onSensorChanged(SensorEvent event) { //   xy_angle = event.values[0]*10; // XY xz_angle = event.values[1]*10; // XZ x=-(int) xy_angle*1; y=-(int) xz_angle*1; xyView.setText(" x = "+ String.valueOf(x)); xzView.setText(" y = "+String.valueOf(y)); zyView.setText(" direction "+String.valueOf(direction)); if(y&gt;-40&amp;&amp;y&lt;-20){ direction=100;//   ,   ,     if (x&gt;10){//   10  30  20  direction=(byte)(x+30); if (direction&gt;60){direction=60;} } if(x&lt;-10){ direction=(byte)(-x+50); if (direction&gt;80){direction=80;} } } else { if (y &gt; -20) {//  ,  -20: 20  40  direction = (byte) (y / 2 + 10); if (direction &gt; 20) { direction = 20; } ; } if (y &lt; -40) {//  ,  -40: -80  40  direction = (byte) (-y - 20); if (direction &gt; 40) { direction = 40; } ; } } } } //   direction 100  // 1-20  ,   -20 // 21-40  ,   -40 // 41-60 ,  10 // 61-80 ,   -10</span></span></code> </pre><br></div></div><br>  Le programme affiche les capteurs sur deux axes sur l'√©cran du smartphone.  Au lieu du troisi√®me axe, qui n'est pas utilis√©, la variable de direction "direction" est affich√©e.  Et les m√™mes donn√©es s'ex√©cutent sous la forme d'un flux d'octets vers le panier.  Cependant, en raison du fait que le flux est purement octet, il serait difficile de d√©terminer o√π serait la commande "forward" ou "stop".  C'est ce que j'ai fait: chaque direction et angle d'inclinaison a sa propre plage de nombres.  En gros, 1-20 est "en avant" avec la vitesse correspondante, 21-40 est "en arri√®re" et ainsi de suite.  Bien s√ªr, il serait possible de transmettre uniquement des donn√©es via UDP, et les commandes de contr√¥le elles-m√™mes devraient √™tre d√©finies via le protocole TCP, et ce serait certainement plus correct.  Mais pour cela, vous devez modifier le programme sur l'ESP8266 lui-m√™me, ce que je ne veux pas encore. <br><br>  Ainsi, le chariot roule autour de l'appartement, r√©agissant avec sensibilit√© aux pentes de mon GalaxyS7, mais m√™me cela, comme le disait la c√©l√®bre Venya, n'est toujours pas cela. <br><br><blockquote>  ¬´Maintenant, je vous offre le dernier et le meilleur.  "La couronne du travail, surtout des r√©compenses", comme l'a dit le po√®te.  Bref, je vous propose le cocktail ¬´Offal Off¬ª, une boisson qui √©clipse tout.  Ce n'est plus une boisson - c'est la musique des sph√®res.  ‚Äû </blockquote><br>  √Ä l'√®re de Siri et d'Alexa, y a-t-il quelque chose pour faire tournoyer vos mains?  Laissez la commande vocale ob√©ir! <br><br>  <b>Et maintenant, √©coutez-moi!</b> <br><br><img src="https://habrastorage.org/webt/lq/2y/wi/lq2ywi0undiqsci5pf5rc2bkwqk.jpeg"><br><br>  Je cite: <br><br><blockquote>  En fait, travailler avec la reconnaissance vocale et la synth√®se vocale dans Android est tr√®s simple.  Tous les calculs complexes nous sont cach√©s dans une biblioth√®que assez √©l√©gante avec une API simple.  Vous pouvez ma√Ætriser cette le√ßon m√™me si vous avez une connaissance tr√®s superficielle de la programmation pour Android. </blockquote><br>  En fait, tout s'est av√©r√© assez maladroit pour moi, mais probablement parce que j'ai utilis√© l'option la plus simple et que je n'ai pas creus√© correctement dans cette API.  Tout se fait √©galement √† travers des intentions, √† l'aide desquelles nous nous tournons vers le moteur vocal de Google, √† savoir sa fonction de reconnaissance vocale.  Par cons√©quent, vous avez besoin d'un Internet fonctionnel. <br><br>  Encore une fois, seul MainActivity.java change, m√™me si j'ai chang√© un peu plus la disposition (quatre boutons sont maintenant compl√®tement inutiles, un suffit). <br><br>  Les √©l√©ments suivants ont √©t√© ajout√©s √† MainActivity.java: <br><br>  La m√™me intention: <br><br><pre> <code class="java hljs">Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH); intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM); intent.putExtra(RecognizerIntent.EXTRA_PROMPT, <span class="hljs-string"><span class="hljs-string">", ,  -??? "</span></span>); startActivityForResult(intent, Print_Words);</code> </pre><br>  Et ce qu'il retourne: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onActivityResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> requestCode, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> resultCode, Intent data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    : if (requestCode==Print_Words &amp;&amp; resultCode==RESULT_OK) { //     ,   : ArrayList&lt;String&gt;result=data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS); //     TextView: stroka_otveta = result.toString(); }</span></span></code> </pre><br>  Et il renvoie un tableau de mots similaires, et sous une forme plut√¥t "poubelle", avec toutes sortes de crochets et de virgules.  Et il vous suffit de choisir un mot similaire √† celui que vous avez dit.  Eh bien et en cons√©quence, si le mot ¬´en avant¬ª est pris, alors nous allons de l'avant, si ¬´√† droite¬ª, puis √† droite et ainsi de suite.  Bien s√ªr, nous devons prendre en compte o√π √† travers "E", o√π la virgule suppl√©mentaire est attach√©e (j'ai coup√© les crochets, mais je n'avais pas assez de force pour les virgules). <br><br><div class="spoiler">  <b class="spoiler_title">Au total, le texte de MainActivity.java lui-m√™me est devenu</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.MotionEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ImageButton; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.speech.RecognizerIntent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageButton mButtonUP; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> direction = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String stroka_otveta; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Print_Words = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView EnteredText1; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView EnteredText2; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> TextView EnteredText3; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> slovo_raspoznano =<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Udp_client(); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HTTP_client(<span class="hljs-number"><span class="hljs-number">40000</span></span>); EnteredText1 = (TextView) findViewById(R.id.textViewX); <span class="hljs-comment"><span class="hljs-comment">// EnteredText2 = (TextView) findViewById(R.id.textViewY); // EnteredText3 = (TextView) findViewById(R.id.textViewZ); // mButtonUP = (ImageButton) findViewById(R.id.imageButtonUP); mButtonUP.setOnTouchListener(new View.OnTouchListener() { @Override public boolean onTouch(View v, MotionEvent event) { if (event.getAction() == MotionEvent.ACTION_DOWN){ if(HTTP_client.ok){ // RecognizerIntent        : EnteredText3.setText(" http  "); Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH); intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM); intent.putExtra(RecognizerIntent.EXTRA_PROMPT, ", ,  -??? "); startActivityForResult(intent, Print_Words); } else { EnteredText3.setText("  "); } } if (event.getAction() == MotionEvent.ACTION_UP ){ } return false; } }); } @Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { //    : if (requestCode==Print_Words &amp;&amp; resultCode==RESULT_OK) { //     ,   : ArrayList&lt;String&gt;result=data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS); //     TextView: stroka_otveta = result.toString(); } StringBuffer sb = new StringBuffer(stroka_otveta); sb.deleteCharAt(stroka_otveta.length()-1); sb.deleteCharAt(0); stroka_otveta=sb.toString(); String[] words = stroka_otveta.split("\\s"); //        () //    for(int i = 0; i&lt; words.length;i++) { if(words[i].equals(",")||words[i].equals("")) { direction = 1; slovo_raspoznano=true; stroka_otveta=words[i]; } if(words[i].equals(",")||words[i].equals("")){ direction=2; slovo_raspoznano=true; stroka_otveta=words[i]; } if(words[i].equals(",")|| words[i].equals("")){ direction=4; slovo_raspoznano=true; stroka_otveta=words[i]; } if(words[i].equals(",")|| words[i].equals(",")|| words[i].equals("") || words[i].equals("")){ direction=3; slovo_raspoznano=true; stroka_otveta=words[i]; } if(words[i].equals(",")|| words[i].equals(",")|| words[i].equals("") || words[i].equals("")){ direction=100; slovo_raspoznano=true; stroka_otveta=words[i]; } } if(!slovo_raspoznano){ direction=100; stroka_otveta=" ,   ... "; } EnteredText1.setText(" "+direction+" " +stroka_otveta); slovo_raspoznano=false; super.onActivityResult(requestCode, resultCode, data); } }</span></span></code> </pre></div></div><br>  Eh bien, jusqu'√† la mise en page du tas avec un seul bouton <br><br><div class="spoiler">  <b class="spoiler_title">activity_main.xml.</b> <div class="spoiler_text"><pre> <code class="java hljs"> &lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>?&gt; &lt;android.support.constraint.ConstraintLayout xmlns:android=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span> xmlns:app=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span> xmlns:tools=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/tools"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> tools:context=<span class="hljs-string"><span class="hljs-string">"mikhail_akhmetov.fourwheelsrobotandroidvoice.MainActivity"</span></span>&gt; &lt;ImageButton android:id=<span class="hljs-string"><span class="hljs-string">"@+id/imageButtonUP"</span></span> style=<span class="hljs-string"><span class="hljs-string">"@android:style/Widget.ImageButton"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"160dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"146dp"</span></span> android:layout_marginTop=<span class="hljs-string"><span class="hljs-string">"8dp"</span></span> android:background=<span class="hljs-string"><span class="hljs-string">"@android:color/holo_orange_dark"</span></span> app:layout_constraintLeft_toLeftOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintRight_toRightOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintTop_toTopOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:srcCompat=<span class="hljs-string"><span class="hljs-string">"@android:drawable/arrow_up_float"</span></span> android:layout_marginBottom=<span class="hljs-string"><span class="hljs-string">"8dp"</span></span> app:layout_constraintBottom_toTopOf=<span class="hljs-string"><span class="hljs-string">"@+id/linearLayout"</span></span>/&gt; &lt;LinearLayout android:id=<span class="hljs-string"><span class="hljs-string">"@+id/linearLayout"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"368dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"227dp"</span></span> android:layout_marginBottom=<span class="hljs-string"><span class="hljs-string">"11dp"</span></span> android:layout_marginEnd=<span class="hljs-string"><span class="hljs-string">"8dp"</span></span> android:layout_marginLeft=<span class="hljs-string"><span class="hljs-string">"8dp"</span></span> android:layout_marginRight=<span class="hljs-string"><span class="hljs-string">"8dp"</span></span> android:layout_marginStart=<span class="hljs-string"><span class="hljs-string">"8dp"</span></span> android:orientation=<span class="hljs-string"><span class="hljs-string">"vertical"</span></span> android:weightSum=<span class="hljs-string"><span class="hljs-string">"1"</span></span> app:layout_constraintBottom_toBottomOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintHorizontal_bias=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> app:layout_constraintLeft_toLeftOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintRight_toRightOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span>&gt; &lt;TextView android:id=<span class="hljs-string"><span class="hljs-string">"@+id/textViewTitle"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:text=<span class="hljs-string"><span class="hljs-string">"   "</span></span> android:textColor=<span class="hljs-string"><span class="hljs-string">"@android:color/holo_red_dark"</span></span>/&gt; &lt;TextView android:id=<span class="hljs-string"><span class="hljs-string">"@+id/textViewX"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:layout_weight=<span class="hljs-string"><span class="hljs-string">"0.28"</span></span> /&gt; &lt;TextView android:id=<span class="hljs-string"><span class="hljs-string">"@+id/textViewY"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:layout_weight=<span class="hljs-string"><span class="hljs-string">"0.28"</span></span> /&gt; &lt;TextView android:id=<span class="hljs-string"><span class="hljs-string">"@+id/textViewZ"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:layout_weight=<span class="hljs-string"><span class="hljs-string">"0.23"</span></span> /&gt; &lt;/LinearLayout&gt; &lt;/android.support.constraint.ConstraintLayout&gt;</code> </pre></div></div><br>  La chose la plus √©tonnante est qu'elle monte vraiment et √©coute la voix (en r√®gle g√©n√©rale).  Mais, bien s√ªr, l'interface de freinage;  pendant que vous dites, jusqu'√† ce qu'il soit reconnu et revienne;  Bref, choisissez une petite vitesse √† l'avance ou la pi√®ce est inversement plus large. <br><br>  C'est tout pour aujourd'hui, je serai content si je l'ai aim√©. <br><br><img src="https://habrastorage.org/webt/0x/ah/jw/0xahjw5wdyqdmgwkwkwrqqf7kaa.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr409107/">https://habr.com/ru/post/fr409107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr409097/index.html">Les scientifiques peuvent d√©sormais inspirer des singes directement dans le cerveau</a></li>
<li><a href="../fr409099/index.html">Que donner pour la nouvelle ann√©e? Probl√®me 2017</a></li>
<li><a href="../fr409101/index.html">Moyens scientifiques pour surmonter la fatigue: nootropiques, caf√© et neurotechnologie</a></li>
<li><a href="../fr409103/index.html">Crispr Therapeutics planifie les premiers essais cliniques pour le traitement des maladies g√©n√©tiques</a></li>
<li><a href="../fr409105/index.html">Les plus grandes crypto-monnaies, leur r√©sultat et pourquoi NiceHash n'a pas vol√© √† la maison</a></li>
<li><a href="../fr409111/index.html">Logiciel d'√©mulation de r√©seau Modbus RTU</a></li>
<li><a href="../fr409113/index.html">Une bagatelle, mais agr√©able: une tasse qui r√©gule la temp√©rature de la boisson</a></li>
<li><a href="../fr409115/index.html">Bandes sonores de jeux cultes: peste, utopie et piolets</a></li>
<li><a href="../fr409119/index.html">Intel ‚ùÑ 2017. R√©sultats de l'ann√©e</a></li>
<li><a href="../fr409121/index.html">Qu'est-ce que c'est: le march√© russe des services de streaming</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>