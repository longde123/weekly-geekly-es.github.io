<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌴 🐓 🏌️ ESET hat neue Versionen des DanaBot-Trojaners entdeckt 📑 ◀️ 👳🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der schnell wachsende modulare DanaBot- Trojaner hat neue Änderungen erfahren. Die Ende Januar 2019 veröffentlichte Version implementiert ein völlig n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET hat neue Versionen des DanaBot-Trojaners entdeckt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/439588/"> Der schnell wachsende modulare <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DanaBot-</a> Trojaner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hat</a> neue Änderungen erfahren.  Die Ende Januar 2019 veröffentlichte Version implementiert ein völlig neues Kommunikationsprotokoll, das der Kommunikation zwischen dem Trojaner und seinem C &amp; C-Server mehrere Verschlüsselungsstufen hinzufügt.  Darüber hinaus wurden die DanaBot-Architektur und die Kampagnen-IDs geändert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2r/-x/j0/2r-xj085tr128-hi_nkl5xix_fk.jpeg"></div><a name="habracut"></a><br><h4>  DanaBot Evolution </h4><br>  Nachdem DanaBot im Mai 2018 im Rahmen einer Spam-Kampagne gegen Australien entdeckt wurde, trat sie bei einer Reihe anderer Angriffe auf, darunter bei einer Spam-Kampagne in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Polen, Italien, Deutschland, Österreich und der Ukraine</a> sowie in den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USA</a> .  In europäischen Kampagnen wurde die Funktionalität des Trojaners durch neue Plugins und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spam-Funktionen erweitert</a> . <br><br>  Am 25. Januar fanden wir ungewöhnliche ausführbare Dateien im Zusammenhang mit DanaBot in Telemetriedaten.  Eine weitere Überprüfung ergab, dass diese Binärdateien zwar Versionen von DanaBot sind, jedoch ein anderes Kommunikationsprotokoll für die Kommunikation mit dem C &amp; C-Server verwenden.  Seit dem 26. Januar haben die Betreiber des Trojaners das Zusammenstellen von Binärdateien mit dem alten Protokoll eingestellt. <br><br>  Zum Zeitpunkt des Schreibens wurde die neue Version von DanaBot in zwei Szenarien verteilt: <br><br><ol><li>  als "Updates" für DanaBot-Opfer; </li><li>  per Spam-Mail (in Polen). </li></ol><br><h4>  Neues Kommunikationsprotokoll </h4><br>  In dem Protokoll, das bis zum 25. Januar verwendet wurde, wurden die Pakete nicht verschlüsselt, wie in Abbildung 1 dargestellt. <br><br><img src="https://habrastorage.org/webt/b-/gk/hh/b-gkhhs8ao2zo0hc8f-gkegxw70.png"><br>  <i>Abbildung 1. Eine Paketerfassung, die das alte Protokoll mit Daten in unverschlüsselter Form zeigt</i> <br><br>  Nach Abschluss verwendet DanaBot AES- und RSA-Verschlüsselungsalgorithmen für die Kommunikation mit dem C &amp; C-Server.  Das neue Kommunikationsprotokoll ist komplexer, da es mehrere Verschlüsselungsstufen verwendet, wie in der folgenden Abbildung dargestellt. <br><br><img src="https://habrastorage.org/webt/yw/0g/p2/yw0gp28vvzyyhwda2docdtdlpsm.png"><br>  <i>Abbildung 2. Schema des neuen DanaBot-Kommunikationsprotokolls</i> <br><br>  Diese Änderungen vermeiden die Erkennung mithilfe vorhandener Netzwerksignaturen und erschweren das Schreiben neuer Regeln für Systeme zur Erkennung und Verhinderung von Eindringlingen.  Darüber hinaus ist es ohne Zugriff auf die entsprechenden RSA-Schlüssel nicht möglich, gesendete oder empfangene Pakete zu dekodieren.  Daher sind RSAP-Dateien von Cloud-basierten Analysesystemen (wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ANY.RUN</a> ) für die Forschung ungeeignet. <br><br><img src="https://habrastorage.org/webt/un/et/ax/unetaxozodao8hdqd4b7rknum8s.png"><br>  <i>Abbildung 3. Erfassen Sie ein Paket mit einem neuen Kommunikationsprotokoll</i> <br><br>  Jedes vom Client gesendete Paket hat einen 24 (0x18) -Byte-Header: <br><br><img src="https://habrastorage.org/webt/td/ey/gk/tdeygk9my0uhayelwswdqx_bvhg.png"><br><br>  Auf das Paket folgen für jedes Paket die von AES verschlüsselten Paketdaten, dann ein 4-Byte-Wert, der die Verschiebungsgröße des AES angibt, und anschließend der von RSA verschlüsselte AES-Schlüssel.  Alle Pakete werden mit unterschiedlichen AES-Schlüsseln verschlüsselt. <br><br>  Serverantworten verwenden dasselbe Format.  Im Gegensatz zu früheren Versionen entsprechen die Paketdaten in den Serverantworten (mit einigen Ausnahmen) keiner bestimmten Struktur. <br><br><h4>  Datenpaketstruktur </h4><br>  Die vorherige Paketdatenstruktur wurde von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Proofpoint</a> im Oktober 2018 ausführlich beschrieben.  In der neuesten Version von DanaBot wurde dieses Schema geringfügig geändert, wie in der folgenden Abbildung dargestellt. <br><br><img src="https://habrastorage.org/webt/hc/7c/y4/hc7cy4kstqughqsadg1vff-xdue.png"><br>  <i>Abbildung 4. Vergleich der Paketdatenstruktur in der alten und neuen Version von DanaBot</i> <br><br><h4>  Änderungen der DanaBot-Architektur </h4><br>  Zusätzlich zum Kommunikationsprotokoll hat DanaBot eine leicht veränderte Architektur.  Frühere Versionen des Trojaners enthielten eine Komponente, die das Hauptmodul heruntergeladen und ausgeführt hat.  Anschließend hat das Hauptmodul Plugins und Konfigurationen heruntergeladen und ausgeführt. <br><br>  In der neuesten Version werden diese Funktionen von einem neuen Bootloader ausgeführt, mit dem alle Plugins zusammen mit dem Hauptmodul heruntergeladen werden.  Die Persistenz wird durch die Registrierung der Bootloader-Komponente als Dienst sichergestellt. <br><br><img src="https://habrastorage.org/webt/c2/by/_p/c2by_pcvcbrnmqztjyxwlcgqps8.png"><br>  <i>Abbildung 5. Vergleich der Architektur der alten und neuen Version von DanaBot</i> <br><br><h4>  Teams </h4><br>  Entsprechend der Analyse verwendet die Ladekomponente die folgenden Befehle: <br><br><ul><li>  0x12C - Hallo.  Der erste Befehl, der vom Client an den Server gesendet wird </li><li>  0x12D - Laden Sie die 32/64-Bit-Startkomponente </li><li>  0x12E - Fordern Sie eine Liste der Plugins und Konfigurationsdateien an </li><li>  0x12F - Plugins / Konfigurationsdateien laden </li></ul><br>  Heruntergeladene Plugins und Konfigurationsdateien werden mit dem aus der Client-ID erhaltenen AES-Schlüssel verschlüsselt.  Darüber hinaus werden Plugins mithilfe der LZMA-Komprimierung im ZIP-Format archiviert, während Konfigurationsdateien mithilfe der zlib archiviert werden. <br>  Befehle mit der ID 0x130-0x134 werden vom Hauptmodul gesendet: <br><br><ul><li>  0x130 - Übertragen Sie die gesammelten Informationen auf einen C &amp; C-Server (z. B. einen Screenshot des Computers des Opfers; Systemdaten) </li><li>  0x131 - Übertragen Sie die gesammelten Informationen auf einen C &amp; C-Server (z. B. eine Liste der Dateien auf der Festplatte eines infizierten Computers). </li><li>  0x132 - Fordern Sie weitere Befehle vom C &amp; C-Server an.  Es gibt ungefähr 30 für Backdoors typische Befehle, darunter das Starten von Plugins, das Sammeln von Systeminformationen und das Ändern von Dateien im Client-System </li><li>  0x133 - Aktualisieren Sie die Liste der C &amp; C-Server über den Tor-Proxy </li><li>  0x134 - Das genaue Ziel ist unbekannt. Höchstwahrscheinlich wird es für die Kommunikation zwischen Plug-Ins und einem C &amp; C-Server verwendet </li></ul><br><h4>  Kampagnen-IDs ändern </h4><br>  Eine frühere Studie hat gezeigt, dass DanaBot unter verschiedenen IDs verteilt ist. <br><br>  In der vorherigen Version von DanaBot wurden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ungefähr 20 Kampagnen-</a> IDs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verwendet</a> .  In der neuesten Version haben sich die Bezeichner geringfügig geändert.  Ab dem 5. Februar 2019 beobachten wir die folgenden IDs: <br><br><ul><li>  ID = 2 anscheinend eine Testversion, die eine kleine Anzahl von Konfigurationsdateien ohne Web-Injects bereitstellt </li><li>  ID = 3 wird aktiv verteilt und richtet sich an Benutzer in Polen und Italien. Es liefert alle Konfigurationsdateien und Webinjektionen für polnische und italienische Zwecke </li><li>  ID = 5 dient Konfigurationsdateien für australische Zwecke </li><li>  ID = 7 gilt nur für Polen und dient Webinjektionen für polnische Zwecke </li><li>  ID = 9 ist anscheinend auch eine Testversion mit begrenzter Verbreitung und ohne spezielle Ausrichtung dient sie einer begrenzten Anzahl von Konfigurationsdateien ohne Web-Injects </li></ul><br><h4>  Schlussfolgerungen </h4><br>  Im Jahr 2018 haben wir die Entwicklung von DanaBot in Bezug auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vertrieb</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Funktionalität beobachtet</a> .  Anfang 2019 wurden dem Trojaner „interne“ Änderungen unterzogen, die auf die aktive Arbeit seiner Schöpfer hinweisen.  Jüngste Updates deuten darauf hin, dass die Entwickler von DanaBot Anstrengungen unternehmen, um eine Erkennung auf Netzwerkebene zu vermeiden.  Es ist möglich, dass die Autoren des Trojaners auf veröffentlichte Studien achten, um Änderungen am Code unverzüglich vorzunehmen, bevor Produktentwickler die Sicherheit gewährleisten. <br><br>  ESET-Produkte erkennen und blockieren alle DanaBot-Komponenten und -Plugins.  Erkennungsnamen werden im nächsten Abschnitt angegeben. <br><br><h4>  Kompromissindikatoren (IoCs) </h4><br>  <b>C &amp; C-Server, die von der neuen Version von DanaBot verwendet werden</b> <br><br> <code>84.54.37[.]102 <br> 89.144.25[.]243 <br> 89.144.25[.]104 <br> 178.209.51[.]211 <br> 185.92.222[.]238 <br> 192.71.249[.]51</code> <br> <br>  <b>Server für Web Injection und Redirect</b> <br><br> <code>47.74.249[.]106 <br> 95.179.227[.]160 <br> 185.158.249[.]144</code> <br> <br>  <b>Hash-Beispiele</b> <br><br>  Neue DanaBot-Builds werden regelmäßig veröffentlicht, sodass wir nur einen Teil der Hashes bereitstellen können: <br>  Dropper <code>98C70361EA611BA33EE3A79816A88B2500ED7844</code> Win32 / TrojanDropper.Danabot.O <br>  Bootloader (x86), ID = 3 <code>0DF17562844B7A0A0170C9830921C3442D59C73C</code> Win32 / Spy.Danabot.L <br>  Bootloader (x64), ID = 3 <code>B816E90E9B71C85539EA3BB897E4F234A0422F85</code> Win64 / Spy.Danabot.G <br>  Bootloader (x86), ID = 9 <code>5F085B19657D2511A89F3172B7887CE29FC70792</code> Win32 / Spy.Danabot.I <br>  Bootloader (x64), ID = 9 <code>4075375A08273E65C223116ECD2CEF903BA97B1E</code> Win64 / Spy.Danabot.F <br>  Hauptmodul (x86) <code>28139782562B0E4CAB7F7885ECA75DFCA5E1D570</code> Win32 / Spy.Danabot.K <br>  Hauptmodul (x64) <code>B1FF7285B49F36FE8D65E7B896FCCDB1618EAA4B</code> Win64 / Spy.Danabot.C <br><br>  <b>Plugins</b> <br><br>  RDPWrap <code>890B5473B419057F89802E0B6DA011B315F3EF94</code> Win32 / Spy.Danabot.H <br>  Stealer (x86) <code>E50A03D12DDAC6EA626718286650B9BB858B2E69</code> Win32 / Spy.Danabot.C <br>  Stealer (x64) <code>9B0EC454401023DF6D3D4903735301BA669AADD1</code> Win64 / Spy.Danabot.E <br>  Sniffer <code>DBFD8553C66275694FC4B32F9DF16ADEA74145E6</code> Win32 / Spy.Danabot.B <br>  VNC <code>E0880DCFCB1724790DFEB7DFE01A5D54B33D80B6</code> Win32 / Spy.Danabot.D <br>  TOR <code>73A5B0BEE8C9FB4703A206608ED277A06AA1E384</code> Win32 / Spy.Danabot.G </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439588/">https://habr.com/ru/post/de439588/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439576/index.html">Ein umfassender Überblick über Python-Interviews. Tipps & Tricks</a></li>
<li><a href="../de439578/index.html">Zur Frage der Transformationen und anderer Operationen</a></li>
<li><a href="../de439580/index.html">Git für Windows in ReactOS zum Laufen bringen</a></li>
<li><a href="../de439584/index.html">Lenergy-Projekt als Umdenken bei tragbaren Netzteilen</a></li>
<li><a href="../de439586/index.html">SPBm-Protokoll als Grundlage des Extreme Automated Campus</a></li>
<li><a href="../de439590/index.html">Quals: Saudi und Oman National Cyber ​​Security CTF 2019. WriteUp</a></li>
<li><a href="../de439592/index.html">Automatisierung ethischer Aktivitäten</a></li>
<li><a href="../de439594/index.html">Frühlingsanmerkungen: AOP Magic</a></li>
<li><a href="../de439596/index.html">Wie ich die Bildverarbeitung auf Android 15 Mal beschleunigt habe</a></li>
<li><a href="../de439598/index.html">Microsoft sprach über die Kosten für kostenpflichtigen Support für Windows 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>