<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïë üßó üîµ Security Week 09: vuln√©rabilit√© de 19 ans dans WinRAR üíê üë®üèº‚Äçüöí üè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous annon√ßons une semaine de bugs pr√©historiques. La vuln√©rabilit√© de l'archiveur WinRAR, d√©couverte et ferm√©e fin janvier, a √©t√© d√©crite en d√©tail p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Security Week 09: vuln√©rabilit√© de 19 ans dans WinRAR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/kaspersky/blog/441718/"><img src="https://habrastorage.org/webt/7b/wu/t9/7bwut9_r22f5g-aq_47-q6g2cpy.png" align="right">  Nous annon√ßons une semaine de bugs pr√©historiques.  La vuln√©rabilit√© de l'archiveur WinRAR, d√©couverte et ferm√©e fin janvier, a √©t√© d√©crite en d√©tail par les sp√©cialistes de Check Point Software ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">actualit√©s</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recherches</a> originales).  Dans le pire des cas, une violation vous permet de d√©compresser le fichier malveillant vers un emplacement arbitraire sur votre disque dur, par exemple, dans le r√©pertoire d'ex√©cution automatique de Windows. <br><br>  Cette vuln√©rabilit√© vous fait penser √† l'utilisation de biblioth√®ques tierces difficiles √† v√©rifier dans votre logiciel, mais pas seulement.  Aujourd'hui, nous parlerons bri√®vement du probl√®me lui-m√™me, de la d√©cision des d√©veloppeurs de WinRAR d'abandonner la biblioth√®que pour d√©compresser les archives au format ACE, et nous aborderons √©galement le sujet de la mise √† jour de WinRAR sur les ordinateurs des utilisateurs.  Regard vers l'avenir: bien que les nouvelles aient provoqu√© une r√©sonance s√©rieuse, il s'agit probablement d'une histoire de fin heureuse.  Mais la classe de vuln√©rabilit√©s associ√©e au traitement des archives arrivant sur votre ordinateur m√©rite une attention particuli√®re. <br><a name="habracut"></a><br>  Dans le rapport d'origine, avant de d√©montrer le probl√®me, il y a beaucoup de d√©tails (int√©ressants), mais regardons tout de suite le r√©sultat. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/R2qcBWJzHMo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  L'archive pr√©par√©e est enregistr√©e sur le bureau, l'utilisateur essaie de la d√©compresser, mais √† la place, le fichier ex√©cutable est √©crit dans le r√©pertoire d'ex√©cution automatique.  Comment est-ce arriv√©?  Les chercheurs ont utilis√© la technologie de fuzzing, √† savoir le package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WinAFL</a> , pris en charge par l'√©quipe de Google Project Zero et qui est la version Windows de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la boucle floue am√©ricaine</a> .  Comme d'autres outils similaires, WinAFL vous permet d'examiner la s√©curit√© (ou la stabilit√©) des logiciels en transmettant des donn√©es al√©atoires (ou pas tout √† fait) √† l'application et en pr√©servant la r√©action.  Les fuzzers peuvent √™tre consid√©r√©s comme une sorte de "baguette magique" d'un chercheur en s√©curit√©.  Ils aident √† d√©tecter divers plantages de programmes l√† o√π ils ne devraient pas se trouver. <br><br>  Cependant, un rapport Check Point montre que les choses ne sont pas si simples.  La recherche de WinAAR avec WinAFL a permis d'identifier plusieurs plantages inattendus de l'application et a conduit les chercheurs vers une biblioth√®que qui traite les archives au format ACE - une norme d'archivage propri√©taire.  Cette biblioth√®que (unacev2.dll) a √©t√© mise √† jour pour la derni√®re fois en 2006 et ne disposait pas de m√©canismes de protection standard (tels que ASLR ou DEP).  De plus, elle √©tait pr√©sente dans toutes les versions de WinRAR au cours des 19 derni√®res ann√©es et, comme il s'est av√©r√© plus tard, tout ce temps √©tait vuln√©rable.  Au moment o√π le bogue a √©t√© d√©couvert, les d√©veloppeurs de WinRAR n'avaient pas acc√®s √† son code source.  ACE √©tait g√©n√©ralement un archiveur commercial √† un moment donn√©, la biblioth√®que de d√©ballage √©tait gratuite, mais vous ne pouviez l√©galement cr√©er des archives dans ce format qu'en utilisant l'utilitaire propri√©taire WinACE (il a √©t√© mis √† jour jusqu'en 2007, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web du programme</a> existait jusqu'en 2017; et maintenant c'est clairement un logiciel abandonn√© ) <br><br>  Pour trouver une vuln√©rabilit√© simple comme Path Traversal, lorsque l'archiveur d√©compresse le fichier dans un r√©pertoire arbitraire, cela ne fonctionnait pas, j'ai d√ª reconstituer un utilitaire de fuzzing, mais cette fois apr√®s avoir √©tudi√© les fonctionnalit√©s de format en utilisant √† la fois le programme WinACE original et le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code</a> distribu√© gratuitement pour le d√©compresser vers Python.  Lors du prochain voyage pour des probl√®mes al√©atoires, les chercheurs ont trouv√© un fichier qui n'√©tait pas enregistr√© du tout o√π WinAFL √©tait cens√© enregistrer le r√©sultat de l'ex√©cution de la biblioth√®que. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/lb/ru/nslbru7z9sfx4ptvh0pifohy0zc.png"></div><br><br>  Le fait est que l'archiveur ACE vous permet d'enregistrer le chemin d'acc√®s complet au fichier compress√©.  Dans une situation normale, ce chemin est ajout√© au chemin de d√©compression s√©lectionn√© lors de la d√©compression.  Lors du fuzzing, il s'est av√©r√© que certains ensembles de donn√©es permettaient de rendre le chemin absolu, c'est-√†-dire de d√©compresser le fichier non pas l√† o√π l'utilisateur l'a indiqu√©, mais n'importe o√π, mais ce n'est pas tr√®s bon.  De plus, cela semble √™tre simple - vous devez appliquer la m√™me astuce lorsque vous ne travaillez pas directement avec la biblioth√®que, mais avec WinRAR lui-m√™me, non?  Pas vraiment: la vuln√©rabilit√© n'a pas √©t√© reproduite.  Je ne raconterai pas tout l'historique de la recherche de la bonne combinaison de param√®tres et de contourner une autre √©tape de validation dans WinRAR lui-m√™me: le programme v√©rifie et supprime le crime du chemin de sauvegarde afin d'√©viter de telles situations.  Mais il v√©rifie, comme il s'est av√©r√©, toutes les options possibles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cx/bj/fo/cxbjfoyha7a0ehhxvlmctekcopc.png"></div><br><br>  Voil√† ce qui s'est pass√©.  Il s'agit d'une capture d'√©cran de l'analyse d'une archive ¬´pr√©par√©e¬ª √† l'aide du code Python mentionn√© ci-dessus.  Le double c: \\ au d√©but du chemin est trait√© par la biblioth√®que unacev2 et WinRAR lui-m√™me afin que le fichier soit √©crit dans un r√©pertoire arbitraire.  Cela semble √™tre un exploit pr√™t?  Encore une fois non, ou plut√¥t pas vraiment.  Toute tentative d'√©criture de l'ex√©cutable dans le r√©pertoire d'ex√©cution automatique dans cette configuration d√©clenchera la protection de Windows.  Mais les chercheurs ont r√©ussi √† trouver un moyen de contourner cette limitation si le fichier est enregistr√© dans le r√©pertoire de l'utilisateur, par exemple, dans le dossier T√©l√©chargements ou sur le bureau (ce qui est fort probable).  Comme indiqu√© dans la vid√©o au d√©but, le fichier pr√©par√© a √©t√© enregistr√© dans le r√©pertoire de lancement automatique de l'utilisateur en naviguant vers un dossier plus haut dans le chemin du fichier. <br><br>  Quel est le r√©sultat?  Dans WinRAR 5.70 Beta 1, la vuln√©rabilit√© a √©t√© corrig√©e en abandonnant compl√®tement l'utilisation d'une biblioth√®que obsol√®te pour travailler avec les fichiers ACE.  Il est peu probable que quiconque en soit s√©rieusement contrari√©.  Soit dit en passant, les conseils donn√©s dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> sur le site Web de ZDNet - ¬´N'ouvrez pas d'archives suspectes au format ACE¬ª - sont un peu faux.  WinRAR ne d√©tecte pas les fichiers par permission, et l'exploit fonctionnera avec une version vuln√©rable du programme, m√™me si l'archive ACE pr√©par√©e a l'extension RAR (ou toute autre).  N'ouvrez pas d'archives suspectes - c'est bien, mais il faut g√©n√©ralement les mettre √† jour. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1052984615139340288"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><br>  Maintenant, prenez votre esprit hors du poste pendant une minute et voyez quelle version de WinRAR vous avez install√©e (sauf, bien s√ªr, si vous utilisez cet archiveur).  Pour r√©f√©rence: la version 5.50 est sortie en 2017, 5.00 - en 2012, 3.90 - en 2009.  Avec une certaine probabilit√©, la date de sortie de WinRAR correspondra approximativement √† la date de configuration initiale du syst√®me, car il n'y a toujours pas de fonction de mise √† jour automatique dans ce programme.  Comme vous pouvez le voir sur le tweet de la soci√©t√© de courtage de vuln√©rabilit√© Zerodium, il existe une demande d'exploits de travail dans les archiveurs.  Des vuln√©rabilit√©s telles que celles trouv√©es dans la biblioth√®que des archives ACE peuvent √™tre utilis√©es pour des attaques massives ou cibl√©es contre les ordinateurs des victimes.  Il convient de noter que les chances de succ√®s d'un tel bug sont loin d'√™tre absolues.  Il est fort probable que l'archive infect√©e sera bloqu√©e par le service de messagerie (par exemple, pour GMail, par exemple, les archives prot√©g√©es par mot de passe et les archives contenant des fichiers ex√©cutables √† l'int√©rieur n'y sont pas ignor√©es) ou par un logiciel antivirus.  √Ä moins, bien s√ªr, que vous ne l'ayez. <br><br>  N√©anmoins, tous ces rappels ennuyeux de la n√©cessit√© de mettre √† jour l'une des dizaines de programmes install√©s sur l'ordinateur ont du sens.  Sinon, il est facile de passer √† c√¥t√© d'une vuln√©rabilit√© grave qui fonctionnera au moment le plus inopportun.  En toute honn√™tet√©, nous notons que de graves probl√®mes dans WinRAR <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apparaissent</a> rarement. <br><br>  <i>Avis de non-responsabilit√©: les opinions exprim√©es dans ce recueil ne co√Øncident pas toujours avec la position officielle de Kaspersky Lab.</i>  <i>Chers r√©dacteurs recommandent g√©n√©ralement de traiter toute opinion avec un scepticisme sain.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr441718/">https://habr.com/ru/post/fr441718/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr441708/index.html">API du contrat WG: zoo des services</a></li>
<li><a href="../fr441710/index.html">Les jeux mobiles par navigateur vous d√©fient</a></li>
<li><a href="../fr441712/index.html">Solution math√©matique aux probl√®mes de relativit√©</a></li>
<li><a href="../fr441714/index.html">Comment les locomotives √† vapeur ont-elles √©t√© dispos√©es?</a></li>
<li><a href="../fr441716/index.html">Programmation pour les non-programmeurs. Biographie de juin</a></li>
<li><a href="../fr441720/index.html">Chatbot pour Vkontakte sur ASP.NET Core C #</a></li>
<li><a href="../fr441722/index.html">Automatisez la transition vers React Hooks</a></li>
<li><a href="../fr441724/index.html">La valorisation du march√© des crypto-monnaies atteindra 1 billion de dollars cette ann√©e -Pr√©dictions de crypto-monnaie 2019</a></li>
<li><a href="../fr441726/index.html">Kubespray-as-a-Service - ajoutez Kubernetes √† n'importe quel cloud</a></li>
<li><a href="../fr441728/index.html">R√©sum√© du concours en ligne pour le jeu Blotto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>