<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ค๐ฝ ๐คฉ ุฃููุงู ูู ุจูุณุชุฌุฑุณ: 3. ุฃููุงู ูุงุฆูุงุช ุฃุฎุฑู โ๏ธ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ุชุญุฏุซูุง ุจุงููุนู ุนู ุจุนุถ ุงูุฃููุงู ุนูู ูุณุชูู ุงููุงุฆู (ุนูู ูุฌู ุงูุฎุตูุต ุ ุนู ุงูุฃููุงู ุนูู ุงูุนูุงูุงุช) ุ ููุฐูู ุญูู ุงูุฃููุงู ุนูู ูุณุชูู ุงูุตู ุ ูุนูุงูุชูุง ุจุฃููุงู ุงููุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฃููุงู ูู ุจูุณุชุฌุฑุณ: 3. ุฃููุงู ูุงุฆูุงุช ุฃุฎุฑู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/465263/" style=";text-align:right;direction:rtl">  ููุฏ ุชุญุฏุซูุง ุจุงููุนู ุนู ุจุนุถ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃููุงู ุนูู ูุณุชูู ุงููุงุฆู</a> (ุนูู ูุฌู ุงูุฎุตูุต ุ ุนู ุงูุฃููุงู ุนูู ุงูุนูุงูุงุช) ุ ููุฐูู ุญูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃููุงู ุนูู ูุณุชูู ุงูุตู</a> ุ ูุนูุงูุชูุง ุจุฃููุงู ุงููุงุฆูุงุช ูุทุงุจูุฑ ุงูุงูุชุธุงุฑ ุ ููู ุฃูุฑ ุบูุฑ ุตุงุฏู ุฏุงุฆููุง. <br><br>  ุงูููู ูุฏููุง hodgepodge.  ููุจุฏุฃ ูุน ุญุงูุฉ <strong>ุชููู ุชุงู</strong> (ูู ุงููุงูุน ุ ููุช ุฃุชุญุฏุซ ุนููุง ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ ุ ููู ูุฐู ุงูููุงูุฉ ุชุญููุช ุฅูู ูุชุฑุฉ ุบูุฑ ูุงุฆูุฉ) ุ ุซู <strong>ุณูุชุฌุงูุฒ ุฃููุงู ุงููุงุฆูุงุช</strong> ุงููุชุจููุฉ ููุชุญุฏุซ ุนู <strong>ุฃููุงู ุงููุณูุฏ</strong> ูู ุงูุฎุชุงู. <br><br><h1 style=";text-align:right;direction:rtl">  ุงููุขุฒู </h1><br>  ุนูุฏ ุงุณุชุฎุฏุงู ุงูุฃููุงู ุ ูููู <em>ุงููููู ูู</em> ุญุงูุฉ <em>ุชููู ุชุงู</em> (ุฃู ุญุงูุฉ <em>ุชููู ุชุงู</em> ) ูููููุง.  ูุญุฏุซ ุฐูู ุนูุฏูุง ุชุญุงูู ุฅุญุฏู ุงููุนุงููุงุช ุงูุชูุงุท ููุฑุฏ ุชู ุงูุชูุงุทู ุจุงููุนู ุจูุงุณุทุฉ ูุนุงููุฉ ุฃุฎุฑู ุ ุจูููุง ุชุญุงูู ูุนุงููุฉ ุฃุฎุฑู ุงูุชูุงุท ููุฑุฏ ุชู ุงูุชูุงุทู ุจูุงุณุทุฉ ุงูุฃูู.  ูุชู ุชูุถูุญ ุฐูู ูู ุงูุดูู ุงูุฃูุณุฑ ุฃุฏูุงู: ุฅุธูุงุฑ ุงูุฃุณูู ุงูุตูุจุฉ ุงูููุงุฑุฏ ุงูููุชูุทุฉ ุ ุจูููุง ุชุธูุฑ ุงูุฃุณูู ุงููุชูุทุนุฉ ูุญุงููุงุช ูุงูุชูุงุท ููุฑุฏ ูุดุบูู ุจุงููุนู. <br><br>  ุฃููุง ูุฑูุญุฉ ูุชุตูุฑ ุญุงูุฉ ุชููู ุชุงู ูู ุฎูุงู ุจูุงุก ุฑุณู ุจูุงูู ููุชููุนุงุช.  ููููุงู ุจุฐูู ุ ูุฒูู ููุงุฑุฏ ูุญุฏุฏุฉ ููุชุฑู ุงููุนุงููุงุช ููุท ุ ูุน ุงูุฅุดุงุฑุฉ ุฅูู ุงููุนุงููุฉ ุงูุชู ุชูุชุธุฑ.  ุฅุฐุง ูุงู ุงูุฑุณู ุงูุจูุงูู ูุญุชูู ุนูู ูุญูุท (ูู ุงูุฃุนูู ููููู ุงููุตูู ุฅููู ูู ุฎูุงู ุงูุฃุณูู) - ููุฐุง ุทุฑูู ูุณุฏูุฏ. <br><br><img src="https://habrastorage.org/webt/-b/rg/yr/-brgyrpjzf-xgudc27jgtyzr6d4.png"><br><a name="habracut"></a><br>  ุจุงูุทุจุน ุ ุงูุฌููุฏ ูููู ููุณ ููุท ูููุนุงููุงุช ุ ูููู ุฃูุถูุง ูุฃู ุนุฏุฏ ุฃูุจุฑ. <br><br>  ูู ุญุงูุฉ ุญุฏูุซ ุญุงูุฉ ุชููู ุชุงู ุ ูุฅู ุงููุนุงููุงุช ุงูุชู ุชูุทูู ุนูููุง ูุง ูููู ุฃู ุชูุนู ุฃู ุดูุก ุญูุงู ุฐูู - ููู ุณุชูุชุธุฑ ุฅูู ุฃุฌู ุบูุฑ ูุณูู.  ูุฐูู ุ ุชููู ุฌููุน ูุธู ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช (DBMS) ู PostgreSQL ุ ุฃูุถูุง ุ ุจุชุชุจุน ุญุงูุฉ ุชููู ุชุงู ุชููุงุฆููุง. <br><br>  ููุน ุฐูู ุ ูุชุทูุจ ุงูุชุญูู ุฌููุฏูุง ูุนููุฉ ุ ูุง ุฃุฑูุฏ ุงูููุงู ุจูุง ุนูุฏ ุทูุจ ููู ุฌุฏูุฏ (ุจุนุฏ ูู ุดูุก ุ ุญุงูุงุช ุงูุชููู ุงูุชุงู ูุงุฏุฑุฉ ุฌุฏูุง).  ูุฐูู ุ ุนูุฏูุง ุชุญุงูู ุงูุนูููุฉ ุงูุชูุงุท ุงูููู ููุง ูููู ุ ุชุฏุฎู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุชุบูู ุ ููููุง ุชุจุฏุฃ ุงููููุช ุจุงููููุฉ ุงููุญุฏุฏุฉ ูู ุงููุนููุฉ <em>deadlock_timeout</em> (ุงูุชุฑุงุถููุง - ุซุงููุฉ ูุงุญุฏุฉ).  ุฅุฐุง ุชู ุชุญุฑูุฑ ุงูููุฑุฏ ูู ููุช ุณุงุจู ุ ูุญููุฆุฐู ุ ูููุง ุจุญูุธู ุนูุฏ ุงูุชุญูู.  ูููู ุฅุฐุง ุงุณุชูุฑุช <em>ูุชุฑุฉ</em> ุงูุงูุชุธุงุฑ ุจุนุฏ <em>deadlock_timeout</em> ุ ูุณูุชู ุฅููุงุธ ุนูููุฉ ุงูุงูุชุธุงุฑ ูุจุฏุก ุงูุชุญูู. <br><br>  ุฅุฐุง ูู ููุดู ุงูุดูู (ุงูุฐู ูุชููู ูู ุจูุงุก ุฑุณู ุจูุงูู ููุชููุนุงุช ูุงูุจุญุซ ุนู ููุงูุญ ููู) ุนู ุทุฑูู ูุณุฏูุฏ ุ ูุฅู ุงูุนูููุฉ ุชุณุชูุฑ ูู ุงูููู - ุงูุขู ุจุงููุนู ุฅูู ุงูููุงูุฉ ุงููุฑูุฑุฉ. <br><br><blockquote style=";text-align:right;direction:rtl">  ูู ููุช ุณุงุจู ูู ุงูุชุนูููุงุช ุ ุชูููุช ุงูููู ุนู ุญู ูุฃูู ูู <em>ููู</em> ุฃู ุดูุก ุนู ูุนููุฉ <em>lock_timeout</em> ุ ูุงูุชู ุชุนูู ุนูู ุฃู ูุดุบู ูุชุชุฌูุจ ุงูุชุธุงุฑูุง ุทููููุง ุฅูู ุฃุฌู ุบูุฑ ูุณูู: ุฅุฐุง ุชุนุฐุฑ ุงูุญุตูู ุนูู ุงูููู ูู ุงูููุช ุงููุญุฏุฏ ุ ููุชูู ุงูุจูุงู ุจุงูุฎุทุฃ lock_not_available.  ูุง ููุจุบู ุงูุฎูุท ุจููู ูุจูู ุงููุนููุฉ <em>statement_timeout</em> ุ ุงูุชู ุชุญุฏ ูู ุฅุฌูุงูู ููุช ุชูููุฐ ุงูุจูุงู ุ ุจุบุถ ุงููุธุฑ ุนูุง ุฅุฐุง ูุงูุช ุชุชููุน ุงูููู ุฃู ุฃู ุงููููุฉ ููุท. <br></blockquote><br>  ุฅุฐุง ุชู ุงูุชุดุงู ุญุงูุฉ ุชููู ุชุงู ุ ูุณูุชู ุฅููุงุก ุฅุญุฏู ุงููุนุงููุงุช (ูู ูุนุธู ุงูุญุงูุงุช ุ ุชูู ุงูุชู ุจุฏุฃุช ุงูุชุญูู) ุจุงูููุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุฅุตุฏุงุฑ ุงูุฃููุงู ุงูุชู ุชู ุงูุชูุงุทูุง ุจูุง ููููู ุฃู ุชุณุชูุฑ ุงููุนุงููุงุช ุงููุชุจููุฉ ูู ุงูุนูู. <br><br>  ุงูุฌููุฏ ุนุงุฏุฉ ูุง ูุนูู ุฃู ุงูุชุทุจูู ุบูุฑ ูุตูู ุจุดูู ุตุญูุญ.  ููุงู ุทุฑููุชุงู ูุงูุชุดุงู ูุซู ูุฐู ุงูุญุงูุงุช: ุฃููุงู ุ ุณุชุธูุฑ ุงูุฑุณุงุฆู ูู ุณุฌู ุงูุฎุงุฏู ุ ูุซุงููุงู ุ ุณุชุฒุฏุงุฏ ูููุฉ pg_stat_database.deadlocks. <br><br><h2 style=";text-align:right;direction:rtl">  ูุซุงู ุญุงูุฉ ุชููู ุชุงู </h2><br>  ุณุจุจ ุดุงุฆุน deadlocks ูู ุชุฑุชูุจ ูุฎุชูู ูุชู ุชุฃููู ุงูุตููู ูู ุงูุฌุฏุงูู. <br>  ูุซุงู ุจุณูุท.  ุชุนุชุฒู ุงูุตููุฉ ุงูุฃููู ููู 100 ุฑูุจู ูู ุงูุญุณุงุจ ุงูุฃูู ุฅูู ุงูุซุงูู.  ููููุงู ุจุฐูู ุ ุชููู ุฃููุงู ูู ุงูุนุฏุฏ ุงูุฃูู: <br><br><pre style=";text-align:right;direction:rtl"><code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = amount - <span class="hljs-number"><span class="hljs-number">100.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> acc_no = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">UPDATE 1</code> </pre><br>  ูู ุงูููุช ููุณู ุ ุชุนุชุฒู ุงูุตููุฉ ุงูุซุงููุฉ ููู 10 ุฑูุจู ูู ุงูุญุณุงุจ ุงูุซุงูู ุฅูู ุงูุฃูู.  ุงููุง ุชุจุฏุฃ ูู ุฎูุงู ุงูุญุฏ ูู ุงูุนุฏ ุงูุซุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = amount - <span class="hljs-number"><span class="hljs-number">10.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> acc_no = <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| UPDATE 1</code> </pre><br>  ุงูุขู ุชุญุงูู ุงููุนุงููุฉ ุงูุฃููู ุฒูุงุฏุฉ ุงูุญุณุงุจ ุงูุซุงูู ุ ููููุง ุชุฑู ุฃู ุงูุตู ูุบูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = amount + <span class="hljs-number"><span class="hljs-number">100.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> acc_no = <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre><br>  ุซู ุชุญุงูู ุงููุนุงููุฉ ุงูุซุงููุฉ ุฒูุงุฏุฉ ุงูุญุณุงุจ ุงูุฃูู ุ ูููู ูุชู ุญุธุฑู ุฃูุถูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = amount + <span class="hljs-number"><span class="hljs-number">10.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> acc_no = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br>  ููุงู ุชููุนุงุช ุฏูุฑูุฉ ูู ุชูุชูู ูู ุชููุงุก ููุณูุง.  ุจุนุฏ ุซุงููุฉ ุ ุชุจุฏุฃ ุงููุนุงููุฉ ุงูุฃููู ุ ุงูุชู ูุง ุชููู ุฅููุงููุฉ ุงููุตูู ุฅูู ุงูููุฑุฏ ุ ูู ูุญุต ุญุงูุฉ ุชููู ุชุงู ูุชููุทุน ุนู ุงูุฎุงุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">ERROR: deadlock detected DETAIL: Process 16477 waits for ShareLock on transaction 530695; blocked by process 16513. Process 16513 waits for ShareLock on transaction 530694; blocked by process 16477. HINT: See server log for query details. CONTEXT: while updating tuple (0,2) in relation "accounts"</code> </pre><br>  ุงูุขู ูููู ุฃู ุชุณุชูุฑ ุงูุตููุฉ ุงูุซุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| UPDATE 1</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br>  ุงูุทุฑููุฉ ุงูุตุญูุญุฉ ูุชูููุฐ ูุซู ูุฐู ุงูุนูููุงุช ูู ุญุธุฑ ุงูููุงุฑุฏ ุจููุณ ุงูุชุฑุชูุจ.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ููููู ุญุธุฑ ุงูุญุณุงุจุงุช ุจุชุฑุชูุจ ุชุตุงุนุฏู ูุฃุฑูุงููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุญุงูุฉ ุชููู ุชุงู ูุงุซููู ูู ุฃูุงูุฑ ุงูุชุญุฏูุซ </h2><br>  ูู ุจุนุถ ุงูุฃุญูุงู ููููู ุงูุญุตูู ุนูู ุทุฑูู ูุณุฏูุฏ ุญูุซ ุ ุนูู ูุง ูุจุฏู ุ ูุง ููุจุบู ุฃู ูููู.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงููุฑูุญ ูุงููุฃููู ุฅุฏุฑุงู ุฃูุงูุฑ SQL ุนูู ุฃููุง ุฐุฑูุฉ ุ ูููู ุชุฃุฎุฐ UPDATE - ุตููู ูุชู ุงูุฃูุงูุฑ ูุฐู ูุชู ุชุญุฏูุซูุง.  ูุฐุง ูุง ูุญุฏุซ ูู ููุช ูุงุญุฏ.  ูุฐูู ุ ุฅุฐุง ูุงู ุฃุญุฏ ุงูุฃูุงูุฑ ุจุชุญุฏูุซ ุงูุตููู ูู ุชุฑุชูุจ ูุงุญุฏ ูุงูุขุฎุฑ ูู ุฃูุฑ ุขุฎุฑ ุ ููุฏ ูููู ุงูุทุฑูู ูุณุฏูุฏูุง. <br><br>  ูู ุบูุฑ ุงููุฑุฌุญ ุฃู ุชุญุตู ุนูู ูุซู ูุฐุง ุงููููู ุ ููู ูุน ุฐูู ูููู ุฃู ูุฌุชูุน.  ููุชุดุบูู ุ ุณููุดุฆ ููุฑุณูุง ูู ุนููุฏ ุงููุจูุบ ุ ูุจูููุง ุจุชุฑุชูุจ ุชูุงุฒูู ูููุจูุบ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> accounts(amount <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>);</code> </pre><br>  ูู ุฃุฌู ุงูุญุตูู ุนูู ุงูููุช ููุนุฑูุฉ ูุง ูุญุฏุซ ุ ุณููุชุจ ูุธููุฉ ุชุฒูุฏ ูู ุงููููุฉ ุงููุฑุณูุฉ ุ ูููู ุจุจุทุก ุ ุจุจุทุก ุ ููุชุฑุฉ ุซุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> inc_slow(n <span class="hljs-type"><span class="hljs-type">numeric</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> $$<span class="pgsql"><span class="pgsql"> </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">SELECT</span></span></span><span class="pgsql"> pg_sleep(</span><span class="hljs-number"><span class="pgsql"><span class="hljs-number">1</span></span></span><span class="pgsql">); </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">SELECT</span></span></span><span class="pgsql"> n + </span><span class="hljs-number"><span class="pgsql"><span class="hljs-number">100.00</span></span></span><span class="pgsql">; $$</span><span class="undefined"></span></span><span class="pgsql"><span class="undefined"></span></span> <span class="hljs-keyword"><span class="hljs-keyword">LANGUAGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span>;</code> </pre><br>  ูุญู ุจุญุงุฌุฉ ุฃูุถุง ุฅูู ุชูุฏูุฏ pgrowlocks. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXTENSION</span></span> pgrowlocks;</code> </pre><br>  ุณูููู ุงูุฃูุฑ UPDATE ุงูุฃูู ุจุชุญุฏูุซ ุงูุฌุฏูู ุจุฃูููู.  ุฎุทุฉ ุงูุชูููุฐ ูุงุถุญุฉ - ูุญุต ุชุณูุณูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) | <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = inc_slow(amount);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| QUERY PLAN | ---------------------------- | Update on accounts | -&gt; Seq Scan on accounts | (2 rows)</code> </pre><br>  ูุธุฑูุง ูุฃู ุฅุตุฏุงุฑุงุช ุงูุตููู ุนูู ุตูุญุฉ ุฌุฏูููุง ูู ุจุงูุชุฑุชูุจ ุงููุชุฒุงูุฏ ูููุฌููุน (ุชูุงููุง ููุง ุฃุถููุงูุง) ุ ุณูุชู ุชุญุฏูุซูุง ุจููุณ ุงูุชุฑุชูุจ.  ูุจุฏุฃ ุงูุชุญุฏูุซ ููุนูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = inc_slow(amount);</code> </pre><br>  ููู ุงูููุช ููุณู ุ ูู ุฌูุณุฉ ุฃุฎุฑู ุ ุณูุญุธุฑ ุงุณุชุฎุฏุงู ุงููุณุญ ุงูุชุณูุณูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> enable_seqscan = <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>;</code> </pre><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ููุฑุฑ ุงููุฌุฏูู ุงุณุชุฎุฏุงู ุชูุญุต ุงูููุฑุณ ูุจูุงู UPDATE ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) || <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = inc_slow(amount) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> amount &gt; <span class="hljs-number"><span class="hljs-number">100.00</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| QUERY PLAN || -------------------------------------------------------- || Update on accounts || -&gt; Index Scan using accounts_amount_idx on accounts || Index Cond: (amount &gt; 100.00) || (3 rows)</code> </pre><br>  ููุน ุงูุตููู ุงูุซุงูู ูุงูุซุงูุซ ุชุญุช ุงูุดุฑุท ุ ูุจูุง ุฃู ุงูููุฑุณ ูุจูู ุจุชุฑุชูุจ ุชูุงุฒูู ุ ุณูุชู ุชุญุฏูุซ ุงูุตููู ุจุงูุชุฑุชูุจ ุงูุนูุณู. <br><br>  ูุทูู ุงูุชุญุฏูุซ ุงููุงุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = inc_slow(amount) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> amount &gt; <span class="hljs-number"><span class="hljs-number">100.00</span></span>;</code> </pre><br>  ุชูุถุญ ุงููุธุฑุฉ ุงูุณุฑูุนุฉ ุนูู ุงูุตูุญุฉ ุงููุฌุฏููุฉ ุฃู ุงููุดุบู ุงูุฃูู ูุฏ ุชููู ุจุงููุนู ูู ุชุญุฏูุซ ุงูุตู ุงูุฃูู (0ุ1) ูุงูุซุงูู - ุงูุฃุฎูุฑ (0ุ3): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pgrowlocks(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>) \gx</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-[ RECORD 1 ]----------------- locked_row | (0,1) locker | 530699 &lt;-  multi | f xids | {530699} modes | {"No Key Update"} pids | {16513} -[ RECORD 2 ]----------------- locked_row | (0,3) locker | 530700 &lt;-  multi | f xids | {530700} modes | {"No Key Update"} pids | {16549}</code> </pre><br>  ููุฑ ุซุงููุฉ ุฃุฎุฑู.  ูุงู ุงููุดุบู ุงูุฃูู ุจุชุญุฏูุซ ุงูุณุทุฑ ุงูุซุงูู ุ ูุงูุซุงูู ููุฏ ุงูููุงู ุจุฐูู ุ ููู ูุง ููููู ุฐูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pgrowlocks(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>) \gx</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-[ RECORD 1 ]----------------- locked_row | (0,1) locker | 530699 &lt;-  multi | f xids | {530699} modes | {"No Key Update"} pids | {16513} -[ RECORD 2 ]----------------- locked_row | (0,2) locker | 530699 &lt;-    multi | f xids | {530699} modes | {"No Key Update"} pids | {16513} -[ RECORD 3 ]----------------- locked_row | (0,3) locker | 530700 &lt;-  multi | f xids | {530700} modes | {"No Key Update"} pids | {16549}</code> </pre><br>  ุงูุขู ููุฏ ุงูุจูุงู ุงูุฃูู ุชุญุฏูุซ ุงูุตู ุงูุฃุฎูุฑ ูู ุงูุฌุฏูู ุ ูููู ูุบูู ุจุงููุนู ุจุงูุตู ุงูุซุงูู.  ููุง ูู ุงูุฌููุฏ. <br><br>  ุชู ุฅุญุจุงุท ุฅุญุฏู ุงููุนุงููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| ERROR: deadlock detected || DETAIL: Process 16549 waits for ShareLock on transaction 530699; blocked by process 16513. || Process 16513 waits for ShareLock on transaction 530700; blocked by process 16549. || HINT: See server log for query details. || CONTEXT: while updating tuple (0,2) in relation "accounts"</code> </pre><br>  ูุงูุขุฎุฑ ูููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| UPDATE 3</code> </pre><br><blockquote style=";text-align:right;direction:rtl">  ูููู ุงูุนุซูุฑ ุนูู ุชูุงุตูู ูุซูุฑุฉ ููุงูุชูุงู ุญูู ุงููุดู ุนู ุญุงูุฉ ุชููู ุชุงู ูููุนูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฏูุฑ ููู README</a> . <br></blockquote><br>  ูุฐุง ูู ุดูุก ุนู ุญุงูุฉ ุชููู ุชุงู ุ ููุญู ููุชูู ุฅูู ุฃููุงู ุงููุงุฆูุงุช ุงููุชุจููุฉ. <br><br><img src="https://habrastorage.org/webt/wb/wm/ho/wbwmhoocvz64odsj3qqooqup9jw.png"><br><br><h1 style=";text-align:right;direction:rtl">  ุฃููุงู ุบูุฑ ุนูุงูุฉ </h1><br>  ุนูุฏูุง ุชุฑูุฏ ุชุฃููู ููุฑุฏ ููุณ <em>ุนูุงูุฉ</em> ูู ููู PostgreSQL ุ ูุชู ุงุณุชุฎุฏุงู ุชุฃููู ุงููุงุฆูุงุช.  ูููู ุฃู ูููู ูุซู ูุฐุง ุงูููุฑุฏ ุฃู ุดูุก ุชูุฑูุจูุง: ูุณุงุญุงุช ุงูุฌุฏูู ุ ูุงูุงุดุชุฑุงูุงุช ุ ูุงููุฎุทุทุงุช ุ ูุงูุฃุฏูุงุฑ ุ ูุฃููุงุน ุงูุจูุงูุงุช ุงููุนุฏูุฏุฉ ... ุจุดูู ุนุงู ุ ูู ูุง ูููู ุงูุนุซูุฑ ุนููู ูู ูุชุงููุฌ ุงููุธุงู. <br><br>  ุฏุนูุง ููุธุฑ ุฅูู ูุซุงู ุจุณูุท.  ูุจุฏุฃ ุงููุนุงููุฉ ูููุดุฆ ุฌุฏูููุง ูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> example(n <span class="hljs-type"><span class="hljs-type">integer</span></span>);</code> </pre><br>  ุงูุขู ููุฑู ูุง ููุน ุชุฃููู ุงููุงุฆูุงุช ุงูุฐู ุธูุฑ ูู pg_locks: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> datname <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_database <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> = l.<span class="hljs-keyword"><span class="hljs-keyword">database</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> dbname, classid, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> relname <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> = l.classid) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> classname, objid, mode, granted <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks l <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> l.locktype = <span class="hljs-string"><span class="hljs-string">'object'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> l.pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> database | dbname | classid | classname | objid | mode | granted ----------+--------+---------+--------------+-------+-----------------+--------- 0 | | 1260 | pg_authid | 16384 | AccessShareLock | t 16386 | test | 2615 | pg_namespace | 2200 | AccessShareLock | t (2 rows)</code> </pre><br>  ูููู ูุง ุชู ุญุธุฑู ุจุงูุถุจุท ููุง ุ ุชุญุชุงุฌ ุฅูู ุฅููุงุก ูุธุฑุฉ ุนูู ุซูุงุซุฉ ูุฌุงูุงุช: ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ classid ู objid.  ููุจุฏุฃ ุจุงูุณุทุฑ ุงูุฃูู. <br><br>  ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู OID ููุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุชู ููุชูู ุฅูููุง ุงูููุฑุฏ ุงููุคูู.  ูู ุญุงูุชูุง ุ ููุฌุฏ ุตูุฑ ูู ูุฐุง ุงูุนููุฏ.  ูุฐุง ูุนูู ุฃููุง ูุชุนุงูู ูุน ูุงุฆู ุนุงููู ูุง ููุชูู ุฅูู ุฃู ูุงุนุฏุฉ ูุนููุฉ. <br><br>  ูุญุชูู Classid ุนูู OID ุงูุฎุงุต ุจู pg_class ุ ูุงูุฐู ูุชูุงูู ูุน ุงุณู ุฌุฏูู ูุชุงููุฌ ุงููุธุงู ุ ูุงูุฐู ูุญุฏุฏ ููุน ุงูููุฑุฏ.  ูู ุญุงูุชูุง ุ pg_authid ุ ุฃู ุฃู ุงูุฏูุฑ ูู ุงูููุฑุฏ (ุงููุณุชุฎุฏู). <br><br>  ูุญุชูู Objid ุนูู OID ูู ุฌุฏูู ูุชุงููุฌ ุงููุธุงู ุงูุฐู ุฃุดุงุฑ ุฅููู classid ููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rolname <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_authid <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> = <span class="hljs-number"><span class="hljs-number">16384</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> rolname --------- student (1 row)</code> </pre><br>  ูุจุงูุชุงูู ุ ูุชู ุญุธุฑ ุฏูุฑ ุงูุทุงูุจ ุ ุงูุฐู ูุนูู ููู. <br><br>  ุงูุขู ุฏุนููุง ูุชุนุงูู ูุน ุงูุณุทุฑ ุงูุซุงูู.  ูุดุงุฑ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ููุฐู ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุงูุชู ูุชุตู ุจูุง. <br><br>  Classid ูุดูุฑ ุฅูู ุงูุฌุฏูู ูุณุงุญุฉ ุงุณู ุงููููุน ุงูุฐู ูุญุชูู ุนูู ุงููุฎุทุทุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> nspname <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_namespace <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> = <span class="hljs-number"><span class="hljs-number">2200</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> nspname --------- public (1 row)</code> </pre><br>  ูุจุงูุชุงูู ุ ูุชู ุญุธุฑ ุงููุฎุทุท ุงูุนุงู. <br><br>  ูุฐูู ุ ุฑุฃููุง ุฃูู ุนูุฏ ุฅูุดุงุก ูุงุฆู ุ ูุชู ุญุธุฑ ุฏูุฑ ุงููุงูู ูุงููุธุงู ุงูุฐู ูุชู ุฅูุดุงุก ุงููุงุฆู ููู (ูู ุงููุถุน ุงููุดุชุฑู).  ููู ุฃูุฑ ููุทูู: ุฎูุงู ุฐูู ุ ูููู ูุฃู ุดุฎุต ุฅุฒุงูุฉ ุงูุฏูุฑ ุฃู ุงููุฎุทุท ุจูููุง ูู ุชูุชูู ุงููุนุงููุฉ ุจุนุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุชูุฏูุฏ ููู ุงูุนูุงูุฉ </h1><br>  ุนูุฏูุง ูุฒุฏุงุฏ ุนุฏุฏ ุงูุตููู ูู ุงูุนูุงูุฉ (ุฃู ุ ูู ุงูุฌุฏูู ุ ุงูููุฑุณ ุ ุงูุนุฑุถ ุงูููููุณ) ุ ูููู ูู PostgreSQL ุงุณุชุฎุฏุงู ุงููุณุงุญุฉ ุงูุญุฑุฉ ูู ุงูุตูุญุงุช ุงูุญุงููุฉ ูุฅุฏุฑุงุฌูุง ุ ูููู ูู ุงููุงุถุญ ุฃูู ูุชุนูู ุนููู ูู ููุช ูุง ุฅุถุงูุฉ ุตูุญุงุช ุฌุฏูุฏุฉ.  ูุงุฏููุง ุ ูุชู ุฅุถุงูุชูุง ุฅูู ููุงูุฉ ุงูููู ุงูููุงุจู.  ููู ุงูููููู ุฃู ูุฐุง <em>ุชูุณูุน ุงูุนูุงูุฉ</em> . <br><br>  ูููุน ุนูููุชูู ูู ุงูุชุณุฑุน ูุฅุถุงูุฉ ุตูุญุงุช ูู ููุณ ุงูููุช ุ ูุฅู ูุฐู ุงูุนูููุฉ ูุญููุฉ ุจููู ุฎุงุต ูู ุงูููุน type.  ูุชู ุงุณุชุฎุฏุงู ููุณ ุงูููู ุนูุฏ ุชูุธูู ุงูููุงุฑุณ ุจุญูุซ ูุง ุชุชููู ุงูุนูููุงุช ุงูุฃุฎุฑู ูู ุฅุถุงูุฉ ุตูุญุงุช ุฃุซูุงุก ุงููุณุญ. <br><br>  ุจุงูุทุจุน ุ ูุชู ุชุญุฑูุฑ ูุฐุง ุงูููู ุฏูู ุงูุชุธุงุฑ ููุงูุฉ ุงููุนุงููุฉ. <br><br><blockquote style=";text-align:right;direction:rtl">  ุณุงุจูุง ุ ุชู ุชูุณูุน ุงูุฌุฏุงูู ุตูุญุฉ ูุงุญุฏุฉ ููุท ูู ููุช ูุงุญุฏ.  ุชุณุจุจ ูุฐุง ูู ุญุฏูุซ ูุดุงูู ุนูุฏ ุฅุฏุฑุงุฌ ุงูุนุฏูุฏ ูู ุงูุนูููุงุช ูู ููุช ูุงุญุฏ ูู ุงูุตููู ุ ูุจุงูุชุงูู ุ ูู PostgreSQL 9.6 ุ ุชูุช ุฅุถุงูุฉ ุนุฏุฉ ุตูุญุงุช ุฅูู ุงูุฌุฏุงูู ูู ููุช ูุงุญุฏ (ุจูุง ูุชูุงุณุจ ูุน ุนุฏุฏ ุงูุนูููุงุช ุงูุชู ุชูุชุธุฑ ุงูููู ุ ูููู ููุณ ุฃูุซุฑ ูู 512). <br></blockquote><br><h1 style=";text-align:right;direction:rtl">  ููู ุงูุตูุญุฉ </h1><br>  ูุชู ุชุทุจูู ููู ุนูู ูุณุชูู ุงูุตูุญุฉ ูู ุงูุญุงูุฉ ุงููุญูุฏุฉ (ุจุงุณุชุซูุงุก ุงูุฃููุงู ุงูุฃุตููุฉ ุ ูุงูุชู ุชูุช ููุงูุดุชูุง ูุงุญููุง). <br><br>  ุชุชูุญ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฑุณ GIN</a> ุชุณุฑูุน ุงูุจุญุซ ูู ุงูููู ุงููุฑูุจุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงููููุงุช ูู ุงููุณุชูุฏุงุช ุงููุตูุฉ (ุฃู ุงูุนูุงุตุฑ ูู ุงูุตูุงุฆู).  ุนูุฏ ุงูุชูุฑูุจ ุงูุฃูู ุ ูููู ุชูุซูู ูุฐู ุงูููุงุฑุณ ุนูู ุฃููุง ุดุฌุฑุฉ B ุนุงุฏูุฉ ุ ุญูุซ ูุง ูุชู ุชุฎุฒูู ุงููุณุชูุฏุงุช ููุณูุง ุ ูููู ูููุงุช ูุฑุฏูุฉ ูู ูุฐู ุงููุณุชูุฏุงุช.  ูุฐูู ุ ุนูุฏ ุฅุถุงูุฉ ูุซููุฉ ุฌุฏูุฏุฉ ุ ูุฌุจ ุฅุนุงุฏุฉ ุจูุงุก ุงูููุฑุณ ุจููุฉ ุดุฏูุฏุฉ ุ ูุน ุฅุฏุฎุงู ูู ูููุฉ ูู ุงููุณุชูุฏ. <br><br>  ูุชุญุณูู ุงูุฃุฏุงุก ุ ุชุญุชูู ููุงุฑุณ GIN ุนูู ููุฒุฉ ุงูุฅุฏุฑุงุฌ ุงููุชุฃุฎุฑ ุงูุชู ูุชู ุชูููููุง ุจูุงุณุทุฉ ุฎูุงุฑ ุชุฎุฒูู fastupdate.  ุชุชู ุฅุถุงูุฉ ุงููููุงุช ุงูุฌุฏูุฏุฉ ุฃููุงู ุจุณุฑุนุฉ ุฅูู ุงููุงุฆูุฉ ุงููุนููุฉ ุบูุฑ ุงููุฑุชุจุฉ ุ ูุจุนุฏ ูุฑูุฑ ุจุนุถ ุงูููุช ุ ูุชู ููู ูู ูุง ุชู ุชุฌููุนู ุฅูู ุจููุฉ ุงูููุฑุณ ุงูุฑุฆูุณู.  ูุฑุฌุน ุงูุชูููุฑ ุฅูู ุญูููุฉ ุฃู ุงููุณุชูุฏุงุช ุงููุฎุชููุฉ ูู ุงููุญุชูู ุฃู ุชุญุชูู ุนูู ูููุงุช ููุฑุฑุฉ. <br><br>  ูุงุณุชุจุนุงุฏ ุนูููุงุช ูุชุนุฏุฏุฉ ูู ุงูุงูุชูุงู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฅูู ุงูููุฑุณ ุงูุฑุฆูุณู ูู ููุณ ุงูููุช ุ ูุชู ุญุธุฑ ุตูุญุฉ ุชุนุฑูู ุงูููุฑุณ ูู ุงููุถุน ุงูุญุตุฑู ุทูุงู ูุชุฑุฉ ุงูููู.  ูุฐุง ูุง ูููุน ุงุณุชุฎุฏุงู ุงูููุฑุณ ูู ุงููุถุน ุงูุนุงุฏู. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุฃููุงู ุงูุงุณุชุดุงุฑูุฉ </h1><br>  ุนูู ุนูุณ ุงูุฃููุงู ุงูุฃุฎุฑู (ูุซู ุฃููุงู ุงูุนูุงูุงุช) ุ ูุง ูุชู ุชุนููู ุงูุฃููุงู ุงูุงุณุชุดุงุฑูุฉ ุชููุงุฆููุง ุ ููุชู ุฅุฏุงุฑุชูุง ุจูุงุณุทุฉ ูุทูุฑ ุงูุชุทุจูู.  ููู ูุฑูุญุฉ ูู ุงูุงุณุชุฎุฏุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงูุชุทุจูู ูุญุชุงุฌ ุฅูู ุญุธุฑ ุงูููุทู ูุจุนุถ ุงูุฃุบุฑุงุถ ุงูุชู ูุง ุชูุณุฌู ูุน ุงูููุทู ุงูููุงุณู ููุฃููุงู ุงูุนุงุฏูุฉ. <br><br>  ุงูุชุฑุถ ุฃู ูุฏููุง ููุฑุฏ ุดุฑุทู ูุง ูุชูุงูู ูุน ุฃู ูุงุฆู ูุงุนุฏุฉ ุจูุงูุงุช (ูุงูุฐู ูููููุง ุญุธุฑู ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ ูุซู SELECT FOR ุฃู LOCK TABLE).  ุชุญุชุงุฌ ุฅูู ุงูุฎุฑูุฌ ุจูุนุฑู ุฑููู ูุฐูู.  ุฅุฐุง ูุงู ููููุฑุฏ ุงุณู ูุฑูุฏ ุ ูุฅู ุงูุฎูุงุฑ ุงูุจุณูุท ูู ุฃุฎุฐ ุฑูุฒ ุงูุชุฌุฒุฆุฉ ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> hashtext(<span class="hljs-string"><span class="hljs-string">'1'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> hashtext ----------- 243773337 (1 row)</code> </pre><br>  ููุฐุง ููุชูุท ุงูููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_advisory_lock(hashtext(<span class="hljs-string"><span class="hljs-string">'1'</span></span>));</code> </pre><br>  ูุงูุนุงุฏุฉ ุ ุชุชููุฑ ูุนูููุงุช ุงูููู ูู pg_locks: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> locktype, objid, mode, granted <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> locktype = <span class="hljs-string"><span class="hljs-string">'advisory'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> locktype | objid | mode | granted ----------+-----------+---------------+--------- advisory | 243773337 | ExclusiveLock | t (1 row)</code> </pre><br>  ููู ูุนูู ุงูููู ุจุงููุนู ุ ูุฌุจ ุฃู ุชุญุตู ุงูุนูููุงุช ุงูุฃุฎุฑู ุฃูุถูุง ุนูู ููู ูุจู ุงููุตูู ุฅูู ุงูููุฑุฏ.  ูู ุงููุงุถุญ ุฃู ุงูุงูุชุฒุงู ุจูุฐู ุงููุงุนุฏุฉ ูุฌุจ ุฃู ูุถููู ุงูุชุทุจูู. <br><br>  ูู ุงููุซุงู ุฃุนูุงู ุ ูููู ุงูููู ุณุงุฑู ุงูููุนูู ุญุชู ููุงูุฉ ุงูุฌูุณุฉ ุ ูููุณ ุงููุนุงููุฉ ุ ูุงููุนุชุงุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> locktype, objid, mode, granted <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> locktype = <span class="hljs-string"><span class="hljs-string">'advisory'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> locktype | objid | mode | granted ----------+-----------+---------------+--------- advisory | 243773337 | ExclusiveLock | t (1 row)</code> </pre><br>  ูุฌุจ ุฃู ูุชู ุฅุตุฏุงุฑูุง ุจุดูู ุตุฑูุญ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_advisory_unlock(hashtext(<span class="hljs-string"><span class="hljs-string">'1'</span></span>));</code> </pre><br>  ููุงู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงููุธุงุฆู ููุนูู ูุน ุงูุฃููุงู ุงูุงุณุชุดุงุฑูุฉ ูุฌููุน ุงูููุงุณุจุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  pg_advisory_lock_shared ูุนุงูู ููู ูุดุชุฑู ุ </li><li style=";text-align:right;direction:rtl">  ูุญุตู pg_advisory_xact_lock (ู pg_advisory_xact_lock_shared) ุนูู ููู ุญุชู ููุงูุฉ ุงููุนุงููุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูุง ูุชููุน pg_try_advisory_lock (ููุฐูู pg_try_advisory_xact_lock ู pg_try_advisory_xact_lock_shared) ุงุณุชูุงู ุงูููู ุ ููู ููุฑุฌุน ูููุฉ ุฎุงุทุฆุฉ ุฅุฐุง ุชุนุฐุฑ ุงูุญุตูู ุนูู ุงูููู ุนูู ุงูููุฑ. </li></ul><br>  ุชููุฑ ูุฌููุนุฉ ูุธุงุฆู try ุทุฑููุฉ ุฃุฎุฑู ูุนุฏู ุงูุชุธุงุฑ ุงูููู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูู ุงููุฏุฑุฌุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ููุงูุฉ ุณุงุจูุฉ</a> . <br><br><h1 style=";text-align:right;direction:rtl">  ุฃููุงู ุงููุณูุฏ </h1><br>  ุธูุฑ ูุตุทูุญ <em>ุชุฃููู ุงููุณูุฏ</em> ููุฐ ูุชุฑุฉ ุทูููุฉ ุ ูู ุงููุญุงููุงุช ุงูุฃููู ูุชุทุจูู ุงูุนุฒู ุงููุงูู ุจูุงุกู ุนูู ุงูุฃููุงู ูู ููุงุนุฏ ุจูุงูุงุช ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช ุงููุจูุฑุฉ (ุงููุณุชูู Serializable ุ ุนูู ุงูุฑุบู ูู ุนุฏู ูุฌูุฏ ูุนูุงุฑ SQL ูู ุฐูู ุงูููุช).  ูุงูุช ุงููุดููุฉ ุงูุชู ุชูุช ููุงุฌูุชูุง ุจุนุฏ ุฐูู ูู ุฃูู ุญุชู ุญุฌุจ ูู ุงูุฎุทูุท ุงูููุฑูุกุฉ ูุงููุชุบูุฑุฉ ูุง ูููุฑ ุนุฒูุฉ ุชุงูุฉ: ูุฏ ุชุธูุฑ ุฎุทูุท <em>ุฌุฏูุฏุฉ</em> ูู ุงูุฌุฏูู ุงูุฐู ููุฏุฑุฌ ุชุญุช ููุณ ุธุฑูู ุงูุงุฎุชูุงุฑ ุ ููุง ูุคุฏู ุฅูู ุธููุฑ <em>ุฃุดุจุงุญ</em> (ุงูุธุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุงูุฎุงุตุฉ ุจุงูุนุฒูุฉ</a> ) . <br><br>  ูุงูุช ููุฑุฉ ุงูุฃููุงู ุงููุณุฏูุฏุฉ ูู ุญุฌุจ ุงููุณูุฏุงุช ูููุณ ุงูุตููู.  ุฅุฐุง ุ ุนูุฏ ุชูููุฐ ุงุณุชุนูุงู ุจุงูุดุฑุท <em>a</em> &gt; 10 ุ ุชู ุญุธุฑ ุงููุณูุฏ <em>a</em> &gt; 10 ุ ููู ูุคุฏู ุฐูู ุฅูู ุฅุถุงูุฉ ุตููู ุฌุฏูุฏุฉ ุฅูู ุงูุฌุฏูู ุงูุฐู ููุฏุฑุฌ ุชุญุช ุงูุดุฑุท ูุณูู ูุชุฌูุจ ุธููุฑ ุงูุฃููุงู.  ุงููุดููุฉ ูู ูุฐู ุงูุญุงูุฉ ุงูุนุงูุฉ ูู ูููุฉ ุตุนุจุฉ ูู ุงููุงุญูุฉ ุงูุญุณุงุจูุฉ ุ  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูููู ุญููุง ููุท ูููุณูุฏุงุช ุงูุชู ููุง ุดูู ุจุณูุท ููุบุงูุฉ. <br><br>  ูู PostgreSQL ุ ูุชู ุชูููุฐ ุงูุทุจูุฉ ุงููุชุณูุณูุฉ ุจุดูู ูุฎุชูู ุ ุนูุงูุฉ ุนูู ุงูุนุฒูุฉ ุงููุงุฆูุฉ ุนูู ุงูููุทุฉ ุงูุญุงููุฉ.  ูุจูู ุงููุตุทูุญ " <em>ุชุฃููู ุงููุณูุฏ"</em> ุ ููู ูุนูุงู ุชุบูุฑ ุจุดูู ุฌุฐุฑู.  ูู ุงููุงูุน ุ ูุฅู ูุฐู "ุงูุฃููุงู" ูุง ุชููุน ุฃู ุดูุก ุ ูููููุง ุชุณุชุฎุฏู ูุชุชุจุน ุชุจุนูุงุช ุงูุจูุงูุงุช ุจูู ุงููุนุงููุงุช. <br><br>  ุซุจุช ุฃู ุงูุนุฒูุฉ ุงููุงุฆูุฉ ุนูู ุงูุตูุฑ ุชุณูุญ ุจูุฌูุฏ <em>ุดุฐูุฐ ูู ุงูุชุณุฌูู ุบูุฑ ุงููุชูุงุณู</em> <em>ูุดุฐูุฐ ูู ุนูููุฉ ูุฑุงุกุฉ ููุท</em> ุ ูููู ูุง ุชูุฌุฏ ุญุงูุงุช ุดุฐูุฐ ุฃุฎุฑู ููููุฉ.  ูููู ุฃููุง ูุชุนุงูู ูุน ุฃุญุฏ ุงูุดุฐูุฐูู ุงููุฏุฑุฌูู ูู ุงููุงุฆูุฉ ุ ูููููุง ุชุญููู ุงูุชุจุนูุงุช ุจูู ุงููุนุงููุงุช ูุฅูุฌุงุฏ ุฃููุงุท ูุนููุฉ ูููุง. <br><br>  ูุญู ููุชููู ุจููุนูู ูู ุงูุชุจุนูุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชููู ุฅุญุฏู ุงููุนุงููุงุช ุจูุฑุงุกุฉ ุตู ุ ูุงูุฐู ูุชู ุชุบููุฑู ุจุนุฏ ุฐูู ุจูุงุณุทุฉ ูุนุงููุฉ ุฃุฎุฑู (ุงูุชุจุนูุฉ RW) ุ </li><li style=";text-align:right;direction:rtl">  ุชููู ุฅุญุฏู ุงููุนุงููุงุช ุจุชุนุฏูู ุงูุณุทุฑ ุงูุฐู ุชูุฑุฃู ูุนุงููุฉ ุฃุฎุฑู (ุงูุชุจุนูุฉ WR). </li></ul><br>  ูููู ุชุชุจุน ุชุจุนูุงุช WR ุจุงุณุชุฎุฏุงู ุงูุฃููุงู ุงูุชูููุฏูุฉ ุงูุญุงููุฉ ุ ูููู ูุฌุจ ุฃู ุชุชุจุน ุงูุชุจุนูุงุช RW ููุท ูุชุชุจุน. <br><br>  ุฃูุฑุฑ ูุฑุฉ ุฃุฎุฑู: ุนูู ุงูุฑุบู ูู ุงูุงุณู ุ ูุฅู ุงูุฃููุงู ุงููุณุฏูุฏุฉ ูุง ุชููุน ุฃู ุดูุก.  ุจุฏูุงู ูู ุฐูู ุ ุนูุฏูุง ูุชู ุชูููุฐ ูุนุงููุฉ ูุง ุ ูุชู ุฅุฌุฑุงุก ูุญุต ุ ูุฅุฐุง ุชู ุงูุชุดุงู ุชุณูุณู "ุณูุฆ" ูู ุงูุชุจุนูุงุช ุงูุชู ูุฏ ุชุดูุฑ ุฅูู ุญุฏูุซ ุฎูู ุ ูุฅู ุงูุนูููุฉ ุชููุงุฑ. <br><br>  ุฏุนููุง ูุฑู ููู ูุญุฏุซ ุชุซุจูุช ุงูุฃููุงู ุงูุฃุตููุฉ.  ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุฌุฏูู ุจู ุนุฏุฏ ูุจูุฑ ูู ุงูุตููู ูููุฑุณ ุจู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> pred(n <span class="hljs-type"><span class="hljs-type">integer</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> pred(n) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> gn <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">10000</span></span>) g(n); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> pred(n) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (fillfactor = <span class="hljs-number"><span class="hljs-number">10</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">ANALYZE</span></span> pred;</code> </pre><br>  ุฅุฐุง ุชู ุชูููุฐ ุงูุงุณุชุนูุงู ุนู ุทุฑูู ุงููุณุญ ุงููุชุณูุณู ููุฌุฏูู ุจุฃูููู ุ ูุณูุชู ุชุนููู ุงูููู ุงููุณุฑุฏ ุนูู ุงูุฌุฏูู ุจุฃูููู (ุญุชู ูู ูู ุชูุน ุฌููุน ุงูุตููู ุชุญุช ุดุฑูุท ุงูุชุตููุฉ). <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| pg_backend_pid | ---------------- | 12763 | (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SERIALIZABLE</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) | <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pred <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> n &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| QUERY PLAN | ---------------------------------------------------------------- | Seq Scan on pred (actual time=0.047..12.709 rows=9900 loops=1) | Filter: (n &gt; 100) | Rows Removed by Filter: 100 | Planning Time: 0.190 ms | Execution Time: 15.244 ms | (5 rows)</code> </pre><br>  ูุชู ุฏุงุฆููุง ุงูุชูุงุท ุฃู ุฃููุงู ูุณูุฏ ูู ูุถุน SIReadLock (ูุฑุงุกุฉ ูุชุณูุณูุฉ ูุนุฒููุฉ) ูุงุญุฏ ุฎุงุต: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> locktype, relation::<span class="hljs-type"><span class="hljs-type">regclass</span></span>, page, tuple <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> mode = <span class="hljs-string"><span class="hljs-string">'SIReadLock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> pid = <span class="hljs-number"><span class="hljs-number">12763</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> locktype | relation | page | tuple ----------+----------+------+------- relation | pred | | (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br>  ูููู ุฅุฐุง ุชู ุชูููุฐ ุงูุงุณุชุนูุงู ุจุงุณุชุฎุฏุงู ูุณุญ ุงูููุฑุณ ุ ูุฅู ุงููุถุน ูุชุบูุฑ ุฅูู ุงูุฃูุถู.  ุฅุฐุง ุชุญุฏุซูุง ุนู ุดุฌุฑุฉ B ุ ูููู ุฃู ูุถุน ุงูููู ุนูู ุตููู ุฌุฏูู ุงููุฑุงุกุฉ ูุนูู ุตูุญุงุช ุงูุฃูุฑุงู ุงูููุณูุญุฉ ุถูุฆููุง ูู ุงูููุฑุณ - ูุจุงูุชุงูู ูุฅููุง ูุง ูุญุธุฑ ููููุง ูุญุฏุฏุฉ ูุญุณุจ ุ ูููู ุฃูุถูุง ูุทุงู ุงููุฑุงุกุฉ ุจุงููุงูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SERIALIZABLE</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) | <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pred <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1001</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| QUERY PLAN | ------------------------------------------------------------------------------------ | Index Only Scan using pred_n_idx on pred (actual time=0.122..0.131 rows=2 loops=1) | Index Cond: ((n &gt;= 1000) AND (n &lt;= 1001)) | Heap Fetches: 2 | Planning Time: 0.096 ms | Execution Time: 0.153 ms | (5 rows)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> locktype, relation::<span class="hljs-type"><span class="hljs-type">regclass</span></span>, page, tuple <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> mode = <span class="hljs-string"><span class="hljs-string">'SIReadLock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> pid = <span class="hljs-number"><span class="hljs-number">12763</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> locktype | relation | page | tuple ----------+------------+------+------- tuple | pred | 3 | 236 tuple | pred | 3 | 235 page | pred_n_idx | 22 | (3 rows)</code> </pre><br>  ูุฏ ุชูุงุญุธ ุงูุนุฏูุฏ ูู ุงูุตุนูุจุงุช. <br><br>  ุฃููุงู ุ ูุชู ุฅูุดุงุก ููู ูููุตู ููู ุฅุตุฏุงุฑ ูู ุงูุณุทุฑ ุงูุฐู ุชูุช ูุฑุงุกุชู ุ ูููู ูู ุงููุญุชูู ุฃู ูููู ููุงู ุงููุซูุฑ ูู ูุฐู ุงูุฅุตุฏุงุฑุงุช.  ููุชุตุฑ ุฅุฌูุงูู ุนุฏุฏ ุนูููุงุช ุงูุชุฃููู <em>ุงููุณูุทุฉ</em> ูู <em>ุงููุธุงู ุนูู</em> <em>ูุงุชุฌ</em> ููู ูุนููุงุช <em>max_pred_locks_per_transaction</em> ร <em>max_connections</em> (ุงูููู ุงูุงูุชุฑุงุถูุฉ ูู 64 ู 100 ุนูู ุงูุชูุงูู).  ูุชู ุชุฎุตูุต ุงูุฐุงูุฑุฉ ููุฐู ุงูุฃููุงู ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุฎุงุฏู ุ  ูุญุงููุฉ ุชุฌุงูุฒ ูุฐุง ุงูุฑูู ุณููุชุฌ ุนููุง ุฃุฎุทุงุก. <br><br>  ูุฐูู ุ ุจุงููุณุจุฉ ููุฃููุงู ุงููุณูุฏ (ูููุท ุจุงููุณุจุฉ ููู!) ุ <em>ูุชู</em> ุงุณุชุฎุฏุงู <em>ุฒูุงุฏุฉ ูุณุชูู</em> .  ูุจู PostgreSQL 10 ุ ูุงูุช ููุงู ูููุฏ ุชู ุฑุจุทูุง ุจุงูููุฏ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูููููู ุงูุจุฏุก ูู ุฎูุงููุง ุงูุชุญูู ูู ุงููุนููุงุช ูู ุฎูุงู ุฑูุน ุงููุณุชูู.  ุฅุฐุง ูุงู ุนุฏุฏ ุฃููุงู ุฅุตุฏุงุฑ ุงูุตู <em>ูู ูู ุตู</em> ุฃูุจุฑ ูู <em>max_pred_locks_per_page</em> ุ ููุชู ุงุณุชุจุฏุงู ูุฐู ุงูุฃููุงู ุจููู ูุณุชูู ุตูุญุฉ ูุงุญุฏ.  ููุง ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SHOW</span></span> max_pred_locks_per_page;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> max_pred_locks_per_page ------------------------- 2 (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) | <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pred <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1002</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| QUERY PLAN | ------------------------------------------------------------------------------------ | Index Only Scan using pred_n_idx on pred (actual time=0.019..0.039 rows=3 loops=1) | Index Cond: ((n &gt;= 1000) AND (n &lt;= 1002)) | Heap Fetches: 3 | Planning Time: 0.069 ms | Execution Time: 0.057 ms | (5 rows)</code> </pre><br>  ุจุฏูุงู ูู ุซูุงุซุฉ ุฃููุงู tuple ุ ูุฑู ููุน ุตูุญุฉ ูุงุญุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> locktype, relation::<span class="hljs-type"><span class="hljs-type">regclass</span></span>, page, tuple <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> mode = <span class="hljs-string"><span class="hljs-string">'SIReadLock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> pid = <span class="hljs-number"><span class="hljs-number">12763</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> locktype | relation | page | tuple ----------+------------+------+------- page | pred | 3 | page | pred_n_idx | 22 | (2 rows)</code> </pre><br>  ูุจุงููุซู ุ ุฅุฐุง ุชุฌุงูุฒ ุนุฏุฏ ุนูููุงุช ุชุฃููู ุงูุตูุญุงุช <em>ุงููุฑุชุจุทุฉ</em> ุจุนูุงูุฉ ููุฑุฏุฉ <em>max_pred_locks_per_relation</em> ุ ููุชู ุงุณุชุจุฏุงู ูุฐู ุงูุฃููุงู ุจููู ูุณุชูู ุนูุงูุฉ ูุงุญุฏ. <br><br>  ูุง ุชูุฌุฏ ูุณุชููุงุช ุฃุฎุฑู: ูุชู ุงูุชูุงุท ุงูุฃููุงู ุงูุฃุตููุฉ ููุท ููุนูุงูุงุช ุฃู ุงูุตูุญุงุช ุฃู ุฅุตุฏุงุฑุงุช ุงูุตู ุ ูุฏุงุฆููุง ูุน ูุถุน SIReadLock. <br><br>  ุจุทุจูุนุฉ ุงูุญุงู ุ ูุฅู ุงูุฒูุงุฏุฉ ูู ูุณุชูู ุงูุฃููุงู ุชุคุฏู ุญุชูุง ุฅูู ุญูููุฉ ุฃู ุนุฏุฏุง ุฃูุจุฑ ูู ุงููุนุงููุงุช ุณูุคุฏู ุจุดูู ุฎุงุทุฆ ุฅูู ุญุฏูุซ ุฎุทุฃ ูู ุงูุชุณูุณู ุ ููุชูุฌุฉ ูุฐูู ุ ุณููุฎูุถ โโุฅูุชุงุฌูุฉ ุงููุธุงู.  ููุง ุชุญุชุงุฌ ุฅูู ุงูุจุญุซ ุนู ุชูุงุฒู ุจูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ูุงูุฃุฏุงุก. <br><br>  ุงูุตุนูุจุฉ ุงูุซุงููุฉ ูู ุฃูู ูู ุนูููุงุช ูุฎุชููุฉ ูุน ุงูููุฑุณ (ุนูู ุณุจูู ุงููุซุงู ุ ุจุณุจุจ ุชูุณูู ุตูุญุงุช ุงูููุฑุณ ุนูุฏ ุฅุฏุฑุงุฌ ุณุทูุฑ ุฌุฏูุฏุฉ) ุ ูุฏ ูุชุบูุฑ ุนุฏุฏ ุตูุญุงุช ุงููุฑูุฉ ุงูุชู ุชุบุทู ูุทุงู ุงููุฑุงุกุฉ.  ููู ุชูููุฐ ูุฐุง ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> pred <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1001</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> locktype, relation::<span class="hljs-type"><span class="hljs-type">regclass</span></span>, page, tuple <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_locks <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> mode = <span class="hljs-string"><span class="hljs-string">'SIReadLock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> pid = <span class="hljs-number"><span class="hljs-number">12763</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> locktype | relation | page | tuple ----------+------------+------+------- page | pred | 3 | page | pred_n_idx | 211 | page | pred_n_idx | 212 | page | pred_n_idx | 22 | (4 rows)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br>  ุจุงูููุงุณุจุฉ ุ ูุง ูุชู ุฏุงุฆููุง ุฅุฒุงูุฉ ุงูุฃููุงู ุงูุฃุตููุฉ ููุฑ ุงูุชูุงุก ุงููุนุงููุฉ ุ ูุฃููุง ุถุฑูุฑูุฉ ูุชุชุจุน ุงูุชุจุนูุงุช ุจูู <em>ุนุฏุฉ</em> ูุนุงููุงุช.  ูููู ุนูู ุฃู ุญุงู ุ ูุชู ุฅุฏุงุฑุชูุง ุชููุงุฆููุง. <br><br>  ูุง ุชุฏุนู ุฌููุน ุฃููุงุน ุงูููุฑุณ ูู PostgreSQL ุงูุฃููุงู ุงูุฃุตููุฉ.  ูู ุงูุณุงุจู ุ ูุงู ุจุฅููุงู B-tree ููุท ุงูุชุจุงูู ุจูุฐุง ุ ูููู ูู PostgreSQL 11 ุ ุชุญุณู ุงููุถุน: ุชูุช ุฅุถุงูุฉ ููุงุฑุณ ุงูุชุฌุฒุฆุฉ ู GiST ู GIN ุฅูู ุงููุงุฆูุฉ.  ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ุงููุตูู ุฅูู ุงูููุฑุณ ุ ููุงู ุงูููุฑุณ ูุง ูุนูู ูุน ุงูุฃููุงู ุงูุฃุตููุฉ ุ ูุณูุชู ููู ุงูููุฑุณ ุจุงููุงูู ุนูู ุงูููู.  ุจุงูุทุจุน ุ ูุฐุง ูุฒูุฏ ุฃูุถูุง ูู ุนุฏุฏ ููุงุตู ุงููุนุงููุงุช ุบูุฑ ุงูุตุญูุญุฉ. <br><br>  ูู ุงูุฎุชุงู ุ ุฃูุงุญุธ ุฃูู ูุน ุงุณุชุฎุฏุงู ุงูุฃููุงู ุงูุฃุตููุฉ ุ ููุฌุฏ ูููุฏ ุนูู ุฃูู ูุถูุงู ุงูุนุฒู ุงูุชุงู ุ ูุฌุจ ุฃู ุชุนูู <em>ุฌููุน</em> ุงููุนุงููุงุช ุนูู ูุณุชูู Serializable.  ุฅุฐุง ูุงูุช ุงููุนุงููุฉ ุชุณุชุฎุฏู ูุณุชูู ูุฎุชูู ุ ููู ุชููู ุจุจุณุงุทุฉ ุจุชุนููู (ููุญุต) ุงูุฃููุงู ุงูุฃุตููุฉ. <br><br><blockquote style=";text-align:right;direction:rtl">  ุญุณุจ ุงูุชูุงููุฏ ุ ุณุฃุชุฑู ุฑุงุจุทูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">README ุนูู ุงูุฃููุงู ุงูุฃุตููุฉ</a> ุ ูุงูุชู ููููู ูู ุฎูุงููุง ุงูุจุฏุก ูู ุฏุฑุงุณุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ. <br></blockquote><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃู ุชุณุชูุฑ</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar465263/">https://habr.com/ru/post/ar465263/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar465251/index.html">ุงูุตูู ุงูุชูู ุชูุฑูุจุง. ุชูุฑูุจุง ูุง ุชุณุฑุจุช ุงูุจูุงูุงุช</a></li>
<li><a href="../ar465255/index.html">ุชูููุฐ ุชุฌูุน ุงุชุตุงู WCF ูู .Net Core ุจุงุณุชุฎุฏุงู HttpClientFactory</a></li>
<li><a href="../ar465257/index.html">"ุงุญุฐุฑูุง ุ ูุงุณ!": ุญูู ูุงูุฏููุงูุฏุฒ ุ ุงูุดุงูุฑูุง ุงูุฅูููุฉ ุ ููููู ุงููุฒูู ูุจุนุถ ุณุญุฑ ุงูุดุงุฑุน</a></li>
<li><a href="../ar465259/index.html">ValueTask <ุงููุชูุฌุฉ> - ููุงุฐุง ูููุงุฐุง ููููุ</a></li>
<li><a href="../ar465261/index.html">ุงูููุฉ ุงูุณุญุฑูุฉ ููุญุฏุงุช ุงููุงูุฑู ุ ุฃู ููููุฉ ุฌุนู ุงูุญูุงุฉ ุฃุณูู ููุจุฑูุฌ ูุฌูุน AVR</a></li>
<li><a href="../ar465267/index.html">ูุณุฎุฉ ูุทุจูุนุฉ ุนูู ุงูุขูุฉ ุงููุงุชุจุฉ. ุชุนุจูุฑ ุงูุณุญุฑ</a></li>
<li><a href="../ar465269/index.html">ุชุฏุฑูุจ Cisco 200-125 CCNA v3.0. ููู 26. DNS ู DHCP</a></li>
<li><a href="../ar465271/index.html">ูุฑุงุตูุฉ ุณุฑูุฉ ูุบุณู ุงูุฃููุงู ูู ุฎูุงู ุชูุฏูู ุงูุทุนุงู ูุฎุฏูุงุช ุญุฌุฒ ุงูููุงุฏู.</a></li>
<li><a href="../ar465273/index.html">ููู ูุญูู ูุทูุฑู ุงูุจุฑุงูุฌ Microgaming ุงููุณุชุฎุฏููู ูู ุงูุงุฎุชุฑุงูุงุช</a></li>
<li><a href="../ar465275/index.html">ุฃููุณ ุชุญุตู ุนูู ููุงุฑุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>