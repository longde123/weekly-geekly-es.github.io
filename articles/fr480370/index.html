<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéΩ üåø üçà Conf√©rence DEFCON 19. Les patrons aiment Excel, les pirates aussi üñåÔ∏è üîá üîá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salutations √† tous! Qui parle espagnol? Super! Nous avons gagn√© ce prix parce que le matin notre √©quipe, l'√©quipe espagnole, a particip√© √† un tournoi ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conf√©rence DEFCON 19. Les patrons aiment Excel, les pirates aussi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/480370/"> Salutations √† tous!  Qui parle espagnol?  Super!  Nous avons gagn√© ce prix parce que le matin notre √©quipe, l'√©quipe espagnole, a particip√© √† un tournoi de football et a re√ßu ce troph√©e, donc je m'excuse aupr√®s de l'Argentine et de l'Afrique du Sud d'avoir gagn√© ce prix.  Merci √† tous d'√™tre venus √† notre pr√©sentation.  Tout d'abord, permettez-moi de vous pr√©senter mon ami Juan Corrido, et je suis Chema Alonso.  Nous travaillons dans une petite entreprise espagnole Informatica64, et avant d'entamer une conversation sur le sujet, je souhaite vous pr√©senter notre pays. <br><br><img src="https://habrastorage.org/webt/-b/tf/lf/-btflfdt73igrodvnmcaqlqwnra.jpeg"><a name="habracut"></a><br><br>  L'Espagne est un petit pays au milieu de tout, elle est situ√©e entre l'Europe, l'Afrique et l'Am√©rique du Sud, car c'est notre histoire.  Si vous n'√™tes jamais all√© en Espagne, vous devriez y aller.  Je viens de Madrid, c'est une belle ville, c'√©tait la capitale d'un grand empire il y a 500 ans.  Si vous venez √† Madrid, vous ne vous sentirez pas comme un √©tranger, car si vous √™tes venu √† Madrid, vous √™tes d√©j√† Madrid.  Juanito d'une autre ville, de S√©ville.  Cette ville √©tait la capitale de l'Empire arabe au 7√®me si√®cle, lorsque l'Espagne √©tait un pays arabe.  Sur la diapositive, vous voyez la Tour dor√©e, elle est construite en or, qui a √©t√© import√©e d'Am√©rique du Sud en Europe. <br>  S√©ville est tr√®s c√©l√®bre pour son flamenco, ses festivals et ses monuments - sur cette diapositive l'un des plus grands monuments architecturaux, la Plaza de Espa√±a, vous le savez probablement tous.  Vous devez visiter ce monument et vous tomberez amoureux, car si Anakin Skywalker tombe amoureux de S√©ville, vous pouvez le faire aussi.  Alors n'oubliez pas de visiter notre pays. <br><br>  Juanito de Triana, est une petite r√©publique ind√©pendante de S√©ville, tr√®s c√©l√®bre pour la Semaine Sainte, car ses habitants sont tr√®s religieux et des milliers d'entre eux tiennent des repr√©sentations religieuses √† cette √©poque, et bien s√ªr, apr√®s cela, ils boivent. <br><br><img src="https://habrastorage.org/webt/0l/-z/yr/0l-zyrakhusiqc5rltere9eegzs.jpeg"><br><br>  Donc, nous travaillons chez Informatica64 et probablement beaucoup d'entre vous ont entendu parler d'un outil que nous avons d√©velopp√© appel√© Foca.  Il s'agit d'un outil gratuit que vous pouvez utiliser pour pirater des informations, des tests de p√©n√©tration, etc.  Demain, nous allons publier dans notre atelier en ligne √† 8 heures une nouvelle troisi√®me version de ce programme, afin que chacun d‚Äôentre vous puisse participer √† son test. <br><br>  Le sujet de notre expos√© d'aujourd'hui concerne les applications distantes utilisant Citrix et le service Terminal Server de Windows.  Les entreprises les placent dans les nuages.  Dans notre pr√©sentation, nous d√©crirons comment utiliser les applications avec l'extension .ica et les fichiers Terminal Service, en automatisant l'analyse des donn√©es √† l'aide de FOCA.  Cela permet √† un attaquant d'identifier les logiciels internes, les r√©seaux internes et de combiner des informations lors de l'analyse PTR et lors d'attaques malveillantes √† l'aide de fichiers Excel.  En cons√©quence, nous utiliserons la fonction de politique de s√©curit√© d√©licate des applications Excel distantes, qui donne aux pirates la possibilit√© de contourner les restrictions de macro et d'acc√©der aux informations confidentielles de l'entreprise. <br><br>  Auparavant, nous avons effectu√© une grande quantit√© de travail sur ce sujet, sur le sujet de Citrix et du service Terminal Server de Windows, mais nous pensons toujours que cela est important, car jusqu'√† pr√©sent, personne ne s'est vraiment pr√©occup√© de ce probl√®me.  Nous montrerons √† quel point il est facile pour un pirate d'infiltrer les donn√©es de l'entreprise √† l'aide de ces outils. <br><br>  Il est tr√®s facile de trouver le point d'entr√©e d'une entreprise qui recherche des applications ou des connexions √† distance via Google.  Ils recherchent des fichiers .rdp.  Vous pouvez trouver pr√®s de deux mille places, 2000 serveurs publiant de telles applications.  Vous pouvez √©galement trouver des sites gouvernementaux qui utilisent des applications "cloud" distantes, vous pouvez simplement cliquer dessus et voir ce qui se passe. <br><br><img src="https://habrastorage.org/webt/qi/ei/i3/qieii365itff3ffjrmf0g83fxm8.jpeg"><br><br><img src="https://habrastorage.org/webt/nk/ci/yv/nkciyvrjzb9glhjlv-14iiefiec.jpeg"><br><br>  Vous pouvez faire √† peu pr√®s la m√™me chose dans BING.  Vous ne pouvez pas utiliser le modificateur d'extension de fichier, mais vous pouvez utiliser le type de fichier .txt et rechercher les modificateurs qui apparaissent dans tous les fichiers dans des milliers d'applications distantes que vous avez trouv√©es. <br><br>  Certains des endroits que nous d√©couvrons en utilisant ces applications distantes sont des sites gouvernementaux.  Sur la diapositive, vous voyez le syst√®me de gestion des ordres de patrouille situ√© sur le domaine .mil aux √âtats-Unis, c'est le site des militaires. <br><br><img src="https://habrastorage.org/webt/xu/jl/sp/xujlsppljishj5vgipw2ybfarqc.jpeg"><br><br>  Nous allions faire une d√©mo bas√©e sur ce site et parler avec Jeff, mais aujourd'hui il l'a corrig√©, et nous ne savons pas pourquoi.  Mais nous sommes pr√™ts √† vous montrer une exp√©rience avec un autre site gouvernemental - le California Department of Transportation. <br><br><img src="https://habrastorage.org/webt/s0/oc/12/s0oc12svfjj0zjuplxoyyklvqci.jpeg"><br><br>  Juste en lisant cette page, en bas, vous pouvez trouver l'application RouteCleaning distante, qui est un fichier avec l'extension .ica, et la t√©l√©charger en cliquant sur le lien.  Voyons voir ce que nous obtenons.  Je vous assure, cela a fonctionn√© il y a 5 minutes.  Eh bien, nous n'avons pas r√©ussi, mais ne vous inqui√©tez pas, nous avons une autre d√©mo. <br><br>  Dans cet environnement, comme nous le verrons, il y a tellement de choses √† se soucier, et il est tr√®s difficile d'assurer la s√©curit√© de toutes les applications.  Cette diapositive avec Leonardo DiCaprio n'a pas de sens, car elle fait r√©f√©rence √† une d√©monstration ayant √©chou√©.  Encore d√©sol√©, mais il y a 5 minutes, cela a vraiment fonctionn√©. <br><br>  Insistez-vous pour que nous r√©essayions?  Eh bien, nous allons taper √† nouveau dans le California Department of Transportation dans le navigateur.  Non, √ßa ne marche plus.  Ils l'ont r√©par√©!  Mais croyez-moi, il y a 5 minutes, tout a fonctionn√© pour nous.  Eh bien, ne vous inqui√©tez pas. <br><br>  Continuons.  Le plus gros probl√®me avec ces fichiers de configuration est leur verbosit√©.  Vous pouvez simplement lire les fichiers .txt et y trouver de nombreuses informations, telles que l'adresse IP interne et les mots de passe utilisateur chiffr√©s.  Vous pouvez d√©chiffrer ces mots de passe crypt√©s, mais vous ne pourrez pas acc√©der au syst√®me √† l'aide d'un compte anonyme ou d'un compte utilisateur.  Mentionn√© ici est un logiciel interne.  Ces fichiers sont donc id√©aux pour les cyberattaques cibl√©es comme APT pour les personnes qui collectent des informations pour organiser de telles attaques.  Une simple recherche de fichiers .ica sur Internet permet de d√©tecter des fichiers avec un mot de passe pour Oracle simplement dans le texte. <br><br><img src="https://habrastorage.org/webt/vq/pt/n7/vqptn7pbh0m9bgc022sspzh3apk.jpeg"><br><br>  Pour cela, vous n'avez rien √† faire de sp√©cial, il y a suffisamment d'informations dans ces fichiers.  Par cons√©quent, nous avons d√©cid√© d'ajouter ce type de fichier √† notre outil FOCA, qui est utilis√© pour collecter des informations et identifier les sites Web des entreprises.  Vous voyez d√©j√† une nouvelle version du programme, qui sera disponible demain pour les gars qui recherchent ce type de fichiers et en extraient des informations. <br><br><img src="https://habrastorage.org/webt/ow/0y/lu/ow0yluzqhm1bkua_m5t-t_t3rqy.jpeg"><br><br>  Le deuxi√®me gros probl√®me est qu'il s'agit de tous les fichiers texte avec l'extension .txt, donc l'attaquant peut modifier librement les fichiers de configuration et ainsi acc√©der √† d'autres parties du syst√®me d'exploitation.  Il peut g√©n√©rer des messages d'erreur sur le serveur, donc lorsque vous utilisez Citrix, vous recevrez un message indiquant que ce fichier ou cette application n'est pas sur le serveur.  Un pirate pourra √©galement obtenir la liste compl√®te des applications install√©es sur votre ordinateur. <br><br>  Il est tr√®s simple de le faire avec les services Terminal Server - en mode d'application distante, la commande -0 donnera acc√®s √† l'ensemble du bureau et la commande -1 ne donnera acc√®s qu'aux applications.  Les versions avec un nombre &lt;6 pour les protocoles RDP cr√©ent un shell alternatif, bien qu'elles ne fonctionnent pas avec les services Terminal Server sous 2008.  Par exemple, vous recevez divers messages d'erreur, tels que ¬´Acc√®s refus√©¬ª, car ce fichier appartient au syst√®me d'exploitation.  Mais le fait que vous ne puissiez pas acc√©der √† ce fichier signifie qu'il ne se trouve pas sur le serveur, mais sur l'ordinateur. <br><br><img src="https://habrastorage.org/webt/8u/hw/wo/8uhwwodvdr_9kmag9zu43rqliay.jpeg"><br><br>  La chose positive est que vous pouvez faire la m√™me chose dans Citrix, et il n'y a aucune protection ici pour emp√™cher une connexion, une autre connexion, une autre et ainsi de suite, vous n'avez m√™me pas besoin d'entrer captcha. <br><br>  Vous pouvez optimiser cette proc√©dure √† l'aide d'un programme cr√©√© par nos soins appel√© CACA (¬´AS¬ª), qui est l'abr√©viation de la phrase ¬´Citrix computer applications¬ª. <br><br><img src="https://habrastorage.org/webt/7r/41/yj/7r41yjylksdddkk5welwudrcsri.jpeg"><br><br>  Vous avez juste besoin d'ouvrir "AS", s√©lectionnez un fichier .ica, sur le c√¥t√© du bloc-notes, vous voyez une liste de param√®tres "ne pas d√©passer", "calculer", "nombre de menaces" et ainsi de suite, vous appuyez sur le bouton D√©marrer et vous pouvez prendre une tasse de caf√© pendant que CACA fait le travail pour vous.  Elle essaie d'ouvrir l'application, tout en faisant des instantan√©s, donc quand elle a fini de travailler, vous pouvez afficher les messages d'erreur.  Ainsi, vous pouvez savoir si cette application existe ou non sur le serveur.  Vous pouvez utiliser une tr√®s grande liste d'applications.  En lan√ßant ¬´KAKA¬ª sur votre ordinateur en d√©but de journ√©e, √† la fin de la journ√©e vous recevrez une liste d'applications dans ¬´KAKA¬ª. <br><br>  Une autre chose qui peut √™tre faite avec les services Terminal Server, nous avons appel√© "Jouer du piano".  Il existe de nombreux liens dans les services Terminal Server et Citrix, en particulier dans Windows 2008, trop de variables, telles que% SystemRoot%,% ProgramFiles%,% SystemDrive%, trop de raccourcis clavier et de nombreuses fonctions qui permettent √† un pirate d'atteindre ces parties du syst√®me, pour que m√™me l'administrateur syst√®me n'obtient pas. <br><br>  Nous aimons vraiment Windows Server 2008, car cela vous aidera dans tout!  Si vous demandez une application qui n'est pas dans le syst√®me d'exploitation, Windows Server 2008 vous donnera une fen√™tre avec une erreur et un bouton d'aide.  Pourquoi ne pas profiter d'une telle courtoisie?  Ainsi, lorsque vous cliquez sur le bouton Aide, le programme vous propose de lire le manuel avec de nombreux liens qui vous permettent d'ouvrir IE, d'activer le panneau ¬´Ouvrir un fichier¬ª, d'ex√©cuter une sorte de commande, etc. <br><br><img src="https://habrastorage.org/webt/ry/b8/ln/ryb8lnxbvm02dfqlrrnlnclabny.jpeg"><br><br>  ¬´Jouer du piano¬ª vous permet d'utiliser de nombreux raccourcis clavier pour acc√©der √† diff√©rentes parties du syst√®me d'exploitation. <br><br><img src="https://habrastorage.org/webt/hj/rn/zn/hjrnzn7fjeuw3tash6eh0jgylwc.jpeg"><br><br>  Lorsque vous les utilisez, nous obtenons de plus en plus de nouveaux raccourcis clavier. <br><br><img src="https://habrastorage.org/webt/2e/u1/-h/2eu1-hnxz9qbff_vnrd6enjfqcg.jpeg"><br><br>  Une fonction int√©ressante est la fonction des touches collantes.  Si vous appuyez sur la touche MAJ trois √† quatre fois de suite, le syst√®me d'exploitation affiche un menu pour d√©finir la fonction de collage des touches avec le panneau de commande.  Ainsi, m√™me si vous n'avez pas acc√®s au panneau de contr√¥le via des touches r√©manentes, vous pouvez configurer tous les panneaux de contr√¥le du syst√®me d'exploitation en cliquant simplement sur ¬´Enregistrer¬ª. <br><br>  Nous allons maintenant vous montrer une d√©monstration du site Web de Citrix.  Il s'agit d'un site Web Sitrix, mais cette page est destin√©e √† d√©montrer les capacit√©s des serveurs, donc notre d√©mo est compl√®tement l√©gale. <br><br><img src="https://habrastorage.org/webt/rr/cu/sh/rrcushzvtok_bjrmerh4vaz09ea.jpeg"><br><br>  Nous entrons le nom d'utilisateur et le mot de passe et entrons dans l'environnement Citrix.  Vous voyez beaucoup d'applications ici.  Nous allons utiliser Excel, car le th√®me de notre pr√©sentation est Excel.  Passons donc √† l'application et ex√©cutons Excel. <br><br><img src="https://habrastorage.org/webt/fm/qo/x9/fmqox9tkjjmjrezlkup3yfa3awy.jpeg"><br><br>  Le syst√®me charge maintenant les composants clients.  Tout est pr√™t, maintenant nous utilisons IE.  Croyez-moi, Excel fonctionne, seule la vitesse d'Internet est faible.  Ici, enfin, la fen√™tre Windows Server 2008 est apparue, nous nous connectons √† l'Excel distant.  Tr√®s lentement ... si quelqu'un m√®ne une attaque d'homme au milieu sur ce r√©seau, arr√™tez de faire √ßa (rires).  Qu'est-il arriv√© √† Internet? <br><br>  Tr√®s, tr√®s lentement ... enfin, enfin!  Nous avons ouvert Excel!  Comme vous pouvez le voir, les donn√©es financi√®res confidentielles de l‚Äôentreprise sont apparues √† l‚Äô√©cran. <br><br><img src="https://habrastorage.org/webt/nm/pe/ko/nmpeko9r7mthcedds8pxcrsshtk.jpeg"><br><br>  Ce fichier doit √™tre prot√©g√© par l'environnement Citrix, essayons d'utiliser des variables d'environnement pour se connecter au r√©pertoire racine.  Comme vous pouvez le voir, lorsque nous essayons d'ouvrir la biblioth√®que ¬´Mes documents¬ª, nous obtenons des messages ¬´Acc√®s refus√©¬ª, mais vous pouvez faire de nombreuses astuces. <br><br>  L'une de ces astuces consiste √† cr√©er un raccourci pour la commande cmd, puis √† l'ex√©cuter ... ne fonctionne pas!  Ils l'ont r√©par√©.  Pas effrayant, il y a beaucoup de consoles.  Cr√©ez un raccourci pour PowerShell et ex√©cutez-le.  Comme vous pouvez le voir, cela a fonctionn√©!  Maintenant, nous pouvons acc√©der √† tout ce dont nous avons besoin. <br><br><img src="https://habrastorage.org/webt/sd/oi/fy/sdoifyzdqaon5ui5zhoofnpa68i.jpeg"><br><br>  C'est tr√®s difficile pour nous, car chaque jour les syst√®mes d'exploitation se compliquent, et les applications qui publient sur le serveur se compliquent aussi.  Ainsi, chaque application que vous publiez sur les services Terminal Server sert de moyen d'acc√©der √† votre syst√®me d'exploitation.  De plus, chaque application est un moyen d'augmenter les privil√®ges d'acc√®s.  Les applications complexes sont optimales pour de telles op√©rations, et Excel est une application si complexe que les entreprises publient via des services pour des applications distantes. <br><br>  C'est un outil tr√®s puissant, et les patrons adorent Excel, car vous pouvez cr√©er de nombreux graphiques et diagrammes amusants, analyser un tas de donn√©es, connecter Excel √† des bases de donn√©es, effectuer une exploration de donn√©es et faire beaucoup d'autres choses conviviales pour les entreprises. <br><br><img src="https://habrastorage.org/webt/xq/b3/_r/xqb3_rujerxhdixxlu6pmi4kdpe.jpeg"><br><br>  Mais pour faire tout cela, vous avez besoin d'un environnement Visual Basic.  Vous pouvez supprimer Visual Basic de votre Excel, mais en m√™me temps, il deviendra une application compl√®tement diff√©rente, il ne restera pas Excel. <br>  L'id√©e est donc que gr√¢ce aux capacit√©s de Visual Basic, vous pouvez faire beaucoup de choses avec Excel.  Montrons-le. <br><br>  Ainsi, nous avons Windows 2008 avec des services de terminaux, et dans cet environnement, nous publions Excel 2007. Nous l'utilisons car les politiques de s√©curit√©, les politiques de restriction des applications sont plus ou moins les m√™mes.  La principale diff√©rence entre la s√©curit√© de MS Office 2010 et 2007 est le bac √† sable, c'est-√†-dire par rapport aux fichiers que vous t√©l√©chargez √† partir d'une source non s√©curis√©e sur Internet.  Mais une fois que vous avez t√©l√©charg√© le fichier sur votre ordinateur, les strat√©gies de s√©curit√© de groupe seront les m√™mes pour les macros.  Vous pouvez utiliser des macros non sign√©es et des macros tierces. <br><br>  Ainsi, dans cet environnement, nous pouvons ex√©cuter Excel avec des macros.  Par d√©faut, les politiques de s√©curit√© permettent √† l'utilisateur de choisir d'activer ou non les macros.  Toutefois, lorsque vous d√©marrez Excel sur un serveur distant, ce choix est une option suppl√©mentaire et les macros sont activ√©es par d√©faut, car Visual Basic pour Applications ne fonctionne pas sur l'ordinateur local, mais sur le serveur.  C'est une grosse diff√©rence. <br><br><img src="https://habrastorage.org/webt/3m/ue/h2/3mueh2avz1mkmipf9a9bh22asec.jpeg"><br><br>  Dans cet exemple, nous allons cr√©er un panneau, et vous voyez que dans le message de politique de s√©curit√©, cette option pour travailler avec la macro est s√©lectionn√©e par l'utilisateur - si oui ou non ce contenu peut √™tre utilis√©.  Bien s√ªr, nous cliquons sur ¬´Autoriser¬ª, apr√®s quoi un graphique avec les indicateurs financiers de l'entreprise appara√Æt √† l'√©cran. <br><br><img src="https://habrastorage.org/webt/oz/xh/nv/ozxhnvjau-hcrxlw4wsuqoo6ras.jpeg"><br><br>  Avec cette attitude envers l'application, vous pouvez faire beaucoup de choses, par exemple, afficher les processus en cours d'ex√©cution.  √Ä l'aide de Windows Management Instrumentation, vous pouvez utiliser les commandes pour obtenir les r√©sultats et les afficher dans un fichier Excel. <br><br>  Nous allons fermer cette fen√™tre et revenir √† la pr√©sentation.  Apr√®s avoir vu cette d√©mo, il devient clair que vous devez prendre soin de la s√©curit√© Excel dans un environnement distant.  La premi√®re chose √† faire pour l'administrateur syst√®me est de verrouiller certaines consoles sp√©ciales, telles que -cmd.exe, -powershell, -script, -cscript.  Mais il y a trop de consoles l√†-bas, et une sauvegarde dans Windows Server 2008 cr√©e des copies de tous ces panneaux de contr√¥le.  Cela cr√©e un double probl√®me car les consoles sont dupliqu√©es.  Dans cet environnement, toutes les consoles sont interdites, pour cela nous avons utilis√© des ACL ACL et des politiques de s√©curit√©, mais nous pouvons m√™me utiliser des consoles d'un autre syst√®me d'exploitation. <br><br>  Cette id√©e a √©t√© avanc√©e par Stevens et que vous pouvez incorporer une dll dans un fichier excel et que cette dll est un interpr√©teur r√©pandu.  Par cons√©quent, simplement en appelant l'interpr√©teur √† partir de votre DLL, vous aurez acc√®s au serveur.  Voyons donc la deuxi√®me d√©mo, qui traite des consoles interdites.  Nous allons entrer dans Windows Server 2008 et essayer d'ex√©cuter cmd.exe, ce qui est interdit.  Vous voyez que rien ne fonctionne pour nous, car cette console est interdite - une inscription appara√Æt que ce programme est bloqu√© par les politiques de s√©curit√© du groupe. <br><br><img src="https://habrastorage.org/webt/ow/tt/xf/owttxfdf1f5nmgmbk0sqlgwmfaw.jpeg"><br><br>  Mais le fichier Excel que nous sommes sur le point d'ouvrir contient .dll de ReactOS et .dll pour l'√©diteur de registre, √©galement de ReactOS.  Par cons√©quent, nous ouvrons la ligne de commande en appuyant sur le bouton "Ligne de commande", et maintenant le fichier Excel extrait le fichier .dll pour l'ex√©cuter.  En fait, nous allons obtenir un interpr√©teur de commandes ReactOS. <br><br><img src="https://habrastorage.org/webt/ow/tt/xf/owttxfdf1f5nmgmbk0sqlgwmfaw.jpeg"><br><br>  Vous voyez √† l'√©cran que nous avons obtenu l'interpr√©teur de commandes ReactOS, qui n'est pratiquement pas diff√©rent de l'interpr√©teur de commandes de Windows 2008. C'est donc une bonne astuce. <br><br><img src="https://habrastorage.org/webt/cq/ia/40/cqia40wgsqxbasnpjnqrvsvyrp4.jpeg"><br><br>  Dans le m√™me temps, aucun cmd.exe n'est visible dans le gestionnaire de t√¢ches, car il s'agit d'un fichier .dll dans le fichier Excel et seule l'application EXCEL.EXE peut √™tre vue dans le gestionnaire de t√¢ches, de sorte que la soci√©t√© que vous avez attaqu√©e ne soup√ßonnera rien. <br><br><img src="https://habrastorage.org/webt/_-/bt/qh/_-btqhcrqfh3jqqvxfvbxhrk7ws.jpeg"><br><br>  Revenons √† nos diapositives.  Apr√®s avoir visionn√© la derni√®re d√©mo, vous pouvez dire - ok, je d√©sactiverai toutes les macros de mon ordinateur.  Mais le fait est que, selon les politiques de s√©curit√©, la d√©sactivation de Visual Basic signifie l'interdiction de son utilisation pour toutes les applications bureautiques, et pas seulement pour Excel, c'est-√†-dire qu'elle affectera Word, PowerPoint, Access, etc. <br><br>  Il existe 4 options de s√©curit√© des macros dans les param√®tres Excel: n'utilisez pas de macros, utilisez uniquement des macros sign√©es, utilisez des macros √† la discr√©tion de l'utilisateur pour chaque cas sp√©cifique et utilisez toutes les macros.  Si l'utilisateur est un hacker, il s√©lectionnera 3 options.  Nous allons maintenant vous montrer la d√©mo Excel, pour laquelle nous avons choisi la premi√®re option - n'utilisez pas du tout de macros. <br><br>  Nous utilisons √† nouveau le fichier Excel publi√© via l'environnement distant, nous retournons donc √† Windows 2008 et quittons la connexion Internet inactive.  Ensuite, nous allons aux politiciens, cochez la case "Activer" pour activer les politiques de s√©curit√© et s√©lectionnez le troisi√®me param√®tre "Aucun avertissement pour toutes les macros, mais avec une interdiction de toutes les macros" dans le menu d√©roulant. <br><br><img src="https://habrastorage.org/webt/4c/vc/7x/4cvc7xfp4siqopcbiwimozjvvs4.jpeg"><br><br>  Ensuite, nous cliquons sur les boutons "Appliquer" et "OK", attendons que les param√®tres changent, revenons au client et ouvrons le fichier Excel.  C'est l'un de mes trucs pr√©f√©r√©s.  Lorsque vous parvenez √† ouvrir un document, vous voyez que rien ne peut √™tre fait car tout est interdit.       ,      ,    . <br><br><img src="https://habrastorage.org/webt/dq/rr/qz/dqrrqzbzztd8nxmyw71a03lb3qw.jpeg"><br><br>   Excel    ‚Äì      trusted locations.    ‚Äì  ,      ,         .   ,       .             ,    ‚Äì      ,       .             ,       ‚Äì   Excel.    ,     ,         .  ,  ,  ! <br><br><img src="https://habrastorage.org/webt/95/gc/7r/95gc7rlc_t8cc15v4kyid8elxdo.jpeg"><br><br>   ,   ‚Äì   !     ,   ‚Äì      ! ,   ,    ,            .      .  ,      . <br><br> ,        4 .  : 1  ‚Äì  , 2-    ,  ‚Äì  ,  4 ‚Äì      .            ¬´     ¬ª. <br><br>  ¬´¬ª, ¬´¬ª      . <br><br><img src="https://habrastorage.org/webt/oq/qo/jy/oqqojyvfg8qzshzdop-xdteftu4.jpeg"><br><br> ,     Excel   ,        ,          .    ¬´    ¬ª,      ¬´   ¬ª. <br><br><img src="https://habrastorage.org/webt/ax/9i/1o/ax9i1ohjtbjwjl1vnujzkhecj_u.jpeg"><br><br>    ,      .    ,    ,          . ,     ,        Certificate Import Wizard! <br><br> ,   ,      ‚Äì    ¬´ ¬ª  ¬´     ¬ª ( ). <br><br><img src="https://habrastorage.org/webt/yo/kc/la/yokclairjf89fzunzom98aoi60s.jpeg"><br><br>   ,     ,     . ,        .           CRL,  CRL      HTTP  LDAP,  HTTP       SQL Injection,     SQL .          Excel    -,      ,    , ,   ,     CRL. <br><br>         SQL, ,     ,    -   CA    DHS ,      .   ,      ,   FOCA. <br><br><img src="https://habrastorage.org/webt/i2/-z/ha/i2-zha056nrm8tanrrl-kr4ke2a.jpeg"><br><br>      : <br><br><ul><li>     DHS; </li><li>   ; </li><li>    Excel  CA; </li><li>   URL  CRL  , , ; </li><li>    DHS  Excel   . </li></ul><br> , , ,        ,            . <br><br><img src="https://habrastorage.org/webt/t_/dr/cl/t_drcl0rnjimbjyxktz_9o375y8.jpeg"><br><br>       ,    ,  , -,           ,    .          Excel    ,   .     ,                   . <br><br><img src="https://habrastorage.org/webt/ui/yk/vd/uiykvdbo0vabx2pywa79tnnm2jy.jpeg"><br><br>          TS Web Access ‚Äì     ¬´  TS Web Access¬ª.  ,       ,    ,        HTTP.       ,  ,   ,    . <br><br>   , ,    ! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Xi0qUZCz6F0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>   :) </h3><br> ,    .    ?     ?  ,     , <a href="https://ua-hosting.company/cloudvps/nl"> VPS    $4.99</a> , <b>  entry-level ,      :</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">   VPS (KVM) E5-2697 v3 (6 Cores) 10GB DDR4 480GB SSD 1Gbps  $19     ?</a> (   RAID1  RAID10,  24    40GB DDR4). <br><br> <b>Dell R730xd  2    - Equinix Tier IV  ?</b>    <b><a href="https://ua-hosting.company/serversnl">2  Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100   $199</a>  ! <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - √† partir de 99 $! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour en savoir plus sur la</font></font><a href="https://habr.com/company/ua-hosting/blog/329618/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cr√©ation d'un b√¢timent d'infrastructure. </font><font style="vertical-align: inherit;">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr480370/">https://habr.com/ru/post/fr480370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr480356/index.html">Conseils Python utiles que vous n'avez pas rencontr√©s</a></li>
<li><a href="../fr480358/index.html">Le prix cach√© des biblioth√®ques CSS-in-JS dans les applications React</a></li>
<li><a href="../fr480362/index.html">Aventures d'hexafluorure d'uranium appauvri allemand en Russie. Partie 1. Histoire et technologies d'enrichissement</a></li>
<li><a href="../fr480364/index.html">M√©taphysique de l'injection de d√©pendance</a></li>
<li><a href="../fr480368/index.html">Attraper les fuites de m√©moire en C / C ++</a></li>
<li><a href="../fr480374/index.html">Le DogBot de React Robotics poursuit sa r√©volution dans l'industrie de la construction</a></li>
<li><a href="../fr480376/index.html">Des jeux vid√©o aux messages secrets: discutez des ≈ìufs de P√¢ques dans les disques vinyle</a></li>
<li><a href="../fr480378/index.html">14 projets open source pour pomper les comp√©tences en science des donn√©es (facile, normal, difficile)</a></li>
<li><a href="../fr480386/index.html">Sauvegardes automatiques des √©quipements r√©seau et de leur stockage dans le syst√®me de contr√¥le de version</a></li>
<li><a href="../fr480388/index.html">Conf√©rence HACKTIVITY 2012. The Big Bang Theory: The Evolution of Pentesting in Enhanced Security. Partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>