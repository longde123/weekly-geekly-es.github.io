<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚶🏻 👩🏻‍🤝‍👨🏼 🔸 Memperluas Editor Persatuan dengan Jendela Editor, Objek Skrip, dan Editor Kustom 😗 👨🏻‍🚀 ⛽️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! Nama saya Grisha dan saya adalah pendiri CGDevs. Hari ini saya ingin berbicara tentang ekstensi editor dan berbicara tentang salah satu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memperluas Editor Persatuan dengan Jendela Editor, Objek Skrip, dan Editor Kustom</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431856/"> Halo semuanya!  Nama saya Grisha dan saya adalah pendiri CGDevs.  Hari ini saya ingin berbicara tentang ekstensi editor dan berbicara tentang salah satu proyek saya, yang saya putuskan untuk posting di OpenSource. <br><br>  Unity adalah alat yang hebat, tetapi memiliki sedikit masalah.  Untuk seorang pemula, untuk membuat ruangan sederhana (kotak dengan jendela), seseorang harus menguasai pemodelan 3D, atau mencoba merakit sesuatu dari paha depan.  Baru-baru ini telah menjadi ProBuilder gratis, tetapi juga paket pemodelan 3D yang disederhanakan.  Saya ingin alat sederhana yang memungkinkan kita untuk dengan cepat menciptakan lingkungan seperti kamar dengan jendela dan memperbaiki UV.  Beberapa waktu yang lalu saya mengembangkan satu plugin untuk Unity, yang memungkinkan Anda untuk dengan cepat membuat prototipe lingkungan seperti apartemen dan kamar menggunakan gambar 2D, dan sekarang saya memutuskan untuk meletakkannya di OpenSource.  Menggunakan contohnya, kami akan menganalisis bagaimana Anda dapat memperluas editor dan alat apa yang ada untuk ini.  Jika Anda tertarik, selamat datang di kucing.  Tautan ke proyek di akhir, seperti biasa, terlampir. <br><br><img src="https://habrastorage.org/webt/e_/oy/lr/e_oylrvnh0iqwprqfu2g_5amfxe.png"><br><a name="habracut"></a><br>  Unity3d memiliki kotak alat yang cukup lebar untuk memperluas kemampuan editor.  Berkat kelas seperti <i>EditorWindow</i> , serta fungsi <i>Custom Inspector</i> , <i>Property Drawer</i> dan <i>TreeView</i> (+ <i>UIElements</i> akan segera muncul), mudah untuk membangun kerangka kerja Anda dengan berbagai tingkat kompleksitas di atas unit. <br><br>  Hari ini kita akan berbicara tentang salah satu pendekatan yang saya gunakan untuk mengembangkan solusi saya dan tentang beberapa masalah menarik yang harus saya hadapi. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mvN5O4LtMZo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Solusinya didasarkan pada penggunaan tiga kelas, seperti <i>EditorWindow</i> (semua jendela tambahan), <i>ScriptableObject</i> (penyimpanan data) dan <i>CustomEditor</i> (fungsionalitas inspektur tambahan untuk Objek Scriptable). <br><br>  Saat mengembangkan ekstensi editor, penting untuk mencoba mematuhi prinsip bahwa pengembang Unity akan menggunakan ekstensi, sehingga antarmuka harus jelas, asli dan sesuai dengan alur kerja Unity. <br><br>  Mari kita bicara tentang tugas yang menarik. <br><br>  Agar kita dapat membuat prototipe sesuatu, pertama-tama kita perlu belajar cara menggambar dari mana kita akan menghasilkan lingkungan kita.  Untuk melakukan ini, kita memerlukan jendela EditorWindow khusus, di mana kita akan menampilkan semua gambar.  Pada prinsipnya, mungkin untuk menggambar di SceneView, tetapi ide awalnya adalah bahwa ketika menyelesaikan solusi, Anda mungkin ingin membuka beberapa gambar pada saat yang sama.  Secara umum, membuat jendela terpisah di sebuah unit adalah tugas yang cukup sederhana.  Ini dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">manual Unity.</a>  Tetapi kotak gambar adalah tugas yang lebih menarik.  Ada beberapa masalah dalam hal ini. <br><br>  <b>Unity memiliki beberapa gaya yang memengaruhi warna jendela.</b> <br><br>  Faktanya adalah bahwa kebanyakan orang menggunakan versi Pro dari Unity menggunakan tema gelap, dan hanya versi ringan yang tersedia dalam versi gratis.  Namun, warna yang digunakan dalam editor gambar tidak boleh menyatu dengan latar belakang.  Di sini Anda dapat menemukan dua solusi.  Yang sulit adalah membuat versi sendiri dari gaya, memeriksanya dan mengubah palet untuk versi unit.  Dan hal yang sederhana adalah mengisi latar belakang jendela dengan warna tertentu.  Dalam pengembangannya, diputuskan untuk menggunakan cara yang sederhana.  Contoh bagaimana ini dapat dilakukan adalah dengan memanggil kode tersebut dalam metode OnGUI. <br><br><div class="spoiler">  <b class="spoiler_title">Warna tertentu</b> <div class="spoiler_text"><pre><code class="cs hljs">GUI.color = BgColor; GUI.DrawTexture(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(Vector2.zero, maxSize), EditorGUIUtility.whiteTexture); GUI.color = Color.white;</code> </pre> <br></div></div><br><br>  Intinya, kami hanya menggambar tekstur warna BgColor ke seluruh jendela. <br><br><img src="https://habrastorage.org/webt/vy/oz/vg/vyozvgmtlmv5ureag8qpthzfpik.png"><br><br>  <b>Gambar dan pindahkan kisi</b> <br><br>  Di sini beberapa masalah terungkap sekaligus.  Pertama, Anda harus memasuki sistem koordinat Anda.  Faktanya adalah bahwa untuk pekerjaan yang benar dan nyaman kita perlu menghitung ulang koordinat GUI jendela dalam koordinat grid.  Untuk ini, dua metode konversi diterapkan (pada dasarnya, ini adalah dua matriks TRS yang dicat) <br><br><div class="spoiler">  <b class="spoiler_title">Mengkonversi koordinat jendela ke koordinat layar</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Vector2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GUIToGrid</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 vec</span></span></span><span class="hljs-function">)</span></span> { Vector2 newVec = ( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(vec.x, -vec.y) - <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(_ParentWindow.position.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, -_ParentWindow.position.height / <span class="hljs-number"><span class="hljs-number">2</span></span>)) * _Zoom + <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(_Offset.x, -_Offset.y); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newVec.RoundCoordsToInt(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Vector2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GridToGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 vec</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(vec.x - _Offset.x, -vec.y - _Offset.y) ) / _Zoom + <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(_ParentWindow.position.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, _ParentWindow.position.height / <span class="hljs-number"><span class="hljs-number">2</span></span>); }</code> </pre><br></div></div><br><br>  di mana <i>_ParentWindow</i> adalah jendela di mana kita akan menggambar grid, <i>_Offset</i> adalah posisi saat ini dari grid, dan <i>_Zoom</i> adalah tingkat perkiraan. <br><br>  Kedua, untuk menggambar garis kita perlu metode <i>Handles.DrawLine</i> .  Kelas Handles memiliki banyak metode yang berguna untuk merender gambar sederhana di jendela editor, inspektur, atau SceneView.  Pada saat pengembangan plugin (Unity 5.5), <i>Handles.DrawLine</i> - mengalokasikan memori dan umumnya bekerja cukup lambat.  Karena alasan ini, jumlah baris yang mungkin untuk render dibatasi oleh konstanta <i>CELLS_IN_LINE_COUNT</i> , dan juga "level LOD" dibuat pada zoom untuk mencapai fps yang dapat diterima dalam editor. <br><br><div class="spoiler">  <b class="spoiler_title">Gambar kotak</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DrawLODLines</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> level</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gridColor = SkinManager.Instance.CurrentSkin.GridColor; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> step0 = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Mathf.Pow(<span class="hljs-number"><span class="hljs-number">10</span></span>, level); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> halfCount = step0 * CELLS_IN_LINE_COUNT / <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = halfCount * DEFAULT_CELL_SIZE; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offsetX = ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (_Offset.x / DEFAULT_CELL_SIZE)) / (step0 * step0) * step0; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offsetY = ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (_Offset.y / DEFAULT_CELL_SIZE)) / (step0 * step0) * step0; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = -halfCount; i &lt;= halfCount; i += step0) { Handles.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(gridColor.r, gridColor.g, gridColor.b, <span class="hljs-number"><span class="hljs-number">0.3f</span></span>); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(-length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)) ); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, -length + offsetY * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, length + offsetY * DEFAULT_CELL_SIZE)) ); } offsetX = (offsetX / (<span class="hljs-number"><span class="hljs-number">10</span></span> * step0)) * <span class="hljs-number"><span class="hljs-number">10</span></span> * step0; offsetY = (offsetY / (<span class="hljs-number"><span class="hljs-number">10</span></span> * step0)) * <span class="hljs-number"><span class="hljs-number">10</span></span> * step0; ; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = -halfCount; i &lt;= halfCount; i += step0 * <span class="hljs-number"><span class="hljs-number">10</span></span>) { Handles.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(gridColor.r, gridColor.g, gridColor.b, <span class="hljs-number"><span class="hljs-number">1</span></span>); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(-length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)) ); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, -length + offsetY * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, length + offsetY * DEFAULT_CELL_SIZE)) ); } }</code> </pre><br></div></div><br><br>  Hampir semuanya siap untuk grid.  Gerakannya digambarkan dengan sangat sederhana.  _Offset pada dasarnya adalah posisi "kamera" saat ini. <br><br><div class="spoiler">  <b class="spoiler_title">Pergerakan grid</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Move</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 dv</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = _Offset.x + dv.x * _Zoom; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = _Offset.y + dv.y * _Zoom; _Offset.x = x; _Offset.y = y; }</code> </pre> <br></div></div><br><br>  Dalam proyek itu sendiri, Anda dapat membiasakan diri dengan kode jendela secara umum dan melihat bagaimana tombol dapat ditambahkan ke jendela. <br><br>  Kita melangkah lebih jauh.  Selain jendela terpisah untuk menggambar, kita perlu menyimpannya sendiri.  Mesin serialisasi internal Unity, Scriptable Object, sangat bagus untuk ini.  Bahkan, ini memungkinkan Anda untuk menyimpan kelas yang dijelaskan sebagai aset dalam proyek, yang sangat nyaman dan asli untuk banyak pengembang unit.  Misalnya, bagian dari kelas Apartemen yang bertanggung jawab untuk menyimpan informasi tata letak secara umum <br><br><div class="spoiler">  <b class="spoiler_title">Bagian dari kelas Apartemen</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Apartment</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> fields public float Height; public bool IsGenerateOutside; public Material OutsideMaterial; public Texture PlanImage; [SerializeField] private List&lt;Room&gt; _Rooms; [SerializeField] private Rect _Dimensions; private Vector2[] _DimensionsPoints = new Vector2[4]; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span></span></code> </pre> <br></div></div><br><br>  Di editor, sepertinya ini di versi saat ini: <br><br><img src="https://habrastorage.org/webt/h1/hh/9o/h1hh9oc8lin8nh3ztjvjqbi0hb0.png"><br><br>  Di sini, tentu saja, CustomEditor telah diterapkan, namun demikian, Anda dapat melihat bahwa parameter seperti _Dimensi, Tinggi, IsGenerateOutside, OutsideMaterial, dan PlanImage ditampilkan di editor. <br><br>  Semua bidang publik dan bidang yang ditandai dengan [SerializeField] diserialisasi (yaitu, disimpan dalam file dalam kasus ini).  Ini sangat membantu jika Anda perlu menyimpan gambar, tetapi ketika bekerja dengan ScriptableObject, dan semua sumber daya editor, Anda harus ingat bahwa lebih baik memanggil metode AssetDatabase.SaveAssets () untuk menyimpan keadaan file.  Kalau tidak, perubahan tidak akan disimpan.  Jika Anda tidak menyimpan proyek dengan tangan Anda. <br><br>  Sekarang kita akan menganalisis sebagian kelas ApartmentCustomInspector, dan bagaimana cara kerjanya. <br><br><div class="spoiler">  <b class="spoiler_title">Kelas ApartemenCustomInspector</b> <div class="spoiler_text"><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">CustomEditor(typeof(Apartment))</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ApartmentCustomInspector</span></span> : <span class="hljs-title"><span class="hljs-title">Editor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Apartment _ThisApartment; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rect _Dimensions; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _ThisApartment = (Apartment) target; _Dimensions = _ThisApartment.Dimensions; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnInspectorGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { TopButtons(); _ThisApartment.Height = EditorGUILayout.FloatField(<span class="hljs-string"><span class="hljs-string">"Height (cm)"</span></span>, _ThisApartment.Height); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dimensions = EditorGUILayout.Vector2Field(<span class="hljs-string"><span class="hljs-string">"Dimensions (cm)"</span></span>, _Dimensions.size).RoundCoordsToInt(); _ThisApartment.PlanImage = (Texture) EditorGUILayout.ObjectField(_ThisApartment.PlanImage, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Texture), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); _ThisApartment.IsGenerateOutside = EditorGUILayout.Toggle(<span class="hljs-string"><span class="hljs-string">"Generate outside (Directional Light)"</span></span>, _ThisApartment.IsGenerateOutside); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_ThisApartment.IsGenerateOutside) _ThisApartment.OutsideMaterial = (Material) EditorGUILayout.ObjectField( <span class="hljs-string"><span class="hljs-string">"Outside Material"</span></span>, _ThisApartment.OutsideMaterial, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Material), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); GenerateButton(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dimensionsRect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(-dimensions.x / <span class="hljs-number"><span class="hljs-number">2</span></span>, -dimensions.y / <span class="hljs-number"><span class="hljs-number">2</span></span>, dimensions.x, dimensions.y); _Dimensions = dimensionsRect; _ThisApartment.Dimensions = _Dimensions; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopButtons</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GUILayout.BeginHorizontal(); CreateNewBlueprint(); OpenBlueprint(); GUILayout.EndHorizontal(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateNewBlueprint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Create new"</span></span> )) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> manager = ApartmentsManager.Instance; manager.SelectApartment(manager.CreateOrGetApartment(<span class="hljs-string"><span class="hljs-string">"New Apartment"</span></span> + GUID.Generate())); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenBlueprint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Open in Builder"</span></span> )) { ApartmentsManager.Instance.SelectApartment(_ThisApartment); ApartmentBuilderWindow.Create(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateButton</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Generate Mesh"</span></span> )) { MeshBuilder.GenerateApartmentMesh(_ThisApartment); } } }</code> </pre> <br></div></div><br>  CustomEditor adalah alat yang sangat kuat yang memungkinkan Anda untuk menyelesaikan banyak tugas khas secara elegan untuk ekstensi editor.  Dipasangkan dengan ScriptableObject, ini memungkinkan Anda untuk membuat ekstensi editor yang sederhana, nyaman dan intuitif.  Kelas ini sedikit lebih rumit daripada hanya menambahkan tombol, seperti yang dapat Anda lihat di kelas asli bahwa bidang privat [SerializeField] _Rooms daftar sedang serial.  Menampilkannya di inspektur, pertama, ke tidak ada, dan kedua - ini dapat menyebabkan bug yang tidak terduga dan menggambar negara.  Metode OnInspectorGUI bertanggung jawab untuk memberikan inspektur, dan jika Anda hanya perlu menambahkan tombol, Anda dapat memanggil metode DrawDefaultInspector () di dalamnya dan semua bidang akan ditarik. <br><br>  Kolom dan tombol yang diperlukan kemudian digambar secara manual.  Kelas EditorGUILayout sendiri memiliki banyak implementasi untuk berbagai jenis bidang yang didukung oleh unit.  Tetapi tombol rendering di Unity diimplementasikan di kelas GUILayout.  Cara pemrosesan tombol ditekan berfungsi dalam kasus ini.  OnInspectorGUI - dijalankan pada setiap acara mouse input pengguna (gerakan mouse, klik mouse di dalam jendela editor, dll.) Jika pengguna mengklik tombol di dalam kotak, metode mengembalikan true dan memproses metode yang ada di dalam jika 'dijelaskan oleh Anda' a.  Sebagai contoh: <br><br><div class="spoiler">  <b class="spoiler_title">Tombol generasi mesh</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateButton</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Generate Mesh"</span></span> )) { MeshBuilder.GenerateApartmentMesh(_ThisApartment); } }</code> </pre> <br></div></div><br>  Ketika Anda mengklik tombol Generate Mesh, metode statis dipanggil, yang bertanggung jawab untuk menghasilkan mesh dari tata letak tertentu. <br><br>  Selain mekanisme dasar yang digunakan ketika memperluas editor Unity, saya ingin secara terpisah menyebutkan alat yang sangat sederhana dan sangat nyaman, tentang yang untuk beberapa alasan banyak lupa - Seleksi.  Seleksi adalah kelas statis yang memungkinkan Anda memilih objek yang diperlukan di inspektur dan ProjectView. <br><br>  Untuk memilih objek, Anda hanya perlu menulis Selection.activeObject = MyAwesomeUnityObject.  Dan bagian terbaiknya adalah ia bekerja dengan ScriptableObject.  Dalam proyek ini, ia bertanggung jawab untuk memilih gambar dan kamar di jendela dengan gambar. <br><br>  Terima kasih atas perhatian anda!  Saya harap artikel dan proyek ini akan bermanfaat bagi Anda, dan Anda akan mempelajari sesuatu yang baru untuk diri Anda sendiri dalam salah satu pendekatan untuk memperluas editor Unity.  Dan seperti biasa - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan ke proyek GitHub</a> , tempat Anda dapat melihat keseluruhan proyek.  Ini masih sedikit lembab, tetapi bagaimanapun itu sudah memungkinkan Anda untuk membuat rencana dalam 2D ​​sederhana dan cepat. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id431856/">https://habr.com/ru/post/id431856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id431846/index.html">GeekBrains mulai menyiapkan pengembang Python full-stack</a></li>
<li><a href="../id431848/index.html">Saat saya menulis naskah terbesar untuk Altium Designer</a></li>
<li><a href="../id431850/index.html">Heisenbug 2018 Moskow: siaran online gratis, pesta, dan banyak lagi</a></li>
<li><a href="../id431852/index.html">Meretas 50.000 printer jaringan dan mencetak teks arbitrer? Tidak ada yang lebih mudahǃ</a></li>
<li><a href="../id431854/index.html">Konsistensi data dalam sistem yang sarat muatan</a></li>
<li><a href="../id431858/index.html">Mitap Sbertekh di Rostov-on-Don</a></li>
<li><a href="../id431860/index.html">Pada opsi driver Linux, atau bagaimana saya menghabiskan akhir pekan</a></li>
<li><a href="../id431862/index.html">Mitap Sbertekh di Yekaterinburg</a></li>
<li><a href="../id431864/index.html">PVS-Studio ROI: bagaimana tidak kehilangan jutaan (draft versi artikel)</a></li>
<li><a href="../id431866/index.html">Pemrogram kesalahpahaman tentang nama - dengan contoh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>