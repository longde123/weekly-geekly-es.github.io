<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💪🏻 👨🏿‍💻 👦🏿 如何控制您的网络基础架构。 第四章 自动化技术 范本 👩‍🍳 🚬 👩🏾‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文是标题为“如何控制网络基础结构”的系列文章中的第六篇。 该系列中所有文章的内容和链接都可以在这里找到 。 

 在留下一些话题之后，我决定开始一个新的篇章。 

 我待会儿再恢复安全。 在这里，我想讨论一种简单但有效的方法，我相信，这种方法对于一种或多种形式都可能有用。 简而言之，就是自动化如何...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何控制您的网络基础架构。 第四章 自动化技术 范本</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453920/">  <i>本文是标题为“如何控制网络基础结构”的系列文章中的第六篇。</i>  <i>该系列中所有文章的内容和链接都可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>找到</i> 。 <br><br> 在留下一些话题之后，我决定开始一个新的篇章。 <br><br> 我待会儿再恢复安全。 在这里，我想讨论一种简单但有效的方法，我相信，这种方法对于一种或多种形式都可能有用。 简而言之，就是自动化如何改变工程师的生活。 这将涉及temlates的使用。 最后是我的项目列表，您可以在这里看到这里描述的所有内容。 <br><br><h2>  Web的DevOps </h2><br> 使用脚本创建配置，使用GIT来控制IT基础架构中的更改，远程“填充”-当您考虑DevOps方法的技术实现时，这些想法首先出现。 优点是显而易见的。 但是不幸的是也有缺点。 <br><br> 五年多以前，我们的开发人员带着这些提议来到了我们的网络公司，我们对此并不热心。 <br><a name="habracut"></a><br> 我必须说，我们继承了一个由大约10个不同供应商的设备组成的杂乱无章的网络。 通过我们最喜欢的CLI进行配置很方便，但是我们更喜欢使用GUI。 此外，还对“带电”设备的长期工作进行了实时控制。 例如，进行更改时，我直接在cli中工作会更自在。 因此，我可以快速看到出现问题并“回滚”更改。 所有这些都与他们的想法有些矛盾。 <br><br> 出现其他问题，例如，从版本到软件版本，界面可能会略有不同。 最后，这将导致您的脚本创建错误的“ config”。 我不想将生产用于闯入。 <br><br> 或者，如何理解配置命令已正确应用以及出现错误时该怎么办？ <br><br> 我不想说所有这些问题都是无法解决的。 只需说“ A”，再说“ B”可能是明智的选择，如果您想使用与开发中相同的变更控制流程，则除了生产外还需要开发环境和过渡环境。 然后，这种方法似乎完成了。 但是要花多少钱？ <br><br> 但是，在一种情况下，劣势几乎被消除了，只剩下了优点。 我说的是设计工作。 <br><br><h2> 专案 </h2><br> 在过去的两年中，我一直参与为一个主要提供商构建数据中心的项目。 我负责这个项目中的F5和Palo Alto。 从思科的角度来看，它是“第三方设备”。 <br><br> 对我个人而言，该项目有两个不同的阶段。 <br><br><h3> 第一阶段 </h3><br> 第一年，我忙得不亦乐乎，晚上和周末都在工作。 我无法抬起头。 管理层和客户的压力是巨大而持续的。 在一个固定的例程中，我什至无法尝试优化流程。 它不仅是设备的配置，而且还不如设计文档的准备。 <br><br> 因此开始了第一个测试，我会惊讶于犯了多少小错误和不准确。 当然，一切正常，但是名称中的字母丢失了，团队中的一行也丢失了……测试还在继续进行，我每天都在不断地与错误，测试和文档打交道。 <br><br> 持续了一年。 据我了解，这个项目对每个人来说都不容易，但是逐渐地，客户变得越来越满意，这使得有可能雇用能够参与例行工作的其他工程师。 <br><br> 现在可以环顾四周。 <br> 那就是第二阶段的开始。 <br><br><h3> 第二阶段 </h3><br> 我决定自动化该过程。 <br><br> 从当时与开发人员的交流中我了解到（尽管我们必须表示敬意，我们拥有一支强大的团队），尽管乍一看似乎来自DOS操作系统，但文本格式还是具有许多有价值的属性。 <br> 例如，如果您想充分利用GIT及其所有派生工具，则文本格式将非常有用。 我想 <br><br> 好吧，看来您只能存储配置或命令列表，但是进行更改非常不便。 另外，在设计时，还有另一个重要任务。 您必须具有描述总体设计（低级设计）和特定实施（网络实施计划）的文档。 在这种情况下，使用模板似乎是一个非常合适的选择。 <br><br> 因此，当使用YAML和Jinja2时，带有配置参数（例如IP地址，BGP AS编号）的YAML文件可以完美地实现NIP的作用，而Jinja2模板则包含适合该设计的语法，实际上是LLD的体现。 <br><br> 花了两天时间学习了YAML和Jinja2语言。 一些好的例子足以理解其工作原理。 然后花了大约两周的时间来创建所有适合我们设计的模板：Palo Alto一周，F5一周。 所有这些都张贴在公司的githab上。 <br><br> 现在更改过程如下： <br><br><ul><li> 更改的Yaml文件 </li><li> 使用模板创建了一个配置文件（Jinja2） </li><li> 保存到远程存储库 </li><li> 将创建的配置上传到设备 </li><li> 看到一个错误 </li><li> 更改了YAML文件或Jinja2模板 </li><li> 使用模板创建了一个配置文件（Jinja2） </li><li>  ... </li></ul><br> 显然，起初很多时间都花在编辑上，但是在一两周后，它已经很可能是稀有的了。 <br><br> 客户希望更改命名约定是一项很好的测试，并且能够调试所有内容。 与F5合作的人都了解这种情况的辛苦之处。 但是对我来说，这很简单。 我更改了YAML文件中的名称，从设备中删除了整个配置，生成了一个新文件并上传了它。 考虑到错误修复，一切都花费了4天：每种技术需要2天。 之后，我准备进行下一步，即创建DEV和Staging数据中心。 <br><br><h3> 开发和暂存 </h3><br> 分阶段实际上完全重复了生产。 开发是主要基于虚拟硬件的精简副本。 一种新方法的理想情况。 如果我将时间花在一般流程上，那么我认为这项工作不会超过2周。 主要时间是另一侧的等待时间，并且是联合寻找问题的时间。 第三方的实施几乎是其他人看不见的。 甚至有时间教一些东西，并在Habré上写几篇文章:) <br><br><h2> 总结一下 </h2><br> 那我到底有什么呢？ <br><br><ul><li> 我需要更改配置的全部就是更改带有配置参数的简单，结构清晰的YAML文件。 我从不更改python脚本，而且很少（仅当有错误时）我更改Jinja2 </li><li> 从文档的角度来看，获得了几乎理想的情况。 您更改文档（YAML文件起NIP的作用）并将此配置上载到设备。 因此，您的文档始终是最新的。 </li></ul><br> 所有这些导致了一个事实， <br><br><ul><li> 错误的百分比降低到几乎为0 </li><li> 花了90％的常规时间 </li><li> 实施速度大大提高 </li></ul><br><h2>  PAY，F5Y，ACY </h2><br> 我说过一些例子足以理解其工作原理。 <br> 这是在我的工作过程中创建的内容的简要说明（当然是经过修改的）。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PAY</a> =来自<b>Y</b> aml的部署<b>P</b> alo <b>A</b> lto =来自Yaml的Palo Alto <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">F5Y</a> =来自<b>Y</b> aml的部署<b>F5</b> =来自<b>Y</b> aml的<b>F5</b> （即将推出） <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ACY</a> =来自<b>Y</b> aml的部署<b>AC</b> i =来自<b>Y</b> aml的<b>F5</b> <br><br> 我将添加一些关于ACY的词（不要与ACI混淆）。 <br><br> 与ACI合作的人都知道，这个奇迹（也是一种很好的方式）不是由网络人员创造的：）。 忘记您对网络了解的所有信息-它对您而言不会派上用场！ <br> 有点夸张，但大致传达了我与ACI合作三年来不断经历的感觉。 <br><br> 在这种情况下，ACY不仅是建立变更控制流程的机会（对于ACI而言尤其重要，因为假设这是数据中心的核心和最关键的部分），而且还为您提供了一个友好的界面来创建配置。 <br><br> 该项目的工程师出于相同的目的使用Excel使用ACI而不是YAML。 当然，使用Excel有一些优点： <br><br><ul><li> 您的压区合而为一 </li><li> 客户很高兴看到的漂亮标志 </li><li> 您可以使用一些Excel工具 </li></ul><br> 但是有一个缺点，在我看来，它的缺点超过了优点。 控制变更和协调团队工作变得更加困难。 <br><br>  ACY实际上正在应用与第三方用于配置ACI相同的方法。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN453920/">https://habr.com/ru/post/zh-CN453920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN453904/index.html">摆脱“ vk.com/away.php”或跟随健康人的链接</a></li>
<li><a href="../zh-CN453906/index.html">什么是“域模型”？</a></li>
<li><a href="../zh-CN453908/index.html">工业计算机中的RTOS Neutrino</a></li>
<li><a href="../zh-CN453914/index.html">TON Test Client安装说明</a></li>
<li><a href="../zh-CN453916/index.html">如何保护自己免受手机诈骗者的侵害</a></li>
<li><a href="../zh-CN453926/index.html">汽车共享服务的工作方式和工作方式</a></li>
<li><a href="../zh-CN453930/index.html">数据迁移系统的比较和选择</a></li>
<li><a href="../zh-CN453932/index.html">捍卫巨石的几句话</a></li>
<li><a href="../zh-CN453934/index.html">开始工作前要讨论的11个问题</a></li>
<li><a href="../zh-CN453938/index.html">NB-IoT被盗自行车追踪</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>