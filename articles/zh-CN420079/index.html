<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙇🏼 🔀 👩‍👦 在虚幻引擎中创建交互式草 🙆🏿 🍻 🆕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="直到最近，游戏中的草通常通过地面上的纹理来表示，而不是通过渲染单个茎来表示。 但是随着铁的力量的增加，渲染草成为可能。 在《 地平线零黎明》和《塞尔达传说：旷野之息》等游戏中可以看到这种渲染的绝佳示例。 在这些游戏中，玩家可以在草地上漫游，更重要的是，草地可以响应玩家的动作。 

 幸运的是，创建这...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在虚幻引擎中创建交互式草</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420079/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/d_/sg/dgd_sg8pss1hh54majrmgysw5fi.gif"></div><br> 直到最近，游戏中的草通常通过地面上的纹理来表示，而不是通过渲染单个茎来表示。 但是随着铁的力量的增加，渲染草成为可能。 在《 <i>地平线零黎明》</i>和<i>《塞尔达传说：旷野之息》</i>等游戏中可以看到这种渲染的绝佳示例。 在这些游戏中，玩家可以在草地上漫游，更重要的是，草地可以<i>响应</i>玩家的动作。 <br><br> 幸运的是，创建这样的系统并不是很困难。 实际上，本文将教您这一点！ 在本教程中，您将学到以下内容： <br><br><ul><li> 使用场景捕捉和粒子系统创建矢量场 </li><li> 根据向量场弯曲玩家的草 </li></ul><a name="habracut"></a><blockquote>  <em>注意：</em>本教程假定您已经了解使用虚幻引擎的基础知识。 如果您不熟悉虚幻引擎，请查看我们的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">面向初学者</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">虚幻引擎</a>教程系列，共十部分。 特别是，请查看“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">粒子系统”</a>教程，以了解如何在本教程中使用Cascade。 </blockquote><blockquote>  <em>注意：</em>本教程是有关使用渲染目标的三个教程系列的一部分： <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1部分：使用渲染目标进行绘图</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分：可变形的雪</a> </li><li> 第3部分：互动草 </li></ul></blockquote><h2> 开始工作 </h2><br> 让我们首先下载本教程的资料（您可以<a href="">从此处</a>下载）。 解压缩它们，转到<em>InteractiveGrassStarter</em>并打开<em>InteractiveGrass.uproject</em> 。 您将看到一小片草地，这将是本教程的主题。 我还创建了一个小部件来显示场景捕获的渲染目标。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8fa/004/60f/8fa00460f2e914dedb752443b566d226.gif"></div><br><br> 在开始之前，您应该学习<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关在雪中创建足迹</a>的教程，因为我将跳过一些信息。 值得考虑的是，本教程中也使用了捕获和投影。 为了节省时间，我准备了一个蓝图捕获，类似于雪中轨道上的教程中的蓝图。 <br><br> 首先，让我们看一下创建交互式草的另一种方法。 最常见的方法是将玩家的坐标转移到草料上，并使用球形蒙版将草从玩家处弯曲到一定半径。 <br><br> 尽管这种方法非常好，但是当我们想在草地上添加更多参与者时，这种方法就无法很好地扩展。 对于添加的每个角色，都必须向材质添加另一个坐标参数和一个球形蒙版。 一种更可扩展的方法是使用<em>矢量场</em> 。 <br><br><h2> 什么是向量场？ </h2><br> 向量场只是一个纹理，其每个像素对应一个方向。 如果您以前使用过流图，则它们是相似的。 但是，我们将使用“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">世界位置偏移”</a>接触来移动顶点，而不是移动UV。 与使用球形掩模的解决方案相比，要获得弯曲方向，材料只需对矢量场采样<i>一次即可</i> 。 <br><br> 让我们找出如何在纹理中保存方向。 看一下这个网格： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/651/6d2/5536516d26f67d5e2e5928db30b1608a.jpg"></div><br> 假设红点是我们要移动的对象。 如果将其移动到右下角，那么哪个矢量将表示该移动？ 如果您回答<em>（1，1）</em> ，那么您是对的！ 如您所知，您还可以将矢量表示为花朵，从而将其保存在纹理中。 让我们将此向量插入虚幻颜色选择器中，看看它返回什么颜色。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b21/5d6/59b/b215d659be2f7f813add96b32fcabae4.jpg"></div><br> 如您所见，方向<em>（1、1）</em>返回黄色。 这意味着，如果我们想沿正XY轴的方向弯曲草，则必须使用此纹理颜色。 现在让我们看一下所有向量的颜色。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbf/302/8bd/fbf3028bd6456dac8ca27a9c1bf2146d.jpg"></div><br> 右下角的正方形看起来非常好，因为它的两个轴上都有渐变。 这意味着我们可以将任何矢量存储在该象限中作为颜色，因为每个矢量都有唯一的颜色。 <br><br> 但是其他三个象限存在问题。 我们沿一个轴只有一个梯度，或者根本没有梯度。 这意味着几个矢量将具有相同的颜色。 例如，我们无法区分向量<em>（-1，1）</em>和<em>（0，1）</em> 。 <br><br> 这三个象限的每个矢量没有唯一的颜色，因为我们只能使用0到1的值表示颜色。但是，这三个象限使用此范围之外的负值。 <br><br> 解决方案是重新分配向量，以使它们都适合从0到1的间隔。这可以通过将向量乘以<em>0.5</em>并加上<em>0.5来完成</em> 。 这是我们得到的可视化效果： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/334/31a/1c633431aa88cde88b2f2af01ede9f89.gif"></div><br> 现在，每个向量都有唯一的颜色。 当需要将其用于计算时，我们只需将其重新分配回-1到1的间隔即可。以下是几种颜色，以及重新分配后的相应方向： <br><br><ul><li>  <em>（0，0）：</em>负的X和Y </li><li>  <em>（0.5、0.5）：</em>无动作 </li><li>  <em>（0，1）：</em>负X和正Y </li><li>  <em>（1，0）：</em>正X和负Y </li></ul><br> 现在让我们学习如何在虚幻引擎中创建矢量场。 <br><br><h3> 创建矢量场 </h3><br> 与在雪中创建痕迹不同，我们将不执行对象形状的捕获。 相反，我们将使用画笔在渲染目标上进行绘制。 这些将只是所选矢量场的图像。 我称它们为<em>方向刷</em> 。 <br><br> 除了使用钝器在渲染目标上绘制外，我们还可以使用<em>粒子</em> 。 粒子将显示方向笔刷并从播放器发出。 要创建矢量场，我们只需要使用场景捕获并仅捕获粒子即可。 这种方法的优点是创建跟踪非常简单。 另外，它使您可以轻松管理属性，例如轨道的存储时间及其大小。 此外，粒子会创建临时的持久性痕迹，因为它们在离开捕获区域并返回到捕获区域之后才存在。 <br><br> 以下是一些我们可以使用的定向画笔的示例，以及它们对草的影响。 请注意，在下面的示例中，粒子是不可见的。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/7ac/976/06a7ac9766e63da84aec88bca2338b9a.gif"></div><br> 首先，让我们创建一个显示方向笔刷的材质。 <br><br><h2> 创建指导材料 </h2><br> 有两种创建方向笔刷的方法： <br><br><ol><li>  <em>数学：</em>方向和形式设置在材料内部。 它的优点是它不需要第三方软件，并且对于简单的表单很方便。 </li><li>  <em>法线贴图转换：</em>创建所需方向和形状的法线贴图。 要将地图转换为合适的矢量场，我们只需删除蓝色通道即可。 这种方法的优点是您可以轻松地创建复杂的形状。 下面是一个很难在数学上创建的画笔示例。 </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddd/e44/0e5/ddde440e52ce5e3bbc6cdece65815265.jpg"></div><br> 在本教程中，我们将在数学上创建画笔。 转到“ <em>材料”</em>文件夹并打开<em>M_Direction</em> 。 请注意，为此材质选择了阴影模型“不<em>发光”</em> 。 这很重要，因为它允许捕获场景以捕获粒子而不影响它们。 <br><br> 为了不复杂，我们将创建一种材质，该材质将导致草从粒子中心移开。 为此，请创建以下方案： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/826/06f/fc1/82606ffc1df0425a75ef17c334a23470.jpg"></div><br> 现在我们需要重新分配。 为此，添加选定的节点并按如下所示连接所有内容： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/eb0/98a/02beb098a304fb3b9ff13a3852c664cd.jpg"></div><br> 现在，让画笔呈圆形。 为此，添加选定的节点： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b97/4bf/702/b974bf7024f3487a8161e279ad3fb350.jpg"></div><br>  <em>RadialGradientExponential</em>控制圆圆周的大小和清晰度。 将其乘以“ <em>粒子颜色”</em>可以使您控制粒子系统中粒子的不透明度。 我将在下一部分中对此进行详细讨论。 <br><br> 这是刷子的样子： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/529/d6e/349/529d6e34937588676b1a20d03fdac107.jpg"></div><br> 单击“ <em>应用”，</em>然后关闭材料。 现在我们已经创建了材料，现在该着手构建一个粒子痕迹系统了。 <br><br><h2> 创建粒子跟踪系统 </h2><br> 转到<em>ParticleSystems</em>文件夹并打开<em>PS_GrassTrail</em> 。 为了节省时间，我已经创建了所有必需的模块。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6aa/008/5ee/6aa0085ee0867456e29f574511b43ec2.jpg"></div><br> 以下是每个模块如何影响草足迹的方法： <br><br><ul><li>  <em>生成：</em>创建频率会影响轨道的平滑度。 如果轨道看起来是断断续续的，那么您应该增加创建的频率。 在本教程中，我们将保留默认值（20）。 </li><li>  <em>生命周期：</em>直到草地恢复其原始状态的路径的生命周期 </li><li>  <em>初始大小：</em>迹线大小 </li><li>  <em>使用寿命内的颜色：</em>由于我们在材质中使用了“粒子颜色”，因此您可以在此处控制不透明度。 您还可以更改Alpha曲线以控制音轨的消失。 例如，您可以选择线性消失，缓和和/或缓和。 在本教程中，我们将保留默认设置，即线性损耗。 </li><li>  <em>锁定轴：</em>用于将粒子引向场景捕获 </li><li>  <em>初始旋转：</em>用于确保粒子沿正确的轴定向（更多信息，请参见下文） </li></ul><br> 首先，我们需要设置材料。 选择“ <em>必需”</em>模块，并将“ <em>材质”</em>设置为<em>M_Direction</em> 。  <em>还将“</em> <em>排序模式”</em>设置为“ <em>PSORTMODE年龄最短”</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb0/a43/fa3/bb0a43fa369abea85bc7a9ff6a80b06e.jpg"></div><br> 此排序模式使您可以在旧粒子上渲染新粒子。 如果不这样做，则不是新的，而是旧的粒子会影响草。 <br><br> 接下来是跟踪的持续时间。 选择<em>Lifetime</em>模块，并将<em>Constant</em>设置为<em>5</em> 。 因此，跟踪将在五秒钟内消失。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/505/d9d/b73/505d9db732f69d4b68b4079bd330553c.jpg"></div><br> 现在，让我们继续走线的大小。 选择<em>初始大小</em>模块，并将<em>常量</em>设置为<em>（150，150，0）</em> 。 因此，每个粒子将覆盖150×150的面积。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/231/dba/9c5/231dba9c5421f8bdd79aba23f8def0cd.jpg"></div><br> 现在我们需要使其朝捕获场景的方向看。 由于场景是从上方捕获的，因此粒子应朝Z轴正方向看，为此，请选择“ <em>锁定轴”</em>模块并将“ <em>锁定轴标志”</em>设置为<em>Z。</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b74/b2b/69c/b74b2b69c7d38785c7ad78d8ec6f250e.jpg"></div><br> 最后，我们需要设置粒子的旋转。 当前，画笔颜色与它们表示的方向不对齐。 发生这种情况是因为默认情况下，将粒子系统旋转90度。 要解决此问题，请选择“ <em>初始旋转”</em>模块，并将“ <em>常量”</em>值设置为<em>-0.25</em> 。 这会将粒子逆时针旋转90度。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/41d/a09/000/41da09000032c1023438b15a3a74f341.jpg"></div><br> 这就是粒子系统所需要的，所以让我们关闭它。 <br><br> 接下来，我们需要将粒子系统附加到应该创建轨迹的对象上。 就我们而言，我们需要将其附加到玩家的角色上。 <br><br><h3> 附着粒子系统 </h3><br> 转到“ <em>角色\模特”，</em>然后打开<em>BP_Mannequin</em> 。 接下来，创建<em>Partice System</em>组件并将其命名为<em>GrassParticles</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b72/9e0/811/b729e08111d25a301682968f1d878da0.jpg"></div><br> 接下来，我们需要定义一个粒子系统。 转到“详细信息”面板，然后将“ <em>粒子\模板”</em>设置为<em>PS_GrassTrail</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/491/45d/7d3/49145d7d362eb92443a8cfe93bd8a023.jpg"></div><br> 如果玩家可以看到游戏中的轨迹，那将很奇怪，因此值得将其隐藏。 为此，请启用“ <em>渲染\所有者看不见”</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/de5/7a8/ad4de57a8d9f0eeee254a58c0de8e8d6.jpg"></div><br> 由于粒子系统已附加到播放器（所有者）上，因此播放器将看不到它，但其他所有对象均可见。 <br><br> 单击“ <em>编译”</em> ，然后单击“ <em>播放”</em> 。 请注意，粒子不会出现在播放器的相机上，而是显示在渲染目标上。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c9d/4d5/4ac/c9d4d54ac998a6aa80da5887dc199b23.gif"></div><br> 到目前为止，场景捕获已设置为捕获<i>所有内容</i> 。 显然，这不适合我们，因为只有粒子会影响草。 在下一节中，我们将学习如何仅捕获粒子。 <br><br><h2> 粒子捕捉 </h2><br> 如果现在捕获粒子，我们将在没有粒子的区域执行不必要的弯曲。 这是因为渲染目标的背景色是黑色。 发生弯曲是因为黑色表示向负XY轴移动（重新分配之后）。 为了使空白区域不包含运动，我们需要使背景目标渲染<em>（0.5，0.5，0）</em> 。 最简单的方法是创建一个巨大的平面并将其附加到播放器上。 <br><br> 首先，为背景创建材料。 返回到内容浏览器并打开<em>Materials \ M_Background</em> 。 然后将常数<em>（</em> <em>0.5，0.5，0</em> <em>）</em>与<em>发射颜色</em>相连。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31b/46f/306/31b46f306ba4f2a0df310d36e54a000b.jpg"></div><br><blockquote>  <em>注意：</em>与粒子材质一样，我们捕获的任何材质都必须具有<em>未照明的着色器</em>模型。 </blockquote><br> 单击“ <em>应用”，</em>然后关闭材料。 返回到<em>BP_Mannequin</em> ，然后创建一个新的<em>Plane</em>组件。 将其命名为<em>Background</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc4/0aa/1ff/bc40aa1ffbb655e576ce999318f4342b.jpg"></div><br> 接下来，设置以下属性： <br><br><ul><li>  <em>位置：</em> （0，0，-5000）。 我们将平面放置得太低，使其不与任何粒子重叠。 </li><li>  <em>比例尺：</em> （100，100，1）。 因此，我们缩放到足以覆盖整个捕获区域的大小。 </li><li>  <em>材质：</em> M_背景 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/824/d3b/e6d824d3b427cff5e136a2861eb02bed.jpg"></div><br> 与粒子一样，如果玩家看到下面有一个巨大的黄色飞机，那将很奇怪。 若要隐藏它，请启用“ <em>渲染\所有者看不见”</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cad/164/7df/cad1647dfe62bb1e29733ac8e6d6b712.jpg"></div><br> 现在我们已经设置了背景，是时候捕获粒子了。 我们可以通过将粒子系统添加到场景捕获<em>的仅显示列表</em>中来做到这一点。 这是将捕获场景捕获的组件列表。 <br><br><h3> 使用仅显示列表 </h3><br> 在我们可以将其添加到仅显示列表之前，我们需要一种方法来获取所有影响草的参与者。 获得它们的一种方法是使用<em>标签</em> 。 标签是可以分配给参与者和组件的简单字符串。 然后，您可以使用“ <em>使用标签获取所有演员”</em>节点来获取所有具有相应标签的演员。 <br><br> 由于玩家的演员必须影响草地，因此他需要标签。 要添加标签，请单击“ <em>Class Defaults”</em>按钮。 然后在<em>Actor \ Tags中</em>创建一个新标签，并将其命名为<em>GrassAffector</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/759/df5/711/759df57115fd0a2172f9c9c4c5b0505d.jpg"></div><br> 由于只能将<i>组件</i>转移到仅显示列表，因此我们需要向影响草的<i>组件</i>添加标签。 选择<em>GrassParticles</em>组件，然后在“ <em>标签”</em>部分添加一个新标签。 也将其命名为<em>GrassAffector</em> （ <i>不必</i>使用此标签）。 对<em>Background</em>组件重复相同的操作。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f4/3f4/05a/8f43f405a8cf96083d5df56e54d21576.jpg"></div><br> 现在，我们需要将影响草的组件添加到场景捕获的仅显示列表中。 单击<em>编译，</em>然后关闭<em>BP_Mannequin</em> 。 然后打开<em>Blueprints \ BP_Capture</em> 。 转到<em>事件BeginPlay</em>并添加突出显示的节点。 还要确保已连接标记的引脚。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d9/e82/3cf/7d9e823cffefede4f0273a81b9363ecb.jpg"></div><br> 该电路将循环所有具有<em>GrassAffector</em>标签的参与者。 之后，她将检查演员是否具有带有此标签的组件，并将其添加到仅显示列表中。 <br><br> 接下来，我们需要告诉场景捕获仅使用仅显示列表。 选择<em>SceneCapture</em>组件，然后转到“ <em>场景捕获”</em>部分。 将<em>原始渲染模式</em>设置为<em>使用ShowOnly列表</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/675/ecd/6eb/675ecd6eb2a1c867734b920bbeaeedd4.jpg"></div><br> 单击<em>编译，</em>然后关闭蓝图。 如果单击“ <em>播放”</em> ，您将看到渲染目标现在仅捕获粒子和背景平面。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee0/a1f/3d7/ee0a1f3d7bb9687f81ec2e7d0faaf61b.gif"></div><br> 在下一节中，我们将达到预期的效果。 是时候教草弯曲了！ <br><br><h2> 弯曲草 </h2><br> 首先，我们需要在草地上投影渲染目标。 转到“ <em>材料”</em>文件夹并打开<em>M_Grass</em> 。 然后创建如下所示的节点。 将纹理设置为<em>RT_Capture</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec0/fd7/4e6/ec0fd74e6e18c21da2d9b647c878613c.jpg"></div><br> 由于我们以0到1的间隔重新分配颜色，在使用它们之前，我们需要以-1到1的间隔重新分配颜色。为此，请添加突出显示的节点： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25d/dc7/0be/25ddc70be17e726bd3089c21ee5be21e.jpg"></div><br> 现在我们有了弯曲方向，我们需要一些方法来沿该方向旋转草。 幸运的是，有一个名为<em>RotateAboutAxis</em>的节点。 让我们来创建它。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a92/4a0/127/a924a0127868686cf2616c8d994e9b5a.jpg"></div><br> 让我们从<em>NormalizedRotationAxis</em>接触开始。 顾名思义，这是顶点将绕其旋转的轴。 要进行计算，我们只需要弯曲方向为<em>（0，0，-1）</em>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">向量积即可</a> 。 为此，我们需要添加选定的节点： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c3/898/ece/5c3898ecee9d7a4fd9ea75e53072acd1.jpg"></div><br> 我们还需要指定<em>RotationAngle</em> ，即顶点相对于旋转点的旋转量。 默认情况下，该值应介于0和1之间，其中0为0度，而1为360度。 要获得旋转角度，我们可以使用弯曲方向的长度乘以最大旋转。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/171/800/6d417180067018db8df09f878251f6e8.jpg"></div><br> 乘以最大旋转<em>0.2</em>将意味着最大旋转角度为<em>72</em>度。 <br><br> 计算<em>PivotPoint</em>有点困难，因为单个草网包含多个茎。 这意味着我们不能使用“ <em>对象位置”</em>节点之类的东西，因为它将为所有草茎返回单个点。 <br><br> 理想情况下，您应该使用第三方3D编辑器将枢轴点保存在UV通道内。 但是对于本教程，我们只是近似枢轴点。 这可以通过从上<em>向下</em>移动到某个偏移量来完成。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f47/6ac/cdf/f476accdf57bca37d5bd7994f53b6b47.jpg"></div><br> 为此，添加选定的节点： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/05a/1bd/208/05a1bd2082b7044a1535aaf38cf33264.jpg"></div><br> 在本教程中，草高约<em>80个</em>单位，因此我为<em>PivotOffset</em>设置了该值。 <br><br> 接下来，我们需要执行两个遮罩。 第一个面具确保茎的根部不会移动。 第二个遮罩可确保没有矢量场作用在捕获区域外的草地上。 <br><br><h3> 遮罩 </h3><br> 在本教程中，我设置草顶部的颜色，以使底部顶点为黑色，顶部顶点为白色。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/199/0ff/45b/1990ff45be26b99bf5330a0d2817e102.jpg"></div><br> 要掩盖根，我们只需将<em>RotateAboutAxis</em>的结果乘以“ <em>顶点颜色”</em>节点即可。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/522/568/0fc/5225680fcb4fd4bedf2f7ec7a49ebb58.jpg"></div><br> 为了遮盖捕获区域之外的草，我们将先前的结果乘以选定的节点： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37b/da2/e95/37bda2e954f8e160ab3b0c80d5269acf.jpg"></div><br> 单击“ <em>应用”，</em>然后关闭材料。 单击“ <em>播放”</em>并在草地上奔跑，在上面留下足迹！ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1dc/058/185/1dc058185c158d1ef243b04f5d041174.gif"></div><br><h2> 接下来要去哪里？ </h2><br> 可以<a href="">从此处</a>下载完成的项目。 <br><br> 尽管本教程中显示的方法对于诸如草之类的简单对象非常有效，但在使用需要更多动态性的对象时还远远不够。 该问题的部分解决方案是使用叶子的物理版本。 有关更多信息，请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这篇</a>关于交互式叶子的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> 。 <br><br> 最后，我要感谢虚幻引擎社区的Deathrey提供了这种粒子方法的技巧！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN420079/">https://habr.com/ru/post/zh-CN420079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN420069/index.html">理查德·汉明（Richard Hamming）：第20章。建模-III</a></li>
<li><a href="../zh-CN420071/index.html">多仓库中仓库的不同价格。 精炼1C-Bitrix</a></li>
<li><a href="../zh-CN420073/index.html">管理的艺术：Teamlead Conf 2018最佳报告回顾。第2部分</a></li>
<li><a href="../zh-CN420075/index.html">这张巧妙的地图解释了物理学中的所有事物如何融合在一起。</a></li>
<li><a href="../zh-CN420077/index.html">新的在线交易机会</a></li>
<li><a href="../zh-CN420081/index.html">在LUKS上安装具有完整系统加密和LVM的Archlinux</a></li>
<li><a href="../zh-CN420083/index.html">Google Assistant的理想选择-莫斯科Hackathon的8课</a></li>
<li><a href="../zh-CN420085/index.html">使用Firebase ML套件识别物体和人类情绪</a></li>
<li><a href="../zh-CN420087/index.html">这是一篇有关MS SQL Server的报告和视频的文章。</a></li>
<li><a href="../zh-CN420089/index.html">机器人：排和巴伐利亚香肠</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>