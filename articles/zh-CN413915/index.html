<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤¾ğŸ¿ ğŸ‘‚ğŸ» ğŸ›ŒğŸ½ ä½¿å¡”é˜²æˆä¸ºç»Ÿä¸€æ¸¸æˆ-ç¬¬2éƒ¨åˆ† ğŸš© ğŸ§‘ ğŸ¤ŸğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿™æ˜¯æ•™ç¨‹â€œåœ¨Unityä¸­åˆ›å»ºå¡”é˜²æ¸¸æˆâ€çš„ç¬¬äºŒéƒ¨åˆ†ã€‚ æˆ‘ä»¬æ­£åœ¨Unityä¸­åˆ›å»ºå¡”é˜²æ¸¸æˆï¼Œåˆ°ç¬¬ä¸€éƒ¨åˆ†ç»“æŸæ—¶ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ”¾ç½®å’Œå‡çº§æ€ªç‰©ã€‚ æˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªæ•Œäººåœ¨æ”»å‡»Cookieã€‚ 

 ä½†æ˜¯ï¼Œæ•Œäººè¿˜ä¸çŸ¥é“åœ¨å“ªé‡Œçœ‹ï¼ æ­¤å¤–ï¼Œä»…å‡­ä¸€æ¬¡æ”»å‡»å°±æ˜¾å¾—å¾ˆå¥‡æ€ªã€‚ åœ¨æœ¬éƒ¨åˆ†çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€æ³¢æ•Œäººå’Œæ‰‹è‡‚æ€ªç‰©ï¼Œä»¥ä¾¿å®ƒä»¬...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿å¡”é˜²æˆä¸ºç»Ÿä¸€æ¸¸æˆ-ç¬¬2éƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413915/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd4/78a/29c/dd478a29c258b63dc809ca16de4ee16a.png" alt="å›¾ç‰‡"></div><br> è¿™æ˜¯æ•™ç¨‹<i>â€œåœ¨Unityä¸­åˆ›å»ºå¡”é˜²æ¸¸æˆâ€</i>çš„ç¬¬äºŒéƒ¨åˆ†ã€‚ æˆ‘ä»¬æ­£åœ¨Unityä¸­åˆ›å»ºå¡”é˜²æ¸¸æˆï¼Œåˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬ä¸€éƒ¨åˆ†</a>ç»“æŸæ—¶ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ”¾ç½®å’Œå‡çº§æ€ªç‰©ã€‚ æˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªæ•Œäººåœ¨æ”»å‡»Cookieã€‚ <br><br> ä½†æ˜¯ï¼Œæ•Œäººè¿˜ä¸çŸ¥é“åœ¨å“ªé‡Œçœ‹ï¼ æ­¤å¤–ï¼Œä»…å‡­ä¸€æ¬¡æ”»å‡»å°±æ˜¾å¾—å¾ˆå¥‡æ€ªã€‚ åœ¨æœ¬éƒ¨åˆ†çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€æ³¢æ•Œäººå’Œæ‰‹è‡‚æ€ªç‰©ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥é˜²å¾¡çè´µçš„cookieã€‚ <br><a name="habracut"></a><br><h2> å¼€å§‹å·¥ä½œ </h2><br> åœ¨Unityä¸­æ‰“å¼€é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨æœ€åä¸€éƒ¨åˆ†ä¸­åœæ­¢äº†è¯¥é¡¹ç›®ã€‚ å¦‚æœæ‚¨åˆšåˆšåŠ å…¥æˆ‘ä»¬ï¼Œè¯·ä¸‹è½½<a href="">é¡¹ç›®è‰æ¡ˆ</a>å¹¶æ‰“å¼€<em>TowerDefense-Part2-Starter</em> ã€‚ <br><br> ä»â€œ <em>åœºæ™¯â€</em>æ–‡ä»¶å¤¹ä¸­æ‰“å¼€<em>GameScene</em> ã€‚ <br><br><h2> è½¬æ•Œäºº </h2><br> åœ¨ä¸Šä¸€æ•™ç¨‹çš„ç»“å°¾ï¼Œæ•Œäººå­¦ä¼šäº†æ²¿è·¯è¡Œé©¶ï¼Œä½†ä¼¼ä¹ä»–ä¸çŸ¥é“åœ¨å“ªé‡Œçœ‹ã€‚ <br><br> åœ¨IDEä¸­æ‰“å¼€<em>MoveEnemy.cs</em>è„šæœ¬ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ä»¥è§£å†³è¿™ç§æƒ…å†µã€‚ <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RotateIntoMoveDirection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1 Vector3 newStartPosition = waypoints [currentWaypoint].transform.position; Vector3 newEndPosition = waypoints [currentWaypoint + 1].transform.position; Vector3 newDirection = (newEndPosition - newStartPosition); //2 float x = newDirection.x; float y = newDirection.y; float rotationAngle = Mathf.Atan2 (y, x) * 180 / Mathf.PI; //3 GameObject sprite = gameObject.transform.Find("Sprite").gameObject; sprite.transform.rotation = Quaternion.AngleAxis(rotationAngle, Vector3.forward); }</span></span></code> </pre> <br>  <code>RotateIntoMoveDirection</code>æ—‹è½¬æ•Œäººï¼Œä½¿å…¶å§‹ç»ˆå‘å‰çœ‹ã€‚ ä»–è¿™æ ·åšå¦‚ä¸‹ï¼š <br><br><ol><li> è®¡ç®—é”™è¯¯çš„å½“å‰æ–¹å‘ï¼Œä»ä¸‹ä¸€ä¸ªç‚¹çš„ä½ç½®å‡å»å½“å‰èˆªè·¯ç‚¹çš„ä½ç½®ã€‚ </li><li> ä½¿ç”¨<code>Mathf.Atan2</code>ç¡®å®šå°†<code>newDirection</code>å®šå‘åˆ°çš„å¼§åº¦è§’ï¼ˆé›¶ç‚¹åœ¨å³ä¾§ï¼‰ã€‚ å°†ç»“æœä¹˜ä»¥<code>180 / Mathf.PI</code> ï¼Œå°†è§’åº¦è½¬æ¢ä¸ºåº¦ã€‚ </li><li> æœ€åï¼Œå®ƒè·å–<em>Sprite</em>å­çº§å¹¶æ—‹è½¬è½´<code>rotationAngle</code>åº¦ã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ—‹è½¬<i>å­çº§</i>è€Œä¸æ˜¯çˆ¶çº§ï¼Œä»¥ä¾¿ç¨åæ·»åŠ çš„èƒ½é‡æ¡ä¿æŒæ°´å¹³ã€‚ </li></ol><br> åœ¨<code>Update()</code> ï¼Œå°†æ³¨é‡Š<code>// TODO:    </code>æ›¿æ¢ä¸º<code>// TODO:    </code>åœ¨ä¸‹ä¸€ä¸ªå¯¹<code>RotateIntoMoveDirection</code>è°ƒç”¨ä¸‹<code>// TODO:    </code> <code>RotateIntoMoveDirection</code> ï¼š <br><br><pre> <code class="cs hljs">RotateIntoMoveDirection();</code> </pre> <br> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›åˆ°Unityã€‚ è¿è¡Œåœºæ™¯ï¼› ç°åœ¨æ•ŒäººçŸ¥é“ä»–è¦ç§»åˆ°å“ªé‡Œã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/73d/7f4/9e5/73d7f49e5fec3785e2ac3376c3774f27.gif"></div><br> ç°åœ¨ï¼Œè¯¥é”™è¯¯çŸ¥é“äº†å®ƒçš„å»å‘ã€‚ <br><br> å”¯ä¸€çš„æ•Œäººçœ‹èµ·æ¥å¹¶ä¸ä»¤äººå°è±¡æ·±åˆ»ã€‚ æˆ‘ä»¬éœ€è¦æˆç¾¤ç»“é˜Ÿï¼ å°±åƒä»»ä½•å¡”é˜²æ¸¸æˆä¸€æ ·ï¼Œæˆç¾¤ç»“é˜Ÿï¼ <br><br><h2> é€šçŸ¥ç©å®¶ </h2><br> åœ¨å¼€å§‹ç§»åŠ¨éƒ¨è½ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è­¦å‘Šç©å®¶å³å°†å‘ç”Ÿçš„æˆ˜æ–—ã€‚ æ­¤å¤–ï¼Œå€¼å¾—åœ¨å±å¹•é¡¶éƒ¨æ˜¾ç¤ºå½“å‰æ³¢æ•°ã€‚ <br><br>  <em>Wave</em>ä¿¡æ¯æ˜¯å‡ ä¸ªGameObjectsæ‰€å¿…éœ€çš„ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°<em>GameManagerçš„GameManagerBehavior</em>ç»„ä»¶ä¸­ã€‚ <br><br> åœ¨IDEä¸­æ‰“å¼€<em>GameManagerBehavior.cs</em>å¹¶æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªå˜é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Text waveLabel; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject[] nextWaveLabels;</code> </pre> <br>  <code>waveLabel</code>å°†æŒ‡å‘æ³¢å½¢ç¼–å·è¾“å‡ºæ ‡ç­¾çš„é“¾æ¥å­˜å‚¨åœ¨å±å¹•çš„å³ä¸Šè§’ã€‚  <code>nextWaveLabels</code>å­˜å‚¨ä¸¤ä¸ª<code>nextWaveLabels</code>åˆ›å»ºåŠ¨ç”»çš„ç»„åˆï¼Œæˆ‘ä»¬å°†åœ¨æ–°ä¸€è½®æµªæ½®å¼€å§‹æ—¶æ˜¾ç¤ºå®ƒä»¬ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7c/650/8f0/e7c6508f018c4382e490a4f6bee31e1f.gif"></div><br> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›åˆ°Unityã€‚ åœ¨â€œ <em>å±‚æ¬¡ç»“æ„â€ä¸­</em>é€‰æ‹©<em>GameManager</em> ã€‚ å•å‡»â€œ <em>æ³¢å½¢æ ‡ç­¾</em> â€å³ä¾§çš„åœ†åœˆï¼Œç„¶ååœ¨â€œ <em>é€‰æ‹©æ–‡æœ¬â€</em>å¯¹è¯æ¡†ä¸­ï¼Œä»â€œ <em>åœºæ™¯â€</em>é€‰é¡¹å¡ä¸­é€‰æ‹©â€œ <em>WaveLabel</em> <em>â€</em> ã€‚ <br><br> ç°åœ¨å°†<em>â€œä¸‹ä¸€æ³¢æ ‡ç­¾</em>çš„<em>å¤§å°</em> â€è®¾ç½®ä¸º<em>2</em> ã€‚ ç°åœ¨ï¼Œå°†<em>å…ƒç´ 0</em>è®¾ç½®ä¸º<em>NextWaveBottomLabel</em> ï¼Œå¯¹äº<em>å…ƒç´ 1ï¼Œå°†</em> <em>NextWaveTopLabelè®¾ç½®</em>ä¸ºä¸Wave Labelç›¸åŒã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d19/725/1f8/d197251f821c7262c638df487fb752cd.png"></div><br>  <i>è¿™å°±æ˜¯ç°åœ¨çš„æ¸¸æˆç®¡ç†å‘˜è¡Œä¸º</i> <br><br> å¦‚æœç©å®¶è¾“äº†ï¼Œé‚£ä¹ˆä»–åº”è¯¥ä¸ä¼šçœ‹åˆ°æœ‰å…³ä¸‹ä¸€æ³¢çš„æ¶ˆæ¯ã€‚ è¦å¤„ç†è¿™ç§æƒ…å†µï¼Œè¯·è¿”å›<em>GameManagerBehavior.cs</em>å¹¶æ·»åŠ å¦ä¸€ä¸ªå˜é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> gameOver = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre> <br> åœ¨<code>gameOver</code>æˆ‘ä»¬å°†å­˜å‚¨ç©å®¶æ˜¯å¦è¾“äº†çš„ä»·å€¼ã€‚ <br><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨å±æ€§å°†æ¸¸æˆå…ƒç´ ä¸å½“å‰waveåŒæ­¥ã€‚ å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°<code>GameManagerBehavior</code> ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> wave; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Wave { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> wave; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { wave = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!gameOver) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; nextWaveLabels.Length; i++) { nextWaveLabels[i].GetComponent&lt;Animator&gt;().SetTrigger(<span class="hljs-string"><span class="hljs-string">"nextWave"</span></span>); } } waveLabel.text = <span class="hljs-string"><span class="hljs-string">"WAVE: "</span></span> + (wave + <span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre> <br> åˆ›å»ºç§æœ‰å˜é‡ï¼Œå±æ€§å’Œgetterå¯¹æ‚¨æ¥è¯´åº”è¯¥å·²ç»å¾ˆç†Ÿæ‚‰äº†ã€‚ ä½†æ˜¯ï¼Œæœ‰äº†äºŒä¼ æ‰‹ï¼Œä¸€åˆ‡éƒ½ä¼šå˜å¾—æ›´åŠ æœ‰è¶£ã€‚ <br><br> æˆ‘ä»¬ç»™<code>wave</code>æŒ‡å®š<code>wave</code>æ–°<code>value</code> ã€‚ <br><br> ç„¶åæˆ‘ä»¬æ£€æŸ¥æ¸¸æˆæ˜¯å¦å®Œæˆã€‚ å¦‚æœä¸æ˜¯ï¼Œåˆ™éå†æ‰€æœ‰<em>nextWaveLabels</em>æ ‡ç­¾-è¿™äº›æ ‡ç­¾å…·æœ‰<em>Animator</em>ç»„ä»¶ã€‚ ä¸ºäº†å¯ç”¨<em>Animator</em>åŠ¨ç”»ï¼Œæˆ‘ä»¬<em>å®šä¹‰</em>äº†<em>nextWave</em>è§¦å‘å™¨ã€‚ <br><br> æœ€åï¼Œæˆ‘ä»¬å°†<code>waveLabel</code>çš„<code>text</code>è®¾ç½®ä¸º<code>wave + 1</code> ã€‚ ä¸ºä»€ä¹ˆ<code>+1</code> ï¼Ÿ æ™®é€šäººä¸ä¼šä»å¤´å¼€å§‹è®¡ç®—ï¼ˆæ˜¯çš„ï¼Œè¿™å¾ˆå¥‡æ€ªï¼‰ã€‚ <br><br> åœ¨<code>Start()</code>è®¾ç½®æ­¤å±æ€§çš„å€¼ï¼š <br><br><pre> <code class="cs hljs">Wave = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br> æˆ‘ä»¬ä»æ•°å­—<em>0</em> <code>Wave</code>å¼€å§‹è®¡æ•°ã€‚ <br><br> ä¿å­˜æ–‡ä»¶å¹¶åœ¨Unityä¸­è¿è¡Œåœºæ™¯ã€‚  Waveæ ‡ç­¾å°†æ­£ç¡®æ˜¾ç¤º1ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b0d/edf/546/b0dedf546c1b6ad9b0d0b91c5021212d.png"></div><br>  <i>å¯¹äºç©å®¶è€Œè¨€ï¼Œä¸€åˆ‡éƒ½å§‹äºç¬¬ä¸€æ³¢ã€‚</i> <br><br><h2> æ³¢æµªï¼šåˆ¶é€ å¤§é‡æ•Œäºº </h2><br> è¿™çœ‹èµ·æ¥ä¼¼ä¹å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯è¦å¤§ä¸¾è¿›æ”»ï¼Œå°±å¿…é¡»åˆ¶é€ æ›´å¤šçš„æ•Œäºº-å°½ç®¡æˆ‘ä»¬ä¸çŸ¥é“è¯¥æ€ä¹ˆåšã€‚ è€Œä¸”ï¼Œåœ¨å½“å‰æ³¢è¢«æ‘§æ¯ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åˆ›å»ºä¸‹ä¸€æ³¢ã€‚ <br><br> ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¸¸æˆåº”è¯¥èƒ½å¤Ÿè¯†åˆ«åœºæ™¯ä¸­æ•Œäººçš„å­˜åœ¨ï¼Œè€Œ<em>æ ‡ç­¾</em>æ˜¯åœ¨æ­¤å¤„è¯†åˆ«æ¸¸æˆå¯¹è±¡çš„å¥½æ–¹æ³•ã€‚ <br><br><h3> æ•Œäººæ ‡è®° </h3><br> åœ¨é¡¹ç›®æµè§ˆå™¨ä¸­é€‰æ‹©<em>æ•Œäºº</em>é¢„åˆ¶ä»¶ã€‚ åœ¨<em>æ£€æŸ¥å™¨</em>é¡¶éƒ¨<em>ï¼Œ</em>å•å‡»â€œ <em>æ ‡ç­¾â€</em>ä¸‹æ‹‰åˆ—è¡¨ï¼Œç„¶åé€‰æ‹©â€œ <em>æ·»åŠ æ ‡ç­¾â€</em> ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/be0/7ea/b29/be07eab29a25c69751add67ce4faa283.png"></div><br> åˆ›å»ºä¸€ä¸ªåä¸º<em>Enemy</em>çš„<em>æ ‡ç­¾</em> ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df1/c66/d02/df1c66d02e0c29a7a6ec0b615dbbd2fc.png"></div><br> é€‰æ‹©é¢„åˆ¶<em>æ•Œäºº</em> ã€‚ åœ¨<em>æ£€æŸ¥å™¨ä¸­ï¼Œ</em>ä¸ºå…¶è®¾ç½®<em>â€œ</em> <em>æ•Œäººâ€</em> <em>æ ‡ç­¾</em> ã€‚ <br><br><h3> å®šä¹‰æ•Œäººçš„æµªæ½® </h3><br> ç°åœ¨æˆ‘ä»¬éœ€è¦è®¾ç½®æ•Œäººçš„æµªæ½®ã€‚ åœ¨IDEä¸­æ‰“å¼€<em>SpawnEnemy.cs</em> ï¼Œå¹¶åœ¨<code>SpawnEnemy</code>ä¹‹å‰æ·»åŠ ä»¥ä¸‹ç±»å®ç°ï¼š <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">System.Serializable</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Wave</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject enemyPrefab; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> spawnInterval = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> maxEnemies = <span class="hljs-number"><span class="hljs-number">20</span></span>; }</code> </pre> <br>  <em>Wave</em>åŒ…å«<code>enemyPrefab</code>åˆ›å»ºè¯¥æ³¢æµªä¸­æ‰€æœ‰æ•Œäººçš„å®ä¾‹çš„åŸºç¡€ï¼Œ <code>spawnInterval</code>è¯¥æ³¢æµªä¸­çš„æ•Œäººä¹‹é—´çš„æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰å’Œ<code>maxEnemies</code>æ­¤æ³¢æµªä¸­åˆ›å»ºçš„æ•Œäººçš„æ•°é‡ã€‚ <br><br> è¯¥ç±»æ˜¯<em>Serializable</em> ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Inspectorä¸­æ›´æ”¹å…¶å€¼ã€‚ <br><br> å°†ä»¥ä¸‹å˜é‡æ·»åŠ åˆ°<code>SpawnEnemy</code>ç±»ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Wave[] waves; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> timeBetweenWaves = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameManagerBehavior gameManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> lastSpawnTime; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> enemiesSpawned = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®äº†ç”Ÿæˆæ•Œäººçš„å˜é‡ï¼Œè¿™ä¸åœ¨è·¯çº¿ä¸Šçš„ç‚¹ä¹‹é—´ç§»åŠ¨æ•Œäººçš„æ–¹å¼éå¸¸ç›¸ä¼¼ã€‚ <br><br> æˆ‘ä»¬å°†å•ä¸ªæ•Œäººçš„<code>waves</code>è®¾ç½®ä¸ºwaveï¼Œå¹¶åœ¨æ•Œäºº<code>enemiesSpawned</code>å’Œ<code>lastSpawnTime</code>è·Ÿè¸ªåˆ›å»ºçš„æ•Œäººçš„æ•°é‡ä»¥åŠåˆ›å»ºå®ƒä»¬çš„æ—¶é—´ã€‚ <br><br> åœ¨æ‰€æœ‰è¿™äº›æ€æ­»ä¹‹åï¼Œç©å®¶éœ€è¦æ—¶é—´å‘¼å¸ï¼Œå› æ­¤å°†<code>timeBetweenWaves</code>è®¾ç½®ä¸º5ç§’ã€‚ <br><br> ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢<code>Start()</code>å†…å®¹ã€‚ <br><br><pre> <code class="cs hljs">lastSpawnTime = Time.time; gameManager = GameObject.Find(<span class="hljs-string"><span class="hljs-string">"GameManager"</span></span>).GetComponent&lt;GameManagerBehavior&gt;();</code> </pre> <br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸º<code>lastSpawnTime</code>åˆ†é…å½“å‰æ—¶é—´ï¼Œå³åœºæ™¯åŠ è½½åè„šæœ¬å¼€å§‹çš„æ—¶é—´ã€‚ ç„¶åæˆ‘ä»¬å¾—åˆ°äº†å·²ç»ç†Ÿæ‚‰çš„<code>GameManagerBehavior</code> ã€‚ <br><br> å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°<code>Update()</code> ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// 1 int currentWave = gameManager.Wave; if (currentWave &lt; waves.Length) { // 2 float timeInterval = Time.time - lastSpawnTime; float spawnInterval = waves[currentWave].spawnInterval; if (((enemiesSpawned == 0 &amp;&amp; timeInterval &gt; timeBetweenWaves) || timeInterval &gt; spawnInterval) &amp;&amp; enemiesSpawned &lt; waves[currentWave].maxEnemies) { // 3 lastSpawnTime = Time.time; GameObject newEnemy = (GameObject) Instantiate(waves[currentWave].enemyPrefab); newEnemy.GetComponent&lt;MoveEnemy&gt;().waypoints = waypoints; enemiesSpawned++; } // 4 if (enemiesSpawned == waves[currentWave].maxEnemies &amp;&amp; GameObject.FindGameObjectWithTag("Enemy") == null) { gameManager.Wave++; gameManager.Gold = Mathf.RoundToInt(gameManager.Gold * 1.1f); enemiesSpawned = 0; lastSpawnTime = Time.time; } // 5 } else { gameManager.gameOver = true; GameObject gameOverText = GameObject.FindGameObjectWithTag ("GameWon"); gameOverText.GetComponent&lt;Animator&gt;().SetBool("gameOver", true); }</span></span></code> </pre> <br> è®©æˆ‘ä»¬é€æ­¥åˆ†æå®ƒï¼š <br><br><ol><li> æˆ‘ä»¬è·å–å½“å‰æ³¢çš„ç´¢å¼•ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦ä¸ºæœ€åä¸€ä¸ªã€‚ </li><li> å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†è®¡ç®—åœ¨å‰ä¸€ä¸ªæ•Œäººäº§ç”Ÿä¹‹åç»è¿‡çš„æ—¶é—´ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦è¯¥åˆ›å»ºä¸€ä¸ªæ•Œäººäº†ã€‚ è¿™é‡Œæˆ‘ä»¬è€ƒè™‘ä¸¤ç§æƒ…å†µã€‚ å¦‚æœè¿™æ˜¯æ³¢æµªä¸­çš„ç¬¬ä¸€ä¸ªæ•Œäººï¼Œåˆ™æˆ‘ä»¬æ£€æŸ¥<code>timeInterval</code>æ˜¯å¦<code>timeInterval</code> <code>timeBetweenWaves</code> ã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬æ£€æŸ¥<code>timeInterval</code>æ˜¯å¦<code>timeInterval</code> <code>spawnInterval</code> waveã€‚ æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½è¦æ£€æŸ¥æ˜¯å¦æ²¡æœ‰åœ¨è¿™ä¸€æ³¢ä¸­åˆ¶é€ å‡ºæ‰€æœ‰æ•Œäººã€‚ </li><li> å¦‚æœ‰å¿…è¦ï¼Œç”Ÿæˆæ•Œäººï¼Œå¹¶åˆ›å»ºæ•Œäººçš„å®ä¾‹ã€‚ è¿˜å¯ä»¥å¢åŠ <code>enemiesSpawned</code>çš„ä»·å€¼ã€‚ </li><li> æ£€æŸ¥å±å¹•ä¸Šçš„æ•Œäººæ•°é‡ã€‚ å¦‚æœä»–ä»¬ä¸åœ¨é‚£ï¼Œè€Œè¿™æ˜¯æµªæ½®ä¸­çš„æœ€åä¸€ä¸ªæ•Œäººï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ›å»ºä¸‹ä¸€ä¸ªæµªæ½®ã€‚ åŒæ ·åœ¨æµªæ½®ç»“æŸæ—¶ï¼Œæˆ‘ä»¬ç»™ç©å®¶æ‰€æœ‰å‰©ä½™é‡‘å¸çš„10ï¼…ã€‚ </li><li> å‡»è´¥æœ€åä¸€æ³¢åï¼Œåœ¨è¿™é‡Œæ’­æ”¾æ¸¸æˆèƒœåˆ©çš„åŠ¨ç”»ã€‚ </li></ol><br><h3> è®¾ç½®ç”Ÿæˆé—´éš” </h3><br> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›åˆ°Unityã€‚ åœ¨â€œ <em>å±‚æ¬¡ç»“æ„â€ä¸­</em>é€‰æ‹©<em>Road</em>å¯¹è±¡ã€‚ åœ¨<em>æ£€æŸ¥å™¨ä¸­ï¼Œ</em>å°†<em>Waves</em>å¯¹è±¡çš„<em>Size</em>è®¾ç½®ä¸º<em>4</em> ã€‚ <br><br> ç°åœ¨ï¼Œä¸ºæ‰€æœ‰å››ä¸ªå…ƒç´ é€‰æ‹©ä¸€ä¸ª<em>æ•Œäºº</em>å¯¹è±¡ä½œä¸º<em>Enemy Prefab</em> ã€‚ å¦‚ä¸‹é…ç½®<em>Spawn Interval</em>å’Œ<em>Max Enemies</em>å­—æ®µï¼š <br><br><ul><li>  <em>å…ƒç´ 0</em> ï¼šç”Ÿæˆé—´éš”ï¼š <em>2.5</em> ï¼Œæœ€å¤§æ•Œäººï¼š <em>5</em> </li><li>  <em>å…ƒç´ 1</em> ï¼šäº§ç”Ÿé—´éš”ï¼š <em>2</em> ï¼Œæœ€å¤§æ•Œäººï¼š <em>10</em> </li><li>  <em>å…ƒç´ 2</em> ï¼šç”Ÿæˆé—´éš”ï¼š <em>2</em> ï¼Œæœ€å¤§æ•Œäººï¼š <em>15</em> </li><li>  <em>å…ƒç´ 3</em> ï¼šç”Ÿæˆæ—¶é—´é—´éš”ï¼š <em>1</em> ï¼Œæœ€å¤§æ•Œäººï¼š <em>5</em> </li></ul><br> å®Œæˆçš„æ–¹æ¡ˆåº”å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff7/0fa/954/ff70fa95476112b51dfb83505f9a785b.png"></div><br> å½“ç„¶ï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨è¿™äº›å€¼æ¥å¢åŠ æˆ–å‡å°‘å¤æ‚æ€§ã€‚ <br><br> å¯åŠ¨æ¸¸æˆã€‚ æ˜¯çš„ ç”²è™«å·²ç»å¼€å§‹äº†æ‚¨çš„cookieä¹‹æ—…ï¼ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a7f/097/4d3/a7f0974d36a188b5575a3e70a8488a4a.gif" alt="è™«å­"></div><br><h3> é™„åŠ ä»»åŠ¡ï¼šæ·»åŠ ä¸åŒç±»å‹çš„æ•Œäºº </h3><br> æ²¡æœ‰ä¸€ç§å¡”é˜²æ¸¸æˆå¯ä»¥è¢«è®¤ä¸ºåªæœ‰ä¸€ç§ç±»å‹çš„æ•Œäººå°±å¯ä»¥å®Œæˆã€‚ å¹¸è¿çš„æ˜¯ï¼Œ <em>Prefabs</em>æ–‡ä»¶å¤¹ä¸­è¿˜<em>åŒ…å«</em> <em>Enemy2</em> ã€‚ <br><br> åœ¨<em>æ£€æŸ¥å™¨ä¸­ï¼Œ</em>é€‰æ‹©â€œ <em>Prefabs \ Enemy2â€ï¼Œ</em>ç„¶åå‘å…¶æ·»åŠ <em>MoveEnemy</em>è„šæœ¬ã€‚ å°†<em>Speed</em>è®¾ç½®ä¸º<em>3</em>å¹¶è®¾ç½®<em>Enemy</em> <em>æ ‡ç­¾</em> ã€‚ ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¿«é€Ÿçš„æ•Œäººï¼Œè®©ç©å®¶ä¸ä¼šæ”¾æ¾ï¼ <br><br><h2> ç©å®¶ç”Ÿæ´»æ›´æ–° </h2><br> å³ä½¿æˆç¾¤çš„æ•Œäººæ”»å‡»cookieï¼Œç©å®¶ä¹Ÿä¸ä¼šå—åˆ°ä¼¤å®³ã€‚ ä½†æ˜¯å¾ˆå¿«æˆ‘ä»¬å°†ä¿®å¤å®ƒã€‚ å¦‚æœç©å®¶å…è®¸æ•Œäººå·è¢­ï¼Œåˆ™ç©å®¶å¿…é¡»é­å—ç—›è‹¦ã€‚ <br><br> åœ¨IDEä¸­æ‰“å¼€<em>GameManagerBehavior.cs</em>å¹¶æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªå˜é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Text healthLabel; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject[] healthIndicator;</code> </pre> <br> æˆ‘ä»¬ä½¿ç”¨<code>healthLabel</code>æ¥è·å–ç©å®¶çš„ç”Ÿå‘½ä»·å€¼ï¼Œå¹¶ä½¿ç”¨<code>healthIndicator</code>æ¥è·å–äº”ä¸ªå’€åš¼é¥¼å¹²çš„ç»¿è‰²å°æ€ªç‰©-å®ƒä»¬åªæ˜¯è±¡å¾ç©å®¶çš„å¥åº·ï¼› å®ƒæ¯”æ ‡å‡†çš„å¥åº·æŒ‡æ ‡æ›´æœ‰è¶£ã€‚ <br><br><h3> å¥åº·ç®¡ç† </h3><br> ç°åœ¨ï¼Œåœ¨<code>GameManagerBehavior</code>æ·»åŠ ä¸€ä¸ªç”¨äºå­˜å‚¨ç©å®¶å¥åº·çŠ¶å†µçš„<code>GameManagerBehavior</code> ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> health; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Health { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> health; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1 if (value &lt; health) { Camera.main.GetComponent&lt;CameraShake&gt;().Shake(); } // 2 health = value; healthLabel.text = "HEALTH: " + health; // 3 if (health &lt;= 0 &amp;&amp; !gameOver) { gameOver = true; GameObject gameOverText = GameObject.FindGameObjectWithTag("GameOver"); gameOverText.GetComponent&lt;Animator&gt;().SetBool("gameOver", true); } // 4 for (int i = 0; i &lt; healthIndicator.Length; i++) { if (i &lt; Health) { healthIndicator[i].SetActive(true); } else { healthIndicator[i].SetActive(false); } } } }</span></span></code> </pre> <br> è¿™å°±æ˜¯æˆ‘ä»¬ç®¡ç†ç©å®¶å¥åº·çš„æ–¹å¼ã€‚ åŒæ ·ï¼Œä»£ç çš„ä¸»è¦éƒ¨åˆ†ä½äºè®¾ç½®å™¨ä¸­ï¼š <br><br><ol><li> å¦‚æœæˆ‘ä»¬é™ä½äº†ç©å®¶çš„å¥åº·çŠ¶å†µï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨<code>CameraShake</code>ç»„ä»¶æ¥åˆ›é€ æ¼‚äº®çš„éœ‡åŠ¨æ•ˆæœã€‚ è¯¥è„šæœ¬åŒ…å«åœ¨å¯ä¸‹è½½çš„é¡¹ç›®ä¸­ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚ </li><li> æˆ‘ä»¬æ›´æ–°å±å¹•å·¦ä¸Šè§’çš„ç§æœ‰å˜é‡å’Œè¿è¡ŒçŠ¶å†µæ ‡ç­¾ã€‚ </li><li> å¦‚æœè¿è¡ŒçŠ¶å†µä¸‹é™åˆ°0å¹¶ä¸”æ¸¸æˆå°šæœªç»“æŸï¼Œåˆ™å°†<code>gameOver</code>ä¸º<code>true</code>å¹¶å¯åŠ¨<code>gameOver</code>åŠ¨ç”»ã€‚ </li><li> æˆ‘ä»¬ä»Cookieä¸­åˆ é™¤å…¶ä¸­ä¸€ä¸ªæ€ªç‰©ã€‚ å¦‚æœä»…å°†å…¶å…³é—­ï¼Œåˆ™å¯ä»¥æ›´è½»æ¾åœ°ç¼–å†™æ­¤éƒ¨åˆ†ï¼Œä½†æ˜¯åœ¨æ­¤å¤„ï¼Œå¦‚æœæ·»åŠ äº†è¿è¡ŒçŠ¶å†µï¼Œæˆ‘ä»¬å°†æ”¯æŒé‡æ–°åŒ…å«ã€‚ </li></ol><br> æˆ‘ä»¬åœ¨<code>Start()</code>åˆå§‹åŒ–<code>Health</code> ï¼š <br><br><pre> <code class="cs hljs">Health = <span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre> <br> å½“åœºæ™¯å¼€å§‹æ’­æ”¾æ—¶ï¼Œæˆ‘ä»¬å°†â€œ <code>Health</code>è®¾ç½®ä¸º<code>5</code> ã€‚ <br><br> å®Œæˆæ‰€æœ‰è¿™äº›æ“ä½œåï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨é”™è¯¯è¿›å…¥Cookieæ—¶æ›´æ–°ç©å®¶çš„å¥åº·çŠ¶å†µã€‚ ä¿å­˜æ–‡ä»¶ï¼Œç„¶åè½¬åˆ°IDEçš„<em>MoveEnemy.cs</em>è„šæœ¬ã€‚ <br><br><h3> å¥åº·æ”¹å˜ </h3><br> è¦æ›´æ”¹æ‚¨çš„å¥åº·çŠ¶å†µï¼Œè¯·åœ¨<code>Update()</code>æ‰¾åˆ°å¸¦æœ‰<code>// TODO:  </code>å­—æ ·çš„<code>// TODO:  </code>å¹¶å°†å…¶æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç ï¼š <br><br><pre> <code class="cs hljs">GameManagerBehavior gameManager = GameObject.Find(<span class="hljs-string"><span class="hljs-string">"GameManager"</span></span>).GetComponent&lt;GameManagerBehavior&gt;(); gameManager.Health -= <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br> å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°<code>GameManagerBehavior</code>å¹¶ä»å…¶<code>Health</code>å‡å»å•ä½ã€‚ <br><br> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›åˆ°Unityã€‚ <br><br> åœ¨<em>å±‚æ¬¡ç»“æ„ä¸­</em>é€‰æ‹©ä¸€ä¸ª<em>GameManager</em> ï¼Œç„¶åé€‰æ‹©<em>HealthLabel</em>ä½œä¸ºå…¶<em>Health Label</em> ã€‚ <br><br> åœ¨<em>å±‚æ¬¡ç»“æ„ä¸­</em>å±•å¼€<em>Cookie</em>å¯¹è±¡ï¼Œå¹¶å°†å…¶äº”ä¸ªå­<em>HealthIndicators</em>æ‹–åŠ¨åˆ°<em>GameManagerçš„Health Indicator</em>æ•°ç»„ä¸­-å¥åº·æŒ‡æ ‡å°†æ˜¯åƒé¥¼å¹²çš„ç»¿è‰²å°æ€ªç‰©ã€‚ <br><br> è¿è¡Œåœºæ™¯ï¼Œç›´åˆ°é”™è¯¯åˆ°è¾¾cookieã€‚ ä»€ä¹ˆéƒ½ä¸åšï¼Œç›´åˆ°è¾“äº†ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d8/f4a/ea4/8d8f4aea4cec500c3894d233f402b7ba.gif" alt="Cookieæ”»å‡»"></div><br><h2> æ€ªç‰©å¤ä»‡ </h2><br> æ€ªç‰©åˆ°ä½äº†å—ï¼Ÿ æ˜¯çš„ æ•Œäººä¼šè¿›æ”»å—ï¼Ÿ æ˜¯çš„ï¼Œå®ƒä»¬çœ‹èµ·æ¥å¾ˆå±é™©ï¼ ç°åœ¨è¯¥å›ç­”è¿™äº›åŠ¨ç‰©äº†ï¼ <br><br> ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š <br><br><ul><li> å¥åº·é€šé“ï¼Œè®©ç©å®¶çŸ¥é“å“ªäº›æ•Œäººå¼ºè€Œå“ªäº›å¼± </li><li> æ£€æµ‹æ€ªç‰©èŒƒå›´å†…çš„æ•Œäºº </li><li> åšå‡ºå†³å®š-å‘å“ªä¸ªæ•Œäººå°„å‡» </li><li> ä¸€å †è´å£³ </li></ul><br><h3> æ•Œäººçš„å¥åº·å§ </h3><br> ä¸ºäº†å®ç°å¥åº·ç­‰çº§ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªå›¾åƒ-ä¸€ä¸ªç”¨äºæ·±è‰²èƒŒæ™¯ï¼Œç¬¬äºŒä¸ªï¼ˆç»¿è‰²æ¡ç¨å°ï¼‰ï¼Œæˆ‘ä»¬å°†æ ¹æ®æ•Œäººçš„å¥åº·è¿›è¡Œç¼©æ”¾ã€‚ <br><br> ä»<em>é¡¹ç›®æµè§ˆå™¨</em> <em>æ‹–åˆ°Prefabs \ Enemy</em>åœºæ™¯ã€‚ <br><br> ç„¶ååœ¨<em>å±‚æ¬¡ç»“æ„ä¸­ï¼Œ</em>å°†<em>Images \ Objects \ HealthBarBackgroundæ‹–æ”¾</em>åˆ°<em>Enemyä¸Šï¼Œ</em>ä»¥å°†å…¶ä½œä¸ºå­çº§æ·»åŠ ã€‚ <br><br> åœ¨<em>æ£€æŸ¥å™¨ä¸­ï¼Œ</em>å°†<em>HealthBarBackground</em>çš„<em>ä½ç½®</em>è®¾ç½®ä¸º<em>ï¼ˆ0ï¼Œ1ï¼Œ-4ï¼‰</em> ã€‚ <br><br> ç„¶ååœ¨â€œ <em>é¡¹ç›®æµè§ˆå™¨â€ä¸­ï¼Œ</em>é€‰æ‹©â€œ <em>å›¾åƒ\å¯¹è±¡\å¥åº·æ â€</em> ï¼Œå¹¶ç¡®ä¿å…¶â€œ <em>é€è§†â€</em>ä¸ºâ€œ <em>å·¦â€</em> ã€‚ ç„¶åå°†å…¶æ·»åŠ ä¸º<em>å±‚æ¬¡ç»“æ„ä¸­</em>çš„<em>æ•Œäºº</em>çš„å­çº§ï¼Œå¹¶è®¾ç½®å…¶<em>ä½ç½®</em>å€¼<em>ï¼ˆ-0.63ï¼Œ1ï¼Œ-5ï¼‰</em> ã€‚ å¯¹äº<em>X</em> <em>æ¯”ä¾‹ï¼Œ</em>å°†å€¼è®¾ç½®ä¸º<em>125</em> ã€‚ <br><br> å°†ä¸€ä¸ªåä¸º<em>HealthBar</em>çš„æ–°<em>Cï¼ƒ</em>è„šæœ¬æ·»åŠ <em>åˆ°HealthBar</em>æ¸¸æˆå¯¹è±¡ã€‚ ç¨åæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œæ›´æ”¹ï¼Œä»¥ä½¿å…¶æ›´æ”¹è¿è¡ŒçŠ¶å†µæ çš„é•¿åº¦ã€‚ <br><br> åœ¨â€œ <em>å±‚æ¬¡ç»“æ„â€ä¸­</em>é€‰æ‹©ä¸€ä¸ª<em>æ•Œäºº</em>å¯¹è±¡åï¼Œè¯·ç¡®ä¿å…¶ä½ç½®ä¸º<em>ï¼ˆ20ï¼Œ0ï¼Œ0ï¼‰</em> ã€‚ <br><br> å•å‡»<em>æ£€æŸ¥å™¨</em>é¡¶éƒ¨çš„â€œ <em>åº”ç”¨â€</em> ï¼Œå°†æ‰€æœ‰æ›´æ”¹ä¿å­˜ä¸ºé¢„åˆ¶ä»¶çš„ä¸€éƒ¨åˆ†ã€‚ æœ€åï¼Œåˆ é™¤<em>Hierarchyä¸­</em>çš„<em>Enemy</em>å¯¹è±¡ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e7/b84/7d2/9e7b847d22d2fda1e146dbf9149f912e.png"></div><br> ç°åœ¨ï¼Œé‡å¤æ‰€æœ‰è¿™äº›æ­¥éª¤ï¼Œä¸º<em>Prefabs \ Enemy2</em>æ·»åŠ ä¸€ä¸ªå¥åº·æ ã€‚ <br><br><h3> æ›´æ”¹å¥åº·æ çš„é•¿åº¦ </h3><br> æ‰“å¼€IDE <em>HealthBar.cs</em>å¹¶æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> maxHealth = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> currentHealth = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> originalScale;</code> </pre> <br> åœ¨<code>maxHealth</code>ä¸­ï¼Œå°†å­˜å‚¨æ•Œäººçš„æœ€å¤§ç”Ÿå‘½å€¼ï¼Œè€Œåœ¨<code>currentHealth</code> ï¼Œå°†å­˜å‚¨å‰©ä½™çš„ç”Ÿå‘½å€¼ã€‚ æœ€åï¼Œ <code>originalScale</code>æ˜¯è¿è¡ŒçŠ¶å†µæ çš„åˆå§‹å¤§å°ã€‚ <br><br> å°†<code>originalScale</code>å¯¹è±¡ä¿å­˜åœ¨<code>Start()</code> ï¼š <br><br><pre> <code class="cs hljs">originalScale = gameObject.transform.localScale.x;</code> </pre> <br> æˆ‘ä»¬å­˜å‚¨<code>localScale</code>å±æ€§çš„<code>x</code>å€¼ã€‚ <br><br> é€šè¿‡å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°<code>Update()</code>æ¥è®¾ç½®è¿è¡ŒçŠ¶å†µæ çš„æ¯”ä¾‹ï¼š <br><br><pre> <code class="cs hljs">Vector3 tmpScale = gameObject.transform.localScale; tmpScale.x = currentHealth / maxHealth * originalScale; gameObject.transform.localScale = tmpScale;</code> </pre> <br> æˆ‘ä»¬å¯ä»¥å°†<code>localScale</code>å¤åˆ¶åˆ°ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½å•ç‹¬æ›´æ”¹å…¶<i>x</i>å€¼ã€‚ ç„¶åï¼Œæˆ‘ä»¬æ ¹æ®ç”²è™«çš„å½“å‰å¥åº·çŠ¶å†µè®¡ç®—æ–°çš„<i>x</i>æ¯”ä¾‹ï¼Œå¹¶å†æ¬¡å°†<code>localScale</code>å€¼åˆ†é…ç»™ä¸€ä¸ªä¸´æ—¶å˜é‡ã€‚ <br><br> ä¿å­˜æ–‡ä»¶å¹¶åœ¨Unityä¸­å¯åŠ¨æ¸¸æˆã€‚ åœ¨æ•Œäººä¹‹ä¸Šï¼Œæ‚¨ä¼šçœ‹åˆ°å¥åº·çš„æ¡çº¹ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd4/78a/29c/dd478a29c258b63dc809ca16de4ee16a.png"></div><br> åœ¨æ¸¸æˆè¿è¡Œæ—¶ï¼Œå±•å¼€â€œ <em>å±‚æ¬¡ç»“æ„â€</em>ä¸­çš„â€œ <em>æ•Œäººï¼ˆå…‹éš†ï¼‰â€</em>å¯¹è±¡ä¹‹ä¸€ï¼Œç„¶åé€‰æ‹©å…¶å­é¡¹<em>HealthBar</em> ã€‚ æ›´æ”¹å…¶<em>å½“å‰</em>è¿è¡ŒçŠ¶å†µå€¼ï¼Œå¹¶æŸ¥çœ‹å…¶è¿è¡ŒçŠ¶å†µæ å¦‚ä½•å˜åŒ–ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ee/af7/22c/5eeaf722c2e6a6ee1d2799380cdcfead.gif"></div><br><h3> æ£€æµ‹èŒƒå›´å†…çš„æ•Œäºº </h3><br> ç°åœ¨ï¼Œæˆ‘ä»¬çš„æ€ªç‰©éœ€è¦æ‰¾å‡ºè¦ç„å‡†çš„æ•Œäººã€‚ ä½†æ˜¯åœ¨æ„è¯†åˆ°è¿™ä¸ªæœºä¼šä¹‹å‰ï¼Œæ‚¨éœ€è¦å‡†å¤‡ã€Šæ€ªç‰©ä¸æ•Œäººã€‹ã€‚ <br><br> é€‰æ‹©â€œé¡¹ç›®æµè§ˆå™¨<em>Prefabs \ Monsterâ€</em> ï¼Œç„¶ååœ¨â€œ <em>æ£€æŸ¥</em>å™¨â€ <em>ä¸­å°†</em> â€œ <em>Circle Collider 2Dâ€</em>ç»„ä»¶æ·»åŠ åˆ°å…¶ä¸­ã€‚ <br><br> å°†å¯¹æ’æœºçš„â€œ <em>åŠå¾„â€</em>å‚æ•°è®¾ç½®ä¸º<em>2.5-</em>è¿™å°†æŒ‡ç¤ºæ€ªç‰©çš„æ”»å‡»åŠå¾„ã€‚ <br><br> é€‰æ‹©â€œ <em>æ˜¯è§¦å‘å™¨â€</em>å¤é€‰æ¡†ï¼Œä»¥ä½¿å¯¹è±¡ç©¿è¿‡è¯¥åŒºåŸŸè€Œä¸æ˜¯ä¸å…¶ç¢°æ’ã€‚ <br><br> æœ€åï¼Œåœ¨<em>æ£€æŸ¥å™¨</em>çš„é¡¶éƒ¨ï¼Œå°†â€œæ€ªç‰©çš„<em>å›¾å±‚</em> â€è®¾ç½®ä¸ºâ€œ <em>å¿½ç•¥å°„çº¿å¹¿æ’­â€</em> ã€‚ åœ¨å¯¹è¯æ¡†ä¸­ï¼Œå•å‡»â€œ <em>æ˜¯ï¼Œæ›´æ”¹å­é¡¹â€</em> ã€‚ å¦‚æœæœªé€‰æ‹©â€œå¿½ç•¥å°„çº¿å¹¿æ’­â€ï¼Œåˆ™å¯¹æ’æœºå°†å“åº”é¼ æ ‡å•å‡»äº‹ä»¶ã€‚ è¿™å°†æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ€ªç‰©ä¼šé˜»æ­¢å‘å¾€å…¶ä¸‹çš„Openspotå¯¹è±¡çš„äº‹ä»¶ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e3e/302/cf2/e3e302cf21adee1433fe2183120c2ba1.png"></div><br> ä¸ºäº†ç¡®ä¿åœ¨è§¦å‘åŒºåŸŸä¸­æ£€æµ‹åˆ°æ•Œäººï¼Œæˆ‘ä»¬éœ€è¦å‘å…¶æ·»åŠ ä¸€ä¸ªå¯¹æ’æœºå’Œåˆšä½“ï¼Œå› ä¸ºUnityä»…åœ¨å°†åˆšä½“é™„ç€åˆ°å…¶ä¸­ä¸€ä¸ªå¯¹æ’æœºæ—¶æ‰å‘é€è§¦å‘äº‹ä»¶ã€‚ <br><br> åœ¨<em>é¡¹ç›®æµè§ˆå™¨ä¸­ï¼Œ</em>é€‰æ‹©<em>Prefabs \ Enemy</em> ã€‚ æ·»åŠ <em>Rigidbody 2D</em>ç»„ä»¶ï¼Œç„¶åé€‰æ‹©<em>Kinematic</em>ä½œä¸º<em>Body Type</em> ã€‚ è¿™æ„å‘³ç€èº«ä½“å°†ä¸å—ç‰©ç†å½±å“ã€‚ <br><br> æ·»åŠ <em>åŠå¾„</em>ä¸º<em>1çš„</em> <em>Circle Collider 2D</em> ã€‚ å¯¹<em>Prefabs \ Enemy 2</em>é‡å¤è¿™äº›æ­¥éª¤ã€‚ <br><br> è§¦å‘å™¨å·²é…ç½®ï¼Œå› æ­¤æ€ªç‰©å°†äº†è§£æ•Œäººåœ¨å…¶ä½œç”¨èŒƒå›´å†…ã€‚ <br><br> æˆ‘ä»¬è¿˜éœ€è¦å‡†å¤‡ä¸€ä»¶äº‹ï¼šä¸€ä¸ªè„šæœ¬ï¼Œå‘Šè¯‰æ€ªç‰©ä½•æ—¶æ¶ˆç­äº†æ•Œäººï¼Œä»¥ä½¿å®ƒä»¬åœ¨ç»§ç»­å°„å‡»æ—¶ä¸ä¼šå¼•å‘å¼‚å¸¸ã€‚ <br><br> åˆ›å»ºä¸€ä¸ªåä¸º<em>EnemyDestructionDelegate</em>çš„æ–°<em>Cï¼ƒ</em>è„šæœ¬ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°<em>Enemy</em>å’Œ<em>Enemy2é¢„åˆ¶ä»¶ä¸­</em> ã€‚ <br><br> åœ¨IDEä¸­æ‰“å¼€<em>EnemyDestructionDelegate.cs</em>å¹¶æ·»åŠ ä»¥ä¸‹å§”æ‰˜å£°æ˜ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnemyDelegate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameObject enemy</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> EnemyDelegate enemyDelegate;</code> </pre> <br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>delegate</code> ï¼Œå³ä¸€ä¸ªå¯ä»¥ä½œä¸ºå˜é‡ä¼ é€’çš„å‡½æ•°çš„å®¹å™¨ã€‚ <br><br><blockquote>  <em>æ³¨æ„</em> ï¼šå½“ä¸€ä¸ªæ¸¸æˆå¯¹è±¡å¿…é¡»ä¸»åŠ¨é€šçŸ¥å…¶ä»–æ¸¸æˆå¯¹è±¡æ›´æ”¹æ—¶ï¼Œå°†ä½¿ç”¨å§”æ‰˜ã€‚ åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="ä»Unityæ–‡æ¡£ä¸­">Unityæ–‡æ¡£ä¸­</a>äº†è§£æœ‰å…³å§”æ‰˜çš„æ›´å¤šä¿¡æ¯ã€‚ </blockquote><br> æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDestroy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enemyDelegate != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { enemyDelegate(gameObject); } }</code> </pre> <br> é”€æ¯æ¸¸æˆå¯¹è±¡åï¼ŒUnityä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•å¹¶æ£€æŸ¥å§”æ‰˜æ˜¯å¦å­˜åœ¨<code>null</code>ä¸ç­‰å¼ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>gameObject</code>ä½œä¸ºå‚æ•°æ¥è°ƒç”¨å®ƒã€‚ è¿™æ ·ï¼Œæ‰€æœ‰æ³¨å†Œä¸ºä»£è¡¨çš„ç­”å·è€…éƒ½å¯ä»¥çŸ¥é“æ•Œäººå·²è¢«æ‘§æ¯ã€‚ <br><br> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›åˆ°Unityã€‚ <br><br><h3> æˆ‘ä»¬ç»™æ€ªç‰©æ€äººçš„è®¸å¯è¯ </h3><br> ç°åœ¨ï¼Œæ€ªç‰©å¯ä»¥åœ¨å…¶è¡ŒåŠ¨èŒƒå›´å†…æ£€æµ‹æ•Œäººã€‚ å°†æ–°çš„<em>Cï¼ƒ</em>è„šæœ¬æ·»åŠ åˆ°<em>Monster</em>é¢„åˆ¶ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º<em>ShootEnemies</em> ã€‚ <br><br> åœ¨IDEä¸­æ‰“å¼€<em>ShootEnemies.cs</em> ï¼Œå¹¶<code>using</code>ä»¥ä¸‹ç»“æ„å°†å…¶æ·»åŠ åˆ°å…¶ä¸­ä»¥è®¿é—®<code>Generics</code> ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic;</code> </pre> <br> æ·»åŠ ä¸€ä¸ªå˜é‡ä»¥è·Ÿè¸ªèŒƒå›´å†…çš„æ‰€æœ‰æ•Œäººï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;GameObject&gt; enemiesInRange;</code> </pre> <br> åœ¨æ•ŒäººèŒƒå›´å†…ï¼Œæˆ‘ä»¬å°†å­˜å‚¨èŒƒå›´å†…çš„æ‰€æœ‰æ•Œäººã€‚ <br><br> åˆå§‹åŒ–<code>Start()</code>çš„å­—æ®µã€‚ <br><br><pre> <code class="cs hljs">enemiesInRange = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;GameObject&gt;();</code> </pre> <br> ä¸€å¼€å§‹ï¼Œè¡ŒåŠ¨èŒƒå›´å†…æ²¡æœ‰æ•Œäººï¼Œå› æ­¤æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚ <br><br> å¡«å†™<code>enemiesInRange</code>åˆ—è¡¨ï¼ å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°è„šæœ¬ä¸­ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// 1 void OnEnemyDestroy(GameObject enemy) { enemiesInRange.Remove (enemy); } void OnTriggerEnter2D (Collider2D other) { // 2 if (other.gameObject.tag.Equals("Enemy")) { enemiesInRange.Add(other.gameObject); EnemyDestructionDelegate del = other.gameObject.GetComponent&lt;EnemyDestructionDelegate&gt;(); del.enemyDelegate += OnEnemyDestroy; } } // 3 void OnTriggerExit2D (Collider2D other) { if (other.gameObject.tag.Equals("Enemy")) { enemiesInRange.Remove(other.gameObject); EnemyDestructionDelegate del = other.gameObject.GetComponent&lt;EnemyDestructionDelegate&gt;(); del.enemyDelegate -= OnEnemyDestroy; } }</span></span></code> </pre> <br><ol><li> åœ¨<code>OnEnemyDestroy</code>æˆ‘ä»¬å°†æ•Œäººä»æ•Œäºº<code>enemiesInRange</code> ã€‚ å½“æ•Œäºº<code>OnTriggerEnter2D</code>åœ¨æ€ªç‰©å‘¨å›´çš„æ‰³æœºä¸Šæ—¶ï¼Œå°†<code>OnTriggerEnter2D</code> ã€‚ </li><li> ç„¶åï¼Œå°†æ•Œäººæ·»åŠ åˆ°æ•Œäººåˆ—è¡¨ä¸­ï¼Œå¹¶æ·»åŠ <code>EnemyDestructionDelegate</code>äº‹ä»¶<code>OnEnemyDestroy</code> ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¿è¯åœ¨æ•Œäººè¢«æ‘§æ¯æ—¶å°†<code>OnEnemyDestroy</code> ã€‚ æˆ‘ä»¬ä¸å¸Œæœ›æ€ªç‰©ä¸ºæ­»å»çš„æ•ŒäººèŠ±è´¹å¼¹è¯ï¼Œå¯¹å—ï¼Ÿ </li><li> åœ¨<code>OnTriggerExit2D</code>æˆ‘ä»¬ä»åˆ—è¡¨ä¸­åˆ é™¤æ•Œäººï¼Œå¹¶å–æ¶ˆæ³¨å†Œ<code>OnTriggerExit2D</code> ã€‚ ç°åœ¨æˆ‘ä»¬çŸ¥é“å“ªäº›æ•Œäººåœ¨å°„ç¨‹ä¹‹å†…ã€‚ </li></ol><br> ä¿å­˜æ–‡ä»¶å¹¶åœ¨Unityä¸­å¯åŠ¨æ¸¸æˆã€‚ ä¸ºäº†ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œè¯·<code>enemiesInRange</code>æ€ªç‰©ï¼Œå°†å…¶é€‰ä¸­ï¼Œç„¶åæŒ‰ç…§â€œ <code>enemiesInRange</code> â€ä¸­<code>enemiesInRange</code>åˆ—è¡¨ä¸­çš„æ›´æ”¹è¿›è¡Œ<code>enemiesInRange</code> ã€‚ <br><br><h3> ç›®æ ‡é€‰æ‹© </h3><br> æ€ªç‰©ç°åœ¨çŸ¥é“å“ªä¸ªæ•Œäººåœ¨å°„ç¨‹å†…ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ–¹åœ†å†…æœ‰å‡ ä¸ªæ•Œäººï¼Œä»–ä»¬ä¼šæ€ä¹ˆåšï¼Ÿ <br><br> å½“ç„¶ï¼Œå®ƒä»¬ä¼šæ”»å‡»æœ€é è¿‘è‚è„çš„é‚£ä¸€ä¸ªï¼ <br><br> æ‰“å¼€<em>MoveEnemy.cs</em> IDEè„šæœ¬ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªè®¡ç®—è¯¥æ€ªç‰©çš„æ–°æ–¹æ³•ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DistanceToGoal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; distance += Vector2.Distance( gameObject.transform.position, waypoints [currentWaypoint + <span class="hljs-number"><span class="hljs-number">1</span></span>].transform.position); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = currentWaypoint + <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; waypoints.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { Vector3 startPosition = waypoints [i].transform.position; Vector3 endPosition = waypoints [i + <span class="hljs-number"><span class="hljs-number">1</span></span>].transform.position; distance += Vector2.Distance(startPosition, endPosition); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distance; }</code> </pre> <br> è¯¥ä»£ç è®¡ç®—å‡ºæ•Œäººå°šæœªèµ°è¿‡çš„è·¯å¾„é•¿åº¦ã€‚ ä¸ºæ­¤ï¼Œå®ƒä½¿ç”¨<code>Distance</code> ï¼Œå®ƒè¢«è®¡ç®—ä¸º<code>Vector3</code>ä¸¤ä¸ªå®ä¾‹ä¹‹é—´çš„è·ç¦»ã€‚ <br><br> ç¨åæˆ‘ä»¬å°†ä½¿ç”¨æ­¤æ–¹æ³•æ‰¾å‡ºè¦æ”»å‡»çš„ç›®æ ‡ã€‚ ä½†æ˜¯ï¼Œå°½ç®¡æˆ‘ä»¬çš„æ€ªç‰©ä¸æ˜¯æ­¦è£…æ— åŠ©çš„ï¼Œæ‰€ä»¥é¦–å…ˆæˆ‘ä»¬ä¼šåšåˆ°è¿™ä¸€ç‚¹ã€‚ <br><br> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›Unityä»¥å¼€å§‹è®¾ç½®å¤–å£³ã€‚ <br><br><h3> è®©æˆ‘ä»¬ç»™æ€ªç‰©å£³ã€‚ å¾ˆå¤šè´å£³ï¼ </h3><br> ä»é¡¹ç›®æµè§ˆå™¨<em>æ‹–åˆ°</em> â€œ <em>å›¾åƒ/å¯¹è±¡/é¡¹ç›®ç¬¦å·1â€åœºæ™¯</em> ã€‚ å°†<em>z</em>ä¸Šçš„ä½ç½®è®¾ç½®ä¸º<em>-2</em> -xå’Œyä¸Šçš„ä½ç½®å¹¶ä¸é‡è¦ï¼Œå› ä¸ºæ¯æ¬¡åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æ¯æ¬¡åˆ›å»ºæ–°çš„å°„å¼¹å®ä¾‹æ—¶éƒ½å°†å®ƒä»¬è®¾ç½®ã€‚ <br><br> æ·»åŠ ä¸€ä¸ªåä¸º<em>BulletBehavior</em>çš„æ–°<em>Cï¼ƒ</em>è„šæœ¬ï¼Œç„¶ååœ¨IDEä¸­å‘å…¶æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> damage; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject target; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector3 startPosition; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector3 targetPosition; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> distance; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> startTime; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameManagerBehavior gameManager;</code> </pre> <br>  <code>speed</code>å†³å®šäº†å¼¹ä¸¸çš„é€Ÿåº¦ï¼› ä»åç§°ä¸­<code>damage</code>æ¸…æ¥šçœ‹å‡º<code>damage</code>çš„<code>damage</code> ã€‚ <br><br>  <code>target</code> ï¼Œ <code>startPosition</code>å’Œ<code>targetPosition</code>ç¡®å®šå¼¹ä¸¸çš„æ–¹å‘ã€‚ <br><br>  <code>distance</code>å’Œ<code>startTime</code>è·Ÿè¸ªå¼¹ä¸¸çš„å½“å‰ä½ç½®ã€‚ å½“ç©å®¶æ€æ­»æ•Œäººæ—¶ï¼Œ <code>gameManager</code>å¥–åŠ±ç©å®¶ã€‚ <br><br> åœ¨<code>Start()</code>åˆ†é…è¿™äº›å˜é‡çš„å€¼ï¼š <br><br><pre> <code class="cs hljs">startTime = Time.time; distance = Vector2.Distance (startPosition, targetPosition); GameObject gm = GameObject.Find(<span class="hljs-string"><span class="hljs-string">"GameManager"</span></span>); gameManager = gm.GetComponent&lt;GameManagerBehavior&gt;();</code> </pre> <br> <code>startTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è®¾ç½®å½“å‰æ—¶é—´çš„å€¼å¹¶è®¡ç®—èµ·å§‹ä½ç½®å’Œç›®æ ‡ä½ç½®ä¹‹é—´çš„è·ç¦»ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”ï¼Œç…§å¸¸è·å¾—</font></font><code>GameManagerBehavior</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦æ§åˆ¶å¼¹ä¸¸çš„â€‹â€‹è¿åŠ¨ï¼Œè¯·æ·»åŠ </font></font><code>Update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹ä»£ç ï¼š</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// 1 float timeInterval = Time.time - startTime; gameObject.transform.position = Vector3.Lerp(startPosition, targetPosition, timeInterval * speed / distance); // 2 if (gameObject.transform.position.Equals(targetPosition)) { if (target != null) { // 3 Transform healthBarTransform = target.transform.Find("HealthBar"); HealthBar healthBar = healthBarTransform.gameObject.GetComponent&lt;HealthBar&gt;(); healthBar.currentHealth -= Mathf.Max(damage, 0); // 4 if (healthBar.currentHealth &lt;= 0) { Destroy(target); AudioSource audioSource = target.GetComponent&lt;AudioSource&gt;(); AudioSource.PlayClipAtPoint(audioSource.clip, transform.position); gameManager.Gold += 50; } } Destroy(gameObject); }</span></span></code> </pre> <br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬ä½¿ç”¨</font></font><code>Vector3.Lerp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´çš„æ’å€¼</font><font style="vertical-align: inherit;">æ¥è®¡ç®—å¼¹ä¸¸çš„æ–°</font><font style="vertical-align: inherit;">ä½ç½®ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœå¼¹ä¸¸åˆ°è¾¾</font></font><code>targetPosition</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™æˆ‘ä»¬æ£€æŸ¥</font><font style="vertical-align: inherit;">å¼¹ä¸¸</font><font style="vertical-align: inherit;">æ˜¯å¦ä»ç„¶å­˜åœ¨</font></font><code>target</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è·å¾—äº†</font></font><code>HealthBar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®æ ‡</font><font style="vertical-align: inherit;">çš„ç»„æˆéƒ¨åˆ†ï¼Œ</font><font style="vertical-align: inherit;">å¹¶é€šè¿‡</font></font><code>damage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°„å¼¹</font><font style="vertical-align: inherit;">çš„å¤§å°é™ä½äº†å®ƒçš„ç”Ÿå‘½å€¼</font><font style="vertical-align: inherit;">ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœæ•Œäººçš„ç”Ÿå‘½å€¼é™ä½åˆ°é›¶ï¼Œæˆ‘ä»¬å°†æ‘§æ¯å®ƒï¼Œé‡ç°å£°éŸ³æ•ˆæœï¼Œå¹¶å¥–åŠ±ç©å®¶å‡†ç¡®æ€§ã€‚ </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¿å­˜æ–‡ä»¶å¹¶è¿”å›åˆ°Unityã€‚ </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æˆ‘ä»¬åšå¤§è´å£³ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ€ªç‰©å¼€å§‹ä»¥é«˜æ°´å¹³å°„å‡»æ›´å¤šçš„ç‚®å¼¹ï¼Œé‚£ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿå¹¸è¿çš„æ˜¯ï¼Œè¿™å¾ˆå®¹æ˜“å®ç°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet1</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¸¸æˆå¯¹è±¡</font><font style="vertical-align: inherit;">ä»â€œ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±‚æ¬¡ç»“æ„</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ </font><em><font style="vertical-align: inherit;">æ‹–åˆ°</font></em><font style="vertical-align: inherit;"> â€œ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®â€</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€‰é¡¹å¡ä¸Šï¼Œ</font><font style="vertical-align: inherit;">ä»¥åˆ›å»ºå°„å¼¹é¢„åˆ¶ä»¶ã€‚ä»åœºæ™¯ä¸­åˆ é™¤åŸå§‹å¯¹è±¡-æˆ‘ä»¬å°†ä¸å†éœ€è¦å®ƒã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet1</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¢„åˆ¶ä»¶å¤åˆ¶</font><em><font style="vertical-align: inherit;">ä¸¤æ¬¡</font></em><font style="vertical-align: inherit;">ã€‚å‘½å</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet3</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å‰¯æœ¬</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€‰æ‹©</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚åœ¨</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥å™¨ä¸­ï¼Œ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†â€œ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprite </font></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendererâ€</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»„ä»¶</font><font style="vertical-align: inherit;">çš„â€œ </font><em><font style="vertical-align: inherit;">Spriteâ€</font></em><font style="vertical-align: inherit;">å­—æ®µè®¾ç½®</font><font style="vertical-align: inherit;">ä¸ºâ€œ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Images / Objects / Bullet2â€</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿Bullet2æ¯”Bullet1å¤šä¸€ç‚¹ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡å¤æ­¤è¿‡ç¨‹ï¼Œå°†Bullet3 </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¢„åˆ¶</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„ç²¾çµæ›´æ”¹</font><font style="vertical-align: inherit;">ä¸º</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Images / Objects / Bullet3</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨â€œ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­å¼¹è¡Œä¸ºâ€ä¸­ï¼Œ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å°†</font><font style="vertical-align: inherit;">è¿›ä¸€æ­¥</font><font style="vertical-align: inherit;">è°ƒæ•´ç”±ç‚®å¼¹é€ æˆçš„ä¼¤å®³ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨â€œ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®â€</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€‰é¡¹å¡ä¸­é€‰æ‹©</font><font style="vertical-align: inherit;">é¢„åˆ¶çš„</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet1</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½ çœ‹åˆ°</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­å¼¹è¡Œä¸ºï¼ˆè„šæœ¬ï¼‰</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå®ƒå¯ä»¥å°†</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼¤å®³</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸º</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet1</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡æ¡£bullet2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet3</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æˆ–æ‚¨å–œæ¬¢çš„ä»»ä½•å…¶ä»–å€¼ã€‚ </font></font><br><br><blockquote> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæˆ‘æ›´æ”¹äº†å€¼ï¼Œä»¥ä¾¿åœ¨è¾ƒé«˜çº§åˆ«ä¸‹æŸåçš„ä»·æ ¼ä¼šæ›´é«˜ã€‚</font><font style="vertical-align: inherit;">è¿™æ ·å¯ä»¥é˜²æ­¢å‡çº§ç¨‹åºå…è®¸ç©å®¶åœ¨æœ€ä½³ç‚¹å‡çº§æ€ªç‰©ã€‚</font></font></blockquote><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c0a/e2d/da2/c0ae2dda288d44bc380864dd1e85f3b6.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¢„åˆ¶å£³-å°ºå¯¸éšçº§åˆ«å¢åŠ </font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ”¹å˜ç‚®å¼¹æ°´å¹³ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†ä¸åŒçš„å¤–å£³åˆ†é…ç»™ä¸åŒçº§åˆ«çš„æ€ªç‰©ï¼Œä»¥ä¾¿æ›´å¼ºçš„æ€ªç‰©æ›´å¿«åœ°æ¶ˆç­æ•Œäººã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨IDEä¸­æ‰“å¼€</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MonsterData.cs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ·»åŠ åˆ°</font></font><code>MonsterLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹å˜é‡ï¼š</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject bullet; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> fireRate;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªçº§åˆ«çš„æ€ªç‰©è®¾ç½®äº†å°„å¼¹çš„é¢„åˆ¶ä»¶å’Œå°„å‡»é¢‘ç‡ã€‚</font><font style="vertical-align: inherit;">ä¿å­˜æ–‡ä»¶å¹¶è¿”å›Unityä»¥å®Œæˆæ€ªç‰©è®¾ç½®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨é¡¹ç›®æµè§ˆå™¨ä¸­é€‰æ‹©</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monster</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¢„åˆ¶ä»¶</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥å™¨ä¸­ï¼Œ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±•å¼€</font><font style="vertical-align: inherit;">â€œ </font><em><font style="vertical-align: inherit;">æ€ªç‰©æ•°æ®ï¼ˆè„šæœ¬ï¼‰â€</font></em><font style="vertical-align: inherit;">ç»„ä»¶ä¸­çš„</font><em><font style="vertical-align: inherit;">â€œ </font></em></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³å¡</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ </font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å°†</font><font style="vertical-align: inherit;">æ¯ä¸ªé¡¹ç›®</font><font style="vertical-align: inherit;">çš„</font><em><font style="vertical-align: inherit;">å°„å‡»ç‡</font></em><font style="vertical-align: inherit;">è®¾ç½®</font><font style="vertical-align: inherit;">ä¸º</font><em><font style="vertical-align: inherit;">1</font></em><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç„¶åå°†</font><font style="vertical-align: inherit;">å…ƒç´ 0ã€1å’Œ2 </font><font style="vertical-align: inherit;">çš„</font><em><font style="vertical-align: inherit;">Bullet</font></em><font style="vertical-align: inherit;">å‚æ•°è®¾ç½®</font><font style="vertical-align: inherit;">ä¸º</font><em><font style="vertical-align: inherit;">Bullet1</font></em><font style="vertical-align: inherit;">ï¼Œ</font><em><font style="vertical-align: inherit;">Bullet2</font></em><font style="vertical-align: inherit;">å’Œ</font><em><font style="vertical-align: inherit;">Bullet3</font></em><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ€ªç‰©ç­‰çº§åº”è®¾ç½®å¦‚ä¸‹ï¼š</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c0/7d0/fd9/8c07d0fd96492f9e0e6c6e1737791c11.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‚®å¼¹æ€æ­»æ•Œäººï¼Ÿ</font><font style="vertical-align: inherit;">æ˜¯çš„ </font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬å¼€ç«å§ï¼</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¼€ç« </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨IDEä¸­æ‰“å¼€</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ShootEnemies.cs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> lastShotTime; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MonsterData monsterData;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¾åæ€ä¹‰ï¼Œè¿™äº›å˜é‡ä¼šè·Ÿè¸ªæœ€åä¸€æ¬¡å°„å‡»æ€ªç‰©çš„æ—¶é—´ï¼Œä»¥åŠ</font></font><code>MonsterData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒ…å«æœ‰å…³æ€ªç‰©å£³ç±»å‹ï¼Œå‘å°„é¢‘ç‡ç­‰ä¿¡æ¯</font><font style="vertical-align: inherit;">çš„ç»“æ„</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä¸­è®¾ç½®è¿™äº›å­—æ®µçš„å€¼</font></font><code>Start()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><pre> <code class="cs hljs">lastShotTime = Time.time; monsterData = gameObject.GetComponentInChildren&lt;MonsterData&gt;();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ†é…</font></font><code>lastShotTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“å‰æ—¶é—´</font><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å€¼ï¼Œå¹¶å¯ä»¥è®¿é—®</font></font><code>MonsterData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥å¯¹è±¡</font><font style="vertical-align: inherit;">çš„ç»„ä»¶</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ·»åŠ ä»¥ä¸‹æ–¹æ³•æ¥å®ç°å°„å‡»ï¼š</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Shoot</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collider2D target</span></span></span><span class="hljs-function">)</span></span> { GameObject bulletPrefab = monsterData.CurrentLevel.bullet; <span class="hljs-comment"><span class="hljs-comment">// 1 Vector3 startPosition = gameObject.transform.position; Vector3 targetPosition = target.transform.position; startPosition.z = bulletPrefab.transform.position.z; targetPosition.z = bulletPrefab.transform.position.z; // 2 GameObject newBullet = (GameObject)Instantiate (bulletPrefab); newBullet.transform.position = startPosition; BulletBehavior bulletComp = newBullet.GetComponent&lt;BulletBehavior&gt;(); bulletComp.target = target.gameObject; bulletComp.startPosition = startPosition; bulletComp.targetPosition = targetPosition; // 3 Animator animator = monsterData.CurrentLevel.visualization.GetComponent&lt;Animator&gt;(); animator.SetTrigger("fireShot"); AudioSource audioSource = gameObject.GetComponent&lt;AudioSource&gt;(); audioSource.PlayOneShot(audioSource.clip); }</span></span></code> </pre> <br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å¾—åˆ°äº†å­å¼¹çš„èµ·å§‹ä½ç½®å’Œç›®æ ‡ä½ç½®ã€‚</font><font style="vertical-align: inherit;">å°†ä½ç½®zè®¾ç½®ä¸ºz </font></font><code>bulletPrefab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä»¥å‰ï¼Œæˆ‘ä»¬å°†å¼¹ä¸¸çš„é¢„åˆ¶ä½ç½®è®¾ç½®ä¸ºzï¼Œä»¥ä½¿å¼¹ä¸¸æ˜¾ç¤ºåœ¨å°„å‡»æ€ªç‰©ä¸‹æ–¹ï¼Œä½†åœ¨æ•Œäººä¸Šæ–¹ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬ä½¿ç”¨</font></font><code>bulletPrefab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€‚å½“çš„</font><font style="vertical-align: inherit;">shellåˆ›å»ºä¸€ä¸ªæ–°shellçš„å®ä¾‹</font></font><code>MonsterLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åˆ†é…</font></font><code>startPosition</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶</font></font><code>targetPosition</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠ•å°„ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æˆ‘ä»¬ä½¿æ¸¸æˆæ›´æœ‰è¶£ï¼šå½“æ€ªç‰©å°„å‡»æ—¶ï¼Œå¼€å§‹å°„å‡»åŠ¨ç”»å¹¶æ’­æ”¾æ¿€å…‰çš„å£°éŸ³ã€‚ </font></font></li></ol><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å…¨éƒ¨æ”¾åœ¨ä¸€èµ· </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨æ˜¯æ—¶å€™å°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€èµ·äº†ã€‚</font><font style="vertical-align: inherit;">å®šä¹‰ç›®æ ‡å¹¶ä½¿æ€ªç‰©çœ‹ç€å®ƒã€‚</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3c5/934/9a7/3c59349a719669c9508c38f155bf25dc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ShootEnemies.cs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è„šæœ¬ä¸­</font><em><font style="vertical-align: inherit;">ï¼Œ</font></em><font style="vertical-align: inherit;">æ·»åŠ </font></font><code>Update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹ä»£ç ï¼š</font></font><br><br><pre> <code class="cs hljs">GameObject target = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 1 float minimalEnemyDistance = float.MaxValue; foreach (GameObject enemy in enemiesInRange) { float distanceToGoal = enemy.GetComponent&lt;MoveEnemy&gt;().DistanceToGoal(); if (distanceToGoal &lt; minimalEnemyDistance) { target = enemy; minimalEnemyDistance = distanceToGoal; } } // 2 if (target != null) { if (Time.time - lastShotTime &gt; monsterData.CurrentLevel.fireRate) { Shoot(target.GetComponent&lt;Collider2D&gt;()); lastShotTime = Time.time; } // 3 Vector3 direction = gameObject.transform.position - target.transform.position; gameObject.transform.rotation = Quaternion.AngleAxis( Mathf.Atan2 (direction.y, direction.x) * 180 / Mathf.PI, new Vector3 (0, 0, 1)); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é€æ­¥è€ƒè™‘æ­¤ä»£ç ã€‚ </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¡®å®šæ€ªç‰©çš„ç›®çš„ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä»ä¸­çš„æœ€å¤§å¯èƒ½è·ç¦»å¼€å§‹</font></font><code>minimalEnemyDistance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ•Œäººåˆ°Cookieçš„è·ç¦»å°äºå½“å‰çš„æœ€å°è·ç¦»ï¼Œæˆ‘ä»¬å°†åœ¨ä¸€ä¸ªèŒƒå›´å†…çš„æ‰€æœ‰æ•Œäººå‘¨å›´å¾ªç¯ï¼Œå¹¶ä½¿å…¶æˆä¸ºæ–°çš„ç›®æ ‡ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è°ƒç”¨</font></font><code>Shoot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»è¿‡æ—¶é—´æ˜¯å¦å¤§äºæ€ªç‰©çš„å°„å‡»é¢‘ç‡ï¼Œå¹¶è®¾ç½®</font></font><code>lastShotTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“å‰æ—¶é—´</font><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å€¼ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è®¡ç®—æ€ªç‰©ä¸å…¶ç›®æ ‡ä¹‹é—´çš„æ—‹è½¬è§’åº¦ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†æ€ªç‰©æ—‹è½¬åˆ°è¿™ä¸ªè§’åº¦ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œä»–å°†å§‹ç»ˆç›¯ç€ç›®æ ‡ã€‚</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¿å­˜æ–‡ä»¶å¹¶åœ¨Unityä¸­å¯åŠ¨æ¸¸æˆã€‚</font><font style="vertical-align: inherit;">æ€ªç‰©å°†å¼€â€‹â€‹å§‹æ‹¼å‘½ä¿æŠ¤cookieã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ç»ˆäºå®Œæˆäº†ï¼</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ¥ä¸‹æ¥è¦å»å“ªé‡Œ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥</font></font><a href="" title="åœ¨è¿™é‡Œ"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½å®Œæˆçš„é¡¹ç›®</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­åšå¾—å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†å‡ºè‰²çš„æ¸¸æˆã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹æ˜¯ä¸€äº›å¯¹è¯¥é¡¹ç›®è¿›è¡Œè¿›ä¸€æ­¥å¼€å‘çš„æƒ³æ³•ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ›´å¤šç±»å‹çš„æ•Œäººå’Œæ€ªç‰© </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ•Œäººçš„ä¸åŒè·¯çº¿ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¸åŒçš„æ¸¸æˆç­‰çº§ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™äº›æ–¹é¢ä¸­çš„æ¯ä¸€ä¸ªéƒ½å°†éœ€è¦æœ€å°çš„æ›´æ”¹ï¼Œå¹¶ä¸”å¯ä»¥ä½¿æ¸¸æˆæ›´åŠ æœ‰è¶£ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨æ ¹æ®æœ¬æ•™ç¨‹åˆ›å»ºäº†ä¸€ä¸ªæ–°æ¸¸æˆï¼Œæˆ‘å°†å¾ˆä¹äºç©è¯¥æ¸¸æˆï¼Œå› æ­¤è¯·å…±äº«ä¸€ä¸ªé“¾æ¥ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™æ¬¡</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="åˆ¶ä½œçƒ­é—¨å¡”é˜²æ¸¸æˆï¼šé¡¶çº§åº”ç”¨å¼€å‘é‡‡è®¿"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡‡è®¿ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥æ‰¾åˆ°æœ‰å…³åˆ›å»ºå¡”é˜²çƒ­é—¨æ¸¸æˆçš„æœ‰è¶£æƒ³æ³•</font><font style="vertical-align: inherit;">ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN413915/">https://habr.com/ru/post/zh-CN413915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN413901/index.html">é€šè¿‡ROSä½¿ç”¨PS4 Dualshock 4æ¸¸æˆæ†æ§åˆ¶EduMipè‡ªå¹³è¡¡æœºå™¨äºº</a></li>
<li><a href="../zh-CN413903/index.html">Cambridge Analyticaå¦‚ä½•å°†ç‚¹å‡»è½¬åŒ–ä¸ºå£°éŸ³</a></li>
<li><a href="../zh-CN413907/index.html">é¢å‘ç§»åŠ¨å¼€å‘äººå‘˜256çš„æœ‰è¶£ææ–™çš„æ‘˜è¦ï¼ˆ6æœˆ4æ—¥-6æœˆ12æ—¥ï¼‰</a></li>
<li><a href="../zh-CN413909/index.html">é‚£æ˜¯ä½ å„¿æ—¶çš„å›å¿†å»çš„åœ°æ–¹</a></li>
<li><a href="../zh-CN413913/index.html">ç†Ÿæ‚‰éŸ³é¢‘å’Œè§†é¢‘è®¾å¤‡å±•è§ˆä¼šï¼šç®€è¦ä»‹ç»æœ€å¤§çš„æ´»åŠ¨-ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN413917/index.html">ç‰ˆæƒæŒæœ‰è€…è®¤ä¸ºï¼ŒYandexä¸ºè¯¥å›½ç›—ç‰ˆè¡Œä¸ºçš„å¢é•¿åšå‡ºäº†è´¡çŒ®</a></li>
<li><a href="../zh-CN413921/index.html">å¦‚ä½•èŠ‚çœé¢å¤–çš„è´¹ç”¨</a></li>
<li><a href="../zh-CN413923/index.html">ä¹Ÿè®¸ä»ç„¶å¯ä»¥æ¸…é™¤å¤§æ°”ä¸­çš„äºŒæ°§åŒ–ç¢³</a></li>
<li><a href="../zh-CN413925/index.html">è«æ–¯ç§‘æ— çº§å˜é€Ÿå™¨</a></li>
<li><a href="../zh-CN413927/index.html">Attiny85ä¸Šçš„Digispark-åœ¨Windows 10ä¸‹è¿æ¥</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>