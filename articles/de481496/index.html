<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî™ üôéüèº üë¶ DDoS-Angriff durch Social Engineering üê™ üÜî üë§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR Der Angreifer ersetzt die Quell-IP durch die Adresse Ihres Servers und l√∂st automatische Missbr√§uche aus. Infolgedessen wird der Client auf dem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DDoS-Angriff durch Social Engineering</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/481496/"><img src="https://habrastorage.org/webt/i6/x7/om/i6x7omrejaehro4mws5isygnptk.jpeg"><br><br>  <b>TL; DR Der Angreifer ersetzt die Quell-IP durch die Adresse Ihres Servers und l√∂st automatische Missbr√§uche aus.</b>  <b>Infolgedessen wird der Client auf dem Hosting f√ºr b√∂swillige Aktivit√§ten gesperrt, die nicht vorhanden waren.</b> <br><br><blockquote>  <b>Kommentar von <a href="https://vdsina.ru/%3Fpartner%3Dhabr2">vdsina.ru</a> :</b> <br>  <i>Dieser Artikel wurde von unserem Kunden verfasst, der nach einem DDoS-Angriff von einem gro√üen Hoster zu uns kam und sich freundlicherweise bereit erkl√§rte, diese Geschichte zu teilen.</i> </blockquote><br>  Ich erz√§hle Ihnen von einer √ºberraschend heimt√ºckischen Art von DDoS-Angriffen, die ich bisher noch nicht erlebt habe.  Das Schleichende ist, dass kein Angriff auf den Server des Opfers selbst erfolgt.  Stattdessen provoziert der Angreifer den Betrieb von Angriffserkennungssystemen von Drittanbietern und zwingt Ihren Server dazu, vollst√§ndig echte Beschwerden (bei gew√∂hnlichen Personen "Missbr√§uche") zu generieren. <br><br>  Auf Seiten des Hosters sieht es so aus, als ob Sie in b√∂swillige Aktivit√§ten verwickelt sind, obwohl dies in der Tat nicht zutrifft.  Es stellte sich heraus, dass viele gro√üe Hosting-Anbieter nicht bereit sind, die Ursachen des Problems zu verstehen, und es vorziehen, Sie einfach wegen Versto√ües gegen die Regeln zu verbieten. <br><br>  Dieser Artikel beschreibt diese Art von Angriff in einem realen Fall. <br><a name="habracut"></a><br><h2>  Zeitleiste </h2><br>  Ich habe mehrere pers√∂nliche Projekte auf VPS-Servern bei einem bekannten Host gef√ºhrt.  Einmal erhielt ich einen Brief von ihm: <br><br><blockquote>  <b># 9042382: ToS-Versto√ü - B√∂swillige Aktivit√§ten</b> <br>  Hallo <br><br>  Wir haben eine Meldung √ºber b√∂swillige Aktivit√§ten von Ihrem Server XXXX erhalten.  Wir bitten Sie, diese Angelegenheit so bald wie m√∂glich zu untersuchen.  Wenn Sie Ihre Untersuchung abgeschlossen haben, antworten Sie bitte auf dieses Ticket mit den Antworten auf die folgenden Fragen: <br>  ... <br><pre><code class="plaintext hljs">Reported-From: abuse-out@checkdomain.de Category: info Report-Type: info Service: different services Version: 0.1 User-Agent: Checkdomain Express 0.19 Date: Fri, 26 May 2018 19:25:19 +0200 Source-Type: ipv4 Source: my-server-ip-xx-xxx Port: dif. Report-ID: dih3cefnp@checkdomain.de Schema-URL: http://www.blocklist.de/downloads/schema/info_0.1.1.json Attachment: text/plain DETAILS ZU DEN ATTACKEN/ST√ñRUNGEN | DETAILS OF THE ATTACKS (letzten 60 Tage / max. 100 St.) | (last 60 days / max. 100 hits) portflood: syn | | standby.checkdomain.de | VORHERIGE SPERREN DER IP-NUMMER | BANNED HISTORY OF THIS IP-NUMBER my-server-ip-xxx-xxx-xxx: this ip-number was never banned before AUZUG AUS SERVERLOGDATEI | EXCERPT FROM SERVER LOGFILE tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:41667 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:46208 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:13000 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:39104 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:55348 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:37266 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:60684 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:63878 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:50445 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:56215 SYNRECV -</code> </pre> <br></blockquote><br>  Wobei <b>my-server-ip-xx-xxx</b> die Server-IP-Adresse ist. <br><br>  Darin sendet mir der Hoster eine Beschwerde, die er √ºber seine abuse @ mailbox erhalten hat, und bittet dringend, die b√∂swillige Aktivit√§t zu beenden, da ich sonst blockiert werde.  Das angeh√§ngte Protokoll zeigt eine Liste der TCP-Verbindungen zum 80 (HTTP) -Port im Status SYN RECEIVED.  Das hei√üt, von meinem Server aus gibt es eine SYN-Flut auf den Webserver von jemandem. <br><br>  Mein erster Gedanke ist, dass sie mich gehackt haben und die SYN-Flut von meinem Server kommt.  Unter Linux gibt es Einschr√§nkungen bei der Verwaltung von Sockets mit normalen Benutzerrechten, und Sie k√∂nnen nur SYN-Pakete (ohne Herstellung einer vollst√§ndigen TCP-Verbindung) mit Root-Rechten senden.  Und das bedeutet, dass sie vollst√§ndig geknackt haben. <br><br>  In einer Panik renne ich zum Server, um nach einem b√∂swilligen Prozess zu suchen.  Ich √ºberpr√ºfe oben, ss, lsof und sehe nichts Verd√§chtiges.  Die Hauptschlussfolgerung: " <i>Horror, sie haben wahrscheinlich ein so cooles Rootkit geflutet, dass das Virus auf Kernel-Ebene vor allen Systemdienstprogrammen verborgen ist!</i> ".  Im Zuge der Recherche hat sich herausgestellt, dass sich die Auslastung des Servers nicht ge√§ndert hat. Gem√§√ü den Grafiken im Hostpanel bleibt der Datenverkehr auf der Schnittstelle unver√§ndert. <br><br>  Davor habe ich <b>tcpdump</b> mit Filtern gestartet, die den ausgehenden Datenverkehr <b>anzeigen</b> , und nichts Verd√§chtiges festgestellt.  Verzweifelt entscheide ich mich, den gesamten Verkehr zum Server zu sehen.  Ich finde seltene RST-Pakete von fremden Servern im Strom des legitimen Verkehrs. <br><br>  Es sieht ungef√§hr so ‚Äã‚Äãaus, wobei <b>mein-server-ip-xx-xxx die</b> Adresse meines Servers ist: <br><br><pre> <code class="plaintext hljs">IP 85.10.207.190.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP 85.10.207.190.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP 85.10.207.190.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP adsl-070-154.sip.pns.bellsouth.net.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP adsl-070-154.sip.pns.bellsouth.net.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP adsl-070-154.sip.pns.bellsouth.net.http &gt; my-server-ip-xx-xxx.8389: Flags [R]</code> </pre><br>  Es war offensichtlich, dass dies eine Anomalie war, da es keinen Austausch mehr mit diesen Servern gab und es mir nicht klar war, warum sie ein Paket gesendet haben, um die Verbindung zu schlie√üen. <br>  An diesem Punkt w√ºrden erfahrene Administratoren sofort alles verstehen, aber wir werden alles an unseren Fingern aussortieren <br><br><h2>  Wie funktioniert das? </h2><br>  Eingehende RST-Pakete sind Antworten auf Versuche, eine TCP-Verbindung zu einem privaten Port herzustellen.  Gleichzeitig gibt es keinen ausgehenden Datenverkehr von meinem Server zu den Servern, die RST senden.  Dies bedeutet, dass der Angreifer die ausgehende Adresse durch meine ersetzt und einen Verkehr erzeugt, der einem DDoS-Angriff √§hnelt.  Da ein Angreifer jedoch nur ein ausgehendes Paket senden kann, gehen alle Antworten von den Servern zu meinem Server. <br><br><img src="https://habrastorage.org/webt/nd/g7/a-/ndg7a-fdzrxswv3sjvd8jwvykym.png"><br>  <font color="999999"><sup>Nur Antworten auf gef√§lschte Anfragen erreichen den Server des Opfers</sup></font> <br><blockquote>  In der Regel werden solche Angriffe zur <a href="https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/">DNS-Verst√§rkung verwendet</a> , wenn der Angreifer eine kleine Anfrage im Namen des Opfers sendet und das Opfer eine gro√üe Antwort erh√§lt, die er nicht angefordert hat.  Dies ist ein klassischer Angriffsmechanismus gegen Kanalersch√∂pfung. </blockquote>  In meinem Fall wollte der Angreifer den Kanal des Opferservers nicht aussch√∂pfen.  Seine Aktivit√§t war in den Verbrauchsgrafiken des Senders v√∂llig unsichtbar.  Ihr Hauptziel war es, Systeme zur automatischen Benachrichtigung √ºber Netzwerkangriffe zu provozieren, die einen Brief mit einer Beschwerde √ºber die im whois-Subnetz meines Providers angegebene Missbrauchsadresse senden.  <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BE%25D0%25B1%25D0%25BD%25D0%25B0%25D1%2580%25D1%2583%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B2%25D1%2582%25D0%25BE%25D1%2580%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9">Intrusive Prevent / Detect-Systeme</a> wie <a href="https://www.snort.org/">Snort</a> und <a href="https://suricata-ids.org/">Suricata k√∂nnen dies tun</a> . <br><br>  Infolgedessen erh√§lt der Hoster einen absolut echten Brief von seri√∂sen Unternehmen, der eine Beschwerde √ºber meine b√∂swillige T√§tigkeit und sogar die darin enthaltenen echten Protokolle enth√§lt.  Gleichzeitig ben√∂tigt der Angreifer keinen gro√üen Kanal, da er die Adressen der Server, auf denen IDS / IPS-Systeme installiert sind, und die erforderliche Mindestanzahl von Paketen f√ºr die automatische Beschwerde im Voraus kennt. <br><br>  Die einzige Schwierigkeit f√ºr einen Angreifer besteht darin, einen Server zu finden, auf dem ausgehende IP-Adressen in Paketen ersetzt werden k√∂nnen.  Alle normalen Hoster blockieren solche Pakete.  Es gibt nur zwei Arten von Hosting, mit denen Clients ausgehende IP-Adressen ersetzen k√∂nnen: entweder als Analphabet konfiguriert oder speziell f√ºr Cyber-Kriminalit√§t entwickelt. <br><br><h2>  √úberpr√ºfen Sie die M√∂glichkeit von IP-Adress-Spoofing </h2><br>  Ich rate Ihnen, Ihren Host auf die M√∂glichkeit zu pr√ºfen, ausgehende IP-Adressen zu ersetzen.  Dies erfordert zwei Server, einen zum Empfangen von Datenverkehr und einen zum Senden. <br><br>  Auf der Empf√§ngerseite werden wir den eingehenden Datenverkehr protokollieren.  Wir geben einen seltenen Port als Filter an, auf dem zu normalen Zeiten kein Datenverkehr stattfinden soll: <br><br><pre> <code class="plaintext hljs">tcpdump -i any port 9912</code> </pre><br>  Auf dem Server, den wir testen, erstellen wir ein Paket mit der Ersetzung der ausgehenden IP-Adresse auf <b>1.1.1.1</b> , das an Port 9912 gerichtet ist. Dazu verwenden wir das coole Dienstprogramm <a href="https://nmap.org/nping/">nping</a> von nmap-Entwicklern.  Sie k√∂nnen damit alle nicht standardm√§√üigen Pakete auf L2- und L3-Ebene generieren. <br><br><pre> <code class="plaintext hljs">nping --tcp -p 9912 -S 1.1.1.1 receiver-server.com</code> </pre><br>  <b>receiver-server.com</b> - Die Adresse des Listening-Servers, auf dem tcpdump ausgef√ºhrt wird <br>  <b>1.1.1.1</b> - Ausgehende Adresse ersetzen <br>  <b>9912</b> - Remote-Port <br><br>  Wenn auf der Seite von <b>receiver-server.com</b> ein Paket angezeigt wird, das im Namen von 1.1.1.1 eingegangen ist, k√∂nnen Sie die ausgehende IP-Adresse durch Ihren Provider ersetzen.  Dies ist eine Gelegenheit, ihn √ºber Probleme beim Einrichten von Netzwerkger√§ten zu informieren.  H√§ufig wird dieses Problem von privaten Internetdienstanbietern verursacht. <br><br><h2>  Dumme technische Unterst√ºtzung </h2><br><br>  Nachdem ich die Gr√ºnde f√ºr die Beschwerden herausgefunden hatte, erkl√§rte ich dem Hoster alles: <br><blockquote>  Hallo <br>  Ich verstehe endlich, was passiert ist. <br><br>  Sie f√§lschen meine IP-Adresse und zuf√§llige DDoS-Hosts, indem sie meine Adresse als Quelladresse verwenden.  So generieren Opfer automatische Missbrauchsmeldungen an meine Hosting-Provider. <br><br>  Sie k√∂nnen im Missbrauchsprotokoll sehen, dass sich die Verbindungen nur im Status SYN_RECV befinden (keine vollst√§ndige TCP-Verbindung hergestellt), da sie nur ein Paket mit gef√§lschter IP senden und den TCP-Handshake nicht beenden k√∂nnen. <br>  Ich kann das beweisen.  Momentan kommen viele eingehende TCP-RST-Pakete von Hosts auf meinen Server, von denen ich keine Pakete gesendet habe. <br><br>  Sie k√∂nnen dies jetzt √ºberpr√ºfen, indem Sie Folgendes ausf√ºhren: <br><br>  tcpdump -i eth0 "tcp [tcpflags] &amp; (tcp-rst)! = 0" <br><br>  Sie werden sehen, dass viele RST-Pakete von Hosts stammen, an die ich noch keine Daten gesendet habe. <br>  Dies zeigt, dass der Angreifer meine IP-Adresse f√§lscht, um mich zu kompromittieren und Missbrauch zu generieren. <br></blockquote><br>  Dann schien es mir, dass jeder qualifizierte Techniker die Situation verstehen w√ºrde und die Frage geschlossen w√ºrde.  Stattdessen forderten sie, dass ich den Server mit Antivirensoftware √ºberpr√ºfe oder das Betriebssystem komplett neu installiere.  W√§hrend wir mit dem technischen Support korrespondierten, kamen die Missbr√§uche weiter und an einem Tag wurde ich verboten. <br><br>  Es war eine wilde Beleidigung, dass ich tats√§chlich gerahmt wurde.  Diese Situation zeigt, wie verletzlich Menschen sind, die nicht verstehen, sondern gedankenlos Skripten folgen.  Seitdem zitiere ich diesen Fall oft als Beispiel, wenn die Debatte √ºber die Auswahl eines Hostings f√ºr wichtige Projekte aufkommt.  Leider k√∂nnen es sich viele Hosting-Anbieter einfach nicht leisten, viel Zeit f√ºr nicht standardm√§√üige F√§lle von kleinen Kunden aufzuwenden, und es ist einfacher, Sie zu bannen, als Ihre Probleme zu l√∂sen. <br><br> <a href="https://vdsina.ru/%3Fpartner%3D7d159c89hz"><img src="https://habrastorage.org/webt/ud/xv/wf/udxvwfcz80j3nug11rxaguqelww.png"><br></a> <br><h3>  Abonnieren Sie unseren Instagram-Entwickler </h3><br> <a href="http://bit.ly/34w4T9B"><img src="https://habrastorage.org/webt/e5/as/-l/e5as-ltfnotkemk2dsqngygimra.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de481496/">https://habr.com/ru/post/de481496/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de481484/index.html">Die KI, die versucht, Probleme zu vermeiden, lernte komplexes Verhalten</a></li>
<li><a href="../de481486/index.html">‚ÄûAm Leben bleiben, am Leben bleiben‚Äú: Das neue Protokoll wird den Radius der m√∂glichen Nutzung von WLAN um 60 Meter vergr√∂√üern</a></li>
<li><a href="../de481488/index.html">Wie die Beamten der Region Moskau die Luftverschmutzung messen</a></li>
<li><a href="../de481490/index.html">Vitamin D. Ein kurzer Ausflug</a></li>
<li><a href="../de481492/index.html">Wir sammeln Farbmusik f√ºr das neue Jahr</a></li>
<li><a href="../de481500/index.html">Fanatischer Programmierer. Abstrakter Teil 3 + abstrakter Tisch. Planung und Kiesel in einem Eimer Wasser</a></li>
<li><a href="../de481502/index.html">Einf√ºhrung in GitHub-Aktionen</a></li>
<li><a href="../de481506/index.html">Die Zusammenstellung interessanter Materialien f√ºr den mobilen Entwickler # 327 (16. - 22. Dezember)</a></li>
<li><a href="../de481510/index.html">Optimierung der Einheit: Wie die Hierarchie der Szenen Sie stiehlt</a></li>
<li><a href="../de481514/index.html">Arbeiten mit der Newtonsoft.Json-Bibliothek anhand eines realen Beispiels. Teil 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>