<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåπ üöå üåØ Criando 1k introdu√ß√£o Caos para ZX-Spectrum üë¶üèº üßöüèø üëâüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inicialmente, eu n√£o planejava fazer uma demo no Chaos Constritions 2018 , no entanto, 2-3 semanas antes do cc, percebi que n√£o podia ir a uma festa d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criando 1k introdu√ß√£o Caos para ZX-Spectrum</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421837/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/7u/dh/ww/7udhwwjcbgzix5jaxzonykfmcf8.png"></div><br>  Inicialmente, eu n√£o planejava fazer uma demo no <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Chaos Constritions 2018</a></strong> , no entanto, 2-3 semanas antes do <strong>cc,</strong> percebi que n√£o podia ir a uma festa de demonstra√ß√£o de m√£os vazias e decidi escrever uma demo curta para <strong>386 / EGA / DOS</strong> . <br><br>  Tendo compilado no <strong>Turbo-C</strong> sob o <strong>DOS</strong> minha <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lib AnotherGraphicsLibrary</a> , que idealmente se encaixava na estrutura do plano de batida do modo <strong>EGA</strong> , fiquei desapontado com os freios, especialmente os freios <strong>EGA</strong> .  A demonstra√ß√£o na forma em que eu gostaria de v√™-lo, por esse per√≠odo muito limitado, era imposs√≠vel de fazer. <br><br>  No entanto, eu n√£o podia desistir e n√£o fazer nada.  E ent√£o me lembrei que h√° muito tempo queria participar dos concursos de demonstra√ß√£o do <strong>ZX-Spectrum</strong> .  E como recebi dois reais de <strong>48k</strong> no ano passado, tive prazer em criar uma demo.  A prop√≥sito - para mim, a coisa mais importante ao escrever uma demonstra√ß√£o √© testar na vida real, os <em>emulsificantes</em> n√£o d√£o tanto prazer ao processo, √© uma sensa√ß√£o maravilhosa quando, ap√≥s a pr√≥xima altera√ß√£o no c√≥digo, voc√™ carrega a demo na vida real e v√™ como o hardware real embaralha os bytes em efeito de desenho de mem√≥ria. <br><br>  Como eu tenho apenas <strong>48k</strong> de reais, decidi fazer uma demo para <strong>48k</strong> .  E devido ao tempo limitado e √† falta de desenvolvimentos, a escolha recaiu sobre a cria√ß√£o de <strong>1k de introdu√ß√£o</strong> (demonstra√ß√£o de apenas 1 kilobyte ou 1024 bytes). <br><a name="habracut"></a><br>  Na √∫ltima vez, <strong>cutuquei</strong> o <strong>z80 asm</strong> no <strong>EmuZWin</strong> - um √≥timo emulador com montador embutido.  Mas, infelizmente, o <strong>EmuZWin</strong> n√£o funciona com nada mais alto que o <strong>Windows XP</strong> ou √© um bug. <br>  Tendo examinado v√°rias op√ß√µes, parei em um monte de programas <strong>Unreal + sjAsm + Notepad ++</strong> , que, na minha opini√£o, s√£o muito <strong>mais f√°ceis do que o</strong> <strong>EmuZWin</strong> em termos de conveni√™ncia, mas, por outro lado, est√£o vivos. <br><br>  Enquanto escrevia esta introdu√ß√£o, conduzi, diretamente na fonte, um log de desenvolvimento, com base no qual o seguinte texto foi escrito: <br><br><h5>  Ol√° Mundo! </h5><br>  O que devo escrever primeiro, tendo quase zero de experi√™ncia no <strong>z80 asm</strong> ?  √â isso mesmo, a sa√≠da do sprite 5x5 √© familiar ou 40x40 pixels, para um dos efeitos (ironicamente, no futuro, para caber em 1k essa parte inacabada foi expulsa da introdu√ß√£o). <br><br>  Surpreendentemente, foi muito f√°cil fazer isso do zero usando a etiqueta de endere√ßo de linha pr√©-gerada usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Down HL</a> . <br><br>  Ah, registradores de √≠ndice, qu√£o convenientes s√£o, mas mais lentos, literalmente consomem barras.  Eu tive que jogar o uso deles em v√°rios lugares. <br><br>  Ainda aqui, no come√ßo, me deparei com falhas <strong>sjAsm</strong> incr√≠veis, ou melhor, sua vers√£o mais recente.  O disrealismo em <strong>Unreal</strong> mostrou uma sequ√™ncia absolutamente louca de comandos.  Baixei a pen√∫ltima vers√£o - j√° era poss√≠vel conviver com ela de alguma forma. <br><br><img src="https://habrastorage.org/webt/xh/yh/ot/xhyhotktsbfmg1iqk_gtrbmsvjy.png"><br><br>  √â claro que voc√™ n√£o pode colocar um n√∫mero adequado de sprites desenhados anteriormente em 1k, ent√£o decidi ger√°-los dinamicamente.  E de qualquer maneira, mas desenhe usando pol√≠gonos. <br><br>  Portanto, o segundo procedimento que escrevi foi o procedimento para desenhar um tri√¢ngulo.  Na maioria das vezes, era uma portabilidade de seu pr√≥prio c√≥digo escrito em <strong>C.</strong>  Com a √∫nica diferen√ßa global da vers√£o <strong>C</strong> , as linhas de varredura de pol√≠gono s√£o geradas primeiro e somente ent√£o s√£o desenhadas nessas linhas de varredura. <br><br>  Depois de idiomas de alto n√≠vel, voc√™ gosta de <strong>jr aka goto</strong> : <br><br><pre><code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.sort_me_please</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">de</span></span>,(<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x2</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bc</span></span>,(<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x0</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nc</span></span>,<span class="hljs-selector-class"><span class="hljs-selector-class">.skip1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x2</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">bc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x0</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">de</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.skip1</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">de</span></span>,(<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x1</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bc</span></span>,(<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x0</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nc</span></span>,<span class="hljs-selector-class"><span class="hljs-selector-class">.skip2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x0</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">de</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x1</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">bc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jr</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.sort_me_please</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.skip2</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">de</span></span>,(<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x2</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bc</span></span>,(<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x1</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nc</span></span>,<span class="hljs-selector-class"><span class="hljs-selector-class">.skip3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x2</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">bc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ld</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">tr_x1</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">de</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jr</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.sort_me_please</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.skip3</span></span>:</code> </pre> <br>  Fiquei um pouco chocado com o fato de que, em um tempo razo√°vel, escrevemos um <strong>draw_triangle</strong> em <strong>z80 asm</strong> , que desenha um pol√≠gono pixel por pixel e sem buracos ao conectar pol√≠gonos. <br><br><img src="https://habrastorage.org/webt/tl/sv/or/tlsvorwso0wpqcrulnaewu23_84.png"><br>  <em>Ol√° tri√¢ngulos!</em> <br><br><h5>  Part√≠culas </h5><br><img src="https://habrastorage.org/webt/ng/kx/mq/ngkxmqez4envpqx6-tzzc0wd2ge.png"><br><br>  Devido √† presen√ßa de um gerador de etiqueta de linha de tela, escrevi um procedimento de sa√≠da de ponto bastante curvo e lento usando essa etiqueta.  O procedimento possui dois pontos de entrada - apenas o inverso do pixel e o inverso do pixel preenchendo-o com <strong>INK</strong> + <strong>BRIGHT</strong> + e a cor especificada em um dos registros. <br><br>  No est√°gio de cria√ß√£o de um efeito com part√≠culas, descobri que o exemplo com as estruturas dos exemplos no <strong>wiki sjAsm</strong> simplesmente n√£o funciona.  O Google trouxe um t√≥pico do site <strong>zx-pk.ru</strong> , onde esse problema √© descrito, e n√£o h√° solu√ß√£o - ha, tudo bem - outra falha. <br><br>  Decidi fazer tudo com clareza - atualizando as coordenadas independentemente da renderiza√ß√£o, por interrup√ß√£o.  Sim ... mais bytes para gerar uma tabela de interrup√ß√£o. <br><br>  Havia poucas part√≠culas nesse est√°gio e elas mal se encaixavam no quadro - essa √© a maneira mais lenta do meu procedimento para gerar o ponto%). Mas usar uma tabela comum com sprites n√£o me permitiu jog√°-la fora e prepar√°-la, porque  isso economizou bastante espa√ßo na necessidade de apenas um gerador de mesa.  E meu amor por bicicletas tamb√©m :) <br><br>  Poucas part√≠culas ... aumentaram seu n√∫mero, mas agora a renderiza√ß√£o ficou engordada em dois quadros. <br><br><img src="https://habrastorage.org/webt/tb/eu/qq/tbeuqqaoeef05uf04tfe33-t7f4.jpeg"><br>  <em>Teste no <strong>Peters WS64</strong> , que eu peguei no √∫ltimo cc e consertei neste inverno :)</em> <br><br>  A prop√≥sito, j√° nesta fase os pontos se transformaram em pontos horizontais em negrito <strong>2: 1</strong> , como no <strong>Commodore 64</strong> .  Isso aconteceu por causa do n√∫mero inicialmente pequeno de part√≠culas e pela minha insatisfa√ß√£o com o fato de serem invis√≠veis quando executadas na vida real.  Resolvido o problema substituindo a placa <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">db</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>,<span class="hljs-number"><span class="hljs-number">64</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br>  em <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">db</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>,<span class="hljs-number"><span class="hljs-number">192</span></span>,<span class="hljs-number"><span class="hljs-number">96</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> <br>  o que piorava a precis√£o do posicionamento e tornava o v√¥o um pouco irregular, mas aumentava a visibilidade.  Aqui, tamb√©m jogou na m√£o que as part√≠culas ca√≠am de cima para baixo - sua vis√£o manchada verticalmente. <br><br>  Ali√°s, as part√≠culas caem cada uma em sua pr√≥pria velocidade aleat√≥ria e dois bytes s√£o usados ‚Äã‚Äãpara armazenar coordenadas <strong>Y.</strong> <br><br><h5>  Sprites </h5><br>  Joguei fora o peda√ßo inacabado da parte do sprite, percebendo que n√£o poderia encaixar <strong>1k</strong> nela. <br><br>  Al√©m disso, j√° havia uma falta de espa√ßo, ent√£o lembrei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do</a> maravilhoso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo da Introspek</a> sobre empacotadores, escolhi o <strong>zx7</strong> como empacotador, que economizou cerca de 110 bytes.  A prop√≥sito, talvez algu√©m conhe√ßa um empacotador mais adequado para uma introdu√ß√£o de 1k? <br><br><h5>  Constru√ß√µes do caos </h5><br><img src="https://habrastorage.org/webt/83/xj/h4/83xjh4wggmay449rwrmrfphx62y.png"><br><br>  Como eu j√° tinha um procedimento para gerar um pol√≠gono, parecia uma boa id√©ia dividir o logotipo <strong>cc</strong> em pol√≠gonos e exibi-los um por um. <br><br>  Eu escrevi algum c√≥digo de teste que exibe v√°rios pol√≠gonos - tudo funcionou como eu pretendia - muito bem. <br><br>  Para verificar se minha ideia se encaixa ou n√£o em <strong>1k</strong> , gerou um certo n√∫mero de pol√≠gonos aleat√≥rios, de acordo com estimativas, um n√∫mero suficiente para o logotipo e o levou √† fonte.  Compilado e garantido que - excelente - a introdu√ß√£o, desta forma, se encaixe no limite de 1024 bytes. <br><br><img src="https://habrastorage.org/webt/fq/8k/bc/fq8kbcfvtdbdirtysojcd0hix8m.jpeg"><br>  <em>Foto da vida, voc√™ reconhece o dispositivo em cima da mesa?</em>  <em>:)))</em> <br><br>  Decidi testar mais uma vez a introdu√ß√£o semi-acabada, j√° com pol√≠gonos e um empacotador, carregado para real e ... foi redefinido.  Primeiro de tudo, comecei a pecar por me esquecer de inicializar a mem√≥ria em algum lugar, a partir do qual, onde tudo funciona bem no emulador <strong>0x00</strong> , na vida real h√° lixo causando uma redefini√ß√£o. <br><br>  Nada √© melhor para encontrar um lugar problem√°tico do que o m√©todo de meia divis√£o e a <strong>interrup√ß√£o que</strong> eu n√£o consegui encontrar. <br><br>  Com uma redefini√ß√£o do real por duas horas, n√£o havia como localizar a falha ... <br>  Como se viu, n√£o estava no meu c√≥digo, estava no <em>aprimorador de</em> som inclu√≠do no telefone do qual carreguei WAVs.  Um melhorador de um fluxo de bits em um arquivo <strong>WAV</strong> gerou um fluxo de del√≠rio. <br><br>  Assim que desliguei tudo funcionou magicamente. <br><br>  Ele delineou o logotipo no editor de gr√°ficos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">erros greenpixel</a> , dividindo-o em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v√°rios tri√¢ngulos e direcionou</a> manualmente as coordenadas para a fonte.  Depois de encher completamente o logotipo da <strong>Chaos Constructions</strong> e execut√°-lo na vida real - fiquei feliz - parecia muito bom. <br><br><img src="https://habrastorage.org/webt/vy/4m/ul/vy4mul7kzdo_o7qav3wtnvc3oki.jpeg"><br>  <em>A primeira exibi√ß√£o do logotipo em real</em> <br><br>  No entanto, coloquei pol√≠gonos aleat√≥rios muito pouco e, no logotipo real, havia um limite de <strong>1k</strong> por 150 bytes.  E isso apesar do efeito de part√≠culas ainda n√£o ter sido conclu√≠do e a transi√ß√£o entre as partes ter sido acentuada. <br><br>  Para ir para a cama naquele dia, por causa da confus√£o com falhas, acabou logo √†s 8 da manh√£ 8) <br><br>  E sim, tentei otimizar o tamanho armazenando as coordenadas e os √≠ndices de v√©rtices separadamente, mas o empacotador n√£o gostou muito, o que fez o tamanho aumentar apenas. <br><br><h5>  Final </h5><br><img src="https://habrastorage.org/webt/qv/h9/is/qvh9ist1fdq9xunbrd4uyejd3gi.png"><br><br>  Eu inventei como diversificar a sa√≠da do logotipo, para isso foram necess√°rios quase nada al√©m de mais dois r√≥tulos de pixel: <br><br><pre> <code class="hljs">fake_points1: db 1,2,4,8,16,32,64,128; 1 ch fake_points2: db 32,8,128,2,16,1,64,4; 2 ch normal_points: db 128,64,32,16,8,4,2,1; 3 ch</code> </pre> <br>  Isso deu um efeito interessante de aumentar os detalhes da renderiza√ß√£o do logotipo, ou a falta inicial de detalhes e um aumento gradual da nitidez. <br><br>  E finalmente, eu fiz a vers√£o final com todas as transi√ß√µes, jogando um monte de tudo.  No processo, encontrei uma falha no procedimento para desenhar um tri√¢ngulo - se os dois v√©rtices t√™m as mesmas coordenadas <strong>Y</strong> , ent√£o o tri√¢ngulo √© desenhado tortamente (parece dividir por 0 ao calcular <strong>dx</strong> ), ignorado com um corte tempor√°rio. <br><br><img src="https://habrastorage.org/webt/xo/a3/--/xoa3--9_kt2k-uodr2gabj8ithm.jpeg"><br>  <em>Testando a vers√£o final em Leningrado 48</em> <br><br><h5>  Otimiza√ß√£o de tamanho </h5><br><img src="https://habrastorage.org/webt/-e/ro/l8/-erol8uszgdcler4i9jhp4n-9cu.jpeg"><br>  <em>D√≠gitos duplos s√£o "bytes extras"</em> <br><br><h6>  94 bytes extras ... </h6><br>  Chegou a hora de cortar a preserva√ß√£o / restaura√ß√£o ‚Äúcultural‚Äù dos registros dos procedimentos de entrada / sa√≠da, longe de onde for necess√°rio, mas a mem√≥ria est√° consumindo. <br><br><h6>  86 bytes ... </h6><br>  Testado na vida real - funciona!  Ele perdeu um pouco mais de mem√≥ria, consertando simultaneamente um bug dividido por 0 a 63 bytes! <br><br><h6>  57 bytes ... </h6><br>  Adicionado loop. <br><br><pre> <code class="hljs sql">random_store: <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>:</code> </pre> <br>  O loop pelo caminho √© feito no n√≠vel de desempacotamento, como  como fonte de entropia para o <strong>RNG</strong> , foram utilizados v√°rios bytes do c√≥digo de inicializa√ß√£o (para economizar espa√ßo), que o <strong>RNG</strong> estragou durante a primeira parte.  Portanto, para repetir, ap√≥s o final da introdu√ß√£o, h√° <strong>ret</strong> , bem, e depois outra descompacta√ß√£o e transi√ß√£o para o c√≥digo descompactado ... <br><br>  N√£o foi poss√≠vel me livrar dos √∫ltimos 48 bytes, tive que cortar o manipulador de interrup√ß√µes, mas Hurrah!  Recheado!  At√© 1 byte extra permaneceu. <br><br>  E como n√£o h√° interrup√ß√µes, ele pode ser pontuado em quadros, e √© dif√≠cil ver a se√ß√£o transversal do feixe em um pixel no primeiro efeito, por isso aumentei o n√∫mero de part√≠culas por olho, com um comprometimento entre velocidade e entretenimento. <br><br>  Picou ainda mais, movendo estupidamente c√≥digos e dados de um lugar para outro, ajudando o empacotador.  O que levou algum tempo :) <br><br>  Isso liberou cerca de <strong>10 bytes</strong> nos quais coloquei uma par√≥dia do som.  Khk, khe, som - isto √©, em alguns lugares, pelo ouvido inserido: <br><br><pre> <code class="hljs perl"> ifdef UseSound ld a,d <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-comment"><span class="hljs-comment">#10 out (#FE),a endif</span></span></code> </pre> <br>  N√£o preguei o som, mas fiz uma defini√ß√£o, obtendo assim duas vers√µes da introdu√ß√£o, com e sem som.  Naquele sem som, em bytes "extras" amontoados <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">db</span></span> <span class="hljs-string"><span class="hljs-string">'e'</span></span>,<span class="hljs-string"><span class="hljs-string">'r'</span></span>,<span class="hljs-string"><span class="hljs-string">'r'</span></span>,<span class="hljs-string"><span class="hljs-string">'o'</span></span>,<span class="hljs-string"><span class="hljs-string">'r'</span></span></code> </pre> <br>  Eu coletei <strong>trd</strong> e <strong>toquei</strong> e <strong>enviei</strong> tudo para o site da <strong>cc</strong> . <br><br>  Hooray - estou participando de demopati! <br><br><h5>  Posf√°cio </h5><br>  Acabou sendo engra√ßado com o som, algu√©m no patlace disse "som claro", algu√©m me olhou estranhamente e, em <strong>pouet</strong> , encontrei o seguinte: <br><br><img src="https://habrastorage.org/webt/vt/p_/sw/vtp_swwrkskgpqbexsuj1nubn40.png"><br><br>  E isso: <br><br><img src="https://habrastorage.org/webt/og/vh/wc/ogvhwc8p907emey1wk2erb-ejtm.png"><br><br>  Em geral, eu n√£o entendi se algu√©m gostou do som de 10 bytes ou n√£o :) <br><br>  E a √∫ltima - √© uma pena que a competi√ß√£o <strong>1k</strong> n√£o tenha ocorrido este ano, o trabalho acabou decente, na minha opini√£o, mas √© dif√≠cil competir com <strong>640k</strong> , mas eu realmente queria competir. <br><br>  <strong>Escreva demos, escreva 1k!</strong> <br><br>  E aqui est√° o que acabou (ps, cuide dos seus ouvidos): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-Q3cD3dx5lY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Vers√£o silenciosa: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/2fwdWSiczIE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt421837/">https://habr.com/ru/post/pt421837/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt421823/index.html">Como trouxemos o X-Ray x64</a></li>
<li><a href="../pt421827/index.html">O que ler sobre Java agora?</a></li>
<li><a href="../pt421829/index.html">Anomalia de Frango - um romance fant√°stico com pessoas reais de TI</a></li>
<li><a href="../pt421833/index.html">Escrevemos nosso programa mais simples para o ARM Cortex-M3</a></li>
<li><a href="../pt421835/index.html">Comiss√£o Interinstitucional desenvolve nova tecnologia para bloquear o Telegram</a></li>
<li><a href="../pt421839/index.html">Programa√ß√£o Java funcional com Vavr</a></li>
<li><a href="../pt421841/index.html">Robotaxi Waymo ainda n√£o est√° pronto para o acesso √†s vias p√∫blicas</a></li>
<li><a href="../pt421845/index.html">O que os analistas de dados realmente fazem? Resultados de 35 entrevistas</a></li>
<li><a href="../pt421847/index.html">Salte para a nuvem. Criando uma solu√ß√£o de IoT de or√ßamento no Hub IoT do NodeMCU + Azure</a></li>
<li><a href="../pt421849/index.html">Eventos para RH em TI em setembro de 2018: My Circle Digest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>