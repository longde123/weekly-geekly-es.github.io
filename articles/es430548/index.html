<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüè´ üë∂üèæ üéÆ Interrupciones de dispositivos externos en un sistema x86. Parte 1. La evoluci√≥n de los controladores de interrupci√≥n ü§¶üèª üë©üèæ‚Äçü§ù‚Äçüë©üèΩ üå≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, me gustar√≠a considerar los mecanismos para entregar interrupciones desde dispositivos externos en el sistema x86 e intentar responde...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interrupciones de dispositivos externos en un sistema x86. Parte 1. La evoluci√≥n de los controladores de interrupci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430548/">  En este art√≠culo, me gustar√≠a considerar los mecanismos para entregar interrupciones desde dispositivos externos en el sistema x86 e intentar responder las preguntas: <br><br><ul><li>  ¬øQu√© es PIC y para qu√© sirve? </li><li>  ¬øQu√© es APIC y para qu√© sirve?  ¬øPara qu√© sirven LAPIC y I / O APIC? </li><li>  ¬øCu√°les son las diferencias entre APIC, xAPIC y x2APIC? </li><li>  ¬øQu√© es el MSI?  ¬øCu√°les son las diferencias entre MSI y MSI-X? </li><li>  ¬øC√≥mo se relacionan las tablas $ PIR, MPtable, ACPI con esto? </li></ul><br>  Si est√° interesado en recibir una respuesta a cualquiera de estas preguntas o si solo desea familiarizarse con la evoluci√≥n de los controladores de interrupci√≥n en el sistema x86, bienvenido a cat. <br><a name="habracut"></a><br><h3>  Introduccion </h3><br>  Todos sabemos lo que es la interrupci√≥n.  Para aquellos que no lo son, cita de wikipedia: <br><br><blockquote> Interrupci√≥n (interrupci√≥n en ingl√©s): una se√±al del software o hardware que informa al procesador sobre la ocurrencia de cualquier evento que requiera atenci√≥n inmediata.  La interrupci√≥n notifica al procesador la ocurrencia de un evento de alta prioridad que requiere la interrupci√≥n del c√≥digo actual ejecutado por el procesador.  El procesador responde suspendiendo su actividad actual, manteniendo su estado y ejecutando una funci√≥n llamada controlador de interrupci√≥n (o controlador de interrupci√≥n) que responde al evento y lo sirve, despu√©s de lo cual devuelve el control al c√≥digo interrumpido. <br><br>  Dependiendo de la fuente de la se√±al de interrupci√≥n, se dividen en: <br><br><ul><li>  Eventos as√≠ncronos o externos (hardware) que se originan en dispositivos de hardware externos (como dispositivos perif√©ricos) y pueden ocurrir en cualquier momento arbitrario: una se√±al de un temporizador, una tarjeta de red o unidad de disco, pulsaciones de teclas, movimientos del mouse.  El hecho de que tal interrupci√≥n ocurra en el sistema se interpreta como una solicitud de interrupci√≥n (IRQ): los dispositivos informan que requieren atenci√≥n del sistema operativo; </li><li>  eventos s√≠ncronos o internos en el propio procesador como resultado de la violaci√≥n de ciertas condiciones al ejecutar c√≥digo de m√°quina: divisi√≥n por cero o desbordamiento de pila, acceso a direcciones de memoria no v√°lidas o c√≥digo de operaci√≥n no v√°lido; </li></ul></blockquote>  En este art√≠culo, me gustar√≠a hablar sobre las interrupciones IRQ externas. <br><br>  ¬øPor qu√© son necesarios?  Supongamos que queremos realizar alguna acci√≥n con un paquete de entrada para una tarjeta de red cuando llegue.  Para no preguntar a la tarjeta de red constantemente "¬øtiene un nuevo paquete?"  y no desperdicie recursos del procesador en esto; puede usar la interrupci√≥n IRQ.  La l√≠nea de interrupci√≥n del dispositivo est√° conectada a la l√≠nea INTR del procesador, y cuando se recibe un paquete, la tarjeta de red "tira" de esta l√≠nea.  El procesador comprende que hay informaci√≥n y lee el paquete. <br><br>  Pero, ¬øqu√© pasa si hay muchos dispositivos?  No puede tener suficiente de todos los dispositivos externos de las patas del procesador. <br><br><img src="https://habrastorage.org/webt/vg/3q/3v/vg3q3v7kx8vjttp43xo99o8pccs.png"><br><br>  Para resolver este problema, se les ocurri√≥ un chip, un controlador de interrupci√≥n. <br><br><h3>  Pic </h3><br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wiki</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">osdev</a> ) <br><br>  El primero fue un chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PIC Intel 8259</a> .  8 l√≠neas de entrada (IRQ0-7) y una salida que conecta el controlador con la l√≠nea INTR del procesador.  Cuando ocurre una interrupci√≥n de un dispositivo, 8259 tira de la l√≠nea INTR, el procesador comprende que alg√∫n dispositivo est√° se√±alando una interrupci√≥n y sondea el PIC para comprender qu√© rama IRQx caus√≥ la interrupci√≥n.  Hay un retraso adicional para esta encuesta, pero el n√∫mero de l√≠neas de interrupci√≥n aumenta a 8. <br><br><img src="https://habrastorage.org/webt/le/yf/6e/leyf6enogyzp6flpijo2d0x1w9g.png"><br><br>  Sin embargo, 8 l√≠neas r√°pidamente resultaron ser peque√±as, y para aumentar su n√∫mero, se comenzaron a utilizar 2 8259 controladores (maestro y esclavo) conectados en cascada (Dual PIC). <br><br>  Las IRQ 0 a 7 son procesadas por el primer Intel 8259 PIC (maestro), y las IRQ 8 a 15 son procesadas por el segundo 8259 PIC (esclavo).  Solo un maestro se√±ala la ocurrencia de una interrupci√≥n.  Si se produce una interrupci√≥n en las l√≠neas 8-15, el segundo PIC (esclavo) se√±ala una interrupci√≥n al maestro a trav√©s de IRQ 2, y el maestro a su vez se√±ala a la CPU.  Esta interrupci√≥n en cascada toma una de las 16 l√≠neas, pero al final ofrece 15 interrupciones disponibles para los dispositivos. <br><br><img src="https://habrastorage.org/webt/xj/yn/dh/xjyndhabujjwz0alrbx831zfzt8.png"><br><br>  El circuito se ha establecido, y esto es lo que quieren decir cuando hablan sobre PIC (Programm Interrupt Controller) ahora.  Posteriormente, los controladores 8259 recibieron algunas mejoras y se conocieron como 8259A, y este circuito se incluy√≥ en el conjunto de chips.  En un momento en que el bus principal para conectar dispositivos externos era el bus ISA, dicho sistema en su conjunto era suficiente.  Solo era necesario asegurarse de que diferentes dispositivos no se conectaran a la misma l√≠nea IRQ para evitar conflictos, ya que las interrupciones ISA no se comparten. <br><br>  Por lo general, el dise√±o de las interrupciones para dispositivos era m√°s o menos est√°ndar <br><br>  Ejemplo (tomado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de aqu√≠</a> ): <br>  IRQ 0 - temporizador del sistema <br>  IRQ 1 - controlador de teclado <br>  IRQ 2 - cascada (interrupci√≥n desde el controlador esclavo) <br>  IRQ 3 - puerto serie COM2 <br>  IRQ 4 - puerto serie COM1 <br>  IRQ 5 - puerto paralelo 2 y 3 o tarjeta de sonido <br>  IRQ 6 - controlador de disquete <br>  IRQ 7 - puerto paralelo 1 <br>  IRQ 8 - Temporizador RTC <br>  IRQ 9 - ACPI <br>  IRQ 10 - abierto / SCSI / NIC <br>  IRQ 11 - abierto / SCSI / NIC <br>  IRQ 12 - controlador de mouse <br>  IRQ 13 - coprocesador matem√°tico <br>  IRQ 14 - ATA canal 1 <br>  IRQ 15 - ATA canal 2 <br><br>  La configuraci√≥n y el trabajo con 8259 microcircuitos se realiza a trav√©s de puertos de E / S: <br><div class="scrollable-table"><table><tbody><tr><th>  Chip </th><th>  Registrarse </th><th>  Puerto de E / S </th></tr><tr><td>  Foto maestra </td><td>  Comando </td><td>  0x0020 </td></tr><tr><td>  Foto maestra </td><td>  Datos </td><td>  0x0021 </td></tr><tr><td>  Foto esclavo </td><td>  Comando </td><td>  0x00A0 </td></tr><tr><td>  Foto esclavo </td><td>  Datos </td><td>  0x00A1 </td></tr></tbody></table></div><br>  ‚Üí La documentaci√≥n para el 8259A se puede encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠.</a> <br><br>  El bus ISA fue reemplazado por el bus PCI.  Y el n√∫mero de dispositivos claramente comenz√≥ a exceder el n√∫mero 15, adem√°s, a diferencia del bus ISA est√°tico, en este caso, los dispositivos se pueden agregar al sistema din√°micamente.  Pero afortunadamente en este bus se pueden compartir interrupciones (es decir, se pueden conectar varios dispositivos a la misma l√≠nea IRQ).  Como resultado, para resolver el problema de la falta de l√≠neas IRQ, decidieron agrupar las interrupciones de todos los dispositivos PCI en l√≠neas PIRQ (solicitud de interrupci√≥n programable). <br><br>  Digamos que tenemos 4 l√≠neas de interrupci√≥n libremente en el controlador PIC y 20 dispositivos PCI.  Combinamos las interrupciones de 5 dispositivos por l√≠nea PIRQx y conectamos las l√≠neas PIRQx al controlador.  Si se produce una interrupci√≥n en la l√≠nea PIRQx, el procesador tendr√° que interrogar a todos los dispositivos conectados a esta l√≠nea para comprender de qui√©n proviene la interrupci√≥n, pero en general esto resuelve el problema.  Un dispositivo que une l√≠neas de interrupci√≥n PCI en una l√≠nea PIRQ a menudo se denomina enrutador PIR. <br><br>  En este m√©todo, debe asegurarse de que las l√≠neas PIRQx no est√©n conectadas a las l√≠neas IRQx en las que ya se han iniciado las interrupciones ISA (ya que esto provocar√° conflictos), y que las l√≠neas PIRQx est√©n equilibradas (porque cuantos m√°s dispositivos conectamos a la misma l√≠nea PIRQ, m√°s dispositivos necesitar√° interrogar√° al procesador para comprender cu√°l de estos dispositivos caus√≥ la interrupci√≥n). <br><br><img src="https://habrastorage.org/webt/u_/jr/u9/u_jru9pemdeda2xvvbqihvgtp3y.png"><br><br>  <b>Nota</b> : el dispositivo PCI -&gt; el mapeo PIR se muestra de forma abstracta en la imagen, porque de hecho es algo m√°s complicado.  En realidad, cada dispositivo PCI tiene 4 l√≠neas de interrupci√≥n (INTA, INTB, INTC, INTD).  Cada dispositivo PCI puede tener hasta 8 funciones, y ahora cada funci√≥n tiene una interrupci√≥n INTx.  La configuraci√≥n del chipset determina qu√© INTx obtendr√° cada funci√≥n del dispositivo. <br><br>  En esencia, las funciones son bloques l√≥gicos separados.  Por ejemplo, en un dispositivo PCI puede haber una funci√≥n de controlador Smbus, una funci√≥n de controlador SATA, una funci√≥n de puente LPC.  En el lado del sistema operativo, cada funci√≥n es un dispositivo separado con su propio espacio de configuraci√≥n PCI Config. <br><br>  El BIOS pas√≥ la informaci√≥n sobre el enrutamiento de interrupci√≥n en el PIC al BIOS usando la tabla $ PIR y completando los registros 3Ch (INT_LN Interrupt Line (R / W)) y 3Dh (INT_PN Interrupt Pin (RO)) del espacio de configuraci√≥n PCI para cada funci√≥n.  La especificaci√≥n para la tabla $ PIR estaba anteriormente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el sitio web de Microsoft</a> , pero ahora ya no est√° all√≠.  El contenido de las filas de la tabla $ PIR puede entenderse a partir de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">especificaci√≥n PCI BIOS</a> [4.2.2.  Obtenga opciones de enrutamiento de interrupci√≥n PCI] o lea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> <br><br><h3>  Apic </h3><br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wiki</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">osdev</a> ) <br><br>  El m√©todo anterior funcion√≥ hasta que aparecieron los sistemas multiprocesador.  El hecho es que en su dispositivo PIC puede transmitir interrupciones a un solo procesador principal.  Pero me gustar√≠a que la carga en los procesadores del manejo de interrupciones sea equilibrada.  La soluci√≥n a este problema fue la nueva interfaz APIC (Advanced PIC). <br><br>  Para cada procesador, se agrega un controlador LAPIC especial (APIC local) y un controlador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">APIC de E / S</a> para enrutar las interrupciones de los dispositivos.  Todos estos controladores se combinan en un bus com√∫n llamado APIC (los nuevos sistemas ahora est√°n conectados a trav√©s de un bus de sistema est√°ndar). <br><br>  Cuando una interrupci√≥n de un dispositivo llega al pin I / O APIC, el controlador dirige la interrupci√≥n al LAPIC de uno de los procesadores.  La presencia de I / O APIC le permite equilibrar la distribuci√≥n de interrupciones de dispositivos externos entre procesadores. <br><br>  El primer chip APIC fue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">82489DX</a> , era un chip separado que combina LAPIC y I / O APIC.  Para crear un sistema de 2 procesadores, se necesitaban 3 microcircuitos de este tipo.  2 funcionar√≠a como LAPIC y uno como I / O APIC.  M√°s tarde, la funcionalidad LAPIC se incluy√≥ directamente en los procesadores, y la funcionalidad I / O APIC se enmarc√≥ en el chip 82093AA. <br><br>  El I / O APIC <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">82093AA</a> conten√≠a 24 pines de entrada, y la arquitectura APIC pod√≠a soportar hasta 16 CPU.  Para mantener la compatibilidad con sistemas m√°s antiguos, se asignaron 0 ~ 15 interrupciones a las interrupciones ISA anteriores.  Y las interrupciones de los dispositivos PCI comenzaron a mostrarse en la l√≠nea IRQ 16-23.  Ahora era posible no pensar en conflictos de interrupci√≥n de dispositivos ISA y PCI.  Adem√°s, gracias al mayor n√∫mero de l√≠neas de interrupci√≥n libre, tambi√©n ha sido posible aumentar el n√∫mero de l√≠neas PIRQx. <br><br><img src="https://habrastorage.org/webt/mc/ra/hj/mcrahjn-owk9qrcmyiixcmhomcq.png"><br><br>  La programaci√≥n I / O APIC y LAPIC se realiza a trav√©s de MMIO.  Los registros LAPIC generalmente se encuentran en 0xFEE00000, los registros I / O APIC en 0xFE00000.  Aunque, en principio, todas estas direcciones pueden reconfigurarse. <br><br>  Como en el caso de PIC, inicialmente, los chips individuales luego se convirtieron en parte del conjunto de chips. <br><br>  Posteriormente, la arquitectura APIC recibi√≥ modernizaci√≥n y la nueva versi√≥n se llam√≥ xAPIC (x - extendida).  Compatibilidad retenida con la versi√≥n anterior.  El n√∫mero de CPU posibles en el sistema aument√≥ a 256. <br><br>  La siguiente ronda de desarrollo de arquitectura se llam√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">x2APIC</a> .  El n√∫mero de CPU posibles en el sistema aument√≥ a 2 ^ 32.  Los controladores pueden funcionar en modo de compatibilidad xAPIC, o en el nuevo modo x2APIC, donde la programaci√≥n LAPIC se lleva a cabo no a trav√©s de MMIO, sino a trav√©s de registros MSR (que es mucho m√°s r√°pido).  A juzgar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">por este enlace, se</a> requiere soporte de IOMMU para que este modo funcione. <br><br>  Cabe se√±alar que el sistema puede tener varios controladores I / O APIC.  Por ejemplo, uno por 24 interrupciones en el puente sur, el otro por 32 en el norte.  En el contexto de las E / S, las interrupciones APIC a menudo se denominan GSI (Interrupci√≥n del sistema global).  Entonces, en dicho sistema ser√° GSI 0-55. <br><br>  ¬øExiste un LAPIC incorporado en la CPU y qu√© arquitectura puede ser entendida por los indicadores de bit en la CPUID? <br>  Para que el sistema detecte LAPIC y I / O APIC, el BIOS debe proporcionar informaci√≥n sobre ellos al sistema a trav√©s de MPtable (el m√©todo anterior) o de la tabla ACPI (MADT en este caso).  Adem√°s de la informaci√≥n general, tanto MPtable como ACPI (esta vez en la tabla DSDT) deben contener informaci√≥n sobre las interrupciones de enrutamiento, es decir, informaci√≥n sobre qu√© dispositivo est√° en qu√© l√≠nea de interrupciones (an√°logo de la tabla $ PIR). <br><br>  La tabla MPTable se puede encontrar en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://web.archive.org/web/20121002210153/">especificaci√≥n</a> oficial.  Anteriormente, la especificaci√≥n estaba en el sitio web de Intel, pero ahora solo se puede encontrar en el archivo.  La especificaci√≥n ACPI ahora se encuentra en el sitio web de UEFI (versi√≥n actual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6.2</a> ).  Cabe se√±alar que con ACPI puede especificar el enrutamiento de interrupci√≥n para sistemas sin APIC (en lugar de usar la tabla $ PIR). <br><br><h3>  Msi </h3><br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wiki</a> ) <br><br>  La versi√≥n anterior con APIC es buena, pero no sin fallas.  Todas estas l√≠neas de interrupci√≥n del dispositivo complican los circuitos y aumentan la probabilidad de errores.  El bus PCI fue reemplazado por PCI express, en el que simplemente se decidi√≥ eliminar las l√≠neas de interrupci√≥n.  Para mantener la compatibilidad, ciertos tipos de mensajes emulan las se√±ales de interrupci√≥n (INTx #).  En este esquema, la adici√≥n l√≥gica de l√≠neas de interrupci√≥n, que sol√≠a hacerse mediante la conexi√≥n f√≠sica de los cables, reca√≠a sobre los hombros de los puentes PCI.  Sin embargo, el soporte de interrupci√≥n INTx heredado es solo soporte para la compatibilidad con el bus PCI.  De hecho, PCI express ha propuesto un nuevo m√©todo para entregar mensajes de interrupci√≥n: MSI (interrupciones se√±alizadas por mensaje).  En este m√©todo, para se√±alar una interrupci√≥n, el dispositivo simplemente escribe en el √°rea MMIO asignada para el procesador LAPIC. <br><br><img src="https://habrastorage.org/webt/8z/qw/7h/8zqw7him-vupzm_wi5glkqtr1ja.png"><br><br>  Anteriormente, solo se asignaban 4 interrupciones a un dispositivo PCI (es decir, a todas sus funciones), pero ahora es posible abordar hasta 32 interrupciones. <br><br>  En el caso de MSI, no se comparten las l√≠neas, cada interrupci√≥n corresponde a su dispositivo. <br><br>  Las interrupciones de MSI tambi√©n resuelven otro problema.  Supongamos que un dispositivo realiza una transacci√≥n de escritura de memoria y desea informar su finalizaci√≥n a trav√©s de una interrupci√≥n.  Pero una transacci√≥n de escritura puede retrasarse en el bus durante el proceso de transferencia (que el dispositivo desconoce en absoluto), y la se√±al de interrupci√≥n llegar√° antes que el procesador.  Por lo tanto, la CPU seguir√° leyendo datos no v√°lidos.  Si se usa MSI, se transmite informaci√≥n sobre MSI, as√≠ como datos, y simplemente no podr√° llegar antes. <br><br>  Cabe se√±alar que las interrupciones de MSI no pueden funcionar sin LAPIC, pero el uso de MSI puede reemplazarnos con I / O APIC (simplificaci√≥n de dise√±o). <br><br>  Posteriormente, este m√©todo recibi√≥ la extensi√≥n MSI-X.  Ahora cada dispositivo puede tener hasta 2048 interrupciones.  Y se hizo posible indicar individualmente a cada interrupci√≥n en qu√© procesador deber√≠a ejecutarse.  Esto puede ser muy √∫til para dispositivos con mucha carga, como tarjetas de red. <br><br>  No se requieren tablas de BIOS adicionales para el soporte de MSI.  Pero el dispositivo debe informar el soporte de MSI en una de las capacidades en su configuraci√≥n PCI, y el controlador del dispositivo debe admitir trabajar con MSI. <br><br><h3>  Conclusi√≥n </h3><br>  En este art√≠culo, examinamos la evoluci√≥n de los controladores de interrupci√≥n y recibimos informaci√≥n te√≥rica general sobre la entrega de interrupciones desde dispositivos externos en un sistema x86. <br><br>  En la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">siguiente parte,</a> veremos c√≥mo usar en Linux cada uno de los controladores descritos en la pr√°ctica. <br><br><h4>  Referencias </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Controladores de interrupci√≥n (cosas en el medio)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬øQu√© hacen las diferentes interrupciones en PCIe?</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Reducci√≥n de la latencia de interrupci√≥n mediante el uso de interrupciones se√±alizadas por mensaje</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Arquitectura de procesamiento de interrupciones para sistemas compatibles con Intel</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es430548/">https://habr.com/ru/post/es430548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es430534/index.html">Crear una plantilla para Zabbix usando el SDK Trassir de DVR como ejemplo</a></li>
<li><a href="../es430536/index.html">Dise√±o de funciones de ventana sumadas en una unidad con un nivel dado de superposici√≥n</a></li>
<li><a href="../es430538/index.html">¬øLees Scaladoc para m√©todos de recolecci√≥n "obvios"? O por qu√© la pereza no siempre es buena</a></li>
<li><a href="../es430542/index.html">Seminario web abierto "Infraestructura como c√≥digo"</a></li>
<li><a href="../es430546/index.html">"Se cre√≠a que el c√≥digo ser√≠a reemplazado por diagramas UML, y no habr√≠a necesidad de probarlo": una entrevista con Alexei Barantsev</a></li>
<li><a href="../es430550/index.html">Construyendo un sistema de componentes reactivos con Kotlin</a></li>
<li><a href="../es430552/index.html">Inicio del d√≠a (septiembre-octubre de 2018)</a></li>
<li><a href="../es430554/index.html">Zapatillas de realidad virtual patentadas por Google que puedes caminar para siempre</a></li>
<li><a href="../es430556/index.html">GeekBrains lanza curso de capacitaci√≥n de gerente de producto</a></li>
<li><a href="../es430558/index.html">C√≥mo funciona la puntuaci√≥n en la industria del autom√≥vil compartido. Parte 1. Descripci√≥n general de herramientas populares sobre datos reales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>