<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔖 🚴🏻 📘 Wie Alice Länder anhand von Fotografien erkennt. Yandex-Forschung ♻️ 🧑🏻‍🤝‍🧑🏻 👩🏿‍🍳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo! Mein Name ist Evgeny Kashin und ich arbeite im Yandex Machine Intelligence Labor. Wir haben kürzlich ein Spiel gestartet, in dem Benutzer mit A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie Alice Länder anhand von Fotografien erkennt. Yandex-Forschung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/473056/"> Hallo!  Mein Name ist Evgeny Kashin und ich arbeite im Yandex Machine Intelligence Labor.  Wir haben kürzlich ein Spiel gestartet, in dem Benutzer mit Alice konkurrieren, um Länder anhand von Fotos zu erraten. <br><br>  Wie Menschen handeln, ist verständlich: Sie erkennen Orte, die sie auf Reisen oder in Filmen gesehen haben, verlassen sich auf Gelehrsamkeit und gesunden Menschenverstand.  Das neuronale Netzwerk hat nichts davon.  Wir fragten uns, welche Details auf den Bildern ihr die Antwort gaben.  Wir haben eine Studie durchgeführt, deren Ergebnisse wir heute mit Habr teilen werden. <br><br>  Dieser Beitrag wird sowohl für Spezialisten auf dem Gebiet der Bildverarbeitung als auch für alle interessant sein, die in die "künstliche Intelligenz" schauen und die Logik ihrer Arbeit verstehen möchten. <br><br><img src="https://habrastorage.org/webt/yr/_o/ww/yr_oww7tnonz-ow4eos1dil0eom.png"><br><a name="habracut"></a><br>  Ein paar Worte zum Spiel " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Errate das Land anhand eines Fotos</a> ."  Kurz gesagt, wir haben Fotos von Yandex.Maps gemacht und sie in zwei Gruppen unterteilt.  Die erste Gruppe wurde von neuronalen Netzen gezeigt und sagte, wo jeder Schuss gemacht wurde.  Nach Durchsicht von Tausenden von Fotos entwickelte das neuronale Netzwerk eine Idee für jedes Land - das heißt, es identifizierte unabhängig Kombinationen von Zeichen, an denen es erkannt werden kann.  Wir verwenden die zweite Gruppe von Bildern im Spiel, Alice hat sie nicht gesehen und erinnert sich während des Spiels nicht an sie.  Alice spielt gut, aber die Leute haben einen Vorteil: Wir haben das neuronale Netz nicht trainiert, um Kennzeichen, Texte von Zeichen und Zeichen, Flaggen von Staaten zu erkennen. <br><br><img src="https://habrastorage.org/webt/wl/ch/1k/wlch1kqg7uzoapthamc-pwtvatc.jpeg"><br><br>  Für das Spiel haben wir das Modell trainiert, um das Land anhand eines Fotos vorherzusagen.  Wir haben ein Modell der Computer Vision <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SE-ResNeXt-101 genommen</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das</a> für viele Aufgaben vorab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">geschult wurde</a> .  Die Zeichen, die aus dem Bild unter Verwendung dieses Faltungs-Neuronalen Netzes erhalten werden, sind ziemlich universell, so dass für den Länderklassifikator nur einige zusätzliche Schichten (der sogenannte Kopf) hinzugefügt werden mussten.  Für das Training wurden Yandex.Mart-Daten verwendet: ungefähr 2,5 Millionen Fotos.  Viele Bilder passten nicht nach dem Kriterium der Schönheit zum Spiel und wurden gefiltert.  Schönheit wird als eine Kombination von Faktoren verstanden: die Qualität des Fotos, die Anwesenheit von Menschen, Text, Wald, Meer.  Ähnliche Bilder wurden von derselben Stelle entfernt, so dass sich das Modell nicht an bestimmte Sehenswürdigkeiten erinnerte.  Nach all dem Filtern blieben ungefähr 1 Million Fotos übrig.  Nachdem wir das Modell anhand dieser Daten trainiert haben, haben wir einen ziemlich genauen Klassifikator erhalten, der das Land nur anhand eines Fotos bestimmt, ohne zusätzliche Informationen zu verwenden. <br><br>  Da die Klassifizierung unter Verwendung eines neuronalen Netzwerks durchgeführt wird, können wir im Gegensatz zu einfacheren linearen Modellen oder Entscheidungsbäumen keine einfache Interpretation von Vorhersagen erhalten.  Aber wir wollten herausfinden, wie ein neuronales Netzwerk anhand eines regulären Fotos einer Straße oder eines Hauses bestimmt, um welches Land es sich handelt.  Und die interessantesten Fälle sind ohne Attraktionen im Rahmen. <br><br>  Zu diesem Zweck haben wir das neuronale Netzwerk von Grund auf trainiert und nicht ganze Bilder, sondern nur kleine Erntestücke eingezogen (damit sich das Modell nicht an bestimmte Orte oder große Objekte erinnert). <br><br>  Dadurch ist die Aufgabe für das Modell spürbar schwieriger geworden (versuchen Sie, das Land an einem Stück Himmel zu erraten), die Erkennungsgenauigkeit hat sich stark verringert.  Andererseits musste das neuronale Netz mehr auf kleine Details achten: ungewöhnliches Mauerwerk, spezifische Muster, Dachart, Pflanzen.  Die Größe des auf das Modell angewendeten Zuschnitts änderte sich, und es wurden verschiedene Modelle erhalten, die das Foto auf verschiedenen Abstraktionsebenen betrachteten: Je kleiner der Zuschnitt, desto schwieriger die Aufgabe und desto aufmerksamer das Modell für Details. <br><br><img src="https://habrastorage.org/webt/-l/mq/og/-lmqognmqibnu46jxgyptkcojpk.jpeg"><br><br>  Algorithmen zur Interpretation von Vorhersagen können auf Modelle angewendet werden, die auf Erntegrößen unterschiedlicher Größe trainiert wurden.  Ich möchte die Vorhersagen in den Quellfotos interpretieren.  Die meisten modernen Faltungsnetzwerke verwenden das <a href="">Global Average Pooling</a> (GAP) vor der letzten Schicht. Dies ermöglicht es, das Netzwerk auf einer Größe zu trainieren und auf eine andere anzuwenden.  Dies liegt daran, dass vor der letzten Ebene räumliche Merkmale, die in Breite und Höhe verteilt sind, für jeden Kanal (Merkmalskarte) zu einer Zahl gemittelt werden.  Daher können auf Zuschneiden trainierte Modelle (z. B. 160 × 160 Pixel) für die großen Originalbilder (800 × 800 Pixel) verwendet werden. <br><br>  Tatsächlich wird die GAP-Schicht nicht nur zur Verwendung des Modells mit unterschiedlichen Auflösungen oder zur Regularisierung benötigt.  Es hilft dem neuronalen Netzwerk auch, Informationen über die Position von Objekten bis zur letzten Schicht zu speichern (genau das, was wir brauchen). <br><br>  Die erste Methode, die wir ausprobiert haben, ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Class Activation Mapping</a> (CAM). <br><br><img src="https://habrastorage.org/webt/5e/_j/_x/5e_j_xaziz1xmlvkerszzc2xjxm.jpeg"><br><br>  Wenn das Bild dem Eingang des neuronalen Netzwerks zugeführt wird, wird auf der vorletzten Schicht ein reduziertes "Bild" (tatsächlich der Aktivierungstensor) mit den wichtigsten Vorzeichen für jede vorhergesagte Klasse erhalten.  Mit der CAM-Methode können Sie die letzten Ebenen so ändern, dass die Ausgabe die Wahrscheinlichkeit jeder Klasse in jeder Region ist.  Wenn Sie beispielsweise 60 Klassen (Länder) für ein Eingabebild von 800 × 800 vorhersagen möchten, besteht das endgültige Bild aus 60 Aktivierungskarten mit einer Größe von 25 × 25. Dies ist in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalveröffentlichung</a> gut dargestellt. <br><br>  Das obige Diagramm zeigt das übliche Modell mit GAP: räumliche Merkmale werden für jeden Kanal auf eine Zahl komprimiert (Merkmalskarte). Danach gibt es eine vollständig verbundene Ebene, die Klassen vorhersagt, die die optimalen Gewichte für jeden Kanal finden.  Im Folgenden wird gezeigt, wie Sie die Architektur ändern, um die CAM-Methode zu erhalten: Die GAP-Schicht wird entfernt, und die Gewichte der letzten vollständig verbundenen Schicht, die während des Trainings mit GAP erhalten wurden (siehe Abbildung oben), werden für jeden Kanal an jedem Punkt verwendet.  Für jedes Bild werden N Aktivierungskarten für alle vorhergesagten Klassen erhalten.  Je heller das Gebiet auf der „Karte“ für jedes Land ist, desto größer ist der Beitrag, den dieser Abschnitt des Bildes zur Entscheidung für ein bestimmtes Land geleistet hat.  Was interessant ist: Wenn wir nach dieser Operation jede Aktivierungskarte mitteln (im Wesentlichen GAP anwenden), erhalten wir nur die anfängliche Vorhersage für jede Klasse. <br><br><img src="https://habrastorage.org/webt/i5/21/-i/i521-iavyhhn6bxnf_xpbfwjkvy.png"><br><br>  Im Bild sehen Sie eine Aktivierungskarte für die wahrscheinlichste (je nach Modell) Klasse.  Es wurde erhalten, indem die Aktivierungskarte 25 × 25 auf die Größe des Originalbildes 800 × 800 gestreckt wurde. <br><br><div class="spoiler">  <b class="spoiler_title">Andere Beispiele</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gy/7l/aq/gy7laq5f399atjwit-doxjarj_8.png"><br><img src="https://habrastorage.org/webt/s4/t1/hq/s4t1hqhmregz0f8xjgpsg6n721m.png"><br><img src="https://habrastorage.org/webt/_6/hz/h1/_6hzh1z6clmb7grbi5eesyo3_4k.png"><br><img src="https://habrastorage.org/webt/v0/zd/fd/v0zdfdpxpluft88d08hgmda2v7e.png"><br><img src="https://habrastorage.org/webt/sy/sf/on/sysfonqdv39cdp63ptmxv0w1_f4.png"><br><img src="https://habrastorage.org/webt/v-/o2/b3/v-o2b39ub3svzr504y0h57wos94.png"><br><img src="https://habrastorage.org/webt/on/09/cg/on09cgziwxi6ppgdxbtheoxehd4.png"><br><img src="https://habrastorage.org/webt/ti/8g/ki/ti8gkignbirkrsctvruho9-tl3g.png"><br></div></div><br>  Nachdem wir für jedes Bild eine solche Karte erhalten haben, können wir die wichtigste Ernte für Länder aus verschiedenen Bildern zusammenfassen.  Auf diese Weise können Sie die Erntesammlung betrachten und das Land am besten beschreiben. <br><br>  Die zweite Methode, mit der wir uns entschieden haben, die erste zu vergleichen, ist eine einfache, umfassende Suche.  Was ist, wenn wir ein Modell nehmen, das auf kleinen Zuschnitten (z. B. 160 × 160 Pixel) trainiert ist, und jedes Stück damit auf einem großen 800 × 800-Bild vorhersagen?  Wenn wir ein Schiebefenster passieren, das jeden Bereich des Bildes überlagert, erhalten wir eine andere Version der Aktivierungskarte, die zeigt, wie wahrscheinlich jedes Stück des Bildes zur Klasse des vorhergesagten Landes gehört. <br><br><img src="https://habrastorage.org/webt/vr/d0/ig/vrd0igxkijgsltioftiqregvjhw.png"><br><br>  Das Bild wird in kleine Ausschnitte mit einer Überlappung von 160 × 160 geschnitten. Für jedes Zuschneiden macht das neuronale Netzwerk Vorhersagen. Die Zahl über dem Zuschneiden ist die Wahrscheinlichkeit, zu der Klasse zu gehören, die das Modell schließlich vorhergesagt hat. <br><br><div class="spoiler">  <b class="spoiler_title">Weitere Beispiele</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/aj/zw/nd/ajzwndf0duu_djxkacgbx5fffbg.png"><br><img src="https://habrastorage.org/webt/_j/vk/ma/_jvkma67rsgmxjcgh_ht4t26u0e.png"><br><img src="https://habrastorage.org/webt/q5/uf/kj/q5ufkjpvlcut51tjvonfvz8oc-a.png"><br><img src="https://habrastorage.org/webt/be/al/av/bealavhehhhen23lv_gc-3nz3vi.png"><br></div></div><br>  Wie bei der ersten Methode können wir wieder die wahrscheinlichsten Stücke für jedes Land auswählen.  Die mit beiden Methoden für das Land erhaltenen Bilder können jedoch einheitlich sein (z. B. ein Gebäude aus verschiedenen Winkeln oder eine Version der Textur).  Daher wird die beste Ernte für das Land zusätzlich gruppiert - dann werden die meisten ähnlichen Bilder in einem Cluster gesammelt.  Danach reicht es aus, mit maximaler Wahrscheinlichkeit ein Bild von jedem Cluster aufzunehmen - für jedes Land werden so viele Bilder angezeigt, wie Cluster angegeben sind.  Wir haben Clustering basierend auf den Eigenschaften durchgeführt, die aus der letzten Klassifikatorschicht erhalten wurden.  Agglomerative Clusterbildung erwies sich in unserem Fall als die beste. <br><br><img src="https://habrastorage.org/webt/01/bl/dt/01bldtbu2pk2tlegwiahkrfbyls.png"><br><br><div class="spoiler">  <b class="spoiler_title">China</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/0j/3t/e1/0j3te1fos-feivrx72damea3rdu.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Italien</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tp/xa/hy/tpxahykascxpynkfngesl3mojsc.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Deutschland</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q4/na/3e/q4na3ea9i6t_cm2kchkvst9yass.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Mexiko</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jv/zc/hg/jvzchgdvxyigsmgujk8ydmqo4v4.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Den USA</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hy/t2/pb/hyt2pbota0isw955unsxnpn8wym.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Die Türkei</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/47/nk/mk/47nkmkhl0didrcmsimstecwo1ye.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Australien</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/z3/kg/br/z3kgbr5eqy6rfxbf23f-rcwljyo.png"><br></div></div><br>  Nachdem Sie eine ziemlich ähnliche Pipeline für die beiden Methoden erhalten haben, können Sie die Parameter der Algorithmen durchlaufen, um die optimale Kombination zu finden.  Zum Beispiel haben wir die Größe des Zuschnitts ausgewählt und uns für zwei Optionen entschieden: 160 und 256 Pixel.  Pflanzen unter 160 gaben zu kleine Zeichen, wonach eine Person oft nicht versteht, was abgebildet ist.  Und mehr als 256 Pflanzen enthielten manchmal mehrere Objekte gleichzeitig.  In der Phase des Clustering müssen verschiedene Parameter ausgewählt werden: die Auswahl des Hauptalgorithmus sowie die Merkmale, mit denen das Clustering durchgeführt wird.  Bei vielen Parameterkombinationen war sofort klar, dass sie nicht ausreichend „interessante“ Ernte liefern.  Um den endgültigen Algorithmus auszuwählen, haben wir nebeneinander Experimente mit Tolok durchgeführt, um zu verstehen, welche Option laut Angaben der Menschen das jeweilige Land „angemessener“ beschreibt. <br><br>  Es stellte sich als nicht intuitiv heraus, dass eine einfachere Methode zum Auffinden von Zuschnitten im Bild (normale Suche) „interessantere“ Objekte findet.  Dies kann auf die Tatsache zurückzuführen sein, dass das neuronale Netzwerk bei der zweiten Methode (Aufzählung) den benachbarten Teil des Bildes nicht sieht und bei der CAM-Methode die Umgebung des Punkts das Ergebnis beeinflusst.  Als Ergebnis erhielten wir eine Visualisierung der charakteristischen Merkmale jedes Landes im automatischen Modus. <br><br>  Jetzt wissen wir also, welche Teile des Rahmens für das neuronale Netzwerk von entscheidender Bedeutung sind, und wir können sehen, was auf sie gefallen ist.  Beispielsweise erkennen die Niederlande ein neuronales Netzwerk an der Kombination von dunklen Backsteinmauern und weißen Fensterkonturen, die Vereinigten Arabischen Emirate - an bestimmten Wolkenkratzern vor dem Hintergrund von Palmen und der Iran - an den charakteristischen Bögen und Ornamenten an den Fassaden. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473056/">https://habr.com/ru/post/de473056/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473042/index.html">Vor- und Nachteile von Django</a></li>
<li><a href="../de473044/index.html">So erstellen Sie effektive Screenshots für eine Anwendung im App Store</a></li>
<li><a href="../de473046/index.html">Wellen, Wind und Willenskraft: Wie das robuste Tablet von Dell den Russen hilft, internationale Regatten zu gewinnen</a></li>
<li><a href="../de473050/index.html">AMD zwingt Intel, die Preise nicht nur für neue, sondern auch für ältere CPU-Modelle zu senken. Dies ist der Beginn eines weiteren Preiskampfs</a></li>
<li><a href="../de473054/index.html">WorldSkills final, Entwicklung von IT-Lösungen für Unternehmen - was es ist, wie es war und warum 1C-Programmierer dort gewonnen haben</a></li>
<li><a href="../de473058/index.html">Sergey Sinitsyn: „OSM ist mehr als nur das Zeichnen von Häusern oder Spuren. Das sind mehr Geschichten! “</a></li>
<li><a href="../de473062/index.html">Subjektive user.js für Mozilla Firefox und nicht nur</a></li>
<li><a href="../de473064/index.html">Batavianische Tränen, Autos und Gorilla-Glas: über einige Arten von verstärktem Glas</a></li>
<li><a href="../de473066/index.html">Quadrantenbäume und Kollisionserkennung</a></li>
<li><a href="../de473070/index.html">Redux - Nicht benötigt! Ersetzen durch useContext und useReducer in React?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>