<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº üë∞ üë©üèª‚Äçüíª Exp√©rience de d√©veloppement de SPA sur VueJS + Nuxt üíÉüèæ üç≥ üòë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Notre entreprise est principalement engag√©e dans le d√©veloppement de boutiques en ligne et nous souhaitons partager notre exp√©rience dans le d√©veloppe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Exp√©rience de d√©veloppement de SPA sur VueJS + Nuxt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414137/">  Notre entreprise est principalement engag√©e dans le d√©veloppement de boutiques en ligne et nous souhaitons partager notre exp√©rience dans le d√©veloppement d'un projet sur un bouquet de VueJS + Nuxt + Laravel. <br><a name="habracut"></a><br>  L'article expliquera comment nous avons d√©cid√© de mettre en ≈ìuvre la boutique en ligne en tant que SPA: comment nous y sommes arriv√©s, difficult√©s, facilit√©. <br><br>  Le site qui sera discut√© est une boutique en ligne presque classique avec un catalogue, des filtres, une recherche, un panier, un compte personnel, c'est-√†-dire  presque tout ce qui peut √™tre dans le magasin.  Le projet a une logique, une tarification et une cartographie diff√©rentes pour les personnes morales et les particuliers. <br><br><h4>  Pourquoi SPA </h4><br>  Avant le projet actuel, notre exp√©rience dans le d√©veloppement d'applications d'une seule page consistait en seulement quelques projets internes.  Et √† bien des √©gards, le SPA pour nous √©tait, dans un sens, un cheval noir. <br><br>  Il n'y avait pas de compr√©hension claire des probl√®mes li√©s √† la croissance du projet, √† sa promotion et √† sa stabilit√©, lorsque, en tant qu'exp√©rience et processus de longue dur√©e dans la cr√©ation de sites ordinaires, ils n'ont soulev√© aucune question pour r√©soudre ces probl√®mes. <br><br>  Le choix de l'approche a provoqu√© un d√©bat assez houleux dans notre entreprise, les √©chelles et les arguments ont √©t√© remplis et la d√©cision a √©t√© tr√®s difficile.  Nos d√©veloppeurs ont d√©cid√© de collecter un prototype de plusieurs pages du projet et de voir quelles difficult√©s surgiraient avec chaque approche.  Cette approche nous a aid√©s √† trouver la solution finale.  Les prototypes ont permis de montrer que la gestion de l'√©tat du site (catalogue, panier, caisse, etc.) est beaucoup plus confortable et pose moins de probl√®mes dans la version SPA.  La vitesse de d√©veloppement et d'interaction entre les typographes et les programmeurs a consid√©rablement augment√© du fait que vous n'avez pas besoin de transf√©rer la disposition, il suffit d'ajouter de la logique aux composants pr√™ts √† l'emploi.  Les probl√®mes que nous pouvons rencontrer sont √©galement devenus plus clairs, ce qui a incit√© √† de nouvelles actions.  Avant nous, le choix de la technologie. <br><br>  En dehors de la fen√™tre, c'est l'√©t√© 2017. Sur Twitter et sur support, les litiges ne se calment pas, ce qui est encore mieux, voir ou r√©agir.  Notre bureau n'a pas d√©pass√© cette tendance.  Les d√©veloppeurs se sont √©galement divis√©s en deux camps, chacun avec ses propres arguments.  Avant cela, chacun de nous a d√©j√† travaill√© avec les deux technologies. <br>  Quelqu'un est devenu plus proche de jsx, quelqu'un pr√©f√®re le html ou le pug plus familier, quelqu'un pense que l'immuabilit√© aide √† mieux surveiller et contr√¥ler l'√©tat de l'application, pour quelqu'un cela semble √™tre une complication excessive.  D'un autre c√¥t√©, chaque framework nous donne la possibilit√© de cr√©er des composants √† fichier unique, et pour les deux il existe d√©j√† des biblioth√®ques assez stables avec un ensemble de toutes les fonctions n√©cessaires pour nous (ssr, gestion d'√©tat globale, routage, gestion des m√©tadonn√©es).  Pour react, c'est nextjs, et pour vue c'est nuxtjs.  Nuxt au moment de la s√©lection √©tait toujours en version b√™ta, mais assez stable.  Parce que  le processus de d√©veloppement a √©t√© construit de telle mani√®re que nous avons initialement une mise en page, puis de construire la partie backend et de transf√©rer la mise en page des pages vers le frontend, le choix du framework √©tait assez simple.  Nous avons choisi vue et nuxtjs, car  il a √©t√© d√©cid√© de r√©aliser le site et de lancer l'api en parall√®le.  Avec cette approche, il est pratique de composer imm√©diatement des composants et d'y ajouter de la logique.  Nos concepteurs de mise en page ont adopt√© une approche plus √©troite pour cr√©er leur code HTML habituel. <br><br><h4>  Un peu de backend </h4><br>  En termes de solutions serveur et en g√©n√©ral du choix des technologies pour la construction du backend, nous sommes pass√©s par la voie la plus famili√®re.  Le langage a √©t√© choisi php, pour lequel nous utilisons le framework laravel.  Tout tourne sur nginx.  En tant que solution de base de donn√©es, nous avons mysql. <br><br><h4>  D√©but du d√©veloppement, packages utilis√©s et probl√®mes </h4><br>  Nuxt nous fournit des packages totalement satisfaisants pour g√©rer l'√©tat de l'application (vuex) et le routage (vue-router).  Par cons√©quent, commencer √† assembler le projet et fixer la logique aux composants pourrait commencer imm√©diatement, puis, au besoin, rechercher les packages dont nous avons besoin.  Tout d'abord, bien s√ªr, j'avais besoin d'une solution pour communiquer avec la partie backend.  Pour ce faire, axios a √©t√© choisi, le standard d√©j√† pour tout le monde, et le wrapper du module nuxt-axios dessus.  Nous aidons √©galement imm√©diatement le projet √† ne pas se perdre dans l'environnement et √† l'ex√©cuter dans chaque environnement avec la configuration souhait√©e - s√©lectionnez dotenv et l'encapsuleur nuxt-dotenv-module.  Pour commencer le d√©veloppement, cela suffit et le processus de mise en page a commenc√©. <br><br>  La premi√®re pause s'est produite lorsqu'il a √©t√© n√©cessaire d'ajouter un curseur d'image √† la mise en page.  "O√π est mon slick-slider, je veux jquery" a √©t√© entendu du c√¥t√© agencement de la salle.  Un examen rapide des solutions pr√™tes √† l'emploi a r√©v√©l√© plusieurs curseurs appropri√©s pour nous.  Mais presque tout le monde a entra√Æn√© une d√©pendance sous la forme de jquery, que je ne voulais pas ajouter au bundle fini, augmentant ainsi sa taille.  Certains packages ne prenaient pas en charge le rendu du serveur, ce qui √©tait √©galement important pour nous.  En cons√©quence, le choix s'est port√© sur awesome-swiper, qui r√©pondait pleinement √† nos exigences et m√™me un peu plus.  Apr√®s que le curseur a √©t√© boulonn√©, nos concepteurs de mise en page sont rest√©s longtemps perdus.  ¬´Est-ce tout, dois-je faire autre chose?  Pr√©cisez simplement une liste d'images et √ßa marche? <br><br>  Vint ensuite le choix du composant pour la s√©lection des dates.  Il y avait plus de chance  un emballage pour notre flatpickr bien-aim√© a √©t√© rapidement trouv√©.  Il ne restait plus qu'√† le coiffer un peu. <br><br>  √Ä plusieurs endroits sur le site, il y a une carte.  Mais, parce que  nous n'avions pas besoin de d√©tails parfaits et d'√©laboration de la carte, il n'y avait pas de choix entre les services.  N√©anmoins, au moment du d√©veloppement, et m√™me maintenant, il n'y a pas de solutions qui couvrent id√©alement tous nos besoins.  Sur la base de tous les avantages et inconv√©nients, google maps et le wrapper vue2-google-maps ont √©t√© choisis.  Le paquet est assez grand et tire beaucoup de choses inutiles pour nous, mais il r√©sout bien ses probl√®mes. <br><br>  Dans certains formulaires, nous avons des champs pour entrer le t√©l√©phone.  L'utilisateur doit aider √† entrer le t√©l√©phone, car il y a trop d'options pour le format, puis travailler √† l'avenir avec des donn√©es saisies dans un seul format est plus facile.  Par cons√©quent, vous avez besoin d'un masque.  Je voulais utiliser le masque de texte d√©j√† familier, et ici nous avons eu de la chance, ils avaient d√©j√† une solution pour vue - vue-text-mask. <br><br>  Ces forfaits couvraient presque toutes nos exigences.  Il ne restait plus qu'√† suivre les clics en dehors du composant, ce que vue-click-outside a aid√©.  Nous avons impl√©ment√© le d√©filement rapide de la page en utilisant vue-backtotop.  Pour travailler avec des dates, utilisez moment. <br><br><h4>  La taille finale du paquet et d'o√π vient 1 m√©gaoctet </h4><br>  Il ne faut pas oublier qu'un crit√®re important lors du choix des emballages √©tait leur poids. <br><br>  Au milieu du projet, nous avons d√©cid√© d'analyser le projet final et de voir les dimensions de l'assemblage.  Les r√©sultats √©taient, pour le moins, surprenants.  La taille du gang app.js √©tait l√©g√®rement sup√©rieure √† 950 kb gzip.  L'√©quipe d'analyse de l'ex√©cution de npm nous a apport√© un beau graphique avec la taille de tous les modules, √† partir duquel nous avons r√©alis√© que certains modules tiraient des d√©pendances inutiles sous la forme de jquery, lodash, etc.  Ils ont d√ª refuser ces colis et leur trouver une alternative.  Actuellement, la taille de l'ensemble est de 480 kb gzip. <br><br><img src="https://habrastorage.org/webt/d9/q5/wo/d9q5woogma0yygvlzimwhk8eu6w.png"><br><br>  Surveillez les d√©pendances et v√©rifiez r√©guli√®rement la taille de votre application. <br><br><h4>  Page de chargement initial et donn√©es obtenues par l'API </h4><br>  Nuxt offre une opportunit√© pratique de remplir le magasin avec des donn√©es c√¥t√© serveur avant de charger le client.  Pour cela, l'action nuxtServerInit est utilis√©e.  Cela ressemble √† ceci pour nous: <br><br><img src="https://habrastorage.org/webt/bs/1t/yc/bs1tycfomfmwwuq8mbegz8movug.png"><br><br>  Comme nous utilisons des cat√©gories et d'autres entit√©s dans plusieurs composants √† la fois, il √©tait plus pratique pour nous de les obtenir imm√©diatement et de les mettre en magasin. <br><br>  Mais ici, il y a un probl√®me avec la taille json que vous obtenez.  √âtant donn√© que le serveur envoie toutes les donn√©es re√ßues au client pour le rendu initial, la taille html peut √™tre trop grande.  Nous l'avons rencontr√© lorsque, dans les cat√©gories, nous avons commenc√© √† transf√©rer des images, des descriptions et d'autres champs qui nous √©taient inutiles sur toutes les pages appartenant √† chaque cat√©gorie.  La taille json √©tait sup√©rieure √† 2 Mo.  Heureusement, cela peut √™tre facilement r√©solu en supprimant les champs inutiles des donn√©es fournies par le serveur. <br><br><h4>  Fuites de m√©moire </h4><br>  Apr√®s un certain temps, l'application sur notre serveur de test, nous avons commenc√© √† observer une augmentation artificielle de la consommation de m√©moire.  pm2 occupait jusqu'√† 90% de toute la m√©moire du serveur et l'application se bloquait p√©riodiquement.  Sur la page github, nuxt a d√©j√† bloqu√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">quelques probl√®mes</a> avec le m√™me probl√®me. <br><br>  Le probl√®me est survenu lorsque nous avons fait plusieurs requ√™tes dans la m√©thode asyncData de nos pages. <br><br><img src="https://habrastorage.org/webt/6c/1j/pr/6c1jprerb-bhjbaekqpft8xqmig.png"><br><br>  Heureusement, les d√©veloppeurs nuxt ont rapidement r√©solu ce probl√®me, et actuellement le processus consomme environ 40 Mo de m√©moire. <br><br><h4>  Probl√®mes int√©ressants et leurs solutions </h4><br>  <b>Articles composants</b> <br>  Dans le panneau de configuration du site, il est possible d'ajouter des articles et d'ins√©rer divers blocs dans le contenu de l'article, par exemple, un bloc contenant des marchandises. <br><br><img src="https://habrastorage.org/webt/09/tj/vz/09tjvzsjrrxk5sux44dhsxrvxty.png"><br><br>  Le code HTML provenant du serveur ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/q_/-r/kx/q_-rkxht2vmhwby6ckddpwn3pqk.png"><br><br>  $ product-4 indique que le composant Product.vue avec l'identifiant 4 devrait √™tre √† la place de ce pointeur. Vue nous offre de nombreuses possibilit√©s pour rendre le composant en utilisant la m√©thode de rendu.  Tout d'abord, nous recherchons toutes les r√©f√©rences aux pointeurs vers les composants dans le html qui est arriv√© et nous obtenons par api les donn√©es n√©cessaires pour afficher ce composant.  Ensuite, nous avons divis√© l'ensemble du code HTML en un arbre.  La biblioth√®que de l'Himalaya nous a aid√©s avec cela.  Et puis nous r√©cup√©rons le HTML en rempla√ßant les pointeurs par des composants pr√™ts √† l'emploi. <br><br>  ... Et il n'y avait pas assez de force pour √©crire un article) Ils ont commenc√© √† √©crire l'article √† l'√©t√© 2017 pendant le d√©veloppement du projet, et c'est d√©j√† l'√©t√© 2018 dans la cour, le projet a √©t√© lanc√© et l'article n'a pas √©t√© publi√©. <br>  Par cons√©quent, nous publions ce que nous avons rassembl√©, mais nous avons encore de nombreux sujets et observations int√©ressants. <br>  Si ce sera int√©ressant - √©crivez, aimez-le)) Eh bien, quoi d'autre serait-il int√©ressant d'entendre, que vous avez manqu√©. <br><br>  Je veux dire que le projet fonctionne depuis environ 4 mois.  Il n'y a pas eu de probl√®me particulier et la vitesse du site est impressionnante et le distingue des autres magasins. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414137/">https://habr.com/ru/post/fr414137/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414127/index.html">Installez 3CX sur un h√©bergement pour 2,99 euros / mois. en 10 minutes</a></li>
<li><a href="../fr414129/index.html">Master en informatique th√©orique √† l'Universit√© d'√âtat de Saint-P√©tersbourg</a></li>
<li><a href="../fr414131/index.html">L'effet de la fr√©quence du signal sur l'√©nergie des liaisons radio dans l'espace libre</a></li>
<li><a href="../fr414133/index.html">Conception de jeux de puzzle avec l'exemple de In The Shadows</a></li>
<li><a href="../fr414135/index.html">Comment le portage d'un jeu sur PSVita a am√©lior√© les performances globales</a></li>
<li><a href="../fr414139/index.html">Sortie du proxy MTProto non officiel en Python, fonctionnalit√©s du protocole</a></li>
<li><a href="../fr414141/index.html">7 r√®gles pour concevoir des cartes de circuits imprim√©s</a></li>
<li><a href="../fr414149/index.html">Les raisons du mauvais son de la plupart des smartphones Android</a></li>
<li><a href="../fr414151/index.html">Fintech-Digest: les banques signaleront les dommages caus√©s par les attaques de pirates informatiques, Western Union refuse de travailler avec les crypto-monnaies</a></li>
<li><a href="../fr414155/index.html">Syst√®mes d'√©v√©nements dans Unity3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>