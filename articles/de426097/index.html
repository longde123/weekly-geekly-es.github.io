<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👦 🧑🏾‍🤝‍🧑🏼 ⛽️ Arduino Projekt "RoboCar4W Robot Machine" 🤙🏾 👩🏿‍🚒 👩🏾‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sie verstehen ", erklärte der Herausgeber," es sollte unterhaltsam, frisch und voller interessanter Abenteuer sein ... damit der Leser nicht abspringe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arduino Projekt "RoboCar4W Robot Machine"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426097/"><p>  <em>Sie verstehen ", erklärte der Herausgeber," es sollte unterhaltsam, frisch und voller interessanter Abenteuer sein ... damit der Leser nicht abspringen kann.</em> <br>  I. Ilf, E. Petrov <em>"Wie wurde Robinson geschaffen"</em> . </p><br><p>  Der Einstieg in Arduino ist wie bei jeder anderen Software- oder Hardwareplattform von einem echten Projekt aus immer interessanter.  Gleichzeitig schreiben Programmierer Code, der "Hallo Welt" anzeigt, Arduinisten blinken eine LED.  Und alle sind als Kinder glücklich. </p><br><p>  Ich beschloss, mit einem fortgeschrittenen Projekt zu beginnen, auch mit der geheimen Hoffnung, die junge Generation aus Counter-Strike herauszureißen (gescheitert). </p><br><p>  Wie Sie dem Namen RoboCar4W entnehmen können, war das erste Projekt ein Allrad-Roboterauto.  Als ich mit der Arbeit anfing, hatte ich bereits Programmiererfahrung, ich wusste einmal lange, wie man lötet, aber ich kannte die Pinbelegung von Arduino überhaupt nicht und las die Dokumentation überhaupt nicht.  Ich habe im Laufe des Spiels alle Weisheiten studiert und Google geholfen. </p><a name="habracut"></a><br><p>  Da das Projekt selbst grundsätzlich nicht neu ist, reichen solche Beschreibungen im Netzwerk aus, alle Komponenten sind bekannt, es wurden keine Überraschungen erwartet.  Daher wurde die Idee allgemein formuliert und das Hauptziel bestand darin, mit Arduino als Plattform für Rapid Prototyping in die "Welt der Dinge" einzutauchen.  In diesem Werk erkennt sich vielleicht jemand am Anfang der Reise. </p><br><p>  Die gesamte Hardware wurde bei ebay gekauft, und aus eigener Erfahrung möchte ich sagen, dass es einfacher ist, ein Starter-Kit sofort zu kaufen (suchen Sie es in den Worten des Arduino Starter-Kits), als es im Detail zusammenzubauen.  Ja, und alle kommen auf einmal zusammen.  Es wurde beschlossen, nicht zu spielen, ein normales Chassis, normale Räder, normale Motoren zu kaufen, so dass es "teuer" war. </p><br><p>  Das Hauptgeheimnis für erfolgreiche Einkäufe bei eBay besteht darin, bei erstklassigen Verkäufern einzukaufen und die Produktbeschreibung sorgfältig zu lesen.  Es gibt viele Artikel darüber im Internet. </p><br><p>  Welches Arduino Board soll man wählen? </p><br><p>  Ich habe Arduino UNO genommen, viele Projekte mit Beschreibungen dafür.  Aber jetzt würde ich das Arduino Mega 2560 nehmen, es hat mehr digitale und analoge Ausgänge und volle Kompatibilität bei Projekten mit UNO. </p><br><h1 id="obschee-opisanie-proekta">  Allgemeine Beschreibung des Projekts </h1><br><p>  In der Welt der Softwareentwicklung wird dies auch als "Systemanforderungen" bezeichnet. </p><br><p>  Die Idee des Projekts war wie folgt.  Die erste Version der Robotermaschine namens RoboCar4W sollte einfache Aktionen ausführen: </p><br><ul><li>  vorwärts, rückwärts bewegen, Kurven ausführen </li><li>  Abstand zu Hindernissen messen </li><li>  in der Lage sein, die Hindernisse vor Ihnen automatisch zu umgehen. </li></ul><br><p>  Die zweite Version des Geräts muss manuell über Bluetooth von einem Android-Telefon aus gesteuert werden. </p><br><p>  Damit Sie hier besser arbeiten können, wird das gesamte endgültige RoboCar4W-Projekt zusammengestellt (hier ohne Bluetooth). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/457/929/cc8/457929cc8554ef727654f53704ece195.jpg" alt="Arduino RoboCar4W"></p><br><p>  Hier ist ein Video von Seeversuchen. </p><br><p>  Im ersten Video fährt RoboCar4W automatisch mit Hindernisvermeidung auf zwei verschiedenen Versionen der "Firmware", d. H.  Skizzieren Sie daher, wenn jemand am meisten interessiert ist und bemerkt, dass das Verhalten des Roboters in verschiedenen Episoden leicht unterschiedlich ist. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/a05/27c/f11/a0527cf11325d83a2b91826412b151b9.jpg" alt="Roboterauto RoboCar4W"></a> </p><br><p>  Im zweiten Video bewegt sich RoboCar4W mithilfe von Befehlen, die der „Fahrer“ über Bluetooth von einem Mobiltelefon unter Android überträgt.  Auf dem Telefon ist „Bluetooth RC Car“ installiert.  Wenn sich darüber hinaus ein Hindernis in der Nähe befindet, stoppt der Roboter, d.h.  Das Rammen von etwas funktioniert nicht (es gibt jedoch eine "geheime" Schaltfläche, die den abgesicherten Modus deaktiviert). </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/173/997/d9c/173997d9c4f497310ab582b11007d468.jpg" alt="Roboterauto RoboCar4W"></a> </p><br><p>  Im dritten Video zeigt RoboCar4W ein vorprogrammiertes Demobewegungsprogramm mit Kurven.  Das Demo-Programm wird auf Befehl von demselben Android-Handy aus aktiviert.  Der Roboter fährt nur eine Weile und macht Kurven. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/820/a73/9f5/820a739f5e40ca959f0c441e53552e4d.jpg" alt="Roboterauto RoboCar4W"></a> </p><br><h1 id="algoritm-upravleniya-dvizheniem">  Bewegungssteuerungsalgorithmus </h1><br><p>  Es ist ein Fehler, unsere Methode als "Hindernisvermeidungsalgorithmus" oder "Pfadfindung" zu bezeichnen.  Dies sind getrennte mathematische Disziplinen, reine Mathematik.  Wenn Sie Mathematik wirklich, wirklich mögen, dann googeln Sie diese Sätze, Sie werden für sechs Monate mit Lesen versorgt. </p><br><p>  In der Zwischenzeit interessieren wir uns für Dinge, die viel einfacher sind.  Deshalb nennen wir es einfach - den Bewegungssteuerungsalgorithmus eines 4-Rad-Roboters.  Natürlich sprechen wir von automatischer Steuerung ohne menschliches Eingreifen. </p><br><p>  Hier ist dieser einfache Algorithmus in Worten geschrieben. Für komplexere Algorithmen ist es erforderlich (ob Sie es wollen oder nicht), Blockdiagramme zu erstellen. </p><br><p>  Schauen Sie sich jetzt gleichzeitig den Quellcode für die Skizze <a href="">RoboCar4W-1.ino an</a> . </p><br><ol><li>  Wir messen den Abstand zum Hindernis vor uns. </li><li> Wenn dieser gemessene Abstand kleiner als der <code>DST_TRH_BACK</code> Wert ist (kurz für den Entfernungsschwellenwert), halten wir an und fahren beim Abbiegen rückwärts.  Die Drehrichtung wird wie folgt gewählt: Wenn Sie zuvor nach links gedreht haben, biegen Sie nach rechts ab und umgekehrt. </li><li>  Wenn der gemessene Abstand größer als <code>DST_TRH_BACK</code> , aber kleiner als <code>DST_TRH_TURN</code> , drehen Sie ihn einfach.  Die Drehrichtung wird zufällig gewählt. </li><li>  Wenn Sie weit vom Hindernis entfernt sind, fahren Sie einfach fort. </li><li>  Wir wiederholen noch einmal. </li></ol><br><p>  Was ist gut daran, dass wir 4 Räder und Allradantrieb haben?  Wir können verschiedene Arten von Runden ausführen (programmieren): </p><br><ul><li>  Reibungslose Rotation.  Alle Räder drehen sich, aber die Räder auf einer Seite drehen sich schneller. </li><li>  Eine scharfe Kurve.  Die Räder drehen sich nur einseitig. </li><li>  Wenden Sie an Ort und Stelle.  Wie bei einem Traktor drehen sich die Räder auf einer Seite rückwärts und auf der anderen vorwärts. </li></ul><br><p>  In der zweiten Version des Programms kann bei der Steuerung von einem Android-Telefon aus der abgesicherte Modus deaktiviert werden, wenn der Roboter versucht, Frontalkollisionen zu verhindern, wenn das Programm zweimal gedrückt wird <br><img src="https://habrastorage.org/getpro/habr/post_images/2d3/256/454/2d3256454e390ed508f62d212ffb1d15.jpg" alt="Knopf"></p><br><p>  und durch einmaliges Drücken wieder eingeschaltet. </p><br><p>  <em>Wichtiger Hinweis</em> .  Alle Logik steht unter der Kontrolle von Arduino.  Android verhält sich hier wie eine Spielekonsole (ohne Verstand) von der Konsole aus. Seine Aufgabe besteht darin, dumm Tastendrücke (d. H. Befehle) über Bluetooth an den Arduino RoboCar4W zu übertragen. </p><br><h1 id="komponenty">  Komponenten </h1><br><p>  Zu Beginn enthielt die Maschine einen Servoantrieb, der den Ultraschall-Entfernungsmesser für Messungen in drei Richtungen um einen bestimmten Winkel drehte.  Während der Tests brannte das Servo aufgrund unachtsamer Handhabung aus, sodass der Abstandssensor jetzt einfach starr vor dem Gehäuse befestigt ist. </p><br><p>  Es gibt keinen Silberstreifen, aber die Skizze ist etwas einfacher geworden. </p><br><p>  Kaufen Sie für die Zukunft das einfachste und billigste Servo, spezielle Leistung, Geschwindigkeit und Drehgenauigkeit in einem bestimmten Winkel sind nicht erforderlich, und es ist recht einfach, ein Servo zu deaktivieren, wie sich herausstellte.  SG90 im Wert von 2 US-Dollar passt gut. </p><br><p>  Daher werden die Komponenten des RoboCar4W-Projekts in englischer Sprache beschrieben, um die Suche bei ebay und dergleichen zu erleichtern: </p><br><ul><li>  Arduino UNO R3 </li><li>  Fertiges Chassis Allrad-Mobilroboterplattform Smart Car Chassis Arduino-kompatibel </li><li>  Gleichstrommotoren mit Drehung in beide Richtungen - 4 Stk. </li><li>  Räder - 4 Stk. </li><li>  Platine zur Steuerung von 4 Gleichstrommotoren Motor Drive Shield L293D </li><li>  Ultraschall-Entfernungsmesser HC-SR04 Ultraschallmodul-Entfernungsmesssensor </li><li>  Ni-MH 1,2 V Batterien - 8 Stk. </li><li>  Kunststoffboxhalter für Batterien, Batterieboxhalter 4 AA Batterien - 2 Stck. </li><li>  Batterietyp "Krona" 8,4 V - 1 Stck. </li><li>  Optionaler Kippschalter - Netzschalter </li></ul><br><p>  Fahrgestell, Gleichstrommotoren und Räder wurden sofort im Kit und sogar mit Montageanleitung gekauft. </p><br><h1 id="raspinovka">  Pinbelegung </h1><br><p>  Die analogen Eingänge können als digitale Pins von E / A-Ports verwendet werden.  Die den analogen Eingängen entsprechenden Arduino-Pins sind mit 14 bis 19 nummeriert. Dies gilt nur für die Arduino-Pins, nicht für die physischen Pin-Nummern des Atmega-Mikrocontrollers. </p><br><p>  Sie müssen nicht zeichnen, Sie können einfach alles in einen Tisch legen.  Ich habe es so gemacht. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/504/d24/fff/504d24fff6bdc78120e1a28a39848967.png" alt="Pinbelegung"></p><br><p>  Die Pins D4, D7, D8, D12 sind belegt, wenn Gleichstrommotoren oder Schrittmotoren verwendet werden. </p><br><p>  Die Pins D9 (Servo # 1-Steuerung), D10 (Servo # 2-Steuerung) werden nur verwendet, wenn Servomotoren verwendet werden. </p><br><p>  Der Arduino-Pin belegt nicht die Arduino-Pins zur Steuerung des Motor Drive Shield L293D. </p><br><p>  Die Stromanschlüsse 3,3 V, 5 V und Masse sind in ausreichenden Mengen auf dem Motorantriebsschild dupliziert.  Daher besteht kein Grund zur Sorge über ihren Mangel. </p><br><p>  Wenn Sie immer noch schön zeichnen möchten, hilft Ihnen das kostenlose Fritzing-Programm. </p><br><h1 id="pitanie">  Ernährung </h1><br><p>  Dies ist der zweite sehr wichtige Punkt.  Viel hängt von der Ernährung ab.  Beispielsweise verbraucht ein Servomotor beim Drehen der Welle in einem bestimmten Winkel viel Strom.  Wenn das Servo von einem 5-V-Arduino gespeist wird, kommt es gleichzeitig zu einem "Spannungsabfall", und der Rest der Schaltung beginnt zu versagen, und der Arduino kann sogar gleichzeitig neu starten. </p><br><p>  In jedem Fall wird ein Motor Drive Shield (oder eine ähnliche Schaltung) benötigt, wenn Sie Motoren im Fahrzeug verwenden. </p><br><p>  Wir haben also 4 Gleichstrommotoren, einen Servoantrieb, das Arduino-Board selbst und mehrere Sensoren.  Die Motoren sind am gefräßigsten, aber die Sensoren können erfolgreich über die Anschlüsse der Arduino-Platine selbst mit Strom versorgt werden, sodass mit ihnen alles einfach ist.  Der Einfachheit halber habe ich die gesamte Wirtschaft in einem Tisch reduziert. </p><br><table><thead><tr><th></th><th>  Empfohlene oder typische Spannung.  Stromaufnahme </th><th>  Maximale Spannung </th><th>  Was soll gefüttert werden? </th><th>  Anmerkungen </th></tr></thead><tbody><tr><td>  Arduino UNO R3 Board </td><td>  7 - 12 V, 200 mA (Durchschnitt) </td><td>  6 - 20 </td><td>  "Krone 9V" Li-Ion 650mAh, 8,4V </td><td>  Mittelanschluss </td></tr><tr><td>  Servomotor MG-995 </td><td>  5-6 V, 0,1 - 0,3 A (Peak) </td><td>  4.8 - 7.2 </td><td>  Batterien (5) Stck.  Ni-Mh 1,2 V = 6 V. </td><td>  Essen nur aus einer separaten Quelle.  Wenn Sie mit Arduino zusammenarbeiten, wird alles fehlschlagen.  4 Stück Ni-Mh Batteriespannungen  * 1,2 V = 4,8 V reichen nicht aus.  Einige argumentieren, dass dieses Servo nicht nur bei 6 Volt 4,8 verwendet werden sollte </td></tr><tr><td>  Gleichstrommotoren (4 Stk.) </td><td>  6 - 8 V, Strom von 70 mA bis 250 mA </td><td>  3 - 12 </td><td>  Batterien (5 + 3) Stck.  Ni-Mh 1,2 V = 9,6 V. </td><td>  Sie können Motoren normalerweise nicht mit einer 9-V-Batterie starten, verschwenden Sie also nicht einmal Zeit (und Batterien)! </td></tr><tr><td>  Motorantriebsabschirmung L293D </td><td>  nicht erforderlich </td><td>  4,5 - 36 </td><td>  nicht erforderlich </td><td></td></tr><tr><td>  Bluetooth-Modul HC-0506 </td><td>  3,3 V, 50 mA </td><td>  1,8-3,6 </td><td>  Mit Pin 3.3V Arduino Board </td><td></td></tr><tr><td>  Ultraschall-Entfernungsmesser HC-SR04 </td><td>  5 V, 2 mA </td><td>  5 </td><td>  Mit Pin 5V Arduino Board </td><td></td></tr></tbody></table><br><p>  Ich hatte keinen DC / DC-Spannungswandler.  Krona 9V war keine sehr gute Energiequelle, ich hatte sie einfach schon. </p><br><p>  Ich habe mich jedoch geweigert, Li-Ionen-Hochleistungsbatterien zu verwenden.  Erstens ist es aufgrund der hohen Kosten und zweitens beim chinesischen Online-Shopping leicht, auf eine Fälschung zu stoßen.  Genauer gesagt, nicht "einfach", sondern "immer".  Darüber hinaus erfordert Li-Ion eine spezielle Handhabung und ist nicht sicher. </p><br><p>  Wie wir aus der Tabelle sehen, benötigen wir drei unabhängige Stromquellen: </p><br><ul><li>  Für Arduino Board und Sensoren. </li><li>  Für Servomotor. </li><li>  Für 4 Gleichstrommotoren. </li></ul><br><p>  Wo kann ich so viel bekommen?  In jedem Fall muss das Arduino-Board selbst von einer separaten Quelle mit Strom versorgt werden  Wenn die Spannung beispielsweise beim Einschalten der Motoren „durchhängt“, kann die Platine neu starten oder einfach ausfallen.  Hier verwenden wir die Batterie des Krona 9V-Formfaktors, und der Anschluss, der an das Arduino angeschlossen wird, sollte mit einem „Plus in der Mitte“ versehen sein. </p><br><p>  Für einen Servomotor und 4 Gleichstrommotoren können Sie mit einer Stromquelle arbeiten.  Das einzige Problem ist, dass der Servomotor für eine Spannung von 5 bis 6 V (maximal 7,2 V) und einen Strom von 100 bis 300 mA (Spitze) ausgelegt ist und Gleichstrommotoren 6 bis 8 V (maximal 12 V) und einen Strom von 250 mA benötigen. </p><br><p>  Um das Problem zu lösen, gibt es DC-DC-Wandler, aber ich hatte keine.  Als Ergebnis habe ich meinen "proprietären" Schaltplan angewendet (ohne heruntergefahrene elektronische Schaltkreise, nur umweltfreundliche Spannung und Strom!): Ich habe 8 Stk. Angeschlossen.  1,2-V-Batterien in Reihe geschaltet und an den richtigen Stellen abgegriffen, wie in der Abbildung gezeigt. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f13/3f4/b82/f133f4b82dc88cf2de958804735c73b3.png" alt="Wahrnehmung"></p><br><p>  6 V gingen an den Servomotor und 9,6 an Gleichstrommotoren.  Es ist klar, dass die Batterien 1-5 einer erhöhten Belastung ausgesetzt sind. </p><br><p>  Zur Steuerung von Servo- und Gleichstrommotoren habe ich einen 4-Kanal Motor Drive Shield verwendet, der auf dem L293D-Chip basiert. </p><br><h1 id="sborka">  Montage </h1><br><p>  Die Montage des fertigen Chassis ist ein kleines Problem.  Aber denken Sie nicht, dass Sie ohne Doping alles sofort bekommen.  Bereiten Sie daher Dateien vor. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/058/f4a/d8b/058f4ad8b7a7b76295d5295dcd63afba.jpg" alt="Montage"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/5bb/d2d/32c/5bbd2d32c5caa7a97d8201bddabae96c.jpg" alt="Montage"></p><br><p>  Es ist nicht möglich, mehrere Motoren, einen Servomotor oder einen Stepper, direkt an das Arduino anzuschließen.  Da die Pins (Schlussfolgerungen) des Arduino stromsparend sind.  Um das Problem zu lösen, gibt es ein zusätzliches Antriebssteuermodul - Motor Drive Shield, das auf dem L293D-Chip basiert, einem der am häufigsten für diesen Zweck entwickelten Chips.  Der L293D-Chip ist auch als H-Bridge bekannt. </p><br><p>  Ich habe eine Karte verwendet, die 4 Kanäle für den Anschluss von zwei L293D-Chips und einem Schieberegister bietet.  Bei eBay für 5 US-Dollar gekauft. </p><br><p>  Diese Antriebssteuerungsmodulplatine hat die folgenden Spezifikationen. </p><br><ul><li>  L293D Motor Drive Shield kompatibel mit Arduino Mega 1280 und 2560, UNO, Duemilanove, Diecimila </li><li>  4-Kanal-Steuerung </li><li>  angetriebene Motoren von 4,5 V bis 36 V. </li><li>  zulässiger Laststrom 600mA pro Kanal, Spitzenstrom - 1,2A </li><li>  Überhitzungsschutz </li><li>  2 Schnittstellen mit einem exakten Arduino-Timer (es gibt keinen „Jitter“) zum Anschließen von Servomotoren an 5 V. Wenn die Versorgungsspannung höher sein muss, muss der Stromanschluss wie unten beschrieben wiederhergestellt werden </li><li>  Es können 4 bidirektionale Gleichstrommotormotoren oder 2 Schritt- und 2 Servomotoren gleichzeitig gesteuert werden </li><li>  Zur bidirektionalen Drehzahlauswahl sind jeweils 4 bidirektionale Gleichstrommotoren an einen 8-Bit-Bus angeschlossen </li><li>  Anschluss von bis zu 2 Stufenantrieben (unipolar oder bipolar) mit einer Spule, Doppelspule oder abwechselnden Schritten </li><li>  Anschluss zum Anschließen einer externen Quelle zur getrennten Stromversorgung von Steuerlogik und Motoren </li><li>  RESET Arduino Button </li><li>  Die Adafruit AFMotor-Bibliothek wird für die Verwaltung verwendet. </li></ul><br><p>  Motor Drive Shield muss ein wenig verfeinert werden, damit Sie danach alles anschließen können.  Ich habe die notwendigen Stecker oben gelötet, das ist passiert. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/470/943/060/47094306049d3d9ff9dbe393bd203b1a.jpg" alt="Motrantriebsschild"></p><br><p>  Die Motoren können relativ zur Arduino-Platine an eine zusätzliche Stromversorgung angeschlossen werden.  Ich empfehle nur diese Verbindungsmethode.  Entfernen Sie dazu den Jumper, wie in der Abbildung gezeigt. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a18/6c0/d8b/a186c0d8b3c77c02a7e260411eb1cbd9.jpg" alt="4-Kanal L293D Motorantriebsabschirmung.  Jumper für externe Stromversorgung"></p><br><p>  In diesem Fall wird der Arduino angetrieben und die Motoren werden unabhängig voneinander angetrieben. </p><br><p>  Die LED am Motorschild leuchtet auf, wenn die Motoren mit Strom versorgt werden. Wenn sie nicht leuchtet, funktionieren die Motoren nicht. </p><br><p>  Neues Problem. </p><br><p>  Die Position des Power Jumpers gilt nicht für Servos, sie werden weiterhin von 5V Arduino gespeist.  Da Servomotoren normalerweise viel Strom verbrauchen und die Leistung nicht ausreicht, fällt das gesamte Gerät aus. Im „besten“ Fall fällt nur der Servoantrieb aus - er dreht sich nicht im eingestellten Winkel oder die ganze Zeit vor jeder Umdrehung zuerst um 0 Grad und nur dann in einem bestimmten Winkel (und wenn Sie mithalten können).  Daher empfehle ich, das Servo auch über eine zusätzliche Stromquelle mit Strom zu versorgen.  Dazu müssen Sie das Anschlussdiagramm leicht wiederholen: Das Pluskabel (normalerweise rot) vom Standardstecker abbeißen und direkt an das Plus der Stromquelle anschließen. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d2f/6ea/fa1/d2f6eafa1d5721a6e36a38429aa4ad9e.jpg" alt="Finalisierung zum Annehmen der Leistung des Servomotors"></p><br><p>  Beim Anschließen eines Motor Drive Shield werden keine analogen Pins verwendet.  Die digitalen Pins 2, 13 werden nicht verwendet. </p><br><p>  Die folgenden Stifte werden nur verwendet, wenn die entsprechenden Gleichstrommotoren oder Schrittmotoren angeschlossen und verwendet werden: </p><br><ul><li>  D11: Gleichstrommotor Nr. 1 / Schritt Nr. 1 (Aktivierung und Drehzahlregelung) </li><li>  D3: Gleichstrommotor Nr. 2 / Schritt Nr. 1 (Aktivierung und Drehzahlregelung) </li><li>  D5: Gleichstrommotor Nr. 3 / Schritt Nr. 2 (Aktivierung und Drehzahlregelung) </li><li>  D6: Gleichstrommotor Nr. 4 / Schritt Nr. 2 (Aktivierung und Drehzahlregelung) </li></ul><br><p>  Diese Pins sind belegt, wenn DC / Stepper verwendet werden: D4, D7, D8, D12. </p><br><p>  Die folgenden Pins werden nur belegt, wenn die entsprechenden Servomotoren verwendet werden: </p><br><ul><li>  D9: Servo # 1-Steuerung </li><li>  D10: Servostation Nr. 2 </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/27f/dd4/746/27fdd474619f83391b6c486a576a31fa.png" alt="Verbindungstabelle"></p><br><p>  Um mit Motor Drive Shield zu beginnen, müssen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Adafruit AFMotor-</a> Bibliothek herunterladen und installieren. </p><br><p>  Beispielcode zur Steuerung von Motoren: </p><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;AFMotor.h&gt;</span></span></span><span class="hljs-meta"> //   Adafruit #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Servo.h&gt;</span></span></span><span class="hljs-meta"> //     AF_DCMotor motor(1); //   ,    DC    Motor Shiled , ,  frequency Servo servo; //    servo.attach(10); //     9  10 (    Motor Shiled) motor.setSpeed(speed); //   DC   0 ()  255 ( ) motor.run(RELEASE); // DC   motor.run(FORWARD); // DC   motor.run(BACKWARD); // DC   servo.write(90); //    90 .</span></span></code> </pre> <br><p>  Der Gleichstrommotor begann erst zu drehen, wenn eine Drehzahl von mehr als 100 angezeigt wurde. Wenn er kleiner ist, summt er nur.  Sie müssen die Mindestdrehzahl Ihres Motors experimentell bestimmen. </p><br><p>  Für Motoren, die an M1 und M2 angeschlossen sind, können Sie die Frequenz einstellen: MOTOR12_64KHZ, MOTOR12_8KHZ, MOTOR12_2KHZ, MOTOR12_1KHZ.  Die höchste Drehzahl wird bei 64 kHz erreicht, diese Frequenz ist zu hören, niedrigere Frequenz und Geschwindigkeit bei 1 kHz, verbraucht aber auch weniger Energie.  Die Motoren 3 und 4 laufen immer mit 1 kHz, andere Werte werden ignoriert.  Der Standardwert ist überall 1 kHz. </p><br><p>  Danach muss ein Motortest durchgeführt werden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eine Skizze zum Testen kann hier angefertigt werden</a> .  Ändern Sie zu Beginn der Skizze die Motornummer in einer Zeile (oder in Zeilen) des Typs: </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-function">AF_DCMotor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">…</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br><p>  Eine Skizze für einige Zeit dreht den / die Motor (en) entlang der Bewegung des Roboters vorwärts und dann zurück.  Überprüfen Sie sorgfältig, ob sich der Motor in diese Richtung dreht, und ändern Sie gegebenenfalls die Polarität der Verbindung. </p><br><p>  Wir schließen das Ultraschall-Entfernungsmessgerät HC-SR04 Ultraschallmodul an.  Pinbelegung: </p><br><ul><li>  Vcc </li><li>  Trig (T) </li><li>  Echo (r) </li><li>  GND </li></ul><br><p>  Die Zeit, die der Ultraschall-Entfernungsmesser für Messungen benötigt (empirisch ermittelt): </p><br><ul><li>  maximal 240 ms bei zu großer Entfernung (außerhalb der Reichweite) </li><li>  mindestens 1 ms, wenn der Abstand zu kurz ist </li><li>  Eine Entfernung von 1,5 m wird in ungefähr 10 ms bestimmt </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/de0/071/18e/de007118e81cee628722e426d8e83800.jpg" alt="Ultraschall-Entfernungsmesser HC-SR04 Ultraschallmodul"></p><br><p>  Ein Ultraschall-Entfernungsmesser-Sensor bestimmt aufgrund seiner physikalischen Natur und nicht, weil China in einigen Fällen die Entfernung zu einem Hindernis schlecht bestimmt: </p><br><ul><li>  Wenn das Hindernis eine komplexe Form hat, wird der Ultraschall in verschiedenen Winkeln reflektiert und der Sensor ist falsch. </li><li>  Der Ultraschall wird von Polstermöbeln oder Spielzeug perfekt absorbiert (d. h. nicht reflektiert), und der Sensor glaubt, dass sich nichts davor befindet. </li></ul><br><p>  Mit anderen Worten, für einen Ultraschall-Entfernungsmesser wäre es ideal, wenn alle Hindernisse die Form einer festen Ebene senkrecht zur Richtung der Ultraschallstrahlung hätten. </p><br><p>  Einige Probleme können mit einem Infrarot-Abstandssensor gelöst werden.  Aber es ist auch nicht perfekt: </p><br><ul><li>  kleine maximale Reichweite im Vergleich zu Ultraschall: 0,3-0,8 m gegenüber 4 m </li><li>  großer Mindestabstand zum Ultraschall: 10 cm vs 2 cm </li><li>  Abhängigkeit der Empfindlichkeit des Sensors von der Gesamtbeleuchtung. </li></ul><br><p>  Wenn Sie diese Entfernungsmesser paarweise installieren, würde sich die Effizienz ihrer Arbeit erheblich erhöhen. </p><br><h1 id="podklyuchaem-bluetooth-hc-05">  Verbinden Sie Bluetooth HC-05 </h1><br><p>  Wie Sie dem Datenblatt entnehmen können, sind die Hauptstifte des „nackten“ HC-05: </p><br><ul><li>  TX-Übertragung (Pin 1) </li><li>  Empfangsempfang (Pin 2) </li><li>  3,3 V (Pin 12) Stromversorgung 3,3 V. </li><li>  GND (Pin 13) Masse </li><li>  PIO8 (Pin 31) -Modusanzeige </li><li>  PIO9 (Pin 32) Verbindungsstatus Wenn die Verbindung hergestellt ist, ist der Ausgang hoch </li><li>  PIO11 (Pin 34) zur Aktivierung des AT-Befehlsmodus </li></ul><br><p>  Unser Modul ist mit der Breakout / Base Board verlötet, wo es bereits einen Spannungsteiler gibt, sodass es einen Arbeitsspannungsbereich von 3,3 V bis 6 V hat. </p><br><p>  Wir verbinden unsere Bluetooth-Modulbaugruppe: </p><br><ul><li>  Arduino (TX) - (RX) HC-05 </li><li>  Arduino (RX) - (TX) HC-05 </li><li>  Arduino (+ 5V) - (VCC) Bluetooth </li><li>  Arduino (GND) - (GND) Bluetooth </li><li>  LED, KEY Pins werden nicht verwendet </li></ul><br><p>  Nachdem das Bluetooth HC-05-Modul mit Strom versorgt wurde, sollte die LED blinken, was bedeutet, dass Bluetooth funktioniert. </p><br><p>  Schalten Sie Bluetooth auf dem Mobiltelefon ein, suchen Sie das Gerät mit dem Namen HC-05 und stellen Sie die Verbindung mit dem Kennwort 1234 her. </p><br><p>  Füllen Sie zum Testen eine einfache Skizze in Arduino aus: </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("Test Arduino + Bluetooth. http://localhost"); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { count++; <span class="hljs-type"><span class="hljs-type">Serial</span></span>.print("Count = "); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println(count); delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); }</code> </pre> <br><p>  Installieren Sie auf dem Android-Telefon das Bluetooth-Terminal.  Wir sind mit dem HC-05-Gerät verbunden und beobachten auf dem Telefonbildschirm Kriechlinien mit zunehmendem Zähler. </p><br><p>  Damit das Modul AT-Befehle empfangen kann, müssen Sie es in den entsprechenden Modus versetzen. Dazu müssen Sie den KEY-Ausgang (PIO11) auf logisch 1 setzen. Auf einigen Breakout- / Basisplatinen gibt es anstelle des KEY-Ausgangs einen EN-Ausgang (ENABLE), der möglicherweise vorhanden ist oder nicht an den Stift auf dem Chip selbst gelötet.  Dies gilt nur für HC05-Chips.  Das ist nur, dass mein EN-Anschluss nirgendwo gelötet ist.  Daher kann es mit einem separaten Draht an den Anschlussschlüssel (PIO11) des Chips gelötet werden.  Um den HC05 während des Betriebs in den AT-Befehlsmodus zu versetzen, schließen Sie den KEY-Chip-Ausgang (PIO11) einige Sekunden lang mit dem Vcc-Ausgangsstrom kurz.  Für HC06 wird kein KEY-Pin benötigt. </p><br><h1 id="programmnoe-obespechenie">  Software </h1><br><p>  Hinweis  Stellen Sie vor dem Herunterladen des Programms auf Arduino jedes Mal sicher, dass das Bluetooth-Modul nicht mit dem Arduino verbunden ist.  Dies führt zu Problemen beim Füllen von Skizzen.  Trennen Sie einfach das Bluetooth-Modul oder die Kabel, die die Pins des Arduino- und RX, TX-Moduls verbinden, von der Stromversorgung. </p><br><p>  Ändern Sie zu Beginn der Skizze die Motornummern in den Zeilen des Typs: </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-function">AF_DCMotor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">…</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br><p>  <a href="">Skizze für den Automatikmodus mit Hindernisvermeidung hier herunterladen</a> . </p><br><p>  Wenn Sie die Zeichenfolge ersetzen </p><br><pre> <code class="hljs lua"><span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> <span class="hljs-built_in"><span class="hljs-built_in">debug</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><p>  auf </p><br><pre> <code class="hljs lua"><span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> <span class="hljs-built_in"><span class="hljs-built_in">debug</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre> <br><p>  Dadurch wird der Debug-Modus aktiviert. </p><br><p>  Im Debugging-Modus fährt oder fährt der RoboCar4W nicht wirklich.  Aktivieren Sie stattdessen den Monitor für die serielle Schnittstelle, und dort sehen Sie, wie er virtuell „fährt“.  Anstelle einer echten Vorwärtsfahrt wird die Zeichenfolge "Vorwärts" auf den Monitor der seriellen Schnittstelle geschrieben, anstatt mit einer Linkskurve, "Zurück L (eft)" usw. umzukehren.  Der Ultraschall-Abstandssensor tut auch nichts, stattdessen werden die Abstände zu Hindernissen programmgesteuert und zufällig generiert. </p><br><p>  Dieser Debugging-Modus ist praktisch, wenn Sie den Bewegungsalgorithmus ändern und anstatt eine Schreibmaschine im Raum zu fangen, einfach alles im Leerlauf überprüfen. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bluetooth-Skizze zur manuellen Steuerung hier herunterladen</a> .  Die Skizze hat keinen Debug-Modus, da dort alles transparent ist.  Sie drücken den Knopf - der Roboter geht. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Programm für Adnroid Bluetooth RC Car</a> . </p><br><p>  Nun, das ist es!  Gute Reise! </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/32b/8dc/98f/32b8dc98ff44592014df2bf2f736f9d5.jpg" alt="Gute Reise!"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de426097/">https://habr.com/ru/post/de426097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de426087/index.html">Signieren einer PDF-Datei in JS und Einfügen einer Signatur in C # mit Crypto PRO</a></li>
<li><a href="../de426089/index.html">Amerikanisches Startup entwickelte Brille-AdBlock</a></li>
<li><a href="../de426091/index.html">8 Cloud-Protokollanalysatoren zur Bewertung der Arbeitsumgebung</a></li>
<li><a href="../de426093/index.html">Monetarisierung von Benutzerdaten im Vergleich zu In-App-Werbung: Vor- und Nachteile</a></li>
<li><a href="../de426095/index.html">Offenes Webinar „Wie man nicht in Python schreibt“</a></li>
<li><a href="../de426099/index.html">Typegramm Nachrichten</a></li>
<li><a href="../de426101/index.html">Datenintegrität in der Microservice-Architektur - wie Sie dies ohne verteilte Transaktionen und enge Konnektivität sicherstellen können</a></li>
<li><a href="../de426103/index.html">Webinar „Brauchen Sie Kubernetes?“ 15. Oktober um 19:00 Uhr</a></li>
<li><a href="../de426105/index.html">Mein Fang in einer Woche</a></li>
<li><a href="../de426111/index.html">Google wird weiterhin einen zensierten Suchdienst in China starten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>