<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêΩ üë®üèª‚Äçüîß üë®üèº‚Äçüî¨ .NET, TensorFlow et les moulins √† vent de Kaggle - le voyage commence üë©üèº‚Äçüöí ü§∞ üßîüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il s'agit d'une s√©rie d'articles sur mon voyage en cours dans la for√™t sombre des comp√©titions Kaggle en tant que d√©veloppeur .NET. 

 Je me concentre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>.NET, TensorFlow et les moulins √† vent de Kaggle - le voyage commence</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437174/"><img src="https://habrastorage.org/webt/tc/fj/ml/tcfjml8-rk618mttrw9qhvfan_u.png" align="left">  Il s'agit d'une s√©rie d'articles sur mon voyage en cours dans la for√™t sombre des comp√©titions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" title="Kaggle">Kaggle en</a> tant que d√©veloppeur .NET. <br><br>  Je me concentrerai sur les r√©seaux de neurones (presque) purs dans cet article et les suivants.  Cela signifie que la plupart des parties ennuyeuses de la pr√©paration de l'ensemble de donn√©es, comme le remplissage des valeurs manquantes, la s√©lection des fonctionnalit√©s, l'analyse des valeurs aberrantes, etc.  sera intentionnellement ignor√©. <br><br>  La pile technologique sera l'API C # + TensorFlow <i>tf.keras</i> .  √Ä ce jour, il faudra √©galement Windows.  Les mod√®les plus grands dans les futurs articles peuvent avoir besoin d'un GPU appropri√© pour que leur temps de formation reste sain. <br><a name="habracut"></a><br><h2>  Pr√©disons les prix de l'immobilier! </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les prix des maisons</a> sont une grande comp√©tition pour les novices.  Son jeu de donn√©es est petit, il n'y a pas de r√®gles sp√©ciales, le classement public a de nombreux participants et vous pouvez soumettre jusqu'√† 4 entr√©es par jour. <br><br>  Inscrivez-vous sur Kaggle, si vous ne l'avez pas encore fait, rejoignez ce concours et t√©l√©chargez les donn√©es.  L'objectif est de pr√©dire le prix de vente (colonne SalePrice) pour les entr√©es dans <i>test.csv</i> .  L'archive contient <i>train.csv</i> , qui compte environ 1500 entr√©es avec un prix de vente connu pour s'entra√Æner.  Nous allons commencer par charger cet ensemble de donn√©es et l'explorer un peu avant d'entrer dans les r√©seaux de neurones. <br><br><h2>  Analyser les donn√©es d'entra√Ænement </h2><br>  <i>Ai-je dit que nous allons sauter la pr√©paration de l'ensemble de donn√©es?</i>  <i>J'ai menti!</i>  <i>Vous devez jeter un oeil au moins une fois.</i> <br><br>  √Ä ma grande surprise, je n'ai pas trouv√© de moyen facile de charger un fichier .csv dans la biblioth√®que de classes standard .NET, j'ai donc install√© un package NuGet, appel√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CsvHelper</a> .  Pour simplifier la manipulation des donn√©es, j'ai √©galement obtenu mon nouveau package d'extension LINQ pr√©f√©r√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MoreLinq</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Chargement de donn√©es .csv dans DataTable</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> csvFilePath</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataTable(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CsvDataReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CsvReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamReader(csvFilePath)))) { result.Load(reader); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">ML.NET</b> <div class="spoiler_text">  L'utilisation de <i>DataTable</i> pour la formation √† la manipulation des donn√©es est, en fait, une mauvaise id√©e. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ML.NET</a> est cens√© avoir le chargement .csv et de nombreuses op√©rations de peparation et d'exploration de donn√©es.  Cependant, il n'√©tait pas encore pr√™t √† cet usage particulier, lorsque je viens de participer au concours des prix des logements. <br></div></div><br><br>  Les donn√©es ressemblent √† ceci (seulement quelques lignes et colonnes): <br><br><table><tbody><tr><td>  Id </td><td>  MSSubClass </td><td>  Msoning </td><td>  LotFrontage </td><td>  Lotarea </td></tr><tr><td>  1 </td><td>  60 </td><td>  RL </td><td>  65 </td><td>  8450 </td></tr><tr><td>  2 </td><td>  20 </td><td>  RL </td><td>  80 </td><td>  9600 </td></tr><tr><td>  3 </td><td>  60 </td><td>  RL </td><td>  68 </td><td>  11250 </td></tr><tr><td>  4 </td><td>  70 </td><td>  RL </td><td>  60 </td><td>  9550 </td></tr></tbody></table><br><br>  Apr√®s le chargement des donn√©es, nous devons supprimer la colonne <i>Id</i> , car elle n'est en fait pas li√©e au prix des maisons: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> trainData = LoadData(<span class="hljs-string"><span class="hljs-string">"train.csv"</span></span>); trainData.Columns.Remove(<span class="hljs-string"><span class="hljs-string">"Id"</span></span>);</code> </pre> <br><h3>  Analyse des types de donn√©es de colonne </h3><br>  DataTable n'inf√®re pas automatiquement les types de donn√©es des colonnes et suppose qu'il s'agit de toutes les cha√Ænes.  La prochaine √©tape consiste donc √† d√©terminer ce que nous avons r√©ellement.  Pour chaque colonne, j'ai calcul√© les statistiques suivantes: nombre de valeurs distinctes, combien d'entre elles sont des nombres entiers et combien d'entre elles sont des nombres √† virgule flottante (un code source avec toutes les m√©thodes d'assistance sera li√© √† la fin de l'article): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> values = rows.Select(row =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)row[column]); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> floats = values.Percentage(v =&gt; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> _)); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> ints = values.Percentage(v =&gt; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> _)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distincts = values.Distinct().Count();</code> </pre> <br><h3>  Colonnes num√©riques </h3><br>  Il s'av√®re que la plupart des colonnes sont en fait des entiers, mais comme les r√©seaux de neurones fonctionnent principalement sur des nombres flottants, nous les convertirons de toute fa√ßon en doubles. <br><br><h3>  Colonnes cat√©gorielles </h3><br>  D'autres colonnes d√©crivent les cat√©gories auxquelles appartenait la propri√©t√© en vente.  Aucun d'entre eux n'a trop de valeurs diff√©rentes, ce qui est bien.  Pour les utiliser comme entr√©e pour notre futur r√©seau de neurones, ils doivent √©galement √™tre convertis pour <i>doubler</i> . <br><br>  Initialement, je leur ai simplement attribu√© des num√©ros de 0 √† distinctValueCount - 1, mais cela n'a pas beaucoup de sens, car il n'y a en fait aucune progression de "Facade: Blue" √† "Facade: Green" en "Facade: White".  Donc, au d√©but, j'ai chang√© cela en ce qu'on appelle un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">codage √† chaud</a> , o√π chaque valeur unique obtient une colonne d'entr√©e distincte.  Par exemple, ¬´Facade: Blue¬ª devient [1,0,0] et ¬´Facade: White¬ª devient [0,0,1]. <br><br><h3>  Les r√©unir tous </h3><br><div class="spoiler">  <b class="spoiler_title">Grande sortie d'exploration de donn√©es</b> <div class="spoiler_text">  CentralAir: 2 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Rue: 2 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Utilitaires: 2 valeurs, entiers: 0,00%, flottants: 0,00% <br>  All√©e: 3 valeurs, pouces: 0,00%, flottants: 0,00% <br>  BsmtHalfBath: 3 valeurs, entiers: 100,00%, flottants: 100,00% <br>  HalfBath: 3 valeurs, entiers: 100,00%, flottants: 100,00% <br>  LandSlope: 3 valeurs, entiers: 0,00%, flottants: 0,00% <br>  PavedDrive: 3 valeurs, pouces: 0,00%, flottants: 0,00% <br>  BsmtFullBath: 4 valeurs, entiers: 100,00%, flottants: 100,00% <br>  ExterQual: 4 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Chemin√©es: 4 valeurs, pouces: 100,00%, flotteurs: 100,00% <br>  FullBath: 4 valeurs, entiers: 100,00%, flottants: 100,00% <br>  GarageFinish: 4 valeurs, pouces: 0,00%, flottants: 0,00% <br>  KitchenAbvGr: 4 valeurs, pouces: 100,00%, flottants: 100,00% <br>  KitchenQual: 4 valeurs, pouces: 0,00%, flottants: 0,00% <br>  LandContour: 4 valeurs, entiers: 0,00%, flottants: 0,00% <br>  LotShape: 4 valeurs, entiers: 0,00%, flottants: 0,00% <br>  PoolQC: 4 valeurs, entiers: 0,00%, flottants: 0,00% <br>  BldgType: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  BsmtCond: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  BsmtExposure: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  BsmtQual: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  ExterCond: 5 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Cl√¥ture: 5 valeurs, pouces: 0,00%, flottants: 0,00% <br>  GarageCars: 5 valeurs, entiers: 100,00%, flottants: 100,00% <br>  Chauffage QC: 5 valeurs, pouces: 0,00%, flottants: 0,00% <br>  LotConfig: 5 valeurs, pouces: 0,00%, flottants: 0,00% <br>  MasVnrType: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  MiscFeature: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  MSZoning: 5 valeurs, entiers: 0,00%, flottants: 0,00% <br>  YrSold: 5 valeurs, entiers: 100,00%, flottants: 100,00% <br>  √âlectrique: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  FireplaceQu: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Fondation: 6 valeurs, entiers: 0,00%, flottants: 0,00% <br>  GarageCond: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  GarageQual: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Chauffage: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  RoofStyle: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Condition: 6 valeurs, pouces: 0,00%, flottants: 0,00% <br>  BsmtFinType1: 7 valeurs, entiers: 0,00%, flottants: 0,00% <br>  BsmtFinType2: 7 valeurs, entiers: 0,00%, flottants: 0,00% <br>  Fonctionnel: 7 valeurs, pouces: 0,00%, flottants: 0,00% <br>  GarageType: 7 valeurs, pouces: 0,00%, flottants: 0,00% <br>  BedroomAbvGr: 8 valeurs, pouces: 100,00%, flottants: 100,00% <br>  Condition2: 8 valeurs, pouces: 0,00%, flottants: 0,00% <br>  HouseStyle: 8 valeurs, pouces: 0,00%, flottants: 0,00% <br>  PoolArea: 8 valeurs, entiers: 100,00%, flottants: 100,00% <br>  RoofMatl: 8 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Condition 1: 9 valeurs, pouces: 0,00%, flottants: 0,00% <br>  GlobalCond: 9 valeurs, pouces: 100,00%, flottants: 100,00% <br>  SaleType: 9 valeurs, pouces: 0,00%, flottants: 0,00% <br>  Qualit√© globale: 10 valeurs, pouces: 100,00%, flottants: 100,00% <br>  MoSold: 12 valeurs, pouces: 100,00%, flottants: 100,00% <br>  TotRmsAbvGrd: 12 valeurs, entiers: 100,00%, flottants: 100,00% <br>  Ext√©rieur 1er: 15 valeurs, pouces: 0,00%, flottants: 0,00% <br>  MSSubClass: 15 valeurs, entiers: 100,00%, flottants: 100,00% <br>  Ext√©rieur2e: 16 valeurs, pouces: 0,00%, flottants: 0,00% <br>  3SsnPorch: 20 valeurs, entiers: 100,00%, flottants: 100,00% <br>  MiscVal: 21 valeurs, entiers: 100,00%, flottants: 100,00% <br>  LowQualFinSF: 24 valeurs, entiers: 100,00%, flottants: 100,00% <br>  Quartier: 25 valeurs, entr√©es: 0,00%, flottants: 0,00% <br>  YearRemodAdd: 61 valeurs, entiers: 100,00%, flottants: 100,00% <br>  ScreenPorch: 76 valeurs, pouces: 100,00%, flottants: 100,00% <br>  GarageYrBlt: 98 valeurs, pouces: 94,45%, flottants: 94,45% <br>  LotFrontage: 111 valeurs, pouces: 82,26%, flottants: 82,26% <br>  Ann√©e de construction: 112 valeurs, pouces: 100,00%, flottants: 100,00% <br>  EnclosedPorch: 120 valeurs, entiers: 100,00%, flottants: 100,00% <br>  BsmtFinSF2: 144 valeurs, entiers: 100,00%, flottants: 100,00% <br>  OpenPorchSF: 202 valeurs, entiers: 100,00%, flottants: 100,00% <br>  WoodDeckSF: 274 valeurs, entiers: 100,00%, flottants: 100,00% <br>  MasVnrArea: 328 valeurs, entr√©es: 99,45%, flottants: 99,45% <br>  2ndFlrSF: 417 valeurs, entiers: 100,00%, flottants: 100,00% <br>  GarageArea: 441 valeurs, entiers: 100,00%, flottants: 100,00% <br>  BsmtFinSF1: 637 valeurs, entiers: 100,00%, flottants: 100,00% <br>  SalePrix: 663 valeurs, pouces: 100,00%, flottants: 100,00% <br>  TotalBsmtSF: 721 valeurs, entiers: 100,00%, flottants: 100,00% <br>  1stFlrSF: 753 valeurs, entiers: 100,00%, flottants: 100,00% <br>  BsmtUnfSF: 780 valeurs, entiers: 100,00%, flottants: 100,00% <br>  GrLivArea: 861 valeurs, entiers: 100,00%, flottants: 100,00% <br>  LotArea: 1073 valeurs, entiers: 100,00%, flottants: 100,00% <br><br>  De nombreuses colonnes de valeurs: <br>  Ext√©rieur1er: AsbShng, AsphShn, BrkComm, BrkFace, CBlock, CemntBd, HdBoard, ImStucc, MetalSd, Plywood, Stone, Stucco, VinylSd, Wd Sdng, WdShing <br>  Exterior2nd: AsbShng, AsphShn, Brk Cmn, BrkFace, CBlock, CmentBd, HdBoard, ImStucc, MetalSd, Other, Plywood, Stone, Stucco, VinylSd, Wd Sdng, Wd Shng <br>  Quartier: Blmngtn, Blueste, BrDale, BrkSide, ClearCr, CollgCr, Crawfor, Edwards, Gilbert, IDOTRR, MeadowV, Mitchel, NAmes, NoRidge, NPkVill, NridgHt, NWAmes, OldTown, Sawyer, SawyerW, Somerst, Stone, Stoner Veenker <br><br>  flotteurs non analysables <br>  GarageYrBlt: NA <br>  LotFrontage: NA <br>  MasVnrArea: NA <br><br>  gammes de flotteurs: <br>  BsmtHalfBath: 0 ... 2 <br>  HalfBath: 0 ... 2 <br>  BsmtFullBath: 0 ... 3 <br>  Chemin√©es: 0 ... 3 <br>  FullBath: 0 ... 3 <br>  KitchenAbvGr: 0 ... 3 <br>  GarageCars: 0 ... 4 <br>  Ann√©e: 2006 ... 2010 <br>  BedroomAbvGr: 0 ... 8 <br>  PoolArea: 0 ... 738 <br>  GlobalCond: 1 ... 9 <br>  Qualit√© globale: 1 ... 10 <br>  MoSold: 1 ... 12 <br>  TotRmsAbvGrd: 2 ... 14 <br>  MSSubClass: 20 ... 190 <br>  3SsnPorch: 0 ... 508 <br>  MiscVal: 0 ... 15500 <br>  LowQualFinSF: 0 ... 572 <br>  Ann√©eRemodAjouter: 1950 ... 2010 <br>  ScreenPorch: 0 ... 480 <br>  GarageYrBlt: 1900 ... 2010 <br>  LotFrontage: 21 ... 313 <br>  Ann√©e de construction: 1872 ... 2010 <br>  EnclosedPorch: 0 ... 552 <br>  BsmtFinSF2: 0 ... 1474 <br>  OpenPorchSF: 0 ... 547 <br>  WoodDeckSF: 0 ... 857 <br>  MasVnrArea: 0 ... 1600 <br>  2ndFlrSF: 0 ... 2065 <br>  GarageArea: 0 ... 1418 <br>  BsmtFinSF1: 0 ... 5644 <br>  Prix: 34,900 ... 755,000 <br>  TotalBsmtSF: 0 ... 6110 <br>  1stFlrSF: 334 ... 4692 <br>  BsmtUnfSF: 0 ... 2336 <br>  GrLivArea: 334 ... 5642 <br>  LotArea: 1300 ... 215245 <br></div></div><br><br>  Dans cet esprit, j'ai construit le <i>ValueNormalizer</i> suivant, qui prend quelques informations sur les valeurs √† l'int√©rieur de la colonne, et renvoie une fonction, qui transforme une valeur (une <i>cha√Æne</i> ) en un vecteur d' <i>entit√©</i> num√©rique pour le r√©seau de neurones ( <i>double []</i> ): <br><br><div class="spoiler">  <b class="spoiler_title">ValueNormalizer</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[]&gt; ValueNormalizer( <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> floats, IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; values) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (floats &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> max = values.AsDouble().Max().Value; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.TryParse(s, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> v) ? v / max : <span class="hljs-number"><span class="hljs-number">-1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] domain = values.Distinct().OrderBy(v =&gt; v).ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[domain.Length+<span class="hljs-number"><span class="hljs-number">1</span></span>] .Set(Array.IndexOf(domain, s)+<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre> <br></div></div><br>  Nous avons maintenant les donn√©es converties dans un format adapt√© √† un r√©seau de neurones.  Il est temps d'en construire un. <br><br><h2>  Construisez un r√©seau de neurones </h2><br>  <i>√Ä partir d'aujourd'hui, vous devrez utiliser une machine Windows pour cela.</i> <br><br>  Si vous avez d√©j√† install√© Python et TensorFlow 1.1x, tout ce dont vous avez besoin est <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gradient"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.1.10-tech-preview3"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  dans votre fichier .csproj moderne.  Sinon, reportez-vous au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">manuel Gradient</a> pour effectuer la configuration initiale. <br><br>  Une fois le package op√©rationnel, nous pouvons cr√©er notre premier r√©seau profond peu profond. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow.keras; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow.keras.layers; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow.train; ... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sequential(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Layer[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dense(units: <span class="hljs-number"><span class="hljs-number">16</span></span>, activation: tf.nn.relu_fn), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dropout(rate: <span class="hljs-number"><span class="hljs-number">0.1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dense(units: <span class="hljs-number"><span class="hljs-number">10</span></span>, activation: tf.nn.relu_fn), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dense(units: <span class="hljs-number"><span class="hljs-number">1</span></span>, activation: tf.nn.relu_fn), }); model.compile(optimizer: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdamOptimizer(), loss: <span class="hljs-string"><span class="hljs-string">"mean_squared_error"</span></span>);</code> </pre> <br>  Cela cr√©era un r√©seau neuronal non form√© avec 3 couches de neurones et une couche de d√©crochage, ce qui aidera √† √©viter le surapprentissage. <br><br><div class="spoiler">  <b class="spoiler_title">tf.nn.relu_fn</b> <div class="spoiler_text">  <i>tf.nn.relu_fn</i> est la fonction d'activation de nos neurones.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ReLU</a> est connu pour bien fonctionner dans les r√©seaux profonds, car il r√©sout le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">probl√®me de gradient qui dispara√Æt</a> : les d√©riv√©es des fonctions d'activation non lin√©aires d'origine avaient tendance √† devenir tr√®s petites lorsque l'erreur se propageait depuis la couche de sortie dans les r√©seaux profonds.  Cela signifiait que les couches plus proches de l'entr√©e ne s'ajusteraient que tr√®s l√©g√®rement, ce qui ralentissait consid√©rablement la formation des r√©seaux profonds. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Abandon</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le d√©crochage</a> est une couche de fonctions sp√©ciales dans les r√©seaux de neurones, qui ne contient en fait pas de neurones en tant que tels.  Au lieu de cela, il fonctionne en prenant chaque entr√©e individuelle et la remplace de mani√®re al√©atoire par 0 sur la sortie automatique (sinon elle transmet simplement la valeur d'origine).  Ce faisant, cela permet d'√©viter le sur- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ajustement</a> √† des entit√©s moins pertinentes dans un petit ensemble de donn√©es.  Par exemple, si nous ne supprimions pas la colonne <i>Id</i> , le r√©seau pourrait potentiellement m√©moriser le mappage &lt;Id&gt; -&gt; &lt;SalePrice&gt; exactement, ce qui nous donnerait une pr√©cision de 100% sur l'ensemble de formation, mais des chiffres compl√®tement ind√©pendants sur toutes les autres donn√©es. <br><br>  Pourquoi avons-nous besoin d'abandon?  Nos donn√©es d'entra√Ænement n'ont que ~ 1500 exemples, et ce minuscule r√©seau de neurones que nous avons construit a&gt; 1800 poids accordables.  S'il s'agissait d'un simple polyn√¥me, il pourrait correspondre √† la fonction de prix que nous essayons d'approcher exactement.  Mais alors, il aurait des valeurs √©normes sur toutes les entr√©es en dehors de l'ensemble de formation d'origine. <br></div></div><br><h2>  Nourrir les donn√©es </h2><br>  TensorFlow attend ses donn√©es soit dans des tableaux NumPy, soit dans des tenseurs existants.  Je convertis DataRows en tableaux NumPy: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> numpy; ... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> predict = <span class="hljs-string"><span class="hljs-string">"SalePrice"</span></span>; <span class="hljs-function"><span class="hljs-function">ndarray </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetInputs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;DataRow&gt; rowSeq</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array(rowSeq.Select(row =&gt; np.array( columnTypes .Where(c =&gt; c.column.ColumnName != predict) .SelectMany(column =&gt; column.normalizer( row.Table.Columns.Contains(column.column.ColumnName) ? (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)row[column.column.ColumnName] : <span class="hljs-string"><span class="hljs-string">"-1"</span></span>)) .ToArray())) .ToArray() ); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> predictColumn = columnTypes.Single(c =&gt; c.column.ColumnName == predict); ndarray trainOutputs = np.array(predictColumn.trainValues .AsDouble() .Select(v =&gt; v ?? <span class="hljs-number"><span class="hljs-number">-1</span></span>) .ToArray()); ndarray trainInputs = GetInputs(trainRows);</code> </pre> <br>  Dans le code ci-dessus, nous convertissons chaque <i>DataRow</i> en <i>ndarray</i> en prenant chaque cellule qu'il <i>contient</i> et en appliquant le <i>ValueNormalizer</i> correspondant √† sa colonne.  Ensuite, nous mettons toutes les lignes dans un autre <i>ndarray</i> , obtenant un tableau de tableaux. <br><br>  Aucune transformation de ce type n'est n√©cessaire pour les sorties, o√π nous convertissons simplement les valeurs du train en un autre <i>ndarray</i> . <br><br><h2>  Il est temps de descendre le gradient </h2><br>  Avec cette configuration, tout ce que nous devons faire pour former notre r√©seau est d'appeler la fonction d' <i>ajustement</i> du mod√®le: <br><br><pre> <code class="cs hljs">model.fit(trainInputs, trainOutputs, epochs: <span class="hljs-number"><span class="hljs-number">2000</span></span>, validation_split: <span class="hljs-number"><span class="hljs-number">0.075</span></span>, verbose: <span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre> <br>  Cet appel annulera en fait les 7,5% restants de l'ensemble de formation pour validation, puis r√©p√©tera les 2000 fois suivantes: <br><br><ol><li>  diviser le reste du <i>train Entr√©es</i> en lots </li><li>  alimenter ces lots un par un dans le r√©seau neuronal </li><li>  erreur de calcul en utilisant la fonction de perte que nous avons d√©finie ci-dessus </li><li>  r√©tropropagation de l'erreur √† travers les gradients des connexions neuronales individuelles, en ajustant les poids </li></ol><br>  Pendant la formation, il affichera l'erreur du r√©seau sur les donn√©es qu'il a mises de c√¥t√© pour validation en tant que <b>val_loss</b> et l'erreur sur les donn√©es de formation elles-m√™mes comme une simple <b>perte</b> .  G√©n√©ralement, si <b>val_loss</b> devient beaucoup plus important que la <b>perte</b> , cela signifie que le r√©seau a commenc√© √† sur-ajuster.  J'aborderai cela plus en d√©tail dans les articles suivants. <br><br>  Si vous avez tout fait correctement, une <u>racine carr√©e</u> de l'une de vos pertes devrait √™tre de l'ordre de 20000. <br><br><img src="https://habrastorage.org/webt/fu/rn/vg/furnvg6dbs8ocijm91_3xcqdxhm.png"><br><br><h2>  Soumission </h2><br>  Je ne parlerai pas beaucoup de la g√©n√©ration du fichier √† soumettre ici.  Le code pour calculer les sorties est simple: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> SubmissionInputFile = <span class="hljs-string"><span class="hljs-string">"test.csv"</span></span>; DataTable submissionData = LoadData(SubmissionInputFile); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> submissionRows = submissionData.Rows.Cast&lt;DataRow&gt;(); ndarray submissionInputs = GetInputs(submissionRows); ndarray sumissionOutputs = model.predict(submissionInputs);</code> </pre> <br>  qui utilise principalement des fonctions, qui ont √©t√© d√©finies pr√©c√©demment. <br><br>  Ensuite, vous devez les √©crire dans un fichier .csv, qui est simplement une liste de paires Id, preded_value. <br><br>  Lorsque vous soumettez votre r√©sultat, vous devriez obtenir un score de l'ordre de 0,17, qui se situerait quelque part dans le dernier quart du tableau du classement public.  Mais bon, si c'√©tait aussi simple qu'un r√©seau √† 3 couches avec 27 neurones, ces scientifiques de donn√©es emb√™tants n'obtiendraient pas 300k $ + / an de compensations totales des grandes entreprises am√©ricaines <br><br><h2>  Envelopper </h2><br>  Le code source complet de cette entr√©e (avec tous les assistants et certaines des parties comment√©es de mes explorations et exp√©riences pr√©c√©dentes) est d'environ 200 lignes sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PasteBin</a> . <br><br>  Dans le prochain article, vous verrez mes manigances essayer d'atteindre le top 50% de ce classement public.  Ce sera une aventure de compagnon amateur, un combat avec The Windmill of Overfitting avec le seul outil dont dispose le vagabond - un mod√®le plus grand (par exemple, NN profond, rappelez-vous, pas d'ing√©nierie manuelle des fonctionnalit√©s!).  Ce sera moins un tutoriel de codage, et plus une qu√™te de pens√©e avec des math√©matiques vraiment croches et une conclusion √©trange.  Restez √† l'√©coute! <br><br><h2>  Les liens </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kaggle</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Concours des prix des logements sur Kaggle</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tutoriel de r√©gression TensorFlow</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Page d'accueil de TensorFlow</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">R√©f√©rence de l'API TensorFlow</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©grad√© (liaison TensorFlow)</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437174/">https://habr.com/ru/post/fr437174/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437160/index.html">Devops</a></li>
<li><a href="../fr437164/index.html"># 10yearschallenge pour les programmeurs</a></li>
<li><a href="../fr437166/index.html">Vol de combat sur Meteor-e</a></li>
<li><a href="../fr437170/index.html">Facebook sugg√®re d'utiliser des lasers spatiaux pour les communications mondiales</a></li>
<li><a href="../fr437172/index.html">IBM MQ et JMeter: premier contact</a></li>
<li><a href="../fr437176/index.html">Application pour iOS et Android sur Kotlin + Flutter UI</a></li>
<li><a href="../fr437180/index.html">JVM de Sib√©rie dure: grande interview sur Excelsior JET</a></li>
<li><a href="../fr437182/index.html">Interception d'appels syst√®me dans le module du noyau Linux</a></li>
<li><a href="../fr437184/index.html">Nikolay Durov a termin√© √† 90% le d√©veloppement de la plate-forme Telegram Open Network</a></li>
<li><a href="../fr437186/index.html">Monolith √† microservices. Point de vue infrastructure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>