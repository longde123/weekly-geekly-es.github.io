<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òëÔ∏è üé≤ üéÆ Rastreo distribuido: hicimos todo mal üëºüèª üé≤ üë®üèø‚Äçü§ù‚Äçüë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : La autora de este material es Cindy Sridharan, una ingeniera de imgix que participa en el desarrollo de API y, en particular, prueba de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rastreo distribuido: hicimos todo mal</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/460365/">  <i><b>Nota</b></i>  <i><b>perev.</b></i>  <i>: La autora de este material es Cindy Sridharan, una ingeniera de imgix que participa en el desarrollo de API y, en particular, prueba de microservicios.</i>  <i>En este art√≠culo, comparte su visi√≥n detallada de los problemas reales en el campo del rastreo distribuido, donde, en su opini√≥n, faltan herramientas verdaderamente efectivas para resolver problemas apremiantes.</i> <br><br><img src="https://habrastorage.org/webt/zu/va/og/zuvaogffo6d3gqi1mmzq5ts3zoc.png"><br>  <i>[La ilustraci√≥n est√° tomada de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otro material</a> sobre el rastreo distribuido.]</i> <br><br>  Se cree que el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rastreo distribuido es</a> dif√≠cil de implementar, y el retorno <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">es dudoso en el mejor de los casos</a> .  El "problema" de la traza se explica por muchas razones, que a menudo se refieren a la complejidad de configurar cada componente del sistema para transmitir los encabezados correspondientes junto con cada solicitud.  Aunque este problema ocurre, no se puede llamar insuperable en absoluto.  Por cierto, no explica por qu√© a los desarrolladores realmente no les gusta el rastreo (incluso si ya funciona). <a name="habracut"></a><br><br>  La principal dificultad con el rastreo distribuido es no recopilar datos, no estandarizar los formatos para distribuir y presentar los resultados, y no determinar cu√°ndo, d√≥nde y c√≥mo muestrear.  No estoy tratando de presentar estos "problemas de digestibilidad" como <i>triviales</i> ; de hecho, existen desaf√≠os t√©cnicos y pol√≠ticos bastante significativos (si realmente estamos analizando los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">est√°ndares y protocolos de</a> c√≥digo abierto) que deben superarse para que estos problemas puedan considerarse resuelto <br><br>  Sin embargo, si imagina que todos estos problemas se han resuelto, es probable que nada cambie significativamente en t√©rminos de <i>la experiencia del usuario final</i> .  El seguimiento puede no ser pr√°ctico en los escenarios de depuraci√≥n m√°s comunes, incluso despu√©s de que se haya implementado. <br><br><h2>  Un rastro tan diferente </h2><br>  El rastreo distribuido incluye varios componentes dispares: <br><br><ul><li>  equipar aplicaciones y middleware con controles; </li><li>  Transmisi√≥n de contexto distribuido </li><li>  colecci√≥n de trazas; </li><li>  almacenamiento de trazas; </li><li>  su extracci√≥n y visualizaci√≥n. </li></ul><br>  Mucho se habla sobre el rastreo distribuido se reduce a considerarlo como una especie de operaci√≥n unaria, cuyo √∫nico prop√≥sito es ayudar en el diagn√≥stico completo del sistema.  Esto se debe en gran medida a la forma en que se form√≥ el concepto de rastreo distribuido.  En <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una publicaci√≥n de blog</a> realizada cuando se abrieron las fuentes de Zipkin, se mencion√≥ que <i>√©l [Zipkin] acelera Twitter</i> .  Las primeras ofertas comerciales para el rastreo tambi√©n se promocionaron como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">herramientas APM</a> . <br><br>  <i><b>Nota</b></i>  <i><b>perev.</b></i>  <i>: Para que el texto adicional se entienda mejor, definimos dos t√©rminos b√°sicos de acuerdo con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n del proyecto OpenTracing</a> :</i> <br><br><ul><li>  <i><b>Span</b> : el elemento b√°sico del rastreo distribuido.</i>  <i>Es una descripci√≥n de un determinado flujo de trabajo (por ejemplo, una consulta de base de datos) con un nombre, horas de inicio y finalizaci√≥n, etiquetas, registros y contexto.</i> </li><li>  <i>Los tramos generalmente contienen enlaces a otros tramos, lo que le permite combinar muchos tramos en <b>Trace</b> , una visualizaci√≥n de la vida de una solicitud a medida que se mueve a trav√©s de un sistema distribuido.</i> </li></ul><br>  Trace'y contiene datos incre√≠blemente valiosos que pueden ayudar en tareas tales como: pruebas en producci√≥n, realizaci√≥n de pruebas de recuperaci√≥n ante desastres, pruebas con la introducci√≥n de errores, etc.  De hecho, algunas empresas ya utilizan el rastreo para tales fines.  Para comenzar, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la transferencia de contexto universal</a> tiene otros usos adem√°s de simplemente transferir tramos al sistema de almacenamiento: <br><br><ul><li>  Por ejemplo, Uber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usa</a> resultados de rastreo para distinguir entre el tr√°fico de prueba y el tr√°fico de producci√≥n. </li><li>  Facebook <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">utiliza</a> datos de rastreo para analizar la ruta cr√≠tica y para cambiar el tr√°fico durante las pruebas regulares de recuperaci√≥n ante desastres. </li><li>  La red social tambi√©n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">utiliza</a> port√°tiles Jupyter, que permiten a los desarrolladores ejecutar consultas arbitrarias sobre los resultados del rastreo. </li><li>  Los adherentes a la inyecci√≥n de falla impulsada por linaje ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LDFI)</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usan</a> trazas distribuidas para pruebas de error. </li></ul><br>  Ninguna de las opciones anteriores se relaciona completamente con el escenario de <i>depuraci√≥n</i> , durante el cual el ingeniero intenta resolver el problema observando el rastro. <br><br>  Cuando se trata del escenario de depuraci√≥n, el diagrama de vista de <i>rastreo</i> sigue siendo la interfaz principal (aunque algunos tambi√©n lo llaman el <i>"diagrama de Gantt"</i> o el <i>"diagrama en cascada"</i> ).  Por <i>traceview,</i> me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">refiero a</a> todos los tramos y metadatos asociados que juntos forman el rastreo.  Cada sistema de rastreo de c√≥digo abierto, as√≠ como cada soluci√≥n de rastreo comercial, ofrece una <i>interfaz</i> de usuario basada en <i>traceview</i> para visualizar, detallar y filtrar datos de rastreo. <br><br>  El problema con todos los sistemas de rastreo con los que he estado familiarizado en este momento es que la <i>visualizaci√≥n</i> final <i>(vista de rastreo)</i> refleja casi por completo las caracter√≠sticas del proceso de generaci√≥n de rastreo.  Incluso cuando se ofrecen visualizaciones alternativas: mapas de intensidad (mapa de calor), topolog√≠as de servicio, histogramas de latencia, al final todav√≠a se reducen a la <i>vista</i> de <i>rastreo</i> . <br><br>  En el pasado, me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">quej√© de</a> que la mayor√≠a de las "innovaciones" en la trazabilidad con respecto a UI / UX parecen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estar</a> limitadas a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">incluir</a> metadatos adicionales en el rastreo, incrustar informaci√≥n con <i>alta cardinalidad</i> en ellos o proporcionar la capacidad de profundizar en tramos espec√≠ficos o ejecutar consultas <i>inter e intra-trace</i> .  En este caso, <i>traceview</i> sigue siendo el principal medio de visualizaci√≥n.  Mientras persista este estado de cosas, el rastreo distribuido ocupar√° (en el mejor de los casos) el 4to lugar como herramienta de depuraci√≥n, seguido de m√©tricas, registros y seguimientos de pila, y en el peor de los casos resultar√° una p√©rdida de dinero y tiempo. <br><br><h2>  Problema con traceview </h2><br>  El prop√≥sito de <i>traceview</i> es proporcionar una imagen completa del movimiento de una solicitud individual en todos los componentes de un sistema distribuido con el que se relaciona.  Algunos sistemas de rastreo m√°s avanzados le permiten profundizar en tramos individuales y ver el desglose de tiempo <i>dentro de un</i> solo proceso (cuando los tramos tienen l√≠mites funcionales). <br><br>  La premisa b√°sica de la arquitectura de microservicios es la idea de que la estructura organizacional crece con las necesidades de la empresa.  Los defensores de los microservicios argumentan que la distribuci√≥n de varias tareas comerciales a trav√©s de servicios separados permite a los equipos de desarrollo peque√±os y aut√≥nomos controlar todo el ciclo de vida de dichos servicios, lo que les permite crear, probar e implementar estos servicios de forma independiente.  Sin embargo, la desventaja de esta distribuci√≥n es la p√©rdida de informaci√≥n sobre c√≥mo cada servicio interact√∫a con los dem√°s.  En tales circunstancias, el rastreo distribuido afirma ser una herramienta indispensable para <i>depurar</i> interacciones complejas entre servicios. <br><br>  Si tiene un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sistema distribuido</a> realmente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">incre√≠blemente complejo</a> , nadie podr√° tener en cuenta su imagen <i>completa</i> .  De hecho, desarrollar una herramienta basada en el supuesto de que generalmente es posible es un poco antipatr√≥n (enfoque ineficiente e improductivo).  Idealmente, la depuraci√≥n requiere una herramienta para ayudar a <i>reducir su b√∫squeda</i> para que los ingenieros puedan centrarse en un subconjunto de las dimensiones (servicios / usuarios / hosts, etc.) que son relevantes para el escenario en cuesti√≥n.  Al determinar la causa de la falla, los ingenieros no est√°n obligados a comprender lo que sucedi√≥ en <i>todos los servicios a la vez</i> , ya que tal requisito contradir√≠a la idea misma de una arquitectura de microservicio. <br><br>  Sin embargo, traceview es <i>solo</i> eso.  S√≠, algunos sistemas de rastreo ofrecen vistas de rastreo comprimidas cuando el n√∫mero de tramos en el rastreo es tan grande que no se pueden mostrar en una sola visualizaci√≥n.  Sin embargo, debido a la gran cantidad de informaci√≥n contenida incluso en una visualizaci√≥n tan truncada, los ingenieros a√∫n se <i>ven obligados a</i> "filtrarla", reduciendo manualmente la selecci√≥n a un conjunto de problemas de fuentes de servicio.  Por desgracia, en este campo las m√°quinas son mucho m√°s r√°pidas que los humanos, menos propensas a errores y sus resultados son m√°s repetibles. <br><br>  Otra raz√≥n por la que creo que el m√©todo de seguimiento es incorrecto es porque no es adecuado para la depuraci√≥n hipot√©tica.  En esencia, la depuraci√≥n es un proceso <i>iterativo</i> que comienza con una hip√≥tesis, seguido de la verificaci√≥n de varias observaciones y hechos recibidos del sistema utilizando diferentes vectores, conclusiones / generalizaciones y una evaluaci√≥n adicional de la verdad de la hip√≥tesis. <br><br>  La capacidad <i>de</i> probar hip√≥tesis de forma <i>r√°pida y econ√≥mica</i> y mejorar el modelo mental en consecuencia es la <i>piedra angular de la</i> depuraci√≥n.  Cualquier herramienta de depuraci√≥n debe ser <i>interactiva</i> y reducir el espacio de b√∫squeda o, en el caso de una traza falsa, permitir al usuario regresar y enfocarse en otra √°rea del sistema.  Una herramienta ideal lo har√° de forma <i>proactiva</i> , atrayendo inmediatamente la atenci√≥n del usuario hacia √°reas potencialmente problem√°ticas. <br><br>  Por desgracia, <i>traceview</i> no se puede llamar una herramienta de interfaz interactiva.  Lo mejor que puede esperar al usarlo es detectar una determinada fuente de mayores retrasos y ver todo tipo de etiquetas y registros asociados con √©l.  Esto no ayuda al ingeniero a identificar <i>patrones</i> en el tr√°fico, como los detalles de la distribuci√≥n de demoras, ni a detectar correlaciones entre diferentes mediciones.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El an√°lisis de trazas gen√©rico</a> puede solucionar algunos de estos problemas.  De hecho, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hay ejemplos de</a> an√°lisis exitosos que utilizan el aprendizaje autom√°tico para identificar tramos anormales e identificar un subconjunto de etiquetas que pueden estar asociadas con un comportamiento anormal.  Sin embargo, todav√≠a no he encontrado visualizaciones convincentes de hallazgos realizados mediante aprendizaje autom√°tico o an√°lisis de datos aplicados a tramos que ser√≠an significativamente diferentes de traceview o DAG (gr√°fico ac√≠clico direccional). <br><br><h3>  Los tramos tienen un nivel demasiado bajo. </h3><br>  El problema fundamental con traceview es que los <i>tramos</i> son primitivas de nivel demasiado bajo para el an√°lisis de latencia y el an√°lisis de causa ra√≠z.  Es como analizar comandos de procesador individuales en un intento de eliminar una excepci√≥n, sabiendo que hay herramientas de nivel mucho m√°s alto, como la traza inversa, con las que es mucho m√°s conveniente trabajar. <br><br>  Adem√°s, me tomar√© la libertad de afirmar lo siguiente: idealmente, no necesitamos una <i>imagen completa de</i> lo que sucedi√≥ durante el ciclo de vida de la solicitud, que representan las herramientas modernas para el rastreo.  En cambio, se requiere alguna forma de abstracci√≥n de nivel superior, que contenga informaci√≥n sobre lo que <i>sali√≥ mal</i> (similar a la traza inversa), junto con alg√∫n contexto.  En lugar de observar todo el rastro, prefiero ver <i>parte de</i> √©l donde sucede algo interesante o inusual.  Actualmente, la b√∫squeda se lleva a cabo manualmente: el ingeniero recibe un rastro y analiza de forma independiente los tramos en busca de algo interesante.  El enfoque cuando las personas miran los tramos en trazas separadas con la esperanza de detectar actividad sospechosa no se escala en absoluto (especialmente cuando tienen que comprender todos los metadatos codificados en diferentes tramos, como la identificaci√≥n del intervalo, el nombre del m√©todo RPC, la duraci√≥n del intervalo 'a, registros, etiquetas, etc.). <br><br><h2>  Alternativas de seguimiento </h2><br>  Los resultados de rastreo son m√°s √∫tiles cuando se pueden visualizar de tal manera que se obtenga una idea no trivial de lo que est√° sucediendo en las partes interconectadas del sistema.  Hasta que este sea el caso, el proceso de depuraci√≥n permanece en gran medida <i>inerte</i> y depende de la capacidad del usuario para notar las correlaciones correctas, verificar las partes correctas del sistema o ensamblar piezas del mosaico, a diferencia de la <i>herramienta</i> que ayuda al usuario a formular estas hip√≥tesis. <br><br>  No soy un dise√±ador visual o un especialista en UX, pero en la siguiente secci√≥n quiero compartir algunas ideas sobre c√≥mo se ver√≠an esas visualizaciones. <br><br><h3>  Centrarse en servicios espec√≠ficos. </h3><br>  En un entorno en el que la industria se est√° consolidando en torno a las ideas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SLO (objetivos de nivel de servicio) y SLI (indicadores de nivel de servicio)</a> , parece razonable que los equipos individuales primero deben monitorear la relevancia de sus servicios para estos objetivos.  Se deduce que <i>la</i> visualizaci√≥n <i>orientada al servicio</i> es la m√°s adecuada para dichos equipos. <br><br>  Las trazas, especialmente sin muestreo, son un dep√≥sito de informaci√≥n sobre cada componente de un sistema distribuido.  Esta informaci√≥n se puede enviar a un controlador complicado que entregar√° hallazgos orientados al <i>servicio</i> a los usuarios, que pueden detectarse con anticipaci√≥n, incluso antes de que el usuario mire los rastros: <br><br><ol><li>  Retrase los diagramas de distribuci√≥n solo para solicitudes muy distinguidas <i>(solicitudes at√≠picas)</i> ; </li><li>  Retrasar los diagramas de distribuci√≥n para casos en los que no se alcanzan los objetivos de servicio de SLO; </li><li>  Las etiquetas m√°s "comunes", "interesantes" y "extra√±as" en las consultas, que se <i>repiten con</i> mayor frecuencia; </li><li>  Desglose de demoras para casos en que las <i>dependencias de</i> servicio no alcanzan los objetivos de SLO establecidos; </li><li>  Desglose de retrasos por diversos servicios posteriores. </li></ol><br>  Las m√©tricas integradas simplemente no pueden responder algunas de estas preguntas, lo que obliga a los usuarios a estudiar cuidadosamente los tramos.  Como resultado, tenemos un mecanismo extremadamente hostil para el usuario. <br><br>  A este respecto, surge la pregunta: ¬øqu√© pasa con las complejas interacciones entre los diversos servicios controlados por diferentes equipos?  ¬øNo se considera que <i>traceview es</i> la herramienta m√°s adecuada para cubrir tal situaci√≥n? <br><br>  Los desarrolladores m√≥viles, propietarios de servicios sin estado, propietarios de servicios administrados con estado (como bases de datos) y propietarios de plataformas pueden estar interesados ‚Äã‚Äãen otra <i>vista de un</i> sistema distribuido;  <i>traceview</i> es una soluci√≥n demasiado universal para estas necesidades fundamentalmente diferentes.  Incluso en una arquitectura de microservicios muy compleja, los propietarios de servicios no necesitan un conocimiento profundo de m√°s de dos o tres servicios ascendentes y descendentes.  En esencia, en la mayor√≠a de los escenarios, los usuarios solo necesitan responder preguntas sobre un <i>conjunto limitado de servicios</i> . <br><br>  Es como mirar un peque√±o subconjunto de servicios a trav√©s de una lupa en aras de un estudio meticuloso.  Esto permitir√° al usuario hacer preguntas m√°s urgentes con respecto a la compleja interacci√≥n entre estos servicios y sus dependencias inmediatas.  Esto es similar a la traza en el mundo de los servicios, donde el ingeniero sabe <i>lo que</i> est√° mal y tambi√©n tiene una idea de lo que est√° sucediendo en los servicios circundantes para comprender <i>por qu√©</i> . <br><br>  El enfoque que estoy promoviendo es exactamente el opuesto al enfoque de arriba hacia abajo basado en la vista de rastreo, cuando el an√°lisis comienza con el rastreo completo y luego desciende gradualmente a tramos individuales.  Por el contrario, el enfoque ascendente comienza con un an√°lisis de un √°rea peque√±a cercana a la causa potencial del incidente, y luego el espacio de b√∫squeda se ampl√≠a si es necesario (con la posible participaci√≥n de otros equipos para analizar una gama m√°s amplia de servicios).  El segundo enfoque es m√°s adecuado para probar r√°pidamente las hip√≥tesis iniciales.  Despu√©s de obtener resultados espec√≠ficos, ser√° posible pasar a un an√°lisis m√°s centrado y detallado. <br><br><h3>  Edificio de topolog√≠a </h3><br>  Las vistas asociadas con un servicio en particular pueden ser incre√≠blemente √∫tiles si el usuario sabe <i>qu√©</i> servicio o grupo de servicios es responsable de aumentar las demoras o es una fuente de errores.  Sin embargo, en un sistema complejo, la identificaci√≥n de un intruso puede no ser una tarea trivial durante una falla, especialmente si no se han recibido mensajes de error de los servicios. <br><br>  La creaci√≥n de una topolog√≠a de servicio puede ser muy √∫til para determinar qu√© servicio muestra un aumento en la tasa de error o un aumento en la latencia, lo que lleva a un deterioro notable en el rendimiento del servicio.  Hablando sobre la construcci√≥n de una topolog√≠a, no me refiero a <i>un mapa de servicios</i> que muestre todos los servicios disponibles en el sistema y conocidos por sus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mapas de arquitectura en forma de estrella de la muerte</a> .  Tal representaci√≥n no es mejor que una vista de rastreo basada en un gr√°fico ac√≠clico dirigido.  En cambio, me gustar√≠a ver una <i>topolog√≠a de servicio generada din√°micamente</i> basada en ciertos atributos, como la tasa de error, el tiempo de respuesta o cualquier par√°metro especificado por el usuario que ayude a aclarar la situaci√≥n con servicios sospechosos espec√≠ficos. <br><br>  Veamos un ejemplo.  Imagine un sitio hipot√©tico de noticias.  El servicio de <i>portada se</i> comunica con Redis, con un servicio de recomendaci√≥n, con un servicio de publicidad y servicio de video.  El servicio de video toma videos de S3 y los metadatos de DynamoDB.  El servicio de recomendaci√≥n recibe metadatos de DynamoDB, descarga datos de Redis y MySQL, escribe mensajes en Kafka.  El servicio de publicidad recibe datos de MySQL y escribe mensajes a Kafka. <br><br>  La siguiente es una representaci√≥n esquem√°tica de esta topolog√≠a (muchos programas de enrutamiento comerciales crean la topolog√≠a).  Puede ser √∫til si necesita comprender las dependencias de los servicios.  Sin embargo, durante la <i>depuraci√≥n</i> , cuando un determinado servicio (por ejemplo, un servicio de video) demuestra un mayor tiempo de respuesta, dicha topolog√≠a no es muy √∫til. <br><br><img src="https://habrastorage.org/webt/qr/85/y9/qr85y98gth6ybvwt5yuditlnack.png"><br>  <i>Esquema hipot√©tico de servicios del sitio de noticias</i> <br><br>  El siguiente diagrama ser√≠a mejor.  En √©l se representa un servicio problem√°tico <i>(video)</i> justo en el centro.  El usuario lo nota de inmediato.  A partir de esta visualizaci√≥n, queda claro que el servicio de video funciona de manera anormal debido al mayor tiempo de respuesta de S3, que afecta la velocidad de descarga de parte de la p√°gina principal. <br><br><img src="https://habrastorage.org/webt/v2/w5/za/v2w5zaf_s1_r8mzo0j6r2dopyyk.png"><br>  <i>Topolog√≠a din√°mica que muestra solo servicios "interesantes"</i> <br><br>  Los esquemas topol√≥gicos generados din√°micamente pueden ser m√°s eficientes que los mapas de servicios est√°ticos, especialmente en infraestructuras flexibles y autoescalables.  La capacidad de comparar y contrastar topolog√≠as de servicio permite al usuario hacer preguntas m√°s relevantes.  Las preguntas m√°s precisas sobre el sistema tienen m√°s probabilidades de conducir a una mejor comprensi√≥n de c√≥mo funciona el sistema. <br><br><h3>  Pantalla comparativa </h3><br>  Otra visualizaci√≥n √∫til ser√≠a una pantalla comparativa.  Las trazas actualmente no son adecuadas para comparaciones de lado a lado, por lo que generalmente se comparan los <i>tramos</i> .  Y la idea principal de este art√≠culo es precisamente que los tramos son de nivel demasiado bajo para extraer la informaci√≥n m√°s valiosa de los resultados de seguimiento. <br><br>  La comparaci√≥n de dos trace'ov no exige visualizaciones fundamentalmente nuevas.  De hecho, algo como un histograma que representa la misma informaci√≥n que traceview es suficiente.  Sorprendentemente, incluso este m√©todo simple puede traer mucho m√°s fruto que un simple estudio de dos trazas por separado.  A√∫n m√°s potente ser√≠a la capacidad de <i>visualizar la</i> comparaci√≥n de trazas <i>en el agregado</i> .  Ser√≠a extremadamente √∫til ver c√≥mo un cambio de configuraci√≥n de la base de datos recientemente implementado con la inclusi√≥n de GC (recolecci√≥n de basura) afecta el tiempo de respuesta de un servicio posterior en unas pocas horas.  Si lo que estoy describiendo aqu√≠ parece un an√°lisis A / B del impacto de los cambios <i>en la</i> infraestructura <i>en una variedad de servicios</i> utilizando resultados de seguimiento, entonces no est√° muy lejos de la verdad. <br><br><h2>  Conclusi√≥n </h2><br>  No cuestiono la utilidad de la traza misma.  Sinceramente, creo que no hay otra forma de recopilar datos tan ricos, casuales y contextuales como los que se encuentran en la traza.    ,          .   ,        traceview-,          ,     ,   trace'.  ,          ,         . <br><br>   ,     ,  .        , <b> </b>  ,        .  ,           production   ,   ,      ,       ,     . <br><br>    ,   ,     ,    , ,      .  ,         ,      ,     trace'  span'. <br><br>           (  UI). ,         ,        .        ,           .           .      . <br><br><h2>  PD del traductor </h2><br>  Lea tambi√©n en nuestro blog: <br><br><ul><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> kubectl-debug    pod' Kubernetes</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">:   ,     Kubernetes</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  Kubernetes (   )</a> ¬ª. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460365/">https://habr.com/ru/post/460365/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460353/index.html">Red neuronal en el cristal. No requiere energ√≠a, reconoce n√∫meros</a></li>
<li><a href="../460355/index.html">Salvar al ahogamiento es nuestro negocio: c√≥mo lidiar con la desmotivaci√≥n del equipo</a></li>
<li><a href="../460359/index.html">Curso para j√≥venes dise√±adores de juegos 2: Equilibrio de progresi√≥n y din√°mica sin matem√°ticas</a></li>
<li><a href="../460361/index.html">Grandes preguntas frecuentes sobre ciberseguridad de los sistemas de informaci√≥n m√©dica</a></li>
<li><a href="../460363/index.html">7 factores faltantes en el enfoque 12 Factor App</a></li>
<li><a href="../460367/index.html">Ingenier√≠a del Caos: el arte de la destrucci√≥n intencional. Parte 1</a></li>
<li><a href="../460373/index.html">Under the Hood Turbo Pages: Arquitectura de la p√°gina web Tecnolog√≠a de descarga r√°pida</a></li>
<li><a href="../460375/index.html">Libro "Aprendizaje autom√°tico para empresas y marketing"</a></li>
<li><a href="../460377/index.html">Uso de Liquibase para administrar la estructura de la base de datos en una aplicaci√≥n Spring Boot. Parte 1</a></li>
<li><a href="../460381/index.html">¬øQu√© es la asertividad y por qu√© es necesaria?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>