<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÜüèª üíò üèº Quasar, Sobaken e Vermin: revelando detalhes da campanha de espionagem cibern√©tica em andamento üçö üë©üèª‚Äç‚öñÔ∏è ü§°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Usando ferramentas de acesso remoto, Quasar, Sobaken e Vermin, os cibercriminosos monitoram as ag√™ncias governamentais ucranianas e roubam dados de se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quasar, Sobaken e Vermin: revelando detalhes da campanha de espionagem cibern√©tica em andamento</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/418165/">  Usando ferramentas de acesso remoto, Quasar, Sobaken e Vermin, os cibercriminosos monitoram as ag√™ncias governamentais ucranianas e roubam dados de seus sistemas.  Este cibergrupo foi mencionado pela primeira vez em um relat√≥rio em janeiro de 2018, atraiu a aten√ß√£o da ESET em meados de 2017 e hoje continua a desenvolver seu software. <br><br>  Neste relat√≥rio, revelamos os detalhes da campanha atual, fornecemos informa√ß√µes sobre malware e descrevemos os m√©todos que os invasores usam para espalhar, direcionar e evitar a detec√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/um/d7/91/umd791-uddub2r4pyn_fl32ttkm.jpeg"></div><a name="habracut"></a><br><h2>  Perfil dos atacantes </h2><br>  Esse grupo parece n√£o ter conhecimento t√©cnico excepcional ou acesso a vulnerabilidades de dia zero.  No entanto, ela aplicou com sucesso a engenharia social para espalhar o trabalho malvari e encoberto por um longo tempo. <br><br>  Conseguimos acompanhar seu trabalho at√© outubro de 2015, mas √© poss√≠vel que o grupo tenha iniciado suas atividades muito antes. <br><br>  Os invasores usam tr√™s modifica√ß√µes do .NET malvari: Quasar RAT (Ferramenta de administra√ß√£o remota), Sobaken (um derivado do RAT do Quasar) e RAT Vermin personalizado.  As ferramentas foram usadas simultaneamente nos mesmos destinos, elas compartilham parcialmente a infraestrutura e se conectam aos mesmos servidores C&amp;C.  Uma poss√≠vel explica√ß√£o para o uso de tr√™s modifica√ß√µes paralelas √© o fato de que elas foram desenvolvidas independentemente uma da outra. <br><br><h2>  As v√≠timas </h2><br>  Software malicioso √© usado em ataques a ag√™ncias governamentais ucranianas.  De acordo com a telemetria da ESET, foram registradas centenas de v√≠timas em v√°rias organiza√ß√µes e centenas de arquivos execut√°veis ‚Äã‚Äãrelacionados a esta campanha. <br><br><h2>  Linha do tempo </h2><br>  A Figura 1 mostra os principais eventos da campanha em ordem cronol√≥gica. <br><br><img src="https://habrastorage.org/webt/8w/9p/4_/8w9p4_dn72fqyzbhonm9xqqvrbq.jpeg"><br>  <i>Figura 1. Linha do tempo da campanha</i> <br><br><h2>  Distribui√ß√£o </h2><br>  De acordo com nossos dados de telemetria, os invasores usam o email como o principal canal de distribui√ß√£o de tr√™s RATs.  Eles usam a engenharia social para convencer as v√≠timas a baixar e executar o malware. <br><br>  Na maioria dos casos, os nomes dos arquivos est√£o escritos em ucraniano e est√£o relacionados ao trabalho das v√≠timas.  Aqui est√£o exemplos desses arquivos: <br><br><ul><li>  "INSTRU√á√ïES para a organiza√ß√£o da prote√ß√£o do servi√ßo militar da Ucr√¢nia e do membro da fam√≠lia" ("Ordem sobre a garantia da seguran√ßa do pessoal militar do ex√©rcito ucraniano e membros de suas fam√≠lias") </li><li>  ‚ÄúEu punirei o novo rascunho, a designa√ß√£o da revis√£o do Viluchennya‚Äù (‚ÄúO novo rascunho da ordem de verifica√ß√£o da retirada‚Äù) </li><li>  "Colocar o OVK Zb—ñlshennya limitu" ("Divis√£o de compras Don HVAC. Aumentar o limite de cr√©dito") </li></ul><br>  Al√©m das t√©cnicas b√°sicas de engenharia social (chamando a aten√ß√£o para o investimento), os atacantes usam tr√™s m√©todos t√©cnicos.  √â prov√°vel que isso melhore ainda mais o desempenho da campanha. <br><br>  <b>M√©todo 1</b> : os aplicativos de email usam o caractere de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">substitui√ß√£o da direita para a esquerda</a> Unicode, que altera a dire√ß√£o na qual os caracteres s√£o lidos, para ocultar a extens√£o verdadeira.  Na verdade, esses s√£o arquivos execut√°veis ‚Äã‚Äãusando os √≠cones Word, Excel, PowerPoint ou Acrobat Reader, para n√£o causar suspeitas. <br><br>  Um exemplo de nome de arquivo: como mostrado na Figura 2, ‚ÄúMovendo lenha s√≥lida (lenha) para queima desprotegida _ &lt;&gt; xcod scr‚Äù (‚ÄúTransportando lenha para aquecimento‚Äù) parecer√° um arquivo .DOCX para usu√°rios desatentos. <br><br><img src="https://habrastorage.org/webt/ec/y9/nm/ecy9nmj2acupweqnnlwm4pzlha4.png"><br>  <i>Figura 2. Um arquivo execut√°vel disfar√ßado como um documento do Word</i> <br><br>  <b>M√©todo 2</b> : Aplicativos de email mascarados como arquivos de extra√ß√£o autom√°tica RAR. <br><br>  Exemplo: um e-mail com o aplicativo ‚ÄúPunishment_MOU_Dodatka_do_Instrucii_440_ost.rar‚Äù (‚ÄúOrdem do Minist√©rio da Defesa, Anexos √† Instru√ß√£o n¬∫ 440‚Äù), conforme mostrado na Figura 3. Dentro do arquivo RAR, h√° um arquivo execut√°vel chamado ‚ÄúPunishment_MOU_Dodatki_do_Instruciiii_440_ost_rar‚Äù. <br><br>  Presumivelmente, as v√≠timas executam esse arquivo, aguardando a descompacta√ß√£o do conte√∫do do arquivo de extra√ß√£o autom√°tica, mas, assim, involuntariamente, iniciam um arquivo execut√°vel malicioso. <br><br>  <b>M√©todo # 3</b> : documento do Word + explora√ß√£o CVE-2017-0199.  Essa vulnerabilidade √© aplicada quando a v√≠tima abre um documento do Word especialmente criado.  O processo do Word envia uma solicita√ß√£o HTTP para um arquivo HTA que cont√©m um script malicioso localizado em um servidor remoto.  Em seguida, o script malicioso √© iniciado pelo <code>mshta.exe</code> .  As primeiras informa√ß√µes p√∫blicas sobre esta vulnerabilidade <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">apareceram em abril de 2017</a> e a Microsoft a fechou, lan√ßando uma atualiza√ß√£o de seguran√ßa para todas as vers√µes do Windows e do Office. <br><br>  De acordo com a telemetria da ESET, esses invasores come√ßaram a usar esse m√©todo em maio de 2017.  Os invasores usaram hxxp: // chip-tuning lg [] ua / para entregar os arquivos HTA e a carga final. <br><br><img src="https://habrastorage.org/webt/fl/3d/ie/fl3diek7ndvyatqlnf0skmg3zs8.png"><br>  <i>Figura 3. Arquivo disfar√ßado como um arquivo RAR de extra√ß√£o autom√°tica.</i>  <i>Os dados da vers√£o e os direitos autorais sugerem que isso √© falso</i> <br><br><h2>  Instala√ß√£o e Persist√™ncia </h2><br>  O procedimento de instala√ß√£o √© o mesmo para as tr√™s modifica√ß√µes dos malvari usados ‚Äã‚Äãpor este grupo.  O conta-gotas despeja os arquivos de carga √∫til (Vermin, Quasar ou Sobaken) na <code>%APPDATA%</code> , em uma subpasta com o nome da empresa leg√≠tima (geralmente Adobe, Intel ou Microsoft).  Em seguida, como mostra a Figura 4, ele cria uma tarefa no planejador para executar o componente a cada 10 minutos para garantir persist√™ncia.  Algumas vers√µes tamb√©m usam o m√©todo de usar a funcionalidade de atalho do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Painel de Controle</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Windows</a> para tornar suas pastas inacess√≠veis no Windows Explorer.  Essas pastas n√£o abrir√£o quando clicadas no Windows Explorer; em vez disso, a p√°gina "Todas as tarefas" ser√° aberta. <br><br><img src="https://habrastorage.org/webt/r_/f8/ag/r_f8agiayao-ya99saiesftwzvq.png"><br>  <i>Figura 4. Uma tarefa que inicia um componente malicioso a cada 10 minutos</i> <br><br>  Exemplos: <br><br> <code>C:\Users\Admin\AppData\Roaming\Microsoft\Proof\Settings.{ED7BA470-8E54-465E-825C- 99712043E01C}\TransactionBroker32.exe <br> C:\Users\Admin\AppData\Roaming\Adobe\SLStore\Setting.{ED7BA470-8E54-465E-825C- 99712043E01C}\AdobeSLService.exe</code> <br> <br><h2>  Segmenta√ß√£o </h2><br>  Os invasores usam muitos truques para que o malware funcione apenas nas m√°quinas de destino.  Eles s√£o especialmente cuidadosos para evitar sistemas de an√°lise automatizados e caixas de areia. <br><br>  <b>M√©todo # 1</b> : verificando o layout do teclado no Windows <br>  Malvar verifica se o layout do teclado russo ou ucraniano est√° instalado.  Caso contr√°rio, seu trabalho para imediatamente. <br><br>  <b>M√©todo 2</b> : Verificar endere√ßo IP <br>  Malvar obt√©m o endere√ßo IP de um computador infectado atrav√©s de uma solicita√ß√£o a um servi√ßo leg√≠timo <br>  Ipinfo.io/json.  O trabalho ser√° conclu√≠do se o endere√ßo IP n√£o for encontrado na Ucr√¢nia ou na R√∫ssia ou se estiver registrado em um dos v√°rios provedores de servi√ßos em nuvem ou desenvolvedores de software antiv√≠rus selecionados.  O c√≥digo que executa a verifica√ß√£o √© mostrado nos resultados da desmontagem nas Figuras 5 e 6. <br><br><img src="https://habrastorage.org/webt/ca/um/ji/caumjikfr3j6dxoyr2vt3ujlin4.jpeg"><br>  <i>Figura 5. C√≥digo verificando a localiza√ß√£o geogr√°fica do endere√ßo IP da m√°quina infectada</i> <br><br><img src="https://habrastorage.org/webt/x4/qv/6l/x4qv6loy2wy9nsy39mbdxauswsi.jpeg"><br>  <i>Figura 6. C√≥digo que corresponde ao endere√ßo IP com uma lista de provedores de servi√ßos em nuvem e fornecedores de antiv√≠rus</i> <br><br>  <b>M√©todo 3</b> : testando a emula√ß√£o de rede <br>  Os sistemas de an√°lise automatizada geralmente usam ferramentas como o Fakenet-NG, onde a comunica√ß√£o DNS / HTTP √© bem-sucedida e produz qualquer resultado.  Os autores da Malvari tentam identificar esses sistemas atrav√©s da gera√ß√£o de um nome / URL aleat√≥rio do site e verificam se n√£o h√° conex√£o com esse URL (na Figura 7), como seria em um sistema real. <br><br><img src="https://habrastorage.org/webt/2i/gd/ht/2igdhtw18kvmfdggtpjlmrzhjio.png"><br>  <i>Figura 7. C√≥digo gerando uma URL aleat√≥ria e iniciando o download</i> <br><br>  <b>M√©todo 4</b> : Verificando um nome de usu√°rio espec√≠fico <br>  O malware n√£o inicia em uma conta com um nome de usu√°rio t√≠pico dos sistemas automatizados de an√°lise de malware, conforme mostrado na Figura 8. <br><br><img src="https://habrastorage.org/webt/ta/7f/xu/ta7fxutvbu2rh5oouavpnlyrwio.jpeg"><br>  <i>Figura 8. Reconcilia√ß√£o do nome de usu√°rio atual com uma lista de sistemas de an√°lise de malware conhecidos</i> <br><br><h2>  Aplica√ß√£o de esteganografia </h2><br>  Desde meados de 2017, os invasores usam esteganografia, ocultando componentes maliciosos em imagens nos sites de hospedagem gratuita saveshot.net e ibb.co. <br><br>  A esteganografia √© uma ci√™ncia que permite ocultar dados "√† vista completa", dentro de outras informa√ß√µes n√£o classificadas.  No nosso caso, o arquivo EXE malicioso foi criptografado e oculto em um arquivo JPEG, como na Figura 9. Malvar baixa e decodifica o JPEG, extrai dados ocultos, descriptografa o arquivo EXE desses dados e o inicia. <br><br><img src="https://habrastorage.org/webt/__/pv/dq/__pvdqrrbokglop1ehh9alsv2ng.png"><br>  <i>Figura 9. Exemplo de imagem JPEG usada para ocultar o componente malicioso entregue (redimensionado e removido)</i> <br><br>  O processo de descriptografia √© bastante complicado e pode ser descrito da seguinte maneira: <br><br>  1. Baixando um arquivo JPEG de um URL codificado em um bin√°rio. <br><br>  2. A for√ßa bruta de uma senha de oito d√≠gitos, calculando seu hash e reconciliando-o com um hash codificado no arquivo bin√°rio baixado.  Esta etapa usa a CPU intensivamente; leva mais de 10 minutos para ser conclu√≠da em um computador comum.  Provavelmente, essa √© outra medida para combater os sistemas automatizados de an√°lise de malware. <br><br>  3. Processando o arquivo JPEG e extraindo os dados ocultos nele, como pode ser visto no c√≥digo desmontado nas Figuras 10 e 11. O algoritmo usado pelo malware √© muito semelhante ao usado no JSteg, um dos algoritmos de esteganografia mais antigos e mais simples para arquivos JPEG.  Ele oculta os dados em LSB (o bit menos significativo) dos coeficientes discretos de transforma√ß√£o de cosseno de um arquivo JPEG.  Esses dados ocultos geralmente n√£o afetam a imagem vis√≠vel a olho nu, mas algoritmos especializados podem detectar facilmente sua presen√ßa.  No entanto, esse algoritmo de esteganografia √© muito f√°cil de implementar, o que provavelmente foi o motivo de sua escolha pelos autores dos malvari. <br><br>  4. Extra√ß√£o e descompacta√ß√£o de dados usando o GZip. <br><br>  5. Descriptografia dos dados descompactados no AES com a senha obtida na etapa No. 2. <br><br>  6. Decodifica√ß√£o de dados decodificados de base64. <br><br>  7. Gravando o arquivo EXE no disco e execu√ß√£o. <br><br>  Como resultado, os autores desta amea√ßa abandonaram a id√©ia de usar esteganografia e come√ßaram a usar hxxp: // chip-tuning lg [] ua para transferir arquivos execut√°veis ‚Äã‚Äãn√£o criptografados. <br><br><img src="https://habrastorage.org/webt/5s/ch/zx/5schzxd_4v0gsywse4wwbanoxj4.png"><br>  <i>Figura 10. C√≥digo esteganogr√°fico dentro de um decodificador JPEG</i> <br><br><img src="https://habrastorage.org/webt/1v/ll/w2/1vllw2olpntevix4tebamq3iuye.jpeg"><br>  <i>Figura 11. C√≥digo esteganogr√°fico dentro de um decodificador JPEG</i> <br><br><h2>  Malvari Mods </h2><br>  Esses atacantes usam tr√™s modifica√ß√µes dos malvari em seus ataques.  Abaixo, apresentamos uma breve vis√£o geral de cada um e nos concentramos na descri√ß√£o dos recursos caracter√≠sticos. <br><br><h3>  Quasar </h3><br>  Quasar √© um RAT de c√≥digo aberto dispon√≠vel no GitHub.  Vimos v√°rias campanhas nas quais esse grupo cibern√©tico usava arquivos bin√°rios Quasar RAT.  A primeira campanha conhecida durou de outubro de 2015 a abril de 2016.  O pr√≥ximo foi realizado em fevereiro de 2017.  Os artefatos de compila√ß√£o mostram o caminho para o PDB <code>n:\projects\Viral\baybak_files_only\QRClient\QuasarRAT-master\Library\obj\ Release\Library.pdb</code> <br><br>  Outra campanha com o Quasar RAT, usando os servidores de comando desses atacantes (mailukr.net), foi implementada em julho - setembro de 2017.  Os atacantes usaram uma vers√£o antiga do Quasar RAT chamada "xRAT 2.0 RELEASE3".  Os artefatos do compilador no conta-gotas mostram o caminho para o PDB <code>N:\shtorm\WinRARArchive\ obj\Release\WinRAR.pdb</code> <br><br><h3>  Sobaken </h3><br>  Sobaken √© uma vers√£o significativamente modificada do Quasar RAT.  Se voc√™ comparar a estrutura dos programas Quasar e Sobaken, poder√° observar muito em comum - veja a Figura 12. <br><br>  Os autores do Sobaken reduziram a funcionalidade do malware, tornando o arquivo execut√°vel menor e mais f√°cil de ocultar.  Eles tamb√©m adicionaram truques para contornar a sandbox e outras descritas acima. <br><br><img src="https://habrastorage.org/webt/y9/ld/aa/y9ldaavl3hyytmazu3mxftcgnku.png"><br>  <i>Figura 12. Evolu√ß√£o sobaken.</i>  <i>Left Quasar RAT v1.3, no meio e na direita - duas vers√µes do Sobaken</i> <br><br><h3>  Vermin </h3><br>  O Vermin √© um backdoor personalizado que somente esse grupo cibern√©tico usa.  Pela primeira vez, o malware foi documentado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio de</a> janeiro de 2018 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">da Palo Alto Networks</a> .  O backdoor apareceu em meados de 2016 e ainda est√° em uso.  Como o Quasar com Sobaken, ele √© escrito em .NET.  Para dificultar a an√°lise, o c√≥digo √© protegido usando o sistema comercial de prote√ß√£o de c√≥digo do .NET Reactor ou o protetor de c√≥digo aberto ConfuserEx. <br><br>  Al√©m disso, como Sobaken, ele usa o Vitevic Assembly Embedder, software gratuito para incorporar as DLLs necess√°rias no arquivo execut√°vel principal, dispon√≠vel no Visual Studio Marketplace. <br><br><h4>  Funcional </h4><br>  O Vermin √© um backdoor completo com v√°rios componentes opcionais.  A vers√£o mais recente conhecida no momento da escrita (Vermin 2.0) suporta os seguintes comandos, cuja ess√™ncia pode ser entendida pelos nomes: <br>  - StartCaptureScreen <br>  - StopCaptureScreen <br>  - ReadDirectory <br>  - UploadFile <br>  - DownloadFile <br>  - CancelUploadFile <br>  - CancelDownloadFile <br>  - GetMonitors <br>  - DeleteFiles <br>  - ShellExec <br>  - getprocesses <br>  - KillProcess <br>  - CheckIfProcessIsRunning <br>  - CheckIfTaskIsRunning <br>  - RunKeyLogger <br>  - CreateFolder <br>  - Renomear pasta <br>  - DeleteFolder <br>  - UpdateBot <br>  - RenameFile <br>  - ArchiveAndSplit <br>  - StartAudioCapture <br>  - StopAudioCapture <br>  - SetMicVolume <br><br>  A maioria dos comandos √© implementada na carga √∫til principal.  Apenas alguns comandos e fun√ß√µes adicionais - por meio de componentes opcionais carregados por atacantes na m√°quina da v√≠tima.  Entre os componentes opcionais: <br>  - grava√ß√£o de √°udio <br>  - keylogger <br>  - Roubo de senha <br>  - Roubo de um arquivo do USB (ladr√£o de arquivos USB) <br><br><h4>  Ferramenta de grava√ß√£o de √°udio (AudioManager) </h4><br>  Um componente Vermin de pleno direito que pode gravar som do microfone do computador da v√≠tima.  Ele aceita tr√™s comandos Vermin: StartAudioCapture, StopAudioCapture e SetMicVolume.  Os dados recebidos s√£o compactados usando codecs Speex e carregados no formato SOAP nos servidores Vermin C&amp;C. <br><br><h4>  Keylogger (KeyboardHookLib) </h4><br>  O Keylogger no Vermin √© um simples arquivo execut√°vel separado que intercepta todas as teclas digitadas e as grava no arquivo em formato criptografado.  Ele tamb√©m grava o conte√∫do do buffer e os nomes das janelas ativas.  O pr√≥prio keylogger n√£o pode se comunicar com os servidores Vermin C&amp;C;  O backdoor principal √© usado para transmitir as informa√ß√µes coletadas. <br><br>  O caminho para o PDB no keylogger confirma a conex√£o com o malware Vermin: <br> <code>Z:\Projects\Vermin\KeyboardHookLib\obj\Release\AdobePrintLib.pdb</code> <br> <br><h4>  Ferramenta de roubo de senha (PwdFetcher) </h4><br>  Um componente separado de roubo de senha da Vermin √© usado para extrair senhas salvas dos navegadores (Chrome, Opera).  A parte principal do c√≥digo parece ter sido copiada de um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo da Habr</a> .  Algumas amostras tamb√©m cont√™m c√≥digo para extrair informa√ß√µes do navegador Firefox, mas elas n√£o parecem ser usadas.  Como mostra a Figura 13, esse componente tamb√©m cont√©m caminhos PDB semelhantes ao componente keylogger, que confirma a conex√£o com o Vermin. <br><br><img src="https://habrastorage.org/webt/yg/fu/go/ygfugop0kr3ev9ddu34gwnq0nm4.png"><br>  <i>Figura 13. Artefatos de compila√ß√£o que permitem associar um componente de roubo de senha ao Vermin</i> <br><br><h4>  Ferramenta de roubo de arquivo USB (UsbGuard) </h4><br>  <code>UsbGuard.exe</code> √© um componente opcional usado por Sobaken e Vermin.  Este √© um pequeno programa separado que monitora as unidades USB conectadas ao computador e copia todos os arquivos que correspondem ao filtro configurado pelos atacantes.  Os arquivos roubados s√£o transferidos usando o m√≥dulo principal do backdoor.  Muitos caminhos diferentes para o PDB foram encontrados na amostra desse componente, que o liga claramente ao Vermin. <br><br>  Desde abril de 2018, o componente de roubo de arquivos √© usado como uma ferramenta separada.  Ele copia os arquivos e os envia imediatamente para um servidor controlado pelo invasor. <br><br>  Nas amostras analisadas, os atacantes procuraram arquivos com as seguintes extens√µes: <br>  - doc <br>  - docx <br>  - xls <br>  - xlsx <br>  - zip <br>  - rar <br>  - 7z <br>  - docm <br>  - txt <br>  - rtf <br>  - xlsm <br>  - pdf <br>  - jpg <br>  - jpeg <br>  - tif <br>  - odt <br>  - ods <br><br><h2>  Conclus√£o </h2><br>  Entre os muitos ataques com o uso de malware voltado para alvos de alto escal√£o na Ucr√¢nia, esta campanha n√£o recebeu muita aten√ß√£o.  Talvez isso se deva ao uso de c√≥digo de fontes abertas.  No entanto, o grupo j√° passou a desenvolver suas pr√≥prias ferramentas. <br><br>  O uso de v√°rias fam√≠lias de mecanismos de malware e infec√ß√£o, incluindo engenharia social e esteganografia, nos √∫ltimos tr√™s anos pode ser devido ao fato de os invasores experimentarem m√©todos ou trabalharem em v√°rios grupos. <br><br>  A aplica√ß√£o bem-sucedida de t√©cnicas triviais (por exemplo, o envio de RAR e EXE por email) enfatiza a import√¢ncia da prote√ß√£o contra o fator humano. <br><br><h2>  Indicadores de compromisso (IoC) </h2><br><h3>  Servidores C e C </h3><br><h4>  Sobaken C&amp;C </h4><br> <code>akamaicdn.ru <br> akamainet021.info <br> cdnakamai.ru <br> windowsupdate.kiev.ua <br> akamainet022.info <br> akamainet066.info <br> akamainet067.info <br> notifymail.ru <br> mailukr.net <br> 188.227.16.73 <br> 212.116.121.46 <br> 206.54.179.160</code> <br> <br><h4>  Quasar C&amp;C </h4><br> <code>188.227.75.189 <br> mailukr.net <br> cdnakamai.ru <br> notifymail.ru</code> <br> <br><h4>  Vermin C&amp;C </h4><br> <code>185.158.153.222 <br> 188.227.17.68 <br> 195.78.105.23 <br> tech-adobe.dyndns.biz <br> notifymail.ru <br> akamainet023.info <br> mailukr.net <br> 185.125.46.24 <br> akamainet024.info <br> 206.54.179.196</code> <br> <br><h3>  Transfer√™ncia de componentes, exfiltra√ß√£o de dados </h3><br> <code>chip-tuning.lg.ua <br> www.chip-tuning.lg.ua <br> olx.website <br> news24ua.info <br> rst.website <br> 1ua.eu <br> novaposhta.website</code> <br> <br><h3>  SHA1 </h3><br><h4>  Vermin </h4><br> <code>028EBDBEBAC7239B41A1F4CE8D2CC61B1E09983B <br> 07E1AF6D3F7B42D2E26DF12A217DEBACEDB8B1B9 <br> 09457ACB28C754AA419AB6A7E8B1940201EF3FFE <br> 0EEE92EC2723ED9623F84082DAD962778F4CF776 <br> 10128AB8770FBDECD81B8894208A760A3C266D78 <br> 131F99A2E18A358B60F09FD61EE312E74B02C07C <br> 14F69C7BFAF1DF16E755CCF754017089238B0E7B <br> 1509F85DE302BE83A47D5AFAD9BEE2542BA317FC <br> 170CEE6523B6620124F52201D943D7D9CA7B95E5 <br> 191159F855A0E580290871C945245E3597A5F25C <br> 1F12C32A41D82E978DE333CD4E93FDAA1396BE94 <br> 22B17966B597568DB46B94B253CD37CBCF561321 <br> 2C7332D8247376842BD1B1BD5298844307649C99 <br> 2E08BA5DF30C0718C1733A7836B5F4D98D84905E <br> 2EDF808F8252A4CBCB92F47A0AEDC1AAAE79A777 <br> 360F54B33AC960EE29CA0557A28F6BB8417EF409 <br> 431FCE6A47D0A48A57F699AA084C9FF175A9D15F <br> 45438834FDC5C690DA3BC1F60722BE86B871280D <br> 4A8A8188E3A7A137651B24780DF37CB6F610CC19 <br> 4C1E4E136B7922F9E28D1B38E9760E28929E4F0B <br> 5B6EA57FFC09593C3B65D903368EA5F7FAA2EB68 <br> 61D366939FE36861B2FECB38A4DFF6D86C925A00 <br> 6A72366D8AE09F72F0466FB59E8ED372F8B460D7 <br> 6FECA622B0FB282064F7DE42BA472A8EC908D0D6 <br> 70A772485C5ED330C6876FA901BA722CD44CA05E <br> 70D97367A3DBD5D45482B6AF8C78C58B64D3F3B3 <br> 7803FD9753930522705F2B6B4E73622887892C28 <br> 7B11A84B18DC4B5F1F2826E7925F0B2DC1B936AE <br> 889FD0BEB3197DDD6C88F5C40D6B8E4D74A892CE <br> 9B6FBABFA2A77FA633F7A2EB352979D5C68CEBC6 <br> A451291F17489E3A59F440A1B693D691B053C531 <br> A53D77E55A06CF131D670339BACEC5AC0F0C6D66 <br> A925D0AFB5D4F5FAC65543C993BE4172F1DBF329 <br> B5F81C804E47B76C74C38DF03A5CBE8A4FE69A9A <br> B99DE55043099E9506B304660B8E1374787AB195 <br> C00C104FC3E9F5977D11C67EF0C8C671D4DFC412 <br> CA0296FA9F48E83EA3F26988401B3F4C4E655F7A <br> D4C6540E789BD3839D65E7EDA5CCA8832493649E <br> D5EDE1BBB9A12757E24BE283AFC8D746ADC4A0D4 <br> DEFBFD98C74BEFF839EEB189F0F6C385AD6BA19B <br> ECF152EB6417A069573F2C7D9A35B9CC31EC8F56 <br> EE2D40825C77C8DFEF67999F0C521919E6672A10 <br> EF09AC6BA08A116F2C4080CBEE8CEF9523E21265 <br> F414C49CF502D1B6CC46E08F3AC97D7846B30732</code> <br> <br><h4>  Sobaken </h4><br> <code>087F77998004207BCCFFBF3030B6789648930FA5 <br> 0A4A2BCB3EF4E19973D5C4BE4E141B665CC0BFE0 <br> 1CEEF0813C0F096E6DA5461DC4B3BF901C500C56 <br> 293DBFF0230DAB3C4C21428F90C8EF06E9F35608 <br> 37E2947BFB5FC0839087C5BCE194EC193F824C85 <br> 39525CBCA591F2A10946BA62A56E4C3382CD4FC0 <br> 3CE0A18E9A8A2B95827008DBFF16364B6FEDF361 <br> 3E869038080DAE006FF6B20DF9B0CD9CB3A5E1A1 <br> 400830AB6DD46789B00D081ADF0F82623472FB13 <br> 43F382A330A454FF83F4F35FB571ECF587A4694A <br> 4449FBE2B28A81B760B284880ADBED43462C2030 <br> 4712AF28168FD728A13EFD520E0665FFD076B6FB <br> 4F504D7B35660943B206D6034752C686365EA58D <br> 53239A62E09BB0B4E49B7954D533258FEF3342C4 <br> 540292753FA0CC4ACB49E5F11FEDEA4B7DEF11D8 <br> 5589E8018DC7F934A8FDAB62670C9140AF31CAB6 <br> 57BBA7D8786D3B0C5F93BC20AB505DF3F69C72D4 <br> 630FE59D60F6882A0B9E35ED606BF06AD4BA048C <br> 63EA7C844D86882F491812813AAAD746738A6BE9 <br> 64121FA2FD2E38AC85A911A9F7ADD8CA1E1A9820 <br> 64DBA711FDD52FECF534CAC0C6FE8848FE36F196 <br> 650AB5E674FEF431EBC8CF98141506DDC80C5E64 <br> 6EF13E9D5B0B6FCB5EB2A7439AAD7B21EA7FB7AC <br> 7177F64362A504F3DF8AA815CEF7136D5A819C04 <br> 9B91EC03A09C4CF6DBEC637B3551BDCA11F04A9B <br> A26764AFB1DAC34CAA2123F7BF3543D385147024 <br> A55319D3DBD7B9A587F5156CF201C327C803FBC9 <br> A841FF1EE379269F00261337A043448D3D72E6FD <br> AAB5BAAAE8A2577E1036769F0D349F553E4D129B <br> ACB989B3401780999474C5B1D7F9198ECA11549A <br> B65372E41E7761A68AEF87001BBB698D8D8D5EC6 <br> BDB5E0B6CA0AA03E0BECA23B46A8420473091DFF <br> C4421084C19423D311A94D7BB6CB0169C44CBECD <br> C7E76993BB419DC755BD0C04255AB88E6C77B294 <br> CF5238C467EBE2704528EED18AB4259BFDC604E3 <br> D2334E161A1720E2DF048E4366150729B9395144 <br> D35FB6E031720876482E728A40532703EF02A305 <br> D82DF2903AA4BC5FD4274B5D1BFAF9E081771628 <br> E4B3CBCA9A53B7B93177A270C2A76F981D157C34 <br> E585AA2C5BFB9D42D2E58DB3833330D056713B9A <br> F4A485696FC871307C22906701CBBB3FA522499B <br> F5C75450108440D0BC9E7B210F072EF25A196D20</code> <br> <br><h4>  Quasar </h4><br> <code>0A4915B81D9A9ACF4E19181DEEEBBE244430C16B <br> 323160C88A254127D9ADB2848AE044AFFF376A4D <br> 395166835495B418773C9690227779D592F94F71 <br> 3EE410DD50FC64F39DFF0C4EE8CC676F0F7D5A74 <br> 5B665152F6596D4412267F9C490878455BA235F9 <br> 5FE8558EB8A3C244BE2DA8BE750221B9A9EE8539 <br> 61CB5E535F0AC90A1F904EC9937298F50E2B4974 <br> 6A1CD05F07B1024287CEA400237E1EA9D2FE1678 <br> 7676AFF05A3550E5BBFF78CF4D10C9E094447D72 <br> 86165F464EC1912A43445D80559D65C165E2CF76 <br> AB3CD05BE6B0BA8567B84D10EDE28ABF87E115AC <br> BFD7158E1C2F6BA525E24F85ED8CCF8EF40FD370 <br> CFEBEFC92DCDF1687FD0BC1B50457EBDEA8672A2 <br> D21B8514990B0CEAC5EAE687DEAA60B447139B9D</code> <br> <br><h4>  Esteganografia </h4><br> <code>04DA3E81684E4963ABEC4C0F6D56DF9F00D2EF26 <br> 3C618A0C4BF4D3D24C9F2A84D191FC296ED22FA4 <br> 746155881D5AB2635566399ACC89E43F6F3DA91A <br> CADBC40A4EFB10F4E9BD8F4EC3742FA8C37F4231 <br> E22CE72406B14EF32A469569FBE77839B56F2D69</code> <br> <br><h4>  Arquivos hta </h4><br> <code>39F5B17471FD839CC6108266826A4AD8F6ECD6A3 <br> 751FBD034D63A5E0A3CA64F55045AE24E575384A <br> 76433D1D13DF60EC0461ED6D8007A95C7A163FF9 <br> 89DF6A7551B00969E22DC1CAE7147447ACA10988 <br> D6D148050F03F5B14681A1BBF457572B9401B664</code> <br> <br><h4>  Ferramenta de grava√ß√£o de √°udio </h4><br> <code>1F49946CA2CE51DC51615000BAA63F6C5A9961F1 <br> 98F62C2E6045D5A15D33C8383ADACF9232E5FBE3 <br> E7C4A69EBD7B41A6AF914DD3D3F64E1AA1ABE9B4 <br> F233A0F2997BB554D4F1A4B7AC77DAE4180850FA</code> <br> <br><h4>  Keylogger </h4><br> <code>21921864D2F1AB2761C36031A2E1D2C00C9B304A <br> 3C2D0615BEF6F88FED6E308D4F45B6133080C74F <br> 91E8346910E0E6783ACFC4F2B9A745C81BD7573A</code> <br> <br><h4>  Ferramenta de roubo de senha </h4><br> <code>2A5C9D4DAE5E53B2962FBE2B7FA8798A127BC9A6 <br> 9B1586766AF9885EF960F05F8606D1230B36AC15 <br> A2F0D5AF81D93752CFF1CF1E8BB9E6CAEE6D1B5E <br> CE18467B33161E39C36FC6C5B52F68D49ABCFC2A</code> <br> <br><h4>  Ferramenta de roubo de arquivos USB </h4><br> <code>050EB7D20EE8EF1E1DAEE2F421E5BF648FB645DF <br> 069A919B3BC8070BB2D71D3E1AD9F7642D8ECF0F <br> 0D265E0BDA9DF83815759ABCA64938EC0FF65733 <br> 0D7DF910D0FB7B100F084BFB8DFA0A9F2371171A <br> 2FF3F5DA2960BE95E50B751680F450896AD1ED67 <br> 3200ECC7503F184F72AB9DA1DC3E1F8D43DDFD48 <br> 46D256EF277328E803D2B15CA7C188267059949D <br> 524EE1B7269D02F725E55254A015200BB472463A <br> 53A0EFD3D448DA8E32CFDDA5848312D3CF802B06 <br> 6FC150A9CAFA75813E7473C687935E7E4A5DCE24 <br> 70559245303F99630A27CB47B328C20C9666F0BB <br> 7D8044A5CBEFE3B016F2132A5750C30BB647E599 <br> 8FD919D531A7A80615517E1AC13C2D0F050AF20D <br> 9D22421DA9696B535C708178C72323F64D31FC80 <br> BFD2DFA3D6AF31DF4B9CC2F6B31B239ADF1CECA1 <br> C08A6222B59A187F3CF27A7BAE4CACFACC97DDEE <br> C2F6A65E14605828880927B9BA3C386507BD8161 <br> C562006D2FA53B15052A4B80C94B86355CCA7427 <br> CB43058D9EBB517832DF7058641AEDF6B303E736 <br> CC8A9C28E884FDA0E1B3F6CEAB12805FEA17D3C1 <br> D3CC27CA772E30C6260C5A3B6309D27F08A295CD <br> E7A2DE3776BA7D939711E620C7D6AB25946C9881 <br> EE6EFA7A6A85A1B2FA6351787A1612F060086320 <br> EF0ABB3A0CD1E65B33C0F109DD18F156FC0F0CDE <br> F63BE193C8A0FBB430F3B88CC8194D755BAD9CD1</code> <br> <br><h3>  Detec√ß√£o ESET </h3><br>  A maioria dos arquivos foi reconhecida automaticamente pela ESET com base no princ√≠pio de similaridade de malware.  As descobertas est√£o diretamente relacionadas √† maioria dos arquivos da campanha: <br> <code>MSIL/Agent AWB <br> MSIL/Agent AZG <br> MSIL/Agent AZJ <br> MSIL/Agent AZX <br> MSIL/Agent BCH <br> MSIL/Agent BCV <br> MSIL/Agent BCY <br> MSIL/Agent BFT <br> MSIL/Agent BGB <br> MSIL/Agent BGC <br> MSIL/Agent BGE <br> MSIL/Agent BGM <br> MSIL/Agent BJU <br> MSIL/Agent SCM <br> MSIL/Spy Agent BBB <br> MSIL/Spy Agent BIF <br> MSIL/TrojanDownloader Agent DYV <br> MSIL/TrojanDownloader Small BBM <br> MSIL/TrojanDropper Agent DBE <br> MSIL/TrojanDropper Agent DJQ <br> MSIL/TrojanDropper Agent DJR <br></code> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418165/">https://habr.com/ru/post/pt418165/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418155/index.html">Diodo LED Diodo Zener</a></li>
<li><a href="../pt418157/index.html">O livro "Objetos elegantes. Edi√ß√£o Java ¬ª</a></li>
<li><a href="../pt418159/index.html">Onde ir para o designer: pr√™mios de prest√≠gio da R√∫ssia, Europa Oriental e pa√≠ses da CEI</a></li>
<li><a href="../pt418161/index.html">Em Stanford, as baterias de streaming em temperatura ambiente desenvolvidas</a></li>
<li><a href="../pt418163/index.html">Testes de produ√ß√£o: Netflix Chaos Automation Platform</a></li>
<li><a href="../pt418167/index.html">ScadaPy: adicione o protocolo IEC 60870-5-104</a></li>
<li><a href="../pt418169/index.html">O que h√° de novo na atualiza√ß√£o 1 do Veeam Availability Console 2.0?</a></li>
<li><a href="../pt418171/index.html">Em que m√©tricas confiar se os usu√°rios realizarem poucas convers√µes no site?</a></li>
<li><a href="../pt418173/index.html">Ida e volta para redes neurais ou uma revis√£o do uso de codificadores autom√°ticos na an√°lise de texto</a></li>
<li><a href="../pt418177/index.html">Edi√ß√£o de imagens .heic sem perda de cor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>