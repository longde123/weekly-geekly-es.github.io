<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüîß üí† üéæ Devinez-moi si vous le pouvez: pr√©dire la cote d'un film avant sa sortie üïü üôÑ ‚è≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="R√©cemment, je suis tomb√© sur un ensemble de donn√©es Kaggle avec des donn√©es sur 45 000 films de l' ensemble de donn√©es Full MovieLens. Les donn√©es con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Devinez-moi si vous le pouvez: pr√©dire la cote d'un film avant sa sortie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466967/"> R√©cemment, je suis tomb√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur un ensemble</a> de donn√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kaggle</a> avec des donn√©es sur 45 000 films de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ensemble</a> de donn√©es Full MovieLens.  Les donn√©es contenaient non seulement des informations sur les acteurs, l'√©quipe, l'intrigue, etc., mais aussi les cotes √©mises par les utilisateurs des films pour les films (26 millions de cotes pour 270 000 utilisateurs). <br><br>  Une t√¢che standard pour ces donn√©es est un syst√®me de recommandation.  Mais pour une raison quelconque, il m'est venu √† l'esprit de <b>pr√©dire la cote d'un film sur la base des informations disponibles avant sa sortie</b> .  Je ne suis pas un connaisseur du cin√©ma, et je me concentre donc g√©n√©ralement sur les critiques, en choisissant quoi voir dans les nouvelles.  Mais les critiques sont √©galement quelque peu partiaux - ils regardent beaucoup plus de films diff√©rents que le spectateur moyen.  Il nous a donc sembl√© int√©ressant de pr√©dire comment le film serait appr√©ci√© par le grand public. <a name="habracut"></a><br><br>  Ainsi, l'ensemble de donn√©es contient les informations suivantes: <br><br><ul><li>  Informations sur le film: heure de sortie, budget, langue, soci√©t√© et pays d'origine, etc.  Ainsi que la note moyenne (et nous le pr√©dirons) </li><li>  Mots cl√©s (tags) sur l'intrigue </li><li>  Noms des acteurs et de l'√©quipe </li><li>  Notes (estimations) </li></ul><br>  Le code utilis√© dans l'article (python) est disponible sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> . <br><br><h3>  Pr√©filtrage des donn√©es </h3><br>  La gamme compl√®te contient des donn√©es sur plus de 45 000 films, mais comme la t√¢che consiste √† pr√©dire la note, vous devez vous assurer que les notes d'un film particulier sont objectives.  Par exemple, dans le fait que beaucoup de gens l'ont appr√©ci√©. <br><br>  La plupart des films ont tr√®s peu de notes: <br><br><img src="https://habrastorage.org/webt/zw/lt/df/zwltdfd2zu6q5a6i755zwybgs40.png" alt="image"><br><br>  Soit dit en passant, le film avec le plus grand nombre de notes (14075) m'a surpris - c'est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Inception¬ª</a> .  Mais les trois suivants - "The Dark Knight", "Avatar" et "Avengers" semblent assez logiques. <br><br>  Il est pr√©vu que le nombre de classements et le budget du film soient interconnect√©s (budget inf√©rieur - classements inf√©rieurs).  Par cons√©quent, la suppression des films avec un petit nombre de notes rend le mod√®le biais√© vers des films plus chers: <br><br><img src="https://habrastorage.org/webt/nr/cj/lx/nrcjlxju9-w96xuzpi6huitamei.png" alt="image"><br><br>  Nous partons pour des films d'analyse avec plus de 50 notes. <br><br>  De plus, nous supprimerons les films sortis avant le d√©but du service de notation (1996).  Ici, le probl√®me est que les films modernes sont en moyenne moins bien not√©s que les anciens, simplement parce que parmi les vieux films, ils regardent et √©valuent les meilleurs, et parmi les films modernes, c'est tout. <br><br>  En cons√©quence, la matrice finale contient environ 6 000 films. <br><br><h3>  Caract√©ristiques utilis√©es </h3><br>  Nous utiliserons plusieurs groupes de fonctionnalit√©s: <br><br><ul><li>  <b>M√©tadonn√©es</b> du film <b>:</b> si le film appartient √† la ¬´collection¬ª (s√©rie de films), pays de sortie, soci√©t√© de fabrication, langue du film, budget, genre, ann√©e et mois de sortie du film, sa dur√©e </li><li>  <b>Mots-cl√©s:</b> pour chaque film, il existe une liste de balises d√©crivant son intrigue.  Puisqu'il y a beaucoup de mots, ils ont √©t√© trait√©s comme suit: regroup√©s en groupes de similitude (par exemple, accident et accident de voiture), sur la base de ces groupes et mots individuels, une analyse PCA a √©t√© effectu√©e et les composants les plus importants ont √©t√© s√©lectionn√©s √† partir de ses r√©sultats.  Cela a r√©duit la dimension de l'espace de fonctionnalit√©. </li><li>  <b>Les ¬´m√©rites¬ª pr√©c√©dents des acteurs qui ont jou√© dans le film.</b>  Pour chaque acteur, une liste de films a √©t√© form√©e dans laquelle il a jou√© plus t√¥t et la note de ces films a √©t√© calcul√©e.  Ainsi, pour chaque film, un indicateur a √©t√© form√© qui agr√®ge le succ√®s des films dans lesquels les acteurs ont jou√© plus t√¥t. </li><li>  <b>Oscars.</b>  Si les acteurs, le r√©alisateur, le producteur, le sc√©nariste ou le cam√©raman ont d√©j√† particip√© √† un film qui a √©t√© nomin√© ou a re√ßu un Oscar du meilleur film, r√©alisation ou sc√©nario, cela a √©t√© pris en compte dans le mod√®le.  De plus, si les acteurs √©taient des nomin√©s ou des laur√©ats de l'Academy Award du meilleur acteur de soutien ou du second r√¥le, cela a √©galement √©t√© pris en compte.  Informations sur les Oscars re√ßues de Wikipedia. </li></ul><br><h4>  Quelques statistiques int√©ressantes </h4><br>  <b>Les films documentaires sont les mieux not√©s.</b>  C'est une bonne raison de noter que diff√©rents films sont √©valu√©s par diff√©rentes personnes, et si les documentaires ont √©t√© √©valu√©s par des mordus d'action, les r√©sultats peuvent √™tre diff√©rents.  Autrement dit, les estimations sont biais√©es en raison des pr√©f√©rences initiales du public.  Mais pour notre t√¢che, cela n'est pas important, car nous voulons pr√©voir une √©valuation non conditionnellement objective (comme si chaque spectateur avait regard√© tous les films), √† savoir celle qui sera donn√©e au film par son public. <br><br>  Soit dit en passant, il est int√©ressant de noter que les films historiques sont class√©s bien moins bien que les documentaires. <br><br><img src="https://habrastorage.org/webt/in/uh/v8/inuhv8hltyvmys4uqxpeec21540.png" alt="image"><br><br>  <b>Les notes les plus √©lev√©es sont attribu√©es aux films sortis en d√©cembre, septembre et mai.</b> <br><br>  Cela peut probablement s'expliquer comme suit: <br><br><ul><li>  en d√©cembre, les entreprises sortent les meilleurs films √† collectionner au box-office pendant les vacances de No√´l </li><li>  en septembre, sortira des films qui participeront √† la lutte pour l'Oscar </li><li>  Mai est la date de sortie des blockbusters d'√©t√©. </li></ul><br><img src="https://habrastorage.org/webt/2b/2c/yc/2b2cycuspiakfgv7ft3kvrdjjcg.png" alt="image"><br><br>  <b>La classification des films d√©pend peu du budget</b> <br><br><img src="https://habrastorage.org/webt/9s/7q/2q/9s7q2qo7c1noal7j1lpoynwax8k.png" alt="image"><br>  Budget nul pour certains films - probablement pas de donn√©es <br><br>  <b>Films les plus courts et les plus longs les mieux not√©s</b> <br><br><img src="https://habrastorage.org/webt/zl/gl/8u/zlgl8uepsad2ej3s8xubwlect68.png" alt="image"><br>  Pour certains films, une dur√©e nulle est indiqu√©e - probablement aucune donn√©e <br><br><h3>  R√©sultats sur diff√©rents ensembles de fonctionnalit√©s </h3><br>  Notre t√¢che - pr√©voir la cote - la t√¢che de r√©gression.  Nous allons tester trois mod√®les - r√©gression lin√©aire (comme la ligne de base), SVM et XGB.  En tant que mesure de qualit√©, nous choisissons RMSE.  Le graphique ci-dessous montre les valeurs RMSE sur l'ensemble de validation pour diff√©rents mod√®les et diff√©rents ensembles de fonctionnalit√©s (je voulais comprendre s'il valait la peine de jouer avec les mots-cl√©s et les Oscars).  Tous les mod√®les sont construits avec des hyperparam√®tres de base. <br><br>  Comme vous pouvez le voir, XGB a le meilleur r√©sultat avec un ensemble complet de fonctionnalit√©s (m√©tadonn√©es de film + mots-cl√©s + Oscars). <br><br><img src="https://habrastorage.org/webt/37/cj/fe/37cjfe-vet9nmvjcdzgtpsbfnjs.png" alt="image"><br><br>  En r√©glant les hyperparam√®tres, il a √©t√© possible de r√©duire le RMSE de 0,708 √† 0,706 <br><br><h3>  Analyse des erreurs et commentaires finaux </h3><br>  Nous supposons que les erreurs de moins de 5% sont petites (environ un tiers) et que les erreurs de plus de 20% sont importantes (environ 10%).  Dans d'autres cas (un peu plus de la moiti√©), nous consid√©rerons la moyenne d'erreur. <br><br>  Fait int√©ressant, la taille de l'erreur et la cote du film sont li√©es: le <b>mod√®le est moins susceptible de faire des erreurs sur les bons films et plus souvent sur les mauvais.</b>  Cela semble logique: les bons films, comme tout autre travail, sont plut√¥t r√©alis√©s par des gens plus exp√©riment√©s et professionnels.  √Ä propos du film Tarantino avec la participation de Brad Pitt, vous pouvez dire √† l'avance qu'il se r√©v√©lera tr√®s probablement bon.  Dans le m√™me temps, un film √† petit budget avec des acteurs peu connus peut √™tre √† la fois bon et mauvais, et il est difficile de juger sans le voir. <br><br><img src="https://habrastorage.org/webt/jg/pv/ic/jgpvick-5luxle1syvo2eskzztm.png" alt="image"><br><br>  Voici les caract√©ristiques les plus importantes du mod√®le (les variables PCA se r√©f√®rent aux mots cl√©s trait√©s qui d√©crivent l'intrigue du film): <br><br><img src="https://habrastorage.org/webt/mp/jo/df/mpjodfpgjy6b8wf5jgpezb0lbzg.png" alt="image"><br><br>  Deux de ces longs m√©trages appartiennent aux Oscars, qui avaient √©t√© pr√©c√©demment nomm√©s par des membres de l'√©quipe (r√©alisateur, producteur, sc√©nariste, cam√©raman) ou des films dans lesquels les acteurs ont jou√©.  Comme mentionn√© ci-dessus, l'erreur de pr√©vision est associ√©e √† l'√©valuation du film, et en ce sens, les nominations pr√©c√©dentes aux Oscars peuvent √™tre un bon d√©limiteur pour le mod√®le.  En effet, les films qui ont au moins une nomination aux Oscars (parmi les acteurs ou les √©quipes) ont une erreur de pr√©vision moyenne de 8,3%, et ceux qui n'ont pas de telles nominations - 9,8%.  Parmi les 10 principales fonctionnalit√©s utilis√©es dans le mod√®le, ce sont les nominations aux Oscars qui donnent le meilleur rapport avec la taille de l'erreur. <br><br>  Par cons√©quent, l'id√©e est venue de construire deux mod√®les distincts: l'un pour les films dans lesquels les acteurs ou l'√©quipe ont √©t√© nomin√©s pour un Oscar, et le second pour le reste.  L'id√©e √©tait que cela pourrait r√©duire l'erreur globale.  Cependant, l'exp√©rience a √©chou√©: le mod√®le g√©n√©ral a donn√© RMSE 0,706 et deux mod√®les distincts ont donn√© 0,715. <br><br>  Par cons√©quent, nous laisserons le mod√®le d'origine.  Les r√©sultats de sa pr√©cision sont les suivants: RMSE dans l'√©chantillon d'apprentissage - 0,688, dans l'√©chantillon de validation - 0,706 et dans l'√©chantillon d'essai - 0,732. <br><br>  Autrement dit, il y a un sur-ajustement.  Des param√®tres de r√©gularisation ont d√©j√† √©t√© d√©finis dans le mod√®le lui-m√™me.  Une autre fa√ßon de r√©duire le surapprentissage pourrait √™tre de collecter davantage de donn√©es.  Pour comprendre si cela peut aider, nous allons construire un graphique des erreurs pour diff√©rentes tailles de l'√©chantillon de formation - de 100 au maximum 3 000 disponibles. Le graphique montre qu'√† partir d'environ 2,5 mille points dans l'ensemble de formation, des erreurs dans la formation, la validation et le changement de l'ensemble de tests petite, c'est-√†-dire qu'une augmentation de l'√©chantillon n'aura pas d'effet significatif. <br><br><img src="https://habrastorage.org/webt/uf/_9/jp/uf_9jpmxsjiylo6fd4d9lqt281i.png" alt="image"><br><br>  <b>Quoi d'autre pouvez-vous essayer d'affiner le mod√®le:</b> <br><br><ul><li>  Initialement, les films sont s√©lectionn√©s diff√©remment (limite diff√©rente sur le nombre de votes, limites suppl√©mentaires sur d'autres variables) </li><li>  Toutes les notes ne sont pas utilis√©es pour calculer la note - il est possible de s√©lectionner des utilisateurs plus actifs ou de supprimer ceux qui ne donnent que de mauvaises notes </li><li>  Essayez diff√©rentes fa√ßons de remplacer les donn√©es manquantes </li></ul><br>  Fait int√©ressant, le film de 1997 ¬´Batman et Robin¬ª a enregistr√© la plus grande erreur de pr√©vision (7 points de pr√©vision au lieu de 4,2 r√©els).  Le film avec Arnold Schwarzenegger, George Clooney et Uma Thurman a re√ßu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">11</a> nominations aux Golden Raspberry <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Awards (et une victoire)</a> , en t√™te de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">liste des 50 pires films de l'histoire d'Empire Newsreel,</a> et a conduit √† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">annulation de la suite et au red√©marrage de toute la s√©rie</a> .  Eh bien, ici, le mod√®le s'est peut-√™tre tromp√© comme un homme :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466967/">https://habr.com/ru/post/fr466967/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466949/index.html">Perspectives pour les r√©seaux quantiques: qui s'y engage et pourquoi</a></li>
<li><a href="../fr466955/index.html">√ânigmes du CV. Partie 3. Le voile des secrets enlev√©</a></li>
<li><a href="../fr466957/index.html">iPhone 11, le nouvel iPad, TV +, Arcade et plus encore. Ce qu'Apple a montr√© aujourd'hui</a></li>
<li><a href="../fr466963/index.html">Habrastatistique: comment Habr vit sans geektimes</a></li>
<li><a href="../fr466965/index.html">Pr√©sentation Apple 10 septembre 2019</a></li>
<li><a href="../fr466973/index.html">Leisya, Fanta: une nouvelle tactique pour un vieux cheval de Troie Android</a></li>
<li><a href="../fr466979/index.html">Renommer des fichiers avec des variables - Code Visual Studio</a></li>
<li><a href="../fr466983/index.html">Pourquoi personne ne peut battre la course de Tesla</a></li>
<li><a href="../fr466985/index.html">√Ä propos des nouvelles normes C ++</a></li>
<li><a href="../fr466987/index.html">Les ¬´ls¬ª atypiques ou comment les linuxo√Ødes sont divertis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>