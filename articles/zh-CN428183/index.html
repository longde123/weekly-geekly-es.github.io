<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤓 🏐 🧑🏾 在TensorFlow上优化神经网络的Levenberg-Marquardt算法的实现 👩🏼‍⚖️ 🏒 💳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="这是TensorFlow库教程。 认为它比有关手写数字识别的文章更深入。 这是有关优化方法的教程。 在这里，您不能没有数学。 如果您完全忘记它也可以。 回想一下。 没有正式的证据和复杂的结论，只有直观理解的必要最低限​​度。 首先，对如何在优化神经网络中使用该算法有一些背景知识。 




 六个月...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在TensorFlow上优化神经网络的Levenberg-Marquardt算法的实现</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428183/"><p> 这是TensorFlow库教程。 认为它比有关手写数字识别的文章更深入。 这是有关优化方法的教程。 在这里，您不能没有数学。 如果您完全忘记它也可以。 回想一下。 没有正式的证据和复杂的结论，只有直观理解的必要最低限​​度。 首先，对如何在优化神经网络中使用该算法有一些背景知识。 </p><br><img src="https://habrastorage.org/webt/ka/vv/kh/kavvkhi2wic8-bj1_-6i4zjvkpe.jpeg"><br><br><p> 六个月前，一个朋友问我如何用Python制作神经网络。 他的公司生产用于地球物理测量的仪器。 在钻井过程中，几种不同的探针可测量与井周围环境参数相关的一组信号。 在某些复杂的情况下，即使在功能强大的计算机上，也需要长时间根据信号精确计算环境参数，因此有必要解释现场的测量结果。 有一个想法是在一个集群上计算数十万个案例，并在它们上训练一个神经网络。 由于神经网络非常快，因此可以在钻孔过程中将其用于确定与测量信号一致的参数。 详细信息在文章中： </p><br><p>  Kushnir，D.，Velker，N.，Bondarenko，A.，Dyatlov，G.，＆Dashevsky，Y.（2018年10月29日）。 使用神经网络（俄语）对二维故障模型中的深方位电阻率工具进行实时仿真。 石油工程师协会。  doi：10.2118 / 192573-RU </p><br><p> 一天晚上，我展示了keras如何实现简单的神经网络，并且一个工作中的朋友开始对计数的数据进行训练。 几天后，我们讨论了结果。 从我的角度来看，他看上去很有前途，但是一位朋友说他需要使用设备的精度进行计算。 如果<em>均方误差</em>约为1，则需要1e-3。 少3个订单。 一千次。 </p><a name="habracut"></a><br><p> 神经网络架构，数据规范化和优化方法的实验几乎没有结果。 几周后，一个朋友打来电话，说他安装了MatLab并通过<em>Levenberg-Marquardt</em>方法（以下称为<em>LM</em> ）解决了问题。 它经过长时间（数天）的优化，无法在GPU上运行，但结果是正确的。 听起来像是一个挑战。 </p><br><p> 快速搜索用于keras或TensorFlow的现成的LM优化器失败。 我只遇到了pyrenn库，但是在我看来它的功能似乎很差。 我决定自己实施。 乍一看，一切看起来都很简单，两个晚上应该就足够了。 花了更长的时间。 有两个问题： </p><br><ol><li>  TensorFlow。 一堆文章，但几乎涉及所有层次，“但让我们来写个<s>世界</s>手写数字识别。” </li><li> 数学 我忘记了很多，数学文章的作者根本不在乎像我这样的人：没有解释的可靠公式，“很明显！” 等等。 </li></ol><br><p> 结果，他为那些忘记了数学并想更深入地了解TensorFlow的人写了一篇文章，但没有硬核。 本文包含大量文本和少量代码。 当文本很少且代码很多时，相反的选择是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Jupyter Notebook Levenberg-Marquardt</a> 。 </p><br><h4> 了解Rosenbrock功能 </h4><br><p> 我们将<em>通过Rosenbrock函数</em>生成训练数据<em>，该函数</em>通常用作优化算法的基准： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mrow" id="MJXp-Span-3"><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> x </font></font></span><span class="MJXp-mrow" id="MJXp-Span-6"><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mrow" id="MJXp-Span-12"><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a </font></font></span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-17"><span class="MJXp-mrow" id="MJXp-Span-18" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-20" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-29" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mrow" id="MJXp-Span-31" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-33" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.082ex" height="2.901ex" viewBox="0 -987.6 16396.5 1249" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-66" x="0" y="0"></use><g transform="translate(550,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="1380" y="0"></use><g transform="translate(1952,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="2782" y="0"></use><g transform="translate(3280,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="4388" y="0"></use><g transform="translate(5444,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="6274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2212" x="7026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="8026" y="0"></use><g transform="translate(8599,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="1173" y="640"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2B" x="10105" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="11106" y="0"></use><g transform="translate(11535,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="12365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2212" x="13085" y="0"></use><g transform="translate(14086,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="809" y="583"></use></g><g transform="translate(15112,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="1173" y="640"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> f（x，y）=（a-x）^ 2 + b（y-x ^ 2）^ 2 </script></p><br><img src="https://habrastorage.org/webt/cr/by/_v/crby_vv7ldxutqj5dxfaehtfnlk.jpeg"><br><br><p> 她为什么好？ </p><br><ul><li> 美好的时间表。 它被称为Rosenbrock山谷和不可翻译的<i>Rosenbrock的香蕉功能</i> 。 </li><li> 整体最小值在一个长而狭窄的抛物线形平坦谷内。 寻找山谷是微不足道的，而全局最小值很难。 </li><li> 有一个多维选项。 要为多个变量提供出色的功能并非易事。 </li></ul><br><p> 我们将通过连接进一步工作所需的库来开始从中编写代码： </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rosenbrock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, a, b)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a - x)**<span class="hljs-number"><span class="hljs-number">2</span></span> + b*(y - x**<span class="hljs-number"><span class="hljs-number">2</span></span>)**<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br><h4> 我们陈述问题 </h4><br><p> 由于我们在谈论一种测量设备，因此让我们继续使用此类比喻。 我们在虚拟世界中的设备可以测量坐标 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-mrow" id="MJXp-Span-35"><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> X </font></font></span><span class="MJXp-mrow" id="MJXp-Span-38"><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.268ex" height="2.419ex" viewBox="0 -780.1 3560 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="829" y="0"></use><g transform="translate(1402,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="2232" y="0"></use><g transform="translate(2729,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-2">（x，y）</script> 和高度 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ž</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> z </script>  。 物理学家研究了这个世界，并说：“ <em>是的，这是Rosenbrock！知道坐标，您就可以准确地计算高度，而无需测量。</em> ” 换句话说，科学家给了我们一个模型 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> x </font></font></span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font></span><span class="MJXp-mrow" id="MJXp-Span-64"><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a </font></font></span><span class="MJXp-mrow" id="MJXp-Span-67"><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> b </font></font></span><span class="MJXp-mrow" id="MJXp-Span-70"><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.39ex" height="2.419ex" viewBox="0 -780.1 13084.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-52" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6F" x="2562" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-73" x="3047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-65" x="3517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6E" x="3983" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="4584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-72" x="5013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6F" x="5465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-63" x="5950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6B" x="6384" y="0"></use><g transform="translate(6905,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="7735" y="0"></use><g transform="translate(8308,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="9138" y="0"></use><g transform="translate(9635,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="10465" y="0"></use><g transform="translate(10995,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="11824" y="0"></use><g transform="translate(12254,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> z = Rosenbrock（x，y，a，b）</script> 取决于参数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mrow" id="MJXp-Span-73"><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A </font></font></span><span class="MJXp-mrow" id="MJXp-Span-76"><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> b </font></font></span><span class="MJXp-mrow" id="MJXp-Span-79"><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.01ex" height="2.298ex" viewBox="0 -780.1 3449 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="829" y="0"></use><g transform="translate(1359,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="2189" y="0"></use><g transform="translate(2618,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-5">（a，b）</script>  。 这些参数尽管在虚构的世界中是恒定的，但未知。 需要找到它们。 </p><br><p> 我们进行了一系列实验， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">米</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> m </script> 点数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mrow" id="MJXp-Span-84"><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-88" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-89"><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-93" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-94"><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-98" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-101"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mrow" id="MJXp-Span-103"><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-107" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-108"><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-113"><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-117" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-118"><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mrow" id="MJXp-Span-127"><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mrow" id="MJXp-Span-132"><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-136" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mrow" id="MJXp-Span-137"><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-141" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mrow" id="MJXp-Span-142"><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.018ex" height="2.419ex" viewBox="0 -780.1 23257.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text><g transform="translate(829,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-31" x="809" y="-213"></use></g><g transform="translate(1856,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(2686,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-31" x="693" y="-213"></use></g><g transform="translate(3630,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(4460,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-31" x="658" y="-213"></use></g><g transform="translate(5380,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(6210,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(7040,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(7870,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="809" y="-213"></use></g><g transform="translate(8896,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(9726,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="693" y="-213"></use></g><g transform="translate(10670,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(11500,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="658" y="-213"></use></g><g transform="translate(12420,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(13250,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2E" x="14080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2E" x="14525" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2E" x="14970" y="0"></use><g transform="translate(15415,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(16245,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(17075,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="809" y="-213"></use></g><g transform="translate(18369,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(19199,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="693" y="-213"></use></g><g transform="translate(20411,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(21241,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="658" y="-213"></use></g><g transform="translate(22427,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-7">（x_1，y_1，z_1），（x_2，y_2，z_2），...，（x_m，y_m，z_m）</script>  ： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># (2.5, 2.5) -   ,  ,     data_points = np.array([[x, y, rosenbrock(x, y, 2.5, 2.5)] for x in np.arange(-2, 2.1, 2) for y in np.arange(-2, 2.1, 2)]) m = data_points.shape[0]</span></span></code> </pre> <br><p> 优化的第一种方法是尝试猜测参数。 我们使用Numpy库： </p><br><pre> <code class="python hljs">x, y = data_points[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], data_points[:, <span class="hljs-number"><span class="hljs-number">1</span></span>] z = data_points[:, <span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   =5  b=5? a_guess, b_guess = 5., 5. #  -hat   ,   , #   ,   ,   .   #     ^   - # .    hat. z_hat = rosenbrock(x, y, a_guess, b_guess)</span></span></code> </pre> <br><p> 如何理解我们错了？ 计算<em>残差</em> -误差大小。 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> m </script> 点给 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> m </script> 残差-您需要一个积分指标。 我们将每个残差平方成一个平方并计算平均值： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">E</span><span class="MJXp-mrow" id="MJXp-Span-152"><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">a</span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">b</span><span class="MJXp-mrow" id="MJXp-Span-158"><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">c</span><span class="MJXp-mrow" id="MJXp-Span-166"><span class="MJXp-mn" id="MJXp-Span-167">1</span></span><span class="MJXp-mrow" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">m</span></span><span class="MJXp-mtext" id="MJXp-Span-170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">u</span><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">m</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">i</span><span class="MJXp-mo" id="MJXp-Span-177">=</span><span class="MJXp-mn" id="MJXp-Span-178">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-181"><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-185" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-188">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">t</span><span class="MJXp-mrow" id="MJXp-Span-196"><span class="MJXp-msubsup" id="MJXp-Span-197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-199" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-201"><span class="MJXp-mrow" id="MJXp-Span-202" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-204" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="53.382ex" height="3.262ex" viewBox="0 -987.6 22983.6 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-53" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-45" x="1697" y="0"></use><g transform="translate(2461,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="3291" y="0"></use><g transform="translate(3820,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="4650" y="0"></use><g transform="translate(5080,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="6188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-66" x="7494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-72" x="8045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="8496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-63" x="9026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-31" x="9459" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="9960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-73" x="11088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-75" x="11558" y="0"></use><g transform="translate(12130,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6D" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-31" x="1124" y="0"></use></g></g><g transform="translate(14257,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(15087,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-69" x="658" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-2212" x="16119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-77" x="17370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-69" x="18086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-64" x="18432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-65" x="18955" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-68" x="19422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="19998" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-74" x="20528" y="0"></use><g transform="translate(20889,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-69" x="658" y="-213"></use></g><g transform="translate(21699,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-32" x="1173" y="640"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> MSE（a，b）= \ frac {1} {m} \ sum_ {i = 1} ^ {m}（z_ {i}-\ widehat {z_ {i}}）^ 2 </script></p><br><p> 这种接近度的度量称为<em>均方误差</em> （以下称为<em>mse</em> ）： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># r - residuals () r = z - z_hat # mse loss = np.mean(r**2) print(loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p> 通过最小化<em>mse</em> ，我们解决了<em>最小二乘问题</em> （ <em>非线性平方最小化</em> ）： </p><br><img src="https://habrastorage.org/webt/lt/qk/su/ltqksu80eo7y4h91xedhj8w0djy.png"><br><p> 可以看出，这些参数根本没有猜测。 </p><br><h4> 我们在TensorFlow上制定问题 </h4><br><p> 该模型具有形式 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">z</span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">k</span><span class="MJXp-mrow" id="MJXp-Span-218"><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">x</span><span class="MJXp-mrow" id="MJXp-Span-221"><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">y</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">a</span><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">b</span><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.39ex" height="2.419ex" viewBox="0 -780.1 13084.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-52" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6F" x="2562" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-73" x="3047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-65" x="3517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6E" x="3983" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="4584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-72" x="5013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6F" x="5465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-63" x="5950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6B" x="6384" y="0"></use><g transform="translate(6905,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="7735" y="0"></use><g transform="translate(8308,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="9138" y="0"></use><g transform="translate(9635,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="10465" y="0"></use><g transform="translate(10995,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="11824" y="0"></use><g transform="translate(12254,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-11"> z = Rosenbrock（x，y，a，b）</script>  。 我们把它变成表格 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">y</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">f</span><span class="MJXp-mrow" id="MJXp-Span-236"><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">x</span><span class="MJXp-mrow" id="MJXp-Span-239"><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">p</span><span class="MJXp-mrow" id="MJXp-Span-242"><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.815ex" height="2.419ex" viewBox="0 -780.1 5948 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-66" x="1831" y="0"></use><g transform="translate(2382,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="3212" y="0"></use><g transform="translate(3784,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-70" x="4614" y="0"></use><g transform="translate(5118,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-12"> y = f（x，p）</script>  （通常是数学写的 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mtext" id="MJXp-Span-245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.731ex" height="2.057ex" viewBox="0 -780.1 2037 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-61" x="1507" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> \ beta </script> 代替 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-70" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> p </script> 但程序员不使用beta）。 现在模型有了形式 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">y</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">k</span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">x</span><span class="MJXp-mrow" id="MJXp-Span-268"><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">p</span><span class="MJXp-mrow" id="MJXp-Span-271"><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.388ex" height="2.419ex" viewBox="0 -780.1 10500.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-52" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6F" x="2591" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-73" x="3076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-65" x="3546" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6E" x="4012" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-62" x="4613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-72" x="5042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6F" x="5494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-63" x="5979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-6B" x="6413" y="0"></use><g transform="translate(6934,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="7764" y="0"></use><g transform="translate(8337,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-70" x="9167" y="0"></use><g transform="translate(9670,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-15"> y = Rosenbrock（x，p）</script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> y </script>  -身高 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> x </script> 是两个元素（分量） <em>的</em>坐标<em>向量</em> ，并且 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhhU0yMBuOfKFgvne1_EChnRPTCGPw#MJMATHI-70" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> p </script>  -参数<em>向量</em> 。 </p><br><p> 程序员经常将向量视为一维数组。 这并不完全正确。 数字数组是<em>表示</em>向量的一种方式。 您可以将向量表示为维数组 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> N </script> 二维数组 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-mn" id="MJXp-Span-282">1</span><span class="MJXp-mtext" id="MJXp-Span-283" style="color: red;">\乘</span><span class="MJXp-mrow" id="MJXp-Span-284"><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.278em; margin-right: 0.278em;">以</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> 1 \乘以N </script>  ，甚至是数组 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">N</span><span class="MJXp-mtext" id="MJXp-Span-289" style="color: red;">\乘</span><span class="MJXp-mrow" id="MJXp-Span-290"><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0.278em; margin-right: 0.278em;">以</span></span><span class="MJXp-mn" id="MJXp-Span-292">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> N \乘以1 </script> 在向量是<em>列向量</em>的事实（例如，将其乘以矩阵）的情况下很重要： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-293"><span class="MJXp-mtext" id="MJXp-Span-294" style="color: red;">\开</span><span class="MJXp-mrow" id="MJXp-Span-295"><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0.278em; margin-right: 0.278em;">始</span></span><span class="MJXp-mrow" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-307" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mspace" id="MJXp-Span-308" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-309">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">s</span><span class="MJXp-mspace" id="MJXp-Span-315" style="width: 0em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-318" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-319">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">d</span><span class="MJXp-mrow" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> \开始{bmatrix} x_1 \\\ vdots \\ x_N \ end {bmatrix} </script></p><br><p>  TensorFlow使用<em>张量</em>的概念。 像数组一样， <em>张量</em>可以是一维的（用于表示<em>向量</em> ），二维的（用于<em>矩阵</em>或<em>列向量</em> ）和任何更大的维度。 </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ('placeholder' ,    #      ) x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m]) #   ('variable' ,    ) #     (5, 5) p = tf.Variable([5., 5.], dtype=tf.float64) #  y_hat = rosenbrock(x[:, 0], x[:, 1], p[0], p[1]) #  r = y - y_hat # mse (mean squared error) loss = tf.reduce_mean(r**2)</span></span></code> </pre> <br><p>  TensorFlow代码的形式与Numpy代码相同。 内容是巨大的。  numpy代码计算<em>出</em> mse <em>值</em> 。  TensorFlow代码根本不执行任何计算，它形成<em>了</em> mse <em>可以计算</em> <em>的数据流</em> <em>图</em> 。  <em>Rosenbrock</em>功能是一个非常<em>耐大脑的</em>时刻。 我们在两种情况下都使用它。 但是，当我们传递Numpy数组时，它将根据公式执行计算并返回数字。 当我们将张量传输到TensorFlow时，它形成<em>数据流</em>的<em>子图，</em>并以张量的形式返回其<em>边缘</em> 。 多态的奇迹，但不要滥用它们： </p><br><img src="https://habrastorage.org/webt/cw/6u/nz/cw6unzjtqsl_uvl3auasc-x46zq.jpeg"><br><p> 由于存在这样的数据流图，TensorFlow尤其能够自动计算<em>导数</em> （使用<em>反向模式自动微分</em>技术）。 </p><br><p> 一点数学。  “为那些被遗忘的人”的方块将被隐藏在扰流板中。 </p><br><div class="spoiler">  <b class="spoiler_title">导数（输入的数字-剩余的数字）</b> <div class="spoiler_text"><p> 您很可能还记得一个变量的标量（返回数字）函数的导数的定义：for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">f</span><span class="MJXp-mrow" id="MJXp-Span-333"><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mtext" id="MJXp-Span-335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">b</span><span class="MJXp-mrow" id="MJXp-Span-342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">R</span></span><span class="MJXp-mtext" id="MJXp-Span-344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">w</span><span class="MJXp-mtext" id="MJXp-Span-355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">b</span><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">R</span></span></span></span><script type="math/tex" id="MathJax-Element-23"> f：\ mathbb {R} \ rightarrow \ mathbb {R} </script> 导数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">f</span></span></span><script type="math/tex" id="MathJax-Element-24"> f </script> 在这一点上 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">x</span><span class="MJXp-mtext" id="MJXp-Span-368">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">n</span><span class="MJXp-mtext" id="MJXp-Span-371">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">b</span><span class="MJXp-mrow" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">R</span></span></span></span><script type="math/tex" id="MathJax-Element-25"> x \ in \ mathbb {R} </script> 定义为： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-380"><span class="MJXp-msup" id="MJXp-Span-381"><span class="MJXp-mrow" id="MJXp-Span-382" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-384" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-385"><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">x</span><span class="MJXp-mrow" id="MJXp-Span-388"><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">i</span><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">h</span><span class="MJXp-mtext" id="MJXp-Span-398" style="color: red;">\到</span><span class="MJXp-mn" id="MJXp-Span-399">0</span></span></span><span class="MJXp-mtext" id="MJXp-Span-400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">c</span><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">f</span><span class="MJXp-mrow" id="MJXp-Span-407"><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">x</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">h</span><span class="MJXp-mrow" id="MJXp-Span-412"><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">f</span><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">x</span><span class="MJXp-mrow" id="MJXp-Span-419"><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">h</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-26"> {f}'（x）= \ lim_ {h \到0} \ frac {f（x + h）-f（x）} {h} </script></p><br><p> 导数是衡量<i>变化的</i>一种方法。 在标量情况下，导数显示函数将改变多少 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">f</span></span></span><script type="math/tex" id="MathJax-Element-27"> f </script> 如果 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">x</span></span></span><script type="math/tex" id="MathJax-Element-28"> x </script> 变小 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-mtext" id="MJXp-Span-428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">n</span></span></span><script type="math/tex" id="MathJax-Element-29"> \ varepsilon </script>  ： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">f</span><span class="MJXp-mrow" id="MJXp-Span-441"><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">x</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-445">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">n</span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-458" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-459"><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">f</span><span class="MJXp-mrow" id="MJXp-Span-462"><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">x</span><span class="MJXp-mrow" id="MJXp-Span-465"><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-468">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">n</span><span class="MJXp-msup" id="MJXp-Span-479"><span class="MJXp-mrow" id="MJXp-Span-480" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-482" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-483"><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">x</span><span class="MJXp-mrow" id="MJXp-Span-486"><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-30"> f（x + \ varepsilon）\大约f（x）+ \ varepsilon {f}'（x）</script></p><br><p> 为了方便起见，我们表示 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">y</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">f</span><span class="MJXp-mrow" id="MJXp-Span-492"><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">x</span><span class="MJXp-mrow" id="MJXp-Span-495"><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><script type="math/tex" id="MathJax-Element-31"> y = f（x）</script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">y</span></span></span><script type="math/tex" id="MathJax-Element-32"> y </script> 由 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">x</span></span></span><script type="math/tex" id="MathJax-Element-33"> x </script> 我们将写如何 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-501"><span class="MJXp-mtext" id="MJXp-Span-502">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">c</span><span class="MJXp-mrow" id="MJXp-Span-507"><span class="MJXp-mtext" id="MJXp-Span-508" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-509"><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">y</span></span><span class="MJXp-mrow" id="MJXp-Span-512"><span class="MJXp-mtext" id="MJXp-Span-513" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-514"><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">x</span></span></span></span><script type="math/tex" id="MathJax-Element-34"> \ frac {\部分y} {\部分x} </script>  。 这样的记录强调 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mtext" id="MJXp-Span-518">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">c</span><span class="MJXp-mrow" id="MJXp-Span-523"><span class="MJXp-mtext" id="MJXp-Span-524" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-525"><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">y</span></span><span class="MJXp-mrow" id="MJXp-Span-528"><span class="MJXp-mtext" id="MJXp-Span-529" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-530"><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">x</span></span></span></span><script type="math/tex" id="MathJax-Element-35"> \ frac {\部分y} {\部分x} </script>  -变量之间<i>的变化率</i> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">x</span></span></span><script type="math/tex" id="MathJax-Element-36"> x </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">y</span></span></span><script type="math/tex" id="MathJax-Element-37"> y </script>  。 更具体地说，如果 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">x</span></span></span><script type="math/tex" id="MathJax-Element-38"> x </script> 更改为 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-539"><span class="MJXp-mtext" id="MJXp-Span-540">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">n</span></span></span><script type="math/tex" id="MathJax-Element-39"> \ varepsilon </script> 然后 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">y</span></span></span><script type="math/tex" id="MathJax-Element-40"> y </script> 更改为大约 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mtext" id="MJXp-Span-554">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">n</span><span class="MJXp-mtext" id="MJXp-Span-565">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">c</span><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mtext" id="MJXp-Span-571" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-572"><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">y</span></span><span class="MJXp-mrow" id="MJXp-Span-575"><span class="MJXp-mtext" id="MJXp-Span-576" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-577"><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">x</span></span></span></span><script type="math/tex" id="MathJax-Element-41"> \ varepsilon \ frac {\部分y} {\部分x} </script>  。 您也可以这样写： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">x</span><span class="MJXp-mtext" id="MJXp-Span-582">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">x</span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-595">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">x</span><span class="MJXp-mtext" id="MJXp-Span-602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">y</span><span class="MJXp-mtext" id="MJXp-Span-614">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">w</span><span class="MJXp-mtext" id="MJXp-Span-625" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-626"><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">y</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-630">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">c</span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mtext" id="MJXp-Span-636" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-637"><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">y</span></span><span class="MJXp-mrow" id="MJXp-Span-640"><span class="MJXp-mtext" id="MJXp-Span-641" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-642"><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">x</span></span><span class="MJXp-mtext" id="MJXp-Span-645">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-42"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \大约y + \ frac {\部分y} {\部分x} \ Delta x </script></p><br><p> 读为：“变化 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">x</span></span></span><script type="math/tex" id="MathJax-Element-43"> x </script> 在 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">x</span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-657">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">x</span></span></span><script type="math/tex" id="MathJax-Element-44"> x + \ Delta x </script> 改变 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">y</span></span></span><script type="math/tex" id="MathJax-Element-45"> y </script> 大约在 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">y</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-669">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">x</span><span class="MJXp-mtext" id="MJXp-Span-676">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">c</span><span class="MJXp-mrow" id="MJXp-Span-681"><span class="MJXp-mtext" id="MJXp-Span-682" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-683"><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">y</span></span><span class="MJXp-mrow" id="MJXp-Span-686"><span class="MJXp-mtext" id="MJXp-Span-687" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-688"><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">x</span></span></span></span><script type="math/tex" id="MathJax-Element-46"> y + \ Delta x \ frac {\部分y} {\部分x} </script>  “。这样的记录清楚地凸显了变更之间的联系 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">x</span></span></span><script type="math/tex" id="MathJax-Element-47"> x </script> 并改变 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">y</span></span></span><script type="math/tex" id="MathJax-Element-48"> y </script>  。 </p></div></div><br><p> 我们建立了一个数据流图，让我们运行mse计算： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        #      placeholder (  ) feed_dict = {x: data_points[:,0:2], y: data_points[:,2]} #       TensorFlow session = tf.Session() #     session.run(tf.global_variables_initializer()) #   ()  loss (mse) current_loss = session.run(loss, feed_dict) print(current_loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p> 结果与Numpy相同。 所以他们没有弄错。 </p><br><h4 id="nachnyom-optimizirovat"> 开始优化 </h4><br><p> 不幸的是，无法猜测参数。 但是然后我们： </p><br><ol><li> 我们设置最佳标准-mse的最小值。 </li><li> 确定了可变参数：矢量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> p </script> 与组件 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-697"><span class="MJXp-mrow" id="MJXp-Span-698"><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.278em; margin-right: 0.278em;">一</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50">一</script>  ， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> b </script>  Rosenbrock函数。 </li><li> 我们还没有考虑过限制，但是还没有限制。 </li></ol><br><p> 在最后一步中，我们构造了带有有限<em>损失</em>张量（ <em>损失</em> <em>函数</em> ）的数据流图。 优化的目的是找到参数向量的值 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> p </script> 损失函数的值最小。 我们很幸运，此函数的图形非常简单（凹形且没有局部最小值）： </p><br><img src="https://habrastorage.org/webt/vf/do/hr/vfdohrpseaocd_vpe6e7sp_6f0u.png"><br><p> 优化入门。 首先，我们编写一个广义周期： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># :   mse,   ,  #   mse,        placeholder def train(target_loss, max_steps, loss_tensor, train_step_op, inputs): step = 0 current_loss = session.run(loss_tensor, inputs) #           while current_loss &gt; target_loss and step &lt; max_steps: step += 1 #    1, 2, 4, 8, 16...  if math.log(step, 2).is_integer(): print(f'step: {step}, current loss: {current_loss}') #    session.run(train_step_op, inputs) current_loss = session.run(loss_tensor, inputs) print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}')</span></span></code> </pre> <br><h4 id="optimiziruem-metodom-naiskoreyshego-gradientnogo-spuska-sgd"> 我们通过最快的梯度下降（SGD）方法进行优化 </h4><br><p> 可以将这种方法的动作与骑着大胆的滑雪者相提并论，后者总是放下斜坡（沿最陡的方向）。 在这种情况下，仅考虑该位置的坡度。 如果坡度较大，则滑雪者在下一次更改之前会飞很长一段距离。 坡度较弱时，它会缓慢移动。 也许如何飞走 <del> 进入一棵树 </del>  （ <em>算法发散</em> ），并卡在坑中（ <em>局部最小值</em> ）。 </p><br><img src="https://habrastorage.org/webt/oe/et/ij/oeetijkwervilr42jsjl9wsgsey.jpeg"><br><p> 您可以编写如下（更改 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mtext" id="MJXp-Span-705">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">l</span><span class="MJXp-mrow" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> \ boldsymbol {p} </script> 在 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-mtext" id="MJXp-Span-719">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">l</span><span class="MJXp-mrow" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">p</span></span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> \ boldsymbol {p}-... </script>  ）： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-736"><span class="MJXp-mtext" id="MJXp-Span-737">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">l</span><span class="MJXp-mrow" id="MJXp-Span-748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">p</span></span><span class="MJXp-mtext" id="MJXp-Span-750">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">w</span><span class="MJXp-mtext" id="MJXp-Span-761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">l</span><span class="MJXp-mrow" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">p</span></span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-775">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">a</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-782">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">l</span><span class="MJXp-msubsup" id="MJXp-Span-787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-789" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">s</span><span class="MJXp-mrow" id="MJXp-Span-795"><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-797">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">l</span><span class="MJXp-mrow" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">p</span></span><span class="MJXp-mrow" id="MJXp-Span-810"><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-55"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p}-\ alpha [\ nabla_ {p} loss（\ boldsymbol {p}）] </script></p><br><p> 油腻的 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-813"><span class="MJXp-mtext" id="MJXp-Span-814">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">l</span><span class="MJXp-mrow" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ boldsymbol {p} </script> 强调这是实际位置的点-当前步骤中参数向量的值。 第一步，这是我们的猜测（5，5）。 公式中有两个有趣的地方： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-827"><span class="MJXp-mtext" id="MJXp-Span-828">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ alpha </script>  - <em>学习率</em> （ <em>learning rate</em> ）， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-mtext" id="MJXp-Span-835">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">l</span><span class="MJXp-msubsup" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-842" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-844"><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0.278em; margin-right: 0.278em;">亏</span></span><span class="MJXp-mrow" id="MJXp-Span-846"><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0.278em; margin-right: 0.278em;">损</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> \ nabla_ {p}亏损</script>  -通过参数向量损失函数的<em>梯度</em> （ <em>gradient</em> ）。 </p><br><img src="https://habrastorage.org/webt/qx/1h/em/qx1hem1cns_udmg0gucq1h9vs9k.jpeg"><br><div class="spoiler">  <b class="spoiler_title">渐变（输入的矢量-左数）</b> <div class="spoiler_text"><p> 考虑一个将向量作为输入并产生标量的函数： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">f</span><span class="MJXp-mrow" id="MJXp-Span-850"><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mtext" id="MJXp-Span-852">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">b</span><span class="MJXp-msubsup" id="MJXp-Span-859"><span class="MJXp-mrow" id="MJXp-Span-860" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-862" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-864">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">w</span><span class="MJXp-mtext" id="MJXp-Span-875">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">b</span><span class="MJXp-mrow" id="MJXp-Span-882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">R</span></span></span></span><script type="math/tex" id="MathJax-Element-59"> f：\ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} </script>  。 微分 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">f</span></span></span><script type="math/tex" id="MathJax-Element-60"> f </script> 在这一点上 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">x</span><span class="MJXp-mtext" id="MJXp-Span-888">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">n</span><span class="MJXp-mtext" id="MJXp-Span-891">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">b</span><span class="MJXp-msubsup" id="MJXp-Span-898"><span class="MJXp-mrow" id="MJXp-Span-899" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-901" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-61"> x \ in \ mathbb {R} ^ {N} </script> 现在称为<i>渐变</i> ，是一个向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-905">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">l</span><span class="MJXp-msubsup" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-912" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">f</span><span class="MJXp-mrow" id="MJXp-Span-915"><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">x</span><span class="MJXp-mrow" id="MJXp-Span-918"><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-921">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">n</span><span class="MJXp-mtext" id="MJXp-Span-924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">b</span><span class="MJXp-msubsup" id="MJXp-Span-931"><span class="MJXp-mrow" id="MJXp-Span-932" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-934" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-62"> [\ nabla_ {x} f（x）] \ in \ mathbb {R} ^ {N} </script>  （称为“ nabla”）由<em>偏导数</em>组成： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-936"><span class="MJXp-mtext" id="MJXp-Span-937">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">l</span><span class="MJXp-msubsup" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-944" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">y</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-948"><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-950">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">c</span><span class="MJXp-mrow" id="MJXp-Span-955"><span class="MJXp-mtext" id="MJXp-Span-956" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-957"><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">y</span></span><span class="MJXp-mrow" id="MJXp-Span-960"><span class="MJXp-mtext" id="MJXp-Span-961" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-966" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-967">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-968"><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mtext" id="MJXp-Span-970">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">c</span><span class="MJXp-mrow" id="MJXp-Span-975"><span class="MJXp-mtext" id="MJXp-Span-976" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-977"><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">y</span></span><span class="MJXp-mrow" id="MJXp-Span-980"><span class="MJXp-mtext" id="MJXp-Span-981" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-982"><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-986" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-987">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-988"><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-993"><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mtext" id="MJXp-Span-995">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">c</span><span class="MJXp-mrow" id="MJXp-Span-1000"><span class="MJXp-mtext" id="MJXp-Span-1001" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1002"><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1005"><span class="MJXp-mtext" id="MJXp-Span-1006" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1007"><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1011" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">N</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1013"><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-63"> \ nabla_ {x} y =（\ frac {\部分y} {\部分x_ {1}}，\ frac {\部分y} {\部分x_ {2}}，...，\ frac {\部分y} {\部分x_ {N}}）</script></p><br><p> 在这种情况下，函数更改对参数更改的依赖关系的记录具有以下形式： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">x</span><span class="MJXp-mtext" id="MJXp-Span-1017">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">x</span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1030">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">x</span><span class="MJXp-mtext" id="MJXp-Span-1037">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">y</span><span class="MJXp-mtext" id="MJXp-Span-1049">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">w</span><span class="MJXp-mtext" id="MJXp-Span-1060" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-1061"><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">y</span><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1065">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">l</span><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">y</span><span class="MJXp-mtext" id="MJXp-Span-1075">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">t</span><span class="MJXp-mtext" id="MJXp-Span-1080">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-64"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \大约y + \ nabla_ {x} y \ cdot \ Delta x </script></p><br><p> 记录已发生很大变化，以考虑到 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">x</span></span></span><script type="math/tex" id="MathJax-Element-65"> x </script>  ， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1089"><span class="MJXp-mtext" id="MJXp-Span-1090">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">x</span></span></span><script type="math/tex" id="MathJax-Element-66"> \ Delta x </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1097"><span class="MJXp-mtext" id="MJXp-Span-1098">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">l</span><span class="MJXp-msubsup" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1105" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">y</span></span></span><script type="math/tex" id="MathJax-Element-67"> \ nabla_ {x} y </script>  -中的向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1108"><span class="MJXp-mtext" id="MJXp-Span-1109">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">b</span><span class="MJXp-msubsup" id="MJXp-Span-1116"><span class="MJXp-mrow" id="MJXp-Span-1117" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1119" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-68"> \ mathbb {R} ^ {N} </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">y</span></span></span><script type="math/tex" id="MathJax-Element-69"> y </script>  -标量。 向量相乘时 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1123"><span class="MJXp-mtext" id="MJXp-Span-1124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">l</span><span class="MJXp-msubsup" id="MJXp-Span-1129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1131" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">y</span></span></span><script type="math/tex" id="MathJax-Element-70"> \ nabla_ {x} y </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1134"><span class="MJXp-mtext" id="MJXp-Span-1135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">x</span></span></span><script type="math/tex" id="MathJax-Element-71"> \ Delta x </script> 使用<i>标量乘积</i> （组件乘积的总和）。 </p></div></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        grad = tf.gradients(loss, p)[0] #   learning_rate = 0.0005 #   ,     apply_gradients - #         opt = tf.train.GradientDescentOptimizer(learning_rate=1) #           sgd = opt.apply_gradients([(learning_rate*grad, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, sgd, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 1381.5379689135807 [...] ENDED ON STEP: 582, FINAL LOSS: 9.698531012270816e-11 PARAMETERS: [2.50000205 2.49999959]</code> </pre> <br><p> 采取了582个步骤： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/j3/jb/b2j3jbxzfk6_ll66vpr83vklwjs.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">朝反梯度方向运动</b> <div class="spoiler_text"><p> 为什么我们朝与梯度相反的方向移动？ 调用标量乘积的条目： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">x</span><span class="MJXp-mtext" id="MJXp-Span-1144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">x</span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">x</span><span class="MJXp-mtext" id="MJXp-Span-1164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">y</span><span class="MJXp-mtext" id="MJXp-Span-1176">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">w</span><span class="MJXp-mtext" id="MJXp-Span-1187" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-1188"><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">y</span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">l</span><span class="MJXp-msubsup" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1199" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">y</span><span class="MJXp-mtext" id="MJXp-Span-1202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">t</span><span class="MJXp-mtext" id="MJXp-Span-1207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">x</span></span></span><script type="math/tex" id="MathJax-Element-72"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \大约y + \ nabla_ {x} y \ cdot \ Delta x </script>  。 最小化 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">y</span></span></span><script type="math/tex" id="MathJax-Element-73"> y </script>  。 由于函数的行为仅在很小的范围内通过导数知道，因此有必要以小的但最佳的步骤移动，以使乘积最小 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1216"><span class="MJXp-mtext" id="MJXp-Span-1217">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">l</span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1224" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">y</span><span class="MJXp-mtext" id="MJXp-Span-1227">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">t</span><span class="MJXp-mtext" id="MJXp-Span-1232">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">x</span></span></span><script type="math/tex" id="MathJax-Element-74"> \ nabla_ {x} y \ cdot \ Delta x </script>  。 按照学校的定义， <i>两个向量</i>的<i>标量乘积等于这些向量的长度乘以它们之间夹角的余弦的乘积</i> ： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">a</span><span class="MJXp-mtext" id="MJXp-Span-1241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">b</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1248" style="color: red;">\左</span><span class="MJXp-mrow" id="MJXp-Span-1249"><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">a</span><span class="MJXp-mtext" id="MJXp-Span-1252" style="color: red;">\右</span><span class="MJXp-mrow" id="MJXp-Span-1253"><span class="MJXp-mo" id="MJXp-Span-1254" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1255" style="color: red;">\左</span><span class="MJXp-mrow" id="MJXp-Span-1256"><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">b</span><span class="MJXp-mtext" id="MJXp-Span-1259" style="color: red;">\右</span><span class="MJXp-mrow" id="MJXp-Span-1260"><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">s</span><span class="MJXp-mtext" id="MJXp-Span-1265" style="color: red;">\角</span><span class="MJXp-mrow" id="MJXp-Span-1266"><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">a</span><span class="MJXp-mrow" id="MJXp-Span-1269"><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">b</span><span class="MJXp-mrow" id="MJXp-Span-1272"><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><script type="math/tex" id="MathJax-Element-75"> a \ cdot b = \左| a \右| \左| b \右| cos \角（a，b）</script>  。 对于固定长度的向量，此乘积的最小余弦值为-1，即 当向量指向相反方向时，它们之间的夹角为180度。 因此，最小标量积 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mtext" id="MJXp-Span-1275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">l</span><span class="MJXp-msubsup" id="MJXp-Span-1280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1282" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">y</span><span class="MJXp-mtext" id="MJXp-Span-1285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">t</span><span class="MJXp-mtext" id="MJXp-Span-1290">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">x</span></span></span><script type="math/tex" id="MathJax-Element-76"> \ nabla_ {x} y \ cdot \ Delta x </script> 何时达到 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1297"><span class="MJXp-mtext" id="MJXp-Span-1298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">x</span></span></span><script type="math/tex" id="MathJax-Element-77"> \ Delta x </script> 在<i>反梯度</i>的方向。 </p></div></div><br><h4 id="optimiziruem-metodom-adam"> 我们用亚当方法进行优化 </h4><br><p> 我们将不进一步介绍梯度方法，但是会有很多变化。 您可以在文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">优化神经网络的方法中</a>阅读它们。 在TensorFlow中，已经实现了许多优化器。 例如，亚当： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       , #      adm = tf.train.AdamOptimizer(15).minimize(loss) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, adm, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 34205.72916492336 [...] ENDED ON STEP: 317, FINAL LOSS: 2.424142714263483e-12 PARAMETERS: [2.49999969 2.50000008]</code> </pre> <br><p> 分317个步骤进行管理。 快得多。 </p><br><h4 id="optimiziruem-metodom-nyutona"> 我们用牛顿法进行优化 </h4><br><p> 可以将二阶方法的作用与骑有理性的随心所欲的滑雪者进行比较，后者可以长时间考虑路线的下一个点，不仅要考虑位置的坡度，还要考虑曲率。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p_/iu/kf/p_iukfzoa0idjm_cbycfmlye4mw.jpeg"></div><br><p> 实际上，梯度下降法和二阶方法都试图猜测（ <em>近似</em> ）当前点的函数。 梯度方法仅关注函数图在一阶导数上的<em>斜率</em> 。 除了偏度以外，二阶方法还考虑了<em>曲率</em> ，二阶导数：“如果曲率持续存在，那么最小值将在哪里？” 我们计算并去那里： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xb/sn/nb/xbsnnb1o5cui4x10wspkrgjinaw.jpeg"></div><br><p> 要构造这样的近似值并计算估计的最小点，可以使用<em>泰勒级数</em> 。 对于一维情况，在点处通过二阶多项式近似 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1305"><span class="MJXp-mrow" id="MJXp-Span-1306"><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0.278em; margin-right: 0.278em;">一</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78">一</script> 看起来像这样： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">f</span><span class="MJXp-mrow" id="MJXp-Span-1362"><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">x</span><span class="MJXp-mrow" id="MJXp-Span-1365"><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1367" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-1368"><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">f</span><span class="MJXp-mrow" id="MJXp-Span-1371"><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">a</span><span class="MJXp-mrow" id="MJXp-Span-1374"><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1377">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">c</span><span class="MJXp-mrow" id="MJXp-Span-1382"><span class="MJXp-msup" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1385" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-1386"><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">a</span><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-1391"><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">x</span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">a</span><span class="MJXp-mrow" id="MJXp-Span-1396"><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1398"><span class="MJXp-mn" id="MJXp-Span-1399">1</span><span class="MJXp-mrow" id="MJXp-Span-1400"><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0.278em; margin-right: 0.278em;">！</span></span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1403">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">c</span><span class="MJXp-mrow" id="MJXp-Span-1408"><span class="MJXp-msup" id="MJXp-Span-1409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1411" style="vertical-align: 0.5em;">″</span></span><span class="MJXp-mrow" id="MJXp-Span-1412"><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">a</span><span class="MJXp-mrow" id="MJXp-Span-1415"><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-1417"><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">x</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">a</span><span class="MJXp-msubsup" id="MJXp-Span-1422"><span class="MJXp-mrow" id="MJXp-Span-1423" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1425" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1426"><span class="MJXp-mn" id="MJXp-Span-1427">2</span><span class="MJXp-mrow" id="MJXp-Span-1428"><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0.278em; margin-right: 0.278em;">！</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> f（x）\大约f（a）+ \ frac {f'（a）（x-a）} {1！} + \ frac {f''（a）（x-a）^ 2} {2！} </script></p><br><p> 最低达到 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">x</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">a</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1435">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">c</span><span class="MJXp-mrow" id="MJXp-Span-1440"><span class="MJXp-msup" id="MJXp-Span-1441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1443" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-1444"><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">a</span><span class="MJXp-mrow" id="MJXp-Span-1447"><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1449"><span class="MJXp-msup" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1452" style="vertical-align: 0.5em;">″</span></span><span class="MJXp-mrow" id="MJXp-Span-1453"><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">a</span><span class="MJXp-mrow" id="MJXp-Span-1456"><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> x = a-\ frac {f'（a）} {f''（a）} </script>  。 多维案例看起来更严重： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/pd/31/dvpd31r1vt2cbts_a5oamiiwgoc.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">黑森州矩阵（输入的矢量-左数）</b> <div class="spoiler_text"><p>  <em>黑森州矩阵</em>是由二阶导数组成的方阵： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1458"><span class="MJXp-mtext" id="MJXp-Span-1459">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">l</span><span class="MJXp-mrow" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1474" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1477" style="color: red;">\开</span><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0.278em; margin-right: 0.278em;">始</span></span><span class="MJXp-mrow" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1488">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">c</span><span class="MJXp-mrow" id="MJXp-Span-1493"><span class="MJXp-mtext" id="MJXp-Span-1494" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1495"><span class="MJXp-mrow" id="MJXp-Span-1496" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1498" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1500"><span class="MJXp-mtext" id="MJXp-Span-1501" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1502"><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1507">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1506">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1508"><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1510">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">c</span><span class="MJXp-mrow" id="MJXp-Span-1515"><span class="MJXp-mtext" id="MJXp-Span-1516" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1517"><span class="MJXp-mrow" id="MJXp-Span-1518" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1520" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1522"><span class="MJXp-mtext" id="MJXp-Span-1523" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1524"><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1528" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mtext" id="MJXp-Span-1529" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1530"><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1534" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1535"><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">s</span><span class="MJXp-mrow" id="MJXp-Span-1543"><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1545">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">c</span><span class="MJXp-mrow" id="MJXp-Span-1550"><span class="MJXp-mtext" id="MJXp-Span-1551" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1552"><span class="MJXp-mrow" id="MJXp-Span-1553" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1555" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1557"><span class="MJXp-mtext" id="MJXp-Span-1558" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1559"><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1563" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mtext" id="MJXp-Span-1564" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1565"><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1569" style="vertical-align: -0.4em;">N</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1570" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1571">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">c</span><span class="MJXp-mrow" id="MJXp-Span-1576"><span class="MJXp-mtext" id="MJXp-Span-1577" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1578"><span class="MJXp-mrow" id="MJXp-Span-1579" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1581" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mtext" id="MJXp-Span-1584" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1585"><span class="MJXp-mo" id="MJXp-Span-1586" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1589" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1590" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1591"><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1595" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1596"><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1598">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">c</span><span class="MJXp-mrow" id="MJXp-Span-1603"><span class="MJXp-mtext" id="MJXp-Span-1604" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mrow" id="MJXp-Span-1606" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1608" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1610"><span class="MJXp-mtext" id="MJXp-Span-1611" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1612"><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1617">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1616">2</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1618"><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">s</span><span class="MJXp-mrow" id="MJXp-Span-1626"><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">c</span><span class="MJXp-mrow" id="MJXp-Span-1633"><span class="MJXp-mtext" id="MJXp-Span-1634" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1635"><span class="MJXp-mrow" id="MJXp-Span-1636" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1638" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1640"><span class="MJXp-mtext" id="MJXp-Span-1641" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1642"><span class="MJXp-mo" id="MJXp-Span-1643" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1646" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1647" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1648"><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1652" style="vertical-align: -0.4em;">N</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1653" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1654">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">s</span><span class="MJXp-mrow" id="MJXp-Span-1660"><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">s</span><span class="MJXp-mrow" id="MJXp-Span-1668"><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1670">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">s</span><span class="MJXp-mrow" id="MJXp-Span-1676"><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1678">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">s</span><span class="MJXp-mspace" id="MJXp-Span-1684" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1685">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">c</span><span class="MJXp-mrow" id="MJXp-Span-1690"><span class="MJXp-mtext" id="MJXp-Span-1691" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1692"><span class="MJXp-mrow" id="MJXp-Span-1693" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1695" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1697"><span class="MJXp-mtext" id="MJXp-Span-1698" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1699"><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1703" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1704" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1705"><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1709" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1710"><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0.278em; margin-right: 0.278em;">和</span></span><span class="MJXp-mtext" id="MJXp-Span-1712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">c</span><span class="MJXp-mrow" id="MJXp-Span-1717"><span class="MJXp-mtext" id="MJXp-Span-1718" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1719"><span class="MJXp-mrow" id="MJXp-Span-1720" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1722" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1724"><span class="MJXp-mtext" id="MJXp-Span-1725" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1726"><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1730" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1731" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1736" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1737"><span class="MJXp-mo" id="MJXp-Span-1738" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1739">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">s</span><span class="MJXp-mrow" id="MJXp-Span-1745"><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-1747">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">c</span><span class="MJXp-mrow" id="MJXp-Span-1752"><span class="MJXp-mtext" id="MJXp-Span-1753" style="color: red;">\部</span><span class="MJXp-msubsup" id="MJXp-Span-1754"><span class="MJXp-mrow" id="MJXp-Span-1755" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1757" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1759"><span class="MJXp-mtext" id="MJXp-Span-1760" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1761"><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1766">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">N</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1767" style="color: red;">\结</span><span class="MJXp-mrow" id="MJXp-Span-1768"><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0.278em; margin-right: 0.278em;">束</span></span><span class="MJXp-mrow" id="MJXp-Span-1770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">x</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-81"> \ boldsymbol {H} y_ {x} = \开始{bmatrix} \ frac {\部分^ 2y} {\部分x_1 ^ 2}＆\ frac {\部分^ 2y} {\部分x_1 \部分x_2}＆\ cdots＆\ frac {\部分^ 2y} {\部分x_1 \部分x_N} \\ \ frac {\部分^ 2y} {\部分x_2 \部分x_1}＆\ frac {\部分^ 2y} {\部分x_2 ^ 2}＆\ cdots＆\ frac {\部分^ 2y} {\部分x_2 \部分x_N} \\ \ vdots＆\ vdots＆\ ddots＆\ vdots \\ \ frac {\部分^ 2y} {\部分x_N \部分x_1}和\ frac {\部分^ 2y} {\部分x_N \部分x_2}＆\ cdots＆\ frac {\部分^ 2y} {\部分x_N ^ 2} \结束{bmatrix} </script></p></div></div><br><p> 通过梯度和Hessian矩阵对向量函数的二阶多项式的逼近 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1778"><span class="MJXp-mrow" id="MJXp-Span-1779"><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.278em; margin-right: 0.278em;">一</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82">一</script> 看起来像这样： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">f</span><span class="MJXp-mrow" id="MJXp-Span-1783"><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">x</span><span class="MJXp-mrow" id="MJXp-Span-1786"><span class="MJXp-mo" id="MJXp-Span-1787" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1788" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-1789"><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">f</span><span class="MJXp-mrow" id="MJXp-Span-1792"><span class="MJXp-mo" id="MJXp-Span-1793" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">a</span><span class="MJXp-mrow" id="MJXp-Span-1795"><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1798"><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">a</span><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mrow" id="MJXp-Span-1803" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1805" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">l</span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1815">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">l</span><span class="MJXp-msubsup" id="MJXp-Span-1820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1822" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">f</span><span class="MJXp-mrow" id="MJXp-Span-1825"><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">a</span><span class="MJXp-mrow" id="MJXp-Span-1828"><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1832">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">c</span><span class="MJXp-mrow" id="MJXp-Span-1837"><span class="MJXp-mn" id="MJXp-Span-1838">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1839"><span class="MJXp-mn" id="MJXp-Span-1840">2</span><span class="MJXp-mrow" id="MJXp-Span-1841"><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0.278em; margin-right: 0.278em;">！</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1843"><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">a</span><span class="MJXp-msubsup" id="MJXp-Span-1847"><span class="MJXp-mrow" id="MJXp-Span-1848" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1850" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">l</span><span class="MJXp-mo" id="MJXp-Span-1859" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">l</span><span class="MJXp-mrow" id="MJXp-Span-1871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1875" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">x</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1877"><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">a</span><span class="MJXp-mrow" id="MJXp-Span-1880"><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mrow" id="MJXp-Span-1883"><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">a</span><span class="MJXp-mrow" id="MJXp-Span-1887"><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-83"> f（x）\大约f（a）+（xa）^ \ intercal [\ nabla_ {x} f（a）] + \ frac {1} {2！}（xa）^ \ intercal [\ boldsymbol {H } f_ {x}（a）]（xa）</script></p><br><p> 最低达到 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">x</span><span class="MJXp-mo" id="MJXp-Span-1891" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">a</span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1894" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1895" style="color: red;">\粗</span><span class="MJXp-mrow" id="MJXp-Span-1896"><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0.278em; margin-right: 0.278em;">体</span></span><span class="MJXp-mrow" id="MJXp-Span-1898"><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0.278em; margin-right: 0.278em;">符</span></span><span class="MJXp-mrow" id="MJXp-Span-1900"><span class="MJXp-mo" id="MJXp-Span-1901" style="margin-left: 0.278em; margin-right: 0.278em;">号</span></span><span class="MJXp-mrow" id="MJXp-Span-1902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1906" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">x</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1908"><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">a</span><span class="MJXp-mrow" id="MJXp-Span-1911"><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-1913"><span class="MJXp-mo" id="MJXp-Span-1914" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1915" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1916">−</span><span class="MJXp-mn" id="MJXp-Span-1917">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1919">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">l</span><span class="MJXp-msubsup" id="MJXp-Span-1924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1926" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">f</span><span class="MJXp-mrow" id="MJXp-Span-1929"><span class="MJXp-mo" id="MJXp-Span-1930" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">a</span><span class="MJXp-mrow" id="MJXp-Span-1932"><span class="MJXp-mo" id="MJXp-Span-1933" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> x = a-[\粗体符号{H} f_ {x}（a）] ^ {-1} [\ nabla_ {x} f（a）] </script>  。 形状实际上与一维情况相符：我们将一阶导数替换为梯度，将二阶导数替换为Hessian矩阵，并进行了校正以处理向量。 将向量除以矩阵是不可能的，因此，使用乘以<em>逆</em>矩阵。  <em>T</em>表示<em>移调</em> 。 该公式暗示默认情况下，向量是一列。 转置将<em>列</em> <em>向量</em>转换<em>为行向量</em> 。 在TensorFlow上实现时，应将其考虑在内，但方向相反：默认情况下，向量为字符串（一维张量）。 以防万一：换位不是90度的旋转，它是将行以相同顺序转换为列。 </p><br><p> 因此，牛顿法的步骤具有以下形式： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1935"><span class="MJXp-mtext" id="MJXp-Span-1936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">l</span><span class="MJXp-mrow" id="MJXp-Span-1947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">p</span></span><span class="MJXp-mtext" id="MJXp-Span-1949">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">w</span><span class="MJXp-mtext" id="MJXp-Span-1960">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">l</span><span class="MJXp-mrow" id="MJXp-Span-1971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">p</span></span><span class="MJXp-mo" id="MJXp-Span-1973" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1974" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1975">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">l</span><span class="MJXp-mrow" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">H</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">s</span><span class="MJXp-msubsup" id="MJXp-Span-1991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1993" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1995"><span class="MJXp-mo" id="MJXp-Span-1996" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-1997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">l</span><span class="MJXp-mrow" id="MJXp-Span-2008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">p</span></span><span class="MJXp-mrow" id="MJXp-Span-2010"><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-2012"><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2014" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2015">−</span><span class="MJXp-mn" id="MJXp-Span-2016">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-2018">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">l</span><span class="MJXp-msubsup" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2025" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">s</span><span class="MJXp-mrow" id="MJXp-Span-2031"><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-2033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">l</span><span class="MJXp-mrow" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">p</span></span><span class="MJXp-mrow" id="MJXp-Span-2046"><span class="MJXp-mo" id="MJXp-Span-2047" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-85"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p}-[\ boldsymbol {H} loss_ {p}（\ boldsymbol {p}）] ^ {-1} [\ nabla_ {p} loss（\ boldsymbol {p} ）] </script></p><br><p>  TensorFlow具有实现此方法的所有功能： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        hess = tf.hessians(loss, p)[0] #    - grad_col = tf.expand_dims(grad, -1) # ,      dp = tf.matmul(tf.linalg.inv(hess), grad_col) #  -  - dp = tf.squeeze(dp) #  p  dp    newton = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, newton, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 105.04357496954218 step: 4, current loss: 9.96663526704236 ENDED ON STEP: 6, FINAL LOSS: 5.882202372519996e-20 PARAMETERS: [2.5 2.5]</code> </pre> <br><p> 足够的6个步骤： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/to/4-/eo/to4-eorewt5uoh_sdhokzqx0kuq.jpeg"></div><br><h4 id="optimiziruem-algoritmom-gaussa-nyutona"> 通过高斯-牛顿算法进行优化 </h4><br><p> 牛顿法有一个缺点-黑森矩阵。 感谢TensorFlow，我们可以在一行代码中对其进行计数。 根据维基百科， <em>约翰·卡尔·弗里德里希·高斯</em> （ <em>Johann Karl Friedrich Gauss）</em>于1809年首次提及他的方法。 最小二乘法的几个参数的Hessian矩阵的计算将花费大量时间。 现在我们可以假设高斯-牛顿算法使用<em>黑森</em> <em>矩阵</em>到<em>雅可比矩阵</em>的近似来简化计算。 但是从历史的角度来看，情况并非如此： <em>路德维希·奥托·黑塞</em> （ <em>Ludwig Otto Hesse</em> ，以他的名字命名的矩阵的开发者）出生于1811年-第一次提到算法后的第二年。  <em>卡尔·古斯塔夫·雅各比</em> （ <em>Carl Gustav Jacobi</em> ）5岁。 </p><br><p> 高斯-牛顿算法不适用于损失函数。 与<em>残差功能一起使用</em> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050">r</span><span class="MJXp-mrow" id="MJXp-Span-2051"><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">p</span><span class="MJXp-mrow" id="MJXp-Span-2054"><span class="MJXp-mo" id="MJXp-Span-2055" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> r（p）</script>  。 此函数采用参数的输入向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> p </script> 并返回<em>残差矢量</em> 。 在我们的例子中，向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> p </script> 由2个组成部分（参数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2060"><span class="MJXp-mrow" id="MJXp-Span-2061"><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0.278em; margin-right: 0.278em;">一</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89">一</script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> b </script>  Rosenbrock函数），以及来自 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> m </script> 组件（根据实验数量）。 获得vector参数的vector函数。 其派生词： </p><br><div class="spoiler">  <b class="spoiler_title">Jacobi矩阵（已输入向量-已释放向量）</b> <div class="spoiler_text"><p> 考虑一个以向量为输入并产生向量的函数： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">f</span><span class="MJXp-mrow" id="MJXp-Span-2069"><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mtext" id="MJXp-Span-2071">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">b</span><span class="MJXp-msubsup" id="MJXp-Span-2078"><span class="MJXp-mrow" id="MJXp-Span-2079" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2081" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2083">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2085">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">w</span><span class="MJXp-mtext" id="MJXp-Span-2094">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">b</span><span class="MJXp-msubsup" id="MJXp-Span-2101"><span class="MJXp-mrow" id="MJXp-Span-2102" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2104" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">M</span></span></span></span></span><script type="math/tex" id="MathJax-Element-92"> f：\ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} ^ {M} </script>  。 微分 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">f</span></span></span><script type="math/tex" id="MathJax-Element-93"> f </script> 在这一点上 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">x</span></span></span><script type="math/tex" id="MathJax-Element-94"> x </script> 现在有大小 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">N</span><span class="MJXp-mtext" id="MJXp-Span-2112" style="color: red;">\乘</span><span class="MJXp-mrow" id="MJXp-Span-2113"><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0.278em; margin-right: 0.278em;">以</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">M</span></span></span><script type="math/tex" id="MathJax-Element-95"> N \乘以M </script>  ，称为<i>Jacobi矩阵</i> ，由偏导数的所有组合组成： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2116"><span class="MJXp-mtext" id="MJXp-Span-2117">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">l</span><span class="MJXp-mrow" id="MJXp-Span-2128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2132" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-2134" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2135" style="color: red;">\开</span><span class="MJXp-mrow" id="MJXp-Span-2136"><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0.278em; margin-right: 0.278em;">始</span></span><span class="MJXp-mrow" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">x</span></span><span class="MJXp-mtext" id="MJXp-Span-2146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">c</span><span class="MJXp-mrow" id="MJXp-Span-2151"><span class="MJXp-mtext" id="MJXp-Span-2152" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2153"><span class="MJXp-mo" id="MJXp-Span-2154" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2157" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2158">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2159"><span class="MJXp-mtext" id="MJXp-Span-2160" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2161"><span class="MJXp-mo" id="MJXp-Span-2162" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2165" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2166">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2167"><span class="MJXp-mo" id="MJXp-Span-2168" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-2169">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">s</span><span class="MJXp-mrow" id="MJXp-Span-2175"><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0.278em; margin-right: 0.278em;">和</span></span><span class="MJXp-mtext" id="MJXp-Span-2177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2178">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">c</span><span class="MJXp-mrow" id="MJXp-Span-2182"><span class="MJXp-mtext" id="MJXp-Span-2183" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2184"><span class="MJXp-mo" id="MJXp-Span-2185" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2188" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2189">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2190"><span class="MJXp-mtext" id="MJXp-Span-2191" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2192"><span class="MJXp-mo" id="MJXp-Span-2193" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2196" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">N</span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-2198" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">s</span><span class="MJXp-mrow" id="MJXp-Span-2205"><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-2207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2208">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">s</span><span class="MJXp-mrow" id="MJXp-Span-2213"><span class="MJXp-mo" id="MJXp-Span-2214" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-2215">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">s</span><span class="MJXp-mspace" id="MJXp-Span-2221" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">c</span><span class="MJXp-mrow" id="MJXp-Span-2227"><span class="MJXp-mtext" id="MJXp-Span-2228" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2229"><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2233" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">M</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2235"><span class="MJXp-mtext" id="MJXp-Span-2236" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2237"><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2241" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2242">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2243"><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-2245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">s</span><span class="MJXp-mrow" id="MJXp-Span-2251"><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0.278em; margin-right: 0.278em;">＆</span></span><span class="MJXp-mtext" id="MJXp-Span-2253">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2254">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">c</span><span class="MJXp-mrow" id="MJXp-Span-2258"><span class="MJXp-mtext" id="MJXp-Span-2259" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2260"><span class="MJXp-mo" id="MJXp-Span-2261" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2264" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">M</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2266"><span class="MJXp-mtext" id="MJXp-Span-2267" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2268"><span class="MJXp-mo" id="MJXp-Span-2269" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">N</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2274" style="color: red;">\结</span><span class="MJXp-mrow" id="MJXp-Span-2275"><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0.278em; margin-right: 0.278em;">束</span></span><span class="MJXp-mrow" id="MJXp-Span-2277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">x</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-96"> \ boldsymbol {J} y_ {x} = \开始{pmatrix} \ frac {\部分y_ {1}} {\部分x_ {1}}＆\ cdots和\ frac {\部分y_ {1}} {\部分x_ {N}} \\ \ vdots＆\ ddots＆\ vdots \\ \ frac {\部分y_ {M}} {\部分x_ {1}}＆\ cdots＆\ frac {\部分y_ {M}} {\部分x_ {N}} \结束{pmatrix} </script></p><br><p> 您可能会注意到<i>Jacobi矩阵</i>的行是分量的<i>梯度</i> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">y</span></span></span><script type="math/tex" id="MathJax-Element-97"> y </script>  。 项 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2287"><span class="MJXp-mrow" id="MJXp-Span-2288"><span class="MJXp-mo" id="MJXp-Span-2289" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290">i</span><span class="MJXp-mrow" id="MJXp-Span-2291"><span class="MJXp-mo" id="MJXp-Span-2292" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">j</span><span class="MJXp-mrow" id="MJXp-Span-2294"><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><script type="math/tex" id="MathJax-Element-98">（i，j）</script> 矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-mtext" id="MJXp-Span-2297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2299">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">c</span><span class="MJXp-mrow" id="MJXp-Span-2302"><span class="MJXp-mtext" id="MJXp-Span-2303" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2304"><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306">y</span></span><span class="MJXp-mrow" id="MJXp-Span-2307"><span class="MJXp-mtext" id="MJXp-Span-2308" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2309"><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">x</span></span></span></span><script type="math/tex" id="MathJax-Element-99"> \ frac {\部分y} {\部分x} </script> 等于 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2312"><span class="MJXp-mtext" id="MJXp-Span-2313">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317">c</span><span class="MJXp-mrow" id="MJXp-Span-2318"><span class="MJXp-mtext" id="MJXp-Span-2319" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2320"><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2324" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">i</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2326"><span class="MJXp-mtext" id="MJXp-Span-2327" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-2328"><span class="MJXp-mo" id="MJXp-Span-2329" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-2330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2332" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">j</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-100"> \ frac {\部分y_ {i}} {\部分x_ {j}} </script> 告诉我们会有多少变化 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-msubsup" id="MJXp-Span-2335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2337" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-101"> y_ {i} </script> 改变时 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2339"><span class="MJXp-msubsup" id="MJXp-Span-2340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2342" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-102"> x_ {j} </script> 值很小。 与以前的情况一样，您可以编写： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">x</span><span class="MJXp-mtext" id="MJXp-Span-2346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2352">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2355">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">x</span><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">x</span><span class="MJXp-mtext" id="MJXp-Span-2366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2376">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">y</span><span class="MJXp-mtext" id="MJXp-Span-2378">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2387">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">w</span><span class="MJXp-mtext" id="MJXp-Span-2389" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-2390"><span class="MJXp-mo" id="MJXp-Span-2391" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">y</span><span class="MJXp-mo" id="MJXp-Span-2393" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2394">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404">l</span><span class="MJXp-mrow" id="MJXp-Span-2405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2409" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-103"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \大约y + \ boldsymbol {J} y_ {x} \ Delta x </script></p><br><p> 在这里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2418"><span class="MJXp-mtext" id="MJXp-Span-2419">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2421">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2427">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429">l</span><span class="MJXp-mrow" id="MJXp-Span-2430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2434" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">x</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104"> \ boldsymbol {J} y_ {x} </script> 矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">N</span><span class="MJXp-mtext" id="MJXp-Span-2438" style="color: red;">\乘</span><span class="MJXp-mrow" id="MJXp-Span-2439"><span class="MJXp-mo" id="MJXp-Span-2440" style="margin-left: 0.278em; margin-right: 0.278em;">以</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441">M</span></span></span><script type="math/tex" id="MathJax-Element-105"> N \乘以M </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2442"><span class="MJXp-mtext" id="MJXp-Span-2443">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2447">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">x</span></span></span><script type="math/tex" id="MathJax-Element-106"> \ Delta x </script> 大小向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">N</span></span></span><script type="math/tex" id="MathJax-Element-107"> N </script> 因此产品 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2452"><span class="MJXp-mtext" id="MJXp-Span-2453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2456">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">l</span><span class="MJXp-mrow" id="MJXp-Span-2464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2468" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2473">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">x</span></span></span><script type="math/tex" id="MathJax-Element-108"> \ boldsymbol {J} y_ {x} \ Delta x </script> 是矩阵与向量的乘积，结果是大小为向量的向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中号</font></font></span></span></span><script type="math/tex" id="MathJax-Element-109"> M </script>  。 </p></div></div><br><p> 为了不使字符过多而感到困惑，我们假设 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-mtext" id="MJXp-Span-2480">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">l</span><span class="MJXp-msubsup" id="MJXp-Span-2491"><span class="MJXp-mrow" id="MJXp-Span-2492" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2494" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110"> \ boldsymbol {J} _ {r} </script>  -当前点的残差函数的Jacobi矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2496"><span class="MJXp-mtext" id="MJXp-Span-2497">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2501">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2504">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">l</span><span class="MJXp-mrow" id="MJXp-Span-2508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111"> \ boldsymbol {p} </script>  。 然后可以将Gauss-Newton算法编写如下： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2510"><span class="MJXp-mtext" id="MJXp-Span-2511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">l</span><span class="MJXp-mrow" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">p</span></span><span class="MJXp-mtext" id="MJXp-Span-2524">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2530">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">w</span><span class="MJXp-mtext" id="MJXp-Span-2535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2536">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2543">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545">l</span><span class="MJXp-mrow" id="MJXp-Span-2546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">p</span></span><span class="MJXp-mo" id="MJXp-Span-2548" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-2549" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-2550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2552">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2557">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2559">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560">l</span><span class="MJXp-msubsup" id="MJXp-Span-2561"><span class="MJXp-mrow" id="MJXp-Span-2562" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2566">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2568">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2571">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574">l</span><span class="MJXp-mtext" id="MJXp-Span-2575">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2576">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2577">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2583">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585">l</span><span class="MJXp-msubsup" id="MJXp-Span-2586"><span class="MJXp-mrow" id="MJXp-Span-2587" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2588">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2589" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2591"><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2593" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2594">−</span><span class="MJXp-mn" id="MJXp-Span-2595">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2596">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2602">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606">l</span><span class="MJXp-msubsup" id="MJXp-Span-2607"><span class="MJXp-mrow" id="MJXp-Span-2608" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2612">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2611">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2613">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2617">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621">r</span><span class="MJXp-mrow" id="MJXp-Span-2622"><span class="MJXp-mo" id="MJXp-Span-2623" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-2624" style="color: red;">\粗</span><span class="MJXp-mrow" id="MJXp-Span-2625"><span class="MJXp-mo" id="MJXp-Span-2626" style="margin-left: 0.278em; margin-right: 0.278em;">体</span></span><span class="MJXp-mrow" id="MJXp-Span-2627"><span class="MJXp-mo" id="MJXp-Span-2628" style="margin-left: 0.278em; margin-right: 0.278em;">符</span></span><span class="MJXp-mrow" id="MJXp-Span-2629"><span class="MJXp-mo" id="MJXp-Span-2630" style="margin-left: 0.278em; margin-right: 0.278em;">号</span></span><span class="MJXp-mrow" id="MJXp-Span-2631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">p</span></span><span class="MJXp-mrow" id="MJXp-Span-2633"><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-112"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p}-[\ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r}] ^ {-1} \ boldsymbol {J} _ {r } ^ \ intercal r（\粗体符号{p}）</script></p><br><p> 形式的记录与牛顿方法的记录完全一致。 仅代替黑森州矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2635"><span class="MJXp-mtext" id="MJXp-Span-2636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2640">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2641">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2642">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646">l</span><span class="MJXp-msubsup" id="MJXp-Span-2647"><span class="MJXp-mrow" id="MJXp-Span-2648" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2649">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2652">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2651">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2654">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">l</span><span class="MJXp-mtext" id="MJXp-Span-2661">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2663">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2664">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2668">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">l</span><span class="MJXp-msubsup" id="MJXp-Span-2672"><span class="MJXp-mrow" id="MJXp-Span-2673" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2674">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2675" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> \ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r} </script> 而不是渐变 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2677"><span class="MJXp-mtext" id="MJXp-Span-2678">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2679">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2681">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2682">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2686">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688">l</span><span class="MJXp-msubsup" id="MJXp-Span-2689"><span class="MJXp-mrow" id="MJXp-Span-2690" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2694">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2697">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703">r</span><span class="MJXp-mrow" id="MJXp-Span-2704"><span class="MJXp-mo" id="MJXp-Span-2705" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-2706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2710">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2712">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2713">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2714">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2715">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2716">l</span><span class="MJXp-mrow" id="MJXp-Span-2717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">p</span></span><span class="MJXp-mrow" id="MJXp-Span-2719"><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> \ boldsymbol {J} _ {r} ^ \ intercal r（\ boldsymbol {p}）</script>  。 接下来，我们将了解为什么可以使用这种近似。 同时，让我们继续在TensorFlow上实施： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,  TensorFlow     , #   ,        #  .  ,   : # 1)       tf.unstack(r) # 2)      tf.gradients(r_i, p) # 3)       tf.stack #      ,     #       j = tf.stack([tf.gradients(r_i, p)[0] for r_i in tf.unstack(r)]) jT = tf.transpose(j) #     - r_col = tf.expand_dims(r, -1) #      hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r_col) # ,      dp = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) #  -  - dp = tf.squeeze(dp) #  p  dp    ng = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, ng, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 14.653025157673625 step: 4, current loss: 4.3918079172783016e-07 ENDED ON STEP: 4, FINAL LOSS: 3.374364957618591e-17 PARAMETERS: [2.5 2.5]</code> </pre> <br><p> 足够4个步骤。 少于牛顿的方法。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iq/ns/5l/iqns5lhcfqamjgy_f6isppnaxo4.jpeg"></div><br><p> 从代码可以看出，损失函数未用于优化，仅用于停止和记录标准。 优化算法如何知道最小化哪个函数？ 答案令人惊讶：没办法！ 高斯-牛顿只使<em>均方误差</em>最小。 </p><br><h4 id="zakrepim-matematicheskuyu-chast-stati"> 修正文章的数学部分 </h4><br><p> 我们重复了所有需要的数学运算。 让我们对其进行一些修复，以进一步仅专注于编程和TensorFlow。 您可能需要一支铅笔来追踪数学动作的顺序。 </p><br><p> 有模特儿 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722">y</span><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">f</span><span class="MJXp-mrow" id="MJXp-Span-2725"><span class="MJXp-mo" id="MJXp-Span-2726" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2727">x</span><span class="MJXp-mrow" id="MJXp-Span-2728"><span class="MJXp-mo" id="MJXp-Span-2729" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730">p</span><span class="MJXp-mrow" id="MJXp-Span-2731"><span class="MJXp-mo" id="MJXp-Span-2732" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115"> y = f（x，p）</script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2734">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116"> x </script>  -矢量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117"> p </script>  -尺寸参数向量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> n </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119"> y </script>  -标量。 从收到的实验 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120"> m </script> 点数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2743"><span class="MJXp-mrow" id="MJXp-Span-2744"><span class="MJXp-mo" id="MJXp-Span-2745" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-2746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2747" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2748" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2749">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2750"><span class="MJXp-mo" id="MJXp-Span-2751" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-2752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2754" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2755">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2756"><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-2758"><span class="MJXp-mo" id="MJXp-Span-2759" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mo" id="MJXp-Span-2760" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2761" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2762" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-2763"><span class="MJXp-mo" id="MJXp-Span-2764" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mrow" id="MJXp-Span-2765"><span class="MJXp-mo" id="MJXp-Span-2766" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-2767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2769" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770">m</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2771"><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-2773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2774" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2775" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2776">m</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2777"><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121">（x_ {1}，y_ {1}），...，（x_ {m}，y_ {m}）</script>  （ <em>数据对</em> ）。 向量残差函数仅取决于参数向量： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780">r</span><span class="MJXp-mrow" id="MJXp-Span-2781"><span class="MJXp-mo" id="MJXp-Span-2782" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783">p</span><span class="MJXp-mrow" id="MJXp-Span-2784"><span class="MJXp-mo" id="MJXp-Span-2785" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2787"><span class="MJXp-mo" id="MJXp-Span-2788" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-2789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2791" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2792">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2793"><span class="MJXp-mo" id="MJXp-Span-2794" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2795">p</span><span class="MJXp-mrow" id="MJXp-Span-2796"><span class="MJXp-mo" id="MJXp-Span-2797" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-2798"><span class="MJXp-mo" id="MJXp-Span-2799" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mo" id="MJXp-Span-2800" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2801" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2802" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2805" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806">m</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2807"><span class="MJXp-mo" id="MJXp-Span-2808" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809">p</span><span class="MJXp-mrow" id="MJXp-Span-2810"><span class="MJXp-mo" id="MJXp-Span-2811" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-2812"><span class="MJXp-mo" id="MJXp-Span-2813" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122"> r（p）=（r_ {1}（p），... r_ {m}（p））</script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2814"><span class="MJXp-msubsup" id="MJXp-Span-2815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2816" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2817" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2818">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2819"><span class="MJXp-mo" id="MJXp-Span-2820" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821">p</span><span class="MJXp-mrow" id="MJXp-Span-2822"><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-2824" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825">y</span><span class="MJXp-mrow" id="MJXp-Span-2826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2827">k</span></span><span class="MJXp-mo" id="MJXp-Span-2828" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-2829">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2830">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2833">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2834">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2836">t</span><span class="MJXp-mrow" id="MJXp-Span-2837"><span class="MJXp-msubsup" id="MJXp-Span-2838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2839" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2840" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2842" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2844" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2845" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2847" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848">f</span><span class="MJXp-mrow" id="MJXp-Span-2849"><span class="MJXp-mo" id="MJXp-Span-2850" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-2851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2852" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2853" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2855"><span class="MJXp-mo" id="MJXp-Span-2856" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">p</span><span class="MJXp-mrow" id="MJXp-Span-2858"><span class="MJXp-mo" id="MJXp-Span-2859" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123"> r_ {k}（p）= y {k}-\ widehat {y_ {k}} = y_ {k}-f（x_ {k}，p）</script>  。   ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">p</script> ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2862"><span class="MJXp-msubsup" id="MJXp-Span-2863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2865" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2867" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2869" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2870" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2871">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125">x_{k}, y_{k}</script>  ？   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2872"><span class="MJXp-msubsup" id="MJXp-Span-2873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2874" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2875" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2877" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2880" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2881">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126">x_{k}, y_{k}</script>      ,      . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127">p</script> ,  <em>  </em> ( <em>sum of squared error</em> — <em>sse</em>  <em>residual sum-of-squares</em> — <em>rss</em> )  .    <em>mse</em>    <em>sse</em> ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2885">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128"> m </script>  。             .     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2887">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2890">s</span><span class="MJXp-mo" id="MJXp-Span-2891" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892">p</span><span class="MJXp-mo" id="MJXp-Span-2893" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2896" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2899">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2897"><span class="MJXp-mn" id="MJXp-Span-2898">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2900" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901">p</span><span class="MJXp-mo" id="MJXp-Span-2902" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2903" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2904" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2905" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2910">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2909">m</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2911" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2912">p</span><span class="MJXp-mo" id="MJXp-Span-2913" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2914" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2915"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2921" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2922">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2916" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2917" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918">k</span><span class="MJXp-mo" id="MJXp-Span-2919">=</span><span class="MJXp-mn" id="MJXp-Span-2920">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2927">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2929">p</span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-129">loss(p) = r_{1}^2(p) + \cdots + r_{m}^2(p) = \sum_{k=1}^{m} r_{k}^2(p)</script></p><br><p>        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130">p</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2933"><span class="MJXp-mo" id="MJXp-Span-2934" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2935">p</span><span class="MJXp-mo" id="MJXp-Span-2936" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">(p)</script>  。 </p><br><p>    ,        .  —    .   —   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2937"><span class="MJXp-msubsup" id="MJXp-Span-2938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2939" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2940" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">r^2</script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2941"><span class="MJXp-mn" id="MJXp-Span-2942">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943">r</span><span class="MJXp-mfrac" id="MJXp-Span-2944" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2945">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946">r</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2947">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948">p</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133">2r \frac{\partial r}{\partial p}</script>  。   : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2949"><span class="MJXp-msubsup" id="MJXp-Span-2950"><span class="MJXp-mi" id="MJXp-Span-2951" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2952" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2953">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957">s</span><span class="MJXp-mo" id="MJXp-Span-2958" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2959" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-munderover" id="MJXp-Span-2960"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2966" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2967">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2961" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2962" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963">k</span><span class="MJXp-mo" id="MJXp-Span-2964">=</span><span class="MJXp-mn" id="MJXp-Span-2965">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2968">2</span><span class="MJXp-msubsup" id="MJXp-Span-2969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2970" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2971" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2972">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2973" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2974">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2976" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2977" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2978">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2979">∂</span><span class="MJXp-msubsup" id="MJXp-Span-2980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2981" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2982" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2983">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2984" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2985" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2986" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-2987"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2993" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2994">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2988" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2989" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2990">k</span><span class="MJXp-mo" id="MJXp-Span-2991">=</span><span class="MJXp-mn" id="MJXp-Span-2992">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2995">2</span><span class="MJXp-msubsup" id="MJXp-Span-2996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2997" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2998" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2999">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3000" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3001">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3003" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3004" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3005">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3006">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3008" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3009" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3010">n</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3011" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-134">\nabla_{p}loss = (\sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{1}}, \cdots, \sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{n}}) </script></p><br><p>        .      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3012"><span class="MJXp-mo" id="MJXp-Span-3013" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3014"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ħ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3015"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">升</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3016"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ö </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3017"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3020" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3021"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3022"><span class="MJXp-mo" id="MJXp-Span-3023" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3024" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3025"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-3027" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-3028" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3029"><span class="MJXp-mi" id="MJXp-Span-3030" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3031" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">升</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3033"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ö </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3036"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3038" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3039" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3040"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span><span class="MJXp-mi" id="MJXp-Span-3041"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ∂ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3043" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3044" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3045"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-munderover" id="MJXp-Span-3047"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3053" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3054"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">米</font></font></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-3048" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Σ</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3049" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ķ</font></font></span><span class="MJXp-mo" id="MJXp-Span-3051"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-3052"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3055" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span><span class="MJXp-mn" id="MJXp-Span-3056"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-3057" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3058"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3060" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ř</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3061" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3062"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ķ</font></font></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3063"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3065" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3066" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3068" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3069"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ∂</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3071" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ř</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3072" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3073"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ķ</font></font></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3074"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3076" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3077" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3078"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3079" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mn" id="MJXp-Span-3080"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- [R</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3083" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3084"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ķ</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3085" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-3086"><span class="MJXp-mi" id="MJXp-Span-3087" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3088" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-3089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- [R</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3091" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3092"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ķ</font></font></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3093"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3096" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span><span class="MJXp-mi" id="MJXp-Span-3098"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ∂ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-3099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3100" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3101" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3103" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-135">[\boldsymbol{H}loss_{p}]_{ij} = \frac{\partial^2 loss}{\partial p_{i} \partial p_{j}} = \sum_{k=1}^{m}(2\frac{\partial r_{k}}{\partial p_{i}}\frac{\partial r_{k}}{\partial p_{j}} + 2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}})</script></p><br><p>    .        ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3104"><span class="MJXp-msup" id="MJXp-Span-3105"><span class="MJXp-mrow" id="MJXp-Span-3106" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-3107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3109">v</span><span class="MJXp-mo" id="MJXp-Span-3110" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3111" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-3113"><span class="MJXp-mrow" id="MJXp-Span-3114" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115">u</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3116" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117">v</span><span class="MJXp-mo" id="MJXp-Span-3118" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119">u</span><span class="MJXp-msup" id="MJXp-Span-3120"><span class="MJXp-mrow" id="MJXp-Span-3121" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122">v</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3123" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136">{(uv)}'={u}'v+u{v}'</script>  。 <br> 太好了！     . </p><br><p> ,        ,       , —  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3124"><span class="MJXp-mn" id="MJXp-Span-3125">2</span><span class="MJXp-msubsup" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3128" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3130" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3131"><span class="MJXp-mi" id="MJXp-Span-3132" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3133" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-3134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3135" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3136" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3138">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3141" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3142">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-3143">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3146" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3147">j</span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script>  。    ,   ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3148"><span class="MJXp-msubsup" id="MJXp-Span-3149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3150" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3151" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3152">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138">r_{k}</script> ,     .          —     .   ,    ?    -. </p><br><p>     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3153"><span class="MJXp-msubsup" id="MJXp-Span-3154"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3155" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3156" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3157">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3159"><span class="MJXp-mo" id="MJXp-Span-3160" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-3161"><span><span class="MJXp-mtr" id="MJXp-Span-3162" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3163" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3164" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3165">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3168" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3169">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3170">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3172" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3173" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3174">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3175" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3176" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3177" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3178" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3179">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3182" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3183">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3184">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3187" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188">n</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3189" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3190" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3191" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span><span class="MJXp-mtd" id="MJXp-Span-3192" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3193" style="margin-left: 0.333em; margin-right: 0.333em;">⋱</span></span><span class="MJXp-mtd" id="MJXp-Span-3194" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3195" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3196" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3197" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3198" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3199">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3201" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3202" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3203">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3204">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3206" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3207" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3208">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3209" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3210" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3211" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3212" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3213">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3215" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3216" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3217">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3218">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3221" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3222">n</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3223" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-139">\boldsymbol{J}_{r} = \begin{pmatrix} \frac{\partial r_{1}}{\partial p_{1}} & \cdots & \frac{\partial r_{1}}{\partial p_{n}}\\ \vdots & \ddots & \vdots \\ \frac{\partial r_{m}}{\partial p_{1}} & \cdots & \frac{\partial p_{m}}{\partial p_{n}} \end{pmatrix}</script></p><br><p> ,    ,     . 注意： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3231"><span class="MJXp-mn" id="MJXp-Span-3232">2</span><span class="MJXp-msubsup" id="MJXp-Span-3233"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3234" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3237">⊺</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3236">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3238"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3239" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3240" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3241">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-3242" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3243">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3244">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3245">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3246">s</span><span class="MJXp-msubsup" id="MJXp-Span-3247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3248" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3249" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3250">p</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-140">2\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r} \approx \boldsymbol{H}loss_{p}</script></p><br><p>   ""     .         (   ).    ,   —        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3251"><span class="MJXp-mn" id="MJXp-Span-3252">2</span><span class="MJXp-msubsup" id="MJXp-Span-3253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3254" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3255" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3256">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3257" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-3258"><span class="MJXp-mi" id="MJXp-Span-3259" style="margin-right: 0.05em;">∂</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3260" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-3261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3262" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3263" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3264">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3265">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3267" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3268" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3269">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-3270">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3273" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3274">j</span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script> ,     . <br>     (    ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3275"><span class="MJXp-mn" id="MJXp-Span-3276">2</span><span class="MJXp-msubsup" id="MJXp-Span-3277"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3278" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3281">⊺</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3280">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3282">r</span><span class="MJXp-mo" id="MJXp-Span-3283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3284"><span class="MJXp-mi" id="MJXp-Span-3285" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3286" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3287">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3288">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3290">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291">s</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-142">2\boldsymbol{J}_{r}^\intercal r = \nabla_{p}loss</script></p><br><p>  ,    ,   - —          ,       <em>mse</em> . </p><br><h4 id="pereformuliruem-i-uslozhnim-zadachu">     </h4><br><p>      .    ,   ,   .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3293">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143"> m </script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3294"><span class="MJXp-mo" id="MJXp-Span-3295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3297" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3298" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3299">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3300" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3302" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3303" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3304">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3306" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3307" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3308" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3309" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3311" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3313" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3314" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3315">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-3316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3318" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3319" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3320">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-3321" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">(x_{1}, y_{1}), ..., (x_{m}, y_{m})</script> ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3323">y</span><span class="MJXp-mo" id="MJXp-Span-3324" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3325">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3326">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3329">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3330">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3331">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3332">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3333">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3334">k</span><span class="MJXp-mo" id="MJXp-Span-3335" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3336">x</span><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3338">p</span><span class="MJXp-mo" id="MJXp-Span-3339" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145">y = rosenbrock(x, p)</script>  。          <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3341">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146">p</script> ,      . </p><br><p>   ,     : " <em>       .  - !</em> ".  ,      ,     ,        ( <em>supervised learning</em> ). ,    .     :  ( <em>training set</em> ) —   ;   —      ( <em>prediction model</em> )    ;   —          ,    . </p><br><p>     <em> </em> ( <em>multi-layer perceptron neural network</em>  <em>mlp</em> ).  ,      ,       : </p><br><ul><li> <em> </em> ( <em>starting values</em> ) .     Xavier'a,       . </li><li> <em></em> ( <em>overfitting</em> ).   —  .     ,    .    —   . </li><li> <em>  </em> ( <em>scaling of the input</em> ).   ,      . </li></ul><br><p>     9 .     500: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    def get_random_rosenbrock_data_points(m): result = np.zeros((m, 3)) result[:, 0] = np.random.uniform(-2, 2, m) result[:, 1] = np.random.uniform(-2, 2, m) result[:, 2] = rosenbrock(result[:, 0], result[:, 1], 2.5, 2.5) return result m = 500 data_points = get_random_rosenbrock_data_points(m) # overfitting   ,      validation_data_points = get_random_rosenbrock_data_points(m)</span></span></code> </pre> <br><p>    500 .   —         ( <em>learner</em> ),     ( <em>outcome measurement</em> )   ( <em>features</em> )     . </p><br><h4 id="realizuem-odnosloynyy-perceptron">    </h4><br><p>          ( <em>network diagram</em> ).        MatLab: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/np/nt/xk/npntxk7brhnpkk7p5v1p4bjur-a.png"></div><br><p>        ( <em>input</em> ).      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3343">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147">W</script> ( <em>weights</em> )  2x10,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3345">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148">b</script> ( <em>bias</em> )  10,       ( <em>activation</em> ).    ()   ( <em>hidden layer</em> )  10 .         ,   ,         ( <em>output</em> ). </p><br><p>   ,   ,  (  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3347">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3348">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3349">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149">tanh</script>  ）： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3351"><span class="MJXp-mtable" id="MJXp-Span-3352"><span><span class="MJXp-mtr" id="MJXp-Span-3353" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3354" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3356" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3357" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3358">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3359" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3360">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3361">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3362">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3363">h</span><span class="MJXp-mo" id="MJXp-Span-3364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3365">x</span><span class="MJXp-msubsup" id="MJXp-Span-3366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3367" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3368" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3369">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3370" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3372" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3373" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3374">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3376" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3377" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-3378"><span class="MJXp-munderover" id="MJXp-Span-3379"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3381" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3380">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3382" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3384" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3385" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3386">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3389" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3390">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3393" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3394" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3395">2</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-150">\begin{matrix} h_{1} = tanh(xW_{1} + b_{1})\\ \widehat{y} = h_{1}W_{2} + b_{2} \end{matrix} </script></p><br><p>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3396"><span class="MJXp-msubsup" id="MJXp-Span-3397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3398" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3399" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3400" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3401">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3402">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3404">h</span><span class="MJXp-mo" id="MJXp-Span-3405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-3406"><span class="MJXp-mo" id="MJXp-Span-3407" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3408"><span><span class="MJXp-mtr" id="MJXp-Span-3409" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3410" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3412" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3413" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mtd" id="MJXp-Span-3414" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3416" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3417" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3418" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">]</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3419"><span class="MJXp-mo" id="MJXp-Span-3420" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3421"><span><span class="MJXp-mtr" id="MJXp-Span-3422" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3423" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3425" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3430"><span class="MJXp-mo" id="MJXp-Span-3431">(</span><span class="MJXp-mn" id="MJXp-Span-3432">1</span><span class="MJXp-mo" id="MJXp-Span-3433">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3426"><span class="MJXp-mn" id="MJXp-Span-3427">1</span><span class="MJXp-mo" id="MJXp-Span-3428">,</span><span class="MJXp-mn" id="MJXp-Span-3429">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3434" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3435" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3436" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3438" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3443"><span class="MJXp-mo" id="MJXp-Span-3444">(</span><span class="MJXp-mn" id="MJXp-Span-3445">1</span><span class="MJXp-mo" id="MJXp-Span-3446">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3439"><span class="MJXp-mn" id="MJXp-Span-3440">1</span><span class="MJXp-mo" id="MJXp-Span-3441">,</span><span class="MJXp-mn" id="MJXp-Span-3442">10</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3447" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3448" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3450" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3455"><span class="MJXp-mo" id="MJXp-Span-3456">(</span><span class="MJXp-mn" id="MJXp-Span-3457">1</span><span class="MJXp-mo" id="MJXp-Span-3458">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3451"><span class="MJXp-mn" id="MJXp-Span-3452">2</span><span class="MJXp-mo" id="MJXp-Span-3453">,</span><span class="MJXp-mn" id="MJXp-Span-3454">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3459" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3460" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3461" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3463" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3468"><span class="MJXp-mo" id="MJXp-Span-3469">(</span><span class="MJXp-mn" id="MJXp-Span-3470">1</span><span class="MJXp-mo" id="MJXp-Span-3471">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3464"><span class="MJXp-mn" id="MJXp-Span-3465">2</span><span class="MJXp-mo" id="MJXp-Span-3466">,</span><span class="MJXp-mn" id="MJXp-Span-3467">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3472" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3473" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3474"><span class="MJXp-mo" id="MJXp-Span-3475" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3476"><span><span class="MJXp-mtr" id="MJXp-Span-3477" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3478" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3480" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3482"><span class="MJXp-mo" id="MJXp-Span-3483">(</span><span class="MJXp-mn" id="MJXp-Span-3484">1</span><span class="MJXp-mo" id="MJXp-Span-3485">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3481">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3486" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3487" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3488" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3490" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3493"><span class="MJXp-mo" id="MJXp-Span-3494">(</span><span class="MJXp-mn" id="MJXp-Span-3495">1</span><span class="MJXp-mo" id="MJXp-Span-3496">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3491"><span class="MJXp-mn" id="MJXp-Span-3492">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3497" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3498" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-3499" style="width: 0em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3500"><span class="MJXp-munderover" id="MJXp-Span-3501"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3503" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3502">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3504" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3505"><span class="MJXp-mo" id="MJXp-Span-3506" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3507"><span><span class="MJXp-mtr" id="MJXp-Span-3508" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3509" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3511" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3513"><span class="MJXp-mo" id="MJXp-Span-3514">(</span><span class="MJXp-mn" id="MJXp-Span-3515">1</span><span class="MJXp-mo" id="MJXp-Span-3516">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3512">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3517" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3518" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3519" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3521" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3524"><span class="MJXp-mo" id="MJXp-Span-3525">(</span><span class="MJXp-mn" id="MJXp-Span-3526">1</span><span class="MJXp-mo" id="MJXp-Span-3527">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3522"><span class="MJXp-mn" id="MJXp-Span-3523">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3528" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3529"><span class="MJXp-mo" id="MJXp-Span-3530" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3531"><span><span class="MJXp-mtr" id="MJXp-Span-3532" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3533" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3535" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3540"><span class="MJXp-mo" id="MJXp-Span-3541">(</span><span class="MJXp-mn" id="MJXp-Span-3542">2</span><span class="MJXp-mo" id="MJXp-Span-3543">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3536"><span class="MJXp-mn" id="MJXp-Span-3537">1</span><span class="MJXp-mo" id="MJXp-Span-3538">,</span><span class="MJXp-mn" id="MJXp-Span-3539">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3544" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3545" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3546" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3547" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3548" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3550" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3555"><span class="MJXp-mo" id="MJXp-Span-3556">(</span><span class="MJXp-mn" id="MJXp-Span-3557">2</span><span class="MJXp-mo" id="MJXp-Span-3558">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3551"><span class="MJXp-mn" id="MJXp-Span-3552">1</span><span class="MJXp-mo" id="MJXp-Span-3553">,</span><span class="MJXp-mn" id="MJXp-Span-3554">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3559" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3560" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3562" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3563" style="vertical-align: -0.4em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-151">h_1 = tanh(\begin{bmatrix} x_1 & x_2 \end{bmatrix}\begin{bmatrix} w^{(1)}_{1,1} & \cdots& w^{(1)}_{1,10} \\ w^{(1)}_{2,1} &\cdots& w^{(1)}_{2,10} \end{bmatrix} + \begin{bmatrix} b^{(1)}_1 & \cdots & b^{(1)}_{10} \end{bmatrix}) \\ \widehat{y} = \begin{bmatrix}h^{(1)}_1 & \cdots & h^{(1)}_{10}\end{bmatrix} \begin{bmatrix} w^{(2)}_{1,1} \\ \vdots \\ w^{(2)}_{1,10} \\ \end{bmatrix} + b_2 </script></p><br><p>    .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3564"><span class="MJXp-msubsup" id="MJXp-Span-3565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3566" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3567" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3568">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152">W_{1}</script>        ""   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3569"><span class="MJXp-msubsup" id="MJXp-Span-3570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3571" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3572" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3573">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153">h_{1}</script> ,       - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3574"><span class="MJXp-msubsup" id="MJXp-Span-3575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3576" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3577" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3578">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154">W_{2}</script>  。  41 .       ,    . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3580">m</span><span class="MJXp-mo" id="MJXp-Span-3581" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-3582">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155">m \times 2</script> ,          .   - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3583"><span class="MJXp-mrow" id="MJXp-Span-3584"><span class="MJXp-munderover" id="MJXp-Span-3585"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3587" style="margin-left: 0px; margin-right: 0px;">ˆ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3586">y</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156">\widehat{y}</script> 来自 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3589">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157"> m </script> : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     10 "" n_hidden = 10 #      Xavier'a initializer = tf.contrib.layers.xavier_initializer() #    x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m, 1]) #         W1 = tf.Variable(initializer([2, n_hidden], dtype=tf.float64)) b1 = tf.Variable(initializer([1, n_hidden], dtype=tf.float64)) #   ,  tanh   h1 = tf.nn.tanh(tf.matmul(x, W1) + b1) #        W2 = tf.Variable(initializer([n_hidden, 1], dtype=tf.float64)) b2 = tf.Variable(initializer([1], dtype=tf.float64)) #   y_hat = tf.matmul(h1, W2) + b2 #  r = y - y_hat #   mse     loss = tf.reduce_mean(tf.square(r)) #      placeholder feed_dict = {x: data_points[:,0:2], y: data_points[:,2:3]} validation_feed_dict = {x: validation_data_points[:,0:2], y: validation_data_points[:,2:3]}</span></span></code> </pre> <br><h4 id="obuchim-neyroset-metodom-adam">    Adam </h4><br><p>     Adam         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3591">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3592">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3593">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3594">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3595">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3596">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3597">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3598">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3599">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3600">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158">rosenbrock</script>  。   mse     : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    adm = tf.train.AdamOptimizer(1e-2).minimize(loss) session.run(tf.global_variables_initializer()) #   ,    40000  train(1e-10, 40000, loss, adm, feed_dict) print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 671.4242576535694 [...] ENDED ON STEP: 40000, FINAL LOSS: 0.22862158574440725 VALIDATION LOSS: 0.29000289644978866</code> </pre> <br><p>       .      :   ,  ,   . </p><br><h4 id="vychislim-matricu-yakobi-dlya-neyronnoy-seti">       </h4><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3602">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3603">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3605">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3606">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3608">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3609">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3610">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3611">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-159">rosenbrock</script>     2  .    : </p><br><ul><li> .   9 ,  500.        . </li><li> .   -  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3613">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-160">p</script> ,        . </li></ul><br><p>    : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      y   x def jacobian(y, x): loop_vars = [ tf.constant(0, tf.int32), tf.TensorArray(tf.float64, size=m), ] #  -   #      _, jacobian = tf.while_loop( lambda i, _: i &lt; m, #           #   (-),   x     lambda i, res: (i+1, res.write(i, tf.reshape(tf.gradients(y[i], x), (-1,)))), loop_vars) #       return jacobian.stack() #       r_flat = tf.squeeze(r) #        #       parms = [W1, b1, W2, b2] parms_sizes = [tf.size(p) for p in parms] j = tf.concat([jacobian(r_flat, p) for p in parms], 1) jT = tf.transpose(j) #           hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r)</span></span></code> </pre> <br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3614"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3615">J</span><span class="MJXp-msubsup" id="MJXp-Span-3616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3617" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3618" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3619">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161">\boldsymbol{J}r_{p}</script>       .       ,   4  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3620"><span class="MJXp-msubsup" id="MJXp-Span-3621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3622" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3623" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3624" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3626" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3627" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3628" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3630" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3631" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3632" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3634" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3635" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162">W_1, b_1, W_2, b_2</script>  。  4  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3636"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3637">J</span><span class="MJXp-msubsup" id="MJXp-Span-3638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3639" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3640" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3642" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3643" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3644" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3645">J</span><span class="MJXp-msubsup" id="MJXp-Span-3646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3647" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3648" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3650" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3651" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3652" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3653">J</span><span class="MJXp-msubsup" id="MJXp-Span-3654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3655" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3656" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3658" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3659" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3660" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3661">J</span><span class="MJXp-msubsup" id="MJXp-Span-3662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3663" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3664" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3666" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3667" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol{J}r_{W_1}, \boldsymbol{J}r_{b_1}, \boldsymbol{J}r_{W_2}, \boldsymbol{J}r_{b_2}</script>      <em>tf.concat</em> . </p><br><p>         . <em>tf.while_loop</em>    ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3668"><span class="MJXp-msubsup" id="MJXp-Span-3669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3670" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3671" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164">r_i</script> ,        ,       <em>stack</em> . </p><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3672"><span class="MJXp-msubsup" id="MJXp-Span-3673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3674" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3675" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165">r_i</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3676"><span class="MJXp-msubsup" id="MJXp-Span-3677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3678" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3679" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166">W_1</script>  : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3680"><span class="MJXp-mrow" id="MJXp-Span-3681"><span class="MJXp-mo" id="MJXp-Span-3682" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.917em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.667em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3683"><span><span class="MJXp-mtr" id="MJXp-Span-3684" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3685" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3686" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3687">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3689" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3690" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3691">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3693" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3698"><span class="MJXp-mo" id="MJXp-Span-3699">(</span><span class="MJXp-mn" id="MJXp-Span-3700">1</span><span class="MJXp-mo" id="MJXp-Span-3701">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3694"><span class="MJXp-mn" id="MJXp-Span-3695">1</span><span class="MJXp-mo" id="MJXp-Span-3696">,</span><span class="MJXp-mn" id="MJXp-Span-3697">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3702" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3703" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3704" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3705" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3706">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3708" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3709" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3710">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3712" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3717"><span class="MJXp-mo" id="MJXp-Span-3718">(</span><span class="MJXp-mn" id="MJXp-Span-3719">1</span><span class="MJXp-mo" id="MJXp-Span-3720">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3713"><span class="MJXp-mn" id="MJXp-Span-3714">1</span><span class="MJXp-mo" id="MJXp-Span-3715">,</span><span class="MJXp-mn" id="MJXp-Span-3716">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3721" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3722" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3723" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3724">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3726" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3727" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3728">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3735"><span class="MJXp-mo" id="MJXp-Span-3736">(</span><span class="MJXp-mn" id="MJXp-Span-3737">1</span><span class="MJXp-mo" id="MJXp-Span-3738">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3731"><span class="MJXp-mn" id="MJXp-Span-3732">2</span><span class="MJXp-mo" id="MJXp-Span-3733">,</span><span class="MJXp-mn" id="MJXp-Span-3734">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3739" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3740" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3741" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3742" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3743">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3745" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3746" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3747">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3749" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3754"><span class="MJXp-mo" id="MJXp-Span-3755">(</span><span class="MJXp-mn" id="MJXp-Span-3756">1</span><span class="MJXp-mo" id="MJXp-Span-3757">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3750"><span class="MJXp-mn" id="MJXp-Span-3751">2</span><span class="MJXp-mo" id="MJXp-Span-3752">,</span><span class="MJXp-mn" id="MJXp-Span-3753">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3758" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.917em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.667em; margin-left: -0.25em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} \\ \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  。  <em>tf.reshape</em>   <em>(-1,)</em>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3759"><span class="MJXp-mrow" id="MJXp-Span-3760"><span class="MJXp-mo" id="MJXp-Span-3761" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.778em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.111em; margin-left: -0.17em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3762"><span><span class="MJXp-mtr" id="MJXp-Span-3763" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3764" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3765" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3766">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3768" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3769" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3770">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3772" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3777"><span class="MJXp-mo" id="MJXp-Span-3778">(</span><span class="MJXp-mn" id="MJXp-Span-3779">1</span><span class="MJXp-mo" id="MJXp-Span-3780">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3773"><span class="MJXp-mn" id="MJXp-Span-3774">1</span><span class="MJXp-mo" id="MJXp-Span-3775">,</span><span class="MJXp-mn" id="MJXp-Span-3776">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3781" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3782" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3783" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3784" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3785">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3787" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3788" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3789">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3791" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3796"><span class="MJXp-mo" id="MJXp-Span-3797">(</span><span class="MJXp-mn" id="MJXp-Span-3798">1</span><span class="MJXp-mo" id="MJXp-Span-3799">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3792"><span class="MJXp-mn" id="MJXp-Span-3793">1</span><span class="MJXp-mo" id="MJXp-Span-3794">,</span><span class="MJXp-mn" id="MJXp-Span-3795">10</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3800" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3801" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3802">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3804" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3805" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3806">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3808" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3813"><span class="MJXp-mo" id="MJXp-Span-3814">(</span><span class="MJXp-mn" id="MJXp-Span-3815">1</span><span class="MJXp-mo" id="MJXp-Span-3816">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3809"><span class="MJXp-mn" id="MJXp-Span-3810">2</span><span class="MJXp-mo" id="MJXp-Span-3811">,</span><span class="MJXp-mn" id="MJXp-Span-3812">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3817" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3818" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3819" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3820" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3821">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3823" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3824" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3825">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3827" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3832"><span class="MJXp-mo" id="MJXp-Span-3833">(</span><span class="MJXp-mn" id="MJXp-Span-3834">1</span><span class="MJXp-mo" id="MJXp-Span-3835">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3828"><span class="MJXp-mn" id="MJXp-Span-3829">2</span><span class="MJXp-mo" id="MJXp-Span-3830">,</span><span class="MJXp-mn" id="MJXp-Span-3831">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3836" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.778em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.111em; margin-left: -0.17em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} & \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  。 </p><br><p>        .           -     .    — TensorFlow             .   —  -    -     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3837"><span class="MJXp-msubsup" id="MJXp-Span-3838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3839" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3840" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3843" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3844" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3845" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3847" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3848" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3849" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3851" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3852" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169">W_1, b_1, W_2, b_2</script>  。        -.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Levenberg-Marquardt Jupyter Notebook</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rosenbrock_train.py</a> .       ,   TensorFlow       .  - ,      ( ) , , . </p><br><h4 id="obuchim-neyroset-metodom-gaussa-nyutona">    - </h4><br><p>  <em>hess_approx</em>  <em>grad_approx</em>       -.      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3854">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3855">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3856">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3858">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3859">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3860">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3861">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3862">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3863">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170">rosenbrock</script>   ,               .   : </p><br><ol><li>    : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3864"><span class="MJXp-mi" id="MJXp-Span-3865">Δ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3866">p</span><span class="MJXp-mo" id="MJXp-Span-3867" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3868"><span class="MJXp-mo" id="MJXp-Span-3869" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3870"><span><span class="MJXp-mtr" id="MJXp-Span-3871" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3872" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3873">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3875" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3880"><span class="MJXp-mo" id="MJXp-Span-3881">(</span><span class="MJXp-mn" id="MJXp-Span-3882">1</span><span class="MJXp-mo" id="MJXp-Span-3883">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3876"><span class="MJXp-mn" id="MJXp-Span-3877">1</span><span class="MJXp-mo" id="MJXp-Span-3878">,</span><span class="MJXp-mn" id="MJXp-Span-3879">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3884" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3885" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3886" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3887">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3889" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3894"><span class="MJXp-mo" id="MJXp-Span-3895">(</span><span class="MJXp-mn" id="MJXp-Span-3896">1</span><span class="MJXp-mo" id="MJXp-Span-3897">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3890"><span class="MJXp-mn" id="MJXp-Span-3891">2</span><span class="MJXp-mo" id="MJXp-Span-3892">,</span><span class="MJXp-mn" id="MJXp-Span-3893">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3898" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3899">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3901" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3903"><span class="MJXp-mo" id="MJXp-Span-3904">(</span><span class="MJXp-mn" id="MJXp-Span-3905">1</span><span class="MJXp-mo" id="MJXp-Span-3906">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3902">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3907" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3908" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3909" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3910">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3912" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3915"><span class="MJXp-mo" id="MJXp-Span-3916">(</span><span class="MJXp-mn" id="MJXp-Span-3917">1</span><span class="MJXp-mo" id="MJXp-Span-3918">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3913"><span class="MJXp-mn" id="MJXp-Span-3914">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3919" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3920">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3922" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3927"><span class="MJXp-mo" id="MJXp-Span-3928">(</span><span class="MJXp-mn" id="MJXp-Span-3929">2</span><span class="MJXp-mo" id="MJXp-Span-3930">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3923"><span class="MJXp-mn" id="MJXp-Span-3924">1</span><span class="MJXp-mo" id="MJXp-Span-3925">,</span><span class="MJXp-mn" id="MJXp-Span-3926">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3931" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3932" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3933" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3934">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3936" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3941"><span class="MJXp-mo" id="MJXp-Span-3942">(</span><span class="MJXp-mn" id="MJXp-Span-3943">2</span><span class="MJXp-mo" id="MJXp-Span-3944">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3937"><span class="MJXp-mn" id="MJXp-Span-3938">1</span><span class="MJXp-mo" id="MJXp-Span-3939">,</span><span class="MJXp-mn" id="MJXp-Span-3940">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3945" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3946">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3948" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3949" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3950" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171">\Delta \boldsymbol{p} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} & \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} & \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} & \Delta b_2\end{bmatrix}</script></li><li>        : <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3951"><span class="MJXp-mi" id="MJXp-Span-3952">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3954" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3955" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3956">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3957" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3958"><span class="MJXp-mo" id="MJXp-Span-3959" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3960"><span><span class="MJXp-mtr" id="MJXp-Span-3961" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3962" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3963">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3970"><span class="MJXp-mo" id="MJXp-Span-3971">(</span><span class="MJXp-mn" id="MJXp-Span-3972">1</span><span class="MJXp-mo" id="MJXp-Span-3973">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3966"><span class="MJXp-mn" id="MJXp-Span-3967">1</span><span class="MJXp-mo" id="MJXp-Span-3968">,</span><span class="MJXp-mn" id="MJXp-Span-3969">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3974" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3975" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-3976" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3977">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3979" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3984"><span class="MJXp-mo" id="MJXp-Span-3985">(</span><span class="MJXp-mn" id="MJXp-Span-3986">1</span><span class="MJXp-mo" id="MJXp-Span-3987">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3980"><span class="MJXp-mn" id="MJXp-Span-3981">2</span><span class="MJXp-mo" id="MJXp-Span-3982">,</span><span class="MJXp-mn" id="MJXp-Span-3983">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3988" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172">\Delta W_{1} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  ， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3989"><span class="MJXp-mi" id="MJXp-Span-3990">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-3991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3992" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3993" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3994">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3995" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3996"><span class="MJXp-mo" id="MJXp-Span-3997" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3998"><span><span class="MJXp-mtr" id="MJXp-Span-3999" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4000" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4001">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4005"><span class="MJXp-mo" id="MJXp-Span-4006">(</span><span class="MJXp-mn" id="MJXp-Span-4007">1</span><span class="MJXp-mo" id="MJXp-Span-4008">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-4004">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-4009" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4010" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4011" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4012">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4014" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4017"><span class="MJXp-mo" id="MJXp-Span-4018">(</span><span class="MJXp-mn" id="MJXp-Span-4019">1</span><span class="MJXp-mo" id="MJXp-Span-4020">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4015"><span class="MJXp-mn" id="MJXp-Span-4016">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4021" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173">\Delta b_{1} = \begin{bmatrix} \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} \end{bmatrix}</script>  ， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4022"><span class="MJXp-mi" id="MJXp-Span-4023">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4025" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4026" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4027">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-4028" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-4029"><span class="MJXp-mo" id="MJXp-Span-4030" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-4031"><span><span class="MJXp-mtr" id="MJXp-Span-4032" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4033" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4034">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4036" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4041"><span class="MJXp-mo" id="MJXp-Span-4042">(</span><span class="MJXp-mn" id="MJXp-Span-4043">2</span><span class="MJXp-mo" id="MJXp-Span-4044">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4037"><span class="MJXp-mn" id="MJXp-Span-4038">1</span><span class="MJXp-mo" id="MJXp-Span-4039">,</span><span class="MJXp-mn" id="MJXp-Span-4040">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-4045" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4046" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4047" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4048">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4050" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4055"><span class="MJXp-mo" id="MJXp-Span-4056">(</span><span class="MJXp-mn" id="MJXp-Span-4057">2</span><span class="MJXp-mo" id="MJXp-Span-4058">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4051"><span class="MJXp-mn" id="MJXp-Span-4052">1</span><span class="MJXp-mo" id="MJXp-Span-4053">,</span><span class="MJXp-mn" id="MJXp-Span-4054">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4059" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} \end{bmatrix}</script>  ， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4060"><span class="MJXp-mi" id="MJXp-Span-4061">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4063" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4064" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4065">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-4066" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-4067"><span class="MJXp-mo" id="MJXp-Span-4068" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-4069"><span><span class="MJXp-mtr" id="MJXp-Span-4070" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4071" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4072">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4074" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4075" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4076" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175">\Delta b_{2} = \begin{bmatrix} \Delta b_2\end{bmatrix}</script>  。 </li><li>   ,      : <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4077"><span class="MJXp-mi" id="MJXp-Span-4078">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4080" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4081" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4082">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4083" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-4084"><span class="MJXp-mo" id="MJXp-Span-4085" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-4086"><span><span class="MJXp-mtr" id="MJXp-Span-4087" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4088" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4089">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4091" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4096"><span class="MJXp-mo" id="MJXp-Span-4097">(</span><span class="MJXp-mn" id="MJXp-Span-4098">1</span><span class="MJXp-mo" id="MJXp-Span-4099">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4092"><span class="MJXp-mn" id="MJXp-Span-4093">1</span><span class="MJXp-mo" id="MJXp-Span-4094">,</span><span class="MJXp-mn" id="MJXp-Span-4095">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-4100" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4101" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4102" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4103">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4105" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4110"><span class="MJXp-mo" id="MJXp-Span-4111">(</span><span class="MJXp-mn" id="MJXp-Span-4112">1</span><span class="MJXp-mo" id="MJXp-Span-4113">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4106"><span class="MJXp-mn" id="MJXp-Span-4107">1</span><span class="MJXp-mo" id="MJXp-Span-4108">,</span><span class="MJXp-mn" id="MJXp-Span-4109">10</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-4114" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4115" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4116">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4118" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4123"><span class="MJXp-mo" id="MJXp-Span-4124">(</span><span class="MJXp-mn" id="MJXp-Span-4125">1</span><span class="MJXp-mo" id="MJXp-Span-4126">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4119"><span class="MJXp-mn" id="MJXp-Span-4120">2</span><span class="MJXp-mo" id="MJXp-Span-4121">,</span><span class="MJXp-mn" id="MJXp-Span-4122">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-4127" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4128" style="margin-left: 0em; margin-right: 0em;">⋯</span></span><span class="MJXp-mtd" id="MJXp-Span-4129" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4130">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4132" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4137"><span class="MJXp-mo" id="MJXp-Span-4138">(</span><span class="MJXp-mn" id="MJXp-Span-4139">1</span><span class="MJXp-mo" id="MJXp-Span-4140">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4133"><span class="MJXp-mn" id="MJXp-Span-4134">2</span><span class="MJXp-mo" id="MJXp-Span-4135">,</span><span class="MJXp-mn" id="MJXp-Span-4136">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4141" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176">\Delta W_{1} = \begin{bmatrix} \Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{1,10} \\ \Delta w^{(1)}_{2,1} &\cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  ， <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4142"><span class="MJXp-mi" id="MJXp-Span-4143">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4145" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4146" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-4147">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-4148" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-4149"><span class="MJXp-mo" id="MJXp-Span-4150" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-4151"><span><span class="MJXp-mtr" id="MJXp-Span-4152" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4153" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4154">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4156" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4161"><span class="MJXp-mo" id="MJXp-Span-4162">(</span><span class="MJXp-mn" id="MJXp-Span-4163">2</span><span class="MJXp-mo" id="MJXp-Span-4164">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4157"><span class="MJXp-mn" id="MJXp-Span-4158">1</span><span class="MJXp-mo" id="MJXp-Span-4159">,</span><span class="MJXp-mn" id="MJXp-Span-4160">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-4165" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4166" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-4167" style="margin-left: 0.333em; margin-right: 0.333em;">⋮</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4168" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4169" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-4170">Δ</span><span class="MJXp-msubsup" id="MJXp-Span-4171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4172" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4177"><span class="MJXp-mo" id="MJXp-Span-4178">(</span><span class="MJXp-mn" id="MJXp-Span-4179">2</span><span class="MJXp-mo" id="MJXp-Span-4180">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4173"><span class="MJXp-mn" id="MJXp-Span-4174">1</span><span class="MJXp-mo" id="MJXp-Span-4175">,</span><span class="MJXp-mn" id="MJXp-Span-4176">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4181" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} \\ \vdots \\ \Delta w^{(2)}_{1,10} \\ \end{bmatrix}</script></li><li>  . </li></ol><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       gn = opt.apply_gradients(zip(dps, parms)) #   session.run(tf.global_variables_initializer()) train(1e-10, 100, loss, gn, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 548.8468777701685 step: 2, current loss: 49648941.340197295 InvalidArgumentError: Input is not invertible.</code> </pre> <br><p> 出了点问题。      ,       .  -  ,      . </p><br><p>      ,        . </p><br><h4 id="obuchim-neyroset-metodom-levenberga-markvadta">    - </h4><br><p>     .          Matlab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   trainlm</a> .       .     MathWorks. </p><br><p>    - : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4182"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4183">p</span><span class="MJXp-mo" id="MJXp-Span-4184" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4185">p</span><span class="MJXp-mo" id="MJXp-Span-4186" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-4187" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-4188"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4189" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-4192">⊺</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4191">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4193"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4194" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4195" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4196">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4197"><span class="MJXp-mo" id="MJXp-Span-4198" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4199" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4200">−</span><span class="MJXp-mn" id="MJXp-Span-4201">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4202"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4203" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-4206">⊺</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4205">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4207">r</span><span class="MJXp-mo" id="MJXp-Span-4208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4209">p</span><span class="MJXp-mo" id="MJXp-Span-4210" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script>  。  -    : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4211"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4212">p</span><span class="MJXp-mo" id="MJXp-Span-4213" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4214">p</span><span class="MJXp-mo" id="MJXp-Span-4215" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-4216" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-4217"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4218" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-4221">⊺</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4220">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4222"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4223" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4224" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4225">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-4226" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4227">μ</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4228">I</span><span class="MJXp-msubsup" id="MJXp-Span-4229"><span class="MJXp-mo" id="MJXp-Span-4230" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4231" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4232">−</span><span class="MJXp-mn" id="MJXp-Span-4233">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4234"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4235" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-4238">⊺</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4237">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4239">r</span><span class="MJXp-mo" id="MJXp-Span-4240" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4241">p</span><span class="MJXp-mo" id="MJXp-Span-4242" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-179">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}+\mu \boldsymbol{I}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script></p><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4243"><span class="MJXp-mtext" id="MJXp-Span-4244" style="color: red;">\亩</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180"> \亩</script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4245"><span class="MJXp-mrow" id="MJXp-Span-4246"><span class="MJXp-mo" id="MJXp-Span-4247" style="margin-left: 0.278em; margin-right: 0.278em;">我</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181">我</script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4249">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182"> n </script> (  ).   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4250"><span class="MJXp-mtext" id="MJXp-Span-4251" style="color: red;">\亩</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183"> \亩</script>  ,       -.   ,    .  ,  LM       -. </p><br><p>        : </p><br><pre> <code class="python hljs">mu = tf.placeholder(tf.float64, shape=[<span class="hljs-number"><span class="hljs-number">1</span></span>]) n = tf.add_n(parms_sizes) I = tf.eye(n, dtype=tf.float64) <span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx + tf.multiply(mu, I)), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       lm = opt.apply_gradients(zip(dps, parms))</span></span></code> </pre> <br><p>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4252"><span class="MJXp-mtext" id="MJXp-Span-4253" style="color: red;">\亩</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184"> \亩</script>  ？  LM     -   .   ,     . ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4254"><span class="MJXp-mtext" id="MJXp-Span-4255" style="color: red;">\亩</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-185"> \亩</script> ,     .     —   ,     <em>mse</em> .       ,   : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       store = [tf.Variable(tf.zeros(p.shape, dtype=tf.float64)) for p in parms] #  TensorFlow       save_parms = [tf.assign(s, p) for s, p in zip(store, parms)] restore_parms = [tf.assign(p, s) for s, p in zip(store, parms)] #   mu    3. feed_dict[mu] = np.array([3.]) step = 0 session.run(tf.global_variables_initializer()) #    mse current_loss = session.run(loss, feed_dict) #    100   while current_loss &gt; 1e-10 and step &lt; 100: step += 1 #  1, 2, 4...   if math.log(step, 2).is_integer(): print(f'step: {step}, mu: {feed_dict[mu][0]} current loss: {current_loss}') #    session.run(save_parms) # ,     mse while True: #    session.run(lm, feed_dict) new_loss = session.run(loss, feed_dict) if new_loss &gt; current_loss: #  -  mu  10     feed_dict[mu] *= 10 session.run(restore_parms) else: #  -  mu  10     feed_dict[mu] /= 10 current_loss = new_loss break print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}') print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, mu: 3.0 current loss: 692.6211687622557 [...] ENDED ON STEP: 100, FINAL LOSS: 0.012346989371823602 VALIDATION LOSS: 0.01859463694102034</code> </pre> <br><p>  100  LM  mse    10  ,   40  . </p><br><p>       .   ,         .  ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rosenbrock_train.py</a> . </p><br><h4 id="poznakomimsya-s-mnogomernym-variantom-funkcii-rozenbroka">       </h4><br><p>    2D   .         .      .          ,     " " ( <em>curse of dimentionality</em> , Bellman, 1961).     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> .      </a> . </p><br><p>      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4257">f</span><span class="MJXp-mo" id="MJXp-Span-4258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4259">x</span><span class="MJXp-mo" id="MJXp-Span-4260" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4261" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-4262"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4268" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4269">N</span><span class="MJXp-mo" id="MJXp-Span-4270">−</span><span class="MJXp-mn" id="MJXp-Span-4271">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-4263" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-4264" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4265">i</span><span class="MJXp-mo" id="MJXp-Span-4266">=</span><span class="MJXp-mn" id="MJXp-Span-4267">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4272"><span class="MJXp-mo" id="MJXp-Span-4273" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">[</span></span><span class="MJXp-mn" id="MJXp-Span-4274">100</span><span class="MJXp-mo" id="MJXp-Span-4275" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4277" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4278" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4279">i</span><span class="MJXp-mo" id="MJXp-Span-4280">+</span><span class="MJXp-mn" id="MJXp-Span-4281">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-4282" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4284" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-4287">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4286">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4288"><span class="MJXp-mo" id="MJXp-Span-4289" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4290" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4291" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-4292" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4293">1</span><span class="MJXp-mo" id="MJXp-Span-4294" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4296" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4297" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4298">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4299"><span class="MJXp-mo" id="MJXp-Span-4300" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4301" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4302" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-4303" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-4304">x</span><span class="MJXp-mo" id="MJXp-Span-4305" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4306" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-4307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4308" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4309" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-4310" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-msubsup" id="MJXp-Span-4311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4312" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4313" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4314">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-4315" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4316" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-4317"><span class="MJXp-mrow" id="MJXp-Span-4318" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4319">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4320" style="vertical-align: 0.5em;">N</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-186">f(\boldsymbol{x}) = \sum_{i=1}^{N-1}\left [ 100(x_{i+1} - x_{i}^2)^2 + (1-x_{i})^2 \right ], \boldsymbol{x}=[x_1 \cdots x_{N}]\in \mathbb{R}^N</script></p><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rosenbrock_train.py</a>   <em>get_rand_rosenbrock_points</em> . </p><br><h4 id="polnocenno-proverim-algoritm-levenberga-markvadta">    - </h4><br><p>     - : " <em>!    4 ,     300!</em> ".   ,   ( <em></em> )    -. , ,  .  -   .  .  :       ?  ,          .   .          ,      - : </p><br><ol><li> 10 000  6D  . </li><li>    3   12, 10, 8 (311 ). </li><li>   . </li><li> 3.5    . </li></ol><br><p>              .     -   2 .      LM       .      20 . </p><br><img src="https://habrastorage.org/webt/nl/b1/-u/nlb1-ut2rftvgoleqzsl4o1e2ze.jpeg"><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rosenbrock_train.py</a> .   .         ,      . </p><br><h4 id="zaklyuchenie"> 结论 </h4><br><p>  ,        .  " ",    ,     .      ,      .   ,    273 .  - ,        . </p><br><p>   ,   : </p><br><ol><li>    . </li><li>    (   )  -: <br> [1] Petros Drineas, Ravi Kannan, and Michael W. Mahoney. 2006. Fast Monte Carlo Algorithms for Matrices I: Approximating Matrix Multiplication. SIAM J. Comput. 36, 1 (July 2006), 132-157. DOI= <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://dx.doi.org/10.1137/S0097539704442684</a> <br> [2] Adelman, M., &amp; Silberstein, M. (2018). Faster Neural Network Training with Approximate Tensor Operations. CoRR, abs/1805.08079. </li></ol><br><p> ,  -     .      ,      .      "". </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428183/">https://habr.com/ru/post/zh-CN428183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428173/index.html">Prettier，ESLint，Husky，Lint-Staged和EditorConfig：用于编写简洁代码的工具</a></li>
<li><a href="../zh-CN428175/index.html">狡猾的前缀树C的实现</a></li>
<li><a href="../zh-CN428177/index.html">那么，求职/ IT工作者怎么了？</a></li>
<li><a href="../zh-CN428179/index.html">在日本的一次拍卖中，原型机Wii控制器是为GameCube开发的</a></li>
<li><a href="../zh-CN428181/index.html">道德机器：无情还是毫无意义？</a></li>
<li><a href="../zh-CN428187/index.html">如何为GNOME Shell编写扩展名：请勿打扰模式</a></li>
<li><a href="../zh-CN428189/index.html">谁是圣骑士？</a></li>
<li><a href="../zh-CN428191/index.html">我们应该如何安排黑客马拉松，或者我们如何进行内部黑客马拉松？</a></li>
<li><a href="../zh-CN428193/index.html">关于旅游</a></li>
<li><a href="../zh-CN428197/index.html">有效的个人理财。 1级</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>