<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßìüèø üßòüèø ü§∂üèª G√©n√©rateur de couverture musicale Python dans Blender üßò üíì üóûÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je parlerai de mon addon au m√©langeur, des raisons qui m'ont pouss√© √† le cr√©er, du processus de d√©veloppement et du ¬´succ√®s¬ª sur You...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>G√©n√©rateur de couverture musicale Python dans Blender</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471086/">  Dans cet article, je parlerai de mon addon au m√©langeur, des raisons qui m'ont pouss√© √† le cr√©er, du processus de d√©veloppement et du ¬´succ√®s¬ª sur YouTube. <br><br><img src="https://habrastorage.org/webt/se/0l/3z/se0l3z14g4hz9us38mpb1yetci0.jpeg"><br><a name="habracut"></a><br><br><h3>  Contexte </h3><br>  Tout a commenc√© avec le fait qu'il y a environ un an (en novembre 2018), j'ai vu dans l'offre de YouTube une couverture si inhabituelle sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">The Ultimate Canon</a> <br><br>  Le gars a enregistr√© les √©chantillons de chaque note de la chanson et, √† travers un montage minutieux, a assembl√© la chanson enti√®re √† partir d'eux.  Pour qui c'est, mais je pense que c'est au moins dr√¥le.  Et le nombre de vues (√† l'√©poque un peu plus de 1 000 000) indiquait que le sujet ( <i>1% de comp√©tence en guitare 99% de comp√©tence en √©dition</i> ) √©tait populaire. <br><br>  Je suis s√ªr que ceux qui √©taient au moins un peu impliqu√©s dans le mixage des chansons savent que parfois il est plus facile de couper et d√©placer l√©g√®rement la piste que de demander au guitariste imprudent de rejouer la partie.  Je faisais aussi des couvertures classiques, et m√™me alors j'ai eu l'id√©e de me glisser et de cr√©er une couverture exactement comme le gars de la vid√©o.  Et maintenant je vois que "mon id√©e a √©t√© effront√©ment vol√©e" et j'ai obtenu un bon √©chappement.  J'√©tais ennuy√© que mon train soit parti, mais il m'est apparu que je pouvais faire la m√™me chose, mais √† un niveau diff√©rent, en ajoutant une nouvelle √©tape - <i>1% guitare 1% √©dition 98% comp√©tences en programmation</i> . <br><br>  De plus, cela vous permettra de cr√©er des compositions beaucoup plus complexes, qui, lorsqu'elles sont √©dit√©es manuellement, peu de gens ont la patience. <br><br><h3>  D√©veloppement </h3><br>  La t√¢che consistait donc √† automatiser le processus de d√©coupage d'√©chantillons sonores en une composition musicale. <br><br>  Tout d'abord, il fallait en quelque sorte transmettre au futur programme des donn√©es sur la composition, ses notes, ses pistes, ses instruments.  J'ai imm√©diatement pens√© √† GuitarPro et √† ses options d'exportation de donn√©es: MusicXML et MIDI. <br><br>  Les recherches m'ont amen√© √† choisir un analyseur pour les fichiers midi sur Python <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">music21</a> .  Ce n'est pas seulement un analyseur, mais √† part cela, je n'ai besoin de rien du module.  Et les analogues √©taient soit avec une documentation terrible, soit ne pouvaient pas faire ce dont j'avais besoin aussi facilement que la musique21. <br><br>  G√©nial, maintenant je peux obtenir des donn√©es √† partir de fichiers midi sur les pistes, leurs notes, leur position et leur dur√©e.  Nous allons plus loin. <br><br>  Maintenant, sur la base de ces donn√©es, vous devez couper des fichiers vid√©o / audio.  Ensuite, j'ai choisi assez vite.  Certainement Blender, m√™me malgr√© ses modestes capacit√©s en tant qu'√©diteur vid√©o.  J'ai de l'exp√©rience avec Adobe PremierePro, After Effects, mais il y a mon propre dialecte de script, qui n'est plus utile nulle part, et ses capacit√©s me sont inconnues.  Dans Blender, presque toutes les actions peuvent √™tre effectu√©es via un script Python.  Et cela correspond d√©j√† au langage de la musique21.  Il vaut la peine d'expliquer qu'√† cette √©poque je ne connaissais pas du tout Python, donc j'ai √©galement consid√©r√© ce projet comme une excellente occasion de se familiariser avec ce langage populaire.  Bingo! <br><br>  Peu √† peu, j'ai commenc√© √† me plonger dans le langage, √† publier des notes de fichiers midi sur la console via music21, √† voir rapidement comment ajouter des modules compl√©mentaires au m√©langeur et √† passer √† la premi√®re t√¢che pratique: g√©n√©rer des √©chantillons de donn√©es.  Il a enregistr√© chaque note unique sur la guitare et a commenc√© √† couper, mais s'est rapidement arr√™t√©.  Mon programmeur interne a protest√© contre ce travail minutieux (et il peut y avoir beaucoup de notes pour chaque instrument: 30-50).  Et cela devrait couper les notes et les rendre individuellement dans des fichiers s√©par√©s, et pour ce faire, ajuster chaque note de piste en longueur au d√©but de la timeline ... En g√©n√©ral, ce processus devait √™tre simplifi√©. <br><br>  La solution √©tait d'utiliser une telle chose dans Blender comme marqueurs.  Il s'agit essentiellement de points contenant des informations textuelles pouvant √™tre d√©finies sur un cadre sp√©cifique.  La logique √©tait la suivante: l'utilisateur organise sa vid√©o et son (si l'audio a √©t√© enregistr√© sur une piste distincte), les conduit les uns aux autres et marque avec les marqueurs le d√©but de chaque note dans la vid√©o, et dans le texte du marqueur indique le type de note (A #, D, C et etc.) et sa dur√©e maximale sur l'enregistrement.  Ensuite, les informations sur les marqueurs sont enregistr√©es dans un fichier et sont d√©j√† utilis√©es lors de la d√©coupe de notes individuelles. <br><br><img src="https://habrastorage.org/webt/hj/nh/sp/hjnhspqu2nigpktwpavzf5pk-as.png"><br><br>  Le point suivant √©tait le ¬´noyau¬ª r√©el des notes de coupe fonctionnelles et leur positionnement sur la chronologie.  Ironiquement, il n'y a rien de sp√©cial √† dire: il y avait beaucoup de documentation de lecture, la documentation de Blender √©tait loin d'√™tre toujours assez d√©taill√©e, mais progressivement j'ai atteint ce que je voulais.  Quand j'ai vu (et entendu) le premier r√©sultat (c'√©tait une courte composition du groupe Epidemic - Frodo), le bonheur ne connaissait pas de limites.  Je pense que tout le monde conna√Æt le sentiment quand quelque chose sort enfin. <br><br><img src="https://habrastorage.org/webt/tj/c9/eu/tjc9euayeaoekq8pan04okdssl4.png"><br><br>  La qualit√© du code est m√©diocre.  J'ai essay√© de le faire √† la h√¢te, car  J'imaginais que je n'√©tais pas le seul √† penser √† une telle chose, et que je ne voudrais pas m'avancer ici (spoiler! Comme j'√©tais na√Øf).  Par cons√©quent, je n'ai pas eu le temps d'adh√©rer au style et de r√©fl√©chir √† la structure, j'ai essay√© d'obtenir un prototype fonctionnel plus rapidement. <br><br><h3>  Nuances </h3><br>  Maintenant, pour les nuances de mise en ≈ìuvre.  Blender a une limite dans les couches de l'√©diteur, 32 au maximum. L'image montre que les √©chantillons audio et vid√©o (vert et violet) occupent chacun 14 couches et sont form√©s dans l'ordre croissant, puis √† nouveau au d√©but de leur secteur.  Cela est d√ª au fait que Blender ne vous permettra pas de g√©n√©rer un √©chantillon au-dessus d'un autre.  Et en musique, il arrive souvent que la note suivante commence avant m√™me la fin du son pr√©c√©dent.  Par cons√©quent, afin d'√©viter le chevauchement, j'ai d√©cid√© de g√©n√©rer la note suivante sur un calque plus √©lev√© que le pr√©c√©dent, et lorsque les couches du secteur se terminent, recommencez √† partir de la premi√®re couche (il est peu probable que la premi√®re note retentisse jusqu'√† 14 couches en avant).  Oui, cela pourrait √™tre fait plus intelligemment en enregistrant des couches, mais comme je l'ai dit, j'√©tais press√©. <br><br>  Les plus attentifs pourraient remarquer que le secteur entier est de 2 par 14 couches, c'est 28, et le maximum dans Blender est 32. Le fait est que pour les notes de spawn, vous devez g√©n√©rer 2 pistes originales (vid√©o et audio) via un script puis les couper note.  Et vous ne pouvez pas appara√Ætre sur une autre piste, j'ai donc r√©serv√© les 31e et 32e couches pour cette entreprise.  Les 29th et 30th sont utilis√©s pour le stockage interm√©diaire des pistes d√©j√† g√©n√©r√©es: la g√©n√©ration se produit sous une piste √† partir du fichier midi, puis les notes sont regroup√©es en une seule piste, transf√©r√©es vers la couche 29/30, nous g√©n√©rons la piste suivante, etc. <br><br>  Il y a aussi une nuance: dans les partitions midi, il existe une propri√©t√© telle que la vitesse de lecture.  Et cela peut changer plusieurs fois √† l'int√©rieur de la composition.  En musique21, je n'ai jamais trouv√© l'occasion de suivre ces changements de vitesse.  Par cons√©quent, la vitesse des notes g√©n√©r√©es co√Øncidera avec la toute premi√®re vitesse sp√©cifi√©e dans le fichier midi.  Il existe 2 solutions: <br><br><ol><li>  pour chaque section avec une nouvelle vitesse, cr√©ez un nouveau fichier midi uniquement avec elle; </li><li>  g√©n√©rer √† nouveau des notes de section avec le modificateur de vitesse Tempo (facteur multiplicatif de la vitesse initiale). </li></ol><br><img src="https://habrastorage.org/webt/ul/8s/1j/ul8s1jkhijfs4uebefv9losylik.png"><br><br>  Je pr√©f√®re ajouter mes propres pistes pour chaque vitesse dans GuitarPro, puis dans Blender, il suffit de les g√©n√©rer uniquement avec un modificateur de vitesse, c'est plus rapide et plus difficile √† confondre. <br><br><h3>  Utilitaires Video Editor </h3><br>  Maintenant que vous disposez d'un projet de jeu de pistes g√©n√©r√©es, vous devez monter un couvercle observable.  C'est-√†-dire  positionnez les pistes dans les coins de la vid√©o, changez en fonction de la musique, etc.  Dans un m√©langeur, c'est assez mauvais.  Pour appliquer l'effet √† la piste, vous devez ¬´coller¬ª une autre piste d'en haut, qui sera rendue lors du rendu, et la mettre dans la bonne position. <br><br>  Les accords sont particuli√®rement importants.  C'est lorsque plusieurs notes sonnent en m√™me temps, c'est-√†-dire  lors du rendu d'une vid√©o, seule la note de t√™te de l'accord sera affich√©e.  La solution a √©t√© d'ajouter le m√™me effet (heureusement, ils ne se cassent pas lorsqu'ils se superposent).  Si pendant l'√©dition normale des pistes g√©n√©r√©es, je pouvais tout faire manuellement, alors l'√©dition de chaque note de l'accord est trop.  Comme vous le savez, j'ai √©galement automatis√© cette nuance.  Maintenant, au simple toucher d'un bouton ¬´Chordify strips¬ª, les √©chantillons s√©lectionn√©s seront transform√©s selon les besoins et chaque note de l'accord sera dessin√©e. <br><br><img src="https://habrastorage.org/webt/ft/3y/gg/ft3yggjgwv4_na3gaycf8kxtnma.png"><br><br><img src="https://habrastorage.org/webt/7y/ak/fy/7yakfyj859n2xayjhj5ehl9xvm8.png"><br><br>  Et encore un point d'automatisation: parfois les √©chantillons g√©n√©r√©s ont des parties vides entre eux.  Cela est d√ª au fait que les scores dans ces endroits sont soudainement des endroits vides.  Dans GuitarPro, cela semble normal, en raison de divers effets, le son de la note est conserv√© entre les deux.  Cependant, des vides se forment dans le m√©langeur.  Ils doivent √™tre remplis en √©tirant la note pr√©c√©dente avant la suivante.  Exactement cette t√¢che est effectu√©e par le bouton ¬´Remplir les lacunes¬ª. <br><br>  La fonctionnalit√© de travail avec le volume a √©galement √©t√© √©crite sur des bagatelles, ainsi que la possibilit√© de remplacer une note absente par une autre, mais avec une valeur diff√©rente de la hauteur, ce qui vous permet d'aller au-del√† des limites de la plage de l'instrument (bien qu'en pratique, elle ne d√©passe pas 1 octave). <br><br><h3>  Gloire sur YouTube </h3><br>  Ainsi, l'addon est pr√™t.  Environ un mois et demi a √©t√© d√©pens√© depuis le d√©but de l'id√©e, il a travaill√© le soir, pendant son temps libre.  Il est temps de faire une couverture qui battra la couverture de la main de ce type.  J'ai choisi la m√™me chanson, mais dans un arrangement rock: Canon Rock.  Il est beaucoup plus m√©lodique et plus compliqu√© que l'original, et d√©montrera clairement le nouveau niveau de mon approche.  Oui, et en r√©ponse √† une vid√©o d√©j√† populaire, elle peut attirer l'attention d'un public. <br><br>  Dans le texte ci-dessus, j'ai un peu tromp√©, car  J'ai commenc√© √† travailler sur la couverture en train d'√©crire l'add-on, afin que, √† l'aide de son exemple, je comprenne quelles fonctionnalit√©s sont n√©cessaires et les impl√©mente. <br><br>  Et maintenant, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">couverture est pr√™te et polie</a> !  Il a tourn√© l'introduction et la fin, dans laquelle, en anglais cass√©, il a essay√© d'expliquer la raideur de ma r√©ponse.  Il a prononc√© quelques mots d√©lib√©r√©ment avec des erreurs (compliment√©, double et eff), dans l'espoir d'amener les t√©l√©spectateurs √† modifier dans les commentaires.  Pr√©parer un aper√ßu.  Avec haleine, en pr√©vision du triomphe attendu, a t√©l√©charg√© et publi√© la vid√©o.  Je les ai envoy√©s en groupes de reprises sur des couvertures et j'ai jet√© le lien sur Instagram √† ce type.  Soit dit en passant, il a un surnom tr√®s triomphant: Ralph Jay Triumfo. <br><br>  Le temps a pass√©.  Il n'y a pas eu de triomphe.  Le premier jour, j'ai eu environ 100 vues, dont la moiti√© √©taient les miennes et mes amies.  Puis il y a eu une accalmie.  Avec chaque nouveau jour, je suis devenu de plus en plus d√©√ßu par toute cette entreprise.  Les gens ne comprennent-ils vraiment pas √† quel point je l'ai fait?  Pourquoi le bouche √† oreille ne fonctionne pas?  Ou peut-√™tre que l'id√©e elle-m√™me n'√©tait cool que dans ma t√™te? <br><br>  Quoi qu'il en soit, j'ai aim√© le r√©sultat et j'ai progressivement commenc√© √† faire de plus en plus de nouvelles couvertures. <br>  √Ä cette √©poque, j'ai particip√© au tournage de l'√©mission ¬´Brain Modeling¬ª √† la t√©l√©vision locale, et une fois j'ai mentionn√© mon m√©tier dans une conversation avec l'h√¥te.  Le r√©sultat a √©t√© un petit rapport sur moi.  Maman, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">je suis √† la t√©l√©</a> ! <br><br>  J'ai parfaitement compris que les retrait√©s regardent principalement la t√©l√©vision locale, il n'y avait donc aucune attente. <br><br>  M√™me alors, je voulais me rappeler le code du module compl√©mentaire, optimiser la g√©n√©ration et mettre le module compl√©mentaire dans le domaine public, mais l'√©chec du triomphe a diminu√© mon ardeur.  De plus, la version compl√®te de la nouvelle version de Blender √©tait en cours de pr√©paration et l'API √©voluait.  Je voulais attendre sa sortie cet √©t√© et transf√©rer l'addon dans la nouvelle version, puis le sortir, mais encore une fois, il n'y avait pas de d√©sir particulier. <br><br>  Et maintenant, apr√®s presque un an, alors que les vues de la premi√®re vid√©o d√©passaient √† peine 600, j'ai d√©cid√© de mettre un addon sur le public et d'√©crire cet article, peut-√™tre au moins cela √©gayera mon temps libre, mais en m√™me temps j'ai r√©primand√©. <br><br>  Bien s√ªr, j'ai essay√© de transf√©rer l'addon vers la nouvelle version 2.80, mais il s'est av√©r√© que l'√©diteur vid√©o n'√©tait pas seulement am√©lior√©, mais m√™me aggrav√©.  Les performances sont bien pires, plantent parfois lors de la g√©n√©ration de morceaux lourds.  L'√©diteur lui-m√™me a commenc√© √† ralentir.  L'impossibilit√© d'√©touffer certaines pistes audio (j'esp√®re que c'est un bug, et elles seront corrig√©es dans la prochaine version mineure).  En attendant, l'addon a besoin de la bonne vieille version 2.79 <br><br>  Voici un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien vers l'addon</a> , n'oubliez pas de mettre music21 sur le m√©langeur d'interpr√©teur python.  J'attends avec impatience l'apparition massive de couvertures synth√©tis√©es de votre part. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr471086/">https://habr.com/ru/post/fr471086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr471074/index.html">Synet - un cadre pour lancer des r√©seaux de neurones pr√©-form√©s sur le CPU</a></li>
<li><a href="../fr471076/index.html">Comment la matrice a cr√©√© un h√©ritage pare-balles</a></li>
<li><a href="../fr471078/index.html">Chrome bloquera compl√®tement le contenu mixte</a></li>
<li><a href="../fr471080/index.html">Qui est responsable de la qualit√© des tests de l'application? 10 raisons d'obtenir des erreurs de production</a></li>
<li><a href="../fr471084/index.html">Motifs proc√©duraux pouvant √™tre utilis√©s avec des cartes tuile</a></li>
<li><a href="../fr471088/index.html">Burn-out IT-sp√©cialistes: 4 histoires du manager, d√©veloppeur, produit et administrateur. Et la recette de Southbridge</a></li>
<li><a href="../fr471090/index.html">[Ne pas] utiliser CDN</a></li>
<li><a href="../fr471092/index.html">Commande CP: copier correctement les dossiers de fichiers vers * nix</a></li>
<li><a href="../fr471094/index.html">Tutu.ru et le Club des programmeurs de Moscou sont invit√©s √† une r√©union de backend le 17 octobre</a></li>
<li><a href="../fr471096/index.html">Test public: solution pour la confidentialit√© et l'√©volutivit√© dans Ethereum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>