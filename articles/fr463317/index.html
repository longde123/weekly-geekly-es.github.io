<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîΩ üçï üåó D√©tails techniques du piratage de Capital One Bank sur AWS ‚ûó ‚óæÔ∏è ‚úäüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le 19 juillet 2019, Capital One Bank a re√ßu un message dont toute entreprise moderne a peur - une fuite de donn√©es s'est produite. Elle a touch√© plus ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©tails techniques du piratage de Capital One Bank sur AWS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463317/"><img src="https://habrastorage.org/getpro/habr/post_images/660/704/174/66070417484bc74908f6089c720dc7f4.png"><br><br>  Le 19 juillet 2019, Capital One Bank a re√ßu un message dont toute entreprise moderne a peur - une fuite de donn√©es s'est produite.  Elle a touch√© plus de 106 millions de personnes.  140 000 num√©ros de s√©curit√© sociale aux √âtats-Unis, un million de num√©ros de s√©curit√© sociale au Canada.  80 000 comptes bancaires.  D√©sagr√©able, d'accord? <br><br>  Malheureusement, le piratage n'a pas eu lieu du tout le 19 juillet.  Il s'est av√©r√© que Paige Thompson, alias <i>Erratic</i> , l'a ex√©cut√©e entre le 22 et le 23 mars 2019.  Il y a <u>presque quatre mois</u> .  En fait, ce n'est qu'avec l'aide de consultants externes que Capital One a su que quelque chose s'√©tait pass√©. <br><a name="habracut"></a><br>  Ancienne employ√©e d'Amazon arr√™t√©e, elle risque une amende de 250 000 $ et cinq ans de prison ... mais il y a beaucoup de n√©gativit√©.  Pourquoi?  Parce que de nombreuses entreprises qui ont √©t√© pirat√©es essaient d'√©carter la responsabilit√© du renforcement de leur infrastructure et de leurs applications dans un contexte de cybercriminalit√© croissante. <br><br>  Dans tous les cas, vous pouvez facilement rechercher sur Google cette histoire.  Nous n'entrerons pas dans le th√©√¢tre, mais parlons du c√¥t√© <b>technique</b> des choses. <br><br><h4>  D'abord, que s'est-il pass√©? </h4><br>  Chez Capital One, il y avait environ 700 godets S3 que Paige Thompson a copi√©s et d√©gonfl√©s. <br><br><h4>  Deuxi√®mement, s'agit-il d'un autre cas d'une strat√©gie de compartiment S3 mal configur√©e? </h4><br>  Non, pas cette fois.  Ici, elle a eu acc√®s √† un serveur avec un pare-feu mal configur√© et √† partir de l√†, elle a men√© toute l'op√©ration. <br><br><h4>  Attendez, comment est-ce possible? </h4><br>  Eh bien, commen√ßons par nous connecter au serveur, bien que nous ayons peu de d√©tails.  On nous a seulement dit que cela s'√©tait produit √† travers un ¬´pare-feu mal configur√©¬ª.  Donc, quelque chose d'aussi simple que de mauvais param√®tres de groupe de s√©curit√© ou la configuration du pare-feu d'application Web (Imperva) ou du pare-feu r√©seau (iptables, ufw, shorewall, etc.).  Capital One a seulement plaid√© coupable et d√©clar√© avoir ferm√© le trou. <br><br><blockquote>  Stone a d√©clar√© que Capital One n'avait pas initialement remarqu√© la vuln√©rabilit√© du pare-feu, mais a r√©pondu rapidement d√®s qu'il l'a d√©couvert.  Bien s√ªr, cela a √©t√© aid√© par le fait que le pirate aurait laiss√© les informations d'identification cl√©s accessibles au public, a d√©clar√© Stone. </blockquote><br>  <i>Si vous souhaitez savoir pourquoi nous ne nous penchons pas sur cette partie, sachez qu'en raison d'informations limit√©es, nous ne pouvons que sp√©culer.</i>  <i>Cela est inutile √©tant donn√© que le hack d√©pendait de l'√©cart laiss√© par Capital One.</i>  <i>Et s'ils ne nous en disent pas plus, nous √©num√©rerons simplement toutes les fa√ßons possibles dont Capital One a laiss√© son serveur ouvert en combinaison avec toutes les fa√ßons possibles dont quelqu'un pourrait utiliser l'une de ces diff√©rentes options.</i>  <i>Ces lacunes et ces m√©thodes peuvent aller des oublis incroyablement stupides √† des sch√©mas incroyablement complexes.</i>  <i>Compte tenu de l'√©ventail des possibilit√©s, cela se transformera en une longue saga sans v√©ritable conclusion.</i>  <i>Par cons√©quent, nous nous concentrerons sur l'analyse de la partie o√π nous avons les faits.</i> <br><br><h4>  Donc la premi√®re conclusion: sachez ce que vos pare-feu permettent </h4><br>  √âtablissez une politique ou un processus pour vous assurer que SEULEMENT ce qui est ouvert l'est.  Si vous utilisez des ressources AWS, telles que des groupes de s√©curit√© ou des listes de contr√¥le d'acc√®s r√©seau, la liste de contr√¥le pour la v√©rification peut √©videmment √™tre longue ... mais comme de nombreuses ressources sont cr√©√©es automatiquement (c'est-√†-dire CloudFormation), vous pouvez √©galement automatiser leur audit.  Qu'il s'agisse d'un script de fortune qui recherche de nouveaux objets √† la recherche de d√©fauts, ou quelque chose comme un audit de s√©curit√© dans un processus CI / CD ... il existe de nombreuses options faciles pour √©viter cela. <br><br>  La partie ¬´amusante¬ª de l'histoire est que si Capital One avait ferm√© le trou depuis le d√©but ... rien ne serait arriv√©.  Et donc, franchement, il est toujours choquant de voir √† quel point quelque chose de <i><b>tr√®s simple</b></i> devient la seule raison pour laquelle une entreprise de piratage informatique.  Surtout aussi grand que Capital One. <br><br><h4>  Donc, le pirate √† l'int√©rieur - que s'est-il pass√© ensuite? </h4><br>  Eh bien, apr√®s avoir p√©n√©tr√© dans l'instance EC2 ... beaucoup de choses peuvent mal se passer.  Vous marchez presque le long d'un couteau si vous permettez √† quelqu'un d'aller aussi loin.  Mais comment est-elle entr√©e dans le seau S3?  Pour comprendre cela, discutons des r√¥les d'IAM (r√¥les IAM). <br><br>  Ainsi, une fa√ßon d'acc√©der aux services AWS est d'√™tre un utilisateur.  D'accord, c'est assez √©vident.  Mais que se passe-t-il si vous souhaitez donner √† d'autres services AWS, par exemple vos serveurs d'applications, un acc√®s √† vos compartiments S3?  Pour cela, il existe des r√¥les IAM.  Ils se composent de deux √©l√©ments: <br><br><ol><li>  Politique de confiance - quels services ou quelles personnes peuvent utiliser ce r√¥le? <br></li><li>  Politique d'autorisations - que permet ce r√¥le? </li></ol><br>  Par exemple, vous souhaitez cr√©er un r√¥le IAM qui permettra aux instances EC2 d'acc√©der au compartiment S3: tout d'abord, il configure une strat√©gie de confiance pour le r√¥le, afin que EC2 (l'ensemble du service) ou des instances sp√©cifiques puissent prendre le relais.  Assumer un r√¥le signifie qu'ils peuvent utiliser des autorisations de r√¥le pour effectuer des actions.  Deuxi√®mement, la politique d'autorisations permet au service / personne / ressource qui "a assum√© le r√¥le" de faire quelque chose sur S3, que ce soit l'acc√®s √† un compartiment sp√©cifique ... ou √† plus de 700, comme dans le cas de Capital One. <br><br>  Une fois que vous √™tes dans une instance EC2 avec le r√¥le IAM, vous pouvez obtenir des informations d'identification de plusieurs mani√®res: <br><br><ol><li> Vous pouvez demander des m√©tadonn√©es d'instance √† <code>http://169.254.169.254/latest/meta-data</code> <br><br>  Entre autres choses, √† cette adresse, vous pouvez trouver le r√¥le IAM avec l'une des cl√©s d'acc√®s.  Bien s√ªr, seulement si vous √™tes dans une instance. <br></li><li>  Utiliser AWS CLI ... <br><br>  Si l'interface de ligne de commande AWS est install√©e, elle est charg√©e avec les informations d'identification des r√¥les IAM, le cas √©ch√©ant.  Il ne reste plus qu'√† travailler sur l'instance.  Bien s√ªr, si leur politique de confiance √©tait ouverte, Page pourrait le faire directement. </li></ol><br>  Ainsi, l'essence des r√¥les IAM est qu'ils permettent √† une ressource d'agir √Ä PARTIR DE VOTRE NOM sur D'AUTRES RESSOURCES. <br><br><h4>  Maintenant que vous comprenez les r√¥les d'IAM, nous pouvons parler de ce que Page Thompson a fait: </h4><br><ol><li>  Elle a acc√©d√© au serveur (instance EC2) √† travers un trou dans le pare-feu <br><br>  Qu'il s'agisse de groupes de s√©curit√© / ACL ou de leurs propres pare-feu d'applications Web, le trou √©tait probablement assez facile √† fermer, comme indiqu√© dans les documents officiels. <br></li><li>  Une fois sur le serveur, elle a pu agir "comme si" elle √©tait le serveur <br></li><li>  √âtant donn√© que le r√¥le de serveur IAM permettait √† S3 d'acc√©der √† ces 700+ compartiments, elle a pu y acc√©der </li></ol><br>  D√©sormais, elle ne pouvait ex√©cuter que la commande <code>List Buckets</code> , puis la commande <code>Sync</code> de l'AWS CLI ... <br><br><hr><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Capital One Bank estime les dommages caus√©s par le piratage √† un montant de 100 √† 150 MILLIONS de dollars</a> .  Pour √©viter de tels dommages, les entreprises investissent tant dans la protection de l'infrastructure cloud, des DevOps et des experts en s√©curit√©.  Et quelle est la valeur et la rentabilit√© de la transition vers le cloud?  √Ä tel point que m√™me face √† de plus en plus de probl√®mes de cybers√©curit√©, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">march√© global du cloud public a progress√© de 42% au premier trimestre 2019</a> ! <br><br>  La morale de cette histoire: v√©rifiez votre s√©curit√©;  effectuer des audits r√©guliers;  respecter le principe du moindre privil√®ge pour les politiques de s√©curit√©. <br><br>  (Vous pouvez voir le rapport juridique complet ici). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463317/">https://habr.com/ru/post/fr463317/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463303/index.html">Facebook arr√™te enfin de cibler les annonces pour les num√©ros de t√©l√©phone que les gens saisissent pour 2FA</a></li>
<li><a href="../fr463305/index.html">Outils d'analyse et de d√©bogage des applications .NET</a></li>
<li><a href="../fr463307/index.html">√âtude de cas sur la communication avec un client ¬´lourd¬ª</a></li>
<li><a href="../fr463311/index.html">CTT dans les solutions serveur. La deuxi√®me version + l'annonce de la troisi√®me, avec la possibilit√© de toucher</a></li>
<li><a href="../fr463313/index.html">Une approche alternative pour vous abonner √† des √©v√©nements, ou EventObject est-il vraiment n√©cessaire?</a></li>
<li><a href="../fr463321/index.html">Paniers et caisses de convivialit√©: analyse des 20 meilleurs magasins de niche russes en ligne</a></li>
<li><a href="../fr463325/index.html">R√©flexion de Game Designer: Personnages pour un jeu qui n'est pas sorti</a></li>
<li><a href="../fr463327/index.html">Vue.js: 3 anti-patterns</a></li>
<li><a href="../fr463329/index.html">D√©veloppement de diagrammes d'arbres dynamiques √† l'aide de SVG et Vue.js</a></li>
<li><a href="../fr463331/index.html">Client Apollo. Maintenant avec des crochets React</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>