<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õÖÔ∏è üê´ üõ£Ô∏è √âquipement sans fil NooLite et maison intelligente (partie 1). Arduino üóùÔ∏è üßëüèΩ‚Äçü§ù‚Äçüßëüèº üëáüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour chers lecteurs de Geektimes! Cette fois, je veux attirer votre attention sur une s√©rie d'articles sur l'int√©gration de l'√©quipement sans fil n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√âquipement sans fil NooLite et maison intelligente (partie 1). Arduino</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/389067/"><img src="https://habrastorage.org/files/d8c/f00/38e/d8cf0038e7a040fe8e07446481c0a1a0.jpg" alt="nooLite"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonjour chers lecteurs de Geektimes! </font><font style="vertical-align: inherit;">Cette fois, je veux attirer votre attention sur une s√©rie d'articles sur l'int√©gration de l'√©quipement sans fil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les syst√®mes domotiques. </font><font style="vertical-align: inherit;">Ce cycle sera similaire √† la s√©rie d'articles d√©j√† publi√©e ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trois</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) sur l'int√©gration des modules Laurent dans les syst√®mes Smart Home, seulement il parlera du syst√®me nooLite et apr√®s avoir lu ce cycle, vous n'aurez plus de questions sur la gestion des appareils nooLite depuis votre Smart √† la maison.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de la s√©rie d'articles</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cycle est divis√© en trois parties. Dans la premi√®re partie, vous d√©couvrirez les principes de fonctionnement de l'√©quipement sans fil nooLite et comment le g√©rer √† partir de vos projets Arduino. La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deuxi√®me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partie d√©crira en d√©tail l'int√©gration du module de contr√¥le MT1132 dans l'Arduino Mega Server et les possibilit√©s de gestion d'une maison intelligente qui s'ouvrent dans cette connexion. Et le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">troisi√®me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article de la s√©rie sera consacr√© √† un sujet tr√®s int√©ressant - le concept de cr√©ation d'appareils ¬´100 en 1¬ª bas√©s sur l'Arduino Mega Server. Un exemple de cr√©ation d'une station de soudage sans fil sur AMS sera examin√© en d√©tail, litt√©ralement √† partir de rien - sur la base d'un seul gradateur sans fil nooLite. Il y aura √©galement une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quatri√®me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partie √† partir de laquelle vous apprendrez √† cr√©er un cristal magique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä propos, la station de soudage, qui sera discut√©e dans le troisi√®me article, est d√©j√† pr√©sente dans le dernier assemblage </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous le num√©ro 0.14. </font><font style="vertical-align: inherit;">Et les lecteurs les plus curieux ne peuvent pas attendre le troisi√®me article, mais t√©l√©chargez imm√©diatement le kit de distribution et d√©couvrez comment tout cela fonctionne par eux-m√™mes. </font></font><br>
<br>
<img src="https://habrastorage.org/files/428/a18/eeb/428a18eeb1f84623bc6c9f8d59e08974.jpg" alt="station de soudure"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et la grande chose est qu'il peut y avoir des centaines de tels appareils dans AMS, et en m√™me temps. </font><font style="vertical-align: inherit;">Par exemple, une station de soudage, une station m√©t√©o, une unit√© de s√©curit√©, un contr√¥leur de serre, etc. Et tout cela peut fonctionner simultan√©ment ou ¬´d√©marrer¬ª en chargeant une page Web ou m√™me un site entier d√©di√© √† un appareil sp√©cifique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ne prenons pas de l'avance sur nous-m√™mes, laissons le plus int√©ressant au final, mais pour l'instant nous ferons la pr√©paration th√©orique n√©cessaire. </font><font style="vertical-align: inherit;">Je promets que tout sera √©nonc√© de la mani√®re la plus simple et la plus intelligible. </font><font style="vertical-align: inherit;">Commen√ßons donc.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âquipement NooLite</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©quipement NooLite est d√©j√† un syst√®me bien connu et populaire et il y a beaucoup d'informations √† ce sujet sur Internet. </font><font style="vertical-align: inherit;">Je vais essayer de r√©sumer les principaux points ici. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le concept est tr√®s simple - il existe des unit√©s de puissance pour contr√¥ler la lumi√®re et diverses charges, et des panneaux de commande qui envoient des commandes √† ces unit√©s de puissance. </font><font style="vertical-align: inherit;">Et tout cela fonctionne, naturellement, sans la participation de connexions filaires. </font><font style="vertical-align: inherit;">En fait, tout. </font><font style="vertical-align: inherit;">La beaut√© du syst√®me est que tous les composants sont pens√©s, bien fabriqu√©s et font exactement ce qu'il dit - ils contr√¥lent de mani√®re fiable l'√©quipement connect√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe √©galement des capteurs sans fil, le contr√¥le des appareils √† partir d'un smartphone et bien plus encore, mais il est impossible de tout couvrir dans un seul article, ici, nous nous concentrerons uniquement sur l'int√©gration de nooLite avec la populaire plateforme de bricolage - Arduino.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De l'ensemble du vaste √©ventail d'√©quipements nooLite, nous serons int√©ress√©s par le module de contr√¥le MT1132 car il est con√ßu pour se connecter √† des ordinateurs Arduino et √† carte unique tels que le Raspberry Pi. Et cela fonctionne sur une simple interface s√©rie. Pour l'avenir, je dirai que j'ai aim√© le module en raison de sa simplicit√©, de sa pr√©visibilit√© et de son fonctionnement fiable. Et j'ai pu appr√©cier ces qualit√©s apr√®s un mois de lutte infructueuse avec le module r√©seau sur la puce W5500, qui ne voulait pas fonctionner normalement. </font></font><br>
<br>
<img src="https://habrastorage.org/files/af4/5a9/4dc/af45a94dc2684467920e9191ebcafc83.jpg" alt="Module MT1132"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et j'ai particuli√®rement appr√©ci√© le fait que (hormis l'alimentation) le module est connect√© √† l'Arduino avec un seul (!) Fil (RX). Le second (TX) peut √™tre compl√®tement omis. Le module est "unidirectionnel", c'est-√†-dire qu'il est con√ßu uniquement pour envoyer des signaux de commande. Les plans de la soci√©t√© Nootehnika incluent le d√©veloppement et la sortie d'une version ¬´bidirectionnelle¬ª du module.</font></font><br>
<br>
<img src="https://habrastorage.org/files/60c/dfb/d07/60cdfbd0709b41b88b19a00638637d59.jpg" alt="SU111-300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxi√®me √©l√©ment dont nous avons besoin de l'√©quipement nooLite est une unit√© de commande de puissance, par exemple SU111-300. La connexion de l'unit√© est √©l√©mentaire et peut √™tre vue dans l'illustration. Deux fils sont connect√©s √† un r√©seau de 220 volts et les deux autres √† la charge. La seule chose √† laquelle je voudrais faire attention est que les modules sont fournis avec un cavalier qui bloque le mode de gradation et, si vous souhaitez r√©gler la puissance, vous devez couper ce cavalier (et n'oubliez pas d'isoler les fils nus r√©sultants).</font></font><br>
<br>
<img src="https://habrastorage.org/files/acf/cd5/4ad/acfcd54ad9ab4c57bf6409799dd3a133.jpg" alt="PU311-2"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne m'attarderai pas sur les t√©l√©commandes car il s'agit d'un contr√¥le ¬´manuel¬ª, et nous, en lien avec l'automatisation, nous int√©ressons davantage √† l'automatique. </font><font style="vertical-align: inherit;">Je peux seulement dire que les exp√©riences ont √©t√© effectu√©es avec la t√©l√©commande PU311-2, faite sous la forme d'un interrupteur mural et qu'elle s'est montr√©e de la meilleure fa√ßon, c'est-√†-dire qu'elle a allum√© et √©teint la lumi√®re clairement et sans √©checs. </font><font style="vertical-align: inherit;">En fait, quel est le bon √©quipement et diff√©rent du mauvais - vous ne remarquez tout simplement pas le bon.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Concept de travail. </font><font style="vertical-align: inherit;">Liaison et dissociation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de pouvoir allumer et √©teindre les appareils √©lectriques √† l'aide du syst√®me nooLite, vous devez ¬´relier¬ª les modules de commande aux unit√©s d'alimentation correspondantes. Cela se fait en utilisant la proc√©dure dite. ¬´Liaisons¬ª et ¬´d√©liement¬ª, d√©crites en d√©tail dans la documentation nooLite. En bref, tout se r√©sume √† appuyer sur une paire de boutons sur les blocs li√©s et ne pr√©sente aucune difficult√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas o√π le module de contr√¥le MT1132 est utilis√© √† la place de la t√©l√©commande, la proc√©dure se d√©roule de mani√®re l√©g√®rement diff√©rente. A savoir: puisque le module n'a pas de boutons, vous devez g√©n√©rer et envoyer par programmation une commande de contr√¥le sur le canal souhait√©, puis appuyez sur le bouton de l'unit√© d'alimentation, confirmant la ¬´liaison¬ª ou le ¬´d√©liement¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les canaux sont des ¬´lignes de contr√¥le¬ª et il y en a 32 dans le module MT1132, comme en t√©moignent les deux derniers chiffres du nom. </font><font style="vertical-align: inherit;">Cela signifie qu'avec ce module, vous pouvez g√©rer 32 groupes d'√©quipements distincts, ce qui est plus que suffisant pour un appartement ou une petite maison. </font><font style="vertical-align: inherit;">Si vous avez une grande maison, les modules peuvent fonctionner conjointement et s'adapter √† n'importe quel nombre de canaux.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du protocole</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un merveilleux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">document sur le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site Web de la soci√©t√© Nootehnika </font><font style="vertical-align: inherit;">qui d√©crit de mani√®re compl√®te et d√©taill√©e la connexion du module et son protocole de contr√¥le. </font><font style="vertical-align: inherit;">Je n'encombrerai pas l'article de d√©tails techniques inutiles, n'importe qui peut lire ce document, je ne d√©crirai que les points principaux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contr√¥ler le module, nous devons former une commande de contr√¥le compos√©e de 12 octets. </font><font style="vertical-align: inherit;">Les principes de formation de cette √©quipe sont d√©crits dans le document ci-dessus. </font><font style="vertical-align: inherit;">Et comme vous le verrez ci-dessous, toutes ces r√®gles sont d√©j√† programm√©es dans les fonctions de contr√¥le et il suffit de les utiliser pour √©mettre des commandes sur le module.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âquipes de test</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nooLite poss√®de un syst√®me de commande assez d√©velopp√©, √† partir duquel nous s√©lectionnerons les plus simples et les plus courants et illustrerons le syst√®me √† l'aide de leur exemple.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Snap</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©lier</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inclusion</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âteint</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©glage de puissance (gradation)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comprendre le fonctionnement des √©quipes de base, vous pouvez facilement en utiliser une autre.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion du module MT1132</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai d√©j√† dit, le module MT1132 est litt√©ralement connect√© avec un fil (sauf pour l'alimentation). </font><font style="vertical-align: inherit;">Le module peut √™tre aliment√© √† la fois par une tension de 5 volts et une tension de 3,3 volts. </font><font style="vertical-align: inherit;">Par cons√©quent, il n'y a eu aucun probl√®me de connexion √† l'Arduino Mega 5 volts ou √† l'Arduino Due 3,3 volts. </font><font style="vertical-align: inherit;">Le seul point est qu'avec une puissance r√©duite, la plage de fonctionnement fiable du syst√®me diminue. </font><font style="vertical-align: inherit;">Et cela doit √™tre pris en compte si vous souhaitez alimenter le module √† partir d'une tension de 3,3 volts.</font></font><br>
<br>
<img src="https://habrastorage.org/files/fb8/2a4/d76/fb82a4d769cb49bda099e57591c13157.jpg" alt="Arduino"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le module poss√®de des broches RX et TX pour recevoir et envoyer des signaux via l'interface s√©rie. </font><font style="vertical-align: inherit;">La connexion du RX, pour recevoir les commandes de contr√¥le du contr√¥leur, est essentielle pour le fonctionnement du module. </font><font style="vertical-align: inherit;">Par cons√©quent, la broche RX c√¥t√© module est connect√©e √† la broche TX (18) c√¥t√© Arduino. </font><font style="vertical-align: inherit;">Ce brochage est valable pour Arduino Mega et Arduino Due.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie logiciel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons maintenant comment g√©rer toute cette √©conomie √† partir de croquis sur Arduino. </font><font style="vertical-align: inherit;">Tout d'abord, initialisez Serial1, auquel nous avons connect√© le module MT1132 (cela se fait √† la fr√©quence standard 9600):</font></font><br>
<br>
<pre><code class="java hljs">Serial1.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, le code de la fonction de contr√¥le principale:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooSendCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> channel, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> format)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> buf[<span class="hljs-number"><span class="hljs-number">12</span></span>];<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>; i++) {<font></font>
    buf[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">85</span></span>;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">1</span></span>] = B01010000;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">2</span></span>] = command;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">3</span></span>] = format;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">5</span></span>] = channel;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">6</span></span>] = data;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checkSum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; i++) {<font></font>
    checkSum += buf[i];<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">10</span></span>] = lowByte(checkSum);<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">11</span></span>] = <span class="hljs-number"><span class="hljs-number">170</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; (<span class="hljs-number"><span class="hljs-number">12</span></span>); i++) {<font></font>
    Serial1.write(buf[i]);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, nous n'avons m√™me pas besoin de savoir comment cela fonctionne, nous pouvons l'utiliser en mode ¬´bo√Æte noire¬ª ou une sorte d'API, avec une certaine interface qui sort. </font><font style="vertical-align: inherit;">Nous avons juste besoin de savoir comment utiliser cette interface. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, il n'y a que quatre param√®tres - canal, commande, donn√©es et format. </font><font style="vertical-align: inherit;">Vous pouvez lire par quel principe les requ√™tes √† cette API peuvent √™tre lues dans le document susmentionn√©, mais nous simplifierons encore plus notre t√¢che et encapsulerons cette interface dans de simples commandes de contr√¥le de p√©riph√©rique nooLite.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooBind</span></span></span><span class="hljs-function">  </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooUnbind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOn</span></span></span><span class="hljs-function">    </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOff</span></span></span><span class="hljs-function">   </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooValue</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">6</span></span>, v, <span class="hljs-number"><span class="hljs-number">1</span></span>);}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une √©quipe relativement complexe n'est que la derni√®re, l√†, en plus du canal, le niveau de puissance est √©galement r√©gl√©. </font><font style="vertical-align: inherit;">Il y a aussi des √©quipes dans le croquis sur lesquelles nous ne nous attarderons pas maintenant, mais elles se forment tout aussi facilement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait ... c'est tout! </font><font style="vertical-align: inherit;">Nulle part est plus facile. </font><font style="vertical-align: inherit;">Dans le code, les commandes de contr√¥le ressemblent √† ceci:</font></font><br>
<br>
<pre><code class="java hljs">nooBind(ch);<font></font>
nooUnbind(ch);<font></font>
nooOn(ch);<font></font>
nooOff(ch);<font></font>
nooValue(ch, v);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons maintenant la pratique de la gestion du module d'alimentation nooLite. </font><font style="vertical-align: inherit;">Donc, nous lions le bloc d'alimentation sur le canal z√©ro:</font></font><br>
<br>
<pre><code class="java hljs">nooBind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le voyant du bloc d'alimentation commence √† clignoter. </font><font style="vertical-align: inherit;">Appuyez sur le bouton du bloc - la LED cesse de clignoter - le bloc d'alimentation est connect√©. </font><font style="vertical-align: inherit;">Au lieu du canal z√©ro, vous pouvez utiliser n'importe quel autre. </font><font style="vertical-align: inherit;">Et vous pouvez facilement g√©n√©rer le num√©ro de canal dans le code d'esquisse en fonction de vos besoins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allumez la lampe (si nous avons attach√© la lampe sur le canal z√©ro, les commandes doivent √™tre envoy√©es sur ce canal):</font></font><br>
<br>
<pre><code class="java hljs">nooOn(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©glez la puissance (luminosit√© de la lampe):</font></font><br>
<br>
<pre><code class="java hljs">nooValue(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous devez parler un peu des r√®gles de formation d'une √©quipe qui d√©finit le niveau de puissance. La valeur de la puissance ne change pas de 0 √† 255, comme on pourrait le penser, mais de 35 √† 155. Si la valeur est sup√©rieure √† 155, alors la puissance sera maximale, si elle est de 0, alors ce sera √©quivalent √† une commande d'arr√™t. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici (juste au cas o√π) une formule qui traduit les valeurs ¬´standard¬ª de 0 √† 100 dans un format compris par le module nooLite:</font></font><br>
<br>
<pre><code class="java hljs">v = x * <span class="hljs-number"><span class="hljs-number">1.2</span></span> + <span class="hljs-number"><span class="hljs-number">34</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant cette formule, vous pouvez r√©gler la luminosit√© de la lampe dans le pourcentage de puissance habituel. </font><font style="vertical-align: inherit;">Et, bien s√ªr, si vous avez besoin d'ajuster la puissance de mani√®re non lin√©aire, vous pouvez cr√©er une variable v selon n'importe quelle loi ou m√™me simplement choisir des valeurs fixes. </font><font style="vertical-align: inherit;">Cela sera discut√© dans la troisi√®me partie du cycle, lorsque nous ajusterons la temp√©rature de chauffage de la station de soudage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âteignez l'appareil:</font></font><br>
<br>
<pre><code class="java hljs">nooOff(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©lier:</font></font><br>
<br>
<pre><code class="java hljs">nooUnbind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le voyant du bloc d'alimentation commence √† clignoter. </font><font style="vertical-align: inherit;">Nous confirmons le d√©couplage en appuyant sur le bouton du bloc d'alimentation. </font><font style="vertical-align: inherit;">√áa y est, maintenant le bloc d'alimentation a cess√© de r√©pondre √† nos commandes et nous pouvons le ¬´snap¬ª √† nouveau sur l'un des 32 canaux du module nooLite MT1132. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici le croquis complet.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code d'esquisse complet</font></font></b><div class="spoiler_text">byte const PIN_TX = 18; // TX PIN (to RX noolite)<br>
byte const PIN_RX = 19; // RX PIN (to TX noolite)<br>
<br>
void nooSendCommand(byte channel, byte command, byte data, byte format) {<br>
 byte buf[12];<br>
<br>
for (byte i = 0; i &lt; 12; i++) {<br>
 buf[i] = 0;<br>
 }<br>
<br>
buf[0] = 85;<br>
 buf[1] = B01010000;<br>
 buf[2] = command;<br>
 buf[3] = format;<br>
 buf[5] = channel;<br>
 buf[6] = data;<br>
<br>
int checkSum = 0;<br>
 for (byte i = 0; i &lt; 10; i++) {<br>
 checkSum += buf[i];<br>
 }<br>
<br>
buf[10] = lowByte(checkSum);<br>
 buf[11] = 170;<br>
<br>
for (byte i = 0; i &lt; (12); i++) {<br>
 Serial1.write(buf[i]);<br>
 }<br>
}<br>
<br>
void nooBind (byte ch) {nooSendCommand(ch, 15, 0, 0);}<br>
void nooUnbind (byte ch) {nooSendCommand(ch, 9, 0, 0);}<br>
<br>
void nooOn (byte ch) {nooSendCommand(ch, 2, 0, 0);}<br>
void nooOff (byte ch) {nooSendCommand(ch, 0, 0, 0);}<br>
void nooTrigger(byte ch) {nooSendCommand(ch, 4, 0, 0);}<br>
void nooCancel (byte ch) {nooSendCommand(ch, 10, 0, 0);}<br>
<br>
void nooUp (byte ch) {nooSendCommand(ch, 3, 0, 0);}<br>
void nooDown (byte ch) {nooSendCommand(ch, 1, 0, 0);}<br>
void nooRevers (byte ch) {nooSendCommand(ch, 5, 0, 0);}<br>
<br>
void nooValue (byte ch, byte v) {nooSendCommand(ch, 6, v, 1);}<br>
<br>
void setup() {<br>
 Serial1.begin(9600);<br>
<br>
/*     <br>
      loop(),    */<br>
<br>
//nooBind(0);<br>
<br>
//nooOn(0);<br>
 //nooOff(0);<br>
 //nooValue(0, 100);<br>
<br>
//nooUnbind(0); <br>
}<br>
<br>
void loop(){<br>
<br>
}<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sous-total</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, </font><font style="vertical-align: inherit;">il n'y a rien de compliqu√© </font><font style="vertical-align: inherit;">√† contr√¥ler les modules de puissance </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite en</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant Arduino, au contraire, le contr√¥le est incroyablement simple: le module est connect√© avec un seul fil, et les commandes sont presque un langage humain naturel - ¬´allumez le canal 0¬ª, ¬´√©teignez le canal 1¬ª, ¬´R√©gler la puissance de 50% sur le canal 3¬ª n'est vraiment nulle part plus simple.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus pour ceux qui ont lu jusqu'au bout</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'autre jour, une nouvelle version d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server est sortie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous le num√©ro 0.14, dans laquelle toutes les maladies infantiles de la technologie sont surmont√©es et qui fonctionne rapidement et de mani√®re stable. </font><font style="vertical-align: inherit;">Et la m√™me version contient le noyau de contr√¥le d'instrument nooLite int√©gr√© et comment tout cela fonctionne, vous apprendrez du prochain article de la s√©rie ¬´√âquipement sans fil nooLite et maison intelligente (partie 2). </font><font style="vertical-align: inherit;">Arduino Mega Server. " </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les deuxi√®me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">troisi√®me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quatri√®me</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parties du cycle.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr389067/">https://habr.com/ru/post/fr389067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr389051/index.html">CNET Smart Home: terrain d'essai de gadgets</a></li>
<li><a href="../fr389053/index.html">Maison intelligente. Cerveaux</a></li>
<li><a href="../fr389057/index.html">CES 2016: LG et Samsung annoncent une maison intelligente</a></li>
<li><a href="../fr389063/index.html">Comment les voitures carr√©es des ann√©es 80 ont √©t√© rationalis√©es par les ann√©es 90</a></li>
<li><a href="../fr389065/index.html">La sonde de l'aube a envoy√© des photos d√©taill√©es des crat√®res de Ceres</a></li>
<li><a href="../fr389069/index.html">Remix OS, un OS multi-fen√™tres bas√© sur Android, est maintenant disponible pour PC</a></li>
<li><a href="../fr389071/index.html">Brouillage dans les syst√®mes mondiaux de navigation par satellite</a></li>
<li><a href="../fr389073/index.html">Branto ORB: une balle presque magique pour contr√¥ler votre maison</a></li>
<li><a href="../fr389075/index.html">–†–∞—Å–ø—Ä–æ–¥–∞–∂–∞ –≤ –°—Ç–∞—Ä—ã–π –ù–æ–≤—ã–π –≥–æ–¥</a></li>
<li><a href="../fr389077/index.html">Fondateur d'Oculus: le PC basse consommation est le principal obstacle √† la vulgarisation de la r√©alit√© virtuelle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>