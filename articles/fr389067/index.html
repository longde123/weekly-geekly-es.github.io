<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛅️ 🐫 🛣️ Équipement sans fil NooLite et maison intelligente (partie 1). Arduino 🗝️ 🧑🏽‍🤝‍🧑🏼 👇🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour chers lecteurs de Geektimes! Cette fois, je veux attirer votre attention sur une série d'articles sur l'intégration de l'équipement sans fil n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Équipement sans fil NooLite et maison intelligente (partie 1). Arduino</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/389067/"><img src="https://habrastorage.org/files/d8c/f00/38e/d8cf0038e7a040fe8e07446481c0a1a0.jpg" alt="nooLite"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonjour chers lecteurs de Geektimes! </font><font style="vertical-align: inherit;">Cette fois, je veux attirer votre attention sur une série d'articles sur l'intégration de l'équipement sans fil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les systèmes domotiques. </font><font style="vertical-align: inherit;">Ce cycle sera similaire à la série d'articles déjà publiée ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trois</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) sur l'intégration des modules Laurent dans les systèmes Smart Home, seulement il parlera du système nooLite et après avoir lu ce cycle, vous n'aurez plus de questions sur la gestion des appareils nooLite depuis votre Smart à la maison.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos de la série d'articles</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cycle est divisé en trois parties. Dans la première partie, vous découvrirez les principes de fonctionnement de l'équipement sans fil nooLite et comment le gérer à partir de vos projets Arduino. La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deuxième</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partie décrira en détail l'intégration du module de contrôle MT1132 dans l'Arduino Mega Server et les possibilités de gestion d'une maison intelligente qui s'ouvrent dans cette connexion. Et le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">troisième</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article de la série sera consacré à un sujet très intéressant - le concept de création d'appareils «100 en 1» basés sur l'Arduino Mega Server. Un exemple de création d'une station de soudage sans fil sur AMS sera examiné en détail, littéralement à partir de rien - sur la base d'un seul gradateur sans fil nooLite. Il y aura également une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quatrième</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partie à partir de laquelle vous apprendrez à créer un cristal magique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À propos, la station de soudage, qui sera discutée dans le troisième article, est déjà présente dans le dernier assemblage </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous le numéro 0.14. </font><font style="vertical-align: inherit;">Et les lecteurs les plus curieux ne peuvent pas attendre le troisième article, mais téléchargez immédiatement le kit de distribution et découvrez comment tout cela fonctionne par eux-mêmes. </font></font><br>
<br>
<img src="https://habrastorage.org/files/428/a18/eeb/428a18eeb1f84623bc6c9f8d59e08974.jpg" alt="station de soudure"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et la grande chose est qu'il peut y avoir des centaines de tels appareils dans AMS, et en même temps. </font><font style="vertical-align: inherit;">Par exemple, une station de soudage, une station météo, une unité de sécurité, un contrôleur de serre, etc. Et tout cela peut fonctionner simultanément ou «démarrer» en chargeant une page Web ou même un site entier dédié à un appareil spécifique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ne prenons pas de l'avance sur nous-mêmes, laissons le plus intéressant au final, mais pour l'instant nous ferons la préparation théorique nécessaire. </font><font style="vertical-align: inherit;">Je promets que tout sera énoncé de la manière la plus simple et la plus intelligible. </font><font style="vertical-align: inherit;">Commençons donc.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Équipement NooLite</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'équipement NooLite est déjà un système bien connu et populaire et il y a beaucoup d'informations à ce sujet sur Internet. </font><font style="vertical-align: inherit;">Je vais essayer de résumer les principaux points ici. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le concept est très simple - il existe des unités de puissance pour contrôler la lumière et diverses charges, et des panneaux de commande qui envoient des commandes à ces unités de puissance. </font><font style="vertical-align: inherit;">Et tout cela fonctionne, naturellement, sans la participation de connexions filaires. </font><font style="vertical-align: inherit;">En fait, tout. </font><font style="vertical-align: inherit;">La beauté du système est que tous les composants sont pensés, bien fabriqués et font exactement ce qu'il dit - ils contrôlent de manière fiable l'équipement connecté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe également des capteurs sans fil, le contrôle des appareils à partir d'un smartphone et bien plus encore, mais il est impossible de tout couvrir dans un seul article, ici, nous nous concentrerons uniquement sur l'intégration de nooLite avec la populaire plateforme de bricolage - Arduino.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De l'ensemble du vaste éventail d'équipements nooLite, nous serons intéressés par le module de contrôle MT1132 car il est conçu pour se connecter à des ordinateurs Arduino et à carte unique tels que le Raspberry Pi. Et cela fonctionne sur une simple interface série. Pour l'avenir, je dirai que j'ai aimé le module en raison de sa simplicité, de sa prévisibilité et de son fonctionnement fiable. Et j'ai pu apprécier ces qualités après un mois de lutte infructueuse avec le module réseau sur la puce W5500, qui ne voulait pas fonctionner normalement. </font></font><br>
<br>
<img src="https://habrastorage.org/files/af4/5a9/4dc/af45a94dc2684467920e9191ebcafc83.jpg" alt="Module MT1132"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et j'ai particulièrement apprécié le fait que (hormis l'alimentation) le module est connecté à l'Arduino avec un seul (!) Fil (RX). Le second (TX) peut être complètement omis. Le module est "unidirectionnel", c'est-à-dire qu'il est conçu uniquement pour envoyer des signaux de commande. Les plans de la société Nootehnika incluent le développement et la sortie d'une version «bidirectionnelle» du module.</font></font><br>
<br>
<img src="https://habrastorage.org/files/60c/dfb/d07/60cdfbd0709b41b88b19a00638637d59.jpg" alt="SU111-300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième élément dont nous avons besoin de l'équipement nooLite est une unité de commande de puissance, par exemple SU111-300. La connexion de l'unité est élémentaire et peut être vue dans l'illustration. Deux fils sont connectés à un réseau de 220 volts et les deux autres à la charge. La seule chose à laquelle je voudrais faire attention est que les modules sont fournis avec un cavalier qui bloque le mode de gradation et, si vous souhaitez régler la puissance, vous devez couper ce cavalier (et n'oubliez pas d'isoler les fils nus résultants).</font></font><br>
<br>
<img src="https://habrastorage.org/files/acf/cd5/4ad/acfcd54ad9ab4c57bf6409799dd3a133.jpg" alt="PU311-2"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne m'attarderai pas sur les télécommandes car il s'agit d'un contrôle «manuel», et nous, en lien avec l'automatisation, nous intéressons davantage à l'automatique. </font><font style="vertical-align: inherit;">Je peux seulement dire que les expériences ont été effectuées avec la télécommande PU311-2, faite sous la forme d'un interrupteur mural et qu'elle s'est montrée de la meilleure façon, c'est-à-dire qu'elle a allumé et éteint la lumière clairement et sans échecs. </font><font style="vertical-align: inherit;">En fait, quel est le bon équipement et différent du mauvais - vous ne remarquez tout simplement pas le bon.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Concept de travail. </font><font style="vertical-align: inherit;">Liaison et dissociation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de pouvoir allumer et éteindre les appareils électriques à l'aide du système nooLite, vous devez «relier» les modules de commande aux unités d'alimentation correspondantes. Cela se fait en utilisant la procédure dite. «Liaisons» et «déliement», décrites en détail dans la documentation nooLite. En bref, tout se résume à appuyer sur une paire de boutons sur les blocs liés et ne présente aucune difficulté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas où le module de contrôle MT1132 est utilisé à la place de la télécommande, la procédure se déroule de manière légèrement différente. A savoir: puisque le module n'a pas de boutons, vous devez générer et envoyer par programmation une commande de contrôle sur le canal souhaité, puis appuyez sur le bouton de l'unité d'alimentation, confirmant la «liaison» ou le «déliement».</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les canaux sont des «lignes de contrôle» et il y en a 32 dans le module MT1132, comme en témoignent les deux derniers chiffres du nom. </font><font style="vertical-align: inherit;">Cela signifie qu'avec ce module, vous pouvez gérer 32 groupes d'équipements distincts, ce qui est plus que suffisant pour un appartement ou une petite maison. </font><font style="vertical-align: inherit;">Si vous avez une grande maison, les modules peuvent fonctionner conjointement et s'adapter à n'importe quel nombre de canaux.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du protocole</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un merveilleux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">document sur le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site Web de la société Nootehnika </font><font style="vertical-align: inherit;">qui décrit de manière complète et détaillée la connexion du module et son protocole de contrôle. </font><font style="vertical-align: inherit;">Je n'encombrerai pas l'article de détails techniques inutiles, n'importe qui peut lire ce document, je ne décrirai que les points principaux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler le module, nous devons former une commande de contrôle composée de 12 octets. </font><font style="vertical-align: inherit;">Les principes de formation de cette équipe sont décrits dans le document ci-dessus. </font><font style="vertical-align: inherit;">Et comme vous le verrez ci-dessous, toutes ces règles sont déjà programmées dans les fonctions de contrôle et il suffit de les utiliser pour émettre des commandes sur le module.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Équipes de test</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nooLite possède un système de commande assez développé, à partir duquel nous sélectionnerons les plus simples et les plus courants et illustrerons le système à l'aide de leur exemple.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Snap</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Délier</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inclusion</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Éteint</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réglage de puissance (gradation)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comprendre le fonctionnement des équipes de base, vous pouvez facilement en utiliser une autre.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion du module MT1132</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai déjà dit, le module MT1132 est littéralement connecté avec un fil (sauf pour l'alimentation). </font><font style="vertical-align: inherit;">Le module peut être alimenté à la fois par une tension de 5 volts et une tension de 3,3 volts. </font><font style="vertical-align: inherit;">Par conséquent, il n'y a eu aucun problème de connexion à l'Arduino Mega 5 volts ou à l'Arduino Due 3,3 volts. </font><font style="vertical-align: inherit;">Le seul point est qu'avec une puissance réduite, la plage de fonctionnement fiable du système diminue. </font><font style="vertical-align: inherit;">Et cela doit être pris en compte si vous souhaitez alimenter le module à partir d'une tension de 3,3 volts.</font></font><br>
<br>
<img src="https://habrastorage.org/files/fb8/2a4/d76/fb82a4d769cb49bda099e57591c13157.jpg" alt="Arduino"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le module possède des broches RX et TX pour recevoir et envoyer des signaux via l'interface série. </font><font style="vertical-align: inherit;">La connexion du RX, pour recevoir les commandes de contrôle du contrôleur, est essentielle pour le fonctionnement du module. </font><font style="vertical-align: inherit;">Par conséquent, la broche RX côté module est connectée à la broche TX (18) côté Arduino. </font><font style="vertical-align: inherit;">Ce brochage est valable pour Arduino Mega et Arduino Due.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie logiciel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons maintenant comment gérer toute cette économie à partir de croquis sur Arduino. </font><font style="vertical-align: inherit;">Tout d'abord, initialisez Serial1, auquel nous avons connecté le module MT1132 (cela se fait à la fréquence standard 9600):</font></font><br>
<br>
<pre><code class="java hljs">Serial1.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, le code de la fonction de contrôle principale:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooSendCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> channel, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> format)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> buf[<span class="hljs-number"><span class="hljs-number">12</span></span>];<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>; i++) {<font></font>
    buf[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">85</span></span>;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">1</span></span>] = B01010000;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">2</span></span>] = command;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">3</span></span>] = format;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">5</span></span>] = channel;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">6</span></span>] = data;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checkSum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; i++) {<font></font>
    checkSum += buf[i];<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">10</span></span>] = lowByte(checkSum);<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">11</span></span>] = <span class="hljs-number"><span class="hljs-number">170</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; (<span class="hljs-number"><span class="hljs-number">12</span></span>); i++) {<font></font>
    Serial1.write(buf[i]);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, nous n'avons même pas besoin de savoir comment cela fonctionne, nous pouvons l'utiliser en mode «boîte noire» ou une sorte d'API, avec une certaine interface qui sort. </font><font style="vertical-align: inherit;">Nous avons juste besoin de savoir comment utiliser cette interface. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, il n'y a que quatre paramètres - canal, commande, données et format. </font><font style="vertical-align: inherit;">Vous pouvez lire par quel principe les requêtes à cette API peuvent être lues dans le document susmentionné, mais nous simplifierons encore plus notre tâche et encapsulerons cette interface dans de simples commandes de contrôle de périphérique nooLite.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooBind</span></span></span><span class="hljs-function">  </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooUnbind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOn</span></span></span><span class="hljs-function">    </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOff</span></span></span><span class="hljs-function">   </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooValue</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">6</span></span>, v, <span class="hljs-number"><span class="hljs-number">1</span></span>);}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une équipe relativement complexe n'est que la dernière, là, en plus du canal, le niveau de puissance est également réglé. </font><font style="vertical-align: inherit;">Il y a aussi des équipes dans le croquis sur lesquelles nous ne nous attarderons pas maintenant, mais elles se forment tout aussi facilement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait ... c'est tout! </font><font style="vertical-align: inherit;">Nulle part est plus facile. </font><font style="vertical-align: inherit;">Dans le code, les commandes de contrôle ressemblent à ceci:</font></font><br>
<br>
<pre><code class="java hljs">nooBind(ch);<font></font>
nooUnbind(ch);<font></font>
nooOn(ch);<font></font>
nooOff(ch);<font></font>
nooValue(ch, v);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons maintenant la pratique de la gestion du module d'alimentation nooLite. </font><font style="vertical-align: inherit;">Donc, nous lions le bloc d'alimentation sur le canal zéro:</font></font><br>
<br>
<pre><code class="java hljs">nooBind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le voyant du bloc d'alimentation commence à clignoter. </font><font style="vertical-align: inherit;">Appuyez sur le bouton du bloc - la LED cesse de clignoter - le bloc d'alimentation est connecté. </font><font style="vertical-align: inherit;">Au lieu du canal zéro, vous pouvez utiliser n'importe quel autre. </font><font style="vertical-align: inherit;">Et vous pouvez facilement générer le numéro de canal dans le code d'esquisse en fonction de vos besoins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allumez la lampe (si nous avons attaché la lampe sur le canal zéro, les commandes doivent être envoyées sur ce canal):</font></font><br>
<br>
<pre><code class="java hljs">nooOn(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réglez la puissance (luminosité de la lampe):</font></font><br>
<br>
<pre><code class="java hljs">nooValue(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous devez parler un peu des règles de formation d'une équipe qui définit le niveau de puissance. La valeur de la puissance ne change pas de 0 à 255, comme on pourrait le penser, mais de 35 à 155. Si la valeur est supérieure à 155, alors la puissance sera maximale, si elle est de 0, alors ce sera équivalent à une commande d'arrêt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici (juste au cas où) une formule qui traduit les valeurs «standard» de 0 à 100 dans un format compris par le module nooLite:</font></font><br>
<br>
<pre><code class="java hljs">v = x * <span class="hljs-number"><span class="hljs-number">1.2</span></span> + <span class="hljs-number"><span class="hljs-number">34</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant cette formule, vous pouvez régler la luminosité de la lampe dans le pourcentage de puissance habituel. </font><font style="vertical-align: inherit;">Et, bien sûr, si vous avez besoin d'ajuster la puissance de manière non linéaire, vous pouvez créer une variable v selon n'importe quelle loi ou même simplement choisir des valeurs fixes. </font><font style="vertical-align: inherit;">Cela sera discuté dans la troisième partie du cycle, lorsque nous ajusterons la température de chauffage de la station de soudage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Éteignez l'appareil:</font></font><br>
<br>
<pre><code class="java hljs">nooOff(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Délier:</font></font><br>
<br>
<pre><code class="java hljs">nooUnbind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le voyant du bloc d'alimentation commence à clignoter. </font><font style="vertical-align: inherit;">Nous confirmons le découplage en appuyant sur le bouton du bloc d'alimentation. </font><font style="vertical-align: inherit;">Ça y est, maintenant le bloc d'alimentation a cessé de répondre à nos commandes et nous pouvons le «snap» à nouveau sur l'un des 32 canaux du module nooLite MT1132. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici le croquis complet.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code d'esquisse complet</font></font></b><div class="spoiler_text">byte const PIN_TX = 18; // TX PIN (to RX noolite)<br>
byte const PIN_RX = 19; // RX PIN (to TX noolite)<br>
<br>
void nooSendCommand(byte channel, byte command, byte data, byte format) {<br>
 byte buf[12];<br>
<br>
for (byte i = 0; i &lt; 12; i++) {<br>
 buf[i] = 0;<br>
 }<br>
<br>
buf[0] = 85;<br>
 buf[1] = B01010000;<br>
 buf[2] = command;<br>
 buf[3] = format;<br>
 buf[5] = channel;<br>
 buf[6] = data;<br>
<br>
int checkSum = 0;<br>
 for (byte i = 0; i &lt; 10; i++) {<br>
 checkSum += buf[i];<br>
 }<br>
<br>
buf[10] = lowByte(checkSum);<br>
 buf[11] = 170;<br>
<br>
for (byte i = 0; i &lt; (12); i++) {<br>
 Serial1.write(buf[i]);<br>
 }<br>
}<br>
<br>
void nooBind (byte ch) {nooSendCommand(ch, 15, 0, 0);}<br>
void nooUnbind (byte ch) {nooSendCommand(ch, 9, 0, 0);}<br>
<br>
void nooOn (byte ch) {nooSendCommand(ch, 2, 0, 0);}<br>
void nooOff (byte ch) {nooSendCommand(ch, 0, 0, 0);}<br>
void nooTrigger(byte ch) {nooSendCommand(ch, 4, 0, 0);}<br>
void nooCancel (byte ch) {nooSendCommand(ch, 10, 0, 0);}<br>
<br>
void nooUp (byte ch) {nooSendCommand(ch, 3, 0, 0);}<br>
void nooDown (byte ch) {nooSendCommand(ch, 1, 0, 0);}<br>
void nooRevers (byte ch) {nooSendCommand(ch, 5, 0, 0);}<br>
<br>
void nooValue (byte ch, byte v) {nooSendCommand(ch, 6, v, 1);}<br>
<br>
void setup() {<br>
 Serial1.begin(9600);<br>
<br>
/*     <br>
      loop(),    */<br>
<br>
//nooBind(0);<br>
<br>
//nooOn(0);<br>
 //nooOff(0);<br>
 //nooValue(0, 100);<br>
<br>
//nooUnbind(0); <br>
}<br>
<br>
void loop(){<br>
<br>
}<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sous-total</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, </font><font style="vertical-align: inherit;">il n'y a rien de compliqué </font><font style="vertical-align: inherit;">à contrôler les modules de puissance </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite en</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant Arduino, au contraire, le contrôle est incroyablement simple: le module est connecté avec un seul fil, et les commandes sont presque un langage humain naturel - «allumez le canal 0», «éteignez le canal 1», «Régler la puissance de 50% sur le canal 3» n'est vraiment nulle part plus simple.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus pour ceux qui ont lu jusqu'au bout</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'autre jour, une nouvelle version d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server est sortie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous le numéro 0.14, dans laquelle toutes les maladies infantiles de la technologie sont surmontées et qui fonctionne rapidement et de manière stable. </font><font style="vertical-align: inherit;">Et la même version contient le noyau de contrôle d'instrument nooLite intégré et comment tout cela fonctionne, vous apprendrez du prochain article de la série «Équipement sans fil nooLite et maison intelligente (partie 2). </font><font style="vertical-align: inherit;">Arduino Mega Server. " </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les deuxième</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">troisième</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quatrième</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parties du cycle.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr389067/">https://habr.com/ru/post/fr389067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr389051/index.html">CNET Smart Home: terrain d'essai de gadgets</a></li>
<li><a href="../fr389053/index.html">Maison intelligente. Cerveaux</a></li>
<li><a href="../fr389057/index.html">CES 2016: LG et Samsung annoncent une maison intelligente</a></li>
<li><a href="../fr389063/index.html">Comment les voitures carrées des années 80 ont été rationalisées par les années 90</a></li>
<li><a href="../fr389065/index.html">La sonde de l'aube a envoyé des photos détaillées des cratères de Ceres</a></li>
<li><a href="../fr389069/index.html">Remix OS, un OS multi-fenêtres basé sur Android, est maintenant disponible pour PC</a></li>
<li><a href="../fr389071/index.html">Brouillage dans les systèmes mondiaux de navigation par satellite</a></li>
<li><a href="../fr389073/index.html">Branto ORB: une balle presque magique pour contrôler votre maison</a></li>
<li><a href="../fr389075/index.html">Распродажа в Старый Новый год</a></li>
<li><a href="../fr389077/index.html">Fondateur d'Oculus: le PC basse consommation est le principal obstacle à la vulgarisation de la réalité virtuelle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>