<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â˜¯ï¸ ğŸ° ğŸŒ ECMAScript 2017ï¼ˆES8ï¼‰ç®€ä»‹ ğŸ™ ğŸ¤— ğŸŒ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç›®å½• 
 å‰è¨€ 
 ES7æ¦‚è¿° 
 1.å¯¹è±¡æ¡ç›® 
 2.å¯¹è±¡å€¼ 
 3. String.prototype.padEnd 
 4. String.prototype.padStart 
 5. Object.getOwnPropertyDescriptor 
 6.å°¾éšé€—å· 
 7. Shared...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ECMAScript 2017ï¼ˆES8ï¼‰ç®€ä»‹</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475074/"><h4> ç›®å½• </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‰è¨€</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ES7æ¦‚è¿°</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">1.å¯¹è±¡æ¡ç›®</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2.å¯¹è±¡å€¼</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">3. String.prototype.padEnd</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">4. String.prototype.padStart</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">5. Object.getOwnPropertyDescriptor</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">6.å°¾éšé€—å·</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">7. SharedArrayBuffer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">8.åŸå­å­¦</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">9.å¼‚æ­¥åŠŸèƒ½</a> <br><br><a name="section000"></a><h2> å‰è¨€ </h2><br> æ‚¨å¥½ï¼Œè¿‡å»æˆ‘å·²ç»è€ƒè™‘è¿‡ES6çš„åˆ›æ–°ï¼Œç°åœ¨æ˜¯æ—¶å€™æ‹†åˆ†ES8äº†ï¼Œå› ä¸ºå®ƒå¸¦æ¥äº†è®¸å¤šæ–°åŠŸèƒ½ã€‚ æˆ‘æ²¡æœ‰å•ç‹¬è€ƒè™‘ES7ï¼ˆ2016ï¼‰ï¼Œå› ä¸ºæ­¤ç‰ˆæœ¬ä»…å¸¦æ¥äº†2é¡¹åˆ›æ–°ã€‚ è¿™æ˜¯Array.prototype.includesï¼ˆï¼‰å’Œå¹‚è¿ç®—ç¬¦ã€‚ ä½†æ˜¯ï¼Œåœ¨å¯åŠ¨ES8ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹ES7çš„åˆ›æ–°ã€‚ <br><br><a name="section0000"></a><h2>  ES7æ¦‚è¿° </h2><br>  <b>includesï¼ˆï¼‰æ–¹æ³•</b>ç¡®å®šæ•°ç»„æ˜¯å¦åŒ…å«ç‰¹å®šå…ƒç´ ï¼Œå¹¶æ ¹æ®æ­¤ç»“æœè¿”å›trueæˆ–falseã€‚ <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.prototype.includes(searchElement[, fromIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>]) : <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span></code> </pre> <br>  searchElement-è¦æœç´¢çš„é¡¹ç›®ã€‚ <br><br>  fromIndex-æ•°ç»„ä¸­å¼€å§‹æœç´¢searchElementå…ƒç´ çš„ä½ç½®ã€‚ å¯¹äºè´Ÿå€¼ï¼Œå°†ä»ç´¢å¼•array.length + fromIndexå‡åºå¼€å§‹æ‰§è¡Œæœç´¢ã€‚ é»˜è®¤å€¼ä¸º0ã€‚ <a name="habracut"></a><br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs">[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>].includes(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">// true [1, 2, 3].includes(4); // false [1, 2, 3].includes(3, 3); // false [1, 2, 3].includes(3, -1); // true [1, 2, NaN].includes(NaN); // true</span></span></code> </pre> <br>  includeï¼ˆï¼‰å¯ä»¥åº”ç”¨äºå…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼‰ã€‚ ç¤ºä¾‹ï¼šåœ¨argumentså¯¹è±¡ä¸Šä½¿ç”¨includeï¼ˆï¼‰æ–¹æ³•ã€‚ <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log([].includes.call(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// true console.log([].includes.call(arguments, 'd')); // false })('a','b','c');</span></span></code> </pre> <br>  <b>å¹‚è¿ç®—ç¬¦</b> ï¼ˆ**ï¼‰è¿”å›ä»¥aä¸ºåº•ä¸”è‡ªç„¶æŒ‡æ•°ä¸ºbçš„å¹‚ã€‚ æé«˜aåˆ°bçš„åŠ›é‡ã€‚ <br><br><pre> <code class="javascript hljs">a ** b</code> </pre> <br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">// 8 3 ** 2 // 9 3 ** 2.5 // 15.588457268119896 10 ** -1 // 0.1 NaN ** 2 // NaN 2 ** 3 ** 2 // 512 2 ** (3 ** 2) // 512 (2 ** 3) ** 2 // 64 -(2 ** 2) // -4 (-2) ** 2 // 4</span></span></code> </pre> <br><a name="section001"></a><h2>  1.å¯¹è±¡æ¡ç›® </h2><br>  Object.entriesï¼ˆï¼‰è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶å…ƒç´ æ˜¯ä¸ç›´æ¥åœ¨å¯¹è±¡ä¸­å‘ç°çš„[keyï¼Œvalue]å¯¹çš„æšä¸¾å±æ€§ç›¸å¯¹åº”çš„æ•°ç»„ã€‚ å±æ€§çš„é¡ºåºä¸æ‚¨æ‰‹åŠ¨å¾ªç¯æµè§ˆå¯¹è±¡çš„å±æ€§æ—¶çš„é¡ºåºç›¸åŒã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj) : <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span></code> </pre> <br>  obj-ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶æšä¸¾å±æ€§å°†ä½œä¸ºæ•°ç»„[keyï¼Œvalue]è¿”å›ã€‚ <br><br>  Object.entriesï¼ˆï¼‰è¿”å›å±æ€§çš„é¡ºåºä¸for ... inå¾ªç¯ä¸­çš„é¡ºåºç›¸åŒï¼ˆä¸åŒä¹‹å¤„æ˜¯for-inè¿˜åˆ—å‡ºäº†åŸå‹é“¾ä¸­çš„å±æ€§ï¼‰ã€‚  Object.entriesï¼ˆï¼‰è¿”å›çš„æ•°ç»„ä¸­å…ƒç´ çš„é¡ºåºä¸å£°æ˜å¯¹è±¡çš„æ–¹å¼æ— å…³ã€‚ å¦‚æœéœ€è¦ç‰¹å®šé¡ºåºï¼Œåˆ™å¿…é¡»åœ¨è°ƒç”¨æ–¹æ³•ä¹‹å‰å¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚ <br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-comment"><span class="hljs-comment">// [ ['foo', 'bar'], ['baz', 42] ] //    var obj = { 0: 'a', 1: 'b', 2: 'c' }; console.log(Object.entries(obj)); // [ ['0', 'a'], ['1', 'b'], ['2', 'c'] ] //    c random   var an_obj = { 100: 'a', 2: 'b', 7: 'c' }; console.log(Object.entries(an_obj)); // [ ['2', 'b'], ['7', 'c'], ['100', 'a'] ] // getFoo  ,    var my_obj = Object.create({}, { getFoo: { value: function() { return this.foo; } } }); my_obj.foo = "bar"; console.log(Object.entries(my_obj)); // [ ['foo', 'bar'] ] // non-object     object console.log(Object.entries("foo")); // [ ['0', 'f'], ['1', 'o'], ['2', 'o'] ] let obj = { one: 1, two: 2 }; for (let [k,v] of Object.entries(obj)) console.log(`${JSON.stringify(k)}: ${JSON.stringify(v)}`) // "one": 1 // "two": 2</span></span></code> </pre> <br>  <b>å°†å¯¹è±¡è½¬æ¢ä¸ºåœ°å›¾</b> <br><br> æ–°çš„Mapï¼ˆï¼‰æ„é€ å‡½æ•°æ¥å—å€¼çš„é‡å¤ã€‚ ä½¿ç”¨Object.entriesï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°å°†Objectè½¬æ¢ä¸ºMapã€‚ è¿™æ¯”ä½¿ç”¨2ä¸ªå…ƒç´ æ•°ç»„ç»„æˆçš„æ•°ç»„æ›´ä¸ºç®€æ´ï¼Œä½†æ˜¯é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Map</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(map); <span class="hljs-comment"><span class="hljs-comment">// Map {"foo" =&gt; "bar", "baz" =&gt; 42}</span></span></code> </pre> <br> ä¸ºä»€ä¹ˆObject.entriesï¼ˆï¼‰çš„è¿”å›å€¼æ˜¯æ•°ç»„è€Œä¸æ˜¯è¿­ä»£å™¨ï¼Ÿ <br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹åº”çš„ç”¨ä¾‹æ˜¯Object.keysï¼ˆï¼‰ï¼Œè€Œä¸æ˜¯Map.prototype.entriesï¼ˆï¼‰ã€‚ <br><br> ä¸ºä»€ä¹ˆObject.entriesï¼ˆï¼‰ä»…è¿”å›å¸¦æœ‰å­—ç¬¦ä¸²é”®çš„æšä¸¾æœ¬æœºå±æ€§ï¼Ÿ <br><br> å†æ¬¡ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†åŒ¹é…Object.keysï¼ˆï¼‰ã€‚ æ­¤æ–¹æ³•è¿˜å¿½ç•¥é”®ä¸ºå­—ç¬¦çš„å±æ€§ã€‚ æœ€åï¼Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªReflect.ownEntriesï¼ˆï¼‰æ–¹æ³•è¿”å›å…¶è‡ªèº«çš„æ‰€æœ‰å±æ€§ã€‚ <br><br> è¯·å‚é˜…å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">è§„èŒƒ</a>ä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£</a>ä¸­çš„object.entriesã€‚ <br><br><a name="section002"></a><h2>  2.å¯¹è±¡å€¼ </h2><br>  Object.valuesï¼ˆï¼‰è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶å…ƒç´ æ˜¯åœ¨å¯¹è±¡ä¸­æ‰¾åˆ°çš„æšä¸¾å±æ€§çš„å€¼ã€‚ è¯¥é¡ºåºä¸æ‚¨æ‰‹åŠ¨å¾ªç¯æµè§ˆå¯¹è±¡çš„é¡ºåºç›¸åŒã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(obj) : <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span></code> </pre> <br>  obj-å°†è¿”å›å…¶æšä¸¾å±æ€§å€¼çš„å¯¹è±¡ã€‚ <br><br>  Object.valuesï¼ˆï¼‰æ–¹æ³•ä»¥ä¸for ... inå¾ªç¯ç›¸åŒçš„é¡ºåºè¿”å›å¯¹è±¡çš„æšä¸¾å±æ€§çš„å€¼çš„æ•°ç»„ã€‚ å¾ªç¯å’Œæ–¹æ³•ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œå¾ªç¯åˆ—å‡ºäº†åŸå‹é“¾ä¸­çš„å±æ€§ã€‚ <br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(obj)); <span class="hljs-comment"><span class="hljs-comment">// ['bar', 42] //    var obj = { 0: 'a', 1: 'b', 2: 'c' }; console.log(Object.values(obj)); // ['a', 'b', 'c']</span></span></code> </pre><br>  Object.entrieså’ŒObject.valuesï¼ˆï¼‰ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œç¬¬ä¸€ä¸ªè¿”å›åŒ…å«å±æ€§åç§°å’Œå€¼çš„æ•°ç»„çš„æ•°ç»„ï¼Œè€Œç¬¬äºŒä¸ªä»…è¿”å›å…·æœ‰å±æ€§å€¼çš„æ•°ç»„ã€‚ <br><br>  <b>Object.valuesï¼ˆï¼‰å’ŒObject.entriesï¼ˆï¼‰ä¹‹é—´çš„ç¤ºä¾‹å·®å¼‚</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> object = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-string"><span class="hljs-string">'somestring'</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(object)); <span class="hljs-comment"><span class="hljs-comment">// ["somestring", 42, false] console.log(Object.entries(object)); // [ ["a", "somestring"], ["b", 42], ["c", false] ]</span></span></code> </pre> <br> è¯·å‚é˜…å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">è§„èŒƒ</a>ä¸­çš„Object.valuesï¼ˆï¼‰ä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£</a> ã€‚ <br><br><a name="section003"></a><h2>  3. String.prototype.padEnd </h2><br>  padEndï¼ˆï¼‰æ–¹æ³•ä½¿ç”¨ç»™å®šçš„å­—ç¬¦ä¸²ï¼ˆæœ€ç»ˆé‡å¤ï¼‰æ¥å®Œæˆå½“å‰è¡Œï¼Œä»¥ä¾¿ç»“æœå­—ç¬¦ä¸²è¾¾åˆ°æŒ‡å®šçš„é•¿åº¦ã€‚ åŠ æ³•åº”ç”¨äºå½“å‰è¡Œçš„æœ«å°¾ï¼ˆå³ä¾§ï¼‰ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.prototype.padEnd(maxLength [ , fillString ]) : <span class="hljs-built_in"><span class="hljs-built_in">String</span></span></code> </pre> <br>  maxLength-å¡«å……å½“å‰è¡Œåç»“æœè¡Œçš„é•¿åº¦ã€‚ å¦‚æœæ­¤å‚æ•°å°äºå½“å‰è¡Œçš„é•¿åº¦ï¼Œåˆ™å°†æŒ‰åŸæ ·è¿”å›å½“å‰è¡Œã€‚ <br>  fillString-ç”¨äºè¡¥å……å½“å‰è¡Œçš„å­—ç¬¦ä¸²ã€‚ å¦‚æœæ­¤è¡Œå¤ªé•¿ï¼Œå®ƒå°†è¢«æˆªæ–­å¹¶ä¸”å°†åº”ç”¨æœ€å·¦è¾¹çš„é‚£ä¸€è¡Œã€‚  â€œâ€ï¼ˆ0x0020 SPACEï¼‰æ˜¯æ­¤å‚æ•°çš„é»˜è®¤å€¼ã€‚ <br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'abc'</span></span>.padEnd(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-comment"><span class="hljs-comment">// "abc " 'abc'.padEnd(10, "foo"); // "abcfoofoof" 'abc'.padEnd(6,"123456"); // "abc123"</span></span></code> </pre> <br> å¡«å……å­—ç¬¦ä¸²çš„ç”¨ä¾‹åŒ…æ‹¬ï¼š <br><br><ul><li> åœ¨æ–‡ä»¶åæˆ–URLä¸­æ·»åŠ è®¡æ•°å™¨æˆ–æ ‡è¯†ç¬¦ï¼š'file 001.txt' </li><li> æ§åˆ¶å°è¾“å‡ºå¯¹é½æ–¹å¼ï¼šâ€œæµ‹è¯•001ï¼šâœ“â€ </li><li> æ‰“å°å¸¦æœ‰å›ºå®šä½æ•°çš„åå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶æ•°å­—ï¼š'0x00FF' </li></ul><br> è¯·å‚é˜…å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">è§„èŒƒ</a>ä¸­çš„String.prototype.padEndä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£</a> ã€‚ <br><br><a name="section004"></a><h2>  4. String.prototype.padStart </h2><br>  padStartï¼ˆï¼‰æ–¹æ³•ç”¨å¦ä¸€è¡Œå¡«å……å½“å‰è¡Œï¼ˆå¦‚æœéœ€è¦ï¼Œå¯ä»¥å¤šæ¬¡è¾“å…¥ï¼‰ï¼Œä»¥ä½¿ç»“æœè¡Œè¾¾åˆ°æŒ‡å®šçš„é•¿åº¦ã€‚ å¡«å……åœ¨å½“å‰è¡Œçš„å¼€å¤´ï¼ˆå·¦ä¾§ï¼‰æ‰§è¡Œã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.prototype.padStart(maxLength [, fillString]) : <span class="hljs-built_in"><span class="hljs-built_in">String</span></span></code> </pre> <br>  maxLength-å½“å‰è¡Œå®Œæˆåæ‘˜è¦è¡Œçš„é•¿åº¦ã€‚ å¦‚æœè¯¥å€¼å°äºå½“å‰è¡Œçš„é•¿åº¦ï¼Œåˆ™å½“å‰è¡Œå°†ä¿æŒä¸å˜ã€‚ <br><br>  fillString-å¡«å……å½“å‰è¡Œçš„å­—ç¬¦ä¸²ã€‚ å¦‚æœæ­¤å­—ç¬¦ä¸²å¯¹äºç»™å®šçš„é•¿åº¦è€Œè¨€å¤ªé•¿ï¼Œå®ƒå°†è¢«æˆªæ–­ã€‚ é»˜è®¤å€¼ä¸ºâ€œâ€ï¼ˆ0x0020ç©ºæ ¼ï¼‰ã€‚ <br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'abc'</span></span>.padStart(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-comment"><span class="hljs-comment">// " abc" 'abc'.padStart(10, "foo"); // "foofoofabc" 'abc'.padStart(6,"123465"); // "123abc" 'abc'.padStart(8, "0"); // "00000abc" 'abc'.padStart(1); // "abc"</span></span></code> </pre> <br> ä¸ºä»€ä¹ˆæœªå°†å¡«å……æ–¹æ³•ç§°ä¸ºpadLeftå’ŒpadRightï¼Ÿ <br><br> å¯¹äºåŒå‘æˆ–ä»å³åˆ°å·¦è¯­è¨€ï¼Œæœ¯è¯­â€œå·¦â€å’Œâ€œå³â€ä¸èµ·ä½œç”¨ã€‚ å› æ­¤ï¼ŒpadStartå’ŒpadEndçš„å‘½åéµå¾ªç°æœ‰çš„åç§°ï¼Œä»¥startsWithå’ŒendsWithå¼€å¤´ã€‚ <br><br> è¯·å‚é˜…å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">è§„èŒƒ</a>ä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£</a>ä¸­çš„String.prototype.padStartã€‚ <br><br><a name="section005"></a><h2>  5. Object.getOwnPropertyDescriptor </h2><br>  Object.getOwnPropertyDescriptorï¼ˆï¼‰æ–¹æ³•ä¸ºä¼ é€’çš„å¯¹è±¡è¿”å›è‡ªå·±çš„å±æ€§ï¼ˆå³ç›´æ¥ä½äºå¯¹è±¡ä¸­ï¼Œè€Œä¸æ˜¯é€šè¿‡åŸå‹é“¾æ¥æ”¶åˆ°çš„å±æ€§ï¼‰çš„å±æ€§æè¿°ç¬¦ã€‚ å¦‚æœè¯¥å±æ€§ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›undefinedã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, prop) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre> <br>  obj-åœ¨å…¶ä¸­æœç´¢å±æ€§çš„å¯¹è±¡ã€‚ <br><br>  prop-å°†è¿”å›å…¶æè¿°çš„å±æ€§åç§°ã€‚ <br><br> æ­¤æ–¹æ³•ä½¿æ‚¨å¯ä»¥æŸ¥çœ‹å±æ€§çš„ç¡®åˆ‡æè¿°ã€‚  JavaScriptä¸­çš„å±æ€§ç”±å­—ç¬¦ä¸²åç§°å’Œå±æ€§æè¿°ç¬¦ç»„æˆã€‚ <br><br> å±æ€§æè¿°ç¬¦æ˜¯å…·æœ‰ä»¥ä¸‹æŸäº›å±æ€§çš„è®°å½•ï¼š <br><br><ul><li>  value-ä¸å±æ€§å…³è”çš„å€¼ï¼ˆä»…åœ¨æ•°æ®æè¿°ç¬¦ä¸­ï¼‰ã€‚ </li><li> å¯å†™-å¦‚æœå¯ä»¥æ›´æ”¹ä¸å±æ€§å…³è”çš„å€¼ï¼Œåˆ™ä¸ºtrueï¼›å¦åˆ™ä¸ºfalseï¼ˆä»…åœ¨æ•°æ®æè¿°ç¬¦ä¸­ï¼‰ã€‚ </li><li>  get-è¿”å›å±æ€§å€¼çš„å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„å‡½æ•°ï¼Œåˆ™ä¸ºundefinedï¼ˆä»…åœ¨è®¿é—®æè¿°ç¬¦ä¸­ï¼‰ã€‚ </li><li>  set-æ›´æ”¹å±æ€§å€¼çš„å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„å‡½æ•°ï¼Œåˆ™ä¸ºundefinedï¼ˆä»…åœ¨è®¿é—®æè¿°ç¬¦ä¸­ï¼‰ã€‚ </li><li> å¯é…ç½®-å¦‚æœå¯ä»¥æ›´æ”¹æ­¤å±æ€§çš„å¥æŸ„ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥ä»åŒ…å«å®ƒçš„å¯¹è±¡ä¸­åˆ é™¤è¯¥å±æ€§ï¼Œåˆ™ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚ </li><li> æšä¸¾-å¦‚æœåˆ—å‡ºåŒ…å«å®ƒçš„å¯¹è±¡çš„å±æ€§æ—¶æ­¤å±æ€§å¯ç”¨ï¼Œåˆ™ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚ </li></ul><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs">obj = { get foo() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>; } }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// {set: undefined, enumerable: true, configurable: true, get: Æ’} obj2 = { bar: 42 }; console.log(Object.getOwnPropertyDescriptor(obj2, 'bar')); // {value: 42, writable: true, enumerable: true, configurable: true}</span></span></code> </pre> <br><h4>  Object.getOwnPropertyDescriptorï¼ˆï¼‰çš„ç”¨ä¾‹ </h4><br>  <b>ç¬¬ä¸€ä¸ª</b>ç”¨ä¾‹ï¼šå°†å±æ€§å¤åˆ¶åˆ°å¯¹è±¡ <br> ä»ES6å¼€å§‹ï¼ŒJavaScriptå·²ç»å…·æœ‰ç”¨äºå¤åˆ¶å±æ€§çš„å·¥å…·æ–¹æ³•ï¼šObject.assignï¼ˆï¼‰ã€‚ ä½†æ˜¯ï¼Œæ­¤æ–¹æ³•ä½¿ç”¨ç®€å•çš„getå’Œsetæ“ä½œå¤åˆ¶é”®ä¸ºé”®çš„å±æ€§ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = source[key]; <span class="hljs-comment"><span class="hljs-comment">// get target[key] = value; // set</span></span></code> </pre> è¿™æ„å‘³ç€å®ƒæ— æ³•æ­£ç¡®å¤åˆ¶å…·æœ‰é»˜è®¤æŒ‡å®šå±æ€§ä»¥å¤–çš„å±æ€§çš„å±æ€§ï¼ˆè·å–ï¼Œè®¾ç½®ï¼Œå†™å…¥ç­‰æ–¹æ³•ï¼‰ã€‚ ä»¥ä¸‹ç¤ºä¾‹è¯´æ˜äº†æ­¤é™åˆ¶ã€‚ è¯¥å¯¹è±¡çš„æºæœ‰ä¸€ä¸ªå®‰è£…ç¨‹åºï¼Œå…¶å¯†é’¥ä¸ºfooï¼š <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> source = { set foo(value) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(value); } }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(source, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { get: undefined, set: [Function: foo], enumerable: true, configurable: true }</span></span></code> </pre> <br> ä½¿ç”¨Object.assignï¼ˆï¼‰å°†fooå±æ€§å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡å¤±è´¥ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> target1 = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(target1, source); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(target1, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre> å¹¸è¿çš„æ˜¯ï¼Œç»“åˆä½¿ç”¨Object.getOwnPropertyDescriptorsï¼ˆï¼‰å’ŒObject.definePropertiesï¼ˆï¼‰å¯ä»¥ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> target2 = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperties(target2, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors(source)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(target2, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { get: undefined, set: [Function: foo], enumerable: true, configurable: true }</span></span></code> </pre> <br>  <b>ç¬¬äºŒä¸ª</b>ç”¨ä¾‹ï¼šå…‹éš†å¯¹è±¡ <br> æµ…å…‹éš†ç±»ä¼¼äºå¤åˆ¶å±æ€§ï¼Œå› æ­¤Object.getOwnPropertyDescriptorsï¼ˆï¼‰åœ¨è¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ <br><br> è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨Object.createï¼ˆï¼‰ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªå‚æ•°ï¼š <br> ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šè¿”å›å¯¹è±¡çš„åŸå‹ã€‚ <br><br> ç¬¬äºŒä¸ªå¯é€‰å‚æ•°æ˜¯å±æ€§æè¿°ç¬¦çš„é›†åˆï¼Œç±»ä¼¼äºObject.getOwnPropertyDescriptorsï¼ˆï¼‰è¿”å›çš„é‚£äº›æè¿°ç¬¦ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> clone = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(obj), <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors(obj));</code> </pre> <br>  <b>ç¬¬ä¸‰ç§</b>ç”¨ä¾‹ï¼šå…·æœ‰ä»»æ„åŸå‹çš„è·¨å¹³å°å¯¹è±¡æ–‡å­—ã€‚ <br><br> ä½¿ç”¨å¯¹è±¡æ–‡å­—æ¥åˆ›å»ºå…·æœ‰ä»»æ„åŸå‹çš„å¯¹è±¡çš„æœ€ä½³è¯­æ³•æ–¹æ³•æ˜¯ä½¿ç”¨ç‰¹æ®Šçš„__proto__å±æ€§ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">__proto__</span></span>: prot, <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, };</code> </pre> <br>  lasï¼Œä¿è¯ä»…åœ¨æµè§ˆå™¨ä¸­æä¾›æ­¤åŠŸèƒ½ã€‚ å¸¸è§„è§£å†³æ–¹æ³•æ˜¯Object.createï¼ˆï¼‰å’Œèµ‹å€¼ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(prot); obj.foo = <span class="hljs-number"><span class="hljs-number">123</span></span>;</code> </pre> <br> ä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨Object.getOwnPropertyDescriptorsï¼ˆï¼‰ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create( prot, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors({ <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, }) );</code> </pre> <br> å¦ä¸€ç§é€‰æ‹©æ˜¯Object.assignï¼ˆï¼‰ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign( <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(prot), { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, } );</code> </pre> <br> é™·é˜±ï¼šä½¿ç”¨è¶…çº§å¤åˆ¶æ–¹æ³•ã€‚ <br><br> è¶…çº§ä½¿ç”¨çš„æ–¹æ³•ç´§å¯†åœ°ç»‘å®šåˆ°å…¶åŸå§‹å¯¹è±¡ï¼ˆå­˜å‚¨è¯¥å¯¹è±¡çš„å¯¹è±¡ï¼‰ã€‚ å½“å‰æ— æ³•å°†è¿™ç§æ–¹æ³•å¤åˆ¶æˆ–ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚ <br><br> è¯·å‚é˜…å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">è§„èŒƒ</a>ä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£</a>ä¸­çš„Object.getOwnPropertyDescriptorã€‚ <br><br><a name="section006"></a><h2>  6.å°¾éšé€—å· </h2><br> æŒ‚é€—å·ï¼ˆå°¾éšé€—å·ï¼‰-åœ¨å‘JavaScriptä»£ç æ·»åŠ æ–°å…ƒç´ ï¼Œå‚æ•°æˆ–å±æ€§æ—¶å¾ˆæœ‰ç”¨ã€‚ å¦‚æœè¦æ·»åŠ æ–°å±æ€§ï¼Œåˆ™åªéœ€æ·»åŠ æ–°è¡Œè€Œä¸æ›´æ”¹å‰ä¸€è¡Œï¼ˆå¦‚æœå·²åœ¨å…¶ä¸­ä½¿ç”¨äº†é€—å·ï¼‰ã€‚ è¿™ä½¿å¾—ç‰ˆæœ¬æ§åˆ¶æ›´ç®€æ´ï¼Œä»£ç æ›´æ”¹çš„éº»çƒ¦ä¹Ÿæ›´å°‘ã€‚ <br><br><h4> æ–‡å­—ä¸­çš„é€—å· </h4><br>  <b>æ•°ç»„</b> <br><br>  JavaScriptä¼šå¿½ç•¥æ•°ç»„ä¸­çš„é€—å·åˆ†éš”ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arr = [ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ]; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// [0, 1, 2] console.log(arr.length); // 3 var arr2 = [0, 1, 2,,,]; console.log(arr2.length); // 5 arr2.forEach((e) =&gt; console.log(e)); // 0 1 2 console.log(arr.map((e) =&gt; e)); // 0 1 2</span></span></code> </pre> <br> å¦‚æœä½¿ç”¨å¤šä¸ªæ‚¬æŒ‚ç‚¹ï¼Œåˆ™ä¼šåˆ›å»ºå­”ã€‚ å…·æœ‰â€œå­”â€çš„é˜µåˆ—ç§°ä¸ºç¨€ç–ï¼ˆå¯†é›†é˜µåˆ—ä¸å…·æœ‰â€œå­”â€ï¼‰ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨Array.prototype.forEachï¼ˆï¼‰æˆ–Array.prototype.mapï¼ˆï¼‰è¿­ä»£æ•°ç»„æ—¶ï¼Œå°†è·³è¿‡å­”ã€‚ <br><br>  <b>å¯¹è±¡</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-string"><span class="hljs-string">"qwerty"</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(object); <span class="hljs-comment"><span class="hljs-comment">// {foo: "bar", baz: "qwerty", age: 42}</span></span></code> </pre> <br><h4> åœ¨åŠŸèƒ½ä¸­ä½¿ç”¨é€—å· </h4><br>  <b>å‚æ•°å®šä¹‰</b> <br><br> åŠŸèƒ½å‚æ•°çš„ä»¥ä¸‹å®šä¹‰æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å½¼æ­¤ç­‰æ•ˆã€‚ æ‚¬æŒ‚çš„é€—å·ä¸ä¼šå½±å“å‡½æ•°æˆ–å…¶å‚æ•°å¯¹è±¡çš„lengthå±æ€§ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">) </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p,</span></span></span><span class="hljs-function">) </span></span>{} (p) =&gt; {}; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p,</span></span></span><span class="hljs-function">) =&gt;</span></span> {};</code> </pre> <br>  <b>æ–¹æ³•å®šä¹‰</b> <br><br> æŒ‚é€—å·ä¹Ÿå¯ç”¨äºå®šä¹‰ç±»æˆ–å¯¹è±¡çš„æ–¹æ³•ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span></span>{ one(a,) {}, two(a, b,) {}, } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { one(a,) {}, two(a, b,) {}, };</code> </pre> <br>  <b>å‡½æ•°è°ƒç”¨</b> <br><br> ä»¥ä¸‹å‡½æ•°è°ƒç”¨æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å½¼æ­¤ç­‰æ•ˆã€‚ <br><br><pre> <code class="javascript hljs">f(p); f(p,); <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>,);</code> </pre> <br>  <b>æ— æ•ˆçš„æŒ‚é€—å·</b> <br><br> å®šä¹‰å‡½æ•°å‚æ•°æˆ–è°ƒç”¨ä»…åŒ…å«é€—å·çš„å‡½æ•°å°†å¼•å‘SyntaxErrorã€‚ å¦å¤–ï¼Œä½¿ç”¨å…¶ä½™å‚æ•°æ—¶ï¼Œä¸å…è®¸ä½¿ç”¨é€—å·åˆ†éš”ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">,</span></span></span><span class="hljs-function">) </span></span>{} <span class="hljs-comment"><span class="hljs-comment">// SyntaxError: missing formal parameter (,) =&gt; {}; // SyntaxError: expected expression, got ',' f(,) // SyntaxError: expected expression, got ',' function f(...p,) {} // SyntaxError: parameter after rest parameter (...p,) =&gt; {} // SyntaxError: expected closing parenthesis, got ','</span></span></code> </pre> <br><h4> åŠé”€ä¸­çš„é€—å· </h4><br> ä½¿ç”¨ç ´åæ€§åˆ†é…æ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨å·¦ä¾§ä½¿ç”¨é€—å·åˆ†éš”ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      [a, b,] = [1, 2]; //      var o = { p: 42, q: true, }; var {p, q,} = o;</span></span></code> </pre> <br> å†æ¬¡ä½¿ç”¨å…¶ä½™å‚æ•°ï¼Œå°†å¼•å‘SyntaxErrorã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> [a, ...b,] = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// Uncaught SyntaxError: Rest element must be last element</span></span></code> </pre> <br><h4>  JSONæ‚¬æŒ‚é€—å· </h4><br> ä»…åœ¨ECMAScript 5ä¸­å…è®¸åœ¨å¯¹è±¡ä¸­æŒ‚é€—å·ã€‚ç”±äºJSONåŸºäºæ—©äºES5çš„JavaScriptè¯­æ³•<b>ï¼Œå› æ­¤JSONä¸­</b>ä¸å…è®¸<b>æŒ‚é€—å·ã€‚</b> <br><br> è¿™ä¸¤è¡Œéƒ½æŠ›å‡ºSyntaxError <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'[1, 2, 3, 4, ]'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'{"foo" : 1, }'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Uncaught SyntaxError: Unexpected token ] in JSON // Uncaught SyntaxError: Unexpected token } in JSON</span></span></code> </pre> <br><h4> ä¸ºä»€ä¹ˆæŒ‚é€—å·æœ‰ç”¨ï¼Ÿ </h4><br> æœ‰ä¸¤ä¸ªå¥½å¤„ã€‚ <br><br> é¦–å…ˆï¼Œé‡æ–°æ’åˆ—å…ƒç´ æ›´å®¹æ˜“ï¼Œå› ä¸ºå¦‚æœæœ€åä¸€ä¸ªå…ƒç´ æ”¹å˜äº†ä½ç½®ï¼Œåˆ™æ— éœ€æ·»åŠ æˆ–åˆ é™¤é€—å·ã€‚ <br><br> å…¶æ¬¡ï¼Œå®ƒå¯ä»¥å¸®åŠ©ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿè·Ÿè¸ªçœŸæ­£å‘ç”Ÿçš„å˜åŒ–ã€‚ ä¾‹å¦‚ï¼Œæ¥è‡ªï¼š <br><br><pre> <code class="plaintext hljs">[ 'Foo' ] : [ 'Foo', '' ]</code> </pre> <br> å¯¼è‡´å¸¦æœ‰â€œ fooâ€çš„è¡Œå’Œå¸¦æœ‰â€œ barâ€çš„è¡Œéƒ½è¢«æ ‡è®°ä¸ºå·²æ›´æ”¹ï¼Œå°½ç®¡å”¯ä¸€çš„å®é™…æ›´æ”¹æ˜¯æ·»åŠ æœ€åä¸€è¡Œã€‚ <br><br> è¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£ä¸­çš„</a>å°¾éšé€—å·ã€‚ <br><br><a name="section007"></a><h2>  7. SharedArrayBuffer </h2><br>  SharedArrayBufferå¯¹è±¡ç”¨äºåˆ›å»ºå›ºå®šé•¿åº¦çš„æ‹†åˆ†ç¼“å†²åŒºï¼Œä»¥å­˜å‚¨åŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼Œç±»ä¼¼äºArrayBufferå¯¹è±¡ï¼Œä½†æ˜¯ç›¸æ¯”ä¹‹ä¸‹ï¼ŒSharedArrayBufferå®ä¾‹å¯ç”¨äºåœ¨å…±äº«å†…å­˜ä¸Šåˆ›å»ºè§†å›¾ã€‚  SharedArrayBufferæ— æ³•æ–­å¼€è¿æ¥ã€‚ <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(length) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre>  length-åˆ›å»ºç¼“å†²åŒºæ•°ç»„çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ <br><br> è¿”å›-æŒ‡å®šé•¿åº¦çš„æ–°SharedArrayBufferå¯¹è±¡ã€‚ åˆå§‹åŒ–åå…¶å†…å®¹ä¸º0ã€‚ <br><br> ä¸ºäº†åœ¨ç¾¤é›†ä¸­çš„ä¸€ä¸ªä»£ç†ä¸å¦ä¸€ä¸ªä»£ç†ï¼ˆä»£ç†å¯ä»¥æ˜¯ç½‘é¡µçš„ä¸»ç¨‹åºæˆ–ç½‘ç»œå·¥ä½œäººå‘˜ä¹‹ä¸€ï¼‰ä¹‹é—´ä½¿ç”¨SharedArrayBufferå¯¹è±¡å…±äº«å†…å­˜ï¼Œä½¿ç”¨äº†postMessageå’Œç»“æ„åŒ–å…‹éš†ã€‚ <br><br> ç»“æ„åŒ–å…‹éš†ç®—æ³•æ¥å—æ˜ å°„åˆ°SharedArrayBuffersçš„SharedArrayBufferså’ŒTypedArraysã€‚ åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼ŒSharedArrayBufferå¯¹è±¡éƒ½ä¼ é€’ç»™æ¥æ”¶è€…ï¼Œåè€…åœ¨æ¥æ”¶ä»£ç†å†…éƒ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ç§æœ‰SharedArrayBufferå¯¹è±¡ï¼ˆä¸ArrayBufferç›¸åŒï¼‰ã€‚ ä½†æ˜¯ï¼Œä¸¤ä¸ªSharedArrayBufferå¯¹è±¡å¼•ç”¨çš„å…±äº«æ•°æ®å—æ˜¯åŒä¸€æ•°æ®å—ï¼Œå¹¶ä¸”å…¶ä¸­ä¸€ä¸ªä»£ç†ä¸­çš„è¯¥å—ä¸­çš„ç¬¬ä¸‰æ–¹æ•ˆæœæœ€ç»ˆå°†åœ¨å¦ä¸€ä¸ªä»£ç†ä¸­å¯è§ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); worker.postMessage(sab);</code> </pre> <br> å…±äº«å†…å­˜å¯ä»¥åœ¨workeræˆ–ä¸»çº¿ç¨‹ä¸­åŒæ—¶åˆ›å»ºå’Œæ›´æ”¹ã€‚ æ ¹æ®ç³»ç»Ÿï¼ˆCPUï¼ŒOSï¼Œæµè§ˆå™¨ï¼‰çš„ä¸åŒï¼Œæ›´æ”¹å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ä¼ æ’­åˆ°æ‰€æœ‰ä¸Šä¸‹æ–‡ã€‚ ä¸ºäº†åŒæ­¥ï¼Œéœ€è¦åŸå­æ“ä½œã€‚ <br><br> å…±äº«æ•°ç»„ç¼“å†²åŒºæ˜¯é«˜çº§å¹¶è¡ŒæŠ½è±¡çš„åŸºæœ¬æ„å»ºå—ã€‚ å®ƒä»¬ä½¿æ‚¨å¯ä»¥åœ¨å¤šä¸ªå·¥ä½œçº¿ç¨‹å’Œä¸»çº¿ç¨‹ä¹‹é—´å…±äº«SharedArrayBufferå¯¹è±¡çš„å­—èŠ‚ï¼ˆå…±äº«ç¼“å†²åŒºä»¥è®¿é—®å­—èŠ‚ï¼Œå°†å…¶åŒ…è£…åœ¨Typed Arrayä¸­ï¼‰ã€‚ è¿™ç§äº¤æ¢å…·æœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š <br> æ‚¨å¯ä»¥æ›´å¿«åœ°åœ¨å·¥ä½œäººå‘˜ä¹‹é—´äº¤æ¢æ•°æ®ã€‚ <br><br> å·¥äººä¹‹é—´çš„åè°ƒå˜å¾—è¶Šæ¥è¶Šå®¹æ˜“å’Œå¿«æ·ï¼ˆä¸postMessageï¼ˆï¼‰ç›¸æ¯”ï¼‰ã€‚ <br><br> å·¥äººçš„å®æ–½å¦‚ä¸‹ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// worker.js self.addEventListener ('message', function (event) { const {sharedBuffer} = event.data; const sharedArray = new Int32Array (sharedBuffer); // Â·Â·Â· });</span></span></code> </pre><br> é¦–å…ˆï¼Œæˆ‘ä»¬æå–å‘é€ç»™æˆ‘ä»¬çš„å…±äº«æ•°ç»„çš„ç¼“å†²åŒºï¼Œç„¶åå°†å…¶åŒ…è£…åœ¨ç±»å‹æ•°ç»„ä¸­ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°ä½¿ç”¨å®ƒã€‚ <br><br>  <b>SharedArrayBufferçš„å±æ€§å’Œæ–¹æ³•ã€‚</b> <br><br>  SharedArrayBuffer.length-å€¼ä¸º1çš„SharedArrayBufferæ„é€ å‡½æ•°çš„é•¿åº¦ã€‚ <br>  SharedArrayBuffer.prototype-å…è®¸æ‰€æœ‰SharedArrayBufferå¯¹è±¡ä½¿ç”¨å…¶ä»–å±æ€§ã€‚ <br><br>  <b>SharedArrayBufferå®ä¾‹</b> <br>  <b>å±æ€§</b> <br><br>  SharedArrayBuffer.prototype.constructor-å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡åŸå‹çš„å‡½æ•°ã€‚ åˆå§‹å€¼ä¸ºæ ‡å‡†çš„å†…ç½®SharedArrayBufferæ„é€ å‡½æ•°ã€‚ <br><br>  SharedArrayBuffer.prototype.byteLengthï¼ˆåªè¯»ï¼‰-æ•°ç»„çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ åœ¨åˆ›å»ºæ•°ç»„æ—¶è®¾ç½®ï¼Œæ— æ³•æ›´æ”¹ã€‚ <br><br>  <b>æ–¹æ³•</b> <br><br>  SharedArrayBuffer.prototype.sliceï¼ˆï¼‰-è¿”å›ä¸€ä¸ªæ–°çš„SharedArrayBufferï¼Œå…¶å†…å®¹æ˜¯æ­¤SharedArrayBufferä»ç‹¬å å¼€å§‹ï¼ˆåŒ…æ‹¬ç»“å°¾ï¼‰çš„å­—èŠ‚çš„å‰¯æœ¬ã€‚ å¦‚æœå¼€å§‹æˆ–ç»“æŸä¸ºè´Ÿæ•°ï¼Œåˆ™è¿™æ˜¯æŒ‡ä»æ•°ç»„æœ«å°¾å¼€å§‹çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯ä»å¼€å¤´å¼€å§‹ã€‚ æ­¤æ–¹æ³•ä¸Array.prototype.sliceï¼ˆï¼‰å…·æœ‰ç›¸åŒçš„ç®—æ³•ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  SharedArrayBuffer     const buffer = new SharedArrayBuffer(16); const int32View = new Int32Array(buffer); //  view // produces Int32Array [0, 0, 0, 0] int32View[1] = 42; const sliced = new Int32Array(buffer.slice(4,12)); console.log(sliced); // Int32Array [42, 0]</span></span></code> </pre> <br><pre> <code class="javascript hljs">sab.slice([begin, end]) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre> <br>  begin-æå–å¼€å§‹çš„é›¶ç´¢å¼•ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨è´Ÿç´¢å¼•æ¥æŒ‡ç¤ºè·åºåˆ—ç»“å°¾çš„åç§»é‡ã€‚  sliceï¼ˆ-2ï¼‰æå–åºåˆ—ä¸­çš„æœ€åä¸¤ä¸ªå…ƒç´ ã€‚ å¦‚æœæœªå®šä¹‰å¼€å§‹ï¼Œåˆ™åˆ‡ç‰‡ä»ç´¢å¼•0å¼€å§‹ã€‚ <br> ç»“æŸ-åº”ä»é›¶å¼€å§‹çš„ç´¢å¼•ï¼Œåº”å®Œæˆæå–ã€‚ <br><br> ä¾‹å¦‚ï¼Œåˆ‡ç‰‡ï¼ˆ1,4ï¼‰æ£€ç´¢ç¬¬äºŒä¸ªå…ƒç´ åˆ°ç¬¬å››ä¸ªå…ƒç´ ï¼ˆç´¢å¼•ä¸º1ã€2å’Œ3çš„å…ƒç´ ï¼‰ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨è´Ÿç´¢å¼•æ¥æŒ‡ç¤ºè·åºåˆ—ç»“å°¾çš„åç§»é‡ã€‚  sliceï¼ˆ2ï¼Œ-1ï¼‰é€šè¿‡åºåˆ—ä¸­çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ æ£€ç´¢ç¬¬ä¸‰ä¸ªå…ƒç´ ã€‚ å¦‚æœçœç•¥endï¼Œåˆ™ç‰‡å°†è¯»å–åºåˆ—çš„æœ«å°¾ï¼ˆsab.byteLengthï¼‰ã€‚ <br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); sab.slice(); <span class="hljs-comment"><span class="hljs-comment">// SharedArrayBuffer { byteLength: 1024 } sab.slice(2); // SharedArrayBuffer { byteLength: 1022 } sab.slice(-2); // SharedArrayBuffer { byteLength: 2 } sab.slice(0, 1); // SharedArrayBuffer { byteLength: 1 }</span></span></code> </pre> <br> è¯·å‚é˜…å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">è§„èŒƒ</a>ä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">MDN Webæ–‡æ¡£</a>ä¸­çš„SharedArrayBufferã€‚ <br><br><a name="section008"></a><h2>  8.åŸå­å­¦ </h2><br>  Atomicså¯¹è±¡æä¾›åŸå­æ“ä½œä½œä¸ºé™æ€æ–¹æ³•ã€‚ ä¸SharedArrayBufferå¯¹è±¡ä¸€èµ·ä½¿ç”¨ã€‚ <br><br> åŸå­æ“ä½œå®‰è£…åœ¨åŸå­æ¨¡å—ä¸­ã€‚ ä¸å…¶ä»–å…¨å±€å¯¹è±¡ä¸åŒï¼ŒAtomicsä¸æ˜¯æ„é€ å‡½æ•°ã€‚ å®ƒä¸èƒ½ä¸newè¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ï¼Œä¹Ÿä¸èƒ½å°†Atomicså¯¹è±¡ä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚ æ‰€æœ‰Atomicså±æ€§å’Œæ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼ˆä¾‹å¦‚ï¼Œç±»ä¼¼äºMathå¯¹è±¡ï¼‰ã€‚ <br><br> å…±äº«å†…å­˜æ—¶ï¼Œå‡ ä¸ªçº¿ç¨‹å¯ä»¥è¯»å–å’Œå†™å…¥ç›¸åŒçš„æ•°æ®åˆ°å†…å­˜ã€‚ åŸå­æ“ä½œä¿è¯å°†è¯»å–å’Œè¯»å–æœŸæœ›å€¼ï¼Œå¹¶åœ¨ä¸‹ä¸€ä¸ªæ“ä½œå¼€å§‹å·¥ä½œä¹‹å‰å®Œæˆæ“ä½œï¼Œå¹¶ä¸”ä¸ä¼šä¸­æ–­è¿™äº›æœŸæœ›å€¼ã€‚ <br><br><h4> å±æ€§ </h4><br>  Atomics [Symbol.toStringTag]-æ­¤å±æ€§çš„å€¼ä¸ºAtomicsã€‚ <br><br><h4> æ–¹æ³• </h4><br>  <b>åŸå­æ“ä½œ</b> <br><br><ul><li>  Atomics.addï¼ˆï¼‰-å°†æ˜¾ç¤ºçš„å€¼æ·»åŠ åˆ°æ•°ç»„ä¸­æŒ‡å®šä½ç½®çš„å½“å‰å€¼ã€‚ è¿”å›æ­¤ä½ç½®çš„å‰ä¸€ä¸ªå€¼ã€‚ </li><li>  Atomics.andï¼ˆï¼‰-åœ¨æŒ‡å®šçš„æ•°ç»„ä½ç½®è®¡ç®—æŒ‰ä½ä¸ã€‚ è¿”å›æ­¤ä½ç½®çš„å‰ä¸€ä¸ªå€¼ã€‚ </li><li>  Atomics.compareExchangeï¼ˆï¼‰-å¦‚æœæ˜¾ç¤ºçš„å€¼ç­‰äºæ˜¾ç¤ºçš„å€¼ï¼Œåˆ™å°†æ˜¾ç¤ºçš„å€¼ä¿å­˜åˆ°æ•°ç»„çš„æŒ‡å®šä½ç½®ã€‚ è¿”å›å‰ä¸€ä¸ªå€¼ã€‚ </li><li> Atomics.exchange() â€”       .   . </li><li> Atomics.load() â€”      . </li><li> Atomics.or() â€”   OR    .      . </li><li> Atomics.store() â€”       .  . </li><li> Atomics.sub() â€”          .      . </li><li> Atomics.xor() â€”   XOR    .      . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atomics.addï¼ˆï¼‰é™æ€æ–¹æ³•å°†å€¼æ·»åŠ åˆ°æ•°ç»„ä¸­æŒ‡å®šä½ç½®çš„å½“å‰å€¼ï¼Œå¹¶åœ¨æ­¤ä½ç½®è¿”å›å‰ä¸€ä¸ªå€¼ã€‚</font><font style="vertical-align: inherit;">æ­¤åŸå­æ“ä½œç¡®ä¿åœ¨å›å†™ä¿®æ”¹åçš„å€¼ä¹‹å‰ï¼Œä¸ä¼šå‘ç”Ÿå…¶ä»–å†™æ“ä½œã€‚</font></font><br><br><pre> <code class="javascript hljs">Atomics.add(typedArray, index, value) : mixed</code> </pre> <br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typedArray-æ•´æ•°çš„æ‹†åˆ†æ•°ç»„ã€‚</font><font style="vertical-align: inherit;">Int8Arrayï¼ŒUint8Arrayï¼ŒInt16Arrayï¼ŒUint16Arrayï¼ŒInt32Arrayæˆ–Uint32Arrayã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> index-typedArrayä¸­è¦æ·»åŠ å€¼çš„ä½ç½®ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value-è¦æ·»åŠ çš„æ•°å­—ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return-æŒ‡å®šä½ç½®çš„å…ˆå‰å€¼ï¼ˆtypedArray [index]ï¼‰ã€‚ </font></font></li></ul><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœtypedArrayç±»å‹ä¸æ˜¯æœ‰æ•ˆçš„æ•´æ•°ç±»å‹ä¹‹ä¸€ï¼Œåˆ™å¼•å‘TypeErrorã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœtypedArrayç±»å‹ä¸æ˜¯æ³›å‹ç±»å‹ï¼Œåˆ™å¼•å‘TypeErrorã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœindexåœ¨typedArrayä¹‹å¤–ï¼Œåˆ™æŠ›å‡ºRangeErrorã€‚ </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹å­</font></font></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ta = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8Array</span></span>(sab); Atomics.add(ta, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  0,   Atomics.load(ta, 0); // 12</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atomics.addï¼ˆï¼‰ä¸­çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§„èŒƒ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åå¤MDNç½‘ç»œä¸Šçš„æ–‡æ¡£</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç­‰å¾…å¹¶é€šçŸ¥ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">waitï¼ˆï¼‰å’Œwakeï¼ˆï¼‰æ–¹æ³•æ˜¯åŸºäºfutexesï¼ˆâ€œå¿«é€Ÿç”¨æˆ·ç©ºé—´äº’æ–¥ä½“â€ï¼‰Linuxå»ºæ¨¡çš„ï¼Œå¹¶æä¾›äº†ç­‰å¾…ç›´åˆ°æŸä¸ªçŠ¶æ€å˜ä¸ºçœŸçš„æ–¹æ³•ï¼Œé€šå¸¸ç”¨ä½œé˜»å¡æ„é€ ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atomics.waitï¼ˆï¼‰</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥ä»è¡¨ç¤º</font><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">æ˜¯å¦</font><font style="vertical-align: inherit;">åŒ…å«åœ¨æ•°ç»„çš„æŒ‡å®šä½ç½®ä¸­ï¼Œå¹¶ä¸”å¤„äºç¡çœ æŒ‚èµ·æˆ–è¶…æ—¶çŠ¶æ€ã€‚</font><font style="vertical-align: inherit;">è¿”å›ç¡®å®šï¼Œä¸ç­‰äºæˆ–è¶…æ—¶ã€‚</font><font style="vertical-align: inherit;">å¦‚æœè°ƒç”¨ä»£ç†ä¸­ä¸å…è®¸ç­‰å¾…ï¼Œåˆ™å®ƒå°†å¼•å‘å¼‚å¸¸é”™è¯¯ï¼ˆå¤§å¤šæ•°æµè§ˆå™¨ä¸å…è®¸åœ¨æµè§ˆå™¨çš„ä¸»æµä¸­ä½¿ç”¨waitï¼ˆï¼‰ï¼‰ã€‚</font></font><br><br><ul><li> Atomics.wait() â€” ,               -.  Â«okÂ», Â«not-equalÂ»  Â«timed-outÂ».       ,     (    wait()    ). </li><li> Atomics.wake() â€”   ,         .   ,   . </li><li> Atomics.isLockFree(size) â€”  ,            .  true,                 (  ).   . </li></ul><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¼˜åŒ–é—®é¢˜ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼˜åŒ–ä½¿å·¥ä½œäººå‘˜ä¸­çš„ä»£ç ä¸å¯é¢„æµ‹ã€‚</font><font style="vertical-align: inherit;">åœ¨å•çº¿ç¨‹ä¸­ï¼Œç¼–è¯‘å™¨å¯ä»¥æ‰§è¡Œç ´åå¤šçº¿ç¨‹ä»£ç çš„ä¼˜åŒ–ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ï¼š</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (sharedArray [<span class="hljs-number"><span class="hljs-number">0</span></span>] === <span class="hljs-number"><span class="hljs-number">123</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å•çº¿ç¨‹ä¸­ï¼ŒsharedArray [0]çš„å€¼åœ¨å¾ªç¯æ‰§è¡ŒæœŸé—´æ°¸ä¸æ›´æ”¹ï¼ˆå¦‚æœsharedArrayæ˜¯æ•°ç»„æˆ–æœªä»¥ä»»ä½•æ–¹å¼å›ºå®šçš„ç±»å‹åŒ–æ•°ç»„ï¼‰ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œå¯ä»¥å¯¹ä»£ç è¿›è¡Œå¦‚ä¸‹ä¼˜åŒ–ï¼š</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tmp = sharedArray [<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (tmp === <span class="hljs-number"><span class="hljs-number">123</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹æ¨¡å¼ä¸‹ï¼Œæ­¤ä¼˜åŒ–ä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨æ­¤æ¨¡æ¿æ¥ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰€åšçš„æ›´æ”¹ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦ä¸€ä¸ªç¤ºä¾‹æ˜¯ä»¥ä¸‹ä»£ç ï¼š</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// main.js sharedArray [1] = 11; sharedArray [2] = 22;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œæ‚¨å¯ä»¥é‡æ–°æ’åˆ—è¿™äº›å†™æ“ä½œï¼Œå› ä¸ºå®ƒä»¬ä¹‹é—´ä»€ä¹ˆä¹Ÿæ²¡è¯»ã€‚</font><font style="vertical-align: inherit;">å½“æ‚¨æœŸæœ›ä»¥ç‰¹å®šé¡ºåºæ‰§è¡Œè®°å½•æ—¶ï¼Œå¤šçº¿ç¨‹ä¼šé‡åˆ°é—®é¢˜ï¼š</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// worker.js while (sharedArray [2]! == 22); console.log (sharedArray [1]); // 0  11</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿™äº›ç±»å‹çš„ä¼˜åŒ–ä½¿å¾—å‡ ä¹ä¸å¯èƒ½å°†åœ¨åŒä¸€ç¼“å†²åŒºä¸Šå·¥ä½œçš„å¤šä¸ªå·¥ä½œç¨‹åºçš„æ“ä½œä¸ä¸€ä¸ªå…¬å…±æ•°ç»„åŒæ­¥ã€‚ </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è§£å†³ä¼˜åŒ–é—®é¢˜ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨Atomicså…¨å±€å˜é‡ï¼Œå…¶æ–¹æ³•æœ‰ä¸‰ä¸ªä¸»è¦ç”¨é€”ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€ä¸ªç”¨ä¾‹ï¼š</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒæ­¥ã€‚</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸå­æ–¹æ³•å¯ç”¨äºä¸å…¶ä»–å·¥ä½œäººå‘˜åŒæ­¥ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤ä¸ªæ“ä½œå…è®¸æ‚¨è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œå¹¶ä¸”ä¸ä¼šè¢«ç¼–è¯‘å™¨é‡æ–°æ’åºï¼š</font></font><br><br><pre> <code class="javascript hljs">Atomics.load (TypedArray &lt;T&gt;, index) : T Atomics.store (TypedArray &lt;T&gt;, index, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: T) : T</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æƒ³æ³•æ˜¯ä½¿ç”¨æ™®é€šæ“ä½œè¯»å–å’Œå†™å…¥å¤§å¤šæ•°æ•°æ®ï¼Œè€ŒAtomicsæ“ä½œï¼ˆåŠ è½½ï¼Œå­˜å‚¨å’Œå…¶ä»–æ“ä½œï¼‰ç¡®ä¿è¯»å–å’Œå†™å…¥æ˜¯å®‰å…¨çš„ã€‚é€šå¸¸ï¼Œæ‚¨å°†ä½¿ç”¨åŸºäºAtomicsçš„è‡ªå·±çš„åŒæ­¥æœºåˆ¶ï¼Œä¾‹å¦‚é”ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¤ºä¾‹ï¼Œç”±äºä½¿ç”¨äº†Atomicsï¼Œå®ƒå§‹ç»ˆå¯ä»¥æ­£å¸¸å·¥ä½œï¼ˆæˆ‘è·³è¿‡äº†sharedArrayçš„è®¾ç½®ï¼‰ï¼š</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// main.js console.log ('notified...'); Atomics.store (sharedArray, 0, 123); // worker.js while (Atomics.load (sharedArray, 0)! == 123); console.log ('notified');</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬äºŒä¸ªç”¨ä¾‹ï¼š</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç­‰å¾…é€šçŸ¥</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨whileå¾ªç¯æ¥ç­‰å¾…é€šçŸ¥ä¸æ˜¯å¾ˆæœ‰æ•ˆï¼Œå› æ­¤Atomicså…·æœ‰å¸®åŠ©æ€§çš„æ“ä½œï¼šAtomics.waitï¼ˆInt32Arrayï¼Œç´¢å¼•ï¼Œå€¼ï¼Œè¶…æ—¶ï¼‰å’ŒAtomics.wakeï¼ˆInt32Arrayï¼Œç´¢å¼•ï¼Œè®¡æ•°ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸‰ç§ç”¨ä¾‹ï¼š</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸå­è¿ç®—</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŸäº›åŸå­è¿ç®—å¯ä»¥ç®—æœ¯ä¸”ä¸èƒ½åŒæ—¶ä¸­æ–­ï¼Œè¿™æœ‰åŠ©äºåŒæ­¥ã€‚</font></font>ä¾‹å¦‚ï¼š <br><br><pre> <code class="javascript hljs">Atomics.add (TypedArray &lt;T&gt;, index, value) : T</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç²—ç•¥åœ°è¯´ï¼Œè¯¥æ“ä½œæ‰§è¡Œï¼šindex + = value; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼æ’•è£‚çš„é—®é¢˜ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±äº«å†…å­˜çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯å€¼æ’•è£‚ï¼ˆåƒåœ¾ï¼‰ï¼šè¯»å–æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªä¸­é—´å€¼-æ–°å€¼è¢«å†™å…¥å†…å­˜ä¹‹å‰æ—¢æ²¡æœ‰å€¼ï¼Œä¹Ÿæ²¡æœ‰æ–°å€¼ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§„èŒƒçš„â€œæ— æ’•è£‚é˜…è¯»â€éƒ¨åˆ†è§„å®šï¼Œå½“ä¸”ä»…å½“ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯»å–å’Œå†™å…¥éƒ½é€šè¿‡ç±»å‹åŒ–æ•°ç»„ï¼ˆè€ŒéDataViewï¼‰è¿›è¡Œã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿™ä¸¤ä¸ªç±»å‹åŒ–çš„æ•°ç»„éƒ½ä¸å®ƒä»¬çš„å…±äº«æ•°ç»„ç¼“å†²åŒºå¯¹é½ï¼šsharedArray.byteOffsetï¼…sharedArray.BYTES_PER_ELEMENT === 0 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¸¤ç§ç±»å‹çš„æ•°ç»„æ¯ä¸ªå…ƒç´ çš„å­—èŠ‚æ•°ç›¸åŒã€‚ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ¢å¥è¯è¯´ï¼Œå½“é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®å…±äº«æ•°ç»„çš„ç›¸åŒç¼“å†²åŒºæ—¶ï¼Œæ®‹ç¼ºå€¼æ˜¯ä¸€ä¸ªé—®é¢˜ï¼š </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¸€ä¸ªæˆ–å¤šä¸ªDateViewsï¼› </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæœªå¯¹é½çš„ç±»å‹åŒ–æ•°ç»„ï¼› </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å…·æœ‰ä¸åŒå¤§å°çš„å…ƒç´ çš„ç±»å‹åŒ–æ•°ç»„ï¼› </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¸ºé¿å…è¿™äº›æƒ…å†µä¸‹çš„å€¼å‡ºç°å·®å¼‚ï¼Œè¯·ä½¿ç”¨Atomicsæˆ–syncã€‚ </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä½¿ç”¨ä¸­çš„å…±äº«æ•°ç»„ç¼“å†²åŒº </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±äº«æ•°ç»„ç¼“å†²åŒºå’ŒJavaScriptè¯­ä¹‰ï¼Œç”¨äºæ‰§è¡Œæœªå†³å‡½æ•°ã€‚ JavaScriptå…·æœ‰æ‰€è°“çš„â€œå®Œæˆå‰â€æ‰§è¡Œè¯­ä¹‰ï¼šæ¯ä¸ªå‡½æ•°éƒ½å¯ä»¥æœŸæœ›å®ƒåœ¨å®Œæˆä¹‹å‰ä¸ä¼šè¢«å¦ä¸€ä¸ªçº¿ç¨‹ä¸­æ–­ã€‚å‡½æ•°æˆä¸ºäº‹åŠ¡å¹¶å¯ä»¥æ‰§è¡Œå®Œæ•´çš„ç®—æ³•ï¼Œè€Œæ²¡æœ‰äººçœ‹åˆ°å¤„äºä¸­é—´çŠ¶æ€çš„æ•°æ®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±äº«æ•°ç»„ç¼“å†²åŒºä¸­æ–­äº†å®Œæˆå‘¨æœŸï¼ˆRTCï¼‰ï¼šå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ›´æ”¹å‡½æ•°æ­£åœ¨å¤„ç†çš„æ•°æ®ã€‚ä½†æ˜¯ï¼Œè¯¥ä»£ç å®Œå…¨æ§åˆ¶æ˜¯å¦å‘ç”Ÿè¿™ç§RTCè¿è§„ï¼šå¦‚æœå®ƒä¸ä½¿ç”¨å…±äº«æ•°ç»„ç¼“å†²åŒºï¼Œåˆ™æ˜¯å®‰å…¨çš„ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™å¤§è‡´ç±»ä¼¼äºå¼‚æ­¥å‡½æ•°è¿åRTCçš„æ–¹å¼ã€‚åœ¨é‚£é‡Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨awaitå…³é”®å­—å¯ç”¨é”å®šæ“ä½œã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±äº«æ•°ç»„ç¼“å†²åŒºå…è®¸emscriptenåœ¨asm.jsä¸­ç¼–è¯‘pthreadã€‚å¼•ç”¨emscriptenæ–‡æ¡£é¡µé¢ï¼š</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[En] [å…è®¸å…±äº«é˜µåˆ—ç¼“å†²åŒº] Emscriptenåº”ç”¨ç¨‹åºå¯åœ¨Web Workerä¹‹é—´å…±äº«ä¸»å†…å­˜å †ã€‚è¿™ä¸ä½çº§åŸå­å’Œfutexæ”¯æŒçš„åŸè¯­ä¸€èµ·ä½¿Emscriptenèƒ½å¤Ÿå®ç°å¯¹Pthreadsï¼ˆPOSIXçº¿ç¨‹ï¼‰APIçš„æ”¯æŒã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Ru] [å…±äº«é˜µåˆ—ç¼“å†²åŒºå…è®¸] Emscriptenåº”ç”¨ç¨‹åºåœ¨Web Workerä¹‹é—´å…±äº«ä¸€å †ä¸»å†…å­˜ã€‚é™¤äº†åº•å±‚åŸå­åŸè¯­å’Œfutexæ”¯æŒä¹‹å¤–ï¼ŒEmscriptenè¿˜æ”¯æŒPthreads APIï¼ˆPOSIXçº¿ç¨‹ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨å¯ä»¥åœ¨asm.jsä¸­ç¼–è¯‘å¤šçº¿ç¨‹Cå’ŒC ++ä»£ç ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³äºå¦‚ä½•æœ€å¥½åœ°åœ¨WebAssemblyä¸­ä½¿ç”¨å¤šçº¿ç¨‹çš„è®¨è®ºæ­£åœ¨è¿›è¡Œä¸­ã€‚</font><font style="vertical-align: inherit;">é‰´äºWebå·¥ä½œäººå‘˜ç›¸å¯¹è¾ƒé‡ï¼ŒWebAssemblyå¯èƒ½ä¼šå¼•å…¥è½»é‡çº§çº¿ç¨‹ã€‚</font><font style="vertical-align: inherit;">æ‚¨è¿˜å¯ä»¥çœ‹åˆ°ä¸»é¢˜æ­£åœ¨èµ°å‘WebAssemblyçš„æœªæ¥ã€‚</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> äº¤æ¢é™¤æ•´æ•°ä»¥å¤–çš„æ•°æ® </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®å‰ï¼Œåªèƒ½ä½¿ç”¨æ•´æ•°æ•°ç»„ï¼ˆæœ€é•¿32ä½ï¼‰ã€‚</font><font style="vertical-align: inherit;">è¿™æ„å‘³ç€å…±äº«å…¶ä»–ç±»å‹æ•°æ®çš„å”¯ä¸€æ–¹æ³•æ˜¯å°†å®ƒä»¬ç¼–ç ä¸ºæ•´æ•°ã€‚</font><font style="vertical-align: inherit;">å¯èƒ½æœ‰ç”¨çš„å·¥å…·åŒ…æ‹¬ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TextEncoderå’ŒTextDecoderï¼šå‰è€…å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºUint8Arrayå®ä¾‹ï¼Œåè€…åˆ™ç›¸åã€‚ </font></font></li><li> stringview.js: ,      .   . </li><li> FlatJS:  JavaScript        (,   )    (ArrayBuffer  SharedArrayBuffer). JavaScript + FlatJS    JavaScript. JavaScript  (TypeScript  . .) . </li><li> TurboScript:  JavaScript-    .    asm.js  WebAssembly. </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åï¼Œå¯èƒ½ä¼šå‡ºç°å…¶ä»–çš„æ›´é«˜çº§åˆ«çš„æ•°æ®äº¤æ¢æœºåˆ¶ã€‚å®éªŒå°†ç»§ç»­æ‰¾å‡ºè¿™äº›æœºåˆ¶çš„å¤–è§‚ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨å…±äº«æ•°ç»„ç¼“å†²åŒºçš„ä»£ç èƒ½ä»¥å¤šå¿«çš„é€Ÿåº¦å·¥ä½œï¼Ÿ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lars T. Hansenç¼–å†™äº†Mandelbrotç®—æ³•çš„ä¸¤ç§å®ç°ï¼ˆå¦‚ä»–çš„æ–‡ç« â€œ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScriptçš„æ–°å¹¶è¡ŒåŸºå…ƒçš„å‘³é“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€æ‰€è¿°ï¼Œå®ƒæ˜¯ä½¿ç”¨å¤šä¸ªWebå·¥ä½œè€…çš„é¡ºåºç‰ˆæœ¬å’Œå¹¶è¡Œç‰ˆæœ¬ã€‚æœ€å¤š4ä¸ªWebå·¥ä½œè€…ï¼Œå› æ­¤å¤„ç†å™¨æ ¸å¿ƒï¼ŒåŠ é€Ÿå‡ ä¹å‘ˆçº¿æ€§å¢é•¿ï¼Œä»æ¯ç§’6.9å¸§ï¼ˆ1ä¸ªWebå·¥ä½œè€…ï¼‰åˆ°æ¯ç§’25.4å¸§ï¼ˆ4ä¸ªWebå·¥ä½œè€…ï¼‰ã€‚æ›´å¤šçš„Webå·¥ä½œè€…å¸¦æ¥äº†é¢å¤–çš„ç”Ÿäº§ç‡æé«˜ï¼Œä½†æ•ˆç‡å´æœ‰æ‰€æé«˜ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HansenæŒ‡å‡ºï¼ŒåŠ é€Ÿæ˜¯ä»¤äººå°è±¡æ·±åˆ»çš„ï¼Œä½†æ˜¯å¹¶è¡Œå·¥ä½œæ˜¯ç”±äºä»£ç æ›´åŠ å¤æ‚ã€‚</font><font style="vertical-align: inherit;">æœ‰å…³å…±äº«é˜µåˆ—ç¼“å†²åŒºå’Œæ”¯æŒæŠ€æœ¯çš„</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä»–ä¿¡æ¯</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><ul><li> <a href="" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…±äº«å†…å­˜</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Lars T.Hansen </font><a href="" rel="nofollow"><font style="vertical-align: inherit;">çš„ç®€çŸ­æ•™ç¨‹</font></a></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‹‰å°”æ–¯Â·æ±‰æ£®ï¼ˆLars T.Hansenï¼‰</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">å“å°JavaScriptçš„æ–°å¹¶è¡ŒåŸè¯­</font></a></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharedArrayBufferå’ŒAtomicsç¬¬2.95é˜¶æ®µåˆ°ç¬¬3é˜¶æ®µ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆPDFï¼‰ï¼ŒGuo-yu Guoå’ŒLars T. Hansençš„å¹»ç¯ç‰‡ï¼ˆ2016-11-30ï¼‰[ESå¥å­éšé™„çš„å¹»ç¯ç‰‡]</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç½‘ç»œå·¥ä½œè€…çš„åŸºæœ¬çŸ¥è¯†ï¼Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œè€…ï¼šåŸƒé‡Œå…‹Â·æ¯”å¾·å°”æ›¼ï¼ˆEric Bidelmanï¼‰[ç½‘ç»œå·¥ä½œè€…ç®€ä»‹]ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å…¶ä»–JavaScriptå¹¶å‘æŠ€æœ¯ï¼š </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è·¯å¾„ï¼Œä»¥å¹¶è¡Œçš„JavaScript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ç”±èµ«å°”æ›¼[å…¶ä¸­JavaScriptæ˜¯æ‹’ç»PJSçš„ç§»åŠ¨åçš„æ¦‚è¿°]çš„Dave</font></font></li><li> â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Write massively-parallel GPU code for the browser with WebGL</a> â€ by Steve Sanderson [ , ,   WebGL      GPU]. </li><li> â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Concurrency is not parallelism</a> â€ by Rob Pike [Rob Pike   Â«concurrencyÂ»  Â«parallelismÂ»    ]. </li><li> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Using Web Workers</a> " from MDN [  MDN,      web workers]. </li><li> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Shared memory and atomics</a> " by Axel Rauschmayer [     js   Shared Array Buffers  Atomics] </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·å‚é˜…å®˜æ–¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§„èŒƒ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥åŠ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MDN Webæ–‡æ¡£</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸­çš„</font><font style="vertical-align: inherit;">Atomics Object </font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><a name="section009"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9.å¼‚æ­¥åŠŸèƒ½ </font></font></h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä½¿ç”¨AsyncFunctionæ„é€ å‡½æ•°åˆ›å»ºAsyncå‡½æ•° </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AsyncFunctionæ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å¼‚æ­¥å‡½æ•°å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">åœ¨JavaScriptä¸­ï¼Œä»»ä½•å¼‚æ­¥å‡½æ•°å®é™…ä¸Šéƒ½æ˜¯AsyncFunctionå¯¹è±¡ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·æ³¨æ„ï¼ŒAsyncFunctionä¸æ˜¯å…¨å±€å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹ä»£ç è·å¾—å®ƒã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}).constructor</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥æ³•</font></font></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncFunction([arg1[, arg2[, ...argN]],] functionBody)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arg1ï¼Œarg2ï¼Œ... argN-å‡½æ•°ç”¨ä½œå½¢å¼å‚æ•°åç§°çš„åç§°ã€‚æ¯ä¸ªåç§°å¿…é¡»æ˜¯ä¸æœ‰æ•ˆçš„JavaScriptæ ‡è¯†ç¬¦åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œæˆ–æ­¤ç±»é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²çš„åˆ—è¡¨ï¼›ä¾‹å¦‚ï¼Œâ€œ xâ€ï¼Œâ€œ theValueâ€æˆ–â€œ aï¼Œbâ€ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">functionBody-ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«JavaScriptæºä»£ç ä¸­çš„å‡½æ•°å®šä¹‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨AsyncFunctionæ„é€ å‡½æ•°åˆ›å»ºçš„å¼‚æ­¥å‡½æ•°å¯¹è±¡å°†åœ¨å‡½æ•°åˆ›å»ºæ—¶è¿›è¡Œè§£æã€‚ä¸ä½¿ç”¨å¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å£°æ˜å¼‚æ­¥å‡½æ•°å¹¶åœ¨ä»£ç å†…éƒ¨è°ƒç”¨å¼‚æ­¥å‡½æ•°ç›¸æ¯”ï¼Œè¿™æ•ˆç‡è¾ƒä½ï¼Œå› ä¸ºæ­¤ç±»å‡½æ•°ä¼šä¸å…¶ä½™ä»£ç ä¸€èµ·è§£æã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼ é€’ç»™å‡½æ•°çš„æ‰€æœ‰å‚æ•°æŒ‰ç…§ä¼ é€’é¡ºåºè¢«è§†ä¸ºåˆ›å»ºçš„å‡½æ•°ä¸­çš„å‚æ•°æ ‡è¯†ç¬¦çš„åç§°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†AsyncFunctionæ„é€ å‡½æ•°ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼ˆä¸ä½¿ç”¨newè¿ç®—ç¬¦ï¼‰ä¸å°†å…¶ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨å…·æœ‰ç›¸åŒçš„æ•ˆæœã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨AsyncFunctionæ„é€ å‡½æ•°åˆ›å»ºçš„å¼‚æ­¥å‡½æ•°ä¸ä¼šä½¿åˆ›å»ºå®ƒä»¬çš„ä¸Šä¸‹æ–‡çŸ­è·¯ã€‚å®ƒä»¬å§‹ç»ˆåœ¨å…¨å±€èŒƒå›´å†…åˆ›å»ºã€‚å½“ä»–ä»¬å¼€å§‹æ—¶ï¼Œä»–ä»¬å°†åªèƒ½è®¿é—®å…¶å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ï¼Œä½†æ— æƒè®¿é—®è°ƒç”¨AsyncFunctionæ„é€ å‡½æ•°çš„ä½œç”¨åŸŸã€‚è¿™ä¸å°†evalä¸å¼‚æ­¥å‡½æ•°çš„ä»£ç ä¸€èµ·ä½¿ç”¨ä¸åŒã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨AsyncFunctionæ„é€ å‡½æ•°åˆ›å»ºå¼‚æ­¥å‡½æ•°çš„ç¤ºä¾‹</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveAfter2Seconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(x); }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); }); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> AsyncFunction = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}).constructor <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncFunction(<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'return await resolveAfter2Seconds(a) + await resolveAfter2Seconds(b);'</span></span>); a(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(v); <span class="hljs-comment"><span class="hljs-comment">//  30  4  });</span></span></code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¼‚æ­¥å‡½æ•°å£°æ˜ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼‚æ­¥å‡½æ•°å£°æ˜å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªAsyncFunctionå¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å®šä¹‰å¼‚æ­¥å‡½æ•°ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥æ³•</font></font></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[param[, param[, ... param]]]</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// body }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name-å‡½æ•°çš„åç§°ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param-è¦ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°åç§°ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥-åŒ…å«å‡½æ•°ä¸»ä½“çš„è¡¨è¾¾å¼ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è°ƒç”¨ä¹‹åï¼Œå¼‚æ­¥å‡½æ•°è¿”å›Promiseã€‚æ¥æ”¶åˆ°ç»“æœåï¼ŒPromiseå®Œæˆï¼Œè¿”å›æ¥æ”¶åˆ°çš„å€¼ã€‚å½“å¼‚æ­¥å‡½æ•°å¼•å‘å¼‚å¸¸æ—¶ï¼ŒPromiseå°†å¤±è´¥ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå€¼ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼‚æ­¥å‡½æ•°å¯ä»¥åŒ…å«ä¸€ä¸ªç­‰å¾…è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼æš‚åœå¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œå¹¶ç­‰å¾…æ¥è‡ªæ‰€ä¼ é€’çš„Promiseçš„å“åº”ï¼Œç„¶åæ¢å¤å¼‚æ­¥å‡½æ•°å¹¶è¿”å›æ¥æ”¶åˆ°çš„å€¼ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awaitå…³é”®å­—ä»…åœ¨å¼‚æ­¥å‡½æ•°ä¸­æœ‰æ•ˆã€‚åœ¨å¦ä¸€ç§æƒ…å†µä¸‹ï¼Œæ‚¨å°†æ”¶åˆ°ä¸€ä¸ªSyntaxErroré”™è¯¯ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼‚æ­¥/ç­‰å¾…åŠŸèƒ½çš„ç›®çš„æ˜¯åŒæ­¥ç®€åŒ–promiseçš„ä½¿ç”¨ï¼Œå¹¶åœ¨Promisesç»„ä¸Šé‡ç°ä¸€äº›æ“ä½œã€‚</font><font style="vertical-align: inherit;">å°±åƒæ‰¿è¯ºå°±åƒç»“æ„åŒ–å›è°ƒä¸€æ ·ï¼Œå¼‚æ­¥/ç­‰å¾…å°±åƒç”Ÿæˆå™¨å’Œæ‰¿è¯ºçš„ç»„åˆã€‚</font></font><br><br>  <b>ä¾‹å­</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveAfter2Seconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(x); }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); }); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> resolveAfter2Seconds(<span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> resolveAfter2Seconds(<span class="hljs-number"><span class="hljs-number">30</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + a + b; } add1(<span class="hljs-number"><span class="hljs-number">10</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(v); <span class="hljs-comment"><span class="hljs-comment">//  60  4  }); async function add2(x) { const a = resolveAfter2Seconds(20); const b = resolveAfter2Seconds(30); return x + await a + await b; } add2(10).then(v =&gt; { console.log(v); //  60  2  });</span></span></code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¼‚æ­¥çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åœ¨ä¸€ä¸ª.jsæ–‡ä»¶ä¸­ç¼–å†™JSç¨‹åºï¼Œä½†æ˜¯æ‚¨çš„ä»£ç å¾ˆå¯èƒ½ä¼šåˆ†æˆå‡ éƒ¨åˆ†ã€‚ç°åœ¨ä»…æ‰§è¡Œå…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†å°†åœ¨ä»¥åæ‰§è¡Œã€‚å‡½æ•°æ˜¯å°†ç¨‹åºåˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†çš„æœ€å¸¸ç”¨çš„æŠ€æœ¯ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹äºå¤§å¤šæ•°åˆæ¬¡ä½¿ç”¨JSçš„å¼€å‘äººå‘˜æ¥è¯´ï¼Œä¸»è¦é—®é¢˜æ˜¯å¯¹ç°åœ¨ä»¥åä¸ä¼šå‘ç”Ÿçš„äº‹æƒ…ç¼ºä¹äº†è§£ã€‚æ¢å¥è¯è¯´ï¼Œæ ¹æ®å®šä¹‰ï¼Œç°åœ¨æ— æ³•å®Œæˆçš„ä»»åŠ¡å°†å¼‚æ­¥ç»“æŸã€‚è€Œä¸”ï¼Œæˆ‘ä»¬å°†ä¸ä¼šæ‹¥æœ‰å‡å®šçš„ç¨‹åºçš„é˜»å¡è¡Œä¸ºã€‚ ï¼ˆYou-Dont-Know-JS /å¼‚æ­¥ä¸æ€§èƒ½ï¼ŒJake Archibaldï¼‰ã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ajax(..)  Ajax-,   var data = ajax( "http://some.url.1" ); console.log( data );// !  `data`     Ajax-</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯ä»€ä¹ˆé”™è¯¯ï¼Ÿ</font><font style="vertical-align: inherit;">åœ¨æˆ‘ä»¬ä»è¯·æ±‚æ¥æ”¶æ•°æ®ä¹‹å‰æ‰§è¡Œconsole.logï¼ˆï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»ç°åœ¨å¼€å§‹åˆ°ä»¥åâ€œç­‰å¾…â€çš„æ˜æ˜¾å†³å®šæ˜¯ä½¿ç”¨å›è°ƒï¼š</font></font><br><br><pre> <code class="javascript hljs">ajax( <span class="hljs-string"><span class="hljs-string">"http://some.url.1"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myCallbackFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( data ); <span class="hljs-comment"><span class="hljs-comment">// ,   ! } );</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è€ƒè™‘è¿‡æ—©è§£å†³åŒæ­¥ä»£ç æ‰§è¡Œçš„å„ç§æ–¹æ³•ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æœ‰3ä¸ªå‡½æ•°getUserï¼ŒgetPostsï¼ŒgetCommentsã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { getUser, getPosts, getComments } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./db'</span></span>); getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>, (error, user) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); getPosts(user.id, (error, posts) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id, (error, comment) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments); }); }); });</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå¾ˆéš¾ä¸æ³¨æ„åˆ°é‡‘å­—å¡”ï¼Œé‡‘å­—å¡”éšç€å¢åŠ çš„æ–°åŠŸèƒ½è€Œå¢åŠ ã€‚è¿™ç§ç¼–ç é£æ ¼é€šå¸¸ç§°ä¸ºâ€œ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›è°ƒåœ°ç‹±â€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¿™æ˜¯ä¸€ç§ç‰¹å®šæ¨¡å¼ï¼Œå¯è®©æ‚¨æ§åˆ¶ç«äº‰ï¼ˆå¼‚æ­¥ï¼‰è¯·æ±‚ï¼Œä»è€Œç¡®ä¿æ‰§è¡Œé¡ºåºã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§£å†³åµŒå¥—å‡½æ•°é—®é¢˜çš„éƒ¨åˆ†æ–¹æ³•æ˜¯ä½¿ç”¨Promiseï¼ˆæˆ‘åœ¨ä¸Š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ç¯‡æ–‡ç« ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¨è®ºäº†Promise </font><font style="vertical-align: inherit;">ï¼Œå®ƒåˆ é™¤äº†å®ƒå¹¶ä½¿ä»£ç æ›´æ•´æ´ã€‚å®ƒä»¬è¿˜æä¾›äº†æ›´æ–¹ä¾¿çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚ä½†æ˜¯è®¸å¤šäººä¸å–œæ¬¢è¿™ç§è¯­æ³•ã€‚</font></font><br><br><pre> <code class="javascript hljs">getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> =&gt;</span></span> getPosts(user,id)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">posts</span></span></span><span class="hljs-function"> =&gt;</span></span> getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">comments</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆå™¨æˆä¸ºPromiseçš„æ›¿ä»£æ–¹æ³•ï¼ˆæˆ‘ä¹Ÿåœ¨ä¸Š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ç¯‡æ–‡ç« ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿›è¡Œäº†</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">è®¨è®º</font></a><font style="vertical-align: inherit;">ã€‚ç”Ÿæˆå™¨æœ¬èº«ä¸é€‚åˆç¼–å†™å¼‚æ­¥ä»£ç ï¼Œä½†æ˜¯å¦‚æœå°†å®ƒä»¬ä¸Promiseä¸€èµ·ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€äº›ç‹¬ç‰¹çš„ä¸œè¥¿-çœ‹èµ·æ¥æ˜¯åŒæ­¥çš„å¼‚æ­¥ä»£ç ã€‚åŒæ—¶ï¼Œç”Ÿæˆå™¨æä¾›äº†ä½¿ç”¨try ... catchæ„é€ å‡½æ•°çš„ç†Ÿæ‚‰çš„é”™è¯¯å¤„ç†æœºåˆ¶åªæœ‰ç”Ÿæˆå™¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„è´Ÿå·-ä¸ºäº†ä¸Promiseä¸€èµ·ä½¿ç”¨ï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°æ¥æ§åˆ¶ç”Ÿæˆå™¨çš„è¿‡ç¨‹ç­”ï¼šæ‚¨å¯ä»¥è‡ªå·±ç¼–å†™æ­¤å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆä¾‹å¦‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coï¼‰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ç¼–å†™äº†æ­¤ç±»å‡½æ•°çš„å®ç°ã€‚</font></font><br><br><pre> <code class="javascript hljs">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> posts = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getPosts(user.id); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> comments = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); } }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">co</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">generator</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> iterator = generator(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prev</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { value, done } = iterator.next(prev); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (done) resolve(value); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>) value.then(run, reject); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> run(value); } run(); }); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨å¼‚æ­¥ä»£ç çš„æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›è°ƒå‡½æ•°ï¼ˆå›è°ƒå‡½æ•°ï¼‰-æ˜“äºä½¿ç”¨ï¼Œä½†æ˜¯éšç€åµŒå¥—å‡½æ•°çš„å¢åŠ ï¼Œå¯è¯»æ€§å¼€å§‹å—åˆ°æŸå®³ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Promisesï¼ˆPromisesï¼‰-ä¼˜é›…è€Œèˆ’é€‚ï¼Œä½†å¯¹äºåˆå­¦è€…æ¥è¯´å¾ˆéš¾ç†è§£ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆå™¨ï¼ˆGeneratorsï¼‰-å…è®¸æ‚¨åŒæ­¥ç¼–å†™å¼‚æ­¥ä»£ç ï¼Œä½†æ˜¯å®ƒä»¬éœ€è¦å•ç‹¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”ç”Ÿæˆå™¨çš„æ“ä½œæœºåˆ¶éå¸¸å¤æ‚ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼‚æ­¥å‡½æ•°æ˜¯åœ¨Promiseså’ŒGeneratorsçš„åŸºç¡€ä¸Šåˆ›å»ºçš„ï¼Œä»¥ä¾¿ä½¿å¼‚æ­¥ä»£ç çš„å·¥ä½œå˜å¾—ç®€å•æ˜“æ‡‚ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†äº†è§£ä»€ä¹ˆæ˜¯å¼‚æ­¥å‡½æ•°ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user); <span class="hljs-comment"><span class="hljs-comment">// { id: 1 }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç°åœ¨ï¼Œå¦‚æœä½¿å‡½æ•°å¼‚æ­¥ï¼ˆæ·»åŠ asyncå…³é”®å­—ï¼‰ï¼Œåˆ™è¯¥å‡½æ•°å°†è¿”å›ä¸€ä¸ªPromiseï¼Œå…¶ä¸­åŒ…å«å…·æœ‰idå±æ€§çš„å¯¹è±¡ã€‚ </font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user); <span class="hljs-comment"><span class="hljs-comment">// Promise { {id: 1} }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä»»ä½•å¼‚æ­¥å‡½æ•°éƒ½è¿”å›Promisï¼ˆæˆ–è€…å°†å…¶åº”è¿”å›çš„å€¼åŒ…è£…åœ¨Promisä¸­ï¼‰ã€‚</font><font style="vertical-align: inherit;">å¦‚æœè¿”å›ç»™å¼‚æ­¥å‡½æ•°çš„å€¼å·²ç»æ˜¯ä¸€ä¸ªPromiseï¼Œåˆ™å°†ä¸ä¼šå†æ¬¡å°†å…¶è½¬å›ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†ä»è¯ºè¨€ä¸­è·å¾—ä»·å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨thenï¼ˆï¼‰æ–¹æ³•ã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user)); <span class="hljs-comment"><span class="hljs-comment">// { id: 1 }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨awaitå…³é”®å­—ï¼Œç¨åå°†å¯¹å…¶è¿›è¡Œè®¨è®ºã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬å›åˆ°ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼ˆä»…è¿™æ¬¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨realå‡½æ•°å‘é€HTTPè¯·æ±‚ã€‚</font></font><br><br><pre> <code class="javascript hljs">fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> data.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™å°±æ˜¯ä½¿ç”¨Promiseå¼‚æ­¥ä»£ç çš„æ ·å­ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨å¼‚æ­¥å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¼‚æ­¥ä»£ç ç¼–å†™ä¸ºåŒæ­¥ä»£ç ã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response= <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sendRequest(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(a); } main();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å”¯ä¸€ä¸å–œæ¬¢çš„æ˜¯å¼‚æ­¥è¿ç®—ç¬¦åªèƒ½åœ¨å¼‚æ­¥å‡½æ•°ä¸­ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">å¦åˆ™ï¼Œæˆ‘å°†ä¸éœ€è¦ä½¿ç”¨mainï¼ˆï¼‰å‡½æ•°ã€‚</font><font style="vertical-align: inherit;">å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨thenï¼ˆï¼‰æ–¹æ³•ï¼Œä½†éšåçš„ä»£ç å°†ä¸å†æ˜¯å¼‚æ­¥çš„ã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response= <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } sendRequest() .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨å›è°ƒå‡½æ•°ä»fetchï¼ˆï¼‰è·å–æ•°æ®ã€‚</font><font style="vertical-align: inherit;">ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨awaitå…³é”®å­—ï¼Œå®ƒå®é™…ä¸Šå‘Šè¯‰äº†è¿è¡Œæ—¶ï¼šç­‰å¾…fetchï¼ˆï¼‰å‡½æ•°æ‰§è¡Œå¹¶å°†ç»“æœå†™å…¥å“åº”å˜é‡ã€‚</font><font style="vertical-align: inherit;">ç„¶åä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œæˆ‘ä»¬è¯´ï¼šç­‰å¾…fetchï¼ˆï¼‰å‡½æ•°æ‰§è¡Œå¹¶è°ƒç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†æ•°æ®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯ä½¿ç”¨Promiseå’Œå¼‚æ­¥åŠŸèƒ½ä¹‹é—´çš„æ˜æ˜¾åŒºåˆ«</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  Promise function sendRequest() { return fetch(`https://jsonplaceholder.typicode.com/users/1`) .then(data =&gt; data.json()); } //  async function async function sendRequest() { let response = await fetch(`https://jsonplaceholder.typicode.com/users/1`); return response.json(); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awaitè¿ç®—ç¬¦åªèƒ½åœ¨å¼‚æ­¥å‡½æ•°çš„ä¸»ä½“ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”å…¶æ“ä½œå¯ä»¥åœ¨ä»»ä½•è¿”å›promiseçš„å‡½æ•°ä¸­ä½¿ç”¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†å¤„ç†å¼‚æ­¥å‡½æ•°ä¸­çš„å¼‚å¸¸ï¼Œä¹ æƒ¯ä¸Šä½¿ç”¨try ... catchæ„é€ ã€‚</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">"Unexpected error"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); <span class="hljs-comment"><span class="hljs-comment">// Error: Unexpected error at sendRequest } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æœ€å... </font></font><br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    async; await; async; await; async; await; async; await; In the System(); The function.sleep()s tonight~</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·å‚é˜…å®˜æ–¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§„èŒƒ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥åŠ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MDN Webæ–‡æ¡£</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸­çš„â€œ </font><font style="vertical-align: inherit;">å¼‚æ­¥å‡½æ•°å®šä¹‰â€ </font><font style="vertical-align: inherit;">ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN475074/">https://habr.com/ru/post/zh-CN475074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN475060/index.html">åˆ›å»ºç®€å•çš„å‘¼å«è·Ÿè¸ªæœåŠ¡ï¼Œç¬¬2éƒ¨åˆ†</a></li>
<li><a href="../zh-CN475062/index.html">ä»‹ç»Appleç™»å½•-Appleæˆæƒç³»ç»Ÿ</a></li>
<li><a href="../zh-CN475064/index.html">é€‚ç”¨äºWindowsæ¡Œé¢çš„.NET Core 3</a></li>
<li><a href="../zh-CN475068/index.html">æˆ‘ä»¬å°†æ‰€æœ‰å±€åŸŸç½‘æµé‡éƒ½å°è£…åœ¨vpnä¸­ï¼Œè€Œæ²¡æœ‰é€Ÿåº¦é™åˆ¶</a></li>
<li><a href="../zh-CN475072/index.html">é€šè¿‡å…¬å¸çš„çœ¼å…‰å®ä¹ ç”Ÿ</a></li>
<li><a href="../zh-CN475076/index.html">è‹è”è¶…çº§è‹±é›„ï¼Œæ·å…‹é¼»å±å’Œæ¾³å¤§åˆ©äºšå…‹éš†äºº</a></li>
<li><a href="../zh-CN475078/index.html">äº†è§£SwiftUIä¸­çš„å±æ€§åŒ…è£…å™¨</a></li>
<li><a href="../zh-CN475082/index.html">Habræ¯å‘¨ï¼ƒ26 /æ¯å‘¨å·¥ä½œå››å¤©ï¼ŒGitLabå‚æ”¿ï¼ŒYandexæ­£åœ¨æµ‹è¯•Roveré€è´§æœºå™¨äºº</a></li>
<li><a href="../zh-CN475086/index.html">é¢å‘å‰ç«¯å¼€å‘äººå‘˜çš„REST APIç±»å‹</a></li>
<li><a href="../zh-CN475092/index.html">â€œæˆ‘ç¨åå†è¯»â€ï¼šè„±æœºæ”¶é›†ç½‘é¡µçš„è‰°éš¾å‘½è¿</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>