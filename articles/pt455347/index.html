<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍢 👌🏾 ⚖️ Interfaces funcionais ... em VBA 🚕 👩🏻‍🚒 👞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""... aqueles que não são avessos a encarar um amador culpando publicamente um tolo, observem como eu provo que Java e Visual Basic são gêmeos separado...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interfaces funcionais ... em VBA</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455347/">  <i>"... aqueles que não são avessos a encarar um amador culpando publicamente um tolo, observem como eu provo que Java e Visual Basic são gêmeos separados no nascimento, e C ++ eles nem são parentes distantes".</i> <br><br>  <b>Bruce McKinney “Die Hard Basic Basic”</b> <br><br><h3>  1. Introdução </h3><br>  Um interesse constante nas abordagens de programação funcional atualmente leva ao fato de que as linguagens de programação tradicionais estão adquirindo ativamente meios funcionais.  E embora as linguagens funcionais puras ainda não sejam muito populares, a funcionalidade está firmemente estabelecida em linguagens como C ++, Java, JavaScript, Python e outras.A linguagem VBA é popular com uma audiência bastante grande de usuários do Microsoft Office há muitos anos. esse idioma praticamente não contém ferramentas funcionais. <br><br>  Vamos tentar preencher essa lacuna - proponho uma implementação completa (embora talvez não perfeita) de interfaces funcionais implementadas pelo VBA.  A implementação pode servir de base para aprimoramentos e aprimoramentos subsequentes. <br><a name="habracut"></a><br><h3>  Problema de argumentos funcionais </h3><br>  O primeiro problema que enfrentaremos nesse caminho é o problema de passar argumentos funcionais para uma função ou método.  O idioma do VBA não contém as ferramentas apropriadas (o operador AddressOf serve apenas para transferir endereços para as funções da API do Windows e não é totalmente seguro de usar).  O mesmo pode ser dito sobre o conhecido método de chamar funções pelo ponteiro (G. Magdanurov Visual Basic na prática São Petersburgo: “BHV Petersburg”, 2008).  Não vamos correr riscos - usamos apenas recursos de linguagem padrão e bibliotecas padrão na implementação. <br><br>  Infelizmente, aqui a OLP não ajuda muito.  Para transferir um objeto funcional para um procedimento ou função, o VBA oferece uma oportunidade padrão - agrupar a funcionalidade necessária com um shell de objeto (crie um objeto, um dos métodos dos quais será a funcionalidade necessária).  Um objeto pode ser passado como um parâmetro.  Essa abordagem é viável, mas muito pesada - para cada funcionalidade necessária, você terá que criar sua própria classe e um objeto dessa classe. <br><br>  Existe outra maneira, que é muito mais simples e não requer a criação de classes separadas para cada funcionalidade. <br><br>  Suponha que você deseje passar uma função anônima para um determinado procedimento proc que incrementa seu argumento em um.  Esta função pode ser escrita da seguinte maneira: <br><br><pre><code class="vbscript hljs">x -&gt; x+<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Essa notação de atribuir funções anônimas agora quase se tornou o "padrão de fato".  A única maneira de passar essa função para um parâmetro é usar uma representação de string: <br><br><pre> <code class="vbscript hljs">r=proc(a,b,”x-&gt;x+<span class="hljs-number"><span class="hljs-number">1</span></span>”)</code> </pre> <br>  aqui aeb são parâmetros comuns e o terceiro parâmetro é uma função sem nome, que é muito clara e pouco difere das entradas nas linguagens de programação populares. <br><br>  Para usar uma função anônima definida dessa maneira, você deve primeiro trazê-la para o formato padrão da função VBA.  Isso executa o seguinte procedimento utilitário: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> prepCode(Code As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> k% = <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(Code, <span class="hljs-string"><span class="hljs-string">"-&gt;"</span></span>) parms$ = <span class="hljs-built_in"><span class="hljs-built_in">Trim</span></span>$(<span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>$(Code, k% - <span class="hljs-number"><span class="hljs-number">1</span></span>)) body$ = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>$(Code, k% + <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>$(parms$, <span class="hljs-number"><span class="hljs-number">1</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">"("</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> parms$ = <span class="hljs-string"><span class="hljs-string">"("</span></span> + parms$ + <span class="hljs-string"><span class="hljs-string">")"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(body$, <span class="hljs-string"><span class="hljs-string">"self"</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> body$ = <span class="hljs-string"><span class="hljs-string">";self="</span></span> &amp; body$ &amp; <span class="hljs-string"><span class="hljs-string">";"</span></span> body$ = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(body$, <span class="hljs-string"><span class="hljs-string">";"</span></span>, vbCrLf) prepCode = <span class="hljs-string"><span class="hljs-string">"function self"</span></span> &amp; parms &amp; vbCrLf &amp; body &amp; _ vbCrLf &amp; <span class="hljs-string"><span class="hljs-string">"end function"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span></code> </pre><br>  A função seleciona uma lista de parâmetros e o corpo de cálculo e, em seguida, forma uma função chamada self.  Para o nosso caso, a função auto terá a seguinte forma: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> self(x) self=x+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span></code> </pre><br>  Obviamente, de acordo com a sintaxe do VBA, essa função fará exatamente o que a função anônima deveria ter feito - aumente o valor de seu argumento em 1. É verdade que essa função ainda não é uma função do VBA, mas apenas uma sequência que contém o código especificado.  Para transformar uma string em uma função, você pode usar a biblioteca padrão da Microsoft “Msscript.ocx”.  Essa biblioteca COM permite que você execute código VBA arbitrário especificado em forma de seqüência de caracteres.  Para fazer isso, faça o seguinte: <br><br>  - Crie um objeto ScriptControl <br>  - Chame o método de instalação da linguagem (VBScript); <br>  - Chame o método de carregamento de funções; <br>  - Chame o método eval para fazer a chamada. <br><br>  Tudo se parece com isso: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> locEv=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ScriptControl locEv.Language = <span class="hljs-string"><span class="hljs-string">"VBScript"</span></span> locEv.AddCode prepCode(“x-&gt;x+<span class="hljs-number"><span class="hljs-number">1</span></span>”) r=locEv.<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(“self(<span class="hljs-number"><span class="hljs-number">5</span></span>)”)</code> </pre><br>  Após executar esse código, o valor da variável r será 6. <br><br>  Três pontos devem ser feitos aqui: <br><br><ul><li>  O corpo de uma função anônima pode conter várias linhas.  As instruções individuais nesse caso terminam com ponto e vírgula.  No código final, os caracteres ";"  são excluídos.  Um corpo de várias linhas permite implementar funcionalidades muito avançadas em funções anônimas; </li><li>  O fato de a função anônima “na realidade” ter o nome “auto” oferece um bônus inesperado - uma função anônima pode ser recursiva. </li><li>  Como o objeto ScriptControl suporta duas linguagens - VBScript e Jscript, a função anônima pode ser (teoricamente) escrita em Jscript (quem quiser pode tentar). </li></ul><br>  A seguir, um modelo de implementação de objeto será descrito. <br><br><h3>  Modelo de objeto </h3><br>  A base do modelo são objetos de dois tipos: Container e Generator.  O objeto Container é um repositório de uma matriz de tamanhos arbitrários; o objeto Generator, como o nome indica, implementa um gerador de formulários geral. <br><br>  Ambos os objetos implementam a interface aIter, descrita em mais detalhes abaixo.  A interface inclui 19 funções: <br><br><div class="scrollable-table"><table><tbody><tr><td>  Nome do método </td><td>  Parâmetros </td><td>  Resultado </td></tr><tr><td>  isGen </td><td>  - </td><td>  Retorna True se o objeto for um gerador. </td></tr><tr><td>  isCont </td><td>  - </td><td>  Retorna True se o objeto for um contêiner. </td></tr><tr><td>  getCont </td><td>  - </td><td>  Para um contêiner retorna uma matriz local, para um gerador retorna Vazio </td></tr><tr><td>  getNext </td><td>  - </td><td>  Retorna o seguinte valor </td></tr><tr><td>  hasNext </td><td>  - </td><td>  Retorna True se o seguinte valor estiver presente </td></tr><tr><td>  Init </td><td>  iniVal como variante, lambda como string = "", emptyC como booleano = falso </td><td>  iniVal - valor inicial; <br>  lambda - função anônima para gerador <br>  emptyC - quando definido como True, um contêiner vazio é criado <br></td></tr><tr><td>  Tome </td><td>  n como inteiro </td><td>  Retorna um contêiner contendo n valores consecutivos obtidos do objeto de origem </td></tr><tr><td>  Filtro </td><td>  lambda como string </td><td>  Retorna o objeto obtido filtrando o original de acordo com a função lambda sem nome </td></tr><tr><td>  Mapa </td><td>  lambda como string </td><td>  Retorna o objeto obtido mapeando o original de acordo com a função lambda sem nome </td></tr><tr><td>  Reduzir </td><td>  acc Como variante, lambda como sequência, </td><td>  Retorna o resultado da convolução do objeto atual com o valor inicial da bateria acc e a função de dobragem especificada pelo parâmetro lambda </td></tr><tr><td>  takeWhile </td><td>  n Como Inteiro, <br>  lambda As String <br></td><td>  Retorna um contêiner contendo n (ou menos) valores consecutivos que satisfazem o predicado especificado pela função lambda sem nome </td></tr><tr><td>  dropWhile </td><td>  n Como Inteiro, <br>  lambda As String <br></td><td>  Retorna um contêiner contendo n (ou menos) valores consecutivos obtidos do original após ignorar valores que atendem ao predicado especificado por lambda. </td></tr><tr><td>  zip </td><td>  iter Como aIter, <br>  n Como Inteiro = 10 <br></td><td>  Ele aceita um contêiner ou gerador e retorna um contêiner contendo pares de valores - do contêiner base e do contêiner.  O tamanho padrão do resultado é dez. </td></tr><tr><td>  zipWith </td><td>  iter Como aIter, <br>  lambda como corda, <br>  n Como Inteiro = 10 <br></td><td>  Leva um contêiner e uma função anônima de dois argumentos.  Retorna um contêiner que contém os resultados da aplicação da função especificada a pares sucessivos - um valor do contêiner base e outro do contêiner de parâmetros. </td></tr><tr><td>  Tamanho </td><td>  - </td><td>  Para um contêiner, retorna o número de elementos </td></tr><tr><td>  summa </td><td>  - </td><td>  Soma dos valores do contêiner </td></tr><tr><td>  produção </td><td>  - </td><td>  Produto dos valores do contêiner </td></tr><tr><td>  máximo </td><td>  - </td><td>  O valor máximo no contêiner </td></tr><tr><td>  mínimo </td><td>  - </td><td>  O valor mínimo no contêiner </td></tr></tbody></table></div><br>  Para um objeto gerador, vários métodos não são implementados diretamente - você deve primeiro selecionar um certo número de valores em um contêiner.  Ao tentar chamar um método não realizado para um gerador, um erro é gerado com o código 666. Em seguida, vários exemplos de uso das interfaces descritas serão considerados. <br><br><h3>  Exemplos </h3><br>  Impressão de números consecutivos de Fibonacci: <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Test_1() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> fibGen As aIter <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> fibGen = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Generator fibGen.Init <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-string"><span class="hljs-string">"(c,p)-&gt;c+p"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i% = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> Debug.Print fibGen.getNext() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> i% <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  Aqui, um gerador é criado com os valores iniciais 0 e 1 e uma função geradora correspondente à sequência de Fibonacci.  Em seguida, os 50 primeiros números são impressos em um loop. <br>  Mapa e filtro: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Test_2() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> co As aIter <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> Z As aIter <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> w As aIter <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> co = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Container co.Init frange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> Z = co.map(<span class="hljs-string"><span class="hljs-string">"x -&gt; 1.0/x"</span></span>). _ take(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>(<span class="hljs-string"><span class="hljs-string">" x -&gt; (x&gt;0.3) or (x&lt;=0.1)"</span></span>) iii% = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> Z.hasNext() Debug.Print iii%; <span class="hljs-string"><span class="hljs-string">" "</span></span>; Z.getNext() iii% = iii% + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  Um contêiner é criado e inicializado por uma sequência numérica do intervalo de 1 a 100. Em seguida, os números com o mapa são substituídos pelo inverso.  Destes, os vinte primeiros são tirados.  Em seguida, essa população é filtrada e números maiores que 0,3 ou menores que 0,1 são selecionados nela.  O resultado é retornado no contêiner, cuja composição é impressa. <br>  Usando convolução: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Test_4() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> co As aIter <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> co = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Container co.Init frange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) v = co.reduce(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"(acc,x)-&gt;acc+x"</span></span>) Debug.Print v v = co.reduce(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"(acc,x)-&gt;acc*x"</span></span>) Debug.Print v <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  Aqui, usando convolução, é considerada a soma e o produto dos números de 1 a 100. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Test_5() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> co1 As aIter <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> co2 As aIter <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> co3 As aIter <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> co1 = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Generator co1.Init <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">123456789</span></span>), <span class="hljs-string"><span class="hljs-string">"x -&gt; INT(x/10)"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> co2 = co1.takeWhile(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">"x -&gt; x &gt; 0"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> co3 = co2.map(<span class="hljs-string"><span class="hljs-string">"x -&gt; x mod 10"</span></span>) Debug.Print co3.maximun Debug.Print co3.minimum Debug.Print co3.summa Debug.Print co3.production <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  Neste exemplo, o gerador co1 é construído, dividindo sequencialmente o número original por graus 10. Em seguida, os quocientes são selecionados até o zero aparecer.  Depois disso, a lista resultante de quocientes é exibida pela função de tomar o restante da divisão por 10. O resultado é uma lista de dígitos do número.  A lista é resumida, ele calculou o máximo, mínimo e produto. <br><br><h3>  Conclusões </h3><br>  A abordagem proposta é bastante viável e pode ser aplicada com sucesso para resolver tarefas diárias de um programador de VBA em um estilo funcional.  Por que somos piores que os javistas? <br><br>  Faça o download de exemplos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> <br><br>  Boa sorte !!! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt455347/">https://habr.com/ru/post/pt455347/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt455337/index.html">Quem adicionou o Python à atualização mais recente do Windows?</a></li>
<li><a href="../pt455339/index.html">Cavando túmulos, SQL Server, anos de terceirização e seu primeiro projeto</a></li>
<li><a href="../pt455341/index.html">O que se sabe sobre a certificação ITIL 4</a></li>
<li><a href="../pt455343/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 9. O mundo físico dos switches. Parte 2</a></li>
<li><a href="../pt455345/index.html">Cuidado Médico</a></li>
<li><a href="../pt455351/index.html">VMware EMPOWER 2019 - os principais anúncios e conclusões da conferência</a></li>
<li><a href="../pt455353/index.html">Aceleração de hardware de redes neurais profundas: GPU, FPGA, ASIC, TPU, VPU, IPU, DPU, NPU, RPU, NNP e outras letras</a></li>
<li><a href="../pt455355/index.html">Redes de TV a cabo para os menores. Parte 8: Rede de backbone óptico</a></li>
<li><a href="../pt455359/index.html">Swift funcional é fácil</a></li>
<li><a href="../pt455361/index.html">Criamos uma extensão do navegador que verifica os resultados do exame</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>