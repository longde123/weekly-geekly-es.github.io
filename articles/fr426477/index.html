<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§πüèæ üôéüèø üì´ Toute la v√©rit√© sur RTOS. Article # 15. Partitions de m√©moire: services et structures de donn√©es üë®‚Äç‚öïÔ∏è ‚òùüèº üà∑Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, nous continuons √† passer en revue les sections de m√©moire du RTOS. 

 Nucleus RTOS dispose de trois appels d'API qui fournissent des...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Toute la v√©rit√© sur RTOS. Article # 15. Partitions de m√©moire: services et structures de donn√©es</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426477/"><img src="https://habrastorage.org/webt/3t/wd/au/3twdaubgcbrqlkg0al5lttnqs-y.jpeg"><br><br>  Dans cet article, nous continuons √† passer en revue les sections de m√©moire du RTOS. <br><br>  Nucleus RTOS dispose de trois appels d'API qui fournissent des fonctions utilitaires li√©es aux pools de partitions de m√©moire: renvoyer des informations sur les pools de partitions, renvoyer le nombre de pools de partitions dans une application et renvoyer des pointeurs vers tous les pools de partitions dans une application.  Les deux premiers d√©fis sont impl√©ment√©s dans Nucleus SE. <br><a name="habracut"></a><br>  Articles pr√©c√©dents de la s√©rie: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 14.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sections de m√©moire: introduction et services de base</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 13.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Structures de donn√©es de t√¢che et appels d'API non pris en charge</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 12.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Services pour travailler avec des t√¢ches</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 11.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√¢ches: configuration et introduction √† l'API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scheduler: fonctionnalit√©s avanc√©es et pr√©servation du contexte</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 9.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scheduler: impl√©mentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 8.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nucleus SE: conception interne et d√©ploiement</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nucleus SE: Introduction</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Autres services RTOS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interaction et synchronisation des t√¢ches</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√¢ches, changement de contexte et interruptions</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√¢ches et planification</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RTOS: Structure et mode temps r√©el</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RTOS: introduction.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a> <br><h2>  R√©cup√©ration des informations du pool de partitions </h2><br>  Cet appel de service fournit des informations partielles sur le pool de partitions.  L'impl√©mentation de Nucleus SE diff√®re de Nucleus RTOS en ce qu'elle renvoie moins d'informations car les noms des objets et les demandes de pause ne sont pas pris en charge et la t√¢che ne peut pas √™tre interrompue. <br><br><h3>  Appel des informations du pool de partitions dans Nucleus RTOS </h3><br>  Prototype d'appel: <br><br>  <b>STATUS NU_Partition_Pool_Information (pool NU_PARTITION_POOL *, nom CHAR *, VOID ** start_address, UNSIGNED * pool_size, UNSIGNED * partition_size, UNSIGNED * disponible, UNSIGNED * allou√©, OPTION * suspend_type, UNSIGNED * tasks_waiting ** first_task; first_task; first_task; first_task; first_task;</b> <br><br>  Param√®tres: <br><br>  <b>pool</b> - un pointeur vers le pool de partitions sur lequel des informations sont demand√©es; <br>  <b>nom</b> - pointeur vers la zone de destination √† 8 caract√®res pour le nom du pool de partitions;  comprend un endroit pour terminer z√©ro; <br>  <b>start_address</b> - un pointeur vers une variable qui re√ßoit un pointeur vers le d√©but de la zone de donn√©es du pool de partitions; <br>  <b>pool_size</b> - un pointeur sur une variable qui re√ßoit la taille du pool de partitions (en octets); <br>  <b>partition_size</b> - pointeur vers une variable qui obtient la taille des partitions dans un pool donn√©; <br>  <b>available</b> - un pointeur sur une variable qui re√ßoit le nombre de partitions actuellement disponibles dans ce pool; <br>  <b>allou√©</b> - un pointeur vers une variable qui re√ßoit le nombre de partitions actuellement utilis√©es dans un pool donn√©; <br>  <b>suspend_type</b> - pointeur vers une variable pour obtenir le type de suspension de t√¢che;  types de suspension valides: <b>NU_FIFO</b> et <b>NU_PRIORITY</b> ; <br>  <b>tasks_waiting</b> - un pointeur sur une variable qui re√ßoit le nombre de t√¢ches suspendues dans un pool de partitions donn√©; <br>  <b>first_task</b> - pointeur vers le pointeur de t√¢che dans lequel se trouve le pointeur de la premi√®re t√¢che suspendue. <br><br>  Valeur de retour: <br><br>  <b>NU_SUCCESS</b> - l'appel s'est termin√© avec succ√®s; <br>  <b>NU_INVALID_POOL</b> - pointeur non valide vers le pool de partitions. <br><br><h3>  Appel des informations du pool de partitions dans Nucleus SE </h3><br>  Prototype d'appel: <br><br>  <b>STATUS NUSE_Partition_Pool_Information (pool NUSE_PARTITION_POOL, ADDR * start_address, U32 * pool_size, U16 * partition_size, U8 * disponible, U8 * allou√©, U8 * tasks_waiting, NUSE_TASK * first_task)</b> <br><br>  Param√®tres: <br><br>  <b>pool</b> - l'index du pool de partitions pour lequel des informations sont demand√©es; <br>  <b>start_address</b> - un pointeur vers une variable qui re√ßoit un pointeur vers le d√©but de la zone de donn√©es du pool de partitions; <br>  <b>pool_size</b> - un pointeur sur une variable qui re√ßoit la taille du pool de partitions (en octets); <br>  <b>partition_size</b> - pointeur vers une variable qui obtient la taille des partitions dans un pool donn√©; <br>  <b>available</b> - un pointeur sur une variable qui re√ßoit le nombre de partitions actuellement disponibles dans ce pool; <br>  <b>allou√©</b> - un pointeur vers une variable qui re√ßoit le nombre de partitions actuellement utilis√©es dans un pool donn√©; <br>  <b>tasks_waiting</b> - un pointeur vers une variable qui re√ßoit le nombre de t√¢ches suspendues dans ce pool de partitions (si la suspension des t√¢ches est d√©sactiv√©e, 0 est renvoy√©); <br>  <b>first_task</b> - un pointeur vers une variable de type <b>NUSE_TASK</b> , qui re√ßoit l'index de la premi√®re t√¢che suspendue (si la suspension de la t√¢che est d√©sactiv√©e, 0 est renvoy√©). <br><br>  Valeur de retour: <br><br>  <b>NUSE_SUCCESS</b> - l'appel s'est termin√© avec succ√®s; <br>  <b>NUSE_INVALID_POOL</b> - index de pool de partitions non valide; <br>  <b>NUSE_INVALID_POINTER</b> - un ou plusieurs des pointeurs transmis ne sont pas valides. <br><br><h3>  Impl√©mentation de la r√©cup√©ration d'informations et du regroupement de partitions dans Nucleus SE </h3><br>  La mise en ≈ìuvre d'un tel appel d'API est simple √† ex√©cuter: <br><br><img src="https://habrastorage.org/webt/ia/82/sj/ia82sj807l4yuaio-mvf-ypjivm.jpeg"><br><br>  La fonction renvoie l'√©tat du pool de partitions.  Ensuite, si le blocage des appels API est activ√©, le nombre de t√¢ches en attente et l'index de la premi√®re d'entre elles sont renvoy√©s (sinon, ces param√®tres sont d√©finis sur 0). <br><br><h2>  Obtention du nombre de pools de partitions </h2><br>  Cet appel renvoie des informations sur le nombre de pools de partitions configur√©s dans l'application.  Alors que dans Nucleus RTOS, ce nombre change au fil du temps et que la valeur de retour repr√©sentera le nombre actuel de pools, dans Nucleus SE, la valeur de retour est d√©finie lors de l'assemblage et reste inchang√©e. <br><br><h3>  Le d√©fi d'obtenir le nombre de pools de partitions dans Nucleus RTOS </h3><br>  L'appel prend en charge la fonctionnalit√© de base de l'API RTOS Nucleus. <br><br>  Prototype d'appel: <br><br>  <b>UNSIGNED NU_Established_Partition_Pools (VOID);</b> <br><br>  Param√®tres: <br><br>  Sont absents. <br><br>  Valeur de retour: <br><br>  Nombre de pools de partitions cr√©√©s dans l'application. <br><br><h3>  Le d√©fi d'obtenir le nombre de pools de partitions dans Nucleus SE </h3><br>  Cet appel d'utilitaire prend en charge la fonctionnalit√© principale de l'API RTOS Nucleus. <br><br>  Prototype d'appel: <br><br>  <b>U8 NUSE_Partition_Pool_Count (void);</b> <br><br>  Param√®tres: <br><br>  Sont absents <br><br>  Valeur de retour: <br><br>  Nombre de pools de partitions cr√©√©s dans l'application. <br><br><h3>  Impl√©mentation </h3><br>  L'impl√©mentation de cet appel d'API est extr√™mement simple: la valeur <b>#define</b> du symbole <b>NUSE_PARTITION_POOL_NUMBER</b> est <b>retourn√©e</b> . <br><br><h2>  Structures de donn√©es </h2><br>  Comme tous les autres objets Nucleus SE, les pools de partitions utilisent des tableaux de structure √† la fois dans la ROM et la RAM, dont le nombre d√©pend du nombre de pools sp√©cifi√©s dans les param√®tres. <br><br>  Je recommande fortement que le code d'application acc√®de √† ces structures de donn√©es via des fonctions API, et non directement.  Cela √©vite l'incompatibilit√© avec les futures versions de Nucleus SE et les effets secondaires ind√©sirables, et simplifie √©galement le portage de l'application vers Nucleus RTOS.  Ce qui suit est une description d√©taill√©e des structures de donn√©es pour faciliter la compr√©hension du code d'appel de service et le d√©bogage. <br><br><h3>  Structure des donn√©es du noyau plac√©es dans la RAM </h3><br>  Ces structures de donn√©es comprennent: <br><br>  <b>NUSE_Partition_Pool_Partition_Used []</b> - un tableau de type <b>U8</b> , ayant une entr√©e pour chaque pool de partitions configur√©, contenant le compteur des pools actuellement utilis√©s; <br>  <b>NUSE_Partition_Pool_Blocking_Count []</b> - un tableau de type <b>U8</b> contenant un compteur de t√¢ches bloqu√©es dans chaque pool de partitions.  Ce tableau existe si le blocage de l'appel d'API est possible. <br><br>  Ces structures de donn√©es sont initialis√©es en z√©ros √† l'aide de <b>NUSE_Init_ Partition_Pool ()</b> lors du d√©marrage de Nucleus SE.  C'est logique car cela rend chaque partition de chaque pool inutilis√©e (gratuite).  L'article suivant fournira une description compl√®te des proc√©dures de d√©marrage dans Nucleus SE. <br><br>  Voici les descriptions des structures de donn√©es dans le fichier <b>nuse_init.c</b> . <br><br><img src="https://habrastorage.org/webt/vi/3x/sx/vi3xsxmbwdzkwgfge9ws_dsvups.jpeg"><br><br><h3>  Donn√©es utilisateur RAM </h3><br>  L'utilisateur doit allouer une zone en RAM pour stocker les donn√©es de chaque pool de partitions.  La quantit√© d'espace dans la RAM doit correspondre au volume des partitions configur√©es (voir ¬´Donn√©es dans la ROM¬ª ci-dessous) avec un octet suppl√©mentaire pour chaque partition du pool.  Chaque section de la zone de donn√©es est pr√©c√©d√©e d'un octet d'√©tat. <br><br><h3>  Donn√©es ROM </h3><br>  Cela comprend: <br><br>  <b>NUSE_Partition_Pool_Data_Address []</b> - un tableau de type <b>ADDR</b> , avec une entr√©e pour chaque pool de partitions configur√©, contenant l'adresse du d√©but de la zone de stockage des donn√©es; <br>  <b>NUSE_Partition_Pool_Partition_Number []</b> - un tableau de type <b>U8</b> avec une entr√©e pour chaque pool de partitions configur√© contenant des informations sur le nombre de partitions dans le pool; <br>  <b>NUSE_Partition_Pool_Partition_Size []</b> - un tableau de type <b>U16</b> avec une entr√©e pour chaque pool de partitions configur√©, contenant la taille des partitions pour les pools. <br><br>  Ces structures de donn√©es sont d√©clar√©es et initialis√©es (statiquement) dans <b>nuse_config.c</b> : <br><br><img src="https://habrastorage.org/webt/zt/67/lq/zt67lqadvkdzmuvazbj0mmlhp8a.jpeg"><br><br><h3>  Empreinte des donn√©es pour le pool de partitions </h3><br>  Comme pour tous les objets principaux de Nucleus SE, la quantit√© de m√©moire requise pour les pools de partitions est pr√©visible. <br><br>  La taille de la ROM (en octets) pour tous les pools de partitions d'application peut √™tre calcul√©e comme suit: <br><br>  <b>NUSE_PARTITION_POOL_NUMBER * (taille de (ADDR) + 2)</b> <br><br>  La quantit√© de donn√©es du noyau dans la RAM pour tous les pools de partitions d'application lorsque le blocage d'appels API est activ√© ne prend que 2 octets par pool de partitions, et lorsque le blocage n'est pas activ√©, cela prend 1 octet. <br><br>  La quantit√© de m√©moire pour stocker les donn√©es utilisateur dans la RAM varie pour chaque pool de partitions, bien que, comme d√©j√† mentionn√©, pour un pool avec l'index n, elle puisse √™tre calcul√©e comme suit: <br><br>  <b>NUSE_Partition_Pool_Partition_Number [n] *</b> <br>  <b>(NUSE_Partition_Pool_Partition_Size [n] + 1)</b> <br><br><h2>  Appels d'API non r√©alis√©s </h2><br>  Trois appels d'API pour les pools de partitions impl√©ment√©s dans Nucleus RTOS ne sont pas pris en charge dans Nucleus SE. <br><br><h3>  Cr√©er un pool de partitions </h3><br>  Cet appel d'API cr√©e un pool de partitions.  Nucleus SE n'en a pas besoin car les t√¢ches sont cr√©√©es statiquement. <br><br>  Prototype d'appel: <br><br>  <b>STATUS NU_Create_Partition_Pool (pool NU_PARTITION_POOL *, nom CHAR *, VOID * start_address, UNSIGNED pool_size, UNSIGNED partition_size, OPTION suspend_type);</b> <br><br>  Param√®tres: <br><br>  <b>pool</b> - un pointeur vers une unit√© de contr√¥le de <b>pool de</b> partitions d√©finie par l'utilisateur;  utilis√© comme descripteur du pool de partitions dans d'autres appels d'API; <br>  <b>nom</b> - un pointeur sur le nom du pool de partitions, une cha√Æne de 7 caract√®res avec un z√©ro de fin; <br>  <b>start_address</b> - d√©finit l'adresse de d√©but de la zone m√©moire du pool de partitions; <br>  <b>pool_size</b> - quantit√© totale de m√©moire en octets; <br>  <b>partition_size</b> - la quantit√© de m√©moire en octets pour chaque partition du pool.  En plus de cela, une petite quantit√© suppl√©mentaire de m√©moire est allou√©e associ√©e √† chaque section, ce qui est r√©alis√© gr√¢ce aux deux pointeurs de donn√©es utilis√©s. <br>  <b>suspend_type</b> - d√©termine comment les t√¢ches sont suspendues dans le pool de partitions;  Les options de param√®tre valides sont <b>NU_FIFO</b> et <b>NU_PRIORITY</b> . <br><br>  Valeur de retour: <br><br>  <b>NU_SUCCESS</b> - indique la r√©ussite de l'appel; <br>  <b>NU_INVALID_POOL</b> - indique la valeur z√©ro de l'unit√© de contr√¥le du pool de partitions ( <b>NULL</b> ); <br>  <b>NU_INVALID_MEMORY</b> - indique la valeur z√©ro de la zone m√©moire d√©finie par l' <b>adresse start_</b> ( <b>NULL</b> ); <br>  <b>NU_INVALID_SIZE</b> - indique que la taille de la partition est soit 0, soit sup√©rieure √† la m√©moire allou√©e √† la partition; <br>  <b>NU_INVALID_SUSPEND</b> - valeur <b>suspend_type</b> non <b>valide</b> . <br><br><h3>  Suppression du pool de partitions </h3><br>  Cet appel d'API supprime un pool de partitions cr√©√© pr√©c√©demment.  Nucleus SE n'en a pas besoin car les objets sont cr√©√©s statiquement et ne peuvent pas √™tre supprim√©s. <br><br>  Prototype d'appel: <br><br>  <b>STATUS NU_Delete_Partition_Pool (pool NU_PARTITION_POOL *);</b> <br><br>  Param√®tres: <br><br>  <b>pool</b> - pointeur vers l'unit√© de contr√¥le du pool de partitions; <br><br>  Valeur de retour: <br><br>  <b>NU_SUCCESS</b> - indique la r√©ussite de l'appel; <br>  <b>NU_INVALID_POOL</b> - indique une valeur non valide pour le pointeur du pool de partitions; <br><br><h3>  Pointeurs de pool de partition </h3><br>  Cet appel d'API cr√©e une liste s√©quentielle de pointeurs vers tous les pools de partitions du syst√®me.  Nucleus SE n'en a pas besoin car les objets sont identifi√©s par un index et non par un pointeur. <br><br>  Prototype d'appel: <br><br>  <b>UNSIGNED NU_Partition_Pool_Pointers (NU_PARTITION_POOL ** pointer_list, UNSIGNED maximum_pointers);</b> <br><br>  Param√®tres: <br><br>  <b>pointer_list</b> - pointeur vers un tableau de pointeurs <b>NU_PARTITION_POOL</b> ;  la baie est remplie de pointeurs vers des pools configur√©s dans le syst√®me; <br>  <b>maximum_pointers</b> - le nombre maximum de pointeurs pouvant √™tre plac√©s dans le tableau. <br><br>  Valeur de retour: <br><br>  Nombre de pointeurs <b>NU_PARTITION_POOL</b> plac√©s dans le tableau. <br><br><h2>  Compatible avec Nucleus RTOS </h2><br>  Lors du d√©veloppement de Nucleus SE, l'une des principales t√¢ches consistait √† garantir un haut niveau de compatibilit√© du code avec Nucleus RTOS.  Les pools de partition ne faisaient pas exception et, du point de vue du d√©veloppeur, ils sont impl√©ment√©s de la m√™me mani√®re que dans Nucleus RTOS.  Certaines zones d'incompatibilit√© existantes sont acceptables, m√™me s'il convient de consid√©rer que le code final est plus facile √† comprendre et plus efficace en termes de m√©moire.  Cependant, les appels d'API Nucleus RTOS peuvent √™tre utilis√©s presque directement comme appels Nucleus SE.  √Ä l'avenir, un article est pr√©vu avec des informations sur l'utilisation de Nucleus SE par les utilisateurs de Nucleus RTOS. <br><br><h3>  Identificateurs d'objet </h3><br>  Dans Nucleus RTOS, tous les objets sont d√©crits par des structures de donn√©es (unit√©s de contr√¥le) d'un type sp√©cifique.  Un pointeur vers ce bloc de contr√¥le est utilis√© comme identifiant pour le pool de partitions.  J'ai d√©cid√© que Nucleus SE n√©cessitait une approche diff√©rente pour une utilisation plus efficace de la m√©moire.  Tous les objets du noyau sont d√©crits par plusieurs tables en RAM et / ou ROM.  Les tailles de ces tables sont d√©termin√©es par le nombre de types configurables de tous les objets.  L'identifiant d'un objet particulier est l'index de ces tables.  Par cons√©quent, j'ai d√©termin√© que <b>NUSE_PARTITION_POOL √©tait</b> √©quivalent √† <b>U8</b> , apr√®s quoi une variable (pas un pointeur) de ce type sert d'identifiant de la t√¢che.  Cette l√©g√®re incompatibilit√© est facile √† d√©terminer si le code est port√© depuis ou vers Nucleus RTOS.  Les identifiants d'objets sont g√©n√©ralement stock√©s et transmis inchang√©s. <br><br>  Nucleus RTOS prend √©galement en charge la d√©nomination des pools de partitions.  Ces noms sont utilis√©s uniquement pour le d√©bogage.  Je les ai exclus de Nucleus SE pour √©conomiser de la m√©moire. <br><br><h3>  Nombre de sections et leur volume </h3><br>  Dans Nucleus RTOS, le pool de partitions est configur√© en fonction du volume total du pool et du volume des partitions (qui contiennent 2 pointeurs suppl√©mentaires).  Ces param√®tres sont d√©finis comme UNSIGNED (environ 32 bits).  Dans Nucleus SE, le pool de partitions est configur√© en fonction de la taille de la partition (pour laquelle un octet suppl√©mentaire a √©t√© ajout√©) et du nombre total de partitions.  Ces param√®tres sont d√©finis comme U16 et U8, respectivement. <br><br><h3>  Appels d'API non r√©alis√©s </h3><br>  Nucleus RTOS prend en charge 7 appels pour travailler avec des pools de partitions, dont 3 ne sont pas impl√©ment√©s dans Nucleus SE.  Plus de d√©tails sur ces d√©fis et les raisons de leur exclusion sont d√©crits ci-dessus. <br><br>  Le prochain article portera sur les signaux. <br><br>  <b>√Ä propos de l'auteur:</b> Colin Walls travaille dans l'industrie √©lectronique depuis plus de trente ans, consacrant la majeure partie de son temps au micrologiciel.  Il est maintenant ing√©nieur firmware chez Mentor Embedded (une division de Mentor Graphics).  Colin Walls intervient souvent lors de conf√©rences et s√©minaires, auteur de nombreux articles techniques et de deux livres sur le firmware.  Vit au Royaume-Uni.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Blog</a> professionnel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de Colin</a> , e-mail: colin_walls@mentor.com. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426477/">https://habr.com/ru/post/fr426477/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426465/index.html">¬´Nous changeons le terrain¬ª - L'informatique va sur un grand chantier</a></li>
<li><a href="../fr426469/index.html">Le t√©l√©gramme comme standard d'entreprise</a></li>
<li><a href="../fr426471/index.html">Comment les donn√©es des logiciels espions fuient</a></li>
<li><a href="../fr426473/index.html">Architecture Redux. Oui ou non?</a></li>
<li><a href="../fr426475/index.html">Miya - assistant depuis le smartphone</a></li>
<li><a href="../fr426479/index.html">Banc de test maison pour cartes m√®res</a></li>
<li><a href="../fr426481/index.html">Cartes hexagonales dans Unity: Path Finder, Player Squads, Animations</a></li>
<li><a href="../fr426483/index.html">Celui qui d√©passe Tesla. Pour plus rentable</a></li>
<li><a href="../fr426485/index.html">Troisi√®me test Qt 5 avec PVS-Studio</a></li>
<li><a href="../fr426487/index.html">Testez l'automatisation √† partir de z√©ro. Partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>