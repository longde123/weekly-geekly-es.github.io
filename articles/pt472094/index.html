<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêÇ üèΩ üèä Delegados e eventos em C # üëºüèª ‚ñ∂Ô∏è üîä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A tradu√ß√£o do artigo foi preparada especificamente para os alunos do curso "Desenvolvedor C #" . 



 O que s√£o eventos em c #? 
 Um evento pode ser u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Delegados e eventos em C #</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/472094/">  <i>A tradu√ß√£o do artigo foi preparada especificamente para os alunos do curso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Desenvolvedor C #"</a></i> . <br><br><img src="https://habrastorage.org/webt/ir/yd/rp/irydrp5fqzvuhxdmpcokybn5gj4.png"><br><hr><br><h3>  O que s√£o eventos em c #? </h3><br>  Um evento pode ser usado para fornecer notifica√ß√µes.  Voc√™ pode se inscrever no evento se precisar dessas notifica√ß√µes.  Voc√™ tamb√©m pode criar seus pr√≥prios eventos que o notificar√£o de que algo do seu interesse aconteceu.  O .NET Framework oferece tipos internos que voc√™ pode usar para criar eventos.  Usando delegados, express√µes lambda e m√©todos an√¥nimos, voc√™ pode criar e usar eventos de uma maneira conveniente. <br><a name="habracut"></a><br><h3>  No√ß√µes b√°sicas sobre delegados em C # </h3><br>  Em C #, os delegados formam os blocos de constru√ß√£o b√°sicos para eventos.  Um delegado √© um tipo que define a assinatura de um m√©todo.  Por exemplo, em C ++, isso pode ser feito usando um ponteiro de fun√ß√£o.  Em C #, voc√™ pode criar uma inst√¢ncia de um delegado que aponte para outro m√©todo.  Voc√™ pode chamar esse m√©todo atrav√©s da inst√¢ncia delegada. <br><br>  A seguir, √© apresentado um exemplo de declarar um delegado e chamar um m√©todo por meio dele. <br><br><h3>  Usando um delegado em C # </h3><br><pre><code class="cs hljs">}<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MathDelegate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value2</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value2</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value1 + value2; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Subtract</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value2</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value1 - value2; } Console.ReadLine(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { MathDelegate mathDelegate = Add; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = mathDelegate(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); Console.WriteLine(result); <span class="hljs-comment"><span class="hljs-comment">// : 7 mathDelegate = Subtract; result = mathDelegate(5, 2); Console.WriteLine(result); // : 3 }</span></span></code> </pre> <br>  Como voc√™ pode ver, usamos a palavra-chave delegate para informar ao compilador que estamos criando um tipo de delegado. <br><br>  √â f√°cil instanciar delegados junto com a cria√ß√£o autom√°tica de um novo tipo de delegado. <br><br>  Voc√™ tamb√©m pode usar a <i>nova</i> palavra-chave para criar um representante. <br><br>  <code>MathDelegate mathDelegate = new MathDelegate(Add)</code> ; <br><br>  Um delegado instanciado √© um objeto;  Voc√™ tamb√©m pode us√°-lo e passar como argumento para outros m√©todos. <br><br><h3>  Delegados de difus√£o seletiva em c # </h3><br>  Outra grande caracter√≠stica dos delegados √© que voc√™ pode combin√°-los.  Isso √© chamado de multicasting.  Voc√™ pode usar o operador + ou + = para adicionar outro m√©todo √† lista de chamadas de uma inst√¢ncia delegada existente.  Da mesma forma, voc√™ tamb√©m pode remover um m√©todo da lista de chamadas usando o operador de atribui√ß√£o de decremento (- ou - =).  Esse recurso serve como base para eventos em C #.  A seguir, √© apresentado um exemplo de um delegado multicast. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hello</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s</span></span></span><span class="hljs-function">)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">" Hello, {0}!"</span></span>, s); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Goodbye</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s</span></span></span><span class="hljs-function">)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">" Goodbye, {0}!"</span></span>, s); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Del</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Del a, b, c, d; <span class="hljs-comment"><span class="hljs-comment">//   a    Hello: a = Hello; //   b    Goodbye: b = Goodbye; //    a  b - c: c = a + b; //  a    c,   d,       Goodbye: d = c - a; Console.WriteLine("Invoking delegate a:"); a("A"); Console.WriteLine("Invoking delegate b:"); b("B"); Console.WriteLine("Invoking delegate c:"); c("C"); Console.WriteLine("Invoking delegate d:"); d("D"); /* : Invoking delegate a: Hello, A! Invoking delegate b: Goodbye, B! Invoking delegate c: Hello, C! Goodbye, C! Invoking delegate d: Goodbye, D! */ Console.ReadLine(); } }</span></span></code> </pre> <br>  Isso √© poss√≠vel porque os delegados herdam da classe <code>System.MulticastDelegate</code> , que por sua vez herda de <code>System.Delegate</code> .  Voc√™ pode usar os membros definidos nessas classes base para seus delegados. <br><br>  Por exemplo, para descobrir quantos m√©todos um representante de multicast chamar√°, voc√™ pode usar o seguinte c√≥digo: <br><br><pre> <code class="plaintext hljs">int invocationCount = d.GetInvocationList().GetLength(0);</code> </pre> <br><h3>  Covari√¢ncia e contravari√¢ncia em C # </h3><br>  Quando voc√™ atribui um m√©todo a um delegado, a assinatura do m√©todo n√£o precisa corresponder exatamente ao delegado.  Isso √© chamado de covari√¢ncia e contravari√¢ncia.  A covari√¢ncia permite que um m√©todo tenha um tipo de retorno mais derivado do que o definido no delegado.  A contravari√¢ncia permite um m√©todo com tipos de par√¢metros que s√£o menos derivados que tipos no delegado. <br><br><h4>  Delegar covari√¢ncia </h4><br>  Aqui est√° um exemplo de covari√¢ncia, <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> TextWriter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CovarianceDel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> StreamWriter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MethodStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> StringWriter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MethodString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { CovarianceDel del; del = MethodStream; del = MethodString; Console.ReadLine(); } }</code> </pre> <br>  Como o <code>StreamWriter</code> e o <code>StringWriter</code> herdam do <code>TextWriter</code> , voc√™ pode usar o <code>CovarianceDel</code> com os dois m√©todos. <br><br><h4>  Contravari√¢ncia em delegados </h4><br>  A seguir, √© apresentado um exemplo de contravari√¢ncia. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoSomething</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TextWriter textWriter</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContravarianceDel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">StreamWriter streamWriter</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ContravarianceDel del = DoSomething; Console.ReadLine(); } }</code> </pre> <br>  Como o m√©todo <code>DoSomething</code> pode funcionar com o <code>TextWriter</code> , certamente pode funcionar com o <code>StreamWriter</code> .  Devido √† contravari√¢ncia, voc√™ pode chamar um delegado e passar uma inst√¢ncia do <code>StreamWriter</code> para o m√©todo <code>DoSomething</code> . <br><br>  Voc√™ pode aprender mais sobre esse conceito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h3>  Express√µes lambda em c # </h3><br>  √Äs vezes, uma assinatura de m√©todo inteira pode exigir mais c√≥digo que o corpo do pr√≥prio m√©todo.  Tamb√©m h√° situa√ß√µes em que voc√™ precisa criar um m√©todo inteiro apenas para us√°-lo como um representante. <br><br>  Para esses casos, a Microsoft adicionou alguns novos recursos em C #, como m√©todos an√¥nimos na 2.0.  No C # 3.0, as coisas ficaram ainda melhores quando express√µes lambda foram adicionadas.  A express√£o lambda √© a maneira preferida ao escrever um novo c√≥digo. <br><br>  A seguir, √© apresentado um exemplo da sintaxe lambda mais recente. <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">class</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Program</span></span> { public delegate double MathDelegate(double value1, double value2); public static void Main() { MathDelegate mathDelegate = (x,y) =&gt; x + y; var result = mathDelegate(5, 2); Console.WriteLine(result); // : 7 mathDelegate = (x, y) =&gt; x - y; ; result = mathDelegate(5, 2); Console.WriteLine(result); // : 3 Console.ReadLine(); } }</code> </pre> <br>  Para ler este c√≥digo, voc√™ precisa usar a palavra ‚Äúsegue‚Äù no contexto da sintaxe lambda especial.  Por exemplo, a primeira express√£o lambda no exemplo acima diz "xey seguem a adi√ß√£o de xey". <br><br>  Uma fun√ß√£o lambda n√£o possui um nome espec√≠fico, diferente de um m√©todo.  Por esse motivo, as lambdas s√£o chamadas de fun√ß√µes an√¥nimas.  Voc√™ tamb√©m n√£o precisa especificar explicitamente o tipo do valor de retorno.  O compilador assume automaticamente a partir do seu lambda.  E no caso do exemplo acima, os tipos de par√¢metro x e y tamb√©m n√£o s√£o especificados explicitamente. <br><br>  Voc√™ pode criar lambdas que abrangem v√°rios operadores.  Voc√™ pode fazer isso adicionando chaves em volta das instru√ß√µes que comp√µem o lambda, conforme mostrado no exemplo abaixo. <br><br><pre> <code class="cs hljs">MathDelegate mathDelegate = (x,y) =&gt; { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Add"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y; };</code> </pre> <br>  √Äs vezes, um an√∫ncio de delegado para um evento parece um pouco complicado.  Por esse motivo, o .NET Framework possui v√°rios tipos de delegados internos que voc√™ pode usar ao declarar delegados.  No exemplo MathDelegate, voc√™ usou o seguinte delegado: <br><br><pre> <code class="plaintext hljs">public delegate double MathDelegate(double value1, double value2);</code> </pre> <br>  Voc√™ pode substituir esse representante por um dos tipos <code>Func &lt;int, int, int&gt;</code> , a saber <code>Func &lt;int, int, int&gt;</code> . <br><br>  assim <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mathDelegate = (x,y) =&gt; { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Add"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = mathDelegate(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); Console.WriteLine(result); <span class="hljs-comment"><span class="hljs-comment">// : 7 mathDelegate = (x, y) =&gt; x - y; ; result = mathDelegate(5, 2); Console.WriteLine(result); // : 3 Console.ReadLine(); } }</span></span></code> </pre> <br>  Os tipos de fun√ß√µes &lt;...&gt; podem ser encontrados no espa√ßo para nome do sistema.  Eles representam delegados que retornam um tipo e levam de 0 a 16 par√¢metros.  Todos esses tipos s√£o herdados de System.MulticaseDelegate, para que voc√™ possa adicionar v√°rios m√©todos √† lista de chamadas. <br><br>  Se voc√™ precisar de um tipo de delegado que n√£o retorne um valor, poder√° usar os tipos System.Action.  Eles tamb√©m podem assumir de 0 a 16 par√¢metros, mas n√£o retornam um valor. <br><br>  Aqui est√° um exemplo do uso do tipo Action, <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Action&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mathDelegate = (x,y) =&gt; { Console.WriteLine(x + y); }; mathDelegate(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">// : 7 mathDelegate = (x, y) =&gt; Console.WriteLine(x - y) ; mathDelegate(5, 2); // : 3 Console.ReadLine(); } }</span></span></code> </pre> <br>  Voc√™ pode aprender mais sobre os representantes internos do .NET <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  As coisas ficam complicadas quando sua fun√ß√£o lambda come√ßa a se referir a vari√°veis ‚Äã‚Äãdeclaradas fora da express√£o lambda ou a isso.  Normalmente, quando um controle deixa o escopo de uma vari√°vel, a vari√°vel se torna inv√°lida.  Mas e se o delegado se referir a uma vari√°vel local.  Para corrigir isso, o compilador gera c√≥digo que prolonga a vida √∫til da vari√°vel capturada, pelo menos enquanto o delegado durar mais tempo.  Isso √© chamado de encerramento. <br><br>  Voc√™ pode aprender mais sobre fechamentos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20150707082707/">aqui</a> . <br><br><h3>  Eventos em C # </h3><br>  Considere um padr√£o de desenvolvimento popular - publicador-assinante (pub / sub).  Voc√™ pode se inscrever em um evento e ser√° notificado quando o editor do evento iniciar um novo evento.  Este sistema √© usado para estabelecer uma comunica√ß√£o fraca entre componentes em um aplicativo. <br><br>  O delegado forma a base para o sistema de eventos em C #. <br><br>  Um evento √© um tipo especial de delegado que facilita a programa√ß√£o orientada a eventos.  Eventos s√£o membros de uma classe que n√£o pode ser chamada fora da classe, independentemente do especificador de acesso.  Portanto, por exemplo, um evento declarado como p√∫blico permitiria que outras classes usassem + = e - = para esse evento, mas o acionamento de um evento (ou seja, chamar um delegado) √© permitido apenas na classe que cont√©m o evento.  Vamos ver um exemplo, <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// -  Pub public class Pub { // OnChange    callback-  public event Action OnChange = delegate { }; public void Raise() { // OnChange OnChange(); } }</span></span></code> </pre> <br>  Em seguida, um m√©todo em outra classe pode se inscrever no evento adicionando um de seus m√©todos ao delegado do evento: <br><br>  A seguir, √© apresentado um exemplo que mostra como uma classe pode fornecer um representante aberto e gerar um evento. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   pub Pub p = new Pub(); //  Subscriber 1   OnChange p.OnChange += () =&gt; Console.WriteLine("Subscriber 1!"); //  Subscriber 2   OnChange p.OnChange += () =&gt; Console.WriteLine("Subscriber 2!"); //  p.Raise(); //   Raise()   callback-     Console.WriteLine("Press enter to terminate!"); Console.ReadLine(); } }</span></span></code> </pre> <br>  Mesmo se o evento for declarado como <code>public</code> , ele n√£o poder√° ser acionado diretamente em qualquer lugar, exceto na classe em que est√° localizado. <br><br>  Usando a palavra-chave <code>event</code> , o compilador protege nosso campo de acessos indesejados. <br><br>  E tamb√©m <br><br>  N√£o permite o uso de = (atribui√ß√£o direta de delega√ß√£o).  Portanto, seu c√≥digo agora est√° protegido contra o risco de excluir assinantes anteriores usando = em vez de + =. <br><br>  Al√©m disso, voc√™ pode observar a sintaxe especial de inicializa√ß√£o do campo OnChange para um representante vazio, como o <code>delegate { }</code> .  Isso garante que nosso campo OnChange nunca seja nulo.  Portanto, podemos remover a verifica√ß√£o nula antes de invocar o evento se n√£o houver outros membros da classe tornando-o nulo. <br><br>  Quando voc√™ executa o programa acima, seu c√≥digo cria uma nova inst√¢ncia do Pub, assina o evento de duas maneiras diferentes e gera um evento chamando p.Raise.  A classe Pub n√£o tem conhecimento de nenhum dos assinantes.  Apenas gera um evento. <br><br>  Voc√™ tamb√©m pode ler meu artigo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C # Publisher-Subscriber Design Pattern,</a> para uma compreens√£o mais profunda desse conceito. <br><br>  Bem, isso √© tudo por agora.  Espero que voc√™ entenda a id√©ia.  Obrigado por ler o post.  Entre em contato se houver algum erro ou altera√ß√£o nos coment√°rios abaixo.  Agradecemos antecipadamente! <br><br><h3>  Links √∫teis </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.c-sharpcorner.com/blogs/c-sharp-generic-delegates-func-action-and-predicate</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/covariance-contravariance</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20150707082707/">https://web.archive.org/web/20150707082707/http://diditwith.net/PermaLink,guid,235646ae-3476-4893-899d-105e4d48c25b.aspx</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt472094/">https://habr.com/ru/post/pt472094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt472078/index.html">Riscos Banc√°rios Abertos</a></li>
<li><a href="../pt472084/index.html">Vulnerabilidades em smartphones</a></li>
<li><a href="../pt472086/index.html">Usando as leis da psicologia da gestalt no design de interface do usu√°rio</a></li>
<li><a href="../pt472088/index.html">Como escolhemos o ServiceDesk. Parte 2</a></li>
<li><a href="../pt472092/index.html">Fun√ß√µes PHP inseguras</a></li>
<li><a href="../pt472096/index.html">O clicker Android inscreve usu√°rios em servi√ßos pagos</a></li>
<li><a href="../pt472100/index.html">Shchyry ucraniano Dunno ou Como Kiev n√£o adivinhou</a></li>
<li><a href="../pt472104/index.html">Habr Weekly # 23 / Voando no espa√ßo e na mente, a Microsoft enterra o Windows Phone, o legado da Matrix, os jogos de papel</a></li>
<li><a href="../pt472106/index.html">Fazendo o MacBook Pro 2018 T2 funcionar com o ArchLinux (dualboot)</a></li>
<li><a href="../pt472110/index.html">Passamos o desafio RegexPlay 100%</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>