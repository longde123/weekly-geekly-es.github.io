<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ü§Ø ‚óºÔ∏è Erste Schritte mit Google Sheets in Python. Von der Registrierung bis zum Lesen von Daten üíÉüèΩ üë©üèª‚Äçü§ù‚Äçüë®üèø üë®üèª‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich habe es eine ganze Weile geschafft, Daten nach Excel hochzuladen, aber der Mod √§ndert sich, Benutzer wollen ihn in den Clouds. 

 Nachdem ich ange...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erste Schritte mit Google Sheets in Python. Von der Registrierung bis zum Lesen von Daten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483302/">  Ich habe es eine ganze Weile geschafft, Daten nach Excel hochzuladen, aber der Mod √§ndert sich, Benutzer wollen ihn in den Clouds. <br><br>  Nachdem ich angefangen hatte, eine Reihe von Projekten in Python zu √ºbersetzen, entschied ich, dass es Zeit war, Excel durch etwas Moderneres zu ersetzen (oder zu erg√§nzen). <br><br>  Als ich zum ersten Mal auf die Notwendigkeit stie√ü, mit Google-Arbeitsbl√§ttern von Python aus zu arbeiten, hatte ich die Illusion, dass dies alles mit ein paar Klicks erledigt werden kann.  Die Realit√§t stellte sich als weniger rosig heraus, aber wir haben keinen anderen Globus. <br><br>  Die Artikel haben mir sehr geholfen: <br><br><ul><li>  <a href="https://habr.com/ru/post/305378">Wir generieren eine sch√∂ne Google-Tabelle aus unserem Programm (unter Verwendung der Google Sheets API v4).</a> </li><li>  <a href="http://italylov.ru/blog/all/probuem-rabotat-s-google-sheets-api/">Erste Schritte mit der Google Sheets API v4 /</a> </li><li>  <a href="http://datalytics.ru/all/rabotaem-s-api-google-drive-s-pomoschyu-python/">Arbeiten mit der Google Drive-API mit Python</a> </li></ul><br>  Wie √ºblich - wenn Sie sich zum ersten Mal mit etwas besch√§ftigen, werden Sie mit einer Vielzahl von Fragen konfrontiert, die sp√§ter nur Verwirrung stiften -, wie k√∂nnte man √ºberhaupt dar√ºber nachdenken?  Grundlegend! <br><br>  Vielleicht bin ich nur einen weiten Weg gegangen - ich freue mich, wenn Sie mich korrigieren. <br><br>  Alle Aktionen wurden auf einem Computer mit Windows + Python 3.6.6 ausgef√ºhrt, und es wurde auch ein Jupyter-Notizbuch verwendet. <br><br>  Die Hauptschwierigkeiten hatte ich bei den Voreinstellungen.  Einen brauchbaren Code zu finden ist nicht schwierig. <br><br>  Der im Artikel verwendete Code ist <a href="https://github.com/ovkgit/google_sheets_python">im Repository</a> verf√ºgbar <a href="https://github.com/ovkgit/google_sheets_python">.</a> <br><a name="habracut"></a><br><h2>  Melden Sie sich f√ºr Google-Dienste an und installieren Sie Bibliotheken </h2><br>  Um mit Tabellen arbeiten zu k√∂nnen, m√ºssen Sie sich bei Google registrieren, das Projekt einrichten und die erforderlichen Bibliotheken installieren. <br><br>  <a href="https://developers.google.com/sheets/">Die offizielle Dokumentation in englischer Sprache finden Sie hier</a> . <br><br>  Zuerst m√ºssen Sie sich auf gmail.com registrieren (Sie k√∂nnen es selbst tun).  Dann m√ºssen Sie ein Projekt erstellen (da Google Zugriff auf seine Dienste bietet). <br><br>  Dies ist ein langer und langwieriger Prozess, mit dem Sie nachvollziehen k√∂nnen, warum die Oberfl√§chen von Google nicht als die bequemsten und intuitivsten bezeichnet werden (einige glauben, dass das soziale Netzwerk Google+ aus diesem Grund nicht gestartet ist). <br><br>  <a href="https://console.developers.google.com/cloud-resource-manager">Rufen</a> Sie dazu <a href="https://console.developers.google.com/cloud-resource-manager">console.developers.google.com/cloud-resource-manager auf</a> und klicken Sie auf "Projekt erstellen". <br><br><img src="https://habrastorage.org/webt/fi/-w/y6/fi-wy693xsw54m-xh7jnh-17ble.jpeg"><br><br>  Geben Sie den Namen des Projekts ein und klicken Sie auf "Erstellen" <br><br><img src="https://habrastorage.org/webt/pq/li/wq/pqliwqiudct5g7s6q_rm6iag6tw.jpeg"><br><br>  In der aktualisierten Liste der Projekte gehen Sie zum Men√º "Berechtigungen" <br><img src="https://habrastorage.org/webt/3z/pr/yb/3zprybr3paa7eqi5sxsurdt_aq8.jpeg"><br><br>  Klicken Sie im folgenden Fenster auf "Hinzuf√ºgen", geben Sie Ihre E-Mail-Adresse aus der Domain "gmail.com" ein und w√§hlen Sie die Gruppe "Projekt" - "Eigent√ºmer" aus <br><br><img src="https://habrastorage.org/webt/fu/4a/cl/fu4aclu3gibqg8-1rae94sovf08.jpeg"><br><br>  Speichern Sie die √Ñnderungen. <br><br>  Es mag seltsam erscheinen, dass Sie ein Projekt erstellt haben, aber gezwungen sind, sich selbst Rechte zu erteilen.  Und das ist eigentlich seltsam, aber es war ein solcher Weg, der zum Zeitpunkt des Schreibens dieses Kurses eingeschlagen werden musste, damit alles so funktioniert, wie es sollte. <br><br>  <a href="https://console.developers.google.com/cloud-resource-manager">Rufen</a> Sie <a href="https://console.developers.google.com/cloud-resource-manager">console.developers.google.com/cloud-resource-manager</a> erneut auf <br><br>  W√§hlen Sie in Ihrem Projekt das Men√º Einstellungen <br><br><img src="https://habrastorage.org/webt/_p/dx/al/_pdxalr_zhciudnkssxnej4iybo.jpeg"><br><br>  W√§hlen Sie im folgenden Fenster "Dienstkonten" und dann "Dienstkonto erstellen". <br><br><img src="https://habrastorage.org/webt/8e/ss/t-/8esst-mi2_3ioiylkv5ej1itpxu.jpeg"><br><br>  Geben Sie den Namen des Kontos ein und klicken Sie auf "Erstellen". <br><br><img src="https://habrastorage.org/webt/4h/fe/18/4hfe18ts9ywn44bevocl3-fpsue.jpeg"><br><br>  W√§hlen Sie die Eigent√ºmerrolle aus und klicken Sie auf Weiter. <br><br><img src="https://habrastorage.org/webt/0x/d9/sx/0xd9sxloeigykugl41pdx_qgp64.jpeg"><br><br>  Klicken Sie im angezeigten Fenster auf Schl√ºssel erstellen <br><br><img src="https://habrastorage.org/webt/pv/jc/xk/pvjcxkvp6mjwda30w3uorjkbex4.jpeg"><br><br>  W√§hlen Sie den json-Schl√ºsseltyp und klicken Sie auf Erstellen <br><br><img src="https://habrastorage.org/webt/75/sz/3l/75sz3lffo7nr8119jrpu-vvm1i8.jpeg"><br><br>  Eine Datei mit Schl√ºsseln wird erstellt und sofort heruntergeladen.  Speichern Sie es, damit wir auf Google-Dienste zugreifen k√∂nnen. <br><br>  Klicken Sie auf die Schaltfl√§che mit drei horizontalen Strichen links neben der Aufschrift ‚ÄûGoogle APIs‚Äú, w√§hlen Sie ‚ÄûAPI and Services‚Äú und dort den Unterpunkt ‚ÄûControl Panel‚Äú. <br><br><img src="https://habrastorage.org/webt/n9/0c/gh/n90cgh2hyrqigsxjus02cwhrt-c.jpeg"><br><br>  Klicken Sie im folgenden Fenster auf "API und Dienste aktivieren". <br><br><img src="https://habrastorage.org/webt/w8/3f/wc/w83fwcm2h2zcq4qza3pysyjhseu.jpeg"><br><br>  Geben Sie "google drive" in die Suchleiste ein und klicken Sie auf den Dienst "Google Drive API" <br><br><img src="https://habrastorage.org/webt/fj/ks/iw/fjksiwvxazgd-6erfruqwrwq8os.jpeg"><br><br>  Klicken Sie auf Aktivieren <br><br><img src="https://habrastorage.org/webt/jk/f-/ys/jkf-ysfiu--oqojyf8vi1lwphao.jpeg"><br><br>  Die Site benachrichtigt Sie, dass die API aktiviert ist, und warnt Sie, dass Anmeldeinformationen erstellt werden m√ºssen.  Ignorieren Sie diese Warnung (wir haben bereits ein Dienstkonto erstellt). <br><br><img src="https://habrastorage.org/webt/se/e4/z4/see4z4tacpn3manmkn_tixgkgck.jpeg"><br><br>  Gehen Sie zur√ºck zur Systemsteuerung <br><br><img src="https://habrastorage.org/webt/c0/ak/ln/c0aklnjxew9zwlph6fgp1ym-yt8.jpeg"><br><br>  Klicken Sie im folgenden Fenster auf "API und Dienste aktivieren". <br><br><img src="https://habrastorage.org/webt/w8/3f/wc/w83fwcm2h2zcq4qza3pysyjhseu.jpeg"><br><br>  Geben Sie "sheet" in die Suchleiste ein und klicken Sie auf den Dienst "Google Sheets API" <br><br><img src="http://img/Task09_17.jpg"><br><br>  Stellen Sie sicher, dass diese API verbunden ist.  Es sollte sich automatisch einschalten, wenn Sie die Google Drive-API verbinden.  Wenn eine Verbindung besteht, wird die Schaltfl√§che "API verwalten" angezeigt, andernfalls die Schaltfl√§che "Aktivieren".  Schalten Sie es bei Bedarf ein. <br><br>  Besuchen <a href="https://console.developers.google.com/cloud-resource-manager">Sie zum</a> letzten Mal <a href="https://console.developers.google.com/cloud-resource-manager">console.developers.google.com/cloud-resource-manager</a> <br><br>  W√§hlen Sie in Ihrem Projekt das Men√º Einstellungen <br><br><img src="https://habrastorage.org/webt/ov/ue/i6/ovuei6xocepbhtqmgs8ydb9tbt4.jpeg"><br>  W√§hlen Sie im folgenden Fenster "Dienstkonten" aus und kopieren und speichern Sie die E-Mail-Adresse des Dienstkontos.  Es ist praktisch, wenn Sie Zugriff auf Tabellen gew√§hren. <br><br><img src="https://habrastorage.org/webt/qh/p5/yr/qhp5yrn74itkqnbwkvtstlcjwha.jpeg"><br><br>  Nun fahren wir mit der Installation der Bibliotheken fort.  F√ºhren Sie den Befehl in der Konsole aus <br><br><pre><code class="bash hljs">pip3 install --upgrade google-api-python-client</code> </pre> <br>  Und danach <br><br><pre> <code class="bash hljs">pip3 install oauth2client</code> </pre> <br>  Wenn Sie den zweiten Befehl ausf√ºhren, wird m√∂glicherweise eine Meldung angezeigt, dass die oauth2client-Bibliothek bereits installiert ist. <br><br>  Gehen Sie zu <a href="https://raw.githubusercontent.com/gsuitedevs/python-samples/master/sheets/quickstart/quickstart.py">raw.githubusercontent.com/gsuitedevs/python-samples/master/sheets/quickstart/quickstart.py</a> <br><br>  Dr√ºcken Sie die rechte Maustaste und w√§hlen Sie "Speichern unter" <br><br><img src="https://habrastorage.org/webt/t7/z5/mv/t7z5mvudm8lmipgvbcxsjn6jsr4.jpeg"><br><br>  Speichern Sie die Datei als quickstart.py <br><br>  und f√ºhren Sie es mit dem Befehl <br><br><pre> <code class="python hljs">python quickstart.py</code> </pre> <br>  Im Browser wird eine neue Seite ge√∂ffnet (m√∂glicherweise wird darauf hingewiesen, dass die Seite unsicher ist, Sie m√ºssen jedoch die Bedingungen akzeptieren). <br><br>  Damit ist unser Weg abgeschlossen. <br><br><h2>  Eine Tabelle f√ºllen und formatieren </h2><br>  Erstellen Sie die erste Tabelle <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   import httplib2 import apiclient.discovery from oauth2client.service_account import ServiceAccountCredentials CREDENTIALS_FILE = 'seraphic-effect-248407-7ac2c44ec709.json' #     ,     #     credentials = ServiceAccountCredentials.from_json_keyfile_name(CREDENTIALS_FILE, ['https://www.googleapis.com/auth/spreadsheets', 'https://www.googleapis.com/auth/drive']) httpAuth = credentials.authorize(httplib2.Http()) #    service = apiclient.discovery.build('sheets', 'v4', http = httpAuth) #      4  API spreadsheet = service.spreadsheets().create(body = { 'properties': {'title': '  ', 'locale': 'ru_RU'}, 'sheets': [{'properties': {'sheetType': 'GRID', 'sheetId': 0, 'title': '  ', 'gridProperties': {'rowCount': 100, 'columnCount': 15}}}] }).execute() spreadsheetId = spreadsheet['spreadsheetId'] #    print('https://docs.google.com/spreadsheets/d/' + spreadsheetId)</span></span></code> </pre><br>  Wenn alles ohne Fehler gelaufen ist, wird ein Link zur Tabelle angezeigt. <br><br>  Die Dateikennung wird in diesem Link verwendet, wir speichern sie in der variablen Tabellenkalkulations-ID und werden sie in Zukunft verwenden. <br><br>  Folge ihm.  Google teilt Ihnen mit, dass Sie keinen Zugriff haben <br><br><img src="https://habrastorage.org/webt/y0/n7/te/y0n7te-mweqjhzr_9eg0gqsj50q.jpeg"><br><br>  Bitte nicht um Erlaubnis!  Sie erhalten eine Benachrichtigung, dass es nicht m√∂glich ist, ein Anforderungsschreiben an die Adresse zu senden, die Google selbst dem Systemkonto zugewiesen hat.  Sie k√∂nnen diese Adresse jedoch nicht √§ndern.  Vielleicht funktioniert das nicht nur im freien Modus. <br><br>  Wir k√∂nnen uns jedoch √ºber Google Drive Zugang verschaffen.  Sie m√ºssen my_test_address@gmail.com durch Ihre eigene ersetzen. <br><br><pre> <code class="python hljs">driveService = apiclient.discovery.build(<span class="hljs-string"><span class="hljs-string">'drive'</span></span>, <span class="hljs-string"><span class="hljs-string">'v3'</span></span>, http = httpAuth) <span class="hljs-comment"><span class="hljs-comment">#    Google Drive  3  API access = driveService.permissions().create( fileId = spreadsheetId, body = {'type': 'user', 'role': 'writer', 'emailAddress': 'my_test_address@gmail.com'}, #     fields = 'id' ).execute()</span></span></code> </pre> <br>  Jetzt haben Sie Zugriff, schlie√üen Sie die Tabelle nicht, wir werden sie verwalten und die √Ñnderungen sofort √ºberpr√ºfen. <br><br>  Jedes Dokument hat seinen eigenen Code - spreadsheetId - genau das wird in der Adressleiste angezeigt, wenn wir die Tabelle im Browser √∂ffnen (in der URL der Seite mit der ge√∂ffneten Tabelle befindet sie sich zwischen "https://docs.google.com/spreadsheets/d/" und "/ edit # gid = 0"). <br><br>  Wir haben es in der variablen Tabellenkalkulations-ID gespeichert und werden weiterhin damit arbeiten. <br><br>  Zun√§chst eine kleine Theorie. <br><br>  In jeder Datei (Kalkulationstabelle) gibt es Blatt-Tabulatoren (Tabelle). <br><br>  Jedes Blatt hat einen eigenen numerischen Code (sheetId).  Das erste im Dokument erstellte Blatt hat eine ID von 0. Die √ºbrigen Bl√§tter haben eine sehr unterschiedliche ID ungleich Null (dh sie werden nicht fortlaufend nummeriert). <br><br>  Stellen Sie dies sicher <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ { "addSheet": { "properties": { "title": "  ", "gridProperties": { "rowCount": 20, "columnCount": 12 } } } } ] }).execute() #   ,  Id   spreadsheet = service.spreadsheets().get(spreadsheetId = spreadsheetId).execute() sheetList = spreadsheet.get('sheets') for sheet in sheetList: print(sheet['properties']['sheetId'], sheet['properties']['title']) sheetId = sheetList[0]['properties']['sheetId'] print('     Id = ', sheetId)</span></span></code> </pre><br>  So etwas wird auf dem Bildschirm angezeigt: <br><br><blockquote>  0 Blatt Nummer eins <br>  415832263 Ein weiteres Blatt <br>  Wir werden ein Blatt mit Id = 0 verwenden </blockquote><br><br>  Tats√§chlich hat das erste Blatt eine ID von Null und das zweite Blatt ist anders nummeriert. <br><br>  Noch eine Frage: Wie werden Zellbereiche angegeben?  Anscheinend wurden Google-Tabellen von verschiedenen Teams unter Anleitung verschiedener Manager und mit Hilfe verschiedener Architekten entwickelt.  Weil die Koordinaten der Zellen auf zwei verschiedene Arten festgelegt werden. <br><br>  Option 1: im Textformat "Blatt Nummer eins! B2: D5", d.h.  der Name des Blattes, gefolgt von einem Ausrufezeichen, nach - der oberen linken Zelle im Format "Buchstabe (Spalte) + Zahl (Zeichenfolge)" + der unteren rechten Zelle im gleichen Format. <br><br><pre> <code class="python hljs">{<span class="hljs-string"><span class="hljs-string">"range"</span></span>: <span class="hljs-string"><span class="hljs-string">"  !B2:D5"</span></span>}</code> </pre> <br>  Option 2: im JSON-Format, mit Angabe der Blatt-ID und der Koordinaten der oberen linken und unteren rechten Zelle in numerischer Form (Zeilennummer und Spaltennummer) <br><br><pre> <code class="python hljs">{<span class="hljs-string"><span class="hljs-string">"range"</span></span>: { <span class="hljs-string"><span class="hljs-string">"sheetId"</span></span>: sheetId, <span class="hljs-comment"><span class="hljs-comment"># ID  "startRowIndex": 1, #    startRowIndex "endRowIndex": 5,#  endRowIndex - 1 (endRowIndex  !) "startColumnIndex": 0, #    startColumnIndex "endColumnIndex": 1 #  endColumnIndex - 1 }}</span></span></code> </pre> <br>  Unterschiedliche Funktionen verwenden unterschiedliche Formate. <br><br>  Jetzt wissen wir genug, um die Zellen mit Daten zu f√ºllen, einen Rahmen zu zeichnen und die √úberschriften hervorzuheben. <br><br><pre> <code class="python hljs">results = service.spreadsheets().values().batchUpdate(spreadsheetId = spreadsheetId, body = { <span class="hljs-string"><span class="hljs-string">"valueInputOption"</span></span>: <span class="hljs-string"><span class="hljs-string">"USER_ENTERED"</span></span>, <span class="hljs-comment"><span class="hljs-comment">#  ,    (  ) "data": [ {"range": "  !B2:D5", "majorDimension": "ROWS", #   ,   "values": [ [" B2", " C2", " D2"], #    ['25', "=6*6", "=sin(3,14/2)"] #    ]} ] }).execute()</span></span></code> </pre> <br>  F√ºllen Sie mehrere Zellen mit Daten.  Weil  Wenn der Parameter USER_ENTERED angegeben ist, nimmt die Tabelle diese Daten als Benutzereingaben wahr - konvertiert numerische Werte in Zahlen und Werte, die mit dem Gleichheitszeichen beginnen, in Formeln. <br><br>  Schauen Sie sich Ihren Tisch an, er ist mit Daten gef√ºllt <br><br><img src="https://habrastorage.org/webt/ob/3h/h_/ob3hh_l6npzamjxabctqph8lrny.jpeg"><br><br>  Stellen Sie die Spaltenbreite ein.  Die batchUpdate-Funktion kann mehrere Befehle gleichzeitig akzeptieren. Daher wird die Breite von drei Spaltengruppen mit einer Anforderung festgelegt.  Es gibt eine Spalte in der ersten und dritten Gruppe und zwei in der zweiten. <br><br><pre> <code class="python hljs">results = service.spreadsheets().batchUpdate(spreadsheetId = spreadsheetId, body = { <span class="hljs-string"><span class="hljs-string">"requests"</span></span>: [ <span class="hljs-comment"><span class="hljs-comment">#    A: 20  { "updateDimensionProperties": { "range": { "sheetId": sheetId, "dimension": "COLUMNS", #    "startIndex": 0, #     "endIndex": 1 #    startIndex  endIndex - 1 (endIndex  !) }, "properties": { "pixelSize": 20 #    }, "fields": "pixelSize" # ,     pixelSize } }, #    B  C: 150  { "updateDimensionProperties": { "range": { "sheetId": sheetId, "dimension": "COLUMNS", "startIndex": 1, "endIndex": 3 }, "properties": { "pixelSize": 150 }, "fields": "pixelSize" } }, #    D: 200  { "updateDimensionProperties": { "range": { "sheetId": sheetId, "dimension": "COLUMNS", "startIndex": 3, "endIndex": 4 }, "properties": { "pixelSize": 200 }, "fields": "pixelSize" } } ] }).execute()</span></span></code> </pre> <br>  Schauen Sie sich die Tabelle an, die Spaltenbreiten haben sich ge√§ndert. <br><br><img src="https://habrastorage.org/webt/wu/zv/h4/wuzvh4jz9uloyxlkhfnxqk7otke.jpeg"><br><br>  Zeichnen Sie einen Rahmen um den Tisch <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ {'updateBorders': {'range': {'sheetId': sheetId, 'startRowIndex': 1, 'endRowIndex': 3, 'startColumnIndex': 1, 'endColumnIndex': 4}, 'bottom': { #      'style': 'SOLID', #   'width': 1, #  1  'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, #   'top': { #      'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'left': { #      'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'right': { #      'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'innerHorizontal': { #       'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'innerVertical': { #       'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}} }} ] }).execute()</span></span></code> </pre><br><img src="https://habrastorage.org/webt/7v/8l/db/7v8ldbkjnukd2j6lukhezmaupje.jpeg"><br><br>  Kombinieren Sie die Zellen √ºber der Tabelle und geben Sie den Titel ein. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   A2:D1 results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ {'mergeCells': {'range': {'sheetId': sheetId, 'startRowIndex': 0, 'endRowIndex': 1, 'startColumnIndex': 1, 'endColumnIndex': 4}, 'mergeType': 'MERGE_ALL'}} ] }).execute() #    results = service.spreadsheets().values().batchUpdate(spreadsheetId = spreadsheetId, body = { "valueInputOption": "USER_ENTERED", #  ,    (  ) "data": [ {"range": "  !B1", "majorDimension": "ROWS", #   ,   "values": [[" " ] ]} ] }).execute()</span></span></code> </pre><br><img src="https://habrastorage.org/webt/ba/pi/tq/bapitq07wcnkdodrbmodxssvvl8.jpeg"><br><br>  Legen Sie das Format f√ºr Tabellenkopfzellen fest <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ { "repeatCell": { "cell": { "userEnteredFormat": { "horizontalAlignment": 'CENTER', "backgroundColor": { "red": 0.8, "green": 0.8, "blue": 0.8, "alpha": 1 }, "textFormat": { "bold": True, "fontSize": 14 } } }, "range": { "sheetId": sheetId, "startRowIndex": 1, "endRowIndex": 2, "startColumnIndex": 1, "endColumnIndex": 4 }, "fields": "userEnteredFormat" } } ] }).execute()</span></span></code> </pre><br><img src="https://habrastorage.org/webt/an/mx/ix/anmxixf0r8g3tgobvulohsg3w5i.jpeg"><br><br>  Auf einfache Weise k√∂nnen Sie herausfinden, welche Breite oder Farbe Sie f√ºr eine Zelle festlegen m√ºssen.  Dazu reicht es aus, eine der Zellen manuell zu formatieren und ihre Eigenschaften zu lesen. <br><br><pre> <code class="python hljs">ranges = [<span class="hljs-string"><span class="hljs-string">"  !C2:C2"</span></span>] <span class="hljs-comment"><span class="hljs-comment"># results = service.spreadsheets().get(spreadsheetId = spreadsheetId, ranges = ranges, includeGridData = True).execute() print(' ') print(results['properties']) print('\n  ') print(results['sheets'][0]['data'][0]['rowData'] ) print('\n ') print(results['sheets'][0]['data'][0]['rowMetadata']) print('\n ') print(results['sheets'][0]['data'][0]['columnMetadata'])</span></span></code> </pre><br>  Wir bekommen eine Antwort <br><blockquote>  Stammdaten <br>  {'title': 'Erstes Testdokument', 'locale': 'ru_RU', 'autoRecalc': 'ON_CHANGE', 'timeZone': 'Etc / GMT', 'defaultFormat': {'backgroundColor': {'red' : 1, 'gr√ºn': ‚Äã‚Äã1, 'blau': 1}, 'Polsterung': {'oben': 2, 'rechts': 3, 'unten': 2, 'links': 3}, 'vertikale Ausrichtung': 'BOTTOM', 'wrapStrategy': 'OVERFLOW_CELL', 'textFormat': {'foregroundColor': {}, 'fontFamily': 'arial, sans, sans-serif', 'fontSize': 10, 'bold': False, 'kursiv': Falsch, 'durchgestrichen': Falsch, 'unterstrichen': Falsch}}} <br><br>  Werte und Farbgebung <br>  [{'values': [{'userEnteredValue': {'stringValue': 'Cell C2'}, 'effectiveValue': {'stringValue': 'Cell C2'}, 'formatedValue': 'Cell C2', 'userEnteredFormat' : {'backgroundColor': {'red': 1, 'green': 0.6}, 'horizontalAlignment': 'CENTER', 'textFormat': {'fontSize': 14, 'fett': True, 'kursiv': True }}, 'effectiveFormat': {'backgroundColor': {'red': 1, 'green': 0.6}, 'padding': {'top': 2, 'right': 3, 'bottom': 2, ' left ': 3},' horizontalAlignment ':' CENTER ',' verticalAlignment ':' BOTTOM ',' wrapStrategy ':' OVERFLOW_CELL ',' textFormat ': {' foregroundColor ': {},' fontFamily ':' Arial ', 'fontSize': 14, 'fett': True, 'kursiv': True, 'durchgestrichen': False, 'unterstrichen': False}, 'hyperlinkDisplayType': 'PLAIN_TEXT'}}}]] <br><br>  Zellenh√∂he <br>  [{'pixelSize': 21}] <br><br>  Zellenbreite <br>  [{'pixelSize': 150}] <br></blockquote>  Dieser Code zeigt die Eigenschaften der Zelle C2 an.  Sie k√∂nnen die Schriftart und die F√ºllfarbe manuell ausw√§hlen (in der Tabelle) und dann sehen, wie sie in json widergespiegelt werden. <br><br><h2>  Daten aus einer Tabelle lesen </h2><br>  Um die Merkmale des Datenlesens vollst√§ndig aufzuzeigen, habe ich die Zellen B4, C7 und D5 wie in der Abbildung gezeigt manuell ausgef√ºllt. <br><br><img src="https://habrastorage.org/webt/ms/yc/ph/msycphwvaxu8x49rvc2vq6zwdfo.jpeg"><br><br>  Code zum Lesen von Daten <br><br><pre> <code class="python hljs">ranges = [<span class="hljs-string"><span class="hljs-string">"  !A2:F8"</span></span>] <span class="hljs-comment"><span class="hljs-comment"># results = service.spreadsheets().values().batchGet(spreadsheetId = spreadsheetId, ranges = ranges, valueRenderOption = 'FORMATTED_VALUE', dateTimeRenderOption = 'FORMATTED_STRING').execute() sheet_values = results['valueRanges'][0]['values'] print(sheet_values)</span></span></code> </pre> <br>  Ergebnis <br><blockquote>  [['', 'Zelle B2', 'Zelle C2', 'Zelle D2'], ['', '25', '36', '0,9999996829']] </blockquote><br>  Einige Parameter der Funktion: <i>valueRenderOption</i> - Format zum Lesen numerischer Daten. <br><br><ul><li>  <b>FORMATTED_VALUE</b> - Lesen basierend auf dem Anzeigeformat.  Das hei√üt  Was in der Tabelle sichtbar war, wird gelesen.  In Zelle D3 lautet die Zahl beispielsweise 0,9999999, das Format ist jedoch "zwei Dezimalstellen", sodass "1,00" angezeigt wird und in diesem Format gelesen wird. </li><li>  <b>UNFORMATTED_VALUE</b> - der Inhalt der Zelle wird gelesen, die Formatierung wird nicht ber√ºcksichtigt (d. H. 0,9999999 w√ºrde gelesen) </li><li>  <b>FORMEL</b> - Die Formel wird angezeigt (in diesem Fall "= sin (3,14 / 2)". Wenn eine Zahl in die Zelle eingegeben wird, wird sie in diesem Modus gelesen. </li></ul><br>  Dieser Code liest die Daten und zeigt sie zeilenweise an.  Lesebereich A2: F8. <br>  Wie auf dem Bildschirm zu sehen: <br><br><ul><li>  Wenn keine Zelle in der zu lesenden Zeile gef√ºllt ist, werden die Daten in der Zeile nicht angezeigt. </li><li>  Daten nach der letzten gef√ºllten Zelle werden nicht angezeigt. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de483302/">https://habr.com/ru/post/de483302/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de483280/index.html">ESP32- und SPIFFS-Dateisystem</a></li>
<li><a href="../de483284/index.html">Wie ich den Zeitplan analysiert habe</a></li>
<li><a href="../de483290/index.html">Design Thinking im Projektmanagement oder warum braucht ein Projektmanager kreative Techniken?</a></li>
<li><a href="../de483294/index.html">Wir schreiben einen "Taschenrechner". Teil II Gleichungen l√∂sen, in LaTeX rendern, Funktionen auf Superlight beschleunigen</a></li>
<li><a href="../de483298/index.html">Wie man richtig aufh√∂rt, damit sp√§ter ...</a></li>
<li><a href="../de483308/index.html">VonmoTrade-Experiment. Teil 4: Trading Charts</a></li>
<li><a href="../de483310/index.html">Erstellen Sie mit pix2pix Linsen f√ºr Snapchat</a></li>
<li><a href="../de483312/index.html">Die gro√üe Schneeflockentheorie</a></li>
<li><a href="../de483314/index.html">So f√ºhren Sie asynchrone Redux-Aktionen mit Redux-Thunk durch</a></li>
<li><a href="../de483316/index.html">Schnelle Einf√ºhrung in SwiftUI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>