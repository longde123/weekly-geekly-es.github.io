<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òùüèæ ‚úã ü•Ñ Comment nous avons √©limin√© les joueurs ordinaires et pour les DDoS ou nos serveurs: un guide pratique ‚úåüèø üè≥Ô∏è‚Äçüåà ‚ñ´Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parler de nouveaux projets est bien s√ªr bien, mais tout ne se passe pas toujours comme nous le souhaitons. 

 En g√©n√©ral, ils ont commenc√© √† se souven...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons √©limin√© les joueurs ordinaires et pour les DDoS ou nos serveurs: un guide pratique</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/417441/">  Parler de nouveaux projets est bien s√ªr bien, mais tout ne se passe pas toujours comme nous le souhaitons. <br><br>  En g√©n√©ral, ils ont commenc√© √† se souvenir du fakap du pass√©, lorsque la solution √† un probl√®me en a ajout√© de nouveaux, s'est emport√©e et a d√©cid√© de partager un couple.  Comment interdire des joueurs innocents, tuer leurs propres serveurs, faire une erreur dans une lettre et capter des tonnes de commentaires n√©gatifs des utilisateurs - c'est tout ce que nous aimons. <br><br><img src="https://habrastorage.org/webt/ug/ah/u-/ugahu-bcho92pvjvqfqy46h26fa.jpeg"><br><a name="habracut"></a><br><h2>  Perdu - obtenez une interdiction </h2><br>  Il fut un temps o√π notre jeu War Robots en raison de d√©fauts d'architecture √©tait attaqu√© par des tricheurs.  Il y avait des utilit√©s qui augmentaient l'offre de sant√© aux valeurs cosmiques, ce qui les rendait pratiquement immortelles.  En cons√©quence, nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cl√¥tur√© la</a> t√¢che avec des tricheurs, mais pas imm√©diatement. <br><br>  Au d√©but, nous voulions r√©soudre le probl√®me magnifiquement au niveau technique: bloquer la possibilit√© de modifier les param√®tres du robot sur le client.  Nous n'avons pas r√©ussi √† le faire (alors, bien s√ªr, nous avons trouv√© un moyen).  Et puis la premi√®re solution de travail a √©t√© un marteau-piqueur qui a calcul√© les tricheurs selon un sch√©ma simple: <br><br><ol><li>  Chaque robot apr√®s le match a √©t√© test√© pour les dommages. </li><li>  Si les d√©g√¢ts subis par le robot d√©passaient la valeur de sa sant√© maximale, alors le joueur √©tait reconnu comme un tricheur et son compte √©tait bloqu√©. </li></ol><br>  La solution √©tait une b√©quille, mais efficace.  Les probl√®mes √† cause de lui ont commenc√© un peu plus tard, mais vous devrez d'abord parler un peu d'un autre bug et des caract√©ristiques du d√©veloppement du PvP mobile synchrone. <br><br>  Lorsque les joueurs ont une connexion Internet tr√®s coquine (ce qui est normal dans les jeux mobiles), des choses absolument magiques peuvent se produire lors de l'√©change de donn√©es entre le client et les serveurs.  Les demandes des clients sont incompl√®tes, hors service ou avec un fort retard.  En g√©n√©ral, un bogue de serveur permettait que si la connexion √©tait mauvaise, le client pouvait envoyer les r√©sultats de la bataille deux ou m√™me trois fois de suite.  En cons√©quence, les joueurs pourraient recevoir 2 √† 3 fois plus de r√©compenses ou d√©penser accidentellement deux fois plus de ressources en r√©parations. <br><br>  Nous avons r√©solu ce probl√®me assez rapidement: le profil du serveur a appris √† ignorer les r√©sultats de bataille inutiles d'un client.  Apr√®s des tests r√©ussis, nous avons publi√© une nouvelle version. <br><br>  C'est ici que nous a couverts. <br><br>  Chaque jour, j'ai commenc√© √† interdire tout un groupe de joueurs avec un marteau-piqueur, dont nous avons oubli√© en toute s√©curit√©, car  le probl√®me des robots indestructibles avec une r√©serve infinie de sant√© √©tait une chose du pass√©.  Il s'est av√©r√© que d√®s que le client du joueur a envoy√© les r√©sultats d'une bataille en double quantit√© au serveur, le marteau-piqueur l'a per√ßu de telle mani√®re que chaque robot mort a √©t√© tu√© deux fois - c'est-√†-dire  a subi des d√©g√¢ts deux fois sa sant√©.  Et apr√®s chaque bataille, les joueurs ont vol√© dans l'interdiction par lots. <br><br>  Tout le monde, bien s√ªr, √©tait indisciplin√© et a m√™me pay√© une compensation, mais la situation est telle, pas positive √† coup s√ªr. <br><br><img src="https://habrastorage.org/webt/rg/le/pc/rglepcj33omwpzwitdrmijjewkk.gif"><br><br>
<h2>  Comment configurer vous-m√™me les DDoS </h2><br>  Nous avons d√©j√† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©crit</a> sur l'√©volution de notre infrastructure de serveurs, et maintenant nous nous souvenons d'un cas de cette √©poque. <br><br>  Fin 2015, la sortie de la fonctionnalit√© tant attendue dans War Robots - clans.  Lorsque la mise √† jour est sortie (et il √©tait tard dans la soir√©e), nous avons ouvert le champagne et tout irait bien.  Mais je n'ai pas eu √† me r√©jouir longtemps - les serveurs se sont soudainement sentis mal.  Il s'est av√©r√© que nous avons fait une attaque DDoS de nos propres mains. <br><br>  Comment?  Tr√®s simple.  Le client sur l'√©cran des r√©sultats de la bataille, dans le but d'obtenir des informations sur les clans des joueurs, a fait trop de demandes.  Et lorsque le serveur a r√©pondu ¬´laissez-moi tranquille, erreur¬ª, le client est revenu sur le serveur sans aucun d√©lai. <br><br>  Cette m√™me nuit, nous avons lav√© le drapeau (nous n'avons pas encore eu le temps de fermer le champagne), qui √©tait contr√¥l√© depuis le serveur de profil - il a compl√®tement bloqu√© le fonctionnement de l'API Hangar Client.  Pour les joueurs qui ont d√©j√† rejoint les clans, nous avons laiss√© ce drapeau allum√©, c'est-√†-dire que tout a fonctionn√© pour eux, car leur nombre n'√©tait pas suffisant pour DDoS le serveur. <br><br>  En cons√©quence, nous avons commenc√© √† traiter correctement les r√©ponses du serveur dans le jeu, et en cas d'erreur, augmentez le d√©lai d'expiration pour r√©essayer la demande. <br><br><h2>  √âvaluation "gratuite" </h2><br>  Une autre histoire est celle o√π une mise en ≈ìuvre de mauvaise qualit√© rencontre le facteur humain.  Seulement maintenant, ils n'ont interdit personne, mais au contraire, ils ont remis la note √† gauche et √† droite.  Bref, une nuit, notre surveillance (et nous surveillons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tout</a> ) a enregistr√© une croissance trop rapide des notes des joueurs. <br><br>  Il s'est ensuite av√©r√© que la mise en ≈ìuvre m√™me du scoring permettait en th√©orie de dupliquer les donn√©es.  Mais personne n'y aurait pr√™t√© attention si l'administrateur en service, √† cause d'une faute de frappe dans une lettre, avait accidentellement red√©marr√© un serveur qui n'√©tait pas cens√© fonctionner.  C'est lui qui a commenc√© √† doubler les cotes des joueurs. <br><br>  J'ai d√ª lib√©rer de toute urgence un correctif et passer par la base pour supprimer tous les points suppl√©mentaires qui avaient le temps de s'accumuler.  Pour √©viter que cela ne se produise - sur tous les serveurs, nous avons supprim√© l'ancien sch√©ma de calcul des points et exclu la possibilit√© de lancement erron√© de services l√† o√π ils ne devraient pas fonctionner.  Il √©tait n√©cessaire de le faire d√®s le d√©but, bien s√ªr, mais ce serait trop ennuyeux. <br><br><h2>  Prix ‚Äã‚Äãinestimable </h2><br>  Il y avait un autre fakap avec une faute de frappe, mais beaucoup plus grave. <br><br>  En quelque sorte √† l'Halloween, nous avons lanc√© un nouveau gacha - une loterie.  Si quelqu'un ne le sait pas, un gacha est la m√©canique pour obtenir un objet de plusieurs diff√©rents au hasard.  √Ä la loterie, le joueur disposait d'un ensemble limit√© de prix visibles de diff√©rentes valeurs.  Pour chaque ouverture, le joueur a re√ßu 1 prix, ce prix a √©t√© retir√© de l'ensemble et le prix d'ouverture a augment√© √† chaque fois.  Ainsi, le joueur pouvait √† coup s√ªr acheter tous les prix de la loterie, et les plus chanceux ont remport√© les prix les plus pr√©cieux lors des premi√®res ouvertures (et, par cons√©quent, les ont re√ßus √† tr√®s bon march√©). <br><br>  En g√©n√©ral, puis avec du sang, nous avons lav√© un √©l√©ment de l'√©v√©nement, l'avons test√©, expos√©.  On commence, on met √† jour les plannings ... Hourra!  Ils se sont pr√©cipit√©s! .. Et en m√™me temps, des tonnes de n√©gativit√© dans la communaut√© nous tombent dessus que nous pr√©tendons tromper nos joueurs. <br><br>  En moins d'une demi-heure, la loterie a d√ª √™tre d√©sactiv√©e.  Oui, nous avons vraiment tromp√© les joueurs.  Mais ce n'√©tait pas une question de chance ou de prix - c'√©tait dans une lettre. <br><br>  L'interface de loterie indique le co√ªt de l'ouverture actuelle (celle qui augmente √† chaque fois), par exemple, PRIX: 100 pi√®ces d'or.  Voici √† quoi ressemblait le concept (notez que selon l'id√©e, chaque carte a √©galement un prix d'ouverture suppl√©mentaire): <br><br><img src="https://habrastorage.org/webt/ns/a6/xv/nsa6xvnjqudlstg_m2veg5-ohxm.jpeg"><br><br>  Et voici comment cela s'est termin√© lorsque, √† la suite d'une s√©rie d '¬´am√©liorations¬ª, le PRIX (prix pour la participation √† la loterie) s'est soudainement transform√© en PRIX (prix) pour le cr√©ateur: <br><br><img src="https://habrastorage.org/webt/1u/s9/lh/1us9lhgsdyfunbhmvsfdfpji_d8.jpeg"><br><br>  Dans le m√™me temps, en raison de la confusion avant la sortie et du mauvais contr√¥le de chaque carte individuelle, le prix d'ouverture a √©t√© perdu, ce qui a confondu tous les joueurs. <br><br>  Et ils ont appuy√© par r√©flexe sur le bouton jusqu'√† ce qu'ils d√©pensent toute la duret√©.  Eh bien, quoi, le "prix" augmente √† chaque achat.  Et il en √©tait ainsi en 18 langues.  Dans le m√™me temps, nous avions √©galement des ¬´locales¬ª sur le client, il √©tait donc possible de corriger une seule lettre uniquement via un correctif. <br><br>  En cons√©quence, ils ont d√©voil√© la situation, introduit des points de contr√¥le suppl√©mentaires, rendu l'or aux joueurs et enregistr√© les param√®tres r√©gionaux sur le serveur afin que rien de tel ne se reproduise. <br><br>  Il est temps de pr√©senter le hashtag <i># Kosyakinaprode</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417441/">https://habr.com/ru/post/fr417441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417429/index.html">Nous avons mis en place un projet npm pratique pour nous-m√™mes et pour l'√©quipe ou un peu sur les outils frontaux modernes</a></li>
<li><a href="../fr417431/index.html">Anti-entretien</a></li>
<li><a href="../fr417435/index.html">Une faute de frappe a √©t√© trouv√©e dans la configuration Aliens: Colonial Marines, √† cause de laquelle le jeu AI √©tait bugg√© pendant quatre ans</a></li>
<li><a href="../fr417437/index.html">Projecteur vs √©cran plat. Nous essayons une robe d'ophtalmologiste et d√©couvrons pourquoi la taille est importante</a></li>
<li><a href="../fr417439/index.html">Intel Core i7-8086K (partie 1)</a></li>
<li><a href="../fr417443/index.html">Les mati√®res organiques sur Mars pourraient √™tre d√©couvertes il y a 40 ans si une m√©thode d'analyse diff√©rente √©tait utilis√©e</a></li>
<li><a href="../fr417445/index.html">Optimisation du rendu d'une sc√®ne du dessin anim√© Disney "Moana". 2e partie</a></li>
<li><a href="../fr417447/index.html">Exp√©dition dans les myst√©rieux cercles de f√©es du d√©sert du Namib</a></li>
<li><a href="../fr417449/index.html">Jurassic World: pouvons-nous vraiment ressusciter des dinosaures?</a></li>
<li><a href="../fr417451/index.html">Cinq erreurs courantes pour les d√©butants</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>