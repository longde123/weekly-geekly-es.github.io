<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëáüèº üë©üèΩ‚Äçüíº üè¢ Uma hist√≥ria de lan√ßamento que afetou tudo ‚úäüèæ üë≤üèº üï°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inimigos da realidade por 12f-2 

 No final de abril, enquanto os caminhantes brancos sitiavam Winterfell, algo mais interessante aconteceu para n√≥s, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Uma hist√≥ria de lan√ßamento que afetou tudo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/453364/"><img src="https://habrastorage.org/webt/kc/5y/q_/kc5yq_bh4rgol9q8lebwmzsldca.jpeg"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inimigos da realidade</a> por 12f-2</i> <br><br>  No final de abril, enquanto os caminhantes brancos sitiavam Winterfell, algo mais interessante aconteceu para n√≥s, fizemos um lan√ßamento incomum.  Em princ√≠pio, lan√ßamos constantemente novos recursos no prod (como todos os outros).  Mas este n√£o era como todos os outros.  Sua escala era tal que quaisquer poss√≠veis erros que pud√©ssemos cometer afetariam todos os nossos servi√ßos e usu√°rios.  Como resultado, lan√ßamos tudo de acordo com o plano, no tempo de inatividade planejado e anunciado, sem consequ√™ncias para a venda.  O artigo √© sobre como conseguimos isso e como aqueles que desejam podem repetir isso em casa. <br><a name="habracut"></a><br>  Agora n√£o vou descrever nossas decis√µes arquitet√¥nicas e t√©cnicas, contar como tudo funciona.  Essas s√£o notas marginais mais prov√°veis ‚Äã‚Äãde como ocorreu um dos lan√ßamentos mais dif√≠ceis, que observei e em que participei diretamente.  N√£o pretendo ser detalhes completos ou t√©cnicos, talvez eles apare√ßam em outro artigo. <br><br><h2>  Hist√≥rico + que tipo de funcionalidade √© essa </h2><br>  Estamos construindo a plataforma de nuvem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mail.ru Cloud Solutions</a> (MCS), onde trabalho como CTO.  E agora - √© hora de conectar-se √† nossa plataforma IAM (Identity and Access Management), que fornece gerenciamento unificado de todas as contas de usu√°rios, usu√°rios, senhas, fun√ß√µes, servi√ßos e muito mais.  Por que √© necess√°rio na nuvem √© uma pergunta √≥bvia: todas as informa√ß√µes do usu√°rio s√£o armazenadas nela. <br><br>  Normalmente, essas coisas come√ßam a ser constru√≠das no in√≠cio de qualquer projeto.  Mas o MCS tem sido historicamente um pouco diferente.  O MCS foi constru√≠do em duas partes: <br><br><ul><li>  Openstack com seu pr√≥prio m√≥dulo de autoriza√ß√£o Keystone, </li><li>  Hotbox (armazenamento S3) com base no projeto Cloud Mail.ru, </li></ul><br>  em torno do qual novos servi√ßos apareceram. <br><br>  Em ess√™ncia, esses eram dois tipos diferentes de autoriza√ß√£o.  Al√©m disso, usamos alguns desenvolvimentos separados do Mail.ru, por exemplo, o armazenamento geral de senhas do Mail.ru, al√©m de um conector openid auto-escrito, que habilitou o SSO (autoriza√ß√£o de passagem) no painel Horizon de m√°quinas virtuais (UI nativa OpenStack). <br><br>  Fazer o IAM significava combinar tudo isso em um √∫nico sistema, completamente nosso.  Ao mesmo tempo, n√£o perca nenhuma funcionalidade ao longo do caminho, crie uma reserva para o futuro, o que nos permitir√° modific√°-la de forma transparente sem refatorar e escal√°-la em termos de funcionalidade.  Tamb√©m no in√≠cio, os usu√°rios apareciam como um modelo de acesso a servi√ßos (RBAC central, controle de acesso baseado em fun√ß√µes) e algumas outras pequenas coisas. <br><br>  A tarefa acabou n√£o sendo trivial: python e perl, v√°rios backends, servi√ßos escritos independentemente, v√°rias equipes de desenvolvimento e administradores.  E o mais importante, milhares de usu√°rios ativos no sistema de produ√ß√£o de combate.  Tudo isso tinha que ser escrito e, o mais importante, lan√ßado sem v√≠timas. <br><br><h2>  O que vamos lan√ßar </h2><br>  Se for muito rude, em algum momento em quatro meses, preparamos o seguinte: <br><br><ul><li>  Eles criaram v√°rios novos dem√¥nios que agregavam fun√ß√µes que anteriormente funcionavam em diferentes partes da infraestrutura.  Outros servi√ßos receberam um novo back-end na forma desses dem√¥nios. </li><li>  Criamos nosso pr√≥prio reposit√≥rio central de senhas e chaves, dispon√≠vel para todos os nossos servi√ßos, que podem ser modificados livremente conforme necess√°rio. </li><li>  Do zero, eles escreveram quatro novos back-ends para o Keystone (usu√°rios, projetos, fun√ß√µes, atribui√ß√µes de fun√ß√µes), que, de fato, substitu√≠ram sua base e agora atuam como um reposit√≥rio √∫nico de nossas senhas de usu√°rios. </li><li>  Ensinamos todos os nossos servi√ßos Openstack a buscar suas pol√≠ticas em um servi√ßo de pol√≠tica de terceiros em vez de ler essas pol√≠ticas localmente em cada servidor (sim, por padr√£o, o Openstack funciona assim!) </li></ul><br>  Uma altera√ß√£o t√£o grande requer altera√ß√µes grandes, complexas e, o mais importante, s√≠ncronas em v√°rios sistemas escritos por diferentes equipes de desenvolvimento.  Ap√≥s a montagem, todo o sistema deve funcionar. <br><br>  Como lan√ßar essas altera√ß√µes e n√£o estragar tudo?  Primeiro, decidimos olhar um pouco para o futuro. <br><br><h2>  Estrat√©gia de implanta√ß√£o </h2><br><ul><li>  Seria poss√≠vel lan√ßar em v√°rias etapas, mas isso aumentaria o tempo de desenvolvimento em tr√™s vezes.  Al√©m disso, por algum tempo, ter√≠amos uma dessincroniza√ß√£o completa de dados nos bancos de dados.  Eu precisaria escrever minhas pr√≥prias ferramentas de sincroniza√ß√£o e viver com v√°rios data warehouses por um longo tempo.  E isso cria uma grande variedade de riscos. </li><li>  Tudo o que eles poderiam preparar de forma transparente para o usu√°rio foi feito com anteced√™ncia.  Demorou 2 meses. </li><li>  Permitimos um tempo de inatividade por v√°rias horas - apenas para opera√ß√µes do usu√°rio para criar e modificar recursos. </li><li>  Para o trabalho de todos os recursos j√° criados, o tempo de inatividade era inaceit√°vel.  Planejamos que, ao implantar, os recursos funcionem sem tempo de inatividade e afetem os clientes. </li><li>  Para reduzir o impacto em nossos clientes, se algo der errado, decidimos lan√ßar no domingo √† noite.  √Ä noite, menos clientes gerenciam m√°quinas virtuais. </li><li>  Avisamos a todos os nossos clientes que, durante o per√≠odo escolhido para a implanta√ß√£o, o gerenciamento de servi√ßos n√£o estar√° dispon√≠vel. </li></ul><br><h2>  Digress√£o: o que √© lan√ßamento? </h2><br>  <i>&lt;filosofia do cuidado&gt;</i> <br><br>  Cada especialista em TI responder√° com facilidade o que √© o lan√ßamento.  Voc√™ coloca CI / CD e automaticamente tudo √© entregue ao produto.  :) <br><br>  Claro, isso √© verdade.  Mas a dificuldade √© que, com as ferramentas modernas para automatizar a entrega de c√≥digos, o entendimento de rolar em si √© perdido.  Como voc√™ se esquece da inven√ß√£o √©pica da roda, olhando para ve√≠culos modernos.  Tudo √© t√£o automatizado que o lan√ßamento √© feito sem a realiza√ß√£o de todo o cen√°rio. <br><br>  E a imagem toda √© a seguinte.  A distribui√ß√£o consiste em quatro grandes aspectos: <br><br><ol><li>  Entrega de c√≥digo, incluindo modifica√ß√£o de dados.  Por exemplo, sua migra√ß√£o. </li><li>  Revers√£o de c√≥digo - a capacidade de retornar se algo der errado.  Por exemplo, atrav√©s da cria√ß√£o de backups. </li><li>  O tempo de cada opera√ß√£o de lan√ßamento / revers√£o.  √â preciso entender o tempo de qualquer opera√ß√£o dos dois primeiros pontos. </li><li>  Funcionalidade afetada.  √â necess√°rio avaliar os efeitos positivos e poss√≠veis negativos negativos. </li></ol><br>  Todos esses aspectos devem ser levados em considera√ß√£o para a implementa√ß√£o bem-sucedida.  Geralmente, eles avaliam apenas o primeiro, na melhor das hip√≥teses, o segundo ponto e, em seguida, o lan√ßamento √© considerado bem-sucedido.  Mas o terceiro e o quarto s√£o ainda mais importantes.  Qual usu√°rio gostar√° se o lan√ßamento demorar 3 horas em vez de um minuto?  Ou se algo sup√©rfluo afeta a distribui√ß√£o?  Ou o tempo de inatividade de um servi√ßo levar√° a consequ√™ncias imprevis√≠veis? <br><br><h2>  Ato 1..n, prepara√ß√£o para libera√ß√£o </h2><br>  A princ√≠pio, pensei em descrever brevemente nossas reuni√µes: toda a equipe, suas partes, montes de discuss√µes em pontos de caf√©, disputas, testes, tempestades cerebrais.  Ent√£o pensei que seria sup√©rfluo.  Quatro meses de desenvolvimento sempre consistem nisso, especialmente quando voc√™ escreve n√£o algo que possa ser entregue constantemente, mas um grande recurso em um sistema vivo.  O que afeta todos os servi√ßos, mas os usu√°rios n√£o devem alterar nada, exceto o "bot√£o √∫nico na interface da web". <br><br>  Nosso entendimento de como implementar, mudou a cada nova reuni√£o e de maneira muito significativa.  Por exemplo, atualizar√≠amos toda a nossa base de faturamento.  Mas eles calcularam o tempo e perceberam que era imposs√≠vel fazer isso em um tempo razo√°vel de implementa√ß√£o.  Levamos quase uma semana adicional para fragmentar e arquivar o banco de dados de cobran√ßa.  E quando a velocidade de lan√ßamento prevista n√£o funcionou depois disso, eles solicitaram um ferro adicional mais poderoso, onde arrastaram toda a base.  N√£o que n√£o quis√©ssemos fazer isso antes, mas a atual necessidade de implementa√ß√£o n√£o nos deixou nenhuma op√ß√£o. <br><br>  Quando um de n√≥s tinha d√∫vidas de que o lan√ßamento poderia afetar a disponibilidade de nossas m√°quinas virtuais, passamos uma semana para testar, experimentar, analisar o c√≥digo e entendemos claramente que isso n√£o aconteceria em nossa produ√ß√£o, e mesmo as pessoas mais duvidosas concordaram com isso. <br><br>  Enquanto isso, o pessoal do suporte t√©cnico realizou seus experimentos independentes para escrever aos clientes instru√ß√µes sobre como se conectar, que deveriam mudar ap√≥s o lan√ßamento.  Eles trabalharam em um UX f√°cil de usar, prepararam instru√ß√µes e forneceram conselhos pessoais. <br><br>  Automatizamos todas as opera√ß√µes de implementa√ß√£o poss√≠veis.  Qualquer opera√ß√£o era roteirizada, mesmo a mais simples, fazia testes constantemente.  Eles discutiram sobre a melhor forma de desativar o servi√ßo - abaixe o daemon ou bloqueie o acesso ao servi√ßo com um firewall.  Uma lista de verifica√ß√£o das equipes foi criada para cada est√°gio de implanta√ß√£o, sendo constantemente atualizada.  Desenhamos e atualizamos constantemente o gr√°fico de Gantt para todos os trabalhos de lan√ßamento, com hor√°rios. <br><br>  E assim ... <br><br><h2>  Ato final, antes do lan√ßamento </h2><br>  ... √© hora de lan√ßar. <br><br>  Como diz o ditado, uma obra de arte n√£o pode ser conclu√≠da, apenas para terminar de trabalhar nela.  √â necess√°rio fazer um esfor√ßo de for√ßa de vontade, entendendo que voc√™ n√£o encontrar√° tudo, mas acreditando que fez todas as suposi√ß√µes razo√°veis, desde todos os casos poss√≠veis, fechou todos os bugs cr√≠ticos e todos os participantes fizeram tudo o que podiam.  Quanto mais c√≥digo voc√™ distribuir, mais dif√≠cil ser√° convencer-se disso (al√©m disso, algu√©m entende que √© imposs√≠vel prever tudo). <br><br>  Tomamos a decis√£o de que est√°vamos prontos para lan√ßar quando est√°vamos convencidos de que fizemos todo o poss√≠vel para fechar todos os riscos para nossos usu√°rios associados a efeitos e paradas inesperadas.  Ou seja, tudo pode dar errado, exceto: <br><br><ol><li>  O efeito (sagrado para n√≥s, o mais precioso) da infraestrutura do usu√°rio, </li><li>  Funcionalidade: o uso do nosso servi√ßo ap√≥s a implanta√ß√£o deve ser o mesmo de antes. </li></ol><br><h2>  Lan√ßamento </h2><br><img src="https://habrastorage.org/webt/mx/vt/yq/mxvtyqnl26yvqbxhego52zj9d8c.png"><br>  <i>Dois est√£o rolando, 8 n√£o interferem</i> <br><br>  Levamos um tempo de inatividade para todas as solicita√ß√µes de usu√°rios em 7 horas.  No momento, temos um plano de implementa√ß√£o e um plano de revers√£o. <br><br><ul><li>  O lan√ßamento em si leva cerca de 3 horas. </li><li>  2 horas - para teste. </li><li>  2 horas - uma reserva para uma poss√≠vel revers√£o de altera√ß√µes. </li></ul><br>  Um gr√°fico de Gantt foi compilado para cada a√ß√£o, quanto tempo leva, o que ocorre em sequ√™ncia, o que √© feito em paralelo. <br><br><img src="https://habrastorage.org/webt/gl/4v/2p/gl4v2pcxxorqbzzhuvlbdsi0jtg.png"><br>  <i>Uma fatia do gr√°fico de distribui√ß√£o de Gantt, uma das vers√µes anteriores (sem execu√ß√£o paralela).</i>  <i>A ferramenta de sincroniza√ß√£o mais valiosa</i> <br><br>  Todos os participantes t√™m seu papel na implementa√ß√£o, de quais tarefas executam e pelas quais s√£o respons√°veis.  Estamos tentando ativar cada est√°gio automaticamente, reverter, coletar feedback e rever novamente. <br><br><h3>  Cr√¥nica de eventos </h3><br>  Ent√£o, 15 pessoas vieram trabalhar no domingo, 28 de abril, √†s 22 horas.  Al√©m dos principais participantes, alguns vieram apenas para apoiar a equipe, pelos quais agradecemos especialmente a eles. <br><br>  Separadamente, vale ressaltar que nosso testador de chave est√° de f√©rias.  √â imposs√≠vel lan√ßar sem teste, estamos trabalhando em op√ß√µes.  Uma colega concorda em nos testar fora das f√©rias, pelas quais ela tem uma gratid√£o imensur√°vel de toda a equipe. <br><br>  <b>00:00.</b>  <b>Parar</b> <br>  Paramos as solicita√ß√µes dos usu√°rios, desligamos a placa de identifica√ß√£o, dizem eles, o trabalho t√©cnico.  Monitorando grita, mas tudo est√° normal.  Verificamos que nada caiu, exceto que deveria.  E come√ßamos a trabalhar na migra√ß√£o. <br><br>  Todo mundo tem um plano de implementa√ß√£o impresso para os pontos, todo mundo sabe quem est√° fazendo o que e em que momento.  Ap√≥s cada a√ß√£o, verificamos os hor√°rios que n√£o os excedem e tudo corre conforme o planejado.  Aqueles que n√£o est√£o envolvidos no lan√ßamento diretamente no est√°gio atual, preparam-se lan√ßando um brinquedo on-line (Xonotic, tipo 3 kwaki), para n√£o interferir com os colegas.  :) <br><br>  <b>02:00</b>  <b>Lan√ßado</b> <br>  Uma surpresa agrad√°vel - terminamos o lan√ßamento uma hora antes, devido √† otimiza√ß√£o de nossos bancos de dados e scripts de migra√ß√£o.  O grito universal "rolou!"  Todas as novas fun√ß√µes no prod, mas at√© agora s√≥ podemos ver a interface.  Todo mundo entra no modo de teste, organizado em mont√µes e come√ßa a ver o que aconteceu no final. <br><br>  N√£o deu muito certo, entendemos isso ap√≥s 10 minutos, quando nada est√° conectado e n√£o funciona nos projetos dos membros da equipe.  Sincroniza√ß√£o r√°pida, exprima nossos problemas, priorize, entre em equipes e entre em depura√ß√£o. <br><br>  <b>2:30 da manh√£</b>  <b>Dois grandes problemas vs quatro olhos</b> <br>  Encontramos dois grandes problemas.  Percebemos que os clientes n√£o ver√£o alguns servi√ßos conectados e haver√° problemas com as contas dos parceiros.  Ambos est√£o associados a scripts de migra√ß√£o imperfeitos para alguns casos extremos.  Precisamos consertar isso agora. <br><br>  N√≥s escrevemos consultas que corrigem isso, pelo menos 4 olhos.  N√≥s rolamos no pr√©-port√£o para garantir que eles funcionem e n√£o quebrem nada.  Voc√™ pode continuar.  Paralelamente, come√ßa nosso teste de integra√ß√£o usual, que detecta mais alguns problemas.  Todos eles s√£o pequenos, mas tamb√©m precisam ser reparados. <br><br>  <b>03:00</b>  <b>-2 problemas +2 problemas</b> <br>  Os dois grandes problemas anteriores foram corrigidos, quase todos os menores tamb√©m.  Todos desocupados em corre√ß√µes trabalham ativamente em suas contas e relatam o que encontram.  Priorizamos, distribu√≠mos por comandos, deixamos acr√≠ticos pela manh√£. <br><br>  Executando os testes novamente, eles revelam dois novos grandes problemas.  Nem todas as pol√≠ticas de servi√ßo chegaram corretamente, portanto, algumas solicita√ß√µes de usu√°rio n√£o s√£o autenticadas.  Al√©m de um novo problema com as contas de parceiros.  Corremos para assistir. <br><br>  <b>03:20.</b>  <b>Sincroniza√ß√£o de emerg√™ncia</b> <br>  Um novo problema foi corrigido.  Para o segundo, organizamos uma sincroniza√ß√£o de emerg√™ncia.  Entendemos o que est√° acontecendo: a corre√ß√£o anterior corrigiu um problema, mas criou outro.  Damos um tempo para descobrir como faz√™-lo da maneira certa e sem consequ√™ncias. <br><br>  <b>03:30</b>  <b>Seis olhos</b> <br>  Estamos cientes do que deve ser o estado final da base para que tudo seja bom para todos os parceiros.  N√≥s escrevemos um pedido em 6 olhos, rolamos na pr√©-haste, testamos, rolamos no prod. <br><br>  <b>04:00.</b>  <b>Tudo funciona</b> <br>  Todos os testes foram aprovados, nenhum problema cr√≠tico √© vis√≠vel.  De tempos em tempos, algo n√£o funciona em equipe, respondemos rapidamente.  Na maioria das vezes, o alarme √© falso.  Mas √†s vezes algo n√£o chegou, em algum lugar uma p√°gina separada n√£o funciona.  N√≥s sentamos, consertamos, consertamos, consertamos.  Uma equipe separada lan√ßa o √∫ltimo grande recurso - cobran√ßa. <br><br>  <b>04:30.</b>  <b>Ponto sem retorno</b> <br>  O ponto de n√£o retorno est√° pr√≥ximo, ou seja, o momento em que, se come√ßarmos a retroceder, n√£o encontraremos o tempo de inatividade que nos √© dado.  H√° problemas com o faturamento, que sabe tudo e anota, mas teimosamente n√£o deseja anular o dinheiro dos clientes.  Existem v√°rios erros em p√°ginas individuais, a√ß√µes e status.  A principal funcionalidade funciona, todos os testes passam com sucesso.  Decidimos que a distribui√ß√£o ocorreu, n√£o iremos reverter. <br><br>  <b>06:00</b>  <b>Abrimos em tudo na interface do usu√°rio</b> <br>  Os erros foram corrigidos.  Alguns usu√°rios que n√£o afetam s√£o deixados para mais tarde.  Abrimos a interface para todos.  Continuamos a invocar o faturamento, aguardamos o feedback dos usu√°rios e monitoramos os resultados. <br><br>  <b>07:00</b>  <b>Problemas de carregamento da API</b> <br>  Torna-se claro que temos um pouco de carga planejada incorretamente em nossa API e testamos essa carga, o que n√£o conseguiu identificar o problema.  Como resultado, ¬± 5% dos pedidos falham.  Estamos nos mobilizando, procurando uma raz√£o. <br><br>  O faturamento √© teimoso, tamb√©m n√£o quer funcionar.  Decidimos adi√°-lo para mais tarde, a fim de fazer altera√ß√µes em um modo calmo.  Ou seja, todos os recursos nele s√£o acumulados, mas as baixas cont√°beis dos clientes n√£o s√£o aprovadas.  Obviamente, isso √© um problema, mas, comparado ao lan√ßamento geral, n√£o parece fundamental. <br><br>  <b>08:00.</b>  <b>Fix API</b> <br>  Lan√ßamos uma corre√ß√£o para a carga, as falhas restantes.  Come√ßamos a ir para casa. <br><br>  <b>10h</b>  <b>Todos</b> <br>  Tudo est√° consertado.  No monitoramento e os clientes ficam quietos, a equipe vai gradualmente para a cama.  O faturamento permanece, n√≥s o restauraremos amanh√£. <br><br>  Depois, durante o dia, ocorreram lan√ßamentos que corrigiam os registros, notifica√ß√µes, c√≥digos de retorno e c√≥digos personalizados de alguns de nossos clientes. <br><br>  Portanto, o lan√ßamento foi bem-sucedido!  √â claro que poderia ser melhor, mas tiramos conclus√µes sobre o que n√£o t√≠nhamos o suficiente para alcan√ßar a perfei√ß√£o. <br><br><h2>  Total </h2><br>  Dois meses ap√≥s a prepara√ß√£o ativa para o lan√ßamento, 43 tarefas foram conclu√≠das, com dura√ß√£o de algumas horas a v√°rios dias. <br><br>  Durante o lan√ßamento: <br><br><ul><li>  dem√¥nios novos e modificados - 5 pe√ßas, substituindo 2 mon√≥litos; </li><li>  altera√ß√µes dentro dos bancos de dados - todos os 6 bancos de dados com dados do usu√°rio s√£o afetados, descarregamentos de tr√™s bancos de dados antigos para um novo s√£o conclu√≠dos; </li><li>  frontend completamente refeito; </li><li>  o n√∫mero de c√≥digo extra√≠do - 33 mil linhas de novo c√≥digo, thousand 3 mil linhas de c√≥digo nos testes, ‚âà 5 mil linhas de c√≥digo de migra√ß√£o; </li><li>  todos os dados est√£o intactos, nenhuma m√°quina virtual do cliente sofreu.  :) </li></ul><br><h2>  Boas pr√°ticas para uma boa implanta√ß√£o </h2><br>  Fomos guiados por eles nessa situa√ß√£o dif√≠cil.  Mas, de um modo geral, √© √∫til observ√°-los em qualquer implementa√ß√£o.  Por√©m, quanto mais dif√≠cil o lan√ßamento, maior o papel que eles desempenham. <br><br><ol><li>  A primeira coisa que voc√™ precisa fazer √© entender como a distribui√ß√£o pode afetar ou afetar os usu√°rios.  Haver√° tempo de inatividade?  Se sim, ent√£o o que √© tempo de inatividade?  Como isso afetar√° os usu√°rios?  Quais s√£o os melhores e os piores cen√°rios?  E feche os riscos. </li><li>  Planeje tudo.  Em cada est√°gio, voc√™ precisa entender todos os aspectos da implementa√ß√£o: <br><ul><li>  entrega de c√≥digo; </li><li>  revers√£o de c√≥digo; </li><li>  hora de cada opera√ß√£o; </li><li>  funcionalidade afetada. </li></ul></li><li>  Execute cen√°rios at√© que todos os est√°gios de lan√ßamento sejam claros, bem como os riscos em cada um deles.  Em caso de d√∫vida, voc√™ pode fazer uma pausa e explorar o est√°gio duvidoso separadamente. </li><li>  Cada est√°gio pode e deve ser aprimorado se ajudar nossos usu√°rios.  Por exemplo, reduzir√° o tempo de inatividade ou remover√° alguns riscos. </li><li>  O teste de revers√£o √© muito mais importante do que a entrega de c√≥digo.  √â necess√°rio verificar se, como resultado da revers√£o, o sistema retornar√° ao seu estado original, confirme com testes. </li><li>  Tudo o que pode ser automatizado deve ser automatizado.  Tudo o que n√£o pode ser automatizado deve ser pr√©-escrito na folha de dicas. </li><li>  Registre crit√©rios de sucesso.  Que funcionalidade deve estar dispon√≠vel e a que horas?  Se isso n√£o acontecer, inicie um plano de revers√£o. </li><li>  E o mais importante, pessoas.  Todos devem estar cientes do que ele est√° fazendo, do que e do que depende de suas a√ß√µes no processo de implanta√ß√£o. </li></ol><br>  E se em uma frase, com um bom planejamento e elabora√ß√£o, voc√™ poder√° implementar o que quiser, sem consequ√™ncias para a venda.  Mesmo isso afeta todos os seus servi√ßos em prod. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt453364/">https://habr.com/ru/post/pt453364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt453352/index.html">Como os drones fornecem medicamentos vitais no Gana</a></li>
<li><a href="../pt453354/index.html">Classifica√ß√£o da cobertura do solo usando o eo-learn. Parte 3</a></li>
<li><a href="../pt453356/index.html">Tend√™ncias atuais e recomenda√ß√µes sobre aglomera√ß√£o de grandes institui√ß√µes financeiras</a></li>
<li><a href="../pt453360/index.html">Cidade sem engarrafamentos</a></li>
<li><a href="../pt453362/index.html">HabraConf # 1 - para tr√°s para back-end</a></li>
<li><a href="../pt453366/index.html">Como usar v√≠rgulas em ingl√™s: 15 regras e exemplos de erros</a></li>
<li><a href="../pt453368/index.html">Recupera√ß√£o de dados de tabelas XtraDB sem arquivo de estrutura usando an√°lise de bytes do arquivo ibd</a></li>
<li><a href="../pt453370/index.html">Confronto 2019: Jet Security Team ficou em primeiro lugar na defesa</a></li>
<li><a href="../pt453374/index.html">Os 10 principais provedores de API e SDK de chamadas de bate-papo, √°udio e v√≠deo para neg√≥cios corporativos</a></li>
<li><a href="../pt453376/index.html">Como desperdi√ßar seu tempo e recursos SSD em v√£o? F√°cil e Simples</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>