<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêõ üßñüèº üë®üèΩ‚Äçüåæ Dispositivo Sysadmin EDC: Linux no seu bolso ü§© ü§òüèø üß†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cada administrador, talvez, teve um caso em que algo de repente quebra e voc√™ est√° em algum lugar na estrada: voc√™ vai de carro, pega um trem ou, bana...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dispositivo Sysadmin EDC: Linux no seu bolso</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409945/"> Cada administrador, talvez, teve um caso em que algo de repente quebra e voc√™ est√° em algum lugar na estrada: voc√™ vai de carro, pega um trem ou, banalmente, senta em algum lugar em um banco do parque e se solta e sai correndo para algum lugar o desejo n√£o √© o menor.  E voc√™ precisa corrigi-lo.  Ou, no m√≠nimo, avalie a escala do animal branco com p√™lo que chegou. <br><br>  √â claro que voc√™ pode fazer isso com um smartphone ou tablet, especialmente se voc√™ precisar apenas usar o ssh.  Mas usar uma tela sens√≠vel ao toque nesses casos, como para mim, √© dor e sofrimento. <br><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hd/-j/nd/hd-jndx6jjchvd9ggnpyj-ynvhw.jpeg"></div><br>  Voc√™ pode comprar um teclado, suporte ou suporte externo para o tablet, mas acho que √© mais f√°cil carregar um laptop completo com voc√™.  Os lugares continuar√£o iguais. <br><a name="habracut"></a><br><h2>  Algumas mem√≥rias e racioc√≠nio </h2><br>  Com pregui√ßa de ler, voc√™ pode imediatamente ir para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">parte pr√°tica.</a> <br><br>  Ao mesmo tempo, quando androids e iPhones ainda n√£o existiam, usei o "tablet para Internet" Nokia N810.  O aparelho tem dimens√µes com um smartphone moderno, enquanto possui um teclado qwerty e at√© com Linux completo a bordo.  Ssh, vnc, rdesktop - sim, sem d√∫vida!  Al√©m disso, usei ativamente o CAS Maxima quando precisava calcular rapidamente algo e mostrar o resultado. <br><br><br> <a href=""><img src="https://habrastorage.org/webt/bd/e7/kx/bde7kxemqv5fuchk9o5aujaokte.jpeg"></a> <br> <a href=""><img src="https://habrastorage.org/webt/so/ya/xr/soyaxrvavdiymhza5xjuv0mhy7q.png"></a> <br><br>  Mas o tempo passou, os smartphones Android come√ßaram a aparecer.  Aqui est√°, pensei: Linux quase completo, ao mesmo tempo, n√£o h√° necessidade de carregar outro dispositivo com voc√™ para distribuir a Internet.  Comecei a cuidar do aparelho com o qwerty, que me substituiria pelo bom e velho n810, que naquela √©poca estava bastante cansado (cabo de tela, bateria substitu√≠da duas vezes, teclado, estojo quebrado).  A escolha recaiu sobre o Motorola Milestone. <br><br>  Aqui est√°, em parte, ao lado do meu bom e velho Palm V e N810: <br><br> <a href=""><img src="https://habrastorage.org/webt/hh/vf/bm/hhvfbmnvsxhy_2srw11rhwt8r5g.jpeg"></a> <br><br>  Devo dizer que o produto n√£o justificou a confian√ßa.  O teclado foi uma decep√ß√£o completa.  Nem por causa do layout, mas por causa do acabamento extremamente ruim: ap√≥s seis meses de uso, ele come√ßou a esfoliar e a sair. <br><br>  O gerenciador de inicializa√ß√£o criptografado adicionou seus pregos ao caix√£o: a incapacidade de usar o n√∫cleo personalizado com todas as consequ√™ncias, o debian chroot comeu a bateria como se por si s√≥, devido √†s peculiaridades da fonte de alimenta√ß√£o, mas de qualquer maneira, o produto de alguma maneira resolveu as tarefas atribu√≠das a ele. <br><br>  No m√≠nimo, continuou a ser usado ap√≥s o t√©rmino do per√≠odo de obsolesc√™ncia planejado determinado pelo fabricante, quando v√°rios modelos mais recentes foram lan√ßados (diferentes, talvez com um layout ligeiramente alterado e com muita mem√≥ria RAM), e era extremamente lento e lento. <br><br>  Tudo bem, como o terminal ssh desce e o smartphone (√© claro, ele devora uma certa quantidade de c√©lulas nervosas).  Mas h√° casos em que voc√™ precisa se prender a um peda√ßo de ferro com um cabo de console ou remover o tcpdump com um dispositivo IP que n√£o responde, para que voc√™ possa fazer algo com ele. <br><br>  √â simplesmente encantador quando, devido √† presen√ßa de uma porta COM na esta√ß√£o de acoplamento, uma pessoa arrasta um idiota shnuy de 17 "HP com uma doca e uma fonte de alimenta√ß√£o de 1,5 kg e depois fica com todo esse material na escada em frente ao balc√£o. <br><br>  Recentemente, usei o ThinkPad x220 de 12 "com adaptador usb2com. Mas, cada vez mais, comecei a deixar o laptop em casa, at√© que um dia (mais uma vez)" $ username, tudo quebrou! ", E eu s√≥ tinha um smartphone Android comigo. <br><br><h2>  Aqui est√°, o peixe dos meus sonhos (de fato, n√£o) </h2><br>  E uma vez me deparei com um produto chamado GPD Pocket.  Um laptop completo no formato de um re-smartphone ou tablet de tamanho menor.  Teclado qwerty de 7 ", uma margem decente de autonomia - voc√™ precisa aceit√°-lo. Eu pedi, recebi, desempacotei. <br><br>  Para compara√ß√£o com x220 e n810: <br><br> <a href=""><img src="https://habrastorage.org/webt/jg/kj/hq/jgkjhqw3ulrb3i956decqaladlk.jpeg"></a> <br><br>  N√£o descreverei as caracter√≠sticas daqueles que precisam - eles a encontrar√£o na Internet, especialmente porque houve recentemente uma revis√£o desagrad√°vel da girbest aqui.  Apenas d√™ o escape lshw e lspci: <br><br>  lshw: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre><code class="plaintext hljs">:   : Default string (Default string) : Default string : Default string  ‚Ññ: Default string : 64 bits : smbios-3.0 dmi-3.0 vsyscall32 : boot=normal chassis=desktop family=Default string sku=Default string uuid=00020003-0004-0005-0006-000700080009 *-core :   : Default string : AMI Corporation  ID: 0 : Default string  ‚Ññ: Default string : Default string *-firmware : BIOS : American Megatrends Inc.  ID: 0 : 5.11 date: 08/07/2017 : 64KiB capacity: 4032KiB : pci upgrade shadowing cdboot bootselect socketedrom edd int13floppy1200 int13floppy720 int13floppy2880 int5printscreen int14serial int17printer acpi usb biosbootspecification uefi *-memory :    ID: 28 :      : 8GiB *-bank:0 : DIMM DDR3 1066 MHz (0,9 ns) : 00000000 : Hynix Semiconductor  ID: 0  ‚Ññ: 00000000 : A1_DIMM0 : 4GiB : 8 bits : 1066MHz (0.9ns) *-bank:1 : DIMM DDR3 1066 MHz (0,9 ns) : 00000000 : Hynix Semiconductor  ID: 1  ‚Ññ: 00000000 : A1_DIMM1 : 4GiB : 8 bits : 1066MHz (0.9ns) *-cache:0 : L1   ID: 32 : CPU Internal L1 : 224KiB capacity: 224KiB : internal write-back : level=1 *-cache:1 : L2   ID: 33 : CPU Internal L2 : 2MiB capacity: 2MiB : internal write-back unified : level=2 *-cpu :  : Intel(R) Atom(TM) x7-Z8750 CPU @ 1.60GHz : Intel Corp.  ID: 34   : cpu@0 : Intel(R) Atom(TM) x7-Z8750 CPU @ 1.60GHz : SOCKET 0 : 889MHz capacity: 2560MHz : 64 bits : 80MHz : x86-64 fpu fpu_exception wp vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp constant_tsc arch_perfmon pebs bts rep_good nopl xtopology tsc_reliable nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch epb pti tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms dtherm ida arat cpufreq : cores=4 enabledcores=4 threads=4 *-pci : Host bridge : Intel Corporation : Intel Corporation  ID: 100   : pci@0000:00:00.0 : 34 : 32 bits : 33MHz : driver=iosf_mbi_pci : IRQ:0 *-display : VGA compatible controller : Intel Corporation : Intel Corporation  ID: 2   : pci@0000:00:02.0 : 34 : 64 bits : 33MHz : pm msi vga_controller bus_master cap_list rom : driver=i915 latency=0 : IRQ:123 :a0000000-a0ffffff :80000000-9fffffff ioport:f000(=64) :c0000-dffff *-generic:0 : Signal processing controller : Intel Corporation : Intel Corporation  ID: b   : pci@0000:00:0b.0 : 34 : 64 bits : 33MHz : msi pm cap_list : driver=proc_thermal latency=0 : IRQ:129 :a1a3b000-a1a3bfff *-usb : USB controller : Intel Corporation : Intel Corporation  ID: 14   : pci@0000:00:14.0 : 34 : 64 bits : 33MHz : pm msi xhci bus_master cap_list : driver=xhci_hcd latency=0 : IRQ:121 :a1a00000-a1a0ffff *-usbhost:0 : xHCI Host Controller : Linux 4.15.0-rc7-stockmind-gpdpocket xhci-hcd  ID: 0   : usb@1  : usb1 : 4.15 : usb-2.00 : driver=hub slots=7 speed=480Mbit/s *-usb:0 :  : Gaming Keyboard : SINO WEALTH  ID: 2   : usb@1:2 : 1.00 : usb-1.10 : driver=usbhid maxpower=100mA speed=1Mbit/s *-usb:1 :  USB- : BCM2045A0 : Broadcom Corp  ID: 3   : usb@1:3 : 1.12  ‚Ññ: B0F1ECED56A9 : usb-2.00 : driver=btusb maxpower=100mA speed=12Mbit/s *-usbhost:1 : xHCI Host Controller : Linux 4.15.0-rc7-stockmind-gpdpocket xhci-hcd  ID: 1   : usb@2  : usb2 : 4.15 : usb-3.00 : driver=hub slots=6 speed=5000Mbit/s *-generic:1 : Encryption controller : Intel Corporation : Intel Corporation  ID: 1a   : pci@0000:00:1a.0 : 34 : 32 bits : 33MHz : pm msi bus_master cap_list : driver=mei_txe latency=0 : IRQ:130 :a1900000-a19fffff :a1800000-a18fffff *-pci : PCI bridge : Intel Corporation : Intel Corporation  ID: 1c   : pci@0000:00:1c.0 : 34 : 32 bits : 33MHz : pci pciexpress msi pm normal_decode bus_master cap_list : driver=pcieport : IRQ:117 :a1000000-a14fffff *-network :   : BCM4356 802.11ac Wireless Network Adapter : Broadcom Corporation  ID: 0   : pci@0000:01:00.0  : wlp1s0 : 02  ‚Ññ: b0:f1:ec:ed:56:a8 : 64 bits : 33MHz : pm msi pciexpress bus_master cap_list ethernet physical wireless : broadcast=yes driver=brcmfmac driverversion=7.35.180.119 firmware=01-1a5c4016 ip=192.168.1.142 latency=0 multicast=yes wireless=IEEE 802.11 : IRQ:125 :a1400000-a1407fff :a1000000-a13fffff *-isa : ISA bridge : Intel Corporation : Intel Corporation  ID: 1f   : pci@0000:00:1f.0 : 34 : 32 bits : 33MHz : isa bus_master cap_list : driver=lpc_ich latency=0 : IRQ:0</code> </pre> </div></div><br>  lspci: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">00:00.0 Host bridge: Intel Corporation Device 2280 (rev 34) 00:02.0 VGA compatible controller: Intel Corporation Device 22b0 (rev 34) 00:0b.0 Signal processing controller: Intel Corporation Device 22dc (rev 34) 00:14.0 USB controller: Intel Corporation Device 22b5 (rev 34) 00:1a.0 Encryption controller: Intel Corporation Device 2298 (rev 34) 00:1c.0 PCI bridge: Intel Corporation Device 22c8 (rev 34) 00:1f.0 ISA bridge: Intel Corporation Device 229c (rev 34) 01:00.0 Network controller: Broadcom Corporation BCM4356 802.11ac Wireless Network Adapter (rev 02)</code> </pre></div></div><br>  A qualidade de constru√ß√£o √© boa, n√£o toca nada, n√£o range, n√£o se dobra.  A caixa √© de alum√≠nio e, em geral, o dispositivo d√° a impress√£o de uma esp√©cie de bloco monol√≠tico.  Isto √© uma vantagem. <br><br>  Mas h√° desvantagens suficientes tamb√©m.  Tela brilhante.  N√£o, n√£o √© apenas brilhante - √© literalmente um espelho.  Ou seja, voc√™ observar√° seu reflexo em condi√ß√µes de qualquer ilumina√ß√£o diferente de zero.  Havia um filme protetor no kit, mas n√£o resolveu o problema. <br><br>  O segundo √© o teclado.  O fato de ela ser √© maravilhoso. <br><br> <a href=""><img src="https://habrastorage.org/webt/zx/ac/cf/zxaccfpxwmrrsoxazzhah3yffk0.jpeg"></a> <br><br>  Mas como √© implementado √© vergonha e horror.  Tentando invadir o macbook, com essas lacunas entre os bot√µes - bem, por qu√™?  Afinal, o p√∫blico-alvo, ao que parece, n√£o √© gatinhos fascinantes - eles apenas levam o pr√≥ximo ipad ou macbook.  N√£o tenha essas lacunas infelizes, o tamanho das chaves pode ser aumentado. <br><br>  O bot√£o Fn tem uma camada muito escassa: s√£o 2 bot√µes para ajustar o brilho, F1-F12 e Insert.  Por que precisamos da linha superior?  Pode ser implementado como uma camada separada. <br><br>  Os usu√°rios do Vim s√£o particularmente dolorosos e sofrem com dois pontos colocados na linha inferior ao lado de ctrl. <br><br>  Ok, tudo est√° ruim, vamos tratar disso, j√° que existem algumas maneiras (mais sobre isso abaixo). <br><br>  Ah, sim, h√° um ponto de trilha aqui.  O que para mim, como um usu√°rio experiente do ThinkPad, aquece minha alma.  S√≥ uma coisa, mas: o trackpoint est√° localizado no lugar errado e, para us√°-lo, voc√™ precisa dobrar o polegar.  Infelizmente, isso √© incur√°vel.  Mas, por algumas tampas vermelhas adicionais no kit, √© claro, obrigado. <br><br>  Trackpoint de pessoa saud√°vel: <br><img src="https://habrastorage.org/webt/hl/qp/9_/hlqp9_0jr_ergvl5hklnu3js1l4.jpeg"><br><br>  Trackpoint do fumante: <br><img src="https://habrastorage.org/webt/vm/be/dm/vmbedms-h1ze_4cnu9_vpecgtri.jpeg"><br><br><h2>  Instale e configure o Linux no GPD Pocket </h2><br>  √â claro que as ‚Äújanelas‚Äù e as ‚Äújanelas 10‚Äù especialmente n√£o s√£o o que eu preciso neste dispositivo, mas s√£o simplesmente contra-indicadas. <br><br>  Devido aos recursos do dispositivo, como a orienta√ß√£o da tela (√© girada para o lado), √© imposs√≠vel simplesmente pegar e instalar o seu Debian favorito sem dan√ßar com um pandeiro. <br><br> <a href=""><img src="https://habrastorage.org/webt/j_/xy/ai/j_xyai5nsa-njzt67cjgkq4joq4.jpeg"></a> <br><br>  Em princ√≠pio, o site oficial tem a imagem oficial do Ubuntu LTS 16.04 (o que me parece uma boa alternativa ao Debian est√°vel), mas depois de ler as discuss√µes na Internet, foi decidido usar o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GPD Pocket Ubuntu Respin</a> <br><br>  Enfatizo, em geral, o √≥bvio de que apenas uma imagem criada no Ubuntu √© adequada para uso e alimenta√ß√£o de um script, por exemplo, Debian, n√£o funcionar√°: <br><br><pre> <code class="plaintext hljs">$./build.sh debian-9.3.0-amd64-netinst.iso Display setting: Xorg-Standard Looking for kernel image... Extracting kernel files... Archive: gpdpocket-20180115-kernel-files.zip inflating: linux-headers-4.15.0-rc7-stockmind-gpdpocket_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb inflating: linux-image-4.15.0-rc7-stockmind-gpdpocket_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb inflating: linux-libc-dev_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb ./isorespin.sh: 'debian-9.3.0-amd64-netinst.iso' must be an Ubuntu (or Ubuntu flavour), Linux Mint, neon, elementary, BackBox or Peppermint desktop ISO.</code> </pre><br>  Na sa√≠da, obtemos o arquivo linuxium-xubuntu-16.04-desktop-amd64.iso, que gravamos na unidade flash USB: <br><br><pre> <code class="plaintext hljs">#dd if=linuxium-xubuntu-16.04-desktop-amd64.iso of=/dev/sdX</code> </pre> <br>  Inicializamos a partir dele, definindo o dispositivo de inicializa√ß√£o, acessando as configura√ß√µes UEFI com o bot√£o Excluir na inicializa√ß√£o. <br><br>  O procedimento de instala√ß√£o √© trivial, n√£o vejo sentido em espalhar.  Observo apenas que √© melhor produzi-lo no modo Ao vivo, para que a tela n√£o seja virada para o lado. <br><br>  Uso criptografia de disco completa, caso o dispositivo seja perdido ou roubado de repente.  Portanto, pelo menos, todas as suas chaves ssh (sim, eu sei sobre prote√ß√£o por senha e ssh-agent) e os logins nos recursos da Internet permanecer√£o intactos.  Portanto, coloquei o LVM em cima do LUKS, o que tamb√©m desejo a voc√™. <br><br><h2>  Corrija as curvulinas </h2><br><h3>  Sono e hiberna√ß√£o </h3><br>  Seria bom poder jogar um laptop em uma bolsa e esquec√™-lo at√© que seja necess√°rio.  Felizmente, tamanho e peso permitem.  Seria bom n√£o iniciar, a cada vez, manualmente os aplicativos necess√°rios, mas simplesmente continuar trabalhando no local de onde voc√™ parou. <br><br>  O modo de suspens√£o, ao que parece, funciona imediatamente.  √â implementado por meios regulares, ou seja, atrav√©s do systemctl suspend.  No entanto, empiricamente, verificou-se que o consumo de energia nesse modo n√£o √© muito inferior ao consumo ocioso.  Aparentemente, o dispositivo simplesmente extingue a tela, faz interface com a rede e desliga o cooler.  Como resultado, a bateria aterrar√° em zero dias para dois. <br><br>  Precisa de hiberna√ß√£o.  O hibernate normal do systemctl acabou inoperante: o estado √© despejado em uma troca, mas n√£o pode se recuperar na inicializa√ß√£o. <br><br>  Lembrei-me de que existe esse projeto - o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Userspace Software Suspend</a> e seus pacotes est√£o no reposit√≥rio. <br><br><pre> <code class="plaintext hljs">#apt install hibernate</code> </pre> <br>  Verificamos: <br><br><pre> <code class="plaintext hljs">#hibernate-disk</code> </pre> <br>  Voila, funciona!  O sistema despejou e desligou.  Depois de inserir a senha LUKS, recuperado.  Mas o som e o wifi foram cobertos, o brilho da luz de fundo da tela foi redefinido ao m√°ximo.  N√≥s vamos terminar. <br><br><h3>  Instale o necess√°rio </h3><br>  Antes de prosseguir com a configura√ß√£o da ACPI, voc√™ precisar√° instalar v√°rios utilit√°rios. <br><br>  Portanto, para ajustar o brilho da tela √© respons√°vel pela luz de fundo. <br><br><pre> <code class="plaintext hljs">#apt install xbacklight</code> </pre> <br>  O laptop n√£o √© um disco r√≠gido, mas um flash drive, ent√£o n√£o quero mat√°-lo com uma troca.  Existe o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ZRam</a> , aqui vamos us√°-lo.  Agora tudo √© simples com isso, voc√™ n√£o precisa prescrever planilhas no rc.local e precisa fazer o seguinte: <br><br><pre> <code class="plaintext hljs">#apt install zram-config #sudo systemctl enable zram-config.service</code> </pre><br>  O pr√≥prio script calcular√° a quantidade necess√°ria de mem√≥ria e far√° um swapon. <br><br>  Conforme observado corretamente nos coment√°rios, o recurso flash consome n√£o apenas a troca, mas tamb√©m o log.  Portanto, / tmp e / var / log ser√£o colocados no ram no tmpfs.  Para fazer isso, adicione duas linhas ao / etc / fstab: <br><br><pre> <code class="plaintext hljs">tmpfs /tmp tmpfs nodev,nosuid,size=256M 0 0 tmpfs /var/log tmpfs nodev,nosuid,size=512M 0 0</code> </pre><br><br><h3>  N√≥s terminamos acpi </h3><br>  Primeiro, desative os manipuladores systemg'shnyh.  Uma vez que faz tudo por seus pr√≥prios meios, mas eles s√£o inoperantes.  Lema - fazemos tudo, mas fazemos mal.  Por exemplo, ele n√£o aprendeu a lidar com a conex√£o de um adaptador de energia ou fones de ouvido, pressionamentos de teclas ou similares. <br><br><div class="spoiler">  <b class="spoiler_title">Ele comeu √°cido e ainda est√° com fome!</b>  <b class="spoiler_title">(4Mb)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/3g/yu/fa/3gyufa5pfygiidcnl4zw2xxmcxi.gif"></div></div><br>  /etc/systemd/logind.conf <br><br><pre> <code class="plaintext hljs">HandlePowerKey=ignore HandleLidSwitch=ignore</code> </pre><br><pre> <code class="plaintext hljs">#systemctl restart systemd-logind.service</code> </pre> <br>  O daemon acpid √© respons√°vel pelo processamento de eventos acpi, cujos arquivos de configura√ß√£o s√£o armazenados repentinamente em / etc / acpi. <br><br>  Enviaremos o laptop √† hiberna√ß√£o pressionando o bot√£o liga / desliga.  Para fazer isso, edite os seguintes arquivos (se n√£o estiverem, voc√™ precisa criar): <br><br>  / etc / acpi / events / powerbtn <br><br><pre> <code class="plaintext hljs">event=button[ /]power action=/etc/acpi/hibernate.sh</code> </pre><br>  /etc/acpi/hibernate.sh (com coment√°rios) <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#!/bin/bash #    ,        LUKS mv /home/user/bin/lock /home/user/bin/nolock # - killall -9 pulseaudio # zram   swap systemctl stop zram-config.service swapon /dev/xubuntu-vg/swap_1 #    DISPLAY=:0.0 su user -c "xbacklight &gt;/tmp/xbl" #    umount -alt nfs4 umount -alt cifs # wpa_supplicant /sbin/wpa_cli suspend hibernate-disk sleep 2 #   DISPLAY=:0.0 su user -c "xbacklight -set `cat /tmp/xbl`" # wpa_supplicant /sbin/wpa_cli resume #  alsa,    . -     /sbin/alsa force-reload #     .  ,      DAC1,            amixer -c 1 set 'DAC1' 90% #    ,        killall i3lock #    mv /home/user/bin/nolock /home/user/bin/lock # zram systemctl start zram-config.service #    swapoff /dev/xubuntu-vg/swap_1</code> </pre></div></div><br>  A hiberna√ß√£o autom√°tica a baixo custo n√£o √© f√°cil de implementar, mas muito simples: <br><br><pre> <code class="plaintext hljs">#apt install acpi</code> </pre> <br>  /etc/acpi/ifbatlowgotosleep.sh <br><br><pre> <code class="plaintext hljs">#!/bin/bash level=`/usr/bin/acpi -b|sed '/unava/d'|awk -F\ '{ print $4 }'|sed -e 's/,//' -e's/%//'` if [ "$level" -lt "10" ] then /etc/acpi/hibernate.sh fi</code> </pre><br>  O script verifica o estado da carga.  Se menos de 10%, ele executa o script de hiberna√ß√£o acima. <br><br>  A execu√ß√£o peri√≥dica √© definida via crontab: <br><br><pre> <code class="plaintext hljs">$sudo crontab -e */3 * * * * /etc/acpi/ifbatlowgotosleep.sh 2&gt;/dev/null</code> </pre><br>  No meu caso, a bateria √© pesquisada a cada 3 minutos. <br><br>  O modo de suspens√£o (suspens√£o do systemctl), como mencionado acima, √© bastante in√∫til.  Portanto, n√£o vejo raz√£o para ativ√°-lo ao fechar a tampa.  Al√©m disso, pode haver um desejo, digamos, de ouvir m√∫sica de um laptop fechado no seu bolso (n√£o √© √† toa que se trata de "bolso"). <br><br>  Portanto, simplesmente desligamos a tela ao fechar e a ligamos ao abrir. <br><br>  Exclua / etc / acpi / lidbtn. <br><br>  Criamos e editamos: <br><br>  / etc / acpi / events / lidclose: <br><br><pre> <code class="plaintext hljs">event=button/lid LID close action=/etc/acpi/lidclose.sh</code> </pre><br>  / etc / acpi / events / lidopen: <br><br><pre> <code class="plaintext hljs">event=button/lid LID open action=/etc/acpi/lidopen.sh</code> </pre><br>  /etc/acpi/lidopen.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xrandr --output DSI1 --off"</code> </pre> <br>  /etc/acpi/lidclose.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xrandr --output DSI1 --auto --rotate right --dpi 200"</code> </pre> <br>  Defina o valor do DPI ao seu gosto e user √© o nome simples da minha conta (altere para o seu). <br><br><h3>  Configurando as teclas de controle de som e brilho </h3><br>  Fazemos isso atrav√©s dos mesmos eventos ACPI. <br><br>  / etc / acpi / events / voldown <br><br><pre> <code class="plaintext hljs">event=button[ /]volumedown action=/etc/acpi/volume-down.sh</code> </pre><br>  / etc / acpi / events / volup <br><br><pre> <code class="plaintext hljs">event=button[ /]volumeup action=/etc/acpi/volume-up.sh</code> </pre><br>  / etc / acpi / events / mute <br><br><pre> <code class="plaintext hljs">event=button[ /]mute action=/etc/acpi/volume-toggle.sh</code> </pre><br>  Scripts: <br><br>  /etc/acpi/volume-toggle.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Speaker Channel' toggle amixer -c 1 set 'Headphone Channel' toggle</code> </pre><br>  /etc/acpi/volume-up.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Headphone' 5%+ amixer -c 1 set 'Speaker' 5%+</code> </pre><br>  /etc/acpi/volume-down.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Headphone' 5%- amixer -c 1 set 'Speaker' 5%-</code> </pre><br>  Da mesma forma para brilho: <br>  / etc / acpi / events / bdown <br><br><pre> <code class="plaintext hljs">event=button[ /]brightnessdown action=/etc/acpi/bdown.sh</code> </pre><br>  / etc / acpi / events / bup <br><br><pre> <code class="plaintext hljs">event=button[ /]brightnessup action=/etc/acpi/bup.sh</code> </pre><br>  /etc/acpi/bup.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xbacklight -inc 5%"</code> </pre><br>  /etc/acpi/bdown.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xbacklight -dec 5%"</code> </pre><br>  Deixe-me lembr√°-lo, usu√°rio √© o nome da minha conta.  Digite o seu. <br><br><h3>  Auscultadores </h3><br>  Merda ^ W Um chip peculiar da Realtek ALC5645 n√£o pode desligar independentemente os alto-falantes quando os fones de ouvido est√£o conectados.  Voc√™ tem que ensinar ao sistema como fazer voc√™ mesmo. <br><br>  Existe um script em respin: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#!/bin/bash set -e -u if [ "$1" = "jack/headphone" -a "$2" = "HEADPHONE" ]; then case "$3" in plug) sink="[Out] Headphones" ;; *) sink="[Out] Speaker" ;; esac for userdir in /run/user/*; do uid="$(basename $userdir)" user="$(id -un $uid)" if [ -f "$userdir/pulse/pid" ]; then su "$user" -c "pacmd set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645__sink $sink" fi done fi</code> </pre></div></div><br>  Mas isso n√£o funciona.  Tenta fazer uma altern√¢ncia atrav√©s do controle de sincroniza√ß√£o do √°udio, mas falha.  Porque: <br><br><pre> <code class="plaintext hljs">$sudo su #su user -c "pacmd set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645__sink '[Out] Speaker'"    PulseAudio,        .</code> </pre><br>  A solu√ß√£o √© simples: quando o processo de √°udio ainda n√£o foi chamado pelo cliente, n√£o h√° nada para contatar o pacmd.  Voc√™ pode, √© claro, adicionar uma linha para iniciar esta em rc.local, xinitrc ou at√© escrever uma unidade systemg separada, mas achei que era melhor planejar minha pr√≥pria muleta do que reparar outras.  E eu escrevi meu pr√≥prio roteiro, muito menos monstruoso e sofisticado, eu acho. <br><br>  /etc/acpi/headphone-jack.sh <br><br><pre> <code class="plaintext hljs">#!/bin/bash set -e -u if [ "$3" = "plug" ]; then amixer -c 1 set 'Speaker Channel' mute &gt;/dev/null amixer -c 1 set 'Headphone Channel' unmute &gt;/dev/null else amixer -c 1 set 'Speaker Channel' unmute &gt;/dev/null amixer -c 1 set 'Headphone Channel' mute &gt;/dev/null fi</code> </pre><br><h3>  Tratamos o layout e outras pequenas coisas </h3><br>  Como j√° mencionado, o layout me enfurece.  O bot√£o excluir √© o local onde a barra invertida e a barra devem estar, os dois pontos na linha inferior, n√£o est√° claro por que o menu principal, guia, √© onde a fuga ocorre nos teclados normais ... <br><br>  N√£o pintarei em detalhes; com a an√°lise, trarei meu ~ / .xmodmaprc e descreverei como isso √© feito. <br><br>  Para come√ßar, precisamos pegar o c√≥digo-chave.  Isso √© feito usando o programa xev (#apt install xev, yes).  Execute, pressione a tecla desejada e obtenha uma sa√≠da como: <br><br><pre> <code class="plaintext hljs">KeyPress event, serial 33, synthetic NO, window 0x3200001, root 0x2c0, subw 0x0, time 187713326, (979,493), root:(982,1078), state 0x0, keycode 119 (keysym 0xffff, Delete), same_screen YES, XLookupString gives 1 bytes: (7f) "" XmbLookupString gives 1 bytes: (7f) "" XFilterEvent returns: False</code> </pre><br>  Precisamos do valor "keycode 119". <br><br>  Em seguida, abra ~ / .xmodmaprc e escreva l√° <br><br><pre> <code class="plaintext hljs">keycode 119 = backslash bar backslash bar</code> </pre> <br>  E introduzimos a execu√ß√£o do "xmodmap ~ / .xmodmaprc" no seu xinitrc ou o que for chamado quando voc√™ inicia seu DE ou WM favorito. <br><br>  Meu ~ / .xmodmaprc: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">pointer = 1 2 3 4 5 remove Lock = Caps_Lock remove Control = Control_L keycode 0x42 = Control_L keycode 135 = Alt_R keycode 0x25 = Super_R keycode 133 = Super_R add Control = Control_L keycode 113 = Left keycode 111 = Up keycode 114 = Right keycode 116 = Down keycode 110 = Home keycode 115 = End keycode 108 = ISO_Next_Group keycode 136 = ISO_First_Group keycode 49 = asciitilde grave asciitilde grave keycode 119 = backslash bar backslash bar keycode 51 = Delete keycode 48 = colon semicolon Cyrillic_zhe Cyrillic_ZHE keycode 47 = apostrophe quotedbl Cyrillic_e Cyrillic_E keycode 130 = XF86Explorer keycode 121 = XF86AudioMute keycode 198 = XF86AudioMicMute keycode 122 = XF86AudioLowerVolume keycode 123 = XF86AudioRaiseVolume keycode 37 = Tab clear mod5 add mod5 = XF86Explorer keycode 166 = Prior keycode 167 = Next</code> </pre></div></div><br>  Ele usa coisas d√∫bias para a maioria dos usu√°rios, como transferir ctrl para caps-lock, tab para ctrl_l, alt_gr para menu e alternar o layout para a antiga posi√ß√£o altgr. <br><br>  Eu tamb√©m uso o xcape para emular pressionando escape com um √∫nico clique em ctrl_l.  Chamado assim: <br><br><pre> <code class="plaintext hljs"> xcape -t 1000 -e "Control_L=Escape"</code> </pre> <br>  Como eu prefiro temas escuros que s√£o mais confort√°veis ‚Äã‚Äã(tenho uma opini√£o, argumentam os r√°banos) em condi√ß√µes de pouca luz, mas geralmente precisam trabalhar sob a luz do dia, h√° um pequeno truque: as cores da imagem podem ser invertidas.  Para fazer isso, voc√™ precisa do programa xcalib: <br><br><pre> <code class="plaintext hljs">#apt install xcalib</code> </pre> <br>  Inverter: <br><br><pre> <code class="plaintext hljs">$xcalib -i -a</code> </pre> <br>  Voc√™ pode vincular a qualquer tecla de acesso conveniente usando o gerenciador de janelas.  Estou pendurado no Super_L + Backspace. <br><br><h2>  Sum√°rio </h2><br>  As impress√µes do dispositivo s√£o mais positivas que negativas.  N√£o me arrependo do dinheiro gasto.  O dispositivo n√£o ocupa muito espa√ßo na bolsa, cabe no bolso da cal√ßa cargo e na jaqueta de fuma√ßa. <br><br> <a href=""><img src="https://habrastorage.org/webt/xz/u5/a2/xzu5a2lnxboqgbrkw8chzh3zlzu.jpeg"></a> <br><br>  Funciona por muito tempo com a bateria, para o teste eu rolei tr√™s horas e meia de filmes com wifi ligado, descarregado em algum lugar pela metade.  Carrega de um banco de paver com usb-a atrav√©s de um adaptador de corrente alternada. <br><br>  Todas as curvulinas moles encontradas foram tratadas com sucesso. <br><br>  √â lament√°vel que n√£o exista uma porta rj45, mas espero que seja resolvida pelo adaptador encomendado com usb.  A falta de comunica√ß√µes m√≥veis e c√¢meras, agora, em condi√ß√µes de vigil√¢ncia total, acho um pouco mais. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt409945/">https://habr.com/ru/post/pt409945/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt409933/index.html">HiSilicon Kirin 970 Android SoC Review - Desempenho e Efici√™ncia</a></li>
<li><a href="../pt409935/index.html">A hist√≥ria "A vida √© alta"</a></li>
<li><a href="../pt409937/index.html">Triunfo e vida cotidiana. Como instalar uma torre em um arranha-c√©u em Lakhta Center. Parte 1</a></li>
<li><a href="../pt409939/index.html">Como Bezos resolveu um problema inesperado ao anunciar sua coluna inteligente</a></li>
<li><a href="../pt409943/index.html">Por que √© importante que as escolas dediquem mais tempo ao estudo da matem√°tica discreta</a></li>
<li><a href="../pt409947/index.html">Universo Superfluido: Mat√©ria Escura como Condensado de Bose-Einstein</a></li>
<li><a href="../pt409949/index.html">Big Bang quente e infla√ß√£o</a></li>
<li><a href="../pt409951/index.html">Painel de LED com WIFI Sonoff BN-SZ01</a></li>
<li><a href="../pt409953/index.html">Ataque card√≠aco e sepse em 10 minutos</a></li>
<li><a href="../pt409955/index.html">Tesla une 50.000 casas pobres no sul da Austr√°lia √† central el√©trica virtual de 250 MW</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>