<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòò üîπ üêå D√©veloppement de classes d'interface en C ++ ü¶é üêê üôèüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les classes d'interface sont tr√®s largement utilis√©es dans les programmes C ++. Mais, malheureusement, des erreurs sont souvent commises lors de l'imp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©veloppement de classes d'interface en C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427281/"><hr><p>  <i>Les classes d'interface sont tr√®s largement utilis√©es dans les programmes C ++.</i>  <i>Mais, malheureusement, des erreurs sont souvent commises lors de l'impl√©mentation de solutions bas√©es sur des classes d'interface.</i>  <i>L'article d√©crit comment concevoir correctement les classes d'interface; plusieurs options sont envisag√©es.</i>  <i>L'utilisation de pointeurs intelligents est d√©crite en d√©tail.</i>  <i>Un exemple d'impl√©mentation d'une classe d'exception et d'un mod√®le de classe de collection bas√© sur des classes d'interface est donn√©.</i> </p><hr><br><a name="habracut"></a><br><h1>  Table des mati√®res </h1><br><div class="spoiler">  <b class="spoiler_title">Table des mati√®res</b> <div class="spoiler_text"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1. Fonctions membres sp√©ciales, cr√©ation et suppression d'objets</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonctions sp√©ciales des membres</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ation et suppression d'objets - d√©tails de base</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Niveau d'acc√®s destructeur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ez et supprimez en un seul module</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suppression polymorphe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suppression lorsque la d√©claration de classe est incompl√®te</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2. Fonctions purement virtuelles et classes abstraites</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonctions virtuelles pures</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Classes abstraites</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Destructeur virtuel pur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3. Classes d'interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Impl√©mentations</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ation d'objets</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Supprimer un objet</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.3.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Utilisation de l'op√©rateur de suppression</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.3.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Utilisation d'une fonction virtuelle sp√©ciale</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.3.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Utilisation d'une fonction externe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.3.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suppression automatique √† l'aide du pointeur intelligent</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Autres options pour g√©rer la dur√©e de vie d'une instance d'une classe d'impl√©mentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Copier la s√©mantique</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Constructeur de classe d'interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interaction bidirectionnelle</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.8.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pointeurs intelligents</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.9.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonctions membres constantes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interfaces COM</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.11.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Classes d'interface et biblioth√®ques</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4. Un exemple de classe d'interface et son impl√©mentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Classe d'interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Classe d'impl√©mentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pointeurs intelligents standard</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.3.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ation c√¥t√© client</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.3.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ation c√¥t√© impl√©mentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Impl√©mentation alternative de la classe de base</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5. Exceptions et collections impl√©ment√©es √† l'aide de classes d'interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5.1 Exceptions</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5.2 Collections</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6. Classes d'interface et classes wrapper</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7. R√©sum√©</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les r√©f√©rences</a> <br></div></div><br><a name="id-introdaction"></a><br><h1>  Pr√©sentation </h1><br><p>  Une classe d'interface est une classe qui n'a pas de donn√©es et se compose principalement de fonctions purement virtuelles.  Cette solution vous permet de s√©parer compl√®tement l'impl√©mentation de l'interface - le client utilise la classe d'interface - √† un autre endroit, une classe d√©riv√©e est cr√©√©e dans laquelle les fonctions purement virtuelles sont red√©finies et la fonction d'usine est d√©finie.  Les d√©tails de l'impl√©mentation sont compl√®tement cach√©s au client.  De cette fa√ßon, une v√©ritable encapsulation est impl√©ment√©e, ce qui est impossible avec la classe habituelle.  Vous pouvez lire sur les classes d'interface de Scott Meyers [Meyers2].  Les classes d'interface sont √©galement appel√©es classes de protocole. </p><br><p>  L'utilisation de classes d'interface vous permet d'affaiblir les d√©pendances entre les diff√©rentes parties du projet, ce qui simplifie le d√©veloppement de l'√©quipe et r√©duit le temps de compilation / assemblage.  Les classes d'interface facilitent la mise en ≈ìuvre de solutions flexibles et dynamiques lorsque les modules sont charg√©s de mani√®re s√©lective lors de l'ex√©cution.  L'utilisation des classes d'interface en tant que biblioth√®que d'interface (API) (SDK) simplifie la solution des probl√®mes de compatibilit√© binaire. </p><br><p>  Les classes d'interface sont utilis√©es assez largement, avec leur aide, elles impl√©mentent l'interface (API) des biblioth√®ques (SDK), l'interface des plug-ins (plugins) et bien plus encore.  De nombreux mod√®les de Gang of Four [GoF] sont naturellement impl√©ment√©s √† l'aide de classes d'interface.  Les classes d'interface incluent les interfaces COM.  Mais, malheureusement, des erreurs sont souvent commises lors de l'impl√©mentation de solutions bas√©es sur des classes d'interface.  Essayons de clarifier ce probl√®me. </p><br><a name="id-1"></a><br><h1>  1. Fonctions membres sp√©ciales, cr√©ation et suppression d'objets </h1><br><p>  Cette section d√©crit bri√®vement un certain nombre de fonctionnalit√©s C ++ que vous devez conna√Ætre pour bien comprendre les solutions propos√©es pour les classes d'interface. </p><br><a name="id-1-1"></a><br><h2>  1.1.  Fonctions sp√©ciales des membres </h2><br><p>  Si le programmeur n'a pas d√©fini les fonctions membres de la classe dans la liste suivante - le constructeur par d√©faut, le constructeur de copie, l'op√©rateur d'affectation de copie, le destructeur - alors le compilateur peut le faire pour lui.  C ++ 11 a ajout√© un constructeur de d√©placement et un op√©rateur d'affectation de d√©placement √† cette liste.  Ces fonctions membres sont appel√©es fonctions membres sp√©ciales.  Ils ne sont g√©n√©r√©s que s'ils sont utilis√©s et des conditions suppl√©mentaires sp√©cifiques √† chaque fonction sont remplies.  Nous attirons l'attention sur le fait que cette utilisation peut s'av√©rer assez cach√©e (par exemple lors de l'impl√©mentation de l'h√©ritage).  Si la fonction requise ne peut pas √™tre g√©n√©r√©e, une erreur est g√©n√©r√©e.  (√Ä l'exception des op√©rations de relocalisation, elles sont remplac√©es par des op√©rations de copie.) Les fonctions membres g√©n√©r√©es par le compilateur sont publiques et int√©grables. </p><br><p>  Les fonctions membres sp√©ciales ne sont pas h√©rit√©es, si une fonction membre sp√©ciale est requise dans la classe d√©riv√©e, le compilateur essaiera toujours de la g√©n√©rer; la pr√©sence de la fonction membre correspondante d√©finie dans la classe de base par le programmeur n'affecte pas cela. </p><br><p> Le programmeur peut interdire la g√©n√©ration de fonctions membres sp√©ciales, en C ++ 11 il est n√©cessaire d'utiliser la construction <code>"=delete"</code> lors de la d√©claration, en C ++ 98 d√©clarer la fonction membre correspondante priv√©e et non d√©finir.  Dans l'h√©ritage de classe, l'interdiction de g√©n√©rer une fonction membre sp√©ciale faite dans la classe de base s'applique √† toutes les classes d√©riv√©es. </p><br><p>  Si le programmeur est √† l'aise avec les fonctions membres g√©n√©r√©es par le compilateur, alors en C ++ 11, il peut l'indiquer explicitement, et pas simplement supprimer la d√©claration.  Pour ce faire, vous devez utiliser la construction <code>"=default"</code> lors de la d√©claration, tandis que le code est mieux lu et que des fonctionnalit√©s suppl√©mentaires apparaissent li√©es √† la gestion du niveau d'acc√®s. </p><br><p>  Des d√©tails sur les fonctions sp√©ciales des membres peuvent √™tre trouv√©s dans [Meyers3]. </p><br><a name="id-1-2"></a><br><h2>  1.2.  Cr√©ation et suppression d'objets - d√©tails de base </h2><br><p>  La cr√©ation et la suppression d'objets √† l'aide des op√©rateurs <code>new/delete</code> est une op√©ration deux-en-un typique.  Lors de l'appel de <code>new</code> , la m√©moire est d'abord allou√©e √† l'objet.  Si la s√©lection r√©ussit, le constructeur est appel√©.  Si le constructeur l√®ve une exception, la m√©moire allou√©e est lib√©r√©e.  Lorsque l'op√©rateur de <code>delete</code> est appel√©, tout se passe dans l'ordre inverse: d'abord, le destructeur est appel√©, puis la m√©moire est lib√©r√©e.  Le destructeur ne doit pas lever d'exceptions. </p><br><p>  Si le <code>new</code> op√©rateur est utilis√© pour cr√©er un tableau d'objets, la m√©moire est d'abord allou√©e √† l'ensemble du tableau.  Si la s√©lection r√©ussit, le constructeur par d√©faut est appel√© pour chaque √©l√©ment du tableau √† partir de z√©ro.  Si un constructeur l√®ve une exception, alors pour tous les √©l√©ments cr√©√©s du tableau, le destructeur est appel√© dans l'ordre inverse de l'appel du constructeur, la m√©moire allou√©e est lib√©r√©e.  Pour supprimer un tableau, vous devez appeler l'op√©rateur <code>delete[]</code> (appel√© l'op√©rateur <code>delete</code> pour les tableaux), et pour tous les √©l√©ments du tableau, le destructeur est appel√© dans l'ordre inverse de l'appel du constructeur, puis la m√©moire allou√©e est lib√©r√©e. </p><br><p>  Attention!  Vous devez appeler la forme correcte de l'op√©rateur de <code>delete</code> , selon qu'un seul objet ou tableau est supprim√©.  Cette r√®gle doit √™tre strictement respect√©e, sinon vous pouvez obtenir un comportement ind√©fini, c'est-√†-dire que tout peut arriver: fuites de m√©moire, crash, etc.  Voir [Meyers2] pour plus de d√©tails. </p><br><p>  Les fonctions d'allocation de m√©moire standard ne <code>std::bad_alloc</code> √† satisfaire la requ√™te, <code>std::bad_alloc</code> une exception de type <code>std::bad_alloc</code> . </p><br><p>  Il est s√ªr d'appliquer n'importe quelle forme de l'op√©rateur de <code>delete</code> √† un pointeur nul. </p><br><p>  Dans la description ci-dessus, une clarification est n√©cessaire.  Pour les soi-disant types triviaux (types int√©gr√©s, structures de style C), le constructeur ne peut pas √™tre appel√© et le destructeur ne fait en aucun cas quoi que ce soit.  Voir √©galement la section 1.6. </p><br><a name="id-1-3"></a><br><h2>  1.3.  Niveau d'acc√®s destructeur </h2><br><p>  Lorsque l'op√©rateur de <code>delete</code> est appliqu√© √† un pointeur sur une classe, le destructeur de cette classe doit √™tre disponible au point d'appel de <code>delete</code> .  (Il existe une exception √† cette r√®gle, abord√©e dans la section 1.6.) Ainsi, en s√©curisant ou en fermant le destructeur, le programmeur interdit l'utilisation de l'op√©rateur de <code>delete</code> lorsque le destructeur n'est pas disponible.  Souvenez-vous que si aucun destructeur n'est d√©fini dans la classe, le compilateur le fera seul et ce destructeur sera ouvert (voir section 1.1). </p><br><a name="id-1-4"></a><br><h2>  1.4.  Cr√©ez et supprimez en un seul module </h2><br><p>  Si le <code>new</code> op√©rateur a cr√©√© un objet, alors l'op√©rateur de <code>delete</code> doit se trouver dans le m√™me module pour le <code>delete</code> .  Au figur√©, "mettez-le l√† o√π vous l'avez pris".  Cette r√®gle est bien connue, voir par exemple [Sutter / Alexandrescu].  Si cette r√®gle est viol√©e, une ¬´non-concordance¬ª des fonctions d'allocation et de lib√©ration de m√©moire peut se produire, ce qui, en r√®gle g√©n√©rale, entra√Æne une interruption anormale du programme. </p><br><a name="id-1-5"></a><br><h2>  1.5.  Suppression polymorphe </h2><br><p>  Si vous concevez une hi√©rarchie polymorphe de classes dont les instances sont supprim√©es √† l'aide de l'op√©rateur de <code>delete</code> , il doit y avoir un destructeur virtuel ouvert dans la classe de base, cela garantit que le destructeur du type r√©el de l'objet est appel√© lorsque l'op√©rateur de <code>delete</code> est appliqu√© au pointeur sur la classe de base.  Si cette r√®gle est viol√©e, un appel au destructeur de classe de base peut se produire, ce qui peut entra√Æner une fuite de ressources. </p><br><a name="id-1-6"></a><br><h2>  1.6.  Suppression lorsque la d√©claration de classe est incompl√®te </h2><br><p>  Le caract√®re omnivore de l'op√©rateur de <code>delete</code> peut cr√©er certains probl√®mes; il peut √™tre appliqu√© √† un pointeur de type <code>void*</code> ou √† un pointeur sur une classe qui a une d√©claration incompl√®te (pr√©emptive).  Dans ce cas, aucune erreur ne se produit, seul l'appel au destructeur est ignor√©, seule la fonction de lib√©ration de la m√©moire est appel√©e.  Prenons un exemple: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">//   X* CreateX(); void Foo() {    X* p = CreateX();    delete p; }</span></span></code> </pre> <br><p>  Ce code se compile m√™me si une d√©claration de classe <code>X</code> compl√®te n'est pas disponible sur le pair de <code>delete</code> num√©rotation.  Vrai, lors de la compilation (Visual Studio), un avertissement est √©mis: </p><br><p> <code>warning C4150: deletion of pointer to incomplete type 'X'; no destructor called</code> </p> <br><p>  S'il existe une impl√©mentation de <code>X</code> et <code>CreateX()</code> , le code est <code>CreateX()</code> , si <code>CreateX()</code> renvoie un pointeur vers l'objet cr√©√© par le <code>new</code> op√©rateur, alors l'appel <code>Foo()</code> correctement ex√©cut√©, le destructeur n'est pas appel√©.  Il est clair que cela peut conduire √† un √©puisement des ressources, donc encore une fois sur la n√©cessit√© de faire attention aux avertissements. </p><br><p>  Cette situation n'est pas farfelue, elle peut facilement survenir lors de l'utilisation de classes telles que des pointeurs intelligents ou des classes de descripteurs.  Scott Meyers traite de ce probl√®me dans [Meyers3]. </p><br><a name="id-2"></a><br><h1>  2. Fonctions purement virtuelles et classes abstraites </h1><br><p>  Le concept de classes d'interface est bas√© sur des concepts C ++ tels que les fonctions virtuelles pures et les classes abstraites. </p><br><a name="id-2-1"></a><br><h2>  2.1.  Fonctions virtuelles pures </h2><br><p>  Une fonction virtuelle d√©clar√©e √† l'aide de la construction <code>"=0"</code> est appel√©e virtuelle pure. </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">// ...    virtual void Foo() = 0; };</span></span></code> </pre> <br><p>  Contrairement √† une fonction virtuelle classique, une fonction purement virtuelle ne peut pas √™tre d√©finie (√† l'exception du destructeur, voir section 2.3), mais elle doit √™tre red√©finie dans l'une des classes d√©riv√©es. </p><br><p>  Des fonctions purement virtuelles peuvent √™tre d√©finies.  Emblem Sutter propose plusieurs utilisations utiles pour cette fonction [Shutter]. </p><br><a name="id-2-2"></a><br><h2>  2.2.  Classes abstraites </h2><br><p>  Une classe abstraite est une classe qui a au moins une fonction purement virtuelle.  Une classe d√©riv√©e d'une classe abstraite et ne rempla√ßant pas au moins une fonction purement virtuelle sera √©galement abstraite.  La norme C ++ interdit la cr√©ation d'instances d'une classe abstraite; vous ne pouvez cr√©er que des instances de d√©riv√©s de classes non abstraites.  Ainsi, une classe abstraite est cr√©√©e pour √™tre utilis√©e comme classe de base.  Par cons√©quent, si un constructeur est d√©fini dans une classe abstraite, alors cela n'a pas de sens de le rendre ouvert, il doit √™tre prot√©g√©. </p><br><a name="id-2-3"></a><br><h2>  2.3.  Destructeur virtuel pur </h2><br><p>  Dans certains cas, il est conseill√© de faire un destructeur virtuel pur.  Mais cette solution a deux fonctionnalit√©s. </p><br><ol><li>  Un destructeur purement virtuel doit √™tre d√©fini.  (La d√©finition par d√©faut est g√©n√©ralement utilis√©e, c'est-√†-dire en utilisant la construction <code>"=default"</code> .) Le destructeur de classe d√©riv√© appelle des destructeurs de classe de base tout au long de la cha√Æne d'h√©ritage et, par cons√©quent, la file d'attente est garantie d'atteindre la racine - un destructeur purement virtuel. </li><li>  Si le programmeur n'a pas red√©fini un destructeur virtuel pur dans la classe d√©riv√©e, le compilateur le fera pour lui (voir section 1.1).  Ainsi, une classe d√©riv√©e d'une classe abstraite avec un destructeur purement virtuel peut perdre son caract√®re abstrait sans √©craser explicitement le destructeur. </li></ol><br><p>  Un exemple d'utilisation d'un destructeur virtuel pur peut √™tre trouv√© dans la section 4.4. </p><br><a name="id-3"></a><br><h1>  3. Classes d'interface </h1><br><p>  Une classe d'interface est une classe abstraite qui n'a pas de donn√©es et se compose principalement de fonctions purement virtuelles.  Une telle classe peut avoir des fonctions virtuelles ordinaires (non purement virtuelles), par exemple, un destructeur.  Il peut √©galement y avoir des fonctions membres statiques, telles que des fonctions d'usine. </p><br><a name="id-3-1"></a><br><h2>  3.1.  Impl√©mentations </h2><br><p>  Une impl√©mentation d'une classe d'interface sera appel√©e une classe d√©riv√©e dans laquelle des fonctions purement virtuelles sont red√©finies.  Il peut y avoir plusieurs impl√©mentations de la m√™me classe d'interface, et deux sch√©mas sont possibles: horizontal, lorsque plusieurs classes diff√©rentes h√©ritent de la m√™me classe d'interface, et vertical, lorsque la classe d'interface est la racine de la hi√©rarchie polymorphe.  Bien s√ªr, il peut y avoir des hybrides. </p><br><p>  Le point cl√© du concept de classes d'interface est la s√©paration compl√®te de l'interface de l'impl√©mentation - le client ne travaille qu'avec la classe d'interface, l'impl√©mentation n'est pas disponible pour elle. </p><br><a name="id-3-2"></a><br><h2>  3.2.  Cr√©ation d'objets </h2><br><p>  L'inaccessibilit√© de la classe d'impl√©mentation provoque certains probl√®mes lors de la cr√©ation d'objets.  Le client doit cr√©er une instance de la classe d'impl√©mentation et obtenir un pointeur sur la classe d'interface via laquelle l'objet sera accessible.  √âtant donn√© que la classe d'impl√©mentation n'est pas disponible, vous ne pouvez pas utiliser le constructeur, par cons√©quent, la fonction d'usine est utilis√©e, qui est d√©finie du c√¥t√© de l'impl√©mentation.  Cette fonction cr√©e g√©n√©ralement un objet √† l'aide du <code>new</code> op√©rateur et renvoie un pointeur sur l'objet cr√©√©, transtyp√© en pointeur sur une classe d'interface.  Une fonction de fabrique peut √™tre un membre statique d'une classe d'interface, mais elle n'est pas n√©cessaire, par exemple, elle peut √™tre membre d'une classe de fabrique sp√©ciale (qui, √† son tour, peut elle-m√™me √™tre une classe d'interface) ou une fonction libre.  Une fonction d'usine peut renvoyer non pas un pointeur brut vers une classe d'interface, mais un pointeur intelligent.  Cette option est discut√©e dans les sections 3.3.4 et 4.3.2. </p><br><a name="id-3-3"></a><br><h2>  3.3.  Supprimer un objet </h2><br><p>  La suppression d'un objet est une op√©ration extr√™mement critique.  Une erreur entra√Æne une fuite de m√©moire ou une double suppression, ce qui entra√Æne g√©n√©ralement un plantage du programme.  Ci-dessous, ce probl√®me est consid√©r√© aussi d√©taill√© que possible, avec une grande attention port√©e √† la pr√©vention des actions erron√©es des clients. </p><br><p>  Il existe quatre options principales: </p><br><ol><li>  Utilisation de l'op√©rateur de <code>delete</code> . </li><li>  Utilisation d'une fonction virtuelle sp√©ciale. </li><li>  Utilisation d'une fonction externe. </li><li>  Suppression automatique √† l'aide du pointeur intelligent. </li></ol><br><a name="id-3-3-1"></a><br><h3>  3.3.1.  Utilisation de l'op√©rateur de <code>delete</code> <br></h3><br><p>  Pour ce faire, vous devez avoir un destructeur virtuel ouvert dans la classe d'interface.  Dans ce cas, l'op√©rateur de <code>delete</code> , appel√© pour un pointeur vers une classe d'interface c√¥t√© client, fournit un appel au destructeur de la classe d'impl√©mentation.  Cette option peut fonctionner, mais il est difficile de la reconna√Ætre comme r√©ussie.  Nous recevons des appels des <code>new</code> op√©rateurs et <code>delete</code> diff√©rents c√¥t√©s de la ¬´barri√®re¬ª, <code>new</code> du c√¥t√© de l'impl√©mentation, <code>delete</code> du c√¥t√© client.  Et si l'impl√©mentation de la classe d'interface se fait dans un module s√©par√© (ce qui est assez courant), alors nous obtenons une violation de la r√®gle de la section 1.4. </p><br><a name="id-3-3-2"></a><br><h3>  3.3.2.  Utilisation d'une fonction virtuelle sp√©ciale </h3><br><p>  Plus progressive est une autre option: la classe d'interface doit avoir une fonction virtuelle sp√©ciale qui supprime l'objet.  Une telle fonction, au final, revient √† appeler <code>delete this</code> , mais cela se produit d√©j√† du c√¥t√© de l'impl√©mentation.  Une telle fonction peut √™tre appel√©e de diff√©rentes mani√®res, par exemple, <code>Delete()</code> , mais d'autres options sont √©galement utilis√©es: <code>Release()</code> , <code>Destroy()</code> , <code>Dispose()</code> , <code>Free()</code> , <code>Close()</code> , etc.  En plus de suivre la r√®gle de la section 1.4, cette option pr√©sente plusieurs avantages suppl√©mentaires. </p><br><ol><li>  Vous permet d'utiliser des fonctions personnalis√©es d'allocation / d√©sallocation de m√©moire pour la classe d'impl√©mentation. </li><li>  Vous permet d'impl√©menter un sch√©ma plus complexe pour contr√¥ler la dur√©e de vie de l'objet d'impl√©mentation, par exemple, √† l'aide d'un compteur de r√©f√©rence. </li></ol><br><p>  Dans ce mode de r√©alisation, une tentative de suppression d'un objet √† l'aide de l'op√©rateur de <code>delete</code> peut √™tre compil√©e et m√™me effectu√©e, mais il s'agit d'une erreur.  Pour l'emp√™cher dans la classe d'interface, il suffit d'avoir un destructeur prot√©g√© vide ou purement virtuel (voir section 1.3).  Notez que l'utilisation de l'op√©rateur de <code>delete</code> peut √™tre assez masqu√©e, par exemple, les pointeurs intelligents standard utilisent l'op√©rateur de suppression pour supprimer un objet par d√©faut et le code correspondant est profond√©ment enfoui dans leur impl√©mentation.  Un destructeur prot√©g√© vous permet de d√©tecter toutes ces tentatives au stade de la compilation. </p><br><a name="id-3-3-3"></a><br><h3>  3.3.3.  Utilisation d'une fonction externe </h3><br><p>  Cette option peut attirer une certaine sym√©trie des proc√©dures de cr√©ation et de suppression d'un objet, mais en r√©alit√© elle n'a aucun avantage par rapport √† la version pr√©c√©dente, mais il existe de nombreux probl√®mes suppl√©mentaires.  Cette option n'est pas recommand√©e pour une utilisation et n'est pas envisag√©e √† l'avenir. </p><br><a name="id-3-3-4"></a><br><h3>  3.3.4.  Suppression automatique √† l'aide du pointeur intelligent </h3><br><p>  Dans ce cas, la fonction d'usine ne renvoie pas un pointeur brut vers une classe d'interface, mais un pointeur intelligent correspondant.  Ce pointeur intelligent est cr√©√© c√¥t√© impl√©mentation et encapsule l'objet de suppression, qui supprime automatiquement l'objet impl√©mentation lorsque le pointeur intelligent (ou sa derni√®re copie) sort du domaine c√¥t√© client.  Dans ce cas, une fonction virtuelle sp√©ciale pour supprimer l'objet d'impl√©mentation peut ne pas √™tre requise, mais un destructeur prot√©g√© est toujours n√©cessaire, il est n√©cessaire d'emp√™cher l'utilisation erron√©e de l'op√©rateur de <code>delete</code> .  (Certes, il convient de noter que la probabilit√© d'une telle erreur est sensiblement r√©duite.) Cette option est examin√©e plus en d√©tail √† la section 4.3.2. </p><br><a name="id-3-4"></a><br><h2>  3.4.  Autres options pour g√©rer la dur√©e de vie d'une instance d'une classe d'impl√©mentation </h2><br><p>  Dans certains cas, le client peut recevoir un pointeur vers la classe d'interface, mais ne le poss√®de pas.  La gestion de la dur√©e de vie de l'objet d'impl√©mentation est enti√®rement du c√¥t√© de l'impl√©mentation.  Par exemple, un objet peut √™tre un objet singleton statique (cette solution est typique pour les usines).  Un autre exemple est li√© √† l'interaction bidirectionnelle, voir la section 3.7.  Le client ne doit pas supprimer un tel objet, mais un destructeur prot√©g√© pour une telle classe d'interface est n√©cessaire, il est n√©cessaire d'emp√™cher l'utilisation erron√©e de l'op√©rateur de <code>delete</code> . </p><br><a name="id-3-5"></a><br><h2>  3.5.  Copier la s√©mantique </h2><br><p>  Pour une classe d'interface, la cr√©ation d'une copie de l'objet d'impl√©mentation √† l'aide du constructeur de copie n'est pas possible, donc si la copie est requise, la classe doit avoir une fonction virtuelle qui cr√©e une copie de l'objet d'impl√©mentation et renvoie un pointeur vers la classe d'interface.  Une telle fonction est souvent appel√©e constructeur virtuel et son nom traditionnel est <code>Clone()</code> ou <code>Duplicate()</code> . </p><br><p>  L'utilisation de l'op√©rateur d'affectation de copie n'est pas interdite, mais ne peut pas √™tre consid√©r√©e comme une bonne id√©e.  L'op√©rateur d'affectation de copie est toujours associ√©; il doit √™tre associ√© au constructeur de copie.  L'op√©rateur g√©n√©r√© par le compilateur par d√©faut n'a pas de sens, il ne fait rien.  Il est th√©oriquement possible de d√©clarer un op√©rateur d'affectation purement virtuel avec red√©finition ult√©rieure, mais l'affectation virtuelle n'est pas une pratique recommand√©e, des d√©tails peuvent √™tre trouv√©s dans [Meyers1].  De plus, l'affectation semble tr√®s peu naturelle: l'acc√®s aux objets de la classe d'impl√©mentation se fait g√©n√©ralement via un pointeur vers la classe d'interface, donc l'affectation ressemblera √† ceci: </p><br><pre> <code class="cpp hljs">* = *;</code> </pre> <br><p>  Il est pr√©f√©rable d'interdire √† l'op√©rateur d'affectation, et si n√©cessaire, une telle s√©mantique a dans la classe d'interface la fonction virtuelle correspondante. </p><br><p>  Il existe deux fa√ßons d'interdire l'attribution. </p><br><ol><li>  D√©clarez l'op√©rateur d'affectation supprim√© ( <code>=delete</code> ).  Si les classes d'interface forment une hi√©rarchie, cela suffit pour le faire dans la classe de base.  L'inconv√©nient de cette m√©thode est qu'elle affecte la classe d'impl√©mentation, l'interdiction s'y applique √©galement. </li><li>  D√©clarez une instruction d'affectation prot√©g√©e avec une d√©finition par d√©faut ( <code>=default</code> ).  Cela n'affecte pas la classe d'impl√©mentation, mais dans le cas d'une hi√©rarchie de classes d'interface, une telle annonce doit √™tre faite dans chaque classe. </li></ol><br><a name="id-3-6"></a><br><h2>  3.6.  Constructeur de classe d'interface </h2><br><p>  Souvent, le constructeur d'une classe d'interface n'est pas d√©clar√©.  Dans ce cas, le compilateur g√©n√®re le constructeur par d√©faut n√©cessaire pour impl√©menter l'h√©ritage (voir section 1.1).  Ce constructeur est ouvert, bien que suffisant pour √™tre s√©curis√©.  Si dans la classe d'interface le constructeur copiant est d√©clar√© supprim√© ( <code>=delete</code> ), alors la g√©n√©ration par le compilateur du constructeur est supprim√©e par d√©faut, et un tel constructeur doit √™tre explicitement d√©clar√©.  Il est naturel de le s√©curiser avec une d√©finition par d√©faut ( <code>=default</code> ).  En principe, la d√©claration d'un tel constructeur prot√©g√© peut toujours se faire.  Un exemple est dans la section 4.4. </p><br><a name="id-3-7"></a><br><h2>  3.7.  Interaction bidirectionnelle </h2><br><p>  Les classes d'interface sont pratiques pour utiliser la communication bidirectionnelle.  Si certains modules sont accessibles via des classes d'interface, le client peut √©galement cr√©er des impl√©mentations de certaines classes d'interface et leur transmettre des pointeurs dans le module.  Gr√¢ce √† ces pointeurs, le module peut recevoir des services du client et √©galement transmettre des donn√©es ou des notifications au client. </p><br><a name="id-3-8"></a><br><h2>  3.8.  Pointeurs intelligents </h2><br><p>  √âtant donn√© que l'acc√®s aux objets de la classe d'impl√©mentation se fait g√©n√©ralement via un pointeur, il est naturel d'utiliser des pointeurs intelligents pour contr√¥ler leur dur√©e de vie.  Mais il faut garder √† l'esprit que si la deuxi√®me option pour supprimer des objets est utilis√©e, alors avec le pointeur intelligent standard, il est n√©cessaire de transf√©rer un suppresseur utilisateur (type) ou une instance de ce type.  Si cela n'est pas fait, le pointeur intelligent utilisera l'op√©rateur de suppression pour supprimer l'objet, et le code ne sera tout simplement pas compil√© (gr√¢ce au destructeur prot√©g√©).  Les pointeurs intelligents standard (y compris l'utilisation de dissolvants personnalis√©s) sont discut√©s en d√©tail dans [Josuttis], [Meyers3].  Un exemple d'utilisation d'un d√©capant personnalis√© peut √™tre trouv√© dans la section 4.3.1. </p><br><p>      ,       ,      ,    . </p><br><a name="id-3-9"></a><br><h2>  3.9.  - </h2><br><p>     -    const.              ,  ,    -,       . </p><br><a name="id-3-10"></a><br><h2>  3.10. COM- </h2><br><p> COM-    ,     ,  COM ‚Äî      ,  COM-     ,   C,    ,   .  COM-  C++      ,   COM. </p><br><a name="id-3-11"></a><br><h2>  3.11.     </h2><br><p>         (API)    (SDK).       .    -,      -,           .     ,     (Windows DLL),     :  -.          .        ,  ,       .     <code>LoadLibrary()</code>      ,    -,       . </p><br><a name="id-4"></a><br><h1> 4.       </h1><br><a name="id-4-1"></a><br><h2>  4.1.   </h2><br><p>       ,      . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IBase() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   public:    virtual void Delete() = 0; //      IBase&amp; operator=(const IBase&amp;) = delete; //   };</span></span></code> </pre> <br><p>    . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IActivatable</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IBase { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    ~IActivatable() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   public:    virtual void Activate(bool activate) = 0;    static IActivatable* CreateInstance(); // - };</span></span></code> </pre> <br><p> ,         ,     .     ,           <code>IBase</code> .     ,            (.  1.3).       ,       . </p><br><a name="id-4-2"></a><br><h2>  4.2.   </h2><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activator</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IActivatable { <span class="hljs-comment"><span class="hljs-comment">// ... private:    Activator(); protected:    ~Activator(); public:    void Delete() override;    void Activate(bool activate) override;    friend IActivatable* IActivatable::CreateInstance(); }; Activator::Activator() {/* ... */} Activator::~Activator() {/* ... */} void Activator::Delete() { delete this; } void Activator::Activate(bool activate) {/* ... */} IActivatable* IActivatable::CreateInstance() {    return static_cast&lt;IActivatable*&gt;(new Activator()); }</span></span></code> </pre> <br><p>      , ,        ,  -  ,         . </p><br><a name="id-4-3"></a><br><h2>  4.3.    </h2><br><a name="id-4-3-1"></a><br><h3> 4.3.1.     </h3><br><p>           . -   (     <code>IBase</code> ): </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseDeleter</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IBase* p)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ p-&gt;Delete(); } };</code> </pre> <br><p>  <code>std::unique_ptr&lt;&gt;</code> -   : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">&gt; // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class"> ‚Äî  </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UniquePtr</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">:</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">unique_ptr</span></span>&lt;I, BaseDeleter&gt;;</code> </pre> <br><p> ,   ,  -   ,  <code>UniquePtr</code>    . </p><br><p>   -: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">&gt; // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class"> ‚Äî  - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateInstance</span></span></span><span class="hljs-class">() </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UniquePtr</span></span></span><span class="hljs-class">&lt;I&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateInstance</span></span></span><span class="hljs-class">() {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UniquePtr&lt;I&gt;(I::CreateInstance()); }</code> </pre> <br><p>        : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">&gt; // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class"> ‚Äî  </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UniquePtr</span></span></span><span class="hljs-class">&lt;I&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToPtr</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">) {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UniquePtr&lt;I&gt;(p); }</code> </pre> <br><p>  <code>std::shared_ptr&lt;&gt;</code>    <code>std::unique_ptr&lt;&gt;</code> ,   ,  <code>std::shared_ptr&lt;&gt;</code>   .      <code>Activator</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> un1 = CreateInstance&lt;IActivatable&gt;(); un1-&gt;Activate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> un2 = ToPtr(IActivatable::CreateInstance()); un2-&gt;Activate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;IActivatable&gt; sh = CreateInstance&lt;IActivatable&gt;(); sh-&gt;Activate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre> <br><p>          (     ‚Äî -): </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;IActivatable&gt; sh2(IActivatable::CreateInstance());</code> </pre> <br><p>     <code>std::make_shared&lt;&gt;()</code> ,      (    ). </p><br><p>    :          ,     .     :     ,  - .     4.4. </p><br><a name="id-4-3-2"></a><br><h3> 4.3.2.     </h3><br><p>       .           -.   <code>std::shared_ptr&lt;&gt;</code>         ,    ,      (         ).     <code>std::shared_ptr&lt;&gt;</code> (  )  -  ,           <code>delete</code>     .  <code>std::shared_ptr&lt;&gt;</code> -       (   )   -      .        . </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class IActivatable; using ActPtr = std::shared_ptr&lt;IActivatable&gt;; //   class IActivatable { protected:    virtual ~IActivatable() = default; //      IActivatable&amp; operator=(const IActivatable&amp;) = default; //   public:    virtual void Activate(bool activate) = 0;    static ActPtr CreateInstance(); // - }; //   class Activator : public IActivatable { // ... public:    Activator();  //      ~Activator(); //      void Activate(bool activate) override; }; Activator::Activator() {/* ... */} Activator::~Activator() {/* ... */} void Activator::Activate(bool activate) {/* ... */} ActPtr IActivatable::CreateInstance() {    return ActPtr(new Activator()); }</span></span></span></span></code> </pre> <br><p>  -        <code>std::make_shared&lt;&gt;()</code> : </p><br><pre> <code class="cpp hljs">ActPtr IActivatable::CreateInstance() {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;Activator&gt;(); }</code> </pre> <br><p>      <code>std::unique_ptr&lt;&gt;</code> ,        , -   ,        . </p><br><a name="id-4-4"></a><br><h2> 4.4.     </h2><br><p>    C#  Java  C++    ¬´¬ª,       .        .      <code>IBase</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    IBase() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IBase() = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ,       virtual void Delete(); //   public:    IBase(const IBase&amp;) = delete;            //      IBase&amp; operator=(const IBase&amp;) = delete; //      struct Deleter        // -    {        void operator()(IBase* p) const { p-&gt;Delete(); }    };    friend struct IBase::Deleter; };</span></span></code> </pre> <br><p>     , <code>Delete()</code>    ,     . </p><br><pre> <code class="cpp hljs">IBase::~IBase() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> IBase::Delete() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br><p>      <code>IBase</code> .         <code>Delete()</code> ,              . -      <code>IBase</code> . <code>Delete()</code>  , - .     <code>Delete()</code>         ,    .       ,    4.3.1. </p><br><a name="id-5"></a><br><h1> 5.   ,      </h1><br><a name="id-5-1"></a><br><h2> 5.1  </h2><br><p>  ,    ,   ,      ,        . </p><br><p>   ,  ,    <code>IException</code>    <code>Exception</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IException</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">friend</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class">;</span></span>    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> IException* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IException() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">What</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    IException&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> IException&amp;) = <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class"> {</span></span>    IException* <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> m_Ptr; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    Exception(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code);    Exception(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Exception&amp; src) : m_Ptr(src.m_Ptr-&gt;Clone()) {}    ~Exception() { m_Ptr-&gt;Delete(); }    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> IException* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ptr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_Ptr; } };</code> </pre> <br><p>         <code>Exception</code> ,            <code>IException</code> .       ,    <code>throw</code> ,   .    <code>Exception</code>      ,      .  -      ,   . </p><br><p>  <code>Exception</code> , ,  . </p><br><p>   <code>IException</code> : </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExcImpl</span></span></span><span class="hljs-class"> :</span></span> IException {    <span class="hljs-keyword"><span class="hljs-keyword">friend</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class">;</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> m_What;    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m_Code;    ExcImpl(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code);    ExcImpl(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ExcImpl&amp;) = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;    <span class="hljs-function"><span class="hljs-function">IException* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    ~ExcImpl() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">What</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>; }; ExcImpl::ExcImpl(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code)    : m_What(what), m_Code(code) {} IException* ExcImpl::Clone() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExcImpl(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ExcImpl::Delete() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* ExcImpl::What() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_What.c_str(); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ExcImpl::Code() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_Code; }</code> </pre> <br><p>   <code>Exception</code> : </p><br><pre> <code class="cpp hljs">Exception::Exception(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code)    : m_Ptr(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExcImpl(what, code)) {}</code> </pre> <br><p>    ,       ‚Äî .NET ‚Äî  , ‚Äî          ,     C++/CLI.  ,        ,     ,   C++/CLI. </p><br><a name="id-5-2"></a><br><h2> 5.2  </h2><br><p>   -    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICollect</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~ICollect() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ICollect&lt;T&gt;* Clone() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsEmpty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> T&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ind)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> T&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ind)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    ICollect&lt;T&gt;&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ICollect&lt;T&gt;&amp;) = <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>; };</code> </pre> <br><p>        ,             -,        . </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICollect</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterator</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Contain</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> ICollect&lt;T&gt; CollType;    CollType* m_Coll; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> T value_type;    Contain(CollType* coll);    ~Contain(); <span class="hljs-comment"><span class="hljs-comment">//     Contain(const Contain&amp; src);    Contain&amp; operator=(const Contain&amp; src); //     Contain(Contain&amp;&amp; src);    Contain&amp; operator=(Contain&amp;&amp; src);    bool mpty() const;    int size() const;    T&amp; operator[](int ind);    const T&amp; operator[](int ind) const;    Iterator&lt;T&gt; begin();    Iterator&lt;T&gt; end(); };</span></span></code> </pre> <br><p>      .   ,       . ,      ,    ,     ,    - <code>begin()</code>  <code>end()</code> ,   .           (. [Josuttis]),         <code>for</code>   .                .            , ,      . </p><br><a name="id-6"></a><br><h1> 6.    - </h1><br><p>       .         -,      .          .   ,         ++.              ,   .NET, Java  Pyton.              .      ,  ,         .   .NET Framework     C++/CLI          C++.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </p><br><a name="id-conclusion"></a><br><h1> 7.  </h1><br><p>      -,         . </p><br><p>         . </p><br><ol><li>   <code>delete</code> . </li><li>    . </li><li>      . </li></ol><br><p>          . </p><br><p>         ,       <code>delete</code> .                ,      . </p><br><p>    -   ,           .             ,    ,      <code>delete</code> . </p><br><p>             . </p><br><p>      ,          ,     ,  ,       . </p><br><br><a name="id-refs"></a><br><h1>  Les r√©f√©rences </h1><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[GoF] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gamma E., Helm R., Johnson R., Vlissides J. M√©thodes de conception orient√©e objet. </font><font style="vertical-align: inherit;">Mod√®les de conception.: Per. </font><font style="vertical-align: inherit;">de l'anglais </font><font style="vertical-align: inherit;">- Saint-P√©tersbourg: Peter, 2001.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Josuttis] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Josattis, Nikolai M. C ++ Standard Library: Reference Guide, 2nd ed.: Per. </font><font style="vertical-align: inherit;">de l'anglais </font><font style="vertical-align: inherit;">- M.: LLC ¬´I.D. </font><font style="vertical-align: inherit;">Williams, 2014.</font></font></p><br><p> [Dewhurst] <br> ,  .   C++.         .: .  . ‚Äî .:  , 2012. </p><br><p> [Meyers1] <br> , .    C++. 35        .: .  . ‚Äî .:  , 2000. </p><br><p> [Meyers2] <br> , .   C++. 55        .: .  . ‚Äî .:  , 2014. </p><br><p> [Meyers3] <br> , .    C++: 42    C++11  C++14.: .  . ‚Äî .:  ¬´.. ¬ª, 2016. </p><br><p> [Sutter] <br> , .     C++.: .  . ‚Äî :  ¬´.. ¬ª, 2015. </p><br><p> [Sutter/Alexandrescu] <br> , . , .    ++.: .  . ‚Äî .:  ¬´.. ¬ª, 2015. </p><br></div></div><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427281/">https://habr.com/ru/post/fr427281/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427271/index.html">Histoire et exp√©rience de l'utilisation de la traduction automatique. Conf√©rence Yandex</a></li>
<li><a href="../fr427273/index.html">L'intelligence artificielle peut-elle laisser les bookmakers sans travail?</a></li>
<li><a href="../fr427275/index.html">Architecture de l'information Internet, partie 3</a></li>
<li><a href="../fr427277/index.html">Un sch√©ma de diffraction se retrouve dans la distribution des nombres premiers, similaire √† celui des quasi-cristaux</a></li>
<li><a href="../fr427279/index.html">CoLaboratoire: Android Night #Apple</a></li>
<li><a href="../fr427283/index.html">Comment la haute disponibilit√© chez Kubernetes est assur√©e</a></li>
<li><a href="../fr427285/index.html">√âcole sur les bases des circuits num√©riques: Novossibirsk - Ok, Krasnoyarsk - pr√©parez-vous</a></li>
<li><a href="../fr427289/index.html">Mod√©lisation g√©ologique 3D, diagraphie et technologie d'Aramco Innovations</a></li>
<li><a href="../fr427291/index.html">R√©duisez le trafic dans les formulaires Web ASP.NET, les div cliquables et les interrogations p√©riodiques du serveur</a></li>
<li><a href="../fr427293/index.html">Mod√®les de conception JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>