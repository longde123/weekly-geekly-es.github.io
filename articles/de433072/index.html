<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏓 👦🏼 🍄 So hacken Sie den Kopierschutz der Sega Dreamcast-Konsole 🔬 👩🏾‍🍳 👐🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nach der Veröffentlichung des DOOM Black Book machte ich Urlaub in Japan, wo ich es schaffte, Ikaruga auf einem echten Arcade-Automaten im Taito HEY-S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So hacken Sie den Kopierschutz der Sega Dreamcast-Konsole</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433072/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/75/nh/l3/75nhl327vyzpklsanxeb3yb9tsw.png"></div><br>  Nach der Veröffentlichung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DOOM Black Book machte</a> ich Urlaub in Japan, wo ich es schaffte, Ikaruga auf einem echten Arcade-Automaten im Taito HEY-Spielzimmer im Akihabara-Viertel von Tokio zu spielen.  Diese Erfahrung hat mein Interesse an der neuesten SEGA-Videospielkonsole - Dreamcast - wiederbelebt. <br><br>  Im Netzwerk finden Sie viele Dokumente, die das Studium des Problems erheblich erleichtern.  Es gibt zwei hervorragende Ressourcen, mit denen jeder schnell auf den neuesten Stand gebracht werden kann: die wunderbare Marcus Comstedt-Website, auf der alles bis auf die GPU-Register beschrieben wird, und Jockels Ressource <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Lassen Sie uns ein Spiel für Sega Dreamcast von Grund auf neu erstellen</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">“</a> <br><br>  Als ich das Auto studierte, entdeckte ich eine erstaunliche Geschichte darüber, wie Hacker den Schutz von Kopien von Spielen schnell aufbrachen und die neuesten Hardware-Hoffnungen von SEGA ruinierten. <br><a name="habracut"></a><br><h2>  Erste Schutzstufe: GD-ROM </h2><br>  Auf dem Papier sah der Kopierschutz für SEGA Dreamcast sehr stark aus.  Die Spiele wurden auf einem speziellen Medium namens GD-ROM ausgeliefert, das nur SEGA produzieren konnte.  GD steht für "Gigabyte Disc" ("Gigabyte Disk"), dh die erhöhte Aufnahmedichte ergab ein maximales Volumen von 1 GB, was viel mehr war als die Fähigkeiten einer herkömmlichen CD-ROM (700 MB). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c59/3dc/d90/c593dcd90243f19b05b025685883c7de.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/797/044/2e8/7970442e84c49259e3a534c34a2909e0.svg" alt="Bild"></div><br>  Die GD-ROM hatte die gleichen physischen Abmessungen wie die CD-ROM, bestand jedoch auf Makroebene aus zwei Bereichen, die mit bloßem Auge unterscheidbar waren. <br><br>  Die erste (dunkle) Zone ist eine CD-ROM-kompatible Region mit niedriger Dichte, die bis zu 35 MB enthält.  Es enthielt eine Sprach-Audiospur, die den Benutzer daran erinnerte, dass der Inhalt der Disc für SEGA Dreamcast und nicht für einen CD-Player bestimmt war <sup>[1]</sup> .  Außerdem fügte der Entwickler dort einen Titel mit Textdateien hinzu, z. B. Copyright-Informationen und manchmal Werbematerialien, z. B. Kunst aus dem Spiel. <br><br>  Der Bereich mit hoher Dichte (Licht) wurde bis zu 984 MB <sup>[2]</sup> gespeichert und der gesamte Inhalt des Spiels befand sich darauf. <br><br>  Für die Hacker schien es unmöglich, das Spiel von der Festplatte zu werfen und es erneut zur Verteilung zu brennen. <br><br><h2>  Booten von GD-ROM: IP.BIN und 1ST_READ.BIN </h2><br>  Bevor wir darüber sprechen, wie Piraten es geschafft haben, Spiele zu kopieren, müssen wir die Ladesequenz verstehen.  Dreamcast hatte kein Betriebssystem.  Es gibt ein weit verbreitetes Missverständnis, dass Windows CE verwendet wurde. Tatsächlich war Microsoft OS jedoch nur eine zusätzliche statische Bibliothek, mit der Dreamcast-Entwickler eine Verbindung herstellen konnten, um DirectX, DirectInput und DirectSound zu verwenden <sup>[3]</sup> .  In einigen Spielen wurde WinCE verwendet <sup>[4]</sup> , aber in den meisten (zum Beispiel Ikaruga) wurde es nicht verwendet.  Unabhängig davon, was der Entwickler verwendet hat, wurde ein Spiel mit einem vollständig verbundenen Betriebssystem und Dreamcast immer auf die gleiche Weise gestartet. <br><br>  Während des normalen Gebrauchs und des Starts des offiziellen Spiels im neu aktivierten Dreamcast wurde BOOTROM gestartet und das Bootstrap-Programm von der GD-ROM in den RAM geladen.  Dieses winzige Programm, das sich auf der letzten GD-ROM-Spur befindet und der Community als „IP.BIN“ bekannt ist, zeigte einen SEGA-lizenzierten Bildschirm an und führte zwei Startebenen durch, um Hardwareregister einzurichten, einen CPU-Stack zu erstellen und VBR zu initialisieren <sup>[5]</sup> . <br><br>  Noch wichtiger ist, dass IP.BIN den Namen der ausführbaren Spieldatei enthielt.  Dieser Name wurde im GD-ROM-Dateisystem gesucht und um 0x8C010000 in den RAM geladen, wonach das Programm dorthin übertragen wurde.  In der Regel wurde die ausführbare Datei "1ST_READ.BIN" genannt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14f/fac/4a7/14ffac4a70c0af94444f819b03acf2af.svg"></div><br>  Nachdem die CPU die Adresse 0x8C010000 erreicht hatte, wurde das Spiel wie gewünscht gestartet. <br><br><h2>  Zweite Schutzstufe: Scrambler-Ransomware </h2><br>  Die theoretische Möglichkeit des Hackens ergab sich aus der scheinbar unbedeutenden Fähigkeit von Dreamcast, nicht von GD-ROM, sondern von CD-ROM zu booten.  Ursprünglich war diese als „MIL-CD“ bezeichnete Funktion zum Hinzufügen von Multimedia-Funktionen zu Musik-CDs konzipiert, wurde jedoch mit Ausnahme von sieben Karaoke-Anwendungen praktisch nicht verwendet. <br><br>  Die SEGA-Ingenieure haben verstanden, dass das Laden einer MIL-CD als Angriffsvektor verwendet werden kann, und haben daher zusätzlichen Schutz geboten.  Als die Konsole die CD-ROM erkannte, lud BOOTROM IP.BIN auf die übliche Weise, verschlüsselte jedoch 1ST_READ.BIN auf den ersten Blick zufällig.  Die funktionierende ausführbare Datei verwandelte sich in einen chaotischen Hash, der dazu führte, dass die Konsole einfrierte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/377/512/b26/377512b26e5672bd9f78bc904dc9715d.svg"></div><br>  Unter diesem Gesichtspunkt schien die Konsole zuverlässig geschützt zu sein.  Dreamcast konnte eine Raubkopie des Spiels erkennen, die ausführbare Datei während des Downloadvorgangs beschädigen und die Piraten besiegen. <br><br><h2>  Serviere mein langes Schwert! </h2><br>  Das Problem mit der beschädigten Datei wurde behoben, als Ende 1999 das Katana SDK (offizielles Sega SDK für Dreamcast) vom Utopia-Hackerteam gestohlen wurde <sup>[6]</sup> .  Es stellte sich heraus, dass der Scrambler nichts anderes als eine Implementierung des Prinzips „Sicherheit durch Dunkelheit“ war.  Das SDK enthielt einen Reverse-Scrambler, der die korrekte ausführbare Datei in einen "Rückwärts-Hash" verwandelte, der nach dem Laden und Verwürfeln mit der Dreamcast-Konsole beim Booten von einer CD-ROM wieder zu einer ausführbaren Datei wurde. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/102/4e1/0b5/1024e10b5ec8dfd9b9604248728e9e83.svg"></div><br><h2>  Ein Spiel mit seiner GD-ROM abrufen </h2><br>  Das gestohlene SDK war alles, was Piraten brauchten.  Dank der Möglichkeit, Code auf einem Computer auszuführen, konnte Dreamcast jetzt nicht mehr als Spielekonsole, sondern als GD-ROM-Laufwerk verwendet werden.  Das „Encoder-Kabel“ aus dem SDK <sup>[7]</sup> ermöglichte es, die Konsole an einen PC anzuschließen und eine physische Verbindung herzustellen.  Damit die Konsole den Inhalt der GD-Tracks sichern kann, wurde eine spezielle ausführbare Datei geschrieben.  Dann wurde es erneut verschlüsselt und auf eine CD-ROM gebrannt, um alle 1 GB Daten über die serielle Schnittstelle der Konsole auszugeben.  Es war ein fehleranfälliger Prozess, der bis zu 18 Stunden dauerte <sup>[8]</sup> <sup>[9]</sup> .  Das Ergebnis wurde in einem speziell erstellten ".gdi" -Format gespeichert. <br><br><pre>  ikaruga.gdi 153 Bytes
 track01.bin 13 982 640 Bytes
 track02.raw 2.088.576 Bytes
 track03.bin 1 185 760 800 Bytes </pre><br>  <b>Eine interessante Tatsache</b> : Sie können sehen, dass die Gesamtdatenmenge nicht 1 GB beträgt, wie oben erwähnt, sondern 1,2 GB.  Dies liegt daran, dass die 2352-Byte-GD-ROM-Sektoren dem Red Book-Format folgen, das 12 Byte für die Synchronisation, 4 Byte für den Header, 2048 Byte für die Nutzlast und 288 Byte für den Fehlererkennungscode / Fehlerkorrekturcode verwendet <sup>[10 ]</sup> . <br><br><pre>  $ cat ikaruga.gdi 
 3
 1 0 4 2352 track01.bin 0
 2 5945 0 2352 track02.raw 0
 3 45000 4 2352 track03.bin 0 </pre><br><h2>  So passen Sie eine 1000-Megabyte-GD-ROM an eine 700-Megabyte-CD-ROM an </h2><br>  Um das Spiel auf eine 700-Megabyte-CD-ROM zu bringen, wurden die Spielressourcen überarbeitet.  Das in GD-ROM verwendete ISO-9660-Dateisystem machte es einfach, die Diskretisierung von Videos und Musik zu ändern und sie vollständig zu löschen.  Für die meisten Spiele war ein derart komplexer Prozess jedoch nicht erforderlich, da sie nicht die gesamten 1 GB belegten.  Zum Beispiel nahm Treasures Ikaruga nur 150 MB ein, und der größte Teil seines Inhalts war mit Nullen gefüllt.  In solchen Fällen reichte es aus, nur die Fülldaten zu bearbeiten. <br><br>  Tatsächlich ist ISO-9660 ein so bekanntes Format, dass sogar Python-Skripte (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gditools.py</a> ) geschrieben wurden, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">um den</a> Inhalt von .gdi-Archiven zu untersuchen. <br><br><h2>  Verpackung und Vertrieb </h2><br>  Die letzten beiden Schritte des Prozesses waren das umgekehrte Verwürfeln von 1ST_READ.BIN und das Packen aller Informationen in ein .cdi-Archiv, damit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DiscJuggler</a> das Image auf CD-R brennen konnte.  Das erzielte Ergebnis funktionierte problemlos auf jedem Vanilla Dreamcast, ohne dass ein Modifikationschip erforderlich war. <br><br><h2>  SEGA-Reaktion und Konsequenzen </h2><br>  SEGA veröffentlichte schnell die zweite Version der DC-Konsole mit vollständig deaktivierter MIL-CD, aber der Schaden wurde bereits angerichtet.  Nach einem katastrophalen Umsatzrückgang und der Veröffentlichung der konkurrierenden PS2 gaben die Entwickler Dreamcast auf und SEGA verließ die Entwicklung der Geräte und konzentrierte sich ausschließlich auf die Erstellung von Software. <br><br><h2>  Referenzen </h2><br>  [1] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SEGA GD Workshop</a> <br>  [2] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">segaretro.org: GD-ROM</a> <br>  [3] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microsoft kündigt Windows CE Toolkit für Dreamcast an</a> <br>  [4] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dreamcast-Spiele unter Windows CE</a> <br>  [5] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IP.BIN und 1ST_READ.BIN</a> <br>  [6] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lassen Sie uns ein Sega Dreamcast-Spiel von Grund auf neu erstellen</a> <br>  [7] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PC Serial Adapter</a> <br>  [8] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein genauerer und detaillierterer Blick auf die Sicherheit von Dreamcast</a> <br>  [9] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zuletzt wurden schnellere Wege unter Verwendung des Breitbandanschlusses des DC entworfen</a> <br>  [10] Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dreamcast Mythos: GD-ROM-Speicherkapazität</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433072/">https://habr.com/ru/post/de433072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433060/index.html">Warum ich Mikrobenchmarks nicht glaube</a></li>
<li><a href="../de433062/index.html">AXIS P1367 vs IDIS DC-B3303X: Vergleichen Sie CCTV-Kameras</a></li>
<li><a href="../de433064/index.html">Incident Management: "Sie können nicht aufgeben" oder die Kunst, Kommas zu setzen</a></li>
<li><a href="../de433066/index.html">HighLoad Cup # 2. Meisterschaft für Backend-Entwickler wieder in Betrieb</a></li>
<li><a href="../de433070/index.html">Wie man Shampoo von Champignons und Spieße von Champagner unterscheidet ... Elasticsearch - Suche nach Produkten in Geschäftsdatenbanken</a></li>
<li><a href="../de433074/index.html">In einem Android-Projekt zu Kotlin wechseln: Tipps und Tricks</a></li>
<li><a href="../de433076/index.html">Wie wir unsere Android Gallery-Bibliothek zum Anzeigen von Medieninhalten erstellt haben</a></li>
<li><a href="../de433078/index.html">Wir schreiben Handelsroboter mit dem grafischen Framework von StockSharp. Teil 2</a></li>
<li><a href="../de433082/index.html">Das Pumpen der Konten anderer Personen ist in Südkorea zu einer Straftat geworden</a></li>
<li><a href="../de433084/index.html">Offene Lektion "Feature Engineering am Beispiel des klassischen Titanic-Datensatzes"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>