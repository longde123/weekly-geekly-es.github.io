<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ö´Ô∏è ü§∂üèæ üë≤üèæ Profundidades SIEM: correlaciones listas para usar. Parte 3.1. Categorizaci√≥n de eventos üÖ±Ô∏è üê´ üåä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬øEs posible categorizar todos los eventos que llegan a SIEM y qu√© sistema de categorizaci√≥n utilizar para esto? ¬øC√≥mo aplicar categor√≠as en las reglas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades SIEM: correlaciones listas para usar. Parte 3.1. Categorizaci√≥n de eventos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432352/">  ¬øEs posible categorizar todos los eventos que llegan a SIEM y qu√© sistema de categorizaci√≥n utilizar para esto?  ¬øC√≥mo aplicar categor√≠as en las reglas de correlaci√≥n y b√∫squeda de eventos?  Analizaremos estos y otros temas en un nuevo art√≠culo del ciclo dedicado a la metodolog√≠a para crear reglas de correlaci√≥n listas para usar para los sistemas SIEM. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wp/ok/om/wpokomy1rlw1e495pzqk6uujan4.png" alt="Categorizaci√≥n de eventos"></div><br>  <i>Imagen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Worktrooper</a></i> <br><a name="habracut"></a><br>  Este art√≠culo fue coescrito con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mikhail Maximov</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Alexander Kovtun</a> . <br><br>  Te advertimos: el art√≠culo es grande, ya que describe la construcci√≥n del sistema de categorizaci√≥n y nuestras cadenas de razonamiento.  Si eres demasiado vago para leerlo en su totalidad, puedes ir inmediatamente a la secci√≥n con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conclusiones</a> ; all√≠ resumimos todo lo que se discuti√≥ en el art√≠culo y resumimos los resultados. <br><br>  En un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior,</a> encontramos que los eventos contienen mucha informaci√≥n importante que no se puede perder en el proceso de normalizaci√≥n.  La descripci√≥n del esquema de interacci√≥n se refiere a este tipo de datos.  Para sistematizar los tipos de interacci√≥n, hicimos lo siguiente: <br><br><ul><li>  identific√≥ los principales esquemas inherentes a cualquier tipo de evento; </li><li>  determin√≥ qu√© entidades est√°n involucradas en los esquemas; </li><li>  form√≥ el conjunto b√°sico de campos necesarios para describir todas las entidades encontradas en el evento inicial y el canal de interacciones entre ellas. </li></ul><br>  Como resultado del an√°lisis de registros de varios tipos de software y hardware, pudimos identificar las entidades: sujeto, objeto de interacci√≥n, fuente y transmisor. <br><br>  Ahora hablemos de la sem√°ntica de la interacci√≥n de estas entidades y su reflejo en la categorizaci√≥n de eventos.  Antes de describir el enfoque de la formaci√≥n y las categor√≠as, es necesario responder dos preguntas: por qu√© es necesario determinar las categor√≠as de eventos y qu√© propiedades debe tener el sistema de cateterismo. <br><br>  Primero, determinemos por qu√© los eventos deben clasificarse.  En resumen: la categorizaci√≥n es necesaria para funcionar igualmente bien con eventos sem√°nticamente similares, independientemente del tipo de fuente.  Nos referimos a los tipos de fuentes con el prop√≥sito principal de la fuente: equipos de red, sistemas operativos, software de aplicaci√≥n.  La frase "trabajar de la misma manera con eventos sem√°nticamente similares" debe entenderse de la siguiente manera: <br><br><ol><li>  Los eventos sem√°nticamente similares de cualquier tipo de fuente tienen una categor√≠a com√∫n. </li><li> Para eventos de cada categor√≠a, se definen reglas claras para completar los campos del esquema.  Por lo tanto, combatimos eficazmente el caos que ocurre en la etapa de normalizaci√≥n de eventos y, a menudo, conduce a m√∫ltiples falsos positivos de las reglas de correlaci√≥n. </li><li>  El manejo de categor√≠as le permite evitar verificaciones innecesarias en el c√≥digo de reglas de correlaci√≥n para comprender la sem√°ntica del evento.  Por ejemplo, no es necesario verificar la disponibilidad de datos en ciertos campos para determinar si el evento describe la entrada del usuario y no la copia de seguridad del sistema. </li><li>  La categorizaci√≥n es una base terminol√≥gica general que ayuda a redactar las reglas de correlaci√≥n e investigaci√≥n de incidentes, para operar con un solo conjunto de t√©rminos y sus significados generalmente aceptados.  Por ejemplo, para comprender claramente que cambiar la configuraci√≥n de la red y cambiar la configuraci√≥n del software son tipos de eventos completamente diferentes que tienen significados completamente diferentes. </li></ol><br>  Para obtener todo esto, debe crear un sistema para clasificar eventos y usarlo al escribir reglas de correlaci√≥n, investigar incidentes y en los casos en que m√°s de una persona trabaje en una organizaci√≥n con un sistema SIEM. <br><a name="Requirements"></a><br>  En cuanto a los requisitos para el sistema de categorizaci√≥n, debe satisfacer cuatro propiedades: <br><br><ol><li>  <b>No ambig√ºedad</b> .  Se debe asignar un mismo evento a una √∫nica categor√≠a. </li><li>  <b>Compacidad</b>  El n√∫mero total de categor√≠as debe ser tal que un experto pueda recordarlas f√°cilmente. </li><li>  <b>Jerarqu√≠a</b>  El sistema debe construirse sobre un esquema jer√°rquico y constar de varios niveles, ya que esta es la estructura m√°s simple para recordar.  Adem√°s, la jerarqu√≠a deber√≠a basarse en el principio de "de lo general a lo particular": en el primer nivel hay m√°s categor√≠as "generales", y en el √∫ltimo, categor√≠as altamente especializadas. </li><li>  <b>Extensibilidad</b>  Los principios por los cuales se construye deber√≠an permitir realizar actualizaciones al sistema de categorizaci√≥n cuando aparecen nuevos tipos de eventos que requieren categor√≠as separadas, sin cambiar el enfoque principal. </li></ol><br>  Pasemos a la descripci√≥n del sistema de categorizaci√≥n: comenzaremos con dos dominios grandes, que incluyen or√≠genes de eventos conectados a SIEM y en los que generan eventos. <br><br><a name="MainDomains"></a><h1>  Dominios de origen y eventos </h1><br>  La implementaci√≥n de SIEM a menudo comienza conectando fuentes que generan eventos dispares.  Una propiedad importante de estos eventos es que reflejan la funcionalidad de las propias fuentes. <br><br>  Se pueden distinguir dos dominios globales: <br><br><ol><li>  Fuentes de TI: software y hardware de aplicaci√≥n en todo el sistema que genera eventos de TI. </li><li>  Fuentes del IB: software y hardware especializados para la seguridad de la informaci√≥n de la compa√±√≠a que generan eventos del IB. </li></ol><br>  Considere las diferencias fundamentales entre los eventos de estos dominios. <br><br>  Las fuentes de TI informan la ocurrencia de cualquier fen√≥meno en el sistema automatizado, sin su evaluaci√≥n del nivel de seguridad: "bueno" o "malo".  Ejemplos: aplicar una nueva configuraci√≥n por un dispositivo, hacer una copia de seguridad de los datos, transferir un archivo a trav√©s de una red, deshabilitar un puerto de red en un conmutador. <br><br>  A diferencia de las fuentes de TI, las fuentes de SI tienen un conocimiento externo adicional sobre c√≥mo interpretar ciertos eventos desde un punto de vista de seguridad: la pol√≠tica.  Por lo tanto, el uso de pol√≠ticas permite a las fuentes de SI tomar decisiones, ya sea que el fen√≥meno observado sea "bueno" o "malo", y reportar esto a SIEM a trav√©s de los eventos del IB generados. <br><br>  Considere el siguiente ejemplo: Entonces, en general, un firewall de nivel Next Generation considera que un evento de transferencia de archivos a trav√©s de la red es "malo": resulta que el archivo es un documento de Word que se transfiere de la red interna de la compa√±√≠a a un servidor externo a trav√©s de FTP, y la pol√≠tica configurada proh√≠be tal interacciones informativas.  La desactivaci√≥n del puerto de red se interpreta como una violaci√≥n de los derechos de acceso por la decisi√≥n de controlar las acciones de los administradores: dado que la desconexi√≥n del puerto la realiza el usuario Alex, que no tiene derechos, y se produce durante sus horas no laborables, de acuerdo con la pol√≠tica de seguridad configurada. <br><br>  Sin embargo, no es del todo cierto decir que las fuentes de seguridad de la informaci√≥n generan solo eventos de seguridad de la informaci√≥n.  Las fuentes del IB generan eventos del IB y de TI.  Las fuentes de IS generan eventos de TI, por regla general, cuando informan un cambio en su estado: cambios de configuraci√≥n, nodos de cl√∫ster y copias de seguridad.  En general, estos eventos pueden atribuirse a la auditor√≠a interna de acciones y al estado de la fuente.  Al mismo tiempo, cuando la actividad se refiere a la aplicaci√≥n de pol√≠ticas de seguridad, la misma fuente ya genera eventos de seguridad de la informaci√≥n, informando as√≠ los resultados de su aplicaci√≥n. <br><br>  Deliberadamente describimos las diferencias entre los dos dominios con tanto detalle.  Los eventos de cada dominio tienen su propio significado y, a veces, pueden diferir fundamentalmente entre s√≠.  Estas diferencias llevaron a la existencia de dos sistemas de categorizaci√≥n de eventos separados responsables de eventos de TI y eventos de seguridad de la informaci√≥n. <br><br><img src="https://habrastorage.org/webt/lh/q6/2j/lhq62jphooh6zal7eks_kohztki.png" alt="Categorizaci√≥n de eventos.  Dominios de eventos."><br>  <i>Dominios de eventos</i> <br><br>  Hay un tipo m√°s raro de fuentes que generan eventos de un tercer dominio separado: el dominio de los ataques.  Los eventos de este dominio se pueden obtener de fuentes del nivel de protecci√≥n de punto final (Endpoint Protection), otros SIEM subordinados (si est√°n organizados en una jerarqu√≠a) u otras soluciones capaces de determinar, en base al an√°lisis de TI y (o) eventos de seguridad de la informaci√≥n, que un sistema automatizado o parte de ella est√° sujeta a ataques de hackers. <br><br>  Como parte de esta serie de art√≠culos, utilizaremos los siguientes conceptos al separar los ataques y los eventos de seguridad de la informaci√≥n de los medios de defensa de extremo a extremo: <br><br><ol><li>  Un ataque es una secuencia maliciosa de acciones de un atacante con el objetivo de lograr un objetivo espec√≠fico dentro de una empresa. </li><li>  Un ataque puede consistir en uno o m√°s eventos: una cadena de eventos de seguridad de la informaci√≥n y / o eventos de TI que son violaciones de las pol√≠ticas de seguridad de la informaci√≥n. </li></ol><br>  Existen varios enfoques para clasificar los ataques, por ejemplo, la creciente popularidad de las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">t√°cticas, t√©cnicas y conocimientos comunes adversos</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MITRE (ATT &amp; CK)</a> , pero no consideraremos este dominio en nuestros art√≠culos. <br><br><a name="ITCategorization"></a><h1>  Sistema de categorizaci√≥n de eventos de TI </h1><br>  El software y hardware de aplicaci√≥n de todo el sistema, que atribuimos a las fuentes de eventos de TI, est√° dise√±ado para implementar o respaldar ciertos procesos para cumplir con sus tareas.  En el curso de su decisi√≥n, los hechos que se cometen se registran por eventos de TI separados.  Se pueden atribuir al proceso en el que ocurri√≥ cada uno de ellos. <br><br>  Al aislar los procesos que ocurren en las fuentes de TI, podemos formar el primer nivel de categorizaci√≥n (que luego llamaremos contexto).  Definir√° un campo sem√°ntico que interpretar√° correctamente los eventos de TI. <br><br>  Al analizar eventos, queda claro que cada uno de ellos describe la interacci√≥n de varias entidades en el marco de un proceso ya definido.  Seleccionando como la principal de estas entidades como objeto de interacci√≥n, formamos el segundo nivel de categorizaci√≥n. <br><br>  El comportamiento de la entidad principal en el evento dentro del marco de un proceso espec√≠fico desempe√±ar√° el papel del tercer nivel de categorizaci√≥n de eventos de TI. <br>  Total, en la salida obtuvimos los siguientes niveles: <br><br><ol><li>  El contexto (proceso) dentro del cual ocurri√≥ el evento. </li><li>  El objeto (entidad principal) descrito por el evento. </li><li>  La naturaleza del comportamiento del objeto dentro del contexto dado. </li></ol><br>  Por lo tanto, hemos formado tres niveles de categorizaci√≥n de eventos de TI, lo que le permite operar convenientemente en eventos sem√°nticamente similares de varios tipos de fuentes en la infraestructura de TI. <br><br>  Para garantizar la unicidad del sistema de categorizaci√≥n resultante, formaremos dominios separados de cada nivel. <br><br><img src="https://habrastorage.org/webt/yj/8h/qo/yj8hqoi_fevntq2utkvczwh5g_o.png" alt="Categorizaci√≥n de eventos de TI.  Primer nivel"><br>  <i>Sistema de categorizaci√≥n para eventos de TI.</i>  <i>Primer nivel</i> <br><br>  Un enfoque de proceso similar para trabajar con sistemas de TI tambi√©n se utiliza en ITSM (Gesti√≥n de servicios de TI, gesti√≥n de servicios de TI), que postula algunos de los procesos b√°sicos que tienen lugar en los servicios de TI.  Confiaremos en este enfoque cuando formemos procesos posibles, o en otras palabras, contextos, cuando consideremos las fuentes de eventos de TI. <br><br>  Destacamos los principales procesos de este nivel: <br><br><ul><li>  <b>Business Continuity Management</b> : eventos relacionados con las operaciones para mantener la operaci√≥n continua de los sistemas: replicaci√≥n, migraci√≥n y sincronizaci√≥n de m√°quinas virtuales, bases de datos y almacenamientos, operaciones de respaldo y restauraci√≥n; </li><li>  <b>Gesti√≥n de</b> usuarios y derechos ( <b>gesti√≥n de</b> usuarios y derechos): eventos relacionados con el trabajo con grupos y cuentas de usuarios; </li><li>  <b>Gesti√≥n de acceso</b> : eventos asociados con los procesos de autenticaci√≥n, autorizaci√≥n, contabilidad (AAA) y cualquier intento de acceder al sistema; </li><li>  <b>Gesti√≥n de disponibilidad</b> : eventos asociados con cualquier acci√≥n para iniciar, detener, encender, apagar y apagar entidades, incluidos los mensajes informativos de los sistemas de control de acceso de la entidad; </li><li>  <b>Gesti√≥n de implementaci√≥n</b> (gesti√≥n de eventos): eventos asociados con la introducci√≥n de nuevas entidades en el sistema desde el exterior, as√≠ como con la eliminaci√≥n de la entidad de este sistema; </li><li>  <b>Gesti√≥n de interacci√≥n de red</b> : eventos relacionados con la transmisi√≥n de datos a trav√©s de la red, incluido el establecimiento de conexiones, apertura y cierre de t√∫neles; </li><li>  <b>Gesti√≥n de red</b> : eventos relacionados con la pila de red: incluidas las acciones con pol√≠ticas y reglas para el filtrado de red; </li><li>  <b>Gesti√≥n de</b> infraestructura virtual (gesti√≥n de infraestructura virtual): eventos relacionados con la infraestructura de virtualizaci√≥n; </li><li>  <b>Gesti√≥n de bases de datos</b> : eventos relacionados con el funcionamiento del DBMS y las acciones de los usuarios y procesos en √©l; </li><li>  <b>Administraci√≥n del sistema</b> : eventos relacionados con el funcionamiento del sistema operativo y el software que forma parte del sistema operativo; </li><li>  <b>Administraci√≥n de aplicaciones gen√©ricas</b> (administraci√≥n de otras aplicaciones): eventos asociados con el funcionamiento de otras aplicaciones instaladas por el usuario y que no forman parte del sistema operativo. </li></ul><br>  Es importante comprender que pueden ocurrir diferentes procesos en la misma fuente de TI.  Entonces, por ejemplo, en el servicio DHCP implementado en Unix, puede ocurrir tanto el proceso de Administraci√≥n de la red (que genera, por ejemplo, un evento de actualizaci√≥n de la direcci√≥n IP en los nodos) como el proceso de Administraci√≥n del sistema, que genera un evento de reinicio del servicio o un error de an√°lisis del archivo de configuraci√≥n. <br><br><h2>  El segundo nivel de categorizaci√≥n de eventos de TI (entidades) </h2><br><img src="https://habrastorage.org/webt/k_/rn/s6/k_rns6dddokqnddjqsdz9kjfdnk.png" alt="Sistema de categorizaci√≥n de eventos del IB.  El primer y segundo nivel."><br>  <i>Sistema de categorizaci√≥n de eventos del IB.</i>  <i>El primer y segundo nivel.</i> <br><br>  El segundo nivel refleja el objeto de interacci√≥n descrito en el evento.  Tenga en cuenta que un evento puede describir varias entidades.  Por ejemplo, tome el siguiente evento: "el usuario envi√≥ una solicitud al servidor de certificados para la emisi√≥n de un certificado personal".  En eventos de este tipo, es necesario elegir una entidad b√°sica como objeto de interacci√≥n, que es central en el evento.  Aqu√≠ podemos determinar que la entidad principal es una "solicitud a un servidor de certificaci√≥n", ya que el usuario es obviamente el sujeto de interacci√≥n, y el certificado personal es el resultado de la interacci√≥n del sujeto y el objeto.  Al recopilar y analizar una gran variedad de eventos, podemos distinguir grupos de entidades: <br><br><ul><li>  <b>identificaci√≥n</b> : cuenta de usuario, grupo de usuarios, certificado: entidades que le permiten identificar al usuario o sistema; </li><li>  <b>ejecutable</b> : aplicaci√≥n, m√≥dulo ejecutable: todo lo que el sistema operativo puede iniciar y contiene un cierto algoritmo; </li><li>  <b>reglas y pol√≠ticas</b> : cualquier regla, pol√≠tica de acceso, incluidas las pol√≠ticas de grupo de Windows OC; </li><li>  <b>la esencia del almacenamiento de informaci√≥n en el sistema operativo</b> : un archivo, una clave de registro, un objeto de un grupo de directorios: todo lo que puede actuar como almacenamiento de informaci√≥n a nivel de aplicaci√≥n; </li><li>  <b>conexiones de red</b> : sesiones, flujos, t√∫neles: entidades que transportan un flujo de datos de un nodo a otro; </li><li>  <b>Entidades de identificaci√≥n de red de un nodo</b> : direcci√≥n de red, z√≥calo, directamente el nodo de red en s√≠, todas aquellas entidades que ning√∫n sistema de monitoreo puede prescindir; </li><li>  <b>red L5-L7</b> : mensaje de correo, flujo de medios, lista de distribuci√≥n: entidades que transmiten informaci√≥n en los niveles L5-L7 del modelo OSI; </li><li>  <b>red de servicio</b> : zona DNS, tabla de enrutamiento.  Estas entidades son responsables del correcto funcionamiento de la red, sin llevar una carga √∫til para el usuario final; </li><li>  <b>entidades de configuraciones tolerantes a fallas</b> : RAID, elementos de red de cl√∫ster; </li><li>  <b>la esencia de los sistemas de virtualizaci√≥n</b> : m√°quinas virtuales, discos duros virtuales, instant√°neas de m√°quinas virtuales; </li><li>  <b>entidades de bases de datos</b> : tablas, bases de datos, DBMS; </li><li>  <b>equipo f√≠sico</b> : dispositivos enchufables, elementos ACS (torniquetes, c√°maras IP); </li><li>  <b>otras entidades del sistema operativo</b> : un comando en la consola de administraci√≥n, consola del sistema, registro del sistema: aquellas entidades del sistema operativo que no encajan en otras categor√≠as; </li><li>  <b>otras entidades de red</b> : interfaz de red, recurso de red p√∫blica: aquellas entidades del subsistema de red que no encajan en otras categor√≠as. </li></ul><br>  Estos grupos no afirman ser exhaustivos, pero cubren las tareas principales para asignar categor√≠as de segundo nivel.  Si es necesario, los grupos representados pueden expandirse. <br><br><h2>  El tercer nivel de categorizaci√≥n de eventos de TI (naturaleza de la interacci√≥n) </h2><br><img src="https://habrastorage.org/webt/x5/wc/ja/x5wcja8h3u9jrersnj_au4im9ke.png" alt="Sistema de categorizaci√≥n para eventos de TI.  El primer, segundo y tercer nivel."><br>  <i>Sistema de categorizaci√≥n para eventos de TI.</i>  <i>El primer, segundo y tercer nivel.</i> <br><br>  Dentro de un proceso espec√≠fico, el comportamiento de la entidad principal se puede reducir a los siguientes valores: <br><br><ul><li>  <b>Control</b> : interacci√≥n que afecta el funcionamiento de la entidad; </li><li>  <b>Comunicaci√≥n</b> : comunicaci√≥n entre entidades; </li><li>  <b>Manipulaci√≥n</b> : acciones para trabajar con la propia entidad, incluida la manipulaci√≥n de sus datos; </li><li>  <b>Incrustaci√≥n</b> : interacci√≥n, como resultado de la cual se agrega una nueva entidad al contexto (o la entidad se elimina del contexto); </li><li>  <b>Estado</b> : eventos informativos sobre cambios en el estado de una entidad. </li></ul><br>  El √∫ltimo dominio se destaca entre otros: incluye eventos que en realidad no describen ninguna interacci√≥n, pero que contienen informaci√≥n sobre la entidad o las transiciones de entidad entre estados.  Por ejemplo, un evento que describe solo el estado actual del sistema (sobre la hora actual del sistema, sobre un cambio en el estado de una licencia de producto). <br><br>  Los eventos describen no solo la interacci√≥n en s√≠, sino tambi√©n su resultado.  Es importante comprender que el contexto, la esencia principal y el comportamiento de un objeto dentro del contexto no dependen del resultado de la interacci√≥n.  El resultado puede ser "√©xito" y "fracaso".  Un evento tambi√©n puede describir el proceso continuo de interacci√≥n incompleta.  Llamaremos a este estado "en curso". <br><br><h2>  Formaci√≥n de un conjunto de datos basado en tres niveles. </h2><br>  Para cada dominio de cada nivel, puede seleccionar un conjunto de datos espec√≠fico que contenga eventos. <br><br>  Analicemos un ejemplo de un evento: <br><br><img src="https://habrastorage.org/webt/0j/e6/so/0je6sogj5o9rk3dbfr4qjylafac.png"><br><br>  Se puede interpretar como "la conexi√≥n del nodo 10.0.1.5 al nodo 192.168.149.2 se desconect√≥".  Al observar el contexto de un evento, puede ver que describe una conexi√≥n de red.  En consecuencia, caemos en el contexto de la "Gesti√≥n de interacci√≥n de red". <br><br>  A continuaci√≥n, determinamos la entidad principal en el evento.  Obviamente, el evento describe tres entidades: dos nodos y una conexi√≥n de red.  Seg√∫n las recomendaciones anteriores, entendemos que la entidad principal en este caso es solo una conexi√≥n de red, y los nodos son participantes de interacci√≥n, puntos finales que realizan acciones en la entidad.  En total, obtenemos la entidad principal del dominio de Conexiones de red, y la acci√≥n realizada en la entidad es "cerrar el canal de comunicaci√≥n", que puede atribuirse al dominio de Comunicaci√≥n. <br><br>  Sin embargo, todav√≠a tenemos muchos datos que podr√≠an guardarse del evento.  Entonces, un conjunto de entidades del segundo nivel "Conexiones de red" tiene propiedades comunes: <br><br><ul><li>  iniciador de conexi√≥n (direcci√≥n + puerto + interfaz); </li><li>  receptor (destino) de la conexi√≥n (direcci√≥n + puerto + interfaz); </li><li>  El protocolo a trav√©s del cual se realiza la conexi√≥n. </li></ul><br>  Adem√°s, por ejemplo, la acci√≥n del tercer nivel de categorizaci√≥n ‚Äúcerrar la conexi√≥n‚Äù, perteneciente al dominio de Comunicaci√≥n, puede contener los siguientes datos, independientemente de qu√© conexi√≥n se cerr√≥ y qu√© fuente inform√≥ esto: <br><br><ul><li>  n√∫mero de bytes enviados / enviados; </li><li>  n√∫mero de paquetes transmitidos / enviados; </li><li>  duraci√≥n </li></ul><br>  Como ejemplo, podemos distinguir un conjunto de entidades b√°sicas "Entidades de almacenamiento de informaci√≥n en el sistema operativo", que se caracterizan por los siguientes datos: <br><br><ul><li>  nombre de la entidad; </li><li>  la ruta de ubicaci√≥n de la entidad en el sistema operativo; </li><li>  tama√±o de la entidad; </li><li>  privilegios de acceso a la entidad. </li></ul><br>  Un conjunto de acciones relacionadas con esta entidad, por ejemplo, "copiar", que se incluye en el dominio de tercer nivel "Manipulaci√≥n", puede caracterizarse por las siguientes propiedades: <br><br><ul><li>  El nuevo nombre de la entidad. </li><li>  una nueva forma de organizar la entidad; </li><li>  Nuevos privilegios de acceso a la entidad. </li></ul><br>  Opcionalmente podemos obtener todos estos datos del evento.  Lo principal es que la categor√≠a que definimos nos permite resaltar un conjunto espec√≠fico de datos que se pueden extraer del evento, entendiendo de antemano que estos datos ser√°n sem√°nticamente similares. <br><br>  Y a este respecto, las categor√≠as se est√°n convirtiendo en una herramienta conveniente.  Al comparar un determinado conjunto de dichos datos con cada nivel de dominio, tenemos la oportunidad de almacenar datos sem√°nticamente similares en los mismos campos de un evento normalizado, independientemente del fabricante y modelo del origen del evento.  Esto simplifica enormemente la b√∫squeda de datos en un gran volumen de eventos y, en consecuencia, la implementaci√≥n de correlaciones para tales eventos. <br><br><h2>     </h2><br> <b> 1:</b>    ,           . <br><br>     ,      <b>Level 1</b> (  ), <b>Level 2</b> ( )  <b>Level 3</b> ( )  .         : <br><br><ul><li> Level 2: <b> ;</b> </li><li> Level 3: <b>Embedding.</b> </li></ul><br>      ,          . <br><br>  ,        : <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 = ‚Äú&lt;      &gt;‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = ‚ÄúEmbedding‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  <b>Situaci√≥n 2:</b> es necesario encontrar todos los eventos que describen un intento de modificar los objetos del sistema de archivos con un nombre que comienza con "boot". <br><br>  Las fuentes conectadas a SIEM pueden producir eventos de modificaci√≥n de archivos completamente diferentes.  Sin embargo, asignar las categor√≠as apropiadas a los eventos le permite seleccionar lo necesario de toda la matriz: <br><br><ul><li>  Nivel 1: <b>Gesti√≥n del sistema;</b> </li><li>  Nivel 2: <b>entidades de almacenamiento de informaci√≥n en el sistema operativo;</b> </li><li>  Nivel 3: <b>manipulaci√≥n.</b> </li></ul><br>  Adem√°s, el nombre del archivo especifica una condici√≥n: usando conjuntos de datos predefinidos, podemos esperar que para esta categor√≠a el nombre del archivo est√© en el campo object.name.  Por lo tanto, para seleccionar eventos, puede formar la siguiente consulta: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 = ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">System</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Management</span></span>‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level2 = ‚Äú&lt;        &gt;‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = ‚ÄúManipulation‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (object.name <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> ‚Äúboot.%‚Äù)</code> </pre> <br>  Si se copi√≥ una entidad, encontraremos informaci√≥n al respecto y que se copi√≥ de otra entidad, lo que dar√° un impulso para una mayor investigaci√≥n. <br><br>  <b>Caso 3:</b> es necesario proporcionar un perfil simple de las conexiones de red en los enrutadores fronterizos de varios fabricantes instalados en las sucursales de la empresa.  SIEM recibe eventos de cada uno de estos enrutadores de borde. <br><br>  Cada uno de los enrutadores genera eventos de TI, despu√©s de la normalizaci√≥n de los cuales los campos Nivel 1, Nivel 2, Nivel 3 contienen categor√≠as.  En el ejemplo descrito, para la creaci√≥n de perfiles, es necesario y suficiente analizar eventos sobre la apertura y cierre de conexiones de red.  Seg√∫n el sistema de categorizaci√≥n presentado, dichos eventos contendr√°n los siguientes campos de categor√≠a: <br><br><ul><li>  Nivel 1: <b>Gesti√≥n de interacci√≥n de red;</b> </li><li>  Nivel 2: <b>Conexiones de red;</b> </li><li>  Nivel 3: <b>Comunicaci√≥n.</b> </li></ul><br>  Adem√°s, para las operaciones de abrir y cerrar conexiones, puede especificar las acciones "abrir" y "cerrar", as√≠ como el estado de la acci√≥n "√©xito". <br><br>  Adem√°s, al tener conjuntos de datos para cada una de las categor√≠as de la categor√≠a, puede estar seguro de que la hora de inicio de esta conexi√≥n se registrar√° en el evento de apertura de la conexi√≥n, y la informaci√≥n sobre los nodos que participan en la interacci√≥n de la red se colocar√° en el evento de cierre de la conexi√≥n, as√≠ como en los campos "N√∫mero de bytes transmitidos", "n√∫mero de paquetes transmitidos" y "duraci√≥n" se colocar√°n los datos correspondientes sobre la duraci√≥n de la conexi√≥n y la cantidad de informaci√≥n transmitida, respectivamente. <br><br>  Por lo tanto, al filtrar el flujo de eventos por las categor√≠as y acciones especificadas, puede seleccionar solo los eventos necesarios para la operaci√≥n de creaci√≥n de perfiles, sin tener que especificar una lista de identificadores de eventos espec√≠ficos. <br><br><h1>  Sistema de categorizaci√≥n de eventos del IB </h1><br>  Antes de hablar sobre el sistema de categorizaci√≥n, notamos que solo consideraremos los eventos que provienen de las defensas.  La categorizaci√≥n de los ataques de piratas inform√°ticos como cadenas de acciones maliciosas es un √°rea separada con su propio sistema de categorizaci√≥n. <br><br>  El sistema para clasificar los eventos de seguridad de la informaci√≥n se basa en un cierto paradigma.  Se formula de la siguiente manera: cualquier incidente que ocurra en un sistema automatizado se refleja en uno o varios medios a la vez: el nivel de un host espec√≠fico, el nivel de red y el nivel del entorno f√≠sico. <br><br>  Las herramientas de seguridad que operan en estos niveles identifican el incidente o sus "ecos" y generan eventos de seguridad de la informaci√≥n que ingresan al SIEM. <br><br>  Por ejemplo, la transmisi√≥n de un archivo malicioso a trav√©s de una red a un host espec√≠fico se puede detectar a nivel de la red y del host, en el proceso de procesamiento del tr√°fico de la red mediante la protecci√≥n de la red o analizando √°reas de la memoria RAM con los m√≥dulos apropiados de herramientas de protecci√≥n antivirus. <br><br>  El acceso f√≠sico no autorizado a las instalaciones se puede detectar a nivel del entorno f√≠sico mediante sistemas de control de acceso y a nivel de host, mediante SZI desde el NSD cuando el usuario est√° autorizado para el host durante las horas de inactividad. <br><br>  Cuando se trabaja con eventos IS, a menudo es necesario comprender en qu√© entorno se registr√≥ el incidente.  Y ya a partir de esto, construya una ruta de investigaci√≥n adicional o forme la l√≥gica de la regla de correlaci√≥n.  Por lo tanto, el entorno de detecci√≥n es el primer nivel de un sistema de categorizaci√≥n. <br><br><h2>  El primer nivel del sistema de categorizaci√≥n de eventos del IB </h2><br><img src="https://habrastorage.org/webt/ig/ay/vz/igayvzurcou73lz_txlya7rqyya.png" alt="Sistema de categorizaci√≥n de eventos del IB.  Primer nivel"><br>  <i>Sistema de categorizaci√≥n de eventos del IB.</i>  <i>Primer nivel</i> <br><br><ul><li>  <b>Infracciones de host</b> (eventos del nivel de host): eventos que provienen de los medios de protecci√≥n instalados en las estaciones de trabajo y servidores finales.  Como regla general, los eventos de seguridad de la informaci√≥n de este nivel describen la activaci√≥n de las pol√≠ticas de seguridad como resultado del an√°lisis del estado interno del host mediante la protecci√≥n.  Bajo el an√°lisis del estado interno aqu√≠ se entiende el an√°lisis de procesos en ejecuci√≥n, datos en las √°reas de RAM, archivos en disco. <br>  <b>Tipos de fuentes de eventos</b> : herramientas de protecci√≥n antivirus, sistemas de monitoreo de integridad, sistemas de detecci√≥n de intrusos a nivel de host, control de acceso y sistemas de control de acceso. </li><li>  <b>Infracciones de red</b> : eventos de sistemas que analizan el tr√°fico de red y le aplican un conjunto de pol√≠ticas de seguridad establecidas. <br>  <b>Tipos de or√≠genes de eventos</b> : cortafuegos, sistemas de detecci√≥n y prevenci√≥n de intrusos, sistemas de detecci√≥n DDoS.  Algunas protecciones de host tambi√©n tienen m√≥dulos de an√°lisis de tr√°fico de red separados.  Por ejemplo, herramientas de protecci√≥n antivirus y algunos dispositivos antivirus dom√©sticos de NSD. </li><li>  <b>Violaciones f√≠sicas</b> (violaciones del nivel del entorno f√≠sico): eventos que provienen de la seguridad f√≠sica. <br>  <b>Tipos de fuentes de eventos</b> : sistemas de seguridad perimetral, sistemas de control de acceso, sistemas de protecci√≥n de fugas de informaci√≥n a trav√©s de canales vibroac√∫sticos y canales PEMIN. <br>  Esta categor√≠a tambi√©n incluye los incidentes identificados por el servicio de seguridad f√≠sica o econ√≥mica en el curso de las actividades internas y llevados a las bases de datos internas de la compa√±√≠a, cuya informaci√≥n puede recopilar SIEM.  Debido a algunas razones organizativas, este es un evento extremadamente raro, pero a√∫n posible. </li></ul><br><h2>  El segundo y tercer nivel del sistema de categorizaci√≥n de eventos del IB </h2><br>  El segundo nivel del sistema de categorizaci√≥n est√° asociado con el primero, pero tiene caracter√≠sticas debido a las siguientes premisas: <br><br><ul><li>  los incidentes de seguridad de la informaci√≥n no siempre ocurren en el entorno f√≠sico; </li><li>  los incidentes en el entorno f√≠sico no siempre est√°n asociados con incidentes de seguridad de la informaci√≥n, pero tambi√©n hay intersecciones; </li><li>  Los incidentes en los niveles de host final y de red a menudo tienen una estructura y sem√°ntica similares. </li></ul><br>  Por lo tanto, en el segundo nivel, se distinguen un grupo de categor√≠as que corresponden a violaciones del nivel del entorno f√≠sico y grupos de categor√≠as comunes a las violaciones de la red y el nivel de host. <br><br>  El tercer nivel del sistema de categorizaci√≥n aclara el segundo y describe directamente las violaciones en s√≠ mismas, cuya esencia se refleja en los eventos de seguridad de la informaci√≥n. <br><br>  Analizamos los sistemas de categorizaci√≥n de eventos para las soluciones de seguridad IBM QRadar, Micro Focus Arcsight y Maxpatrol SIEM para violaciones de nivel de host y red.  De acuerdo con los resultados, concluyeron: todos son muy similares, y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">eCSIRT.net mkVI</a> puede servir como el sistema de categorizaci√≥n m√°s completo y unificador.  Fue ella quien fue tomada como base en el siguiente sistema de categorizaci√≥n. <br><br><img src="https://habrastorage.org/webt/eh/-e/gs/eh-egskwu2pfw2sjhrlucrdii80.png" alt="Sistema de categorizaci√≥n de eventos del IB.  Nivel de host y restricciones de nivel de red."><br>  <i>Sistema de categorizaci√≥n de eventos del IB.</i>  <i>Nivel de host y violaciones de nivel de red.</i> <br><br><ul><li>  <b>Contenido abusivo</b> : contenido entregado legalmente al usuario final, que provoca acciones ilegales (intencionales o no intencionales) o que contiene datos maliciosos / basura. <br>  <b>Categor√≠as de tercer nivel</b> : spam, phishing. <br>  <b>Tipos de or√≠genes de eventos</b> : servidores proxy con control de contenido (Microsoft Threat Management Gateway), herramientas de protecci√≥n del tr√°fico web (Cisco Web Security Appliance, Check Point URL filtering blade), herramientas de protecci√≥n de correo (Cisco Email Security Appliance, Kaspersky Secure Mail Gateway), Seguridad de host final con m√≥dulos integrados de control web y de correo electr√≥nico (McAfee Internet Security, Kaspersky Internet Security). </li><li>  <b>Recopilaci√≥n de informaci√≥n: recopilaci√≥n de</b> datos sobre el objeto de protecci√≥n contra fuentes de informaci√≥n abiertas y cerradas, utilizando m√©todos de recopilaci√≥n activos y pasivos. <br>  <b>Categor√≠as de tercer nivel</b> : huellas digitales, olfateo, escaneo, fuerza bruta. <br>  <b>Tipos de or√≠genes de eventos</b> : por regla general, caracter√≠sticas de seguridad de red, a saber: firewalls (dispositivo de seguridad adaptable de Cisco, blade de firewall de Checkpoint), herramientas de detecci√≥n y prevenci√≥n de intrusiones (Cisco Firepower Next - Generation IPS, blade de Check Point IPS). </li><li>  <b>Disponibilidad</b> : una violaci√≥n maliciosa o accidental de la disponibilidad de servicios y sistemas individuales en general. <br>  <b>Categor√≠as de tercer nivel</b> : DDoS, DoS, Flood. <br>  <b>Tipos de or√≠genes de eventos</b> : cortafuegos y sistemas de detecci√≥n y prevenci√≥n de intrusos, as√≠ como sistemas para detectar y bloquear ataques DoS de red (Arbor Pravail APS, Arbor Peakflow SP, Radware DefensePro, IFI Soft APK "Perimeter"). </li><li>  <b>Exploraci√≥n de vulnerabilidades</b> : identifica una vulnerabilidad o grupo de vulnerabilidades.  Es importante tener en cuenta que esta categor√≠a describe eventos de seguridad de la informaci√≥n sobre la detecci√≥n de vulnerabilidades, pero no su funcionamiento. <br>  <b>Categor√≠as de tercer nivel</b> : Firmware, Software. <br>  <b>Tipos de fuentes de</b> eventos: eventos del SIEM incorporado o del esc√°ner de seguridad y auditor√≠a externo integrado (Tenable Nessus Vulnerability Scanner, Positive Technologies Maxpatrol 8, Positive Technologies XSpider, Qualys Vulnerability Scanner, Burp Suit). </li><li>  <b>Explotaci√≥n de vulnerabilidad</b> (explotaci√≥n de vulnerabilidad): identificaci√≥n de impacto negativo deliberado en el sistema o explotaci√≥n de la vulnerabilidad del sistema.  En este caso, a menudo las categor√≠as de tercer nivel pueden incluir t√©cnicas de ataque individuales enumeradas en MITER ATT &amp; CK (enlace) y definidas por caracter√≠sticas de seguridad. <br>  <b>Categor√≠as de tercer nivel</b> : entidades externas XML, secuencias de comandos de sitios cruzados, deserializaci√≥n insegura, envenenamiento de enrutamiento, etc. <br>  <b>Tipos de fuentes de eventos</b> : sistemas de detecci√≥n y prevenci√≥n de intrusos a nivel de red (Positive Technologies Network Attack Discovery, Positive Technologies Web Application Firewall, Imperva Web Application Firewall, Cisco Firepower Next Generation IPS, Check Point IPS blade) o nivel de host (Carbon Black Cb Defense, M√≥dulos de protecci√≥n antivirus HIPS, OSSEC). </li><li>  <b>Hacktool</b> (hacking utilities): uso de utilidades utilizadas para hackear sistemas o implementar otras acciones ilegales para obtener informaci√≥n confidencial y evitar las herramientas de seguridad. <br>  <b>Categor√≠as de tercer nivel</b> : esc√°ner, Bruteforcer, Exploit Kit, volcado de contrase√±a, esc√°ner de vulnerabilidad, cliente TOR, Sniffer, Shellcode, Keylogger. <br>  <b>Tipos de fuentes de eventos</b> : sistemas de detecci√≥n y prevenci√≥n de intrusos a nivel de red y host, esc√°neres de seguridad y auditor√≠a, herramientas de protecci√≥n antivirus. </li><li>  <b>C√≥digo malicioso</b> : detecta el uso de c√≥digo malicioso. <br>  <b>Categor√≠as de tercer nivel</b> : Virus, Gusano, Botnet, Rootkit, Bootkit, Trojan, Backdoor, Cryptor. <br>  <b>Tipos de or√≠genes de eventos</b> : cualquier herramienta de protecci√≥n antivirus de red y host, sistemas de detecci√≥n y prevenci√≥n de intrusiones a nivel de red. </li><li>  <b>Cumplimiento</b> (violaci√≥n del cumplimiento): la identificaci√≥n de los hechos de incumplimiento de las verificaciones definidas en las pol√≠ticas de cumplimiento.  En este caso, las pol√≠ticas de cumplimiento se refieren a los requisitos de PCI DSS, la Orden FSTEC No. 21 y los est√°ndares de seguridad corporativos. <br>  <b>Categor√≠as de tercer nivel</b> : control de integridad, control de configuraci√≥n del sistema operativo, control de configuraci√≥n de la aplicaci√≥n. <br>  <b>Tipos de or√≠genes de eventos</b> : esc√°neres de seguridad y auditor√≠a. </li><li>  <b>Fuga de informaci√≥n</b> : fuga de datos confidenciales a trav√©s de cualquier canal de comunicaci√≥n. <br>  <b>Categor√≠as de tercer nivel</b> : correo electr√≥nico, mensajer√≠a, red social, dispositivo m√≥vil, almacenamiento extra√≠ble. <br>  <b>Tipos de fuentes de eventos</b> : Sistemas de prevenci√≥n de fugas de datos (Rostelecom - Solar Dozor, InfoWatch Traffic Monitor). </li><li>  <b>Anomal√≠a</b> (anomal√≠as): una desviaci√≥n significativa de los par√°metros del objeto de protecci√≥n o su comportamiento de la norma establecida previamente. <br>  <b>Categor√≠as de tercer nivel</b> : Estad√≠stica, Comportamiento. <br>  <b>Tipos de or√≠genes de eventos</b> : herramientas de protecci√≥n de red de pr√≥xima generaci√≥n, sistemas de prevenci√≥n de fuga de datos, sistemas de clase de an√°lisis de comportamiento de usuarios y entidades (Splunk User Behavior Analytics, Securonix User and Entity Behavior Analytics, Exabeam Advanced Analytics). </li></ul><br><img src="https://habrastorage.org/webt/d8/zs/xq/d8zsxq3vzpqv8xa8p9415yzs_eg.png" alt="Sistema de categorizaci√≥n de eventos del IB.  Violaciones del nivel del entorno f√≠sico."><br>  <i>Sistema de categorizaci√≥n de eventos del IB.</i>  <i>Violaciones del nivel del entorno f√≠sico.</i> <br><br>  Las violaciones en el entorno f√≠sico, importantes desde el punto de vista de la seguridad de la informaci√≥n, tienen su propia "rama" separada en el sistema de categorizaci√≥n.  Es importante que en este caso el sistema de categorizaci√≥n tenga solo un nivel. <br><br>  Tal representaci√≥n "truncada" del sistema de categorizaci√≥n se debe principalmente a casos extremadamente raros de integraci√≥n SIEM con equipos de seguridad f√≠sica.  Las excepciones son los sistemas de control de acceso y contabilidad (ACS), que a menudo est√°n conectados a SIEM.  De lo contrario, al compilar esta "rama" del sistema de categorizaci√≥n, no ten√≠amos suficientes datos estad√≠sticos para sistematizar esta direcci√≥n en particular. <br><br><ul><li>  <b>Robo</b> (robo): el robo de medios f√≠sicos o dispositivos inform√°ticos (computadoras port√°tiles, tabletas, tel√©fonos inteligentes) con informaci√≥n confidencial del territorio de la empresa o de los empleados de la empresa. <br>  <b>Tipos de fuentes de eventos</b> : bases de incidentes del servicio de seguridad f√≠sica, sistemas de personal. </li><li>  <b>Intrusi√≥n</b> (penetraci√≥n f√≠sica): derivaci√≥n no autorizada o no regulada del sistema de protecci√≥n f√≠sica. <br>  <b>Tipos de fuentes de eventos</b> : bases de incidentes del servicio de seguridad f√≠sica, ACS, sistemas de seguridad perimetral. </li><li>  <b>Da√±o</b> (da√±o): da√±o dirigido, destrucci√≥n, reducci√≥n en la vida √∫til del equipo o canales de comunicaci√≥n. <br>  <b>Tipos de or√≠genes de eventos</b> : base de datos de incidentes de seguridad f√≠sica. </li></ul><br><h2>  Ejemplos de uso de sistemas de categorizaci√≥n </h2><br>  Aplicamos el sistema de categorizaci√≥n descrito para escribir reglas de correlaci√≥n de alto nivel y buscar eventos en el proceso de investigaci√≥n.  Considera dos situaciones. <br><br>  <b>Situaci√≥n 1</b> : mediante la regla de correlaci√≥n, es necesario identificar una fuga de informaci√≥n confidencial debido a la pirater√≠a de los activos del sistema automatizado.  SIEM recibe eventos de las siguientes caracter√≠sticas de seguridad: <br><br><ul><li>  sistemas de prevenci√≥n de fuga de datos; </li><li>  sistemas de detecci√≥n y prevenci√≥n de intrusos a nivel de red; </li><li>  sistemas de detecci√≥n y prevenci√≥n de intrusiones a nivel de host; </li><li>  herramienta de protecci√≥n antivirus. </li></ul><br>  Cada uno de ellos genera eventos IB, despu√©s de la normalizaci√≥n en los <b>campos</b> <b>Nivel1</b> , <b>Nivel2</b> , <b>Nivel3 de los</b> cuales se fijan las categor√≠as. <br>  El texto de la regla de correlaci√≥n en pseudoc√≥digo puede verse as√≠: <br><br><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#         .    ¬´Host_poisoning event Host_poisoning¬ª: #          ,        group by dst.host #     hostname/fqdn/ip ,     filter { Level2 = ‚ÄúMalicious Code‚Äù OR Level2 = ‚ÄúVulnerability Exploitation‚Äù } #           : event Data_leak: group by dst.host filter { Level2 = ‚ÄúInformation Leak‚Äù AND Level3 = ‚ÄúEmail‚Äù #        } #      Host_poisoning_and_data_leakage:   ¬´Host_poisoning¬ª,   ¬´Data_leak¬ª   24       : rule Host_poisoning_and_data_leakage: (Host_poisoning ‚Äî&gt; Data_leak) within 24h emit { #  ‚Äî    }</span></span></code> </pre> <br>  <b>Situaci√≥n 2:</b> estamos investigando el incidente en un host espec√≠fico: alexhost.company.local.  Debe comprender lo que le sucedi√≥ en el per√≠odo de 04:00 a 06:00 11/08/2018.  Durante este tiempo, hay alrededor de 21,6 millones de eventos de este host en el SIEM (el flujo de eventos promedio es de 3000 EPS).  Ahora son las 11:00 del 09/09/2018, todos los eventos est√°n en la base de datos SIEM, en el momento del incidente, no se establecieron reglas de correlaci√≥n en SIEM. <br><br>  Obviamente, analizar todos los eventos manualmente es una mala idea.  Es necesario reducir de alguna manera su volumen y localizar el problema.  Intentemos buscar eventos de inter√©s para nosotros en este conjunto.  Una consulta de ejemplo utilizar√° una sintaxis similar a SQL. <br><br><ol><li>  Aprendemos que "vimos" remedios en este momento: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (‚ÄúHost violations‚Äù, ‚ÄúNetwork violations‚Äù, ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">Physical</span></span> violations‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=‚Äúalexhost.company.local‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Supongamos que recibimos 10,000 eventos de violaciones de Host y dominios de violaciones de red para esta solicitud.  De todos modos, mucho, para an√°lisis manual. </li><li>  Tratemos de entender si el host pudo haber sido pirateado durante el incidente, y no nos importa qu√© tipo de protecci√≥n significa. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (‚ÄúVulnerability Exploitation‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=‚Äúalexhost.company.local‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Supongamos que recibimos 500 eventos para esta solicitud de los sistemas de detecci√≥n y prevenci√≥n de intrusiones a nivel de red y host.  Genial  Ya puedes trabajar con esto manualmente. </li><li>  Durante la investigaci√≥n, nos dimos cuenta de que el pirateo se produjo dentro de la empresa.  Intentaremos averiguar si alguna de las herramientas de protecci√≥n "vio" la instalaci√≥n o ejecuci√≥n de herramientas de pirater√≠a en cualquiera de los hosts de la compa√±√≠a. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level3 = ‚ÄúExploit kit‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;)</code> </pre> </li></ol><br><a name="Conclusion"></a><h1>  Conclusiones </h1><br>  Describimos los principios de la construcci√≥n de un sistema para clasificar eventos y presentamos los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">requisitos</a> que determinaron los enfoques y principios para su formaci√≥n.  Basado en los detalles de las fuentes de eventos conectados a SIEM, el sistema de categorizaci√≥n se dividi√≥ en dos √°reas: categorizaci√≥n de eventos de fuentes de TI y categorizaci√≥n de eventos de fuentes de informaci√≥n. <br><br>  El sistema de categorizaci√≥n de eventos de TI se form√≥ sobre la base de los siguientes principios: <br><br><ol><li>  Los eventos de TI reflejan las etapas o detalles de los procesos de TI que son compatibles o implementados por las fuentes de eventos. </li><li>  El sistema de categorizaci√≥n consta de 3 niveles principales y uno adicional que determina el √©xito o el fracaso de la acci√≥n descrita en el evento. </li><li>  En el primer nivel, los procesos de TI se distinguen dentro de los cuales opera la fuente de los eventos. </li><li>  El segundo nivel describe las entidades b√°sicas que est√°n involucradas en este proceso. </li><li>  El tercer nivel determina qu√© acciones realiza esta o esta entidad dentro del proceso. </li><li>  Un nivel adicional describe el estado de estas acciones (√©xito, fracaso). </li></ol><br>  El sistema de categorizaci√≥n de eventos del IB se basa en los siguientes principios: <br><br><ol><li>  La categorizaci√≥n se aplica exclusivamente a los eventos de seguridad de la informaci√≥n recopilados de los equipos de seguridad y no afecta la categorizaci√≥n de los ataques en sistemas automatizados.  Las diferencias entre los ataques y los eventos de seguridad de la informaci√≥n se dieron al comienzo del art√≠culo. </li><li>  El sistema de categorizaci√≥n consta de 3 niveles. </li><li>  En el primer nivel, se identifican dominios en los que se pueden registrar las violaciones de IS: violaciones del nivel de host, la red y el entorno f√≠sico. </li><li>  El segundo nivel de categorizaci√≥n est√° formado por clases espec√≠ficas de violaciones. </li><li>      ,     . </li></ol><br>                 . <br><br><img src="https://habrastorage.org/webt/_z/3m/ah/_z3mahc8mgidrucoua4fzcbwmgq.png" alt="Esquema general del sistema de categorizaci√≥n."><br> <i>   </i> <br><br>        .       ,        .         ,       ,     . <br><br><hr><br>  <b>Serie de art√≠culos:</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Profundidades SIEM: correlaciones listas para usar.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1: ¬ømarketing puro o un problema sin soluci√≥n?</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Profundidades SIEM: correlaciones listas para usar.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2. Esquema de datos como reflejo del modelo del "mundo"</a> <br><br>  Profundidades SIEM: correlaciones listas para usar.  3.1.   ( <i> </i> ) <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Profundidades SIEM: correlaciones listas para usar.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 3.2.   </a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Profundidades SIEM: correlaciones listas para usar.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 4. Modelo del sistema como contexto de reglas de correlaci√≥n</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Profundidades SIEM: correlaciones listas para usar.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 5. Metodolog√≠a para desarrollar reglas de correlaci√≥n</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es432352/">https://habr.com/ru/post/es432352/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es432342/index.html">Camunda BPM Meetup Raiffeisenbank UPD Broadcast</a></li>
<li><a href="../es432344/index.html">Cuatro etapas de desarrollo de ingenieros.</a></li>
<li><a href="../es432346/index.html">Noticias del mundo de OpenStreetMap No. 436 (20/11/2018 - 26/06/2018)</a></li>
<li><a href="../es432348/index.html">Clase magistral: moldeo al vac√≠o de pl√°sticos en silicona</a></li>
<li><a href="../es432350/index.html">¬øPor qu√© los elementos React tienen una propiedad $$ typeof?</a></li>
<li><a href="../es432354/index.html">Las filtraciones de datos m√°s significativas en 2018. Primera parte (enero-junio)</a></li>
<li><a href="../es432356/index.html">C√≥mo escribir una excelente fuente de noticias VKontakte en 20 horas</a></li>
<li><a href="../es432360/index.html">El "descendiente" AlphaGo aprendi√≥ independientemente a jugar ajedrez, shogi e ir</a></li>
<li><a href="../es432362/index.html">Chang'e 4 - la misi√≥n al otro lado de la luna comienza hoy</a></li>
<li><a href="../es432364/index.html">Alfabeto fon√©tico: c√≥mo una soluci√≥n para la aviaci√≥n ayudar√° a transferir un inicio de sesi√≥n por tel√©fono</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>