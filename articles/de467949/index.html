<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏽 📂 💼 Warum ist die Standardimplementierung von Schnittstellen nützlich? ✴️ 👨🏿‍🤝‍👨🏽 👨‍👧‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In meinem letzten Beitrag habe ich versprochen, über einige Fälle zu sprechen, in denen es meiner Meinung nach sinnvoll ist, die Verwendung von Standa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Warum ist die Standardimplementierung von Schnittstellen nützlich?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467949/">  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">meinem letzten</a> Beitrag habe ich versprochen, über einige Fälle zu sprechen, in denen es meiner Meinung nach sinnvoll ist, die Verwendung von Standardimplementierungen in Schnittstellen in Betracht zu ziehen.  Diese Funktion hebt natürlich nicht viele bestehende Konventionen zum Schreiben von Code auf, aber ich habe festgestellt, dass die Verwendung der Standardimplementierung in einigen Situationen zu saubererem und besser lesbarem Code führt (zumindest meiner Meinung nach). <br><a name="habracut"></a><br><h2>  Erweitern von Schnittstellen mit Abwärtskompatibilität </h2><br>  Die Dokumentation sagt: <br><blockquote>  Das häufigste Szenario ist das sichere Hinzufügen von Methoden zu einer Schnittstelle, die bereits veröffentlicht und von unzähligen Clients verwendet wird. </blockquote>  Das zu lösende Problem besteht darin, dass jede von der Schnittstelle geerbte Klasse eine Implementierung für die neue Methode bereitstellen muss.  Dies ist nicht sehr schwierig, wenn die Schnittstelle nur von Ihrem eigenen Code verwendet wird. Wenn sie sich jedoch in der öffentlichen Bibliothek befindet oder von anderen Befehlen verwendet wird, kann das Hinzufügen eines neuen Schnittstellenelements zu großen Kopfschmerzen führen. <br><br>  Betrachten Sie ein Beispiel: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Avalon</span></span> : <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make =&gt; <span class="hljs-string"><span class="hljs-string">"Toyota"</span></span>; }</code> </pre> <br>  Wenn ich dieser Schnittstelle eine neue <i>GetTopSpeed ​​()</i> -Methode hinzufügen möchte, muss ich ihre Implementierung in <i>Avalon</i> hinzufügen: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTopSpeed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Avalon</span></span> : <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make =&gt; <span class="hljs-string"><span class="hljs-string">"Toyota"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTopSpeed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">130</span></span>; }</code> </pre> <br>  Wenn ich jedoch eine Standardimplementierung der <i>GetTopSpeed ​​()</i> -Methode in <i>ICar erstelle</i> , muss ich sie nicht jeder geerbten Klasse hinzufügen. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTopSpeed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">150</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Avalon</span></span> : <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make =&gt; <span class="hljs-string"><span class="hljs-string">"Toyota"</span></span>; }</code> </pre> <br>  Bei Bedarf kann ich die Implementierung in Klassen, für die der Standard nicht geeignet ist, immer noch überladen: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTopSpeed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">150</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Avalon</span></span> : <span class="hljs-title"><span class="hljs-title">ICar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Make =&gt; <span class="hljs-string"><span class="hljs-string">"Toyota"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTopSpeed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">130</span></span>; }</code> </pre> <br>  Es ist wichtig zu berücksichtigen, dass die Standardmethode <i>GetTopSpeed ​​()</i> nur für Variablen verfügbar ist, die in <i>ICar umgewandelt wurden,</i> und <i>Avalon</i> nicht zur Verfügung steht, wenn sie nicht überladen ist.  Dies bedeutet, dass diese Technik am nützlichsten ist, wenn Sie mit Schnittstellen arbeiten (andernfalls wird Ihr Code mit vielen Casts an Schnittstellen überflutet, um Zugriff auf die Standardimplementierung der Methode zu erhalten). <br><br><h2>  Mixins und Eigenschaften (oder so ähnlich) </h2><br>  Ähnliche Sprachkonzepte von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mixins</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Merkmalen</a> beschreiben Möglichkeiten, das Verhalten eines Objekts durch Komposition zu erweitern, ohne dass eine Mehrfachvererbung erforderlich ist. <br><br>  Wikipedia berichtet über Mixins: <br><blockquote>  Mixin kann auch als Schnittstelle mit Standardmethoden betrachtet werden </blockquote>  Klingt das so? <br><br>  Trotz der Standardimplementierung sind Schnittstellen in <i>C #</i> keine Mixins.  Der Unterschied besteht darin, dass sie auch Methoden ohne Implementierung enthalten können, die Vererbung von anderen Schnittstellen unterstützen, spezialisiert werden können <i>(anscheinend bezieht sich dies auf Vorlagenbeschränkungen. - ca. Transl.)</i> Und so weiter.  Wenn wir jedoch eine Schnittstelle erstellen, die nur Methoden mit einer Standardimplementierung enthält, handelt es sich tatsächlich um ein traditionelles Mixin. <br><br>  Betrachten Sie den folgenden Code, der dem Objekt "Bewegung" Funktionen hinzufügt und dessen Position verfolgt (z. B. in Game Dev): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IMovable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Angle { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Speed { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// ,         public void Move() =&gt; Location = ...; } public class Car : IMovable { public string Make =&gt; "Toyota"; }</span></span></code> </pre> <br>  Autsch!  Es gibt ein Problem in diesem Code, das ich erst bemerkte, als ich anfing, diesen Beitrag zu schreiben und versuchte, ein Beispiel zu kompilieren.  Schnittstellen (auch solche mit einer Standardimplementierung) können den Status nicht speichern.  Daher unterstützen Schnittstellen keine automatischen Eigenschaften.  Aus der <a href="">Dokumentation</a> : <br><blockquote>  Schnittstellen können den Instanzstatus nicht speichern.  Obwohl statische Felder jetzt in Schnittstellen zulässig sind, können Instanzfelder immer noch nicht verwendet werden.  Daher können Sie keine automatischen Eigenschaften verwenden, da diese implizit versteckte Felder verwenden. </blockquote>  In diesem <i>C # stehen</i> Schnittstellen im Widerspruch zum Konzept der Mixins (soweit ich sie verstehe, können Mixins den Status konzeptionell speichern), aber wir können immer noch das ursprüngliche Ziel erreichen: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IMovable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Angle { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Speed { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// A method that changes location // using angle and speed public void Move() =&gt; Location = ...; } public class Car : IMovable { public string Make =&gt; "Toyota"; // ,         public (int, int) Location { get; set; } public int Angle { get; set; } public int Speed { get; set; } }</span></span></code> </pre> <br>  Auf diese Weise haben wir das erreicht, was wir wollten, indem wir die <i>Move ()</i> -Methode und ihre Implementierung allen Klassen zur Verfügung gestellt haben, die die <i>IMovable-</i> Schnittstelle implementieren.  Natürlich muss die Klasse noch eine Implementierung für die Eigenschaften bereitstellen, aber zumindest werden sie in der <i>IMovable-</i> Schnittstelle <i>deklariert</i> , wodurch die Standardimplementierung von <i>Move ()</i> mit ihnen arbeiten kann und sichergestellt wird, dass jede Klasse, die die Schnittstelle implementiert, den richtigen Status hat. <br><br>  Betrachten Sie als vollständigeres und praktischeres Beispiel ein Mixin für die Protokollierung: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ILogger</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; LoggerFactory .GetLogger(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.GetType().Name) .LogInfo(message); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LoggerFactory</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> ILogger </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConsoleLogger(name); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ConsoleLogger</span></span> : <span class="hljs-title"><span class="hljs-title">ILogger</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConsoleLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> { _name = name ?? <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(name)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; Console.WriteLine(<span class="hljs-string"><span class="hljs-string">$"[INFO] </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{_name}</span></span></span><span class="hljs-string">: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{message}</span></span></span><span class="hljs-string">"</span></span>); }</code> </pre> <br>  Jetzt kann ich in jeder Klasse von der <i>ILogger-</i> Schnittstelle erben: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Foo</span></span> : <span class="hljs-title"><span class="hljs-title">ILogger</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoSomething</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ((ILogger)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).LogInfo(<span class="hljs-string"><span class="hljs-string">"Woot!"</span></span>); } }</code> </pre><br>  Und so ein Code: <br><br><pre> <code class="cs hljs">Foo foo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Foo(); foo.DoSomething();</code> </pre> <br>  Ausgänge: <br><br><pre> <code class="bash hljs">[INFO] Foo: Woot!</code> </pre> <br><h2>  Erweiterungsmethoden ersetzen </h2><br>  Die nützlichste Anwendung, die ich gefunden habe, ist das Ersetzen einer großen Anzahl von Erweiterungsmethoden.  Kehren wir zu einem einfachen Protokollierungsbeispiel zurück: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ILogger</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Log</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> level, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span>; }</code> </pre> <br>  Bevor Standardimplementierungen in Schnittstellen angezeigt wurden, schrieb ich in der Regel viele Erweiterungsmethoden für diese Schnittstelle, sodass in einer geerbten Klasse nur eine Methode implementiert werden sollte, wodurch Benutzer Zugriff auf viele Erweiterungen haben würden: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ILoggerExtensions</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ILogger logger, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; logger.Log(<span class="hljs-string"><span class="hljs-string">"INFO"</span></span>, message); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ILogger logger, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; logger.Log(<span class="hljs-string"><span class="hljs-string">"INFO"</span></span>, <span class="hljs-string"><span class="hljs-string">$"[</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string">] message"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ILogger logger, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; logger.Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, message); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ILogger logger, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; logger.Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, <span class="hljs-string"><span class="hljs-string">$"[</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string">] </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{message}</span></span></span><span class="hljs-string">"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ILogger logger, Exception ex</span></span></span><span class="hljs-function">)</span></span> =&gt; logger.Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, ex.Message); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ILogger logger, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, Exception ex</span></span></span><span class="hljs-function">)</span></span> =&gt; logger.Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, <span class="hljs-string"><span class="hljs-string">$"[</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string">] </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{ex.Message}</span></span></span><span class="hljs-string">"</span></span>); }</code> </pre> <br>  Dieser Ansatz funktioniert gut, aber nicht ohne Mängel.  Beispielsweise stimmen Klassennamensräume mit Erweiterungen und Schnittstellen nicht unbedingt überein.  Dazu störendes visuelles Rauschen in Form eines Parameters und eines Links zu einer Logger-Instanz: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span> ILogger logger logger.Log</code> </pre> <br>  Jetzt kann ich die Erweiterungen durch Standardimplementierungen ersetzen: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ILogger</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Log</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> level, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; Log(<span class="hljs-string"><span class="hljs-string">"INFO"</span></span>, message); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; Log(<span class="hljs-string"><span class="hljs-string">"INFO"</span></span>, <span class="hljs-string"><span class="hljs-string">$"[</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string">] message"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, message); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> =&gt; Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, <span class="hljs-string"><span class="hljs-string">$"[</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string">] </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{message}</span></span></span><span class="hljs-string">"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Exception ex</span></span></span><span class="hljs-function">)</span></span> =&gt; Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, ex.Message); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, Exception ex</span></span></span><span class="hljs-function">)</span></span> =&gt; Log(<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>, <span class="hljs-string"><span class="hljs-string">$"[</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string">] </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{ex.Message}</span></span></span><span class="hljs-string">"</span></span>); }</code> </pre> <br>  Ich finde diese Implementierung sauberer und leichter zu lesen (und zu unterstützen). <br><br>  Die Verwendung der Standardimplementierung bietet gegenüber Erweiterungsmethoden noch einige weitere Vorteile: <br><br><ul><li>  Kann das nutzen </li><li>  Sie können nicht nur Methoden, sondern auch andere Elemente bereitstellen, z. B. Indexer </li><li>  Die Standardimplementierung kann überladen sein, um das Verhalten zu verdeutlichen. </li></ul><br>  Was mich im obigen Code verwirrt, ist, dass es nicht ganz offensichtlich ist, welche Schnittstellenmitglieder eine Standardimplementierung haben und welche Teil des Vertrags sind, den die geerbte Klasse implementieren soll.  Ein Kommentar, der die beiden Blöcke trennt, mag helfen, aber ich mag die strikte Klarheit der Erweiterungsmethoden in dieser Hinsicht. <br><br>  Um dieses Problem zu lösen, begann ich, Schnittstellen mit Mitgliedern mit der Standardimplementierung als <i>teilweise</i> zu deklarieren (außer vielleicht sehr einfachen).  Dann habe ich die Standardimplementierungen in eine separate Datei mit einer Namenskonvention der Form <i>"ILogger.LogInfoDefaults.cs"</i> , <i>"ILogger.LogErrorDefaults.cs"</i> usw. <i>eingefügt</i> .  Wenn es nur wenige Standardimplementierungen gibt und keine zusätzliche Gruppierung erforderlich ist, <i>nenne</i> ich die Datei <i>"ILogger.Defaults.cs"</i> . <br><br>  Dies trennt Mitglieder mit Standardimplementierung vom nicht implementierbaren Vertrag, für dessen Implementierung geerbte Klassen erforderlich sind.  Darüber hinaus können Sie sehr lange Dateien schneiden.  Es gibt auch einen kniffligen Trick beim Rendern von angehängten Dateien im <i>ASP.NET-</i> Stil in Projekten eines beliebigen Formats.  Fügen Sie dazu der Projektdatei oder in <i>Directory.Build.props Folgendes hinzu</i> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProjectCapability</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DynamicDependentFile"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProjectCapability</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DynamicFileNesting"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Jetzt können Sie im <i>Projektmappen-</i> <i>Explorer</i> <i>"Dateiverschachtelung"</i> auswählen und alle Ihre <i>.Defaults.cs-</i> Dateien werden als Nachkommen der "Haupt" -Schnittstellendatei <i>angezeigt</i> . <br><br>  Zusammenfassend lässt sich sagen, dass es immer noch mehrere Situationen gibt, in denen Erweiterungsmethoden bevorzugt werden: <br><br><ul><li>  Wenn Sie normalerweise mit Klassen arbeiten, nicht mit Schnittstellen (da Sie Objekte in Schnittstellen umwandeln müssen, um auf Standardimplementierungen zuzugreifen). </li><li>  Wenn Sie häufig Erweiterungen mit Vorlagen verwenden: <i>public static T SomeExt &lt;</i> <i>T</i> &gt; (dieses T foo) (z. B. in der <i>Fluent-API</i> ) </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467949/">https://habr.com/ru/post/de467949/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467925/index.html">Warum lieben Entwickler das dunkle Thema so sehr?</a></li>
<li><a href="../de467929/index.html">Wir organisieren Chaos oder wie man einen Prozessansatz in einer Organisation implementiert</a></li>
<li><a href="../de467933/index.html">Und doch, warum Posit eine würdige Alternative zu IEEE 754 sind</a></li>
<li><a href="../de467937/index.html">Frisches WordPress Online Shop Plugin</a></li>
<li><a href="../de467943/index.html">Grundlagen der Risiko- und geschäftsorientierten Informationssicherheit: Grundkonzepte und Paradigma</a></li>
<li><a href="../de467951/index.html">Habrastatistik: Leserkommentare analysieren. Teil 2, Antworten auf Fragen</a></li>
<li><a href="../de467953/index.html">Testen billiger virtueller Server</a></li>
<li><a href="../de467957/index.html">Was steckt hinter der Feigenbaum-Konstante?</a></li>
<li><a href="../de467959/index.html">Kosmologie und Quantenfluktuationen im Browser</a></li>
<li><a href="../de467961/index.html">Probleme und Nuancen bei der Entwicklung für SmartTV mit React.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>