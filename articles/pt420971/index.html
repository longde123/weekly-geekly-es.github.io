<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§µüèø üëßüèæ üçã Resposta de falha: cluster estendido em rela√ß√£o ao site de recupera√ß√£o de desastres ‚òÑÔ∏è üë®üèº‚Äçüé§ üèÇüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Temos duas abordagens para a recupera√ß√£o de falhas: um cluster "estendido" (instala√ß√£o ativo-ativo) e uma plataforma com m√°quinas virtuais (r√©plicas) ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Resposta de falha: cluster estendido em rela√ß√£o ao site de recupera√ß√£o de desastres</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/technoserv/blog/420971/"><img src="https://habrastorage.org/webt/vq/4b/8b/vq4b8bziie3zsdalswgid3zjmd8.jpeg"><br><br>  Temos duas abordagens para a recupera√ß√£o de falhas: um cluster "estendido" (instala√ß√£o ativo-ativo) e uma plataforma com m√°quinas virtuais (r√©plicas) desativadas.  Eles t√™m v√°rios pontos para salvar instant√¢neos. <br><br>  H√° um pedido de toler√¢ncia a desastres e muitos de nossos clientes realmente precisam.  Portanto, come√ßamos a elaborar os dois esquemas como parte de nossa produ√ß√£o. <br><br>  Os m√©todos t√™m pr√≥s e contras, agora vou falar sobre eles. <br><a name="habracut"></a><br><h3>  Cluster Esticado </h3><br><img src="https://habrastorage.org/webt/oe/au/pz/oeaupzuepknnmkaax9h1gsssvso.png"><br><br>  Como voc√™ pode ver, esta √© uma hist√≥ria padr√£o do cluster de metr√¥.  Nos profissionais - quase zero tempo de inatividade, uma pausa apenas no momento de iniciar as m√°quinas virtuais.  Esse recurso funciona - VMware High Availability (HA).  Ela v√™ que os hosts est√£o perdidos e reinicia imediatamente a VM no site remoto. <br><br>  O lan√ßamento √© feito imediatamente a partir do armazenamento, localizado no cluster. <br><br>  O armazenamento com um cluster distribu√≠do geograficamente √© um recurso de marketing da NetApp.  Outros fabricantes t√™m algo com um nome semelhante.  Em ess√™ncia, essa √© uma replica√ß√£o ass√≠ncrona pensada de um lado para o outro.  Escrevemos para um n√≥ na rede local e sincronizamos atrav√©s de canais de comunica√ß√£o especializados com outro. <br><br>  No caso de uma falha de um dos sistemas de armazenamento, o restante (em outro site) apresenta o caminho dos discos para os hosts restantes.  VMs que morreram s√£o reiniciadas nelas.  Tudo acontece automaticamente - o data center travou, tudo reiniciou, o armazenamento funcionou, o VMware funcionou.  O cliente viu que tudo piscou e reiniciou. <br><br>  O √∫nico cache da RAM da VM pode ser perdido.  Mas se o banco de dados jogou fora, a perda √© zero no tempo. <br><br>  Se perdermos a comunica√ß√£o entre os sites, tudo continuar√° funcionando em seu lugar e, assim que a conex√£o for restaurada, ela come√ßar√° a ser sincronizada. <br><br>  A desvantagem √© o pre√ßo alto.  Porque voc√™ realmente precisa de um SHD duplo (al√©m disso, semelhante em tipo, velocidade e volume de discos do primeiro SHD no site principal), que n√£o pode ser usado de alguma forma, exceto como reserva.  Al√©m de liga√ß√£o ao armazenamento para o cluster metropolitano, s√£o pontes FC, rede FC e muito mais. <br><br>  Temos dois DPCs, entre eles um pacote FC ao longo de dois feixes (quatro linhas √≥pticas escuras e DWDM).  Esses s√£o dois peda√ßos de ferro, cada um com 200 Gbps de largura de banda para FC e Ethernet. <br><br><h3>  Alternativa com DR </h3><br><img src="https://habrastorage.org/webt/90/zb/pk/90zbpkhak2hyp6hfmmt4afea1mo.png"><br><br>  H√° software com um nome intuitivamente memor√°vel - VMware vCloud Availability para DR de nuvem para nuvem. <br><br>  Este √© um sistema para criar uma VM id√™ntica em um site remoto uma vez, relativamente falando, em 15 minutos.  Um sistema para apresentar tudo isso da maneira correta aos mecanismos de controle da nuvem √© anexado a ele em fita isolante. <br><br>  Ou seja, a tecnologia VMware Replication est√° no back-end.  No caso de uma falha, lan√ßamos manualmente o plano de recupera√ß√£o de desastres no segundo site, ele para de tentar replicar automaticamente, registra a VM no vCloud Director, personaliza os endere√ßos IP (para que n√£o precise ser alterado para a VM) e inicia a VM na ordem necess√°ria.  Em nossa solu√ß√£o, n√£o √© necess√°rio alterar o endere√ßamento, estendemos as redes para os dois data centers. <br><br>  As m√°quinas est√£o sendo replicadas constantemente, mas n√£o o data center inteiro, mas apenas os selecionados s√£o processos cr√≠ticos.  Ele √© replicado de vez em quando, o intervalo m√≠nimo √© de 15 minutos (esse √© o caso ideal quando tudo voa e h√° um servidor de replica√ß√£o dedicado e um m√≠nimo de altera√ß√µes na VM).  Na pr√°tica, voc√™ tem uma c√≥pia meia hora ou uma hora atr√°s.  Se algo desse errado, os dados que ca√≠am no intervalo eram perdidos.  15 minutos √© a quest√£o do agente que coleta a nova replica√ß√£o.  A Veeam diz que eles podem levar menos de 15 minutos, mas na verdade tamb√©m √© mais demorado se eles n√£o usarem recursos de armazenamento.  Eu n√£o vi em uma m√°quina industrial (n√£o em um teste) que seria o contr√°rio. <br><br>  Por um longo tempo, a NetApp, como muitos outros fabricantes de sistemas de armazenamento, possui a tecnologia SnapMirror, que permite mudar o trabalho de replica√ß√£o de hipervisores para sistemas de armazenamento, e o VMware Replication pode us√°-lo. <br><br>  √Ä medida que o servi√ßo de replica√ß√£o √© executado, o trem vai longe.  Mas √© barato. <br><br>  Por que ainda √© barato - como voc√™ pode usar qualquer armazenamento de qualquer lado (de diferentes fabricantes, classes diferentes), n√£o √© necess√°rio alocar um grande volume de discos com anteced√™ncia. <br><br>  N√£o h√° necessidade de alocar um grande grupo de discos, dentro do qual as luas s√£o cortadas.  Ele apenas ocupa um lugar no armazenamento local e √© aplicado com base na disponibilidade do registro da m√°quina virtual.  Por esse motivo, o local no sistema de armazenamento √© otimamente ocupado, se usado para outras tarefas.  E √© usado, pois n√£o prestamos esse servi√ßo a todos os clientes. <br><br>  Menos - voc√™ precisa configurar a replica√ß√£o no n√≠vel da VM, ou seja, controlar se tudo est√° configurado corretamente, que esta √© a m√°quina, garantir que a replica√ß√£o seja aprovada, que n√£o haja erros.  Crie planos de DR para cada cliente, realize seus testes. <br><br>  No primeiro caso, o armazenamento √© realizado, condicionalmente, infraestruturalmente, quase por setores (mais precisamente, por objetos).  E ent√£o uma m√°quina pode cair devido a uma tarefa que cai devido a alguns motivos de software relacionados a um bug em n√≠veis altos ou devido a problemas de acessibilidade.  Isso acontece um pouco mais frequentemente do que se voc√™ tomar apenas n√≠veis baixos. <br><br>  No plus - DR armazena v√°rios pontos.  Voc√™ pode reverter alguns instant√¢neos. <br><br>  Fora do sistema operacional convidado, voc√™ precisa de software adicional. <br><br>  Para obter todas as redes necess√°rias para o Vcloud Director, precisamos do trabalho de nosso administrador.  Em geral, toda a conectividade de rede nesta vers√£o permanece com nosso administrador.  Para um cliente de nuvem, isso significa um aplicativo, que tamb√©m leva tempo. <br><br>  A replica√ß√£o tamb√©m √© configurada atrav√©s do aplicativo.  VM adicionada - voc√™ precisa enviar uma solicita√ß√£o para replic√°-la.  N√£o se enquadra nas tarefas de replica√ß√£o automaticamente.  √â necess√°rio prestar aten√ß√£o ao administrador. <br><br><h3>  A diferen√ßa </h3><br>  Como resultado, o pre√ßo pode diferir em mais de duas vezes.  A replica√ß√£o multiplicar√° o custo do espa√ßo em disco por duas ou mais (duas c√≥pias completas + hist√≥rico de altera√ß√µes), al√©m de algo para o servi√ßo e a reserva de recursos de computa√ß√£o.  No caso do cluster metropolitano, o custo do espa√ßo ser√° multiplicado por dois, mas o espa√ßo em si custar√° significativamente mais, al√©m de voc√™ precisar reservar firmemente os n√≥s em um site remoto.  Ou seja, os recursos de computa√ß√£o devem ser multiplicados por dois, n√£o podemos utiliz√°-los para mais nada. <br><br>  No caso do cluster metro, podemos usar apenas os mesmos tipos de discos para que haja um espelho completo.  Se no data center principal, algumas das unidades s√£o r√°pidas, outras lentas, com 10 mil rota√ß√µes por minuto, √© necess√°ria uma configura√ß√£o id√™ntica.  No caso de uma r√©plica, s√£o poss√≠veis discos mais lentos no site de backup, o que √© mais barato devido ao armazenamento.  Mas ao mudar para uma reserva, o desempenho ser√° menor.  Ou seja, se ele armazena algo no SSD no cluster principal e √© replicado para discos regulares, o armazenamento fica muito mais barato com o custo de diminuir a infraestrutura de reserva. <br><br>  No momento, estamos escolhendo o que ser√° inclu√≠do em uma vers√£o anterior, portanto, queremos consultar: voc√™ pode nos dizer brevemente como voc√™ organiza seus sites de recupera√ß√£o de desastres e o que voc√™ gostaria que eles fizessem em geral? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt420971/">https://habr.com/ru/post/pt420971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt420959/index.html">Os sistemas de IA otimizam o resfriamento do data center</a></li>
<li><a href="../pt420963/index.html">An√°lise de neg√≥cios: como abandonar o Excel sem abandon√°-lo</a></li>
<li><a href="../pt420965/index.html">Os seis relat√≥rios mais √∫teis do Frontend Conf 2018</a></li>
<li><a href="../pt420967/index.html">Ajudando a nadar: como apresentar os novatos a um projeto complexo</a></li>
<li><a href="../pt420969/index.html">Revista Cosmonautics News deixa de existir</a></li>
<li><a href="../pt420973/index.html">Configurando o UFW no Ubuntu Server 16.04 com o exemplo BigBlueButton</a></li>
<li><a href="../pt420975/index.html">N√£o fa√ßa isso na produ√ß√£o</a></li>
<li><a href="../pt420977/index.html">Truques QComboBox + QTreeView</a></li>
<li><a href="../pt420979/index.html">Redux Basics (livro did√°tico, 2¬™ edi√ß√£o)</a></li>
<li><a href="../pt420981/index.html">‚ÄúPosso falar sobre a dor comum de todos os desenvolvedores do iOS‚Äù - 10 perguntas para o programador, edi√ß√£o 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>