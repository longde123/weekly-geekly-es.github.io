<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîî üòò üî¨ DotVVM - Kommunikation zwischen Client und Server ‚úçüèø üéπ üéá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist der zweite Artikel in einer Reihe √ºber DotVVM. Der erste Artikel war eher eine Tatsachenfeststellung. Ich habe versucht, anhand eines einfach...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DotVVM - Kommunikation zwischen Client und Server</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412951/">  Dies ist der zweite Artikel in einer Reihe √ºber DotVVM.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der erste Artikel</a> war eher eine Tatsachenfeststellung.  Ich habe versucht, anhand eines einfachen Beispiels zu zeigen, wie man in DotVVM auf einer grundlegenden Ebene arbeitet.  Der Artikel ging in der Tat nicht auf das Wichtigste ein: wie es funktioniert. <br><br>  Dieser Artikel widmet sich diesem Problem sowie der Verkehrsoptimierung. <br><a name="habracut"></a><br>  In diesem Artikel wird die Kommunikation zwischen Client und Server genauer untersucht. <br>  Sie k√∂nnen ein Beispiel aus einem vorherigen Artikel mit einer Aufgabenliste √ºbernehmen.  In der dort verfassten Bewerbung konnten neue F√§lle hinzugef√ºgt und als erledigt markiert werden. <br><br><h2>  Kommunikation </h2><br>  Wenn eine Seite angefordert wird, wird die URL analysiert und DotVVM sucht sie in DotVVMStartup.cs, wo in der Routentabelle ein Pfad zur DOTHTML-Datei vorhanden ist, in der sich wiederum eine Direktive im ViewModel befindet. <br><br>  Das ViewModel ist in json serialisiert, wodurch dem ViewModel bestimmte Regeln auferlegt werden.  Alle √∂ffentlichen Methoden und √∂ffentlichen Eigenschaften (Zeichenfolge, Guid, Bool, Int, andere numerische Typen, DateTime, Sammlungen (Array, Liste) fallen in json. Im Fall von Liste kann es sich um eine Sammlung derselben einfachen Typen oder Objekte handeln, die diese Typen verwenden . <br><br>  Bei der Arbeit mit DotVVM in realen Projekten wurden verschiedene Regeln f√ºr die ViewModel-Architektur offenbart, die wir einhalten m√∂chten. <br><br><ul><li>  Verwenden Sie Entity Framework DbContext nicht direkt in ViewModel </li><li>  Zeigen Sie keine sauberen Entit√§ten in der Ansicht an, sondern verwenden Sie DTO (Data Transfer Objects). </li><li>  F√ºr mehr Kontrolle √ºber das ViewModel sollte es DotvvmViewModelBase erben </li></ul><br>  Angenommen, ViewModel wurde erfolgreich in json zusammengestellt, alle Front-End-Bindungen wurden in View generiert und die Seite geladen.  Alternativ haben die von DotvvmViewModelBase geerbten Methoden √ºbergeben: Init (), Load () und PreRender ().  Wenn Sie die Seite zum ersten Mal laden, kann das √úberschreiben dieser Funktionen hilfreich sein, aber das Wichtigste zuerst. <br><br><img src="https://habrastorage.org/webt/k0/c_/iq/k0c_iqh9wcejxpnpqmrrzljupws.png"><br><br>  F√ºgen Sie einen neuen Fall mit einer Liste hinzu. <br><br><ol><li>  AJAX POST wird von json des ge√§nderten ViewModel an den Server gesendet </li><li>  Das gleiche ViewModel wird in den Serverspeicher entladen, jedoch unver√§ndert </li><li>  <b>Mit Init ()</b> </li><li>  Das unver√§nderte Server-ViewModel wird mit dem vom Client stammenden Server verglichen </li><li>  Produziert von <b>Load ()</b> </li><li>  Die Methode selbst wird ausgef√ºhrt. </li><li>  <b>Von PreRender ()</b> </li><li>  Nach dem Vergleich werden die √Ñnderungen an den Client zur√ºckgesendet. </li></ol><br>  Wenn Ihr ViewModel DotvvmViewModelBase erbt, haben Sie Zugriff auf Init (), Load () und PreRender ().  Alle drei Methoden sind abstrakt und k√∂nnen erweitert und ge√§ndert werden. <br><br>  Auch in DotvvmViewModelBase gibt es eine Eigenschaft des Anforderungskontextes Context, von der aus Zugriff auf das Anforderungsobjekt, auf die IsPostBack-Eigenschaft, auf URL-Parameter und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vieles mehr besteht</a> . <br><br>  Das Senden mit jedem Postback des gesamten ViewModel ist nicht sehr effizient.  Um die gesendete Datenmenge zumindest irgendwie zu reduzieren, gibt es in DotVVM verschiedene Ans√§tze. <br><br><h4>  Attribut binden </h4><br>  Mit dem Bind-Attribut k√∂nnen Sie dem Compiler mitteilen, wie mit Eigenschaften im ViewModel umgegangen werden soll. <br><br><img src="https://habrastorage.org/webt/rx/k-/tk/rxk-tki0naesl5kdbpj_fg5-cvo.jpeg"><br><br><ul><li>  <b>[Bind (Direction.Both)]</b> - Die Standardeinstellung.  Daten werden bei jeder Anfrage gesendet. </li><li>  <b>[Bind (Direction.None)]</b> - Es wird haupts√§chlich f√ºr Dienste und Fassaden verwendet, die keiner Serialisierung unterzogen werden, aber in ViewModel zum Laden oder Speichern verwendet werden. </li><li>  <b>[Bind (Direction.ServerToClient)]</b> - Daten werden nur in einer Richtung vom Server zum Client gesendet.  Dies bedeutet nur beim Laden der Seite, nicht jedoch beim Postback. </li><li>  <b>[Bind (Direction.ServerToClientFirstRequest)]</b> - Ideal f√ºr statische Daten.  Zum Beispiel Optionen in einem Kombinationsfeld </li><li>  <b>[Bind (Direction.ClientToServer)]</b> - Daten werden nur in einer Richtung mit Postback vom Client zum Server gesendet. </li></ul><br><h4>  Statische Befehle </h4><br>  Mit DotVVM k√∂nnen Sie auch eine statische Methode auf dem Server anfordern.  Die Effektivit√§t solcher Methoden besteht darin, dass sie nur die Antwort senden, dh das gesamte ViewModel kommt vom Server, aber nur den Teil, den wir ben√∂tigen.  Solche statischen Methoden k√∂nnen Parameter annehmen und Werte zur√ºckgeben. <br><br>  In unserem Beispiel gibt es einen Ort, an dem Sie statische Befehle anwenden k√∂nnen.  Wenn wir einen Fall als erledigt markieren.  Es ist nicht erforderlich, das gesamte ViewModel an den Server zu senden. <br>  Sie k√∂nnen die MarkAsDone-Methode (ToDoItem-Element) in die statische Methode umschreiben, indem Sie sie in eine separate statische Klasse √ºbertragen und der Methode das Attribut <b>[AllowStaticCommand]</b> hinzuf√ºgen. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">FirstDotvvmApp</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ToDoItemValidator</span></span> { [AllowStaticCommand] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsDone</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre> <br>  Sie m√ºssen die Ansicht auch √§ndern, indem Sie eine Direktive mit dem Namespace hinzuf√ºgen, in dem sich unsere statische Klasse befindet. <br><br><pre> <code class="cs hljs">@import FirstDotvvmApp</code> </pre><br>  Die Schaltfl√§che verwendet nicht nur den Befehl, sondern auch staticCommand. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dot:Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Validation.Enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Visible</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{value: !IsDone}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Mark as done"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{staticCommand: IsDone = ToDoItemValidator.IsDone()}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dot:Button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Zum Vergleich k√∂nnen Sie sehen, wie viel Verkehr wir gespart haben. <br><br><img src="https://habrastorage.org/webt/si/iy/vg/siiyvg-x4hbzqeuxhprqdnd-3bm.jpeg"><br><br>  Normalerweise wird eine Kombination beider Ans√§tze verwendet, um Datenverkehr bei der Kommunikation mit realen Projekten zu sparen. <br><br><h4>  Referenzen </h4><br>  Weitere Beispiele zur Verwendung neuer Funktionen finden Sie <a href="">hier</a> . <br><br>  Ebenfalls k√ºrzlich gab es einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stream (Eng.) Auf DotVVM 2.0</a> , in dem √ºber die wichtigsten Innovationen und neuen Funktionen gesprochen wurde. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de412951/">https://habr.com/ru/post/de412951/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de412939/index.html">Tester gegen das Testen</a></li>
<li><a href="../de412941/index.html">Java Eastern European Conference 2018: Berichte und Eindr√ºcke</a></li>
<li><a href="../de412945/index.html">Abh√§ngigkeitsmanager</a></li>
<li><a href="../de412947/index.html">Lasttests in der Azure-Cloud. Wie teste ich einen gro√üen Online-Shop unter realen Bedingungen?</a></li>
<li><a href="../de412949/index.html">Astrologen k√ºndigen eine Woche iOS-Entwicklung in Avito an</a></li>
<li><a href="../de412953/index.html">Intel RealSense d435 Kamerakalibrierung mit OpenCV2 und ROS</a></li>
<li><a href="../de412955/index.html">UI-Tests in Xcode mit Embassy und Succulent</a></li>
<li><a href="../de412957/index.html">Mi Band 4 und Mi Band 5: Die Zukunft der Xiaomi Smart Bracelets</a></li>
<li><a href="../de412959/index.html">Zur Frage von AVR und Weltrekorden</a></li>
<li><a href="../de412961/index.html">Sharing Economy in der Telekommunikation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>