<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÇ üíµ üë∏üèº Comment configurer la recherche d'adresses par coordonn√©es (et o√π trouver le r√©pertoire n√©cessaire) üèÇüèæ üëáüèΩ üë®üèæ‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au printemps, nous avons ajout√© la fonction ¬´G√©ocodage invers√©¬ª √† l'API DaData.ru, √©galement appel√©e ¬´ Adresse par coordonn√©es ¬ª. Le nom indique: la m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment configurer la recherche d'adresses par coordonn√©es (et o√π trouver le r√©pertoire n√©cessaire)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/467787/"><img src="https://habrastorage.org/webt/_w/mf/y5/_wmfy5eag0qfwexxhm4qerr0-64.jpeg"><br><br>  Au printemps, nous avons ajout√© la fonction ¬´G√©ocodage invers√©¬ª √† l'API DaData.ru, √©galement appel√©e ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Adresse par coordonn√©es</a> ¬ª.  Le nom indique: la m√©thode prend des coordonn√©es g√©ographiques et fournit des donn√©es sur l'adresse. <br><br>  Un produit solide avec les m√™mes fonctionnalit√©s offre Yandex - il s'appelle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Geocoder</a> .  Mais le service Yandex est gratuit uniquement pour les projets non commerciaux ouverts.  Le tarif standard - √† partir de 120 000 ‚ÇΩ par an - ne convient pas √† tout le monde. <br><br>  Nous avons pens√© - si vous faites une alternative gratuite ou peu co√ªteuse √† "Geocoder", les d√©veloppeurs vous diront probablement merci.  Et ils l'ont fait.  Dans l'article, je vais vous expliquer le fonctionnement de la structure "Adresse par coordonn√©es": comment nous configurons la recherche, cr√©ons un r√©pertoire et l'empaquetons dans une m√©thode toute faite. <br><a name="habracut"></a><br><h2>  O√π obtenons-nous les donn√©es et comment recherchons-nous l'adresse </h2><br>  En approchant de la t√¢che, nous avons √©tudi√© des solutions toutes faites: o√π trouver le r√©pertoire de coordonn√©es avec des adresses et comment ensuite rechercher des objets g√©ographiques √† partir de ce r√©pertoire.  Il s'est av√©r√© que vous n'avez m√™me pas besoin d'aller loin pour les bons outils. <br><br>  <b>Nous prenons les objets d'adresse dans FIAS</b> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Federal Information Address System</a> .  Il s'agit du r√©pertoire d'adresses ouvert et officiel le plus complet.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nous avons d√©j√† √©crit</a> √† ce sujet en d√©tail sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Habr√©</a> , et maintenant quatre faits sont importants: <br><br><ul><li>  FIAS stocke tous les objets adressables du pays, des r√©gions et en dessous - aux b√¢timents et territoires suppl√©mentaires; </li><li>  le r√©pertoire est disponible gratuitement aux formats DBF et XML; </li><li>  FIAS n'est pas parfait - il manque des dizaines de milliers de maisons et de nombreuses rues, en particulier de nouvelles; </li><li>  Chaque objet adresse du r√©pertoire correspond √† un code ID - FIAS unique.  Le code objet est parfois modifi√©, mais pour notre article, ce n'est pas si important. </li></ul><br>  Les objets d'adresse t√©l√©charg√©s depuis FIAS avec ID sont la base de notre annuaire pour le g√©ocodage invers√©. <br><br>  <b>T√©l√©chargez les coordonn√©es depuis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenStreetMap</a> (OSM).</b>  OSM est un projet avec une licence gratuite: les passionn√©s collectent les coordonn√©es de divers objets et les affichent √† tout le monde. <br><br>  En termes simples, OSM est un ensemble de points, de lignes et de polygones sur une carte.  Chaque objet a sa propre description, type et ensemble de coordonn√©es.  Les donn√©es OSM pour la Russie se trouvent sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">needgeo.com</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">osm.sbin.ru/osm_dump/</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">osmosis.svimik.com/latest/</a> . <br><br><img src="https://habrastorage.org/webt/ws/p6/hy/wsp6hyjy8brd4qmc11clfyoulic.png"><br>  <sub>La liste des sources est publi√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur une page sp√©ciale sur le ¬´Wiki¬ª du projet</a></sub> <br><br>  Le d√©chargement consiste en des fichiers PBF - ce format est utilis√© √† la place de XML comme un format plus compact.  Transformer PBF en OSM XML ne co√ªte rien, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tas d'utilitaires approuv√©s par la communaut√© peuvent</a> g√©rer cela. <br><br>  Pour notre propre r√©pertoire, nous prenons les objets d'adresse de FIAS, puis recherchons leurs coordonn√©es dans OSM.  S'il est trouv√©, enregistrez les donn√©es combin√©es.  Il s'av√®re une telle intersection de FIAS et OSM. <br><br>  Et tout cela est merveilleux, mais il y a un probl√®me: les choses ne sont pas faciles avec la qualit√© des donn√©es dans OSM.  Les coordonn√©es des objets ne correspondent souvent pas √† la r√©alit√©.  Par exemple, les polygones pour les r√©gions et les districts sont ad√©quats.  Mais pour les villes et en dessous - pas tant. <br><br><img src="https://habrastorage.org/webt/dc/hn/uh/dchnuhisbetq44m1uyd8sniuy20.png"><br>  <sub>Les polygones sont des polygones qui d√©limitent des zones sur une carte.</sub>  <sub>Ils se composent d'un ensemble de points li√©s avec des coordonn√©es.</sub>  <sub>Les polygones indiquent les limites des r√©gions, des quartiers, des villes et m√™me des b√¢timents</sub> <br><br>  Le travail principal, et dans une large mesure, consiste √† collecter des donn√©es ad√©quates aupr√®s de l'OSM et √† √©liminer le mariage.  La t√¢che est si volumineuse que je lui ai consacr√© une section distincte dans l'article. <br><br>  <b>Nous t√©l√©chargeons √©galement des maisons qui ne sont pas dans FIAS √† partir d'OSM.</b>  Comme je l'ai dit plus haut, il y a des dizaines de milliers de logements √† FIAS.  Ce n'est m√™me pas un probl√®me, mais simplement une r√©alit√©, un arri√®re-plan.  Par cons√©quent, nous r√©approvisionnons notre r√©pertoire avec des maisons d'OSM.  Mais seulement ceux pour lesquels il y a une rue √† FIAS.  Les b√¢timents provenant d'OSM n'ont pas d'ID FIAS, nous les identifions donc comme <i>code FIAS + num√©ro de maison</i> du <i>parent</i> . <br><br>  <b>Dans le r√©pertoire que nous recherchons avec l'aide de la belle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lucene</a></b> - notre assistante √† long terme.  Merci pour le conseil, √† un Indien bien vers√© qui a √©crit le post <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Indexing Geographical Data With Lucene</a> (un bon ajout est le mat√©riel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ad spatial dans les algorithmes de recherche spatiale</a> - sur les kd-arbres sur lesquels l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">algorithme de recherche</a> est construit). <br><br>  D√®s que nous avons d√©couvert Lucene, le probl√®me de recherche a √©t√© r√©solu presque tout seul.  Les affaires restent - optez pour du papier de verre. <br><br><ol><li>  Nous avons charg√© dans Lucene votre r√©pertoire de coordonn√©es et d'adresses, obtenu un index de recherche.  Pour plus de facilit√©, presque tout a √©t√© supprim√©, ne laissant que les identifiants et coordonn√©es des adresses. </li><li>  Nous mettons en place une recherche par index: entr√©e - coordonn√©es, sortie - ID des objets d'adresse trouv√©s.  La recherche ne renvoie pas d'autres informations, car l'index a √©t√© totalement raccourci. </li><li>  Satisfait de l'√©mission, chargement des donn√©es de la "grande" FIAS par les identifiants trouv√©s.  Nous ajoutons beaucoup de tout, de l'adresse dont tout le monde a besoin en une seule ligne au signe de la capitale r√©gionale des villes. </li><li>  Nous avons compris comment trier et donner les objets re√ßus. </li></ol><br>  Jusqu'√† pr√©sent, tout semble simple, mais ce n'est qu'une petite partie du travail.  Aucune recherche d'adresse par coordonn√©es n'aurait fonctionn√© si nous n'avions pas compil√© un r√©pertoire d√©cent. <br><br><h2>  Comment collecter la base de coordonn√©es et d'adresses </h2><br>  Pour commencer, je vais disposer les bagages: apr√®s avoir lu l'article, faire rapidement un tel manuel ne fonctionne pas.  Nous le collectons depuis 2014, en le compl√©tant constamment.  Je vais parler de ce putain de long chemin. <br><br>  La partie la plus difficile lors de la compilation d'un r√©pertoire est de trier les coordonn√©es provenant d'OSM.  Au d√©but, nous les avons v√©rifi√©s du mieux que nous pouvions, y compris avec nos mains.  L'objectif principal √©tait alors d'obtenir des points de r√©f√©rence dans les grandes villes et d'en faire un guide de r√©f√©rence.  Maintenant qu'il existe de nombreux points de ce type, il n'est presque plus n√©cessaire de v√©rifier manuellement les nouvelles donn√©es.  √Ä la fois, nous ajoutons 200 000 √† 300 000 adresses avec coordonn√©es au r√©pertoire de r√©f√©rence, et voici comment proc√©der. <br><br>  <b>Nous formons des adresses compl√®tes √† partir de balises OSM.</b>  Dans les t√©l√©chargements OSM, les composants des adresses sont dispers√©s par diff√©rentes balises: <br><br><ul><li>  <i>addr: ville - village Bulatnikovo</i> ; </li><li>  <i>addr: rue - rue centrale</i> ; </li><li>  <i>addr: num√©ro de maison - 103</i> . </li></ul><br>  Nous parcourons les tags et collectons l'adresse compl√®te d'eux: <i>village Bulatnikovo, 103, rue Central</i> . <br><br>  <b>Nous ex√©cutons chaque nouvelle adresse via l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API de normalisation Dadat</a> .</b>  Le service convertit les adresses dans un format unique "comme dans FIAS": <br><br><ul><li>  corrige les fautes de frappe; </li><li>  d√©code les abr√©viations comme "NiNo" et "Msk"; </li><li>  change les anciens noms en nouveaux; </li><li>  trouve la ville manquante dans l'adresse par index; </li><li>  d√©finit un code FIAS. </li></ul><br>  Les adresses de l'API sont propres, bien qu'elles envoient maintenant une lettre ou un colis. <br><div class="scrollable-table"><table><tbody><tr><th>  Avant la normalisation </th><th>  Apr√®s </th></tr><tr><td>  <i>Bulatnikovo village, Central Street, 103</i> </td><td><p>  <i>142718, r√©gion de Moscou, quartier Leninsky, avec Bulatnikovo, rue centrale, 103.</i> </p><br><p>  Code FIAS - <i>a8b6a52f-e96d-4ec3-a0ff-641013ab0445</i> </p></td></tr></tbody></table></div>  Nous stockons les maisons, les rues et les colonies standardis√©es comme un seul point.  Pour la rue et le village, ce point est le centre.  Par cons√©quent, tous les objets d'adresse sont dans la m√™me table, √† l'int√©rieur - l'adresse, l'ID FIAS, la latitude et la longitude. <br><div class="scrollable-table"><table><tbody><tr><th>  L'adresse </th><th>  ID FIAS </th><th>  Latitude </th><th>  Longitude </th></tr><tr><td>  <i>142718, r√©gion de Moscou, quartier Leninsky, avec Bulatnikovo, rue centrale, 103</i> </td><td>  <i>a8b6a52f-e96d-4ec3-a0ff-641013ab0445</i> </td><td>  <i>55,558773</i> </td><td>  <i>37,667103</i> </td></tr><tr><td>  <i>119034, Moscou, voie Turchaninov, d 6 bldg.2</i> </td><td>  <i>8c925e61-9173-48b3-999e-dc85c86d89e7</i> </td><td>  <i>55,737096</i> </td><td>  <i>37,597190</i> </td></tr></tbody></table></div>  <b>Nous analysons les adresses que Dadata n'a pas standardis√©es.</b>  Les adresses qui n'ont pas pu √™tre mises en correspondance avec FIAS sont marqu√©es d'un drapeau par le service.  Nous les v√©rifions manuellement, il existe plusieurs options. <br><br><ol><li>  L'adresse n'est pas entr√©e dans les balises de t√©l√©chargement OSM appropri√©es, mais le diable sait o√π.  √âtiquettes d'adresse remplies et non remplies, et la ville dans l'√©tiquette de rue, et bien plus encore. </li><li>  Dans OSM se trouve un objet exotique comme une aire de jeux, un terrain de football universitaire ou m√™me un cimeti√®re.  Il n'y a rien de tel dans FIAS, et pour nos besoins, ces r√©sultats ne conviennent pas.  Ces objets sont simplement filtr√©s. </li><li>  Une erreur - et pas une erreur du tout.  Par exemple, un quartier d'une ville qui n'existe pas dans FIAS provenait de l'OSM.  Ou dans OSM, l'objet est situ√© dans une colonie, mais dans FIAS, cette colonie a √©t√© attach√©e √† la ville et supprim√©e.  Ensuite, nous terminons l'algorithme pour les donn√©es charg√©es et le r√©ex√©cutons. </li></ol><br><img src="https://habrastorage.org/webt/_u/yc/1u/_uyc1uds-xef7yiwtpu01vgk7ju.png"><br>  <sub>Analyser le d√©chargement, et l√† - confusion dans les balises</sub> <br><br>  <b>Nous v√©rifions l'ad√©quation des coordonn√©es charg√©es.</b>  Pour ce faire, nous regardons avec un utilitaire sp√©cial si les coordonn√©es du nouvel objet tombent dans le polygone de la r√©gion ou du district parent.  Si l'adresse informe que l'objet se trouve dans la r√©gion d'Omsk, veuillez avoir la gentillesse de rentrer dans sa d√©charge.  L'entr√©e dans la ville n'est pas obligatoire - toutes les villes ne sont pas couvertes avec pr√©cision dans OSM, pour beaucoup, les donn√©es ne sont pas mises √† jour. <br><br>  Nous chargeons les polygones de r√©f√©rence depuis OSM et les stockons tels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">quels</a> - au format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GeoJSON</a> .  Pour choisir le polygone √† essayer sur un point, regardez dans un tableau s√©par√©.  Dans ce document, nous avons compar√© les pr√©fixes des codes CLADR et les ID de polygone: vous trouvez le code CLADR pour l'adresse et vous voyez quel polygone choisir. <br><br><img src="https://habrastorage.org/webt/f_/ud/tt/f_udtt5i_rael-f2i8exqc-4k0g.png"><br>  <sub>Le code KLADR est un identifiant unique utilis√© avant la FIAS.</sub>  <sub>Un million de services peuvent trouver ce code pour une adresse</sub> <br><br>  L'utilitaire permet √† l'objet de se tenir √† 1 700 m√®tres de la d√©charge.  Cette r√®gle a √©t√© ajout√©e en raison des autoroutes qui d√©passent souvent les fronti√®res de la r√©gion.  Mais une distance sup√©rieure √† 1700 m√®tres est un signe d'erreur, selon les statistiques. <br><br>  Sur ceci pour les villes et les rues, le contr√¥le se termine. <br><br>  <b>Encore une fois, plus strictement, nous v√©rifions les coordonn√©es charg√©es des maisons.</b>  L'utilitaire mentionn√© √† nouveau entre en jeu, et c'est ce qu'il fait. <br><br><ol><li>  Il prend l'adresse de la nouvelle maison et trouve des voisins pour lui dans le r√©pertoire de r√©f√©rence. </li><li>  Selon les coordonn√©es, il consid√®re la distance entre la nouvelle maison non v√©rifi√©e et les voisins fiables. </li></ol><br><img src="https://habrastorage.org/webt/sx/vx/y-/sxvxy-u2l54hlaggzda0zx8u-tw.jpeg"><br>  <sub>Il est facile de trouver des voisins: 1. Nous prenons une nouvelle maison et trouvons l'ID FIAS du parent.</sub>  <sub>2. Nous s√©lectionnons dans l'annuaire de r√©f√©rence les maisons dont les parents ont le m√™me identifiant FIAS</sub> <br><br>  L'inspection est effectu√©e uniquement √† domicile, √† moins de 150 m√®tres de coll√®gues fiables.  De plus, nous consid√©rons chaque nouvelle maison approuv√©e lors de l'analyse des √©l√©ments suivants.  Voici comment cela fonctionne. <br><br>  Supposons que, dans le guide de r√©f√©rence, les maisons <i>n ¬∞ 1, 2 et 3</i> soient stock√©es le <i>long de la rue Kommunarov</i> .  Dans les nouvelles donn√©es, les maisons <i>n ¬∞ 5, 6 et 7 se trouvaient</i> dans la m√™me rue.  A en juger par les coordonn√©es, les nouvelles maisons sont √† proximit√©.  L'utilitaire voit que la maison <i>num√©ro 5</i> est √† c√¥t√© des maisons <i>num√©ro 1, 2 et 3</i> et l'ajoute au r√©pertoire de r√©f√©rence.  Ainsi, les maisons <i>num√©ro 6 et 7 sont</i> √©galement test√©es. <br><br>  Et puis le sort des donn√©es provenant d'OSM est d√©cid√©: <br><br><ul><li>  maisons qui ont pass√© les deux contr√¥les: pour les d√©charges et pour les voisins, nous ajoutons au r√©pertoire de r√©f√©rence; </li><li>  si l'objet ne tombe pas dans le polygone, les nouvelles donn√©es ne conviennent pas.  De m√™me si la distance entre la maison et les voisins est trop grande; </li><li>  les maisons qui n'ont pas de voisins, nous reportons.  Ils se trouvent dans une base de donn√©es distincte, un jour nous analyserons. </li></ul><br>  <b>Nous divisons les objets test√©s en deux parties.</b>  Ils iront aux diff√©rentes plaques de notre manuel de r√©f√©rence. <br><br><img src="https://habrastorage.org/webt/60/mh/30/60mh30nzsamn2rv_gegjgooqusy.png"><br>  <sub>Dans le premier tableau - tous les objets avec ID FIAS aux maisons: r√©gions, agglom√©rations, rues.</sub>  <sub>Dans le second - √† la maison et un lien vers le parent de la premi√®re table</sub> <br><br>  Deux tables sont n√©cessaires pour attribuer les cl√©s aux maisons manquantes dans FIAS.  Ils n'ont pas leur propre code FIAS, alors voici comment: <br><br><ul><li>  nous collectons des objets d'adresse √† la maison dans une table, chacun d'eux a son propre code FIAS; </li><li>  dans le second - uniquement √† la maison, en se r√©f√©rant au parent dans le premier tableau. </li></ul><br>  √Ä la suite d'un immeuble sans code FIAS, nous identifions l' <i>ID + le num√©ro de maison</i> du <i>parent √† l'</i> aide de la cl√© <i>FIAS</i> . <br><br>  <b>La r√©f√©rence est pr√™te, il reste √† tester.</b>  Nous ex√©cutons un service de test fonctionnel pendant la nuit et testons les performances.  Nous v√©rifions la vitesse √† Moscou, en demandant toutes les maisons dans un rayon de trois kilom√®tres.  Pour √™tre s√ªr.  Bien s√ªr, ils ont tout recouvert d'autotests. <br><br>  L'essentiel apr√®s la mise √† jour est de ne pas empirer. <br><br><h2>  G√©ocodage invers√© √† travers les yeux de l'utilisateur </h2><br>  La m√©thode de saisie prend trois param√®tres: coordonn√©es, nombre de r√©sultats et rayon de recherche.  Le rayon par d√©faut est de 100 m√®tres, le maximum est d'un kilom√®tre.  La valeur exacte est d√©finie dans les param√®tres. <br><br><pre><code class="java hljs">curl -X POST \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Authorization: Token ${API_KEY}"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">'{ "lat": 55.878, "lon": 37.653, "radius_meters": 50 }'</span></span> \ https:<span class="hljs-comment"><span class="hljs-comment">//suggestions.dadata.ru/suggestions/api/4_1/rs/geolocate/address</span></span></code> </pre> <br>  La m√©thode renvoie les objets trouv√©s: maisons, rues et habitations.  Il les trie par ordre d√©croissant de pr√©cision. <br><br><ol><li>  √Ä la maison. </li><li>  Les rues. </li><li>  R√®glements. </li><li>  Les villes </li></ol><br>  Ensuite, il trie √† nouveau - par distance des coordonn√©es donn√©es.  Si la m√©thode a trouv√© quatre maisons et une rue, les maisons se tiendront d'abord par ordre de distance d'un point donn√©.  Derri√®re eux, la rue. <br><br>  Apr√®s tous ces ch√¢teaux, la m√©thode retourne enfin les objets qu'elle a trouv√©s. <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"suggestions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unrestricted_value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: {...} }, { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unrestricted_value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: {...} } ] }</code> </pre> <br>  √Ä l'int√©rieur - beaucoup de choses diff√©rentes sur les objets trouv√©s: lignes avec l'adresse compl√®te et abr√©g√©e, noms actuels et obsol√®tes, code postal, code FIAS de l'objet parent et ainsi de suite. <br><br><img src="https://habrastorage.org/webt/c5/_4/8i/c5_48iyueonoygc22saytynllr4.png"><br>  <sub>Toutes les donn√©es fournies par la m√©thode se trouvent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans la documentation</a></sub> <br><br>  La couverture par coordonn√©es pour diff√©rentes r√©gions est diff√©rente, comme ceci avec les maisons: <br><br><ul><li>  Moscou - 96%, </li><li>  Saint-P√©tersbourg - 88%, </li><li>  autres millions de villes - 74%, </li><li>  le reste de la Russie est de 47%. </li></ul><br>  Et le voici - couvrant les rues: <br><br><ul><li>  Moscou - 92% </li><li>  Saint-P√©tersbourg - 79%, </li><li>  autres villes millionnaires - 75%, </li><li>  le reste de la Russie est de 67%. </li></ul><br>  Ils ne consid√©raient pas les villes - √† l'√©chelle de la Russie, m√™me le fait d'appartenir au titre fier de la ville √©tait instable.  Par exemple, la <i>r√©gion de Yaroslavl, le district de Poshekhonsky, s / o Fedorkovsky</i> est une ville, selon le r√©pertoire officiel de la FIAS.  Mais en fait, et √† l'adresse - le district rural.  Physiquement, le district rural ressemble √† l'union de plusieurs villages dans une grande tache.  Il est difficile non seulement de d√©terminer le centre, mais m√™me de trouver la colonie sur la carte. <br><br>  Nous r√©fl√©chissons d√©j√† √† ce qu'il faut ajouter √† la m√©thode: permettre le filtrage par type d'objet, renvoyer la distance √† un point donn√©, autre chose.  Nous surveillons la demande et d√©cidons d'investir. <br><br>  Sinon, tout est d√©j√† sur la prod.  Jusqu'√† 10 000 demandes par jour - gratuitement, plus - par abonnement √† partir de 5 000 ‚ÇΩ par an.  Si vous avez besoin d'adresses par coordonn√©es pour un projet commercial et que Geocoder est trop cher, essayez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'API Dadati</a> . <br><br>  <i>L'article original est publi√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le blog HFLabs</a> .</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467787/">https://habr.com/ru/post/fr467787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467775/index.html">5 mythes sur les affaires: pourquoi le client a tort et comment d√©passer Apple</a></li>
<li><a href="../fr467779/index.html">√Ä propos de Godot, GLSL et WebGL, shaders utilis√©s dans le mini-jeu</a></li>
<li><a href="../fr467781/index.html">Cours C ++ au centre CS, premi√®re partie</a></li>
<li><a href="../fr467783/index.html">Comment un informaticien peut-il travailler et vivre en Suisse</a></li>
<li><a href="../fr467785/index.html">Comment optimiser les pandas lorsque vous travaillez avec de grands ensembles de donn√©es (essai)</a></li>
<li><a href="../fr467789/index.html">Java 13 vient d'arriver. ZGC a commenc√© √† partager la m√©moire, CDS se souvient des classes et d'autres merveilles techniques</a></li>
<li><a href="../fr467791/index.html">Analyse du d√©filement des pages dans Google Data Studio</a></li>
<li><a href="../fr467793/index.html">Pile technologique ennuyeuse d'une entreprise Internet unipersonnelle</a></li>
<li><a href="../fr467795/index.html">Remarque sur les crypto-monnaies et la r√©glementation de l'√âtat</a></li>
<li><a href="../fr467797/index.html">"Riez pour le plaisir de": pourquoi pourriez-vous avoir besoin d'outils logiciels qui n'ont pas d'application "de combat"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>