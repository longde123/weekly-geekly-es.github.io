<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÅ‚Äçüó® ‚ò†Ô∏è üññ Lancement de Bash en d√©tail ü§∑üèΩ ‚ôèÔ∏è üë®‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si vous avez trouv√© cette page dans une recherche, vous essayez probablement de r√©soudre un probl√®me avec l'ex√©cution de bash. 

 Il est possible que ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lancement de Bash en d√©tail</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452410/">  Si vous avez trouv√© cette page dans une recherche, vous essayez probablement de r√©soudre un probl√®me avec l'ex√©cution de bash. <br><br>  Il est possible que votre environnement bash ne d√©finisse pas de variable d'environnement et que vous ne compreniez pas pourquoi.  Vous pouvez avoir ins√©r√© quelque chose dans divers fichiers de d√©marrage bash ou dans des profils, ou dans tous les fichiers au hasard jusqu'√† ce que cela fonctionne. <br><br>  Dans tous les cas, le but de cette note est de d√©crire la proc√©dure de d√©marrage de bash aussi facilement que possible afin de pouvoir r√©soudre les probl√®mes. <br><br><h2>  Graphique </h2><br>  Cet organigramme r√©sume tous les processus lors du d√©marrage de bash. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6d/dca/884/c6ddca8846f8c34fd80e003c91c4356b.png"><br><br>  Examinons maintenant de plus pr√®s chaque partie. <br><a name="habracut"></a><br><h2>  Login Shell? </h2><br>  Vous devez d'abord choisir si vous √™tes dans le shell de connexion ou non. <br><br>  Le shell de connexion est le premier shell que vous entrez lorsque vous vous connectez √† une session interactive.  Le shell de connexion ne n√©cessite pas de nom d'utilisateur ni de mot de passe.  Vous pouvez forcer le lancement du shell de connexion en ajoutant l'indicateur <code>--login</code> lors de l'appel de <code>bash</code> , par exemple: <br><br><pre>  bash --login </pre><br>  Le shell de connexion configure l'environnement de base lors de la premi√®re ex√©cution du shell bash. <br><br><h2>  Interactif? </h2><br>  Ensuite, vous d√©terminez si le shell est interactif ou non. <br><br>  Cela peut √™tre v√©rifi√© par la pr√©sence de la variable <code>PS1</code> (elle d√©finit la fonction d'entr√©e de commande): <br><br><pre>  if ["$ {PS1-}"];  alors
   √©cho interactif
 d'autre
   √©cho non interactif
 fi </pre><br>  Ou voyez si l'option <code>-i</code> est d√©finie √† l'aide d'une variable de trait d'union sp√©ciale dans bash, par exemple: <br><br><pre>  $ echo $ - </pre><br>  S'il y a un <code>i</code> dans la sortie, alors le shell est interactif. <br><br><h2>  Dans le shell de connexion? </h2><br>  Si vous √™tes dans le shell de connexion, bash recherche le fichier <code>/etc/profile</code> et s'ex√©cute s'il existe. <br><br>  Il recherche ensuite l'un de ces trois fichiers dans l'ordre suivant: <br><br><pre>  ~ / .bash_profile
 ~ / .bash_login
 ~ / .profile </pre><br>  Quand il en trouve un, il le lance et saute les autres. <br><br><h2>  Dans un shell interactif? </h2><br>  Si vous √™tes dans un shell interactif sans connexion (shell sans connexion), il est suppos√© que vous avez d√©j√† visit√© le shell de connexion, l'environnement est configur√© et sera h√©rit√©. <br><br>  Dans ce cas, les deux fichiers suivants sont ex√©cut√©s dans l'ordre, s'ils existent: <br><br><pre>  /etc/bash.bashrc
 ~ / .bashrc </pre><br><h2>  Pas une seule option? </h2><br>  Si vous n'√™tes ni dans le shell de connexion ni dans le shell interactif, votre environnement sera en effet vide.  Cela provoque beaucoup de confusion (voir les t√¢ches cron ci-dessous). <br><br>  Dans ce cas, bash examine la variable <code>BASH_ENV</code> de votre environnement et ex√©cute le fichier correspondant qui y est r√©pertori√©. <br><br><h2>  Difficult√©s et r√®gles g√©n√©rales typiques </h2><br><h4>  Emplois Cron </h4><br>  <b>Dans 95% des cas, j'ai d√©bogu√© le lancement bash car le travail cron ne fonctionne pas comme pr√©vu.</b> <br><br>  Cette fichue t√¢che <b>fonctionne tr√®s bien lorsque je l'ex√©cute sur la ligne de commande, mais √©choue lorsqu'elle est ex√©cut√©e dans crontab</b> . <br><br>  Il y a <b>deux raisons</b> : <br><br><ul><li>  Les t√¢ches Cron ne sont pas interactives. <br></li><li>  Contrairement aux scripts de ligne de commande, les t√¢ches cron n'h√©ritent pas de l'environnement shell. </li></ul><br>  Habituellement, vous ne remarquez pas ou ne vous souciez pas que le script shell n'est pas interactif car l'environnement h√©rite du shell interactif.  Cela signifie que tous les <code>PATH</code> et <code>alias</code> configur√©s comme pr√©vu. <br><br>  C'est pourquoi vous devez souvent d√©finir un <code>PATH</code> sp√©cifique pour la t√¢che cron, comme ici: <br><br><pre>  * * * * * CHEMIN = $ {CHEMIN}: / chemin / vers / mon / programme / dossier monprogramme </pre><br><h4>  Scripts qui s'appellent </h4><br>  Un autre probl√®me courant est lorsque les scripts sont configur√©s par erreur pour s‚Äôappeler.  Par exemple, <code>/etc/profile</code> fait r√©f√©rence √† <code>~/.bashrc</code> . <br><br>  Habituellement, cela se produit lorsque quelqu'un essaie de corriger une sorte d'erreur et que tout semble fonctionner.  Malheureusement, lorsque vous devez s√©parer ces diff√©rents types de sessions, de nouveaux probl√®mes surviennent. <br><br><h2>  Sandbox Docker Image </h2><br>  Pour exp√©rimenter avec le d√©marrage du shell, j'ai cr√©√© une image Docker que vous pouvez utiliser pour d√©boguer le d√©marrage du shell dans un environnement s√ªr. <br><br>  Lancement: <br><br><pre> <code class="bash hljs">$ docker run -n bs -d imiell/bash_startup $ docker <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -ti bs bash</code> </pre> <br>  Dockerfile est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Pour forcer la connexion et simuler le shell de connexion: <br><br><pre> <code class="bash hljs">$ bash --login</code> </pre> <br>  Pour v√©rifier l'ensemble de variables <code>BASH_ENV</code> : <br><br><pre> <code class="bash hljs">$ env | grep BASH_ENV</code> </pre> <br>  Pour d√©boguer <code>crontab</code> simple script sera ex√©cut√© toutes les minutes (dans <code>/root/ascript</code> ): <br><br><pre> <code class="bash hljs">$ crontab -l $ cat /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/script.log</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452410/">https://habr.com/ru/post/fr452410/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452398/index.html">EFORTH pour calculatrice programmable</a></li>
<li><a href="../fr452400/index.html">Affaires inefficaces</a></li>
<li><a href="../fr452402/index.html">Exp√©riences avec une diode tunnel analogique</a></li>
<li><a href="../fr452404/index.html">Cinq tendances cl√©s de l'ITSM pour cette ann√©e</a></li>
<li><a href="../fr452408/index.html">Toilette Maine Coon</a></li>
<li><a href="../fr452412/index.html">Confidentialit√© des donn√©es, IoT et Mozilla WebThings</a></li>
<li><a href="../fr452414/index.html">HP Reverb - Examen du nouvel ensemble VR</a></li>
<li><a href="../fr452416/index.html">Animation squelettique sur le c√¥t√© de la carte vid√©o</a></li>
<li><a href="../fr452418/index.html">Comment faire une pr√©sentation produit qui engagera le client?</a></li>
<li><a href="../fr452424/index.html">La carence en h√©lium peut ralentir le d√©veloppement des ordinateurs quantiques - discuter de la situation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>