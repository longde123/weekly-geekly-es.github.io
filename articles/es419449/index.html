<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👈🏽 🙃 👨🏻‍🚀 API de contexto de Redux vs. React 💂🏼 🐗 🚝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En React 16.3, se ha agregado una nueva API de contexto. Nuevo en el sentido de que la antigua API de contexto estaba detrás de escena, la mayoría de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>API de contexto de Redux vs. React</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419449/"><img src="https://habrastorage.org/webt/fg/fp/ik/fgfpikxzusi8yqxz5vioyhdjgxm.png"><br><br>  En React 16.3, se ha agregado una nueva API de contexto.  <i>Nuevo</i> en el sentido de que la <i>antigua</i> API de contexto estaba detrás de escena, la mayoría de las personas no sabían acerca de su existencia o no la usaban, porque la documentación aconsejaba evitar usarla. <br><br>  Sin embargo, ahora la API de contexto es una parte completa de React, abierta para su uso (no como antes, oficialmente). <br><a name="habracut"></a><br>  Inmediatamente después del lanzamiento de React 16.3, aparecieron artículos que proclamaban la muerte de Redux debido a la nueva API de contexto.  Si le hubiera preguntado a Redux sobre esto, creo que él habría respondido: "los informes de mi muerte son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muy exagerados</a> ". <br><br>  En esta publicación, quiero hablar sobre cómo funciona la nueva API de Context, cómo se ve Redux, cuándo puedes usar Context en lugar de Redux, y por qué Context no reemplaza a Redux en cada caso. <br><br>  <b>Si solo desea una descripción general de la API de contexto, puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">seguir el enlace</a> .</b> <br><br><h3>  Ejemplo de aplicación de reacción </h3><br>  Voy a sugerirle que comprenda los principios de trabajar con el estado en React (accesorios y estado), pero si no es así, tengo un curso gratuito de 5 días para ayudarlo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">a aprenderlo</a> . <br><br>  Veamos un ejemplo que nos lleva al concepto utilizado en Redux.  Comenzaremos con una versión simple de React, y luego veremos cómo se ve en Redux y finalmente con Context. <br><br><img src="https://habrastorage.org/webt/tq/8q/ze/tq8qzesfpe66d4kveo0p6y10cv0.png"><br><br>  En esta aplicación, la información del usuario se muestra en dos lugares: en la barra de navegación en la esquina superior derecha y en el panel lateral al lado del contenido principal. <br><br>  (Puede notar que hay muchas similitudes con Twitter. ¡No es una coincidencia! Una de las mejores formas de perfeccionar sus habilidades de Reacción es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">copiar (crear réplicas de sitios / aplicaciones existentes)</a> . <br><br>  La estructura del componente se ve así: <br><br><img src="https://habrastorage.org/webt/ld/x0/3j/ldx03joils7rg-6cszxkur0dm_u.png"><br><br>  Usando React puro (solo accesorios), necesitamos almacenar información del usuario lo suficientemente alta en el árbol para que pueda pasar a los componentes que la necesitan.  En este caso, la información del usuario debe estar en la aplicación. <br><br>  Luego, para transferir información sobre el usuario a los componentes que la necesitan, la aplicación debe pasarla a Nav y Body.  Ellos, a su vez, lo pasarán a UserAvatar (¡hurra!) Y a Sidebar.  Finalmente, Sidebar debería pasarlo a UserStats. <br><br>  Veamos cómo funciona esto en el código (pongo todo en un archivo para que sea más fácil de leer, pero de hecho probablemente se dividirá en archivos separados, siguiendo una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estructura estándar</a> ). <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./styles.css"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UserAvatar = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user, size }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; ); const UserStats = ({ user }) =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar user={user} /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; ); const Nav = ({ user }) =&gt; ( &lt;div className="nav"&gt; &lt;UserAvatar user={user} size="small" /&gt; &lt;/div&gt; ); const Content = () =&gt; &lt;div className="content"&gt;main content here&lt;/div&gt;; const Sidebar = ({ user }) =&gt; ( &lt;div className="sidebar"&gt; &lt;UserStats user={user} /&gt; &lt;/div&gt; ); const Body = ({ user }) =&gt; ( &lt;div className="body"&gt; &lt;Sidebar user={user} /&gt; &lt;Content user={user} /&gt; &lt;/div&gt; ); class App extends React.Component { state = { user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }; render() { const { user } = this.state; return ( &lt;div className="app"&gt; &lt;Nav user={user} /&gt; &lt;Body user={user} /&gt; &lt;/div&gt; ); } } ReactDOM.render(&lt;App /&gt;, document.querySelector("#root"));</code> </pre> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Código de muestra de CodeSandbox</a> <br><br>  Aquí la aplicación <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">inicializa el estado que</a> contiene el objeto de usuario.  En una aplicación real, es más probable que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">extraiga estos datos del servidor</a> y los guarde en estado para su representación. <br><br>  En cuanto a los accesorios ("perforación de accesorios"), <i>no es gran cosa</i> .  Funciona muy bien  Lanzando accesorios, este es un ejemplo ideal de React.  Pero arrojar profundamente en el árbol de estado puede ser un poco molesto al escribir.  Y molesta aún más si tienes que transmitir muchos props'ov (y no uno). <br><br>  Sin embargo, hay una gran desventaja en esta estrategia: crea una conexión entre componentes que no deberían conectarse.  En el ejemplo anterior, Nav debería aceptar un accesorio de "usuario" y pasarlo a UserAvatar, incluso si Nav no lo necesita. <br><br>  Los componentes estrechamente acoplados (como los que pasan accesorios a sus hijos) son más difíciles de reutilizar, ya que debe vincularlos con los nuevos padres cada vez que los use en un lugar nuevo. <br><br>  Veamos cómo podemos mejorar esto. <br><br><h3>  Antes de usar Context o Redux ... </h3><br>  Si puede encontrar una manera de <i>combinar la</i> estructura de su aplicación y aprovechar la transferencia de accesorios a los descendientes, esto puede hacer que su código sea más limpio sin tener que recurrir a un accesorio avanzado, <i>Context</i> o <i>Redux</i> . <br><br>  En este ejemplo, los accesorios para niños son una excelente solución para componentes que deben ser universales, como Nav, Sidebar y Body.  También tenga en cuenta que puede pasar JSX a <i>cualquier</i> accesorio, no solo a los niños; por lo tanto, si necesita más de una "ranura" para conectar componentes, recuerde esto. <br><br>  Aquí hay un ejemplo de una aplicación React en la que Nav, Body y Sidebar toman a los niños y los muestran tal como están.  Por lo tanto, quien usa el componente no necesita preocuparse por transferir ciertos datos que requiere el componente.  Simplemente puede mostrar lo que necesita en su lugar, utilizando los datos que ya tiene dentro del alcance.  Este ejemplo también muestra cómo usar cualquier accesorio para transmitir niños. <br><br>  (¡Gracias a Dan Abramov por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta oferta</a> !) <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./styles.css"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UserAvatar = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user, size }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; ); const UserStats = ({ user }) =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar user={user} /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; ); //  children   . const Nav = ({ children }) =&gt; ( &lt;div className="nav"&gt; {children} &lt;/div&gt; ); const Content = () =&gt; ( &lt;div className="content"&gt;main content here&lt;/div&gt; ); const Sidebar = ({ children }) =&gt; ( &lt;div className="sidebar"&gt; {children} &lt;/div&gt; ); // Body   sidebar  content,    , //    . const Body = ({ sidebar, content }) =&gt; ( &lt;div className="body"&gt; &lt;Sidebar&gt;{sidebar}&lt;/Sidebar&gt; {content} &lt;/div&gt; ); class App extends React.Component { state = { user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }; render() { const { user } = this.state; return ( &lt;div className="app"&gt; &lt;Nav&gt; &lt;UserAvatar user={user} size="small" /&gt; &lt;/Nav&gt; &lt;Body sidebar={&lt;UserStats user={user} /&gt;} content={&lt;Content /&gt;} /&gt; &lt;/div&gt; ); } } ReactDOM.render(&lt;App /&gt;, document.querySelector("#root"));</code> </pre> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Código de muestra de CodeSandbox</a> <br><br>  Si su aplicación es demasiado complicada (¡más complicada que este ejemplo!), Puede ser difícil entender cómo adaptar la plantilla a los niños.  Veamos cómo puede reemplazar el reenvío de accesorios con Redux. <br><br><h3>  Ejemplo de Redux </h3><br>  Echaré un vistazo rápido al ejemplo de Redux para que podamos entender mejor cómo funciona Context, así que si no tienes una comprensión clara de Redux, primero lee <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mi introducción a Redux</a> (o mira el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">video</a> ). <br><br>  Aquí está nuestra aplicación React rediseñada para usar Redux.  La información del usuario se ha trasladado a la tienda Redux, lo que significa que podemos usar la función de conexión react-redux para pasar directamente la utilería del usuario a los componentes que los necesitan. <br><br>  Esta es una gran victoria en términos de deshacerse de la conexión.  Eche un vistazo a Nav, Body y Sidebar, y verá que ya no reciben ni transmiten accesorios de usuario.  Ya no juegan papas calientes con accesorios.  No más conexiones inútiles. <br><br>  El reductor hace poco aquí;  Es bastante simple.  Tengo una cosa más sobre cómo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funcionan los reductores Redux</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cómo escribir el código inmutable</a> que usan. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    createStore, connect, and Provider: import { createStore } from "redux"; import { connect, Provider } from "react-redux"; //  reducer       . const initialState = {}; function reducer(state = initialState, action) { switch (action.type) { //    action SET_USER  state. case "SET_USER": return { ...state, user: action.user }; default: return state; } } //  store  reducer'   . const store = createStore(reducer); // Dispatch' action     user. store.dispatch({ type: "SET_USER", user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }); //   mapStateToProps,      state (user) //     `user` prop. const mapStateToProps = state =&gt; ({ user: state.user }); //  UserAvatar    connect(),    //`user` ,      . //     2 : // const UserAvatarAtom = ({ user, size }) =&gt; ( ... ) // const UserAvatar = connect(mapStateToProps)(UserAvatarAtom); const UserAvatar = connect(mapStateToProps)(({ user, size }) =&gt; ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; )); //   UserStats    connect(),    // `user` . const UserStats = connect(mapStateToProps)(({ user }) =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; )); //    Nav      `user`. const Nav = () =&gt; ( &lt;div className="nav"&gt; &lt;UserAvatar size="small" /&gt; &lt;/div&gt; ); const Content = () =&gt; ( &lt;div className="content"&gt;main content here&lt;/div&gt; ); //   Sidebar. const Sidebar = () =&gt; ( &lt;div className="sidebar"&gt; &lt;UserStats /&gt; &lt;/div&gt; ); //   Body. const Body = () =&gt; ( &lt;div className="body"&gt; &lt;Sidebar /&gt; &lt;Content /&gt; &lt;/div&gt; ); //  App    ,     . const App = () =&gt; ( &lt;div className="app"&gt; &lt;Nav /&gt; &lt;Body /&gt; &lt;/div&gt; ); //     Provider, //   connect()    store. ReactDOM.render( &lt;Provider store={store}&gt; &lt;App /&gt; &lt;/Provider&gt;, document.querySelector("#root") );</span></span></code> </pre><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Código de muestra de CodeSandbox</a> <br><br>  Ahora probablemente te estés preguntando cómo Redux logra esta magia.  Asombroso  ¿Cómo React no admite pasar accesorios a múltiples niveles, y puede Redux hacer esto? <br><br>  La respuesta es que Redux usa la función de <i>contexto</i> React (función de contexto).  No la API Context moderna (todavía no), sino la antigua.  Uno que la documentación de React dice que no use a menos que esté escribiendo su propia biblioteca o sepa lo que está haciendo. <br><br>  El contexto es similar a un bus de computadora que sigue a cada componente: para que la energía (datos) pase a través de él, solo necesita conectarse.  Y react-redux connect hace exactamente eso. <br><br>  Sin embargo, esta característica de Redux es solo la punta del iceberg.  La transferencia de datos al lugar correcto es la característica más <i>obvia</i> de Redux.  Aquí hay algunos otros beneficios que obtiene de la caja: <br><br>  <b>conectar es una función pura</b> <br><br>  connect automáticamente hace que los componentes conectados sean "limpios", es decir, solo se volverán a renderizar cuando cambien sus accesorios, es decir, cuando cambie su porción del estado de Redux.  Esto evita la reproducción innecesaria y acelera la aplicación. <br><br>  <b>Depuración fácil con Redux</b> <br><br>  La ceremonia de escribir acciones y reductores se equilibra con la increíble facilidad de depuración que Redux te brinda. <br><br>  Con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la extensión Redux DevTools,</a> obtiene un registro automático de todas las acciones realizadas por su aplicación.  En cualquier momento, puede abrirlo y ver qué acciones se lanzaron, cuál es su carga útil y establecer antes y después de la acción. <br><br><img src="https://habrastorage.org/webt/go/km/oi/gokmoivlzezzfb-wjkhujjyxep8.gif"><br><br>  Otra gran característica que proporciona Redux DevTools es la depuración mediante el <i>"viaje en el tiempo"</i> , es decir, puede hacer clic en cualquier acción anterior e ir a este punto en el tiempo, hasta la actual.  La razón por la que esto funciona es que cada acción actualiza la tienda de la <i>misma manera</i> , por lo que puede tomar una lista de las actualizaciones de estado grabadas y reproducirlas sin efectos secundarios, y terminar en el lugar que desee. <br><br>  También hay herramientas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LogRocket</a> , que básicamente le proporcionan las RedTo DevTools permanentes en <i>producción</i> para cada uno de sus usuarios.  ¿Tienes un informe de error?  No hay problema  Mire esta sesión de usuario en LogRocket, y puede ver una repetición de lo que hizo y qué acciones se lanzaron.  Todo esto funciona utilizando el flujo de acción de Redux. <br><br>  <b>Extendiendo Redux con Middleware</b> <br><br>  Redux admite el concepto de middleware (una palabra elegante para "una función que se ejecuta cada vez que se envía una acción").  Escribir su propio middleware no es tan difícil como parece, y le permite usar algunas herramientas poderosas. <br><br>  Por ejemplo ... <br><br><ul><li>  ¿Desea enviar una solicitud de API cada vez que un nombre de acción comienza con FETCH_?  Puedes hacer esto con middleware. </li><li>  ¿Desea un lugar centralizado para registrar eventos en su software de análisis?  Middleware es un buen lugar para hacer esto. </li><li>  ¿Quiere evitar que una acción comience en un momento específico?  Puede hacer esto con middleware, invisible para el resto de su aplicación. </li><li>  ¿Desea interceptar una acción que tenga un token JWT y guardarla automáticamente en localStorage?  Si, middleware. </li></ul><br>  Aquí hay un buen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">artículo</a> con ejemplos de cómo escribir el middleware de Redux. <br><br><h4>  Cómo usar la API React Context </h4><br>  Pero tal vez no necesites todas estas rarezas de Redux.  Es posible que no necesite una simple depuración, ajuste o mejoras de rendimiento automáticas; todo lo que desea hacer es transferir datos fácilmente.  Tal vez su aplicación es pequeña, o simplemente necesita hacer algo rápidamente y lidiar con las sutilezas más adelante. <br><br>  La nueva API de contexto probablemente sea adecuada para usted.  Veamos como funciona. <br><br>  Publiqué un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tutorial</a> rápido de API de contexto en Egghead si prefieres mirar antes que leer (3:43). <br><br>  Aquí hay 3 componentes importantes de la API de contexto: <br><br><ul><li>  Función React.createContext que crea contexto </li><li>  Proveedor (devuelve createContext), que configura el "bus", <br>  pasando por el árbol de componentes </li><li>  Consumidor (también devuelve createContext) que absorbe <br>  "Bus eléctrico" para extracción de datos </li></ul><br>  El proveedor es muy similar al proveedor en React-Redux.  Asume un valor que puede ser lo que quieras (incluso podría ser una tienda Redux ... pero eso sería estúpido).  Lo más probable es que este sea un objeto que contenga sus datos y cualquier acción que desee realizar con los datos. <br><br>  Consumer funciona un poco como la función de conexión en React-Redux, conectándose a los datos y poniéndolos a disposición de un componente que los usa. <br><br>  Aquí están los aspectos más destacados: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     context //    2 : { Provider, Consumer } // ,   ,  UpperCase,  camelCase //  ,          , //        . const UserContext = React.createContext(); // ,     context, //   Consumer. // Consumer   "render props". const UserAvatar = ({ size }) =&gt; ( &lt;UserContext.Consumer&gt; {user =&gt; ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; )} &lt;/UserContext.Consumer&gt; ); // ,      "user prop", //   Consumer    context. const UserStats = () =&gt; ( &lt;UserContext.Consumer&gt; {user =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar user={user} /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; )} &lt;/UserContext.Consumer&gt; ); // ...    ... // ... (      `user`). //  App   context ,  Provider. class App extends React.Component { state = { user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }; render() { return ( &lt;div className="app"&gt; &lt;UserContext.Provider value={this.state.user}&gt; &lt;Nav /&gt; &lt;Body /&gt; &lt;/UserContext.Provider&gt; &lt;/div&gt; ); } }</span></span></code> </pre><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Código de muestra de CodeSandbox</a> <br><br>  Veamos cómo funciona. <br><br>  Recuerde, tenemos 3 partes: el contexto mismo (creado usando React.createContext) y dos componentes que interactúan con él (Proveedor y Consumidor). <br><br>  <b>Proveedor y consumidor trabajan juntos</b> <br><br>  Proveedor y consumidor están relacionados e inseparables.  Solo saben cómo interactuar entre ellos.  Si creó dos contextos separados, por ejemplo, "Contexto1" y "Contexto2", el Proveedor1 y el Contexto del consumidor1 no podrán comunicarse con el Contexto2 del proveedor y el consumidor. <br><br>  <b>El contexto no contiene estado</b> <br><br>  Tenga en cuenta que el contexto <i>no tiene su propio estado</i> .  Este es solo un canal para sus datos.  Debe pasar el valor al Proveedor, y ese valor se pasará a cualquier Consumidor que sepa cómo buscarlo (el Proveedor está vinculado al mismo contexto que el Consumidor). <br><br>  Cuando crea un contexto, puede pasar el "valor predeterminado" de la siguiente manera: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Ctx = React.createContext(yourDefaultValue);</code> </pre><br><br>  El valor predeterminado es lo que recibirá el Consumidor cuando se coloque en el árbol sin el Proveedor encima.  Si no lo pasa, el valor será indefinido.  Tenga en cuenta que este <i>es el valor predeterminado</i> , no el valor <i>inicial</i> .  El contexto no guarda nada;  solo difunde los datos que le pasas. <br><br>  <b>El consumidor utiliza el patrón de accesorios de renderizado</b> <br><br>  La función conectar Redux es un componente de orden superior (abreviado como HoC).  Envuelve otro componente y le pasa accesorios. <br><br>  El consumidor, por el contrario, espera que el componente hijo sea una función.  Luego llama a esta función durante la representación, pasando el valor que recibió del Proveedor en algún lugar por encima (ya sea el valor predeterminado del contexto, o indefinido si no pasó el valor predeterminado). <br><br>  <b>El proveedor toma un valor.</b> <br><br>  Solo un valor, como prop.  Pero recuerde que el valor puede ser cualquier cosa.  En la práctica, si desea pasar varios valores hacia abajo, debe crear un objeto con todos los valores y pasar este objeto hacia abajo. <br><br><h3>  API de contexto flexible </h3><br>  Dado que crear contexto nos da dos componentes para trabajar (Proveedor y Consumidor), podemos usarlos como queramos.  Aquí hay un par de ideas. <br><br>  <b>Envuelva al consumidor en HOC</b> <br><br>  ¿No le gusta la idea de agregar UserContext.Consumer en cada lugar que lo necesita?  Este es tu código!  Tiene derecho a decidir cuál será su mejor opción. <br><br>  Si prefiere obtener el valor como accesorio, puede escribir un pequeño contenedor alrededor del Consumidor de la siguiente manera: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Component</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConnectedComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;UserContext.Consumer&gt; {user =&gt; &lt;Component {...props} user={user}/&gt;} &lt;/UserContext.Consumer&gt; ); } }</code> </pre><br>  Después de eso, puede reescribir, por ejemplo, UserAvatar usando la función withUser: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UserAvatar = withUser(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ size, user }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">img</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">user-avatar</span></span></span></span><span class="xml"><span class="hljs-tag"> ${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span></span><span class="xml"><span class="hljs-tag"> || ""}`} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"user avatar"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{user.avatar}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ));</span></span></code> </pre><br>  Y listo, el contexto puede funcionar como conectar Redux.  Menos limpieza automática. <br><br>  Aquí hay un ejemplo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CodeSandbox</a> con este HOC. <br><br>  <b>Mantener el estado en el proveedor</b> <br><br>  Recuerde que el proveedor es solo un canal.  No guarda ningún dato.  Pero esto no le impide crear su <i>propio</i> contenedor para almacenar datos. <br><br>  En el ejemplo anterior, los datos se almacenan en la aplicación, por lo que lo único que necesitaba comprender eran los componentes Proveedor + Consumidor.  Pero tal vez quieras crear tu propia tienda.  Puede crear un componente para almacenar el estado y pasarlo a través del contexto: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserStore</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ state = { <span class="hljs-attr"><span class="hljs-attr">user</span></span>: { <span class="hljs-attr"><span class="hljs-attr">avatar</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Dave"</span></span>, <span class="hljs-attr"><span class="hljs-attr">followers</span></span>: <span class="hljs-number"><span class="hljs-number">1234</span></span>, <span class="hljs-attr"><span class="hljs-attr">following</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span> } }; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;UserContext.Provider value={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.user}&gt; {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.props.children} &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/UserContext.Provider&gt; ); } } /</span></span></span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/ ...    ... const App = () =&gt; ( &lt;div className="app"&gt; &lt;Nav /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;Body </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">div&gt; </span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReactDOM</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;UserStore&gt; &lt;App </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">UserStore&gt;, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">document</span></span></span></span><span class="hljs-function"><span class="hljs-params">.querySelector(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"#root"</span></span></span></span></span><span class="hljs-function">) );</span></span></code> </pre><br>  Ahora los datos del usuario están contenidos en su <i>propio</i> componente, cuya única tarea son estos datos.  Genial  La aplicación puede volver a ser apátrida.  Creo que se ve un poco más limpio. <br><br>  Aquí hay un ejemplo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CodeSandbox</a> con este UserStore. <br><br>  <b>Lanzar acciones hacia abajo a través del contexto</b> <br><br>  Recuerde que el objeto pasado a través del proveedor puede contener todo lo que desee.  Esto significa que puede contener funciones.  Incluso puedes nombrarlos acciones. <br><br>  Aquí hay un nuevo ejemplo: una habitación simple con un interruptor para cambiar el color de fondo - oh, me refiero a la luz. <br><br><img src="https://habrastorage.org/webt/di/s4/r1/dis4r10ujowkvv5pn9mgx9b6jbs.gif"><br><br>  El estado se almacena en la tienda, que también tiene una función de cambio de luz.  Tanto el estado como la función se pasan a través del contexto. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./styles.css"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  context. const RoomContext = React.createContext(); // ,     //   . class RoomStore extends React.Component { state = { isLit: false }; toggleLight = () =&gt; { this.setState(state =&gt; ({ isLit: !state.isLit })); }; render() { //  state  onToggleLight action return ( &lt;RoomContext.Provider value={{ isLit: this.state.isLit, onToggleLight: this.toggleLight }} &gt; {this.props.children} &lt;/RoomContext.Provider&gt; ); } } //    ,    , //       RoomContext. const Room = () =&gt; ( &lt;RoomContext.Consumer&gt; {({ isLit, onToggleLight }) =&gt; ( &lt;div className={`room ${isLit ? "lit" : "dark"}`}&gt; The room is {isLit ? "lit" : "dark"}. &lt;br /&gt; &lt;button onClick={onToggleLight}&gt;Flip&lt;/button&gt; &lt;/div&gt; )} &lt;/RoomContext.Consumer&gt; ); const App = () =&gt; ( &lt;div className="app"&gt; &lt;Room /&gt; &lt;/div&gt; ); //     RoomStore, //           . ReactDOM.render( &lt;RoomStore&gt; &lt;App /&gt; &lt;/RoomStore&gt;, document.querySelector("#root") );</span></span></code> </pre><br>  Aquí hay un ejemplo de trabajo completo en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CodeSandbox</a> . <br><br>  <b>Entonces, después de todo, ¿qué usar, Context o Redux?</b> <br><br>  Ahora que has visto ambos caminos, ¿cuál vale la pena usar?  Sé que solo quieres escuchar la respuesta a esta pregunta, pero tengo que responder: "depende de ti". <br><br>  Depende de qué tan grande sea su aplicación ahora o qué tan rápido crezca.  ¿Cuántas personas trabajarán en él, solo usted o un equipo grande?  ¿Qué experiencia tiene usted o su equipo en trabajar con los conceptos funcionales en los que se basa Redux (como la inmutabilidad y las características puras). <br><br>  Un error fatal que impregna todo el ecosistema de JavaScript es la idea de la <i>competencia</i> .  Existe la idea de que cada opción es un juego de suma cero: si usa la <i>biblioteca</i> A, no debe usar su <i>biblioteca</i> competidora B. Que cuando salga una nueva biblioteca que sea mejor que la anterior, debería desplazar a la existente.  Que todo debe ser / o que debes elegir lo más nuevo y lo mejor, o ser relegado a un segundo plano con desarrolladores del pasado. <br><br>  El mejor enfoque es mirar esta maravillosa opción con un ejemplo, un conjunto de herramientas.  Es como elegir entre usar un destornillador o un destornillador potente.  Para el 80% de los casos, un destornillador hará el trabajo más fácil y más rápido que un destornillador.  Pero para el otro 20%, un destornillador sería la mejor opción (no hay suficiente espacio o el artículo es delgado).  Cuando compré un destornillador, no tiré inmediatamente el destornillador, no lo reemplazó, sino que simplemente me dio otra opción.  Otra forma de resolver el problema. <br><br>  El contexto no "reemplaza" Redux, no más que React "reemplaza" Angular o jQuery.  Demonios, todavía uso jQuery cuando necesito hacer algo rápidamente.  A veces sigo usando plantillas EJS del lado del servidor en lugar de implementar una aplicación React.  A veces, Reaccionar es más de lo que necesitas para completar una tarea.  Lo mismo vale para Redux. <br><br>  Hoy, si Redux es más de lo que necesita, puede usar el contexto. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Learning React puede ser difícil: ¡hay tantas bibliotecas y herramientas! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mi consejo </font><font style="vertical-align: inherit;">Ignórelos a todos :) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para un tutorial paso a paso, lea mi libro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Pure React</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419449/">https://habr.com/ru/post/es419449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419429/index.html">Tengo 57 años y soy un maestro scrum</a></li>
<li><a href="../es419433/index.html">Informes DSW - Generador de informes DeepSeeWeb</a></li>
<li><a href="../es419439/index.html">Cómo el comercio electrónico sobrevive a las promociones a gran escala. Preparándose para las cargas máximas en la web [Parte 2]</a></li>
<li><a href="../es419441/index.html">SpaceX reutiliza el cohete Falcon 9 Block 5 hoy</a></li>
<li><a href="../es419443/index.html">La NASA volverá a volar a la luna, haciendo que todos los elementos del avión</a></li>
<li><a href="../es419451/index.html">Crea un paquete para Symfony 4 paso a paso</a></li>
<li><a href="../es419453/index.html">Métodos numéricos para resolver sistemas de ecuaciones no lineales.</a></li>
<li><a href="../es419457/index.html">RabbitMQ - SQL Server</a></li>
<li><a href="../es419459/index.html">Baterías de plomo-ácido: alfabeto de carga de pulso</a></li>
<li><a href="../es419461/index.html">Ventilación del baño</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>