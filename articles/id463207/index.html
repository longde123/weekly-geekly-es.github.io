<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’¾ ğŸ‘¨ğŸ¼â€ğŸš€ ğŸ˜ Pengembangan chatbot (telegram + youtube) ğŸ”¼ ğŸ‘¨ğŸ¿â€ğŸ­ âš—ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mengapa itu bahkan muncul di sini? 

 Baru-baru ini, saya menulis artikel tentang pengembangan bot php menggunakan laravel + botman untuk telegram. Ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengembangan chatbot (telegram + youtube)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463207/">  Mengapa itu bahkan muncul di sini? <br><br>  Baru-baru ini, saya menulis artikel tentang pengembangan bot php menggunakan laravel + botman untuk telegram.  Hal pertama yang mereka tulis, saya kutip, adalah "menembak dari meriam di burung pipit".  Saya setuju dengan ini, saya bahkan menyadarinya selama pengembangan, tetapi saya tertarik pada laravel. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ly/rl/ce/lyrlcenybn_v6he3q2rsxgymiok.jpeg" alt="gambar"></div><a name="habracut"></a><br>  Sekarang saya sedang mengembangkan bot di php murni (tanpa tegap) dan API telegram, dan karena ada banyak artikel tentang topik yang sama, kami akan sedikit menyentuh google API (youtube api) sedikit.  Saya harap Anda menemukan itu menarik dan bermanfaat untuk belajar tentang youtube API. <br><br>  Penyimpangan kecil.  Saat ini saya bekerja sebagai programmer frontend dan bekerja dengan php hanya untuk kesenangan saya sendiri (walaupun itu adalah kesenangan).  Mungkin ada kesalahan bodoh di sisi server, tetapi berfungsi dan bagi saya pada saat pelatihan ini sudah cukup. <br><br><h4>  Pernyataan masalah </h4><br>  Suatu malam saya mendapat ide untuk menghubungkan bot dan youtube, pada waktu itu saya bahkan tidak curiga keberadaan api google.  Dibutuhkan bot yang, ketika video baru dirilis di saluran youtube, akan mendorong pemberitahuan di bot saya. <br><br>  Pada prinsipnya, fungsinya cukup sederhana, tetapi bagaimana cara bekerja dengan youtube?  Ternyata google sendiri memiliki solusi untuk masalah ini dan namanya adalah Google API.  Ini memungkinkan Anda untuk bekerja dengan semua aplikasi dari perusahaan, tetapi saya hanya tertarik pada youtube. <br><br><h4>  Kustomisasi dan Pengembangan </h4><br>  Kebetulan selama studi tentang api youtube, solusi elegan untuk masalah saya ditemukan, itu ditawarkan oleh dokumentasi api itu sendiri.  Tapi pertama-tama tentang api.  Untuk mulai bekerja dengannya, Anda harus pergi ke konsol Google dan pilih opsi api yang Anda butuhkan.  Setelah itu path terletak hanya pada dokumentasi atau pada stackoverflow.  Saya harus segera mengatakan bahwa tidak ada versi Rusia dari dokumentasi, tidak ada pelajaran juga.  Dianjurkan untuk memiliki pengetahuan bahasa Inggris minimal atau untuk bertindak dengan mengetik. <br><br>  Ini terlihat seperti ini.  Anda masuk ke konsol Google, buat proyek Anda dan pilih API yang diinginkan. <br><br><img src="https://habrastorage.org/webt/p1/aa/8v/p1aa8vsd_gsk_kbhgtvzdzdpqso.png" alt="gambar"><br><br>  Dan sekarang untuk menyelesaikan masalah.  Saat membaca dokumentasi, saya menemukan (google sendiri menunjukkan) layanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pubsubhubbub.appspot.com/subscribe,</a> ini memungkinkan Anda untuk menautkan youtube dan aplikasi Anda.  Bagaimana cara kerjanya?  Ia bekerja berdasarkan prinsip webhook.  Anda menyisipkan youtube saluran yang ingin Anda dengarkan dan setiap kali dengan tindakan apa pun pada saluran (tambahkan video, hapus, ubah), terima data ke skrip Anda. <br><br><img src="https://habrastorage.org/webt/hl/tb/yg/hltbygpefguy9khw5huwwer9au8.png" alt="gambar"><br><br>  URL panggilan balik - skrip yang akan menerima data dari google. <br>  URL topik adalah saluran yang ingin Anda dengarkan. <br><br>  Nah, bidang Mode memungkinkan Anda untuk memilih apa yang Anda inginkan, berlangganan atau berhenti berlangganan dari mendengarkan. <br><br>  Mari mulai menulis kode, sebagai permulaan, mari atur skrip kami untuk bekerja dengan youtube.  Saya menulis semuanya dalam satu file sejak itu  itu tes + kode yang sebenarnya tidak cukup.  Setelah Anda mengirimkan permintaan berlangganan, Anda harus mengonfirmasi.  Googling, Anda dapat menemukan jawabannya di situs favorit semua orang, salah satu komentar di stackoverflow menyarankan. <br><br><pre><code class="php hljs">$video = <span class="hljs-string"><span class="hljs-string">"null"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'hub_challenge'</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $_REQUEST[<span class="hljs-string"><span class="hljs-string">'hub_challenge'</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $video = parseYoutubeUpdate(file_get_contents(<span class="hljs-string"><span class="hljs-string">'php://input'</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseYoutubeUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($data)</span></span></span><span class="hljs-function"> </span></span>{ $xml = simplexml_load_string($data, <span class="hljs-string"><span class="hljs-string">'SimpleXMLElement'</span></span>, LIBXML_NOCDATA); $video_id = substr((string)$xml-&gt;entry-&gt;id, <span class="hljs-number"><span class="hljs-number">9</span></span>); $channel_id = substr((string)$xml-&gt;entry-&gt;author-&gt;uri, <span class="hljs-number"><span class="hljs-number">32</span></span>); $published = (string)$xml-&gt;entry-&gt;published; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'video_id'</span></span>=&gt;$video_id, <span class="hljs-string"><span class="hljs-string">'channel_id'</span></span>=&gt;$channel_id, <span class="hljs-string"><span class="hljs-string">'published'</span></span>=&gt;$published ); }</code> </pre> <br>  Di sini kita buat untuk kenyamanan variabel di mana kita akan memerlukan info tentang video.  Dua baris berikutnya memungkinkan Anda untuk menentukan apakah mungkin untuk mengkonfirmasi permintaan dari pubsubhubbub, jika demikian, maka konfirmasikan, jika tidak, itu berarti bahwa data berasal dari youtube dan kami perlu memprosesnya.  Di fungsi parseYoutubeUpdate, kami memproses respons, kami mendapatkan semua informasi yang kami butuhkan. <br><br>  Di sini layak diasingkan dan diceritakan tentang bentuk data khusus (menurut saya, saya bisa keliru) yang digunakan oleh youtube (untuk jawaban) itu disebut, seperti yang saya pahami, atom (jangan dikacaukan dengan IDE atau ini adalah xml biasa ... ada sedikit pengalaman dengan itu) .  Itu terlihat seperti ini (sebagian kecil jawaban dari youtube): <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>yt:video:eE5mpblYpdY<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">yt:videoId</span></span></span><span class="hljs-tag">&gt;</span></span>eE5mpblYpdY<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">yt:videoId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">yt:channelId</span></span></span><span class="hljs-tag">&gt;</span></span>UCGqKr3O5ub-O7zEKx_qeHUQ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">yt:channelId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>20b3560a49 1080<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alternate"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://www.youtube.com/watch?v=hgCQ378xNus"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>not Epic<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uri</span></span></span><span class="hljs-tag">&gt;</span></span>https://www.youtube.com/channel/UCGqKr3O5ub-O7zEKx_qeHUQ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uri</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">published</span></span></span><span class="hljs-tag">&gt;</span></span>2019-07-14T05:10:49+00:00<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">published</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">updated</span></span></span><span class="hljs-tag">&gt;</span></span>2019-07-14T05:11:07.600177664+00:00<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">updated</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Kembali ke parseYoutubeUpdate (). <br><br>  Dalam suatu fungsi, kami mengonversi respons ke format xml. <br>  Kami menulis data yang kami butuhkan ke dalam variabel. <br>  Dan kemudian kita mengembalikan array dengan data ini. <br><br>  Kami lolos ke telegram.  Sebagai permulaan, saya ingin mengatakan, itu ****** betapa mudahnya bekerja daripada dengan botman.  Jika Anda ingin mengembangkan bot hanya untuk telegram, maka jangan gunakan perpustakaan yang memungkinkan Anda untuk mengembangkan bot untuk platform yang berbeda ....  tidak masuk akal ... akan ada lebih banyak masalah.  API telegram sangat jelas dan sederhana bahkan untuk pemula yang baru saja bertemu php dan memiliki pengetahuan OOP minimal. <br><br>  Jadi, lebih dekat ke intinya, lebih dekat ke kode.  Kita perlu membuat bot dan mengikatnya ke skrip kita.  Saya harap Anda bisa membuat bot.  Kami menulis token dari bot dan membuat permintaan <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TOKEN = <span class="hljs-string"><span class="hljs-string">"6826815*******Yme99*****9kjzgVi*****3S******"</span></span>; $url = <span class="hljs-string"><span class="hljs-string">'https://api.telegram.org/bot'</span></span> . TOKEN . <span class="hljs-string"><span class="hljs-string">'/sendMessage'</span></span>;</code> </pre><br>  Sekarang kita hanya perlu mengirim permintaan ke server telegram. <br><br><pre> <code class="php hljs">$params = [ <span class="hljs-string"><span class="hljs-string">'chat_id'</span></span> =&gt;<span class="hljs-number"><span class="hljs-number">712531723</span></span>, <span class="hljs-string"><span class="hljs-string">"text"</span></span> =&gt; $linkVideo, ]; $url = $url . <span class="hljs-string"><span class="hljs-string">'?'</span></span> . http_build_query($params);</code> </pre><br>  Kami membuat parameter yang diperlukan, bagi saya ini adalah id obrolan (jika ini menampilkan produksi bot, maka perlu untuk menyimpan semua id dalam database ke spam) dan pesan teks. <br><br>  Seperti yang mungkin Anda perhatikan, saya mengirimkan tautan sebagai pesan sederhana, bukan video.  Seperti yang saya pahami, sebuah telegram mentransmisikan video hanya jika diunggah ke server, jika tidak ... + Saya perlu melihat gambar pratinjau untuk video tersebut. <br><br>  Sekarang bot kami akan menerima pemberitahuan untuk keluar / mengedit video.  Itu terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/yg/18/72/yg1872yqamevvqavsgu7hpfo-oc.png" alt="gambar"><br><br>  Game usai  Saya memiliki semuanya.  Kelemahan terbesar dari kode ini adalah bahwa ia berada dalam satu file, tetapi tidak masuk akal bagi saya untuk memisahkan kode 10-baris. <br><br>  Sumber - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id463207/">https://habr.com/ru/post/id463207/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id463193/index.html">Konversi gambar hitam dan putih ke grafik ASCII menggunakan dekomposisi matriks non-negatif</a></li>
<li><a href="../id463195/index.html">Apa yang terjadi dengan Internet Tele2</a></li>
<li><a href="../id463197/index.html">Blazor + MVVM = Silverlight menyerang balik karena kejahatan kuno tidak terkalahkan</a></li>
<li><a href="../id463203/index.html">Beban waktu yang berat. Yandex melaporkan kesalahan umum dalam bekerja dengan waktu</a></li>
<li><a href="../id463205/index.html">Awalnya tidak dapat dioperasikan: cara bertahan dengan laptop di Windows 10 dan drive 32-gigabyte</a></li>
<li><a href="../id463213/index.html">Kesalahpahaman untuk pengembang C # pemula. Mencoba menjawab pertanyaan standar</a></li>
<li><a href="../id463215/index.html">Para insinyur dan arsitek sudah merancang permukiman bulan</a></li>
<li><a href="../id463221/index.html">Watching the Sun: 5 jenis gadget, dari $ 5 hingga $ 5.000</a></li>
<li><a href="../id463229/index.html">Jetpacks in Culture: Cinema</a></li>
<li><a href="../id463231/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 14. VTP, Pemangkasan, dan VLAN Asli</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>