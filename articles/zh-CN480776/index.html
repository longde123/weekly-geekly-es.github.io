<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚰️ 🔹 🏢 我们通过所有可能的方法部署Active Directory。 💋 ♨️ 🧖🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Server 2019中真正有用的创新之一是无需执行Sysprep或全新安装即可进入服务器的功能。 使用Windows Server在虚拟服务器上部署基础结构从未如此简单。 


 今天，我们将讨论通过Powershell安装和管理Active Directory有多么容易。 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>我们通过所有可能的方法部署Active Directory。</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ultravds/blog/480776/">  Windows Server 2019中真正有用的创新之一是无需执行Sysprep或全新安装即可进入服务器的功能。 使用Windows Server在虚拟服务器上部署基础结构从未如此简单。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/832/bb5/ece/832bb5eceeb41372149067c20c1e4961.png"></div><br> 今天，我们将讨论通过Powershell安装和管理Active Directory有多么容易。 <br><a name="habracut"></a><br><h2> 设定角色 </h2><br>  <b>RSAT或具有GUI的本地服务器：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b8/87e/6fa/6b887e6fa363eca9beb473dc1f992526.png"></div><br> 首先，您需要将服务器添加到RSAT。 它使用域名或IP地址添加到主页上。 确保以<code>local\Administrator</code>格式输入登录名，否则服务器将不接受密码。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c0e/5b7/e62/c0e5b7e627ac9f0ff9c2da7c0cd7fc2c.png"></div><br> 转到添加组件，然后选择AD DS。 <br><br>  <b>Powershell：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cd6/a61/300/cd6a61300f8bf4a746faee1922d99fda.png"></div><br> 如果您不知道系统组件的名称，则可以运行命令并获取可用组件，它们的依存关系及其名称的列表。 <br><br><pre> <code class="plaintext hljs">Get-WindowsFeature</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1cd/253/2df/1cd2532dfd27b952e5a8ca2592bd8577.png"></div><br> 复制组件的名称并继续安装。 <br><br><pre> <code class="plaintext hljs">Install-WindowsFeature -Name AD-Domain-Services</code> </pre> <br>  Windows管理中心： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bbe/5f0/0b2/bbe5f00b224a5590bed0a70959e1e433.png"></div><br> 转到“角色和功能”，然后选择ADDS（Active Directory域服务）。 <br><br> 这就是一切。 当前无法通过Windows管理中心管理Active Directory。 他的提及无非提醒着他到目前为止是多么无用。 <br><br><h2> 将服务器提升到域控制器 </h2><br> 为此，我们创建了一个新的森林。 <br><br>  <b>RSAT或本地GUI服务器：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/960/6ab/cb7/9606abcb74f747172d941f011fbec085.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c3/803/f19/7c3803f19052f098ee5755b9ec476326.png"></div><br> 强烈建议您将所有内容保留为默认值，所有组件都可以直接使用，并且不需要任何特殊需要就无需触摸它们。 <br><br>  <b>Powershell：</b> <br><br> 首先，您需要创建一个林并为其设置密码。  Powershell有一个单独的密码变量类型-SecureString，用于将密码安全地存储在RAM中并在网络上安全地传输。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8d/7b6/6e1/a8d7b66e1f1487312d192a673b693d11.png"></div><br><pre> <code class="plaintext hljs">$pass = Read-Host -AsSecureString</code> </pre> <br> 必须使用这种方式输入使用任何人的密码的任何cmdlet。 首先，在SecureString中编写密码，然后在cmdlet中指定此变量。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f37/51c/ea7/f3751cea704deceb2ae284068a3aac11.png"></div><br><pre> <code class="plaintext hljs">Install-ADDSForest -DomainName test.domain -SafeModeAdministratorPassword $pass</code> </pre> <br> 与通过GUI进行安装一样，甚至到控制台的输出也相同。 与具有GUI的服务器不同，安装角色和将服务器安装为域控制器都不需要重新启动。 <br><br> 使用RSAT安装控制器比使用Powershell需要更长的时间。 <br><br><h2> 我们管理域名 </h2><br> 现在，要了解通过Powershell和AD AC（Active Directory管理中心）进行的Active Directory管理有多少不同，请考虑几个工作示例。 <br><br><h3> 创建一个新用户 </h3><br> 假设我们要在“用户”组中创建一个用户，并希望他为自己设置密码。 通过AD AC，看起来像这样： <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5bf/f47/caa/5bff47caa8da4678423ccdda37efce15.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f06/58a/b3b/f0658ab3b0c95aa5f64f11d489f3a5cf.png"></div><br><pre> <code class="plaintext hljs">New-ADUser -Name BackdoorAdmin -UserPrincipalName BackdoorAdmin@test Get-ADUser BackdoorAdmin</code> </pre> <br>  AD DC和Powershell之间没有区别。 <br><br><h3> 启用用户 </h3><br>  <b>RSAT或本地GUI服务器：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d43/a7d/a27/d43a7da2706e395f85ff16a2168c628a.png"></div><br> 用户必须通过GUI首先设置与GPO相对应的密码，然后才能将其打开。 <br><br>  <b>Powershell：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dca/557/ecc/dca557ecc71b1232c88740da553cefa3.png"></div><br>  Powershell几乎是同一回事，即使没有密码也只能使用户处于活动状态。 <br><br><pre> <code class="plaintext hljs">Set-ADUser -Identity BackdoorAdmin -Enabled $true -PasswordNotRequired $true</code> </pre> <br><h3> 将用户添加到组 </h3><br>  <b>RSAT或具有GUI的本地服务器：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b16/f8e/f11/b16f8ef1141004fd838325c7c14d12d8.png"></div><br> 使用AD DC，您需要转到用户的属性，在组中找到具有用户成员身份的列，找到我们要放置它的组并最终添加它，然后单击“确定”。 <br><br>  <b>Powershell：</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/599/613/f38/599613f383d7dc2b5c5dac19bbebf025.png"></div><br> 如果我们不知道所需的群组名称，则可以使用以下方式获取它们的列表： <br><br><pre> <code class="plaintext hljs">(Get-ADGroup -Server localhost -Filter *).name</code> </pre> <br> 您可以使用以下所有属性获得一个组： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/246/ed0/7bb/246ed07bb8d7d5e695627b98b337b568.png"></div><br><pre> <code class="plaintext hljs">Get-ADGroup -Server localhost -Filter {Name -Like "Administrators"}</code> </pre> <br> 最后，将用户添加到组中： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9cf/28c/752/9cf28c7525a9d5b527530b4778d3d52a.png"></div><br> 此外，由于所有内容都是Powershell中的对象，因此，就像通过AD DC一样，我们必须首先获取用户组，然后将其添加到其中。 <br><br><pre> <code class="plaintext hljs">$user = Get-ADUser BackdoorAdmin</code> </pre> <br> 然后将此对象添加到组中： <br><br><pre> <code class="plaintext hljs">Get-ADGroup -Server localhost -Filter {Name -Like "Administrators"} | Add-ADGroupMember -Members $user</code> </pre> <br> 并检查： <br><br><pre> <code class="plaintext hljs">Get-ADGroupMember -Identity Administrators</code> </pre> <br> 如您所见，通过AD AC和Powershell管理AD几乎没有区别。 <br><br><h2> 结论： </h2><br> 如果您已经遇到了AD和其他服务的部署，那么您可能已经注意到通过RSAT和Powershell进行部署的相似之处，以及所有内容的真实情况。 毕竟，GUI是核心。 <br><br> 我们希望本文有用或有趣。 <br><br> 最后，一些实用技巧： <br><br><ol><li> 不要在域控制器上安装其他角色。 </li><li> 使用BPA（最佳实践分析器）可以稍微加快控制器的速度 </li><li> 不要使用内置的Enterprice Admin，请始终使用自己的帐户。 </li><li> 在具有转发端口或VSD的白色IP地址上部署服务器时，请确保关闭端口389，否则您将成为DDoS攻击放大点。 </li></ol><br> 我们还提供阅读过往的帖子的内容： <a href="https://habr.com/ru/company/ultravds/blog/469549/">有关</a>如何使用带有服务器核心的<a href="https://ultravds.com/">VDS Ultralight</a>资费示例（99卢布） <a href="https://habr.com/ru/company/ultravds/blog/474312/">来</a>准备客户端虚拟机， <a href="https://habr.com/ru/company/ultravds/blog/474312/">如何与Windows Server 2019 Core一起使用以及如何在其上安装GUI</a>以及如何使用Windows Admin <a href="https://habr.com/ru/company/ultravds/blog/476416/">管理</a>服务器的<a href="https://habr.com/ru/company/ultravds/blog/469549/">故事</a>中心如何在Windows Server Core 2019上<a href="https://habr.com/ru/company/ultravds/blog/479850/">安装</a> Exchange 2019 <br><br> 我们提供了已更新的UltraLite <a href="https://ultravds.com/">Windows VDS</a>关税，已安装Windows Server 2019 Core的价格为99卢布。 <br> <a href="https://ultravds.com/"><img src="https://habrastorage.org/webt/ww/d4/ro/wwd4ro5_5a28hvdxyazf3enjxou.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN480776/">https://habr.com/ru/post/zh-CN480776/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN480756/index.html">打开数据。 罗斯科莫斯。 让我们像在NASA中一样</a></li>
<li><a href="../zh-CN480760/index.html">在国外工作：哪些国家的互联网速度最快？</a></li>
<li><a href="../zh-CN480762/index.html">V＆V并不意味着仇杀</a></li>
<li><a href="../zh-CN480772/index.html">技术债务不可避免的简单原因</a></li>
<li><a href="../zh-CN480774/index.html">不统一的Nginx：Ayhor托管-实时划线</a></li>
<li><a href="../zh-CN480778/index.html">手势管理：处理视觉覆盖。 第二部分</a></li>
<li><a href="../zh-CN480780/index.html">如何用立方体和象形图组装插图</a></li>
<li><a href="../zh-CN480782/index.html">我开始使用Angular时要知道的5件事</a></li>
<li><a href="../zh-CN480788/index.html">命令行上的圣诞树</a></li>
<li><a href="../zh-CN480790/index.html">“工厂效率”。 找到瓶颈并实施拉动系统以提高生产率</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>