<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÇ üïäÔ∏è üéÖüèº Wir schreiben einen Angelbot im Spiel Albion Online in Python üë©üèæ‚Äçü§ù‚Äçüë®üèª üëéüèº üëßüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits, ich bin ein gl√ºcklicher Benutzer des GNU / Linux-Betriebssystems. Und wie viele Leute wissen, gibt es viel weniger Spielzeug, das oh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir schreiben einen Angelbot im Spiel Albion Online in Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459110/"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/d19/0a2/dbbd190a2f9638019018783a7cd87d6e.jpg" alt="Bild"><br><br>  Hallo allerseits, ich bin ein gl√ºcklicher Benutzer des GNU / Linux-Betriebssystems. Und wie viele Leute wissen, gibt es viel weniger Spielzeug, das ohne zus√§tzliche T√§nze mit einem Tamburin zu Linux geht als unter Windows. <br><br>  Und noch weniger Spiele im MMORPG-Genre. <br><br>  Vor ungef√§hr einem halben oder einem Jahr fand ich jedoch heraus, dass sie das Albion Online-Spiel auf Linux portiert hatten. <br>  Das Spiel ist sehr unterhaltsam, nimmt aber ziemlich viel Zeit in Anspruch.  Und um meine kostbaren Lebensstunden nicht umsonst zu verschwenden, beschloss ich, einen Bot zu schreiben.  Wer wird mir Ressourcen bewirtschaften, w√§hrend ich meinem Gesch√§ft nachgehe? <br><br>  Das Spiel hat viele Arten von Kunsthandwerk, man kann Holz schneiden, Steine ‚Äã‚Äãgraben, sogar G√§rten anlegen, aber ich habe mich f√ºr das Angeln entschieden. <br><a name="habracut"></a><br>  Die Essenz des Online-Fischens in Albion ist also einfach: Nehmen Sie eine Angelrute, gehen Sie zum Teich, halten Sie den Knopf gedr√ºckt, um den K√∂der zu werfen, und warten Sie auf eine bestimmte Bisszeit. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cef/bb4/9f2/cefbb49f2112b5f63ca0a793f6fa9799.png" alt="Bild"><br><br>  Beim Picken m√ºssen Sie erneut die Tasten dr√ºcken und ein Minispiel spielen. <br><br>  Hier m√ºssen Sie abwechselnd ziehen, dann ziehen Sie nicht an der Angelrute, abh√§ngig von den Bewegungen des Schwimmers.  Der Schwimmer bewegt sich immer zuf√§llig mit unterschiedlichen Sequenzen und Geschwindigkeiten.  Und wenn Sie alles richtig machen und der Schwimmer nicht √ºber die zul√§ssige Zone hinausgeht, werden Sie Fische fangen. <br><br>  Also werden wir all dieses Gesch√§ft automatisieren.  Mit Hilfe der Computersprache Python.  Ich entschied mich f√ºr das Schwierigste, n√§mlich f√ºr den Moment, in dem das Spiel mit einem Float beginnt.  Auch hier kam mir meine Lieblings- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OpenCV-</a> Computer-Vision- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bibliothek</a> zu Hilfe.  Durch das Starten k√∂nnen wir Objekte beispielsweise in Bildern erkennen.  Die Bibliothek selbst wei√ü jedoch nicht genau, was wir entdecken m√ºssen.  Nat√ºrlich gibt es viele Muster, in denen verschiedene Objekte dargestellt werden, um sie zu definieren.  Es gibt jedoch definitiv keine Floats f√ºr Albion Online. <br><br>  Aber in dieser Bibliothek gibt es eine wunderbare Suchfunktion f√ºr eine bestimmte Vorlage.  Und als Vorlage habe ich gerade einen Screenshot unseres Schwimmers gemacht. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b0/47a/5d9/7b047a5d988af0b78f2a7ff897df05e9.png" alt="Bild"><br><br>  Und wie wir sehen, war alles perfekt auf dem Bild zu finden. <br><br>  Und der Unterschied zwischen dem Bild und dem Streaming-Video ist nicht gro√ü, denn es handelt sich tats√§chlich nur um einen Stream von Bildern mit einer sehr hohen Geschwindigkeit und einigen Codezeilen.  Und jetzt k√∂nnen wir den Float bereits im Streaming-Video finden. <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mss.linux <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MSS <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> mss <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyautogui <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mss <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy template = cv2.imread(<span class="hljs-string"><span class="hljs-string">"2019-07-02_06-55_1.png"</span></span>, cv2.IMREAD_GRAYSCALE) w, h = template.shape[::<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> mss.mss() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sct: monitor = {<span class="hljs-string"><span class="hljs-string">"top"</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-string"><span class="hljs-string">"left"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">800</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">640</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-string"><span class="hljs-string">"Screen capturing"</span></span>: last_time = time.time() img = numpy.array(sct.grab(monitor)) cv2.imshow(<span class="hljs-string"><span class="hljs-string">"OpenCV/Numpy normal"</span></span>, img) print(<span class="hljs-string"><span class="hljs-string">"fps: {}"</span></span>.format(<span class="hljs-number"><span class="hljs-number">1</span></span> / (time.time() - last_time))) gray_frame = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) res = cv2.matchTemplate(gray_frame, template, cv2.TM_CCOEFF_NORMED) loc = np.where(res &gt;= <span class="hljs-number"><span class="hljs-number">0.7</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> pt <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(*loc[::<span class="hljs-number"><span class="hljs-number">-1</span></span>]): cv2.rectangle(img, pt, (pt[<span class="hljs-number"><span class="hljs-number">0</span></span>] + w, pt[<span class="hljs-number"><span class="hljs-number">1</span></span>] + h), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">3</span></span>) cv2.imshow(<span class="hljs-string"><span class="hljs-string">"Frame"</span></span>, img) key = cv2.waitKey(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cv2.waitKey(<span class="hljs-number"><span class="hljs-number">25</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> == ord(<span class="hljs-string"><span class="hljs-string">"q"</span></span>): cv2.destroyAllWindows() <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre> <br></div></div><br>  Wir gehen weiter.  Der Schwimmer selbst bewegt sich hin und her und wir m√ºssen ihn auch durch Dr√ºcken der Maustaste bewegen. <br><br>  Und deshalb brauchen wir seine Koordinaten.  Und daf√ºr helfen uns diese Zeilen. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> img: pts = (pt[<span class="hljs-number"><span class="hljs-number">0</span></span>],pt[<span class="hljs-number"><span class="hljs-number">1</span></span>]) x = (pt[<span class="hljs-number"><span class="hljs-number">0</span></span>]) y = (pt[<span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (x) cv2.circle(template,pts,<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-number"><span class="hljs-number">200</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>),<span class="hljs-number"><span class="hljs-number">2</span></span>) cv2.putText(img, <span class="hljs-string"><span class="hljs-string">"%d-%d"</span></span> % (x,y), (x+<span class="hljs-number"><span class="hljs-number">10</span></span>,y<span class="hljs-number"><span class="hljs-number">-10</span></span>), cv2.FONT_HERSHEY_SIMPLEX, <span class="hljs-number"><span class="hljs-number">1</span></span>, color_yellow, <span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>  Dann verwenden wir einfach die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PyAutoGUI-</a> Bibliothek, die die Maustaste festklemmt und mit einer bestimmten Frequenz dr√ºckt. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> &lt; x &lt; <span class="hljs-number"><span class="hljs-number">500</span></span>: pyautogui.mouseDown(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.mouseUp(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) x = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br>  Und das Minispiel selbst ist erfolgreich gewonnen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/012/b6b/a40/012b6ba4054f6db696a76bd196205a7d.png" alt="Bild"><br><br>  Wir setzen das Ganze in eine Funktion und lassen es vorerst. <br><br>  Dann kehren wir zum Originalteil zur√ºck, wo wir den Schwimmer √ºberwachen m√ºssen. <br><br>  Es ist alles ein bisschen anders, zum Beispiel k√∂nnen wir bestimmen, wohin sich der Schwimmer selbst wirft, und versuchen, diesen Teil des Bildschirms auf das Vorhandensein des Schwimmers zu analysieren.  Der ins Wasser geworfene Schwimmer erscheint jedoch in unterschiedlichen Winkeln und schwankt st√§ndig. <br><br>  In diesem Fall werden wir diese etwas andere Methode anwenden.  Das Wesentliche ist, dass wir den Unterschied in Pixeln innerhalb des verfolgten Fragments analysieren.  Was, wenn kein Float vorhanden ist, gegen Null geht. <br><br>  Als Ergebnis wurde der optimale Wert gefunden, bei dem wir mit dem Verschwinden des Schwimmers Aktionen ausf√ºhren k√∂nnen. <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">screen_record</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> sct = mss.mss() last_time = time.time() <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): img = sct.grab(mon) print(<span class="hljs-string"><span class="hljs-string">'loop took {} seconds'</span></span>.format(time.time() - last_time)) last_time = time.time() img = np.array(img) processed_image = process_image(img) mean = np.mean(processed_image) print(<span class="hljs-string"><span class="hljs-string">'mean = '</span></span>, mean) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> mean &lt;= float(<span class="hljs-number"><span class="hljs-number">0.11</span></span>): print(<span class="hljs-string"><span class="hljs-string">'SSSSSSSS '</span></span>) pyautogui.click(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: time.sleep(<span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cv2.waitKey(<span class="hljs-number"><span class="hljs-number">25</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> == ord(<span class="hljs-string"><span class="hljs-string">'q'</span></span>): cv2.destroyAllWindows() <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre><br></div></div><br>  Und wir produzieren sie, n√§mlich per Mausklick.  Wir setzen dies auch in die Funktion ein. <br><br>  Und zum Schluss schreiben wir einfach ein Skript, in dem wir in einer Endlosschleife eine Angel werfen und abwechselnd die erste und die zweite Funktion ausf√ºhren. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>: time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.moveTo(<span class="hljs-number"><span class="hljs-number">431</span></span>,<span class="hljs-number"><span class="hljs-number">175</span></span>,duration=<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.mouseDown(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) pyautogui.moveTo(<span class="hljs-number"><span class="hljs-number">450.200</span></span>,duration=<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.mouseUp(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>) screen_record() time.sleep(<span class="hljs-number"><span class="hljs-number">0.01</span></span>) ss()</code> </pre><br>  Hier ist eine vollst√§ndige Videoanweisung und ein Beispiel f√ºr die Arbeit dieses Bots: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/92XnJ3s0vX8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Es gibt wirklich einige Nuancen, die Sie mit Zahlen schamanisieren m√ºssen, da diese Zahlen f√ºr meinen Monitor, meinen Standort, meinen Charakter und meine Ausr√ºstung ausgew√§hlt sind.  Aber ich denke f√ºr einen kompetenten Pythonisten wird dies kein Problem sein. <br><br>  Das ganze Drehbuch: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mss.linux <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MSS <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> mss <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyautogui <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> imutils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mss <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyautogui template = cv2.imread(<span class="hljs-string"><span class="hljs-string">"2019-07-02_06-55_1.png"</span></span>, cv2.IMREAD_GRAYSCALE) w, h = template.shape[::<span class="hljs-number"><span class="hljs-number">-1</span></span>] color_yellow = (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>) mon = {<span class="hljs-string"><span class="hljs-string">'top'</span></span>: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-string"><span class="hljs-string">'left'</span></span>: <span class="hljs-number"><span class="hljs-number">350</span></span>, <span class="hljs-string"><span class="hljs-string">'width'</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">'height'</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(original_image)</span></span></span><span class="hljs-function">:</span></span> processed_image = cv2.cvtColor(original_image, cv2.COLOR_BGR2GRAY) processed_image = cv2.Canny(processed_image, threshold1=<span class="hljs-number"><span class="hljs-number">200</span></span>, threshold2=<span class="hljs-number"><span class="hljs-number">300</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> processed_image <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> op = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> mss.mss() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sct: monitor = {<span class="hljs-string"><span class="hljs-string">"top"</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-string"><span class="hljs-string">"left"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">800</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">640</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-string"><span class="hljs-string">"Screen capturing"</span></span>: last_time = time.time() img = numpy.array(sct.grab(monitor)) gray_frame = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) res = cv2.matchTemplate(gray_frame, template, cv2.TM_CCOEFF_NORMED) loc = np.where(res &gt;= <span class="hljs-number"><span class="hljs-number">0.7</span></span>) op += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (op) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> pt <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(*loc[::<span class="hljs-number"><span class="hljs-number">-1</span></span>]): cv2.rectangle(img, pt, (pt[<span class="hljs-number"><span class="hljs-number">0</span></span>] + w, pt[<span class="hljs-number"><span class="hljs-number">1</span></span>] + h), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> img: pts = (pt[<span class="hljs-number"><span class="hljs-number">0</span></span>],pt[<span class="hljs-number"><span class="hljs-number">1</span></span>]) x = (pt[<span class="hljs-number"><span class="hljs-number">0</span></span>]) y = (pt[<span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (x) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> &lt; x &lt; <span class="hljs-number"><span class="hljs-number">490</span></span>: pyautogui.mouseDown(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>) pyautogui.mouseUp(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) x = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> key = cv2.waitKey(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cv2.waitKey(<span class="hljs-number"><span class="hljs-number">25</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> == ord(<span class="hljs-string"><span class="hljs-string">"q"</span></span>): cv2.destroyAllWindows() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> op &gt; <span class="hljs-number"><span class="hljs-number">35</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">screen_record</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> sct = mss.mss() last_time = time.time() <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): img = sct.grab(mon) print(<span class="hljs-string"><span class="hljs-string">'loop took {} seconds'</span></span>.format(time.time() - last_time)) last_time = time.time() img = np.array(img) processed_image = process_image(img) mean = np.mean(processed_image) print(<span class="hljs-string"><span class="hljs-string">'mean = '</span></span>, mean) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> mean &lt;= float(<span class="hljs-number"><span class="hljs-number">0.11</span></span>): print(<span class="hljs-string"><span class="hljs-string">'SSSSSSSS '</span></span>) pyautogui.click(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: time.sleep(<span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cv2.waitKey(<span class="hljs-number"><span class="hljs-number">25</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> == ord(<span class="hljs-string"><span class="hljs-string">'q'</span></span>): cv2.destroyAllWindows() <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>: time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.moveTo(<span class="hljs-number"><span class="hljs-number">431</span></span>,<span class="hljs-number"><span class="hljs-number">175</span></span>,duration=<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.mouseDown(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) pyautogui.moveTo(<span class="hljs-number"><span class="hljs-number">450.200</span></span>,duration=<span class="hljs-number"><span class="hljs-number">1</span></span>) pyautogui.mouseUp(button=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>) screen_record() time.sleep(<span class="hljs-number"><span class="hljs-number">0.01</span></span>) ss()</code> </pre><br></div></div><br>  Diejenigen, die gerne sagen, dass dies Zeitverschwendung ist, werden feststellen, dass dies nur ein Werkzeug ist. Sie k√∂nnen diese Bibliotheken in anderen Projekten verwenden.  Computer Vision selbst wird sowohl beim Schweben ballistischer Raketen als auch in Programmen zur Unterst√ºtzung von Menschen mit Behinderungen eingesetzt.  Wo Sie sich entscheiden, sie anzuwenden, nur Ihr Wunsch. <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459110/">https://habr.com/ru/post/de459110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459098/index.html">GitHub Package Registry unterst√ºtzt Swift-Pakete</a></li>
<li><a href="../de459100/index.html">GitHub Package Registry unterst√ºtzt Swift-Pakete</a></li>
<li><a href="../de459102/index.html">Geschenkplatte oder kostenlose Musik f√ºr Cola-Liebhaber und fertiges Fr√ºhst√ºck</a></li>
<li><a href="../de459104/index.html">C # oder Java? TypeScript oder JavaScript? Die Klassifizierung von Programmiersprachen basierend auf maschinellem Lernen</a></li>
<li><a href="../de459108/index.html">Tesla wird in der zweiten H√§lfte dieses Jahres mehrere √úberraschungen gleichzeitig pr√§sentieren</a></li>
<li><a href="../de459112/index.html">Grundlegendes zu Google Chrome Konvertieren von HTML in PDF-Funktionen</a></li>
<li><a href="../de459114/index.html">14 besten WordPress SEO Plugins im Jahr 2019</a></li>
<li><a href="../de459116/index.html">Einen Schritt n√§her an der Thymusreparatur</a></li>
<li><a href="../de459118/index.html">Wie wir das neue Netzwerk auf Huawei im Moskauer B√ºro entworfen und implementiert haben, Teil 2</a></li>
<li><a href="../de459120/index.html">Modulare eingebettete Computer der UNO-1000/2000-Serie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>