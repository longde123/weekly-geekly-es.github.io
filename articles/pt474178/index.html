<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëú ‚úÖ üê´ URA no Webhook üå∂Ô∏è üë®üèΩ‚Äçüé§ üéôÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um chatbot online √© uma tend√™ncia recente no mercado. Mas como interagir com os clientes que est√£o offline? Uma porcentagem significativa de pessoas p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>URA no Webhook</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zadarma/blog/474178/"><img src="https://habrastorage.org/webt/6i/wc/yt/6iwcytdcaivt0kpvrob20iahmsm.png"><br><br>  Um chatbot online √© uma tend√™ncia recente no mercado.  Mas como interagir com os clientes que est√£o offline?  Uma porcentagem significativa de pessoas prefere interagir por telefone.  E a empresa precisa de uma grande equipe de operadores ou de uma solu√ß√£o de automa√ß√£o de comunica√ß√£o de voz.  Estamos oferecendo uma solu√ß√£o para reduzir a carga de trabalho e os custos (e afetar√° apenas a ocupa√ß√£o dos desenvolvedores). <br><a name="habracut"></a><br>  Como programar com rapidez e facilidade qualquer menu de voz, informante autom√°tico, secret√°rio-rob√¥ com um banco de dados de clientes anexado? <br><br>  Alerta de spoiler: tudo √© feito implementando webhooks e estamos usando o exemplo do PHP. <br><br>  <b>O que e porque?</b> <br><br>  Por exemplo, voc√™ tem um servi√ßo de entrega ou uma loja online com sua pr√≥pria log√≠stica.  Alguns clientes est√£o ligando para ver o que h√° com seus pacotes e isso pode ser facilmente automatizado.  O mesmo vale para a geolocaliza√ß√£o da cabine, alguma coleta de dados ou qualquer informa√ß√£o individual que possa ser relatada ao cliente sem desperdi√ßar energia humana. <br><br>  Pode ser facilmente automatizado, forneceremos um exemplo abaixo.  Ah, e isso pode ser feito completamente de gra√ßa. <br><br>  <b>Por que n√£o seu pr√≥prio asterisco?</b> <br><br>  Obviamente, tudo isso pode ser feito com o Asterisk, mas, al√©m do desenvolvedor, voc√™ tamb√©m precisar√° de um administrador, que tamb√©m esteja familiarizado com a seguran√ßa da comunica√ß√£o por voz (pois eles frequentemente s√£o invadidos). <br>  Ent√£o, discutiremos a maneira mais simples de resolver a tarefa - com webhooks. <br><br>  <b>Lista de m√©todos</b> <br><br>  Voc√™ precisar√° apenas de dois m√©todos novos para o trabalho, mas cada um deles oferece muitas possibilidades, e o mais importante - ciclos ilimitados.  Com a ajuda desses ciclos, voc√™ pode obter um menu de voz em v√°rios n√≠veis e um informante para qualquer assunto. <br><br>  <b>Principais m√©todos:</b> <br><br><ul><li>  NOTIFY_START - o in√≠cio de uma chamada recebida no PBX </li><li>  NOTIFY_IVR - resposta dos chamadores a uma determinada a√ß√£o </li></ul><br>  A descri√ß√£o detalhada do m√©todo est√° dispon√≠vel para copiar e colar na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descri√ß√£o da API</a> . <br><br>  Para solicita√ß√µes NOTIFY_START e NOTIFY_IVR, voc√™ pode alterar os cen√°rios durante a chamada, respondendo com uma das op√ß√µes: <br><br><img src="https://habrastorage.org/webt/o-/qb/2j/o-qb2j_sbansavtyv9ozmcepotw.png"><br><img src="https://habrastorage.org/webt/km/jz/g9/kmjzg91272jweekf2s1mwv6g-re.png"><br><img src="https://habrastorage.org/webt/er/u4/kf/eru4kf3bhtepzadbkqjgwsk8oic.png"><br><img src="https://habrastorage.org/webt/_y/fg/7a/_yfg7akgztm3m-9nxqcqpowpcvo.png"><br><img src="https://habrastorage.org/webt/da/xh/d-/daxhd-p3c1f2ewcljo4xg-o85qu.png"><br><img src="https://habrastorage.org/webt/nj/rd/o3/njrdo3kqwruuctzcogbjdrw3vh0.png"><br><br>  Assim, um cliente liga e ouve a sauda√ß√£o e depois disca um determinado n√∫mero (por exemplo, um c√≥digo de rastreamento), enviamos uma notifica√ß√£o com os d√≠gitos inseridos, o script verifica o banco de dados e envia a resposta para n√≥s.  A resposta pode conter um ID de arquivo de voz ou uma resposta de voz padr√£o. <br><br>  Temos um sistema padr√£o de reprodu√ß√£o de n√∫meros, para que voc√™ n√£o precise gravar uma resposta com anteced√™ncia;  ou seja, a notifica√ß√£o apropriada √© escolhida no banco de dados e √© reproduzida como um n√∫mero por um rob√¥.  Ou voc√™ pode criar at√© cem mensagens de voz padr√£o e us√°-las para responder aos clientes (por exemplo, ‚ÄúSua entrega est√° no armaz√©m‚Äù, ‚ÄúVoc√™ pode receber seu pacote todos os dias entre 9:00 e 22:00). <br><br>  <b>O m√≠nimo de implementa√ß√£o</b> <br><br>  Para o atendedor responder, voc√™ precisa do n√∫mero m√≠nimo de telefone e de um PBX.  Voc√™ tamb√©m deve enviar ou inserir as respostas poss√≠veis. <br><br>  <b>Configurar</b> <br><br><img src="https://habrastorage.org/webt/nr/wc/u_/nrwcu_blznq1tjzmncdz3i4s_fy.png"><br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O PBX gratuito</a> para esta tarefa pode ser definido em tr√™s cliques (escolha o n√∫mero de funcion√°rios e o menu de voz pode ser definido posteriormente) </li><li>  Os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">n√∫meros de</a> telefone do PBX podem ser conectados a partir de 100 pa√≠ses ao redor do mundo.  O n√∫mero se conecta automaticamente ap√≥s a conclus√£o da verifica√ß√£o do ID (se for necess√°rio para o pa√≠s de sua escolha).  Voc√™ tamb√©m pode conectar um de seu pr√≥prio n√∫mero gratuitamente </li><li>  Para definir os menus de voz, v√° para a p√°gina "Chamadas recebidas e URA" e escolha uma op√ß√£o que melhor lhe convier.  Ou voc√™ pode enviar seus arquivos ou digitar um texto e o rob√¥ o ler√° automaticamente.  Existem 16 idiomas dispon√≠veis com v√°rias vozes para cada um (14 vozes em ingl√™s).  Voc√™ pode salvar at√© 100 sauda√ß√µes em sua conta pessoal. </li></ol><br><img src="https://habrastorage.org/webt/fi/om/f_/fiomf_rhb6i5kneddqae5pxj_uy.png"><br><br>  <b>Exemplo PHP</b> <br><br>  Para demonstrar op√ß√µes diferentes, criamos 4 exemplos de desempenho de URA no PHP. <br><br><ol><li>  O sistema informa os tr√™s √∫ltimos d√≠gitos do CallerID (exemplo de trabalho com informa√ß√µes sobre n√∫meros e d√≠gitos pronunciados) </li><li>  O usu√°rio digita a data de nascimento em DTMF e o sistema informa quantos dias faltam at√© o anivers√°rio (trabalhando com DTMF e pronunciando d√≠gitos) </li><li>  Menu multin√≠vel sem fim: o usu√°rio pode digitar d√≠gitos e acessar o menu seguinte / anterior (exemplo de como, com um ciclo simples, voc√™ pode criar qualquer n√∫mero de menus de voz) </li><li>  Exemplo de autoriza√ß√£o para receber o status da balan√ßa (√∫til para muitas situa√ß√µes da vida) </li></ol><br>  Os tr√™s primeiros exemplos est√£o dispon√≠veis no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> .  L√° voc√™ tem todos os elementos necess√°rios, basta inserir os arquivos com o preenchimento (que devem ser enviados anteriormente ou lidos no PBX). <br><br>  <b>Tarefa 4</b> : o chamador ouve a sauda√ß√£o e √© solicitado a digitar o n√∫mero de identifica√ß√£o; depois de entrar no sistema, informa a balan√ßa, despede-se usando uma frase popular da lista e encerra a chamada. <br><br>  Aqui est√° um exemplo de c√≥digo para a tarefa descrita. <br>  <b>C√≥digo PHP</b> <br><br><pre><code class="php hljs">$request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Request(); $notify = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::getEvent([AbstractNotify::EVENT_START, AbstractNotify::EVENT_IVR]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$notify) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> ($notify-&gt;event){ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> AbstractNotify::EVENT_START: $request -&gt;setIvrPlay(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::INFO_FILE_ID) -&gt;setWaitDtmf(TIMEOUT , ATTEMPTS, MAXDIGITS, DTMF_NAME, DEFAULT_BEHAVIOUR); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> AbstractNotify::EVENT_IVR: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($notify-&gt;wait_dtmf-&gt;digits)) { $balance = getBalance($notify-&gt;wait_dtmf-&gt;digits); $request-&gt;setIvrSayNumber($balance, <span class="hljs-string"><span class="hljs-string">'en'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($notify-&gt;ivr_saynumber)) { $request-&gt;setIvrSayPopular(POPULAR_PHRASE_NUM, <span class="hljs-string"><span class="hljs-string">'en'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $request-&gt;setHangup(); } } $request-&gt;send();</code> </pre> <br>  Pretendemos expandir ainda mais os recursos de nosso m√©todo e coletar feedback nos coment√°rios abaixo.  Tamb√©m temos outros m√©todos de webhook e API dispon√≠veis. Voc√™ pode ver a lista completa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no site</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt474178/">https://habr.com/ru/post/pt474178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt474164/index.html">Zimbra √© o nosso tudo</a></li>
<li><a href="../pt474166/index.html">√çndices de capas para GiST</a></li>
<li><a href="../pt474170/index.html">Confiss√£o de Design - 15 de novembro, Moscou, DI Telegraph</a></li>
<li><a href="../pt474172/index.html">Multa de 30 mil euros pelo uso ilegal de cookies</a></li>
<li><a href="../pt474176/index.html">11 v√≠deos do primeiro dia do DevFest 2019 em Kaliningrado</a></li>
<li><a href="../pt474180/index.html">Como a arquitetura da Web tolerante a falhas √© implementada na plataforma Mail.ru Cloud Solutions</a></li>
<li><a href="../pt474184/index.html">Passamos o desafio de Callum Macrae 100%</a></li>
<li><a href="../pt474186/index.html">Refutando mitos: pr√°ticas reais de TI na Arm√™nia</a></li>
<li><a href="../pt474192/index.html">Por que mudei do UX para o PM e depois para o Lead PM e o que mudou?</a></li>
<li><a href="../pt474194/index.html">Equipe b√∫ssola</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>