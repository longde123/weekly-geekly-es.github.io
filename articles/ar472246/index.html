<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ฉ ใฝ๏ธ ุฑุฏ + IndexDb + ุงูุชุญุฏูุซ ุงูุชููุงุฆู = AsyncRedux ุชูุฑูุจูุง ๐ง๐ป ๐ง ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุฐู ุงูููุงูุฉ ุ ุณุฃุฎุจุฑู ุฎุทูุฉ ุจุฎุทูุฉ ุนู ููููุฉ ุฅุนุฏุงุฏ IndexDB (ูุงุนุฏุฉ ุจูุงูุงุช ูุถูููุฉ ูู ุฃู ูุณุชุนุฑุถ ุญุฏูุซ) ูุงุณุชุฎุฏุงููุง ูู ุงููุดุงุฑูุน ุงูููุชูุจุฉ ูู ReactJS. ูุชูุฌุฉ ูุฐ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฑุฏ + IndexDb + ุงูุชุญุฏูุซ ุงูุชููุงุฆู = AsyncRedux ุชูุฑูุจูุง</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472246/" style=";text-align:right;direction:rtl"><img width="300" align="right" src="https://habrastorage.org/webt/ak/5r/t4/ak5rt4e4mavxwvxlaidpfgiie0g.jpeg">  ูู ูุฐู ุงูููุงูุฉ ุ ุณุฃุฎุจุฑู ุฎุทูุฉ ุจุฎุทูุฉ ุนู ููููุฉ ุฅุนุฏุงุฏ IndexDB (ูุงุนุฏุฉ ุจูุงูุงุช ูุถูููุฉ ูู ุฃู ูุณุชุนุฑุถ ุญุฏูุซ) ูุงุณุชุฎุฏุงููุง ูู ุงููุดุงุฑูุน ุงูููุชูุจุฉ ูู ReactJS.  ูุชูุฌุฉ ูุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ูู IndexDB ุจุณูููุฉ ููุง ูู ูุงูุช ููุฌูุฏุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Redux Store ูู</a> ุงูุชุทุจูู ุงูุฎุงุต ุจู. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">IndexDB</a> ูู DBMS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุฌู</a> ูููุซุงุฆู ุ ููู ุฃุฏุงุฉ ููุงุฆูุฉ ููุชุฎุฒูู ุงููุคูุช ููููุฉ ุตุบูุฑุฉ ูุณุจูุง (ูุญุฏุงุช ูุนุดุฑุงุช ููุบุงุจุงูุช) ูู ุงูุจูุงูุงุช ุงููููููุฉ ุนูู ุฌุงูุจ ุงููุชุตูุญ.  ุชุชุถูู ุงููููุฉ ุงูููุงุณูุฉ ุงูุชู ูุฌุจ ุนููู ุงุณุชุฎุฏุงููุง ูู IndexDB ุชุฎุฒูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูุคูุชูุง ูุฃุฏูุฉ ุงูุฃุนูุงู ูู ุฌุงูุจ ุงูุนููู (ุฃุณูุงุก ุงูุจูุฏุงู ูุงููุฏู ูุงูุนููุงุช ุญุณุจ ุงูููุฏ ููุง ุฅูู ุฐูู).  ุจุนุฏ ูุณุฎูุง ุฅูู ุฌุงูุจ ุงูุนููู ุ ููููู ููุท ุชูุฒูู ุงูุชุญุฏูุซุงุช ูู ูุฐู ุงูุฏูุงุฆู ูู ุงูุฎุงุฏู (ุฃู ูููุง - ุตุบูุฑุฉ) ููุง ุชููู ุจุฐูู ูู ูู ูุฑุฉ ุชูุชุญ ูููุง ูุงูุฐุฉ ุงููุชุตูุญ. <br><a name="habracut"></a><br>  ููุงู ุทุฑู ุบูุฑ ููุงุณูุฉ ููุซูุฑุฉ ููุฌุฏู ููุบุงูุฉ ุ ูููู ุชุนูู ูุงุณุชุฎุฏุงู IndexDB: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฎุฒูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูุคูุชูุง ุญูู <b>ุฌููุน</b> ูุงุฆูุงุช ุงูุฃุนูุงู ุญุชู ูุชุณูู ุนูู ุฌุงูุจ ุงููุชุตูุญ ุงุณุชุฎุฏุงู ุฅููุงูุงุช ุงููุฑุฒ ูุงูุชุตููุฉ ุงูุดุงููุฉ </li><li style=";text-align:right;direction:rtl">  ุชุฎุฒูู ุญุงูุฉ ุงูุชุทุจูู ูู IndexDB ุจุฏูุงู ูู Redux Store </li></ul><br>  ููุงู ุซูุงุซุฉ ุงุฎุชูุงูุงุช ุฑุฆูุณูุฉ ุจูู IndexDB ู Redux Store ูููุฉ ุจุงููุณุจุฉ ููุง: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  IndexDB ูู ูุญุฏุฉ ุชุฎุฒูู ุฎุงุฑุฌูุฉ ูุง ูุชู ูุณุญูุง ุนูุฏ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ููุณู ุจุงููุณุจุฉ ูุนุฏุฉ ุนูุงูุงุช ุชุจููุจ ููุชูุญุฉ (ููุง ูุคุฏู ุฃุญูุงููุง ุฅูู ุณููู ุบูุฑ ูุชููุน ุฅูู ุญุฏ ูุง) </li><li style=";text-align:right;direction:rtl">  IndexDB ูู DBMS ุบูุฑ ูุชุฒุงูู ุชูุงูุง.  ุฌููุน ุงูุนูููุงุช - ุงูุงูุชุชุงุญ ุ ูุงููุฑุงุกุฉ ุ ูุงููุชุงุจุฉ ุ ูุงูุจุญุซ - ุบูุฑ ูุชุฒุงูู. </li><li style=";text-align:right;direction:rtl">  ูุง ูููู ุชุฎุฒูู IndexDB (ุจุทุฑููุฉ ุชุงููุฉ) ูู JSON ูุงุณุชุฎุฏุงู ุชูููุงุช ุงูุฎุฏุงุน ุงูุฐููู ูู Redux ูุฅูุดุงุก ููุทุงุช ุ ูุณูููุฉ ุชุตุญูุญ ุงูุฃุฎุทุงุก ุ ูุฑุญูุฉ ุฅูู ุงููุงุถู. </li></ol><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 0: ูุงุฆูุฉ ุงูููุงู </h2><br>  ุจุงููุนู ูุซุงู ููุงุณููู ูุน ูุงุฆูุฉ ุงูููุงู.  ุงูุจุฏูู ูุน ุชุฎุฒูู ุงูุญุงูุฉ ูู ููุงูุฉ ุงููููู ุงูุญุงูู ูุงููุญูุฏ <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูููุฐ ูููู ูุงุฆูุฉ ุงูููุงู ุชุฎุฒูู ุงููุงุฆูุฉ ูู ุญุงูุฉ ุงููููู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Button'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> counter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'common/counter'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Form <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Table <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Table'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step0</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'Sample task'</span></span> }, ], }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ ...state.tasks, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: state.newTaskText } ], <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, } ) ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDeleteF = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">idToDelete</span></span></span><span class="hljs-function"> =&gt;</span></span> () =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: state.tasks.filter( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> { id } </span></span></span><span class="hljs-function">) =&gt;</span></span> id !== idToDelete ), } ) ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleNewTaskTextChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> { target: { value } } </span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: value || <span class="hljs-string"><span class="hljs-string">''</span></span>, } ); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bordered</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">hover</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">striped</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">#</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Text</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { this.state.tasks.map( task =&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{task.id}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{task.id}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{task.text}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleDeleteF(</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">task.id</span></span></span></span><span class="xml"><span class="hljs-tag"> )} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"danger"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"+1"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Form.Control</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleNewTaskTextChange}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"  "</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.newTaskText</span></span></span></span><span class="xml"><span class="hljs-tag"> || ''} /&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleAdd}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">; } }</span></span></code> </pre>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) </div></div><br>  ุญุชู ุงูุขู ุ ุฌููุน ุงูุนูููุงุช ูุน ุงูููุงู ูุชุฒุงููุฉ.  ุฅุฐุง ุงุณุชุบุฑูุช ุฅุถุงูุฉ ูููุฉ 3 ุซูุงูู ุ ูุณูุชู ุชุฌููุฏ ุงููุชุตูุญ ููุฏุฉ 3 ุซูุงูู ููุท.  ุจุงูุทุจุน ุ ุจูููุง ูุญุชูุธ ุจูู ุดูุก ูู ุฐุงูุฑุชูุง ุ ูุง ูููููุง ุงูุชูููุฑ ูู ุงูุฃูุฑ.  ุนูุฏูุง ูููู ุจุชุถููู ุงููุนุงูุฌุฉ ุจุงุณุชุฎุฏุงู ุฎุงุฏู ุฃู ูุน ูุงุนุฏุฉ ุจูุงูุงุช ูุญููุฉ ุ ูุณูุชุนูู ุนูููุง ุงูุงูุชูุงู ุจุงููุนุงูุฌุฉ ุงูุฌูููุฉ ููุชุฒุงูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุญุธุฑ ุงูุนูู ุจุงุณุชุฎุฏุงู ุฌุฏูู (ุฃู ุนูุงุตุฑ ูุฑุฏูุฉ) ุฃุซูุงุก ุฅุถุงูุฉ ุนูุงุตุฑ ุฃู ุฅุฒุงูุชูุง. <br><br>  ูู ุฃุฌู ุนุฏู ุชูุฑุงุฑ ูุตู ูุงุฌูุฉ ุงููุณุชุฎุฏู ูู ุงููุณุชูุจู ุ ุณูุถุนูุง ูู ูููู TaskList ูููุตู ุ ุงููููุฉ ุงููุญูุฏุฉ ุงูุชู ุณุชููู ุจุฅูุดุงุก ููุฏ HTML ููุงุฆูุฉ ุงูููุงู.  ูู ุงูููุช ููุณู ุ ุณูุณุชุจุฏู ุงูุฃุฒุฑุงุฑ ุงููุนุชุงุฏุฉ ุจููู ุฎุงุต ุญูู ุฒุฑ ุงูุชูููุฏ ุ ูุงูุฐู ุณูุญุธุฑ ุงูุฒุฑ ุญุชู ูููู ูุนุงูุฌ ุงูุฃุฒุฑุงุฑ ุชูููุฐู ุ ุญุชู ูู ูุงูุช ูุฐู ุงููุนุงูุฌ ูุธููุฉ ุบูุฑ ูุชุฒุงููุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุทุจูู ูููู ุชุฎุฒูู ูุงุฆูุฉ ููุงู ูู ุญุงูุฉ ุฑุฏ ุงููุนู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> counter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'common/counter'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TaskList <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../common/TaskList'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step01</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'Sample task'</span></span> }, ] }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newTaskText</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ ...state.tasks, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ], } ) ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDelete = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">idToDelete</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: state.tasks.filter( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> { id } </span></span></span><span class="hljs-function">) =&gt;</span></span> id !== idToDelete ), } ) ); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;&gt; &lt;h1&gt;      &lt;/h1&gt; &lt;h2&gt;       &lt;/h2&gt; &lt;TaskList onAdd={this.handleAdd} onDelete={this.handleDelete} tasks={this.state.tasks} /&gt; &lt;/&gt;; } }</code> </pre>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) </div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุทุจูู ูููู ูุนุฑุถ ูุงุฆูุฉ ูู ุงูููุงู ููุญุชูู ุนูู ูููุฐุฌ ูุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./AutoDisableButtonWithSpinner'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Form <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Table <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Table'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TaskList</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">newTaskAdding</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">newTaskAdding</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   ,     await this.props.onAdd( this.state.newTaskText ); this.setState( { newTaskText: '' } ); } finally { this.setState( { newTaskAdding: false } ); } }; this.handleDeleteF = idToDelete =&gt; async() =&gt; await this.props.onDelete( idToDelete ); this.handleNewTaskTextChange = ( { target: { value } } ) =&gt; this.setState( { newTaskText: value || '', } ); } render() { return &lt;Table bordered hover striped&gt; &lt;thead&gt;&lt;tr&gt; &lt;th&gt;#&lt;/th&gt;&lt;th&gt;Text&lt;/th&gt;&lt;th /&gt; &lt;/tr&gt;&lt;/thead&gt; &lt;tbody&gt; { this.props.tasks.map( task =&gt; &lt;tr key={task.id}&gt; &lt;td&gt;{task.id}&lt;/td&gt; &lt;td&gt;{task.text}&lt;/td&gt; &lt;td&gt;&lt;Button onClick={this.handleDeleteF( task.id )} type="button" variant="danger"&gt;&lt;/Button&gt;&lt;/td&gt; &lt;/tr&gt; ) } &lt;tr key="+1"&gt; &lt;td /&gt; &lt;td&gt;&lt;Form.Control disabled={this.state.newTaskAdding} onChange={this.handleNewTaskTextChange} placeholder="  " type="text" value={this.state.newTaskText || ''} /&gt;&lt;/td&gt; &lt;td&gt;&lt;Button onClick={this.handleAdd} type="button" variant="primary"&gt;&lt;/Button&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/Table&gt;; } }</span></span></code> </pre>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) </div></div><br>  ุจุงููุนู ูู ูููุฐุฌ ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ุ ููููู ุฑุคูุฉ ุงููููุงุช ุงูุฑุฆูุณูุฉ ูุชุฒุงููุฉ / ุชูุชุธุฑ.  ูููู ููุจููุงุช Async / ุงูุชุธุงุฑ ุชูููู ุญุฌู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ุชุนูู ูุน Promises ุจุดูู ููุญูุธ.  ุชุชูุญ ูู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ุชูุชุธุฑ ุงูุงูุชุธุงุฑ ุงูุชุธุงุฑ ุงุณุชุฌุงุจุฉ ูู ูุธููุฉ ุชุฑุฌุน ุงููุนุฏ ุ ููุง ูู ูุงูุช ูุธููุฉ ุนุงุฏูุฉ (ุจุฏูุงู ูู ุงูุชุธุงุฑ ูุชูุฌุฉ ูู ุฐูู ุงูุญูู ()).  ุจุทุจูุนุฉ ุงูุญุงู ุ ูุง ุชุชุญูู ุงููุธููุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุจุทุฑููุฉ ุณุญุฑูุฉ ุฅูู ูุธููุฉ ูุชุฒุงููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุณูุชู ููุงุทุนุฉ ุณูุณูุฉ ุงูุชูููุฐ ุนูุฏ ุงูุงูุชุธุงุฑ.  ูููู ุจุนุฏ ุฐูู ุ ูุตุจุญ ุงูุฑูุฒ ุฃูุซุฑ ุฅูุฌุงุฒูุง ูููููููุง ุ ููููู ุงุณุชุฎุฏุงูู ูู ุงูุญููุงุช ููู ุนูููุงุช ุงูุฅูุดุงุก / ุงูุชุฌุฑูุจ / ูู ุงูููุงูุฉ. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูุง <a href="" rel="nofollow">ูุณุชุฏุนู <code> TaskList</code></a> <code>this.props.onAdd</code> ูุนุงูุฌ <code>this.props.onAdd</code> ููุท ุ ููููู ูููู ุจุงุณุชุฎุฏุงู ุงููููุฉ ุงูููุชุงุญูุฉ " <code>await</code> .  ูู ูุฐู ุงูุญุงูุฉ ุ ุฅุฐุง ูุงูุช ุงููุนุงูุฌ ูู ูุธููุฉ ุนุงุฏูุฉ ูุง ุชูุฑุฌุน ุดูุฆูุง ุ ุฃู ุชูุฑุฌุน ุฃู ูููุฉ ุฃุฎุฑู ุบูุฑ <code>Promise</code> ุ <code>TaskList</code> ูููู <code>TaskList</code> ุจุจุณุงุทุฉ ุฃุณููุจ <code>handleAdd</code> ุจุงูุทุฑููุฉ ุงููุนุชุงุฏุฉ.  ูููู ุฅุฐุง ูุงูุช ุงููุนุงูุฌ ุจุฅุฑุฌุงุน <code>Promise</code> (ุจูุง ูู ุฐูู ุฅุฐุง ุชู ุฅุนูุงู ุงููุนุงูุฌ ูุฏุงูุฉ ุบูุฑ <code>TaskList</code> ) ุ <code>TaskList</code> ุญุชู ููุชูู ุงููุนุงูุฌ ูู ุงูุชูููุฐ ุ ูุนูุฏูุง ููุท ุณูู ูุนูุฏ ุชุนููู ููู <code>newTaskText</code> ู <code>newTaskText</code> . <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 1: ุฅุถุงูุฉ IndexDB ุฅูู React Component </h2><br>  ูุชุจุณูุท ุนูููุง ุ ุณูููู ุฃููุงู ุจูุชุงุจุฉ ูููู ุจุณูุท ูููู ุจุชูููุฐ ุทุฑู ุงููุนุฏ ูู ุฃุฌู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชุญ ูุงุนุฏุฉ ุจูุงูุงุช ูุน ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุชุงููุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงูุนูุงุตุฑ ุงูููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ุนูุงุตุฑ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช </li></ul><br>  ุงูุฃูู ูู ุงูุฃูุซุฑ "ุบูุฑ ุชุงููุฉ" - ูุง ูุตู ุฅูู 5 ูุนุงูุฌุงุช ุงูุฃุญุฏุงุซ.  ููุน ุฐูู ุ ูุง ุนูู ุงูุตูุงุฑูุฎ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">openDatabasePromise () - ุงูุชุญ ูุงุนุฏุฉ ุจูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openDatabasePromise</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> keyPath </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> resolve, reject </span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dbOpenRequest = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.indexedDB.open( DB_NAME, <span class="hljs-string"><span class="hljs-string">'1.0.0'</span></span> ); dbOpenRequest.onblocked = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { reject( <span class="hljs-string"><span class="hljs-string">'    ,    , '</span></span> + <span class="hljs-string"><span class="hljs-string">'      .'</span></span> ); }; dbOpenRequest.onerror = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( <span class="hljs-string"><span class="hljs-string">'Unable to open indexedDB '</span></span> + DB_NAME ); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( err ); reject( <span class="hljs-string"><span class="hljs-string">'   ,       .'</span></span> + <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> err.message ? </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' : '</span></span></span></span><span class="hljs-function"><span class="hljs-params"> + err.message : </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">) ); }; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dbOpenRequest</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onupgradeneeded</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> db = event.target.result; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { db.deleteObjectStore( OBJECT_STORE_NAME ); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> ( err ) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( err ); } db.createObjectStore( OBJECT_STORE_NAME, { keyPath } ); }; dbOpenRequest.onsuccess = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.info( <span class="hljs-string"><span class="hljs-string">'Successfully open indexedDB connection to '</span></span> + DB_NAME ); resolve( dbOpenRequest.result ); }; dbOpenRequest.onerror = reject; } ); }</code> </pre></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">getAllPromise / getPromise / putPromise - ูุฌูุน ูุฏุนู IndexDb ูู ุงููุนุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    ObjectStore,   IDBRequest //     Promise function wrap( methodName ) { return function() { const [ objectStore, ...etc ] = arguments; return new Promise( ( resolve, reject ) =&gt; { const request = objectStore[ methodName ]( ...etc ); request.onsuccess = () =&gt; resolve( request.result ); request.onerror = reject; } ); }; } const deletePromise = wrap( 'delete' ); const getAllPromise = wrap( 'getAll' ); const getPromise = wrap( 'get' ); const putPromise = wrap( 'put' ); }</span></span></code> </pre></div></div><br>  ูุถุนู ูุนูุง ูู ุตู ูุงุญุฏ ูููุฑุณุฅูุฏุงุน <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">IndexedDbRepository - ุงููุฌูุน ุญูู IDBDatabase</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DB_NAME = <span class="hljs-string"><span class="hljs-string">'objectStore'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> OBJECT_STORE_NAME = <span class="hljs-string"><span class="hljs-string">'objectStore'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexedDbRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>( keyPath ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.keyPath = keyPath; <span class="hljs-comment"><span class="hljs-comment">//     async //      this.openDatabasePromise = this._openDatabase(); } async _openDatabase( keyPath ) { try { this.dbConnection = await openDatabasePromise( keyPath ); } catch ( error ) { this.error = error; throw error; } } async _tx( txMode, callback ) { await this.openDatabasePromise; // await db connection const transaction = this.dbConnection.transaction( [ OBJECT_STORE_NAME ], txMode ); const objectStore = transaction.objectStore( OBJECT_STORE_NAME ); return await callback( objectStore ); } async findAll() { return this._tx( 'readonly', objectStore =&gt; getAllPromise( objectStore ) ); } async findById( key ) { return this._tx( 'readonly', objectStore =&gt; getPromise( objectStore, key ) ); } async deleteById( key ) { return this._tx( 'readwrite', objectStore =&gt; deletePromise( objectStore, key ) ); } async save( item ) { return this._tx( 'readwrite', objectStore =&gt; putPromise( objectStore, item ) ); } }</span></span></code> </pre>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) </div></div><br>  ููููู ุงูุขู ุงููุตูู ุฅูู IndexDB ูู ุงูููุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-comment"><span class="hljs-comment">// ,     await db.save( { id: 42, text: 'Task text' } ); const item = await db.findById( 42 ); const items = await db.findAll();</span></span></code> </pre><br>  ูู ุจุชูุตูู "ุงููุณุชูุฏุน" ุจูููููุง.  ููููุง ูููุงุนุฏ ุงูุฑุฏ ุ ูุฌุจ ุฃู ุชููู ุงูุฏุนูุฉ ุฅูู ุงูุฎุงุฏู ูู ุทุฑููุฉ componentDidMount (): <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> IndexedDbRepository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../common/IndexedDbRepository'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-comment"><span class="hljs-comment">//     this.repository.findAll().then( tasks =&gt; this.setState( { tasks } ) ); }</span></span></code> </pre><br>  ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ูููู ุชุนุฑูู ุงูุฏุงูุฉ <code>componentDidMount()</code> ุนูู ุฃููุง ุบูุฑ ูุชุฒุงููุฉ ุ ุซู ูููู ุงุณุชุฎุฏุงู ุจููุงุช ูุชุฒุงูู / ุงูุชุธุงุฑ ุจุฏูุงู ูู ุฐูู ().  ูููู ูุง ูุฒุงู <code>componentDidMount()</code> ููุณ ูุธููุฉ "ููุง" ุ ูููู ูุณูู React.  ูู ูุฏุฑู ููู ุณุชุชุตุฑู ููุชุจุฉ ุฑุฏ ุงููุนู 17.x ุงุณุชุฌุงุจุฉู ููุญุงููุฉ ุฅุฑุฌุงุน <code>Promise</code> ุจุฏูุงู ูู <code>undefined</code> ุ <br><br>  ุงูุขู ูู ุงูููุดุฆ ุ ุจุฏูุงู ูู ููุก ุตููู ูุงุฑุบ (ุฃู ุตููู ุจุจูุงูุงุช ุงูุงุฎุชุจุงุฑ) ุ ุณูููุฃูุง ุฎุงููุฉ.  ููู ุงูุชูุฏูู ุ ุณุชููู ุจูุนุงูุฌุฉ ูุฐู ุงููููุฉ ุงููุงุฑุบุฉ ูุถุฑูุฑุฉ ูุงูุชุธุงุฑ ูุนุงูุฌุฉ ุงูุจูุงูุงุช.  ูููู ูุฃููุฆู ุงูุฐูู ูุฑุบุจูู ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ูุถุน ูุฐุง ูู ุฃุนูุงู ูููุตูุฉ ุ ูููู ููุงุฐุง ุชูุชุฌ ููุงูุงุชุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> } <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> render() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.tasks === <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;&gt;&lt;Spinner animation="border" aria-hidden="true" as="span" role="status" /&gt;&lt;span&gt;  ...&lt;/span&gt;&lt;/&gt;; /* ... */ }</code> </pre><br>  ูุจูู ุชูููุฐ <code>handleDelete</code> / <code>handleDelete</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( newTaskText ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.save( { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.findAll() } ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDelete = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( idToDelete ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.deleteById( idToDelete ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.findAll() } ); }; }</code> </pre><br>  ูู ููุง ุงููุนุงูุฌูู ุ ููุชูู ุฃููุงู ุฅูู ุงููุณุชูุฏุน ูุฅุถุงูุฉ ุนูุตุฑ ุฃู ุฅุฒุงูุชู ุ ุซู ูููู ุจูุณุญ ุญุงูุฉ ุงููููู ุงูุญุงูู ููุทูุจ ูุฑุฉ ุฃุฎุฑู ูุงุฆูุฉ ุฌุฏูุฏุฉ ูู ุงููุณุชูุฏุน.  ูุจุฏู ุฃู ุงูููุงููุงุช ุฅูู setState () ุณุชุฐูุจ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู.  ููู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ุชูุชุธุฑ ุงูุงูุชุธุงุฑ ูู ุงูุฃุณุทุฑ ุงูุฃุฎูุฑุฉ ูู ุงููุนุงูุฌุงุช ุณุชุชุณุจุจ ูู ุญุฏูุซ ููุงููุฉ setState () ุงูุซุงููุฉ ููุท ุจุนุฏ ุญู Promise () ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุทุฑููุฉ findAll (). <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 2. ุงูุงุณุชูุงุน ุฅูู ุงูุชุบููุฑุงุช </h2><br>  ุนูุจ ูุจูุฑ ูู ุงูููุฏ ุฃุนูุงู ูู ุฃูู ุ ุฃููุงู ุ ูุชู ุชูุตูู ุงููุณุชูุฏุน ูู ูู ูููู.  ุซุงููุงู ุ ุฅุฐุง ุบูุฑ ุฃุญุฏ ุงูููููุงุช ูุญุชููุงุช ุงููุณุชูุฏุน ุ ููู ูุนุฑู ุงููููู ุงูุขุฎุฑ ุนููุง ุฅูุง ุจุนุฏ ุฅุนุงุฏุฉ ูุฑุงุกุฉ ุงูุญุงูุฉ ููุชูุฌุฉ ูุฃู ุฅุฌุฑุงุกุงุช ูููุณุชุฎุฏู.  ูุฐุง ุบูุฑ ูุฑูุญ. <br><br>  ูููุงูุญุฉ ูุฐุง ุ ุณููุฏู ูููู RepositoryListener ุงูุฌุฏูุฏ ูุณูุฏุนู ููุนู ุดูุฆูู.  ุณูููู ูุฐุง ุงููููู ุ ุฃููุงู ุ ูุงุฏุฑูุง ุนูู ุงูุงุดุชุฑุงู ูู ุงูุชุบููุฑุงุช ูู ุงููุณุชูุฏุน.  ุซุงููุงู ุ ุณูู ูููู RepositoryListener ุจุฅุจูุงุบ ุงููููู ุงูุฐู ูุงู ุจุฅูุดุงุฆู ุจูุฐู ุงูุชุบููุฑุงุช. <br><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุฅุถุงูุฉ ุงููุฏุฑุฉ ุนูู ุชุณุฌูู ูุนุงูุฌุงุช ูู IndexedDbRepository: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexedDbRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>( keyPath ) { <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamp = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> addListener( listener ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.add( listener ); } onChange() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamp++; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.forEach( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">listener</span></span></span><span class="hljs-function"> =&gt;</span></span> listener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamp ) ); } removeListener( listener ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.delete( listener ); } }</code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br>  ุณูููู ุจุชูุฑูุฑ ุฎุชู ุฅูู ุงููุนุงูุฌุงุช ุ ูุงูุฐู ุณูุชุบูุฑ ูุน ูู ููุงููุฉ ุฅูู onChange ().  ููููู ุจุชุนุฏูู ุทุฑููุฉ _tx ุจุญูุซ <code>onChange()</code> ุงุณุชุฏุนุงุก <code>onChange()</code> ููู ููุงููุฉ ูู ูุนุงููุฉ ุฐุงุช ูุถุน <code>readwrite</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> _tx( txMode, callback ) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.openDatabasePromise; <span class="hljs-comment"><span class="hljs-comment">// await db connection try { const transaction = this.dbConnection.transaction( [ OBJECT_STORE_NAME ], txMode ); const objectStore = transaction.objectStore( OBJECT_STORE_NAME ); return await callback( objectStore ); } finally { if ( txMode === 'readwrite' ) this.onChange(); // notify listeners } }</span></span></code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br>  ุฅุฐุง ููุง ูุง ูุฒุงู ูุณุชุฎุฏู <code>then()</code> / <code>catch()</code> ูู <code>then()</code> ููุนูู ูุน Promise ุ ูุณูุถุทุฑ ุฅูุง ุฅูู ุชูุฑุงุฑ ุงูุฏุนูุฉ ุฅูู <code>onChange()</code> ุ ุฃู ุงุณุชุฎุฏุงู polyfills ุงูุฎุงุตุฉ ูู Promise () ุงูุชู ุชุฏุนู <code>final()</code> .  ูุญุณู ุงูุญุธ ุ ูุชูุญ ูู ุงููุฒุงููุฉ / ุงูุงูุชุธุงุฑ ุงูููุงู ุจุฐูู ุจุจุณุงุทุฉ ูุฏูู ุฑูุฒ ุบูุฑ ุถุฑูุฑู. <br><br>  ุงููููู RepositoryListener ููุณู ูุฑุจุท ูุณุชูุน ุงูุญุฏุซ ูู ุฃุณุงููุจ componentDidMount ู componentWillUnmount: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">RepositoryListener ููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> IndexedDbRepository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./IndexedDbRepository'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryListener</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repositoryStamp</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onChange( repositoryStamp ); } componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentDidUpdate() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentWillUnmount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.unsubscribe(); } subscribe() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { repository } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( repository <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> IndexedDbRepository &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository !== repository ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository.removeListener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener ); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository = repository; repository.addListener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener ); } } unsubscribe( ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository.removeListener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.children || <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } }</code> </pre>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) </div></div><br>  ุงูุขู ุ ุณูููู ุจุชุถููู ูุนุงูุฌุฉ ุชุบููุฑุงุช ุงููุฎุฒูู ูู <code>handleAdd</code> <code>handleDelete</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุจุฏุฃ DRY</a> ุ ุณูููู ุจุฅุฒุงูุฉ ุงูููุฏ ุงูููุงุจู ูู <code>handleDelete</code> / <code>handleDelete</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( newTaskText ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.save( { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDelete = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( idToDelete ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.deleteById( idToDelete ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepositoryChanged = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.findAll() } ); }; } componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepositoryChanged(); <span class="hljs-comment"><span class="hljs-comment">// initial load }</span></span></code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br>  ููุถูู ุฏุนูุฉ ููุชุนุงูู ูุน RepositoryChanged ูู RepositoryListener ุงููุชุตู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> render() { <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleRepoChanged}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.repository}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TaskList</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onAdd</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleAdd}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onDelete</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleDelete}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">tasks</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.tasks}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">; }</span></span></code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 3. ุงุฎุฑุงุฌ ุชุญููู ุงูุจูุงูุงุช ูุชุญุฏูุซูุง ูู ูููู ูููุตู </h2><br>  ููุฏ ูุชุจูุง ูููููุง ููููู ุชููู ุงูุจูุงูุงุช ูู ุงููุณุชูุฏุน ุ ููููู ุชุบููุฑ ุงูุจูุงูุงุช ูู ุงููุณุชูุฏุน.  ูููู ุฅุฐุง ููุช ุชุชุฎูู ูุดุฑูุนูุง ูุจูุฑูุง ูุญุชูู ุนูู ุฃูุซุฑ ูู 100 ูููููุง ุ ูุณูุธูุฑ ุฃู <b>ูู</b> ูููู ูุนุฑุถ ุจูุงูุงุช ูู ุงููุณุชูุฏุน ุณูุถุทุฑ ุฅูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฃูุฏ ูู ุฃู ุงููุณุชูุฏุน ูุชุตู ุจุดูู ุตุญูุญ ูู ููุทุฉ ูุงุญุฏุฉ </li><li style=";text-align:right;direction:rtl">  ุชูููุฑ ุชุญููู ุงูุจูุงูุงุช ุงูุฃููู ูู ุทุฑููุฉ <code>componentDidMount()</code> </li><li style=";text-align:right;direction:rtl">  ูู ุจุชูุตูู ูููู <code>RepositoryListener</code> ุ ูุงูุฐู ูููุฑ ุงุณุชุฏุนุงุก ูุนุงูุฌ ูุฅุนุงุฏุฉ ุชุญููู ุงูุชุบููุฑุงุช </li></ul><br>  ูู ููุงู ุงููุซูุฑ ูู ุงูุฅุฌุฑุงุกุงุช ุงูููุฑุฑุฉุ  ูุง ูุจุฏู ูุฐูู.  ูุฅุฐุง ูุณู ุดูุก ูุงุ  ุชุถูุน ูุน ูุณุฎุฉ ูุตูุ <br><br>  ุณูููู ูู ุงูุฑุงุฆุน ุฃู ูุชุฃูุฏ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูู ุฃููุง ููุชุจ ุจูุฌุฑุฏ ูุงุนุฏุฉ ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูููุงู ูู ุงููุณุชูุฏุน ุ ูุฃู ุดูุฆูุง ุณุญุฑููุง ูููุฐ ูุฐู ุงูุฃุณุงููุจ ุ ูุนุทููุง ุงูุจูุงูุงุช ุ ูุนุงูุฌ ุงูุชุบููุฑุงุช ูู ุงููุณุชูุฏุน ุ ููู ุฃุฌู ุงููููุฉ ูููู ุฃู ูุฑุจุท ูุฐุง ุฃูุถูุง ูุณุชูุฏุน. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doFindAllTasks = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> repo </span></span></span><span class="hljs-function">) =&gt;</span></span> repo.findAll(); <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> &lt;DataProvider doCalc={ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doFindAllTasks }&gt; {(data) =&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">...   -,   data...</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/DataProvider&gt;</span></span></code> </pre><br>  ุงููุญุธุฉ ุบูุฑ ุงูุชูููููุฉ ุงููุญูุฏุฉ ูู ุชูููุฐ ูุฐุง ุงููููู ูู ุฃู doFindAllTasks () ูู ูุนุฏ.  ูุชุณููู ุนูููุง ุ ุณููุดุฆ ูููููุง ูููุตููุง ููุชุธุฑ ุชูููุฐ ุงููุนุฏ ููุณุชุฏุนู ุณููููุง ุจูููุฉ ูุญุณูุจุฉ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุฒ PromiseComponent</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PromiseComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentDidUpdate( ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentWillUnmount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.unsubscribe(); } subscribe() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { cleanOnPromiseChange, promise } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( promise <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise !== promise ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( cleanOnPromiseChange ) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise = promise; promise.then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise === promise ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, value } ); } } ) .catch( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise === promise ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { error, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); } } ); } } unsubscribe( ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { children, fallback } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { error, value } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( error !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> error; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( value === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> || value === <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fallback || <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> children( value ); } }</code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br></div></div><br>  ูุดุจู ูุฐุง ุงููููู ูู ุงูููุทู ูุงููููู ุงูุฏุงุฎูู ุงูุฎุงุต ุจู RepositoryListener.  ูุฃู ููุง ููููุง ูุงูุขุฎุฑ ูุฌุจ ุฃู "ูููุน" ุ "ูุณุชูุน" ุฅูู ุงูุฃุญุฏุงุซ ููุนุงูุฌูุง ุจุทุฑููุฉ ูุง.  ูุชุฐูุฑ ุฃูุถูุง ุฃู ุงูุฃุญุฏุงุซ ุงูุชู ุชุญุชุงุฌ ุฅูู ุงูุงุณุชูุงุน ุฅูููุง ูุฏ ุชุชุบูุฑ. <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูุจุฏู ุงููููู ุงูุณุญุฑู ููุบุงูุฉ DataProvider ุจุณูุทูุง ุฌุฏูุง ุญุชู ุงูุขู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> repository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./RepositoryHolder'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataProvider</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepoChanged = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forceUpdate(); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleRepoChanged}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{repository}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromiseComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">promise</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.props.doCalc(</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag"> )}&gt;</span></span></span><span class="xml"> {data =&gt; this.props.children( data )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromiseComponent</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br>  ูู ุงููุงูุน ุ ุฃุฎุฐูุง ุงููุณุชูุฏุน (ูุงููููุฑุฏ ุงููููุตู RepositoryHolder ุ ุงูุฐู ูู ุงูุขู ููุฏ ุงูุงุณุชูุฑุงุฏ) ุ ูุฏุนุง doCalc ุ ููุฐุง ุณูู ูุณูุญ ููุง ุจููู ุจูุงูุงุช ุงููููุฉ ุฅูู this.props.children ุ ูุจุงูุชุงูู ุ ุฑุณู ูุงุฆูุฉ ูู ุงูููุงู.  ุชุจุฏู Singlenton ุฃูุถูุง ุจุณูุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> repository;</code> </pre><br>  ุงุณุชุจุฏู ุงูุขู ุงุณุชุฏุนุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุงููููู ุงูุฑุฆูุณู ุจุงุณุชุฏุนุงุก DataProvider: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> repository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./RepositoryHolder'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doFindAllTasks = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repository</span></span></span><span class="hljs-function"> =&gt;</span></span> repository.findAll(); <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;DataProvider doCalc={this.doFindAllTasks} fallback={&lt;&gt;&lt;Spinner animation="border" aria-hidden="true" as="span" role="status" /&gt;&lt;span&gt;  ...&lt;/span&gt;&lt;/&gt;}&gt; { tasks =&gt; &lt;TaskList onAdd={this.handleAdd} onDelete={this.handleDelete} tasks={tasks} /&gt; } &lt;/DataProvider&gt;; } }</code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br>  ูุฐุง ูููู ุฃู ูุชููู.  ุงุชุถุญ ุจุดูู ุฌูุฏ: ูุญู ูุตู ูุงุนุฏุฉ ุชููู ุงูุจูุงูุงุช ุ ููููู ูููู ูููุตู ุจูุฑุงูุจุฉ ุงูุงุณุชูุงู ุงููุนูู ููุฐู ุงูุจูุงูุงุช ุ ููุฐูู ุงูุชุญุฏูุซ.  ูุงู ููุงู ุญุฑููุง ุจุถุนุฉ ุฃุดูุงุก ุตุบูุฑุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ุทูุจ ุจูุงูุงุช ุ ูู ููุงู ูุง ูู ุงูููุฏ (ูููู ููุณ ูู ุทุฑููุฉ ุงูุชูุฏูู <code>render()</code> ุชุญุชุงุฌ ุฅูู ูุตู ูุธููุฉ ุงููุตูู ุฅูู ุงููุณุชูุฏุน ุ ุซู ุชูุฑูุฑ ูุฐู ุงููุธููุฉ ุฅูู DataProvider </li><li style=";text-align:right;direction:rtl">  ุฅู ุงูุฏุนูุฉ ุฅูู DataProvider ุฑุงุฆุนุฉ ูุฑุงุฆุนุฉ ุจุฑูุญ React ุ ููููุง ูุจูุญุฉ ููุบุงูุฉ ูู ูุฌูุฉ ูุธุฑ JSX.  ุฅุฐุง ูุงู ูุฏูู ุงูุนุฏูุฏ ูู ุงูููููุงุช ุ ูุฅู ูุณุชูููู ุฃู ุซูุงุซุฉ ูุณุชููุงุช ูู ุงูุชุนุดูุด ุจูู DataProviders ุงููุฎุชููุฉ ุณูู ุชุฑุจูู ูุซูุฑูุง. </li><li style=";text-align:right;direction:rtl">  ูู ุงููุญุฒู ุฃู ูุชู ุงุณุชูุงู ุงูุจูุงูุงุช ูู ูููู ูุงุญุฏ (DataProvider) ุ ููุชู ุชุบููุฑูุง ูู ูููู ุขุฎุฑ (ุงููููู ุงูุฑุฆูุณู).  ุฃูุฏ ุฃู ุฃุตููุง ุจููุณ ุงูุขููุฉ. </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 4. ุงูุงุชุตุงู () </h2><br>  ุฏุฑุงูุฉ ุฑุฏ ุงููุนู ูู ูุจู ุนููุงู ุงูุนููุงู ุฎููุช ุจุงููุนู.  ุณุฃูุฏู ุงูุชูููุญ ุงูุชุงูู ุฅูู ุงูุจุงูู: ุณูููู ูู ุงูุฌูุฏ ุฃู ูููู ูููู ุฎุฏูุฉ DataProvider ุ ุจุฏูุงู ูู ุงูุงุชุตุงู ุจุงูุฃุทูุงู () ุจุงููุนููุงุช ุ ุจููุก ุฎุตุงุฆุต ุงููููู ุงูุฎุงุต ุจูุง ููููุง ููููุงุนุฏ.  ูุฅุฐุง ุชุบูุฑ ุดูุก ูุง ูู ุงููุณุชูุฏุน ุ ูุณูุคุฏู ุฐูู ุจุจุณุงุทุฉ ุฅูู ุชุบููุฑ ุงูุฎุตุงุฆุต ุจุงุณุชุฎุฏุงู ุขููุฉ React ุงูููุงุณูุฉ. <br><br>  ููุฐุง ุณูู ูุณุชุฎุฏู ูููู ุงูุทูุจ ุงูุนุงูู.  ูู ุงููุงูุน ุ ููุณ ุดูุฆูุง ูุนูุฏูุง ุ ุฅููุง ูุฌุฑุฏ ูุธููุฉ ุชุฃุฎุฐ ูุฆุฉ ูููู ููุนููุฉ ูุชุนุทู ูููููุง ุขุฎุฑ ุฃูุซุฑ ุชุนููุฏูุง.  ูุฐูู ุ ูุฅู ูุธููุชูุง ุงูุชู ููุชุจูุง ุณุชููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฃุฎุฐ ููุณูุทุฉ ูุฆุฉ ุงููููู ุญูุซ ูุชูุฑูุฑ ุงููุนููุงุช </li><li style=";text-align:right;direction:rtl">  ุงูุจู ูุฌููุนุฉ ูู ุงูููุงุนุฏ ุ ูููููุฉ ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ูู ุงููุณุชูุฏุน ุ ููุง ูู ุงูุฎุตุงุฆุต ููุถุนูุง </li><li style=";text-align:right;direction:rtl">  ูู ุงุณุชุฎุฏุงูู ุ ุณูููู ูุดุงุจููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุธููุฉ connect () ูู ุฑุฏ ูุนู ุฑุฏ ุงููุนู</a> . </li></ul><br>  ุณุชุจุฏู ุงูุฏุนูุฉ ุฅูู ูุฐู ุงููุธููุฉ ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapRepoToProps = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repository</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: repository.findAll(), } ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapRepoToActions = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repository</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">doAdd</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> newTaskText </span></span></span><span class="hljs-function">) =&gt;</span></span> repository.save( { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ), <span class="hljs-attr"><span class="hljs-attr">doDelete</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> idToDelete </span></span></span><span class="hljs-function">) =&gt;</span></span> repository.deleteById( idToDelete ), } ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Step4Connected = connect( mapRepoToProps, mapRepoToActions )( Step4 );</code> </pre><br>  <code>Step4</code> ุงูุฃุณุทุฑ ุงูุฃููู ุงูุชุนููู ุจูู ุงุณู ุฎุงุตูุฉ ุงููููู <code>Step4</code> ูุงูููู ุงูุชู ุณูุชู ุชุญููููุง ูู ุงููุณุชูุฏุน.  ุงูุชุงูู ูุฃุชู ุชุนููู ุงูุฅุฌุฑุงุกุงุช: ูุงุฐุง ุณูุญุฏุซ ุฅุฐุง <code>Step4</code> ุจุงุณุชุฏุนุงุก <code>this.props.doAdd(...)</code> ุฃู <code>this.props.doDelete(...)</code> ูู ุฏุงุฎู ูููู <code>Step4</code> .  ูุงูุฎุท ุงูุฃุฎูุฑ ูุฌูุน ูู ุดูุก ูุนูุง ููุฏุนู ูุธููุฉ ุงูุงุชุตุงู.  ูุงููุชูุฌุฉ ูู ูููู ุฌุฏูุฏ (ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ูุฐู ุงูุชูููุฉ ุชุณูู ูููู ุงููุธุงู ุงูุนุงูู).  ููู ูููู ุจุนุฏ ุฐูู ุจุชุตุฏูุฑ ูููู Step4 ุงูุฃุตูู ูู ุงูููู ุ ูููู ุงููุฌูุน ูู ุญููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step4</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Step4Connected = connect( <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> )( Step4 ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> Step4Connected;</code> </pre><br>  ููููู ุงูุนูู ูุน TaskList ุงูุขู ูุดุจู ุงููุฌูุน ุงูุจุณูุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step4</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.tasks === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.tasks === <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? &lt;&gt;&lt;Spinner animation="border" aria-hidden="true" as="span" role="status" /&gt;&lt;span&gt;  ...&lt;/span&gt;&lt;/&gt; : &lt;TaskList onAdd={this.props.doAdd} onDelete={this.props.doDelete} tasks={this.props.tasks} /&gt;; } }</code> </pre><br>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) <br><br>  ููุฐุง ูู ุดูุก.  ูุง ููุฌุฏ ูุตูููู ุ ููุง ูุนุงูุฌุงุช ุฅุถุงููุฉ - ูุชู ูุถุน ูู ุดูุก ุจูุงุณุทุฉ ูุธููุฉ connect () ูู ุงูุฏุนุงุฆู ุงูุฎุงุตุฉ ุจุงููููู. <br><br>  ูุจูู ุฃู ูุฑู ููู ูุฌุจ ุฃู ุชุจุฏู ูุธููุฉ connect (). <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุฒ ุงูุงุชุตุงู ()</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> repository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./RepositoryHolder'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Connected</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepoChanged = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forceUpdate(); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { childClass, childProps, mapRepoToProps, mapRepoToActions } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> promises = mapRepoToProps( repository, childProps ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actions = mapRepoToActions( repository, childProps ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleRepoChanged}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{repository}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromisesComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">promises</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{promises}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { values =&gt; React.createElement( childClass, { ...childProps, ...values, ...actions, } )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromisesComponent</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> mapRepoToProps, mapRepoToActions </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">childClass</span></span></span><span class="hljs-function"> =&gt;</span></span> props =&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Connected</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">childClass</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{childClass}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">childProps</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mapRepoToActions</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mapRepoToActions}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mapRepoToProps</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mapRepoToProps}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; }</span></span></code> </pre>  ( <a href="" rel="nofollow">ููุฏ ุฌูุซุจ ุงููุตุฏุฑ</a> ) </div></div><br>  ูุจุฏู ุฃู ุงูููุฏ ููุณ ูุนูุฏูุง ุฌุฏูุง ... ุนูู ุงูุฑุบู ูู ุฃูู ุฅุฐุง ุจุฏุฃุช ุงูุบูุต ุ ูุณุชุธูุฑ ุฃุณุฆูุฉ.  ุชุญุชุงุฌ ุฅูู ุงููุฑุงุกุฉ ูู ุงูููุงูุฉ.  ููุงู ูุชู ุชุนุฑูู ุงูุฏุงูุฉ <code>connect()</code> .  ูุณุชุบุฑู ูุนููุชูู ุ ุซู ุชุฑุฌุน ุงูุฏุงูุฉ ุงูุชู ุชุฑุฌุน ... ูุฑุฉ ุฃุฎุฑู ูุธููุฉุ  ููุณ ุญูุง  ูุง ุชุคุฏู ุงูุฅูุดุงุกุงุช ุงูุฃุฎูุฑุฉ ูู <code>props =&gt; &lt;Connected...</code> ุฅุฑุฌุงุน ูุธููุฉ ูุญุณุจ ุ ุจู ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูููู React ูุธููู</a> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุจุงูุชุงูู ุ ุนูุฏูุง ูุฏูุฌ ConnectedStep4 ูู ุดุฌุฑุฉ ุงูุชุฑุงุถูุฉ ุ ูุณูุชุถูู: </font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุตู -&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ูุธููู ูุฌููู -&gt; ุงูุงุชุตุงู -&gt; RepositoryListener -&gt; PromisesComponent -&gt; Step4</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุตู ุฅูู 4 ูุตูู ูุณูุทุฉ ุ ูููู ูุคุฏู ูู ูููุง ูุธููุชู. ูุฃุฎุฐ ูููู ุบูุฑ ูุณูู ุงููุนููุงุช ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู ุงููุธููุฉ </font></font><code>connect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฆุฉ ุงููููู ุงููุชุฏุงุฎู ุ ูุงูุฎุตุงุฆุต ุงูุชู ูุชู ููููุง ุฅูู ุงููููู ููุณู ุนูุฏ ุงุณุชุฏุนุงุก (props) ูุชูุฑูุฑูุง ุจุงููุนู ุฅูู ุงููููู </font></font><code>Connect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุงููููู </font></font><code>Connect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุคูู ุนู ุงูุญุตูู ุนูู ูุฌููุนุฉ ูู ุงููุนููุงุช ุงูุชู ุชู ุชูุฑูุฑูุง </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ูุงุฆู ุงููุงููุณ ูุน ููุงุชูุญ ุงูุตููู ูููู ุงููุนุฏ). </font></font><code>PromisesComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฑ ุญุณุงุจ ุงูููู ุ ููุนูุฏูุง ุฅูู ูููู Connect ุ ูุงูุฐู ุ ุฅูู ุฌุงูุจ ุงูุฎุตุงุฆุต ุงูุฃุตููุฉ ุงููููููุฉ (ุงูุฏุนุงุฆู) ุ ูุงูุฎุตุงุฆุต ุงููุญุณูุจุฉ (ุงูููู) ุ ูุฎุตุงุฆุต ุงูุฅุฌุฑุงุกุงุช (ุงูุฅุฌุฑุงุกุงุช) ุ ูููููุง ุฅูู ุงููููู </font></font><code>Step4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ุนุจุฑ ููุงููุฉ </font></font><code>React.createElement(...)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). ุญุณูุง ุ ุงููููู</font></font><code>RepositoryListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุจุชุญุฏูุซ ุงููููู ุ ููุง ูุคุฏู ุฅูู ุฅุนุงุฏุฉ ุญุณุงุจ promis'y ุฅุฐุง ุญุฏุซ ุดูุก ูุง ูู ุงููุณุชูุฏุน. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุฉ ูุฐูู ุ ุฅุฐุง ุฃุฑุงุฏ ุฃู ูู ุงูููููุงุช ุงุณุชุฎุฏุงู ุงููุณุชูุฏุน ูู IndexDb ุ ูุณูููู ุฐูู ูุงููุงู ูู ููุงุชุตุงู ุจูุธููุฉ ูุงุญุฏุฉ </font></font><code>connect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญุฏูุฏ ุงูุชุนููู ุจูู ุงูุฎุตุงุฆุต ููุธุงุฆู ุงูุญุตูู ุนูู ุงูุฎุตุงุฆุต ูู ุงููุณุชูุฏุน ูุงุณุชุฎุฏุงููุง ุฏูู ุฃู ุตุฏุงุน ุฅุถุงูู.</font></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุทูุฉ 5. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ vlsergey / react-indexdb-repo</font></font></a> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฎูุฑูุง ุ ูุฑุชุจ ูู ุฐูู ูู ุดูู ููุชุจุฉ ุจุญูุซ ูููู ูููุทูุฑูู ุงูุขุฎุฑูู ุงุณุชุฎุฏุงููุง ูู ูุดุงุฑูุนูู. </font><font style="vertical-align: inherit;">ูุงูุช ูุชูุฌุฉ ูุฐู ุงูุฎุทูุฉ:</font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Library </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ vlsergey / react-ูุนุฏ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุชูููุฐ PromiseComponent ู PromisesComponent ูุน ุฏุนู ูุชุฏููู ุงููุชุงุฆุฌ (ุจุญูุซ ุชููู ูุงุฌูุฉ ุงููุณุชุฎุฏู "ุชุดูุฌุงุช" ุฃูู ุนูุฏูุง ูุง ุชููู ุงูุชุบููุฑุงุช ูุซูุฑุฉ ููุงูุชูุงู ุจุงููุณุจุฉ ููุง)</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุจุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ vlsergey / ูุชุชูุงุนู-indexdb-ุงูุฑูุจู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - IndexedDbRepository ุงูุชูููุฐุ ูุธููุฉ ุงููุฑุงูู ุทุจูุงุช ุฑุจุท () ูุจุนุถ</font></font></li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุซุงู ุนูู ุงุณุชุฎุฏุงู ูุฐู ุงูููุชุจุฉ ูุฅูุดุงุก ูุงุฆูุฉ ููุงู</font></font></a> </li></ul><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุฏูุง ูู ุงูุงุณุชูุชุงุฌ: ูุง ุชุจูู ูู ุงูุจุญุฑ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏ ุฃุนูุงู ุนููู ุจุงููุนู ุจูุง ูููู ูุงุณุชุฎุฏุงูู ูู ุงูุญููู ุงูุตูุงุนูุฉ. </font><font style="vertical-align: inherit;">ูููู ูุง ูุฒุงู ุ ูุง ุชูุณู ุงููููุฏ:</font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุคุฏู ุชุบููุฑ ุงูุฎุตุงุฆุต ุฏุงุฆููุง ุฅูู ูุนูุฏ ุฌุฏูุฏุฉ. </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ููุง ุฅูู ุงุณุชุฎุฏุงู ูุธููุฉ ุงูุญูุธ ุ ูููู ุถุน ูู ุงูุงุนุชุจุงุฑ ุนูุงูุฉ ุชุบููุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ูุฐุง ูู ุงูููุงู ุงูุฐู ูุฃุชู ููู ุงูุทุงุจุน ูู IndexedDbRepository ูู ูุชูุงูู ูุฏู (ุฑุจูุง ุจุฏุช ูุฐู ุงููุทุนุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฒุงุฆุฏุฉ ุนู ุงูุญุงุฌุฉ ูุดุฎุต).</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุจุท ุงููุณุชูุฏุน ูู ุฎูุงู ุงูุงุณุชูุฑุงุฏ ุ ุญุชู ูู ูุงู ูู ููุงู ูุงุญุฏ ุ ุฎุทุฃ. </font><font style="vertical-align: inherit;">ูู ุงูุถุฑูุฑู ุงูุชุทูุน ูุญู ุงุณุชุฎุฏุงู ุงูุณูุงูุงุช.</font></font></li><li style=";text-align:right;direction:rtl">     ,     IndexedDB      . </li><li style=";text-align:right;direction:rtl">            :     .     .   IndexDB      ยซยป   ,    โ       . </li><li style=";text-align:right;direction:rtl">  ,  IndexDB    Redux Storage.      IndexDB    ,            . </li></ul><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Online-</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar472246/">https://habr.com/ru/post/ar472246/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar472230/index.html">ุฑูุงุฆู ู ML - ุงูุญุฏูุซ ุนู ุงูููุชุฌุงุช ุงูุฌุฏูุฏุฉ</a></li>
<li><a href="../ar472232/index.html">ูู "ููุณุน ุงูุฃููุงู ูู ZX-Spectrum" ุฅูู ZX-Poly</a></li>
<li><a href="../ar472234/index.html">Cryptocurrency: ูู ูุง ูุฒุงู ุงููุณุชูู ุ ุฃู ุดุฑููุ</a></li>
<li><a href="../ar472240/index.html">ุนู ุงูุชูุงุนุจ. ูุง ูู ุ ููุงุฐุง ูููู ููุนู ุฐููุ ูุธุฑุฉ ุงููุทูุฑ</a></li>
<li><a href="../ar472242/index.html">ููุฏ ูููุง ุจุชุณุฑูุน ุจุฑูุงูุฌ ุฌุฏููุฉ Tokio ุนุดุฑ ูุฑุงุช</a></li>
<li><a href="../ar472248/index.html">ููู ุฏูุฌูุง ุจุฑูุฌุฉ IT-Planet final</a></li>
<li><a href="../ar472252/index.html">ุงูุฃุญุฏุงุซ ุงูุฑูููุฉ ูู ููุณูู ูู 21 ุฅูู 28 ุฃูุชูุจุฑ</a></li>
<li><a href="../ar472254/index.html">ุงูุฃุญุฏุงุซ ุงูุฑูููุฉ ูู ุณุงู ุจุทุฑุณุจุฑุฌ ูู 21 ุฅูู 28 ุฃูุชูุจุฑ</a></li>
<li><a href="../ar472258/index.html">ููููุฉ "ุชุนูู ุงูุชุนูู" - ุชุญุณูู ุงูุฐูู</a></li>
<li><a href="../ar472262/index.html">ููุฎุต ุงูููุงุฏ ุงููุซูุฑุฉ ููุงูุชูุงู ููุทููุฑ ุงูุจุฑุงูุฌ ุงููุญููู ุฑูู 318 (ูู ุงููุชุฑุฉ ูู 14 ุฅูู 20 ุฃูุชูุจุฑ)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>