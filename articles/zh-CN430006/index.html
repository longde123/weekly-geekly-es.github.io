<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤽🏾 🤷🏽 ⛓️ 以Talking Hat为例的从研究到实施的数据科学项目 🧘🏼 🙏🏽 🤢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="一个月前，伦塔（Lenta）发起了一场竞赛 ，其中来自哈利·波特（Harry Potter）的同一个Talking Hat识别出可以访问四个学院之一的社交网络的参与者。 比赛进行得很顺利，听起来各不相同的名称由不同的系所决定，并且相似的英语和俄语名称和姓氏也以类似的方式分配。 我不知道分布是否仅取决...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>以Talking Hat为例的从研究到实施的数据科学项目</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/430006/"><p><img src="https://habrastorage.org/webt/4h/il/lk/4hillkjrgatenqqix3nypmyn8vm.png"></p><br><p> 一个月前，伦塔（Lenta）发起了一场<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">竞赛</a> ，其中来自哈利·波特（Harry Potter）的同一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Talking Hat</a>识别出可以访问四个学院之一的社交网络的参与者。 比赛进行得很顺利，听起来各不相同的名称由不同的系所决定，并且相似的英语和俄语名称和姓氏也以类似的方式分配。 我不知道分布是否仅取决于姓名和姓氏，是否以某种方式考虑了朋友的数量或其他因素，但是这场竞赛提出了本文的想法：尝试从头开始训练分类器，这将使用户可以分配到不同的系。 </p><a name="habracut"></a><br><p> 在本文中，我们将创建一个简单的ML模型，该模型将根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CRISP</a>方法进行的小型研究过程，根据人员的姓名和姓氏将其分配给Harry Potter的部门。 即我们： </p><br><ul><li> 我们提出问题； </li><li> 我们研究可能的解决方案，并制定数据要求（解决方法和数据）； </li><li> 我们将收集必要的数据（解决方法和数据）； </li><li> 我们将研究收集的数据集（探索性研究）； </li><li> 从原始数据中提取特征（特征工程）； </li><li> 让我们教一个机器学习模型（模型评估）； </li><li> 比较获得的结果，评估解决方案的质量，并在必要时重复第2-6段； </li><li> 我们将解决方案打包到可以使用的服务中（生产）。 </li></ul><br><p><img src="https://habrastorage.org/webt/6l/pf/oa/6lpfoa17u8pxjkf7wke7pm19-h0.png"></p><br><p> 这项任务看似微不足道，因此我们将对整个过程（少于2小时）和本文（因此其阅读时间少于15分钟）施加额外的限制。 </p><br><p> 如果您已经沉迷于美丽而美妙的数据科学世界，而您又看不到Kagglite，或者（上帝禁止）喜欢在与同事会面时测量Hadup的长度，那么这篇文章对您来说似乎很简单且无趣。 而且：最终模型的质量不是本文的主要价值。 我们已警告您。 走吧 </p><br><p> 好奇的读者也可以使用包含本文中使用的代码的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github存储库</a> 。 如有错误，请打开PR。 </p><br><h2 id="formuliruem-zadachu"> 我们制定问题 </h2><br><p> 可以解决无限长的时间里没有明确的决策标准的问题，因此我们将立即决定要得到一个解决方案，该解决方案使我们能够根据输入的行来获得答案“格兰芬多”，“拉文克劳”，“赫奇帕奇”或“斯莱特林”。 </p><br><p> 实际上，我们想得到一个黑匣子： </p><br><pre><code class="plaintext hljs">" " =&gt; [?] =&gt; Griffindor</code> </pre> <br><p> 最初的黑帽子根据其性质和个人素质向各部门分配了年轻的巫师。 由于我们无法获得根据任务条件获得的性格和性格数据，因此我们将使用参与者的姓名和姓氏，请记住，在这种情况下，我们应在与书中本国部门相对应的部门之间分配书中的字符。 如果我们的决定将哈利分配给赫奇帕奇或拉文克劳，陶艺师肯定会不高兴的（但是这应该使哈利以相同的可能性将哈利分配给格兰芬多和斯莱特林来传达这本书的精神）。 </p><br><p> 由于我们在谈论概率，因此我们用更严格的数学术语来形式化问题。 从数据科学的角度来看，我们解决了分类问题，即为对象（线，以名称和姓氏的形式）分配某个类（实际上，它只是一个标签或标签，可以是数字或具有yes / no值的4个变量） ） 我们知道，至少对于哈利来说，给出两个答案是正确的：格兰芬多和斯莱特林，因此最好不要预测帽子所定义的具体能力，而要预测一个人被分配给该能力的可能性，因此我们的决定将在某种功能 </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mo>&amp;lt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x540D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x79F0;</mo></mrow><mo>&amp;gt;&amp;lt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x59D3;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6C0F;</mo></mrow><mo>&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>g</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>w</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>p</mi><mi>u</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>n</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.361ex" height="2.66ex" viewBox="0 -780.1 30294.3 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="0" y="0"></use><g transform="translate(550,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3C" x="1658" y="0"></use><g transform="translate(2714,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">名</text></g><g transform="translate(3544,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">称</text></g><g transform="translate(4652,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3E"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3C" x="778" y="0"></use></g><g transform="translate(6487,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">姓</text></g><g transform="translate(7317,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">氏</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3E" x="8424" y="0"></use><g transform="translate(9481,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3D" x="10588" y="0"></use><g transform="translate(11645,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(12475,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-72" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-69" x="932" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="1277" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="1827" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-69" x="2378" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="2724" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-64" x="3324" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6F" x="3848" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-72" x="4333" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3B" x="16601" y="0"></use><g transform="translate(17046,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-61" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-76" x="981" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="1466" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="1932" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-63" x="2533" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6C" x="2967" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-61" x="3265" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-77" x="3795" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3B" x="20978" y="0"></use><g transform="translate(21424,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-68" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-75" x="576" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="1149" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="1699" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6C" x="2250" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-70" x="2548" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-75" x="3052" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="3624" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="4175" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3B" x="25507" y="0"></use><g transform="translate(25953,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6C" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-69" x="768" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-74" x="1113" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-68" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="2051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-72" x="2518" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-69" x="2969" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="3315" y="0"></use></g></g><g transform="translate(29464,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>名</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>称</mo></mrow><mo>&gt;&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>姓</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>氏</mo></mrow><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>w</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>p</mi><mi>u</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>n</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> f（<名称> <姓氏>）=（P_ {griffindor}; P_ {ravenclaw}; P_ {hufflpuff}; P_ {slitherin}）</script></p><br><h3 id="metriki-i-ocenka-kachestva"> 指标和质量评估 </h3><br><p> 制定了任务和目标， <del> 现在我们来思考如何解决 </del> 但这还不是全部。 为了开始研究，您需要输入质量指标。 换句话说，要确定我们如何将两种不同的解决方案相互比较。 </p><br><p> 生活中的一切都是美好而简单的-我们从直觉上理解，垃圾邮件检测器必须将最少的垃圾邮件传递给传入的邮件，并传递最多的必要信件，并且它当然不应将必要的信件发送给垃圾邮件。 </p><br><p> 实际上，一切都更加复杂， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">对此</a>的确认<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">是</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">大量</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> ，这些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a>解释了如何使用度量以及使用哪些度量。 练习有助于最好地理解这一点，但这是一个非常大的话题，我们承诺为此写一篇单独的文章并做一个开放的表，以便每个人都可以玩转并在实践中了解这有何不同。 </p><br><p> 对我们来说，“但让我们选择最好的”家庭将是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ROC AUC</a> 。 在这种情况下，这正是我们希望从度量​​标准中获得的结果：假阳性越少，实际预测越准确，ROC AUC越大。 </p><br><p> 对于理想的ROC模型，AUC为1，对于理想的随机模型，它<em>绝对随机地</em>定义类-0.5。 </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>O</mi><mi>C</mi><mtext>&amp;#xA0;</mtext><mi>A</mi><mi>U</mi><mi>C</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0.5</mn><mo>;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.416ex" height="2.66ex" viewBox="0 -832 8790.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-4F" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-43" x="1523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-41" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-55" x="3284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-43" x="4051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-69" x="5062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="5407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-5B" x="6008" y="0"></use><g transform="translate(6286,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-35" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3B" x="7566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-31" x="8011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-5D" x="8511" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>O</mi><mi>C</mi><mtext>&nbsp;</mtext><mi>A</mi><mi>U</mi><mi>C</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mo stretchy="false">[</mo><mn>0.5</mn><mo>;</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> ROC \ AUC \ in [0.5; 1] </script></p><br><h2 id="algoritmy"> 演算法 </h2><br><p> 我们的黑匣子应该考虑书籍英雄的分布，输入不同的名字和姓氏，然后给出结果。 要解决分类问题，可以使用不同的机器学习算法： </p><br><p> 神经网络，分解机，线性回归或（例如）SVM。 </p><br><p> 与流行的看法相反，数据科学不仅限于神经网络，而且为了普及该思想，本文将神经网络留给<em>好奇的读者练习</em> 。 那些没有参加过数据分析课程（特别是主观上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">更好的</a>课程）的人，或者只是阅读了有关机器学习或AI的新闻，而这些新闻现在甚至在业余渔民杂志上也发表过，这些人必须符合通用算法的名称：套袋，加强，支持向量法（SVM），线性回归。 我们将使用它们来解决问题。 </p><br><p> 更准确地说，我们比较： </p><br><ul><li> 线性回归 </li><li> 增强（XGboost，LightGBM） </li><li> 决定树木（严格来说，这是相同的提振，但我们将其单独取出：多余的树木） </li><li> 套袋（随机森林） </li><li> 支持向量机 </li></ul><br><p> 我们可以通过定义与霍格沃茨大学学生相对应的大学系来解决将每个霍格沃茨系学生分配给其中一个系的问题，但是严格来说，此任务<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">归结</a>为解决确定每个班级是否属于个人的问题。 因此，在本文的框架中，我们为自己设定了获得4个模型的目标，每个模型一个。 </p><br><h2 id="dannye"> 资料 </h2><br><p> 寻找正确的数据集进行培训，更重要的是，将其用于正确的目的是合法的，这是数据科学中最复杂，最耗时的任务之一。 对于我们的任务，我们将从哈利·波特世界各地的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Wikia中</a>获取数据。 例如，在此链接上，您可以找到在格兰芬多学院学习的所有角色。 在这种情况下，我们将数据用于非商业目的非常重要，因此我们不会违反本网站的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">许可</a> 。 </p><br><p><img src="https://habrastorage.org/webt/ff/f8/4e/fff84efaafg_yqwbhuhbfyz17k0.jpeg"></p><br><p> 对于那些认为数据科学家真是太酷了的人，我将去数据科学家那里任教，我们提醒您，存在清理和准备数据的步骤。 必须手动审核下载的数据，以删除例如“格兰芬多第七郡”和半自动删除“来自格兰芬多的未知女孩”。 在实际工作中，任务的很大一部分总是与数据集中缺失值的准备，清理和恢复相关联。 </p><br><p> 稍微按Ctrl + C和Ctrl + V，然后在输出中得到4个文本文件，其中包含2种语言的字符名称：英语和俄语。 </p><br><h2 id="izuchaem-sobrannye-dannye--eda-exploratory-data-analysis"> 我们研究收集的数据（EDA，探索性数据分析） </h2><br><p> 在此阶段，我们有4个文件，其中包含学院学生的姓名，我们将对其进行更详细的介绍： </p><br><pre> <code class="bash hljs">$ ls ../input griffindor.txt hufflpuff.txt ravenclaw.txt slitherin.txt</code> </pre> <br><p> 每个文件每行包含1个学生的姓名和姓氏（如果有）： </p><br><pre> <code class="bash hljs">$ wc -l ../input/*.txt 250 ../input/griffindor.txt 167 ../input/hufflpuff.txt 180 ../input/ravenclaw.txt 254 ../input/slitherin.txt 851 total</code> </pre> <br><p> 收集的数据具有以下形式： </p><br><pre> <code class="bash hljs">$ cat ../input/griffindor.txt | head -3 &amp;&amp; cat ../input/griffindor.txt | tail -3      Charlie Stainforth Melanie Stanmore Stewart</code> </pre> <br><p> 我们的整个想法基于这样的假设：黑匣子（或黑帽）可以在名称和姓氏中有所区别。 </p><br><p> 该算法可以按原样填充行，但效果不佳，因为基本模型将无法独立理解“ Draco”与“ Harry”的区别，因此我们需要从我们的姓名中提取符号。 </p><br><h3 id="podgotovka-dannyh-feature-engineering"> 数据准备（特征工程） </h3><br><p>  <strong>符号</strong> （或特征， <em>英文</em> <strong>特征</strong> -属性）是对象的区别属性。 过去一年中，一个人换工作的次数，左手的手指数，发动机的发动机容量，汽车的行驶里程是否超过100,000公里。 各种各样的标志分类都是由很多人发明的，在这方面没有而且不可能是一个单一的系统，因此，我们将举例说明哪些标志可以是： </p><br><ol><li> 有理数 </li><li> 类别（最多12、12-18或18+） </li><li> 二进制值（是否退还第一笔贷款） </li><li> 日期，颜色，份额等 </li></ol><br><p>  <strong>特征的搜索</strong> （或形成）（ <em>英语为</em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Feature Engineering</a> ）通常作为单独的研究阶段或数据分析专家的工作而脱颖而出。 实际上，常识，经验和假设检验有助于流程本身。 立即猜测正确的标志是一个全手，基础知识和运气相结合的问题。 有时其中包含萨满教，但是一般的方法很简单：您需要先想到，然后检查是否有可能通过添加新属性来改善解决方案。 例如，作为执行任务的标志，我们可以在名称中加上嘶嘶声。 </p><br><p> 在我们模型的第一个版本中（因为真正的数据科学研究-作为杰作，永远无法完成），我们将使用以下功能来命名和使用姓氏： </p><br><ol><li>  1和单词的最后一个字母-元音或辅音 </li><li> 双元音和辅音 </li><li> 元音，辅音，聋人，浊音的数量 </li><li> 名字长度，姓氏长度 </li><li>  ... </li></ol><br><p> 为此，我们将以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">该</a>存储库为基础并添加一个类，以便将其用于拉丁字母。 这将使我们有机会确定每个字母的发音。 </p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Phonetic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RussianLetter, EnglishLetter &gt;&gt; RussianLetter(<span class="hljs-string"><span class="hljs-string">''</span></span>).classify() {<span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>} &gt;&gt; EnglishLetter(<span class="hljs-string"><span class="hljs-string">'d'</span></span>).classify() {<span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>}</code> </pre> <br><p> 现在，我们可以定义用于计算统计信息的简单函数，例如： </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">starts_with_letter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word, letter_type=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vowel'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   ,    . :param word:  :param letter_type: 'vowel'  'consonant'.   . :return: Boolean """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(word) == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Letter(word[<span class="hljs-number"><span class="hljs-number">0</span></span>]).classify()[letter_type] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count_letter_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       . :param word:  :param debug:    :return: :obj:`dict` of :obj:`str` =&gt; :int:count """</span></span> count = { <span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> word: classes = Letter(letter).classify() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> count.keys(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> classes[key]: count[key] += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count</code> </pre> <br><p> 使用这些功能，我们已经可以得到第一个迹象： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> feature_engineering <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">"  («»): "</span></span>, len(<span class="hljs-string"><span class="hljs-string">""</span></span>))   («»): <span class="hljs-number"><span class="hljs-number">5</span></span> &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">" («»)   : "</span></span>, starts_with_letter(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>))  («»)   : <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">" («»)   : "</span></span>, starts_with_letter(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'consonant'</span></span>))  («»)   : <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt; count_Harry = count_letter_type(<span class="hljs-string"><span class="hljs-string">""</span></span>) &gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"     («»): "</span></span>, count_Harry[<span class="hljs-string"><span class="hljs-string">'paired'</span></span>])      («»): <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p> 严格来说，借助这些功能，我们可以获得字符串的一些矢量表示，即，我们获得了映射： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mo>&amp;lt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x540D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x79F0;</mo></mrow><mo>&amp;gt;&amp;lt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x59D3;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6C0F;</mo></mrow><mo>&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>=&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mo>.</mo><mo>.</mo><mo>.</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mtext>&amp;#xA0;</mtext><mi>v</mi></msub><mi>o</mi><mi>w</mi><mi>e</mi><mi>l</mi><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x7684;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6570;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x91CF;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="86.919ex" height="2.419ex" viewBox="0 -780.1 37423.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-66" x="0" y="0"></use><g transform="translate(550,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3C" x="1658" y="0"></use><g transform="translate(2714,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">名</text></g><g transform="translate(3544,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">称</text></g><g transform="translate(4652,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3E"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3C" x="778" y="0"></use></g><g transform="translate(6487,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">姓</text></g><g transform="translate(7317,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">氏</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3E" x="8424" y="0"></use><g transform="translate(9481,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(10588,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-3E" x="778" y="0"></use></g><g transform="translate(12423,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6C" x="13253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="13552" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="14018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-67" x="14619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-74" x="15099" y="0"></use><g transform="translate(15461,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-68" x="0" y="0"></use><g transform="translate(576,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-61" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6D" x="1130" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="2008" y="0"></use></g></g><g transform="translate(17887,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6C" x="18717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="19016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="19482" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-67" x="20083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-74" x="20563" y="0"></use><g transform="translate(20925,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-68" x="0" y="0"></use><g transform="translate(576,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-75" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-72" x="1042" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="1493" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-61" x="2094" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6D" x="2623" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="3502" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-73" x="3968" y="0"></use></g></g><g transform="translate(24739,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-2E" x="25569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-2E" x="26014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMAIN-2E" x="26460" y="0"></use><g transform="translate(26905,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(27735,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-76" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6F" x="28428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-77" x="28914" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="29630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6C" x="30097" y="0"></use><g transform="translate(30395,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-75" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-72" x="1042" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6E" x="1493" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-61" x="2094" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-6D" x="2623" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-65" x="3502" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgfbdgxuXGNTVP-tobZkKK0a4XlKA#MJMATHI-73" x="3968" y="0"></use></g></g><g transform="translate(34103,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(34933,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(35763,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">量</text></g><g transform="translate(36593,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>名</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>称</mo></mrow><mo>&gt;&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>姓</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>氏</mo></mrow><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>=&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mo>.</mo><mo>.</mo><mo>.</mo><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mtext>&nbsp;</mtext><mi>v</mi></msub><mi>o</mi><mi>w</mi><mi>e</mi><mi>l</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>的</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>数</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>量</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> f（<名称> <姓氏>）=>（length_ {name}，length_ {surnames}，...，\ _vowels_ {surnames}的数量）</script></p><br><p> 现在，我们可以以可以输入到机器学习算法的数据集的形式显示数据： </p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_processed_data &gt;&gt; hogwarts_df = load_processed_data() &gt;&gt; hogwarts_df.head()</code> </pre> <br><p><img src="https://habrastorage.org/webt/5-/-e/4g/5--e4gvhmdhe00fxjhwqnxzdajk.png"></p><br><p> 此外，结果，我们为每个学生得到以下症状： </p><br><pre> <code class="python hljs">&gt;&gt; hogwarts_df[hogwarts_df.columns].dtypes</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">收到的迹象</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">name object surname object is_english bool name_starts_with_vowel bool name_starts_with_consonant bool name_ends_with_vowel bool name_ends_with_consonant bool name_length int64 name_vowels_count int64 name_double_vowels_count int64 name_consonant_count int64 name_double_consonant_count int64 name_paired_count int64 name_deaf_count int64 name_sonorus_count int64 surname_starts_with_vowel bool surname_starts_with_consonant bool surname_ends_with_vowel bool surname_ends_with_consonant bool surname_length int64 surname_vowels_count int64 surname_double_vowels_count int64 surname_consonant_count int64 surname_double_consonant_count int64 surname_paired_count int64 surname_deaf_count int64 surname_sonorus_count int64 is_griffindor int64 is_hufflpuff int64 is_ravenclaw int64 is_slitherin int64 dtype: object</code> </pre> </div></div><br><p> 最后4列是针对性的-它们包含有关学生入学的信息。 </p><br><h2 id="obuchenie-algoritmov"> 算法训练 </h2><br><p> 简而言之，算法就像人一样被训练：他们犯错误并从中学习。 为了了解他们犯了多少错误，算法使用<strong>错误</strong>函数（损失函数， <em>英语</em> <strong>损失函数</strong> ）。 </p><br><p> 通常，学习过程非常简单，它包含几个步骤： </p><br><ol><li> 做个预测。 </li><li> 评价错误。 </li><li> 更正模型参数。 </li><li> 重复1-3，直到达到目标，过程停止或数据结束。 </li><li><p> 评价结果模型的质量。 </p><br><p> 当然，实际上，一切都有些复杂。 例如，存在<strong>过度拟合</strong>的现象-该算法可以从字面上记住哪些特征与答案相对应，从而使与他所训练的物体不相似的物体的结果恶化。 为避免这种情况，存在各种技术和技巧。 </p><br></li></ol><br><p> 如上所述，我们将解决4个问题：每个系一个。 因此，我们将为Slytherin准备数据： </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,     - : &gt;&gt; data_full = hogwarts_df.drop( [ 'name', 'surname', 'is_griffindor', 'is_hufflpuff', 'is_ravenclaw' ], axis=1).copy() #    ,   : &gt;&gt; X_data = data_full.drop('is_slitherin', axis=1) #     ,   1    &gt;&gt; y = data_full.is_slitherin</span></span></code> </pre> <br><p> 在学习过程中，算法会不断将其结果与真实数据进行比较，因为这部分数据集已分配用于验证。 还应考虑良好音调的规则，以对算法根本看不到的单个数据评估算法的结果。 因此，现在我们将样本按70/30的比例进行划分，并训练第一个算法： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cross_validation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier <span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt; seed = 7 #    &gt;&gt; test_size = 0.3 &gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X_data, y, test_size=test_size, random_state=seed) &gt;&gt; rfc = RandomForestClassifier() &gt;&gt; rfc_model = rfc.fit(X_train, y_train)</span></span></code> </pre> <br><p> 做完了 现在，如果将数据提交到此模型的输入，它将产生结果。 这很有趣，所以首先我们将检查哈利中的模型是否可以识别斯莱特林。 为此，首先准备函数以获得算法的预测： </p><br><div class="spoiler">  <b class="spoiler_title">查看代码</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> parse_line_to_hogwarts_df <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_single_student_features</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      :param name: string     :return: pd.DataFrame     """</span></span> featurized_person_df = parse_line_to_hogwarts_df(name) person_df = pd.DataFrame(featurized_person_df, columns=[ <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_english'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_starts_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_starts_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_ends_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_ends_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_length'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_double_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_double_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_paired_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_deaf_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_sonorus_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_starts_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_starts_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_ends_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_ends_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_length'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_double_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_double_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_paired_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_deaf_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_sonorus_count'</span></span>, ], index=[<span class="hljs-number"><span class="hljs-number">0</span></span>] ) featurized_person = person_df.drop( [<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>], axis = <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> featurized_person <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_predictions_vector</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model, person)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    :param model:   :param person: string   :return: list    """</span></span> encoded_person = get_single_student_features(person) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model.predict_proba(encoded_person)[<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre> </div></div><br><p> 现在，我们设置一个小的测试数据集来考虑算法的结果。 </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score_testing_dataset</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      . :param model:   """</span></span> testing_dataset = [ <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Kirill Malev"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry Potter"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"Severus Snape"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Tom Riddle"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Salazar Slytherin"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> testing_dataset: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"{} — {}"</span></span>.format(name, get_predictions_vector(model, name)[<span class="hljs-number"><span class="hljs-number">1</span></span>])) score_testing_dataset(rfc_model)</code> </pre> <br><pre> <code class="plaintext hljs">  — 0.5 Kirill Malev — 0.5   — 0.0 Harry Potter — 0.0   — 0.75   — 0.9 Severus Snape — 0.5   — 0.2 Tom Riddle — 0.5   — 0.2 Salazar Slytherin — 0.3</code> </pre> <br><p> 结果令人怀疑。 根据这种模式，即使是该学院的创始人也不会在他的学院中。 因此，您需要评估严格的质量：查看我们一开始就要求的指标： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> accuracy_score, roc_auc_score, classification_report predictions = rfc_model.predict(X_test) print(<span class="hljs-string"><span class="hljs-string">"Classification report: "</span></span>) print(classification_report(y_test, predictions)) print(<span class="hljs-string"><span class="hljs-string">"Accuracy for Random Forest Model: %.2f"</span></span> % (accuracy_score(y_test, predictions) * <span class="hljs-number"><span class="hljs-number">100</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"ROC AUC from first Random Forest Model: %.2f"</span></span> % (roc_auc_score(y_test, predictions)))</code> </pre> <br><pre> <code class="plaintext hljs">Classification report: precision recall f1-score support 0 0.66 0.88 0.75 168 1 0.38 0.15 0.21 89 avg / total 0.56 0.62 0.56 257 Accuracy for Random Forest Model: 62.26 ROC AUC from first Random Forest Model: 0.51</code> </pre> <br><p> 结果如此可疑也就不足为奇了-ROC AUC约为0.51表明该模型的预测比抛硬币更好。 </p><br><h2 id="testirovanie-poluchennyh-rezultatov-metriki-kachestva"> 测试结果。 质量指标 </h2><br><p> 使用上面的一个示例，我们研究了如何训练一种支持sklearn接口的算法。 其余的训练方法完全相同，因此我们只能训练所有算法，并在每种情况下选择最佳算法。 </p><br><p><img src="https://habrastorage.org/webt/ff/i0/fq/ffi0fqqs7gbi3aczbucvusrw2qi.jpeg"></p><br><p> 这并不复杂，对于每种算法，我们使用标准设置训练1，并且还训练整个集合，对影响算法质量的各种选项进行分类。 此阶段称为“模型调整”或“超参数优化”，其本质非常简单：选择提供最佳结果的设置集。 </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_classifiers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_processed_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> warnings warnings.filterwarnings(<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   hogwarts_df = load_processed_data() #     data_full = hogwarts_df.drop( [ 'name', 'surname', 'is_griffindor', 'is_hufflpuff', 'is_ravenclaw' ], axis=1).copy() X_data = data_full.drop('is_slitherin', axis=1) y = data_full.is_slitherin #    slitherin_models = train_classifiers(data_full, X_data, y) score_testing_dataset(slitherin_models[5])</span></span></code> </pre> <br><pre> <code class="plaintext hljs">  — 0.09437856871661066 Kirill Malev — 0.20820536334902712   — 0.07550095601699099 Harry Potter — 0.07683794773639624   — 0.9414529336862744   — 0.9293671807790949 Severus Snape — 0.6576783576162999   — 0.18577792617672767 Tom Riddle — 0.8351835484058869   — 0.25930925139546795 Salazar Slytherin — 0.24008788903854789</code> </pre> <br><p> 此版本中的数字在主观上比过去更好，但对于内部完美主义者来说仍然不够好。 因此，我们将下一个更深的层次，并回到工作的产品意义上：我们需要预测最有可能的师资力量，这将由散布的帽子决定英雄。 这意味着您需要为每个系训练模型。 </p><br><p><img src="https://habrastorage.org/webt/hc/ag/ci/hcagciojsjdzpglovd1xabohtym.jpeg"></p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_all_models <span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt; slitherin_models, griffindor_models, ravenclaw_models, hufflpuff_models = \ train_all_models()</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">结果的长结论和多项式回归的结果</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">SVM Default Report Accuracy for SVM Default: 73.93 ROC AUC for SVM Default: 0.53 Tuned SVM Report Accuracy for Tuned SVM: 72.37 ROC AUC for Tuned SVM: 0.50 KNN Default Report Accuracy for KNN Default: 70.04 ROC AUC for KNN Default: 0.58 Tuned KNN Report Accuracy for Tuned KNN: 69.65 ROC AUC for Tuned KNN: 0.58 XGBoost Default Report Accuracy for XGBoost Default: 70.43 ROC AUC for XGBoost Default: 0.54 Tuned XGBoost Report Accuracy for Tuned XGBoost: 68.09 ROC AUC for Tuned XGBoost: 0.56 Random Forest Default Report Accuracy for Random Forest Default: 73.93 ROC AUC for Random Forest Default: 0.62 Tuned Random Forest Report Accuracy for Tuned Random Forest: 74.32 ROC AUC for Tuned Random Forest: 0.54 Extra Trees Default Report Accuracy for Extra Trees Default: 69.26 ROC AUC for Extra Trees Default: 0.57 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 73.54 ROC AUC for Tuned Extra Trees: 0.55 LGBM Default Report Accuracy for LGBM Default: 70.82 ROC AUC for LGBM Default: 0.62 Tuned LGBM Report Accuracy for Tuned LGBM: 74.71 ROC AUC for Tuned LGBM: 0.53 RGF Default Report Accuracy for RGF Default: 70.43 ROC AUC for RGF Default: 0.58 Tuned RGF Report Accuracy for Tuned RGF: 71.60 ROC AUC for Tuned RGF: 0.60 FRGF Default Report Accuracy for FRGF Default: 68.87 ROC AUC for FRGF Default: 0.59 Tuned FRGF Report Accuracy for Tuned FRGF: 69.26 ROC AUC for Tuned FRGF: 0.59 SVM Default Report Accuracy for SVM Default: 70.43 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 71.60 ROC AUC for Tuned SVM: 0.50 KNN Default Report Accuracy for KNN Default: 63.04 ROC AUC for KNN Default: 0.49 Tuned KNN Report Accuracy for Tuned KNN: 65.76 ROC AUC for Tuned KNN: 0.50 XGBoost Default Report Accuracy for XGBoost Default: 69.65 ROC AUC for XGBoost Default: 0.54 Tuned XGBoost Report Accuracy for Tuned XGBoost: 68.09 ROC AUC for Tuned XGBoost: 0.50 Random Forest Default Report Accuracy for Random Forest Default: 66.15 ROC AUC for Random Forest Default: 0.51 Tuned Random Forest Report Accuracy for Tuned Random Forest: 70.43 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 64.20 ROC AUC for Extra Trees Default: 0.49 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 70.82 ROC AUC for Tuned Extra Trees: 0.51 LGBM Default Report Accuracy for LGBM Default: 67.70 ROC AUC for LGBM Default: 0.56 Tuned LGBM Report Accuracy for Tuned LGBM: 70.82 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 66.54 ROC AUC for RGF Default: 0.52 Tuned RGF Report Accuracy for Tuned RGF: 65.76 ROC AUC for Tuned RGF: 0.53 FRGF Default Report Accuracy for FRGF Default: 65.76 ROC AUC for FRGF Default: 0.53 Tuned FRGF Report Accuracy for Tuned FRGF: 69.65 ROC AUC for Tuned FRGF: 0.52 SVM Default Report Accuracy for SVM Default: 74.32 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 74.71 ROC AUC for Tuned SVM: 0.51 KNN Default Report Accuracy for KNN Default: 69.26 ROC AUC for KNN Default: 0.48 Tuned KNN Report Accuracy for Tuned KNN: 73.15 ROC AUC for Tuned KNN: 0.49 XGBoost Default Report Accuracy for XGBoost Default: 72.76 ROC AUC for XGBoost Default: 0.49 Tuned XGBoost Report Accuracy for Tuned XGBoost: 74.32 ROC AUC for Tuned XGBoost: 0.50 Random Forest Default Report Accuracy for Random Forest Default: 73.93 ROC AUC for Random Forest Default: 0.52 Tuned Random Forest Report Accuracy for Tuned Random Forest: 74.32 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 73.93 ROC AUC for Extra Trees Default: 0.52 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 73.93 ROC AUC for Tuned Extra Trees: 0.50 LGBM Default Report Accuracy for LGBM Default: 73.54 ROC AUC for LGBM Default: 0.52 Tuned LGBM Report Accuracy for Tuned LGBM: 74.32 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 73.54 ROC AUC for RGF Default: 0.51 Tuned RGF Report Accuracy for Tuned RGF: 73.93 ROC AUC for Tuned RGF: 0.50 FRGF Default Report Accuracy for FRGF Default: 73.93 ROC AUC for FRGF Default: 0.53 Tuned FRGF Report Accuracy for Tuned FRGF: 73.93 ROC AUC for Tuned FRGF: 0.50 SVM Default Report Accuracy for SVM Default: 80.54 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 80.93 ROC AUC for Tuned SVM: 0.52 KNN Default Report Accuracy for KNN Default: 78.60 ROC AUC for KNN Default: 0.50 Tuned KNN Report Accuracy for Tuned KNN: 80.16 ROC AUC for Tuned KNN: 0.51 XGBoost Default Report Accuracy for XGBoost Default: 80.54 ROC AUC for XGBoost Default: 0.50 Tuned XGBoost Report Accuracy for Tuned XGBoost: 77.04 ROC AUC for Tuned XGBoost: 0.52 Random Forest Default Report Accuracy for Random Forest Default: 77.43 ROC AUC for Random Forest Default: 0.49 Tuned Random Forest Report Accuracy for Tuned Random Forest: 80.54 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 76.26 ROC AUC for Extra Trees Default: 0.48 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 78.60 ROC AUC for Tuned Extra Trees: 0.50 LGBM Default Report Accuracy for LGBM Default: 75.49 ROC AUC for LGBM Default: 0.51 Tuned LGBM Report Accuracy for Tuned LGBM: 80.54 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 78.99 ROC AUC for RGF Default: 0.52 Tuned RGF Report Accuracy for Tuned RGF: 75.88 ROC AUC for Tuned RGF: 0.55 FRGF Default Report Accuracy for FRGF Default: 76.65 ROC AUC for FRGF Default: 0.50 #   ,       </code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegression clf = LogisticRegression(random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'lbfgs'</span></span>, multi_class=<span class="hljs-string"><span class="hljs-string">'multinomial'</span></span>) hogwarts_df = load_processed_data_multi() <span class="hljs-comment"><span class="hljs-comment">#     data_full = hogwarts_df.drop( [ 'name', 'surname', ], axis=1).copy() X_data = data_full.drop('faculty', axis=1) y = data_full.faculty clf.fit(X_data, y) score_testing_dataset(clf)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">  — [0.3602361 0.16166944 0.16771712 0.31037733] Kirill Malev — [0.47473072 0.16051924 0.13511385 0.22963619]   — [0.38697926 0.19330242 0.17451052 0.2452078 ] Harry Potter — [0.40245098 0.16410043 0.16023278 0.27321581]   — [0.13197025 0.16438855 0.17739254 0.52624866]   — [0.17170203 0.1205678 0.14341742 0.56431275] Severus Snape — [0.15558044 0.21589378 0.17370406 0.45482172]   — [0.39301231 0.07397324 0.1212741 0.41174035] Tom Riddle — [0.26623969 0.14194379 0.1728505 0.41896601]   — [0.24843037 0.21632736 0.21532696 0.3199153 ] Salazar Slytherin — [0.09359144 0.26735897 0.2742305 0.36481909]</code> </pre> <br><p>  confusion_matrix: </p><br><pre> <code class="python hljs">confusion_matrix(clf.predict(X_data), y)</code> </pre> <br><pre> <code class="plaintext hljs">array([[144, 68, 64, 78], [ 8, 9, 8, 6], [ 22, 18, 31, 20], [ 77, 73, 78, 151]])</code> </pre> </div></div><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_predctions_vector</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(models, person)</span></span></span><span class="hljs-function">:</span></span> predictions = [get_predictions_vector (model, person)[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> models] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">3</span></span>] } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score_testing_dataset</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(models)</span></span></span><span class="hljs-function">:</span></span> testing_dataset = [ <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Kirill Malev"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry Potter"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"Severus Snape"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Tom Riddle"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Salazar Slytherin"</span></span>] data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> testing_dataset: predictions = get_predctions_vector(models, name) predictions[<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = name data.append(predictions) scoring_df = pd.DataFrame(data, columns=[<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>, <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>, <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>, <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> scoring_df <span class="hljs-comment"><span class="hljs-comment"># Data Science —    ,       top_models = [ slitherin_models[3], griffindor_models[3], ravenclaw_models[3], hufflpuff_models[3] ] score_testing_dataset(top_models)</span></span></code> </pre> <br><pre> <code class="plaintext hljs"> name slitherin griffindor hufflpuff ravenclaw 0   0.349084 0.266909 0.110311 0.091045 1 Kirill Malev 0.289914 0.376122 0.384986 0.103056 2   0.338258 0.400841 0.016668 0.124825 3 Harry Potter 0.245377 0.357934 0.026287 0.154592 4   0.917423 0.126997 0.176640 0.096570 5   0.969693 0.106384 0.150146 0.082195 6 Severus Snape 0.663732 0.259189 0.290252 0.074148 7   0.268466 0.579401 0.007900 0.083195 8 Tom Riddle 0.639731 0.541184 0.084395 0.156245 9   0.653595 0.147506 0.172940 0.137134 10 Salazar Slytherin 0.647399 0.169964 0.095450 0.26126</code> </pre> <br><p><img src="https://habrastorage.org/webt/kc/pq/r7/kcpqr7dw_t-yudtoda54qj1su3o.jpeg"></p><br><p>     , <del>     </del>   .    ROC AUC  ,  0.5.    ,   : </p><br><ul><li>   ; </li><li>    ; </li><li>    ,        ; </li><li>      ,     ; </li><li>  ,            ,   . </li></ul><br><p>            ,    ,   ,   ,          XGBoost      CV ,       . </p><br><p> 重要！ ,       70% .     ,    4          . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_production_models <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xgboost <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> XGBClassifier best_models = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>): best_models.append(XGBClassifier(base_score=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, booster=<span class="hljs-string"><span class="hljs-string">'gbtree'</span></span>, colsample_bylevel=<span class="hljs-number"><span class="hljs-number">1</span></span>, colsample_bytree=<span class="hljs-number"><span class="hljs-number">0.7</span></span>, gamma=<span class="hljs-number"><span class="hljs-number">0</span></span>, learning_rate=<span class="hljs-number"><span class="hljs-number">0.05</span></span>, max_delta_step=<span class="hljs-number"><span class="hljs-number">0</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">6</span></span>, min_child_weight=<span class="hljs-number"><span class="hljs-number">11</span></span>, missing=<span class="hljs-number"><span class="hljs-number">-999</span></span>, n_estimators=<span class="hljs-number"><span class="hljs-number">1000</span></span>, n_jobs=<span class="hljs-number"><span class="hljs-number">1</span></span>, nthread=<span class="hljs-number"><span class="hljs-number">4</span></span>, objective=<span class="hljs-string"><span class="hljs-string">'binary:logistic'</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_alpha=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_lambda=<span class="hljs-number"><span class="hljs-number">1</span></span>, scale_pos_weight=<span class="hljs-number"><span class="hljs-number">1</span></span>, seed=<span class="hljs-number"><span class="hljs-number">1337</span></span>, silent=<span class="hljs-number"><span class="hljs-number">1</span></span>, subsample=<span class="hljs-number"><span class="hljs-number">0.8</span></span>)) slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model = \ train_production_models(best_models) top_models = slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model score_testing_dataset(top_models)</code> </pre> <br><pre> <code class="plaintext hljs">name slitherin griffindor hufflpuff ravenclaw 0   0.273713 0.372337 0.065923 0.279577 1 Kirill Malev 0.401603 0.761467 0.111068 0.023902 2   0.031540 0.616535 0.196342 0.217829 3 Harry Potter 0.183760 0.422733 0.119393 0.173184 4   0.945895 0.021788 0.209820 0.019449 5   0.950932 0.088979 0.084131 0.012575 6 Severus Snape 0.634035 0.088230 0.249871 0.036682 7   0.426440 0.431351 0.028444 0.083636 8 Tom Riddle 0.816804 0.136530 0.069564 0.035500 9   0.409634 0.213925 0.028631 0.252723 10 Salazar Slytherin 0.824590 0.067910 0.111147 0.085710</code> </pre> <br><p>      ,  ,   . </p><br><p>    ,           ,     .   . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle pickle.dump(slitherin_model, open(<span class="hljs-string"><span class="hljs-string">"../output/slitherin.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(griffindor_model, open(<span class="hljs-string"><span class="hljs-string">"../output/griffindor.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(ravenclaw_model, open(<span class="hljs-string"><span class="hljs-string">"../output/ravenclaw.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(hufflpuff_model, open(<span class="hljs-string"><span class="hljs-string">"../output/hufflpuff.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>))</code> </pre> <br><h2 id="prodakshn">  </h2><br><p>           ,     .   ,     , ,       . </p><br><p>           ,  ,      .        ,       .  ,   Data Scientist —       -. </p><br><p>     : </p><br><ul><li>     ; </li><li>     json-       json; </li><li>            . </li></ul><br><p> ,     docker-,           python-.  ,           flask. </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-comment"><span class="hljs-comment"># In python 2.7 import os import subprocess import json import re from flask import Flask, request, jsonify from inspect import getmembers, ismethod import numpy as npb import pandas as pd import math import os import pickle import xgboost as xgb import sys from letter import Letter from talking_hat import * from sklearn.ensemble import RandomForestClassifier import warnings def prod_predict_classes_for_name (full_name): featurized_person = parse_line_to_hogwarts_df(full_name) person_df = pd.DataFrame(featurized_person, columns=[ 'name', 'surname', 'is_english', 'name_starts_with_vowel', 'name_starts_with_consonant', 'name_ends_with_vowel', 'name_ends_with_consonant', 'name_length', 'name_vowels_count', 'name_double_vowels_count', 'name_consonant_count', 'name_double_consonant_count', 'name_paired_count', 'name_deaf_count', 'name_sonorus_count', 'surname_starts_with_vowel', 'surname_starts_with_consonant', 'surname_ends_with_vowel', 'surname_ends_with_consonant', 'surname_length', 'surname_vowels_count', 'surname_double_vowels_count', 'surname_consonant_count', 'surname_double_consonant_count', 'surname_paired_count', 'surname_deaf_count', 'surname_sonorus_count', ], index=[0] ) slitherin_model = pickle.load(open("models/slitherin.xgbm", "rb")) griffindor_model = pickle.load(open("models/griffindor.xgbm", "rb")) ravenclaw_model = pickle.load(open("models/ravenclaw.xgbm", "rb")) hufflpuff_model = pickle.load(open("models/hufflpuff.xgbm", "rb")) predictions = get_predctions_vector([ slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model ], person_df.drop(['name', 'surname'], axis=1)) return { 'slitherin': float(predictions[0][1]), 'griffindor': float(predictions[1][1]), 'ravenclaw': float(predictions[2][1]), 'hufflpuff': float(predictions[3][1]) } def predict(params): fullname = params['fullname'] print(params) return prod_predict_classes_for_name(fullname) def create_app(): app = Flask(__name__) functions_list = [predict] @app.route('/&lt;func_name&gt;', methods=['POST']) def api_root(func_name): for function in functions_list: if function.__name__ == func_name: try: json_req_data = request.get_json() if json_req_data: res = function(json_req_data) else: return jsonify({"error": "error in receiving the json input"}) except Exception as e: data = { "error": "error while running the function" } if hasattr(e, 'message'): data['message'] = e.message elif len(e.args) &gt;= 1: data['message'] = e.args[0] return jsonify(data) return jsonify({"success": True, "result": res}) output_string = 'function: %s not found' % func_name return jsonify({"error": output_string}) return app if __name__ == '__main__': app = create_app() app.run(host='0.0.0.0')</span></span></code> </pre> </div></div><br><p> Dockerfile: </p><br><pre> <code class="bash hljs">FROM datmo/python-base:cpu-py35 <span class="hljs-comment"><span class="hljs-comment">#  python3-wheel,        RUN apt-get update; apt-get install -y python3-pip python3-numpy python3-scipy python3-wheel ADD requirements.txt / RUN pip3 install -r /requirements.txt RUN mkdir /code;mkdir /code/models COPY ./python_api.py ./talking_hat.py ./letter.py ./request.py /code/ COPY ./models/* /code/models/ WORKDIR /code CMD python3 /code/python_api.py</span></span></code> </pre> <br><p>    : </p><br><pre> <code class="bash hljs">docker build -t talking_hat . &amp;&amp; docker rm talking_hat &amp;&amp; docker run --name talking_hat -p 5000:5000 talking_hat</code> </pre> <br><h2 id="testirovanie-prodakshn-modeli">    </h2><br><p>     —            .  ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://">Apache Benchmark</a> .      ,      .  —  . </p><br><pre> <code class="bash hljs">$ ab -p data.json -T application/json -c 50 -n 10000 http://0.0.0.0:5000/predict</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ab</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">This is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt; Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 0.0.0.0 (be patient) Completed 1000 requests Completed 2000 requests Completed 3000 requests Completed 4000 requests Completed 5000 requests Completed 6000 requests Completed 7000 requests Completed 8000 requests Completed 9000 requests Completed 10000 requests Finished 10000 requests Server Software: Werkzeug/0.14.1 Server Hostname: 0.0.0.0 Server Port: 5000 Document Path: /predict Document Length: 141 bytes Concurrency Level: 50 Time taken for tests: 238.552 seconds Complete requests: 10000 Failed requests: 0 Total transferred: 2880000 bytes Total body sent: 1800000 HTML transferred: 1410000 bytes Requests per second: 41.92 [#/sec] (mean) Time per request: 1192.758 [ms] (mean) Time per request: 23.855 [ms] (mean, across all concurrent requests) Transfer rate: 11.79 [Kbytes/sec] received 7.37 kb/s sent 19.16 kb/s total Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.1 0 3 Processing: 199 1191 352.5 1128 3352 Waiting: 198 1190 352.5 1127 3351 Total: 202 1191 352.5 1128 3352 Percentage of the requests served within a certain time (ms) 50% 1128 66% 1277 75% 1378 80% 1451 90% 1668 95% 1860 98% 2096 99% 2260 100% 3352 (longest request)</code> </pre> </div></div><br><p>     ,      : </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prod_predict_classes_for_name</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(full_name)</span></span></span><span class="hljs-function">:</span></span> &lt;...&gt; predictions = get_predctions_vector([ app.slitherin_model, app.griffindor_model, app.ravenclaw_model, app.hufflpuff_model ], person_df.drop([<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> &lt;...&gt; <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> app.app_context(): app.slitherin_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/slitherin.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.griffindor_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/griffindor.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.ravenclaw_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/ravenclaw.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.hufflpuff_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/hufflpuff.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> app</code> </pre> <br><p>    : </p><br><pre> <code class="bash hljs">$ docker build -t talking_hat . &amp;&amp; docker rm talking_hat &amp;&amp; docker run --name talking_hat -p 5000:5000 talking_hat $ ab -p data.json -T application/json -c 50 -n 10000 http://0.0.0.0:5000/predict</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ab</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">This is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt; Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 0.0.0.0 (be patient) Completed 1000 requests Completed 2000 requests Completed 3000 requests Completed 4000 requests Completed 5000 requests Completed 6000 requests Completed 7000 requests Completed 8000 requests Completed 9000 requests Completed 10000 requests Finished 10000 requests Server Software: Werkzeug/0.14.1 Server Hostname: 0.0.0.0 Server Port: 5000 Document Path: /predict Document Length: 141 bytes Concurrency Level: 50 Time taken for tests: 219.812 seconds Complete requests: 10000 Failed requests: 3 (Connect: 0, Receive: 0, Length: 3, Exceptions: 0) Total transferred: 2879997 bytes Total body sent: 1800000 HTML transferred: 1409997 bytes Requests per second: 45.49 [#/sec] (mean) Time per request: 1099.062 [ms] (mean) Time per request: 21.981 [ms] (mean, across all concurrent requests) Transfer rate: 12.79 [Kbytes/sec] received 8.00 kb/s sent 20.79 kb/s total Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.1 0 2 Processing: 235 1098 335.2 1035 3464 Waiting: 235 1097 335.2 1034 3462 Total: 238 1098 335.2 1035 3464 Percentage of the requests served within a certain time (ms) 50% 1035 66% 1176 75% 1278 80% 1349 90% 1541 95% 1736 98% 1967 99% 2141 100% 3464 (longest request)</code> </pre> </div></div><br><p> 做完了   .         ,          . </p><br><h2 id="zaklyuchenie"> 结论 </h2><br><p>            ,             .       -     . </p><br><p> ,     : </p><br><ul><li>    feature engineering-     ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>  ),  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Soundex</a>     . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>   PyTorch        .       ,        ,         . </li><li>     flask   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Quart</a> ,        ,          . </li><li>    -  -,     . </li></ul><br><p>      ,           ,     .   ,  ! </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 没有开放数据科学社区，就不会发表这篇文章，该社区聚集了数据分析领域的大量俄语专家。 </font></font></p><cut></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN430006/">https://habr.com/ru/post/zh-CN430006/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN429996/index.html">云网络管理员</a></li>
<li><a href="../zh-CN429998/index.html">提高注意力的科学方法：促智药，神经接口和电刺激</a></li>
<li><a href="../zh-CN430000/index.html">最后的莫希干人。 《财富》 500强企业中最老的首席执行官将一切归于智能手机的衰落</a></li>
<li><a href="../zh-CN430002/index.html">红帽企业版Linux 8 Beta-与世界同步</a></li>
<li><a href="../zh-CN430004/index.html">来自中国的未经认证的GPS追踪器。 在俄罗斯合法吗？</a></li>
<li><a href="../zh-CN430008/index.html">齿轮：马，帆船和其他皇家娱乐活动</a></li>
<li><a href="../zh-CN430010/index.html">公开课“如何不做：业务流程分析中的反例”</a></li>
<li><a href="../zh-CN430014/index.html">密封类。 语义与性能</a></li>
<li><a href="../zh-CN430016/index.html">科学家困惑地承认，他们仍然不知道引力相互作用的确切大小</a></li>
<li><a href="../zh-CN430024/index.html">飞机失事如何改善IT解析</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>