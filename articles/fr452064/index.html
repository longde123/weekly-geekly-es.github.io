<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëë ü§Ω üåÅ Configuration et fichiers de l'√©tat souhait√© PowerShell: Partie 1. Configuration du serveur d'extraction DSC pour qu'il fonctionne avec la base de donn√©es SQL üòµ ‚ûø ‚ú≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La configuration de l'√©tat souhait√© de PowerShell (DSC) facilite le d√©ploiement et la configuration du syst√®me d'exploitation, des r√¥les de serveur et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Configuration et fichiers de l'√©tat souhait√© PowerShell: Partie 1. Configuration du serveur d'extraction DSC pour qu'il fonctionne avec la base de donn√©es SQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/452064/"><img src="https://habrastorage.org/webt/-4/vu/2i/-4vu2idi-kona7rk1zluhuqtrlk.png"><br><br>  La configuration de l'√©tat souhait√© de PowerShell (DSC) facilite le d√©ploiement et la configuration du syst√®me d'exploitation, des r√¥les de serveur et des applications lorsque vous avez des centaines de serveurs. <br><br>  Mais lorsque vous utilisez DSC sur site, c'est-√†-dire  pas dans MS Azure, il y a quelques nuances.  Ils sont particuli√®rement tangibles si l'organisation est grande (√† partir de 300 postes de travail et serveurs) et qu'elle n'a pas encore ouvert le monde des conteneurs: <br><br><ul><li>  Il n'y a pas de rapports complets sur l'√©tat des syst√®mes.  Si la configuration souhait√©e n'a √©t√© appliqu√©e sur aucun serveur, alors sans ces rapports, nous ne le saurons pas.  Il est assez difficile d'obtenir des informations √† partir du serveur de rapports int√©gr√©, et pour un grand nombre d'h√¥tes, c'est aussi long. </li><li>  Il n'y a aucune √©volutivit√© et tol√©rance aux pannes.  Il est impossible de cr√©er une batterie de serveurs Web DSC d'interrogation qui aurait une seule base de donn√©es tol√©rante aux pannes et un r√©f√©rentiel commun de fichiers de configuration mof, de modules et de cl√©s d'enregistrement. </li></ul><br>  Aujourd'hui, je vais vous dire comment r√©soudre le premier probl√®me et obtenir les donn√©es pour le reporting.  Tout serait plus simple si SQL pouvait √™tre utilis√© comme base de donn√©es.  MS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">promet une</a> prise en charge int√©gr√©e uniquement dans Windows Server 2019 ou dans le serveur Windows build 1803. Il <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©chouera</a> √©galement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√†</a> r√©cup√©rer des donn√©es √† l'aide du fournisseur OleDB, car le serveur DSC utilise un param√®tre nomm√© qui n'est pas enti√®rement pris en charge par OleDbCommand. <br><br>  J'ai trouv√© ceci: pour ceux qui utilisent Windows Server 2012 et 2016, vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">configurer l'</a> utilisation de la base de donn√©es SQL comme backend pour le serveur DSC d'interrogation.  Pour ce faire, cr√©ez un ¬´proxy¬ª sous la forme d'un fichier .mdb avec des tables li√©es, qui redirigera les donn√©es re√ßues des rapports clients vers la base de donn√©es du serveur SQL. <br><a name="habracut"></a><br>  <i>Remarque: Pour Windows Server 2016, vous devez utiliser <a href="">AccessDatabaseEngine2016x86</a> , car Microsoft.Jet.OLEDB.4.0 n'est plus pris en charge.</i> <br><br>  Je ne m'attarderai pas sur le processus de d√©ploiement du serveur DSC d'interrogation, il est tr√®s bien d√©crit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Je note seulement quelques points.  Si nous d√©ployons l'interrogation DSC sur le m√™me serveur Web avec WSUS ou Kaspersky Security Center, alors dans le script de cr√©ation de configuration, il est n√©cessaire de modifier les param√®tres suivants: <br><br><ol><li><pre><code class="sql hljs">UseSecurityBestPractices     = $false</code> </pre> <br>  Sinon, TLS 1.0 sera d√©sactiv√©, vous ne pourrez pas vous connecter √† la base de donn√©es SQL.  Kaspersky Security Center ne fonctionnera pas non plus (le probl√®me doit √™tre r√©solu dans Kaspersky Security Center v11). </li><li><pre> <code class="sql hljs">Enable32BitAppOnWin64   = $true</code> </pre> <br>  Si vous n'effectuez pas cette modification, vous ne pouvez pas d√©marrer le serveur AppPool DSC sur IIS avec WSUS. </li><li>  Lors de l'installation d'un serveur DSC avec WSUS, d√©sactivez la mise en cache statique et dynamique pour le site DSC. </li></ol><br>  Passons √† la configuration du serveur DSC pour utiliser la base de donn√©es SQL. <br><br><h3>  Cr√©ation d'une base de donn√©es SQL </h3><br><ol><li>  Cr√©ez une base de donn√©es SQL vide nomm√©e DSC. <br><br><img src="https://habrastorage.org/webt/24/je/ik/24jeikjjhurylsfpxfdz-hkdkoo.png"><br><br><img src="https://habrastorage.org/webt/-i/km/hz/-ikmhzvewzfmt8ygqaidws2erzm.png"></li><li>  Cr√©ez un compte pour vous connecter √† cette base de donn√©es.  V√©rifiez au pr√©alable que l'authentification des comptes Windows et SQL est activ√©e sur le serveur SQL. <br><br><img src="https://habrastorage.org/webt/z-/qz/tx/z-qztxe410jqyjoj7rwna3t9-am.png"><br><br><img src="https://habrastorage.org/webt/uh/no/vm/uhnovmv8wsywdxi6ahxiinvkj4y.png"></li><li>  Acc√©dez √† la section User Mapping.  S√©lectionnez une base de donn√©es, dans ce cas, DSC.  Nous accordons les droits du propri√©taire de la base de donn√©es. <br><br><img src="https://habrastorage.org/webt/cl/fg/vg/clfgvg0ya7csozw1ner_egxdxs8.png"></li><li>  C'est fait. <br><br><img src="https://habrastorage.org/webt/9i/la/7n/9ila7nedgtygol496l7da239i1k.png"></li></ol><br><h3>  Cr√©ation d'un sch√©ma pour une base de donn√©es DSC </h3><br>  Il existe deux fa√ßons de cr√©er un sch√©ma pour une base de donn√©es DSC: <br><br><ul><li>  ind√©pendamment, via un script en TSQL <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ANSI_NULLS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> QUOTED_IDENTIFIER <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[Devices]( [TargetName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationID] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ServerCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [TargetCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeCompliant] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastComplianceTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastHeartbeatTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [Dirty] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusCode] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[RegistrationData]( [AgentId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationNames] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[StatusReport]( [JobId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Id</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [OperationType] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RefreshMode] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ReportFormatVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StartTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [EndTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Errors</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusData] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RebootRequested] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre> </li><li>  importer des donn√©es √† partir de devices.mdb vides dans le cadre du module PS PSDesiredStateConfiguration via l'assistant d'importation de donn√©es SQL. <br><br>  Devices.mdb, avec lequel nous travaillerons, se trouve dans C: \ Windows \ SysWOW64 \ WindowsPowerShell \ v1.0 \ Modules \ PSDesiredStateConfiguration \ PullServer. <br></li></ul><br><ol><li>  Pour importer des donn√©es, ex√©cutez l'Assistant d'importation et d'exportation SQL Server. <br><br><img src="https://habrastorage.org/webt/im/3v/ww/im3vwwj9ib9wucm4xnl70jow1yy.png"></li><li>  Nous choisissons d'o√π nous collecterons les donn√©es - dans notre cas, il s'agit d'une base de donn√©es Microsoft Access.  Cliquez sur Suivant. <br><br><img src="https://habrastorage.org/webt/l5/rc/dq/l5rcdqtxvaajv5h5mbil72vv3k0.png"></li><li>  S√©lectionnez le fichier d'o√π nous importons le sch√©ma. <br><br><img src="https://habrastorage.org/webt/th/dt/xu/thdtxutqcvsrv0laifxjhsbse2w.png"></li><li>  Nous indiquons o√π importer - nous avons cette base de donn√©es SQL. <br><br><img src="https://habrastorage.org/webt/dc/sc/p5/dcscp5f9n-cdmm0qfo0gv_-k0oy.png"></li><li>  S√©lectionnez le serveur SQL (nom du serveur) et la base de donn√©es dans laquelle nous importerons les donn√©es (DataBase). <br><br><img src="https://habrastorage.org/webt/kr/sd/ds/krsddsbr4jpvi9dgvc3f_qcxwqy.png"></li><li>  Nous s√©lectionnons l'option Copier les donn√©es d'une ou plusieurs tables ou vues (copie de donn√©es de tables ou de vues). <br><br><img src="https://habrastorage.org/webt/nu/aq/q8/nuaqq8akzpdz07fwf1gedrxcfns.png"></li><li>  Nous s√©lectionnons les tables √† partir desquelles nous importerons le sch√©ma de base de donn√©es. <br><br><img src="https://habrastorage.org/webt/bf/7k/at/bf7kat56ltu-amw0nhvgbp2tkpw.png"></li><li>  Cochez Ex√©cuter imm√©diatement et cliquez sur Terminer. <br><br><img src="https://habrastorage.org/webt/7i/au/wo/7iauwo3j_x0qzfwqgfc1u8tyfks.png"></li><li>  C'est fait. <br><br><img src="https://habrastorage.org/webt/oi/49/w0/oi49w0cedn8ilblfijwlhjsumfm.png"></li><li>  Par cons√©quent, les tables doivent appara√Ætre dans la base de donn√©es DSC. <br><br><img src="https://habrastorage.org/webt/z3/ui/pp/z3uippubkjjk0r2fqolnoweezme.png"></li></ol><br><h3>  Configuration d'un fichier ¬´proxy¬ª .mdb </h3><br>  <b>Cr√©ation d'une connexion ODBC au serveur SQL.</b>  Il est suppos√© que MS Access n'est pas install√© sur le serveur avec DSC, donc la configuration de databases.mdb est effectu√©e sur un h√¥te interm√©diaire avec MS Access install√©. <br><br>  Cr√©ons une connexion ODBC syst√®me au serveur SQL (la profondeur de bits de la connexion doit correspondre √† la profondeur de bits de MS Access - 64 ou 32).  Il peut √™tre cr√©√© en utilisant: <br>  - applet de commande PowerShell: <br><br><pre> <code class="sql hljs">Add-OdbcDsn ‚ÄìName DSC ‚ÄìDriverName 'SQL Server' ‚ÄìPlatform '&lt;64-bit or 32-bit&gt;' ‚ÄìDsnType System ‚ÄìSetPropertyValue @('Description=DSC Pull Server',"Server=&lt;Name of your SQL Server&gt;",'Trusted_Connection=yes','Database=DSC') ‚ÄìPassThru</code> </pre> <br>  - ou manuellement, √† l'aide de l'assistant de connexion: <br><br><ol><li>  Ouvrez les outils d'administration.  Nous s√©lectionnons les sources de donn√©es ODBC en fonction de la version de MS Access install√©e.  Acc√©dez √† l'onglet Syst√®me DSN et cr√©ez une connexion syst√®me (Ajouter). <br><br><img src="https://habrastorage.org/webt/pt/k5/cu/ptk5cuuxfa2deeqiw_h6vb4vy_4.png"></li><li>  Nous indiquons que nous allons nous connecter au serveur SQL.  Cliquez sur Terminer. <br><br><img src="https://habrastorage.org/webt/ey/b_/dz/eyb_dz43l6-xzg3yupw4zgrasbi.png"></li><li>  Sp√©cifiez le nom et le serveur √† connecter.  Ensuite, une connexion avec les m√™mes param√®tres devra √™tre cr√©√©e sur le serveur DSC. <br><br><img src="https://habrastorage.org/webt/_d/py/lq/_dpylq1y7uycuiq08tkq-jp1eri.png"></li><li>  Nous indiquons que pour nous connecter au serveur SQL, nous utilisons la connexion pr√©c√©demment cr√©√©e avec le nom DSC. <br><br><img src="https://habrastorage.org/webt/_2/bw/bs/_2bwbsadgrihkikrnnh2eq2tkbs.png"></li><li>  Sp√©cifiez la base de donn√©es dans les param√®tres de connexion DSC. <br><br><img src="https://habrastorage.org/webt/eg/ex/eg/egexegl50aplc4fr_f1jbfx3edq.png"></li><li>  Cliquez sur Terminer. <br><br><img src="https://habrastorage.org/webt/di/a8/_n/dia8_nwzir-nhafd9rezwstdwjq.png"></li><li>  Avant de terminer les r√©glages, nous v√©rifions que la connexion fonctionne (Test Data Source). <br><br><img src="https://habrastorage.org/webt/kt/ft/tm/ktfttmjcb_8gyb3s-o_xnwewyfy.png"></li><li>  C'est fait. <br><br><img src="https://habrastorage.org/webt/4r/4z/aa/4r4zaalbv3rms8xsfjoijzvtige.png"></li></ol><br>  <b>Cr√©ation de la base de donn√©es devices.mdb dans MS Access.</b>  Nous d√©marrons MS Access et cr√©ons une base de donn√©es vide appel√©e devices.mdb. <br><br><img src="https://habrastorage.org/webt/tq/4n/ia/tq4niasnq5av17ozevpg365y_qy.png"><br><br><ol><li>  Acc√©dez √† l'onglet Donn√©es externes, cliquez sur la base de donn√©es ODBC.  Dans la fen√™tre qui appara√Æt, s√©lectionnez Cr√©er une table li√©e pour la communication avec la source de donn√©es. <br><br><img src="https://habrastorage.org/webt/aq/ql/vq/aqqlvqqilfgqgdakivqfna9irvu.png"></li><li>  Dans la nouvelle fen√™tre, s√©lectionnez l'onglet Machine Data Source et cliquez sur OK.  Dans la nouvelle fen√™tre, entrez les informations d'identification pour la connexion au serveur SQL. <br><br><img src="https://habrastorage.org/webt/rr/8c/zl/rr8czlircqalebpljfw47h5eax4.png"></li><li>  Nous s√©lectionnons les tables qui doivent √™tre li√©es.  Cochez la case Enregistrer le mot de passe et cliquez sur OK.  Le mot de passe doit √™tre enregistr√© √† chaque fois pour les trois tables. <br><br><img src="https://habrastorage.org/webt/dy/f9/w5/dyf9w58ztue8ugsagfiieghgqsc.png"></li><li>  Dans les indices, vous devez s√©lectionner les √©l√©ments suivants: <br>  - TargetName pour la table dbo_Devices; <br><br><img src="https://habrastorage.org/webt/e-/fl/s_/e-fls_elpbmiktv67egcweaxlvq.png"><br><br>  - NodeName ou IPAddress pour dbo_RegistrationData; <br><br><img src="https://habrastorage.org/webt/xo/ug/do/xougdoiodatj1tlmsalqpdfzauk.png"><br><br>  - NodeName ou IPAddress pour dbo_StatusReport. <br><br><img src="https://habrastorage.org/webt/w7/lj/us/w7ljush_8zrt8hupqoqvrtsgk4g.png"></li><li>  Renommez les tables dans MS Access, √† savoir: supprimez le pr√©fixe dbo_ pour que DSC puisse les utiliser. <br><br><img src="https://habrastorage.org/webt/6w/o-/1q/6wo-1qvgkwua75cv1nd1rsmng1k.png"></li><li>  C'est fait. <br><br><img src="https://habrastorage.org/webt/58/16/x8/5816x8uw93muoywridyx-dwjugw.png"></li><li>  Enregistrez le fichier et fermez MS Access.  Copiez maintenant le fichier devices.mdb r√©sultant sur le serveur DSC (par d√©faut dans C: \ Program Files \ WindowsPowershell \ DSCService) et remplacez-le par celui existant (le cas √©ch√©ant). </li></ol><br><h3>  Configuration d'un serveur DSC pour utiliser SQL </h3><br><ol><li>  Nous revenons au serveur DSC.  Pour vous connecter au serveur SQL avec notre fichier proxy, cr√©ez une nouvelle connexion ODBC sur le serveur DSC.  Le nom, la profondeur de bits et les param√®tres de connexion doivent √™tre les m√™mes que lors de la cr√©ation du fichier MDB.  Vous pouvez copier les devices.mdb vides d√©j√† configur√©s √† partir d'ici. <br></li><li>  Pour utiliser devices.mdb, vous devez apporter des modifications au web.config du serveur DSC d'interrogation (par d√©faut, C: \ inetpub \ PSDSCPullServer \ web.config): </li></ol><br><br>  - pour Windows Server 2012 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br>  - pour Windows Server 2016 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br><br>  Ceci termine la configuration du serveur DSC. <br><br><h3>  V√©rification de l'int√©grit√© du serveur DSC </h3><br><ol><li>  V√©rifiez que le serveur DSC est accessible via un navigateur Web. <br><br><img src="https://habrastorage.org/webt/oi/oe/1z/oioe1zuj9x9gvl9eeek9sc38nz8.png"></li><li>  V√©rifions maintenant si le serveur DSC d'interrogation fonctionne correctement.  Pour cela, le module xPSDesiredStateConfiguration dispose d'un script pullserversetuptests.ps1.  Avant d'ex√©cuter ce script, vous devez installer le module Powershell nomm√© Pester.  Installez-le Install-Module -Name Pester. </li><li>  Ouvrez C: \ Program Files \ WindowsPowerShell \ Modules \ xPSDesiredStateConfiguration \ &lt;version du module&gt; \ DSCPullServerSetup \ PullServerDeploymentVerificationTest (dans l'exemple, la version 8.0.0.0.0). <br><br><img src="https://habrastorage.org/webt/_5/db/gl/_5dbglhxbi5mgboeexxi_pw7oxk.png"></li><li>  Ouvrez PullServerSetupTests.ps1 et v√©rifiez le chemin d'acc√®s au web.config du serveur DSC.  Rouge a mis en √©vidence le chemin d'acc√®s √† web.config, qui v√©rifiera le script.  Si n√©cessaire, modifiez ce chemin. <br><br><img src="https://habrastorage.org/webt/et/te/mn/ettemnvebjfc3kgviqzqsob_eas.png"></li><li>  Ex√©cutez pullserversetuptests.ps1 <br>  Invoke-Pester. \ PullServerSetupTests.ps1 <br>  Tout fonctionne. <br><br><img src="https://habrastorage.org/webt/qc/qp/m5/qcqpm5a4iwsl_-9d7n2uzll9zjg.png"></li><li>  Dans SQL Management Studio, nous voyons que les h√¥tes administr√©s envoient des rapports au serveur de rapports DSC et les donn√©es vont √† la base de donn√©es DSC sur le serveur SQL. <br><br><img src="https://habrastorage.org/webt/ba/oo/04/baoo048uqhsyxpsv4yaaftqmwvi.png"></li></ol><br>  C‚Äôest tout.  Dans les articles suivants, je pr√©vois de dire comment cr√©er des rapports sur les donn√©es re√ßues, et je vais aborder les questions sur la tol√©rance aux pannes et l'√©volutivit√©. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452064/">https://habr.com/ru/post/fr452064/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452052/index.html">Comment nous avons r√©duit de moiti√© le co√ªt d'une le√ßon d'introduction en examinant une solution des compagnies a√©riennes</a></li>
<li><a href="../fr452054/index.html">Pourquoi WhatsApp ne sera jamais s√ªr</a></li>
<li><a href="../fr452056/index.html">Golang DevDay: 31 mai, Novossibirsk + √©mission</a></li>
<li><a href="../fr452060/index.html">Informations sur les pr√©dicats d'espoir</a></li>
<li><a href="../fr452062/index.html">Comment commence ta matin√©e?</a></li>
<li><a href="../fr452066/index.html">Excelsior JET arr√™te le d√©veloppement de son compilateur AOT apr√®s 18 ans de travail</a></li>
<li><a href="../fr452068/index.html">12. Check Point Getting Started R80.20. Journaux et rapports</a></li>
<li><a href="../fr452072/index.html">Nous impl√©mentons CircularRevealAnimation sur Flutter et publions simultan√©ment la biblioth√®que sur pub.dev</a></li>
<li><a href="../fr452074/index.html">Le premier jeu sur l'unit√© ou ce qu'il m'a fallu six mois</a></li>
<li><a href="../fr452076/index.html">Briser le navigateur UC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>