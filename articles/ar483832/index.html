<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ฉ ๐ฉ๐พโ๐คโ๐ฉ๐ฝ RxJava ุฅูู Coroutines: ุชุฑุญูู ููุฒุฉ ููุงูุฉ ุฅูู ููุงูุฉ ๐ ๐จ๐ปโ๐ซ ๐๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(ูุดุฑุช ุฃุตูุง ุนูู ูุชูุณุทุฉ ) 

 ุฅู corotines Kotlin ูู ุฃูุซุฑ ุจูุซูุฑ ูู ูุฌุฑุฏ ุฎููุท ุฎูููุฉ ุงููุฒู - ุฅููุง ูููุฐุฌ ุฌุฏูุฏ ูุณุงุนุฏ ุงููุทูุฑูู ุนูู ุงูุชุนุงูู ูุน ุงูุชุฒุงูู ุจุทุฑููุฉ ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RxJava ุฅูู Coroutines: ุชุฑุญูู ููุฒุฉ ููุงูุฉ ุฅูู ููุงูุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483832/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jb/id/pq/jbidpqpivwqpagw9azop_fswram.png" alt="ุตูุฑุฉ"></div><br>  (ูุดุฑุช ุฃุตูุง ุนูู <a href="https://link.medium.com/OJ7ed2RCd3" rel="nofollow">ูุชูุณุทุฉ</a> ) <br><br>  ุฅู corotines Kotlin ูู ุฃูุซุฑ ุจูุซูุฑ ูู ูุฌุฑุฏ ุฎููุท ุฎูููุฉ ุงููุฒู - ุฅููุง ูููุฐุฌ ุฌุฏูุฏ ูุณุงุนุฏ ุงููุทูุฑูู ุนูู ุงูุชุนุงูู ูุน ุงูุชุฒุงูู ุจุทุฑููุฉ <a href="https://medium.com/%40elizarov/structured-concurrency-722d765aa952" rel="nofollow">ููุธูุฉ</a> ูุชุนุจูุฑูุฉ. <br><br>  ุนูุฏ ุชุทููุฑ ุฃุญุฏ ุชุทุจููุงุช Android ุ ููุจุบู ูููุฑุก ูุฑุงุนุงุฉ ุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ุงููุฎุชููุฉ: ุฅููุงู ุชุดุบูู ุงูุนูููุงุช ุทูููุฉ ุงููุฏู ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูุงูุชุนุงูู ูุน ุฃุญุฏุงุซ ุฏูุฑุฉ ุงูุญูุงุฉ ุ ูุฅูุบุงุก ุงูุงุดุชุฑุงูุงุช ุ ูุงูุนูุฏุฉ ุฅูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู.  ูู ุงูุนุงููู ุงููุงุถููู ุ ุฃุตุจุญุช RxJava ูุงุญุฏุฉ ูู ุงูุฃุทุฑ ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ูุญู ูุฐู ุงููุฌููุนุฉ ูู ุงููุดููุงุช.  ูู ูุฐู ุงูููุงูุฉ ุณุฃููู ุจุฅุฑุดุงุฏู ุฎูุงู ุชุฑุญูู ุงูููุฒุฉ ุงูุดุงููุฉ ูู RxJava ุฅูู coroutines. <br><a name="habracut"></a><br><h4 style=";text-align:right;direction:rtl">  ููุฒุฉ </h4><br>  ุงูููุฒุฉ ุงูุชู ุณูููู ุจุชุญููููุง ุฅูู coroutines ุจุณูุทุฉ ุฅูู ุญุฏ ูุง: ุนูุฏูุง ูุฑุณู ุงููุณุชุฎุฏู ุจูุฏูุง ุ ูููู ุจุฅุฌุฑุงุก ููุงููุฉ API ููุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุฏููุฉ ูุคููุฉ ููุจุญุซ ุนู ุชูุงุตูู ุงูุนูู ุนุจุฑ ูููุฑ ูุซู <a href="https://www.gov.uk/government/organisations/companies-house" rel="nofollow">Companies House</a> .  ุฅุฐุง ูุงูุช ุงูููุงููุฉ ูุงุฌุญุฉ ุ ูุณูุธูุฑ ุงูุฑุฏ ุ ุฅู ูู ููู - ุฑุณุงูุฉ ุงูุฎุทุฃ. <br><br><h4 style=";text-align:right;direction:rtl">  ูุฌุฑุฉ </h4><br><img src="https://habrastorage.org/webt/j0/0h/kg/j00hkgwjgnuwnzz4lsgdf5ry_fa.png" align="left"><br>  ุณูููู ุจุชุฑุญูู ุงูููุฏ ุงูุฎุงุต ุจูุง ุจุทุฑููุฉ ููุงุฆูุฉ ุชุจุฏุฃ ูู ุฎุฏูุฉ ุงูุชุญุฏูุซูุฉ ุ ูุงูุงูุชูุงู ุฅูู ุทุจูุฉ ุงููุณุชูุฏุน ุ ุซู ุฅูู ุทุจูุฉ ุงููุชูุงุนู ูุฃุฎูุฑุงู ุฅูู ViewModel. <br><br>  ุงููุธุงุฆู ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุญุงูููุง ูุฌุจ ุฃู ุชุตุจุญ ุงููุธููุฉ "ูุธุงุฆู ุงูุชุนููู" ูุงููุธุงุฆู ุงูุชู ุชูุฑุฌุน "ุงูููุงุญุธุฉ" ูุฌุจ ุฃู ุชูุฑุฌุน "ุงูุชุฏูู".  ูู ูุฐุง ุงููุซุงู ุจุงูุฐุงุช ุ ูู ููุนู ุฃู ุดูุก ูุน ุงูุชุฏููุงุช. <br><br><h4 style=";text-align:right;direction:rtl">  ุฎุฏูุฉ ุงูุชุญุฏูุซูุฉ </h4><br>  ุฏุนูุง ููุชูู ูุจุงุดุฑุฉ ุฅูู ุงูููุฏ ููุนูุฏ ูุฑุงุกุฉ ุทุฑููุฉ businessLookupEligibility ูู BusinessLookupService ุฅูู coroutines.  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ุชุจุฏู ุงูุขู. <br><br><pre style=";text-align:right;direction:rtl"><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"v1/eligibility"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Query(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"countryCode"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span></span>: Single&lt;NetworkResponse&lt;BusinessLookupEligibilityResponse, ErrorResponse&gt;&gt; }</code> </pre> <br>  ุฎุทูุงุช ุฅุนุงุฏุฉ ุงูุจูุงุก: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจุฏุกุงู ูู <a href="" rel="nofollow">ุงูุฅุตุฏุงุฑ 2.6.0</a> ูุฏุนู ุงูุชุนุฏูู ุงูุชุญุฏูุซู ูุนุฏู ุงูุชููู ุงููุฑุญูู.  ุฏุนูุง ูุญูู ุทุฑููุฉ businessLookupEligibility ุฅูู ูุธููุฉ ุชุนููู. </li><li style=";text-align:right;direction:rtl">  ูู ุจุฅุฒุงูุฉ ุจุฑูุงูุฌ ุงูุชูุงู ูุงุญุฏ ูู ููุน ุงูุฅุฑุฌุงุน. </li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"v1/eligibility"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Query(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"countryCode"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span></span>: NetworkResponse&lt;BusinessLookupEligibilityResponse, ErrorResponse&gt; }</code> </pre><br>  NetworkResponse ูู ูุฆุฉ ูุฎุชููุฉ ุชูุซู BusinessLookupEligibilityResponse ุฃู ErrorResponse.  ูุชู ุฅูุดุงุก NetworkResponse ูู ูุญูู ุงุณุชุฏุนุงุก ุงูุชุญุฏูุซูุฉ ูุฎุตุต.  ูุจูุฐู ุงูุทุฑููุฉ ุ ููุตุฑ ุชุฏูู ุงูุจูุงูุงุช ุนูู ุญุงูุชูู ูุญุชููุชูู ููุท - ุงููุฌุงุญ ุฃู ุงูุฎุทุฃ ุ ูุฐูู ูุง ุฏุงุนู ูููู ูุณุชูููู BusinessLookupService ุจุดุฃู ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุก. <br><br><h4 style=";text-align:right;direction:rtl">  ูุณุชูุฏุน </h4><br>  ุฏุนูุง ููุชูู ููุฑู ูุง ูุฏููุง ูู BusinessLookupRepository.  ูู ููุฆุฉ ุทุฑููุฉ businessLookupEligibility ุ ูุฏุนู businessLookupService.businessLookupEligibility (ุชูู ุงูุชู ูููุง ุจุฅุนุงุฏุฉ ุชุดููููุง ููุชู) ููุณุชุฎุฏู ูุดุบู ุฎุฑุงุฆุท RxJava ูุชุญููู NetworkResponse ุฅูู ูููุฐุฌ ุงุณุชุฌุงุจุฉ ูููุชุงุฆุฌ ูุงูุฎุฑุงุฆุท ููููุฐุฌ ุงููุฌุงู.  ุงููุชูุฌุฉ ูู ูุฆุฉ ูุฎุชููุฉ ุฃุฎุฑู ุชูุซู Result.Success ูุชุญุชูู ุนูู ูุงุฆู BusinessBooklEligibility ูู ุญุงูุฉ ูุฌุงุญ ุงุชุตุงู ุงูุดุจูุฉ.  ุฅุฐุง ุญุฏุซ ุฎุทุฃ ูู ุงุณุชุฏุนุงุก ุงูุดุจูุฉ ุฃู ุงุณุชุซูุงุก ุฅูุบุงุก ุงูุชุณูุณู ุฃู ุญุฏุซ ุฎุทุฃ ุขุฎุฑ ุ ูุณููุดุฆ Result.Failure ุจุฑุณุงูุฉ ุฎุทุฃ ุฐุงุช ูุนูู (ErrorMessage ูู <a href="https://kotlinlang.org/docs/reference/type-aliases.html" rel="nofollow">typealias</a> for String). <br><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupService: BusinessLookupService, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupApiToDomainMapper: BusinessLookupApiToDomainMapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> responseToString: Mapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> schedulerProvider: SchedulerProvider ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Single&lt;Result&lt;BusinessLookupEligibility, ErrorMessage&gt;&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> businessLookupService.businessLookupEligibility(countryCode) .map { response -&gt; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span><span class="hljs-symbol"><span class="hljs-symbol">@map</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (response) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Success -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibility = businessLookupApiToDomainMapper.map(response.body) Result.Success&lt;BusinessLookupEligibility, ErrorMessage&gt;(businessLookupEligibility) } <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Error -&gt; Result.Failure&lt;BusinessLookupEligibility, ErrorMessage&gt;( responseToString.transform(response) ) } }.subscribeOn(schedulerProvider.io()) } }</code> </pre><br>  ุฎุทูุงุช ุฅุนุงุฏุฉ ุงูุจูุงุก: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  businessLookupEligibility ุชุตุจุญ ูุธููุฉ ุชุนููู ูุคูุช. </li><li style=";text-align:right;direction:rtl">  ูู ุจุฅุฒุงูุฉ ุจุฑูุงูุฌ ุงูุชูุงู ูุงุญุฏ ูู ููุน ุงูุฅุฑุฌุงุน. </li><li style=";text-align:right;direction:rtl">  ุนุงุฏุฉู ูุง ุชููู ุงูุทุฑู ุงูููุฌูุฏุฉ ูู ุงููุณุชูุฏุน ุจููุงู ุทูููุฉ ุงูุฃูุฏ ูุซู ููุงููุงุช ุงูุดุจูุฉ ุฃู ุงุณุชุนูุงูุงุช ุงูุฏูุณูุจู.  ููุน ุนูู ุนุงุชู ุงููุณุชูุฏุน ูุณุคูููุฉ ุชุญุฏูุฏ ุงูุณูุณูุฉ ุงูุชู ูุฌุจ ุฃู ูุชู ูุฐุง ุงูุนูู ุนูููุง.  ูู ุฎูุงู subscribeOn (schedulerProvider.io ()) ุ ูุฅููุง ูุจูุบ RxJava ุจุฃูู ูุฌุจ ุงูููุงู ุจุงูุนูู ุนูู ูุคุดุฑ ุชุฑุงุจุท io.  ููู ูููู ุฃู ูุชุญูู ุงูุดูุก ููุณู ูุน coroutinesุ  ุณูุณุชุฎุฏู withContext ูุน ูุฑุณู ูุนูู ูุชุญููู ุชูููุฐ ุงููุชูุฉ ุฅูู ูุคุดุฑ ุชุฑุงุจุท ูุฎุชูู ูุงูุนูุฏุฉ ุฅูู ุงููุฑุณู ุงูุฃุตูู ุนูุฏ ุงูุชูุงู ุงูุชูููุฐ.  ุฅููุง ููุงุฑุณุฉ ุฌูุฏุฉ ููุชุฃูุฏ ูู ุฃู ุงููุธููุฉ ุขููุฉ ูู ุฎูุงู ุงุณุชุฎุฏุงู withContext.  ูุฌุจ ุนูู ูุณุชูููู BusinessLookupRepository ุฃูุง ูููุฑูุง ูู ุณูุณูุฉ ุงูุฑุณุงุฆู ุงูุชู ูุฌุจ ุนูููู ุงุณุชุฎุฏุงููุง ูุชูููุฐ ุทุฑููุฉ businessLookupEligibility ุ ูุฌุจ ุฃู ูููู ูู ุงูุขูู ุงุณุชุฏุนุงุกูุง ูู ุณูุณูุฉ ุงูุฑุณุงุฆู ุงูุฑุฆูุณูุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ูุนุฏ ูุญุชุงุฌ ุฅูู ูุดุบู ุงูุฎุฑูุทุฉ ุ ุญูุซ ูููููุง ุงุณุชุฎุฏุงู ูุชูุฌุฉ businessLookupService.businessLookupElibility ูู ุฌุณู ูุธููุฉ ุงูุชุนููู. </li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupService: BusinessLookupService, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupApiToDomainMapper: BusinessLookupApiToDomainMapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> responseToString: Mapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dispatcherProvider: DispatcherProvider ) { <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Result&lt;BusinessLookupEligibility, ErrorMessage&gt; = withContext(dispatcherProvider.io) { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> response = businessLookupService.businessLookupEligibility(countryCode)) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Success -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibility = businessLookupApiToDomainMapper.map(response.body) Result.Success&lt;BusinessLookupEligibility, ErrorMessage&gt;(businessLookupEligibility) } <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Error -&gt; Result.Failure&lt;BusinessLookupEligibility, ErrorMessage&gt;( responseToString.transform(response) ) } } }</code> </pre><br><h4 style=";text-align:right;direction:rtl">  interactor ู </h4><br>  ูู ูุฐุง ุงููุซุงู ุจุงูุชุญุฏูุฏ ุ ูุง ูุญุชูู BusinessLookupEligibilityInteractor ุนูู ุฃู ููุทู ุฅุถุงูู ููุนูู ููููู ูู BusinessLookupRepository.  ูุญู ูุณุชุฎุฏู ุงุณุชุฏุนุงุก <a href="https://kotlinlang.org/docs/reference/operator-overloading.html" rel="nofollow">ุนุงูู ุงูุชุญููู ุงูุฒุงุฆุฏ</a> ุจุญูุซ ูููู ุงุณุชุฏุนุงุก ุงููุชูุงุนู ูุฏุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupEligibilityInteractor</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupRepository: BusinessLookupRepository ) { <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Single&lt;Result&lt;BusinessLookupEligibility, ErrorMessage&gt;&gt; = businessLookupRepository.businessLookupEligibility(countryCode) }</code> </pre><br>  ุฎุทูุงุช ุฅุนุงุฏุฉ ุงูุจูุงุก: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุฏุนุงุก ุงููุดุบู ุงููุฑุญ ูุตุจุญ ุชุนููู ุงุณุชุฏุนุงุก ุงููุดุบู ุงููุฑุญ. </li><li style=";text-align:right;direction:rtl">  ูู ุจุฅุฒุงูุฉ ุจุฑูุงูุฌ ุงูุชูุงู ูุงุญุฏ ูู ููุน ุงูุฅุฑุฌุงุน. </li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupEligibilityInteractor</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupRepository: BusinessLookupRepository ) { <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Result&lt;BusinessLookupEligibility, ErrorMessage&gt; = businessLookupRepository.businessLookupEligibility(countryCode) }</code> </pre><br><h4 style=";text-align:right;direction:rtl">  ViewModel </h4><br>  ูู BusinessProfileViewModel ูุณูู BusinessLookupEligibilityInteractor ุจุฅุฑุฌุงุน Single.  ูุญู ูุดุชุฑู ูู ุงูุฏูู ูููุงุญุธู ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุชุญุฏูุฏ ุฌุฏููุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู.  ูู ุญุงูุฉ ุงููุฌุงุญ ุ ูููู ุจุชุนููู ุงููููุฉ ูู ูููุฐุฌ ูุฌุงู ุฅูู BusinessViewState LiveData.  ูู ุญุงูุฉ ุงููุดู ุ ูููู ุจุชุนููู ุฑุณุงูุฉ ุฎุทุฃ. <br><br>  ูุถูู ูู ุงุดุชุฑุงู ุฅูู CompositeDisposable ููุชุฎูุต ูููู ูู ุทุฑููุฉ onCleared () ูุฏูุฑุฉ ุญูุงุฉ ViewModel. <br><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessProfileViewModel</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibilityInteractor: BusinessLookupEligibilityInteractor, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> schedulerProvider: SchedulerProvider ) : ViewModel() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> disposables = CompositeDisposable() <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessViewState: MutableLiveData&lt;ViewState&gt; = LiveDataFactory.createDefault(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCountrySubmit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(country: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Country</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { disposables.add(businessLookupEligibilityInteractor(country.countryCode) .observeOn(schedulerProvider.ui()) .subscribe { state -&gt; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span><span class="hljs-symbol"><span class="hljs-symbol">@subscribe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (state) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Success -&gt; businessViewState.value = state.entity.provider <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Failure -&gt; businessViewState.value = state.failure } }) } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> void onCleared() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCleared(); disposables.clear(); } }</code> </pre><br>  ุฎุทูุงุช ุฅุนุงุฏุฉ ุงูุจูุงุก: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุจุฏุงูุฉ ุงูููุงู ุ ุฐูุฑุช ูุงุญุฏุฉ ูู ุงููุฒุงูุง ุงูุฑุฆูุณูุฉ ูู coroutines - ุงูุชุฒุงูู ุงูููุธู.  ูููุง ูุฃุชู ุฏูุฑ ุงููุนุจุฉ.  ูู coroutine ูุฏูู ูุทุงู.  ุงููุทุงู ูุฏูู ุงูุณูุทุฑุฉ ุนูู coroutine ุนุจุฑ ูุธููุชูุง.  ุฅุฐุง ุชู ุฅูุบุงุก ุงููุธููุฉ ุ ูุณูุชู ุฃูุถูุง ุฅูุบุงุก ุฌููุน ุงูุฎุทูุท ูู ุงููุทุงู ุงูููุงุจู.  ุฃูุช ุญุฑ ูู ุฅูุดุงุก ูุทุงูุงุช ุฎุงุตุฉ ุจู ุ ููู ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุณุชููุฏ ูู viewModelScope ุงููุฏุฑู ูุฏูุฑุฉ ุญูุงุฉ ุฏูุฑุฉ ุงูุญูุงุฉ.  ุณูุจุฏุฃ coroutine ุฌุฏูุฏ ูู viewModelScope ุจุงุณุชุฎุฏุงู viewModelScope.launch.  ุณูุชู ุฅุทูุงู coroutine ูู ุงูุฎูุท ุงูุฑุฆูุณู ูุฃู viewModelScope ูุฏูู ูุฑุณู ุงูุชุฑุงุถู - Dispatchers.Main.  ุจุฏุฃ coroutine ุนูู Dispatchers. ูู ูููู Main ุจุญุธุฑ ุงูุฎูุท ุงูุฑุฆูุณู ุฃุซูุงุก ุชุนูููู.  ูุธุฑูุง ูุฃููุง ุฃุทูููุง ููุชู coroutine ุ ูููููุง ุงุณุชุฏุนุงุก businessLookupEligibilityInteractor ุจุชุนููู ุงููุดุบู ูุงูุญุตูู ุนูู ุงููุชูุฌุฉ.  businessLookupEligibilityInteractor ูุณุชุฏุนู BusinessLookupRepository.businessLookupEligibility ูุง ูุญูู ุงูุชูููุฐ ุฅูู Dispatchers.IO ููุนูุฏ ุฅูู Dispatchers.Main.  ุจูุง ุฃููุง ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูููููุง ุชุญุฏูุซ businessViewState LiveData ุนู ุทุฑูู ุชุนููู ูููุฉ. </li><li style=";text-align:right;direction:rtl">  ูููููุง ุงูุชุฎูุต ูู ุงููุณุชูููุงุช ูุฃู viewModelScope ูุฑุชุจุท ุจุฏูุฑุฉ ุญูุงุฉ ViewModel.  ูุชู ุฅูุบุงุก ุฃู coroutine ุงูุฐู ุชู ุฅุทูุงูู ูู ูุฐุง ุงููุทุงู ุชููุงุฆููุง ุฅุฐุง ุชู ูุณุญ ViewModel. </li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessProfileViewModel</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibilityInteractor: BusinessLookupEligibilityInteractor ) : ViewModel() { <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessViewState: MutableLiveData&lt;ViewState&gt; = LiveDataFactory.createDefault(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCountrySubmit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(country: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Country</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { viewModelScope.launch { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> state = businessLookupEligibilityInteractor(country.countryCode)) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Success -&gt; businessViewState.value = state.entity.provider <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Failure -&gt; businessViewState.value = state.failure } } } }</code> </pre><br><h4 style=";text-align:right;direction:rtl">  ุงููุฌุจุงุช ุงูุณุฑูุนุฉ ุงูุฑุฆูุณูุฉ </h4><br>  ุฅู ูุฑุงุกุฉ ูููู ุงูููุฏ ุงูููุชูุจ ูุน coroutines ุณูู ููุบุงูุฉ ุ ููุน ุฐูู ููู ุชุญูู ูููุฐุฌู ูุชุทูุจ ุจุนุถ ุงูุฌูุฏ ูุชุนูู ููููุฉ ุงูุชุนุงูู ูุน ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุน coroutines. <br><br>  ูู ูุฐู ุงูููุงูุฉ ูู ุฃุบุทู ุงูุงุฎุชุจุงุฑ.  ููุฏ ุงุณุชุฎุฏูุช ููุชุจุฉ <a href="https://mockk.io/" rel="nofollow">mockk</a> ุญูุซ ูุงุฌูุช ูุดุงูู ูู ุงุฎุชุจุงุฑ coroutines ุจุงุณุชุฎุฏุงู Mockito. <br><br>  ูู ูุง ูุชุจุชู ุจุงุณุชุฎุฏุงู Rx Java ุ ูุฌุฏุชู ุณูู ุงูุชูููุฐ ูุน coroutines <a href="https://kotlinlang.org/docs/reference/coroutines/flow.html" rel="nofollow">ูุงูุชุฏููุงุช</a> <a href="https://kotlinlang.org/docs/reference/coroutines/channels.html" rel="nofollow">ูุงููููุงุช</a> .  ูุงุญุฏุฉ ูู ูุฒุงูุง coroutines ูู ุฃููุง ููุฒุฉ ูุบุฉ Kotlin ูุชุชุทูุฑ ุฌูุจุง ุฅูู ุฌูุจ ูุน ุงููุบุฉ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar483832/">https://habr.com/ru/post/ar483832/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar483818/index.html">ุงููุญุฑู ููุบุฉ ุงูุจุฑูุฌุฉ ูุงูุฑูุงูุฉ ุงูุจุตุฑูุฉ - ูู 45 ุณุงุนุฉ</a></li>
<li><a href="../ar483820/index.html">ูุง ูุคุซุฑ ุนูู ุฅุตุฏุงุฑ ุงูุงุฆุชูุงู. ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ููุฎุงุทุฑ ุงูุงุฆุชูุงู ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูููุงูุณุฉ</a></li>
<li><a href="../ar483824/index.html">ููููุฉ ุงูุญุตูู ุนูู ุนูู ุฃุญูุงูู ูุงูุชูููุฑ ุงูุฅูุฌุงุจู ูุงููุถู ูุฏูุงู ูู ุฐูู ุ ุจุนุฏ ุฃู ุฏุฑุณุช ุงูููุงุนุฏ ุงูุฎูุณุฉ ...</a></li>
<li><a href="../ar483828/index.html">ุชุฃูู ูุงูููุฑ ุงูุฐุฑู ููุงูุถุฉ</a></li>
<li><a href="../ar483830/index.html">ุงูุชูุฌูู ููุธุงู ุงูุชุดุบูู iOS: ุงูุชููู ุงูุนุงููู ุฏูู ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุชุทุจูู</a></li>
<li><a href="../ar483834/index.html">ุฏุจูุงู: ูุฌุฑุฏ ุชุญููู i386 ุฅูู amd64</a></li>
<li><a href="../ar483842/index.html">ุชุงุฑูุฎ ุฅูุดุงุก ุณุญุงุจุฉ ุงูููุฒู. ุงูุฌุฒุก 5. ุชุญุฏูุซ 2019 - PHP 7.2 ุ MariaDB 10.4 ู Nextcloud 17</a></li>
<li><a href="../ar483844/index.html">ุชุญููู ุงููุซุงุฆู ุงูุชูุธูููุฉ ุญูู ุญูุงูุฉ ุงููุนูููุงุช ูู ุงูุงุฆุชูุงู ุงูุฑูุณู ูุงููุทุงุน ุงููุงูู</a></li>
<li><a href="../ar483846/index.html">ูุงูุฐุฉ ุจุฏููุฉ ูุฅุฏุงุฑุฉ ููููุณ</a></li>
<li><a href="../ar483850/index.html">ูุง ุงูุขููุฉ ุญุฑู ุงูุฃูุงูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>