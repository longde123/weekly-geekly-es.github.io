<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>锔   Extensi贸n de macro Assert () para implementar un manejo m铆nimo de errores   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Se帽or, se me ocurri贸 una defensa del drag贸n". 隆Ya no nos tiene miedo! Se activa por el aleteo de las alas de un drag贸n y enciende una sirena ruidosa ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Extensi贸n de macro Assert () para implementar un manejo m铆nimo de errores</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439172/"> "Se帽or, se me ocurri贸 una defensa del drag贸n".  隆Ya no nos tiene miedo!  Se activa por el aleteo de las alas de un drag贸n y enciende una sirena ruidosa para que todos puedan escuchar al drag贸n acercarse. <br>  "驴Esta defensa hace algo m谩s?" <br>  "No, 驴por qu茅?"  隆Seremos advertidos! <br>  "S铆 ... Comido por las sirenas aullando ... Y sin embargo ... 驴recordarnos cu谩ndo hemos planeado interrupciones? ... <br><br><h3>  Descripci贸n del problema </h3><br>  Este m茅todo no pretende el concepto de manejo de errores en proyectos complejos y complejos.  M谩s bien, es un ejemplo de lo que se puede hacer con medios m铆nimos. <br><a name="habracut"></a><br>  Una buena norma es suponer que no se debe activar ninguna aserci贸n () durante la ejecuci贸n del programa.  Y si al menos una afirmaci贸n () funcion贸 al probar la aplicaci贸n, entonces debe enviar este error al desarrollador.  Pero, 驴qu茅 pasa si la aplicaci贸n no se prueba completamente?  驴Y afirmar () funcionar谩 para el cliente?  驴Enviar error al desarrollador?  驴Abortar un programa?  En realidad, esta ser谩 la versi贸n de lanzamiento de la aplicaci贸n y la aserci贸n est谩ndar () simplemente estar谩 deshabilitada.  La pregunta tambi茅n surge con la contradicci贸n interna del sistema: deber铆a haber una gran cantidad de afirmaci贸n () para facilitar la detecci贸n de errores, pero deber铆a haber menos afirmaci贸n () para interrumpir menos al usuario y su trabajo con la aplicaci贸n.  Especialmente no me gustar铆a "caer" si cu谩ntas personas usan la aplicaci贸n dependen de la estabilidad del trabajo y si afirmar () es esencialmente insignificante (requiere correcci贸n, pero permite, por ejemplo, continuar trabajando con bastante 茅xito). <br><br>  Tales consideraciones conducen a la necesidad de refinar afirmar () c / c ++.  Y defina sus propias macros que ampl铆en la funcionalidad del aserci贸n est谩ndar (), pero agregando un manejo m铆nimo de errores.  Que tales macros sean. <br><br>  <b>VERIFY_EXIT (condici贸n);</b> <b><br></b>  <b>VERIFY_RETURN (condici贸n, valor de retorno);</b> <b><br></b>  <b>VERIFY_THROW (condici贸n, excepci贸n);</b> <b><br></b>  <b>VERIFY_DO (condici贸n) {/ * fail block * /};</b> <br><br>  (Estas macros tambi茅n se pueden llamar de manera diferente. Por ejemplo, VERIFY_OR_EXIT (), VERIFY_OR_RETURN (), VERIFY_OR_THROW (), VERIFY_OR_DO (). O viceversa en una versi贸n m谩s corta). <br><br>  Estas macros, en primer lugar, tienen una implementaci贸n tanto para la versi贸n de depuraci贸n de la compilaci贸n como para la versi贸n de lanzamiento.  Eso les permite tener un comportamiento en la versi贸n de lanzamiento del programa.  Es decir  realizar acciones no solo durante las pruebas, sino tambi茅n con el usuario. <br><br><h3>  Descripci贸n macro </h3><br>  (La descripci贸n de las macros es aproximada, su otro dise帽o tambi茅n es posible). <br><br>  1) <b>VERIFY_EXIT (condici贸n);</b> <br><br>  Comprueba la <b>condici贸n de</b> condici贸n y, si es falsa, llama a la aserci贸n est谩ndar () (versi贸n de depuraci贸n) y tambi茅n sale de la funci贸n actual (versiones de depuraci贸n y liberaci贸n). <br><br>  2) <b>VERIFY_RETURN (condici贸n, valor de retorno);</b> <br><br>  Comprueba la <b>condici贸n de</b> condici贸n y, si es falsa, llama a la aserci贸n est谩ndar () (versi贸n de depuraci贸n), y tambi茅n sale de la funci贸n actual devolviendo <b>ReturnValue</b> (versiones de depuraci贸n y liberaci贸n). <br><br>  3) <b>VERIFY_THROW (condici贸n, excepci贸n);</b> <br><br>  Comprueba la <b>condici贸n de</b> condici贸n y, si es falsa, llama a la aserci贸n est谩ndar () (versi贸n de depuraci贸n) y tambi茅n genera una <b>excepci贸n</b> (versiones de depuraci贸n y liberaci贸n). <br><br>  4) <b>VERIFY_DO (condici贸n) {/ * fail block * /};</b> <br><br>  Comprueba la <b>condici贸n de</b> condici贸n y, si es falsa, llama a la aserci贸n est谩ndar () (versi贸n de depuraci贸n), y tambi茅n realiza un <b>bloqueo fallido</b> o una operaci贸n que sigue inmediatamente a la macro (versiones de depuraci贸n y liberaci贸n). <br><br>  Para todas las macros es importante: <br><br><ul><li>  En todos los casos, la <b>Condici贸n</b> debe ser verdadera para "pasar" la macro y falsa para activar la ruta de manejo m铆nimo de errores. </li><li>  Cada una de las macros implementa alg煤n m茅todo m铆nimo de manejo de errores.  Esto es necesario para implementar el comportamiento en caso de errores que no se detectaron durante la prueba, pero ocurrieron en el usuario.  Dependiendo de la implementaci贸n, puede informar al desarrollador sobre un error que ocurri贸 en el cliente, pero tambi茅n cada implementaci贸n proporciona una forma m铆nima de recuperarse de un error. </li></ul><br><h3>  Patrones de uso macro </h3><br>  Por supuesto, lo m谩s interesante es que los superhombres entrop铆a (h茅roes de la reducci贸n de errores en los programas) son el uso de estas macros. <br><br>  1) Condiciones previas y posteriores. <br><br>  El primer caso de uso es pre y post condiciones.  Perm铆tame recordarle que las condiciones previas verifican el estado del programa (argumentos de entrada, estado del objeto, variables utilizadas) para cumplir con los requisitos necesarios del fragmento de c贸digo ejecutado.  Las condiciones de publicaci贸n (son menos comunes en los programas) est谩n destinadas a verificar que hemos logrado el resultado deseado y que el estado de los objetos sigue siendo v谩lido para el fragmento de c贸digo actual. <br><br>  El uso de las macros propuestas es sencillo: asignamos cada verificaci贸n en una macro separada.  Seleccionamos macros en funci贸n del manejo de errores que necesitamos.  (VERIFY_EXIT () - error al procesar con la salida de esta funci贸n, VERIFY_RETURN () - error al procesar con la devoluci贸n de un valor, VERRIFY_THROW () - error al procesar con una excepci贸n, etc.) <br><br>  Tambi茅n puede agregar o usar la macro VERIFICAR (), que no har谩 ning煤n manejo de errores.  Esto puede ser 煤til, por ejemplo, en condiciones de publicaci贸n al final de una funci贸n. <br><br>  Estas macros son completamente autosuficientes si utiliza los principios del c贸digo puro y asigna suficientes funciones para implementar acciones at贸micas.  Cada funci贸n puede verificar el estado de un objeto, argumentos de entrada, etc.  para llevar a cabo su acci贸n at贸mica. <br><br>  2) Sem谩ntica de una transacci贸n. <br><br>  Adem谩s, estas macros se pueden usar para implementar c贸digo con sem谩ntica de transacciones.  Dicha sem谩ntica se entiende como: 1) preparaci贸n gradual para una operaci贸n con verificaci贸n de los resultados de cada una de las etapas de preparaci贸n;  2) la ejecuci贸n de la acci贸n solo si todas las etapas de preparaci贸n fueron exitosas;  3) negativa a cumplir, si no se cumplen algunas condiciones en la etapa de preparaci贸n (con un posible retroceso del cumplimiento). <br><br>  3) Dise帽o del c贸digo, teniendo en cuenta una posible extensi贸n. <br><br>  Esto es especialmente cierto para las bibliotecas y el c贸digo general, que inicialmente pueden desarrollarse dentro del contexto de una sola condici贸n de ejecuci贸n, y luego pueden comenzar a usarse con otras condiciones (comenzar a usarse de manera diferente).  En este caso, estas macros pueden describir los "l铆mites" de la funcionalidad del c贸digo.  Determine qu茅 fue visto inicialmente como un error y qu茅 fue exitoso.  (Este enfoque est谩 cerca de las condiciones pre post post cl谩sicas). Por supuesto, escribo los "bordes" entre comillas, porque  estos l铆mites pueden revisarse, pero es importante determinar (o m谩s bien transmitir a los futuros desarrolladores) el conocimiento de los l铆mites aceptables del dise帽o del c贸digo. <br><br><h3>  Implementaci贸n macro </h3><br>  Supongo que la mayor铆a de los desarrolladores de nivel medio no tendr谩n problemas para implementar estas macros.  Pero si necesita informaci贸n, dedicar茅 algunos puntos importantes. <br><br>  Las macros deben ser representables como una sola declaraci贸n.  驴Qu茅 se puede hacer con do {} while (false) construcciones o similares.  Por ejemplo, as铆: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VERFY_EXIT(cond) \ do{bool _= (bool)(cond); assert(_); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(!_) {return;}} while(false) \ </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*end macro VERIFY_EXIT()*/</span></span></span></span></code> </pre> <br>  Entonces puedes escribir el siguiente c贸digo: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) VERIFY_EXIT(a%<span class="hljs-number"><span class="hljs-number">2</span></span>==<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre> <br>  Por supuesto, esta es solo una de las posibilidades de implementaci贸n.  Puede implementar macros de otras maneras. <br><br>  PD: 隆Batalla exitosa con entrop铆a, superhombres! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439172/">https://habr.com/ru/post/439172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439160/index.html">Estado del algoritmo: 驴qu茅 les sucede a los desarrolladores independientes en Steam?</a></li>
<li><a href="../439162/index.html">C贸mo depurar frontend y backend: instrucciones paso a paso</a></li>
<li><a href="../439166/index.html">mmWave en camino a la comercializaci贸n en el formato de tel茅fono inteligente</a></li>
<li><a href="../439168/index.html">Sistemas de an谩lisis de clientes</a></li>
<li><a href="../439170/index.html">Los operadores celulares ayudar谩n a los bancos a verificar la precisi贸n de los datos del cliente</a></li>
<li><a href="../439174/index.html">D铆a seguro de Internet: qu茅 amenazas buscar en 2019</a></li>
<li><a href="../439176/index.html">Enviar un correo electr贸nico con archivos adjuntos por JavaMailSender de SpringFramework</a></li>
<li><a href="../439180/index.html">Rekko Challenge</a></li>
<li><a href="../439182/index.html">C贸mo distribuimos los pedidos entre los conductores en Yandex.Taxi</a></li>
<li><a href="../439184/index.html">Cambie su contrase帽a: prueba de pol铆ticas de contrase帽a del servicio web</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>