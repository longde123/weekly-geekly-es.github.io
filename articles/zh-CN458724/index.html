<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖍️ 🎐 🚶 神经网络和深度学习，第3章，第1部分：改进神经网络的训练方式 🏈 💇🏿 🤪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="目录内容 

- 第1章：使用神经网络识别手写数字 
- 第2章：反向传播算法如何工作 
- 第三章 第1部分：改进训练神经网络的方法 第2部分：为什么进行正则化有助于减少再培训？ 第3部分：如何选择神经网络超参数？ 
- 第1部分：改进训练神经网络的方法 
- 第2部分：为什么进行正则化有助于减少...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>神经网络和深度学习，第3章，第1部分：改进神经网络的训练方式</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458724/"><div class="spoiler">  <b class="spoiler_title">目录内容</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1章：使用神经网络识别手写数字</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2章：反向传播算法如何工作</a> </li><li> 第三章 <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1部分：改进训练神经网络的方法</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分：为什么进行正则化有助于减少再培训？</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分：如何选择神经网络超参数？</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第4章：视觉证明神经网络能够计算任何功能</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第5章：为什么深度神经网络这么难训练？</a> </li><li> 第6章 <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1部分：深度学习</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分：图像识别的最新进展</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">后记：有没有简单的算法可以创造情报？</a> </li></ul></div></div><br> 当一个人学习打高尔夫球时，他通常会花费大部分时间进行基本击球。 然后，他根据基本的打击逐渐发展出其他打击，并研究这些技巧。 同样，到目前为止，我们一直专注于了解反向传播算法。 这是我们的“基本罢工”，是使用神经网络（NS）进行大多数工作培训的基础。 在本章中，我将讨论一组可用于改进反向传播的更简单实现以及改进NS教学方法的技术。 <br><br> 我们将在本章中学习的技术包括：成本函数作用的最佳选择，即具有交叉熵的成本函数； 四个所谓 正则化方法（L1和L2的正则化，神经元的排除[辍学]，训练数据的人工扩展），可提高我们NS在训练数据之外的通用性； 初始化网络权重的最佳方法； 一组启发式方法，可帮助您为网络选择良好的超参数。 我还将在表面上考虑其他几种技术。 在大多数情况下，这些讨论是相互独立的，因此您可以根据需要跳过它们。 我们还在工作代码中实现了许多技术，并使用它们来改进为手写数字分类任务所获得的结果，这在第1章中进行了研究。 <br><a name="habracut"></a><br> 当然，我们只考虑为神经网络开发的大量技术中的一小部分。 最重要的是，进入大量可用技术领域的最佳方法是详细研究一些最重要的技术。 掌握这些重要的技术本身不仅有用，而且还将加深您对使用神经网络时可能出现的问题的理解。 因此，您将准备根据需要快速适应新技术。 <br><br><h2> 交叉熵成本函数 </h2><br> 我们大多数人都不喜欢错。 开始学习钢琴后不久，我在观众面前举行了一场小型音乐会。 我很紧张，开始演奏比需要低八度的乐曲。 我很困惑，直到有人向我指出一个错误，我才能继续。 我很as愧。 但是，尽管这很不愉快，但我们还是很快就学到了，认为我们错了。 当然，下次我与观众交谈时，我会以正确的八度演奏！ 相反，如果我们的错误定义不明确，我们的学习速度就会变慢。 <br><br> 理想情况下，我们希望神经网络能够从错误中快速学习。 在实践中会发生这种情况吗？ 为了回答这个问题，让我们看一个牵强的例子。 它涉及一个只有一个输入的神经元： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/711/536/586/711536586b63bd594c00d3ade2e88580.png"><br><br> 我们正在教这个神经元做一件非常简单的事情：接受1并给0。当然，我们可以通过手动选择权重和偏移量而无需使用训练算法，来找到这样一个琐碎问题的解决方案。 然而，尝试使用梯度下降来获得重量和位移是非常有用的。 让我们看看神经元是如何训练的。 <br><br> 为了确定性，我将选择0.6的初始权重和0.9的初始偏移量。 这些是分配给起点的一些常规值，我没有特别选择它们。 最初，输出神经元产生0.82，因此我们需要学习很多知识才能接近期望的输出0.0。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">原始文章</a>具有一个交互式表单，您可以在该表单上单击“运行”并观察学习过程。 该动画没有预先录制，浏览器实际上是计算渐变，然后使用它来更新权重和偏移并显示结果。 学习速度为η= 0.15，足够慢，可以看到正在发生的事情，但足够快，可以在几秒钟内完成学习。 在第一章中介绍了成本函数C是二次方的。 我会很快提醒您其确切的形式，因此没有必要再来这里找回。 只需单击“运行”按钮，即可多次开始训练。 <br><br> 如您所见，神经元快速学习了权重和偏见，从而降低了成本，并提供了0.09的输出。 这不是0.0的理想结果，但是很好。 假设我们选择初始权重和偏移量为2.0。 在这种情况下，初始输出将为0.98，这是完全错误的。 让我们看看在这种情况下神经元将如何学习产生0。 <br><br> 尽管此示例使用相同的学习率（η= 0.15），但我们看到学习速度较慢。 在最初的大约150个时期，重量和位移几乎不变。 然后训练加速，几乎和第一个示例一样，神经元迅速移动到0.0。 这种行为很奇怪，不喜欢学习一个人。 正如我在开始时所说的，当我们非常错误时，我们经常会学习得最快。 但是，我们只是看到了人造神经元如何非常困难地学习，犯了很多错误-比他犯了一点错误时要困难得多。 而且，事实证明，这种行为不仅在我们的简单示例中出现，而且在更通用的NS中出现。 为什么学习这么慢？ 我可以找到避免这种问题的方法吗？ <br><br> 为了理解问题的根源，我们记得我们的神经元通过重量和位移的变化来学习，其速率由成本函数theC /∂w和∂C/∂b的偏导数确定。 因此，说“学习缓慢”与说这些偏导数很小是相同的。 问题在于了解为什么它们很小。 为此，让我们计算偏导数。 回想一下，我们使用由等式（6）给出的二次成本函数： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mrow" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">（</font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"> y </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-15"><span class="MJXp-mrow" id="MJXp-Span-16" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">）</font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-15"><span class="MJXp-mn MJXp-script" id="MJXp-Span-18" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"> 2</font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mn" id="MJXp-Span-20"><font style="vertical-align: inherit;"> 2</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"> t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-25"><span class="MJXp-mn" id="MJXp-Span-26"><font style="vertical-align: inherit;">54</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-4">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mrow" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-15"><span class="MJXp-mrow" id="MJXp-Span-16" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-18" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mn" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-25"><span class="MJXp-mn" id="MJXp-Span-26"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.398ex" height="2.901ex" viewBox="0 -987.6 11796.4 1249" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-3D" x="1038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-66" x="2344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-72" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="3346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-63" x="3876" y="0"></use><g transform="translate(4309,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-79" x="829" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2212" x="1549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="2550" y="0"></use><g transform="translate(3079,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-32" x="1173" y="640"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-32" x="8673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-74" x="9423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="9785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-67" x="10314" y="0"></use><g transform="translate(10795,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-34" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> C = \ frac {（y-a）^ 2} {2} \ tag {54} </script></p><br><br> 其中a是在输入处使用x = 1时的神经元输出，而y = 0是所需的输出。 要直接通过重量和位移来写，请记住a =σ（z），其中z = wx + b。 使用链式规则通过重量和位移进行区分，我们获得： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-27"><span class="MJXp-mtext" id="MJXp-Span-28">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">˚F </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ř </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mrow" id="MJXp-Span-33"><span class="MJXp-mtext" id="MJXp-Span-34" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\部</font></font></span><span class="MJXp-mrow" id="MJXp-Span-35"><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ç </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-38"><span class="MJXp-mtext" id="MJXp-Span-39" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\部</font></font></span><span class="MJXp-mrow" id="MJXp-Span-40"><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瓦特</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mrow" id="MJXp-Span-44"><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ý </font></font></span><span class="MJXp-mrow" id="MJXp-Span-49"><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"> š </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;">我</font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;">克</font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;">米</font></span><span class="MJXp-msup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">一个</font></span></span><span class="MJXp-msup" id="MJXp-Span-56"><span class="MJXp-mo MJXp-script" id="MJXp-Span-58" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">“ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">（</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"> ż </font></span><span class="MJXp-mrow" id="MJXp-Span-62"><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">）</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"> X </font></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;">一个</font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;">小号</font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;">我</font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;">克</font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;">米</font></span><span class="MJXp-msup" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">一个</font></span></span><span class="MJXp-msup" id="MJXp-Span-72"><span class="MJXp-mo MJXp-script" id="MJXp-Span-74" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">” </font></span></span><span class="MJXp-mrow" id="MJXp-Span-75"><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">（</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;"> ż </font></span><span class="MJXp-mrow" id="MJXp-Span-78"><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">）</font></span></span><span class="MJXp-mtext" id="MJXp-Span-80" style="color: red;"><font style="vertical-align: inherit;"> \标</font></span><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">签</font></span></span><span class="MJXp-mrow" id="MJXp-Span-83"><span class="MJXp-mn" id="MJXp-Span-84"><font style="vertical-align: inherit;">55</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-51">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-58" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-62"><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-67">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msup" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-74" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-75"><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-78"><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-80" style="color: red;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-83"><span class="MJXp-mn" id="MJXp-Span-84"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.767ex" height="2.78ex" viewBox="0 -883.9 29608 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><g fill="red" stroke="red"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">部</text></g></g><g transform="translate(1330,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">分</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-43" x="2160" y="0"></use></g><g transform="translate(5135,0)"><g fill="red" stroke="red"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">部</text></g></g><g transform="translate(1330,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">分</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-77" x="2160" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-3D" x="8290" y="0"></use><g transform="translate(9346,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="10176" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2212" x="10928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-79" x="11929" y="0"></use><g transform="translate(12426,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-73" x="13506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-69" x="13976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-67" x="14321" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-6D" x="14802" y="0"></use><g transform="translate(15680,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2032" x="748" y="583"></use></g><g transform="translate(16505,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-7A" x="17335" y="0"></use><g transform="translate(17803,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-78" x="18633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-3D" x="19483" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="20540" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-73" x="21319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-69" x="21789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-67" x="22134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-6D" x="22615" y="0"></use><g transform="translate(23493,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2032" x="748" y="583"></use></g><g transform="translate(24318,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-7A" x="25148" y="0"></use><g transform="translate(25616,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g fill="red" stroke="red" transform="translate(26446,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">标</text></g></g><g transform="translate(27776,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">签</text></g><g transform="translate(28606,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-35" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ frac {\部分C} {\部分w} =（a-y）\ sigma'（z）x = a \ sigma'（z）\标签{55} </script></p><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-85"><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">c</span><span class="MJXp-mrow" id="MJXp-Span-91"><span class="MJXp-mtext" id="MJXp-Span-92" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-93"><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">C</span></span><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mtext" id="MJXp-Span-97" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-98"><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">b</span></span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-102"><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">a</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">y</span><span class="MJXp-mrow" id="MJXp-Span-107"><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-109">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">m</span><span class="MJXp-msup" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-116" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">z</span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">a</span><span class="MJXp-mtext" id="MJXp-Span-124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">m</span><span class="MJXp-msup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-131" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-132"><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">z</span><span class="MJXp-mrow" id="MJXp-Span-135"><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-137" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-138"><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-140"><span class="MJXp-mn" id="MJXp-Span-141">56</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.771ex" height="2.78ex" viewBox="0 -883.9 28748.5 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><g fill="red" stroke="red"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">部</text></g></g><g transform="translate(1330,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">分</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-43" x="2160" y="0"></use></g><g transform="translate(5135,0)"><g fill="red" stroke="red"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">部</text></g></g><g transform="translate(1330,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">分</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-62" x="2160" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-3D" x="8003" y="0"></use><g transform="translate(9059,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="9889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2212" x="10641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-79" x="11642" y="0"></use><g transform="translate(12139,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-73" x="13219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-69" x="13689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-67" x="14034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-6D" x="14515" y="0"></use><g transform="translate(15393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2032" x="748" y="583"></use></g><g transform="translate(16218,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-7A" x="17048" y="0"></use><g transform="translate(17516,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-3D" x="18624" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="19680" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-73" x="20460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-69" x="20929" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-67" x="21275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-6D" x="21755" y="0"></use><g transform="translate(22634,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-2032" x="748" y="583"></use></g><g transform="translate(23458,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMATHI-7A" x="24288" y="0"></use><g transform="translate(24757,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g fill="red" stroke="red" transform="translate(25587,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">标</text></g></g><g transform="translate(26917,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">签</text></g><g transform="translate(27747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhj0-JIqkRSWs8gbMlWbKHPWSoTIHg#MJMAIN-36" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> \ frac {\部分C} {\部分b} =（a-y）\ sigma'（z）= a \ sigma'（z）\标签{56} </script></p><br><br> 我将x = 1替换为y = 0。 要了解这些表达式的行为，让我们仔细看一下右边的σ'（z）。 回想一下S型的形状： <br><br><img src="https://habrastorage.org/webt/qp/md/8t/qpmd8tvjtjws0nis2rfaxcv59x8.png"><br><br> 该图显示，当神经元的输出接近1时，曲线变得非常平坦，并且σ'（z）变小。 式（55）和（56）告诉我们，∂C/∂w和∂C/∂b变得很小。 因此学习减慢。 而且，正如我们稍后会看到的，事实上，出于同样的原因，并且在国民议会中，培训的放缓是发生的，而且这种情况更为笼统，而不仅仅是我们最简单的例子。 <br><br><h2> 引入交叉熵成本函数 </h2><br> 我们如何减慢学习速度？ 事实证明，我们可以通过用另一个值函数（称为交叉熵）代替值的二次函数来解决问题。 为了理解交叉熵，我们离开了最简单的模型。 假设我们训练具有多个输入值x <sub>1</sub> ，x <sub>2</sub> ，...，相应权重w <sub>1</sub> ，w <sub>2</sub> ，...和偏移b的神经元： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5e/9a8/ddf/a5e9a8ddf40b507400692516269bd632.png"><br><br> 当然，神经元的输出将是a =σ（z），其中z = ∑ <sub>j</sub> w <sub>j</sub> x <sub>j</sub> + b是输入的加权和。 我们将给定神经元的交叉熵代价函数定义为 <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">C</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">c</span><span class="MJXp-mrow" id="MJXp-Span-151"><span class="MJXp-mn" id="MJXp-Span-152">1</span></span><span class="MJXp-mrow" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">n</span></span><span class="MJXp-mtext" id="MJXp-Span-155">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">u</span><span class="MJXp-msubsup" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-160" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">t</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">y</span><span class="MJXp-mtext" id="MJXp-Span-168">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">a</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-173"><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-175">1</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">y</span><span class="MJXp-mrow" id="MJXp-Span-178"><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">n</span><span class="MJXp-mrow" id="MJXp-Span-183"><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-185">1</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">a</span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">t</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-197" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-200"><span class="MJXp-mn" id="MJXp-Span-201">57</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> C =-\ frac {1} {n} \ sum_x \ left [y \ ln a +（1-y）\ ln（1-a）\ right] \标签{57} </script></p><br><br> 其中n是训练数据的单位总数，总和遍及所有训练数据x，y是相应的期望输出。 <br><br> 方程（57）解决学习速度减慢的问题并不明显。 坦白说，称其为价值功能还不是很明显！ 在转向学习减慢之前，让我们看看在什么意义上交叉熵可以解释为价值的函数。 <br><br> 特别是有两个属性，可以合理地将交叉熵解释为值的函数。 首先，它大于零，即C&gt; 0。 要看到这一点，请注意（a）（57）中总和的所有单个成员均为负，因为两个对数均取自0到1范围内的数字，并且（b）负号位于总和之前。 <br><br> 其次，如果神经元的实际输出接近所有训练输入x的期望输出，则交叉熵将接近零。 为了证明这一点，我们需要假设期望的输出y为0或1。通常在解决分类问题或计算布尔函数时会发生这种情况。 要了解如果不做这样的假设会发生什么，请参考本节末尾的练习。 <br><br> 为了证明这一点，假设对于某些输入x，y = 0且a≈0。 因此，神经元可以很好地处理此类输入。 我们看到，由于y = 0，因此表达式（57）的第一项消失了，而第二项将是-ln（1-a）≈0。 当y = 1且a≈1时，也是如此。 因此，如果实际输出接近期望值，则价值贡献将很小。 <br><br> 综上所述，我们得到交叉熵为正，并且当神经元更好地计算所有训练输入x的期望输出y时，交叉熵趋于零。 我们期望成本函数中同时存在这两个属性。 实际上，这两个属性都可以通过二次值来满足。 因此，对于交叉熵来说是个好消息。 但是，交叉熵代价函数具有优势，因为与二次值不同，它避免了学习速度变慢的问题。 为了看到这一点，让我们计算权重与交叉熵的值的偏导数。 代入（57）中的a =σ（z），应用链式规则两次，得到 <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-202"><span class="MJXp-mtext" id="MJXp-Span-203">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">c</span><span class="MJXp-mrow" id="MJXp-Span-208"><span class="MJXp-mtext" id="MJXp-Span-209" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">C</span></span><span class="MJXp-mrow" id="MJXp-Span-213"><span class="MJXp-mtext" id="MJXp-Span-214" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-215"><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-219" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">c</span><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mn" id="MJXp-Span-228">1</span></span><span class="MJXp-mrow" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">n</span></span><span class="MJXp-mtext" id="MJXp-Span-231">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">u</span><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-236" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-237">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">t</span><span class="MJXp-mrow" id="MJXp-Span-242"><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-244">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">c</span><span class="MJXp-mrow" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">y</span></span><span class="MJXp-mrow" id="MJXp-Span-251"><span class="MJXp-mtext" id="MJXp-Span-252">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">a</span><span class="MJXp-mrow" id="MJXp-Span-258"><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">z</span><span class="MJXp-mrow" id="MJXp-Span-261"><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">c</span><span class="MJXp-mrow" id="MJXp-Span-269"><span class="MJXp-mrow" id="MJXp-Span-270"><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-272">1</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">y</span><span class="MJXp-mrow" id="MJXp-Span-275"><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-277"><span class="MJXp-mn" id="MJXp-Span-278">1</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">a</span><span class="MJXp-mrow" id="MJXp-Span-286"><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">z</span><span class="MJXp-mrow" id="MJXp-Span-289"><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mtext" id="MJXp-Span-291" style="color: red;">\右</span><span class="MJXp-mrow" id="MJXp-Span-292"><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">c</span><span class="MJXp-mrow" id="MJXp-Span-299"><span class="MJXp-mtext" id="MJXp-Span-300" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mtext" id="MJXp-Span-303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">a</span></span><span class="MJXp-mrow" id="MJXp-Span-309"><span class="MJXp-mtext" id="MJXp-Span-310" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-311"><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-316" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-317"><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-319"><span class="MJXp-mn" id="MJXp-Span-320">58</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ frac {\部分C} {\部分w_j} =-\ frac {1} {n} \ sum_x \ left（\ frac {y} {\ sigma（z）}-\ frac {（1-y）} {1- \ sigma（z）} \右）\ frac {\部分\ sigma} {\部分w_j} \标签{58} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-321"><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">c</span><span class="MJXp-mrow" id="MJXp-Span-329"><span class="MJXp-mn" id="MJXp-Span-330">1</span></span><span class="MJXp-mrow" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">n</span></span><span class="MJXp-mtext" id="MJXp-Span-333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">u</span><span class="MJXp-msubsup" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-338" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">t</span><span class="MJXp-mrow" id="MJXp-Span-344"><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">c</span><span class="MJXp-mrow" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">y</span></span><span class="MJXp-mrow" id="MJXp-Span-353"><span class="MJXp-mtext" id="MJXp-Span-354">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">a</span><span class="MJXp-mrow" id="MJXp-Span-360"><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">z</span><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">c</span><span class="MJXp-mrow" id="MJXp-Span-371"><span class="MJXp-mrow" id="MJXp-Span-372"><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-374">1</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">y</span><span class="MJXp-mrow" id="MJXp-Span-377"><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-mn" id="MJXp-Span-380">1</span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">a</span><span class="MJXp-mrow" id="MJXp-Span-388"><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">z</span><span class="MJXp-mrow" id="MJXp-Span-391"><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mtext" id="MJXp-Span-393">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">t</span><span class="MJXp-mrow" id="MJXp-Span-399"><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">m</span><span class="MJXp-msup" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-408" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-409"><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">z</span><span class="MJXp-mrow" id="MJXp-Span-412"><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-416" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-417" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-418"><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.278em; margin-right: 0.278em;">记</span></span><span class="MJXp-mrow" id="MJXp-Span-420"><span class="MJXp-mn" id="MJXp-Span-421">59</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> =-\ frac {1} {n} \ sum_x \ left（\ frac {y} {\ sigma（z）}-\ frac {（1-y）} {1- \ sigma（z）} \ right） \ sigma'（z）x_j \标记{59} </script></p><br><br> 简化为一个公分母并进行简化，我们得到： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-422"><span class="MJXp-mtext" id="MJXp-Span-423">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">c</span><span class="MJXp-mrow" id="MJXp-Span-428"><span class="MJXp-mtext" id="MJXp-Span-429" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-430"><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">C</span></span><span class="MJXp-mrow" id="MJXp-Span-433"><span class="MJXp-mtext" id="MJXp-Span-434" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-435"><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-439" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">c</span><span class="MJXp-mrow" id="MJXp-Span-446"><span class="MJXp-mn" id="MJXp-Span-447">1</span></span><span class="MJXp-mrow" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">n</span></span><span class="MJXp-mtext" id="MJXp-Span-450">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">u</span><span class="MJXp-msubsup" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-455" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">c</span><span class="MJXp-mrow" id="MJXp-Span-461"><span class="MJXp-mtext" id="MJXp-Span-462">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">m</span><span class="MJXp-msup" id="MJXp-Span-467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-469" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-470"><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">z</span><span class="MJXp-mrow" id="MJXp-Span-473"><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-477" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-478"><span class="MJXp-mtext" id="MJXp-Span-479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">a</span><span class="MJXp-mrow" id="MJXp-Span-485"><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">z</span><span class="MJXp-mrow" id="MJXp-Span-488"><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-490"><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-492">1</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-494">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">a</span><span class="MJXp-mrow" id="MJXp-Span-500"><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">z</span><span class="MJXp-mrow" id="MJXp-Span-503"><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-505"><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-507"><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-509">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">a</span><span class="MJXp-mrow" id="MJXp-Span-515"><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">z</span><span class="MJXp-mrow" id="MJXp-Span-518"><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">y</span><span class="MJXp-mrow" id="MJXp-Span-522"><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-524"><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.278em; margin-right: 0.278em;">。</span></span><span class="MJXp-mtext" id="MJXp-Span-526" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-527"><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0.278em; margin-right: 0.278em;">记</span></span><span class="MJXp-mrow" id="MJXp-Span-529"><span class="MJXp-mn" id="MJXp-Span-530">60</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> \ frac {\部分C} {\部分w_j} = \ frac {1} {n} \ sum_x \ frac {\ sigma'（z）x_j} {\ sigma（z）（1- \ sigma（z）） }（\ sigma（z）-y）。 \标记{60} </script></p><br><br> 使用sigmoid的定义σ（z）= 1 /（1 + e <sup>−z</sup> ）和一些代数，我们可以证明σ′（z）=σ（z）（1-σ（z））。 我将要求您在练习中进一步验证这一点，但现在，将其作为事实接受。 项σ（z）和σ（z）（1 −σ（z））被抵消，这导致 <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-531"><span class="MJXp-mtext" id="MJXp-Span-532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">c</span><span class="MJXp-mrow" id="MJXp-Span-537"><span class="MJXp-mtext" id="MJXp-Span-538" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-539"><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">C</span></span><span class="MJXp-mrow" id="MJXp-Span-542"><span class="MJXp-mtext" id="MJXp-Span-543" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-544"><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-548" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">c</span><span class="MJXp-mrow" id="MJXp-Span-555"><span class="MJXp-mn" id="MJXp-Span-556">1</span></span><span class="MJXp-mrow" id="MJXp-Span-557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">n</span></span><span class="MJXp-mtext" id="MJXp-Span-559">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">u</span><span class="MJXp-msubsup" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-564" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-567" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-568"><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-570">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">a</span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">z</span><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">y</span><span class="MJXp-mrow" id="MJXp-Span-583"><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.278em; margin-right: 0.278em;">。</span></span><span class="MJXp-mtext" id="MJXp-Span-587" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-588"><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.278em; margin-right: 0.278em;">记</span></span><span class="MJXp-mrow" id="MJXp-Span-590"><span class="MJXp-mn" id="MJXp-Span-591">61</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> \ frac {\部分C} {\部分w_j} = \ frac {1} {n} \ sum_x x_j（\ sigma（z）-y）。 \标记{61} </script></p><br><br> 很棒的表情。 由此得出，训练配重的速度受σ（z）-y的控制，即受输出误差的控制。 误差越大，神经元学习越快。 可以直观地预期到这一点。 该选项避免了在类似的二次成本方程式（55）中由术语σ'（z）引起的学习速度下降。 当我们使用交叉熵时，σ'（z）项减少了，我们不再需要担心它的小。 这种减少是交叉熵代价函数所保证的特殊奇迹。 实际上，当然，这并不是一个奇迹。 稍后我们将看到，为此属性特别选择了交叉熵。 <br><br> 类似地，可以计算偏差的偏导数。 我不会再提供所有详细信息，但是您可以轻松地检查一下 <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-592"><span class="MJXp-mtext" id="MJXp-Span-593">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">c</span><span class="MJXp-mrow" id="MJXp-Span-598"><span class="MJXp-mtext" id="MJXp-Span-599" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-600"><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">C</span></span><span class="MJXp-mrow" id="MJXp-Span-603"><span class="MJXp-mtext" id="MJXp-Span-604" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-605"><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">b</span></span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-609">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">c</span><span class="MJXp-mrow" id="MJXp-Span-614"><span class="MJXp-mn" id="MJXp-Span-615">1</span></span><span class="MJXp-mrow" id="MJXp-Span-616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">n</span></span><span class="MJXp-mtext" id="MJXp-Span-618">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">u</span><span class="MJXp-msubsup" id="MJXp-Span-621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-623" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mrow" id="MJXp-Span-624"><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-626">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">a</span><span class="MJXp-mrow" id="MJXp-Span-632"><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">z</span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">y</span><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-641"><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0.278em; margin-right: 0.278em;">。</span></span><span class="MJXp-mtext" id="MJXp-Span-643" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-644"><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0.278em; margin-right: 0.278em;">记</span></span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mn" id="MJXp-Span-647">62</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ frac {\部分C} {\部分b} = \ frac {1} {n} \ sum_x（\ sigma（z）-y）。 \标记{62} </script></p><br><br> 这再次有助于避免由于平方值（56）的类似方程中的σ'（z）而导致学习延迟。 <br><br><h3> 锻炼身体 </h3><br><ul><li> 检查σ'（z）=σ（z）（1-σ（z））。 </li></ul><br><br> 让我们回到我们之前玩过的牵强的示例，看看如果使用交叉熵而不是二次值会发生什么。 为了进行调整，我们从当初始权重为0.6且偏移为0.9时二次成本完美运行的情况开始。 原始文章具有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">交互式形式</a> ，您可以在其中单击“运行”按钮，查看用交叉熵替换二次值时会发生什么。 <br><br> 毫不奇怪，在这种情况下，神经元像以前一样被完美地训练。 现在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">让我们看一下</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">神经元曾经被卡住的情况</a> ，重量和位移从2.0开始。 <br><br><img src="https://habrastorage.org/webt/mg/xt/bb/mgxtbb83sfsoikt345v4hukgpmi.png"><br><br> 成功！ 这次，神经元如我们所愿迅速学会了。 如果仔细观察，您会发现成本曲线的斜率最初比相应的二次值曲线的平坦区域陡。 这种越野熵给我们带来了凉爽，也不会让我们陷于我们期望神经元以最快的速度开始训练时所犯的错误非常严重的地方。 <br><br> 我没有说在最后的例子中使用什么训练速度。 之前，我们使用二次值η= 0.15。 在新示例中，我们应该使用相同的速度吗？ 实际上，改变成本函数，不可能确切地说出使用“相同”学习速度的含义。 这将是苹果与橙子的比较。 对于这两种成本函数，我通过寻找一种学习速度来进行实验，该速度可以让我看到正在发生的事情。 如果您仍然感兴趣，则在最新示例中，η= 0.005。 <br><br> 您可能会争辩说，改变学习速度会使图形失去意义。 如果我们可以任意选择学习速度，谁会关心神经元学习的速度呢？ 但是，这一反对意见没有考虑要点。 图形的含义不是学习的绝对速度，而是学习速度的变化方式。 使用二次函数时，如果神经元非常错误，则训练速度会变慢，而当神经元接近所需答案时，训练速度会变快。 利用交叉熵，当神经元犯了一个大错误时，学习会更快。 这些陈述不依赖于给定的学习速度。 <br><br> 我们检查了一个神经元的交叉熵。 但是，这很容易推广到具有许多层和许多神经元的网络。 假设y = y <sub>1</sub> ，y <sub>2</sub> ，...是输出神经元（即最后一层的神经元）的期望值，而<sup>L</sup> <sub>1</sub> ， <sup>L</sup> <sub>2</sub> ，...是输出值本身。 然后，交叉熵可以定义为： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">C</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-652">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">c</span><span class="MJXp-mrow" id="MJXp-Span-657"><span class="MJXp-mn" id="MJXp-Span-658">1</span></span><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">n</span></span><span class="MJXp-mtext" id="MJXp-Span-661">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">u</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-667">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">u</span><span class="MJXp-msubsup" id="MJXp-Span-670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-672" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">t</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-681" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-682">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">n</span><span class="MJXp-msubsup" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-690"><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-692">1</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-696" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-697"><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-699">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">n</span><span class="MJXp-mrow" id="MJXp-Span-702"><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-704">1</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">j</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-710"><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">t</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-719">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">g</span><span class="MJXp-mrow" id="MJXp-Span-723"><span class="MJXp-mn" id="MJXp-Span-724">63</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> C =-\ frac {1} {n} \ sum_x \ sum_j \ left [y_j \ ln a ^ L_j +（1-y_j）\ ln（1-a ^ L_j）\ right] \ tag {63} </script></p><br><br> 这与等式（57）相同，只是现在我们的∑ <sub>j</sub>在所有输出神经元上求和。 我不会详细分析导数，但是可以合理地假设，使用表达式（63）我们可以避免在具有许多神经元的网络中出现放慢速度。 如果有兴趣，可以对下面的问题求导。 <br><br> 顺便提一句，我使用的“交叉熵”一词使这本书的一些早期读者感到困惑，因为它与其他资料相矛盾。 特别是，通常为两个概率分布pj确定交叉熵 <br> 和qj为∑ <sub>j</sub> p <sub>j</sub> lnq <sub>j</sub> 。 如果认为一个乙状神经元给出了由神经元a的激活和与其互补的1-a值组成的概率分布，则该定义可以与（57）相关联。 <br><br> 但是，如果在最后一层中有许多乙状神经元，则向量a <sup>L</sup> <sub>j</sub>通常不会给出概率分布。 结果，类型∑ <sub>j</sub> p <sub>j</sub> lnq <sub>j</sub>的定义<sub>是</sub>没有意义的，因为我们不使用概率分布。 取而代之的是（63），人们可以想象如何总结每个神经元的交叉熵的总和，其中每个神经元的激活被解释为两个元素的概率分布的一部分（当然，我们的网络中没有概率元素，因此这些实际上不是概率）。 从这个意义上讲，（63）将是概率分布的交叉熵的概括。 <br><br> 什么时候使用交叉熵而不是二次值？ 实际上，如果您具有S型输出神经元，则交叉熵几乎总是会更好地使用。 要了解这一点，请记住，在建立网络时，我们通常使用随机过程来初始化权重和偏移量。 可能会发生这种选择，导致网络完全误解某些训练输入数据的事实-例如，输出神经元趋向于1（应设为0，反之亦然）。 如果我们使用二次值来减慢训练速度，则它根本不会停止训练，因为权重将继续在其他训练示例上进行训练，但是这种情况显然是不可取的。 <br><br><h3> 练习题 </h3><br><ul><li> 交叉熵的一个发现是，起初可能很难记住y和a的对应作用。 很容易混淆，因为它是正确的--[ylna +（1- y）ln（1- a）]或-[alny +（1-a）ln（1- y）]。 当y = 0或1时第二个表达式会发生什么？ 这个问题会影响第一个表达式吗？ 怎么了 </li><li> 在本节开头的单个神经元讨论中，我说过对于所有训练输入数据，如果σ（z）≈y，则交叉熵很小。    ,  y  0  1.       ,     (, ) y      0  1. ,      ,  σ(z)=y    .   ,     <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-725"><span class="MJXp-mtable" id="MJXp-Span-726"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-727" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-728" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">C</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-732" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-733">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-735"><span class=""><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737" style="margin-left: 0px;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">y</span><span class="MJXp-mi" id="MJXp-Span-740">ln</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">y</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-745">1</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">y</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-749">ln</span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-752">1</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">y</span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> C = -\frac{1}{n} \sum_x [y \ln y+(1-y) \ln(1-y)] \tag{64} </script></p>  。  −[ylny+(1−y)ln(1−y)]    . </li></ul><br><br><h3>  </h3><br><ul><li>     .      ,             <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-757"><span class="MJXp-mtable" id="MJXp-Span-758"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-759" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-760" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-761" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-762">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-764">∂</span><span class="MJXp-msubsup" id="MJXp-Span-765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-772" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-773">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-775"><span class=""><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">L</span><span class="MJXp-mo" id="MJXp-Span-783">−</span><span class="MJXp-mn" id="MJXp-Span-784">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-793" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796" style="margin-right: 0.05em;">σ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-797" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \sigma'(z^L_j) \tag{65} </script></p>  σ'(z <sup>L</sup> <sub>j</sub> )   ,      . ,          δ <sup>L</sup>     x   <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-804"><span class="MJXp-mtable" id="MJXp-Span-805"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-806" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-807" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">δ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-814" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">y</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> \delta^L = a^L-y \tag{66} </script></p>   ,  ,           <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-817"><span class="MJXp-mtable" id="MJXp-Span-818"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-819" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-820" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-821" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-822">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-824">∂</span><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-832" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-833">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-835"><span class=""><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">L</span><span class="MJXp-mo" id="MJXp-Span-843">−</span><span class="MJXp-mn" id="MJXp-Span-844">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \tag{67} </script></p>  σ'(z <sup>L</sup> <sub>j</sub> ) ,       ,       ,          .         .     ,       . </li><li>         . ,       . ,      ,       ,     ,  a <sup>L</sup> <sub>j</sub> = z <sup>L</sup> <sub>j</sub> . ,         δL     x  <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-855"><span class="MJXp-mtable" id="MJXp-Span-856"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-857" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-858" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860" style="margin-right: 0.05em;">δ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-861" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-865" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">y</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \delta^L = a^L-y \tag{68} </script></p>     ,   ,  ,           ,  <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-868"><span class="MJXp-mtable" id="MJXp-Span-869"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-870" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-871" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-872" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-873">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-875">∂</span><span class="MJXp-msubsup" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-883" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-884">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-886"><span class=""><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">L</span><span class="MJXp-mo" id="MJXp-Span-894">−</span><span class="MJXp-mn" id="MJXp-Span-895">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-904" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \tag{69} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-906"><span class="MJXp-mtable" id="MJXp-Span-907"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-908" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-909" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-910" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-911">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-913">∂</span><span class="MJXp-msubsup" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">j</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-920" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-921">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-923"><span class=""><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925" style="margin-left: 0px;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-934" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> \frac{\partial C}{\partial b^L_{j}} = \frac{1}{n} \sum_x (a^L_j-y_j) \tag{70} </script></p>  ,     ,          .         . </li></ul><br><br><h2>        MNIST </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">交叉熵很容易实现为使用梯度下降和反向传播教授网络的程序的一部分。我们稍后将通过开发来自MNIST的早期手写数字分类程序的改进版本network.py来进行此操作。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新程序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">称为network2.py，它不仅包括交叉熵，还包括本章中开发的其他几种技术。同时，让我们看看我们的新程序对MNIST数字的分类情况如何。与第1章一样，我们将使用包含30个隐藏神经元和大小为10的微型数据包的网络。我们将设置学习速度η= 0.5，并学习30个时代。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正如我已经说过的，在这种情况下无法确切地说出适合的训练速度，因此我尝试了选择。的确，有一种方法可以将学习率与交叉熵和二次值进行非常粗略的启发式关联。前面我们看到，在二次值的梯度项中，还有一个附加项σ'=σ（1-σ）。假设我们平均的值σ，∫ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dσσ（1-σ）= 1/6。可以看出，对于相同的学习速率，（非常粗略的）二次成本平均学习速度要慢6倍。这表明一个好的出发点是将二次函数的学习速度除以6。当然，这根本不是严格的论据，您也不应该太在意。但有时它可能是有用的起点。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">network2.py的界面与network.py略有不同，但是仍然应该清楚发生了什么。</font><font style="vertical-align: inherit;">可以使用python shell中的帮助命令（network2.Network.SGD）获得network2.py上的文档。</font></font><br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, evaluation_data=test_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br> 注意，顺便说一句，net.large_weight_initializer（）命令用于初始化权重和偏移量的方式与第1章中所述相同。我们需要运行它，因为稍后我们将更改默认的权重初始化。 结果，在启动所有上述命令后，我们得到的网络的工作精度为95.49％。 使用二次值，这与第一章的结果非常接近95.42％。 <br><br> 让我们看看使用100个隐藏神经元和交叉熵，其余保持不变的情况。 在这种情况下，准确度是96.82％。 这是对第一章结果的重大改进，在第一章中，我们使用二次值获得了96.59％的精度。 变化似乎很小，但认为误差从3.41％降至3.18％。 也就是说，我们消除了大约1/14的错误。 很好 <br><br> 很好的是，与二次值相比，交叉熵成本函数可以为我们提供相似或更好的结果。 但是，他们并没有明确证明交叉熵是最佳选择。 事实是，我根本没有尝试选择超参数-训练的速度，迷你包装的大小等。 为了使改进更具说服力，我们需要适当地解决它们的优化问题。 但是结果仍然鼓舞人心，并且我们的理论计算证实了交叉熵比二次成本函数更好。 <br><br> 因此，整章以及原则上将贯穿本书的其余部分。 我们将开发新技术，对其进行测试，并获得“改进的结果”。 当然，很高兴看到这些改进。 但是解释它们总是很困难。 只有认真研究优化所有其他超参数之后，我们才能看到改进，这才具有说服力。 这是一项相当复杂的工作，需要大量的计算资源，通常我们不会进行如此详尽的调查。 相反，我们将在上述非正式测试的基础上进一步发展。 但是您需要记住，这样的测试并不是明确的证据，并在参数开始失败时仔细监视这些情况。 <br><br> 到目前为止，我们一直在详细讨论交叉熵。 如果对MNIST的结果进行很小的改进，为什么还要浪费这么多的精力呢？ 在本章的后面，我们将看到其他技术，尤其是正则化，它们将提供更强大的改进。 那么，为什么我们要关注交叉熵呢？ 特别是因为交叉熵是一种常用的价值函数，因此值得一读。 但是更重要的原因是神经元的饱和度是神经网络领域的重要问题，在本书中我们将不断提到。 因此，我对交叉熵进行了详尽的讨论，因为这是一个很好的实验室，可以开始了解神经元的饱和度以及如何解决该问题。 <br><br><h2> 交叉熵是什么意思？ 它来自哪里？ </h2><br> 我们对交叉熵的讨论围绕代数分析和实际实现。 这很有用，但是结果是，更广泛的概念性问题仍然没有答案，例如：交叉熵是什么意思？ 有没有直观的方式展示它？ 人们甚至怎么想出交叉熵呢？ <br><br> 让我们从最后一个开始：是什么让我们考虑交叉熵？ 假设我们发现了前面描述的学习减慢，并且意识到这是由等式（55）和（56）中的σ'（z）引起的。 稍微看一下这些方程式，我们可以考虑是否可以选择这样的成本函数，从而使σ'（z）消失。 然后<sub>，</sub>一个训练示例的成本C = C <sub>x</sub>将满足以下等式： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-936"><span class="MJXp-mtext" id="MJXp-Span-937">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">˚F </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ř </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mrow" id="MJXp-Span-942"><span class="MJXp-mtext" id="MJXp-Span-943" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\部</font></font></span><span class="MJXp-mrow" id="MJXp-Span-944"><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ç </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-947"><span class="MJXp-mtext" id="MJXp-Span-948" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\部</font></font></span><span class="MJXp-mrow" id="MJXp-Span-949"><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瓦特</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-953" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-957" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-958"><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></span><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ý </font></font></span><span class="MJXp-mrow" id="MJXp-Span-963"><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><span class="MJXp-mtext" id="MJXp-Span-965" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> \标</font></font></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">签</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-968"><span class="MJXp-mn" id="MJXp-Span-969"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">71</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> \ frac {\部分C} {\部分w_j} = x_j（a-y）\标签{71} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-970"><span class="MJXp-mtext" id="MJXp-Span-971">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">˚F </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ř </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mtext" id="MJXp-Span-977" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\部</font></font></span><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ç </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-mtext" id="MJXp-Span-982" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\部</font></font></span><span class="MJXp-mrow" id="MJXp-Span-983"><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> b</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mrow" id="MJXp-Span-987"><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ý </font></font></span><span class="MJXp-mrow" id="MJXp-Span-992"><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><span class="MJXp-mtext" id="MJXp-Span-994" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> \标</font></font></span><span class="MJXp-mrow" id="MJXp-Span-995"><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">签</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-997"><span class="MJXp-mn" id="MJXp-Span-998"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">72</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-19"> \ frac {\部分C} {\部分b} =（a-y）\标签{72} </script></p><br><br> 如果我们选择一个使它们正确的值函数，那么它们宁愿简单地描述一种直观的理解，即初始误差越大，神经元学习越快。 他们还将解决减速问题。 实际上，从这些方程式开始，我们将表明可以通过简单地遵循数学本能来推导交叉熵的形式。 看到这一点，我们注意到，基于链式规则，我们得到： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-999"><span class="MJXp-mtext" id="MJXp-Span-1000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">c</span><span class="MJXp-mrow" id="MJXp-Span-1005"><span class="MJXp-mtext" id="MJXp-Span-1006" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1007"><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-mtext" id="MJXp-Span-1011" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1012"><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">b</span></span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1016">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">c</span><span class="MJXp-mrow" id="MJXp-Span-1021"><span class="MJXp-mtext" id="MJXp-Span-1022" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1023"><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1026"><span class="MJXp-mtext" id="MJXp-Span-1027" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1028"><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">a</span></span><span class="MJXp-mtext" id="MJXp-Span-1031">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">m</span><span class="MJXp-msup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1038" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mrow" id="MJXp-Span-1039"><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">z</span><span class="MJXp-mrow" id="MJXp-Span-1042"><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1044" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1045"><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1047"><span class="MJXp-mn" id="MJXp-Span-1048">73</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-20"> \ frac {\部分C} {\部分b} = \ frac {\部分C} {\部分a} \ sigma'（z）\标签{73} </script></p><br><br> 在最后一个方程中使用σ'（z）=σ（z）（1 −σ（z））= a（1 − a），我们得到： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1049"><span class="MJXp-mtext" id="MJXp-Span-1050">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">c</span><span class="MJXp-mrow" id="MJXp-Span-1055"><span class="MJXp-mtext" id="MJXp-Span-1056" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1057"><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1060"><span class="MJXp-mtext" id="MJXp-Span-1061" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1062"><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">b</span></span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1066">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">c</span><span class="MJXp-mrow" id="MJXp-Span-1071"><span class="MJXp-mtext" id="MJXp-Span-1072" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1073"><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1076"><span class="MJXp-mtext" id="MJXp-Span-1077" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1078"><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">a</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">a</span><span class="MJXp-mrow" id="MJXp-Span-1082"><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-1084">1</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">a</span><span class="MJXp-mrow" id="MJXp-Span-1087"><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1089" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1090"><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1092"><span class="MJXp-mn" id="MJXp-Span-1093">74</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-21"> \ frac {\部分C} {\部分b} = \ frac {\部分C} {\部分a} a（1-a）\标签{74} </script></p><br><br> 与等式（72）相比，我们获得： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1094"><span class="MJXp-mtext" id="MJXp-Span-1095">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">c</span><span class="MJXp-mrow" id="MJXp-Span-1100"><span class="MJXp-mtext" id="MJXp-Span-1101" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1102"><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1105"><span class="MJXp-mtext" id="MJXp-Span-1106" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1107"><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">a</span></span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">c</span><span class="MJXp-mrow" id="MJXp-Span-1116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">a</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">a</span><span class="MJXp-mrow" id="MJXp-Span-1122"><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-1124">1</span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">a</span><span class="MJXp-mrow" id="MJXp-Span-1127"><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1129" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1130"><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mn" id="MJXp-Span-1133">75</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> \ frac {\部分C} {\部分a} = \ frac {a-y} {a（1-a）} \标签{75} </script></p><br><br> 将表达式集成到a上，我们得到： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">C</span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1138" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">y</span><span class="MJXp-mtext" id="MJXp-Span-1140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">a</span><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1145"><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-1147">1</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">y</span><span class="MJXp-mrow" id="MJXp-Span-1150"><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">n</span><span class="MJXp-mrow" id="MJXp-Span-1155"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-1157">1</span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">a</span><span class="MJXp-mrow" id="MJXp-Span-1160"><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1164"><span class="MJXp-mtext" id="MJXp-Span-1165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">m</span><span class="MJXp-mrow" id="MJXp-Span-1168"><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0.278em; margin-right: 0.278em;">常</span></span><span class="MJXp-mrow" id="MJXp-Span-1170"><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1172" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1173"><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1175"><span class="MJXp-mn" id="MJXp-Span-1176">76</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> C =-[y \ ln a +（1-y）\ ln（1-a）] + {\ rm常数} \标签{76} </script></p><br><br> 这是一个单独的训练示例x对成本函数的贡献。 为了获得完整的成本函数，我们需要对所有训练示例进行平均，然后得出： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">C</span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">c</span><span class="MJXp-mrow" id="MJXp-Span-1186"><span class="MJXp-mn" id="MJXp-Span-1187">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">u</span><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1195" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">y</span><span class="MJXp-mtext" id="MJXp-Span-1198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">a</span><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1203"><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-1205">1</span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">y</span><span class="MJXp-mrow" id="MJXp-Span-1208"><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1210">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">n</span><span class="MJXp-mrow" id="MJXp-Span-1213"><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-1215">1</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">a</span><span class="MJXp-mrow" id="MJXp-Span-1218"><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1222"><span class="MJXp-mtext" id="MJXp-Span-1223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">m</span><span class="MJXp-mrow" id="MJXp-Span-1226"><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.278em; margin-right: 0.278em;">常</span></span><span class="MJXp-mrow" id="MJXp-Span-1228"><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1230" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1231"><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0.278em; margin-right: 0.278em;">记</span></span><span class="MJXp-mrow" id="MJXp-Span-1233"><span class="MJXp-mn" id="MJXp-Span-1234">77</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-24"> C =-\ frac {1} {n} \ sum_x [y \ ln a +（1-y）\ ln（1-a）] + {\ rm常数} \标记{77} </script></p><br><br> 这里的常数是每个训练示例的各个常数的平均值。 如您所见，方程式（71）和（72）唯一地确定了交叉熵的形状，即肉身为一个公共常数。 交叉熵并不是凭空获得的。 可以通过简单自然的方式找到她。 <br><br> 交叉熵的直观想法如何？ 我们如何想象呢？ 详细的解释将导致我们超越培训课程。 但是，我们可以提到起源于信息理论领域的解释交叉熵的标准方法的存在。 粗略地说，交叉熵是一种令人惊讶的度量。 例如，我们的神经元试图计算函数x→y = y（x）。 但是，它计算函数x→a = a（x）。 假设我们将a想象为y = 1的概率的神经元估计，而1-a是y的正确值为0的概率。然后，交叉熵衡量了我们平均多少会“感到惊讶”找到y的真实值。 如果我们希望有一个出路，我们就不会感到惊讶，而如果出路是出乎意料的话，我们会感到非常惊讶。 当然，我没有给出“惊奇”的严格定义，因此所有这些看起来都像是空话。 但是实际上，在信息论中，有一种确定意外的确切方法。 不幸的是，我不知道在互联网上关于这一点的良好，简短和自给自足的讨论的任何例子。 但是，如果您有兴趣进行更深入的研究，那么<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Wikipedia文章将</a>提供很好的常规信息，这些信息将为您提供正确的指导。 有关详细<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">信息，请参阅有关信息论</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">书中有关</a>卡夫不等式的第5章。 <br><br><h3> 挑战赛 </h3><br><ul><li> 我们已经详细讨论了在学习中使用二次成本函数在网络中神经元饱和时可能发生的学习减慢。 另一个可能抑制学习的因素是方程（61）中项x <sub>j</sub>的存在。 因此，当输出x <sub>j</sub>接近零时，相应的权重w <sub>j</sub>将被缓慢训练。 解释为什么不可能<sub>通过</sub>选择一些巧妙的成本函数来消除项x <sub>j</sub> 。 </li></ul><br><br><h2>  Softmax（软最大功能） </h2><br> 在本章中，我们将主要使用交叉熵代价函数来解决学习缓慢的问题。 但是，我想根据所谓的 神经元的softmax层。 在本章的其余部分中，我们将不使用Softmax图层，因此，如果您急于赶时间，可以跳过本节。 但是，Softmax仍然值得理解，特别是因为它本身很有趣，并且特别是因为在讨论深度神经网络时，我们将在第6章中使用Softmax层。 <br><br>  Softmax的想法是为HC定义一种新型的输出层。 它以与S形层相同的方式开始，并形成加权输入 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">u</span><span class="MJXp-msubsup" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1246" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">k</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">k</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">L</span><span class="MJXp-mo" id="MJXp-Span-1259">−</span><span class="MJXp-mn" id="MJXp-Span-1260">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">j</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> z ^ L_j = \ sum_ {k} w ^ L_ {jk} a ^ {L-1} _k + b ^ L_j </script>  。 但是，我们不使用S形来获得答案。 在Softmax层中，我们将Softmax函数应用于z <sup>L</sup> <sub>j</sub> 。 根据她的说法，输出神经元j的激活a <sup>L</sup> <sub>j</sub>等于： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1266"><span class="MJXp-msubsup" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">c</span><span class="MJXp-mrow" id="MJXp-Span-1277"><span class="MJXp-msubsup" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1280" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1285"><span class="MJXp-mtext" id="MJXp-Span-1286">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">u</span><span class="MJXp-msubsup" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1291" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1294" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1299" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1300"><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1302"><span class="MJXp-mn" id="MJXp-Span-1303">78</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> a ^ L_j = \ frac {e ^ {z ^ L_j}} {\ sum_k e ^ {z ^ L_k}} \标签{78} </script></p><br><br> 在分母中，我们对所有输出神经元求和。 <br><br> 如果您不熟悉Softmax函数，等式（78）对您来说似乎很神秘。 我们为什么要使用这样的功能一点也不明显。 同样不明显的是，它将帮助我们解决学习速度减慢的问题。 为了更好地理解方程式（78），假设我们有一个包含四个输出神经元和四个相应加权输入的网络，我们将其指定为z <sup>L</sup> <sub>1</sub> ，z <sup>L</sup> <sub>2</sub> ，z <sup>L</sup> <sub>3</sub>和z <sup>L</sup> <sub>4</sub> 。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">原始文章</a>包含交互式调整滑块，为这些滑块分配了加权输入的可能值以及相应输出激活的时间表。 研究它们的一个很好的起点是使用底部滑块增加z <sup>L</sup> <sub>4</sub> 。 <br><br><img src="https://habrastorage.org/webt/na/og/gw/naoggwrddhdvbb8oazriohydiy8.png"><br><br><img src="https://habrastorage.org/webt/tz/-7/_4/tz-7_4zl_-vtam3qzx22klosse8.png"><br><br> 通过增加z <sup>L</sup> <sub>4</sub> ，可以观察到相应输出激活<sup>L</sup> <sub>4</sub>的增加，而其他输出激活的减少。 随着z <sup>L</sup> <sub>4</sub>的减少，a <sup>L</sup> <sub>4</sub>将减少，而所有其他输出激活将增加。 仔细观察，您会发现在这两种情况下，其他激活中的一般变化都可以完全补偿<sup>L</sup> <sub>4</sub>中发生的变化。 这样做的原因是保证所有输出激活合计为1，我们可以使用等式（78）和一些代数证明： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1304"><span class="MJXp-mtext" id="MJXp-Span-1305">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">u</span><span class="MJXp-msubsup" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1310" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">c</span><span class="MJXp-mrow" id="MJXp-Span-1321"><span class="MJXp-mtext" id="MJXp-Span-1322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">u</span><span class="MJXp-msubsup" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1327" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1330" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1335"><span class="MJXp-mtext" id="MJXp-Span-1336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">u</span><span class="MJXp-msubsup" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1341" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1344" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1350">1</span><span class="MJXp-mtext" id="MJXp-Span-1351" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1352"><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1354"><span class="MJXp-mn" id="MJXp-Span-1355">79</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> \ sum_j a ^ L_j = \ frac {\ sum_j e ^ {z ^ L_j}} {\ sum_k e ^ {z ^ L_k}} = 1 \标签{79} </script></p><br><br> 结果，随着<sup>L</sup> <sub>4</sub>的增加<sub>，</sub>其余的输出激活总数必须减少相同的值，以确保所有输出激活的总和等于1。当然，对于所有其他激活，类似的语句也适用。 <br><br> 从等式（78）还可以得出，因为指数函数为正，所以所有输出激活都是正的。 结合上一段的观察，我们发现Softmax层的输出将是一组总数为1的正数。换句话说，Softmax层的输出可以表示为概率分布。 <br><br>  Softmax层的输出是概率分布的事实非常令人高兴。 在许多问题中，方便的是，能够将输出激活a <sup>L</sup> <sub>j</sub>解释为由网络估计的小瓶j将是正确选项的概率。 因此，例如，在分类问题MNIST中，我们可以将<sup>L</sup> <sub>j</sub>解释为网络对j将成为正确数字分类概率的估计。 <br><br> 相反，如果输出层是S形的，那么我们绝对不能假设激活会形成概率分布。 我不会严格地证明这一点，但是可以合理地假设，在通常情况下，乙状结肠层的激活不会形成概率分布。 因此，使用S形输出层，我们将无法获得对输出激活的这种简单解释。 <br><br><h3> 锻炼身体 </h3><br><ul><li> 举例说明，在具有S型输出层的网络中，输出激活a <sup>L</sup> <sub>j</sub>并不总等于1。 </li></ul><br><br> 我们开始对Softmax函数以及Softmax层的行为有所了解。 总结一下：方程式（78）中的指数可确保所有输出激活为正。 公式（78）的分母中的总和确保Softmax的总数为1。因此，这种公式不再显得神秘：这是确保输出激活形成概率分布的自然方法。  Softmax可以想象成一种缩放z <sup>L</sup> <sub>j</sub> ，然后将它们压缩在一起以形成概率分布的方法。 <br><br><h3> 练习题 </h3><br><ul><li>  Softmax的单调性。 证明ja <sup>L</sup> <sub>j</sub> /∂zL <sub>k</sub>如果j = k <sub>为</sub>正，如果j≠k为负。 结果，保证了z <sup>L</sup> <sub>j</sub>的增加，以增加相应的输出激活a <sup>L</sup> <sub>j</sub> ，并减少所有其他输出激活。 我们已经使用滑块的示例从经验上看到了这一点，但是这种证明将是严格的。 </li><li> 非本地性Softmax。 乙状结肠层的一个好特征是输出a <sup>L</sup> <sub>j</sub>是相应加权输入a <sup>L</sup> <sub>j</sub> =σ（z <sup>L</sup> <sub>j</sub> ）的函数。 解释一下为什么Softmax层不是这种情况： <sup>L</sup> <sub>j的</sub>任何输出激活取决于所有加权输入。 </li></ul><br><br><h3> 挑战赛 </h3><br><ul><li> 反转Softmax图层。 假设我们有一个带有输出Softmax层的NS，并且激活<sup>L</sup> <sub>j是</sub>已知的。 证明相应的加权输入的形式为z <sup>L</sup> <sub>j</sub> = ln a <sup>L</sup> <sub>j</sub> + C，其中C是一个独立于j的常数。 </li></ul><br><br><h2> 学习减速问题 </h2><br> 我们已经非常熟悉神经元的Softmax层。 但是到目前为止，我们还没有看到Softmax层如何使我们解决学习速度减慢的问题。 为了理解这一点，让我们基于“对数似然”定义一个成本函数。 我们将使用x表示网络的训练输入，并使用y表示相应的所需输出。 然后，与此训练输入关联的LPS将是： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">C</span><span class="MJXp-mtext" id="MJXp-Span-1358">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">v</span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">n</span><span class="MJXp-msubsup" id="MJXp-Span-1368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">y</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">g</span><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mn" id="MJXp-Span-1377">80</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> C \ equiv-\ ln a ^ L_y \ tag {80} </script></p><br><br> 因此，例如，如果我们研究MNIST图像，并且图像7进入了输入，则LPS将为-ln <sup>L</sup> <sub>7</sub> 。 为了直观地理解这一点，我们考虑网络很好地应对识别的情况，即确保它在输入7处。在这种情况下，它将评估对应概率a <sup>L</sup> <sub>7</sub>的值接近1，因此，成本-ln <sub>7</sub>将很小。 相反，如果网络运行不正常，则<sup>L</sup> <sub>7</sub>的可能性会较小，而<sup>L</sup> <sub>7</sub>的成本-ln会更大。 因此，LPS的行为符合成本函数的预期。 <br><br> 减速问题呢？ 为了进行分析，我们回想起减速的主要因素是isC /∂wL <sub>jk</sub>和∂C/∂bL <sub>j的行为</sub> 。 我不会详细描述导数的捕获-我将要求您在任务中执行此操作，但是使用一些代数可以证明： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1378"><span class="MJXp-mtext" id="MJXp-Span-1379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">c</span><span class="MJXp-mrow" id="MJXp-Span-1384"><span class="MJXp-mtext" id="MJXp-Span-1385" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1386"><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mtext" id="MJXp-Span-1390" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1391"><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1405" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-1406" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1407"><span class="MJXp-mo" id="MJXp-Span-1408" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1409"><span class="MJXp-mn" id="MJXp-Span-1410">81</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-29"> \ frac {\部分C} {\部分b ^ L_j} = a ^ L_j-y_j \标签{81} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1411"><span class="MJXp-mtext" id="MJXp-Span-1412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">c</span><span class="MJXp-mrow" id="MJXp-Span-1417"><span class="MJXp-mtext" id="MJXp-Span-1418" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1422"><span class="MJXp-mtext" id="MJXp-Span-1423" style="color: red;">\部</span><span class="MJXp-mrow" id="MJXp-Span-1424"><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0.278em; margin-right: 0.278em;">分</span></span><span class="MJXp-msubsup" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">k</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">L</span><span class="MJXp-mo" id="MJXp-Span-1438">−</span><span class="MJXp-mn" id="MJXp-Span-1439">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">k</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1440"><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1449" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-1450"><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1452" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1453"><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1455"><span class="MJXp-mn" id="MJXp-Span-1456">82</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-30"> \ frac {\部分C} {\部分w ^ L_ {jk}} = a ^ {L-1} _k（a ^ L_j-y_j）\标签{82} </script></p><br><br> 我在这里使用了一些符号，并且我使用的“ y”与上一段略有不同。  y表示所需的网络输出-即，如果输出为“ 7”，则输入为图像7。在这些等式中，y表示对应于7的输出激活向量，即除7中的单位为零外，所有零的向量。的位置。 <br><br> 这些方程与我们在交叉熵的早期分析中获得的相似表达式相同。 比较例如方程式（82）和（67）。 这是相同的方程式，尽管后者是在训练示例中平均的。 并且，与第一种情况一样，这些表达式保证了学习不会减慢。 可以想象，具有LPS的输出Softmax层与基于交叉熵的具有S型输出和成本的层非常相似。 <br><br> 鉴于它们的相似性，应该使用什么-S型输出和交叉熵，或者Softmax输出和LPS？ 实际上，在很多情况下，这两种方法都行之有效。 尽管在本章的后面，我们将使用S型输出层，其成本基于交叉熵。 稍后，在第6章中，有时会使用Softmax输出和LPS。 进行更改的原因是使以下某些网络与某些有影响力的研究论文中发现的网络更加相似。 从更一般的角度来看，当您需要将输出激活解释为概率时，应使用Softmax和LPS。 这并非总是必要的，但是在分类问题（例如MNIST）中很有用，其中包括不相交的类。 <br><br><h3> 任务 </h3><br><ul><li> 导出方程式（81）和（82）。 </li><li>  Softmax这个名字来自哪里？ 假设我们更改Softmax函数，以便通过等式给出输出激活 <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1457"><span class="MJXp-msubsup" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">c</span><span class="MJXp-mrow" id="MJXp-Span-1468"><span class="MJXp-msubsup" id="MJXp-Span-1469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1471" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">c</span><span class="MJXp-msubsup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1477"><span class="MJXp-mtext" id="MJXp-Span-1478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">u</span><span class="MJXp-msubsup" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1483" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1486" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">c</span><span class="MJXp-msubsup" id="MJXp-Span-1488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1492" style="color: red;">\标</span><span class="MJXp-mrow" id="MJXp-Span-1493"><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0.278em; margin-right: 0.278em;">签</span></span><span class="MJXp-mrow" id="MJXp-Span-1495"><span class="MJXp-mn" id="MJXp-Span-1496">83</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> a ^ L_j = \ frac {e ^ {c z ^ L_j}} {\ sum_k e ^ {c z ^ L_k}} \标签{83} </script></p> 其中c是一个正常数。 请注意，c = 1对应于标准Softmax函数。 但是使用不同的c值，我们得到了另一个在质量上仍然与Softmax类似的函数。 证明输出激活形成概率分布，这与常规Softmax一样。 假设我们使c非常大，即c→＆inf;。 输出激活a <sup>L</sup> <sub>j</sub>的极限值是多少？ 解决此问题后，应该清楚为什么将c = 1的函数视为最大函数的“软化版本”。 这是术语softmax的来源。 </li><li> 使用Softmax和LPS进行反向传播。 在上一章中，我们推导了包含乙状结肠层的网络的反向传播算法。 为了将该算法应用于网络层和Softmax层，我们需要导出误差<sup>δL</sup> j∂C/∂zL <sub>j</sub>的表达式。 证明合适的表达是 <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1497"><span class="MJXp-mtext" id="MJXp-Span-1498">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ë </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">升</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">吨</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大号</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大号</font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1512" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ý </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1515" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ĵ</font></font></span></span><span class="MJXp-mtext" id="MJXp-Span-1516" style="color: red;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> \标</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1517"><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">签</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1519"><span class="MJXp-mn" id="MJXp-Span-1520"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">84</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ delta ^ L_j = a ^ L_j -y_j \标签{84} </script></p> 使用此表达式，我们可以使用输出的Softmax层和LPS将反向传播算法应用于网络。 </li></ul><br><br><h2> 再培训和正规化 </h2><br> 曾经有人要求诺贝尔奖获得者恩里科·费米（Enrico Fermi）对一些同事提出的解决重要的未解决物理问题的数学模型提出意见。 该模型与实验完全吻合，但费米对此表示怀疑。 他询问其中可以更改多少个自由参数。  “四个，”他们告诉他。 费米回答：“我记得我的朋友约翰尼·冯·诺伊曼（Johnny von Neumann）多么喜欢说，用四个参数可以将一头大象推到那里，而用五个参数可以使他摇动树干。” <br><br> 当然，历史的意义在于，具有大量自由参数的模型可以描述令人惊讶的各种现象。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使这样的模型可以很好地处理可用数据，也不会自动使其成为一个好的模型。</font><font style="vertical-align: inherit;">这可能只是意味着该模型有足够的自由来描述几乎任何给定大小的数据集，而无需揭示现象的主要思想。</font><font style="vertical-align: inherit;">发生这种情况时，该模型可以很好地处理现有数据，但不能推广新情况。</font><font style="vertical-align: inherit;">对模型的真实测试是它在从未遇到过的情况下做出预测的能力。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">费米和冯·诺依曼对具有四个参数的模型表示怀疑。我们的NS具有30个隐藏的神经元，用于MNIST数字的分类，具有近24,000个参数！这些是很多参数。我们的带有100个隐藏神经元的NS具有近80,000个参数，而这些参数的高级深层NS有时具有数百万甚至数十亿个。我们可以相信他们的工作成果吗？</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们使网络复杂化一个新的情况，使这个问题复杂化。我们将使用具有30个隐藏神经元和23,860个参数的NS。但是我们不会使用所有50,000张MNIST图像来训练网络。取而代之的是，我们仅使用前1000个。使用有限集会使泛化问题更加明显。我们将像以前一样使用基于交叉熵的成本函数进行学习，学习速度为η= 0.5，最小数据包大小为10。但是，我们将研究400个时代，这比以前稍微多了，因为有训练示例我们没有很多。让我们使用network2看一下成本函数如何变化：</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, evaluation_data=test_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用结果，我们可以在训练网络时建立成本变化的图表（图表是使用overfitting.py程序制作的）：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/202/918/ebd/202918ebd6b97ceb7fa451a150c879c1.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看起来令人鼓舞，正如预期的那样，成本正在平稳下降。请记住，我只显示了从200到399的时期。结果，我们放大地看到了训练的后期阶段，正如我们稍后将看到的那样，所有最有趣的事件都会发生。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，让我们看看验证数据的分类准确性如何随时间变化：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d52/ead/ddb/d52eadddb40981a35b36a852dc346674.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后我再次增加了时间表。在前200个时代（此处看不见），准确性提高到近82％。然后训练逐渐变慢。最终，在第280年代左右，分类准确性停止提高。在以后的时代中，在第280个时代达到的精度值附近仅观察到很小的随机波动。将此与上一张图表进行比较，在该图表上与训练数据相关的成本正在逐渐降低。如果仅研究此成本，则似乎该模型正在改进。但是，使用测试数据的结果告诉我们，这种改进只是一种幻想。就像费米不喜欢的模型一样，我们在280年代后的网络研究不再推广到验证数据。因此，该培训不再有用。我们说，在280年代之后，网络正在重新训练，或过度拟合。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能想知道我不是根据培训数据而不是根据验证数据分类的准确性来研究成本的问题。换句话说，也许问题在于我们正在将苹果与橙子进行比较。如果将培训数据的成本与验证成本进行比较，即比较可比较的指标，将会发生什么？也许我们可以比较训练数据和测试数据的分类准确性？实际上，无论如何进行比较，都会出现相同的现象。但是细节正在改变。例如，让我们看一下验证数据的值：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/81e/c1b/01a/81ec1b01a439d1766585dc57587b907c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以看出，尽管训练数据的成本在不断提高，但直到15世纪左右，验证数据的成本才有所提高，然后开始完全恶化。这是再训练模型的另一个标志。但是，出现了一个问题，我们应该考虑在哪个时代开始进行再培训胜于培训（15或280）？从实践的角度来看，我们仍然对提高验证数据分类的准确性感兴趣，而成本只是分类准确性的中介。因此，考虑到280年的时代是有意义的，在那之后，再培训开始盛行于国民议会的培训。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">训练数据分类的准确性可以看出再训练的另一个迹象：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ff/5f3/dd6/6ff5f3dd69e5182de0ebfc1e54e8db0b.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准确性不断提高，达到100％。也就是说，我们的网络正确分类了所有1000个训练图像！同时，验证准确性仅增长到82.27％。也就是说，我们的网络仅研究训练集的特征，而根本不学习识别数字。似乎网络只是记住训练集，而不是足够了解数字以将其推广到测试集。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再培训是国民议会的一个严重问题。对于通常具有大量重量和位移的现代NS来说尤其如此。为了进行有效的培训，我们需要一种方法来确定何时进行再培训，以免再培训。而且我们也希望能够减少再培训的影响。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测再培训的一种明显方法是使用上述方法，在网络培训期间监视使用验证数据的准确性。如果我们发现验证数据的准确性不再提高，则必须停止训练。当然，严格来说，这不一定是再培训的标志。也许同时处理测试和培训数据的准确性将停止提高。然而，采用这样的策略将防止再培训。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将使用此策略的一个小变化。回想一下，当我们将数据加载到MNIST时，我们将它们分为三组：</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper()</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到目前为止，我们已经使用了training_data和test_data，并忽略了validate_data [confirming]。 Validation_data包含10,000张图像，这与MNIST训练集的50,000张图像和验证集的10,000张图像都不相同。我们将使用validation_data而不是使用test_data来防止过度拟合。为此，我们将使用与上述test_data几乎相同的策略。也就是说，我们将在每个时代结束时计算validation_data的分类准确性。一旦validation_data的分类精度已满，我们将停止学习。此策略称为“提前停止”。当然，在实践中，我们将无法立即发现准确性已得到满足。取而代之的是，我们将继续进行培训，直到确定这一点（并决定当您需要停下来时，这并不总是那么容易，您可以为此使用或多或少的激进方法。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为什么使用validation_data而不是test_data来防止重新训练？使用validation_data评估超参数的不同选择是更通用的策略的一部分，这些选择包括学习的时期数，学习的速度，最佳的网络体系结构等。我们使用这些估计来查找超参数并为其分配适当的值。尽管我还没有提到这一点，但部分原因是因为我在本书前面的示例中选择了超参数。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当然，此评论不能回答为什么我们使用validation_data而不是test_data来防止过度拟合的问题。它只是替换了一个更普遍的问题的答案-为什么我们使用validation_data而不是test_data选择超参数？要了解这一点，请记住，在选择超参数时，我们很可能必须从各种选项中进行选择。如果我们根据来自test_data的等级分配超参数，则可能会针对test_data专门定制此数据。也就是说，我们可以从test_data中找到非常适合特定数据的特定特征的超参数，但是，我们的网络操作不会被推广到其他数据集。我们通过使用validation_data选择超参数来避免这种情况。然后，在收到我们需要的GP之后，我们使用test_data进行最终的准确性评估。这使我们充满信心，我们用test_data得到的结果是NS泛化程度的真实度量。换句话说，辅助数据就是这样的特殊训练数据，可以帮助我们学习良好的GP。这种定位GP的方法有时称为保留方法，因为validate_data与training_data分开“持有”。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实际上，即使在评估了test_data的工作质量之后，我们还是会改变主意，尝试使用不同的方法（也许是不同的网络体系结构），其中将包括搜索一组新的GP。在这种情况下，是否存在不必要地适应test_data的危险？我们是否需要可能无限数量的数据集，以确保我们的结果能被很好地推广？通常，这是一个深刻而复杂的问题。但是出于我们的实际目的，我们不会对此太担心。如上所述，我们只是使用基于training_data，validation_data和test_data的简单保留方法简单地深入研究。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到目前为止，我们一直在考虑使用1000个训练图像进行再训练。如果我们使用50,000张图像的完整训练集会发生什么？我们将所有其他参数保持不变（30个隐藏的神经元，学习速度0.5，小数据包大小10），但是我们将使用所有50,000张图片研究30个时代。这是一张图表，显示了训练数据和测试数据分类的准确性。请注意，这里我使用了验证数据而不是验证数据，以便更轻松地将结果与早期图形进行比较。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ac/939/bd9/3ac939bd9760316faf84350fca4cd00d.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以看出，与使用1000个训练示例相比，测试和训练数据上的准确性指标保持彼此更接近。</font><font style="vertical-align: inherit;">特别是，最佳分类精度为97.86％，仅比验证数据的95.33％高2.53％。</font><font style="vertical-align: inherit;">相比之下，早早下跌了17.73％！</font><font style="vertical-align: inherit;">正在进行再培训，但大大减少了。</font><font style="vertical-align: inherit;">从培训到测试数据，我们的网络可以更好地编译信息。</font><font style="vertical-align: inherit;">通常，减少再训练的最佳方法之一是增加训练数据量。</font><font style="vertical-align: inherit;">有了足够的训练数据，即使是非常大的网络也很难进行训练。</font><font style="vertical-align: inherit;">不幸的是，获取训练数据非常昂贵和/或困难，因此此选项并不总是可行的。</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 正则化 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">增加训练数据量是减少再训练的一种方法。</font><font style="vertical-align: inherit;">还有其他减少培训的方法吗？</font><font style="vertical-align: inherit;">一种可能的方法是减小网络大小。</font><font style="vertical-align: inherit;">确实，大型网络比小型网络具有更大的潜力，因此我们不愿诉诸此选项。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幸运的是，即使我们已经确定了网络和训练数据的大小，还有其他技术可以减少再训练。</font><font style="vertical-align: inherit;">它们被称为正则化技术。</font><font style="vertical-align: inherit;">在本章中，我将介绍一种最流行的技术，有时称为弱化权重或使L2正则化。</font><font style="vertical-align: inherit;">她的想法是在成本函数中添加一个称为正则化成员的额外成员。</font><font style="vertical-align: inherit;">这是带有正则化的交叉熵：</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1521"><span class="MJXp-mtable" id="MJXp-Span-1522"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1523" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1524" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1528" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1529"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1531"><span class=""><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1533" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1536"><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">[</span></span><span class="MJXp-msubsup" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1540" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mi" id="MJXp-Span-1541">ln</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1549">1</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1553" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1555">ln</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1558">1</span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1567" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">λ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1569">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1571"><span class=""><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573" style="margin-left: 0px;">w</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">w</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1576" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> C = -\frac{1}{n} \sum_{xj} \left[ y_j \ln a^L_j+(1-y_j) \ln (1-a^L_j)\right] + \frac{\lambda}{2n} \sum_w w^2 \tag{85} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一项是交叉熵的常用表达。</font><font style="vertical-align: inherit;">但是我们增加了第二个，即所有网络权重的平方和。</font><font style="vertical-align: inherit;">它由因子λ/ 2n缩放，其中λ&gt; 0是正则化参数，而n通常是训练集的大小。</font><font style="vertical-align: inherit;">我们将讨论如何选择λ。</font><font style="vertical-align: inherit;">还值得注意的是，正则化项中不包括偏差。</font><font style="vertical-align: inherit;">关于它下面。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当然，可以规范其他成本函数，例如二次函数。</font><font style="vertical-align: inherit;">这可以通过类似的方式完成：</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1591"><span class="MJXp-mtable" id="MJXp-Span-1592"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1593" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1594" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1597" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1598"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1599"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ñ</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1601"><span class=""><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Σ</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‖</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ý</font></font></span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1609" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大号</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1610"><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‖</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1612" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1614" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">λ</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1616"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1618"><span class=""><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ∑</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1623" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> C = \frac{1}{2n} \sum_x \|y-a^L\|^2 + \frac{\lambda}{2n} \sum_w w^2 \tag{86} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在两种情况下，我们都可以将正则化成本函数写为 </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1624"><span class="MJXp-mtable" id="MJXp-Span-1625"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1626" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1627" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1632" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1634" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">λ</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1636"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1638"><span class=""><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ∑</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1643" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> C = C_0 + \frac{\lambda}{2n} \sum_w w^2 \tag{87} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是未经正则化的原始成本函数。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从直觉上很明显，在所有其他条件相同的情况下，正则化的目的是说服网络选择较小的权重。</font><font style="vertical-align: inherit;">大的权重只有在它们显着改善成本函数的第一部分时才有可能。</font><font style="vertical-align: inherit;">换句话说，正则化是在找到较小的权重和最小化初始成本函数之间做出折衷选择的一种方式。</font><font style="vertical-align: inherit;">重要的是，折衷的这两个要素取决于λ的值：当λ小时，我们倾向于最小化原始成本函数；当λ大时，我们倾向于较小的权重。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根本不明白为什么选择这样的折衷办法应该有助于减少再培训！</font><font style="vertical-align: inherit;">但事实证明这很有帮助。</font><font style="vertical-align: inherit;">在下一节中，我们将弄清楚它为什么有帮助。</font><font style="vertical-align: inherit;">但是首先，让我们来看一个显示正则化确实可以减少重新训练的示例。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了构造一个例子，我们首先需要了解如何将具有随机梯度下降的训练算法应用于正则化NS。</font><font style="vertical-align: inherit;">特别是，我们需要知道如何计算网络中所有权重和偏移量的偏导数∂C/∂w和∂C/∂b。</font><font style="vertical-align: inherit;">在将等式（87）中的偏导数取后，得到：</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1644"><span class="MJXp-mtable" id="MJXp-Span-1645"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1646" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1647" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1648" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1649"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瓦特</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1653" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1654" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1655"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1658" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1659"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w的</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1662" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拉姆达</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ñ</font></font></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> w ^</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> \frac{\partial C}{\partial w} = \frac{\partial C_0}{\partial w} + \frac{\lambda}{n} w \tag{88} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1666"><span class="MJXp-mtable" id="MJXp-Span-1667"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1668" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1669" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1670" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1671"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1673"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1676" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1677"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1680" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1681"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \frac{\partial C}{\partial b} = \frac{\partial C_0}{\partial b} \tag{89} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员∂C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /∂w和∂C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /∂w可以通过或计算，如在前面的章节中描述。</font><font style="vertical-align: inherit;">我们看到，计算正则化成本函数的梯度很容易：您只需要照常使用OP，然后将λ/ nw加到所有权重项的偏导数上即可。</font><font style="vertical-align: inherit;">位移的偏导数不变，因此，通过梯度下降学习位移的规则与通常的规则没有什么不同：</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1683"><span class="MJXp-mtable" id="MJXp-Span-1684"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1685" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1686" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">η </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1692" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1693"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆PartialD;＆</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1696" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1697"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> b \rightarrow b -\eta \frac{\partial C_0}{\partial b} \tag{90} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 重量训练规则变成： </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1699"><span class="MJXp-mtable" id="MJXp-Span-1700"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1701" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1702" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瓦特</font></font></span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瓦特</font></font></span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">η </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1708" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1709"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆PartialD;＆</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1712" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1713"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W的</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1716" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ñ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拉姆达</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">n</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">w</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> w \rightarrow w-\eta \frac{\partial C_0}{\partial w}-\frac{\eta \lambda}{n} w \tag{91} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1721"><span class="MJXp-mtable" id="MJXp-Span-1722"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1723" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1724" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1726"><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1728">1</span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1730" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">η</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">λ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">w</span><span class="MJXp-mo" id="MJXp-Span-1736" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">η</span><span class="MJXp-mfrac" id="MJXp-Span-1738" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1739">∂</span><span class="MJXp-msubsup" id="MJXp-Span-1740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1742" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1743">∂</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">w</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> = \left(1-\frac{\eta \lambda}{n}\right) w -\eta \frac{\partial C_0}{\partial w} \tag{92} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一切都与通常的梯度下降法则相同，除了我们首先将权重w缩放1-ηλ/ n。这种缩放有时称为减肥，因为它减轻了体重。乍一看，权重似乎不可避免地趋于零。但这不是这样，因为如果这导致不规则成本函数的减少，则另一个术语可能导致权重增加。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好的，让梯度下降像这样工作。随机梯度下降呢？以及，如在nonregularized变随机梯度下降，我们可以估算∂C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过平均微型包米训练样例/∂w。因此，随机梯度下降的正则化学习规则变为（参见等式（20））：</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1745"><span class="MJXp-mtable" id="MJXp-Span-1746"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1747" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1748" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瓦特</font></font></span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1751"><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-1753"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1755" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">η </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">λ</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1762" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">η</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">米</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1765"><span class=""><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Σ</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1768" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1769"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1772" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w的</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> w \rightarrow \left(1-\frac{\eta \lambda}{n}\right) w -\frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial w} \tag{93} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中小包装中的训练示例x的总和，而C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是每个训练示例的不规则成本。</font><font style="vertical-align: inherit;">除重量损失因子1-ηλ/ n之外，其他所有内容均与随机梯度下降的通常规则相同。</font><font style="vertical-align: inherit;">最后，为了完成图片，让我写下一个用于偏移的正则化规则。</font><font style="vertical-align: inherit;">自然，它与不规则情况完全相同（请参见等式（21））：</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1775"><span class="MJXp-mtable" id="MJXp-Span-1776"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1777" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1778" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1783" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">η</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">米</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1786"><span class=""><span class="MJXp-mo" id="MJXp-Span-1787" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Σ</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1789" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1790"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1793" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1794"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∂ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> b \rightarrow b - \frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial b} \tag{94} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迷你包装中用于培训示例x的金额。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们看看正规化如何改变国民议会的效力。我们将使用一个包含30个隐藏神经元的网络，一个大小为10的微型数据包，学习速度为0.5以及具有交叉熵的成本函数。但是，这次我们使用正则化参数λ= 0.1。在代码中，我将此变量命名为lmbda，因为lambda字在python中用于与本主题无关的内容。我还再次使用了test_data而不是validation_data。但是我决定使用test_data，因为结果可以直接与我们早期的不规则结果进行比较。您可以轻松地更改代码，以使其使用validation_data，并确保结果相似。</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, ... evaluation_data=test_data, lmbda = <span class="hljs-number"><span class="hljs-number">0.1</span></span>, ... monitor_evaluation_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ... monitor_training_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与早期情况一样，训练数据的成本也在不断下降，而没有进行正规化：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a20/73d/9f9/a2073d9f90ed8bc7d861e48a0f8a9c75.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是这一次，test_data的准确性在所有400个时代中都在不断提高：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/695/4d8/c1b/6954d8c1ba89251488688d13a4f75613.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显然，正规化抑制了再训练。此外，与未进行正则化的情况下获得的峰的82.27％相比，其准确度已显着提高，并且峰的分类准确度达到87.1％。总的来说，我们几乎可以肯定，经过400个时代的学习，我们可以获得更好的成绩。从经验上讲，正则化似乎可以使我们的网络更好地概括知识，并显着降低再培训的影响。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果我们离开仅使用1,000张教学图片的人工环境，然后返回到完整的50,000张图像，会发生什么情况？</font><font style="vertical-align: inherit;">当然，我们已经看到，使用全套50,000张图像，再培训是一个小得多的问题。</font><font style="vertical-align: inherit;">正则化有助于改善结果吗？</font><font style="vertical-align: inherit;">让我们保留先前的超参数值-30个时期，速度0.5，最小数据包大小10。但是，我们需要更改正则化参数。</font><font style="vertical-align: inherit;">事实是，训练集的大小n从1000跃升至50000，这改变了权重1的衰减因子-ηλ/ n。</font><font style="vertical-align: inherit;">如果我们继续使用λ= 0.1，这意味着权重的削弱程度要小得多，因此，正则化的影响会降低。</font><font style="vertical-align: inherit;">我们通过接受λ= 5.0对此进行补偿。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 好的，让我们通过首先重新初始化权重来训练我们的网络： </font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, ... evaluation_data=test_data, lmbda = <span class="hljs-number"><span class="hljs-number">5.0</span></span>, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们得到的结果是：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f13/8c6/190/f138c6190ae49d3c90ddeb15b3964011.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很多令人愉快的事情。首先，我们对验证数据的分类准确性已从无正则化的95.49％增长到有正则化的96.49％。这是一个重大改进。其次，可以看出，训练和测试集上的工作结果之间的差距比以前要低得多，不到1％。差距仍然很大，但我们显然在减少再培训方面取得了重大进展。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，看看使用100个隐藏神经元和正则化参数＆lambda = 5.0时获得的分类精度。我不会对再培训进行详细的分析，这只是出于娱乐目的，以了解使用我们的新技巧（具有交叉熵和L2正则化的代价函数）可以实现多少精度。</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, lmbda=<span class="hljs-number"><span class="hljs-number">5.0</span></span>, ... evaluation_data=validation_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最终结果是对支持数据的分类精度为97.92％。与具有30个隐藏神经元的情况相比，有了很大的飞跃。您可以进行更多微调，以η= 0.1和λ= 5.0的60个周期开始该过程，并克服98％的障碍，在支持数据上达到98.04的精度。 152行代码不错！</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我将正则化描述为减少重新训练并提高分类准确性的一种方法。但是，这些并不是其唯一的优势。从经验上讲，尝试过多次启动我们的网络MNIST，每次更改权重后，我发现没有规则化的启动有时会“卡住”，很明显落入成本函数的局部最小值中。结果，不同的发射有时会产生非常不同的结果。相反，正则化使您可以轻松获得可重复的结果。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为什么会这样呢？</font><font style="vertical-align: inherit;">启发式地，当成本函数没有正则化时，在所有其他条件相同的情况下，权重向量的长度很可能会增长。</font><font style="vertical-align: inherit;">随着时间的流逝，这可能会导致很大的权重向量。</font><font style="vertical-align: inherit;">由于这个原因，比例尺的矢量可能会卡住，并显示在大致相同的方向上，这是因为由于梯度下降而导致的变化在矢量的长度较长时仅会导致方向上的微小变化。</font><font style="vertical-align: inherit;">我相信由于这种现象，我们的训练算法很难正确地研究权重空间，因此很难找到成本函数的最小值。</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN458724/">https://habr.com/ru/post/zh-CN458724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN458708/index.html">想要<s>减肥</ s>自己学习IT吗？ 问我如何</a></li>
<li><a href="../zh-CN458710/index.html">适用于PHP的空白混淆器</a></li>
<li><a href="../zh-CN458716/index.html">首先看台达Amplon RT UPS</a></li>
<li><a href="../zh-CN458718/index.html">Java JIT编译之父Cliff Click的大型访谈</a></li>
<li><a href="../zh-CN458720/index.html">hh.ru程序员学校第十次开设了一组IT专家</a></li>
<li><a href="../zh-CN458726/index.html">Habr Special //与Invasion的作者一起播客。 俄罗斯黑客简史</a></li>
<li><a href="../zh-CN458728/index.html">什么是电动自行车（来自两个制造商的五种型号的团体评测），第2部分</a></li>
<li><a href="../zh-CN458730/index.html">对抗软件开发中的复杂性</a></li>
<li><a href="../zh-CN458732/index.html">GIS？ 还是非gIS？ 那是问题</a></li>
<li><a href="../zh-CN458734/index.html">数据中心的工作日：连续7年的运作无懈可击。 关于老鼠的延续</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>