<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüîß ü¶à üìé Predecir el tiempo de soluci√≥n de tickets utilizando Machine Learning ‚óºÔ∏è ‚öôÔ∏è ‚õΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Haciendo un boleto en el sistema de gesti√≥n de proyectos y seguimiento de tareas, cada uno de nosotros est√° contento de ver los t√©rminos aproximados d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Predecir el tiempo de soluci√≥n de tickets utilizando Machine Learning</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/433166/"><p>  Haciendo un boleto en el sistema de gesti√≥n de proyectos y seguimiento de tareas, cada uno de nosotros est√° contento de ver los t√©rminos aproximados de la decisi√≥n sobre nuestra apelaci√≥n. <br>  Al recibir un flujo de boletos entrantes, una persona / equipo necesita alinearlos en prioridad y tiempo, lo que tomar√° para resolver cada apelaci√≥n. <br>  Todo esto le permite planificar su tiempo de manera m√°s efectiva para ambas partes. </p><br><p>  Bajo el corte, hablar√© sobre c√≥mo analic√© y entren√© a los modelos de ML que predicen el tiempo que lleva resolver los boletos emitidos a nuestro equipo. </p><a name="habracut"></a><br><p> Yo mismo trabajo para el puesto de SRE en un equipo llamado LAB.  Estamos recibiendo llamadas tanto de desarrolladores como de control de calidad con respecto al despliegue de nuevos entornos de prueba, sus actualizaciones a las √∫ltimas versiones de lanzamiento, soluciones a varios problemas que surgen y mucho m√°s.  Estas tareas son bastante heterog√©neas y, l√≥gicamente, requieren una cantidad diferente de tiempo para completarse.  Existe nuestro equipo durante varios a√±os y durante este tiempo se logr√≥ acumular una buena base de solicitudes.  Decid√≠ analizar esta base y en base a ella, con la ayuda del aprendizaje autom√°tico, elaborar un modelo que aborde la predicci√≥n del tiempo probable de cierre de una apelaci√≥n (ticket). </p><br><p>  En nuestro trabajo, utilizamos JIRA, sin embargo, el modelo que presento en este art√≠culo no tiene ninguna relaci√≥n con un producto espec√≠fico; no es un problema obtener la informaci√≥n necesaria de ninguna base de datos. </p><br><p>  Entonces, pasemos de las palabras a los hechos. </p><br><h2 id="predvaritelnyy-analiz-dannyh">  An√°lisis de datos preliminares. </h2><br><p>  Cargamos todo lo que necesitamos y mostramos las versiones de los paquetes utilizados. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> warnings warnings.simplefilter(<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) %matplotlib inline <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> nltk.corpus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> stopwords <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mean_absolute_error, mean_squared_error <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.neighbors <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KNeighborsRegressor <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LinearRegression <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time, date <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> package <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [pd, np, matplotlib, sklearn, nltk]: print(package.__name__, <span class="hljs-string"><span class="hljs-string">'version:'</span></span>, package.__version__)</code> </pre> </div></div><br><pre> <code class="plaintext hljs">pandas version: 0.23.4 numpy version: 1.15.0 matplotlib version: 2.2.2 sklearn version: 0.19.2 nltk version: 3.3</code> </pre> <br><p>  Descargue los datos del archivo csv.  Contiene informaci√≥n sobre boletos cerrados en los √∫ltimos 1,5 a√±os.  Antes de escribir los datos en un archivo, fueron ligeramente preprocesados.  Por ejemplo, se han eliminado comas y puntos de los campos de texto con descripciones.  Sin embargo, esto es solo un procesamiento preliminar y en el futuro el texto se borrar√° m√°s. </p><br><p>  Veamos qu√© hay en nuestro conjunto de datos.  En total, ingresaron 10783 boletos. </p><br><div class="spoiler">  <b class="spoiler_title">Explicaci√≥n de campo</b> <div class="spoiler_text"><table><tbody><tr><td width="88">  Creado </td><td>  Fecha y hora de creaci√≥n del ticket </td></tr><tr><td>  Resuelto </td><td>  Fecha y hora de cierre del boleto </td></tr><tr><td>  Resoluci√≥n_hora </td><td>  El n√∫mero de minutos transcurridos entre la creaci√≥n y el cierre de un ticket.  Se considera la hora del calendario, porque  La compa√±√≠a tiene oficinas en diferentes pa√≠ses, trabajando en diferentes zonas horarias y no hay un horario fijo para todo el departamento. </td></tr><tr><td>  Ingeniero_N </td><td>  Nombres "codificados" de ingenieros (para no dar informaci√≥n inadvertida o confidencial en el futuro, habr√° una gran cantidad de datos "codificados" en el art√≠culo, que de hecho simplemente se renombrar√°n).  Estos campos contienen el n√∫mero de tickets en el modo ‚Äúen progreso‚Äù al momento de recibir cada uno de los tickets en el conjunto de fechas presentado.  Me detendr√© en estos campos por separado hacia el final del art√≠culo, porque  Merecen atenci√≥n extra. </td></tr><tr><td>  Cesionario </td><td>  El empleado que estuvo involucrado en la resoluci√≥n del problema. </td></tr><tr><td>  Issue_type </td><td>  Tipo de boleto. </td></tr><tr><td>  Medio ambiente </td><td>  El nombre del entorno de trabajo de prueba para el que se realiz√≥ el ticket (puede significar un entorno espec√≠fico o la ubicaci√≥n en su conjunto, por ejemplo, un centro de datos). </td></tr><tr><td>  Prioridad </td><td>  Prioridad de entradas. </td></tr><tr><td>  Tipo de trabajo </td><td>  El tipo de trabajo que se espera para este ticket (agregar o quitar servidores, actualizar el entorno, trabajar con monitoreo, etc.) </td></tr><tr><td>  Descripci√≥n </td><td>  Descripci√≥n </td></tr><tr><td>  Resumen </td><td>  T√≠tulo del boleto. </td></tr><tr><td>  Vigilantes </td><td>  El n√∫mero de personas que "miran" el boleto, es decir  reciben notificaciones por correo electr√≥nico para cada actividad en el boleto. </td></tr><tr><td>  Votos </td><td>  El n√∫mero de personas que "votaron" por el boleto, lo que demuestra su importancia y su inter√©s en √©l. </td></tr><tr><td>  Reportero </td><td>  La persona que emiti√≥ el boleto. </td></tr><tr><td>  Engineer_N_vacation </td><td>  Si el ingeniero estaba de vacaciones al momento de emitir el boleto. </td></tr></tbody></table><br><pre> <code class="python hljs">df.info()</code> </pre> <br><pre> <code class="plaintext hljs">&lt;class 'pandas.core.frame.DataFrame'&gt; Index: 10783 entries, ENV-36273 to ENV-49164 Data columns (total 37 columns): Created 10783 non-null object Resolved 10783 non-null object Resolution_time 10783 non-null int64 engineer_1 10783 non-null int64 engineer_2 10783 non-null int64 engineer_3 10783 non-null int64 engineer_4 10783 non-null int64 engineer_5 10783 non-null int64 engineer_6 10783 non-null int64 engineer_7 10783 non-null int64 engineer_8 10783 non-null int64 engineer_9 10783 non-null int64 engineer_10 10783 non-null int64 engineer_11 10783 non-null int64 engineer_12 10783 non-null int64 Assignee 10783 non-null object Issue_type 10783 non-null object Environment 10771 non-null object Priority 10783 non-null object Worktype 7273 non-null object Description 10263 non-null object Summary 10783 non-null object Watchers 10783 non-null int64 Votes 10783 non-null int64 Reporter 10783 non-null object engineer_1_vacation 10783 non-null int64 engineer_2_vacation 10783 non-null int64 engineer_3_vacation 10783 non-null int64 engineer_4_vacation 10783 non-null int64 engineer_5_vacation 10783 non-null int64 engineer_6_vacation 10783 non-null int64 engineer_7_vacation 10783 non-null int64 engineer_8_vacation 10783 non-null int64 engineer_9_vacation 10783 non-null int64 engineer_10_vacation 10783 non-null int64 engineer_11_vacation 10783 non-null int64 engineer_12_vacation 10783 non-null int64 dtypes: float64(12), int64(15), object(10) memory usage: 3.1+ MB</code> </pre> </div></div><br><p>  En total, tenemos 10 campos de "objeto" (es decir, que contienen un valor de texto) y 27 campos num√©ricos. <br>  En primer lugar, busque inmediatamente las emisiones en nuestros datos.  Como puede ver, existen dichos tickets en los que el tiempo de decisi√≥n se estima en millones de minutos.  Claramente, esta no es informaci√≥n relevante, tales datos solo interferir√°n con la construcci√≥n del modelo.  Llegaron aqu√≠, porque la recopilaci√≥n de datos de JIRA se realiz√≥ mediante una consulta en el campo Resuelto, y no se cre√≥.  En consecuencia, los boletos que se cerraron en los √∫ltimos 1,5 a√±os llegaron aqu√≠, pero podr√≠an haberse abierto mucho antes.  Es hora de deshacerse de ellos.  Descartaremos los tickets que se crearon antes del 1 de junio de 2017.  Tendremos 9493 boletos restantes. </p><br><p>  En cuanto a las razones: creo que en cada proyecto puede encontrar f√°cilmente solicitudes que han estado pendientes durante bastante tiempo debido a diversas circunstancias y que a menudo se cierran no resolviendo el problema en s√≠, sino "venciendo el plazo de prescripci√≥n". </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[[<span class="hljs-string"><span class="hljs-string">'Created'</span></span>, <span class="hljs-string"><span class="hljs-string">'Resolved'</span></span>, <span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>]].sort_values(<span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>, ascending=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>).head()</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/gm/ay/ju/gmayjuxuxwxsuljj5xhg8dqrd00.png"><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df = df[df[<span class="hljs-string"><span class="hljs-string">'Created'</span></span>] &gt;= <span class="hljs-string"><span class="hljs-string">'2017-06-01 00:00:00'</span></span>] print(df.shape)</code> </pre> </div></div><br><pre> <code class="plaintext hljs">(9493, 33)</code> </pre> <br><p>  Entonces, comencemos a ver lo que podemos encontrar interesante en nuestros datos.  Para comenzar, descubramos lo m√°s simple: los entornos m√°s populares entre nuestros tickets, los "reporteros" m√°s activos y similares. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df.describe(include=[<span class="hljs-string"><span class="hljs-string">'object'</span></span>])</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/hj/ta/oe/hjtaoeo7rsqv2dcxzvzyiyqkqi4.png"><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Environment'</span></span>].value_counts().head(<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> </div></div><br><pre> <code class="plaintext hljs">Environment_104 442 ALL 368 Location02 367 Environment_99 342 Location03 342 Environment_31 322 Environment_14 254 Environment_1 232 Environment_87 227 Location01 202 Name: Environment, dtype: int64</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Reporter'</span></span>].value_counts().head()</code> </pre> </div></div><br><pre> <code class="plaintext hljs">Reporter_16 388 Reporter_97 199 Reporter_04 147 Reporter_110 145 Reporter_133 138 Name: Reporter, dtype: int64</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Worktype'</span></span>].value_counts()</code> </pre> </div></div><br><pre> <code class="plaintext hljs">Support 2482 Infrastructure 1655 Update environment 1138 Monitoring 388 QA 300 Numbers 110 Create environment 95 Tools 62 Delete environment 24 Name: Worktype, dtype: int64</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Priority'</span></span>].value_counts().plot(kind=<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>), rot=<span class="hljs-number"><span class="hljs-number">0</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>, title=<span class="hljs-string"><span class="hljs-string">'   '</span></span>);</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/bh/qh/lf/bhqhlfwmdxys3_y1k6qpdom5o4w.png"><br><p>  Bueno, algo que ya hemos aprendido.  La mayor√≠a de las veces, la prioridad para las entradas es normal, aproximadamente 2 veces menos alta e incluso menos cr√≠tica.  Muy rara vez hay una baja prioridad, aparentemente las personas tienen miedo de exponerla, creyendo que en este caso quedar√° suspendido durante un tiempo bastante largo en la cola y el tiempo para su decisi√≥n puede retrasarse.  M√°s tarde, cuando ya construiremos el modelo y analicemos sus resultados, veremos que tales temores pueden no ser infundados, ya que una baja prioridad realmente afecta el marco de tiempo para la tarea y, por supuesto, no en la direcci√≥n de la aceleraci√≥n. </p><br><p>  De las columnas para los entornos m√°s populares y los reporteros m√°s activos, vemos que Reporter_16 tiene un amplio margen, y Environment_104 ocupa el primer lugar en los entornos.  Incluso si a√∫n no lo ha adivinado, le contar√© un peque√±o secreto: este reportero es del equipo que trabaja en este entorno en particular. <br>  Veamos de qu√© tipo de entorno provienen los tickets m√°s cr√≠ticos. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[df[<span class="hljs-string"><span class="hljs-string">'Priority'</span></span>] == <span class="hljs-string"><span class="hljs-string">'Critical'</span></span>][<span class="hljs-string"><span class="hljs-string">'Environment'</span></span>].value_counts().index[<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre> </div></div><br><pre> <code class="plaintext hljs">'Environment_91'</code> </pre> <br><p>  Ahora imprimiremos informaci√≥n sobre cu√°ntos tickets con diferentes prioridades provienen del mismo entorno "cr√≠tico". </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df[df[<span class="hljs-string"><span class="hljs-string">'Environment'</span></span>] == df[df[<span class="hljs-string"><span class="hljs-string">'Priority'</span></span>] == <span class="hljs-string"><span class="hljs-string">'Critical'</span></span>][<span class="hljs-string"><span class="hljs-string">'Environment'</span></span>].value_counts().index[<span class="hljs-number"><span class="hljs-number">0</span></span>]][<span class="hljs-string"><span class="hljs-string">'Priority'</span></span>].value_counts()</code> </pre> </div></div><br><pre> <code class="plaintext hljs">High 62 Critical 57 Normal 46 Name: Priority, dtype: int64</code> </pre> <br><p>  Veamos el tiempo de ejecuci√≥n del ticket en el contexto de las prioridades.  Por ejemplo, es divertido notar que el tiempo promedio de ejecuci√≥n de un ticket con baja prioridad es m√°s de 70 mil minutos (casi 1.5 meses).  La dependencia del tiempo de ejecuci√≥n del ticket de su prioridad tambi√©n se puede rastrear f√°cilmente. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df.groupby([<span class="hljs-string"><span class="hljs-string">'Priority'</span></span>])[<span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>].describe()</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/tc/gs/gc/tcgsgc07_eog0hnm0mcj5i3m790.png"><br><p>  O aqu√≠ como un gr√°fico, el valor medio.  Como puede ver, la imagen no ha cambiado mucho, por lo tanto, las emisiones no afectan en gran medida la distribuci√≥n. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">df.groupby([<span class="hljs-string"><span class="hljs-string">'Priority'</span></span>])[<span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>].median().sort_values().plot(kind=<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>), rot=<span class="hljs-number"><span class="hljs-number">0</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>);</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/ir/zc/go/irzcgo8mkcwkmfeybj2vriormwq.png"><br><p>  Ahora veamos el tiempo promedio de soluci√≥n de boletos para cada uno de los ingenieros, dependiendo de cu√°ntos boletos ten√≠a el ingeniero en ese momento.  De hecho, estos gr√°ficos, para mi sorpresa, no muestran una sola imagen.  Para algunos, el tiempo de ejecuci√≥n aumenta a medida que aumentan los tickets actuales en el trabajo, mientras que para algunos esta relaci√≥n es lo contrario.  Para algunos, la adicci√≥n no es del todo rastreable. </p><br><p>  Sin embargo, mirando hacia el futuro nuevamente, dir√© que la presencia de esta caracter√≠stica en el conjunto de datos aument√≥ la precisi√≥n del modelo en m√°s de 2 veces y definitivamente hay un efecto en el tiempo de ejecuci√≥n.  Simplemente no lo vemos.  Y el modelo ve. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">engineers = [i.replace(<span class="hljs-string"><span class="hljs-string">'_vacation'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> df.columns <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'vacation'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> i] cols = <span class="hljs-number"><span class="hljs-number">2</span></span> rows = int(len(engineers) / cols) fig, axes = plt.subplots(nrows=rows, ncols=cols, figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(rows): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(cols): df.groupby(engineers[i * cols + j])[<span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>].mean().plot(kind=<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, rot=<span class="hljs-number"><span class="hljs-number">0</span></span>, ax=axes[i, j]).set_xlabel(<span class="hljs-string"><span class="hljs-string">'Engineer_'</span></span> + str(i * cols + j + <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> cols, rows, fig, axes</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Imagen larga como resultado</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xn/vb/zk/xnvbzk-0flci0_llfpn6ghuqpts.png"></div></div><br><p>  Hagamos una peque√±a matriz de interacci√≥n por pares de las siguientes caracter√≠sticas: tiempo de soluci√≥n del ticket, n√∫mero de votos y n√∫mero de observadores.  Con una bonificaci√≥n diagonal, tenemos la distribuci√≥n de cada atributo. </p><br><p>  De lo interesante, se puede ver la dependencia de reducir el tiempo de soluci√≥n del ticket en el creciente n√∫mero de observadores.  Tambi√©n se ve que las personas no son muy activas en el uso de los votos. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">pd.scatter_matrix(df[[<span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>, <span class="hljs-string"><span class="hljs-string">'Watchers'</span></span>, <span class="hljs-string"><span class="hljs-string">'Votes'</span></span>]], figsize=(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), diagonal=<span class="hljs-string"><span class="hljs-string">'hist'</span></span>);</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Cuadro de resultados</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bf/qo/qq/bfqoqq3djaiib4mxn1l5mdsy6ru.png"></div></div><br><p>  Entonces, realizamos un peque√±o an√°lisis preliminar de los datos, vimos las dependencias existentes entre el atributo objetivo, que es el tiempo que lleva resolver el boleto, y signos tales como el n√∫mero de votos para el boleto, el n√∫mero de "observadores" detr√°s de √©l y su prioridad.  Seguimos adelante. </p><br><h2 id="postroenie-modeli-vystraivaem-priznaki">  Construyendo un modelo.  Se√±ales de construcci√≥n </h2><br><p>  Es hora de pasar a construir el modelo en s√≠.  Pero primero, necesitamos llevar nuestras caracter√≠sticas a una forma que sea comprensible para el modelo.  Es decir  descomponga los signos categ√≥ricos en vectores dispersos y elimine el exceso.  Por ejemplo, no necesitamos los campos con la hora en que se cre√≥ y cerr√≥ el ticket en el modelo, as√≠ como el campo Asignatario, porque  finalmente utilizaremos este modelo para predecir el tiempo de ejecuci√≥n de un ticket que a√∫n no ha sido asignado a nadie ("asesinado"). </p><br><p>  El signo objetivo, como acabo de mencionar, es el momento de resolver el problema para nosotros, por lo que lo tomamos como un vector separado y tambi√©n lo eliminamos del conjunto de datos generales.  Adem√°s, algunos de los campos estaban vac√≠os debido a que los reporteros no siempre completan el campo de descripci√≥n al emitir un ticket.  En este caso, los pandas establecen sus valores en NaN, simplemente los reemplazamos con una cadena vac√≠a. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">y = df[<span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>] df.drop([<span class="hljs-string"><span class="hljs-string">'Created'</span></span>, <span class="hljs-string"><span class="hljs-string">'Resolved'</span></span>, <span class="hljs-string"><span class="hljs-string">'Resolution_time'</span></span>, <span class="hljs-string"><span class="hljs-string">'Assignee'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'Description'</span></span>].fillna(<span class="hljs-string"><span class="hljs-string">''</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'Summary'</span></span>].fillna(<span class="hljs-string"><span class="hljs-string">''</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> </div></div><br><p>  Descomponemos signos categ√≥ricos en vectores dispersos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">codificaci√≥n One-hot</a> ).  Hasta que toquemos los campos con la descripci√≥n y la tabla de contenido del ticket.  Los usaremos un poco diferente.  Algunos nombres de reportero contienen una [X].  Entonces, JIRA marca a los empleados inactivos que ya no trabajan en la empresa.  Decid√≠ dejarlos entre los signos, aunque es posible borrar los datos de ellos, porque en el futuro, cuando usemos el modelo, no veremos boletos de estos empleados. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_df</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dic, feature_list)</span></span></span><span class="hljs-function">:</span></span> out = pd.DataFrame(dic) out = pd.concat([out, pd.get_dummies(out[feature_list])], axis = <span class="hljs-number"><span class="hljs-number">1</span></span>) out.drop(feature_list, axis = <span class="hljs-number"><span class="hljs-number">1</span></span>, inplace = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> out X = create_df(df, df.columns[df.dtypes == <span class="hljs-string"><span class="hljs-string">'object'</span></span>].drop([<span class="hljs-string"><span class="hljs-string">'Description'</span></span>, <span class="hljs-string"><span class="hljs-string">'Summary'</span></span>])) X.columns = X.columns.str.replace(<span class="hljs-string"><span class="hljs-string">' \[X\]'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>)</code> </pre> </div></div><br><p>  Y ahora nos ocuparemos del campo de descripci√≥n en el ticket.  Trabajaremos con √©l de una de las formas m√°s simples: recopilaremos todas las palabras utilizadas en nuestros tickets, contaremos las m√°s populares, descartaremos las palabras "extra", aquellas que obviamente no pueden afectar el resultado, como, por ejemplo, la palabra "por favor" (por favor, toda la comunicaci√≥n en JIRA se realiza estrictamente en ingl√©s), que es el m√°s popular.  S√≠, estas son nuestras personas educadas. </p><br><p>  Tambi√©n eliminamos las " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">palabras de detenci√≥n</a> ", de acuerdo con la biblioteca nltk, y limpiamos m√°s a fondo el texto de caracteres innecesarios.  Perm√≠teme recordarte que esto es lo m√°s simple que se puede hacer con el texto.  No " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estampamos</a> " palabras, tambi√©n puede contar los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">N-gramos de</a> palabras m√°s populares, pero nos limitaremos a eso. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">all_words = np.concatenate(df[<span class="hljs-string"><span class="hljs-string">'Description'</span></span>].apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: s.split()).values) stop_words = stopwords.words(<span class="hljs-string"><span class="hljs-string">'english'</span></span>) stop_words.extend([<span class="hljs-string"><span class="hljs-string">'please'</span></span>, <span class="hljs-string"><span class="hljs-string">'hi'</span></span>, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span>, <span class="hljs-string"><span class="hljs-string">'('</span></span>, <span class="hljs-string"><span class="hljs-string">')'</span></span>, <span class="hljs-string"><span class="hljs-string">'='</span></span>, <span class="hljs-string"><span class="hljs-string">'{'</span></span>, <span class="hljs-string"><span class="hljs-string">'}'</span></span>]) stop_words.extend([<span class="hljs-string"><span class="hljs-string">'h3'</span></span>, <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-string"><span class="hljs-string">'@'</span></span>, <span class="hljs-string"><span class="hljs-string">'!'</span></span>, <span class="hljs-string"><span class="hljs-string">'#'</span></span>, <span class="hljs-string"><span class="hljs-string">'$'</span></span>, <span class="hljs-string"><span class="hljs-string">'%'</span></span>, <span class="hljs-string"><span class="hljs-string">'^'</span></span>, <span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-string"><span class="hljs-string">'(for'</span></span>, <span class="hljs-string"><span class="hljs-string">'output)'</span></span>]) stop_symbols = [<span class="hljs-string"><span class="hljs-string">'=&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'['</span></span>, <span class="hljs-string"><span class="hljs-string">']'</span></span>, <span class="hljs-string"><span class="hljs-string">'#'</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-string"><span class="hljs-string">'\\'</span></span>, <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'-&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>] words_series = pd.Series(list(all_words)) <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> all_words words_series = words_series[~words_series.isin(stop_words)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> symbol <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> stop_symbols: words_series = words_series[~words_series.str.contains(symbol, regex=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, na=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)]</code> </pre> </div></div><br><p>  Despu√©s de todo esto, obtuvimos el objeto pandas.Series que contiene todas las palabras utilizadas.  Veamos los m√°s populares y tomemos los primeros 50 de la lista para usarlos como signos.  Para cada uno de los tickets, veremos si esta palabra se usa en la descripci√≥n y, de ser as√≠, coloque 1 en la columna correspondiente, de lo contrario 0. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">usefull_words = list(words_series.value_counts().head(<span class="hljs-number"><span class="hljs-number">50</span></span>).index) print(usefull_words[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>])</code> </pre> </div></div><br><pre> <code class="plaintext hljs">['error', 'account', 'info', 'call', '{code}', 'behavior', 'array', 'update', 'env', 'actual']</code> </pre> <br><p>  Ahora, en nuestro conjunto de datos generales, crearemos columnas separadas para las palabras que hemos seleccionado.  En esto, puede deshacerse del campo de descripci√≥n en s√≠. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> usefull_words: X[<span class="hljs-string"><span class="hljs-string">'Description_'</span></span> + word] = X[<span class="hljs-string"><span class="hljs-string">'Description'</span></span>].str.contains(word).astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>) X.drop(<span class="hljs-string"><span class="hljs-string">'Description'</span></span>, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> </div></div><br><p>  Haremos lo mismo para el campo del t√≠tulo del boleto. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">all_words = np.concatenate(df[<span class="hljs-string"><span class="hljs-string">'Summary'</span></span>].apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: s.split()).values) words_series = pd.Series(list(all_words)) <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> all_words words_series = words_series[~words_series.isin(stop_words)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> symbol <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> stop_symbols: words_series = words_series[~words_series.str.contains(symbol, regex=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, na=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)] usefull_words = list(words_series.value_counts().head(<span class="hljs-number"><span class="hljs-number">50</span></span>).index) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> usefull_words: X[<span class="hljs-string"><span class="hljs-string">'Summary_'</span></span> + word] = X[<span class="hljs-string"><span class="hljs-string">'Summary'</span></span>].str.contains(word).astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>) X.drop(<span class="hljs-string"><span class="hljs-string">'Summary'</span></span>, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> </div></div><br><p>  Veamos con qu√© terminamos en la matriz de caracter√≠sticas X y el vector de respuesta y. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">print(X.shape, y.shape)</code> </pre> </div></div><br><pre> <code class="plaintext hljs">((9493, 1114), (9493,))</code> </pre> <br><p>  Ahora dividiremos estos datos en una muestra de entrenamiento (entrenamiento) y una muestra de prueba en la proporci√≥n porcentual de 75/25.  Total tenemos 7119 ejemplos en los que entrenaremos, y 2374 en los que evaluaremos nuestros modelos.  Y la dimensi√≥n de nuestra matriz de atributos aument√≥ a 1114 debido a la disposici√≥n de signos categ√≥ricos. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">X_train, X_holdout, y_train, y_holdout = train_test_split(X, y, test_size=<span class="hljs-number"><span class="hljs-number">0.25</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>) print(X_train.shape, X_holdout.shape)</code> </pre> </div></div><br><pre> <code class="plaintext hljs">((7119, 1114), (2374, 1114))</code> </pre> <br><h2 id="treniruem-model">  Entrenamos al modelo. </h2><br><h3 id="lineynaya-regressiya">  Regresi√≥n lineal </h3><br><p>  Comencemos con el modelo m√°s ligero y (menos esperado) menos preciso: la regresi√≥n lineal.  Evaluaremos tanto la precisi√≥n de los datos de entrenamiento como la muestra demorada (reservada), datos que el modelo no vio. </p><br><p>  En el caso de la regresi√≥n lineal, el modelo m√°s o menos aceptable se muestra en los datos de entrenamiento, pero la precisi√≥n en la muestra retrasada es monstruosamente baja.  Incluso mucho peor que predecir el promedio habitual para todas las entradas. </p><br><p>  Aqu√≠ debe tomar un breve descanso y contar c√≥mo el modelo eval√∫a la calidad utilizando su m√©todo de puntuaci√≥n. <br>  La evaluaci√≥n se realiza por el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">coeficiente de determinaci√≥n</a> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.298ex" height="3.262ex" viewBox="0 -987.6 26392.1 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-32" x="1074" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-3D" x="1491" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-31" x="2547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-2212" x="3270" y="0"></use><g transform="translate(4270,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6D" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-28" x="3419" y="0"></use><g transform="translate(3808,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-2212" x="4865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-68" x="6116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-61" x="6692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-74" x="7222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-79" x="7583" y="0"></use><g transform="translate(8081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6F" x="9174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-76" x="9660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-65" x="10145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-72" x="10612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-73" x="11313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-75" x="11783" y="0"></use><g transform="translate(12355,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6D" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-28" x="14483" y="0"></use><g transform="translate(14872,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-2212" x="15929" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6F" x="17180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-76" x="17665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-65" x="18151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-72" x="18617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6C" x="19069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-69" x="19367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6E" x="19713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-65" x="20313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-79" x="20780" y="0"></use><g transform="translate(21277,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMAIN-32" x="550" y="583"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>‚àí</mo><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mtext>&nbsp;</mtext><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> R ^ 2 = 1 - {\ sum_ {i = 1} ^ {m} (y_ {i} - \ hat {y}) ^ 2 \ over \ sum_ {i = 1} ^ {m} (y_ {i } - \ overline {y}) ^ 2} </script></p><br><p>  Donde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.145ex" height="2.419ex" viewBox="0 -780.1 2215 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-79" x="1717" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ hat {y} </script>  Es el resultado predicho por el modelo a <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.097ex" height="2.419ex" viewBox="0 -780.1 4347.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-76" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-65" x="1221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-72" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6C" x="2139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-69" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-6E" x="2783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-65" x="3383" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/dins/blog/433166/&amp;usg=ALkJrhhlXCC_P66yl1RVD7tJ4Vom_DsnfQ#MJMATHI-79" x="3850" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ overline {y} </script>  - el valor promedio para toda la muestra. </p><br><p>  No nos detendremos demasiado en el coeficiente ahora.  Solo notamos que no refleja completamente la precisi√≥n del modelo que nos interesa.  Por lo tanto, al mismo tiempo, utilizaremos el error absoluto medio (MAE) para evaluarlo y confiar en √©l. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">lr = LinearRegression() lr.fit(X_train, y_train) print(<span class="hljs-string"><span class="hljs-string">'R^2 train:'</span></span>, lr.score(X_train, y_train)) print(<span class="hljs-string"><span class="hljs-string">'R^2 test:'</span></span>, lr.score(X_holdout, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>, mean_absolute_error(lr.predict(X_train), y_train)) print(<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>, mean_absolute_error(lr.predict(X_holdout), y_holdout))</code> </pre> </div></div><br><pre> <code class="plaintext hljs">R^2 train: 0.3884389470220214 R^2 test: -6.652435243123196e+17 MAE train: 8503.67256637168 MAE test: 1710257520060.8154</code> </pre> <br><h3 id="gradientnyy-busting">  Aumento de gradiente </h3><br><p>  Bueno, ¬ød√≥nde sin √©l, sin aumento de gradiente?  Intentemos entrenar al modelo y ver qu√© sucede.  Usaremos el notorio XGBoost para esto.  Comencemos con la configuraci√≥n est√°ndar de hiperpar√°metros. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> xgboost xgb = xgboost.XGBRegressor() xgb.fit(X_train, y_train) print(<span class="hljs-string"><span class="hljs-string">'R^2 train:'</span></span>, xgb.score(X_train, y_train)) print(<span class="hljs-string"><span class="hljs-string">'R^2 test:'</span></span>, xgb.score(X_holdout, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>, mean_absolute_error(xgb.predict(X_train), y_train)) print(<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>, mean_absolute_error(xgb.predict(X_holdout), y_holdout))</code> </pre> </div></div><br><pre> <code class="plaintext hljs">R^2 train: 0.5138516547636054 R^2 test: 0.12965507684512545 MAE train: 7108.165167471887 MAE test: 8343.433260957032</code> </pre> <br><p>  El resultado fuera de la caja ya no es malo.  Intentemos modelar el modelo seleccionando hiperpar√°metros: n_estimators, learning_rate y max_depth.  Como resultado, nos detenemos en los valores de 150, 0.1 y 3, respectivamente, que muestran el mejor resultado en la muestra de prueba en ausencia de sobreentrenamiento del modelo en los datos de entrenamiento. </p><br><div class="spoiler">  <b class="spoiler_title">Seleccionamos n_estimators</b> <div class="spoiler_text"><p>  * <em>En lugar de R ^ 2, la puntuaci√≥n en la imagen debe ser MAE.</em> </p><br><pre> <code class="python hljs">xgb_model_abs_testing = list() xgb_model_abs_training = list() rng = np.arange(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">151</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rng: xgb = xgboost.XGBRegressor(n_estimators=i) xgb.fit(X_train, y_train) xgb.score(X_holdout, y_holdout) xgb_model_abs_testing.append(mean_absolute_error(xgb.predict(X_holdout), y_holdout)) xgb_model_abs_training.append(mean_absolute_error(xgb.predict(X_train), y_train)) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) plt.plot(rng, xgb_model_abs_testing, label=<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>); plt.plot(rng, xgb_model_abs_training, label=<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Number of estimators'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'$R^2 Score$'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) plt.show();</code> </pre> <br><img src="https://habrastorage.org/webt/yw/_k/fe/yw_kfe9ov-i5usxjjbvhgnyjnss.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Seleccionamos learning_rate</b> <div class="spoiler_text"><pre> <code class="python hljs">xgb_model_abs_testing = list() xgb_model_abs_training = list() rng = np.arange(<span class="hljs-number"><span class="hljs-number">0.05</span></span>, <span class="hljs-number"><span class="hljs-number">0.65</span></span>, <span class="hljs-number"><span class="hljs-number">0.05</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rng: xgb = xgboost.XGBRegressor(n_estimators=<span class="hljs-number"><span class="hljs-number">150</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, learning_rate=i) xgb.fit(X_train, y_train) xgb.score(X_holdout, y_holdout) xgb_model_abs_testing.append(mean_absolute_error(xgb.predict(X_holdout), y_holdout)) xgb_model_abs_training.append(mean_absolute_error(xgb.predict(X_train), y_train)) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) plt.plot(rng, xgb_model_abs_testing, label=<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>); plt.plot(rng, xgb_model_abs_training, label=<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Learning rate'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'MAE'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) plt.show();</code> </pre> <br><img src="https://habrastorage.org/webt/iv/7n/5n/iv7n5n1dfgccqjx2frkjsjdzxxq.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Seleccionamos max_depth</b> <div class="spoiler_text"><pre> <code class="python hljs">xgb_model_abs_testing = list() xgb_model_abs_training = list() rng = np.arange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rng: xgb = xgboost.XGBRegressor(n_estimators=<span class="hljs-number"><span class="hljs-number">150</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, learning_rate=<span class="hljs-number"><span class="hljs-number">0.1</span></span>, max_depth=i) xgb.fit(X_train, y_train) xgb.score(X_holdout, y_holdout) xgb_model_abs_testing.append(mean_absolute_error(xgb.predict(X_holdout), y_holdout)) xgb_model_abs_training.append(mean_absolute_error(xgb.predict(X_train), y_train)) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) plt.plot(rng, xgb_model_abs_testing, label=<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>); plt.plot(rng, xgb_model_abs_training, label=<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Maximum depth'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'MAE'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) plt.show();</code> </pre> <br><img src="https://habrastorage.org/webt/2b/ej/70/2bej70cirp-wehkeolsd-6klzic.png"></div></div><br><p>  Ahora entrenaremos el modelo con hiperpar√°metros seleccionados. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">xgb = xgboost.XGBRegressor(n_estimators=<span class="hljs-number"><span class="hljs-number">150</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, learning_rate=<span class="hljs-number"><span class="hljs-number">0.1</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">3</span></span>) xgb.fit(X_train, y_train) print(<span class="hljs-string"><span class="hljs-string">'R^2 train:'</span></span>, xgb.score(X_train, y_train)) print(<span class="hljs-string"><span class="hljs-string">'R^2 test:'</span></span>, xgb.score(X_holdout, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>, mean_absolute_error(xgb.predict(X_train), y_train)) print(<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>, mean_absolute_error(xgb.predict(X_holdout), y_holdout))</code> </pre> </div></div><br><pre> <code class="plaintext hljs">R^2 train: 0.6745967150462303 R^2 test: 0.15415143189670344 MAE train: 6328.384400466232 MAE test: 8217.07897417256</code> </pre> <br><p>  El resultado final con los par√°metros seleccionados y la funci√≥n de visualizaci√≥n son importantes: la importancia de los signos seg√∫n el modelo.  En primer lugar, es el n√∫mero de observadores de boletos, pero luego 4 ingenieros van de inmediato.  En consecuencia, el tiempo de empleo de un boleto puede verse muy afectado por el empleo de un ingeniero.  Y es l√≥gico que el tiempo libre de algunos de ellos sea m√°s importante.  Al menos porque el equipo tiene ingenieros superiores y medios (no tenemos juniors en el equipo).  Por cierto, nuevamente en secreto, el ingeniero en primer lugar (barra naranja) es realmente uno de los m√°s experimentados de todo el equipo.  Adem√°s, los 4 de estos ingenieros tienen un prefijo senior en su puesto.  Resulta que el modelo una vez m√°s confirm√≥ esto. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs">features_df = pd.DataFrame(data=xgb.feature_importances_.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), columns=X.columns).sort_values(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, by=[<span class="hljs-number"><span class="hljs-number">0</span></span>], ascending=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) features_df.loc[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>].plot(kind=<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>), rot=<span class="hljs-number"><span class="hljs-number">75</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>);</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/yn/er/7o/yner7ojqi-tz7a5je4g8phkmyki.png"><br><h3 id="neyronnaya-set">  Red neuronal </h3><br><p>  Pero no nos detendremos en un aumento de gradiente e intentaremos entrenar la red neuronal, o m√°s bien el perceptr√≥n multicapa, una red neuronal de distribuci√≥n directa totalmente conectada.  Esta vez no comenzaremos con la configuraci√≥n est√°ndar de hiperpar√°metros, como  en la biblioteca sklearn, que usaremos, por defecto solo hay una capa oculta con 100 neuronas y durante el entrenamiento el modelo da una advertencia sobre el desacuerdo para las 200 iteraciones est√°ndar.  Inmediatamente utilizamos 3 capas ocultas con 300, 200 y 100 neuronas, respectivamente. </p><br><p>  Como resultado, vemos que el modelo no est√° sobreentrenado en la muestra de entrenamiento, lo que, sin embargo, no evita que muestre un resultado decente en la muestra de prueba.  Este resultado es bastante inferior al resultado del aumento de gradiente. </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fuente</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.neural_network <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MLPRegressor nn = MLPRegressor(random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, hidden_layer_sizes=(<span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span> ,<span class="hljs-number"><span class="hljs-number">100</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.03</span></span>, learning_rate=<span class="hljs-string"><span class="hljs-string">'adaptive'</span></span>, learning_rate_init=<span class="hljs-number"><span class="hljs-number">0.0005</span></span>, max_iter=<span class="hljs-number"><span class="hljs-number">200</span></span>, momentum=<span class="hljs-number"><span class="hljs-number">0.9</span></span>, nesterovs_momentum=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) nn.fit(X_train, y_train) print(<span class="hljs-string"><span class="hljs-string">'R^2 train:'</span></span>, nn.score(X_train, y_train)) print(<span class="hljs-string"><span class="hljs-string">'R^2 test:'</span></span>, nn.score(X_holdout, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>, mean_absolute_error(nn.predict(X_train), y_train)) print(<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>, mean_absolute_error(nn.predict(X_holdout), y_holdout))</code> </pre> </div></div><br><pre> <code class="plaintext hljs">R^2 train: 0.9771443840549647 R^2 test: -0.15166596239118246 MAE train: 1627.3212161350423 MAE test: 8816.204561947616</code> </pre> <br><p>  Veamos qu√© podemos lograr al tratar de elegir la mejor arquitectura de nuestra red.             ,     ,          200  ,    ,      .       . </p><br><div class="spoiler"> <b class="spoiler_title">   </b> <div class="spoiler_text"><pre> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [(<span class="hljs-number"><span class="hljs-number">500</span></span>,), (<span class="hljs-number"><span class="hljs-number">750</span></span>,), (<span class="hljs-number"><span class="hljs-number">1000</span></span>,), (<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>)]: nn = MLPRegressor(random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, hidden_layer_sizes=i, alpha=<span class="hljs-number"><span class="hljs-number">0.03</span></span>, learning_rate=<span class="hljs-string"><span class="hljs-string">'adaptive'</span></span>, learning_rate_init=<span class="hljs-number"><span class="hljs-number">0.0005</span></span>, max_iter=<span class="hljs-number"><span class="hljs-number">200</span></span>, momentum=<span class="hljs-number"><span class="hljs-number">0.9</span></span>, nesterovs_momentum=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) nn.fit(X_train, y_train) plt.plot(nn.loss_curve_, label=str(i)); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Iterations'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'MSE'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) plt.show()</code> </pre> <br><img src="https://habrastorage.org/webt/eg/xx/3k/egxx3kwhm28pfdsbvn_sp2_sewo.png"></div></div><br><p>         .  3    10        . </p><br><div class="spoiler"> <b class="spoiler_title">   </b> <div class="spoiler_text"><pre> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [(<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">300</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>), (<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), (<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), (<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), (<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), (<span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">250</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)]: nn = MLPRegressor(random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, hidden_layer_sizes=i, alpha=<span class="hljs-number"><span class="hljs-number">0.03</span></span>, learning_rate=<span class="hljs-string"><span class="hljs-string">'adaptive'</span></span>, learning_rate_init=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, max_iter=<span class="hljs-number"><span class="hljs-number">200</span></span>, momentum=<span class="hljs-number"><span class="hljs-number">0.9</span></span>, nesterovs_momentum=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) nn.fit(X_train, y_train) plt.plot(nn.loss_curve_, label=str(i)); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Iterations'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'MSE'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) plt.show()</code> </pre> <br><img src="https://habrastorage.org/webt/p9/8z/d7/p98zd7u3ppxuzyykvyt91skxjiq.png"></div></div><br><p>    ""    (200, 100, 100, 100, 80, 80, 80, 40, 20)    : <br> 2506    <br> 7351    </p><br><p>   ,    ,        .      learning rate    . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs">nn = MLPRegressor(random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>, hidden_layer_sizes=(<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.1</span></span>, learning_rate=<span class="hljs-string"><span class="hljs-string">'adaptive'</span></span>, learning_rate_init=<span class="hljs-number"><span class="hljs-number">0.007</span></span>, max_iter=<span class="hljs-number"><span class="hljs-number">200</span></span>, momentum=<span class="hljs-number"><span class="hljs-number">0.9</span></span>, nesterovs_momentum=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) nn.fit(X_train, y_train) print(<span class="hljs-string"><span class="hljs-string">'R^2 train:'</span></span>, nn.score(X_train, y_train)) print(<span class="hljs-string"><span class="hljs-string">'R^2 test:'</span></span>, nn.score(X_holdout, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'MAE train'</span></span>, mean_absolute_error(nn.predict(X_train), y_train)) print(<span class="hljs-string"><span class="hljs-string">'MAE test'</span></span>, mean_absolute_error(nn.predict(X_holdout), y_holdout))</code> </pre> </div></div><br><pre> <code class="plaintext hljs">R^2 train: 0.836204705204337 R^2 test: 0.15858607391959356 MAE train: 4075.8553476632796 MAE test: 7530.502826043687</code> </pre> <br><p>  ,  .      ,        .   ,       ,    . </p><br><p>     .    :                 ( ,   200 ).  ,        ""   .  , 30   200 ,   issue type: Epic       .         , ..    ,   ,                ,     ,           .    4  5    .         ,    .           ,      . </p><br><p>       ‚Äî      9  ,             .     ,           ,        ,          . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs">pd.Series([X_train.columns[abs(nn.coefs_[<span class="hljs-number"><span class="hljs-number">0</span></span>][:,i]).argmax()] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(nn.hidden_layer_sizes[<span class="hljs-number"><span class="hljs-number">0</span></span>])]).value_counts().head(<span class="hljs-number"><span class="hljs-number">5</span></span>).sort_values().plot(kind=<span class="hljs-string"><span class="hljs-string">'barh'</span></span>, title=<span class="hljs-string"><span class="hljs-string">'Feature importance'</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>));</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/t3/f_/pk/t3f_pkvagtacmshpf6ultiteoki.png"><br><h2 id="ansambl-modeley">   </h2><br><p>             .  Por qu√©       7530   8217.     (7530 + 8217) / 2 = 7873,  ,    , ?  No, no asi.    ,   .     ,     7526. </p><br><p>      ,     kaggle .     , ,    . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs">nn_predict = nn.predict(X_holdout) xgb_predict = xgb.predict(X_holdout) print(<span class="hljs-string"><span class="hljs-string">'NN MSE:'</span></span>, mean_squared_error(nn_predict, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'XGB MSE:'</span></span>, mean_squared_error(xgb_predict, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'Ensemble:'</span></span>, mean_squared_error((nn_predict + xgb_predict) / <span class="hljs-number"><span class="hljs-number">2</span></span>, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'NN MAE:'</span></span>, mean_absolute_error(nn_predict, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'XGB MSE:'</span></span>, mean_absolute_error(xgb_predict, y_holdout)) print(<span class="hljs-string"><span class="hljs-string">'Ensemble:'</span></span>, mean_absolute_error((nn_predict + xgb_predict) / <span class="hljs-number"><span class="hljs-number">2</span></span>, y_holdout))</code> </pre> </div></div><br><pre> <code class="plaintext hljs">NN MSE: 628107316.262393 XGB MSE: 631417733.4224195 Ensemble: 593516226.8298339 NN MAE: 7530.502826043687 XGB MSE: 8217.07897417256 Ensemble: 7526.763569558157</code> </pre> <br><h2 id="analiz-rezultatov">   </h2><br><p>       ?      7500   .  Es decir  5   .          .     .  ,         . </p><br><p>      ( ): </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs">((nn_predict + xgb_predict) / <span class="hljs-number"><span class="hljs-number">2</span></span> - y_holdout).apply(np.abs).sort_values(ascending=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>).head(<span class="hljs-number"><span class="hljs-number">10</span></span>).values</code> </pre> </div></div><br><pre> <code class="plaintext hljs">[469132.30504392, 454064.03521379, 252946.87342439, 251786.22682697, 224012.59016987, 15671.21520735, 13201.12440327, 203548.46460229, 172427.32150665, 171088.75543224]</code> </pre> <br><p>  . ,    . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs">df.loc[((nn_predict + xgb_predict) / <span class="hljs-number"><span class="hljs-number">2</span></span> - y_holdout).apply(np.abs).sort_values(ascending=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>).head(<span class="hljs-number"><span class="hljs-number">10</span></span>).index][[<span class="hljs-string"><span class="hljs-string">'Issue_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'Priority'</span></span>, <span class="hljs-string"><span class="hljs-string">'Worktype'</span></span>, <span class="hljs-string"><span class="hljs-string">'Summary'</span></span>, <span class="hljs-string"><span class="hljs-string">'Watchers'</span></span>]]</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/9d/sy/mt/9dsymtwss-2wkd1xy_3h0nx3qvu.png"><br><p>           ,       -  ,          .     4           . </p><br><p>    ,       . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs">print(((nn_predict + xgb_predict) / <span class="hljs-number"><span class="hljs-number">2</span></span> - y_holdout).apply(np.abs).sort_values().head(<span class="hljs-number"><span class="hljs-number">10</span></span>).values) df.loc[((nn_predict + xgb_predict) / <span class="hljs-number"><span class="hljs-number">2</span></span> - y_holdout).apply(np.abs).sort_values().head(<span class="hljs-number"><span class="hljs-number">10</span></span>).index][[<span class="hljs-string"><span class="hljs-string">'Issue_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'Priority'</span></span>, <span class="hljs-string"><span class="hljs-string">'Worktype'</span></span>, <span class="hljs-string"><span class="hljs-string">'Summary'</span></span>, <span class="hljs-string"><span class="hljs-string">'Watchers'</span></span>]]</code> </pre> </div></div><br><pre> <code class="plaintext hljs">[ 1.24606014, 2.6723969, 4.51969139, 10.04159236, 11.14335444, 14.4951508, 16.51012874, 17.78445744, 21.56106258, 24.78219295]</code> </pre> <br><img src="https://habrastorage.org/webt/c0/ah/h7/c0ahh76a9u5tti2oinyzpycip3c.png"><br><p> ,      ,     -     ,    -        . ,  ,            ,     . </p><br><h2 id="kak-pole-engineer-uvelichilo-tochnost">   Engineer   </h2><br><p> ,        'Engineer',    ,   ,         ?  . </p><br><p>   ,             2 . , ,    ,       ,       .  ,  ,   ,     ""    ,       (  ) ,         ,     ,   . ,         " ",              . </p><br><p>    ,      .      ,     ,                     12 ,     (  JQL   JIRA): </p><br><pre> <code class="sql hljs">assignee was engineer_N during (ticket_creation_date) and status was "In Progress"</code> </pre> <br><p>    10783 * 12 = 129396 ,  ‚Ä¶ . ,  ,                 , ..   5   . <br>  ,    ,     ,   ,      2 .              . </p><br><h2 id="itogi-i-plany-na-buduschee">      </h2><br><p>               .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SLO</a>    ,    . </p><br><p>  ,          ,      (      : -   , -  ,  -    )        ,           . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433166/">https://habr.com/ru/post/es433166/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433144/index.html">.NET Core 2.2 lanzado. Que hay de nuevo (1 de 3)</a></li>
<li><a href="../es433146/index.html">[competencia] Top 25 consolas de juegos (agitar viejos tiempos)</a></li>
<li><a href="../es433154/index.html">Se espera experiencia de usuario 5G NR en el mundo real</a></li>
<li><a href="../es433158/index.html">Parodias musicales de SUSE sobre Kubernetes, Linus Torvalds y otros.</a></li>
<li><a href="../es433164/index.html">R√°pido y furioso: Forza Horizon 4 acelera con los sombreadores de ventanas</a></li>
<li><a href="../es433168/index.html">¬øPor qu√© un programador tiene una pasant√≠a en la cocina? Una conversaci√≥n con Dodo Pizza sobre gemba, .NET y apertura.</a></li>
<li><a href="../es433170/index.html">C√≥mo no pudimos rehacer la arquitectura de la empresa</a></li>
<li><a href="../es433172/index.html">Fijamos el modo multijugador al juego m√≥vil "Hacer palabras a partir de palabras" en iOS y Android, escrito en C ++</a></li>
<li><a href="../es433174/index.html">No todos los parches son igualmente √∫tiles.</a></li>
<li><a href="../es433176/index.html">Certificado de Docker Remote API de autenticaci√≥n con verificaci√≥n de revocaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>