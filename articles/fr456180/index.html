<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö¥üèΩ üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ üé¥ Comment ai-je trouv√© ma premi√®re vuln√©rabilit√©? üé∂ üçÖ üìΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©face 
 Bonjour √† tous. J'ai 20 ans. Jusqu'√† r√©cemment, j'ai √©tudi√© au Lyceum et je me pr√©parais √† entrer dans une universit√© m√©dicale, et maintenan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment ai-je trouv√© ma premi√®re vuln√©rabilit√©?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456180/"><h3>  Pr√©face </h3><br>  Bonjour √† tous.  J'ai 20 ans.  Jusqu'√† r√©cemment, j'ai √©tudi√© au Lyceum et je me pr√©parais √† entrer dans une universit√© m√©dicale, et maintenant je suis d√©veloppeur √† part enti√®re dans une entreprise am√©ricaine.  En fait, je suis tr√®s heureux de ne pas avoir r√©ussi avec la m√©decine - la programmation √©tait mon hobby, et maintenant je peux le faire tout le temps.  Maintenant, je pr√©f√®re ne pas √©crire sur le succ√®s en informatique.  En ce moment, je veux parler de la fa√ßon dont j'ai lu quelques livres sur les vuln√©rabilit√©s (pour prot√©ger mes projets) et j'ai r√©ussi √† mettre ces connaissances en pratique. <br><br><h3>  Clause de non-responsabilit√© </h3><br>  Tous les documents, captures d'√©cran et liens vers des ressources tierces sont publi√©s √† des fins √©ducatives.  L'auteur n'est pas responsable de leur utilisation par d'autres visiteurs du Habr.  L'entreprise a √©t√© inform√©e √† l'avance de 48 heures de la vuln√©rabilit√© et a re√ßu suffisamment de donn√©es pour la corriger. <br><a name="habracut"></a><br><h2>  Comment tout a commenc√© </h2><br>  C'√©tait une journ√©e tr√®s ordinaire.  J'ai accompli plusieurs t√¢ches au travail et pr√©par√© une tasse de caf√©.  En m√™me temps, j'ai d√©cid√© de lire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article</a> sur le d√©ploiement de l'application sur AWS, que j'ai republi√© une fois en VK (au fait, je n'ai jamais lu l'article).  La colonne √† droite de l'article affiche plusieurs autres articles et une <b>banni√®re partenaire pour le fournisseur d'h√©bergement</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f8/47a/a34/8f847aa343de32b3f8e385a1d691259b.png" alt="image"><br><br>  Je ne me souviens pas exactement de ce qui m'a fait aller sur le site, mais pendant la transition, j'ai remarqu√© une caract√©ristique int√©ressante: le lien m√®ne √† la page d'inscription et il a imm√©diatement rempli un champ - un code promotionnel. <br><br>  Si nous comparons le code promotionnel, qui se trouve dans le champ de saisie et dans la barre d'adresse, nous voyons qu'il correspond compl√®tement. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/458/0be/bcc/4580bebcc578ee1a923cd2973093c0d9.png" alt="image"><br><br><h2>  Que pouvons-nous y faire? </h2><br>  Il est courant d'essayer de changer.  Si le code promotionnel est compar√© √† la valeur dans la base de donn√©es - avec une probabilit√© √©lev√©e, nous obtiendrons une erreur.  Mais lors de la modification de l'entr√©e - il n'y a pas de demande au serveur et il s'av√®re que l'entr√©e n'est v√©rifi√©e que lorsque vous cliquez sur le bouton d'enregistrement. <br><br>  Je pense qu'ici, vous pouvez d√©j√† faire quelque chose de plus int√©ressant: changez notre code promotionnel directement dans la barre d'adresse et voyez ce qui se passe.  S'ils n'ont pas de code promotionnel sp√©cifiquement pour le Habr que j'ai devin√© tout de suite, <s>ainsi qu'une centaine de jeux de caract√®res diff√©rents</s> , nous pouvons d√©finitivement changer les valeurs du champ de saisie en utilisant le lien d'adresse. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b5/dad/ca0/2b5dadca07aa57c01f7af71162effabf.png" alt="image"><br><br>  L'√©tape suivante consiste √† regarder le code HTML.  RMB dans le champ de saisie -&gt; Afficher le code article. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e5/76c/6f0/1e576c6f0af03c3e06c7db8f0374af68.png" alt="image"><br><br>  Ici, vous pouvez voir tout de suite que nous modifions la valeur du champ de saisie.  Essayons de le quitter et ajoutons par exemple un lien.  Pour ce faire, il suffit de changer le lien et nous pouvons changer le contenu de la page: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f36/e33/a28/f36e33a28083d6c544d340f54ba51676.png" alt="image"><br><br>  R√©sultat: nous venons de trouver une vuln√©rabilit√© xss sur le site du h√©bergeur. <br><br><h2>  Et maintenant? </h2><br>  Je pense que √ßa vaut la peine d'aller plus loin.  Le lien est en quelque sorte superficiel et pas int√©ressant.  Nous voulons dire tout cela aux propri√©taires du service et, id√©alement, obtenir une r√©compense (la soci√©t√©, en passant, n'a pas de prime de bogue, ce qui signifie que tout cela n'est pas pay√©, mais je ne le savais toujours pas).  Essayons de placer le bloc, de le stabiliser et d'ins√©rer l'image.  Que faut-il pour cela?  tout de m√™me - changer l'url. <br><br>  Je pense que d√©crire html et css ne vaut pas la peine, alors je viens de mettre ici ce qui s'est pass√©.  Habr bloque une partie des balises, en jette d'autres - je ne peux pas mettre le code du lien ici. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4d/22c/2e0/e4d22c2e0478fcd98e3804d8125792bc.png" alt="image"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://upcloud.com/signup/%3Fpromo%3D%2522%253E%2B%253Cdiv%2520class%3Dblack%2520style%3Dwidth:100%25%3Bheight:400px%3Bbackground-color:red%3Bpadding:10px%3Bopacity:0.7%3Bborder:5px%3Bborder-style:solid%3Bborder-color:teal%3Bborder-radius:10px%253EYour%2520WebSite%2520have%2520been%2520hacked!%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cimg%2520src%3D">Je posterai un lien ici.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://upcloud.com/signup/%3Fpromo%3D%2522%253E%2B%253Cdiv%2520class%3Dblack%2520style%3Dwidth:100%25%3Bheight:400px%3Bbackground-color:red%3Bpadding:10px%3Bopacity:0.7%3Bborder:5px%3Bborder-style:solid%3Bborder-color:teal%3Bborder-radius:10px%253EYour%2520WebSite%2520have%2520been%2520hacked!%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cimg%2520src%3D">Je ne sais pas si elle travaille en ce moment, mais quand elle a post√© le poste, elle a travaill√©.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://upcloud.com/signup/%3Fpromo%3D%2522%253E%2B%253Cdiv%2520class%3Dblack%2520style%3Dwidth:100%25%3Bheight:400px%3Bbackground-color:red%3Bpadding:10px%3Bopacity:0.7%3Bborder:5px%3Bborder-style:solid%3Bborder-color:teal%3Bborder-radius:10px%253EYour%2520WebSite%2520have%2520been%2520hacked!%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cbr%253E%253Cimg%2520src%3D">Qui en a besoin - retire le lien et analyse.</a> <br><br><h3>  R√©mun√©ration </h3><br>  Ne pensez pas que upCloud a compl√®tement refus√© de payer.  Au lieu de cela, ils ont offert leurs services gratuitement.  Mais j'ai refus√© ce type de paiement, car je ne suis pas int√©ress√© par la location d'un serveur maintenant. <br><br><h3>  Comment exploiter cette vuln√©rabilit√©? </h3><br>  Ici, tout est simple: vous pouvez commencer par collecter les donn√©es de tous les nouveaux utilisateurs, puis terminer par les sites de phishing et utiliser l'h√©bergement de quelqu'un d'autre comme le v√¥tre.  Vous pouvez remplacer tous les liens de la page par les v√¥tres ou remplacer le formulaire par des utilisateurs.  Il suffit de les envoyer comme r√©f√©rences.  Et bien s√ªr, vous pouvez substituer une demande au serveur √† partir du formulaire afin qu'il ne v√©rifie pas le code promotionnel (lors de l'inscription, le code promotionnel est v√©rifi√© et la r√©ponse est retourn√©e au client avec une erreur, mais tout est r√©solu en activant zhs). <br><br><h2>  Ce que les d√©veloppeurs ont oubli√© de faire: </h2><br>  C'est simple - valider l'entr√©e utilisateur.  SQL-Inj ne fonctionne pas l√†-bas - le service se bloque sur WordPress, et √† son tour, traite les lignes entrantes. <br><br>  Par cons√©quent, nous pouvons: <br><br><ol><li>  V√©rifiez le code promo avec la base lors du rendu de la page <br><br>  C'est lent et non justifi√©.  Il n'y a pas de charge suppl√©mentaire sur la base de donn√©es, et cela ne sert √† rien si elle est toujours v√©rifi√©e lors de l'inscription. <br></li><li>  Conduisez le code promotionnel tout au long de la saison r√©guli√®re <br><br>  / ^ [A-Z0-9] + $ / - suffit pour valider les valeurs et se prot√©ger contre les vuln√©rabilit√©s.  Et cela fonctionne plus rapidement que l'interrogation de la base de donn√©es, et l'effet n'est pas pire - XSS est supprim√©. <br></li></ol><br><h2>  Conclusion </h2><br>  Les propri√©taires du service ont √©t√© inform√©s 48 heures + 2 jours avant que je n√©gocie par e-mail et LinkedIn avec ceux qui √©taient en quelque sorte li√©s au d√©veloppement.  Toutes les conversations ont abouti: ¬´Veuillez nous dire comment vous avez proc√©d√©, mais bien s√ªr, nous ne paierons pas les vuln√©rabilit√©s.¬ª  J'ajouterai √©galement que, de la m√™me mani√®re, le site accepte les scripts js tiers: √† la fois via une source tierce et par √©criture directe de code, cependant, dans le deuxi√®me cas, Google Chrome d√©tecte automatiquement xss et affiche une page d'erreur au lieu d'une page de service. <br><br>  J'esp√®re que chaque programmeur validera toutes les donn√©es d'entr√©e et n'oubliera pas la cha√Æne de requ√™te.  Et je suis √©galement s√ªr que l'article aidera quelqu'un √† remarquer √† l'avance + √† r√©soudre ce probl√®me √† la maison. <br><br>  Merci beaucoup pour votre attention. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456180/">https://habr.com/ru/post/fr456180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456168/index.html">O√π √©tait ta maison il y a des millions d'ann√©es?</a></li>
<li><a href="../fr456170/index.html">Comment cr√©er une application financi√®re: 5 API pour aider le d√©veloppeur</a></li>
<li><a href="../fr456172/index.html">Partie 2: RocketChip: connexion de la RAM</a></li>
<li><a href="../fr456174/index.html">Comment organiser un hackathon en tant qu'√©tudiant 101. Deuxi√®me partie</a></li>
<li><a href="../fr456178/index.html">Th√®mes et styles Android sans magie. Et comment les cuisiner avec SwitchCompat</a></li>
<li><a href="../fr456182/index.html">Audio via Bluetooth: informations les plus d√©taill√©es sur les profils, les codecs et les appareils</a></li>
<li><a href="../fr456184/index.html">Radio d√©finie par logiciel - comment √ßa marche? Partie 8</a></li>
<li><a href="../fr456186/index.html">CS231n: R√©seaux de neurones convolutifs pour la reconnaissance de formes</a></li>
<li><a href="../fr456188/index.html">Jeton, jeton d'actualisation et cr√©ation d'un wrapper asynchrone pour une demande REST</a></li>
<li><a href="../fr456192/index.html">Des monolithes aux microservices: l'exp√©rience de M.Video-Eldorado et MegaFon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>