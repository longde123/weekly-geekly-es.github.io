<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍⚕️ 👵🏽 👩🏼‍🍳 只有没有双手！ 不重复用户操作的机器人 🤰🏾 👈 👩‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="这篇评论文章介绍了如何将RPA用于业务流程，其中包括普通人无法执行，不想执行的任务，或者需要花费大量时间并且需要特殊知识（例如使用FTP，数据库）的业务流程或API。 

 在此过程中包含此类操作，使其创建更接近于传统编程和“脚本”，并且具有该方法的优点和缺点。 

 即使在传统的机器人技术任务中使...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>只有没有双手！ 不重复用户操作的机器人</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446092/">这篇评论文章介绍了如何将RPA用于业务流程，其中包括普通人无法执行，不想执行的任务，或者需要花费大量时间并且需要特殊知识（例如使用FTP，数据库）的业务流程或API。 <br><br> 在此过程中包含此类操作，使其创建更接近于传统编程和“脚本”，并且具有该方法的优点和缺点。 <br><br> 即使在传统的机器人技术任务中使用API​​，也可以显着提高执行速度，可靠性和稳定性，但与此同时，它使我们无法实现业务用户自己创建和维护流程的梦想，绝对可以将开发和支持交还给他们开发团队。 <br><br> 在可能的情况下，以及有必要在过程中将操作添加到较低级别时，我将尝试在本文中讲述。 第一部分是介绍性内容，第二部分是具体示例。 给出了一个我很熟悉的平台（UiPath）的示例，因此对于那些喜欢其他口味和颜色的机器人的人，请不要被冒犯。 <br><br><img src="https://habrastorage.org/webt/ru/je/ca/rujecadz9jbx5ofmb9-krdg5ylk.png" title="机械臂向仿生机器人下达订单"><br><a name="habracut"></a><br><h2> 赞成和反对机器人学低 </h2><br><h3> 为什么这样的机器人有用？ </h3><br><ul><li> 大大加快了工作。 通常，这是我们考虑与外部系统进行低级交互的主要原因。 如果我们可以使过程加快10倍，则可以节省使用其他机器人及其虚拟机和许可证的费用。 </li><li> 可靠性得到提高，您不再需要在UI中使用动态选择器，无需考虑如何绕过验证码，争取在Citrix中识别无法放置插件的图片的准确性，或消除新闻页面上的无休止滚动。 </li><li> 使用没有完整UI或不允许您通过UI获取所有必要信息的系统。 例如，在我的实践中，有一种情况是我们从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Shopify</a>获取有关API的数据，然后将其传输到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ShipHero</a>并将其发送到内部会计系统。 仅最后一步使用了用户界面。 </li></ul><br><h3> 为什么这样的机器人有害？ </h3><br><ul><li> 业务用户不再了解我们的机器人流程可以做什么，也无法自己更改和维护。 对于无人值守的机器人而言并非如此，但对于有人值守（数字助理）来说，这是一个很大的缺点，因为我们希望用户自己成为其过程的作者。 </li><li> 安全服务过程的可见性和可理解性丢失了。 如果使用普通的机器人我们可以清楚地表明他正在执行与“有机”用户相同的操作，甚至可以将工作描述用作文档，那么使用低级集成，我们不得不同意必须经过我们的流程与“大型”自动化系统相同的冗长验证和控制程序。 </li><li>  Dito，关于集成团队。 一旦开始使用API​​，我们就属于他们的财产，必须遵守他们的规则。 </li><li>  “真实”编程的成本和风险要大于机器人技术。 如果有人可以按下按钮，则机器人也可以按下它。 但是，古老的未公开文档系统的API可以为我们提供必要的数据吗？ 是否可以将信息直接写入数据库，还是会破坏其完整性？ 经验丰富的专家是完成此任务所必需的，还是对新手来说足够？ 为什么PowerPoint.Interop中的Slides.Duplicate返回数组？ 可以获得所有这些有趣的问题的答案，但这需要时间。 </li></ul><br><h3> 何时需要以及何时不应该在机器人中使用编程 </h3><br> 上面可以总结如下： <br><h4> 编程值得使用 </h4><br><ul><li> 您的过程效率低下 </li><li>  UI系统不便于自动化，但是有一个便捷的API </li></ul><br><h4> 如果不使用编程 </h4><br><ul><li> 流程将由业务用户开发或支持。 </li><li> 使用API​​会使机器人很难完成协商过程。 </li></ul><br><img src="https://habrastorage.org/webt/i_/lk/mj/i_lkmjp2rfwz9oihzwb-rg-ivla.png" title="他的选择者在哪里？"><br><br><h2> 通过代码进行什么工作以及如何有意义？ </h2><br> 然后，我尝试给出一些使用代码的示例，在创建机器人时，我必须真正使用一种或另一种方法，这意味着它们是在生活中发生的。 当然，该列表并不详尽，但我希望它是说明性的。 <br> 在撰写本文时，所有示例均已在最新版本的操作上进行了测试。 <br><br><h3> 微软Office </h3><br> 奇怪的是，最先使用该API的候选人之一就是Microsoft Office。 是的，UiPath具有出色的内置功能，可用于处理Excel（甚至两种类型，一种直接存储文件，第二种通过应用程序）。 也有使用Word的机会（通过程序包管理器<code>UiPath.Word.Activities</code>了<code>UiPath.Word.Activities</code>程序包）。 但是，例如，没有使用PowerPoint的标准操作，还有Outlook甚至带有Project的Visio，它们在大型公司中仍很活跃。 使用Office，您可以非常容易地通过用户界面与机器人结交朋友，但是在某些情况下，这样做不是很方便，因为并非所有UI元素都可以直接访问，并且您必须在键盘上弹奏音阶。 例如，带有文本<b>k [tab] k [f10] JCDD</b> （用于Office的英文版）的<code>Type Into</code>操作将打开PowerPoint幻灯片中的图形数据，以便在Excel中进行编辑。 这样的组合效果很好，但是看起来比IDDKQD更神奇。 <br><blockquote>  ProTip：可以使用<code>Microsoft UI Automation (UIA)</code>而不是默认选择的<code>Microsoft Active Accessibility (MSAA)</code>框架来扩展可用选择器的列表。 使用UI资源管理器中的F4按钮切换到它，看看是否有区别 </blockquote> 要使用Office文件，可以使用第三方库，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Xceed DocX</a>或Spire库，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Spire.Presentation</a> 。 使用第三方库时，请注意许可证，它可能并不总是适合您的公司（例如，iTextSharp for PDF通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AGPL</a>免费分发，而PDFSharp-通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MIT</a>免费分发）。 此方法非常方便，因为即使计算机上未安装Microsoft Office也可以使用，这意味着它非常适合在虚拟机上运行的无人值守机器人。 <br><br> 对于使用Office程序的复杂工作， <code>Microsoft.Office.Interop</code>可以解决。 它使我们能够在应用程序内执行操作，操纵数据等。 您可以撰写不止一篇文章来介绍使用Office.Interop的功能，这是一件古老而脆弱的事情，但是它很适合我们的目的。 为了使Interop能够正常工作，您需要向Imports中添加适当的程序集。 <br><br> 以下是一些可以使用Office Interop进行处理的示例： <br><br><h4> 展望 </h4><br>  Outlook的功能远不只是处理邮件，它是个人信息管理器，通常有日历，笔记本和通讯簿，是一整套。 如果通常通过直接访问服务器可以解决所有带有电子邮件的问题，如果它代表IMAP / POP3接口，则从Outlook本身获取其余信息要容易得多。 为此，Interop非常适合。 <br><br><div class="spoiler">  <b class="spoiler_title">获取日历事件列表</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> oApp As <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Microsoft.Office.Interop.Outlook.Application <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> mapiNamespace As Microsoft.Office.Interop.Outlook.NameSpace <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> calendarFolder As Microsoft.Office.Interop.Outlook.MAPIFolder <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> calendarItems As Microsoft.Office.Interop.Outlook.Items mapiNamespace = oApp.GetNamespace(<span class="hljs-string"><span class="hljs-string">"MAPI"</span></span>) calendarFolder = mapiNamespace.GetDefaultFolder(Microsoft.Office.Interop.Outlook.OlDefaultFolders.olFolderCalendar) calendarItems = calendarFolder.Items calendarItems.IncludeRecurrences = <span class="hljs-literal"><span class="hljs-literal">True</span></span></code> </pre><br></div></div><br><h4> 简报 </h4><br> 使用PowerPoint，您不仅可以创建精美的演示文稿，还可以将其用于文书工作，例如商业报价或常规项目报告。 为此，您需要在PowerPoint中显示来自其他来源的数据，当然，机器人在此方面做得很好。 创建PowerPoint幻灯片时，大多数时候都需要对它们进行精美的设计，因此您可以提前进行操作，并通过复制模板幻灯片并用它们替换文本来替换实际数据。 <br><blockquote> 可以在nuget.org存储库中找到<code>Microsoft.Office.Interop.Powerpoint</code>和所有其他Interop程序集。 <br></blockquote><div class="spoiler">  <b class="spoiler_title">幻灯片重复</b> <div class="spoiler_text"> 由于Presentation在System.Activities中，而Application在其他Interop中，因此您必须完全编写类名。  fileName和slideToCopy-分别是参数，字符串和数字。 <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> app As <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Microsoft.Office.Interop.PowerPoint.Application <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> pres As Microsoft.Office.Interop.PowerPoint.Presentation <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> newSlide As Microsoft.Office.Interop.PowerPoint.Slide pres = app.Presentations.Open(fileName) newSlide = pres.Slides(slideToCopy).Duplicate()(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br></div></div><br> 通过包含幻灯片的所有元素的Shapes集合，您可以在新页面上快速更新必要的信息。 <br><br><h4> 用Word工作 </h4><br> 尽管<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Word Activities Pack</a>中的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">活动</a>提供了基本的Word功能，但它们并未涵盖构建它们的Xceed DocX库的全部功能。 最常见的情况是使用表，但还有许多其他情况。 <br><br> 在项目存储库中有足够多的不同<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">示例</a>来了解该库或类似库在哪里有用。 <br><br><h3>  Web API（REST，SOAP） </h3><br>  REST / JSON现在可能是关键链接，以便与代表API的系统进行集成。 <br><br> 通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Web Activities Pack</a>提供了对REST，SOAP和JSON的支持。 <br> 使用REST，一切都非常简单，因为它应该是这样： <code>HTTP Request</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Request-</a> &gt; <code>Deserialize JSON</code> ，现在我们已经有了一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JObject</a> ，我们可以用它做任何想要的事情。 为了将数据传输到Web服务，有一个方便的参数编辑器。 <br><br> 但是遗憾的是，对于SOAP，内置功能受到限制，并非支持所有类型的Web服务，也不是所有请求都得到了正确处理。 如果该服务不适合您，则必须使用HttpClient的许多包装之一，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SimpleSOAPClient</a>或编写自己的包装（一种<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用C＃处理SOAP</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">变体</a> ）。 <br><br>  <b>UPDATE 04/03/19：在版本2019.4中，该版本的beta已可供下载，该组件已更新，改进和重做。</b>  <b>因此，您可以很快看到普通的SOAP支持。</b> <br><br><h3> 使用FTP </h3><br> 在UiPath中，一切都很简单， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">社区活动中</a>包含一套针对FTP的现成操作，不过应注意的是，从FTP活动包的版本18.2开始， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">已弃用</a> 。 但是所有功能都存在，甚至支持SFTP（该设置基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SSH.NET</a> ），尽管不幸的是，使用客户端密钥的工作尚未完成。 <br><br><img src="https://habrastorage.org/webt/ox/-u/av/ox-uavywdnypfrph50zhytvjqze.png" title="FTP活动包中的活动">  。 <br><br><h3> 资料库 </h3><br>  UiPath通过.NET数据提供程序处理数据库。 对于MS SQL和MS Access，一切都很简单，其余的则需要配置ODBC，如果不存在，则安装驱动程序。 请记住，由于当前平台是32位的，因此我们需要下载适当的驱动程序，并且ODBC数据源必须相同。 <br><br> 以下是使用MySQL的示例。 <br><br><div class="spoiler">  <b class="spoiler_title">配置MySQL连接</b> <div class="spoiler_text"> 测试远程MySQL数据库的设置（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">来自此处的</a>驱动程序）： <br><img src="https://habrastorage.org/webt/dt/c2/2f/dtc22fpl8xwohfxihkekbkru4ts.png" title="远程MySQL Server的ODBC设置" width="300"><br> 并从动作连接到它 <br><img src="https://habrastorage.org/webt/hx/6_/eu/hx6_euiuwkka_3i2dkp9ro-5guo.png" title="连接到MySQL测试数据库的设置" width="300"><br></div></div><br> 与SQL兼容的数据库的进一步工作是相当标准的-我们进行查询，获得一个DataTable。 <br><br><h3> 通过BAPI的SAP </h3><br> 如果您的SAP提供了这个机会，您可以尝试通过UI而不是通过UI来通过BAPI自动与SAP集成。 和往常一样，在UiPath中已经为此做好了准备 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一组操作</a> ，包括用于配置与SAP的连接的向导。 这里几乎没有编程，但这是一个事实的例子，即标准集成路径并非唯一可行的方法。 <br><br><h2> 总结 </h2><br> 我希望我能在本文的帮助下讨论在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">学院</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">论坛</a>上不容易学习的使用机器人的那些方面。 如果有人对机器人开发感兴趣或帮助回答与机器人开发有关的问题，我将感到非常高兴。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN446092/">https://habr.com/ru/post/zh-CN446092/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN446080/index.html">在美国，法院建议禁止进口某些型号的iPhone，因为它们侵犯了高通公司的苹果专利</a></li>
<li><a href="../zh-CN446082/index.html">半环的故事</a></li>
<li><a href="../zh-CN446086/index.html">Linux历史。 第三部分：新市场和旧“敌人”</a></li>
<li><a href="../zh-CN446088/index.html">我在2018年不知道的事情</a></li>
<li><a href="../zh-CN446090/index.html">GSM + GPS模块A9G上的Micropython</a></li>
<li><a href="../zh-CN446094/index.html">有生命周期表</a></li>
<li><a href="../zh-CN446096/index.html">《 TasteVill：如何使零售业发生革命，做错一切》</a></li>
<li><a href="../zh-CN446098/index.html">苏联时代的“东方号”和“日出号”飞行控制中心</a></li>
<li><a href="../zh-CN446100/index.html">通过Excel电子表格自动创建Android和iOS本地化文件</a></li>
<li><a href="../zh-CN446104/index.html">Python悖论</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>