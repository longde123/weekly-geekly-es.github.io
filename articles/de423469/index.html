<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♟️ 📣 🧓 Schnellste Gleitkommazahlen im Wilden Westen 🤛🏼 🙍🏻 🙌🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bei der Implementierung eines „Lesers“ trat ein Problem mit einer erhöhten Genauigkeit der Berechnungen auf. Der Berechnungsalgorithmus arbeitete schn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Schnellste Gleitkommazahlen im Wilden Westen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423469/"> Bei der Implementierung eines „Lesers“ trat ein Problem mit einer erhöhten Genauigkeit der Berechnungen auf.  Der Berechnungsalgorithmus arbeitete schnell mit Standard-Gleitkommazahlen, aber als Bibliotheken für genaue Berechnungen verbunden wurden, begann sich alles wild zu verlangsamen.  In diesem Artikel werden Algorithmen zum Erweitern von Gleitkommazahlen unter Verwendung eines Mehrkomponentenansatzes betrachtet, aufgrund dessen eine Beschleunigung erreicht werden konnte, da die Gleitkomma-Arithmetik auf einem CP-Chip implementiert ist.  Dieser Ansatz ist nützlich für eine genauere Berechnung der numerischen Ableitung, der Matrixinversion, des Polygontrimmens oder anderer geometrischer Probleme.  So ist es möglich, 64-Bit-Float auf Grafikkarten zu emulieren, die diese nicht unterstützen. <br><br><img src="https://habrastorage.org/webt/54/1e/jo/541ejotttsu8hl3swtihly-liro.png" alt="double.js Benchmark"><br><br><a name="habracut"></a><br><br><h3>  Einführung </h3><br>  Da Nikluas Wirth uns hinterlassen hat, die Nummern 0 und 1 zu behalten, speichern wir sie darin.  Und leben Menschen im Dezimalsystem, und die scheinbar gewöhnlichen Zahlen 0,1 und 0,3 sind im Binärsystem nicht durch einen endlichen Bruchteil darstellbar?  Wir erleben einen kulturellen Schock, wenn wir Berechnungen an ihnen anstellen.  Natürlich wird versucht, Bibliotheken für Prozessoren basierend auf dem Dezimalsystem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu</a> erstellen, und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IEEE hat</a> sogar standardisierte Formate. <br><br>  Im Moment berücksichtigen wir jedoch überall den binären Speicher und führen alle Geldberechnungen mit Bibliotheken für genaue Berechnungen durch, z. B. Bignumber, was zu Leistungseinbußen führt.  Asiks betrachten Krypto, und in Prozessoren gibt es so wenig Platz für Ihre Dezimalarithmetik, sagen Vermarkter.  Daher ist ein Mehrkomponentenansatz, wenn eine Zahl in Form einer nicht transformierten Summe von Zahlen gespeichert wird, ein praktischer Trick und eine sich aktiv entwickelnde Sphäre auf dem Gebiet der theoretischen Informatik.  Obwohl Decker 1971 immer noch lernte, ohne Genauigkeitsverlust korrekt zu multiplizieren, erschienen gebrauchsfertige Bibliotheken viel später (MPFR, QD) und nicht in allen Sprachen, anscheinend da nicht alle IEEE-Standards unterstützten, sondern zum Beispiel auch später strenge Beweise für Berechnungsfehler im Jahr 2017 für Doppelwortarithmetik. <br><br><h3>  Doppelwortarithmetik </h3><br>  Was ist der Punkt?  In bärtigen Zeiten, als es keine Standards für schwebende Zahlen gab, kam Møller auf die Idee, um Probleme bei der Implementierung der Rundung zu vermeiden, und Knuth bewies später, dass es eine fehlerfreie Summierung gibt.  Laufen auf diese Weise <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quickTwoSum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> s = a + b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> z = s - a; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> e = b - z; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [s, e]; }</code> </pre> <br>  In diesem Algorithmus wurde angenommen, dass wenn <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.913ex" height="2.66ex" viewBox="0 -832 3407.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-3E" x="1364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="2420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-62" x="2699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="3128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1"> | a | > | b | </script>  dann kann ihre genaue Summe als die Summe zweier Zahlen dargestellt werden <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>+</mo><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.014ex" height="1.937ex" viewBox="0 -676.4 2158.9 834" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-2B" x="691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-65" x="1692" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> s + e </script>  und Sie können sie paarweise für nachfolgende Berechnungen speichern, und die Subtraktion wird auf die Addition mit einer negativen Zahl reduziert. <br><br><img src="https://habrastorage.org/webt/6o/5b/h3/6o5bh3at9xelrvk2yslo4qk0jl0.png" alt="Runde zum nächsten gegen Bank"><br><br>  In der Folge zeigte Dekker, dass bei Verwendung von Gleitkommazahlen, bei denen auf die nächste gerade Zahl gerundet wird (Rundung auf die nächste gerade Zahl, was im Allgemeinen ein korrektes Verfahren ist, das bei langen Berechnungen und dem IEEE-Standard nicht zu großen Fehlern führt), dann gibt es einen fehlerfreien Multiplikationsalgorithmus. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twoMult</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> A = split(a); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> B = split(b); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> r1 = a * b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t1 = -r1 + A[<span class="hljs-number"><span class="hljs-number">0</span></span>] * B[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t2 = t1 + A[<span class="hljs-number"><span class="hljs-number">0</span></span>] * B[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t3 = t2 + A[<span class="hljs-number"><span class="hljs-number">1</span></span>] * B[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [r1, t3 + A[<span class="hljs-number"><span class="hljs-number">1</span></span>] * B[<span class="hljs-number"><span class="hljs-number">1</span></span>]]; }</code> </pre><br>  Dabei ist split () der Algorithmus von Herrn Weltkamp zum Teilen einer Zahl <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> splitter = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.pow(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t = splitter * a; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> d = a - t; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> xh = t + d; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> xl = a - xh; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [xh, xl]; }</code> </pre><br>  mit Konstante <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>s</mi></msup><mo>+</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.033ex" height="2.178ex" viewBox="0 -780.1 4750.5 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-3D" x="1038" y="0"></use><g transform="translate(2094,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-73" x="707" y="557"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-2B" x="3249" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-31" x="4249" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>s</mi></msup><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-3"> C = 2 ^ s + 1 </script>  Dies entspricht etwas mehr als der Hälfte der Länge der Mantisse, was beim Multiplikationsprozess nicht zu einem Überlaufen von Zahlen führt und die Mantisse in zwei Hälften teilt.  Beispielsweise beträgt bei einer Wortlänge von 64 Bit die Länge der Mantisse 53 und dann s = 27. <br><br><img src="https://habrastorage.org/webt/ut/k-/rl/utk-rlv912w0uw44uvm4cce4uts.gif" alt="Doppelschwimmer"><br><br>  Auf diese Weise lieferte Dekker den fast vollständigen Satz, der für die Berechnung in Doppelwortarithmetik benötigt wird.  Seitdem wurde auch angegeben, wie man zwei Doppelwortzahlen multipliziert, dividiert und quadriert. <br><br>  Sein quickTwoSum-Algorithmus zum Summieren von zwei Doppelwörtern war überall „inline“, und die Prüfung wurde verwendet <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.913ex" height="2.66ex" viewBox="0 -832 3407.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-3E" x="1364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="2420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMATHI-62" x="2699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhhXWYqxqHobpcxZGSfugbe2puX2Fw#MJMAIN-7C" x="3128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4"> | a | > | b | </script>  .  Auf modernen Prozessoren, wie in [4] beschrieben, ist es billiger, zusätzliche Operationen mit Zahlen zu verwenden, als den Algorithmus zu verzweigen.  Daher ist der folgende Algorithmus jetzt besser geeignet, um zwei Einzelwortnummern hinzuzufügen <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twoSum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> s = a + b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a1 = s - b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b1 = s - a1; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> da = a - a1; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> db = b - b1; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [s, da + db]; }</code> </pre><br>  Das ist also die Summe und Multiplikation von Doppelwortzahlen. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add22</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">X, Y</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> S = twoSum(X[<span class="hljs-number"><span class="hljs-number">0</span></span>], Y[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> E = twoSum(X[<span class="hljs-number"><span class="hljs-number">1</span></span>], Y[<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> c = S[<span class="hljs-number"><span class="hljs-number">1</span></span>] + E[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> V = quickTwoSum(S[<span class="hljs-number"><span class="hljs-number">0</span></span>], c); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> w = V[<span class="hljs-number"><span class="hljs-number">1</span></span>] + E[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quickTwoSum(V[<span class="hljs-number"><span class="hljs-number">0</span></span>], w); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul22</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">X, Y</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> S = twoMult(X[<span class="hljs-number"><span class="hljs-number">0</span></span>], Y[<span class="hljs-number"><span class="hljs-number">0</span></span>]); S[<span class="hljs-number"><span class="hljs-number">1</span></span>] += X[<span class="hljs-number"><span class="hljs-number">0</span></span>] * Y[<span class="hljs-number"><span class="hljs-number">1</span></span>] + X[<span class="hljs-number"><span class="hljs-number">1</span></span>] * Y[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quickTwoSum(S[<span class="hljs-number"><span class="hljs-number">0</span></span>], S[<span class="hljs-number"><span class="hljs-number">1</span></span>]); }</code> </pre><br>  Im Allgemeinen wird die vollständigste und genaueste Liste von Algorithmen für Doppelwortarithmetik, theoretische Fehlergrenzen und praktische Implementierung im Link [3] von 2017 beschrieben.  Bei Interesse empfehle ich daher dringend, direkt dorthin zu fahren.  Im Allgemeinen ist in [6] und in [5] ein Algorithmus für Vierfachwörter für eine Mehrkomponentenerweiterung beliebiger Länge angegeben.  Nur dort wird nach jeder Operation der Renormierungsprozess verwendet, der für kleine Größen nicht immer optimal ist, und die Genauigkeit der Berechnungen in QD ist nicht genau definiert.  Generell lohnt es sich natürlich, über die Grenzen der Anwendbarkeit dieser Ansätze nachzudenken. <br><br><h3>  Horrorgeschichten Javascript-a.  Vergleich von decimal.js vs bignumber.js vs big.js. </h3><br>  So kam es, dass fast alle Bibliotheken für genaue Berechnungen in js von einer Person geschrieben wurden.  Die Illusion der Wahl entsteht, obwohl sie fast alle gleich sind.  Darüber hinaus wird in der Dokumentation nicht explizit angegeben, dass sich die Größe Ihrer Zahl ständig verdoppelt, wenn Sie Zahlen nach jeder Multiplikations- / Divisionsoperation nicht runden, und die Komplexität des Algorithmus in x3500 zu einer einfachen Größe werden kann.  Ein Vergleich der Berechnungszeit könnte beispielsweise so aussehen, wenn Sie die Zahlen nicht gerundet hätten. <br><br><img src="https://habrastorage.org/webt/lj/6r/pk/lj6rpkl_lenvq7vabfyqqhdwh8y.png"><br><br>  Das heißt, Sie setzen die Genauigkeit auf 32 Dezimalstellen und ... Ups, Sie haben bereits 64 Stellen, 128. Wir denken sehr genau!  256, 512 ... Aber ich habe 32 gesetzt! .. 1024, 2048 ... So etwas erscheint 3.500 Mal über dem Kopf.  In der Dokumentation heißt es, dass bei wissenschaftlichen Berechnungen decimal.js wahrscheinlich besser für Sie ist.  Wenn Sie jedoch nur regelmäßig abrunden, arbeitet Bignumber.js für wissenschaftliche Berechnungen etwas schneller (siehe Abb. 1).  Wer muss die Hundertstel Cent zählen, wenn sie nicht als Wechselgeld ausgegeben werden können?  Gibt es einen Fall, in dem ich mehr angegebene Nummern speichern muss und nicht mit ein paar zusätzlichen Zeichen aussteigen kann?  Wie nimmt es den Sinus einer solchen Monsternummer, wenn niemand die strenge Genauigkeit der Konvergenz der Taylor-Reihe für beliebige Zahlen kennt?  Im Allgemeinen gibt es keinen unbegründeten Verdacht, dass es möglich ist, die Berechnungsgeschwindigkeit dort zu erhöhen, indem beispielsweise Schönhage-Strassen-Multiplikationsalgorithmen verwendet und der Sinus mit Cordic-Berechnungen gefunden wird. <br><br><h3>  Double.js </h3><br>  <s>Ich möchte natürlich sagen, dass Double.js schnell und genau zählt.</s>  <s>Dies ist jedoch nicht ganz richtig, das heißt, es ist zehnmal schneller, als es berücksichtigt, aber es ist nicht immer genau.</s>  <s>Zum Beispiel kann 0.3-0.1 verarbeitet werden, indem es in einen doppelten Speicher übergeht und umgekehrt.</s>  <s>Die Pi-Zahl kann jedoch mit einer doppelten Genauigkeit von fast 32 Stellen aufgelöst werden und funktioniert nicht zurück.</s>  <s>Am 16. wird ein Fehler generiert, als ob ein Überlauf auftritt.</s>  <s>Im Allgemeinen fordere ich die js-Community auf, zusammenzuarbeiten, um das Problem des Parsens zu lösen, da ich nicht weiterkomme.</s>  <s>Ich habe versucht, digital zu analysieren und in doppelter Genauigkeit zu teilen, wie in QD, in Chargen von 16 Ziffern zu teilen und in doppelter Genauigkeit zu teilen, die Mantisse mit Big.js wie in einer der Julia-Bibliotheken zu teilen.</s>  <s>Jetzt sündige ich an einem Fehler in .parseFloat (), da IEEE-Standards mit Rundung auf die nächste Ganzzahl auch mit ECMAScript 1 unterstützt werden. Natürlich können Sie versuchen, den Binärpuffer zu binden und alle 0 und 1 zu beobachten. Im Allgemeinen, wenn Sie dieses Problem lösen können, dann Es wird dann möglich sein, Berechnungen mit beliebiger Genauigkeit und Beschleunigung in x10-x20 aus bignumber.js durchzuführen.</s>  <s>Bei vielen Mandelbrot wird jedoch bereits Qualität wiedergegeben, und Sie können es für geometrische Aufgaben verwenden.</s> <br><br>  Ein Jahr später kehrte ich hierher zurück und behebt immer noch ein Problem mit dem Parsen.  Das Problem bestand nur in unzureichender Genauigkeit, wenn es mit 10 ^ (- n) multipliziert wurde.  Alle Algorithmen wurden von Grund auf überarbeitet und laufen jetzt mit erschreckender Genauigkeit und Geschwindigkeit. <br><br><img src="https://habrastorage.org/webt/ax/gx/mb/axgxmb_wfffxczzejqaxa9mqdpy.png" alt="double.js vs number"><br><br>  Hier ist ein Link zur <a href="">Bibliothek</a> , es gibt einen interaktiven Benchmark und eine Sandbox, in der Sie damit spielen können. <br><br><h3>  Verwendete Quellen </h3><br><ol><li>  O. Møller.  <i>Quasi doppelte Genauigkeit in der Gleitkomma-Arithmetik.</i>  1965. </li><li>  Theodorus Dekker.  <i>Eine Gleitkomma-Technik zur Erweiterung der verfügbaren Präzision</i> , 1971. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Viewer</a> ] </li><li>  Mioara Joldes, Jean-Michel Müller, Valentina Popescu.  <i>Enge und strenge Fehlergrenzen für Grundbausteine ​​der Doppelwortarithmetik</i> , 2017. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PDF</a> ] </li><li>  Muller, J.-M.  Brisebarre, N. de Dinechin usw.  Handbuch der Gleitkomma-Arithmetik, Kapitel 14, 2010. </li><li>  Jonathan Shewchuk.  <i>Robuste adaptive geometrische Gleitkomma-Prädikate</i> , 1964. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PDF</a> ] </li><li>  Yozo Hida, Xiaoye Li und David Bailey.  <i>Bibliothek für Double-Double- und Quad-Double-Arithmetik</i> , 2000. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PDF</a> ] </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de423469/">https://habr.com/ru/post/de423469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de423459/index.html">Unterschiede zwischen Phoenix und Rails durch die Augen eines Konvertiten</a></li>
<li><a href="../de423461/index.html">Suborbitaler Herbst</a></li>
<li><a href="../de423463/index.html">Da haben wir einen anderen RFM-Analysealgorithmus geschrieben</a></li>
<li><a href="../de423465/index.html">Was Sie über ITSM lesen sollten: Bücher, Blogs und aktuelle Artikel</a></li>
<li><a href="../de423467/index.html">Russische Entwickler werden einen Katalog zur Produktkompatibilität veröffentlichen</a></li>
<li><a href="../de423475/index.html">Den Alterungscode hacken: eine neue Wissenschaft über das Altern und was es bedeutet, jung zu bleiben</a></li>
<li><a href="../de423477/index.html">Sei ein Sicherheits-Ninja: Begib dich auf den Weg zu den Höhen von IB</a></li>
<li><a href="../de423479/index.html">"Zuerst": ob man zum Mars fliegt</a></li>
<li><a href="../de423481/index.html">Ich muss den Kubernetes-Cluster erhöhen, bin aber nur ein Code-Programmierer. Es gibt einen Ausweg</a></li>
<li><a href="../de423483/index.html">Finden des richtigen Weges zum Trennen von Website-Inhalten mithilfe von Webpack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>