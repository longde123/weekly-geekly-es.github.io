<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘… ğŸ² ğŸ“ TensorFlow.jså’Œclmtrackr.jsï¼šåœ¨æµè§ˆå™¨ä¸­è·Ÿè¸ªç”¨æˆ·å‡è§†çš„æ–¹å‘ ğŸ£ ğŸ•œ ğŸ™‹ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿™ç¯‡æ–‡ç« çš„ä½œè€…ï¼ˆæˆ‘ä»¬æ­£åœ¨ç¿»è¯‘çš„è¯‘æœ¬ï¼‰æä¾›äº†ä¸“é—¨è®¨è®ºé€šè¿‡ç½‘ç»œæµè§ˆå™¨è§£å†³è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„é—®é¢˜çš„æ–‡ç« ã€‚ å€ŸåŠ©TensorFlow JavaScriptåº“ï¼Œè§£å†³æ­¤ç±»é—®é¢˜å¹¶ä¸éš¾ã€‚ ä¸å…¶è®­ç»ƒæˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹å¹¶å°†å…¶ä½œä¸ºæˆå“çš„ä¸€éƒ¨åˆ†æä¾›ç»™ç”¨æˆ·ï¼Œæˆ‘ä»¬ä¸å¦‚ç»™ä»–ä»¬æœºä¼šç‹¬ç«‹æ”¶é›†æ•°æ®å¹¶ç›´æ¥åœ¨æˆ‘ä»¬è‡ªå·±çš„è®¡ç®—æœºä¸Šçš„æµè§ˆå™¨ä¸­è®­ç»ƒæ¨¡å‹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TensorFlow.jså’Œclmtrackr.jsï¼šåœ¨æµè§ˆå™¨ä¸­è·Ÿè¸ªç”¨æˆ·å‡è§†çš„æ–¹å‘</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/426055/"> è¿™ç¯‡æ–‡ç« çš„ä½œè€…ï¼ˆæˆ‘ä»¬æ­£åœ¨ç¿»è¯‘çš„è¯‘æœ¬ï¼‰æä¾›äº†ä¸“é—¨è®¨è®ºé€šè¿‡ç½‘ç»œæµè§ˆå™¨è§£å†³è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„é—®é¢˜çš„æ–‡ç« ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å€ŸåŠ©TensorFlow</a> JavaScriptåº“ï¼Œè§£å†³æ­¤ç±»é—®é¢˜å¹¶ä¸éš¾ã€‚ ä¸å…¶è®­ç»ƒæˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹å¹¶å°†å…¶ä½œä¸ºæˆå“çš„ä¸€éƒ¨åˆ†æä¾›ç»™ç”¨æˆ·ï¼Œæˆ‘ä»¬ä¸å¦‚ç»™ä»–ä»¬æœºä¼šç‹¬ç«‹æ”¶é›†æ•°æ®å¹¶ç›´æ¥åœ¨æˆ‘ä»¬è‡ªå·±çš„è®¡ç®—æœºä¸Šçš„æµè§ˆå™¨ä¸­è®­ç»ƒæ¨¡å‹ã€‚ ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå®Œå…¨ä¸éœ€è¦æœåŠ¡å™¨ç«¯æ•°æ®å¤„ç†ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1n/6k/57/1n6k57nn-wdkux5hhohvjnyadve.jpeg"></div><br> æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>ä½“éªŒè¯¥ææ–™ä¸“ç”¨äºåˆ›å»ºçš„å†…å®¹ã€‚ ä¸ºæ­¤ï¼Œæ‚¨å°†éœ€è¦ç°ä»£çš„æµè§ˆå™¨ï¼Œç½‘ç»œæ‘„åƒå¤´å’Œé¼ æ ‡ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™æ˜¯</a>é¡¹ç›®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a>æºä»£ç ã€‚ è¯¥ææ–™çš„ä½œè€…è¯´ï¼Œä»–å¹¶ä¸æ˜¯ä¸ºåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå·¥ä½œè€Œè®¾è®¡çš„ï¼Œä»–æ²¡æœ‰æ—¶é—´è¿›è¡Œé€‚å½“çš„æ”¹è¿›ã€‚ æ­¤å¤–ï¼Œä»–æŒ‡å‡ºï¼Œå¦‚æœå¿…é¡»å¤„ç†æ¥è‡ªç§»åŠ¨æ‘„åƒæœºçš„è§†é¢‘æµï¼Œæ­¤å¤„è€ƒè™‘çš„ä»»åŠ¡å°†å˜å¾—æ›´åŠ å¤æ‚ã€‚ <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">ä¸»æ„</font> </h2><br> è®©æˆ‘ä»¬ä½¿ç”¨æœºå™¨å­¦ä¹ æŠ€æœ¯æ¥æ‰¾å‡ºç”¨æˆ·åœ¨æµè§ˆç½‘é¡µæ—¶æ‰€å¤„çš„ç¡®åˆ‡ä½ç½®ã€‚ æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ç½‘ç»œæ‘„åƒå¤´è§‚å¯Ÿä»–çš„çœ¼ç›æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ <br><br> åœ¨æµè§ˆå™¨ä¸­è®¿é—®ç½‘ç»œæ‘„åƒå¤´éå¸¸å®¹æ˜“ã€‚ å¦‚æœæˆ‘ä»¬å‡è®¾æ¥è‡ªæ‘„åƒæœºçš„æ•´ä¸ªå›¾åƒéƒ½å°†ç”¨ä½œç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œé‚£ä¹ˆå¯¹äºè¿™äº›â€‹â€‹ç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¯´å®ƒå¤ªå¤§äº†ã€‚ è¯¥ç³»ç»Ÿå°†å¿…é¡»åšå¾ˆå¤šå·¥ä½œæ‰èƒ½ç¡®å®šå›¾åƒä¸­çœ¼ç›çš„ä½ç½®ã€‚ å¦‚æœæˆ‘ä»¬æ­£åœ¨è°ˆè®ºå¼€å‘äººå‘˜è‡ªå·±è®­ç»ƒå¹¶åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„æ¨¡å‹ï¼Œé‚£ä¹ˆè¿™ç§æ–¹æ³•å¯ä»¥å¾ˆå¥½åœ°å±•ç¤ºè‡ªå·±ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ­£åœ¨è°ˆè®ºè®­ç»ƒå’Œåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨è¯¥æ¨¡å‹ï¼Œé‚£ä¹ˆè¿™å¤ªå¤šäº†ã€‚ <br><br> ä¸ºäº†ç®€åŒ–ç½‘ç»œçš„å·¥ä½œï¼Œæˆ‘ä»¬åªèƒ½ä¸ºå®ƒæä¾›ä¸€éƒ¨åˆ†å›¾åƒ-åŒ…å«ç”¨æˆ·çš„çœ¼ç›å’Œçœ¼ç›å‘¨å›´çš„ä¸€å°å—åŒºåŸŸã€‚ è¯¥åŒºåŸŸæ˜¯å›´ç»•çœ¼ç›çš„çŸ©å½¢ï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“è¿›è¡Œè¯†åˆ«ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å·¥ä½œçš„ç¬¬ä¸€éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pg/fc/fp/pgfcfppfo3_6wddvm58zikfoqlw.png"></div><br>  <i><font color="#999999">ç½‘ç»œæ‘„åƒå¤´è¾“å…¥ï¼Œé¢éƒ¨è¯†åˆ«ï¼Œçœ¼ç›æ£€æµ‹ï¼Œè£å‰ªå›¾åƒ</font></i> <br><br> ä¸ºäº†æ£€æµ‹å›¾åƒä¸­çš„äººè„¸ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªåä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">clmtrackr</a>çš„åº“ã€‚ å®ƒä¸æ˜¯å®Œç¾çš„ï¼Œä½†æ˜¯ä½“ç§¯å°ï¼Œæ€§èƒ½å¥½ï¼Œå¹¶ä¸”é€šå¸¸è¶³ä»¥åº”ä»˜å…¶ä»»åŠ¡ã€‚ <br><br> å¦‚æœå°†å°çš„ä½†æ™ºèƒ½é€‰æ‹©çš„å›¾åƒç”¨ä½œç®€å•å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œåˆ™è¯¥ç½‘ç»œå¯ä»¥æ¯«æ— é—®é¢˜åœ°å­¦ä¹ ã€‚ è¿™æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„æ ·å­ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yh/k_/th/yhk_thr05faoc09immbn8fz1vou.png"></div><br>  <i><font color="#999999">è¾“å…¥å›¾åƒï¼ˆæ¨¡å‹ï¼‰æ˜¯ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œåæ ‡æ˜¯ç½‘ç»œåœ¨ç”¨æˆ·æ­£åœ¨æŸ¥çœ‹çš„é¡µé¢ä¸Šé¢„æµ‹çš„ä½ç½®ã€‚</font></i> <br><br> è¿™é‡Œå°†æè¿°æœ¬èŠ‚ä¸­è®¨è®ºçš„æƒ³æ³•çš„æœ€ä½é™åº¦å®Œå…¨å®ç°ã€‚ è¯¥é¡¹ç›®çš„ä»£ç ä½äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤</a>å­˜å‚¨åº“ä¸­ï¼Œè¯¥é¡¹ç›®å…·æœ‰è®¸å¤šå…¶ä»–åŠŸèƒ½ã€‚ <br><br><h2>  <font color="#3AC1EF">å‡†å¤‡å·¥ä½œ</font> </h2><br> é¦–å…ˆï¼Œ <code>clmtrackr.js</code>ä»ç›¸åº”çš„<a href="">å­˜å‚¨åº“</a> <code>clmtrackr.js</code> ã€‚ æˆ‘ä»¬å°†ä»ä¸€ä¸ªç©ºçš„HTMLæ–‡ä»¶å¼€å§‹å·¥ä½œï¼Œè¯¥æ–‡ä»¶å°†ä½¿ç”¨æˆ‘ä»¬çš„ä»£ç å¯¼å…¥jQueryï¼ŒTensorFlow.jsï¼Œclmtrackr.jså’Œ<code>main.js</code>æ–‡ä»¶ï¼Œç¨åæˆ‘ä»¬å°†è¿›è¡Œå¤„ç†ï¼š <br><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!doctype html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://code.jquery.com/jquery-3.3.1.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.0"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clmtrackr.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">æ¥æ”¶æ¥è‡ªç½‘ç»œæ‘„åƒå¤´çš„è§†é¢‘æµ</font> </h2><br> ä¸ºäº†æ¿€æ´»ç½‘ç»œæ‘„åƒå¤´å¹¶åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºè§†é¢‘æµï¼Œæˆ‘ä»¬éœ€è¦è·å¾—ç”¨æˆ·è®¸å¯ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘æ²¡æœ‰æä¾›è§£å†³é¡¹ç›®ä¸å„ç§æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜çš„ä»£ç ã€‚ æˆ‘ä»¬å°†å‡è®¾ç”¨æˆ·ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„Google Chromeæµè§ˆå™¨åœ¨äº’è”ç½‘ä¸Šå·¥ä½œã€‚ <br><br> å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°HTMLæ–‡ä»¶ã€‚ å®ƒåº”è¯¥ä½äº<code>&lt;body&gt;</code> ï¼Œä½†ä½äº<code>&lt;script&gt;</code>æ ‡è®°ä¸Šæ–¹ï¼š <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">video</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"webcam"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"400"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autoplay</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">video</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨<code>main.js</code>æ–‡ä»¶ï¼š <br><br><pre> <code class="hljs javascript">$(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> video = $(<span class="hljs-string"><span class="hljs-string">'#webcam'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStreaming</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{   video.srcObject = stream; } navigator.mediaDevices.getUserMedia({ <span class="hljs-attr"><span class="hljs-attr">video</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }).then(onStreaming); });</code> </pre> <br> è‡ªå·±å°è¯•æ­¤ä»£ç ã€‚ å½“æ‚¨æ‰“å¼€é¡µé¢æ—¶ï¼Œæµè§ˆå™¨åº”å¾å¾—è®¸å¯ï¼Œç„¶åç½‘ç»œæ‘„åƒå¤´ä¸­çš„å›¾ç‰‡å°†å‡ºç°åœ¨å±å¹•ä¸Šã€‚ <br><br> ç¨åï¼Œæˆ‘ä»¬å°†æ‰©å±•<code>onStreaming()</code>å‡½æ•°çš„ä»£ç ã€‚ <br><br><h2>  <font color="#3AC1EF">è„¸éƒ¨æœå¯»</font> </h2><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨clmtrackr.jsåº“åœ¨è§†é¢‘ä¸­æœç´¢äººè„¸ã€‚ é¦–å…ˆï¼Œé€šè¿‡åœ¨<code>const video = ...</code>ä¹‹åæ·»åŠ ä»¥ä¸‹ä»£ç æ¥åˆå§‹åŒ–äººè„¸è·Ÿè¸ªç³»ç»Ÿï¼š <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ctrack = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> clm.tracker(); ctrack.init();</code> </pre> <br> ç°åœ¨ï¼Œåœ¨<code>onStreaming()</code>å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨å…¶ä¸­æ·»åŠ ä»¥ä¸‹å‘½ä»¤æ¥è¿æ¥äººè„¸æœç´¢ç³»ç»Ÿï¼š <br><br><pre> <code class="hljs pgsql">ctrack.<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>(video);</code> </pre> <br> è¿™å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚ ç°åœ¨ï¼Œç³»ç»Ÿå°†èƒ½å¤Ÿè¯†åˆ«è§†é¢‘æµä¸­çš„é¢éƒ¨ã€‚ <br><br> ä¸ä¿¡ï¼Ÿ è®©æˆ‘ä»¬åœ¨æ‚¨çš„è„¸ä¸Šç”»ä¸€ä¸ªâ€œé¢å…·â€ï¼Œä»¥ç¡®ä¿è¿™æ˜¯çœŸçš„ã€‚ <br> ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è´Ÿè´£æ˜¾ç¤ºè§†é¢‘çš„å…ƒç´ ä¸Šæ–¹æ˜¾ç¤ºå›¾åƒã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<code>&lt;canvas&gt;</code>åœ¨HTMLé¡µé¢ä¸Šç»˜åˆ¶å†…å®¹ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡å°†å…¶å åŠ åœ¨æ˜¾ç¤ºè§†é¢‘çš„å…ƒç´ ä¸Šæ¥åˆ›å»ºè¿™æ ·çš„å…ƒç´ ã€‚ ä»¥ä¸‹ä»£ç å°†å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»å°†å…¶æ·»åŠ åˆ°HTMLæ–‡ä»¶ä¸­çš„<code>&lt;video&gt;</code>å…ƒç´ ä¸‹ï¼š <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"overlay"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"400"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css">   </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#webcam</span></span></span><span class="css">, </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#overlay</span></span></span><span class="css"> {       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">top</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">left</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">;   } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> å¦‚æœéœ€è¦ï¼Œå¯ä»¥å°†å†…è”æ ·å¼ç§»åŠ¨åˆ°å•ç‹¬çš„CSSæ–‡ä»¶ä¸­ã€‚ <br><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨é¡µé¢ä¸­æ·»åŠ äº†ä¸<code>&lt;video&gt;</code>å…ƒç´ ç›¸åŒå¤§å°çš„<code>&lt;canvas&gt;</code> <code>&lt;video&gt;</code>å…ƒç´ ã€‚ æ­¤å¤„ä½¿ç”¨çš„æ ·å¼ç¡®ä¿äº†å…ƒç´ å°†ä½äºç›¸åŒä½ç½®çš„äº‹å®ã€‚ <br><br> ç°åœ¨ï¼Œæ¯æ¬¡æµè§ˆå™¨æ˜¾ç¤ºè§†é¢‘çš„ä¸‹ä¸€å¸§æ—¶ï¼Œæˆ‘ä»¬å°†åœ¨<code>&lt;canvas&gt;</code>ä¸Šç»˜åˆ¶ä¸€äº›<code>&lt;canvas&gt;</code> ã€‚ ä½¿ç”¨<code>requestAnimationLoop()</code>æœºåˆ¶æ‰§è¡Œæ¯å¸§è¾“å‡ºæœŸé—´ä»»ä½•ä»£ç çš„æ‰§è¡Œã€‚ åœ¨å°†ä»»ä½•å†…å®¹è¾“å‡ºåˆ°<code>&lt;canvas&gt;</code> ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸­åˆ é™¤ä¹‹å‰çš„å†…å®¹ï¼Œå¹¶å°†å…¶æ¸…é™¤ã€‚ ç„¶åï¼Œæˆ‘ä»¬å»ºè®®<code>clmtrackr</code>å°†å›¾å½¢ç›´æ¥è¾“å‡ºåˆ°<code>&lt;canvas&gt;</code> ã€‚ <br><br> è¿™æ˜¯å®ç°æˆ‘ä»¬åˆšæ‰è®¨è®ºçš„ä»£ç ã€‚ å°†å…¶æ·»åŠ åˆ°<code>ctrack.init()</code>å‘½ä»¤ä¸‹é¢ï¼š <br><br><pre> <code class="hljs matlab">const overlay = $(<span class="hljs-string"><span class="hljs-string">'#overlay'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; const overlayCC = overlay.getContext(<span class="hljs-string"><span class="hljs-string">'2d'</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trackingLoop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { // ,     , //     -   . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requestAnimationFrame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(trackingLoop)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentPosition</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ctrack</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentPosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">overlayCC</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clearRect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0, 0, 400, 300)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(currentPosition)</span></span></span><span class="hljs-function"> {   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ctrack</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(overlay)</span></span></span><span class="hljs-function">; } }</span></span></code> </pre> <br> ç°åœ¨ï¼Œåœ¨<code>onStreaming()</code>ä¹‹åç«‹å³åœ¨<code>ctrack.start()</code>å‡½æ•°ä¸­è°ƒç”¨<code>trackingLoop()</code>å‡½æ•°ã€‚ æ­¤å‡½æ•°æœ¬èº«å°†è®¡åˆ’åœ¨æ¯ä¸ªå¸§ä¸­é‡æ–°å¯åŠ¨ã€‚ <br><br> åˆ·æ–°é¡µé¢ï¼Œç„¶åæŸ¥çœ‹ç½‘ç»œæ‘„åƒå¤´ã€‚ æ‚¨åº”è¯¥åœ¨è§†é¢‘çª—å£ä¸­çš„è„¸éƒ¨å‘¨å›´çœ‹åˆ°ä¸€ä¸ªç»¿è‰²çš„â€œè’™ç‰ˆâ€ã€‚ æœ‰æ—¶ï¼Œä¸ºäº†ä½¿ç³»ç»Ÿæ­£ç¡®è¯†åˆ«é¢éƒ¨ï¼Œæ‚¨éœ€è¦åœ¨æ¡†æ¶ä¸­ç¨å¾®ç§»åŠ¨å¤´éƒ¨ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/394/ab1/98a/394ab198a25c82f7a6c03eefdbe7c73c.png"></div><br>  <i><font color="#999999">äººè„¸è¯†åˆ«ç»“æœ</font></i> <br><br><h2>  <font color="#3AC1EF">ç¡®å®šåŒ…å«çœ¼ç›çš„å›¾åƒåŒºåŸŸ</font> </h2><br> ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°çœ¼ç›æ‰€åœ¨çš„çŸ©å½¢åŒºåŸŸï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨å•ç‹¬çš„<code>&lt;canvas&gt;</code> ã€‚ <br><br> å¹¸è¿çš„æ˜¯ï¼Œcmltrackerä¸ä»…ä¸ºæˆ‘ä»¬æä¾›äº†æœ‰å…³è„¸éƒ¨ä½ç½®çš„ä¿¡æ¯ï¼Œè¿˜ä¸ºæˆ‘ä»¬æä¾›äº†70ä¸ªæ§åˆ¶ç‚¹ã€‚ å¦‚æœæŸ¥çœ‹cmltrackerçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£</a> ï¼Œåˆ™å¯ä»¥ç²¾ç¡®é€‰æ‹©æˆ‘ä»¬éœ€è¦çš„æ§åˆ¶ç‚¹ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e7/334/c6f/6e7334c6fa51c5c55ebd66b45d0d8dd8.png"></div><br>  <i><font color="#999999">æ§åˆ¶ç‚¹</font></i> <br><br> æˆ‘ä»¬ç¡®å®šçœ¼ç›æ˜¯å›¾åƒçš„çŸ©å½¢éƒ¨åˆ†ï¼Œå…¶è¾¹ç•Œæ¥è§¦ç‚¹23ã€28ã€24å’Œ26ï¼Œåœ¨æ¯ä¸ªæ–¹å‘ä¸Šæ‰©å¤§äº†5ä¸ªåƒç´ ã€‚ è¯¥çŸ©å½¢åº”è¯¥åŒ…å«å¯¹æˆ‘ä»¬æ¥è¯´å¾ˆé‡è¦çš„æ‰€æœ‰å†…å®¹ï¼Œé™¤éç”¨æˆ·å°†å¤´éƒ¨å€¾æ–œå¤ªå¤šã€‚ <br><br> ç°åœ¨ï¼Œåœ¨å¯ä»¥ä½¿ç”¨è¯¥å›¾åƒç‰‡æ®µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å†æ·»åŠ ä¸€ä¸ª<code>&lt;canvas&gt;</code>ä½œä¸ºå…¶è¾“å‡ºã€‚ å…¶å°ºå¯¸ä¸º50x25åƒç´ ã€‚ å¸¦æœ‰çœ¼ç›çš„çŸ©å½¢å°†é€‚åˆæ­¤å…ƒç´ ã€‚ è½»å¾®çš„å›¾åƒå˜å½¢ä¸æ˜¯é—®é¢˜ã€‚ <br><br> å°†æ­¤ä»£ç æ·»åŠ åˆ°æè¿°<code>&lt;canvas&gt;</code>çš„HTMLæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶å°†åŒ…æ‹¬å›¾åƒä¸­å¸¦æœ‰çœ¼ç›çš„éƒ¨åˆ†ï¼š <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eyes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"25"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css">   </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#eyes</span></span></span><span class="css"> {       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">top</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">right</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">;   } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> ä»¥ä¸‹å‡½æ•°å°†è¿”å›<code>x</code>å’Œ<code>y</code>åæ ‡ä»¥åŠçœ¼ç›å‘¨å›´çŸ©å½¢çš„å®½åº¦å’Œé«˜åº¦ã€‚ ä½œä¸ºè¾“å…¥ï¼Œå®ƒæ¥æ”¶ä»clmtrackræ¥æ”¶åˆ°çš„<code>positions</code>æ•°ç»„ã€‚ è¯·æ³¨æ„ï¼Œä»clmtrackræ¥æ”¶åˆ°çš„æ¯ä¸ªåæ ‡éƒ½æœ‰åˆ†é‡<code>x</code>å’Œ<code>y</code> ã€‚ æ­¤å‡½æ•°å¿…é¡»æ·»åŠ åˆ°<code>main.js</code> ï¼š <br><br><pre> <code class="hljs markdown">function getEyesRectangle(positions) { const minX = positions[<span class="hljs-string"><span class="hljs-string">23</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>] - 5; const maxX = positions[<span class="hljs-string"><span class="hljs-string">28</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>] + 5; const minY = positions[<span class="hljs-string"><span class="hljs-string">24</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">1</span></span>] - 5; const maxY = positions[<span class="hljs-string"><span class="hljs-string">26</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">1</span></span>] + 5; const width = maxX - minX; const height = maxY - minY; return [minX, minY, width, height]; }</code> </pre> <br> ç°åœ¨ï¼Œåœ¨æ¯ä¸€å¸§ä¸­ï¼Œæˆ‘ä»¬å°†ä»è§†é¢‘æµä¸­æå–ä¸€ä¸ªå¸¦æœ‰çœ¼ç›çš„çŸ©å½¢ï¼Œåœ¨å åŠ åœ¨<code>&lt;video&gt;</code>å…ƒç´ ä¸Šçš„<code>&lt;canvas&gt;</code>ä¸Šç”¨çº¢çº¿åœˆå‡ºå®ƒï¼Œç„¶åå°†å…¶å¤åˆ¶åˆ°æ–°çš„<code>&lt;canvas&gt;</code> ã€‚ è¯·æ³¨æ„ï¼Œä¸ºäº†æ­£ç¡®è¯†åˆ«æˆ‘ä»¬éœ€è¦çš„åŒºåŸŸï¼Œæˆ‘ä»¬å°†è®¡ç®—æŒ‡æ ‡<code>resizeFactorX</code>å’Œ<code>resizeFactorY</code> ã€‚ <br><br> ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢<code>trackingLoop()</code>å‡½æ•°ä¸­çš„<code>if</code>å—ï¼š <br><br><pre> <code class="hljs powershell"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPosition) { //  ,     //   &lt;canvas&gt;,    &lt;video&gt; ctrack.draw(overlay); //  ,  ,    //   const eyesRect = getEyesRectangle(currentPosition); overlayCC.strokeStyle = <span class="hljs-string"><span class="hljs-string">'red'</span></span>; overlayCC.strokeRect(eyesRect[<span class="hljs-number"><span class="hljs-number">0</span></span>], eyesRect[<span class="hljs-number"><span class="hljs-number">1</span></span>], eyesRect[<span class="hljs-number"><span class="hljs-number">2</span></span>], eyesRect[<span class="hljs-number"><span class="hljs-number">3</span></span>]); //      , //        //      const resizeFactorX = video.videoWidth / video.width; const resizeFactorY = video.videoHeight / video.height; //          //    &lt;canvas&gt; const eyesCanvas = <span class="hljs-variable"><span class="hljs-variable">$</span></span>(<span class="hljs-string"><span class="hljs-string">'#eyes'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; const eyesCC = eyesCanvas.getContext(<span class="hljs-string"><span class="hljs-string">'2d'</span></span>); eyesCC.drawImage(   video,   eyesRect[<span class="hljs-number"><span class="hljs-number">0</span></span>] * resizeFactorX, eyesRect[<span class="hljs-number"><span class="hljs-number">1</span></span>] * resizeFactorY,   eyesRect[<span class="hljs-number"><span class="hljs-number">2</span></span>] * resizeFactorX, eyesRect[<span class="hljs-number"><span class="hljs-number">3</span></span>] * resizeFactorY,   <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, eyesCanvas.width, eyesCanvas.height ); }</code> </pre> <br> ç°åœ¨é‡æ–°åŠ è½½é¡µé¢åï¼Œæ‚¨åº”è¯¥åœ¨çœ¼ç›å‘¨å›´çœ‹åˆ°ä¸€ä¸ªçº¢è‰²çŸ©å½¢ï¼Œå¹¶ä¸”è¯¥çŸ©å½¢åŒ…å«çš„å†…å®¹åœ¨ç›¸åº”çš„<code>&lt;canvas&gt;</code> ã€‚ å¦‚æœæ‚¨çš„çœ¼ç›å¤§äºæˆ‘çš„çœ¼ç›ï¼Œè¯·å°è¯•ä½¿ç”¨<code>getEyeRectangle</code>å‡½æ•°ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c8/29e/5a3/6c829e5a354575ed9c269bebf20c5a5a.png"></div><br>  <i><font color="#999999">&lt;canvas&gt;å…ƒç´ ï¼Œè¯¥å…ƒç´ ç»˜åˆ¶ä¸€ä¸ªåŒ…å«ç”¨æˆ·çœ¼ç›å›¾åƒçš„çŸ©å½¢</font></i> <br><br><h2>  <font color="#3AC1EF">èµ„æ–™æ”¶é›†</font> </h2><br> æœ‰å¾ˆå¤šæ”¶é›†æ•°æ®çš„æ–¹æ³•ã€‚ æˆ‘å†³å®šä½¿ç”¨å¯ä»¥ä»é¼ æ ‡å’Œé”®ç›˜è·å¾—çš„ä¿¡æ¯ã€‚ åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæ•°æ®æ”¶é›†çœ‹èµ·æ¥åƒè¿™æ ·ã€‚ <br><br> ç”¨æˆ·åœ¨é¡µé¢ä¸Šç§»åŠ¨å…‰æ ‡å¹¶ç”¨çœ¼ç›æ³¨è§†ä»–ï¼Œæ¯æ¬¡ç¨‹åºéœ€è¦è®°å½•å¦ä¸€ä¸ªæ ·æœ¬æ—¶æŒ‰ä¸‹é”®ç›˜ä¸Šçš„<code></code> ã€‚ é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¾ˆå®¹æ˜“å¿«é€Ÿæ”¶é›†å¤§é‡æ•°æ®ä»¥è®­ç»ƒæ¨¡å‹ã€‚ <br><br><h3>  <font color="#3AC1EF">â–é¼ æ ‡è¿½è¸ª</font> </h3><br> ä¸ºäº†æ‰¾å‡ºé¼ æ ‡æŒ‡é’ˆåœ¨ç½‘é¡µä¸Šçš„ç¡®åˆ‡ä½ç½®ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<code>document.onmousemove</code>äº‹ä»¶å¤„ç†ç¨‹åºã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬çš„å‡½æ•°è¿˜å¯ä»¥å¯¹åæ ‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œä½¿å…¶é€‚åˆ[-1ï¼Œ1]èŒƒå›´ï¼š <br><br><pre> <code class="hljs pgsql">//   : const mouse = { x: <span class="hljs-number"><span class="hljs-number">0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0</span></span>, handleMouseMove: <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(event) {   //      ,    [<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]   mouse.x = (event.clientX / $(<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>).width()) * <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>;   mouse.y = (event.clientY / $(<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>).height()) * <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>; }, } document.onmousemove = mouse.handleMouseMove;</code> </pre> <br><h3>  <font color="#3AC1EF">â–å½±åƒæ’·å–</font> </h3><br> ä¸ºäº†æ•è·<code>&lt;canvas&gt;</code>æ˜¾ç¤ºçš„å›¾åƒå¹¶å°†å…¶ä¿å­˜ä¸ºå¼ é‡ï¼ŒTensorFlow.jsæä¾›äº†è¾…åŠ©å‡½æ•°<code>tf.fromPixels()</code> ã€‚ æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥ä¿å­˜ç„¶åæ ‡å‡†åŒ–<code>&lt;canvas&gt;</code>ä¸­çš„å›¾åƒï¼Œè¯¥<code>&lt;canvas&gt;</code>æ˜¾ç¤ºä¸€ä¸ªåŒ…å«ç”¨æˆ·çœ¼ç›çš„çŸ©å½¢ï¼š <br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { //       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.tidy(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {   const image = tf.fromPixels($(<span class="hljs-string"><span class="hljs-string">'#eyes'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]);   //  &lt;i&gt;&lt;font color=<span class="hljs-string"><span class="hljs-string">"#999999"</span></span>&gt;&lt;/font&gt;&lt;/i&gt;:   const batchedImage = image.expandDims(<span class="hljs-number"><span class="hljs-number">0</span></span>);   //    :   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> batchedImage.toFloat().div(tf.scalar(<span class="hljs-number"><span class="hljs-number">127</span></span>)).<span class="hljs-built_in"><span class="hljs-built_in">sub</span></span>(tf.scalar(<span class="hljs-number"><span class="hljs-number">1</span></span>)); }); }</code> </pre> <br> è¯·æ³¨æ„ï¼Œ <code>tf.tidy()</code>å‡½æ•°ç”¨äºåœ¨å®Œæˆåè¿›è¡Œæ¸…ç†ã€‚ <br><br> æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰æ ·æœ¬ä¿å­˜åœ¨ä¸€ä¸ªå¤§å‹è®­ç»ƒé›†ä¸­ï¼Œä½†æ˜¯åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ£€æŸ¥æ¨¡å‹è®­ç»ƒçš„è´¨é‡å¾ˆé‡è¦ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸€äº›æ ·æœ¬ä¿å­˜åœ¨å•ç‹¬çš„å¯¹ç…§æ ·æœ¬ä¸­ã€‚ ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ–°æ•°æ®æ£€æŸ¥æ¨¡å‹çš„è¡Œä¸ºï¼Œå¹¶ç¡®å®šæ¨¡å‹æ˜¯å¦å—åˆ°è¿‡åº¦è®­ç»ƒã€‚ ä¸ºæ­¤ï¼Œå¯¹ç…§æ ·å“ä¸­åŒ…æ‹¬æ ·å“æ€»æ•°çš„20ï¼…ã€‚ <br><br> è¿™æ˜¯ç”¨äºæ”¶é›†æ•°æ®å’Œæ ·æœ¬çš„ä»£ç ï¼š <br><br><pre> <code class="hljs pgsql">const dataset = { train: {   n: <span class="hljs-number"><span class="hljs-number">0</span></span>,   x: <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>,   y: <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, }, val: {   n: <span class="hljs-number"><span class="hljs-number">0</span></span>,   x: <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>,   y: <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, }, } <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> captureExample() { //            tf.tidy(<span class="hljs-keyword"><span class="hljs-keyword">function</span></span>() {   const image = getImage();   const mousePos = tf.tensor1d([mouse.x, mouse.y]).expandDims(<span class="hljs-number"><span class="hljs-number">0</span></span>);   // ,    (  )     const subset = dataset[Math.random() &gt; <span class="hljs-number"><span class="hljs-number">0.2</span></span> ? <span class="hljs-string"><span class="hljs-string">'train'</span></span> : <span class="hljs-string"><span class="hljs-string">'val'</span></span>];   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (subset.x == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) {     //        subset.x = tf.keep(image);     subset.y = tf.keep(mousePos);   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {     //          const oldX = subset.x;     const oldY = subset.y;     subset.x = tf.keep(oldX.concat(image, <span class="hljs-number"><span class="hljs-number">0</span></span>));     subset.y = tf.keep(oldY.concat(mousePos, <span class="hljs-number"><span class="hljs-number">0</span></span>));   }   //     subset.n += <span class="hljs-number"><span class="hljs-number">1</span></span>; }); }</code> </pre> <br> æœ€åï¼Œæˆ‘ä»¬éœ€è¦å°†æ­¤å‡½æ•°ç»‘å®šåˆ°<code></code> ï¼š <br><br><pre> <code class="hljs matlab">$(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).keyup(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span><span class="hljs-function"> { //         </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event.keyCode == 32)</span></span></span><span class="hljs-function"> {   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">captureExample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">;   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">event</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">preventDefault</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">;   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">false</span></span></span><span class="hljs-function">; } });</span></span></code> </pre> <br> ç°åœ¨ï¼Œæ¯æ¬¡æŒ‰<code></code> ï¼Œçœ¼å›¾å’Œé¼ æ ‡æŒ‡é’ˆçš„åæ ‡éƒ½ä¼šæ·»åŠ åˆ°å…¶ä¸­ä¸€ä¸ªæ•°æ®é›†ä¸­ã€‚ <br><br><h2>  <font color="#3AC1EF">æ¨¡å‹è®­ç»ƒ</font> </h2><br> åˆ›å»ºä¸€ä¸ªç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚  TensorFlow.jsä¸ºæ­¤ç›®çš„æä¾›äº†è®©äººæƒ³èµ·Kerasçš„APIã€‚ ç½‘ç»œåº”å…·æœ‰ä¸€ä¸ª<code>conv2d</code>å±‚ï¼Œä¸€ä¸ª<code>maxPooling2d</code>å±‚ä»¥åŠæœ€åä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªè¾“å‡ºå€¼çš„<code>dense</code>å±‚ï¼ˆå®ƒä»¬ä»£è¡¨å±å¹•åæ ‡ï¼‰ã€‚ åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸ºç½‘ç»œæ·»åŠ äº†ä¸€ä¸ª<code>dropout</code>å±‚å’Œä¸€ä¸ª<code>flatten</code>å±‚ï¼Œä½œä¸ºæ­£åˆ™åŒ–å™¨ï¼Œä»¥å°†äºŒç»´æ•°æ®è½¬æ¢ä¸ºä¸€ç»´æ•°æ®ã€‚ ç½‘ç»œåŸ¹è®­æ˜¯ä½¿ç”¨Adamä¼˜åŒ–å™¨å®Œæˆçš„ã€‚ <br><br> è¯·æ³¨æ„ï¼Œåœ¨å°è¯•MacBook Airä¹‹åï¼Œæˆ‘å†³å®šä½¿ç”¨è¿™é‡Œä½¿ç”¨çš„ç½‘ç»œè®¾ç½®ã€‚ æ‚¨å¯ä»¥é€‰æ‹©è‡ªå·±çš„æ¨¡å‹é…ç½®ã€‚ <br><br> è¿™æ˜¯æ¨¡å‹ä»£ç ï¼š <br><br><pre> <code class="hljs powershell">let currentModel; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { const model = tf.sequential(); model.add(tf.layers.conv2d({   kernelSize: <span class="hljs-number"><span class="hljs-number">5</span></span>,   filters: <span class="hljs-number"><span class="hljs-number">20</span></span>,   strides: <span class="hljs-number"><span class="hljs-number">1</span></span>,   activation: <span class="hljs-string"><span class="hljs-string">'relu'</span></span>,   inputShape: [<span class="hljs-variable"><span class="hljs-variable">$</span></span>(<span class="hljs-string"><span class="hljs-string">'#eyes'</span></span>)<span class="hljs-type"><span class="hljs-type">.height</span></span>(), <span class="hljs-variable"><span class="hljs-variable">$</span></span>(<span class="hljs-string"><span class="hljs-string">'#eyes'</span></span>)<span class="hljs-type"><span class="hljs-type">.width</span></span>(), <span class="hljs-number"><span class="hljs-number">3</span></span>], })); model.add(tf.layers.maxPooling2d({   poolSize: [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>],   strides: [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>], })); model.add(tf.layers.flatten()); model.add(tf.layers.dropout(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)); //    x  y model.add(tf.layers.dense({   units: <span class="hljs-number"><span class="hljs-number">2</span></span>,   activation: <span class="hljs-string"><span class="hljs-string">'tanh'</span></span>, })); //   Adam     <span class="hljs-number"><span class="hljs-number">0.0005</span></span>     MSE model.compile({   optimizer: tf.train.adam(<span class="hljs-number"><span class="hljs-number">0.0005</span></span>),   loss: <span class="hljs-string"><span class="hljs-string">'meanSquaredError'</span></span>, }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model; }</code> </pre> <br> åœ¨å¼€å§‹è®­ç»ƒç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬è®¾ç½®äº†å›ºå®šæ•°é‡çš„æ—¶ä»£å’Œå¯å˜çš„æ•°æ®åŒ…å¤§å°ï¼ˆå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨éå¸¸å°çš„æ•°æ®é›†ï¼‰ã€‚ <br><br><pre> <code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fitModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> batchSize = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(dataset.train.n * <span class="hljs-number"><span class="hljs-number">0.1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (batchSize &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) {   batchSize = <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (batchSize &gt; <span class="hljs-number"><span class="hljs-number">64</span></span>) {   batchSize = <span class="hljs-number"><span class="hljs-number">64</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentModel == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) {   currentModel = createModel(); } currentModel.fit(dataset.train.x, dataset.train.y, {   <span class="hljs-attr"><span class="hljs-attr">batchSize</span></span>: batchSize,   <span class="hljs-attr"><span class="hljs-attr">epochs</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>,   <span class="hljs-attr"><span class="hljs-attr">shuffle</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,   <span class="hljs-attr"><span class="hljs-attr">validationData</span></span>: [dataset.val.x, dataset.val.y], }); }</code> </pre> <br> ç°åœ¨ï¼Œåœ¨é¡µé¢ä¸Šæ·»åŠ ä¸€ä¸ªæŒ‰é’®ä»¥å¼€å§‹å­¦ä¹ ã€‚ æ­¤ä»£ç è½¬åˆ°HTMLæ–‡ä»¶ï¼š <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"train"</span></span></span><span class="hljs-tag">&gt;</span></span>Train!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css">   </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#train</span></span></span><span class="css"> {       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">top</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">50%</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">left</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">50%</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">transform</span></span></span><span class="css">: </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">translate</span></span></span><span class="css">(-50%, -50%);       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">font-size</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">24pt</span></span></span><span class="css">;   } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> æ­¤ä»£ç å¿…é¡»æ·»åŠ åˆ°JSæ–‡ä»¶ä¸­ï¼š <br><br><pre> <code class="hljs matlab">$(<span class="hljs-string"><span class="hljs-string">'#train'</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fitModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; });</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">ç”¨æˆ·åœ¨å“ªé‡Œçœ‹ï¼Ÿ</font> </h2><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥æ”¶é›†æ•°æ®å¹¶å‡†å¤‡æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹é¢„æµ‹é¡µé¢ä¸Šç”¨æˆ·æ­£åœ¨å¯»æ‰¾çš„ä½ç½®ã€‚ æˆ‘ä»¬åœ¨å±å¹•å‘¨å›´ç§»åŠ¨çš„ç»¿è‰²åœ†åœˆçš„å¸®åŠ©ä¸‹æŒ‡å‘è¿™ä¸ªåœ°æ–¹ã€‚ <br><br> é¦–å…ˆï¼Œåœ¨é¡µé¢ä¸Šæ·»åŠ ä¸€ä¸ªåœ†åœˆï¼š <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"target"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css">   </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#target</span></span></span><span class="css"> {       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background-color</span></span></span><span class="css">: lightgreen;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-radius</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">50%</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">40px</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">40px</span></span></span><span class="css">;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">transition</span></span></span><span class="css">: all </span><span class="hljs-number"><span class="css"><span class="hljs-number">0.1s</span></span></span><span class="css"> ease;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">box-shadow</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">20px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css"> white;       </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">4px</span></span></span><span class="css"> solid </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">rgba</span></span></span><span class="css">(0,0,0,0.5);   } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> ä¸ºäº†åœ¨é¡µé¢ä¸Šç§»åŠ¨å®ƒï¼Œæˆ‘ä»¬ä¼šå®šæœŸä¼ è¾“ç¥ç»ç½‘ç»œçœ¼ç›çš„å½“å‰å›¾åƒï¼Œå¹¶å‘å¥¹è¯¢é—®æœ‰å…³ç”¨æˆ·åœ¨å“ªé‡Œçœ‹çš„é—®é¢˜ã€‚ å“åº”çš„æ¨¡å‹äº§ç”Ÿä¸¤ä¸ªåæ ‡ï¼Œåœ†åº”æ²¿ç€è¯¥åæ ‡ç§»åŠ¨ï¼š <br><br><pre> <code class="hljs matlab"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">moveTarget</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(currentModel == null)</span></span></span><span class="hljs-function"> {   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function">; } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tf</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tidy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(function()</span></span></span><span class="hljs-function"> {   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">image</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">;   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prediction</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentModel</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(image)</span></span></span><span class="hljs-function">;   //          </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">targetWidth</span></span></span><span class="hljs-function"> = $</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('#target')</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outerWidth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">;   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">targetHeight</span></span></span><span class="hljs-function"> = $</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('#target')</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outerHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">;   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(prediction.get(0, 0)</span></span></span><span class="hljs-function"> + 1) / 2 * </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($(window)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">width</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">targetWidth</span></span></span><span class="hljs-function">);   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(prediction.get(0, 1)</span></span></span><span class="hljs-function"> + 1) / 2 * </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($(window)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">height</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">targetHeight</span></span></span><span class="hljs-function">);   //     :   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">target</span></span></span><span class="hljs-function"> = $</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('#target')</span></span></span><span class="hljs-function">;   $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">target</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">css</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('left', x + 'px')</span></span></span><span class="hljs-function">;   $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">target</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">css</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('top', y + 'px')</span></span></span><span class="hljs-function">; }); } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setInterval</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(moveTarget, 100)</span></span></span><span class="hljs-function">;</span></span></code> </pre> <br> æˆ‘å°†é—´éš”è®¾ç½®ä¸º100æ¯«ç§’ã€‚ å¦‚æœæ‚¨çš„è®¡ç®—æœºä¸å¦‚æˆ‘çš„è®¡ç®—æœºå¼ºå¤§ï¼Œåˆ™å¯ä»¥å†³å®šå°†å…¶æ”¾å¤§ã€‚ <br><br><h2>  <font color="#3AC1EF">æ€»ç»“</font> </h2><br> ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»æ‹¥æœ‰å®ç°æœ¬ææ–™å¼€å¤´æå‡ºçš„æƒ³æ³•æ‰€éœ€çš„ä¸€åˆ‡ã€‚ ä½“éªŒæˆ‘ä»¬æ‰€åšçš„äº‹æƒ…ã€‚ è·Ÿéšä»–çš„çœ¼ç›ç§»åŠ¨é¼ æ ‡å…‰æ ‡ï¼Œç„¶åæŒ‰ç©ºæ ¼é”®ã€‚ ç„¶åå•å‡»å¼€å§‹è®­ç»ƒæŒ‰é’®ã€‚ <br><br> æ”¶é›†æ›´å¤šæ•°æ®ï¼Œå†æ¬¡å•å‡»æŒ‰é’®ã€‚ ç¨åï¼Œæ³¨è§†åï¼Œç»¿è‰²åœ†åœˆå°†å¼€å§‹åœ¨å±å¹•ä¸Šç§»åŠ¨ã€‚ é¦–å…ˆï¼Œåˆ°è¾¾æ‚¨è¦çœ‹çš„åœ°æ–¹å¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œä½†æ˜¯ä»å¤§çº¦50ä¸ªæ”¶é›†çš„æ ·æœ¬å¼€å§‹ï¼Œç»è¿‡å‡ ä¸ªé˜¶æ®µçš„åŸ¹è®­ï¼Œå¦‚æœå¹¸è¿çš„è¯ï¼Œå®ƒå°†å¾ˆå‡†ç¡®åœ°ç§»è‡³è¦æŸ¥çœ‹çš„é¡µé¢ä¸Šã€‚ åœ¨æ­¤ææ–™ä¸­è§£æçš„ç¤ºä¾‹çš„å®Œæ•´ä»£ç å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚ <br><br> å°½ç®¡æˆ‘ä»¬æ‰€åšçš„å·¥ä½œçœ‹èµ·æ¥å¾ˆæœ‰è¶£ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥è¿›è¡Œè®¸å¤šæ”¹è¿›ã€‚ å¦‚æœç”¨æˆ·ç§»åŠ¨å…¶å¤´éƒ¨æˆ–æ”¹å˜å…¶åœ¨ç›¸æœºå‰çš„ä½ç½®æ€ä¹ˆåŠï¼Ÿ æˆ‘ä»¬çš„é¡¹ç›®ä¸ä¼šå½±å“é€‰æ‹©é™åˆ¶çœ¼ç›æ‰€åœ¨å›¾åƒåŒºåŸŸçš„çŸ©å½¢çš„å¤§å°ï¼Œä½ç½®å’Œè§’åº¦çš„å¯èƒ½æ€§ã€‚ å®é™…ä¸Šï¼Œåœ¨è¿™é‡Œè®¨è®ºçš„ç¤ºä¾‹çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®Œæ•´ç‰ˆæœ¬</a>ä¸­å®ç°äº†è®¸å¤šå…¶ä»–åŠŸèƒ½ã€‚ ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸€äº›ï¼š <br><br><ul><li> ä¸Šè¿°ç”¨äºè‡ªå®šä¹‰çŸ©å½¢æ¡†çš„é€‰é¡¹ã€‚ </li><li> å°†å›¾åƒè½¬æ¢ä¸ºç°åº¦ã€‚ </li><li> ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CoordConv</a> ã€‚ </li><li> ä¸€ä¸ªçƒ­å›¾ï¼Œç”¨äºæ£€æŸ¥æ¨¡å‹åœ¨å“ªäº›åœ°æ–¹æ•ˆæœè‰¯å¥½ä»¥åŠåœ¨å“ªäº›åœ°æ–¹æ•ˆæœä¸å¥½ã€‚ </li><li> èƒ½å¤Ÿä¿å­˜å’ŒåŠ è½½æ•°æ®é›†ã€‚ </li><li> ä¿å­˜å’ŒåŠ è½½æ¨¡å‹çš„èƒ½åŠ›ã€‚ </li><li> ä¿æŒé‡é‡çš„ä¸œè¥¿åœ¨è®­ç»ƒåæ˜¾ç¤ºå‡ºæœ€å°çš„è®­ç»ƒæŸå¤±ã€‚ </li><li> æ”¹è¿›çš„ç”¨æˆ·ç•Œé¢ä»¥åŠæœ‰å…³ä½¿ç”¨ç³»ç»Ÿçš„ç®€è¦è¯´æ˜ã€‚ </li></ul><br>  <b>äº²çˆ±çš„è¯»è€…ä»¬ï¼</b> æ‚¨ä½¿ç”¨TensorFlowå—ï¼Ÿ <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN426055/">https://habr.com/ru/post/zh-CN426055/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN426041/index.html">ä½¿ç”¨SymPyçš„Laplaceå˜æ¢æ–¹æ³•å¯¹çº¿æ€§å¾®åˆ†æ–¹ç¨‹å’Œç³»ç»Ÿçš„ç¬¦å·è§£</a></li>
<li><a href="../zh-CN426045/index.html">.NETä¸­çš„ç‰¹æ®Šå¼‚å¸¸ä»¥åŠå¦‚ä½•å‡†å¤‡å®ƒä»¬</a></li>
<li><a href="../zh-CN426047/index.html">è‹±è¯­åˆå­¦è€…çš„10æœ¬å¥½ä¹¦</a></li>
<li><a href="../zh-CN426051/index.html">æ”¹å–„è½¯ä»¶è°ƒè¯•æŠ€èƒ½-ä¸€äº›æŠ€å·§</a></li>
<li><a href="../zh-CN426053/index.html">äº‹ä»¶å¤„ç†ç¨‹åºç¼“å­˜å’ŒReactåº”ç”¨ç¨‹åºæ€§èƒ½æ”¹è¿›</a></li>
<li><a href="../zh-CN426059/index.html">Tutu PHPèšä¼šï¼ƒ2ï¼šæ¼”è®²è§†é¢‘</a></li>
<li><a href="../zh-CN426061/index.html">å¾®è½¯åŠ å…¥å¼€æ”¾å‘æ˜ç½‘ç»œå¹¶æˆäºˆ60,000ä¸ªè®¸å¯</a></li>
<li><a href="../zh-CN426063/index.html">HPE MSAå…¥é—¨çº§é˜µåˆ—åˆ›æ–°ï¼šæ›´å®æƒ çš„é—ªå­˜é˜µåˆ—å’Œä¸°å¯Œçš„è§£å†³æ–¹æ¡ˆé›†æˆ</a></li>
<li><a href="../zh-CN426065/index.html">æ™ºèƒ½ç”µè§†æœ¬èº«å†³å®šäº†æœ€æœ‰è¶£çš„é¢‘é“ï¼Œè¿˜æ˜¯ä¸€ç§ç‹¬ç‰¹çš„è§†é¢‘å†…å®¹æ•°ç‹¬è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="../zh-CN426067/index.html">åƒä¸¤æ¬¡å¤§ç«ä¸€æ ·ç§»åŠ¨ï¼Ÿ å†æ¬¡å…³äºäººå‘˜æ¬è¿</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>