<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎅🏾 👨🏻‍🎤 🐮 Exim patché - patchez à nouveau. Nouvelle exécution de commande à distance dans Exim 4.92 en une seule demande 🕐 🚩 👩🏿‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Plus récemment, au début de l'été, il y a eu des appels massifs pour mettre à jour Exim vers la version 4.92 en raison de la vulnérabilité CVE-2019-10...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Exim patché - patchez à nouveau. Nouvelle exécution de commande à distance dans Exim 4.92 en une seule demande</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/467089/"><p><img src="https://habrastorage.org/webt/w3/6y/su/w36ysucnkuecnyzhrqzf-9z_qpo.jpeg"></p><br><p>  Plus récemment, au début de l'été, il y a eu des appels massifs pour mettre à jour Exim vers la version 4.92 en raison de la vulnérabilité CVE-2019-10149 (Mettre à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">jour d'urgence Exim vers 4.92 - infection active / Habr</a> ).  Et l'autre jour, il s'est avéré que le malware Sustes a décidé de profiter de cette vulnérabilité. </p><br><p>  Désormais, tous ceux mis à jour en urgence peuvent à nouveau être «heureux»: le 21 juillet 2019, le chercheur de Zerons a découvert une vulnérabilité critique dans l' <strong>agent de transfert de courrier Exim (MTA) lors de l'utilisation de TLS</strong> pour les versions <strong>4.80 à 4.92.1</strong> inclusivement, permettant l' <strong>exécution de code à</strong> distance <strong>avec des privilèges privilégiés</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE -2019-15846</a> ). </p><a name="habracut"></a><br><h3 id="uyazvimost">  Vulnérabilité </h3><br><p>  La vulnérabilité est présente lors de l'utilisation des bibliothèques GnuTLS et OpenSSL lors de l'établissement d'une connexion TLS sécurisée. </p><br><p>  Selon le développeur Heiko Schlittermann, le fichier de configuration dans Exim n'utilise pas TLS par défaut, cependant, de nombreuses distributions créent les certificats nécessaires lors de l'installation et incluent une connexion sécurisée.  Les versions plus récentes d'Exim définissent également l'option <em>tls_advertise_hosts = *</em> et génèrent les certificats nécessaires. </p><br><blockquote>  dépend de la configuration.  La plupart des distributions l'activent par défaut, mais Exim a besoin d'un certificat + clé pour fonctionner comme un serveur TLS.  Les Distros créent probablement un Cert lors de l'installation.  Les nouveaux Exims ont l'option tls_advertise_hosts par défaut à "*" et créent un certificat auto-signé, si aucun n'est fourni. </blockquote><p> La vulnérabilité elle-même consiste en un traitement SNI incorrect (Server Name Indication, une technologie introduite en 2003 dans la RFC 3546 pour qu'un client demande un certificat valide pour un nom de domaine, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Distribution de la norme TLS SNI / Blog de la société WEBO Group / Habr</a> ) lors d'une prise de contact TLS.  Il suffit à l'attaquant d'envoyer un SNI se terminant par une barre oblique inverse ("\") et un caractère nul ("\ 0"). </p><br><p>  Les chercheurs de Qualys ont trouvé un bogue dans la fonction string_printing (tls_in.sni), qui est l'échappement incorrect "\".  Par conséquent, la barre oblique inverse est écrite sous forme non échappée dans le fichier d'en-tête de la bobine d'impression.  De plus, ce fichier avec des droits privilégiés est lu par la fonction spool_read_header (), ce qui entraîne un débordement de tas. </p><br><p>  <strong>Il convient de noter qu'à l'heure actuelle, les développeurs Exim ont créé des vulnérabilités PoC avec l'exécution de commandes sur un serveur vulnérable distant, mais il n'est pas encore accessible au public.</strong>  <strong>En raison de la facilité d'utilisation du bogue, ce n'est qu'une question de temps, et assez courte.</strong> </p><br><p>  Une étude plus détaillée de Qualys est disponible <a href="">ici</a> . </p><br><p><img src="https://habrastorage.org/webt/50/qt/j-/50qtj-fn2xezvc6edxtjjh2eaqw.png" alt="Utilisation de SNI dans TLS"></p><br><p>  <em>Utilisation de SNI dans TLS</em> </p><br><h3 id="kolichestvo-potencialno-uyazvimyh-publichnyh-serverov">  Nombre de serveurs publics potentiellement vulnérables </h3><br><p>  Selon les statistiques d'un grand hébergeur <strong>E-Soft Inc,</strong> au 1er septembre, la version 4.92 est utilisée sur plus de 70% des hôtes sur des serveurs loués. </p><br><div class="scrollable-table"><table><thead><tr><th>  La version </th><th>  Nombre de serveurs </th><th>  Pourcent </th></tr></thead><tbody><tr><td>  4.92.1 </td><td>  6471 </td><td>  1,28% </td></tr><tr><td>  <strong>4,92</strong> </td><td>  <strong>376436</strong> </td><td>  <strong>74,22%</strong> </td></tr><tr><td>  4,91 </td><td>  58179 </td><td>  11,47% </td></tr><tr><td>  4.9 </td><td>  5732 </td><td>  1,13% </td></tr><tr><td>  4,89 </td><td>  10700 </td><td>  2,11% </td></tr><tr><td>  4,87 </td><td>  14177 </td><td>  2,80% </td></tr><tr><td>  4,84 </td><td>  9937 </td><td>  1,96% </td></tr><tr><td>  Autres versions </td><td>  25568 </td><td>  5,04% </td></tr></tbody></table></div><br><p>  <em>Statistiques sur la société E-Soft Inc</em> </p><br><p>  Si vous vous tournez vers le moteur de recherche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>Shodan</strong></a> , alors à partir de 5 250 000 dans la base de données du serveur: </p><br><ul><li>  environ 3 500 000 utilisent Exim 4.92 (environ 1 380 000 utilisent SSL / TLS); </li><li>  plus de 74 000 utilisent 4.92.1 (environ 25 000 utilisent SSL / TLS). </li></ul><br><p>  Ainsi, il existe environ <strong>1,5 million de</strong> serveurs Exim potentiellement vulnérables et connus du public. </p><br><p><img src="https://habrastorage.org/webt/de/re/g1/dereg1wjlk1oeohppbhvt49dau4.png" alt="Trouver des serveurs Exim à Shodan"></p><br><p>  <em>Trouver des serveurs Exim à Shodan</em> </p><br><h3 id="zaschita">  La protection </h3><br><ul><li>  L'option la plus simple, mais non recommandée, est de ne pas utiliser TLS, ce qui entraînera le transfert des e-mails en texte clair. </li><li>  Pour éviter l'exploitation de la vulnérabilité, il sera plus préférable de passer à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exim Internet Mailer 4.92.2</a> . </li><li>  S'il n'est pas possible de mettre à niveau ou d'installer la version corrigée, vous pouvez définir la liste de contrôle d'accès dans la configuration Exim pour l'option <strong>acl_smtp_mail</strong> avec les règles suivantes: <br><br><pre><code class="plaintext hljs"># to be prepended to your mail acl (the ACL referenced # by the acl_smtp_mail main config option) deny condition = ${if eq{\\}{${substr{-1}{1}{$tls_in_sni}}}} deny condition = ${if eq{\\}{${substr{-1}{1}{$tls_in_peerdn}}}}</code> </pre> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467089/">https://habr.com/ru/post/fr467089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467079/index.html">Carrousel CSS et Javascript Ant</a></li>
<li><a href="../fr467081/index.html">Analyse de la coloration émotionnelle des critiques de Kinopoisk</a></li>
<li><a href="../fr467083/index.html">Comment l'étrange instruction popcount est utilisée dans les processeurs modernes</a></li>
<li><a href="../fr467085/index.html">La décompilation C, C ++ et DotNet sont les bases de l'inverse. Résolution des problèmes de marche arrière avec r0ot-mi. partie 1</a></li>
<li><a href="../fr467087/index.html">Comment j'ai préparé et réussi la certification Oracle Database SQL (1Z0-071)</a></li>
<li><a href="../fr467091/index.html">Une introduction rapide à Svelte du point de vue d'un développeur angulaire</a></li>
<li><a href="../fr467093/index.html">Espionner vos programmes avec Strace</a></li>
<li><a href="../fr467095/index.html">Plus simple qu'il n'y paraît. 20</a></li>
<li><a href="../fr467097/index.html">Utilisation de la bibliothèque de pagination avec Realm</a></li>
<li><a href="../fr467099/index.html">Hapi pour les petits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>