<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ ğŸ‘ğŸ½ ğŸ™‹ğŸ¼ Analisis perilaku Trojan Pegasus di jaringan ğŸ’ƒğŸ» ğŸ’¹ ğŸš¡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kode sumber untuk trojan perbankan Pegasus baru-baru ini diterbitkan . Terlepas dari penyebutan kelompok Carbanak atas nama arsip, para peneliti dari ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analisis perilaku Trojan Pegasus di jaringan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/418017/">  Kode sumber untuk trojan perbankan Pegasus baru-baru ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diterbitkan</a> .  Terlepas dari penyebutan kelompok Carbanak atas nama arsip, para peneliti dari Minerva Labs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">membantah</a> keterlibatan Trojan dalam kelompok ini dan membuktikan keterlibatan mereka dalam kelompok <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Buhtrap</a> (Ratopak).  Di dalam arsip adalah deskripsi singkat tentang pekerjaan Trojan, kode sumbernya, deskripsi sistem pembayaran bank dan data karyawan banyak bank Rusia. <br><br>  Arsitektur kode sumber malware ini cukup menarik.  Fungsionalitas dibagi menjadi beberapa modul yang dirangkai menjadi satu â€œbinpackâ€ pada tahap kompilasi.  Proses kompilasi juga mencakup penandatanganan file yang dapat dieksekusi dengan sertifikat dari file tric.pfx, yang tidak ada dalam arsip. <br><br>  Yang tidak kalah penasaran adalah aktivitas jaringan Pegasus, yang, setelah infeksi, mencoba menyebar di dalam domain dan tahu bagaimana mem-proxy data antara mesin yang menggunakan pipa dan transportasi Mailslot.  Kami fokus mempelajari fitur-fitur aktivitas jaringan Trojan dan dengan cepat menambahkan deteksi Pegasus ke produk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PT Network Attack Discovery</a> .  Ini akan memungkinkan semua penggunanya untuk mendeteksi aktivitas trojan ini dan modifikasinya tepat waktu di jaringan mereka.  Pada artikel ini, saya akan memberikan deskripsi rinci tentang mekanisme distribusi jaringan dan interaksi antara salinan Pegasus. <br><br><img src="https://habrastorage.org/webt/yn/sn/-u/ynsn-udu1ai9y-xbrolf4fubrta.png"><a name="habracut"></a><br><br><h2>  Intro </h2><br>  Setelah berada di mesin, modul InstallerExe utama menyuntikkan kode ke svchost.exe menggunakan teknik Proses Hollow dan, setelah menginisialisasi modul utama, Pegasus memulai beberapa proses paralel: <br><br><ol><li>  Replikasi Domain - terlibat dalam intelijen dalam jaringan dan upaya untuk menyebar ke mesin Windows lainnya. </li><li>  Mailslot Listener mendengarkan pesan mailslot broadcast, di mana Pegasus mengirimkan akun yang ditambang.  Nama slot dihasilkan pada waktu kompilasi. </li><li>  Pipe Server Listener mendengarkan Windows Pipe dengan nama yang dibuat atas nama mesin.  Pipa-pipa ini terutama digunakan untuk mendeteksi salinan Pegasus lain pada jaringan dan interaksinya. </li><li>  Kata Sandi Log masuk secara berkala setiap beberapa menit mencoba untuk membuang data akun dengan modul dari Mimikatz. </li><li>  Network Connectivity bertanggung jawab untuk komunikasi dengan server CnC dan pengiriman pesan berkala. </li></ol><br><pre><code class="bash hljs">// start transports <span class="hljs-built_in"><span class="hljs-built_in">which</span></span> links data with our CB-manager pwInitPipeServerAsync(dcmGetServerCallback()); mwInitMailslotServer(dcmGetServerCallback()); ... // start broadcasting creds to other machines cmStartupNetworkBroadcaster();</code> </pre> <br><h2>  Replikasi domain </h2><br>  Salah satu subsistem di Pegasus bertanggung jawab atas Gerakan Lateral pada jaringan Windows.  Distribusi dibagi menjadi dua langkah penting: <br><br><ol><li>  Deteksi mobil tetangga. </li><li>  Mencoba replikasi ke mesin. </li></ol><br>  Penemuan mesin tetangga di domain dilakukan melalui dua panggilan API: <br><br><img src="https://habrastorage.org/webt/-p/6f/sj/-p6fsjb6pe8v-rdjacycwncholk.png" align="left">  NetServerEnum, yang membutuhkan layanan Browser dan panggilan ke WNetOpenEnum / WNetEnumResource. <br>  Semua mesin yang ditemukan di domain harus dipindai jika sudah terinfeksi.  Pegasus melakukan jajak pendapat nama pipa yang dihasilkan setiap 200 milidetik selama lebih dari 20 kali berturut-turut.  Kami menggunakan perilaku abnormal ini sebagai salah satu indikator aktivitas Pegasus di domain.  Karena tidak mendeteksi tanda-tanda infeksi, malware melanjutkan ke langkah berikutnya - upaya replikasi. <br><br><img src="https://habrastorage.org/webt/j0/nw/yl/j0nwylxgv6mvqzd8krxwf2su2x8.png" align="left">  Replikasi adalah sebagai berikut.  Menggunakan akun yang ditemukan (KM) pada host, Pegasus mencoba masuk ke mesin menggunakan protokol SMB ke $ IPC dan ADMIN $ bola, dan jika ada akses ke $ IPC dan tidak ada akses ke $ ADMIN, maka Pegasus menyimpulkan bahwa itu benar akun tidak cukup dan harus ditandai sebagai tidak valid.  Setelah memperoleh akses ke ADMIN $ ball, yang merupakan alias untuk folder% windir%, malware mencoba menentukan arsitektur mesin untuk menggunakan modul yang sesuai di masa depan. <br><br>  Algoritma penentuan arsitektur didasarkan pada header file PE pada mesin jarak jauh.  Sebagai file seperti itu, Pegasus mencoba membaca 4 kilobyte pertama dari notepad.exe dari folder% windir%.  Kelemahan yang jelas dari metode ini adalah bahwa pada Windows Server 2012, notepad terletak di jalur% windir% \ System32. <br><br>  Lokasi notepad.exe di Windows 7: <br><br><pre> <code class="bash hljs">C:\Users\Administrator&gt;<span class="hljs-built_in"><span class="hljs-built_in">where</span></span> notepad.exe C:\Windows\System32\notepad.exe C:\Windows\notepad.exe</code> </pre><br>  Di Windows Server 2012: <br><br><pre> <code class="bash hljs">C:\Users\Administrator&gt;<span class="hljs-built_in"><span class="hljs-built_in">where</span></span> notepad.exe C:\Windows\System32\notepad.exe</code> </pre><br>  Jika tidak mendeteksi notepad.exe, Pegasus tidak dapat menginfeksi server, meskipun memiliki informasi akun dengan hak yang diperlukan.  Tidak adanya notepad di% windir% dapat menghentikan distribusi Pegasus pada Windows Server 2012. Menggunakan regedit.exe dalam hal ini lebih dapat diandalkan. <br><br>  Setelah berhasil mendefinisikan arsitektur server target, Pegasus memuat dropper RSE (Remote Service Exe) kecil berukuran sekitar 10 kilobyte, yang tugasnya memuatkan binpack dari modul Pegasus melalui pipa dalam bentuk yang jelas dan kontrol transfer ke modul Shellcode.  Nama dropper terdiri dari pseudo-random dan terdiri dari serangkaian karakter heksadesimal dari 8 hingga 15 karakter.  Generator pseudo-acak diinisialisasi tergantung pada nama mesin target dan akan sama antara mulai untuk menghindari kemungkinan kekacauan% â€‹â€‹windir% dengan salinan dropper sebelumnya. <br><br><img src="https://habrastorage.org/webt/pu/qb/hf/puqbhf_9-i8k7civefzklrqegxk.png"><br><br>  Dropper diperiksa untuk integritas dan kemungkinan penghapusan oleh antivirus, setelah itu diluncurkan oleh salah satu dari dua mekanisme yang diterapkan - SCM atau WMI, dan pertama-tama Pegasus mencoba untuk memulai RSE melalui mekanisme WMI, dan hanya kemudian menggunakan Service Control Manager (SCM).  Ini karena SCM meninggalkan lebih banyak jejak di log Windows.  Pembuat Pegasus juga merencanakan metode distribusi lainnya - Wsh Remote, Powershell remoting, Penjadwal Tugas, dan modul untuk mengeksekusi perintah melalui RDP sedang dikembangkan. <br><br>  Seperti disebutkan di atas, setelah peluncuran yang sukses, dropper memeriksa dan membuka pipa untuk mendengarkan dan mentransfer kontrol ke muatan yang masuk. <br><br><img src="https://habrastorage.org/webt/od/zt/to/odztto9o8_yrp0galq3-9_owej4.png"><br><br>  Karena kode Pegasus disuntikkan oleh metode Proses Hollow ke dalam proses svchost.exe, modul InstallerExe asli tidak boleh tetap pada disk jika terjadi infeksi primer, maupun dropper RSE jika terjadi distribusi.  Jika pipet masih dapat diakses oleh jalur yang dikenal, Pegasus menghapusnya dengan caranya sendiri: <br><br><ol><li>  menimpa isi file dengan data acak; </li><li>  menimpa dengan data kosong (nol); </li><li>  ganti nama file; </li><li>  penghapusan file. </li></ol><br><img src="https://habrastorage.org/webt/up/ti/uy/uptiuydt0vx1zc9lz29l2kcdy80.png"><br><br>  Setelah infeksi berhasil, proses distribusi Replikasi Domain dimulai lagi. <br><br><h2>  Mailslot berfungsi </h2><br><img src="https://habrastorage.org/webt/z1/oa/hu/z1oahuoskry5bzymotu4d6n_9kk.png" align="left">  Setelah Pegasus mendapatkan akses ke data akun baik dari salinan Pegasus lain atau dari modul mod_LogonPasswords, ia akan mulai menyiarkan data AS berdasarkan domain.  Distribusi dilakukan menggunakan mekanisme SMB berbasis Mailslot, yang memungkinkan penyiaran searah sebagian kecil data di seluruh domain.  Distribusi berlangsung sesuai dengan nama slot yang dibuat secara acak dan sehingga semua mesin yang terinfeksi dalam domain dapat mengirim dan menerima data dengan satu nama, generator pseudo-acak untuk nama diinisialisasi dari variabel TARGET_BUILDCHAIN_HASH yang ditentukan dalam konfigurasi selama proses pembuatan. <br><br>  Karena mekanisme Mailslot memberlakukan batasan pada ukuran paket maksimum, hanya satu KM dikirim pada suatu waktu sesuai dengan prinsip waktu pengiriman terakhir: di antara semua KM yang tersedia, domain yang tanggal pengiriman terakhirnya adalah yang tertua dikirim oleh domain. <br><br><img src="https://habrastorage.org/webt/e6/rw/wt/e6rwwt8svxdb_yzrszemgjeonlk.png" align="right">  Data dalam Mailslot tidak ditransmisikan dalam teks yang jelas, tetapi dibungkus dengan tiga lapis enkripsi XOR, dan kunci dikirimkan bersama dengan data.  Lapisan data pertama adalah amplop NetMessageEnvelope dengan pemeriksaan integritas data oleh algoritma SHA1, digunakan untuk semua data yang dikirimkan melalui jaringan lokal.  4 byte data pada awal paket adalah kuncinya, yang diubah oleh pergeseran bit 5 bit ke kanan per siklus.  Di dalam amplop adalah struktur data yang disandikan XOR dengan bidang AS langsung dan tanggal mereka ditambahkan.  Kunci 8 dan byte juga terletak di awal struktur, tetapi diterapkan tanpa offset.  Setelah decoding struktur KM, itu hanya tinggal deserialize bidang individu dari struktur ENC_BUFFER seperti nama komputer, nama domain, nama pengguna dan kata sandi.  Bidang-bidang ini dienkripsi dengan kunci 8-byte dengan offset.  Skrip untuk mendekripsi paket Mailslot dan contoh dari paket tersebut dapat ditemukan di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">script</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PCAP</a> . <br><br>  Periode untuk mengirim pesan Mailslot dalam versi rilis berkisar dari 20 detik hingga 11 menit. <br><br><pre> <code class="bash hljs">// some random <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> before making next step DbgPrint(<span class="hljs-string"><span class="hljs-string">"going to sleep"</span></span>); <span class="hljs-comment"><span class="hljs-comment">#ifdef _DEBUG // debug - 2-5 s Sleep(rg.rgGetRnd(&amp;rg, 2000, 5000)); #else // release - 20 - 650 s //Sleep(rg.rgGetRnd(&amp;rg, 2000, 65000) * 10); Sleep(rg.rgGetRnd(&amp;rg, 2000, 15000)); #endif</span></span></code> </pre> <br>  Selain bertukar akun, mekanisme Mailslot digunakan untuk mencari mesin yang terinfeksi dengan akses Internet dan untuk mengiklankan akses Internet.  Amplop NetMessageEnvelope menyimpan jenis pesan yang dikirim.  Pertukaran data antara mesin tanpa akses dan mesin dengan akses Internet dilakukan melalui pipa. <br><br><h2>  Pipa bekerja </h2><br>  Untuk komunikasi dua arah atau transfer data dalam jumlah besar, salinan Pegasus menggunakan pipa sebagai saluran komunikasi.  Nama pipa, meskipun juga dihasilkan oleh generator pseudo-acak, tetapi tergantung pada nama mesin dan membangun dan, dengan demikian, memungkinkan bagian klien dan server untuk menggunakan nama yang sama. <br><br>  Dalam komunikasi satu arah, misalnya, mentransfer binpack selama replikasi ke komputer lain, data tidak dienkripsi dan dikirimkan secara jelas.  Binpack dimulai dengan struktur SHELLCODE_CONTEXT dengan panjang 561 byte. <br><br><img src="https://habrastorage.org/webt/qf/ja/89/qfja89-eipqz2lncisi7fkcuqbe.png"><br><br>  Selama transmisi dua arah, misalnya, memproksi data antara salinan Pegasus tanpa akses Internet dan server CnC, struktur amplop NetMessageEnvelope yang sama dengan enkripsi XOR digunakan seperti dalam kasus Mailslot, karena  memungkinkan Anda untuk membedakan berbagai jenis pesan di bidang id. <br><br>  Secara arsitektur, proksi data dilakukan melalui permintaan untuk mentransfer sebagian data (PMI_SEND_QUERY), menerima id permintaan sebagai tanggapan dan menanyakan status tugas dengan id (PMI_CHECK_STATUS_QUERY).  Sebagai aturan, struktur Amplop lain ditransfer sebagai beban, menambahkan berbagai fungsi dan lapisan enkripsi lainnya. <br><br>  Selain itu, bekerja dengan pipa tidak berakhir pada interaksi antara mesin yang terinfeksi.  Modul mod_KBRI_hd menyuntikkan kode ke dalam proses cmd.exe yang memotong panggilan MoveFileExW dan menganalisis semua data yang disalin, karena ini adalah bagian dari proses pembayaran.  Jika file yang disalin berisi data yang menarik bagi penyerang - data dengan pembayaran, pemberitahuan tentang ini dikirim ke server CnC.  Komunikasi antara modul mod_KBRI disuntikkan ke cmd.exe dan salinan Pegasus dilakukan di dalam mesin yang terinfeksi melalui pipa yang namanya tidak dihasilkan tetapi hardcoded dalam kode sumber: <br><br><pre> <code class="bash hljs">\.\pipe\pg0F9EC0DB75F67E1DBEFB3AFA2</code> </pre> <br><img src="https://habrastorage.org/webt/xr/eh/uj/xrehuj7ia40r-g4ka-osjtq9gjc.png" align="left">  Fungsionalitas modul juga termasuk penggantian akun data dengan cepat sesuai dengan templat.  Contoh pola untuk mencari di tangkapan layar. <br><br><h2>  Lalu lintas Cnc </h2><br>  Aliran terpisah bertanggung jawab untuk pertukaran data langsung dengan server CnC, yang memeriksa antrian potongan data dari proses internal atau salinan malware lainnya setiap beberapa menit dan mengirimkannya ke server. <br><br>  Selama inisialisasi modul mod_NetworkConnectivity, ia melakukan pemeriksaan multistage koneksi jaringan: <br><br>  1) Mendeteksi pengaturan server proxy dan mencoba terhubung ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.google.com</a> : <br><br><ul><li>  Di cabang registri \\ Perangkat Lunak \\ Microsoft \\ Windows \\ CurrentVersion \\ Pengaturan Internet. </li><li>  Melalui WPAD (hubungi WinHttpGetProxyForUrl). </li><li>  Melalui konfigurasi proksi untuk pengguna saat ini (hubungi WinHttpGetIEProxyConfigForCurrentUser). </li></ul><br>  2) Memeriksa koneksi dengan server pembaruan Microsoft dan data yang dikembalikan ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">authrootseq.txt</a> , <a href="">authrootstl.cab</a> , <a href="">rootupd.exe</a> ) <br><br>  3) Menguji koneksi HTTPS dengan salah satu dari 6 alamat: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">safebrowsing.google.com</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">aus3.mozilla.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">addons.mozilla.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fhr.data.mozilla.com</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">versioncheck-bg.addons.mozilla.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">services.addons.mozilla.org</a> </li></ul><br>  Hanya setelah melewati semua pemeriksaan, Pegasus percaya bahwa ia memiliki akses yang diperlukan ke jaringan eksternal dan dapat mengumumkannya melalui domain Mailslot dengan pesan.  Selain itu, Pegasus dapat menyamar dan berkomunikasi dengan server CnC hanya selama jam kerja - dari jam 9 pagi sampai 7 malam waktu setempat. <br><br>  Pegasus mengirimkan potongan data yang dibungkus dalam sebuah amplop dengan perhitungan hash dari jumlah dalam bentuk terenkripsi menggunakan enkripsi DES dalam mode CRYPT_MODE_CBC / PKCS5_PADDING.  Kunci enkripsi hanya bergantung pada variabel selama kompilasi, dan dengan demikian kami dapat mendekripsi lalu lintas antara malware dan server hanya dengan mengetahui BUILDCHAIN_HASH-nya.  Dalam kode sumber di dalam arsip, variabel ini memiliki nilai 0x7393c9a643eb4a76.  Sebuah skrip untuk mendekripsi Check-in ke server dan contoh dari paket semacam itu dapat ditemukan di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">script</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PCAP</a> . <br><br>  Ini mentransfer konten tersebut (struktur INNER_ENVELOPE) ke server CnC selama Check-in, atau bersama-sama dengan data apa pun.  Awalnya, ada 28 byte amplop dengan bidang panjang dan jumlah SHA1. <br><br><img src="https://habrastorage.org/webt/po/zs/7s/pozs7shklsxh653kgnbxkgnmgl0.png"><br><br>  Data yang sama ditransfer antara mesin selama proksi melalui pipa, tetapi dibungkus dengan amplop NetMessageEnvelope yang kita tahu dengan jumlah hash dan enkripsi XOR. <br><br>  Operator CnC dapat mengirim perintah untuk dieksekusi ke salinan dan pesan Pegasus dengan perintah atau data lain, misalnya, EID_CREDENTIALS_LIST dapat berisi lapisan enkripsi bidang mereka sendiri, seperti yang kita lihat dalam contoh akun penyiaran. <br><br><h2>  Deteksi </h2><br>  Pertama-tama, kami tertarik untuk mendeteksi aktivitas Pegasus di jaringan dan, setelah mempelajari kode sumber dengan hati-hati dan berjalan di lingkungan pengujian, kami menemukan anomali jaringan dan artefak yang dengan jelas menunjukkan adanya malware kompleks di jaringan.  Pegasus benar-benar dapat disebut serbaguna - secara aktif menggunakan protokol SMB untuk mengirim pesan dan menjalin komunikasi dengan salinan lain, menyebar ke mesin lain dan berkomunikasi dengan server CnC dengan caranya sendiri yang khusus.  Dengan menginstal jaringan peer-to-peer di domain, salinan Pegasus membuka jalan ke jaringan eksternal dan berkomunikasi dengan server CnC dengan mem-proxy lalu lintas satu sama lain.  Menggunakan sertifikat untuk menandatangani file yang dapat dieksekusi dan mengakses sumber daya Microsoft dan Mozilla selama verifikasi koneksi membuat sulit untuk mendeteksi aktivitas dan deteksi pada host. <br><br>  Proyek kode sumber Pegasus terstruktur dan dijelaskan dengan cukup baik, sehingga dalam waktu dekat kita dapat mengharapkan peminjaman bagian-bagian dari kodenya oleh program jahat lainnya dan penampilan modifikasi. <br><br>  Banyak mekanisme untuk mengeksekusi perintah dari jarak jauh dan mencari data akun tetap tidak terealisasi, para pengembang juga akan menambahkan kemampuan untuk mengubah shellcode selama implementasi dengan cepat.  Dan ini bukan semua ide mereka. <br><br>  Kami telah mengembangkan beberapa tanda tangan untuk PT NAD dan IDS Suricata, yang memungkinkan kami untuk mengidentifikasi aktivitas jaringan spesifik Pegasus pada tahap yang berbeda, mulai dari detik-detik pertama aktivitasnya.  Anda dapat menemukan tanda tangan terbuka untuk Suricata IDS di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Twitter kami</a> , mereka akan secara otomatis masuk ke Suricata Anda jika Anda menggunakan mekanisme pembaruan pembaruan suricata. <br><br>  Anda dapat melihat bagaimana tanda tangan untuk aktivitas Pegasus bekerja di tangkapan layar di bawah ini.  Ini adalah produk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PT Network Attack Discovery</a> baru kami yang mengidentifikasi insiden dan membantu menyelidiki mereka: <br><br> <a href=""><img src="https://habrastorage.org/webt/cc/ok/ou/ccokou2rr1ed01valiivylk6prs.png"></a> <br><br>  Selain itu, indikator kompromi (IC) berikut dapat digunakan untuk deteksi: <br><br><pre>  MAILSLOT \ 46CA075C165CBB2786 
 pipa \ pg0F9EC0DB75F67E1DBEFB3AFA2<font></font>
<font></font>
 hxxp: //denwer/pegasus/index.php
 hxxp: //mp3.ucrazy.org/music/index.php
 hxxp: //support.zakon-auto.net/tuning/index.asp
 hxxp: //video.tnt-online.info/tnt-comedy-tv/stream.php </pre><br>  <b>Diposting oleh</b> Cyril Shipulin dari @attackdetection, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Twitter</a> |  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Telegram</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418017/">https://habr.com/ru/post/id418017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418007/index.html">Pengembangan lintas platform dengan .NET, pemrograman reaktif, pola MVVM, dan pembuatan kode</a></li>
<li><a href="../id418009/index.html">Node.js dan rendering server dalam Airbnb</a></li>
<li><a href="../id418011/index.html">Halaman Tunggal dan SEO. Rahasia Optimasi</a></li>
<li><a href="../id418013/index.html">Intel Core i7-8086K (bagian 3)</a></li>
<li><a href="../id418015/index.html">Vasyuki baru. Perkembangan inovatif Moskow hingga 2100</a></li>
<li><a href="../id418023/index.html">Pointer dalam C lebih abstrak dari yang Anda kira</a></li>
<li><a href="../id418025/index.html">Buku â€œBelajar Java EE. Pemrograman modern untuk perusahaan besar "</a></li>
<li><a href="../id418027/index.html">Layanan Mikro Blitz</a></li>
<li><a href="../id418029/index.html">ReactOS 0.4.9: pembenci harus mencari argumen baru</a></li>
<li><a href="../id418031/index.html">Penumpukan massal model ML dalam produksi: nyata atau tidak?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>