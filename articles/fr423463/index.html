<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹️ 👩‍💼 🧣 Comme nous avons écrit un autre algorithme d'analyse RFM ☦️ 👵🏿 🧔🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous avons récemment expliqué pourquoi nous avons créé notre propre segmenteur RFM, qui permet de faire une analyse RFM en 20 secondes , et a montré c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comme nous avons écrit un autre algorithme d'analyse RFM</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mindbox/blog/423463/"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img align="left" alt="KDPV" width="400" src="https://habrastorage.org/webt/jz/8z/ry/jz8zryizwksvh074dadvanrqwye.png"></a>  Nous avons récemment expliqué pourquoi nous avons créé notre propre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">segmenteur RFM, qui permet de faire une analyse RFM en 20 secondes</a> , et a montré comment utiliser ses résultats dans le marketing. </p><br><p>  Maintenant, nous disons comment il est organisé. <br><br><br clear="left"></p><a name="habracut"></a><br><h1 id="zadacha-napisat-novyy-algoritm-rfm-analiza">  Tâche: écrire un nouvel algorithme d'analyse RFM </h1><br><p>  Nous n'étions pas satisfaits des approches disponibles pour l'analyse RFM.  Par conséquent, nous avons décidé de fabriquer notre propre segmenteur, qui: </p><br><ul><li>  Cela fonctionne de manière complètement automatique. </li><li>  Construit de 3 à 15 segments. </li><li>  S'adapte à n'importe quel domaine d'activité du client (peu importe ce qu'il est: un magasin de fleurs ou d'outils électriques). </li><li>  Il détermine le nombre et l'emplacement des segments en fonction des données disponibles et non de paramètres prédéfinis qui ne peuvent pas être universels. </li><li>  Il sélectionne les segments afin qu'ils aient toujours des consommateurs (contrairement à certaines approches lorsque certains segments sont vides). </li></ul><br><h1 id="kak-reshali-zadachu">  Comment résoudre le problème </h1><br><p> Lorsque nous avons réalisé la tâche, nous avons réalisé qu'elle dépassait le pouvoir de l'homme et avons demandé l'aide de l'intelligence artificielle.  Pour apprendre à la voiture à diviser les consommateurs en segments, nous avons décidé d'utiliser des méthodes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">clustering</a> . </p><br><p>  Les méthodes de clustering sont utilisées pour rechercher une structure dans les données et sélectionner des groupes d'objets similaires en elles - exactement ce dont vous avez besoin pour l'analyse RFM. </p><br><p>  Le regroupement fait référence aux méthodes d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apprentissage automatique</a> de la classe « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apprentissage sans professeur</a> ».  Une classe est appelée comme ça parce qu'il y a des données, mais personne ne sait quoi en faire, donc elle ne peut pas enseigner à une machine. </p><br><p>  Nous n'avons pas pu trouver d'entreprises utilisant cette approche sur le marché.  Bien qu'ils aient trouvé un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> dans lequel l'auteur mène des recherches scientifiques sur ce sujet.  Mais, comme nous l'avons compris par notre propre expérience, de la science aux affaires n'est pas du tout une étape. </p><br><h2 id="etap-1-predobrabotka-dannyh">  Étape 1. Traitement des données </h2><br><p>  Les données doivent être préparées pour le clustering. </p><br><p>  Tout d'abord, nous vérifions les valeurs incorrectes: valeurs négatives, etc. </p><br><p>  Ensuite, nous éliminons les émissions - des consommateurs aux caractéristiques inhabituelles.  Il y en a peu, mais ils peuvent grandement affecter le résultat, et pas pour le mieux.  Pour les séparer, nous utilisons une méthode spéciale d'apprentissage automatique - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Local Outlier Factor</a> . </p><br><p><img src="https://habrastorage.org/webt/bw/ff/sm/bwffsmjiyzunwf00brnvxp7-jjw.png" alt="Image de séparation des émissions"></p><br><p>  Ici, dans les images, j'utilise seulement deux des trois dimensions (R et M) de trois pour faciliter la perception. </p><br><p>  Les émissions ne participent pas à la construction des segments, mais leur sont attribuées après la formation des segments. </p><br><h2 id="etap-2-klasterizaciya-potrebiteley">  Étape 2. Regroupement des consommateurs </h2><br><p>  Je vais clarifier la terminologie: par clusters, j'entends des groupes d'objets obtenus à la suite de l'utilisation d'algorithmes de clustering et des segments comme résultat final, c'est-à-dire le résultat d'une analyse RFM. </p><br><p>  Il existe plusieurs dizaines d'algorithmes de clustering.  Des exemples de certains d'entre eux peuvent être trouvés <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans la documentation du paquet scikit-learn</a> . </p><br><p>  Nous avons essayé huit algorithmes avec diverses modifications.  La plupart n'avaient pas assez de mémoire.  Ou le temps de leur travail tendait vers l'infini.  Presque tous les algorithmes qui ont réussi techniquement à faire face à la tâche ont donné des résultats terribles: par exemple, le populaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DBSCAN a</a> considéré 55% des objets comme du bruit et a divisé le reste en 4302 grappes. </p><br><p><img src="https://habrastorage.org/webt/ur/9l/3g/ur9l3gmnohsqkffhjsthn5bocwc.png" alt="Exemple d'opération DBSCAN"></p><br><p>  <em>Les objets violets sont définis comme du «bruit»</em> </p><br><p>  En conséquence, nous avons choisi l'algorithme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">K-Means</a> (K-means) car il ne recherche pas les groupes de points, mais regroupe simplement les points autour des centres.  Il s'est avéré que c'était la bonne décision. </p><br><p>  Mais d'abord, nous avons résolu quelques problèmes: </p><br><ol><li><p>  <strong>Instabilité.</strong>  Il s'agit d'un problème connu avec la plupart des algorithmes de clustering, y compris K-Means.  L'instabilité réside dans le fait qu'avec des lancements répétés, les résultats peuvent être différents, car un élément de hasard est utilisé. <br>  Par conséquent, nous nous regroupons plusieurs fois, puis nous nous regroupons à nouveau, mais déjà au centre des grappes.  En tant que centres finaux des clusters, nous prenons les centres des clusters résultants (c'est-à-dire les clusters formés par les centres des premiers clusters). </p><br></li><li><p>  <strong>Le nombre de clusters.</strong>  Les données peuvent être différentes et le nombre de clusters doit également être différent. <br>  Pour trouver le nombre optimal de clusters pour chaque base de clients, nous effectuons un clustering avec un nombre différent de clusters, puis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sélectionnons le meilleur résultat</a> . </p><br></li><li><p>  <strong>La vitesse.</strong>  L'algorithme K-means n'est pas très rapide, mais acceptable (quelques minutes pour une base moyenne de plusieurs centaines de milliers de consommateurs).  Cependant, nous l'exécutons plusieurs fois: d'une part, pour augmenter la stabilité, et d'autre part, pour sélectionner le nombre de clusters.  Et le temps de fonctionnement augmente beaucoup. <br>  Pour l'accélération, nous utilisons une modification du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mini Batch K-Means</a> .  Il recalcule les centres de cluster à chaque itération non pas pour tous les objets, mais uniquement pour un petit sous-échantillon.  La qualité baisse un peu, mais le temps est considérablement réduit. </p><br></li></ol><br><p>  Dès que nous avons résolu ces problèmes, le clustering a commencé à se dérouler avec succès. </p><br><p><img src="https://habrastorage.org/webt/sm/gd/w1/smgdw1bf8lxc71abccsn9yqfb_m.png" alt="Résultat KMeans"></p><br><h2 id="etap-3-postobrabotka-klasterov">  Étape 3. Post-traitement des clusters </h2><br><p>  Les grappes obtenues à l'aide de l'algorithme doivent être amenées sous une forme qui convient à la perception. </p><br><p>  Tout d'abord, nous transformons ces grappes de courbes en rectangles.  En fait, cela en fait des segments.  La rectangularité des segments est une exigence de notre système et, en plus, ajoute de la compréhensibilité aux segments eux-mêmes.  Pour convertir, nous utilisons un autre algorithme d'apprentissage automatique - l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arbre de décision</a> . </p><br><p><img src="https://habrastorage.org/webt/bf/uq/gi/bfuqgiaft8d6cmb-pucpzxb8_ho.png" alt="Résultat de l'arbre de décision"></p><br><p>  <em>L'arbre de décision est construit sur des données sans valeurs aberrantes, et les valeurs aberrantes sont ensuite attribuées aux segments finis</em> </p><br><p>  Deuxièmement, nous avons fait une autre chose intéressante - la description des segments.  Un algorithme spécial, utilisant un dictionnaire, décrit chaque segment en russe en direct, de sorte que les gens ne ressentent pas le désir de regarder des nombres sans âme. </p><br><p><img src="https://habrastorage.org/webt/as/-y/g3/as-yg31sxa3rjjarnmaxz8h9uuw.png" alt="Exemples de description de segment"></p><br><h1 id="testirovanie-rezultatov">  Résultats des tests </h1><br><p>  Le produit est prêt.  Mais avant de commencer à vendre, il doit être testé.  Autrement dit, vérifiez si l'analyse RFM est effectuée comme prévu. </p><br><p>  Nous savons que la meilleure façon de comprendre si nous avons fait quelque chose de valable est de découvrir l'utilité de l'analyse pour nos clients.  Et nous le ferons.  Mais c'est long, et les résultats seront plus tard, et nous voulons savoir comment nous avons réussi à faire face à la tâche, maintenant. </p><br><p>  Par conséquent, en tant que mesure plus simple et plus rapide, nous avons utilisé la méthode du «groupe témoin historique». </p><br><p>  Pour ce faire, nous avons pris plusieurs bases de données et les segmentées en utilisant l'analyse RFM à différents moments dans le passé: une base de données pour l'État il y a six mois, l'autre il y a un an, etc. </p><br><p>  Sur la base de chaque segmentation pour chaque base, nous avons construit notre prévision des actions des clients du moment sélectionné au présent.  Ils ont ensuite comparé ces prévisions avec le comportement réel des clients. </p><br><p><img src="https://habrastorage.org/webt/sf/g8/x0/sfg8x0petj3fj1hoot8ytxzhfkw.png" alt="KG historique"></p><br><p>  <em>Exemple de test sur un groupe témoin historique avec une période de contrôle de six mois</em> </p><br><p>  Dans l'image: </p><br><ul><li>  Les colonnes R, F et M indiquent classiquement les limites des segments le long de chaque axe.  Ceci est le résultat d'une segmentation de base sous la forme dans laquelle elle était il y a six mois. </li><li>  La colonne "Taille" indique la taille du segment il y a six mois par rapport à la taille totale de la base de données. </li><li>  Les colonnes «Probabilité d'achat» et «Montant» sont des données sur le comportement réel des consommateurs au cours des six prochains mois. <br><ul><li>  La probabilité d'achat est définie comme le rapport entre le nombre de consommateurs du segment ayant effectué un achat et le nombre total de consommateurs du segment. </li><li>  Montant - le montant total dépensé par les consommateurs du segment par rapport au montant dépensé par les consommateurs de tous les segments. </li></ul></li></ul><br><p>  Les résultats sont cohérents.  Par exemple, les clients des segments pour lesquels nous avions prédit une fréquence élevée d'achats achetaient en fait plus souvent. </p><br><p>  Bien que nous ne puissions garantir le bon fonctionnement de l'algorithme à 100% sur la base de ces tests, nous avons décidé qu'il était réussi. </p><br><h1 id="chto-my-ponyali">  Que comprenons-nous </h1><br><p>  L'apprentissage automatique est vraiment capable d'aider une entreprise à résoudre des problèmes insolubles ou très mal résolus. </p><br><p>  Mais le vrai défi n'est pas la compétition Kaggle.  Ici, en plus d'obtenir une meilleure qualité dans une métrique donnée, vous devez réfléchir à la façon dont l'algorithme fonctionnera, s'il sera pratique pour les personnes et, en général, s'il est nécessaire de résoudre le problème en utilisant ML ou vous pouvez trouver un moyen plus simple. </p><br><p>  Et enfin, l'absence d'une métrique formelle de qualité complique la tâche plusieurs fois, car il est difficile d'évaluer correctement le résultat. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr423463/">https://habr.com/ru/post/fr423463/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr423453/index.html">ZFS et vitesse d'accès au disque dans les hyperviseurs</a></li>
<li><a href="../fr423455/index.html">Tablette correcte</a></li>
<li><a href="../fr423457/index.html">Travail Timlid en 2018</a></li>
<li><a href="../fr423459/index.html">Différences entre Phoenix et Rails à travers les yeux d'un converti</a></li>
<li><a href="../fr423461/index.html">Automne suborbital</a></li>
<li><a href="../fr423465/index.html">Que lire sur l'ITSM: livres, blogs et derniers articles</a></li>
<li><a href="../fr423467/index.html">Les développeurs russes publieront un catalogue de compatibilité des produits</a></li>
<li><a href="../fr423469/index.html">Numéros à virgule flottante Far West les plus rapides</a></li>
<li><a href="../fr423475/index.html">Pirater le code du vieillissement: une nouvelle science sur le vieillissement et ce que signifie rester jeune</a></li>
<li><a href="../fr423477/index.html">Soyez un ninja de la sécurité: commencez votre chemin vers les hauteurs de l'IB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>