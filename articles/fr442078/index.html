<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧛🏼 ☝🏻 🏥 Travailler avec l'API Jira avec Python 👨🏼‍🔬 ➿ 👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous. On a pensé à automatiser le téléchargement des rapports de Jira. Puisque Python était un outil préféré, le choix s'est porté sur un mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Travailler avec l'API Jira avec Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442078/"> Bonjour à tous.  On a pensé à automatiser le téléchargement des rapports de Jira.  Puisque Python était un outil préféré, le choix s'est porté sur un module de JIra vous permettant de travailler avec leur API.  À qui c'est intéressant je demande sur kat. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2d/a37/f46/c2da37f469f8ecd69f7b7597d9e90cc6.jpg" alt="image"><br><a name="habracut"></a><br>  Atlassian dispose d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> officielle sur l'utilisation de son module.  Le module lui-même est appelé «jira».  Par tradition, nous installerons le module avec la commande: <br><br><pre><code class="python hljs">pip install jira</code> </pre> <br>  Ensuite, nous importons le module directement dans le code: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jira <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> JIRA</code> </pre> <br>  Pour vous connecter au serveur lui-même, vous devez créer un client en lui passant les paramètres requis: <br><br><pre> <code class="python hljs">jira_options = {<span class="hljs-string"><span class="hljs-string">'server'</span></span>: <span class="hljs-string"><span class="hljs-string">'https://project-name.atlassian.net'</span></span>} jira = JIRA(options=jira_options, basic_auth=(login, api_key))</code> </pre> <br>  Afin de vous authentifier avec un mot de passe, vous pouvez transférer le mot de passe au lieu de la clé api.  Une fois l'autorisation passée, nous avons un client api actif auquel vous pouvez accéder. <br><br>  Les possibilités ne sont certes pas illimitées, mais assez larges.  J'avais besoin de retirer des tâches pour une semaine spécifique et de compiler un rapport sur les heures passées à Excell.  Vous pouvez obtenir des tâches directement par le projet lui-même, par numéro de tâche ou par requête JQL.  Les outils de recherche sont assez flexibles et simples.  Toutes les informations retournées par le client api sont fournies sous forme de chaîne, des étapes supplémentaires sont donc nécessaires pour travailler avec. <br>  Nous composons une requête jql et prenons les tâches dessus: <br><br><pre> <code class="python hljs">jql = <span class="hljs-string"><span class="hljs-string">'project = '</span></span> + project_key + <span class="hljs-string"><span class="hljs-string">' AND worklogDate &gt;= '</span></span> + work_date issues_list = jira.search_issues(jql)</code> </pre> <br>  Malheureusement, je ne comprenais toujours pas pourquoi, dans les tâches obtenues grâce à une telle demande, il n'y a pas de propriété de journal de travail.  Après quelques tentatives pour comprendre ce qui n'allait pas, j'ai poliment demandé à jira la tâche par numéro: <br><br><pre> <code class="python hljs">issue = jira.issue(issue_key)</code> </pre> <br>  Dans la tâche renvoyée par cette méthode, le champ du journal de travail avec une liste de journaux de travail était.  En conséquence, j'ai commencé à prendre des tâches par requête jql, j'ai retiré les numéros de tâche et après cela j'ai retiré les informations dont j'avais besoin: <br><br><pre> <code class="python hljs">worklogs = issue.fields.worklog.worklogs</code> </pre> <br>  Une ligne similaire vous permet d'extraire tous les enregistrements de temps d'une tâche spécifique.  Chaque entrée a des informations de temps en secondes et en représentation textuelle (1h, 3d etc.). <br>  Alors tout est simple, prenez les rejets qui ne correspondent pas à la période, dans mon cas le numéro de semaine ne correspond pas: <br><br><pre> <code class="python hljs">worklog_date_str = re.search(<span class="hljs-string"><span class="hljs-string">r'(\d{4}-\d{2}-\d{2})'</span></span>, worklog.started) worklog_date = datetime.strptime(worklog_date_str.group(<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-string"><span class="hljs-string">'%Y-%m-%d'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> worklog_date.isocalendar()[<span class="hljs-number"><span class="hljs-number">1</span></span>] == weak_number:</code> </pre> <br>  Étant donné que la date est renvoyée dans une chaîne, j'ai utilisé une expression régulière simple pour la récupérer, et dans la ligne suivante, je donne le type dont vous avez besoin.  L'expression worklog_date.isocalendar () [1] vous permet de connaître le numéro de la semaine, qui sera comparé à ce qui doit être pris.  S'il correspond, écrasez et écrivez le reste des données. <br><br>  En général, le module ci-dessus vous permet de résoudre un éventail assez large de tâches, vous n'avez besoin que de temps et de désir. <br><br>  UPD <br><br>  Vous ne pouvez plus demander de tâches, développez simplement le champ requis <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/pycontribs/jira/blob/master/jira/client.py#L2371</a> <br>  merci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">HSerg</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442078/">https://habr.com/ru/post/fr442078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442064/index.html">Dégradation logicielle</a></li>
<li><a href="../fr442066/index.html">Plusieurs façons de simuler un PDF avec une signature numérique</a></li>
<li><a href="../fr442070/index.html">Les entreprises s'inquiètent enfin du développement des appareils IoT et de leur sécurité</a></li>
<li><a href="../fr442072/index.html">RxJava2 + Retrofit 2. Nous modifions l'adaptateur pour gérer le manque de statut Internet sur Android</a></li>
<li><a href="../fr442074/index.html">Cascade élégante de RiME dans le moteur de jeu: faites un jet d'eau</a></li>
<li><a href="../fr442080/index.html">Connexion au micromètre pour l'application Web Java</a></li>
<li><a href="../fr442082/index.html">Comment simplifier la recherche dans les bases de données Oracle: un «jeu de gentleman» de scripts</a></li>
<li><a href="../fr442084/index.html">Antiquités: appareil photo à disquette de vingt ans</a></li>
<li><a href="../fr442086/index.html">Comment Love Kubernetes est-il allé au groupe Mail.ru le 14 février</a></li>
<li><a href="../fr442088/index.html">La SEC a accusé Ilon Mask d'avoir violé l'interdiction de publication de données importantes sur Tesla dans les réseaux sociaux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>