<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí™üèº üôÖüèø ü¶Ç Tutorial do Java 9 para quem precisa trabalhar com c√≥digo legado üìã üç∞ üî¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Boa noite, colegas. Exatamente h√° um m√™s, recebemos um contrato para a tradu√ß√£o do Java moderno da Manning, que deve ser um dos nossos novos produtos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tutorial do Java 9 para quem precisa trabalhar com c√≥digo legado</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/417733/"> Boa noite, colegas.  Exatamente h√° um m√™s, recebemos um contrato para a tradu√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Java moderno</a> da Manning, que deve ser um dos nossos novos produtos mais not√°veis ‚Äã‚Äãno pr√≥ximo ano.  O problema de "Moderno" e "Legado" em Java √© t√£o agudo que a necessidade de um livro desses √© bastante madura.  A escala do desastre e como resolver problemas no Java 9 s√£o brevemente descritas em um artigo de Wayne Citrin, cuja tradu√ß√£o queremos oferecer hoje. <br><a name="habracut"></a><br>  A cada poucos anos, com o lan√ßamento de uma nova vers√£o do Java, os palestrantes do JavaOne come√ßam a apreciar novas constru√ß√µes de linguagem e APIs e elogiam suas virtudes.  E desenvolvedores zelosos, enquanto isso, est√£o ansiosos para introduzir novos recursos.  Essa imagem est√° longe da realidade - ela n√£o leva em considera√ß√£o que a maioria dos programadores est√° ocupada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dando suporte e finalizando os aplicativos existentes</a> , e n√£o grava novos aplicativos do zero. <br><br>  A maioria dos aplicativos - especialmente os comerciais - deve ser compat√≠vel com vers√µes anteriores do Java que n√£o suportam todos esses novos recursos do super-duper.  Por fim, a maioria dos clientes e usu√°rios finais, especialmente no segmento de grandes empresas, desconfia de uma atualiza√ß√£o radical da plataforma Java, preferindo esperar at√© que fique mais forte. <br><br>  Portanto, assim que o desenvolvedor tenta uma nova oportunidade, ele se depara com problemas.  Voc√™ usaria os m√©todos de interface padr√£o no seu c√≥digo?  Talvez - se voc√™ tiver sorte e seu aplicativo n√£o precisar interagir com o Java 7 ou inferior.  Deseja usar a classe <code>java.util.concurrent.ThreadLocalRandom</code> para gerar n√∫meros pseudo-aleat√≥rios em um aplicativo multithread?  N√£o funcionar√° se seu aplicativo for executado em Java 6, 7, 8 ou 9 ao mesmo tempo. <br><br>  Com o lan√ßamento do novo lan√ßamento, os desenvolvedores que suportam c√≥digo legado se sentem como crian√ßas for√ßadas a olhar para uma vitrine de pastelaria.  Eles n√£o podem entrar, ent√£o o destino deles √© decep√ß√£o e frustra√ß√£o. <br><br>  Ent√£o, h√° algo na nova vers√£o do Java 9 para programadores envolvidos no suporte a c√≥digo legado?  Algo que poderia facilitar sua vida?  Felizmente sim. <br><br>  <b>O que tinha que ser feito com o suporte do c√≥digo legado √© a apar√™ncia do Java 9</b> <br><br>  Obviamente, voc√™ pode colocar os recursos da nova plataforma em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aplicativos herdados</a> nos quais voc√™ deve cumprir a compatibilidade com vers√µes anteriores.  Em particular, sempre h√° oportunidades para tirar proveito das novas APIs.  No entanto, pode ficar um pouco feio. <br><br>  Por exemplo, voc√™ pode aplicar a liga√ß√£o tardia se desejar acessar a nova API quando seu aplicativo tamb√©m precisar trabalhar com vers√µes mais antigas do Java que n√£o suportam essa API.  Suponha que voc√™ queira usar a classe <code>java.util.stream.LongStream</code> , introduzida no Java 8, e que voc√™ queira usar o <code>anyMatch(LongPredicate)</code> dessa classe, mas o aplicativo deve ser compat√≠vel com o Java 7. Voc√™ pode criar uma classe auxiliar, desta forma: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> classLongStreamHelper { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Class longStreamClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Class longPredicateClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Method anyMatchMethod; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { longStreamClass = Class.forName(<span class="hljs-string"><span class="hljs-string">"java.util.stream.LongStream"</span></span>); longPredicateClass = Class.forName(<span class="hljs-string"><span class="hljs-string">"java.util.function.LongPredicate"</span></span>); anyMatchMethod = longStreamClass.getMethod(<span class="hljs-string"><span class="hljs-string">"anyMatch"</span></span>, longPredicateClass): } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ClassNotFoundException e) { longStreamClass = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; longPredicateClass = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; anyMatchMethod = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (NoSuchMethodException e) { longStreamClass = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; longPredicateClass = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; anyMatchMethod = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">anyMatch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object theLongStream, Object thePredicate)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> NotImplementedException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (longStreamClass == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotImplementedException(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Boolean result = (Boolean) anyMatchMethod.invoke(theLongStream, thePredicate); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.booleanValue(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Throwable e) { <span class="hljs-comment"><span class="hljs-comment">// lots of potential exceptions to handle. Let's simplify. throw new NotImplementedException(); } } }</span></span></code> </pre> <br>  Existem maneiras de simplificar essa opera√ß√£o ou torn√°-la mais geral ou mais eficaz - voc√™ entendeu a id√©ia. <br><br>  Em vez de chamar <code>theLongStream.anyMatch(thePredicate)</code> , como faria no Java 8, voc√™ pode chamar <code>LongStreamHelper.anyMatch(theLongStream, thePredicate)</code> em qualquer vers√£o do Java.  Se voc√™ estiver lidando com o Java 8, isso funcionar√°, mas se com o Java 7, o programa lan√ßar√° uma <code>NotImplementedException</code> . <br><br>  Por que isso √© feio?  Como o c√≥digo pode se tornar excessivamente complicado se voc√™ precisar acessar muitas APIs (na verdade, mesmo agora, com uma √∫nica API, isso j√° √© inconveniente).  Al√©m disso, essa pr√°tica n√£o √© segura para o tipo, pois o c√≥digo n√£o pode mencionar diretamente <code>LongStream</code> ou <code>LongPredicate</code> .  Finalmente, essa pr√°tica √© muito menos eficiente, devido √† sobrecarga da reflex√£o, al√©m <code>try-catch</code> blocos adicionais de <code>try-catch</code> .  Portanto, embora possa ser feito dessa maneira, n√£o √© muito interessante e est√° repleto de erros devido ao descuido. <br><br>  Sim, voc√™ pode acessar as novas APIs e seu c√≥digo ao mesmo tempo mant√©m a compatibilidade com vers√µes anteriores, mas voc√™ n√£o ter√° √™xito com as novas constru√ß√µes de idioma.  Por exemplo, suponha que precisamos usar express√µes lambda no c√≥digo que deve permanecer compat√≠vel com vers√µes anteriores e funcionar no Java 7. Voc√™ est√° sem sorte.  O compilador Java n√£o permitir√° que voc√™ especifique uma vers√£o do c√≥digo-fonte acima do destino.  Portanto, se voc√™ definir o n√≠vel de conformidade do c√≥digo-fonte como 1,8 (ou seja, Java 8) e o n√≠vel de conformidade de destino for 1,7 (Java 7), o compilador n√£o permitir√°. <br><br>  <b>Arquivos JAR com v√°rias vers√µes ajudar√£o voc√™</b> <br><br>  Mais recentemente, outra grande oportunidade apareceu para usar os recursos Java mais recentes, permitindo que os aplicativos funcionassem com vers√µes mais antigas do Java, onde esses aplicativos n√£o eram suportados.  No Java 9, esse recurso √© fornecido para novas APIs e novas constru√ß√µes de linguagem Java: estamos falando de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">arquivos JAR</a> com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v√°rias vers√µes</a> . <br><br>  Os arquivos JAR com v√°rias vers√µes quase n√£o diferem dos bons e antigos arquivos JAR, mas com uma ressalva importante: um novo "nicho" apareceu nos novos arquivos JAR, onde √© poss√≠vel escrever classes que usam os recursos mais recentes do Java 9. Se voc√™ trabalha com o Java 9, A JVM encontrar√° esse "nicho", usar√° as classes dele e ignorar√° as classes com o mesmo nome da parte principal do arquivo JAR. <br><br>  No entanto, ao trabalhar com Java 8 ou inferior, a JVM n√£o est√° ciente da exist√™ncia desse "nicho".  Ela o ignora e usa classes da parte principal do arquivo JAR.  Com o lan√ßamento do Java 10, um novo ‚Äúnicho‚Äù semelhante aparecer√° para as classes que usam os recursos mais relevantes do Java 10 e assim por diante. <br><br>  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JEP 238</a> , uma proposta para desenvolvimento Java, que descreve arquivos JAR vorazes, √© fornecido um exemplo simples.  Digamos que temos um arquivo JAR com quatro classes em execu√ß√£o no Java 8 ou inferior: <br><br><pre> <code class="java hljs">JAR root - A.class - B.class - C.class - D.class</code> </pre> <br>  Agora imagine que, ap√≥s o lan√ßamento do Java 9, reescrevamos as classes A e B para que eles possam usar os novos recursos espec√≠ficos do Java 9. Em seguida, o Java 10 √© lan√ßado e reescrevemos a classe A para que ele possa usar os novos recursos do Java 10. , o aplicativo ainda deve funcionar bem com o Java 8. O novo arquivo JAR com v√°rias vers√µes se parece com o seguinte: <br><br><pre> <code class="java hljs">JAR root - A.class - B.class - C.class - D.class - META-INF Versions - <span class="hljs-number"><span class="hljs-number">9</span></span> - A.class - B.class - <span class="hljs-number"><span class="hljs-number">10</span></span> - A.class</code> </pre> <br>  O arquivo JAR n√£o adquiriu apenas uma nova estrutura;  agora em seu manifesto, √© indicado que esse arquivo possui v√°rias vers√µes. <br><br>  Quando voc√™ executa esse arquivo JAR na JVM Java 8, ele ignora a se√ß√£o <code>\META-INF\Versions</code> porque nem sequer suspeita ou procura por ele.  Somente as classes originais A, B, C e D s√£o usadas. <br><br>  Ao executar no Java 9, as classes localizadas em <code>\META-INF\Versions\9</code> s√£o usadas, al√©m disso, s√£o usadas em vez das classes originais A e B, mas as classes em <code>\META-INF\Versions\10</code> ignoradas. <br><br>  Ao executar no Java 10, os dois ramos <code>\META-INF\Versions</code> ;  em particular, a vers√£o A do Java 10, vers√£o B do Java 9 e as vers√µes padr√£o C e D. <br><br>  Portanto, se voc√™ precisa de uma nova API ProcessBuilder do Java 9 em seu aplicativo, mas precisa garantir que o aplicativo continue funcionando no Java 8, basta escrever as novas vers√µes de suas classes usando ProcessBuilder na se√ß√£o <code>\META-INF\Versions\9</code> do arquivo JAR e deixe as classes antigas na parte principal do arquivo, usadas por padr√£o.  Essa √© a maneira mais f√°cil de usar os novos recursos do Java 9 sem sacrificar a compatibilidade com vers√µes anteriores. <br><br>  O Java 9 JDK possui uma vers√£o da ferramenta jar.exe que suporta a cria√ß√£o de arquivos JAR com v√°rias vers√µes.  Outras ferramentas n√£o JDK tamb√©m fornecem esse suporte. <br><br>  <b>Java 9: ‚Äã‚Äãm√≥dulos, m√≥dulos em todos os lugares</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O sistema do m√≥dulo Java 9</a> (tamb√©m conhecido como Projeto Jigsaw) √©, sem d√∫vida, a maior mudan√ßa no Java 9. Um dos objetivos de modulariza√ß√£o √© fortalecer o mecanismo de encapsulamento do Java para que o desenvolvedor possa especificar quais APIs s√£o fornecidas a outros componentes e contar, que a JVM aplicar√° o encapsulamento.  O encapsulamento √© mais poderoso com a modulariza√ß√£o do que com modificadores de acesso <code>public/protected/private</code> para classes ou membros da classe. <br><br>  O segundo objetivo da modulariza√ß√£o √© indicar quais m√≥dulos precisam de outros m√≥dulos para funcionar e, antes de iniciar o aplicativo, verifique se todos os m√≥dulos necess√°rios est√£o no lugar.  Nesse sentido, os m√≥dulos s√£o mais fortes que o mecanismo tradicional do caminho de classe, pois os caminhos do caminho de classe n√£o s√£o verificados com anteced√™ncia e os erros s√£o poss√≠veis devido √† falta de classes necess√°rias.  Portanto, um caminho de classe incorreto j√° pode ser detectado quando o aplicativo tiver tempo para trabalhar por tempo suficiente ou ap√≥s ter sido iniciado v√°rias vezes. <br>  Todo o sistema do m√≥dulo √© amplo e complexo, e uma discuss√£o detalhada est√° al√©m do escopo deste artigo (aqui est√° uma boa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">explica√ß√£o detalhada</a> ).  Aqui prestarei aten√ß√£o aos aspectos da modulariza√ß√£o que ajudam o desenvolvedor com o suporte de aplicativos herdados. <br><br>  A modulariza√ß√£o √© uma coisa boa, e o desenvolvedor deve tentar dividir o novo c√≥digo em m√≥dulos sempre que poss√≠vel, mesmo que o restante do aplicativo seja (ainda n√£o) modularizado.  Felizmente, isso √© f√°cil de fazer, gra√ßas √† especifica√ß√£o para trabalhar com m√≥dulos. <br><br>  Primeiro, o arquivo JAR se torna modularizado (e se transforma em um m√≥dulo) com a apar√™ncia do arquivo module-info.class (compilado a partir de module-info.java) na raiz do arquivo JAR.  <code>module-info.java</code> cont√©m metadados, em particular, o nome do m√≥dulo cujos pacotes s√£o exportados (ou seja, tornam-se vis√≠veis de fora), quais m√≥dulos esse m√≥dulo requer e outras informa√ß√µes. <br><br>  As informa√ß√µes no <code>module-info.class</code> s√£o vis√≠veis apenas quando a JVM a procura - ou seja, o sistema trata os arquivos JAR modularizados da mesma forma normal se funcionar com vers√µes mais antigas do Java (pressup√µe-se que o c√≥digo tenha sido compilado para funcionar com uma vers√£o mais antiga do Java Estritamente falando, √© preciso um pouco de qu√≠mica e ainda √© o Java 9 que √© especificado como a vers√£o de destino do module-info.class, mas isso √© real). <br><br>  Portanto, voc√™ deve poder executar arquivos JAR modularizados com Java 8 e abaixo, desde que em outros aspectos eles tamb√©m sejam compat√≠veis com vers√µes anteriores do Java.  Observe tamb√©m que <code>module-info.class</code> podem, com reservas, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ser colocados em √°reas com vers√£o de arquivos JAR com v√°rias vers√µes</a> . <br><br>  No Java 9, h√° um caminho de classe e um caminho do m√≥dulo.  e um caminho do m√≥dulo.  O caminho de classe funciona normalmente.  Se voc√™ colocar um arquivo JAR modularizado em um caminho de classe, ele ser√° desperdi√ßado como qualquer outro arquivo JAR.  Ou seja, se voc√™ modularizou o arquivo JAR e seu aplicativo ainda n√£o est√° pronto para trat√°-lo como um m√≥dulo, voc√™ pode coloc√°-lo no caminho de classe, ele funcionar√° como sempre.  Seu c√≥digo legado deve lidar com isso com √™xito. <br><br>  Observe tamb√©m que a cole√ß√£o de todos os arquivos JAR no caminho de classe √© considerada parte de um √∫nico m√≥dulo sem nome.  Esse m√≥dulo √© considerado o mais comum, no entanto, exporta todas as informa√ß√µes para outros m√≥dulos e pode se referir a qualquer outro m√≥dulo.  Portanto, se voc√™ ainda n√£o possui um aplicativo Java modularizado, mas existem algumas bibliotecas antigas que tamb√©m n√£o s√£o modularizadas (e provavelmente nunca o ser√£o) - voc√™ pode simplesmente colocar todas essas bibliotecas no caminho de classe e todo o sistema funcionar√° bem. <br><br>  O Java 9 possui um caminho de m√≥dulo que funciona junto com o caminho de classe.  Ao usar m√≥dulos desse caminho, a JVM pode verificar (em tempo de compila√ß√£o e em tempo de execu√ß√£o) se todos os m√≥dulos necess√°rios est√£o no lugar e reportar um erro se algum m√≥dulo estiver ausente.  Todos os arquivos JAR no caminho de classe, como membros de um m√≥dulo sem nome, s√£o acess√≠veis aos m√≥dulos listados no caminho modular - e vice-versa. <br><br>  N√£o √© dif√≠cil transferir o arquivo JAR do caminho de classe para o caminho do m√≥dulo - e aproveitar ao m√°ximo a modulariza√ß√£o.  Primeiro, voc√™ pode adicionar o arquivo <code>module-info.class</code> ao arquivo JAR e, em seguida, colocar o arquivo JAR modularizado no caminho dos m√≥dulos.  Esse m√≥dulo rec√©m-criado ainda poder√° acessar todos os arquivos JAR restantes no JAR do caminho de classe, pois eles entram no m√≥dulo sem nome e permanecem em acesso. <br><br>  Tamb√©m √© poss√≠vel que voc√™ n√£o queira modular o arquivo JAR ou que o arquivo JAR n√£o perten√ßa a voc√™, mas a outra pessoa, portanto, voc√™ n√£o pode modul√°-lo voc√™ mesmo.  Nesse caso, o arquivo JAR ainda pode ser colocado no caminho do m√≥dulo, tornando-se um m√≥dulo autom√°tico. <br><br>  Um m√≥dulo autom√°tico √© considerado um m√≥dulo, mesmo que n√£o possua um <code>module-info.class</code> .  Este m√≥dulo √© o mesmo nome que o arquivo JAR que ele cont√©m e outros m√≥dulos podem solicit√°-lo explicitamente.  Ele exporta automaticamente todas as suas APIs dispon√≠veis ao p√∫blico e l√™ (ou seja, requer) todos os outros m√≥dulos nomeados, bem como os m√≥dulos sem nome. <br><br>  Portanto, um arquivo JAR n√£o modulado de um caminho de classe pode ser transformado em um m√≥dulo sem fazer nada.  Os arquivos JAR herdados s√£o convertidos automaticamente em m√≥dulos, apenas faltam algumas informa√ß√µes que determinariam se todos os m√≥dulos necess√°rios est√£o no lugar ou determinar o que est√° faltando. <br><br>  Nem todo arquivo JAR n√£o modulado pode ser movido para o caminho do m√≥dulo e transformado em um m√≥dulo autom√°tico.  Existe uma regra: um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pacote pode fazer parte de apenas um m√≥dulo nomeado</a> .  Ou seja, se um pacote estiver localizado em mais de um arquivo JAR, apenas um arquivo JAR com este pacote na composi√ß√£o poder√° ser transformado em um m√≥dulo autom√°tico.  O restante pode permanecer no caminho de classe e ingressar no m√≥dulo sem nome. <br><br>  √Ä primeira vista, o mecanismo descrito aqui parece complicado, mas na pr√°tica √© muito simples.  De fato, nesse caso, √© poss√≠vel deixar os arquivos JAR antigos no caminho de classe ou mov√™-los para o caminho do m√≥dulo.  Voc√™ pode dividi-los em m√≥dulos ou n√£o.  E quando seus arquivos JAR antigos s√£o modularizados, voc√™ pode deix√°-los no caminho de classe ou mov√™-los para o caminho do m√≥dulo. <br><br>  Na maioria dos casos, tudo deve simplesmente funcionar, como antes.  Seus arquivos JAR herdados devem se enraizar no novo sistema modular.  Quanto mais voc√™ modula o c√≥digo, mais informa√ß√µes de depend√™ncia voc√™ precisa verificar, e os m√≥dulos e APIs ausentes ser√£o detectados em est√°gios muito iniciais do desenvolvimento e provavelmente economizar√£o muito trabalho. <br><br>  <b>Java 9 ‚Äúfa√ßa voc√™ mesmo‚Äù: JDK modular e Jlink</b> <br><br>  Um dos problemas com aplicativos Java herdados √© que o usu√°rio final pode n√£o funcionar com um ambiente Java adequado.  Uma maneira de garantir a integridade de um aplicativo Java √© fornecer um tempo de execu√ß√£o com o aplicativo.  Java permite criar JREs privados (redistribu√≠veis) que podem ser distribu√≠dos no aplicativo.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> est√° como criar um JRE particular.  Como regra geral, √© tomada a hierarquia de arquivos JRE, que √© instalada com o JDK, os arquivos necess√°rios s√£o salvos e os arquivos opcionais com a funcionalidade que pode ser necess√°ria em seu aplicativo s√£o salvos. <br><br>  O processo √© um pouco problem√°tico: voc√™ deve manter uma hierarquia de arquivos de instala√ß√£o, tendo cuidado, para n√£o perder um √∫nico arquivo, nem um √∫nico diret√≥rio.  Isso por si s√≥ n√£o vai doer, no entanto, voc√™ ainda deseja se livrar de tudo o que √© sup√©rfluo, pois esses arquivos ocupam espa√ßo.  Sim, √© f√°cil ceder e cometer esse erro. <br><br>  Ent√£o, por que n√£o delegar esse trabalho ao JDK? <br><br>  No Java 9, voc√™ pode criar um ambiente independente que √© adicionado ao aplicativo - e nesse ambiente, haver√° todo o necess√°rio para o aplicativo funcionar.  Voc√™ n√£o precisa mais se preocupar com o fato de o computador do usu√°rio ter o ambiente errado para a execu√ß√£o do Java, n√£o com o fato de voc√™ mesmo ter constru√≠do incorretamente um JRE particular. <br><br>  Um recurso essencial para a cria√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">imagens execut√°veis ‚Äã‚Äãindependentes</a> √© um sistema modular.  Agora voc√™ pode modularizar n√£o apenas seu pr√≥prio c√≥digo, mas tamb√©m o pr√≥prio Java 9 JDK.  Agora a biblioteca de classes Java √© uma cole√ß√£o de m√≥dulos, e as ferramentas JDK tamb√©m consistem em m√≥dulos.  O sistema de m√≥dulos requer que voc√™ especifique os m√≥dulos da classe base que s√£o necess√°rios no seu c√≥digo e especifique os elementos JDK necess√°rios. <br><br>  Para reunir tudo isso, o Java 9 fornece uma nova ferramenta especial chamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">jlink</a> .  Ao iniciar o jlink, voc√™ obt√©m uma hierarquia de arquivos - exatamente os necess√°rios para executar seu aplicativo, nem mais nem menos.  Esse conjunto ser√° muito menor que o JRE padr√£o; al√©m disso, ser√° espec√≠fico da plataforma (ou seja, ser√° selecionado para um sistema operacional e uma m√°quina espec√≠ficos).  Portanto, se voc√™ deseja criar essas imagens execut√°veis ‚Äã‚Äãpara outras plataformas, ser√° necess√°rio executar o jlink no contexto da instala√ß√£o em cada plataforma espec√≠fica para a qual voc√™ precisa dessa imagem. <br><br>  Observe tamb√©m: se voc√™ executar o jlink com um aplicativo no qual nada √© modularizado, a ferramenta simplesmente n√£o ter√° as informa√ß√µes necess√°rias para compactar o JRE, portanto, o jlink n√£o ter√° mais nada a n√£o ser empacotar todo o JRE.  Mesmo nesse caso, ser√° um pouco mais conveniente para voc√™: o jlink compilar√° o JRE para voc√™, para que voc√™ n√£o se preocupe em como copiar corretamente a hierarquia de arquivos. <br><br>  Com o jlink, fica f√°cil compactar o aplicativo e tudo o que voc√™ precisa para execut√°-lo - e voc√™ n√£o precisa se preocupar em fazer algo errado.  A ferramenta empacotar√° apenas a parte do tempo de execu√ß√£o necess√°ria para o aplicativo funcionar.  Ou seja, √© garantido que um aplicativo Java herdado receba um ambiente no qual estar√° operacional. <br><br>  <b>A reuni√£o do velho e do novo</b> <br><br>   ,     Java-   ,      ,     .  Java 9,     ,      API   ,   (  )  ,      ,         Java. <br><br>     Java 9: -,      ,        ,      Java. <br><br>  JAR-      Java 9       JAR-,     Java   .  ,      Java 9,     Java 8        ‚Äì     . <br><br>   Java,    ,     JAR-   ,     .   ,             ,  ¬´  ¬ª   . <br><br>   JDK  jlink,             ,       .       ,    Java    ‚Äì    . <br><br>      Java,  Java 9       ,             ‚Äì       ,   ,          Java. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt417733/">https://habr.com/ru/post/pt417733/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt417721/index.html">GPUs na solu√ß√£o de problemas modernos de TI</a></li>
<li><a href="../pt417723/index.html">Trabalhar com a API KOMPAS-3D ‚Üí Li√ß√£o 11 ‚Üí R√≥tulos de texto simples</a></li>
<li><a href="../pt417725/index.html">Como a Flant contrata funcion√°rios</a></li>
<li><a href="../pt417729/index.html">O Intel Core i7-8086K (parte 2)</a></li>
<li><a href="../pt417731/index.html">A hist√≥ria de um T61</a></li>
<li><a href="../pt417735/index.html">Infraestrutura de chave p√∫blica: tokens GnuPG / SMIME e PKCS # 11 com suporte para criptografia russa</a></li>
<li><a href="../pt417737/index.html">Aqui est√°, nosso ver√£o</a></li>
<li><a href="../pt417739/index.html">Aprendizado de m√°quina contra risco de cr√©dito ou "Vamos l√°, Gini, vamos l√°"</a></li>
<li><a href="../pt417741/index.html">27 de julho de 2018 - eclipse lunar total e o grande confronto de Marte</a></li>
<li><a href="../pt417743/index.html">Amplificadores lend√°rios - Anatomia da tend√™ncia hist√≥rica: Cold Transistor Sound</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>