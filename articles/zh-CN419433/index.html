<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤦 💅🏾 👩‍👩‍👧‍👧 DSW报表-DeepSeeWeb报表生成器 🤬 😯 🕜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DSW报表-DeepSeeWeb报表生成器 


 通常在分析应用程序中，用户需要定期生成并发送包含仪表板元素的PDF报告。 在基于InterSystems技术的开发中，此任务由DSW Reports项目解决，该项目是DeepSeeWeb的扩展。 本文将介绍如何使用DSW报告生成PDF报告并通过电子...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DSW报表-DeepSeeWeb报表生成器</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intersystems/blog/419433/"><h1 id="dsw-reports--generator-otchetov-deepseeweb">  DSW报表-DeepSeeWeb报表生成器 </h1><br><p> 通常在分析应用程序中，用户需要定期生成并发送包含仪表板元素的PDF报告。 在基于InterSystems技术的开发中，此任务由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DSW Reports</a>项目解决，该项目是DeepSeeWeb的扩展。 本文将介绍如何使用DSW报告生成PDF报告并通过电子邮件发送。 </p><a name="habracut"></a><br><h2 id="chto-takoe-dsw-reports"> 什么是DSW报告？ </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">InterSystems IRIS数据平台</a>的组成部分是用于开发<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">InterSystems IRIS商业智能</a> （以前称为DeepSee）的分析应用程序的技术。 有一个单独的项目<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DeepSeeWeb</a> ，它使用更现代的基于Web的界面（AngularJS）可视化InterSystems IRIS BI仪表板。 为了与服务器端进行通信，DeepSeeWeb使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MDX2JSON</a>这个项目，该项目提供对InterSystems IRIS BI的REST API访问。 </p><br><p> 关于DeepSeeWeb和MDX2JSON，我们已经在第一篇和第二篇中写过。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DSW Reports</a>是用AngularJS编写的DSW扩展，它实现了自动报告的基本功能。  DSW报表使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DeepSeeWeb</a>呈现小部件，并使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MDX2JSON</a>处理MDX请求。 </p><br><h3 id="vozmozhnosti"> 能力： </h3><br><ul><li> 使用过滤器集渲染选定的小部件。 </li><li> 任意MDX查询的计算输出。 </li><li> 自动打印PDF报告并将其邮寄 </li><li> 使用CSS样式自定义报告外观 </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/4aa/e41/53a/4aae4153a36a9e87b3966c8ef587ed61.png" alt="HTML报告"></p><br><h2 id="sozdanie-otchyota"> 报告制作 </h2><br><p> 要在DSW报告中生成报告，只需创建至少2个文件： </p><br><ul><li>  <strong>index.html-</strong>报表的线框和主页通常不会更改。 </li><li>  <strong>config.js-</strong>报告配置，针对不同报告的更改，负责填写报告。 </li></ul><br><p> 报表配置文件必须包含<strong>getConfiguration</strong>函数。 </p><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    function getConfiguration(params){...}</span></span></code> </pre> <br><p>  <strong>getConfiguration</strong>函数接受一个<em>params</em>对象，该对象包含URL字符串中的参数和一个附加参数“ <strong><em>server</em></strong> ”（服务器地址）。  “ <strong><em>server</em></strong> ”参数的形式为： <code>protocol://host:port</code> 。 </p><br><p> 由于使用了<em>params</em>对象，因此任何数据都可以通过URL字符串传输到报表。 例如，如果您想根据需要更改窗口小部件过滤器，那么我们将<strong><em>filter</em></strong>参数与URL参数一起传递，并且可以通过<em>params</em>对象使用它。 </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//&lt;protocol://host:port&gt;/dsw/reports/report_dir/index.html?filter=NOW function getConfiguration(params){ var filter = params["filter"]; // filter = "NOW" }</span></span></code> </pre> <br><p>  <strong>getConfiguration</strong>函数返回一个包含3个属性的对象： </p><br><ul><li>  <em>REPORT_NAME-</em>报告名称 </li><li>  <em>块</em> -报告块数组 </li><li>  <em>NAMESPACE-</em>报告的数据区域 </li></ul><br><p> 让我们仔细<em>看一下BLOCKS</em>块数组。 块-具有窗口小部件设置，计算出的字段设置等的对象。 </p><br><h3 id="vid-bloka"> 块类型： </h3><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, <span class="hljs-comment"><span class="hljs-comment">//  "note": String, //  .   HTML  "widget": { // iframe : "url": String, //URL   iframe "height": Number, // iframe "width": Number // iframe }, "totals":[{ //     MDX "mdx": String //MDX- "strings": [{ //    "title": String, // .   HTML. "value": String, //    "value_append": String, //  . //    %, $  .. //%     (x * 100). //  HTML. "row": Number //  MDX-, //   . //  0. },{...}] },{...}]}</span></span></code> </pre> <br><p> 如果不需要使用空字符串更好地设置该字段，则需要所有字段。 </p><br><div class="spoiler">  <b class="spoiler_title">块例</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"Persons"</span></span>, <span class="hljs-attr"><span class="hljs-attr">note</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">widget</span></span>: { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: server + <span class="hljs-string"><span class="hljs-string">"/dsw/index.html#!/d/KHAB/Khabarovsk%20Map.dashboard"</span></span> + <span class="hljs-string"><span class="hljs-string">"?widget=1&amp;height=420&amp;ns="</span></span> + namespace, <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">700</span></span>, <span class="hljs-attr"><span class="hljs-attr">height</span></span>: <span class="hljs-number"><span class="hljs-number">420</span></span> } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">另一个例子</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"Khabarovsky krai"</span></span>, <span class="hljs-attr"><span class="hljs-attr">note</span></span>: <span class="hljs-string"><span class="hljs-string">"Something note (only static)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">widget</span></span>: { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: server + <span class="hljs-string"><span class="hljs-string">"/dsw/index.html#!/d/KHAB/Khabarovsk%20Map.dashboard"</span></span> + <span class="hljs-string"><span class="hljs-string">"?widget=0&amp;height=420&amp;isLegend=true&amp;ns="</span></span> + namespace, <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">495</span></span>, <span class="hljs-attr"><span class="hljs-attr">height</span></span>: <span class="hljs-number"><span class="hljs-number">420</span></span> }, <span class="hljs-attr"><span class="hljs-attr">totals</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">mdx</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT NON EMPTY "</span></span> + <span class="hljs-string"><span class="hljs-string">"[Region].[H1].[Region].CurrentMember.Properties(\"Population\") ON 0,"</span></span>+ <span class="hljs-string"><span class="hljs-string">"NON EMPTY {[Region].[H1].[Region].&amp;[],"</span></span> + <span class="hljs-string"><span class="hljs-string">"[Region].[H1].[Region].&amp;[--],"</span></span>+ <span class="hljs-string"><span class="hljs-string">"[Region].[H1].[Region].&amp;[ ]} ON 1 FROM [KHABCUBE]"</span></span>, <span class="hljs-attr"><span class="hljs-attr">strings</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"Khabarovsk: "</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">"None"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value_append</span></span>: <span class="hljs-string"><span class="hljs-string">" ."</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"Komsomolsk-on-Amur: &lt;br /&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">"None"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value_append</span></span>: <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-attr"><span class="hljs-attr">row</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"Komsomolsky district: &lt;br /&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">"None"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value_append</span></span>: <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-attr"><span class="hljs-attr">row</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }] }] }</code> </pre> </div></div><br><h3 id="chem-zapolnyat-blok"> 如何填写区块？ </h3><br><p> 填写该块的主要字段是小部件设置的<strong>url</strong>和<strong>mdx</strong>的计算值设置。 </p><br><ul><li> 也可以手动编译<strong>MDX</strong> ，但建议使用InterSystems IRIS BI / DeepSee中内置的Visual <a href="">Analyzer</a>构造函数来进行编译。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/74e/94c/838/74e94c8380169f233cd5af9d9e534ea4.png" alt="分析仪"></li><li> 可以使用DeepSeeWeb获取<strong>URL</strong> 。 报表中嵌入的小部件是从DeepSeeWeb小部件获取的iframe。 要获取到源的链接，请在小部件上下文菜单中选择<em>“共享”</em>项。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c30/d81/8a0/c30d818a0246e2d1887df88af6a00f38.png" alt="分享到"></li></ul><br><h3 id="kastomizaciya-vneshnego-vida-otchyota"> 自定义报告的外观 </h3><br><p> 除报告库外，还提供了<strong>style.css</strong>文件， <strong>可</strong>用于编辑报告的外观。 它包含一组标准类，用于控制报告的所有元素。 您还可以添加自己的样式类，并在<strong>index.html</strong>文件中使用它们。 </p><br><h2 id="rassylka-po-e-mail"> 电子邮件通讯 </h2><br><p> 假设报告已准备就绪，并放置在DeepSeeWeb中的报告文件夹中。 即 现在可以在此处获得交互式HTML报告。 将其转换为PDF并通过邮件发送需要做些什么？  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pthantomjs</a>和内置的SMTP客户端将自动执行此操作。 您可以在此处查看如何安装和配置phantomjs（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">windows</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ubuntu</a> ）。 接下来，您需要配置SMTP客户端并在“ <a href="">任务管理器”中</a>创建一个任务。 </p><br><h3 id="nastroyka-smtp">  SMTP设定 </h3><br><p> 所有设置都在终端中进行。 </p><br><ol><li> 首先，您需要设置用于邮寄的邮件 <br><br><pre> <code class="hljs pgsql">//    SMTP <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ##<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(DSW.Report.EmailSender).setConfig(<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>, port, username, <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>, sender, SSLConfig)</code> </pre> <br><ul><li>  <strong>服务器</strong> -SMTP服务器的地址。 </li><li>  port-传出邮件的端口。 </li><li>  <strong>用户名</strong>和<strong>密码</strong> -身份验证数据。 </li><li>  <strong>发件人</strong> -新闻稿的电子邮件地址。 </li><li>  <strong>SSLConfig-</strong> <em>可选</em> 。  <a href="">SSL配置</a>的名称。 </li></ul></li><li> 然后，您应该配置要分发的用户列表。 <br><br><pre> <code class="hljs pgsql">//     <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ##<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(DSW.Report.EmailSender).addRecipient(email) //     <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ##<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(DSW.Report.EmailSender).deleteRecipient(email)</code> </pre> </li><li> 完成上述步骤后，您可以启动新闻通讯。 <br><br><pre> <code class="hljs pgsql">//    <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ##<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(DSW.Report.Task).Run(url, reportname)</code> </pre> <br><ul><li>  <strong>url-</strong>链接到报告。 </li><li>  <strong>reportname-</strong>报告的名称。 生成PDF时使用。 </li></ul></li></ol><br><h3 id="avtomaticheskiy-zapusk-rassylki"> 自动开始邮件列表 </h3><br><p> 要自动化分发，我们使用<a href="">任务管理器</a> 。 使用以下参数创建一个新任务： </p><br><ol><li> 在第一页上，配置了启动区域，我们规定了启动新闻简报的功能。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65a/196/9e3/65a1969e3a355fc61fc22c87ec57ff4c.png" alt="任务1"></li><li> 在第二页上，配置任务启动的时间和周期性。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/554/95d/777/55495d777e30af74cac20b8f2ca1b2f4.png" alt="任务2"></li><li> 最后一步-单击<em>“完成”</em> 。 </li></ol><br><p> 经过所有这些操作之后，所有内容都得到了一个由DeepSeeWeb小部件组成的自动生成的报告，该报告在给定时间以PDF的形式通过邮件发送。 </p><br><p>  →可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>找到完成报告的示例<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> <br>  →请在<a href="">此处</a>查看此报告的配置文件<a href="">。</a> <br>  →并且您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>注册每周报告交付 <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">链接</a>到存储库 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN419433/">https://habr.com/ru/post/zh-CN419433/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN419417/index.html">GDPR：数据映射或客户如何找到长期被遗忘的笔记本电脑</a></li>
<li><a href="../zh-CN419419/index.html">UI自动测试：这样做是不值得的</a></li>
<li><a href="../zh-CN419423/index.html">我们承诺向我们提供实时视频，不带fr和抽搐</a></li>
<li><a href="../zh-CN419425/index.html">安全周29.黑客Reddit，一种用于加密货币和MikroTik路由器的钱包</a></li>
<li><a href="../zh-CN419427/index.html">爱普生邀请大家参加2018年极客野餐</a></li>
<li><a href="../zh-CN419435/index.html">NIST蓝牙安全</a></li>
<li><a href="../zh-CN419437/index.html">AR-增强现实（文章和视频）</a></li>
<li><a href="../zh-CN419439/index.html">电子商务如何在大规模促销中生存。 为网络上的峰值负载做好准备[第2部分]</a></li>
<li><a href="../zh-CN419441/index.html">SpaceX今天首次重新使用Falcon 9 Block 5火箭</a></li>
<li><a href="../zh-CN419443/index.html">美国宇航局将再次飞往月球，使飞机的所有元素</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>