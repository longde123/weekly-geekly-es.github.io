<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úäüèº üêì ü§úüèº Statistiques des commentaires en ligne Confluence ü•ä üôãüèø üéûÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comment collecter des statistiques de commentaire de page dans Confluence? 

 Oui, et pourquoi cela pourrait-il √™tre n√©cessaire? 



 Pourquoi et pour...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Statistiques des commentaires en ligne Confluence</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485652/">  Comment collecter des statistiques de commentaire de page dans Confluence? <br><br>  Oui, et pourquoi cela pourrait-il √™tre n√©cessaire? <br><br><img src="https://habrastorage.org/webt/c6/7x/uo/c67xuo6sop9dd7mpzxty_i7wj7s.png"><br><a name="habracut"></a><br><h2>  Pourquoi et pourquoi </h2><br>  Dans le projet dans lequel je suis arriv√© √† travailler, le processus suivant de pr√©paration et d'approbation des exigences est n√©: <br><br><ul><li>  Confluence a √©t√© utilis√© pour la documentation. </li><li>  L'√©quipe des fournisseurs a pr√©par√© des descriptions des processus commerciaux et de leurs √©tapes sous forme de pages s√©par√©es selon le mod√®le. </li><li>  Une fois par semaine, un lot de descriptions pr√©par√©es a √©t√© remis au client pour relecture. </li><li>  L'√©quipe client a laiss√© toutes les questions et ajouts sur la page correspondante sous la forme de commentaires int√©gr√©s. </li><li>  Et l'√©quipe du fournisseur a compl√©t√© le contenu, r√©pondu aux commentaires, fix√© des questions pour une √©tude suppl√©mentaire. </li><li>  Si la question est r√©pondue et que le contenu est mis √† jour ou que la t√¢che √† √©tudier est fix√©e, l'√©quipe client doit fermer le commentaire. </li><li>  Les questions sur un lot de documents de la semaine en cours doivent √™tre ferm√©es au moment du transfert du prochain lot la semaine prochaine. </li></ul><br>  Chaque semaine, les chefs de projet ont pour t√¢che de comprendre dans quelle mesure le lot de documents livr√© a fonctionn√© et ce qui peut √™tre consid√©r√© comme conditionnellement pr√™t √† partir de celui-ci.  Et les participants de l'√©quipe des fournisseurs doivent p√©riodiquement v√©rifier l'√©tat des commentaires sur leurs documents et travailler de mani√®re cibl√©e avec les autres.  Mais comment les trouver?  Vous pouvez ouvrir chaque page, rechercher le premier commentaire dessus avec vos yeux (ou √† l'aide d'une <a href="https://community.atlassian.com/t5/Confluence-questions/Search-for-unresolved-inline-comments/qaq-p/971424">petite astuce</a> ), puis cliquer sur tous les commentaires, car  l'√©quipe du client n'est pas press√©e de les fermer, de penser √† chacun et de chercher une r√©ponse. <br><br>  Le lot hebdomadaire contient de 50 √† 100 pages distinctes, et le faire avec vos mains repr√©sente un travail consid√©rable.  Et si vous essayez toujours de recueillir des arguments pour convaincre l'autre c√¥t√©, cela devient tr√®s triste.  Et il y a aussi des commentaires qui r√©sultent d'une modification incorrecte de la page lorsque le texte source est accidentellement supprim√©.  Un tel commentaire est visible dans les commentaires r√©solus, mais il ne peut pas √™tre rouvert (vous pouvez, si vous recr√©ez un marqueur invisible dans le texte de la page). <br><br>  La recherche d'outils a √©chou√©.  De plus, Confluence est d√©ploy√© c√¥t√© client, vous ne pouvez pas installer de plugins, sans parler d‚Äôacheter.  Aucune expertise en d√©veloppement macro. <br><br>  √Ä un moment donn√©, je me suis souvenu de l' <a href="https://docs.atlassian.com/ConfluenceServer/rest/7.1.0/">API REST</a> Confluence et de mon exp√©rience ant√©rieure avec l'utilisation de l' <a href="https://docs.atlassian.com/software/jira/docs/api/REST/7.6.1/">API Jira</a> similaire.  La recherche et les exp√©riences avec les fonctions d'appel √† partir du navigateur ont montr√© que vous pouvez acc√©der aux commentaires et √† leurs propri√©t√©s.  Ensuite, vous avez d√ª choisir un outil d'automatisation et vous pouvez commencer √† r√©soudre.  J'ai une certaine exp√©rience dans la cr√©ation de scripts sur des outils plus susceptibles d'√™tre plus proches d'administrateurs comme Bash, Perl, JScript.  Je ne suis pas d√©veloppeur, je n'avais aucun outil familier ou familier.  Je voulais essayer quelque chose de plus commun ou convenable.  Ensuite, j'ai d√©couvert un <a href="https://atlassian-python-api.readthedocs.io/en/latest/">wrapper pour l'API Python</a> et j'ai d√©cid√© d'essayer avec. <br><br><h2>  Principe g√©n√©ral </h2><br>  Le probl√®me a √©t√© formul√© comme suit.  Vous devez trouver toutes les pages li√©es √† une livraison hebdomadaire sp√©cifique.  Recueillez les commentaires sur eux dans une liste: page, lien vers le commentaire, auteur et date du commentaire, texte source sur la page, commentaire et r√©ponses, auteur et date de la derni√®re r√©ponse, statut du commentaire.  En outre, collectez des statistiques pour chaque page, le nombre de commentaires au total, le nombre de dangers, le nombre de messages ouverts.  Enregistrez tout sur une page de statistiques sp√©ciale. <br><br>  Je mets Python, regarde √† travers les bases de travailler avec, et allons-y.  Cr√©ez d'abord une connexion: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> atlassian <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Confluence UserLogin = <span class="hljs-string"><span class="hljs-string">'xxxxxx'</span></span> <span class="hljs-comment"><span class="hljs-comment"># input("Login: ") UserPwd = 'xxxxxx' # input("Password: ") confluenceURL = 'http://wiki.xxxxxx' confluence = Confluence( url=confluenceURL, username=UserLogin, password=UserPwd)</span></span></code> </pre> <br>  Pour rechercher des pages d'un lot hebdomadaire, j'ai d√©cid√© d'utiliser des balises.  Comment les livrer en masse est une t√¢che distincte. <br><br><pre> <code class="python hljs">page_label = <span class="hljs-string"><span class="hljs-string">'week123'</span></span> cql = <span class="hljs-string"><span class="hljs-string">'space.key={} and label = "{}" and type = page '</span></span> <span class="hljs-string"><span class="hljs-string">'ORDER BY title '</span></span>.format(<span class="hljs-string"><span class="hljs-string">'YYY'</span></span>, page_label) pages = confluence.cql(cql, expand=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, start=<span class="hljs-number"><span class="hljs-number">0</span></span>, limit=<span class="hljs-number"><span class="hljs-number">200</span></span>)</code> </pre><br>  Nous avons donc obtenu une liste de pages √† v√©rifier.  Ensuite, nous commen√ßons √† traiter chaque page individuelle.  Nous collectons √† partir de ses donn√©es sur les commentaires avec leurs param√®tres.  Sur la base de ces donn√©es, nous construisons des statistiques sur le nombre de commentaires sur la page et dans quelles conditions.  Ensuite, nous supprimons le r√©sultat pour toutes les pages et commen√ßons √† formater le r√©sultat.  Nous cr√©ons le corps de la page avec le r√©sultat sous la forme d'un tableau de statistiques et d'une liste d√©taill√©e des commentaires ouverts. <br><br><div class="spoiler">  <b class="spoiler_title">Traitement de la liste des pages</b> <div class="spoiler_text"><pre> <code class="python hljs">statistics = [] open_comments = [] <span class="hljs-comment"><span class="hljs-comment">#  - ? if pages is not None: #    ? if pages['size'] &gt; 0: for page in pages['results']: print(page['title']) #       , #  page_comments = page_comments_data(page['content']['id']) #     statistics.append(page_statistics(page_comments)) #        #    . for comment in page_comments: if comment['Result'] not in ['resolved', 'nocomment']: if not (comment['Result'] == 'dangling' and comment['Author'] in excludeNames): open_comments.append(comment) #       . statistics.append(total_statistics(statistics)) #     page_id = confluence.get_page_id(space='YYY', title=page_title) #     ,    . page_body = ('&lt;p&gt;&lt;ac:structured-macro ac:name="toc" ac:schema-version="1"' '/&gt;&lt;/p&gt;' '&lt;h1&gt;Comments Statistics&lt;/h1&gt;{}' '&lt;h1&gt;Open Comments List&lt;/h1&gt;{}' ).format(create_table(statistics), create_table(open_comments)) #  if page_id is not None: status = confluence.update_page( page_id=page_id, title=page_title, body=page_body, representation='storage' )</span></span></code> </pre></div></div><br><h2>  Fonctionnalit√©s de l'API </h2><br>  Voyons maintenant comment traiter la page.  Par d√©faut, l'API renvoie uniquement des informations de base, telles qu'un identifiant ou un nom de page.  Toutes les propri√©t√©s suppl√©mentaires doivent √™tre sp√©cifi√©es explicitement.  Ils peuvent √™tre vus en analysant le r√©sultat de l'appel.  Des donn√©es suppl√©mentaires peuvent √™tre trouv√©es dans les sections ou sous-sections de _expandable.  Nous ajoutons l'√©l√©ment souhait√© pour d√©velopper et regarder plus loin jusqu'√† ce que nous trouvions les donn√©es n√©cessaires. <br><br><div class="spoiler">  <b class="spoiler_title">Exemple de probl√®me</b> <div class="spoiler_text"><pre> <code class="json hljs">http://wiki.xxxxxx/rest/api/content/<span class="hljs-number"><span class="hljs-number">101743895</span></span>?expand=body,children.comment { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"97517865"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"page"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"current"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"w2019-47 comments status"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"children"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"comment"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"results"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"start"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"limit"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_links"</span></span>: {} }, <span class="hljs-attr"><span class="hljs-attr">"_links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"_expandable"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"attachment"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/child/attachment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"page"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/child/page"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"body"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"_expandable"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"editor"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"export_view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"styled_view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"storage"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"anonymous_export_view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"extensions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"position"</span></span>: <span class="hljs-string"><span class="hljs-string">"none"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"_links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"_expandable"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"metadata"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operations"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"restrictions"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/restriction/byOperation"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"history"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/history"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ancestors"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"descendants"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/descendant"</span></span>, } }</code> </pre></div></div><br>  Et il y a aussi une restriction sur le nombre de r√©sultats publi√©s, la pagination.  Il est configur√© c√¥t√© serveur (API?) Et dans notre cas, il est de 25. Pour certaines demandes, il peut √™tre modifi√© en sp√©cifiant explicitement, mais cela ne fonctionnera que pour le niveau sup√©rieur.  Et r√©v√©lant des commentaires sur la page, nous n'en obtenons tout de m√™me que 25, tandis que la taille est √©galement fausse.  Dans l'exemple, il y en avait 29 en r√©alit√©.  Nous avons r√©ussi √† contourner la pagination des commentaires en utilisant une fonction distincte dans le module Confluence - get_page_comments avec la possibilit√© de sp√©cifier la taille de la page. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    import re #      XML def replace_chars2(in_text): text = re.sub(r'&amp;', '&amp;', in_text) text = re.sub(r'\'', ''', text) text = re.sub(r'&lt;', '&lt;', text) text = re.sub(r'&gt;', '&gt;', text) text = re.sub(r'"', '"', text) return text</span></span></code> </pre><br>  Le prochain √©cueil attendait les caract√©ristiques de la pr√©servation et de la d√©livrance des caract√®res sp√©ciaux.  Le corps d'une page ou d'un commentaire peut √™tre obtenu dans plusieurs vues: XML interne - stockage, HTML interm√©diaire sans sortie macro - vue et HTML avec sortie macro - export_view.  Mais le titre du titre de la page et le texte original comment√© originalSelection sont toujours publi√©s sous une forme adapt√©e √† la lecture.  Parce que  √† l'avenir, ces donn√©es tombent dans le corps de la page avec des statistiques, puis certains caract√®res ont conduit √† des erreurs de conversion.  J'ai d√ª √©crire une proc√©dure de remplacement ci-dessus. <br><br><h2>  Commentaires sur la page </h2><br>  Passons maintenant √† l'analyse de la page.  Il s'agit d'une proc√©dure qui charge une page, collecte ses donn√©es, puis extrait une liste de commentaires avec des r√©ponses et les recueille dans la correspondance.  Le r√©sultat est une liste de dictionnaires, o√π chaque √©l√©ment de la liste correspond √† un commentaire avec des r√©ponses.  Et tous les attributs de ce commentaire se trouvent dans les champs correspondants du dictionnaire. <br><br><div class="spoiler">  <b class="spoiler_title">Traitement d'une seule page</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">page_comments_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(page_identifier)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#,      ,  , #   , #  ,    ,    #   (). expand_text = ('body.storage,extensions.inlineProperties' ',extensions.resolution,version,children.comment' ',children.comment.version,children.comment.body.storage' ) #    .     . conf_page = confluence.get_page_by_id(page_identifier, expand='body.storage') page_title = replace_chars2(conf_page['title']) #   . link_base = conf_page['_links']['base'] page_link = link_base + conf_page['_links']['webui'] page_code = '&lt;a href="{}"&gt;{}&lt;/a&gt;'.format(page_link, page_title) #   page_comments = confluence.get_page_comments(content_id=page_identifier, start=0, limit=1000, comments = [] #    for comment in page_comments['results']: #      - . if comment['extensions']['location'] == 'footer': continue #  comment_text = comment['body']['storage']['value'] comment_result = comment['extensions']['resolution']['status'] comment_link = '&lt;a href="{}"&gt;{}&lt;/a&gt;'\ .format(link_base + comment['_links']['webui'], 'link') #  comment_link = re.sub(r'&amp;focusedCommentId=', '&amp;focusedCommentId=', comment_link) #  created_when = re.sub(r'\.000\+', ' GMT+', re.sub(r'T', ' ', comment['version']['when'])) created_by = comment['version']['by']['displayName'] orig_text = replace_chars2(comment['extensions'] ['inlineProperties']['originalSelection']) #    /. thread = '&lt;b&gt;To text: &lt;/b&gt;{}&lt;br/&gt;&lt;b&gt;At: &lt;/b&gt;{}&lt;br/&gt;&lt;b&gt;By: ' '&lt;/b&gt;{}&lt;br/&gt;{}'.format(orig_text, created_when, created_by, comment_text) last_by = '' last_when = '' #  answers = comment['children']['comment']['size'] if answers &gt; 0: for message in comment['children']['comment']['results']: #  last_when = re.sub(r'\.000\+', ' GMT+', re.sub(r'T', ' ', message['version']['when'])) last_by = message['version']['by']['displayName'] #  thread += ('&lt;br/&gt;===next===&lt;br/&gt;&lt;b&gt;At: &lt;/b&gt;{}&lt;br/&gt;&lt;b&gt;By: ' '&lt;/b&gt;{}&lt;br/&gt;{}'.format(last_when, last_by, message['body']['storage']['value']) ) #  . row_comm = {"Page": page_code, "Comment": comment_link, "Thread": thread, "Result": comment_result, "Answers count": answers, "Creation Date": created_when, "Author": created_by, "Last Date": last_when, "Last Author": last_by} comments.append(row_comm) #   ,   , #     . if len(comments) == 0: row_comm = {"Page": page_code, "Comment": 'nolink', "Thread": 'nocomment', "Result": 'nocomment', "Answers count": 0, "Creation Date": 'never', "Author": 'nobody', "Last Date": 'never', "Last Author": 'nobody'} comments.append(row_comm) return comments</span></span></code> </pre></div></div><br><h2>  Statistiques et tableaux </h2><br>  Pour la clart√© de la pr√©sentation des donn√©es, nous collectons des statistiques √† leur sujet et les organisons sous forme de tableaux. <br><br><div class="spoiler">  <b class="spoiler_title">Nous traitons les statistiques</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">page_statistics</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(comments_data)</span></span></span><span class="hljs-function">:</span></span> open_count = <span class="hljs-number"><span class="hljs-number">0</span></span> dang_count = <span class="hljs-number"><span class="hljs-number">0</span></span> comment_count = len(comments_data) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> comment_count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> comment <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> comments_data: <span class="hljs-comment"><span class="hljs-comment">#     if comment['Result'] not in ['resolved', 'nocomment']: if comment['Result'] in ['open', 'reopened']: open_count += 1 if comment['Result'] == 'dangling' and comment['Author'] not in excludeNames: dang_count += 1 res_dict = {'Page': comments_data[0]['Page'], 'Total': comment_count, 'Resolved': comment_count - open_count - dang_count, 'Dangling': dang_count, 'Open': open_count} return res_dict #   def total_statistics(stat_data): total_comment = 0 total_resolved = 0 total_open = 0 total_dangling = 0 for statRow in stat_data: total_comment += statRow['Total'] total_resolved += statRow['Resolved'] total_open += statRow['Open'] total_dangling += statRow['Dangling'] res_dict = {'Page': 'All Pages Total', 'Type': '', 'Jira': '', 'Status': '', 'Total': total_comment, 'Resolved': total_resolved, 'Dangling': total_dangling, 'Open': total_open} return res_dict</span></span></code> </pre></div></div><br>  Pour faire les donn√©es sous forme de tableaux, nous ferons une autre proc√©dure.  Il forme le code HTML du tableau √† partir de la liste des dictionnaires, comme en-t√™tes il ajoute une ligne √† partir des noms des cl√©s du dictionnaire et ajoute une colonne avec des num√©ros de ligne. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_table</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tab_data)</span></span></span><span class="hljs-function">:</span></span> tab_start = <span class="hljs-string"><span class="hljs-string">'&lt;table style="width: 100.00%;"&gt;&lt;colgroup&gt;&lt;col /&gt;'</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;col /&gt;&lt;/colgroup&gt;&lt;tbody&gt;'</span></span> tab_end = <span class="hljs-string"><span class="hljs-string">'&lt;/tbody&gt;&lt;/table&gt;'</span></span> tab_code = tab_start + <span class="hljs-string"><span class="hljs-string">'&lt;tr&gt;'</span></span> row_num = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(tab_data) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;th&gt;Num&lt;/th&gt;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tab_data[<span class="hljs-number"><span class="hljs-number">0</span></span>].keys(): tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;th&gt;{}&lt;/th&gt;'</span></span>.format(key) tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;/tr&gt;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tab_data: tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;tr&gt;&lt;td&gt;{}&lt;/td&gt;'</span></span>.format(row_num) row_num += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> field <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> row.values(): tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;td&gt;{}&lt;/td&gt;'</span></span>.format(field) tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;/tr&gt;'</span></span> tab_code += tab_end + <span class="hljs-string"><span class="hljs-string">'\n'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tab_code</code> </pre><br>  Maintenant, tout est pr√™t.  Apr√®s avoir √©tiquet√© et ex√©cut√© le script, nous obtenons une page qui ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/-1/if/af/-1ifafmgt3mqvbayphkq7opy4mq.png"><br><br><h2>  PS </h2>  Bien s√ªr, ce n'est pas tout ce qui s'est finalement av√©r√©.  Il y a eu une analyse des pages et une recherche d'une macro avec le num√©ro de t√¢che dans Jira.  Il y avait un √©tiquetage automatique par num√©ros de t√¢ches dans Jira et des liens entre eux et Confluence.  Il y a eu une comparaison et une v√©rification des listes de livraison hebdomadaires.  Il y avait une sauvegarde des commentaires dans Excel et la collecte de donn√©es communes √† partir de plusieurs fichiers Excel hebdomadaires.  Et r√©cemment, l'analyse des commentaires de Word a √©t√© ajout√©e. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr485652/">https://habr.com/ru/post/fr485652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr485636/index.html">Les virus r√©sistants aux CRISPR construisent des abris pour prot√©ger les g√©nomes des enzymes p√©n√©trant l'ADN</a></li>
<li><a href="../fr485640/index.html">M√©thodes de masquage des pages Web</a></li>
<li><a href="../fr485646/index.html">Conseils Python utiles que vous n'avez jamais rencontr√©s auparavant. 2e partie</a></li>
<li><a href="../fr485648/index.html">L'approche pythonique des boucles for: range () et enumerate ()</a></li>
<li><a href="../fr485650/index.html">Docker Image Reduction Techniques</a></li>
<li><a href="../fr485654/index.html">Une id√©e tir√©e de la physique aide l'IA √† travailler dans des dimensions plus √©lev√©es.</a></li>
<li><a href="../fr485660/index.html">La soci√©t√© de protection DDoS a elle-m√™me lanc√© des attaques DDoS, a reconnu son fondateur</a></li>
<li><a href="../fr485664/index.html">Cr√©ation de param√®tres dynamiques dans un travail Jenkins, ou comment rendre votre t√¢che conviviale</a></li>
<li><a href="../fr485672/index.html">Redis Best Practices, Partie 1</a></li>
<li><a href="../fr485682/index.html">La gestion du temps n'aidera pas: la procrastination est le probl√®me de la r√©gulation des √©motions, pas du temps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>