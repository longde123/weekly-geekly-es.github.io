<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐒 🦀 🎤 Testen Sie meine Geduld mit der Check Point Security Academy 👃🏿 🐠 🤹🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich habe das Programm der Check Point Security Academy auf Habré mehrmals erwähnt: Das Wesentliche ist, dass das Unternehmen Check Point im Sommer ein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testen Sie meine Geduld mit der Check Point Security Academy</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430210/"> Ich habe das Programm der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Check Point Security Academy</a> auf Habré mehrmals erwähnt: Das Wesentliche ist, dass das Unternehmen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Check Point</a> im Sommer einen Wettbewerb im Format Capture the Flag angekündigt hat, bei dem die Erfahrungen des Teilnehmers in der Vergangenheit nicht wichtig sind, sondern nur seine Fähigkeit, das Cyber ​​zu enträtseln Rätsel.  Basierend auf den Ergebnissen dieses Wettbewerbs rekrutierte das Unternehmen zwanzig Teilnehmer für einen dreimonatigen professionellen Kurs in Cybersicherheit. Alle Teilnehmer erhalten von Beginn des Kurses an das volle Gehalt eines Spezialisten für KB, der verpflichtet ist, zwei Jahre nach Ende des Kurses im Unternehmen zu arbeiten. <br><br><img src="https://habrastorage.org/webt/vf/kb/ix/vfkbixclsmvdnirjojnsjcc5q2k.png"><br>  <i>In einem CTF-Wettbewerb kann eine Flagge sogar ein Bild wie dieses sein.</i> <br><br>  Die Auswahl der Teilnehmer wurde im August abgeschlossen, aber die Website des Wettbewerbs wird bis zum nächsten Sommer weiter funktionieren, und ich lade diejenigen ein, die sich registrieren und sich aus sportlichen Gründen versuchen möchten.  Der Wettbewerb besteht aus 12 Puzzles unterschiedlicher Komplexität mit einer Bewertung von 10 bis 150 Punkten. <br>  Hier möchte ich das Puzzle "Test My Patience" aus der Kategorie "Surprise" analysieren.  Sie hat einen mittleren Schwierigkeitsgrad (50 Punkte) und hier ist ihr vollständiger Text: <br><blockquote>  Hallo zusammen <br>  Wir haben <a href="">diese</a> ausführbare Datei auf dem Computer des lokalen Uhrmachers gefunden. <br>  Es wird gemunkelt, dass der Uhrmacher irgendwie die einzige Person war, die es geschafft hat, es zu knacken. <br>  Denken Sie, Sie sind so gut wie der Uhrmacher? <br>  <b>Hinweis: Diese Datei ist in keiner Weise schädlich</b> </blockquote> Als Referenz - eine 32-Bit-Binärdatei für Windows, auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einige Virenschutzprogramme schwören</a> , aber wenn Sie sie noch ausführen, sieht sie folgendermaßen aus: <br><br><img src="https://habrastorage.org/webt/iw/x_/_f/iwx__foij5pljrqee4346ldcgqy.png"><br><br>  Innerhalb der Binärdatei ist verschlüsselt;  Es weigert sich, unter dem Debugger zu laufen;  Wenn Sie versuchen, einen Debugger während der Ausführung mit ihm zu verbinden, wird er sofort beendet.  Wahrscheinlich haben Spezialisten von Check Point ihr Puzzle in einen Kryptopacker gewickelt, der von einer Art Malvari entlehnt wurde. <br><br>  Wie werden wir die Zahl des Uhrmachers erraten? <br><a name="habracut"></a><br>  Es gibt zwei Möglichkeiten.  Das erste kann bedingt als "es gibt Macht, kein Verstand" bezeichnet werden: Wenn das Programm nicht live debuggt werden kann, werden wir das tote debuggen! <br><br>  Starten Sie den 32-Bit-Task-Manager (\ Windows \ SysWOW64 \ taskmgr.exe), klicken Sie mit der rechten Maustaste auf den mysteriösen Prozess und wählen Sie Dump-Datei erstellen.  (Der 64-Bit-Task-Manager für 32-Bit-Prozesse erstellt einen Speicherauszug des wow64cpu-Emulators, mit dem schwieriger zu arbeiten ist.) <br><br>  Wir schauen in den Dump und sehen, dass zumindest die darin enthaltenen Zeilen bereits entschlüsselt sind: <br><br><img src="https://habrastorage.org/webt/ug/fx/u-/ugfxu-y-1tgtxfjbhjb-zx7gmlg.png"><br><br>  Die Linien mit der versteckten Nummer oder der Flagge sind jedoch noch nicht sichtbar. <br><br>  Wir wenden uns der Waffe des Hauptkalibers zu: WinDbg (X86) -&gt; Open Crash Dump ... <br><br><img src="https://habrastorage.org/webt/kz/em/by/kzemby77zuk_wllg194irxj864y.png"><br><br>  Wo im Gedächtnis ist die Zeile, die wir sehen wollen, gedruckt - "Gute Arbeit, mein Freund!"? <br>  Mit dem Befehl <code>lm</code> können Sie feststellen, dass die Binärdatei von <code>01140000</code> bis <code>015b2000</code> geladen ist.  dann <code>sa 01140000 015b2000 "Good job my friend!"</code>  findet die <code>0115a0d0</code> bei <code>0115a0d0</code> : <br><br><img src="https://habrastorage.org/webt/3g/nu/ed/3gnuedahkhiapktjyob3fsxavto.png"><br><br>  Lassen Sie uns nun herausfinden, wo diese Zeile gedruckt wird: Vielleicht enthält ein Befehl Bytes <code>d0 a0 15 01</code> , die der Adresse der <code>d0 a0 15 01</code> Zeile entsprechen.  ( <code>sb 01140000 015b2000 d0 a0 15 01</code> ) <br><br>  Viel Glück!  - Ein solches Team wurde gefunden: <br><br><img src="https://habrastorage.org/webt/rm/5v/ah/rm5vah4nctvyf7bewf8uy-dkzbo.png"><br><br>  Wie lautet der Code für diesen Befehl?  ( <code>ub 011412f7; u 011412f7</code> ) <br><br><img src="https://habrastorage.org/webt/xx/oc/kx/xxockxynmnfarqsjejxdghowqk8.png"><br><br>  Wir sehen, dass abhängig vom Ergebnis der Funktion <code>01141180</code> entweder die gewünschte Nachricht gedruckt wird oder "Falsche ..." <br><br>  Der Funktionscode <code>01141180</code> belegt drei Bildschirme.  Es ist ziemlich leicht zu erkennen, dass dies eine Implementierung von <code>strcmp()</code> , in der ein Aufruf von <code>Sleep(700)</code> hinzugefügt wurde.  Es ist noch nicht klar, warum es <code>Sleep()</code> gibt <code>Sleep()</code> ;  Das Ergebnis der Funktion wird jedoch nicht beeinflusst. Daher sollten wir besser herausfinden, welche Zeichenfolgen verglichen werden: <br><br><img src="https://habrastorage.org/webt/kz/ie/l3/kziel3yw1_p5f74wyjngg-aam2k.png"><br><br>  Es werden zwei Zeiger übergeben, die <code>ebp-14h</code> und <code>ebp-24h</code> .  Der zweite von ihnen wurde als <code>011410b0</code> an die Funktion <code>011410b0</code> . <br>  Ist das nicht die Funktion, die nach der versteckten Nummer fragt?  Überprüfen wir den Aufrufstapel ( <code>k</code> ): <br><br><img src="https://habrastorage.org/webt/8t/ov/tl/8tovtlh8uebmq10eb5hwfbaa_nq.png"><br><br>  Ja, sie ist es! <br><br>  Das allgemeine Schema des Puzzles ist jetzt klar: Die <code>ebp-24h</code> des Benutzers wird bei <code>ebp-24h</code> gespeichert, die Zahl bei <code>ebp-14h</code> , dann werden sie verglichen und entweder "Gute Arbeit, mein Freund!" Oder "Falsche ..." gedruckt. <br><br>  Alles was bleibt ist, die versteckte Nummer aus dem Stapelrahmen zu ziehen.  Wir kennen sein <code>ebp</code> aus dem Call Stack: <br><br><img src="https://habrastorage.org/webt/p1/eq/qo/p1eqqone8e7i_kszzwojdlq8goa.png"><br><br>  Komm schon, komm schon ... <br><br><img src="https://habrastorage.org/webt/zn/zo/yk/znzoyk99atyzq37hewnooffjvsu.png"><br><br>  Erfolg!  Sie können etwas Leckeres entkorken. <br><br>  Drei mysteriöse Dinge blieben jedoch ohne Erklärung: <ol><li>  Warum wird hier im <code>strcmp()</code> <code>Sleep(700)</code> ein Aufruf zum <code>Sleep(700)</code> <code>strcmp()</code> ? </li><li>  Warum hat das Programm bei Eingabe der versteckten Nummer zehn Sekunden lang eingefroren, bevor "Gute Arbeit, mein Freund!" Gedruckt wurde? </li><li>  Was hat der Uhrmacher mit diesem Puzzle zu tun? </li></ol><br>  Es stellt sich also heraus, dass es einen zweiten - intelligenteren - Weg gibt, die erratene Zahl zu erraten.  Wenn Sie nur zufällig die Zahlen 0-9 versuchen, ist es leicht zu bemerken, dass bei den Neunern das Programm ein wenig „hängt“.  Wenn Sie die Nummern 90-99 ausprobieren, können Sie sehen, dass das Programm auf der Nummer 98 doppelt so lange "einfriert".  (Nachdem wir den Mut aufgedeckt haben, wissen wir bereits, worum es geht: Ein erfolgreicher Vergleich jedes Zeichenpaars führt zu einer Verzögerung von 0,7 s.) Um das Rätsel zu lösen, ohne den Debugger zu starten, genügte es, jede nächste Ziffer auszuwählen, sodass die Verzögerung vor der Antwort zunahm - entweder manuell mit einer genauen Stoppuhr oder einem einfachen Skript.  Daher wiesen die Compiler auf eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">langjährige Methode zum Angriff auf kryptografische Algorithmen hin</a> , wenn die Zeit bis zur Fehlermeldung gemessen und analysiert wird. <br><br>  Aber zu lernen, wie man Programme aufnimmt, die in unbekannten Kryptopackern verpackt sind, ist meiner Meinung nach sowohl interessanter als auch wertvoller :-) <br><br>  Beachten Sie, dass wir nicht herausfinden mussten, wie die Binärdatei verschlüsselt ist oder wie die Zeichenfolge mit der angezeigten Nummer auf dem Stapel angezeigt wird (wir haben im Speicherauszug gesehen, dass sie nicht zu den Zeichenfolgenkonstanten gehört) - wir haben es geschafft, sowohl fertig als auch bereit zu sein, und dafür Etwa ein Dutzend WinDbg-Befehle reichten aus. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430210/">https://habr.com/ru/post/de430210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430200/index.html">Der Aktienkurs von Nvidia fällt angesichts des Zusammenbruchs des Kryptowährungsmarktes und des sinkenden Interesses am Bergbau</a></li>
<li><a href="../de430202/index.html">Schreiben eines Systems paarweise interagierender Partikel in C ++ mit DirectX 11</a></li>
<li><a href="../de430204/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 18: „Privates Surfen im Internet“, Teil 1</a></li>
<li><a href="../de430206/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 18: Privates Surfen im Internet, Teil 2</a></li>
<li><a href="../de430208/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 18: „Privates Surfen im Internet“, Teil 3</a></li>
<li><a href="../de430212/index.html">OpenSceneGraph: Grundlagen der Szenengeometrie</a></li>
<li><a href="../de430216/index.html">So wie ich es verstehe, esse ich viele Süßigkeiten oder die Klassifizierung von Waren durch Einchecken in der Anwendung</a></li>
<li><a href="../de430218/index.html">Energieoptimierung STM32: Ein praktischer Leitfaden</a></li>
<li><a href="../de430220/index.html">Wie man einen "hundertjährigen" USB-Hub in einen intelligent verwalteten verwandelt und 300 US-Dollar spart</a></li>
<li><a href="../de430222/index.html">Senior Engineer auf der Suche nach Arbeit. Wie ich 20 Interviews mit HR durchlaufen habe und was ich darüber denke</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>