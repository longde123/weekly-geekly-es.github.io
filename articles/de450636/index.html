<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè∏ ü§∏üèΩ üèÇüèΩ Magento 2. Monolog oder wie man Protokolle schreibt ‚èÆÔ∏è üññüèø üë®üèæ‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wenn Sie die verschiedenen Module f√ºr Magento 2 studieren, werden Sie feststellen, dass die Protokollierung viel seltener verwendet wird als Magento 1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Magento 2. Monolog oder wie man Protokolle schreibt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450636/">  Wenn Sie die verschiedenen Module f√ºr Magento 2 studieren, werden Sie feststellen, dass die Protokollierung viel seltener verwendet wird als Magento 1. Dies liegt haupts√§chlich an der Tatsache, dass die Protokollierung schwieriger geworden ist.  Hier m√∂chte ich mich auf die technische Seite des Problems konzentrieren, n√§mlich wie Daten protokolliert werden, wie Protokolle in Ihre eigene Datei geschrieben werden und was Monolog ist. <br><a name="habracut"></a><br><h3>  Inhaltsverzeichnis </h3><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Monolog</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anwendungsfunktionen in Magento 2</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Implementierung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Protokollierung mit dem Standardlogger</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Protokollierung mit einem Standardlogger mit einem benutzerdefinierten Kanal</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schreiben in eine benutzerdefinierte Datei mit Ihrem eigenen Handler</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schreiben in eine benutzerdefinierte Datei mit virtualType</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schnelle Datenerfassung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fazit</a> <br></blockquote><a name="monolog"></a><h2>  Monolog </h2><br>  Beginnen wir mit der wichtigsten Frage: Was ist Monolog und woher kommt es? <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Monolog</a></b> - Dies ist eine Bibliothek, die den PSR-3-Standard f√ºr die Datenprotokollierung implementiert.  Es ist Monolog, das in Magento 2 zum Aufzeichnen von Protokollen verwendet wird. <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PSR-3</a></b> ist wiederum ein Standard, der einen gemeinsamen Ansatz f√ºr die Datenprotokollierung und Empfehlungen f√ºr die Implementierung von Protokollierern beschreibt, die eine gemeinsame Schnittstelle bieten. <br><br><a name="psr-3"></a><div class="spoiler">  <b class="spoiler_title">PSR-3-Highlights</b> <div class="spoiler_text"><blockquote> <b>1. Der</b> Logger (Objekt) muss die Schnittstelle \ Psr \ Log \ LoggerInterface implementieren. <br>  <b>2.</b> Wir haben die folgenden Fehlerstufen (angegeben in der Reihenfolge der Priorit√§t von gr√∂√üer nach kleiner): <br>  <i><b>NOTFALL</b> - System ist unbrauchbar.</i> <br>  <i><b>ALERT</b> - Ma√ünahmen m√ºssen sofort ergriffen werden.</i>  <i>Beispiel: Ganze Website ausgefallen, Datenbank nicht verf√ºgbar usw.</i> <br>  <i><b>KRITISCH</b> - Kritische Bedingungen.</i>  <i>Beispiel: Anwendungskomponente nicht verf√ºgbar, unerwartete Ausnahme.</i> <br>  <i><b>FEHLER</b> - Laufzeitfehler, die keine sofortige Aktion erfordern, aber normalerweise √ºberwacht werden sollten.</i> <br>  <i><b>WARNUNG</b> - Au√üergew√∂hnliche Vorkommen, bei denen es sich nicht um Fehler handelt. Beispiel: Verwendung veralteter APIs.</i> <br>  <i><b>HINWEIS</b> - Normale, aber wichtige Ereignisse.</i> <br>  <i><b>INFO</b> - Interessante Ereignisse.</i>  <i>Beispiel: Benutzer meldet sich an, SQL-Protokolle.</i> <br>  <i><b>DEBUG</b> - Detaillierte Debug-Informationen.</i> <br><br>  <b>3.</b> Jede Ebene hat ihre eigene Methode (Debug, Info, Benachrichtigung, Warnung, Fehler, Kritisch, Alarm, Notfall / Notfall) und es sollte auch eine Protokollmethode geben, die die Fehlerstufe als ersten Parameter verwendet. <br>  <b>4. Die</b> Methoden akzeptieren eine Zeichenfolge oder etwas, das __toString () implementiert (dh Sie m√ºssen print_r ($ message, true) manuell f√ºr Arrays verwenden oder sie im n√§chsten Parameter √ºbergeben). <br>  <b>5.</b> Alle Methoden akzeptieren ein $ context-Array, das das Protokoll erg√§nzt. <br>  <b>6.</b> Kann, aber nicht unbedingt, das Ersetzen von Daten aus dem $ context-Array in die Nachricht implementiert werden.  In diesem Fall wird das Format {name} empfohlen, wobei name -&gt; der Schl√ºssel des Arrays im $ -Kontext ist. <br></blockquote><br></div></div><br>  Monolog ist ziemlich einfach zu bedienen.  Schauen wir uns das folgende Beispiel an. <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Monolog</span></span>\<span class="hljs-title"><span class="hljs-title">Logger</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Monolog</span></span>\<span class="hljs-title"><span class="hljs-title">Handler</span></span>\<span class="hljs-title"><span class="hljs-title">StreamHandler</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Monolog</span></span>\<span class="hljs-title"><span class="hljs-title">Formatter</span></span>\<span class="hljs-title"><span class="hljs-title">HtmlFormatter</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     "name" $log = new Logger('name'); //  ,      "path/to/your1.log"       "WARNING"   (notice, info  debug   ). $log-&gt;pushHandler(new StreamHandler('path/to/your1.log', Logger::WARNING)); //  ,      "path/to/your2.log"       "ALERT"   (..        alert  emergency).    ,    .         html   HtmlFormatter. $log-&gt;pushHandler(new StreamHandler('path/to/your2.log', Logger::ALERT,false) -&gt;setFormatter(new HtmlFormatter)); //  ,       . $log-&gt;pushProcessor(function ($record) { $record['extra']['dummy'] = 'Hello world!'; return $record; }); //   $log-&gt;warning('Foo'); $log-&gt;error('Bar',['test']); $log-&gt;info('Test'); //   ,    1     INFO //your1.log // [2019-08-12 02:57:52] name.WARNING: Foo [] ['extra'=&gt;['dummy'=&gt;'Hello world!']] // [2019-08-12 02:57:53] name.ERROR: BAR ['test'] ['extra'=&gt;['dummy'=&gt;'Hello world!']] //your2.log // , .    ALERT  EMERGENCY</span></span></code> </pre> <br>  H√∂hepunkte der Arbeit von Monolog zu beachten: <br><br><ul><li>  <b>Logger</b> ist ein Objekt, mit dem wir Protokolle aufzeichnen.  Der Logger selbst zeichnet nicht auf, sondern verwaltet Handler.  Es kann eine beliebige Nummer erstellt werden. </li><li>  <b>Handler</b> - ein Objekt, das Daten direkt verarbeitet.  Sie k√∂nnen dem Logger so viele Handler hinzuf√ºgen, wie Sie m√∂chten.  Alle werden nacheinander aufgerufen, unabh√§ngig davon, ob der angegebene Handler den Fehler verarbeiten konnte oder nicht.  Die isHandling-Methode bestimmt, ob dieser Handler den empfangenen Fehler verarbeiten kann. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isHandling</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $record[<span class="hljs-string"><span class="hljs-string">'level'</span></span>] &gt;= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;level; }</code> </pre><br>  Die gr√∂√üte √Ñhnlichkeit mit dem Handler ist meiner Meinung nach der Event Observer. <br></li><li>  <b>Prozessor</b> - jede aufgerufene Entit√§t (aufrufbar).  Vielleicht ein paar.  Sie k√∂nnen sowohl global zugewiesen als auch f√ºr den Handler installiert werden.  Zun√§chst werden globale Prozessoren gestartet.  Die Hauptaufgabe des Prozessors besteht darin, dem Protokoll zus√§tzliche Daten hinzuzuf√ºgen (z. B. die IP, von der aus die Verbindung hergestellt wurde, den Wert globaler Variablen, Informationen dar√ºber, auf welchem ‚Äã‚ÄãGit-Zweig sich der Code befindet usw.). </li><li>  <b>Formatierer</b> - Konvertiert die Nachrichtenausgabe vor dem Schreiben.  Es kann nur 1 pro Handler geben.  Es ist notwendig, die Formatierung des Nachrichtentexts zu √§ndern, um beispielsweise Text in HTML oder JSON zu konvertieren. </li><li>  <b>Kanal</b> - der Name des Loggers.  Es wird beim Aufzeichnen des Protokolls geschrieben.  Da 1 Handler in 2 verschiedenen Loggern verwendet werden kann (er schreibt Protokolle in 1 dieselbe Datei), wird dadurch bestimmt, woher der Fehler stammt. </li><li>  <b>Level</b> - Fehlerlevel.  Dieser Parameter f√ºr den Handler gibt die minimale Fehlerstufe an, die er behandeln wird. </li><li>  <b>Bubble</b> - Nachrichten-Popup.  Nachdem der Handler die Nachricht verarbeitet hat, leitet der Logger die Nachricht an den n√§chsten Handler weiter.  Dieser Prozess kann mithilfe der Eigenschaft bubble gestoppt werden.  Wenn der Handler den Wert dieser Eigenschaft false hat (der Standardwert ist immer true), werden andere Handler nicht gestartet, nachdem dieser Handler seine Arbeit erledigt hat (dieser Fehler konnte verarbeitet werden). </li><li>  <b>Sortierreihenfolge</b> - Ausf√ºhrungsreihenfolge.  Der zuletzt hinzugef√ºgte Handler wird immer als allererster gestartet.  Mit dieser Funktion k√∂nnen Sie einen Mechanismus implementieren, um den Logger vollst√§ndig zu deaktivieren (√ºber Bubbling False).  √úber den Konstruktor hinzugef√ºgte Handler werden in der im Konstruktor angegebenen Reihenfolge ausgef√ºhrt. </li></ul><br><blockquote>  Da PSR-3 Entwickler nicht verpflichtet, AutoCorrect-Werte im Text zu implementieren, f√ºhrt Monolog dies standardm√§√üig nicht aus.  Wenn Sie schreiben -&gt; emerg ('test 1111 {placeholder}', ['placeholder' =&gt; 'foo']), erhalten Sie Folgendes <br>  [2019-08-12 02:57:52] main.EMERGENCY: test 1111 {placeholder} {"placeholder": "foo"} [] <br><br>  Damit der Austausch funktioniert, m√ºssen Sie einen zus√§tzlichen Prozessor anschlie√üen - \ Monolog \ Processor \ PsrLogMessageProcessor. <br></blockquote>  Es ist erw√§hnenswert, dass Monolog eine gro√üe Anzahl von Formatierern, Prozessoren und Handlern im Auslieferungszustand hat.  Sie k√∂nnen sie entweder verwenden oder Ihre eigenen schreiben. <br><br><a name="subtlety"></a><h2>  Anwendungsfunktionen in Magento 2 </h2><br>  Auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Magento-Website</a> finden Sie ein allgemeines Beispiel f√ºr die Verwendung des Loggers.  Leider enth√ºllt das vorgestellte Beispiel nicht alle Details und beantwortet leider nicht die Frage "Wie schreibe ich Protokolle in Ihre eigene Datei?".  Lassen Sie uns deshalb alles genauer verstehen. <br><br>  In den Tagen von Magento 1 verwendeten wahrscheinlich fr√ºher oder sp√§ter alle die Mage :: log-Methode, die √ºberall im Code verf√ºgbar war, und der einfachste Protokolleintrag sah aus wie Mage :: log ('ALARM!', Null, 'api.log').  Als Ergebnis hatten wir einen Datensatz des folgenden Formulars in der Datei var / log / api.log <br><br><pre> <code class="php hljs"><span class="hljs-number"><span class="hljs-number">2019</span></span><span class="hljs-number"><span class="hljs-number">-08</span></span><span class="hljs-number"><span class="hljs-number">-12</span></span>T01:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>+<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> DEBUG (<span class="hljs-number"><span class="hljs-number">7</span></span>): ALARM!</code> </pre><br>  <i>Standardformat:% Zeitstempel %% Priorit√§tsname% (% Priorit√§t%):% Nachricht%.</i> <br><br>  Mal sehen, wie man Daten im einfachsten Fall in Magento 2 protokolliert. Meistens verwenden Sie $ this -&gt; _ logger-&gt; info ('ALARM!');  (Wenn ein Objekt beispielsweise eine solche Eigenschaft geerbt hat). <br><br>  Als Ergebnis eines solchen Aufrufs erhalten wir den folgenden Eintrag in der Datei var / log / system.log <br><br><pre> <code class="php hljs">[<span class="hljs-number"><span class="hljs-number">2019</span></span><span class="hljs-number"><span class="hljs-number">-08</span></span><span class="hljs-number"><span class="hljs-number">-12</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>] main.INFO: ALARM! [] []</code> </pre><br>  <i>Das Standardformat ist [% datetime%]% channel%.% Level_name%:% message %% context %% extra%</i> <br><blockquote>  Wenn das Objekt keine solche Eigenschaft hat (_logger oder logger), m√ºssen wir zuerst die Abh√§ngigkeit \ Psr \ Log \ LoggerInterface zu Ihrer Klasse hinzuf√ºgen und das resultierende Objekt in die Eigenschaft $ logger schreiben (gem√§√ü <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PSR-2 Punkt 4.2</a> und dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf der Magento-Website dargestellten Beispiel</a> ). . <br></blockquote>  Im Gegensatz zu Magento 1 gibt es hier viel mehr Nuancen. <br><br>  <b>1. Parameter f√ºr die Protokollierung.</b> <br><br>  Betrachten Sie einen generischen Aufruf der Schreibmethode <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_logger-&gt;{level}($message, $context = []); <span class="hljs-comment"><span class="hljs-comment">//$this-&gt;_logger-&gt;log('{level}', $message, $context = []);</span></span></code> </pre><br>  <b>1)</b> Wobei {level} gem√§√ü PSR-3 eine der Methoden ist, die f√ºr die Protokollierung einer bestimmten Fehlerstufe reserviert sind (Debug, Info, Benachrichtigung, Warnung, Fehler, kritisch, Alarm, Notfall / Notfall). <br>  <b>2)</b> $ message - im Gegensatz zu Magento 1 sollte es eine Zeichenfolge sein.  Das hei√üt,  $ object-&gt; getData () funktioniert hier nicht.  Das Datenarray muss an den n√§chsten Parameter √ºbergeben werden.  \ Exception-Objekte sind eine Ausnahme, da die Implementierung von \ Magento \ Framework \ Logger \ Monolog sie separat verarbeitet und automatisch -&gt; getMessage () als $ message weiterf√ºhrt, wenn das \ Exception-Objekt als Nachricht √ºbergeben wurde. <br>  <b>3)</b> $ context ist ein optionaler Parameter, ein Array. <br><br>  <b>2. Die Eigenschaft $ this -&gt; _ logger ist nicht in allen Klassen verf√ºgbar.</b> <br><br>  <b>Pr√§sentiert</b> in: Block, Helfer, Modell, Sammlung usw. <br>  <b>Nicht verf√ºgbar</b> in: ResourceModel, Controller, Comand, Setup usw. <br><br><div class="spoiler">  <b class="spoiler_title">Erfahren Sie mehr √ºber ResourceModel und Collection.</b> <div class="spoiler_text">  ResourceModel verf√ºgt √ºber die Eigenschaft _logger, wird jedoch nicht im Konstruktor ausgef√ºllt.  Es wird nur mit der privaten Methode getLogger in \ Magento \ Framework \ Model \ ResourceModel \ AbstractResource gef√ºllt.  Die Methode wird nur im Fehlerfall beim Schreiben in die Datenbank (im catch-Block) innerhalb der commit () -Methode aufgerufen.  Bis dahin verf√ºgt das Ressourcenmodell nicht √ºber einen Logger. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">commit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getConnection()-&gt;commit(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getConnection()-&gt;getTransactionLevel() === <span class="hljs-number"><span class="hljs-number">0</span></span>) { $callbacks = CallbackPool::get(spl_object_hash(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getConnection())); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($callbacks <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $callback) { call_user_func($callback); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (\<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getLogger()-&gt;critical($e); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>; } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLogger</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> === <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_logger) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_logger = ObjectManager::getInstance()-&gt;get(\Psr\Log\LoggerInterface::class); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_logger; }</code> </pre><br>  Collection hat von Anfang an einen Logger.  Es wird im Konstruktor \ Magento \ Framework \ Data \ Collection \ AbstractDb zugewiesen und sp√§ter vererbt. <br></div></div><br>  Es ist unm√∂glich, dies nicht zu sagen, aber in den Controllern gibt es eine M√∂glichkeit, den Logger mithilfe des ObjectManager abzurufen (√ºber die Eigenschaft $ this -&gt; _ objectManager).  Dies ist nat√ºrlich nicht der richtigste Weg. <br><br>  <b>3. Der Standardlogger und die Liste der Handler.</b> <br><br>  In der globalen Datei di.xml (app / etc / di.xml) finden Sie, dass \ Psr \ Log \ LoggerInterface von der Klasse \ Magento \ Framework \ Logger \ Monolog implementiert wird, die wiederum von \ Monolog \ Logger erbt.  Der Loggername ist main.  Dort sind auch mehrere Handler definiert. <br><br><pre> <code class="xml hljs">‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">preference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Psr\Log\LoggerInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Logger\Monolog"</span></span></span><span class="hljs-tag"> /&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Logger\Monolog"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span>main<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"handlers"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"array"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"system"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>Magento\Framework\Logger\Handler\System<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"debug"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>Magento\Framework\Logger\Handler\Debug<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syslog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>Magento\Framework\Logger\Handler\Syslog<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br>  Einige Klassen unterscheiden sich von den oben aufgef√ºhrten (da sie im Magento \ Developer-Modul neu definiert wurden): <br><br>  <b>1)</b> Magento \ Framework \ Logger \ Handler \ System ( <i>h√∂rt auf INFO)</i> <br>  <b>2)</b> Magento \ Developer \ Model \ Logger \ Handler \ Debug ( <i>h√∂rt DEBUG ab</i> ) <br>  <b>3)</b> Magento \ Developer \ Model \ Logger \ Handler \ Syslog ( <i>h√∂rt auf DEBUG</i> ) <br><br>  In den angegebenen Klassen (Debug und Syslog) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wird die M√∂glichkeit zum Deaktivieren der Protokollierung</a> (dev / debug / debug_logging bzw. dev / syslog / syslog_logging) hinzugef√ºgt. <br><br>  Beachten Sie, dass die Liste der Handler, die in exception.log schreiben, keinen Ausnahmebehandler enth√§lt.  Es wird im Systemhandler aufgerufen. <br><br><div class="spoiler">  <b class="spoiler_title">Magento \ Framework \ Logger \ Handler \ System</b> <div class="spoiler_text"><pre> <code class="php hljs">... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $record)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($record[<span class="hljs-string"><span class="hljs-string">'context'</span></span>][<span class="hljs-string"><span class="hljs-string">'exception'</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;exceptionHandler-&gt;handle($record); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } $record[<span class="hljs-string"><span class="hljs-string">'formatted'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getFormatter()-&gt;format($record); <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::write($record); } ...</code> </pre><br></div></div><br><blockquote>  Magento 2 bis 2.2 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hatten ein Problem</a> damit, dass der Logger nach dem ersten gefundenen nicht mehr zu einem anderen Handler springen konnte.  Dieses Problem wurde durch die Tatsache verursacht, dass Monolog berechnete, dass alle Handler in einem Array mit digitalen Schl√ºsseln und mit alphabetischen Schl√ºsseln (['system' =&gt;, 'debug' =&gt;, ...]) darauf kamen.  Magento-Entwickler haben die Situation sp√§ter korrigiert - sie konvertieren den Hash in ein regul√§res Array mit digitalen Schl√ºsseln, bevor sie ihn an Monolog √ºbergeben.  Monolog hat jetzt auch den Handler-Aufz√§hlungsalgorithmus ge√§ndert und verwendet die next () -Methode. <br></blockquote>  <b>4. Einf√ºhrung Ihres Handlers in die Liste der vorhandenen.</b> <br><br>  Wir kommen zu der interessantesten Sache, die den Eindruck der Implementierung in Magento 2 ein wenig beeintr√§chtigt. Sie k√∂nnen der Liste der vorhandenen mit di.xml keinen benutzerdefinierten Handler hinzuf√ºgen, ohne ... "zus√§tzliche Gesten".  Dies ist auf das Prinzip der Zusammenf√ºhrungskonfiguration zur√ºckzuf√ºhren. <br><br>  Es gibt mehrere <b>Konfigurationsbereiche</b> : <br><br>  <b>1)</b> Initial (app / etc / di.xml) <br>  <b>2)</b> Global ({moduleDir} /etc/di.xml) <br>  <b>3)</b> Bereichsspezifisch ({moduleDir} / etc / {area} /di.xml dh Frontend / adminhtml / crontab / webapi_soap / webapi_rest usw.) <br><br>  Innerhalb von Level 1 werden Konfigurationen zusammengef√ºhrt, aber die n√§chste Ebene definiert sie beim Zusammenf√ºhren neu (wenn sie auch dort deklariert sind).  Dies macht es unm√∂glich, Handler in ihren Modulen zur vorhandenen Liste hinzuzuf√ºgen, da diese im urspr√ºnglichen Bereich deklariert ist. <br><br>  <i>Vielleicht sehen wir in Zukunft eine Implementierung, bei der das Hinzuf√ºgen von Handlern vom urspr√ºnglichen Bereich in ein anderes Modul verschoben und dadurch in den globalen Bereich √ºbertragen wird.</i> <br><br><a name="howto"></a><h2>  Implementierung </h2><br>  Schauen wir uns die wichtigsten Methoden zum Aufzeichnen von Protokollen an, die f√ºr uns bei der Implementierung von Aufgaben hilfreich sein k√∂nnen. <br><br><a name="howto1"></a><h3>  1. Protokollierung mit dem Standardlogger </h3><br>  Mit dieser Methode k√∂nnen wir problemlos Protokolle in eines der Standardprotokolle (debug.log, system.log oder exception.log) schreiben. <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $logger; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(\Psr\Log\LoggerInterface $logger)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;logger = $logger; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;logger-&gt;info(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//[...some date...] main.INFO: Something went wrong [] [] } }</span></span></code> </pre><br>  Alles wird noch einfacher, wenn in unserer Klasse bereits eine vererbte Logger-Abh√§ngigkeit besteht. <br><br><pre> <code class="php hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_logger-&gt;info(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    -&gt;debug,   ,      debug.log ...</span></span></code> </pre><br><a name="howto2"></a><h3>  2. Protokollierung mit einem Standardlogger mit einem benutzerdefinierten Kanal </h3><br>  Diese Methode unterscheidet sich von der vorherigen darin, dass ein Klon des Loggers erstellt und ihm ein anderer Kanal (Name) zugewiesen wird.  Dies vereinfacht die Suche in der Protokolldatei. <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $logger; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(\Psr\Log\LoggerInterface $logger)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;logger = $logger-&gt;withName(<span class="hljs-string"><span class="hljs-string">'api'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    } public function foo() { $this-&gt;logger-&gt;info('Something went wrong'); //[...some date...] api.INFO: Something went wrong [] [] } }</span></span></code> </pre><br><br>  Um nach den erforderlichen Protokollen zu suchen, reicht es jetzt aus, die Suche nach "api" (der Standardprotokollierer in Magento 2 hei√üt main) in den vorhandenen Dateien system.log, debug.log, exception.log zu verwenden.  Kann verwenden <br><pre> <code class="bash hljs">grep -rn <span class="hljs-string"><span class="hljs-string">'api'</span></span> var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/system.log</code> </pre><br><br><a name="howto3"></a><h3>  3. Schreiben Sie mit Ihrem eigenen Handler in eine benutzerdefinierte Datei </h3><br>  Erstellen wir einen einfachen Handler, der alle Fehler der kritischen Ebene und h√∂her in einer separaten Datei var / log / Critical.log protokolliert.  F√ºgen Sie die M√∂glichkeit hinzu, alle anderen Handler f√ºr eine bestimmte Fehlerstufe und h√∂her zu blockieren.  Dadurch wird vermieden, dass Daten in den Dateien debug.log und system.log dupliziert werden. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Oxis</span></span>\<span class="hljs-title"><span class="hljs-title">Log</span></span>\<span class="hljs-title"><span class="hljs-title">Logger</span></span>\<span class="hljs-title"><span class="hljs-title">Handler</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Filesystem</span></span>\<span class="hljs-title"><span class="hljs-title">DriverInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Logger</span></span>\<span class="hljs-title"><span class="hljs-title">Handler</span></span>\<span class="hljs-title"><span class="hljs-title">Base</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Monolog</span></span>\<span class="hljs-title"><span class="hljs-title">Logger</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Test</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Base</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $fileName = <span class="hljs-string"><span class="hljs-string">'var/log/critical.log'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $loggerType = Logger::CRITICAL; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DriverInterface $filesystem)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::__construct($filesystem,<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;bubble = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      setBubble() } }</span></span></code> </pre><br><blockquote>  In Magento 2 2.2+ im Konstruktor \ Magento \ Framework \ Logger \ Handler \ Base hat sich die Art und Weise der Verarbeitung des Pfads zur Protokolldatei ge√§ndert <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// BP . $this-&gt;fileName // BP. DIRECTORY_SEPARATOR . $this-&gt;fileName</span></span></code> </pre><br>  Daher finden Sie in √§lteren Handlern / am Anfang von $ fileName. <br></blockquote><br><br>  Zum Beispiel ist eine kleine Erkl√§rung wert.  Da Base es Ihnen nicht erlaubt, die Bubble-Eigenschaft √ºber Konstruktorparameter festzulegen, m√ºssten wir entweder einen Teil des Codes aus dem Base-Konstruktor wiederholen, um den Eingabeparameter korrekt an das √ºbergeordnete Element der Base-Klasse zu √ºbergeben (das √ºbrigens einen Eingabeparameter zum Festlegen dieser Eigenschaft hat) oder verwenden ein solcher Ansatz.  Ich habe die zweite Option gew√§hlt. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Oxis</span></span>\<span class="hljs-title"><span class="hljs-title">Log</span></span>\<span class="hljs-title"><span class="hljs-title">Logger</span></span>\<span class="hljs-title"><span class="hljs-title">Handler</span></span>\<span class="hljs-title"><span class="hljs-title">Test</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Psr</span></span>\<span class="hljs-title"><span class="hljs-title">Log</span></span>\<span class="hljs-title"><span class="hljs-title">LoggerInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $logger; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( LoggerInterface $logger, Test $handler )</span></span></span><span class="hljs-function"> </span></span>{ $logger-&gt;pushHandler($handler); <span class="hljs-comment"><span class="hljs-comment">//  setHandlers([$handler]),        . $this-&gt;logger = $logger; } public function foo() { $this-&gt;logger-&gt;critical('Something went wrong'); //      critical.log //[...some date...] main.CRITICAL: Something went wrong [] [] } }</span></span></code> </pre><br>  Diese Methode zum Hinzuf√ºgen eines Handlers ist nicht ideal, erm√∂glicht es Ihnen jedoch, den Konfigurationsbereich des Problems zu verlassen, sodass wir alle Logger in unserer di.xml duplizieren m√ºssen.  Wenn das Ziel darin besteht, alle Logger durch Ihre eigenen zu ersetzen, ist es viel besser, den virtualType-Ansatz zu verwenden, den wir weiter betrachten werden. <br><br><a name="howto4"></a><h3>  4. Schreiben in eine benutzerdefinierte Datei mit virtualType </h3><br>  Dieser Ansatz erm√∂glicht es uns, die Klasse, die wir zum Schreiben von Protokollen ben√∂tigen, mit di.xml in die angegebene Protokolldatei zu zwingen.  Einen √§hnlichen Ansatz finden Sie in den Modulen Magento \ Payment und Magento \ Shipping.  Ich mache Sie darauf aufmerksam, dass dieser Ansatz ab Magento 2 2.2 und h√∂her funktioniert. <br><blockquote>  In Magento 2 2.2+ wurde dem Konstruktor \ Magento \ Framework \ Logger \ Handler \ Base ein neuer Parameter hinzugef√ºgt, mit dem Sie einen virtuellen Handler erstellen und √ºber di.xml den relativen Pfad zur Datei zum Schreiben des Protokolls angeben k√∂nnen.  Bisher war es erforderlich, entweder den vollst√§ndigen Pfad durch $ filePath anzugeben oder einen neuen Handler zu erstellen und den relativen Pfad in die gesch√ºtzte Datei $ fileName-Eigenschaft zu schreiben. <br></blockquote><br>  F√ºgen Sie in der Datei di.xml unseres Moduls Folgendes hinzu <br><pre> <code class="xml hljs"> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ApiHandler"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Logger\Handler\Base"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span>var/log/api.log<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ApiLogger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Logger\Monolog"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span>api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"handlers"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"array"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>ApiHandler<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Oxis\Log\Model\A"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>ApiLogger<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  F√ºgen Sie Oxis \ Log \ Model \ A eine Logger-Klasse hinzu. <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Oxis</span></span>\<span class="hljs-title"><span class="hljs-title">Log</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $logger; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(\Psr\Log\LoggerInterface $logger)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;logger = $logger; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;logger-&gt;info(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>); } }</code> </pre><br>  Jetzt werden absolut alle Protokolle, die in unserer Klasse geschrieben werden, von unserer Version des Loggers verarbeitet, der mit unserem Handler Protokolle in die Datei var / log / api.log schreibt. <br><br>  <b>4.1.</b>  <b>Wenn die Klasse den Logger √ºber das $ context-Objekt und nicht √ºber ihren Konstruktor empf√§ngt.</b> <br>  Dazu geh√∂rt \ Magento \ Catalog \ Model \ Product, dessen Abh√§ngigkeiten nicht \ Psr \ Log \ LoggerInterface haben, aber es gibt \ Magento \ Framework \ Model \ Context, √ºber das der Logger auf die Klasseneigenschaft festgelegt wird.  In diesem Fall m√ºssen wir die obige Option etwas komplizieren und den im $ context-Objekt befindlichen Logger ersetzen.  Damit dies nicht das gesamte Magento betrifft, ersetzen wir $ context nur f√ºr unsere Klasse durch virtualType. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ApiHandler"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Logger\Handler\Base"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span>var/log/api.log<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ApiLogger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Logger\Monolog"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span>api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"handlers"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"array"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>ApiHandler<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       logger--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ApiLogContainingContext"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Model\Context"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>ApiLogger<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">virtualType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Oxis\Log\Model\A"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"context"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>ApiLogContainingContext<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><a name="howto5"></a><h3>  5. Schnelle Datenprotokollierung </h3><br>  Es gibt Zeiten, in denen wir die Protokollierung schnell hinzuf√ºgen m√ºssen.  In den meisten F√§llen kann dies entweder auf dem Produktionsserver oder f√ºr schnelle Tests erforderlich sein. <br><pre> <code class="php hljs">... $log = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \Monolog\Logger(<span class="hljs-string"><span class="hljs-string">'custom'</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \Monolog\Handler\StreamHandler(BP.<span class="hljs-string"><span class="hljs-string">'/var/log/custom.log'</span></span>)]); $log-&gt;error(<span class="hljs-string"><span class="hljs-string">'test'</span></span>); ...</code> </pre><br>  <i>Vorteile dieses Ansatzes: Schreibt ein Datum, es gibt einen Kontext (Array), f√ºgt am Ende automatisch \ n hinzu</i> <br><br>  Im obigen Beispiel wird \ Monolog \ Logger speziell angewendet und nicht \ Magento \ Framework \ Logger \ Monolog, wodurch es erweitert wird.  Tatsache ist, dass es bei dieser Verwendung keinen Unterschied gibt, sondern weniger zu schreiben (und sich leichter daran zu erinnern). <br><br>  \ Monolog \ Handler \ StreamHandler wird wiederum anstelle von \ Magento \ Framework \ Logger \ Handler \ Base verwendet, da die Verwendung von Base als Snippet aufgrund zus√§tzlicher Abh√§ngigkeiten von Klassen von Drittanbietern nicht sehr praktisch ist. <br><br>  Ein anderer Ansatz, √ºber den nicht gesprochen werden kann, sind die guten alten file_put_contents. <br><br><pre> <code class="php hljs">... file_put_contents(BP.<span class="hljs-string"><span class="hljs-string">'/var/log/custom.log'</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>,FILE_APPEND); ...</code> </pre><br>  <i>Vorteile dieses Ansatzes: Schreiben Sie relativ schnell und m√ºssen Sie sich nicht an Klassen erinnern.</i> <br><br>  In beiden F√§llen spielt der konstante <b>BP</b> die Hauptrolle.  Sie zeigt immer auf den Ordner mit Magenta (1 Stufe h√∂her als die Kneipe), was praktisch ist und uns immer hilft, Protokolle an die richtige Stelle zu schreiben. <br><br><a name="fin"></a><h2>  Fazit </h2><br>  Ich hoffe, die obigen Informationen waren oder werden f√ºr Sie n√ºtzlich sein. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450636/">https://habr.com/ru/post/de450636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450626/index.html">Designmuster korrigieren - Singleton in PHP</a></li>
<li><a href="../de450628/index.html">Julia: Typen, Multimethoden und Arithmetik √ºber Polynome</a></li>
<li><a href="../de450630/index.html">Frontend Weekly Digest (29. April - 5. Mai 2019)</a></li>
<li><a href="../de450632/index.html">Cram Basic in 768 Bytes</a></li>
<li><a href="../de450634/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 363 (29. April - 5. Mai 2019)</a></li>
<li><a href="../de450640/index.html">Wie man versteht, dass man wirklich mit dem Rauchen aufh√∂rt</a></li>
<li><a href="../de450642/index.html">PHP Digest Nr. 155 (22. April - 6. Mai 2019)</a></li>
<li><a href="../de450644/index.html">Kryptow√§hrung: lebt oder stirbt? Teil 3</a></li>
<li><a href="../de450648/index.html">PS2 / PSP-Emulator + Google Drive + YouTube = "Wahnsinn" geht weiter</a></li>
<li><a href="../de450650/index.html">Anwendungszentrierte Infrastruktur. Netzwerkarchitektur der Zukunft - vom Denken zum Gesch√§ft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>