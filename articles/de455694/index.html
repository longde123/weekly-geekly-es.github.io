<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∞ üôéüèø üßúüèª Abrechnungsarchitektur der n√§chsten Generation: √úbergang zu Tarantool üôÜüèæ üß° üïµüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Warum rechnet ein Unternehmen wie MegaFon, Tarantool? Von au√üen scheint es, dass der Verk√§ufer normalerweise kommt, eine gro√üe Kiste mitbringt, den St...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Abrechnungsarchitektur der n√§chsten Generation: √úbergang zu Tarantool</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/455694/">  Warum rechnet ein Unternehmen wie MegaFon, Tarantool?  Von au√üen scheint es, dass der Verk√§ufer normalerweise kommt, eine gro√üe Kiste mitbringt, den Stecker in die Steckdose steckt - hier kommt die Abrechnung!  Fr√ºher war es so, aber jetzt ist es archaisch und solche Dinosaurier sind bereits ausgestorben oder ausgestorben.  Die Abrechnung ist zun√§chst ein Abrechnungssystem - ein Leseger√§t oder ein Taschenrechner.  In der modernen Telekommunikation ist dies ein <b>System zur Automatisierung des gesamten Lebenszyklus der Interaktion mit dem Abonnenten vom Vertragsabschluss bis zur K√ºndigung</b> , einschlie√ülich Echtzeitabrechnung, Zahlungsannahme und vielem mehr.  Die Abrechnung in Telekommunikationsunternehmen √§hnelt einem Kampfroboter - gro√ü, leistungsstark und mit Waffen aufgeh√§ngt. <br><br><img src="https://habrastorage.org/webt/fm/qq/n0/fmqqn0374oz43yleqaghmzfmh3i.jpeg"><br><br>  Und hier ist Tarantool?  <b>Oleg Ivlev</b> und <b>Andrey Knyazev</b> werden dar√ºber sprechen.  Oleg ist der Chefarchitekt von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MegaFon</a> mit umfassender Erfahrung in ausl√§ndischen Unternehmen. Andrey ist der Direktor f√ºr Gesch√§ftssysteme.  Aus dem Protokoll ihres Berichts auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tarantool-Konferenz 2018</a> erfahren Sie, warum F &amp; E in Unternehmen erforderlich ist, was Tarantool ist, wie der Stillstand f√ºr die vertikale Skalierung und Globalisierung zu den Voraussetzungen f√ºr die Entstehung dieser Datenbank im Unternehmen wurde, √ºber technologische Herausforderungen, die Transformation der Architektur und wie MegaFons Technostek Netflix √§hnelt. Google und Amazon. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bW24mJwSllQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Einzelabrechnungsprojekt </h2><br>  Das Projekt, das diskutiert wird, hei√üt "Single Billing".  In ihm zeigte Tarantool seine besten Eigenschaften. <br><br><img src="https://habrastorage.org/webt/gz/zv/uz/gzzvuztrluedxrko5az64xmlqs4.jpeg"><br><br>  Das Wachstum der Leistung von Hi-End-Ger√§ten konnte nicht mit dem Wachstum der Abonnentenbasis und der Zunahme der Anzahl der Dienste Schritt halten, ein weiteres Wachstum der Anzahl der Abonnenten und Dienste aufgrund von M2M, IoT wurde erwartet und Zweigstellenmerkmale f√ºhrten zu einer Verschlechterung der Markteinf√ºhrungszeit.  Das Unternehmen entschied sich f√ºr ein einheitliches Gesch√§ftssystem mit einer einzigartigen modularen Architektur von Weltklasse anstelle von 8 derzeit unterschiedlichen Abrechnungssystemen. <br><br>  <b>MegaFon besteht aus acht Unternehmen in einem</b> .  Im Jahr 2009 wurde die Umstrukturierung abgeschlossen: Niederlassungen in ganz Russland wurden zu einem einzigen Unternehmen, MegaFon OJSC (jetzt PJSC), zusammengelegt.  Somit verf√ºgt das Unternehmen √ºber 8 Abrechnungssysteme mit eigenen ‚Äûkundenspezifischen‚Äú L√∂sungen, Branchenfunktionen und einer anderen Organisationsstruktur, IT und Marketing. <br><br>  Alles war in Ordnung, bis ich ein gemeinsames Bundesprodukt auf den Markt bringen musste.  Hier traten viele Schwierigkeiten auf: f√ºr einige, Tarifierung mit Aufrundung, f√ºr andere in geringerem Ma√üe und f√ºr andere nach dem arithmetischen Mittel.  Es gibt Tausende solcher Momente. <br><br>  Trotz der Tatsache, dass die Version des Abrechnungssystems die gleiche ist, ein Lieferant, gingen die Einstellungen auseinander, so dass der Kleber f√ºr eine lange Zeit.  Wir haben versucht, ihre Anzahl zu reduzieren, und sind auf ein zweites Problem gesto√üen, das vielen Unternehmen bekannt ist. <br><br>  <b>Vertikale Skalierung</b> .  Selbst das k√ºhlste Eisen zu dieser Zeit entsprach nicht den Anforderungen.  Wir haben Hewlett-Packard-Ger√§te verwendet, die Superdome Hi-End-Linie, aber es wurden nicht einmal zwei Zweige ben√∂tigt.  Ich wollte eine horizontale Skalierung ohne gro√üe Transaktionskosten und Kapitalinvestitionen. <br><br>  <b>Erwartung eines Wachstums der Anzahl der Abonnenten und Dienste</b> .  Die Berater haben lange Zeit Geschichten √ºber IoT und M2M in die Telekommunikationswelt gebracht: Es wird eine Zeit kommen, in der jedes Telefon und B√ºgeleisen eine SIM-Karte und zwei im K√ºhlschrank haben wird.  Heute haben wir eine Anzahl von Abonnenten, und in naher Zukunft wird es eine Gr√∂√üenordnung mehr geben. <br><br><h2>  Technologische Herausforderungen </h2><br>  Diese vier Gr√ºnde haben uns zu gro√üen Ver√§nderungen gef√ºhrt.  Es gab die Wahl zwischen einem Upgrade des Systems und einem Design von Grund auf neu.  Sie dachten lange nach, trafen ernsthafte Entscheidungen, spielten Ausschreibungen.  Infolgedessen haben sie sich von Anfang an f√ºr das Design entschieden und interessante Herausforderungen angenommen - technologische Herausforderungen. <br><br><h3>  Skalierbarkeit </h3><br>  Wenn es fr√ºher beispielsweise <b>8 Abrechnungskonten f√ºr 15 Millionen Abonnenten gegeben h√§tte</b> und jetzt <b>100 Millionen Abonnenten und mehr</b> h√§tten sich <b>herausstellen sollen</b> - die Last ist um eine Gr√∂√üenordnung h√∂her. <br><br><blockquote>  Wir sind vergleichbar mit gro√üen Internet-Playern wie Mail.ru oder Netflix. </blockquote><br>  Weitere Ma√ünahmen zur Erh√∂hung der Auslastung und der Abonnentenbasis stellten uns jedoch vor gro√üe Herausforderungen. <br><br><h3>  Die Geographie unseres riesigen Landes </h3><br>  Zwischen Kaliningrad und Wladiwostok <b>7500 km und 10 Zeitzonen</b> .  Die Lichtgeschwindigkeit ist endlich und bei solchen Verz√∂gerungsabst√§nden bereits signifikant.  150 ms auf den coolsten modernen optischen Kan√§len sind ein bisschen viel f√ºr die Echtzeitabrechnung, insbesondere wie es jetzt in der Telekommunikation in Russland der Fall ist.  Dar√ºber hinaus m√ºssen Sie an einem Werktag und mit unterschiedlichen Zeitzonen aktualisieren - dies ist ein Problem. <br><br>  Wir bieten nicht nur Dienstleistungen gegen eine monatliche Geb√ºhr an, wir haben komplexe Tarife, Pakete und verschiedene Modifikatoren.  Wir m√ºssen dem Teilnehmer nicht nur erlauben oder verbieten zu sprechen, sondern ihm auch eine bestimmte Quote geben - um Anrufe und Aktionen in Echtzeit zu berechnen, damit er es nicht bemerkt. <br><br><h3>  Fehlertoleranz </h3><br><blockquote>  Dies ist die Kehrseite der Zentralisierung. </blockquote><br>  Wenn wir alle Abonnenten in einem System sammeln, sind alle Notfallereignisse und Katastrophen f√ºr das Gesch√§ft katastrophal.  Daher gestalten wir das System so, dass die Auswirkungen von Unf√§llen auf die gesamte Teilnehmerbasis ausgeschlossen sind. <br><br>  Dies ist wiederum eine Folge der Ablehnung der vertikalen Skalierung.  Bei der horizontalen Skalierung haben wir die Anzahl der Server von Hunderten auf Tausende erh√∂ht.  Sie m√ºssen verwaltet und austauschbar sein, die IT-Infrastruktur automatisch sichern und das verteilte System wiederherstellen. <br><br>  Solche interessanten Herausforderungen standen uns gegen√ºber.  Wir haben das System entworfen und in diesem Moment versucht, die weltweit besten Praktiken zu finden, um zu √ºberpr√ºfen, wie sehr wir im Trend sind und wie viel wir fortschrittlichen Technologien folgen. <br><br><h2>  Welterfahrung </h2><br><blockquote>  √úberraschenderweise haben wir in der Welttelekommunikation keine einzige Referenz gefunden. </blockquote><br>  Europa sank um die Anzahl der Abonnenten und die Gr√∂√üenordnung, die Vereinigten Staaten - um die Ebene seiner Tarife.  Wir haben uns etwas in China angesehen, aber etwas in Indien gefunden und Spezialisten von Vodafone India mitgenommen. <br><br>  Zur Analyse der Architektur wurde das Dream Team unter der Leitung von IBM, Architekten aus verschiedenen Bereichen, zusammengestellt.  Diese Leute k√∂nnten angemessen bewerten, was wir tun, und bestimmte Kenntnisse in unsere Architektur einbringen. <br><br><h2>  Skalieren </h2><br>  Ein paar Zahlen zur Veranschaulichung. <br><br>  Wir entwickeln ein System f√ºr <b>80 Millionen Abonnenten mit einer Reserve von einer Milliarde</b> .  Also entfernen wir zuk√ºnftige Schwellenwerte.  Dies liegt nicht daran, dass wir China √ºbernehmen werden, sondern am Druck von IoT und M2M. <br><br>  <b>300 Millionen Dokumente werden in Echtzeit verarbeitet</b> .  Obwohl wir 80 Millionen Abonnenten haben, arbeiten wir mit potenziellen Kunden und denen, die uns verlassen haben, zusammen, wenn wir Forderungen einziehen m√ºssen.  Daher sind die realen Volumina viel gr√∂√üer. <br><br>  T√§glich √§ndern <b>2 Milliarden Transaktionen</b> den Kontostand - dies sind Zahlungen, Geb√ºhren, Anrufe und andere Ereignisse.  <b>200 TB Daten √§ndern sich aktiv</b> , <b>8 PB Daten</b> √§ndern sich etwas langsamer, und dies ist kein Archiv, sondern Live-Daten in einer einzigen Abrechnung.  Die Skalierung des Rechenzentrums umfasst <b>5.000 Server an 14 Standorten</b> . <br><br><h2>  Technologie-Stack </h2><br>  Als wir die Architektur planten und mit der Montage des Systems begannen, importierten wir die interessantesten und fortschrittlichsten Technologien.  Das Ergebnis war ein technologischer Stack, der jedem Internet-Player und Unternehmen, die hoch ausgelastete Systeme herstellen, vertraut ist. <br><br><img src="https://habrastorage.org/webt/cq/km/ys/cqkmyscpadcxt7nokj1_y_fwlny.jpeg"><br><br>  Der Stack √§hnelt den Stacks anderer Hauptakteure: Netflix, Twitter, Viber.  Es besteht aus 6 Komponenten, aber wir wollen es reduzieren und vereinheitlichen. <br><br><blockquote>  Flexibilit√§t ist gut, aber in einem gro√üen Unternehmen gibt es keinen Weg ohne Vereinigung. </blockquote><br>  Wir werden nicht dasselbe Oracle in Tarantool √§ndern.  In der Realit√§t gro√üer Unternehmen ist dies eine Utopie oder ein Kreuzzug f√ºr 5-10 Jahre mit einem unverst√§ndlichen Ergebnis.  Aber Cassandra und Couchbase k√∂nnen durch Tarantool ersetzt werden, und wir f√ºhlen uns dem verpflichtet. <br><br><h2>  Warum Tarantool? </h2><br>  Es gibt 4 einfache Kriterien, warum wir diese Datenbank ausgew√§hlt haben. <br><br>  <b>Geschwindigkeit</b> .  Wir haben Stresstests an MegaFon-Industriesystemen durchgef√ºhrt.  Tarantool gewann - es zeigte die beste Leistung. <br><br>  Dies bedeutet nicht, dass andere Systeme die Anforderungen von MegaFon nicht erf√ºllen.  Aktuelle Speicherl√∂sungen sind so produktiv, dass dieser Bestand des Unternehmens mehr als ausreichend ist.  Wir sind jedoch daran interessiert, mit dem Anf√ºhrer umzugehen, und nicht mit demjenigen, der den Schwanz einwebt, einschlie√ülich des Belastungstests. <br><br><blockquote>  Tarantool deckt auch langfristig die Bed√ºrfnisse des Unternehmens ab. </blockquote><br>  <b>TCO-Kosten</b> .  Die Unterst√ºtzung von Couchbase auf MegaFon-Volumes kostet Platz, mit Tarantool ist die Situation viel besser und in Bezug auf die Funktionalit√§t sind sie eng. <br><br>  Eine weitere nette Funktion, die unsere Wahl leicht beeinflusst hat - Tarantool funktioniert besser als andere Datenbanken mit Speicher.  Es zeigt <b>maximale Effizienz</b> . <br><br>  <b>Zuverl√§ssigkeit</b>  MegaFon investiert in Zuverl√§ssigkeit, wahrscheinlich wie kein anderer.  Als wir uns Tarantool anschauten, stellten wir fest, was zu tun ist, damit es unseren Anforderungen entspricht. <br><br>  Wir haben unsere Zeit und Finanzen investiert und zusammen mit Mail.ru eine Unternehmensversion erstellt, die jetzt von mehreren anderen Unternehmen verwendet wird. <br><br><blockquote>  Tarantool-Enterprise hat uns mit Sicherheit, Zuverl√§ssigkeit und Protokollierung voll zufrieden gestellt. </blockquote><br><h3>  Partnerschaft </h3><br>  Das Wichtigste f√ºr mich ist der <b>direkte Kontakt zum Entwickler</b> .  Genau das haben die Tarantool-Leute bestochen. <br><br>  Wenn Sie zu einem Spieler kommen, insbesondere zu einem, der mit einem Anker-Client arbeitet, und sagen, dass Sie die Datenbank ben√∂tigen, um dies, dies und das zu k√∂nnen, antwortet sie normalerweise: <br><br>  <i>- Nun, legen Sie die Anforderungen unter den Boden dieses Stapels - eines Tages werden wir sie wahrscheinlich erreichen.</i> <br><br>  Viele haben eine Roadmap f√ºr die n√§chsten 2-3 Jahre, und es ist fast unm√∂glich, sie dort zu integrieren, und Tarantool-Entwickler bestechen mit Offenheit und nicht nur mit MegaFon und passen ihr System an den Kunden an.  Das ist cool und wir m√∂gen es wirklich. <br><br><h2>  Wo haben wir Tarantool angewendet? </h2><br>  Bei uns wird Tarantool in mehreren Elementen verwendet.  <b>Der erste ist im Pilotprojekt</b> , das wir im Adressverzeichnissystem erstellt haben.  Fr√ºher wollte ich, dass es ein System ist, das Yandex.Maps und Google Maps √§hnelt, aber es stellte sich etwas anders heraus. <br><br>  Zum Beispiel das Adressverzeichnis in der Verkaufsschnittstelle.  Unter Oracle dauert das Finden der ben√∂tigten Adresse 12-13 Sekunden.  - unangenehme Zahlen.  Wenn wir zu Tarantool wechseln, Oracle durch eine andere Datenbank in der Konsole ersetzen und dieselbe Suche durchf√ºhren, erhalten wir eine 200-fache Beschleunigung!  Die Stadt taucht nach dem dritten Buchstaben auf.  Jetzt passen wir die Oberfl√§che so an, dass dies nach dem ersten geschieht.  Die Reaktionsgeschwindigkeit ist jedoch v√∂llig anders - bereits Millisekunden statt Sekunden. <br><br>  <b>Die zweite Anwendung ist ein Trendthema namens Two-Speed-IT</b> .  Dies liegt daran, dass Berater aus jedem Eisen sagen, dass Unternehmen dorthin gehen sollten. <br><br><img src="https://habrastorage.org/webt/3j/mb/oc/3jmboctdb2q3n6iwdlf1auvf_x0.jpeg"><br><br>  Es gibt eine Infrastrukturschicht, Dom√§nen dar√ºber, z. B. ein Abrechnungssystem wie Telekommunikation, Unternehmenssysteme und Unternehmensberichte.  Dies ist der Kern, der nicht ber√ºhrt werden muss.  Das ist nat√ºrlich m√∂glich, aber paranoid in der Bereitstellung von Qualit√§t, weil es dem Unternehmen Geld bringt. <br><br>  Als n√§chstes kommt die Schicht der Mikrodienste - die, die den Bediener oder einen anderen Spieler unterscheidet.  Auf der Grundlage bestimmter Caches k√∂nnen schnell Microservices erstellt werden, die Daten aus verschiedenen Dom√§nen abrufen.  Hier ist ein <b>Feld f√ºr Experimente</b> - wenn etwas nicht geklappt hat, einen Microservice geschlossen, einen anderen ge√∂ffnet.  Dies bietet eine wirklich verl√§ngerte Markteinf√ºhrungszeit und erh√∂ht die Zuverl√§ssigkeit und Geschwindigkeit des Unternehmens. <br><br><blockquote>  Microservices ist vielleicht die Hauptrolle von Tarantool in MegaFon. </blockquote><br><h2>  Wo wir Tarantool anwenden wollen </h2><br>  Wenn wir unser erfolgreiches Abrechnungsprojekt mit Transformationsprogrammen bei der Deutschen Telekom, Svyazkome, Vodafone India vergleichen, ist es √ºberraschend dynamisch und kreativ.  Bei der Implementierung dieses Projekts wurden nicht nur MegaFon und seine Struktur ver√§ndert, sondern auch Tarantool-Enterprise erschien bei Mail.ru, und unser Anbieter Nexign (ehemals Peter-Service) verf√ºgte √ºber eine BSS-Box (Boxed Billing Solution). <br><br>  In gewisser Hinsicht ist dies ein historisches Projekt f√ºr den russischen Markt.  Es kann mit dem verglichen werden, was im Buch von Frederick Brooks ‚ÄûMythical Man-Month‚Äú beschrieben ist.  In den 60er Jahren zog IBM 5.000 Mitarbeiter an, um ein neues OS / 360-Betriebssystem f√ºr Mainframes zu entwickeln.  Wir haben weniger als 1.800, aber unsere sind in Westen, und unter Ber√ºcksichtigung des Einsatzes von Open Source und neuer Ans√§tze arbeiten wir produktiver. <br><br>  Die Abrechnungsdom√§nen oder allgemeiner die Gesch√§ftssysteme werden unten angezeigt.  Mitarbeiter kennen CRM sehr gut.  Jeder sollte bereits andere Systeme haben: Open API, Gateway API. <br><br><img src="https://habrastorage.org/webt/lj/g1/ec/ljg1ecnbyprze3f4js1j7899h9e.jpeg"><br><br><h3>  API √∂ffnen </h3><br>  Schauen wir uns noch einmal die Zahlen an und wie die Open API jetzt funktioniert.  Die Last betr√§gt <b>10.000 Transaktionen pro Sekunde</b> .  Da wir planen, die Microservice-Schicht aktiv zu entwickeln und die √∂ffentliche MegaFon-API zu erstellen, erwarten wir in diesem speziellen Teil in Zukunft mehr Wachstum.  <b>100.000 Transaktionen werden definitiv sein</b> . <br><br>  Ich wei√ü nicht, ob das SSO mit Mail.ru vergleichbar ist - die Jungs haben beispielsweise 1.000.000 Transaktionen pro Sekunde.  Wir sind sehr an ihrer L√∂sung interessiert und planen, aus ihren Erfahrungen zu lernen - zum Beispiel, um mit Tarantool eine funktionierende SSO-Reserve zu bilden.  Jetzt machen Entwickler von Mail.ru dies mit uns. <br><br><h2>  CRM </h2><br>  CRM - das sind genau 80 Millionen Abonnenten, die wir auf eine Milliarde bringen m√∂chten, da es bereits 300 Millionen Dokumente gibt, die eine dreij√§hrige Geschichte enthalten.  Wir freuen uns sehr auf neue Dienste, und hier ist <b>der Wachstumspunkt vernetzte Dienste</b> .  Dies ist ein Ball, der wachsen wird, weil es immer mehr Dienste geben wird.  Dementsprechend wird eine Geschichte ben√∂tigt, √ºber die wir nicht stolpern wollen. <br><br>  Die Abrechnung in Bezug auf die Abrechnung und die Arbeit mit den Forderungen der Kunden wurde <b>in eine separate Dom√§ne umgewandelt</b> .  Um die Leistung zu maximieren, wird die <b>Architekturvorlage f√ºr</b> die <b>Dom√§nenarchitektur angewendet</b> . <br><br><blockquote>  Das System ist in Dom√§nen unterteilt, die Last wird verteilt und Fehlertoleranz bereitgestellt.  Zus√§tzlich haben wir mit verteilter Architektur gearbeitet. </blockquote><br>  Alles andere sind L√∂sungen auf Unternehmensebene.  Im Call Store - <b>2 Milliarden pro Tag</b> , 60 Milliarden pro Monat.  Manchmal muss man sie einen Monat lang und besser schnell nacherz√§hlen.  <b>Die Finanz√ºberwachung</b> ist genau die 300 Millionen, die st√§ndig wachsen und wachsen: Abonnenten wechseln h√§ufig zwischen Betreibern und erh√∂hen diesen Anteil. <br><br>  Die Telekommunikationskomponente der Mobilkommunikation ist die <b>Online-Abrechnung</b> .  Dies sind die Systeme, mit denen Sie anrufen oder nicht anrufen k√∂nnen, um in Echtzeit eine Entscheidung zu treffen.  Hier betr√§gt die Last 30.000 Transaktionen pro Sekunde. Angesichts des wachsenden Daten√ºbertragungsplans planen wir <b>250.000 Transaktionen</b> und sind daher sehr an Tarantool interessiert. <br><br>  Das vorherige Bild zeigt die Dom√§nen, in denen wir Tarantool verwenden werden.  CRM selbst ist nat√ºrlich breiter und wir werden es im Kern selbst anwenden. <br><br>  Unsere gesch√§tzte TTX von 100 Millionen Abonnenten verwirrt mich als Architekt - was ist, wenn 101 Millionen?  Alles noch einmal wiederholen?  Um dies zu verhindern, verwenden wir Caches und erh√∂hen gleichzeitig die Zug√§nglichkeit. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/167/a80/b0e/167a80b0e38db7f135407b097284a3ff.jpg"><br><br>  Im Allgemeinen gibt es zwei Ans√§tze zur Verwendung von Tarantool.  Der erste besteht <b>darin, alle Caches auf der Microservice-Ebene zu erstellen</b> .  Soweit ich wei√ü, folgt VimpelCom diesem Pfad und erstellt einen Client-Cache. <br><br>  Wir sind weniger abh√§ngig von Anbietern, wir √§ndern den Kern von BSS, sodass wir sofort eine einzige Client-Kartei haben.  Aber wir wollen es sticken.  Daher verwenden wir einen etwas anderen Ansatz - <b>wir erstellen Caches innerhalb der Systeme</b> . <br><br><blockquote>  Es gibt also weniger als einen Rassynchron - ein System ist sowohl f√ºr einen Cache als auch f√ºr die Hauptmasterquelle verantwortlich. </blockquote><br>  Das Verfahren passt gut zum Tarantool-Transaktionsskelett-Ansatz, wenn nur Teile aktualisiert werden, die sich auf Aktualisierungen beziehen, d. H. Daten√§nderungen.  Alles andere kann woanders aufbewahrt werden.  Es gibt keinen riesigen Datensee, keinen nicht verwalteten globalen Cache.  Caches sind f√ºr das System konzipiert, entweder f√ºr Produkte oder f√ºr Kunden, oder um dem Service das Leben zu erleichtern.  Wenn ein Abonnent aufgrund seiner Qualit√§t ver√§rgert anruft, m√∂chte ich ihn qualitativ bedienen. <br><br><h2>  RTO und RPO </h2><br>  Es gibt zwei Begriffe in IT - <b>RTO</b> und <b>RPO</b> . <br><br>  <b>Das Ziel</b> der <b>Wiederherstellungszeit</b> ist die Zeit, um einen Dienst nach einem Fehler wiederherzustellen.  RTO = 0 bedeutet, dass der Dienst auch dann weiter funktioniert, wenn etwas herunterf√§llt. <br><br>  <b>Ziel</b> des <b>Wiederherstellungspunkts</b> ist die Zeit f√ºr die Wiederherstellung von Daten, wie viele Daten wir √ºber einen bestimmten Zeitraum verlieren k√∂nnen.  RPO = 0 bedeutet, dass wir keine Daten verlieren. <br><br><h2>  Tarantool Herausforderung </h2><br>  Versuchen wir, das Problem f√ºr Tarantool zu l√∂sen. <br><br>  <b>Gegeben</b> : Jeder versteht den Anwendungskorb, zum Beispiel bei Amazon oder anderswo.  <b>Der</b> Korb <b>muss</b> 24 Stunden, 7 Tage die Woche oder 99,99% der Zeit arbeiten.  Bestellungen, die bei uns eingehen, m√ºssen in Ordnung bleiben, da wir die Kommunikation f√ºr den Abonnenten nicht zuf√§llig aktivieren oder deaktivieren k√∂nnen - alles muss streng konsistent sein.  Das vorherige Abonnement wirkt sich auf das n√§chste aus, daher sind die Daten wichtig - nichts sollte verloren gehen. <br><br>  <b>L√∂sung</b> .  Sie k√∂nnen versuchen, es direkt zu l√∂sen und die Entwickler der Datenbank fragen, aber das Problem ist mathematisch nicht gel√∂st.  Man kann sich an Theoreme, Erhaltungss√§tze, Quantenphysik erinnern, aber warum - es kann nicht auf DB-Ebene gel√∂st werden. <br><br>  Der gute alte architektonische Ansatz funktioniert hier - Sie m√ºssen den Themenbereich gut kennen und auf seine Kosten diesen Rebus l√∂sen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/944/6e3/d25/9446e3d25815306bbe9dce45df4350ab.jpg"><br><br>  <b>Unsere L√∂sung: Erstellen Sie ein verteiltes Anwendungsregister f√ºr Tarantool - einen geoverteilten Cluster</b> .  In der Abbildung sind dies drei verschiedene Rechenzentren - zwei f√ºr den Ural und eines f√ºr den Ural. Wir verteilen alle Anwendungen an diese Zentren. <br><br>  Netflix, das heute als einer der f√ºhrenden IT-Anbieter gilt, verf√ºgte bis 2012 nur √ºber ein Rechenzentrum.  Am Vorabend der katholischen Weihnacht am 24. Dezember fiel dieses Rechenzentrum aus.  Benutzer von Kanada und den Vereinigten Staaten blieben ohne ihre Lieblingsfilme, sehr ver√§rgert und schrieben dar√ºber in sozialen Netzwerken.  Netflix verf√ºgt nun √ºber drei Rechenzentren an der Westostk√ºste und eines in Westeuropa. <br><br><blockquote>  Wir bauen zun√§chst eine geoverteilte L√∂sung - Fehlertoleranz ist uns wichtig. </blockquote><br>  Wir haben also einen Cluster, aber was ist mit RPO = 0 und RTO = 0?  Die L√∂sung ist einfach, was vom Thema abh√§ngt. <br><br>  Was ist bei Anwendungen wichtig?  Zwei Teile: Werfen Sie den Korb, <b>bevor Sie</b> eine Kaufentscheidung treffen, und danach.  Ein Teil von DO in einer Telekommunikation wird normalerweise als <b>Auftragserfassung</b> oder <b>Auftragsverhandlung bezeichnet</b> .  In der Telekommunikation kann dies viel komplizierter sein als im Online-Shop, da Sie dort den Kunden bedienen, 5 Optionen anbieten m√ºssen, und dies alles geschieht f√ºr eine Weile, aber der Warenkorb ist voll.  Zu diesem Zeitpunkt ist ein Fehler m√∂glich, aber nicht be√§ngstigend, da er in einem interaktiven Modus unter der Aufsicht einer Person auftritt. <br><br>  Wenn das Moskauer Rechenzentrum pl√∂tzlich ausf√§llt und automatisch zu einem anderen Rechenzentrum wechselt, werden wir weiterarbeiten.  Theoretisch kann ein Produkt in einem Warenkorb verloren gehen, aber Sie sehen dies, erg√§nzen den Warenkorb erneut und arbeiten weiter.  In diesem Fall ist RTO = 0. <br><br>  Gleichzeitig gibt es eine zweite Option: Wenn wir auf "Senden" geklickt haben, m√∂chten wir, dass die Daten nicht verloren gehen.  Ab diesem Moment beginnt die Automatisierung zu funktionieren - dies ist bereits RPO = 0. Die Anwendung dieser beiden unterschiedlichen Muster kann in einem Fall nur ein geoverteilter Cluster mit einem umschaltbaren Master sein, in dem anderen Fall eine Art Quorumeintrag.  Muster k√∂nnen variieren, aber wir l√∂sen das Problem. <br><br>  Mit einem verteilten Anwendungsregister k√∂nnen wir auch alles skalieren - um viele Disponenten und Auftragnehmer zu haben, die auf dieses Register zugreifen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28f/ab6/da3/28fab6da317b89510738c9b2497fe529.jpg"><br><br><h2>  Cassandra und Tarantool zusammen </h2><br>  Es gibt noch einen anderen Fall - das <b>"Schaufenster der Waagen".</b>  Hier ist nur ein interessanter Fall der gemeinsamen Verwendung von Cassandra und Tarantool. <br><br>  Wir verwenden Cassandra, weil 2 Milliarden Anrufe pro Tag nicht das Limit sind und es mehr geben wird.  Vermarkter lieben es, den Verkehr nach Quellen zu f√§rben. In sozialen Netzwerken gibt es zum Beispiel immer mehr Details.  Dies alles erh√∂ht die Geschichte. <br><br><blockquote>  Mit Cassandra k√∂nnen Sie horizontal auf jedes Volumen skalieren. </blockquote><br>  Wir f√ºhlen uns wohl mit Cassandra, aber sie hat ein Problem - sie kann nicht gut lesen.    , 30 000     ‚Äî <b>  </b> . <br><br>     ,      :    ,      -   ,     Cassandra.        ,     IBM manager file transfer ‚Äî   ,     ,   UDP, ,   TCP.  ,    ,       ,   -    ,       ‚Äî  . <br><br>    ,  <b>   </b> .      Kafka  Tarantool,     , ,  ,   <b> </b> ,       , , 100        2 . <br><br>   ,       2         ,    ,   . <br><br><h2>  Fazit </h2><br>     Tarantool.     Mail.ru,     . <br><br>   BCG  McKinsey, Accenture  IBM     -  ‚Äî   ,   ,    ,  ,   . ,  Tarantool             .       . <br><br><blockquote>     ‚Äî     Tarantool Conference  ,   17      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">T+ Conference 2019</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">¬´ Tarantool  Enterprise¬ª</a> .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">¬´ Tarantool    Oracle¬ª</a> . ,  ,    .  ‚Äî  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>    :  ,    Tarantool, , ,   . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de455694/">https://habr.com/ru/post/de455694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de455678/index.html">Auf dem Weg von Sergej Pawlowitsch Korolev. Modernes russisches bemanntes Projekt. Teil 1. "F√∂deration"</a></li>
<li><a href="../de455682/index.html">Wie viel geben Sie f√ºr die Infrastruktur aus? Und wie kann man das sparen?</a></li>
<li><a href="../de455684/index.html">Warum haben wir einen Hackathon f√ºr Tester durchgef√ºhrt?</a></li>
<li><a href="../de455686/index.html">Wie w√§hle ich das beste Projektmanagement-Tool aus, wenn Sie ein Millennial sind?</a></li>
<li><a href="../de455692/index.html">ASZP: Restyling oder Theater beginnen mit einem Kleiderb√ºgel</a></li>
<li><a href="../de455696/index.html">Der elektronische Zustand der Zukunft. Teil 2</a></li>
<li><a href="../de455698/index.html">Das Buch "Wie JavaScript funktioniert"</a></li>
<li><a href="../de455700/index.html">4 Tricks, die uns geholfen haben, das Frontend zu optimieren</a></li>
<li><a href="../de455702/index.html">Effektive Zahlengenerierung in einem bestimmten Intervall</a></li>
<li><a href="../de455710/index.html">Warum brauchen wir bei Leroy Merlin eine eigene russische Entwicklungsabteilung f√ºr 200 Mitarbeiter?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>