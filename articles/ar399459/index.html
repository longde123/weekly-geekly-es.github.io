<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ค ๐ผ๐ผ ูุนุจุฉ ูุฑู ูุญูุงูุฉ ุถุฏ ุงูุชุณุฑุจ ๐ท ๐จโ๐จ ๐ก</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชุญูุฉ ุทูุจุฉ. ููุงู ุดูุก ูู ูุฐุง ุงููุจูู - hydrolock \ neptune \ avkvastorozh - ุฃูุธูุฉ ุฅุบูุงู ุงูููุงู ุฅุฐุง ุญุฏุซ ุชุณุฑุจ ุบูุฑ ูุญููู. ุงููุจุฏุฃ ุจุณูุท - ูุณุชุดุนุฑ ููุงู + ุฃุชูุชุฉ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุนุจุฉ ูุฑู ูุญูุงูุฉ ุถุฏ ุงูุชุณุฑุจ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/399459/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูุฉ ุทูุจุฉ. ููุงู ุดูุก ูู ูุฐุง ุงููุจูู - hydrolock \ neptune \ avkvastorozh - ุฃูุธูุฉ ุฅุบูุงู ุงูููุงู ุฅุฐุง ุญุฏุซ ุชุณุฑุจ ุบูุฑ ูุญููู. ุงููุจุฏุฃ ุจุณูุท - ูุณุชุดุนุฑ ููุงู + ุฃุชูุชุฉ + ุฒูุฌ ูู ุงูุตูุงุจูุฑ ุงูููุฑุจุงุฆูุฉ. ููู ุงูุดูุทุงู ุ ูุงูุนุงุฏุฉ ุ ูููู ูู ุงูุชูุงุตูู: ููู ูุชู ุชุฑุชูุจ ุงูุตูุงุจูุฑ ุ ูููููุฉ ุชุฑุชูุจ ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุงูุชุณุฑุจ ุ ูููุงุฐุง ูููู ุฃุญุฏููุง 50 ุฑูุจู ูุงูุขุฎุฑ ูููู 500 ุฑูุจู. ุณูุชู ูู ููููุบุฑุงู ูู ูุดุฑุฉ ุงูุชุฎุทูุท ุญูู ูุฐุง ุงูุฃูุฑ ุจุงููุงูู ุ ูุณูู ุชุฒูู ุงูุนุจูุฉ ุนูููู ุ ููุง ุฅูู ุฐูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุตุฉ ุณูู ุฃุณูุฑ ูู ุทูุจ ุงููุธุงู ุ ุงูุฐู ูุงุฏูู ูู ุงูุงุฎุชูุงุฑ. ุชู ุจูุงุก ุงููุธุงู ุจุงููุงูู ุนูู ูุณุชุดุนุฑุงุช ุงููุตูุน ููุญุฏุฉ ุชุญูู ูุญููุฉ ุงูุตูุน ุชุนุชูุฏ ุนูู ุงูุฌุณููุงุช (ูุซู Spark) ุงูููุชูู (ูุซู esp8266 ุงูุฐู ูุญุชูู ุนูู ุณุญุงุจุฉ IDE ุนูู ุงูุฃุณูุงู ุฎุงุฑุฌ ุงูุตูุฏูู) ุ ููุงุนุฏุฉ ุงูุฌูุงุฒ ูู ูุญุฏุฉ ุชุญูู stm + wifi ูู Broadcom. ูู ูุฐุง ูุฑุชุจุท ุจุฎุงุฏู ููุชูุญ ุนูู Orange Pi One.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/715/6ee/aa2/7156eeaa28b44479a5d5aff2e63ff89c.png" width="600"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุฐุง ูุง ููุชูู ูุธุงูุ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - ูุฃููู ุฃุณุชุทูุน ุงูููุงู ุจุฐูู ุจููุณู ููู ูุฑุชูุน </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - ุงูุชูุงูู ูุน ุงูุฃูุธูุฉ ุงูุฎุงุฑุฌูุฉ ุนุฑุฌุงุก ูู ุงูุฃูุธูุฉ ุงูุฌุงูุฒุฉ. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - ูุง ุชุญุชูู ุงูุฃูุธูุฉ ุงูุฌุงูุฒุฉ ุนูู ูุธุงุฆู ูุณุงุนุฏุฉ - ูุน ูุฑุงุนุงุฉ ูุฑุงุกุงุช ุงูุนุฏุงุฏุงุช ุ ูุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงู ุ ูุงูุฅุจูุงุบ ุนู ุงููุทุงุน ุงูููุงู ูุบูุฑูุง ูู ุงูุฃููุงู ุงููุซูุฑุฉ ูููุดู.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุจุฏุฃ ุจุงูุฑุงูุนุงุช</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุฎุชุงุฑ ุจุบุจุงุก ูู ุงูุฌุจูุฉ ูู ุญูุซ ุนุฒู ุงูุฏูุฑุงู. ูุจุนุถ ุงูููุช ุนุงุด ูู ุงูุถูุงุญู ุ ุญูุซ ุชุฑูุช ููุนูุฉ ุงูููุงู (ููุง ูู ุงูุญุงู ูู ูู ููุงู ูู ุฒุงููุงุฏู) ุงููุซูุฑ ููุง ูู ูุฑุบูุจ ููู. ูุฐุง ูุฅู ุงูุตูุงูุงุช ุงููุฑููุฉ 1/2 ุจูุตุฉ ุฅุฐุง ูู ุชููุณ ุงูุณูุฉ - ููู ุงูุตุนุจ ุฌุฏูุง ุชุฏููุฑูุง. ูุนูู ุณูุฉ ุงูููุงุดู ุงููุณุฎูุฉ ุจููุงุณ 1 ุจูุตุฉ ุ ูุง ุฃุญุงูู ุญุชู ุชุญุฑูููุง - ุฅูุง ุฅุฐุง ููุช ุจุชูููุฉ ุงููุชู ุจููุชุงุญ ุ ูููู ููุง ููููู ุชูุฒูู ุดูุก ูุง. ุชููู ุงููุดููุฉ ูู ุฑูุงุณุจ ุฎุดุจ ุงููุงูุณููู ุงูุตูุจ "ุงููุชุถุฎู" ุจูููุฉ ูุงุญุฏุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุง ูุฐูู ุ ููุน ุงูุงุฎุชูุงุฑ ุนูู ุงูุณูุณูุฉ ุงูุงุญุชุฑุงููุฉ ูู hydrolock - 21N * m ูู ุนุฒู ุงูุฏูุฑุงู ูุง ูุจุฏู ูุซู ุงูุซุฑุซุฑุฉ ุงูุฅุนูุงููุฉ ุ ูุฅู ุงูุฑุงูุนุฉ ุถุฎูุฉ ุจุจุณุงุทุฉ - ูู ุจุชูููู ููุงู ุชุฑููุจูุง ูุจู ุงูุดุฑุงุก. </font></font><br>
<br>
<img src="https://habrastorage.org/files/758/e07/18c/758e0718cc9a46e09306bac214db8cf1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุตูุจูุฑ ูุฎุชูู ุ ูุฎุชู ูุทุงุทู ุญูู ุงููุญูุท ุ ูุงููุฏุฎู ุชุญุช ุงูุบุฏุฉ ุงููููุจูุฉ. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฒุน ุงูุบุทุงุก.</font></font><br>
<br>
<img src="https://habrastorage.org/files/f9d/aa4/a25/f9daa4a251e140c3bbe4b049a5af7f46.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุงููุง ูู ุงูุฌุฒุก ุงูุนููู ูู ุงูููุญุฉ ููุญุฑู ุงูุณุงุฆุฑ. ูู ูุฐุง ูุนูู ุจููุฉ 12 ูููุช. ูุคุฏู ุชูุตูุฑ ูุจู ุงูุชุญูู ุฅูู ุงูุฃุฑุถ ุฅูู ูุถุน ุงูุตูุงู ูู ูุถุน ุงูุฅุบูุงู. ุนูู ุงูููุญุฉ ูุฑู ูุญุฏุฉ ุชุญูู PIC 12f629 ุจุณูุทุฉ. ุนุงุด ุ ุชุญูู ูู ูุญุฑู ุงูุฑุงูุนุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฌุฒุก ุงูุฎููู ูู ุงูููุญุฉ ูู ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู. </font></font><br>
<br>
<img src="https://habrastorage.org/files/c14/e08/f2e/c14e08f2e4224088a534e1811fa3729a.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L293 ุณุงุฆู ููุถุฎู ุถูุฆู (ุจุงุนุซ + ูุงุดู ุถูุฆู). ุชูุธุฑ ุฅูู ุงูุชุฑุณ ุงูุฑุฆูุณู ููุญุฑู ุงูุฃูุฑุงุต ุ ูุงูุฐู ูุชู ุฑุณูู ูู ุฃุฌุฒุงุก - ุฃุจูุถ ูุฃุณูุฏ ุ ูุบูู / ููุชูุญ. </font></font><br>
<br>
<img src="https://habrastorage.org/files/a14/cec/177/a14cec1771ef4d52bc15c83e9183124e.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฏูุฑ ุงูุฑุงูุนุฉ ุทูุงู ุงูููุช ูู ุงุชุฌุงู ูุงุญุฏ ุ ููุทู ุงูุชุญูู ุจุณูุท - ูููู ุจูู ุงูุนููุฏ ุญุชู ููุชูู ุฅูู ุงูููู ุงููุทููุจ. ูููู ุฏูุฑุงู ุงูุฑุงูุนุฉ ูู ุงุชุฌุงู ูุงุญุฏ ุฃูู ุชุขูููุง ุ ููู ุบูุฑ ุงููุญุชูู ุฃู ุชุคุฏู ุทุฑููุฉ ุนุฏู ุงูุงุชุตุงู ูุชุญุฏูุฏ ุงููุถุน ุฅูู ุชุนูุฑ / ุนุทู ุงูููุงูู ุงูููุงูู ุฃู ููุชุงุญ ุงูุญุฏ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุซุจูุช ุ ููููู ูู ุงูุฑุงูุนุฉ ูู ูุญุฑู ุงูุฃูุฑุงุต - ูุชู ุชุนููููุง ุนูู ุตูุงููู. ููุฌุฏ ุญุดูุฉ ุนุงุฒูุฉ ููุญุฑุงุฑุฉ ุจูู ุงููุญุฑู ูุงูุฑุงูุนุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/files/bf7/37c/1f7/bf737c1f7a144c72baba7a17fdc94615.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุญุตูุช ุนูู ุงูุฅุตูุงุญ ูุจู ุนุงู ููุตู. ุชู ุดุฑุงุก ุงูุฑุงูุนุฉ ูุจู ุซูุงุซ ุณููุงุช - ูุชูููููุง ุ ูุงููุธุฑ ูู ุงูุฏุงุฎู ุ ูุดุฑุงุก ุงููุฒูุฏ ููููุง ุฃุซูุงุก ุงูุฅุตูุงุญ. ูุนู ุ ุงูุขู ... ุงูุญุฏ ุงูุฃูุตู ุงูุฐู ุชูููุช ููู ูู ูุฐุง ุงูุณูุฑู ุงูุฌูููู ูุงู ูุถุน ุฌุงูุน ุชุฑุงุจู ูู ุชุฌููุน ุฅูุฏุงุฏุงุช ุงูููุงู ูุน ุงุญุชูุงู ุงุณุชุจุฏุงูู ุจุฑุงูุนุฉ. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุท ุจุนุฏ ุนุงู ููุตู - ุงุดุชุฑูุช ุฑุงูุนุฉ ุซุงููุฉ ูุฃุซููุชูุง.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชูุฌุฉ ูุฐูู ุ ููุงุญุธ ุธุงูุฑุฉ ุบุฑูุจุฉ ููุงุฏุฑุฉ (ุชูุช ูุฑุงุกุชูุง ุจุตูุช Drozdov) - ุชู ุชุฃููุฏ ุฌููุน ุงููุนูููุงุช ูู ูููุน ุงูุดุฑูุฉ ุงููุตูุนุฉ. ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ุงููุตู ุบุฑูุจ ุ ููุง ูู ุฃู ุงูุชููููู ูุชุจูุง ุ ุซู ุชู ุชุณููู ุงูุชุณููู ูููุงุณ ุ ููู ูุง ูุฒุงู ุนุฏุฏ ูููู ูู ุงููุงุณ ูููููู ุฌููุน ุงูุฑูุงุฆู. ูุง ููุฌุฏ ูุณู ูุงูู ูู ุงููููุน - ูููุชูุงูููู ูุน ุงูุชูุงุตูู ุงูุชูููุฉ ุจุงูุฏุงุฎู. ุญุชู ุนูู ุญุณุงุจ ุฒูุงุฏุฉ ุนุฒู ุงูุฏูุฑุงู ุ ูู ูุณุชูููุง ูู ุงูุจุฏุงูุฉ - ูุงูุฑุงูุนุฉ ูู ุงูุจุฏุงูุฉ ุชููุฌุฑ ุจูุญุฑู 1.5 ุฃูุจูุฑ ูุจุนุฏ 2-3 ุซูุงูู ุชุจุฏุฃ ูู ุงูุตุนูุฏ ูู ุงููุถุน ุงูุนุงุฏู (ุงูุญุงูู 0.7 ุฃูุจูุฑ). ูุณุชุบุฑู ุญูุงูู 25-30 ุซุงููุฉ ููุฅุบูุงู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฌุฑุจุฉ ุฃุฎุฑู: ุนูู ุญุณุงุจ ุนุฒู ุงูุฏูุฑุงู - ุฅููุง ููุฑุทุฉ ูููุช ููุณูู ุ ููุง ุงููุงุก ุฌูุฏ ุชูุงููุง ุ ููุฏุฉ ุนุงู ููุตู ูู ููุชุฑ 100 ูููุฑููุชุฑ ููุฌุฏ ุฒูุฌ ูู ุงูุฎุจุซ ููุง ููุฌุฏ ููู ุฒุงุฆุฏ. </font><font style="vertical-align: inherit;">ุนููู ุฏูุน ุนุฒู ุงูุฏูุฑุงู ุงููุจูุฑ ูุน ุงูุณุนุฑ ูููุช ุงูุงูุชุชุงุญ ูุงูููุงู ูู ุงูุฎุฒุงูุฉ. </font><font style="vertical-align: inherit;">ุฃุนุชูุฏ ุฃูู ุณูููู ููุงู ูุง ูููู ูู ูุญุฑูุงุช ุงูุฃูุฑุงุต ุงูุชูููุฏูุฉ ูู Hydrolock Ultimate ุฃู Neptune ุฃู Aquastorozh. </font><font style="vertical-align: inherit;">ูุง ูููููู ุฃู ุฃุดูุฏ ุนูู ุงูุฃุฎูุฑูู - ูู ุฃูู ุจุฐูู ุ ููุฐ ุญูุงูู 5 ุณููุงุช ูุงู ูุฏููู ุชุฑูุณ ุจูุงุณุชูููุฉ ุฌุฒุฆููุง ุ ุงูุขู ูุจุฏู ุฃููู ูุฏ ุฃุตูุญูุง ุฐูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุฃูุถูุง ููุฏุฑูููู ูููุฑ ูุน ุงุชุตุงู ูุจุงุดุฑ ุจุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุจูุญุฑู ุงูุฃูุฑุงุต - ูุฐุง ุฅุฐุง ููุช ูุง ุชุญุชุงุฌ ุฅูู ูู ูุง ููุช ุจู. </font><font style="vertical-align: inherit;">ููุงู ุ ุงูุทุงูุฉ ูุณุชููุฉ ูู 4 ุจุทุงุฑูุงุช ุ ูุงููุงุนุฏุฉ ุชุดุจู ูุญุฑู ุงูุฃูุฑุงุต ุงูููุงุฆู. </font><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ูู ุงููุญุชูู ุฃูุถูุง ุฃู ุชููู ูุซูุฑุฉ ููุงูุชูุงู ููุญุฏุฉ ุชุญูู ุฐุงุชูุฉ ุงูุตูุน - ุฅููุง 5 ูููุช ุ ูุง ุชุญุชุงุฌ ุฅูู ูุถุน ุญุงููุชูู ุนูู 5 ู 12 ูููุช ูููููู ุงูุชุฎูุต ูู ุงูุนุฒู ุงูุจุตุฑู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุงูุชุณุฑุจ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุดุชุฑูุช ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ูู ููุณ ุนุฏุงุฏ WSU - ุนุงููู. </font><font style="vertical-align: inherit;">ูุฏููู ููุงุชุฌ "ูุฌููุน ููุชูุญ" ุ ูุงุญุฏ ูุณุญุจ ุฅูู ุงูุฃุฑุถ ููุท ุฅุฐุง ูุงู ููุงู ูุงุก ุ ูุงูุซุงูู - ุฅุฐุง ุฏุฎู ุงููุงุก ุ ูุฅูู ูุณุญุจ ุฅูู ุงูุฃุฑุถ ุทูุงู ุงูููุช ุญุชู ูุชู ูุทุน ุงูุทุงูุฉ. </font><font style="vertical-align: inherit;">ุฃุณุชุฎุฏู ุงููุฎุฑุฌ ุงูุฃูู ููุท ุ ูุจููุฉ ุงูููุทู ููุฌูุฏ ูู ูุญุฏุฉ ุงูุชุญูู ุ ูููู ูุจุฏู ุฃู ูุฐุง ุงูุฅุฎุฑุงุฌ ูููู ุฃู ูููู ูููุฏูุง ูุจุนุถ ุฃูุธูุฉ ุฅุฑุณุงู ุงููุฒูุฏ ูู ุงููุญุฏุงุช ุงูุณูููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฃุณูุงู ูู ุงูุนุฏุฉ ุซูุงุซุฉ ุฃูุชุงุฑ ูู ููุงู ูุง. </font><font style="vertical-align: inherit;">ููู ุงูุฃุณูุงู Ad_i_Asrael ุฅุณุฑุงุฆูู. </font><font style="vertical-align: inherit;">ุชุญูู ูู ุงูุงูุชุจุงุณ:</font></font><br>
<br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูู ุฃุญูุฑ (ุจูู) (Vcc) ูุฏุนูู ูู +5 ุฅูู +30 ูููุช. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูู ุฃุณูุฏ (ุฃุจูุถ) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(OUT2) ุณูู ุฃุฎุถุฑ (OUT1) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูู ุฃุตูุฑ (GND)</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅููู ูุง ููุน ุตูุน ุงูุฃุฑุถ ุงูุจูุถุงุก / ุงูุณูุฏุงุกุ </font><font style="vertical-align: inherit;">ุนูู ูุญุฑู ุงูุฑุงูุนุฉ ุ ุจุงูููุงุณุจุฉ ุ ุงูุฃุณูุงู ุงูููููุฉ ูุน ุงูููุทู ููุณุช ูุฒุนุฌุฉ. </font><font style="vertical-align: inherit;">ููุฌุฏ ุงููุณุชุดุนุฑ ุงูุฃูู ูู ุงููุทุจุฎ ุ ุฃุณูู ุงูุญูุถ ุจุฌูุงุฑ ุบุณุงูุฉ ุงูุฃุทุจุงู. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2ea/407/a25/2ea407a255b8420e9b1d6c26772e2709.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุซุงูู ูู ุงูุญูุงู ูู ุฎูุฏู ุชุตุฑูู ุฎุงุต. </font><font style="vertical-align: inherit;">ุนูุฏูุง ูุนู ุฐุฑุงุน ุงูุชุณููุฉ ุ ูู ูุฃุช ุจูุง ุฅูู ุงูุญุงุฆุท. </font><font style="vertical-align: inherit;">ููุงูุช ุงููุชูุฌุฉ ููุนูุง ูู ุญูุถ ูุฌูุน ุงูููุงู ูู ุงูุญูุงู ูุงููุฑุญุงุถ. </font></font><br>
<br>
<img src="https://habrastorage.org/files/51d/715/898/51d71589848d4a77a59f8caf0dbf2041.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุชุฌุฑุจุฉ ุงูุชุดุบูู - ูุงู ููุงู ุจุงููุนู ุฅูุฐุงุฑ ูุงุฐุจ ูุงุญุฏ ูุฌูุงุฒ ุงูุงุณุชุดุนุงุฑ ูู ุบุณุงูุฉ ุงูุตุญูู. </font><font style="vertical-align: inherit;">ุฅุฐุง ุญูููุง ูู ุฎูุงู ุงูุณุฌู ูุฏูุฑุฉ ุงูุชุฑุงุน ูุงุญุฏุฉ (500 ูููู ุซุงููุฉ) ุ ูุงูุช ููุงู ุฏุงุฆุฑุฉ ุ ุนุฏููุช ุงูุดูุฑุฉ - ูุญุฏุซ ุชุบููุฑ ุงูุญุงูุฉ ุงูุขู ุนูุฏ 10 ููู ูุชุทุงุจูุฉ ูุชุชุงููุฉ ูู ุงููุณุชุดุนุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงูุณุงุช ุงููุณุชุดุนุฑ ูุทููุฉ ุจุงูุฐูุจ. </font><font style="vertical-align: inherit;">ูุฏู ุตุฏูู ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ููุงุซูุฉ ูุนุฏุฉ ุณููุงุช ุ ูู ููุงุญุธ ุฃู ุฃูุณุฏุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุงูุถุบุท</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูููุง - ููุงููุณ ุงูุนุฑุถ. </font><font style="vertical-align: inherit;">ุงูุฏูุฉ + - 0.5 ุตุฑุงู ุขูู ููุงุณุจูู ุชูุงููุง. </font><font style="vertical-align: inherit;">ุจูุงุกู ุนูู ุงููุณุชุดุนุฑุงุช ุ ูุฃุชู ุชูุจูู ุฅููุงู ุชุดุบูู ุงูููุงู. </font><font style="vertical-align: inherit;">ุงุดุชุฑูุช ุนูู ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุงุฐุง ูุง ุชุถููุ </font><font style="vertical-align: inherit;">ูู ุงููููุฏ - ุณูููู ูุงุฏุฑูุง ูุฑุฉ ูุงุญุฏุฉ ูู ุงูุณูุฉ ุนูู ุงูุฅุจูุงุบ ุนู ุฅุบูุงู ุงููุงุก ุงูุณุงุฎู. </font><font style="vertical-align: inherit;">ุชุณุชุฎุฏู ุนุงุฏูุง ds18b20.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฏุงุฏุงุช</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itelma ุงูุฃูุซุฑ ุดููุนุง ุ ูุฑุฉ ูุงุญุฏุฉ ูู 10 ูุชุฑุงุช ุงูุงุชุตุงู. </font><font style="vertical-align: inherit;">ุนูู ุฌุงูุจ ูุญุฏุฉ ุงูุชุญูู ุ ูุชู ุณุญุจ ุงูุฅุฎุฑุงุฌ ุญุชู + 3.3 ูููุช ุ ููุณุญุจู ุงูุนุฏุงุฏ ุฅูู ุงูุฃุฑุถ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูู</font></font></h3><br>
<img src="https://habrastorage.org/files/318/4e6/d7a/3184e6d7ad9c4eab99d9962410c7918c.jpg"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุฏุงุฎู</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/a83/72d/117/a8372d1170ca43f8b92925fa76a240f8.jpg"><br>
<img src="https://habrastorage.org/files/f7b/e62/ee8/f7be62ee80a54ff2a0ed60ad17467a8b.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุณุชูุงุฏุงู ุฅูู ุงูุฌุณููุงุช ุงูููุชูู ุ ูุฒูุฏ ูู ุงูุชูุงุตูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูุฏููู ูุณุฎุฉ ูุน ูุญุฏุฉ 2G ุฃู 3G (ุฅููุชุฑูู). ูุงูุช ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุงูุฃููู ุนุจุงุฑุฉ ุนู ุฎุจุซ ูุงูู ุ ูุงูุถ ูุน ุงูุซูุงุฆูุงุช OK ุ ูููู ุจูุฌุฑุฏ ุฃู ุชุจุฏุฃ ุงูููุงูู ุงููุนูุฏุฉ ูุงููุถุบ ุ ูููู ุฃู ูุคุฏู ุงููุนุจ ูุน i2c ูุงูููุงุทุนุงุช ุฅูู ููุฏุงู wifi. ุงูุขู ููููู ุงูุนูุด. ูู ุญูุซ ุงููุจุฏุฃ ุ ููููู ุทุฑุฏ ูุณุชุดุนุฑุงุช ุงูุถุบุท ุฎุงุฑุฌ ุงูุฏุงุฆุฑุฉ ูุชุญุฑูู ูู ุดูุก ุนูู ESP8266 - ุงุฐูุจ ุฅููู. ุฃููุงู ุ ูุญุชุงุฌ ุงูููุชูู ุฅูู ุฑุจุท ุญุณุงุจ ุงูุฌุณููุงุช (ูุชู ูู ุฎูุงู ุงูุชุทุจูู ุนูู ุงููุงุชู ุงููุญููู ุฃู ูู ุฎูุงู ูุญุฏุฉ ุงูุชุญูู Particle CLI - ุฃุณุชุฎุฏู ุงูุทุฑููุฉ ุงูุซุงููุฉ ููุท) ูุชุณุฌูู ุดุจูุฉ wifi. ุจุนุฏ ุงูุฑุจุท ุ </font><font style="vertical-align: inherit;">ูุธูุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูุณู ุงูุฌูุงุฒ ูุญุฏุฉ ุงูุชุญูู ูุญุงูุฉ ุงูุงุชุตุงู ุจุงูุณุญุงุจุฉ.</font></font><br>
<br>
<img src="https://habrastorage.org/files/71d/c17/687/71dc17687ccb4a289d0a0dd2296fdfca.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏู ุฌููุน ุงูุนูุฏ ุงููุชุตูุฉ ุจุงูุณุญุงุจุฉ ููุท ูุชุญุฏูุซ ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ. </font><font style="vertical-align: inherit;">ูุง ูุนูู ุฃููู ุณุฃููู ุจุฌููู ุงูุนุธูุฉ - ุงูุนูู ููุท ูุน ุงูุณุญุงุจุฉ ูุง ูุฃูู ููุงุฑุฏ ุชุญูู ุบููุฉ. </font><font style="vertical-align: inherit;">ูุฏุนู IDE ุงูุนูู ูุน ุงูููุชุจุงุช ุ ููุฏุนู ุงูุนุฏุงุฏ ุญุฑููุง ุงูุนุดุฑุงุช ุ ูุงูุจุงูู ูู ูุจู ุงููุฌุชูุน. </font><font style="vertical-align: inherit;">ูู ููุงุญุธุชู ุ ุชู ููู ูู ุดูุก ุดุงุฆุน ููุชุฑุฉ ุทูููุฉ ุ ูููุฒุฉ ุฃุฎุฑู ูู ุฃู IDE ูุนุฑู ุนูู ุงูููุฑ ุนุฏุฏ ุงููุดุงุฑูุน ุงูุชู ุชุณุชุฎุฏู ุงูููุชุจุฉ.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ ูุตุฏุฑ ุงูุจุฑูุงูุฌ ุงูุซุงุจุช</font></font></b><div class="spoiler_text"><pre><code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">// This #include statement was automatically added by the Particle IDE.</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Adafruit_SSD1306/Adafruit_SSD1306.h"</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment">// This #include statement was automatically added by the Particle IDE.</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"MQTT/MQTT.h"</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment">// This #include statement was automatically added by the Particle IDE.</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"OneWire/OneWire.h"</span></span></span></span>

SYSTEM_THREAD(ENABLED);
SYSTEM_MODE(MANUAL);
STARTUP(WiFi.selectAntenna(ANT_EXTERNAL));
STARTUP(System.enableFeature(FEATURE_RETAINED_MEMORY));

<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">counter_struct</span></span></span><span class="hljs-class"> {</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value;
  byte state;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pin;
};
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">valve_struct</span></span></span><span class="hljs-class"> {</span></span>
  byte state;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pin;
};
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensor_struct</span></span></span><span class="hljs-class"> {</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> timeout;
  byte state;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pin;
};

<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> currentMillis = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> previous_conected = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> previous_wifi_uptime = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> previous_counter_read = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> wifi_uptime;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> start_temp_timer = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> read_temp_timer = <span class="hljs-number"><span class="hljs-number">0</span></span>;
byte display_timeout = <span class="hljs-number"><span class="hljs-number">0</span></span>;

<span class="hljs-comment"><span class="hljs-comment">//temp onewire </span></span>
OneWire ds0 = OneWire(D2);
OneWire ds1 = OneWire(D3);
byte addr0[<span class="hljs-number"><span class="hljs-number">8</span></span>];
byte addr1[<span class="hljs-number"><span class="hljs-number">8</span></span>];
<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> presense0 = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> presense1 = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
byte data[<span class="hljs-number"><span class="hljs-number">12</span></span>];

<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> OLED_RESET A7</span></span>
<span class="hljs-function"><span class="hljs-function">Adafruit_SSD1306 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">display</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OLED_RESET)</span></span></span></span>;


<span class="hljs-comment"><span class="hljs-comment">//valve control</span></span>
retained valve_struct valve[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, D4}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, D5} };

<span class="hljs-comment"><span class="hljs-comment">//counter control</span></span>
retained counter_struct counter[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, A0}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, A1} };
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pressure[<span class="hljs-number"><span class="hljs-number">2</span></span>] = {A2, A3};
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SENSOR_TIMEOUT 10</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> sensor_struct sensor[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, D6}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, D7} };

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* topic, byte* payload, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> length)</span></span></span></span>;

byte server[] = { <span class="hljs-number"><span class="hljs-number">192</span></span>,<span class="hljs-number"><span class="hljs-number">168</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">101</span></span>};
<span class="hljs-function"><span class="hljs-function">MQTT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">client</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(server, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1883</span></span></span></span><span class="hljs-function"><span class="hljs-params">, callback)</span></span></span></span>;

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* t, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> retain)</span></span></span><span class="hljs-function"> 
</span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client.publish(t, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)p, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(p), retain);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* t, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> retain)</span></span></span><span class="hljs-function"> 
</span></span>{   
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf_d[<span class="hljs-number"><span class="hljs-number">12</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf_d,<span class="hljs-string"><span class="hljs-string">"%d"</span></span>,p);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client.publish(t, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)buf_d, n, retain);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* t, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> retain)</span></span></span><span class="hljs-function"> 
</span></span>{   
    <span class="hljs-comment"><span class="hljs-comment">//char buf_f[18];</span></span>
    <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;
<span class="hljs-comment"><span class="hljs-comment">//    dtostrf(p, 9, 4, buf_f);</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//int n = sprintf(buf_f,"%f",p);</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client.publish(t, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)s.c_str(), s.length(), retain);
}

<span class="hljs-comment"><span class="hljs-comment">// recieve message</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* topic, byte* payload, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> length)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> p[length + <span class="hljs-number"><span class="hljs-number">1</span></span>];
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(p, payload, length);
    p[length] = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;
    <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p)</span></span></span></span>;
    <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(topic)</span></span></span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t.equals(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark/set"</span></span>))
    {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (message.equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"1"</span></span>))
        {
            Particle.connect();
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waitFor(Particle.connected, <span class="hljs-number"><span class="hljs-number">10000</span></span>)) 
                {publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);}
            <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
                {Particle.disconnect(); publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);}
        }
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
        {
            Particle.disconnect();
            publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
        }
    }
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t.startsWith(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/"</span></span>))
    {
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m = message.toInt();
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = t.substring(<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>).toInt();
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; m &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; x &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; x &lt;<span class="hljs-number"><span class="hljs-number">2</span></span>) 
        {
            set_valve(x, m);
        }
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
        {
            publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/"</span></span> + t.substring(<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>),  valve[x].state , <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
        }
    }
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t.startsWith(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/"</span></span>))
    {
        <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> m = message.toFloat();
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = t.substring(<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>).toInt();
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; m &lt;= <span class="hljs-number"><span class="hljs-number">999999</span></span> &amp;&amp; x &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; x &lt;<span class="hljs-number"><span class="hljs-number">2</span></span>) 
        {
            counter[x].value = m;
        }
        publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/"</span></span> + t.substring(<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>),  counter[x].value , <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
<span class="hljs-comment"><span class="hljs-comment">//Serial.begin(9600);</span></span>
    WiFi.on();
    WiFi.connect();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waitFor(WiFi.ready, <span class="hljs-number"><span class="hljs-number">5000</span></span>)) {mqtt_connect();}
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) 
    {
        pinMode(valve[i].pin, OUTPUT);
        digitalWrite(valve[i].pin, valve[i].state);
        pinMode(counter[i].pin, INPUT);
        pinMode(sensor[i].pin, INPUT);
        counter[i].state = digitalRead(counter[i].pin);
        pinMode(pressure[i], AN_INPUT);
    }
    pinMode(A4, INPUT_PULLUP);

    display.begin(SSD1306_SWITCHCAPVCC, <span class="hljs-number"><span class="hljs-number">0x3C</span></span>);  <span class="hljs-comment"><span class="hljs-comment">// initialize with the I2C addr 0x3C (for the 128x64)</span></span>
    display.clearDisplay();   <span class="hljs-comment"><span class="hljs-comment">// clears the screen and buffer</span></span>

    <span class="hljs-comment"><span class="hljs-comment">//Particle.connect();</span></span>
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> 
</span></span>{
    currentMillis = millis();
    <span class="hljs-comment"><span class="hljs-comment">//       MQTT </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - previous_conected &gt;= <span class="hljs-number"><span class="hljs-number">30000</span></span> || previous_conected &gt; currentMillis)
    {
        previous_conected = currentMillis;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!client.isConnected() &amp; wifi_uptime &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>)
        {
            mqtt_connect();
        }
        publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/rssi"</span></span>, WiFi.RSSI(), <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
    }
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - previous_wifi_uptime &gt;= <span class="hljs-number"><span class="hljs-number">1000</span></span> || previous_wifi_uptime &gt; currentMillis)
    {
        previous_wifi_uptime = currentMillis;
        WiFi.ready() ? wifi_uptime++ : wifi_uptime = <span class="hljs-number"><span class="hljs-number">0</span></span>;
        <span class="hljs-comment"><span class="hljs-comment">//work with button and display</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fg = digitalRead(A4);
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (display_timeout &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)
        {
            display_timeout -= <span class="hljs-number"><span class="hljs-number">1</span></span>;
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (display_timeout == <span class="hljs-number"><span class="hljs-number">0</span></span>) 
            { 
                display.clearDisplay();
                display.display();
            } 
        }
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fg == <span class="hljs-number"><span class="hljs-number">0</span></span>)
        {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (display_timeout == <span class="hljs-number"><span class="hljs-number">0</span></span>)
            {
                display.clearDisplay();   <span class="hljs-comment"><span class="hljs-comment">// clears the screen and buffer</span></span>
                display.setTextSize(<span class="hljs-number"><span class="hljs-number">2</span></span>);
                display.setTextColor(WHITE);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"C="</span></span>);
                display.println(counter[<span class="hljs-number"><span class="hljs-number">0</span></span>].value, <span class="hljs-number"><span class="hljs-number">4</span></span>);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"H="</span></span>);
                display.println(counter[<span class="hljs-number"><span class="hljs-number">1</span></span>].value, <span class="hljs-number"><span class="hljs-number">4</span></span>);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"Valve="</span></span>);
                display.print(valve[<span class="hljs-number"><span class="hljs-number">0</span></span>].state);
                display.print(<span class="hljs-string"><span class="hljs-string">"|"</span></span>);
                display.println(valve[<span class="hljs-number"><span class="hljs-number">1</span></span>].state);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"Sensor="</span></span>);
                display.print(sensor[<span class="hljs-number"><span class="hljs-number">0</span></span>].state);
                display.print(<span class="hljs-string"><span class="hljs-string">"|"</span></span>);
                display.println(sensor[<span class="hljs-number"><span class="hljs-number">1</span></span>].state);
                display.display();
            }
            display_timeout = <span class="hljs-number"><span class="hljs-number">10</span></span>;
        }
    }
    <span class="hljs-comment"><span class="hljs-comment">//counter check</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - previous_counter_read &gt;= <span class="hljs-number"><span class="hljs-number">500</span></span> || previous_counter_read &gt; currentMillis)
    {
        previous_counter_read = currentMillis;
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) 
        {
            byte count_state = digitalRead(counter[i].pin);
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count_state != counter[i].state)
            {
                counter[i].state = count_state;
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count_state == <span class="hljs-number"><span class="hljs-number">0</span></span>)
                {
                    counter[i].value += <span class="hljs-number"><span class="hljs-number">0.01</span></span>;
                    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf18[<span class="hljs-number"><span class="hljs-number">30</span></span>];
                    <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf18,<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/%d"</span></span>, i);
                    publish_message(buf18 , counter[i].value, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
                }
            }
            <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
            byte sensor_state = digitalRead(sensor[i].pin);
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor_state != sensor[i].state) <span class="hljs-comment"><span class="hljs-comment">//</span></span>
            {
                sensor[i].state = sensor_state;
                sensor[i].timeout = SENSOR_TIMEOUT; 
            }
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor[i].timeout &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) 
            {
                sensor[i].timeout -= <span class="hljs-number"><span class="hljs-number">1</span></span>;
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor[i].timeout == <span class="hljs-number"><span class="hljs-number">0</span></span>)
                {
                    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf18[<span class="hljs-number"><span class="hljs-number">30</span></span>];
                    <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf18,<span class="hljs-string"><span class="hljs-string">"home/water_count/sensor/%d"</span></span>, i);
                    publish_message(buf18 , sensor[i].state, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
                    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor[i].state  == <span class="hljs-number"><span class="hljs-number">0</span></span>)
                    {
                        set_valve(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//close both valve</span></span>
                        set_valve(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//close both valve</span></span>
                    }
                }
            }
        }
    }

    <span class="hljs-comment"><span class="hljs-comment">// temp onewire</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - start_temp_timer &gt;= <span class="hljs-number"><span class="hljs-number">299000</span></span> || start_temp_timer &gt; currentMillis)
    { <span class="hljs-comment"><span class="hljs-comment">// </span></span>
        start_temp_timer = currentMillis;
        presense0 = start_temp0();
        presense1 = start_temp1();
    }
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - read_temp_timer &gt;= <span class="hljs-number"><span class="hljs-number">300000</span></span> || read_temp_timer &gt; currentMillis)
    {<span class="hljs-comment"><span class="hljs-comment">// </span></span>
        read_temp_timer = currentMillis;
        start_temp_timer = currentMillis;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (presense0) read_temp0();
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (presense1) read_temp1();
        <span class="hljs-comment"><span class="hljs-comment">//preasure calc and send</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf18[<span class="hljs-number"><span class="hljs-number">30</span></span>]; 
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++)
        {
            <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf18,<span class="hljs-string"><span class="hljs-string">"home/water_count/pressure/%d"</span></span>, i);
            <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> read_val = analogRead(pressure[i]);
            <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value = (read_val - <span class="hljs-number"><span class="hljs-number">600.0</span></span>) / <span class="hljs-number"><span class="hljs-number">300.0</span></span> ;
            publish_message(buf18 , value, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
        }
    }
    <span class="hljs-comment"><span class="hljs-comment">//Particle.process();</span></span>
    client.loop();
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mqtt_connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (client.connect(<span class="hljs-string"><span class="hljs-string">"water_count"</span></span>))
    { <span class="hljs-comment"><span class="hljs-comment">//  spark    </span></span>
        client.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark/set"</span></span>);
        publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, Particle.connected() ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
        client.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/+/set"</span></span>);
        client.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/+/set"</span></span>);
        
    }
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_temp0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !ds0.search(addr0)) { ds0.reset_search(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    ds0.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OneWire::crc8(addr0, <span class="hljs-number"><span class="hljs-number">7</span></span>) != addr0[<span class="hljs-number"><span class="hljs-number">7</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    
    ds0.reset();
    ds0.select(addr0);
    ds0.write(<span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; 
}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_temp1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !ds1.search(addr1)) { ds1.reset_search(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    ds1.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OneWire::crc8(addr1, <span class="hljs-number"><span class="hljs-number">7</span></span>) != addr1[<span class="hljs-number"><span class="hljs-number">7</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    
    ds1.reset();
    ds1.select(addr1);
    ds1.write(<span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; 
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-comment"><span class="hljs-comment">//delay(1000);</span></span>
    ds0.reset();
    ds0.select(addr0);
    ds0.write(<span class="hljs-number"><span class="hljs-number">0xBE</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) 
    {
        data[i] = ds0.read();
    }
    <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> raw = (data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | data[<span class="hljs-number"><span class="hljs-number">0</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> celsius = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)raw * <span class="hljs-number"><span class="hljs-number">0.0625</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (celsius &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || celsius &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
    publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/temp/0"</span></span>, celsius, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
    <span class="hljs-comment"><span class="hljs-comment">//Serial.println(celsius);</span></span>
    ds0.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;
}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-comment"><span class="hljs-comment">//delay(1000);</span></span>
    ds1.reset();
    ds1.select(addr1);
    ds1.write(<span class="hljs-number"><span class="hljs-number">0xBE</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) 
    {
        data[i] = ds1.read();
    }
    <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> raw = (data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | data[<span class="hljs-number"><span class="hljs-number">0</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> celsius = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)raw * <span class="hljs-number"><span class="hljs-number">0.0625</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (celsius &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || celsius &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
    publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/temp/1"</span></span>, celsius, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
    <span class="hljs-comment"><span class="hljs-comment">//Serial.println(celsius);</span></span>
    ds1.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_valve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> vlv, byte state)</span></span></span><span class="hljs-function">
</span></span>{
    valve[vlv].state = state;
    digitalWrite(valve[vlv].pin, state);
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf26[<span class="hljs-number"><span class="hljs-number">26</span></span>];
    <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf26,<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/%d"</span></span>, vlv);
    publish_message(buf26 , state , <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
}
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฎูุงู MQTT ูุชูุงุตู ูุน ุงููุณูุท. </font><font style="vertical-align: inherit;">ุฑุตุฏ ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ูุงูุฎูุฐุฉ ูู ุงููุฑูุน ุงูููุงุจูุฉ ูุฃุญุฏุงุซ ูููู mqtt. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู home / water_count / valve / 0 - ูุญุฑู ููููุงู. </font><font style="vertical-align: inherit;">home / water_count / counter / 0 - ูุฑุงุกุงุช ุนุฏุงุฏ ูุงุก ุจุงุฑุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ูุดุชุฑู ูู ุฃูุงูุฑ ุชุบููุฑ ุญุงูุฉ ูุญุฑู ุงูุฃูุฑุงุต ูุชุญุฏูุฏ ุงููููุฉ ุงูุญุงููุฉ ููุนุฏุงุฏ (ุงููุงุก ุงูุจุงุฑุฏ ูุงูุณุงุฎู):</font></font><br>
<br>
<pre><code class="hljs axapta"><span class="hljs-keyword"><span class="hljs-keyword">client</span></span>.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/+/set"</span></span>);
<span class="hljs-keyword"><span class="hljs-keyword">client</span></span>.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/+/set"</span></span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฌุฏ ุฒุฑ ูุงุญุฏ ุนูู ุงูุฌูุงุฒ - ุจุงูุถุบุท ุนูู ุชุดุบูู ุงูุดุงุดุฉ ุ ูุฑุณู ุงููุฑุงุกุงุช ุงูุญุงููุฉ ููุนุฏุงุฏุงุช ูุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ูุงูุตูุงุจูุฑ. ุดุงุดุฉ OLED ุ ุชุชูุงุดู ุจุณุฑุนุฉ ุฅุฐุง ูุงูุช ููุฏ ุงูุชุดุบูู ุทูุงู ุงูููุช.</font></font><br>
<br>
<pre><code class="hljs lisp">STARTUP(<span class="hljs-name"><span class="hljs-name">System</span></span>.enableFeature(<span class="hljs-name"><span class="hljs-name">FEATURE_RETAINED_MEMORY</span></span>))<span class="hljs-comment"><span class="hljs-comment">;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ูู ููุฒุฉ ุงูุฃุฌูุฒุฉ ูุงูุจุฑุงูุฌ ุงููุซูุฑุฉ ููุงูุชูุงู ูู ูุญุฏุฉ ุชุญูู stm ุ ูู ุงูุฌุณููุงุช ุงููุฑุฌุนูุฉ ูุณููููุง BackupSRAM. ูุญุชูู ุงูููุชูู ุนูู ุฅุฎุฑุงุฌ vbat - ูุฐู ููุณุช ุทุงูุฉ ุงูุจุทุงุฑูุฉ ุฃู ุงูุดุญู. ุทุงููุง ููุงู ุฌูุฏ ุนูู ูุฐู ุงูุณุงู ุ ูุชู ุงูุงุญุชูุงุธ ุจูุญุชูู 4 ูููู ุจุงูุช ูู SRAM ูุน ุฅูุบุงุก ุชูุดูุท ูุญุฏุฉ ุงูุชุญูู ุชูุงููุง. ูุฐุง ูุฒูู ูุดููุฉ ุงูุชุขูู ุนูู EEPROM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูููุฏ ุ ูุชู ุงูุฅุนูุงู ุนู ุงููุชุบูุฑุงุช ุงูุชู ูุฌุจ ุฏูุนูุง ุฅูู ูุฐู ุงูุฐุงูุฑุฉ ูุน ุงูุฅุดุงุฑุฉ: ุงูุงุญุชูุงุธ ุจูุง. ููุช ุจุชุทุจูู ุฃุฌูุฒุฉ ูู supercapacitor ุนูุฏ 1.5F. ููููุง ููุฑูุฉ ุงูุจูุงูุงุช ุ ุณุชููุช ุงูุฐุงูุฑุฉ ุนูุฏ 1.6 ูููุช ุ ููููุง ูุชุฌุงุฑุจู ุนูู ุงูููุญุฉ ุงูุฃูููุฉ ุ ุณุชุฃุชู ูู ุบุถูู ุฃุณุจูุนูู ูุน ููุซูู. ููุทู ุฅุบูุงู ุงูุฑุงูุนุงุช ุนูุฏูุง ูุชู ุชุดุบูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ูู "ูุณุชูู" ููุง ูุนุชูุฏ ุนูู ุงุชุตุงู openhab. ููุฌุฏ ููุชุงุญ ุซูุงุซู ุงูุงุชุฌุงู ููุชุญูู ุงููุจุงุดุฑ ูู ุงูููุงุฏุฉ - ุฃูุชููุงุชููู ุ OFF (ููุฑุงุช ููุชูุญุฉ) ุ ุฅุบูุงู (ุฅุบูุงู).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฑุณู ุงูุจูุงูู ููุฏุงุฆุฑุฉ ุฃุฏูุงู: </font></font><br>
<br>
<img src="https://habrastorage.org/files/1a8/f4c/63d/1a8f4c63dba34f4e9905b703fabad0fd.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุชูุฒูู ูุดุฑูุน ุงููุณุฑ ุ ุฌูุจูุง ุฅูู ุฌูุจ ูุน libs ุงููุฎุตุตุฉ ุ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุฑุณู LUT ุ ูู ุงููุณุงุฑุงุช ูู ูุชููุต.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุถู ุตุฏูู ููุญูุงู ุงููุงุฆู</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/351/e37/1c3/351e371c3caf487d9f14f839f89402be.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุฏุฉ ุชุฒููุฏ ุงูุทุงูุฉ. </font><font style="vertical-align: inherit;">ูุญุชุงุฌ ุฅูู 12 ู 5 ูููุช. </font><font style="vertical-align: inherit;">ูุชู ุงูุจุญุซ ุนู ุงููุชุจุฑุน ุนูู ูููุน ุฆู ุจุงู ุนู ุงูุณุทุฑ: "ูุญูู ุทุงูุฉ ุงููุฑุต ุงูุตูุจ 5 ูููุช 12 ูููุช" ุ ูุซู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุณูุงู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุทุจุนู ุจุจูุงุณุชูู PLA ุนูู ุทุงุจุนุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ (ุชุงุฑุงูุชููุง ุชููู). </font><font style="vertical-align: inherit;">ูููุฉ 0.4 ูู ุ ุทุจูุฉ 0.25 ูู. </font><font style="vertical-align: inherit;">ุงูุบุทุงุก ูู ููุณ ุงูููุช ูุงููุงุนุฏุฉ ูุชุฑููุจ ููุญุฉ ุงูุชุญูู. </font><font style="vertical-align: inherit;">ูุชู ุฅุฑูุงู ุงููุงุนุฏุฉ ูุน ูุตุฏุฑ ุงูุทุงูุฉ ุจุงูุฌุฏุงุฑ. </font><font style="vertical-align: inherit;">ูู ูุชู ุชุซุจูุช ุงููุงุนุฏุฉ ุฐุงุช ุงูุบุทุงุก ุจูุณุงููุฑ ุ ูููุงู ูุง ูููู ูู ุชูุชุฑ ุงูุบุทุงุก (ูุซู ุบุทุงุก ุงูุฌุฏุฉ ุนูู ูุฑุทุจุงูุงุช ุงููุฑุจู) ูุงููููู ุงูุทุจูู ููุฌุฏุฑุงู ูุนูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุฐุฌ ุซูุงุซู ุงูุฃุจุนุงุฏ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฑุดูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/files/945/110/37d/94511037d3734ad1a573e84e5fc426ef.png"><br>
<br>
<img src="https://habrastorage.org/files/5aa/546/c0b/5aa546c0b6dd41d58fd6b33bde08df74.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅููู ููู ูุจุฏู ูู ุดูุก ูุซุจุชูุง ุนูู ุฃูุจูุจ ููุงู.</font></font><br>
<br>
<img src="https://habrastorage.org/files/cfb/293/f66/cfb293f66c3f4bb9ad2f46e812418918.jpg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openhab</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ูุดุฑู ุนูู Orange Pi One ุชุญุช Armbian.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููู ุงูุนูุตุฑ</font></font></b><div class="spoiler_text"><pre><code class="hljs julia">  -    ,  .
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_temp1	<span class="hljs-string"><span class="hljs-string">"T cool [%.1f ยฐC]"</span></span>			(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/temp1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_temp2	<span class="hljs-string"><span class="hljs-string">"T hot [%.1f ยฐC]"</span></span>			(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/temp2:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_count0	<span class="hljs-string"><span class="hljs-string">"Count cool [%.2f ยณ]"</span></span>					(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/counter/0:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_count1	<span class="hljs-string"><span class="hljs-string">"Count hot [%.2f ยณ]"</span></span>				(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/counter/1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_pressure0	<span class="hljs-string"><span class="hljs-string">"P cool [%.2f .]"</span></span>			(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/pressure/0:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_pressure1	<span class="hljs-string"><span class="hljs-string">"P hot [%.2f .]"</span></span>				(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/pressure/1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sensor0	<span class="hljs-string"><span class="hljs-string">"Sensor0 is [MAP(water_sensor.map):%s]"</span></span>		(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/sensor/0:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sensor1	<span class="hljs-string"><span class="hljs-string">"Sensor1 is [MAP(water_sensor.map):%s]"</span></span>		(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/sensor/1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_valve0	<span class="hljs-string"><span class="hljs-string">"Valve cool"</span></span>		(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/valve/0:state:default], &gt;[mqtt_bro:home/water_count/valve/0/set:command:*:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_valve1	<span class="hljs-string"><span class="hljs-string">"Valve hot"</span></span>				(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/valve/1:state:default], &gt;[mqtt_bro:home/water_count/valve/1/set:command:*:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>	watercount_sendStr <span class="hljs-string"><span class="hljs-string">"LastVol:[%s]"</span></span>						(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sendCool <span class="hljs-string"><span class="hljs-string">"Send cool [%.2f ยณ]"</span></span>		(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sendHot <span class="hljs-string"><span class="hljs-string">"Send hot [%.2f ยณ]"</span></span>			(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sendSwitch <span class="hljs-string"><span class="hljs-string">"Autosend"</span></span> 	(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_rssi	<span class="hljs-string"><span class="hljs-string">"WaterCount [%d dB]"</span></span>	(gSpark_RSSI)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/rssi:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_spark_state	<span class="hljs-string"><span class="hljs-string">"WaterCount Spark"</span></span>		(gSpark)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/spark:state:default], &gt;[mqtt_bro:home/water_count/spark/set:command:*:default]"</span></span> }</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุญุงุฌุฉ ุฅูู ูุงุนุฏุฉ ุชุญููู ุตุบูุฑุฉ ููุณุชุดุนุฑ ุงูุชุณุฑุจ.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญููู ูููููุฌุฒ</font></font></b><div class="spoiler_text"><b>transform\water_sensor.map </b><br>
1=dry<br>
0=wet<br>
undefined=undefined<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุดูู ุงูุตูุญุฉ ููุฅุฏุงุฑุฉ:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููู ููู Sitemap</font></font></b><div class="spoiler_text"><b>Sitemap</b><br>
Text label=ยซยป icon=ยซwaterยป <br>
 {<br>
 Frame <br>
 {<br>
 Text item=watercount_temp1<br>
 Text item=watercount_count0<br>
 Text item=watercount_pressure0<br>
 Switch item=watercount_valve0 mappings=[1=ยซCloseยป, 0=ยซOpenยป]<br>
 }<br>
 Frame <br>
 {<br>
 Text item=watercount_temp2<br>
 Text item=watercount_count1<br>
 Text item=watercount_pressure1<br>
 Switch item=watercount_valve1 mappings=[1=ยซCloseยป, 0=ยซOpenยป]<br>
 }<br>
 Frame <br>
 {<br>
 Text item=watercount_sensor0<br>
 Text item=watercount_sensor1 <br>
 }<br>
 Frame <br>
 {<br>
 Switch item=watercount_sendSwitch mappings=[0=ยซOFFยป, 1=ยซONยป]<br>
 Text item=watercount_sendStr<br>
 Text item=watercount_sendCool<br>
 Text item=watercount_sendHot<br>
 }<br>
 } <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุงุนุฏ ุงููุนุงูุฌุฉ:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุนุฏ Configs</font></font></b><div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_sensor0"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_sensor0 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
			{
				sendTelegram("****_bot", "Sensor0 was wet less than 5 seconds")
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor0 become dry")
			}
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">0</span></span>)
			{
				sendTelegram("****_bot", "Sensor0 was dry less than 5 seconds");			
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor0 become wet! Valves will be closed!")
			}
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_sensor1"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_sensor1 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
			{
				sendTelegram("****_bot", "Sensor1 was wet less than 5 seconds")
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor1 become dry")
			}
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">0</span></span>)
			{
				sendTelegram("****_bot", "Sensor1 was dry less than 5 seconds");			
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor1 become wet! Valves will be closed!")
			}
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
	
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_temp2"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_temp2 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_temp2.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt; <span class="hljs-number"><span class="hljs-number">37</span></span> )
		{
			sendTelegram("****_bot", String::format("Hot water temp drop to %s", watercount_temp2.state.toString));
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>

<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_pressure0"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_pressure0 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Cool pressure drop to %s", watercount_pressure0.state.toString));
		}
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Cool pressure rise to %s", watercount_pressure0.state.toString));
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_pressure1"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_pressure1 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Hot pressure drop to %s", watercount_pressure1.state.toString));
		}
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Hot pressure rise to %s", watercount_pressure1.state.toString));
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>

<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Generate send string counters" //every <span class="hljs-number"><span class="hljs-number">24</span></span> day <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> mounth  <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">00.01</span></span> minutes
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		<span class="hljs-type"><span class="hljs-type">Time</span></span> cron "0 0 1 24 1/1 ?" 
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		
		var <span class="hljs-type"><span class="hljs-type">float</span></span> deltaCool = (watercount_count0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue() - (watercount_sendCool.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue()
		var <span class="hljs-type"><span class="hljs-type">float</span></span> deltaHot = (watercount_count1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue() - (watercount_sendHot.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue()
		
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (deltaCool &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; deltaHot &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>)
		{
			watercount_sendStr.postUpdate(String::format(" %.2f / %.2f 3", deltaCool, deltaHot))
			watercount_sendCool.state = watercount_count0.state
			watercount_sendHot.state = watercount_count1.state
			sendTelegram("****_bot", String::format(" 23,  5, . 23.  โ2560097 (.) = %.2f 3. C โ2538996 (.) = %.2f 3. %s", (watercount_sendCool.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue(), (watercount_sendHot.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue(), watercount_sendStr.state.toString()))
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			watercount_sendSwitch.postUpdate(<span class="hljs-number"><span class="hljs-number">0</span></span>)
			sendTelegram("****_bot", "Current counters value less than sended last time. Turn off autosend.")
		}
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Send string counters" 
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		<span class="hljs-type"><span class="hljs-type">Time</span></span> cron "0 0 23 24 1/1 ?"
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (watercount_sendSwitch.state == <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendMail("uk@uk.ru", " 23,  5, . 23", String::format(" 23,  5, . 23.  โ2560097 (.) = %.2f 3. C โ2538996 (.) = %.2f 3", (watercount_sendCool.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue(), (watercount_sendHot.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue()));
			sendTelegram("****_bot", "Send email with watercount values");
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			sendTelegram("****_bot", "Can't send email with watercount values - autosend is OFF.");
		}
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Rotate valves" 
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		<span class="hljs-type"><span class="hljs-type">Time</span></span> cron "0 0 05 25 1/1 ?"
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (watercount_valve0.state == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; watercount_valve1.state == <span class="hljs-number"><span class="hljs-number">0</span></span>)
		{	
			watercount_valve0.postUpdate(<span class="hljs-number"><span class="hljs-number">1</span></span>)
			Thread::sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>)
			watercount_valve1.postUpdate(<span class="hljs-number"><span class="hljs-number">1</span></span>)
			Thread::sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>)
			watercount_valve0.postUpdate(<span class="hljs-number"><span class="hljs-number">0</span></span>)
			Thread::sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>)
			watercount_valve1.postUpdate(<span class="hljs-number"><span class="hljs-number">0</span></span>)
			sendTelegram("****_bot", "Valves was rotated.");
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			sendTelegram("****_bot", "Can't rotate valves, it's closed.");
		}
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุฑุณุงู ุงูุฑุณุงุฆู ุ ูุง ุฃุณุชุฎุฏู ุงููุธููุฉ ุงููุถููุฉ ูุชุทุจูู openhab android ุ ููุง ุฃุชูุงูู ูุน ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูู. </font><font style="vertical-align: inherit;">ุฃูุง ุฃุญุจ ุฑูุจูุช Telegram. </font><font style="vertical-align: inherit;">ูููู ุฑุคูุฉ ููููุฉ ุชูููู ูุชูุตูู ุงูุจูุช ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฅุฑุณุงู ุฑุณุงุฆู ูู ุตูุฏูู ุจุฑูุฏ gmail ุ ุฅุฐุง ูุงู ูุฏูู ูุตุงุฏูุฉ ุซูุงุฆูุฉ ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุชูููู ูููุฉ ูุฑูุฑ ููุฑุฉ ูุงุญุฏุฉ ูุชุทุจูู ุงูุจุฑูุฏ ูุชุนููู ูููุฉ ุงููุฑูุฑ ูุฐู ูู ุชูููู openhab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุชุจุน ุงูููุงุนุฏ. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูู ูู watercount_sensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุฑุณู ุฌูุงุฒ ุงูุชุญูู ููู ูุณุชุดุนุฑ ุงูุชุณุฑุจ ุงูุฌุฏูุฏุฉ ููุท ุนูุฏูุง ูุชู ุชุบููุฑ ุงููููุฉ ุฃู ุฅุฐุง ูุงู ููุงู ุฅูุฐุงุฑ ูุงุฐุจ (ุฃูู ูู 10 ุฏูุฑุงุช). ูููู ุจุชุญููู ูุง ุฌุงุก ูุฃูููุฉ ุชุงุฑูุฎูุฉ ุ ููุดูู ุฑุณุงุฆู ุฅุนูุงููุฉ. ููุงู ูุงุฑู ุจุณูุท - ูุญุงููุฉ ููุญุตูู ุนูู prevoiusItem ูุนุทู ุงููููุฉ ุงูุญุงููุฉ ุจุงุณุชูุฑุงุฑ ุ ูู ุฃุฌุฏ ุญูุงู - ุฃูุง ุขุฎุฐ ุงููููุฉ "-3 ุซุงููุฉ" ุ ุฅุฐุง ุชุบูุจ ุนูููุง ุดุฎุต ูุง ุ ุงูุชุจูุง ูู ุงูุชุนูููุงุช ุฃู ูู PM. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูู ูู watercount_temp2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุชุญูู ููุง ุฅุฐุง ูุงู ุฃูู ูู 37 ุ ููุง ูุนูู ุฃู ุงููุงุก ุงูุณุงุฎู ุฃุตุจุญ ุจุงุฑุฏูุง ุ ูุฌุจ ุนููู ุชุดุบูู ุณุฎุงู ุงูุชุฏูู ุนูุฏ ุงููุตูู. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูู ูู watercount_pressure</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ูููู ุจุชุญููู ุงููููุฉ ุงูุญุงููุฉ ูุงูุณุงุจูุฉ ุ ููุฑุฏ ุจุฑุณุงูุฉ ุนูู ุงูุฎูุงุถ ุฃูู ูู 1 ุตุฑุงู ุขูู ูุงูููู ูููู. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุนุฏุงุฏุงุช ุณูุณูุฉ ุงูุฅุฑุณุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุจุฏุฃ ูู cron ููู 24 ูู ูู ุดูุฑ ูู ุงูุณุงุนุฉ ุงููุงุญุฏุฉ ุตุจุงุญูุง. ูุชุญูู ูู ุฃู ุงูููู ุงูุขู ุฃูุจุฑ ูู ุชูู ุงูุชู ุชู ุฅุฑุณุงููุง ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ. ุฅุฐุง ูุงู ุฃูู ุ ุฃููู ุงูุฅุฑุณุงู ุงูุชููุงุฆู ููู ุจุฅูุดุงุก ุชูุจูู. ุฅุฐุง ูุงูุช ููุงูู - ูุชุฐูุฑ ููู ุงูุนุฏุงุฏุงุช ูุฅุฑุณุงููุง ุฅูู ุงููุงููู ุงูุฌูุงุฆู ุ ูุฑุณู ูุต ุงูุฑุณุงูุฉ ุงููุณุชูุจููุฉ ุฅูู ุงูุจุฑููุฉ. ูู ุงูููุช ููุณู ุ ูููุฑ ูู watercount_sendStr ููุฏุงุฑ ูุง ุงุณุชููููุงู ุฎูุงู ุงูุดูุฑ ุงููุงุถู. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุนุฏุงุฏุงุช ุฅุฑุณุงู ุณูุณูุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ูุจุฏุฃ ูู cron ูู ุงูููู ุงูุฑุงุจุน ูุงูุนุดุฑูู ุงูุณุงุนุฉ 23.00. ููุชุญูู ููุง ุฅุฐุง ูุงู ุงูุฅุฑุณุงู ุงูุชููุงุฆู ููููููุง ุ ุฅุฐุง ูุงู ููุฏ ุงูุชุดุบูู - ุชุฑุณู ุงูุฎูุฐุฉ ุนุฏุงุฏุงุช ุฅูู ุจุฑูุฏ ุดุฑูุฉ ุงูุดุญู. ุงุชุถุญ ุฃู ูุฏู ุงูููู ุงูุฑุงุจุน ูุงูุนุดุฑูู ุทูุงู ุงูููู ุ ุดูุก ูุง ูุฅุตูุงุญู ุฃู ูุทุน ุงูุฅุฑุณุงู ุงูุชููุงุฆู ุ ุฅุฐุง ุญุฏุซ ุฎุทุฃ ูู ุงูุจุฑููุงุช. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฏูุซ ุจุงูุชุนููู</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏููุฑ ุงูุตูุงูุงุช</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุงุนุฏุฉ ุฅุบูุงู / ูุชุญ ุงูุตูุจูุฑ ูุฑุฉ ูุงุญุฏุฉ ูู ุงูุดูุฑ ุถุฏ ุงูุบููุงู. </font><font style="vertical-align: inherit;">ุงูุฎุงูุณุฉ ูุงูุนุดุฑูู ูู ุงูุฎุงูุณุฉ ุตุจุงุญูุง - ุญุชู ูุง ุชุฏุฎู ูู ุนูู ุบุณุงูุฉ ุงูุตุญูู ุฃู ุงูุบุณุงูุฉ ุ ูููู ุญุชู ูู ูุตูุช ุฅูู ููุงู - ููุณ ุงูุฃูุฑ ุจุงูุบ ุงูุฃูููุฉ ุ ุณูุชู ุฅุบูุงู ุงููุงุก ููุฏุฉ 3-4 ุซูุงูู ุชูุฑูุจูุง. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุง ููุท ูุจุฏุฃ ุงูููุฒู ุงูุฐูู ...</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ูุชูุญ ูู ุงูุฌูุน ุจูู ุงูุฃูุธูุฉ ูู ููุทุฉ ูุงุญุฏุฉ (openhab) ุจูุงุก ููุทู ุบูุฑ ูุชููุฑ ููุฌููุนุฉ ูู ุงูุฃูุธูุฉ ุงููุณุชููุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู: ูุตู ุญุฏุซ ุฒูุงุฏุฉ ูู ุนุฏุงุฏ ุงูููุงู - ูุธุงู ุงูุฃูุงู ูุดุท ุ ูุฃููุงู ุงูุจุงุจ ุงูุฃูุงูู ูุบููุฉ ุ ูุงุณุชููุงู ุงูุทุงูุฉ ูุบุณุงูุฉ ุงูุตุญูู ูุงูุบุณุงูุฉ ุฃูู ูู 5 ูุงุท ุ ููุง ูุนูู ุฃูู ุชู ุงููุดู ุนู ุชุณุฑุจ ูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ. </font><font style="vertical-align: inherit;">ูููู ุจุชุดููู ุฃูุฑ ูุฅุบูุงู ุงูุฑุงูุนุงุช ุ ูุฅุฑุณุงู ุฑุณุงูุฉ ุฅูู ุงูุจูุช ูู Telegram. </font><font style="vertical-align: inherit;">ููู ูุฐุง ูุดุจู ุงูุฎูุท ูุงุญููุง.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar399459/">https://habr.com/ru/post/ar399459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar399449/index.html">ุงูุญูุถ ุงููููู ูู ูุตู ุญุฌู ุงููุฑูููุณููุงุช ููุท. ูู ุดูุก ุขุฎุฑ ุนุจุงุฑุฉ ุนู ูููู ูู ูุธุงุฆู ุบูุฑ ูุนุฑููุฉ</a></li>
<li><a href="../ar399451/index.html">ููุงุฐุง ููุณ ูุฏููุง ุฐูุฑูุงุช ุงูุฑุถุน</a></li>
<li><a href="../ar399453/index.html">ุฎูุณุฉ ุฃุดูุงู ูู ุฃููุงู blockchain ูุชุงุญุฉ ุงูุขู</a></li>
<li><a href="../ar399455/index.html">ููุณ ููุท ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ: ูุง ูู ุขุฎุฑ ูู Audiomania ูุนุดุงู ุงูููุณููู ูุนุดุงู ูุงูููุณููููู</a></li>
<li><a href="../ar399457/index.html">ููุงุก FinTech ุงูุฑูุณู ุฑูู 2: ุงูุชุฏุงูู ูู ุงูุนุตุฑ ุงูุฑููู</a></li>
<li><a href="../ar399461/index.html">ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุณูุณุงุนุฏ ุงููุงุณ ุนูู ุงูุชุฎูุต ูู ุงูุฑูุงุจ ูุงููุฎุงูู</a></li>
<li><a href="../ar399463/index.html">ุชุนููุช Multicopter ุงูุฌููุณ ุนูู ุฃุณุทุญ ุงูุณูุงุฑุงุช ุงููุชุญุฑูุฉ</a></li>
<li><a href="../ar399469/index.html">ุชุนูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ Pix2pix ุนูู ุชูููู ุฑุณููุงุช ููู ุงูุฑุตุงุต ุจุดูู ูุงูุนู ูุตูุฑ ุจุงูุฃุจูุถ ูุงูุฃุณูุฏ</a></li>
<li><a href="../ar399471/index.html">ูุณุงูู ุงููุถุงุก ุ ุงูุฌุฒุก 5: ููู ุณูุนูุด ุนูู ุนุทุงุฑุฏ (ุฃู ูู ูุนูุด)</a></li>
<li><a href="../ar399473/index.html">ุชุญููุช ุฑูุงูุฉ ุฅูุชู 4004 ุฅูู 45 ุนุงููุง. ุงููููู ูู ุชุงุฑูุฎ ุชูููููุฌูุง ุงููุนูููุงุช</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>