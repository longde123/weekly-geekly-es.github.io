<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ üìî üëß NB-IoT, Internet das coisas em banda estreita. Modos de economia de energia e comandos de controle üî£ üòà üòá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bom dia a todos! 


 Na parte anterior , foram discutidas informa√ß√µes e recursos gerais da tecnologia NB-IoT, mas aqui proponho considerar em detalhes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NB-IoT, Internet das coisas em banda estreita. Modos de economia de energia e comandos de controle</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435722/"><p>  Bom dia a todos! </p><br><p>  Na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">parte anterior</a> , foram discutidas informa√ß√µes e recursos gerais da tecnologia NB-IoT, mas aqui proponho considerar em detalhes os modos de economia de energia PSM e eDRX, bem como os comandos pelos quais esses modos podem ser controlados. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zq/25/d1/zq25d19x97qntznb9esig9avf40.png"></div><a name="habracut"></a><br><h2>  Modos de economia de energia no NB-IoT </h2><br><p>  Para dispositivos alimentados por bateria, √© importante consumir o m√≠nimo de energia poss√≠vel.  Para isso, o NB-IoT oferece dois modos de economia de energia: Modo de economia de energia, PSM e modo inativo estendido DRX, eDRX.  Vamos consider√°-los com mais detalhes. </p><br><h3>  Modo de economia de energia PSM </h3><br><p>  De acordo com a especifica√ß√£o 3GPP TS 23.682, o <b>PSM (Modo de economia de energia)</b> √© um modo semelhante ao desligamento, no qual o dispositivo, no entanto, permanece registrado na rede.  Curiosamente, o modo PSM apareceu nas especifica√ß√µes 3GPP anteriores ao NB-IoT - na vers√£o 12 do 3GPP. </p><br><p>  O dispositivo NB-IoT inicia o modo PSM, incluindo os valores de dois temporizadores nas solicita√ß√µes ATTACH REQUEST / TAU REQUEST enviadas nos procedimentos Attach e TAU (TAU, Tracking Area Update √© um procedimento peri√≥dico usado no LTE para notificar a rede sobre a disponibilidade e localiza√ß√£o de um dispositivo m√≥vel ) </p><br><p>  O primeiro temporizador - <b>T3324 Active Timer</b> - determina o tempo durante o qual o dispositivo permanece acess√≠vel a partir da rede ap√≥s o procedimento de conex√£o, TAU ou transfer√™ncia de dados. </p><br><p>  O segundo temporizador - <b>T3412 TAU Timer peri√≥dico estendido</b> - determina o per√≠odo do procedimento TAU. </p><br><p>  O modo PSM e os temporizadores T3324, T3412 s√£o mostrados na fig.  1: </p><br><img src="https://habrastorage.org/webt/fi/3v/xj/fi3vxjd1z69gf1rjr4diouuotfs.jpeg"><br><p>  Se a rede permitir o uso do modo PSM, os valores desses cron√¥metros ser√£o inclu√≠dos nas mensagens de resposta ATTACH ACCEPT / TAU ACCEPT.  Ao determinar os valores dos temporizadores, a rede pode levar em considera√ß√£o n√£o apenas os valores solicitados pelo dispositivo, mas tamb√©m a configura√ß√£o local.  Em outras palavras, a rede n√£o √© obrigada a confirmar exatamente os valores do timer solicitados pelo dispositivo.  Mas o dispositivo deve aplicar os valores recebidos da rede. </p><br><p>  <b>O per√≠odo de tempo em que o dispositivo est√° no modo PSM √© definido como a diferen√ßa entre o Timer TAU peri√≥dico estendido e o Timer ativo (T3412-T3324).</b>  Como o valor do T3324 Active Timer pode ser igual a zero, o <b>tempo te√≥rico m√°ximo gasto no modo PSM</b> √© igual ao tempo m√°ximo T3412 Temporizador TAU peri√≥dico estendido e √© de <b>413 dias e 8 horas (!!!)</b> .  O valor m√°ximo do Temporizador ativo T3324 √© de 3 horas e 6 minutos (186 minutos). </p><br><p>  Quando o dispositivo est√° no modo PSM, n√£o √© acess√≠vel pelo lado da rede (para os chamados servi√ßos de termina√ß√£o m√≥vel). </p><br><p>  A GSMA recomenda que as operadoras m√≥veis salvem e transmitam ao dispositivo (ap√≥s a √∫ltima sa√≠da do PSM) pelo menos o √∫ltimo pacote de dados de 100 bits. </p><br><p>  O dispositivo pode sair do modo PSM a qualquer momento (por exemplo, se o dispositivo precisar transferir urgentemente alguns dados, como na figura acima). </p><br><h3>  EDRX no modo de economia de energia (DRX no modo inativo estendido) </h3><br><p>  <b>O eDRX (DRX em modo inativo estendido)</b> pode ser considerado um modo de economia de energia adicional do dispositivo, apareceu nas especifica√ß√µes do 3GPP Release 13. DRX significa recep√ß√£o descont√≠nua (Discontinuous Receiving).  O m√©todo de recep√ß√£o intermitente √© conhecido nas comunica√ß√µes celulares h√° muito tempo e consiste no fato de que, para economizar energia, o caminho de recebimento do dispositivo √© ativado periodicamente em determinados intervalos, e a maior parte do tempo √© desligada.  A rede "sabe" sobre isso e envia sinais de pagina√ß√£o apenas nos momentos "certos".  O modo de recep√ß√£o intermitente avan√ßada (eDRX) permite aumentar significativamente o per√≠odo de tempo em que o caminho de recebimento do dispositivo est√° desativado.  De acordo com a especifica√ß√£o 3GPP TS 23.682, o <b>per√≠odo de recep√ß√£o intermitente de eDRX no modo NB-IoT √© de 20,48 a 10485,76 segundos</b> ( <b>10485</b> segundos s√£o quase 3 horas). </p><br><p>  Uma compara√ß√£o do DRX "antigo" e do eDRX "novo" √© mostrada na Fig.  2: </p><br><img src="https://habrastorage.org/webt/m-/hw/vz/m-hwvz9fasw-ubefb9q0vaprfso.jpeg"><br><p>  O NB-IoT ativa o modo eDRX transmitindo o valor do per√≠odo eDRX nas solicita√ß√µes ATTACH REQUEST / TAU REQUEST enviadas nos procedimentos Attach e TAU.  Se a rede permitir o uso do modo eDRX, o valor do per√≠odo eDRX ser√° inclu√≠do nas mensagens de resposta ATTACH ACCEPT / TAU ACCEPT.  A rede n√£o √© necess√°ria para confirmar o valor do per√≠odo eDRX solicitado pelo dispositivo, mas √© necess√°rio que o dispositivo aplique o valor transmitido pela rede. </p><br><p>  Assim como no PSM, ao usar o modo eDRX, a GSMA recomenda que os operadores salvem e transmitam ao dispositivo pelo menos o √∫ltimo pacote de dados de 100 bits.  No entanto, como segue uma pesquisa realizada pela associa√ß√£o GSM, as operadoras pretendem economizar muito mais dados a jusante (do aplicativo ao dispositivo). </p><br><p>  O modo EDRX pode ser usado simultaneamente com o modo PSM. </p><br><p>  Os modos PSM e eDRX est√£o entre os requisitos m√≠nimos de NBMA recomendados pela GSMA. </p><br><h2>  Comandos de gerenciamento de dispositivos NB-IoT (comandos AT) </h2><br><p>  Os comandos AT padr√£o s√£o descritos na especifica√ß√£o 3GPP TS 27.007.  Existem muitos comandos no total. Aqui consideraremos apenas aqueles com os quais voc√™ pode controlar os modos de economia de energia do dispositivo NB-IoT.  Al√©m disso, diferentes fabricantes podem interpretar os padr√µes ou inventar novas equipes √† sua maneira.  Portanto, para uma maior defini√ß√£o, vejamos os comandos do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√≥dulo NB-IoT N21</a> . </p><br><h3>  Comando de controle do modo PSM </h3><br><p>  Para definir os par√¢metros do modo PSM, use o comando AT + CPSMS: </p><br><pre><code class="bash hljs">AT+CPSMS=[mode],[Requested_Periodic-RAU],[Requested_GPRS-READY-timer],[Requested_Periodic-TAU],[Requested_Active-Time]</code> </pre> <br><p>  Par√¢metros de comando AT + CPSMS: </p><br><ul><li>  modo (0 - PSM desativado, 1 - PSM ativado) </li><li>  RAU peri√≥dica solicitada, T3312 (aplic√°vel a 2G / 3G, n√£o usado no NB-IoT) </li><li>  Solicitado_GPRS-READY-timer, T3314 (aplic√°vel a 2G / 3G, n√£o usado no NB-IoT) </li><li>  TAU peri√≥dica solicitada, T3412 (aplic√°vel ao LTE, <b>usado no NB-IoT</b> ) </li><li>  Tempo ativo solicitado, T3324 (aplic√°vel a 2G / 3G / LTE, <b>usado no NB-IoT</b> ) </li></ul><br><p>  Assim, tr√™s par√¢metros s√£o usados ‚Äã‚Äãpara configurar os par√¢metros PSM no modo NB-IoT: <b>mode</b> , <b>Requested_Periodic-TAU</b> e <b>Requested_Active-Time</b> . </p><br><p>  A dura√ß√£o solicitada do dispositivo no modo PSM √© a diferen√ßa entre Requested_Periodic-TAU e Requested_Active-Time. </p><br><h4>  Codificando o valor de Requested_Active-Time (T3324) </h4><br><p>  O Requested_Active-Time √© codificado como uma sequ√™ncia de 8 bits, onde os bits altos 8, 7, 6 s√£o o multiplicador, os bits 5, 4, 3, 2, 1 s√£o o valor. </p><br><div class="scrollable-table"><table><caption>  Tabela 1. Multiplicadores de tempo ativo solicitado (T3324) </caption><tbody><tr><td>  Bit 8 </td><td>  Bit 7 </td><td>  Bit 6 </td><td>  Multiplicador </td></tr><tr><td>  0 0 </td><td>  0 0 </td><td>  0 0 </td><td>  2 segundos </td></tr><tr><td>  0 0 </td><td>  0 0 </td><td>  1 </td><td>  1 minuto </td></tr><tr><td>  0 0 </td><td>  1 </td><td>  0 0 </td><td>  6 minutos (1/10 horas) </td></tr><tr><td>  1 </td><td>  1 </td><td>  1 </td><td>  Temporizador desativado </td></tr><tr><td></td><td></td><td></td><td>  Outros valores devem ser interpretados como 1 minuto (na vers√£o atual do protocolo) </td></tr></tbody></table></div><br><p>  Exemplo de codifica√ß√£o do valor Requested_Active-Time (T3324): <br>  00000101 - Tempo ativo solicitado <br>  000 - multiplicador, 2 segundos, <br>  00101 - valor, 5, <br>  5 x 2 segundos = 10 segundos - o valor solicitado Requested_Active-Time. </p><br><p>  O valor m√°ximo de Tempo solicitado (ativo) (T3324) √© de 3 horas e 6 minutos (186 minutos). </p><br><h4>  Codificando o valor de Requested_Periodic-TAU (T3412) </h4><br><p>  Requested_Periodic-TAU √© codificado como uma sequ√™ncia de 8 bits, onde os bits altos 8, 7, 6 s√£o o multiplicador, os bits baixos 5, 4, 3, 2, 1 s√£o o valor. </p><br><div class="scrollable-table"><table><caption>  Tabela 2. Multiplicadores solicitados_Periodic-TAU (T3412) </caption><tbody><tr><td>  Bit 8 </td><td>  Bit 7 </td><td>  Bit 6 </td><td>  Multiplicador </td></tr><tr><td>  0 0 </td><td>  0 0 </td><td>  0 0 </td><td>  10 minutos </td></tr><tr><td>  0 0 </td><td>  0 0 </td><td>  1 </td><td>  1 hora </td></tr><tr><td>  0 0 </td><td>  1 </td><td>  0 0 </td><td>  10 horas </td></tr><tr><td>  0 0 </td><td>  1 </td><td>  1 </td><td>  2 segundos </td></tr><tr><td>  1 </td><td>  0 0 </td><td>  0 0 </td><td>  30 segundos </td></tr><tr><td>  1 </td><td>  0 0 </td><td>  1 </td><td>  1 minuto </td></tr><tr><td>  1 </td><td>  1 </td><td>  0 0 </td><td>  320 horas.  Nota: esse valor se aplica apenas aos temporizadores T3312 estendido e T3412 estendido (consulte TS 24.301).  Se for recebido em uma mensagem com a verifica√ß√£o de integridade ativada, o valor deve ser interpretado como 320 horas.  Caso contr√°rio, deve ser interpretado como 1 hora. </td></tr><tr><td>  1 </td><td>  1 </td><td>  1 </td><td>  Temporizador desativado </td></tr></tbody></table></div><br><p>  Um exemplo de codifica√ß√£o do valor de Requested_Periodic-TAU (T3412): <br>  00100001 - TAU peri√≥dica solicitada <br>  001 - multiplicador, 1 hora, <br>  00010 - o valor 2, <br>  2 x 1 hora = 2 horas - o valor solicitado Requested_Periodic-TAU </p><br><p>  O valor m√°ximo para o timer do Requested_Periodic-TAU T3412 √© 9920 horas ou 413 dias e 8 horas. </p><br><h4>  Exemplos de comando AT + CPSMS </h4><br><pre> <code class="bash hljs">AT+CPSMS=0 //  PSM </code> </pre> <br><pre> <code class="bash hljs">AT+CPSMS=1,,,<span class="hljs-string"><span class="hljs-string">"00100001"</span></span>,<span class="hljs-string"><span class="hljs-string">"00100011"</span></span> //  PSM , Requested_Periodic-TAU: 2 , Requested_Active-Time: 3 ,  PSM: 1   57 </code> </pre> <br><h3>  Comando de controle do modo EDRX </h3><br><p>  Para definir os par√¢metros do modo eDRX, use o comando AT + CEDRXS: </p><br><pre> <code class="bash hljs">AT+CEDRXS=[mode],[AcT-type],[Requested_eDRX_value]</code> </pre> <br><p>  Par√¢metros de comando AT + CEDRXS: </p><br><p>  1. mode - mode: </p><br><ul><li>  0 - modo eDRX desativado </li><li>  1 - modo eDRX ativado </li><li>  2 - o modo eDRX est√° ativado, s√£o permitidas mensagens n√£o solicitadas (URC) </li></ul><br><p>  2. Tipo AcT - tecnologia de acesso via r√°dio: </p><br><ul><li>  1 - EC-GSM-IoT </li><li>  2 - GSM </li><li>  3 - 3G </li><li>  4 - LTE, LTE-M </li><li>  5 - NB-IoT </li></ul><br><p>  3. Requested_eDRX_value - a dura√ß√£o do per√≠odo eDRX.  O valor √© codificado como uma sequ√™ncia bin√°ria de 4 bits.  De acordo com a especifica√ß√£o 3GPP TS 23.682, o eDRX no modo NB-IoT est√° no intervalo de 20,48 a 10485,76 segundos.  Os valores requested_eDRX_value no modo NB-IoT s√£o mostrados na Tabela 3. </p><br><div class="scrollable-table"><table><caption>  Tabela 3. A dura√ß√£o do per√≠odo eDRX </caption><tbody><tr><td>  Requested_eDRX_value no modo NB-IoT </td><td>  Dura√ß√£o do per√≠odo EDRX, s </td></tr><tr><td>  0010 </td><td>  20,48 </td></tr><tr><td>  0011 </td><td>  40,96 </td></tr><tr><td>  0100 </td><td>  20,48 </td></tr><tr><td>  0101 </td><td>  81,92 </td></tr><tr><td>  0110 </td><td>  20,48 </td></tr><tr><td>  0111 </td><td>  20,48 </td></tr><tr><td>  1000 </td><td>  20,48 </td></tr><tr><td>  1001 </td><td>  163,84 </td></tr><tr><td>  1010 </td><td>  327,68 </td></tr><tr><td>  1011 </td><td>  655,36 </td></tr><tr><td>  1100 </td><td>  1310,72 </td></tr><tr><td>  1101 </td><td>  2621,44 </td></tr><tr><td>  1110 </td><td>  5.242,88 </td></tr><tr><td>  1111 </td><td>  10485.76 </td></tr></tbody></table></div><br><br><h4>  Exemplos de comando AT + CEDRXS </h4><br><pre> <code class="bash hljs">AT+CEDRXS=0 //  eDRX </code> </pre> <br><pre> <code class="bash hljs">AT+CEDRXS=1,5,<span class="hljs-string"><span class="hljs-string">"0010"</span></span> //  eDRX ,   - NB-IoT,   eDRX - 20,48 </code> </pre> <br><p>  PS O artigo n√£o afirma ser verdade absoluta e pode conter imprecis√µes.  Se voc√™ notar imprecis√µes, deseja compartilhar informa√ß√µes privilegiadas ou apenas expressar sua opini√£o - seja bem-vindo ao comentar! </p><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte anterior: NB-IoT, Internet das Coisas com Banda Estreita.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Informa√ß√µes gerais e recursos de tecnologia.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt435722/">https://habr.com/ru/post/pt435722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt435708/index.html">Fayal: um ponto de encontro no Atl√¢ntico</a></li>
<li><a href="../pt435712/index.html">Procter & Gamble lan√ßa impressora anti-envelhecimento para pele</a></li>
<li><a href="../pt435714/index.html">Os desenvolvedores ucranianos tiveram acesso aos arquivos de todas as c√¢meras Ring do mundo</a></li>
<li><a href="../pt435718/index.html">Bombeamos NGSW angular usando l√≥gica personalizada no Service Worker</a></li>
<li><a href="../pt435720/index.html">R√°dio Adblock de desenvolvimento</a></li>
<li><a href="../pt435724/index.html">Retendo os v√≠cios do imperativo</a></li>
<li><a href="../pt435728/index.html">[Sexta-feira] Hist√≥ria de como a venda de TI tentou vender lenha, ou nos bastidores de um concurso</a></li>
<li><a href="../pt435730/index.html">A concha rachou</a></li>
<li><a href="../pt435732/index.html">Friday JS: um quine que toca tic-tac-toe</a></li>
<li><a href="../pt435734/index.html">Como n√£o se deixar enganar fazendo f√≠sica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>