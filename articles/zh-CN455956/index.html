<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜œ ğŸ‘¨â€ğŸš€ ğŸ˜ Chromiumä¸ä»…æ˜¯æµè§ˆå™¨ï¼Œè€Œä¸”è¿˜æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¡†æ¶ ğŸ¥‡ ğŸ’¯ ğŸ•’</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¤§å¤šæ•°äººå·²ç»ä¹ æƒ¯äº†Chromiumæ—¢æ˜¯æµè§ˆå™¨åˆæ˜¯å…¶ä»–æµè§ˆå™¨çš„åŸºç¡€çš„äº‹å®ã€‚ ç›´åˆ°æœ€è¿‘ï¼Œæˆ‘ä¹Ÿè¿™æ ·è®¤ä¸ºï¼Œä½†æ˜¯ï¼Œç ”ç©¶äº†è¿™ä¸ªä¸»é¢˜å‡ ä¸ªæœˆä¹‹åï¼Œæˆ‘å¼€å§‹å‘ç°å¦ä¸€ä¸ªå¥‡å¦™çš„ä¸–ç•Œã€‚ é“¬æ˜¯ä¸€ä¸ªå·¨å¤§çš„ç”Ÿæ€ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å†…å®¹ï¼šä¾èµ–ç³»ç»Ÿï¼Œè·¨å¹³å°æ„å»ºç³»ç»Ÿä»¥åŠå‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹çš„ç»„ä»¶ã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸å°è¯•ä½¿ç”¨æ‰€æœ‰è¿™äº›åŠŸèƒ½æ¥åˆ›å»ºè‡ªå·±çš„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Chromiumä¸ä»…æ˜¯æµè§ˆå™¨ï¼Œè€Œä¸”è¿˜æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¡†æ¶</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/455956/"><img src="https://habrastorage.org/webt/ue/ye/xv/ueyexvk-uewnyghxhvtud7vugrq.jpeg"><br><br> å¤§å¤šæ•°äººå·²ç»ä¹ æƒ¯äº†Chromiumæ—¢æ˜¯æµè§ˆå™¨åˆæ˜¯å…¶ä»–æµè§ˆå™¨çš„åŸºç¡€çš„äº‹å®ã€‚ ç›´åˆ°æœ€è¿‘ï¼Œæˆ‘ä¹Ÿè¿™æ ·è®¤ä¸ºï¼Œä½†æ˜¯ï¼Œç ”ç©¶äº†è¿™ä¸ªä¸»é¢˜å‡ ä¸ªæœˆä¹‹åï¼Œæˆ‘å¼€å§‹å‘ç°å¦ä¸€ä¸ªå¥‡å¦™çš„ä¸–ç•Œã€‚ é“¬æ˜¯ä¸€ä¸ªå·¨å¤§çš„ç”Ÿæ€ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å†…å®¹ï¼šä¾èµ–ç³»ç»Ÿï¼Œè·¨å¹³å°æ„å»ºç³»ç»Ÿä»¥åŠå‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹çš„ç»„ä»¶ã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸å°è¯•ä½¿ç”¨æ‰€æœ‰è¿™äº›åŠŸèƒ½æ¥åˆ›å»ºè‡ªå·±çš„åº”ç”¨ç¨‹åºå‘¢ï¼Ÿ <br><br> åœ¨Katä¹‹ä¸‹ï¼Œæœ‰ä¸€ä¸ªæœ‰å…³å¦‚ä½•å¼€å§‹æ‰§è¡Œæ­¤æ“ä½œçš„å°æŒ‡å—ã€‚ <br><a name="habracut"></a><br><h2> ç¯å¢ƒå‡†å¤‡ </h2><br> åœ¨æˆ‘å°†ä½¿ç”¨Ubuntu 18.04çš„æ–‡ç« ä¸­ï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°å…¶ä»–æ“ä½œç³»ç»Ÿçš„è¿‡ç¨‹ï¼š <br><br><ul><li>  <a href="">çš„Linux</a> <br></li><li>  <a href="">çª—æˆ·</a> <br></li><li>  <a href="">Macç”µè„‘</a> <br></li></ul><br> ä»¥ä¸‹æ­¥éª¤éœ€è¦Gitå’ŒPythonã€‚ å¦‚æœå°šæœªå®‰è£…ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…å®ƒä»¬ï¼š <br><br><pre><code class="bash hljs">sudo apt install git python</code> </pre> <br><h3> è®¾ç½®depot_tools </h3><br>  <code>depot_tools</code>æ˜¯Chromiumå¼€å‘å·¥å…·ç®±ã€‚ è¦å®‰è£…å®ƒï¼Œæ‚¨å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://chromium.googlesource.com/chromium/tools/depot_tools.git</code> </pre> <br> å¹¶å°†è·¯å¾„æ·»åŠ åˆ°PATHç¯å¢ƒå˜é‡ä¸­ï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PATH</span></span></span><span class="hljs-string">:/path/to/depot_tools"</span></span></code> </pre> <br> é‡è¦ï¼šå¦‚æœå°†<code>depot_tools</code>ä¸‹è½½åˆ°æ‚¨çš„ä¸»æ–‡ä»¶å¤¹ä¸­ï¼Œè¯·ä¸è¦åœ¨<code>PATH</code>å˜é‡ä¸­ä½¿ç”¨<code>~</code> ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚ æ‚¨å¿…é¡»ä½¿ç”¨<code>$HOME</code>å˜é‡ï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PATH</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${HOME}</span></span></span><span class="hljs-string">/depot_tools"</span></span></code> </pre> <br><h3> ä»£ç æ£€ç´¢ </h3><br> é¦–å…ˆï¼Œæ‚¨éœ€è¦ä¸ºæºåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸»ç›®å½•ä¸­ï¼ˆå¤§çº¦éœ€è¦30 GBçš„å¯ç”¨ç©ºé—´ï¼‰ï¼š <br><br><pre> <code class="bash hljs">mkdir ~/chromium &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/chromium</code> </pre> <br> ä¹‹åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ¥è‡ª<code>depot_tools</code>çš„<code>fetch</code>å®ç”¨ç¨‹åºä¸‹è½½æºï¼š <br><br><pre> <code class="bash hljs">fetch --nohooks --no-history chromium</code> </pre> <br> ç°åœ¨ï¼Œæ‚¨å¯ä»¥å»å–èŒ¶/å’–å•¡ï¼Œå› ä¸ºæ“ä½œè¿‡ç¨‹å¹¶ä¸å¾ˆå¿«ã€‚ å¯¹äºå®éªŒï¼Œä¸éœ€è¦å†å²è®°å½•ï¼Œå› æ­¤ä½¿ç”¨<code>--no-history</code>æ ‡å¿—ã€‚ æ•…äº‹ä¼šæ›´é•¿ã€‚ <br><br><h3> ä¾èµ–å®‰è£… </h3><br> æ‰€æœ‰æºéƒ½åœ¨<code>src</code>æ–‡ä»¶å¤¹ä¸­ï¼Œè¯·è½¬åˆ°å®ƒï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> src</code> </pre> <br> ç°åœ¨ï¼Œæ‚¨éœ€è¦ä½¿ç”¨è„šæœ¬æ”¾ç½®æ‰€æœ‰ä¾èµ–é¡¹ï¼š <br><br><pre> <code class="bash hljs">./build/install-build-deps.sh</code> </pre> <br> å¹¶è¿è¡Œé’©å­ï¼š <br><br><pre> <code class="bash hljs">gclient runhooks</code> </pre> <br> è¿™æ ·å°±å®Œæˆäº†ç¯å¢ƒçš„å‡†å¤‡ã€‚ <br><br><h2> å»ºç«‹ç³»ç»Ÿ </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ninjaè¢«</a>ç”¨ä½œChromiumçš„ä¸»è¦è£…é…ç³»ç»Ÿï¼Œ <a href="">GN</a>å®ç”¨ç¨‹åºç”¨äºç”Ÿæˆ<code>.ninja</code>æ–‡ä»¶ã€‚ <br><br> ä¸ºäº†äº†è§£å¦‚ä½•ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œæˆ‘å»ºè®®åˆ›å»ºä¸€ä¸ªæµ‹è¯•å®ç”¨ç¨‹åºç¤ºä¾‹ã€‚ ä¸ºæ­¤ï¼Œè¯·åœ¨<code>src</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª<code>example</code>å­æ–‡ä»¶å¤¹ï¼š <br><br><pre> <code class="bash hljs">mkdir example</code> </pre> <br> ç„¶åï¼Œåœ¨<code>src/example</code>æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»º<code>BUILD.gn</code>æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ï¼š <br><br><pre> <code class="cpp hljs">executable(<span class="hljs-string"><span class="hljs-string">"example"</span></span>) { sources = [ <span class="hljs-string"><span class="hljs-string">"example.cc"</span></span>, ] }</code> </pre> <br>  <code>BUILD.gn</code>ç”±ç›®æ ‡ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶<code>example</code> ï¼‰å’Œæ„å»ºç›®æ ‡æ‰€éœ€çš„æ–‡ä»¶åˆ—è¡¨ç»„æˆã€‚ <br><br> ä¸‹ä¸€æ­¥æ˜¯åˆ›å»º<code>example.cc</code>æ–‡ä»¶æœ¬èº«ã€‚ é¦–å…ˆï¼Œæˆ‘å»ºè®®åˆ¶ä½œä¸€ä¸ªç»å…¸çš„åº”ç”¨ç¨‹åºâ€œ Hello worldâ€ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; int main(int argc, char **argv) { std::cout &lt;&lt; "Hello world" &lt;&lt; std::endl; return 0; }</span></span></span></span></code> </pre> <br> æºä»£ç å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a>ä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰¾åˆ°</a> ã€‚ <br><br> ä¸ºäº†ä½¿GNäº†è§£æ–°é¡¹ç›®ï¼Œè¯·åœ¨<code>src</code>ä¸­çš„<code>BUILD.gn</code>æ–‡ä»¶ä¸­ï¼Œåœ¨<code>deps</code>éƒ¨åˆ†ä¸­æ·»åŠ <code>"//example"</code>è¡Œï¼š <br><br><pre> <code class="cpp hljs">... group(<span class="hljs-string"><span class="hljs-string">"gn_all"</span></span>) { testonly = <span class="hljs-literal"><span class="hljs-literal">true</span></span> deps = [ <span class="hljs-string"><span class="hljs-string">":gn_visibility"</span></span>, <span class="hljs-string"><span class="hljs-string">"//base:base_perftests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//base:base_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//base/util:base_util_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//chrome/installer"</span></span>, <span class="hljs-string"><span class="hljs-string">"//chrome/updater"</span></span>, <span class="hljs-string"><span class="hljs-string">"//net:net_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//services:services_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//services/service_manager/public/cpp"</span></span>, <span class="hljs-string"><span class="hljs-string">"//skia:skia_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//sql:sql_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//third_party/flatbuffers:flatbuffers_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//tools/binary_size:binary_size_trybot_py"</span></span>, <span class="hljs-string"><span class="hljs-string">"//tools/ipc_fuzzer:ipc_fuzzer_all"</span></span>, <span class="hljs-string"><span class="hljs-string">"//tools/metrics:metrics_metadata"</span></span>, <span class="hljs-string"><span class="hljs-string">"//ui/base:ui_base_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//ui/gfx:gfx_unittests"</span></span>, <span class="hljs-string"><span class="hljs-string">"//url:url_unittests"</span></span>, # â†“â†“â†“â†“â†“â†“â†“â†“ <span class="hljs-string"><span class="hljs-string">"//example"</span></span>, ] ...</code> </pre> <br> ç°åœ¨ï¼Œæ‚¨éœ€è¦è¿”å›åˆ°<code>src</code>æ–‡ä»¶å¤¹å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆé¡¹ç›®ï¼š <br><br><pre> <code class="bash hljs">gn gen out/Default</code> </pre> <br>  GNè¿˜å…è®¸æ‚¨ä¸ºå—æ”¯æŒçš„IDEä¹‹ä¸€å‡†å¤‡é¡¹ç›®ï¼š <br><br><ul><li> èš€ <br></li><li> ä¸ <br></li><li>  vs2013 <br></li><li>  vs2015 <br></li><li>  vs2017 <br></li><li>  vs2019 <br></li><li>  Xcodeçš„ <br></li><li>  qtcreator <br></li><li>  json <br></li></ul><br> å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–æ›´å¤šä¿¡æ¯ï¼š <br><br><pre> <code class="bash hljs">gn <span class="hljs-built_in"><span class="hljs-built_in">help</span></span> gen</code> </pre> <br> ä¾‹å¦‚ï¼Œè¦åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">QtCreatorä¸­</a>ä½¿ç”¨<code>example</code>é¡¹ç›®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼Œ</a>æ‚¨éœ€è¦è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š <br><br><pre> <code class="bash hljs">gn gen --ide=qtcreator --root-target=example out/Default</code> </pre> <br> ä¹‹åï¼Œæ‚¨å¯ä»¥åœ¨QtCreatorä¸­æ‰“å¼€é¡¹ç›®ï¼š <br><br><pre> <code class="bash hljs">qtcreator out/Default/qtcreator_project/all.creator</code> </pre> <br> æœ€åä¸€æ­¥æ˜¯ä½¿ç”¨Ninjaæ„å»ºé¡¹ç›®ï¼š <br><br><pre> <code class="bash hljs">autoninja -C out/Default example</code> </pre> <br> ç»„è£…ç³»ç»Ÿçš„ç®€è¦ä»‹ç»å¯ä»¥å®Œæˆã€‚ <br><br> å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨è¯¥åº”ç”¨ç¨‹åºï¼š <br><br><pre> <code class="bash hljs">./out/Default/example</code> </pre> <br> å¹¶æŸ¥çœ‹Hello worldã€‚ å®é™…ä¸Šï¼Œæ‚¨å¯ä»¥æ’°å†™æœ‰å…³Chromiumä¸­è£…é…ç³»ç»Ÿçš„å¦ä¸€ç¯‡æ–‡ç« ã€‚ ä¹Ÿè®¸ä¸æ˜¯ä¸€ä¸ªã€‚ <br><br><h2> ä½¿ç”¨å‘½ä»¤è¡Œ </h2><br> ä½œä¸ºä½¿ç”¨Chromiumä»£ç åº“ä½œä¸ºæ¡†æ¶çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å»ºè®®ä½¿ç”¨å‘½ä»¤è¡Œã€‚ <br><br> ä»»åŠ¡ï¼š <i>ä»¥Chromiumæ ·å¼æ˜¾ç¤ºä¼ é€’ç»™åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å‚æ•°ã€‚</i> <br> è¦ä½¿ç”¨å‘½ä»¤è¡Œï¼Œéœ€è¦åœ¨example.ccä¸­åŒ…å«å¤´æ–‡ä»¶ï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#include "base/command_line.h"</span></span></code> </pre> <br> åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿä¸è¦å¿˜è®°åœ¨<code>BUILD.gn</code>æ·»åŠ å¯¹<code>base</code>é¡¹ç›®çš„<code>BUILD.gn</code> ã€‚  <code>BUILD.gn</code>åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><pre> <code class="cpp hljs">executable(<span class="hljs-string"><span class="hljs-string">"example"</span></span>) { sources = [ <span class="hljs-string"><span class="hljs-string">"example.cc"</span></span>, ] deps = [ <span class="hljs-string"><span class="hljs-string">"//base"</span></span>, ] }</code> </pre> <br> ç°åœ¨ï¼Œæ‚¨éœ€è¦çš„æ‰€æœ‰å†…å®¹éƒ½å°†è¿æ¥åˆ°<code>example</code> ã€‚ <br><br> ä¸ºäº†ä½¿ç”¨å‘½ä»¤è¡Œï¼ŒChromiumæä¾›äº†ä¸€ä¸ªå•ä¾‹<code>base::CommandLine</code> ã€‚ è¦è·å¾—é“¾æ¥ï¼Œæ‚¨éœ€è¦ä½¿ç”¨é™æ€æ–¹æ³•<code>base::CommandLine::ForCurrentProcess</code> ï¼Œä½†æ˜¯é¦–å…ˆæ‚¨éœ€è¦ä½¿ç”¨<code>base::CommandLine::Init</code>æ–¹æ³•å¯¹å…¶è¿›è¡Œ<code>base::CommandLine::Init</code> ï¼š <br><br><pre> <code class="cpp hljs">base::CommandLine::Init(argc, argv); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> *cmd_line = base::CommandLine::ForCurrentProcess();</code> </pre> <br> ä½¿ç”¨<code>GetSwitches</code>æ–¹æ³•å°†åœ¨å‘½ä»¤è¡Œ<code>GetSwitches</code>åº”ç”¨ç¨‹åºå¹¶ä»¥<code>-</code>å¼€å¤´çš„æ‰€æœ‰å‚æ•°ä½œä¸º<code>base::SwitchMap</code> ï¼ˆæœ¬è´¨<code>map&lt;string, string&gt;</code>æ˜¯<code>map&lt;string, string&gt;</code> ï¼‰ <code>GetSwitches</code> ã€‚ æ‰€æœ‰å…¶ä»–å‚æ•°éƒ½ä»¥<code>base::StringVector</code> ï¼ˆæœ¬è´¨ä¸Šæ˜¯<code>vectr&lt;strig&gt;</code> ï¼‰è¿”å›ã€‚ è¿™äº›çŸ¥è¯†è¶³ä»¥å®ç°è¯¥ä»»åŠ¡çš„ä»£ç ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> &amp;sw : cmd_line-&gt;GetSwitches()) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Switch "</span></span> &lt;&lt; sw.first &lt;&lt; <span class="hljs-string"><span class="hljs-string">": "</span></span> &lt;&lt; sw.second &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> &amp;arg: cmd_line-&gt;GetArgs()) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Arg "</span></span> &lt;&lt; arg &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }</code> </pre> <br> å®Œæ•´ç‰ˆæœ¬å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a>ä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰¾åˆ°</a> ã€‚ <br><br> è¦æ„å»ºå’Œè¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œæ‚¨éœ€è¦è¿è¡Œï¼š <br><br><pre> <code class="bash hljs">autoninja -C out/Default example ./out/Default/example arg1 --sw1=val1 --sw2 arg2</code> </pre> <br> å±å¹•å°†æ˜¾ç¤ºï¼š <br><br><pre> <code class="bash hljs">Switch sw1: val1 Switch sw2: Arg arg1 Arg arg2</code> </pre> <br><h2> è”ç½‘ </h2><br> ä½œä¸ºä»Šå¤©çš„ç¬¬äºŒä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å»ºè®®ä½¿ç”¨Chromiumçš„ç½‘ç»œéƒ¨åˆ†ã€‚ <br><br> ä»»åŠ¡ï¼š <i>æ˜¾ç¤ºä½œä¸ºå‚æ•°ä¼ é€’çš„URLçš„å†…å®¹</i> ã€‚ <br><br><h3> é“¬ç½‘ç»œå­ç³»ç»Ÿ </h3><br> ç½‘ç»œå­ç³»ç»Ÿéå¸¸å¤§ä¸”å¤æ‚ã€‚ å¯¹HTTPï¼ŒHTTPSï¼ŒFTPå’Œå…¶ä»–æ•°æ®èµ„æºçš„è¯·æ±‚çš„å…¥å£ç‚¹æ˜¯<code>URLRequest</code> ï¼Œå®ƒå·²ç»ç¡®å®šäº†è¦ä½¿ç”¨å“ªä¸ªå®¢æˆ·ç«¯ã€‚ ç®€åŒ–å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7d6/b9f/e45/7d6b9fe45ac8c5a47d51e4522735e5eb.png"><br><br>  <i>å®Œæ•´ç‰ˆæœ¬å¯ä»¥åœ¨<a href="">æ–‡æ¡£ä¸­</a>æ‰¾åˆ°ã€‚</i> <br><br> è¦åˆ›å»º<code>URLRequest</code>å¿…é¡»ä½¿ç”¨<code>URLRequestContext</code> ã€‚ åˆ›å»ºä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªç›¸å½“å¤æ‚çš„æ“ä½œï¼Œå› æ­¤å»ºè®®ä½¿ç”¨<code>URLRequestContextBuilder</code> ã€‚ å®ƒå°†ä½¿ç”¨é»˜è®¤å€¼åˆå§‹åŒ–æ‰€æœ‰å¿…éœ€çš„å˜é‡ï¼Œä½†æ˜¯ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥å°†å®ƒä»¬æ›´æ”¹ä¸ºè‡ªå·±çš„å˜é‡ï¼Œä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs">net::URLRequestContextBuilder context_builder; context_builder.DisableHttpCache(); context_builder.SetSpdyAndQuicEnabled(<span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-comment"><span class="hljs-comment">/* http2 */</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-comment"><span class="hljs-comment">/* quic */</span></span>); context_builder.SetCookieStore(<span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>);</code> </pre> <br><h3> å¤šçº¿ç¨‹ </h3><br>  Chromiumç½‘ç»œå †æ ˆæ—¨åœ¨åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å·¥ä½œï¼Œå› æ­¤æ‚¨ä¸èƒ½è·³è¿‡æœ¬ä¸»é¢˜ã€‚ åœ¨Chromiumä¸­ä½¿ç”¨å¤šçº¿ç¨‹çš„åŸºæœ¬å¯¹è±¡æ˜¯ï¼š <br><br><ul><li>  Task-è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œåœ¨Chromiumä¸­æ˜¯<code>base::Callback</code>ç±»å‹çš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>base::Bind</code>åˆ›å»ºã€‚ <br></li><li> ä»»åŠ¡é˜Ÿåˆ—-è¦æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—ã€‚ <br></li><li> ç‰©ç†çº¿ç¨‹-æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆPOSIXä¸Šçš„<code>pthread</code>æˆ–Windowsä¸Šçš„<code>CreateThread()</code>ä¸Šçš„è·¨å¹³å°åŒ…è£…å™¨ã€‚ åœ¨<code>base::PlatformThread</code>ç±»ä¸­å®ç°ï¼Œè¯·å‹¿ç›´æ¥ä½¿ç”¨ã€‚ <br></li><li>  base :: Thread-ä¸€ä¸ªçœŸæ­£çš„çº¿ç¨‹ï¼Œå®ƒä¸æ–­åœ°å¤„ç†æ¥è‡ªä¸“ç”¨ä»»åŠ¡é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼› ä¸å»ºè®®ç›´æ¥åˆ›å»ºå®ƒä»¬ã€‚ <br></li><li> çº¿ç¨‹æ± -å…·æœ‰å…¬å…±ä»»åŠ¡é˜Ÿåˆ—çš„çº¿ç¨‹æ± ã€‚ åœ¨<code>base::ThreadPool</code>ç±»ä¸­å®ç°ã€‚ é€šå¸¸ï¼Œåˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚ ä½¿ç”¨<code>base/task/post_task.h</code>å‡½æ•°å°†ä»»åŠ¡å‘é€ç»™å®ƒã€‚ <br></li><li> åºåˆ—æˆ–è™šæ‹Ÿçº¿ç¨‹-ä½¿ç”¨å®é™…çº¿ç¨‹å¹¶å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢çš„è™šæ‹Ÿçº¿ç¨‹ã€‚ <br></li><li> ä»»åŠ¡è¿è¡Œå™¨-ç”¨äºè®¾ç½®ä»»åŠ¡çš„æ¥å£ï¼Œåœ¨<code>base::TaskRunner</code> ã€‚ <br></li><li> é¡ºåºä»»åŠ¡è¿è¡Œç¨‹åº-ç”¨äºè®¾ç½®ä»»åŠ¡çš„ç•Œé¢ï¼Œå¯ç¡®ä¿ä»»åŠ¡æŒ‰ç…§åˆ°è¾¾æ—¶çš„é¡ºåºæ‰§è¡Œã€‚ åœ¨<code>base::SequencedTaskRunner</code>ç±»ä¸­å®ç°ã€‚ <br></li><li> å•çº¿ç¨‹ä»»åŠ¡è¿è¡Œç¨‹åº-ä¸ä¸Šä¸€ä¸ªä»»åŠ¡è¿è¡Œç¨‹åºç›¸ä¼¼ï¼Œä½†ä¿è¯æ‰€æœ‰ä»»åŠ¡å°†åœ¨ä¸€ä¸ªOSçº¿ç¨‹ä¸­æ‰§è¡Œã€‚ åœ¨<code>base::SingleThreadTaskRunner</code> ã€‚ <br></li></ul><br><h3> å®ä½œ </h3><br> æŸäº›Chromiumç»„ä»¶è¦æ±‚å­˜åœ¨<code>base::AtExitManager</code>è¿™æ˜¯ä¸€ä¸ªç±»ï¼Œå…è®¸æ‚¨æ³¨å†Œåœ¨åº”ç”¨ç¨‹åºç»ˆæ­¢æ—¶å¿…é¡»æ‰§è¡Œçš„æ“ä½œã€‚ ä½¿ç”¨å®ƒéå¸¸ç®€å•ï¼Œæ‚¨éœ€è¦åœ¨å †æ ˆä¸Šåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼š <br><br><pre> <code class="cpp hljs">base::AtExitManager exit_manager;</code> </pre> <br> å½“<code>exit_manager</code>è¶…å‡ºèŒƒå›´æ—¶ï¼Œå°†æ‰§è¡Œæ‰€æœ‰å·²æ³¨å†Œçš„å›è°ƒã€‚ <br><br> ç°åœ¨ï¼Œæ‚¨éœ€è¦æ³¨æ„ç½‘ç»œå­ç³»ç»Ÿæ‰€æœ‰å¿…éœ€çš„å¤šçº¿ç¨‹ç»„ä»¶çš„å¯ç”¨æ€§ã€‚ ä¸ºæ­¤ï¼Œåˆ›å»ºä¸€ä¸ª<code>Thread pool</code> ï¼Œç±»å‹ä¸º<code>TYPE_IO</code> <code>Message loop</code> ï¼ˆç”¨äºå¤„ç†ç½‘ç»œæ¶ˆæ¯ï¼‰å’Œ<code>Run loop</code> ï¼ˆä¸»ç¨‹åºå¾ªç¯ï¼‰ï¼š <br><br><pre> <code class="cpp hljs">base::ThreadPool::CreateAndStartWithDefaultParams(<span class="hljs-string"><span class="hljs-string">"downloader"</span></span>); base::<span class="hljs-function"><span class="hljs-function">MessageLoop </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">msg_loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(base::MessageLoop::TYPE_IO)</span></span></span></span>; base::RunLoop run_loop;</code> </pre> <br> æ¥ä¸‹æ¥ï¼Œä½¿ç”¨<code>Context builder</code>åˆ›å»ºä¸€ä¸ª<code>Context</code> ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> ctx = net::URLRequestContextBuilder().Build();</code> </pre> <br> è¦å‘é€è¯·æ±‚ï¼Œå¿…é¡»ä½¿ç”¨<code>ctx</code>å¯¹è±¡çš„<code>CreateRequest</code>æ–¹æ³•åˆ›å»º<code>URLRequest</code>å¯¹è±¡ã€‚ ä¼ é€’äº†ä»¥ä¸‹å‚æ•°ï¼š <br><br><ul><li>  URLï¼Œç±»å‹ä¸ºGURLçš„å­—ç¬¦ä¸²ï¼› <br></li><li> ä¼˜å…ˆæƒ <br></li><li> å¤„ç†äº‹ä»¶çš„å§”æ‰˜ã€‚ <br></li></ul><br> å§”æ‰˜æ˜¯å®ç°<code>net::URLRequest::Delegate</code>æ¥å£çš„ç±»ã€‚ å¯¹äºæ­¤ä»»åŠ¡ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyDelegate</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> net::URLRequest::Delegate { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">explicit</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyDelegate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(base::Closure quit_closure)</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quit_closure_</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::move(quit_closure))</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buf_</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(base::MakeRefCounted&lt;net::IOBuffer&gt;(BUF_SZ))</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnReceivedRedirect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(net::URLRequest *request, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> net::RedirectInfo &amp;redirect_info, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *defer_redirect)</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"redirect to "</span></span> &lt;&lt; redirect_info.new_url &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnAuthRequired</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(net::URLRequest* request, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> net::AuthChallengeInfo&amp; auth_info)</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"auth req"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCertificateRequested</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(net::URLRequest *request, net::SSLCertRequestInfo *cert_request_info)</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"cert req"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnSSLCertificateError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(net::URLRequest* request, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> net_error, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> net::SSLInfo&amp; ssl_info, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fatal)</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"cert err"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnResponseStarted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(net::URLRequest *request, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> net_error)</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"resp started"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> n = request-&gt;Read(buf_.get(), BUF_SZ); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"resp read "</span></span> &lt;&lt; n &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n == net::ERR_IO_PENDING) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { OnReadCompleted(request, n); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(buf_-&gt;data(), n) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnReadCompleted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(net::URLRequest *request, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bytes_read)</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"completed"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; quit_closure_.Run(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: base::Closure quit_closure_; scoped_refptr&lt;net::IOBuffer&gt; buf_; };</code> </pre> <br> æ‰€æœ‰ä¸»è¦é€»è¾‘éƒ½åœ¨<code>OnResponseStarted</code>äº‹ä»¶<code>OnResponseStarted</code> ï¼šå‡å»å“åº”çš„å†…å®¹ï¼Œç›´åˆ°å‘ç”Ÿé”™è¯¯æˆ–æ²¡æœ‰è¦è¯»å–çš„å†…å®¹ä¸ºæ­¢ã€‚ ç”±äºè¯»å–å“åº”åï¼Œæ‚¨éœ€è¦å®Œæˆåº”ç”¨ç¨‹åºï¼Œå› æ­¤å§”æ‰˜äººå¿…é¡»æœ‰æƒè®¿é—®å°†ä¸­æ–­ä¸»<code>Run loop</code>çš„å‡½æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨<code>base::Closure</code>ç±»å‹çš„å›è°ƒã€‚ <br><br> ç°åœ¨ä¸€åˆ‡å°±ç»ªï¼Œå¯ä»¥å‘é€è¯·æ±‚äº†ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">MyDelegate </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delegate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(run_loop.QuitClosure())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> req = ctx-&gt;CreateRequest(GURL(args[<span class="hljs-number"><span class="hljs-number">0</span></span>]), net::RequestPriority::DEFAULT_PRIORITY, &amp;delegate); req-&gt;Start();</code> </pre> <br> ä¸ºäº†å¼€å§‹å¤„ç†è¯·æ±‚ï¼Œæ‚¨éœ€è¦è¿è¡Œ<code>Run loop</code> ï¼š <br><br><pre> <code class="cpp hljs">run_loop.Run();</code> </pre> <br> å®Œæ•´ç‰ˆæœ¬å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a>ä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰¾åˆ°</a> ã€‚ <br><br> è¦æ„å»ºå’Œè¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œæ‚¨éœ€è¦è¿è¡Œï¼š <br><br><pre> <code class="bash hljs">autoninja -C out/Default example out/Default/example <span class="hljs-string"><span class="hljs-string">"https://example.com/"</span></span></code> </pre> <br><h2> å†³èµ› </h2><br> å®é™…ä¸Šï¼Œåœ¨Chromiumä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°è®¸å¤šæœ‰ç”¨çš„å¤šç»´æ•°æ®é›†å’Œç§¯æœ¨ï¼Œæ‚¨å¯ä»¥ä»ä¸­æ„å»ºåº”ç”¨ç¨‹åºã€‚ å®ƒåœ¨ä¸æ–­å‘å±•ï¼Œä¸€æ–¹é¢æ˜¯ä¸€ä¸ªä¼˜ç‚¹ï¼Œå¦ä¸€æ–¹é¢ï¼Œå¯¹APIè¿›è¡Œå®šæœŸæ›´æ”¹ä¸ä¼šè®©æ‚¨æ”¾æ¾ã€‚ ä¾‹å¦‚ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œå¹¸è¿çš„æ˜¯å°†<code>base::TaskScheduler</code>æ›´æ”¹ä¸º<code>base::ThreadPool</code> ï¼Œè€Œæ— éœ€æ›´æ”¹APIã€‚ <br><br>  PSæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾æˆ‘ä»¬å›¢é˜Ÿä¸­é¢†å…ˆçš„C ++ç¨‹åºå‘˜ï¼ å¦‚æœæ‚¨æ„Ÿåˆ°è‡ªå·±æœ‰åŠ›é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™é‡Œæè¿°äº†æˆ‘ä»¬çš„æ„¿æœ›ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">team.mail.ru/vacancy/4641/</a> ã€‚ è¿˜æœ‰ä¸€ä¸ªâ€œå“åº”â€æŒ‰é’®ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN455956/">https://habr.com/ru/post/zh-CN455956/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN455944/index.html">ä¸è‡ªç”±èŒä¸šè€…ä¸€èµ·å·¥ä½œã€‚ å­¦ä¹ å››å¤„èµ°åŠ¨</a></li>
<li><a href="../zh-CN455946/index.html">Google Playä¸Šçš„ç¦æ­¢å†…å®¹-ç”Ÿå­˜ä»»åŠ¡</a></li>
<li><a href="../zh-CN455948/index.html">RAMBleedï¼šåœ¨34å°æ—¶å†…æ£€ç´¢RSAå¯†é’¥</a></li>
<li><a href="../zh-CN455950/index.html">æœ€ç¨€æœ‰å’Œæœ€æ˜‚è´µçš„ç¼–ç¨‹è¯­è¨€ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN455952/index.html">Roslynçš„ä»£ç ç”Ÿæˆ</a></li>
<li><a href="../zh-CN455958/index.html">ä¸æ–­å‘å±•çš„ç»†èƒè‡ªåŠ¨æœº</a></li>
<li><a href="../zh-CN455960/index.html">å¼€å‘äººå‘˜ç¦»å¼€çš„åŸå› ï¼š8ä¸ªåŸå› </a></li>
<li><a href="../zh-CN455962/index.html">æ•°æ®ç§‘å­¦ä¸çƒ­å¸¦ä¼šè®®</a></li>
<li><a href="../zh-CN455966/index.html">è‹±å›½æ’åå‰äº”çš„ç§»åŠ¨åº”ç”¨å¼€å‘å…¬å¸</a></li>
<li><a href="../zh-CN455968/index.html">æˆ‘ç”¨25ä¸‡å¢å¸ƒï¼ˆ1ä¸ªé›¶ä»¶ï¼‰åœ¨å¤ªé˜³èƒ½ç”µæ± æ¿ä¸Šåšä¸€ä¸ªåŠé½¿è½®</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>