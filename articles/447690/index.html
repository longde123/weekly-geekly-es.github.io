<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîû üë®‚Äç‚öïÔ∏è ‚ö±Ô∏è Configuraci√≥n compilable de un sistema distribuido üì´ üë®üèø‚Äçü§ù‚Äçüë®üèª üí∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En esta publicaci√≥n nos gustar√≠a compartir una forma interesante de lidiar con la configuraci√≥n de un sistema distribuido. 
 La configuraci√≥n se repre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Configuraci√≥n compilable de un sistema distribuido</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/primetalk/blog/447690/"><p>  En esta publicaci√≥n nos gustar√≠a compartir una forma interesante de lidiar con la configuraci√≥n de un sistema distribuido. <br>  La configuraci√≥n se representa directamente en lenguaje Scala de forma segura.  Un ejemplo de implementaci√≥n se describe en detalle.  Se discuten varios aspectos de la propuesta, incluida la influencia en el proceso general de desarrollo. </p><br><p><img src="https://habrastorage.org/webt/71/bl/ax/71blaxtldz-ia4yftyebaxbam7c.png" alt="Proceso de gesti√≥n de configuraci√≥n general"></p><br><p>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en ruso</a> ) </p><a name="habracut"></a><br><h3 id="introduction">  Introduccion </h3><br><p>  La construcci√≥n de sistemas distribuidos robustos requiere el uso de una configuraci√≥n correcta y coherente en todos los nodos.  Una soluci√≥n t√≠pica es utilizar una descripci√≥n de implementaci√≥n textual (terraform, ansible o similar) y archivos de configuraci√≥n generados autom√°ticamente (a menudo, dedicados para cada nodo / rol).  Tambi√©n nos gustar√≠a usar los mismos protocolos de las mismas versiones en cada nodo de comunicaci√≥n (de lo contrario, experimentar√≠amos problemas de incompatibilidad).  En el mundo JVM, esto significa que al menos la biblioteca de mensajer√≠a debe ser de la misma versi√≥n en todos los nodos comunicantes. </p><br><p>  ¬øQu√© hay de probar el sistema?  Por supuesto, deber√≠amos realizar pruebas unitarias para todos los componentes antes de realizar las pruebas de integraci√≥n.  Para poder extrapolar los resultados de las pruebas en tiempo de ejecuci√≥n, debemos asegurarnos de que las versiones de todas las bibliotecas se mantengan id√©nticas tanto en el tiempo de ejecuci√≥n como en los entornos de prueba. </p><br><p>  Al ejecutar pruebas de integraci√≥n, a menudo es mucho m√°s f√°cil tener el mismo classpath en todos los nodos.  Solo necesitamos asegurarnos de que se use el mismo classpath en la implementaci√≥n.  (Es posible usar diferentes classpaths en diferentes nodos, pero es m√°s dif√≠cil representar esta configuraci√≥n y desplegarla correctamente). Entonces, para mantener las cosas simples, solo consideraremos classpaths id√©nticos en todos los nodos. </p><br><p>  La configuraci√≥n tiende a evolucionar junto con el software.  Usualmente usamos versiones para identificar varios <br>  etapas de la evoluci√≥n del software.  Parece razonable cubrir la configuraci√≥n bajo la gesti√≥n de versiones e identificar diferentes configuraciones con algunas etiquetas.  Si solo hay una configuraci√≥n en producci√≥n, podemos usar una versi√≥n √∫nica como identificador.  A veces podemos tener m√∫ltiples entornos de producci√≥n.  Y para cada entorno podr√≠amos necesitar una rama de configuraci√≥n separada.  Por lo tanto, las configuraciones pueden etiquetarse con rama y versi√≥n para identificar de manera √∫nica las diferentes configuraciones.  Cada etiqueta y versi√≥n de rama corresponde a una combinaci√≥n √∫nica de nodos distribuidos, puertos, recursos externos, versiones de biblioteca classpath en cada nodo.  Aqu√≠ solo cubriremos la rama √∫nica e identificaremos configuraciones mediante una versi√≥n decimal de tres componentes (1.2.3), de la misma manera que otros artefactos. </p><br><p>  En entornos modernos, los archivos de configuraci√≥n ya no se modifican manualmente.  Normalmente generamos <br>  archivos de configuraci√≥n en el momento de la implementaci√≥n y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nunca los toque</a> despu√©s.  Entonces, uno podr√≠a preguntarse por qu√© todav√≠a usamos el formato de texto para los archivos de configuraci√≥n.  Una opci√≥n viable es colocar la configuraci√≥n dentro de una unidad de compilaci√≥n y beneficiarse de la validaci√≥n de la configuraci√≥n en tiempo de compilaci√≥n. </p><br><p>  En esta publicaci√≥n examinaremos la idea de mantener la configuraci√≥n en el artefacto compilado. </p><br><h3 id="compilable-configuration">  Configuraci√≥n compilable </h3><br><p>  En esta secci√≥n discutiremos un ejemplo de configuraci√≥n est√°tica.  Se est√°n configurando e implementando dos servicios simples: el servicio de eco y el cliente del servicio de eco.  Luego se instancian dos sistemas distribuidos diferentes con ambos servicios.  Uno es para una configuraci√≥n de un solo nodo y otro para la configuraci√≥n de dos nodos. </p><br><p>  Un sistema distribuido t√≠pico consta de unos pocos nodos.  Los nodos podr√≠an identificarse utilizando alg√∫n tipo: </p><br><pre><code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Backend</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Frontend</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span></span></code> </pre> <br><p>  o solo </p><br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">hostName: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  o incluso </p><br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Singleton</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">Singleton</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span></code> </pre> <br><p>  Estos nodos desempe√±an diversas funciones, ejecutan algunos servicios y deber√≠an poder comunicarse con los otros nodos mediante conexiones TCP / HTTP. </p><br><p>  Para la conexi√≥n TCP, se requiere al menos un n√∫mero de puerto.  Tambi√©n queremos asegurarnos de que el cliente y el servidor est√©n hablando el mismo protocolo.  Para modelar una conexi√≥n entre nodos, declaremos la siguiente clase: </p><br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TcpEndPoint</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Protocol</span></span></span><span class="hljs-class">](</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">node: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">NodeId</span></span></span></span><span class="hljs-class"><span class="hljs-params">, port: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Port</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Protocol</span></span></span></span><span class="hljs-class"><span class="hljs-params">]</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  donde <code>Port</code> es solo un <code>Int</code> dentro del rango permitido: </p><br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PortNumber</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">Refined</span></span>[<span class="hljs-type"><span class="hljs-type">Int</span></span>, <span class="hljs-type"><span class="hljs-type">Closed</span></span>[_0, <span class="hljs-type"><span class="hljs-type">W</span></span>.`<span class="hljs-number"><span class="hljs-number">65535</span></span>`.<span class="hljs-type"><span class="hljs-type">T</span></span>]]</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Tipos refinados</b> <div class="spoiler_text"><p>  Ver biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">refinada</a> .  En resumen, permite agregar restricciones de tiempo de compilaci√≥n a otros tipos.  En este caso, <code>Int</code> solo puede tener valores de 16 bits que pueden representar el n√∫mero de puerto.  No hay ning√∫n requisito para usar esta biblioteca para este enfoque de configuraci√≥n.  Simplemente parece encajar muy bien. </p></div></div><br><p>  Para HTTP (REST) ‚Äã‚Äãtambi√©n podr√≠amos necesitar una ruta del servicio: </p><br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UrlPathPrefix</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">Refined</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>, <span class="hljs-type"><span class="hljs-type">MatchesRegex</span></span>[<span class="hljs-type"><span class="hljs-type">W</span></span>.`<span class="hljs-string"><span class="hljs-string">"[a-zA-Z_0-9/]*"</span></span>`.<span class="hljs-type"><span class="hljs-type">T</span></span>]] <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PortWithPrefix</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Protocol</span></span></span><span class="hljs-class">](</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">portNumber: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">PortNumber</span></span></span></span><span class="hljs-class"><span class="hljs-params">, pathPrefix: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">UrlPathPrefix</span></span></span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Tipo fantasma</b> <div class="spoiler_text"><p>  Para identificar el protocolo durante la compilaci√≥n, estamos utilizando la funci√≥n Scala de declarar el <code>Protocol</code> argumento de tipo que no se usa en la clase.  Es un <em>tipo</em> llamado <em>fantasma</em> .  En tiempo de ejecuci√≥n raramente necesitamos una instancia de identificador de protocolo, por eso no la almacenamos.  Durante la compilaci√≥n, este tipo fantasma proporciona seguridad de tipo adicional.  No podemos pasar el puerto con un protocolo incorrecto. </p></div></div><br><p>  Uno de los protocolos m√°s utilizados es REST API con serializaci√≥n Json: </p><br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JsonHttpRestProtocol</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RequestMessage</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ResponseMessage</span></span></span><span class="hljs-class">]</span></span></code> </pre> <br><p>  donde <code>RequestMessage</code> es el tipo base de mensajes que el cliente puede enviar al servidor y <code>ResponseMessage</code> es el mensaje de respuesta del servidor.  Por supuesto, podemos crear otras descripciones de protocolo que especifiquen el protocolo de comunicaci√≥n con la precisi√≥n deseada. </p><br><p>  A los fines de esta publicaci√≥n, utilizaremos una versi√≥n m√°s simple del protocolo: </p><br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleHttpGetRest</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RequestMessage</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ResponseMessage</span></span></span><span class="hljs-class">]</span></span></code> </pre> <br><p>  En este protocolo, el mensaje de solicitud se agrega a la URL y el mensaje de respuesta se devuelve como una cadena simple. </p><br><p>  Una configuraci√≥n de servicio podr√≠a describirse por el nombre del servicio, una colecci√≥n de puertos y algunas dependencias.  Hay algunas formas posibles de c√≥mo representar todos estos elementos en Scala (por ejemplo, <code>HList</code> , tipos de datos algebraicos).  Para los fines de esta publicaci√≥n, utilizaremos Cake Pattern y representaremos piezas combinables (m√≥dulos) como rasgos.  (Cake Pattern no es un requisito para este enfoque de configuraci√≥n compilable. Es solo una posible implementaci√≥n de la idea). </p><br><p>  Las dependencias podr√≠an representarse utilizando el patr√≥n de pastel como puntos finales de otros nodos: </p><br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoProtocol</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">A</span></span></span><span class="hljs-class">] </span></span>= <span class="hljs-type"><span class="hljs-type">SimpleHttpGetRest</span></span>[<span class="hljs-type"><span class="hljs-type">A</span></span>, <span class="hljs-type"><span class="hljs-type">A</span></span>] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoConfig</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">A</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ServiceConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">portNumber</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">PortNumber</span></span> = <span class="hljs-number"><span class="hljs-number">8081</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">echoPort</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">PortWithPrefix</span></span>[<span class="hljs-type"><span class="hljs-type">EchoProtocol</span></span>[<span class="hljs-type"><span class="hljs-type">A</span></span>]] = <span class="hljs-type"><span class="hljs-type">PortWithPrefix</span></span>[<span class="hljs-type"><span class="hljs-type">EchoProtocol</span></span>[<span class="hljs-type"><span class="hljs-type">A</span></span>]](portNumber, <span class="hljs-string"><span class="hljs-string">"echo"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">echoService</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">HttpSimpleGetEndPoint</span></span>[<span class="hljs-type"><span class="hljs-type">NodeId</span></span>, <span class="hljs-type"><span class="hljs-type">EchoProtocol</span></span>[<span class="hljs-type"><span class="hljs-type">A</span></span>]] = providedSimpleService(echoPort) }</code> </pre> <br><p>  El servicio de eco solo necesita un puerto configurado.  Y declaramos que este puerto es compatible con el protocolo de eco.  Tenga en cuenta que no necesitamos especificar un puerto en particular en este momento, porque los rasgos permiten declaraciones de m√©todos abstractos.  Si usamos m√©todos abstractos, el compilador requerir√° una implementaci√≥n en una instancia de configuraci√≥n.  Aqu√≠ hemos proporcionado la implementaci√≥n ( <code>8081</code> ) y se usar√° como valor predeterminado si la omitimos en una configuraci√≥n concreta. </p><br><p>  Podemos declarar una dependencia en la configuraci√≥n del cliente del servicio echo: </p><br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoClientConfig</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">A</span></span></span><span class="hljs-class">] </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testMessage</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-string"><span class="hljs-string">"test"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pollInterval</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">FiniteDuration</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">echoServiceDependency</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">HttpSimpleGetEndPoint</span></span>[_, <span class="hljs-type"><span class="hljs-type">EchoProtocol</span></span>[<span class="hljs-type"><span class="hljs-type">A</span></span>]] }</code> </pre> <br><p>  La dependencia tiene el mismo tipo que <code>echoService</code> .  En particular, exige el mismo protocolo.  Por lo tanto, podemos estar seguros de que si conectamos estas dos dependencias, funcionar√°n correctamente. </p><br><div class="spoiler">  <b class="spoiler_title">Implementaci√≥n de servicios</b> <div class="spoiler_text"><p>  Un servicio necesita una funci√≥n para iniciarse y cerrarse con gracia.  (La capacidad de cerrar un servicio es cr√≠tica para las pruebas). De nuevo, hay algunas opciones para especificar dicha funci√≥n para una configuraci√≥n dada (por ejemplo, podr√≠amos usar clases de tipo).  Para esta publicaci√≥n usaremos nuevamente Cake Pattern.  Podemos representar un servicio usando <code>cats.Resource</code> que ya proporciona bracketing y liberaci√≥n de recursos.  Para adquirir un recurso, debemos proporcionar una configuraci√≥n y un contexto de tiempo de ejecuci√≥n.  Entonces la funci√≥n de inicio del servicio podr√≠a verse as√≠: </p><br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResourceReader</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class">[_], </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class">] </span></span>= <span class="hljs-type"><span class="hljs-type">Reader</span></span>[<span class="hljs-type"><span class="hljs-type">Config</span></span>, <span class="hljs-type"><span class="hljs-type">Resource</span></span>[<span class="hljs-type"><span class="hljs-type">F</span></span>, <span class="hljs-type"><span class="hljs-type">A</span></span>]] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ServiceImpl</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class">[_]] </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">resource</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"> implicit resolver: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">AddressResolver</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">F</span></span></span></span><span class="hljs-class"><span class="hljs-params">], timer: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Timer</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">F</span></span></span></span><span class="hljs-class"><span class="hljs-params">], contextShift: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">ContextShift</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">F</span></span></span></span><span class="hljs-class"><span class="hljs-params">], ec: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">ExecutionContext</span></span></span></span><span class="hljs-class"><span class="hljs-params">, applicative: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Applicative</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">F</span></span></span></span><span class="hljs-class"><span class="hljs-params">] </span></span></span><span class="hljs-class">)</span></span>: <span class="hljs-type"><span class="hljs-type">ResourceReader</span></span>[<span class="hljs-type"><span class="hljs-type">F</span></span>, <span class="hljs-type"><span class="hljs-type">Config</span></span>, <span class="hljs-type"><span class="hljs-type">Unit</span></span>] }</code> </pre> <br><p>  donde </p><br><ul><li>  <code>Config</code> : tipo de configuraci√≥n que requiere este iniciador de servicio </li><li>  <code>AddressResolver</code> : un objeto de tiempo de ejecuci√≥n que tiene la capacidad de obtener direcciones reales de otros nodos (sigue leyendo para obtener m√°s detalles). </li></ul><br><p>  los otros tipos provienen de <code>cats</code> : </p><br><ul><li>  <code>F[_]</code> - tipo de efecto (en el caso m√°s simple <code>F[A]</code> podr√≠a ser solo <code>() =&gt; A</code> En esta publicaci√≥n usaremos <code>cats.IO</code> ) </li><li>  <code>Reader[A,B]</code> - es m√°s o menos un sin√≥nimo de una funci√≥n <code>A =&gt; B</code> </li><li>  <code>cats.Resource</code> : tiene formas de adquirir y liberar </li><li>  <code>Timer</code> : permite dormir / medir el tiempo </li><li>  <code>ContextShift</code> - an√°logo de <code>ExecutionContext</code> </li><li>  <code>Applicative</code> : envoltorio de funciones en efecto (casi una m√≥nada) (eventualmente podr√≠amos reemplazarlo por otra cosa) </li></ul><br><p>  Usando esta interfaz podemos implementar algunos servicios.  Por ejemplo, un servicio que no hace nada: </p><br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ZeroServiceImpl</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class">[_]] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ServiceImpl</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class">] </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">&lt;</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">Any</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resource</span></span></span></span>(...): <span class="hljs-type"><span class="hljs-type">ResourceReader</span></span>[<span class="hljs-type"><span class="hljs-type">F</span></span>, <span class="hljs-type"><span class="hljs-type">Config</span></span>, <span class="hljs-type"><span class="hljs-type">Unit</span></span>] = <span class="hljs-type"><span class="hljs-type">Reader</span></span>(_ =&gt; <span class="hljs-type"><span class="hljs-type">Resource</span></span>.pure[<span class="hljs-type"><span class="hljs-type">F</span></span>, <span class="hljs-type"><span class="hljs-type">Unit</span></span>](())) }</code> </pre> </div></div><br><p>  (Consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥digo fuente</a> para otras implementaciones de servicios: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">servicio echo</a> , <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cliente echo</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">controladores de por vida</a> .) </p><br><p>  Un nodo es un objeto √∫nico que ejecuta algunos servicios (Cake Pattern habilita el inicio de una cadena de recursos): </p><br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleNodeImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ZeroServiceImpl</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IO</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoServiceService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoClientService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FiniteDurationLifecycleServiceImpl</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">EchoConfig</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-type"><span class="hljs-type">EchoClientConfig</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-type"><span class="hljs-type">FiniteDurationLifecycleConfig</span></span> }</code> </pre> <br><p>  Tenga en cuenta que en el nodo especificamos el tipo exacto de configuraci√≥n que necesita este nodo.  El compilador no nos permitir√° construir el objeto (Cake) con un tipo insuficiente, porque cada rasgo de servicio declara una restricci√≥n en el tipo de <code>Config</code> .  Adem√°s, no podremos iniciar el nodo sin proporcionar una configuraci√≥n completa. </p><br><div class="spoiler">  <b class="spoiler_title">Resoluci√≥n de direcci√≥n de nodo</b> <div class="spoiler_text"><p>  Para establecer una conexi√≥n, necesitamos una direcci√≥n de host real para cada nodo.  Puede ser conocido m√°s tarde que otras partes de la configuraci√≥n.  Por lo tanto, necesitamos una forma de proporcionar un mapeo entre la identificaci√≥n del nodo y su direcci√≥n real.  Este mapeo es una funci√≥n: </p><br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeAddress</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">NodeId</span></span></span><span class="hljs-class">](</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">host: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Uri</span></span></span></span><span class="hljs-class"><span class="hljs-params">.</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Host</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">trait</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddressResolver</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class">[_]] </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolve</span></span></span></span>[<span class="hljs-type"><span class="hljs-type">NodeId</span></span>](nodeId: <span class="hljs-type"><span class="hljs-type">NodeId</span></span>): <span class="hljs-type"><span class="hljs-type">F</span></span>[<span class="hljs-type"><span class="hljs-type">NodeAddress</span></span>[<span class="hljs-type"><span class="hljs-type">NodeId</span></span>]] }</code> </pre> <br><p>  Hay algunas formas posibles de implementar dicha funci√≥n. </p><br><ol><li>  Si conocemos las direcciones reales antes de la implementaci√≥n, durante la creaci√≥n de instancias de hosts de nodo, podemos generar c√≥digo Scala con las direcciones reales y ejecutar la compilaci√≥n despu√©s (que realiza comprobaciones de tiempo de compilaci√≥n y luego ejecuta el conjunto de pruebas de integraci√≥n).  En este caso, nuestra funci√≥n de mapeo se conoce est√°ticamente y se puede simplificar a algo as√≠ como un <code>Map[NodeId, NodeAddress]</code> . </li><li>  A veces obtenemos direcciones reales solo en un momento posterior cuando el nodo se inicia realmente, o no tenemos direcciones de nodos que a√∫n no se han iniciado.  En este caso, podr√≠amos tener un servicio de descubrimiento que se inicia antes que todos los dem√°s nodos y cada nodo podr√≠a anunciar su direcci√≥n en ese servicio y suscribirse a las dependencias. </li><li>  Si podemos modificar <code>/etc/hosts</code> , podemos usar nombres de host predefinidos (como <code>my-project-main-node</code> y <code>echo-backend</code> ) y simplemente asociar este nombre con la direcci√≥n IP en el momento de la implementaci√≥n. </li></ol><br><p>  En esta publicaci√≥n no cubrimos estos casos con m√°s detalles.  De hecho, en nuestro ejemplo de juguete, todos los nodos tendr√°n la misma direcci√≥n IP: <code>127.0.0.1</code> . </p></div></div><br><p>  En esta publicaci√≥n consideraremos dos dise√±os de sistemas distribuidos: </p><br><ol><li>  Dise√±o de nodo √∫nico, donde todos los servicios se colocan en el nodo √∫nico. </li><li>  Dise√±o de dos nodos, donde el servicio y el cliente est√°n en nodos diferentes. </li></ol><br><p>  La configuraci√≥n para un dise√±o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nodo √∫nico</a> es la siguiente: </p><br><div class="spoiler">  <b class="spoiler_title">Configuraci√≥n de nodo √∫nico</b> <div class="spoiler_text"><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleNodeConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoConfig</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoClientConfig</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FiniteDurationLifecycleConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Singleton</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">//</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">identifier</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">the</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">single</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">node</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">//</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">configuration</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">server</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">Singleton</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nodeId</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-type"><span class="hljs-type">Singleton</span></span> <span class="hljs-comment"><span class="hljs-comment">/** Type safe service port specification. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">portNumber</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">PortNumber</span></span> = <span class="hljs-number"><span class="hljs-number">8088</span></span> <span class="hljs-comment"><span class="hljs-comment">// configuration of client /** We'll use the service provided by the same host. */ def echoServiceDependency = echoService override def testMessage: UrlPathElement = "hello" def pollInterval: FiniteDuration = 1.second // lifecycle controller configuration def lifetime: FiniteDuration = 10500.milliseconds // additional 0.5 seconds so that there are 10 requests, not 9. }</span></span></code> </pre> </div></div><br><p>  Aqu√≠ creamos una configuraci√≥n √∫nica que extiende la configuraci√≥n del servidor y del cliente.  Tambi√©n configuramos un controlador de ciclo de vida que normalmente terminar√° el cliente y el servidor despu√©s de que pase el intervalo de por <code>lifetime</code> . </p><br><p>  Se puede usar el mismo conjunto de implementaciones y configuraciones de servicios para crear el dise√±o de un sistema con dos nodos separados.  Solo necesitamos crear <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dos configuraciones de nodo separadas</a> con los servicios apropiados: </p><br><div class="spoiler">  <b class="spoiler_title">Configuraci√≥n de dos nodos</b> <div class="spoiler_text"><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeServerConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoConfig</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SigTermLifecycleConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeId</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">NodeIdImpl</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nodeId</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-type"><span class="hljs-type">NodeServer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">portNumber</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">PortNumber</span></span> = <span class="hljs-number"><span class="hljs-number">8080</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NodeClientConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoClientConfig</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FiniteDurationLifecycleConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// NB! dependency specification def echoServiceDependency = NodeServerConfig.echoService def pollInterval: FiniteDuration = 1.second def lifetime: FiniteDuration = 10500.milliseconds // additional 0.5 seconds so that there are 10 request, not 9. def testMessage: String = "dolly" }</span></span></code> </pre> </div></div><br><p>  Vea c√≥mo especificamos la dependencia.  Mencionamos el servicio proporcionado por el otro nodo como una dependencia del nodo actual.  El tipo de dependencia se verifica porque contiene un tipo fantasma que describe el protocolo.  Y en tiempo de ejecuci√≥n tendremos la identificaci√≥n de nodo correcta.  Este es uno de los aspectos importantes del enfoque de configuraci√≥n propuesto.  Nos brinda la capacidad de configurar el puerto solo una vez y asegurarnos de que estamos haciendo referencia al puerto correcto. </p><br><div class="spoiler">  <b class="spoiler_title">Implementaci√≥n de dos nodos</b> <div class="spoiler_text"><p>  Para esta configuraci√≥n, utilizamos exactamente las mismas implementaciones de servicios.  No hay cambios en absoluto.  Sin embargo, creamos dos implementaciones de nodos diferentes que contienen diferentes conjuntos de servicios: </p><br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TwoJvmNodeServerImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ZeroServiceImpl</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IO</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoServiceService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SigIntLifecycleServiceImpl</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">EchoConfig</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-type"><span class="hljs-type">SigTermLifecycleConfig</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TwoJvmNodeClientImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ZeroServiceImpl</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IO</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EchoClientService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FiniteDurationLifecycleServiceImpl</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-type"><span class="hljs-type">EchoClientConfig</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-type"><span class="hljs-type">FiniteDurationLifecycleConfig</span></span> }</code> </pre> <br><p>  El primer nodo implementa el servidor y solo necesita la configuraci√≥n del lado del servidor.  El segundo nodo implementa el cliente y necesita otra parte de la configuraci√≥n.  Ambos nodos requieren alguna especificaci√≥n de por vida.  A los efectos de este nodo de servicio posterior, tendr√° una vida √∫til infinita que podr√≠a finalizar utilizando <code>SIGTERM</code> , mientras que el cliente de eco finalizar√° despu√©s de la duraci√≥n finita configurada.  Vea la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aplicaci√≥n de inicio</a> para m√°s detalles. </p></div></div><br><h4 id="overall-development-process">  Proceso de desarrollo general </h4><br><p>  Veamos c√≥mo este enfoque cambia la forma en que trabajamos con la configuraci√≥n. </p><br><p>  La configuraci√≥n como c√≥digo se compilar√° y producir√° un artefacto.  Parece razonable separar los artefactos de configuraci√≥n de otros artefactos de c√≥digo.  A menudo podemos tener multitud de configuraciones en la misma base de c√≥digo.  Y, por supuesto, podemos tener m√∫ltiples versiones de varias ramas de configuraci√≥n.  En una configuraci√≥n podemos seleccionar versiones particulares de bibliotecas y esto permanecer√° constante cada vez que implementemos esta configuraci√≥n. </p><br><p>  Un cambio de configuraci√≥n se convierte en cambio de c√≥digo.  Por lo tanto, debe estar cubierto por el mismo proceso de garant√≠a de calidad: </p><br><p>  Ticket -&gt; PR -&gt; revisi√≥n -&gt; fusi√≥n -&gt; integraci√≥n continua -&gt; despliegue continuo </p><br><p>  Existen las siguientes consecuencias del enfoque: </p><br><ol><li><p>  La configuraci√≥n es coherente para la instancia de un sistema particular.  Parece que no hay forma de tener una conexi√≥n incorrecta entre nodos. </p><br></li><li><p>  No es f√°cil cambiar la configuraci√≥n solo en un nodo.  Parece poco razonable iniciar sesi√≥n y cambiar algunos archivos de texto.  Entonces la deriva de la configuraci√≥n se vuelve menos posible. </p><br></li><li><p>  Peque√±os cambios de configuraci√≥n no son f√°ciles de hacer. </p><br></li><li><p>  La mayor√≠a de los cambios de configuraci√≥n seguir√°n el mismo proceso de desarrollo y pasar√°n algunas revisiones. </p><br></li></ol><br><p>  ¬øNecesitamos un repositorio separado para la configuraci√≥n de producci√≥n?  La configuraci√≥n de producci√≥n puede contener informaci√≥n confidencial que nos gustar√≠a mantener fuera del alcance de muchas personas.  Por lo tanto, podr√≠a valer la pena mantener un repositorio separado con acceso restringido que contendr√° la configuraci√≥n de producci√≥n.  Podemos dividir la configuraci√≥n en dos partes: una que contiene la mayor√≠a de los par√°metros abiertos de producci√≥n y otra que contiene la parte secreta de la configuraci√≥n.  Esto permitir√≠a el acceso de la mayor√≠a de los desarrolladores a la gran mayor√≠a de los par√°metros y restringir√≠a el acceso a cosas realmente sensibles.  Es f√°cil lograr esto usando rasgos intermedios con valores de par√°metros predeterminados. </p><br><h3 id="variations">  Variaciones </h3><br><p>  Veamos los pros y los contras del enfoque propuesto en comparaci√≥n con las otras t√©cnicas de administraci√≥n de configuraci√≥n. </p><br><p>  En primer lugar, enumeraremos algunas alternativas a los diferentes aspectos de la forma propuesta de tratar con la configuraci√≥n: </p><br><ol><li>  Archivo de texto en la m√°quina de destino. </li><li>  Almacenamiento centralizado de valores clave (como <code>etcd</code> / <code>zookeeper</code> ). </li><li>  Componentes de subprocesos que podr√≠an reconfigurarse / reiniciarse sin reiniciar el proceso. </li><li>  Configuraci√≥n fuera del artefacto y control de versiones. </li></ol><br><p>  El archivo de texto ofrece cierta flexibilidad en t√©rminos de correcciones ad-hoc.  El administrador de un sistema puede iniciar sesi√≥n en el nodo de destino, realizar un cambio y simplemente reiniciar el servicio.  Esto podr√≠a no ser tan bueno para sistemas m√°s grandes.  No quedan rastros detr√°s del cambio.  El cambio no es revisado por otro par de ojos.  Puede ser dif√≠cil descubrir qu√© ha causado el cambio.  No ha sido probado.  Desde la perspectiva del sistema distribuido, un administrador puede simplemente olvidarse de actualizar la configuraci√≥n en uno de los otros nodos. </p><br><p>  (Por cierto, si eventualmente ser√° necesario comenzar a usar archivos de configuraci√≥n de texto, solo tendremos que agregar el analizador + validador que podr√≠a producir el mismo tipo de <code>Config</code> y eso ser√≠a suficiente para comenzar a usar configuraciones de texto. Esto tambi√©n muestra que el La complejidad de la configuraci√≥n en tiempo de compilaci√≥n es un poco menor que la complejidad de las configuraciones basadas en texto, porque en la versi√≥n basada en texto necesitamos un c√≥digo adicional). </p><br><p>  El almacenamiento centralizado de valores clave es un buen mecanismo para distribuir los metapar√°metros de la aplicaci√≥n.  Aqu√≠ debemos pensar en lo que consideramos valores de configuraci√≥n y qu√© son solo datos.  Dada una funci√≥n <code>C =&gt; A =&gt; B</code> , generalmente llamamos a los valores que cambian raramente <code>C</code> "configuraci√≥n", mientras que con frecuencia cambiamos los datos <code>A</code> , solo ingresamos datos.  La configuraci√≥n debe proporcionarse a la funci√≥n antes que los datos <code>A</code>  Dada esta idea, podemos decir que se espera que la frecuencia de los cambios se pueda utilizar para distinguir los datos de configuraci√≥n de solo datos.  Adem√°s, los datos generalmente provienen de una fuente (usuario) y la configuraci√≥n proviene de una fuente diferente (administrador).  Tratar con par√°metros que pueden cambiarse despu√©s de la inicializaci√≥n del proceso conduce a un aumento de la complejidad de la aplicaci√≥n.  Para tales par√°metros tendremos que manejar su mecanismo de entrega, an√°lisis y validaci√≥n, manejando valores incorrectos.  Por lo tanto, para reducir la complejidad del programa, ser√° mejor que reduzcamos el n√∫mero de par√°metros que pueden cambiar en tiempo de ejecuci√≥n (o incluso eliminarlos por completo). </p><br><p>  Desde la perspectiva de esta publicaci√≥n, debemos hacer una distinci√≥n entre par√°metros est√°ticos y din√°micos.  Si la l√≥gica de servicio requiere un cambio raro de algunos par√°metros en tiempo de ejecuci√≥n, entonces podemos llamarlos par√°metros din√°micos.  De lo contrario, son est√°ticos y podr√≠an configurarse utilizando el enfoque propuesto.  Para la reconfiguraci√≥n din√°mica, podr√≠an ser necesarios otros enfoques.  Por ejemplo, partes del sistema podr√≠an reiniciarse con los nuevos par√°metros de configuraci√≥n de manera similar a reiniciar procesos separados de un sistema distribuido. <br>  (Mi humilde opini√≥n es evitar la reconfiguraci√≥n en tiempo de ejecuci√≥n porque aumenta la complejidad del sistema. <br>  Podr√≠a ser m√°s sencillo confiar en el soporte del sistema operativo para reiniciar los procesos.  Sin embargo, puede que no siempre sea posible). </p><br><p>  Un aspecto importante del uso de la configuraci√≥n est√°tica que a veces hace que las personas consideren la configuraci√≥n din√°mica (sin otras razones) es el tiempo de inactividad del servicio durante la actualizaci√≥n de la configuraci√≥n.  De hecho, si tenemos que hacer cambios en la configuraci√≥n est√°tica, tenemos que reiniciar el sistema para que los nuevos valores entren en vigencia.  Los requisitos para el tiempo de inactividad var√≠an para los diferentes sistemas, por lo que podr√≠a no ser tan cr√≠tico.  Si es cr√≠tico, entonces tenemos que planificar con anticipaci√≥n cualquier reinicio del sistema.  Por ejemplo, podr√≠amos implementar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">drenaje de la conexi√≥n AWS ELB</a> .  En este escenario, siempre que necesitemos reiniciar el sistema, comenzamos una nueva instancia del sistema en paralelo, luego cambiamos a ELB, mientras dejamos que el sistema anterior complete el servicio de las conexiones existentes. </p><br><p>  ¬øQu√© hay de mantener la configuraci√≥n dentro de artefactos versionados o afuera?  Mantener la configuraci√≥n dentro de un artefacto significa en la mayor√≠a de los casos que esta configuraci√≥n ha pasado el mismo proceso de garant√≠a de calidad que otros artefactos.  Por lo tanto, uno puede estar seguro de que la configuraci√≥n es de buena calidad y confiable.  Por el contrario, la configuraci√≥n en un archivo separado significa que no hay rastros de qui√©n y por qu√© realiz√≥ cambios en ese archivo.  ¬øEs esto importante?  Creemos que para la mayor√≠a de los sistemas de producci√≥n es mejor tener una configuraci√≥n estable y de alta calidad. </p><br><p>  La versi√≥n del artefacto permite saber cu√°ndo se cre√≥, qu√© valores contiene, qu√© caracter√≠sticas est√°n habilitadas / deshabilitadas, qui√©n fue el responsable de realizar cada cambio en la configuraci√≥n.  Puede requerir cierto esfuerzo mantener la configuraci√≥n dentro de un artefacto y es una elecci√≥n de dise√±o. </p><br><h3 id="pros--cons">  Pros y contras </h3><br><p>  Aqu√≠ nos gustar√≠a resaltar algunas ventajas y discutir algunas desventajas del enfoque propuesto. </p><br><h4 id="advantages">  Ventajas </h4><br><p>  Caracter√≠sticas de la configuraci√≥n compilable de un sistema distribuido completo: </p><br><ol><li>  Comprobaci√≥n est√°tica de la configuraci√≥n.  Esto proporciona un alto nivel de confianza, que la configuraci√≥n es correcta dadas las restricciones de tipo. </li><li>  Rico lenguaje de configuraci√≥n.  T√≠picamente, otros enfoques de configuraci√≥n est√°n limitados a, como m√°ximo, una sustituci√≥n variable. <br>  El uso de Scala one puede usar una amplia gama de caracter√≠sticas del lenguaje para mejorar la configuraci√≥n.  Por ejemplo, podemos usar rasgos para proporcionar valores predeterminados, objetos para establecer un alcance diferente, podemos referirnos a <code>val</code> definidos solo una vez en el alcance externo (DRY).  Es posible usar secuencias literales o instancias de ciertas clases ( <code>Seq</code> , <code>Map</code> , etc.). </li><li>  DSL  Scala tiene un soporte decente para los escritores DSL.  Se pueden usar estas caracter√≠sticas para establecer un lenguaje de configuraci√≥n que sea m√°s conveniente y f√°cil de usar para el usuario final, de modo que la configuraci√≥n final sea al menos legible para los usuarios del dominio. </li><li>  Integridad y coherencia entre nodos.  Uno de los beneficios de tener la configuraci√≥n para todo el sistema distribuido en un solo lugar es que todos los valores se definen estrictamente una vez y luego se reutilizan en todos los lugares donde los necesitamos.  Tambi√©n escribir declaraciones de puerto seguro asegura que en todas las configuraciones correctas posibles los nodos del sistema hablen el mismo idioma.  Existen dependencias expl√≠citas entre los nodos que hacen que sea dif√≠cil olvidar proporcionar algunos servicios. </li><li>  Alta calidad de cambios.  El enfoque general de pasar los cambios de configuraci√≥n a trav√©s del proceso normal de relaciones p√∫blicas establece altos est√°ndares de calidad tambi√©n en la configuraci√≥n. </li><li>  Cambios de configuraci√≥n simult√°neos.  Cada vez que realizamos cambios en la configuraci√≥n, la implementaci√≥n autom√°tica garantiza que todos los nodos se actualicen. </li><li>  Simplificaci√≥n de la aplicaci√≥n.  La aplicaci√≥n no necesita analizar y validar la configuraci√≥n y manejar valores de configuraci√≥n incorrectos.  Esto simplifica la aplicaci√≥n general.  (Un cierto aumento de la complejidad est√° en la configuraci√≥n en s√≠, pero es una compensaci√≥n consciente hacia la seguridad). Es bastante sencillo volver a la configuraci√≥n normal, solo agregue las piezas que faltan.  Es m√°s f√°cil comenzar con la configuraci√≥n compilada y posponer la implementaci√≥n de piezas adicionales para algunos momentos posteriores. </li><li>  Configuraci√≥n versionada.  Debido al hecho de que los cambios de configuraci√≥n siguen el mismo proceso de desarrollo, como resultado obtenemos un artefacto con una versi√≥n √∫nica.  Nos permite cambiar la configuraci√≥n de nuevo si es necesario.  Incluso podemos implementar una configuraci√≥n que se utiliz√≥ hace un a√±o y funcionar√° exactamente de la misma manera.  La configuraci√≥n estable mejora la previsibilidad y la fiabilidad del sistema distribuido.  La configuraci√≥n se fija en tiempo de compilaci√≥n y no se puede manipular f√°cilmente en un sistema de producci√≥n. </li><li>  Modularidad  El marco propuesto es modular y los m√≥dulos se pueden combinar de varias maneras para <br>  admite diferentes configuraciones (configuraciones / dise√±os).  En particular, es posible tener un dise√±o de nodo √∫nico a peque√±a escala y una configuraci√≥n de nodo m√∫ltiple a gran escala.  Es razonable tener m√∫ltiples dise√±os de producci√≥n. </li><li>  Prueba  Para fines de prueba, uno podr√≠a implementar un servicio simulado y usarlo como una dependencia de una manera segura.  Algunos dise√±os de prueba diferentes con varias partes reemplazadas por simulacros podr√≠an mantenerse simult√°neamente. </li><li>  Pruebas de integraci√≥n.  A veces, en sistemas distribuidos es dif√≠cil ejecutar pruebas de integraci√≥n.  Utilizando el enfoque descrito para escribir una configuraci√≥n segura del sistema distribuido completo, podemos ejecutar todas las partes distribuidas en un √∫nico servidor de manera controlable.  Es f√°cil emular la situaci√≥n. <br>  cuando uno de los servicios deja de estar disponible. </li></ol><br><h4 id="disadvantages">  Desventajas </h4><br><p>  El enfoque de configuraci√≥n compilada es diferente de la configuraci√≥n "normal" y podr√≠a no satisfacer todas las necesidades.  Estas son algunas de las desventajas de la configuraci√≥n compilada: </p><br><ol><li>  Configuraci√≥n est√°tica  Puede que no sea adecuado para todas las aplicaciones.  En algunos casos existe la necesidad de corregir r√°pidamente la configuraci√≥n en producci√≥n sin pasar por todas las medidas de seguridad.  Este enfoque lo hace m√°s dif√≠cil.  La compilaci√≥n y la reasignaci√≥n son necesarias despu√©s de realizar cualquier cambio en la configuraci√≥n.  Esta es la caracter√≠stica y la carga. </li><li>  Generaci√≥n de configuraci√≥n.  Cuando una herramienta de automatizaci√≥n genera la configuraci√≥n, este enfoque requiere una compilaci√≥n posterior (que a su vez podr√≠a fallar).  Puede requerir un esfuerzo adicional para integrar este paso adicional en el sistema de compilaci√≥n. </li><li>  Instrumentos  Hay muchas herramientas en uso hoy en d√≠a que dependen de configuraciones basadas en texto.  Algunos de ellos <br>  no ser√° aplicable cuando se compila la configuraci√≥n. </li><li>  Se necesita un cambio de mentalidad.  Los desarrolladores y DevOps est√°n familiarizados con los archivos de configuraci√≥n de texto.  La idea de compilar la configuraci√≥n puede parecerles extra√±a. </li><li>  Antes de introducir la configuraci√≥n compilable, se requiere un proceso de desarrollo de software de alta calidad. </li></ol><br><p>  Existen algunas limitaciones del ejemplo implementado: </p><br><ol><li>  Si proporcionamos una configuraci√≥n adicional que no es requerida por la implementaci√≥n del nodo, el compilador no nos ayudar√° a detectar la implementaci√≥n ausente.  Esto podr√≠a abordarse utilizando <code>HList</code> o <code>HList</code> (clases de casos) para la configuraci√≥n de nodos en lugar de rasgos y Cake Pattern. </li><li>  Tenemos que proporcionar algunas repeticiones en el archivo de configuraci√≥n: ( <code>package</code> , <code>import</code> , declaraciones de <code>object</code> ; <br>  <code>override def</code> 's para los par√°metros que tienen valores predeterminados).  Esto podr√≠a abordarse parcialmente mediante un DSL. </li><li>  En esta publicaci√≥n no cubrimos la reconfiguraci√≥n din√°mica de cl√∫steres de nodos similares. </li></ol><br><h3 id="conclusion">  Conclusi√≥n </h3><br><p>  En esta publicaci√≥n hemos discutido la idea de representar la configuraci√≥n directamente en el c√≥digo fuente de una manera segura.  El enfoque podr√≠a utilizarse en muchas aplicaciones como un reemplazo de xml y otras configuraciones basadas en texto.  A pesar de que nuestro ejemplo se ha implementado en Scala, tambi√©n podr√≠a traducirse a otros idiomas compilables (como Kotlin, C #, Swift, etc.).  Uno podr√≠a probar este enfoque en un nuevo proyecto y, en caso de que no encaje bien, cambiar a la forma tradicional. </p><br><p>  Por supuesto, la configuraci√≥n compilable requiere un proceso de desarrollo de alta calidad.  A cambio, promete proporcionar una configuraci√≥n robusta de igual calidad. </p><br><p>  Este enfoque podr√≠a extenderse de varias maneras: </p><br><ol><li>  Se podr√≠an usar macros para realizar la validaci√≥n de la configuraci√≥n y fallar en el momento de la compilaci√≥n en caso de fallas en las restricciones de l√≥gica de negocios. </li><li>  Se podr√≠a implementar un DSL para representar la configuraci√≥n de una manera f√°cil de usar para el dominio. </li><li>  Gesti√≥n din√°mica de recursos con ajustes autom√°ticos de configuraci√≥n.  Por ejemplo, cuando ajustamos el n√∫mero de nodos del cl√∫ster, podr√≠amos querer (1) que los nodos obtengan una configuraci√≥n ligeramente modificada;  (2) administrador de cl√∫ster para recibir informaci√≥n de nuevos nodos. </li></ol><br><h3 id="thanks">  Gracias </h3><br><p>  Quisiera agradecer a Andrey Saksonov, Pavel Popov, Anton Nehaev por brindar comentarios inspiradores sobre el borrador de esta publicaci√≥n que me ayudaron a aclararlo. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447690/">https://habr.com/ru/post/447690/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447680/index.html">Ejercicios de emulaci√≥n: manual de Xbox 360 FMA</a></li>
<li><a href="../447682/index.html">Centro de datos espaciales: 24 horas antes del lanzamiento</a></li>
<li><a href="../447684/index.html">C√≥mo mostrar los valores de la empresa en una oficina (sin carteles ni lemas)</a></li>
<li><a href="../447686/index.html">Un par√°metro muy importante de las l√°mparas LED, que pocas personas conocen</a></li>
<li><a href="../447688/index.html">A la pregunta sobre bitset</a></li>
<li><a href="../447694/index.html">Configuraci√≥n del sistema distribuido compilado</a></li>
<li><a href="../447696/index.html">¬øPor qu√© las ciudades se oponen a Amazon Go, las primeras tiendas sin efectivo?</a></li>
<li><a href="../447698/index.html">Red Hogwarts: acad√©mico sin diploma</a></li>
<li><a href="../447700/index.html">La flexibilidad emocional es la clave del crecimiento personal.</a></li>
<li><a href="../447702/index.html">El c√≠rculo matem√°tico ideal no existe.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>