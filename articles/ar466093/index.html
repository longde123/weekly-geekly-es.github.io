<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘· âš«ï¸ ğŸ“¶ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ kubectl execØŸ ğŸ‘ ğŸ‘‹ğŸ¾ ğŸ‘©â€ğŸ“</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ØªÙ‚Ø±ÙŠØ¨Ø§. Ø§Ù„Ø¹Ø§Ø¨Ø±Ø©. : Ø´Ø§Ø±Ùƒ Ù…Ø¤Ù„Ù Ø§Ù„Ù…Ù‚Ø§Ù„ - Ø¥Ø±ÙƒØ§Ù† Ø¥ÙŠØ±ÙˆÙ„ ØŒ ÙˆÙ‡Ùˆ Ù…Ù‡Ù†Ø¯Ø³ Ù…Ù† SAP - ÙÙŠ Ø¯Ø±Ø§Ø³ØªÙ‡ Ù„Ù„Ø¢Ù„ÙŠØ§Øª kubectl exec Ù„ÙØ±ÙŠÙ‚ kubectl exec ØŒ ÙˆÙ‡Ùˆ Ù…Ø£Ù„ÙˆÙ Ù„Ù„ØºØ§ÙŠØ© Ù„ÙƒÙ„ Ù…Ù† ÙŠØ¹Ù…...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ kubectl execØŸ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/466093/" style=";text-align:right;direction:rtl"> <i><b>ØªÙ‚Ø±ÙŠØ¨Ø§.</b></i>  <i><b>Ø§Ù„Ø¹Ø§Ø¨Ø±Ø©.</b></i>  <i>: Ø´Ø§Ø±Ùƒ Ù…Ø¤Ù„Ù Ø§Ù„Ù…Ù‚Ø§Ù„ - Ø¥Ø±ÙƒØ§Ù† Ø¥ÙŠØ±ÙˆÙ„ ØŒ ÙˆÙ‡Ùˆ Ù…Ù‡Ù†Ø¯Ø³ Ù…Ù† SAP - ÙÙŠ Ø¯Ø±Ø§Ø³ØªÙ‡ Ù„Ù„Ø¢Ù„ÙŠØ§Øª <code>kubectl exec</code> Ù„ÙØ±ÙŠÙ‚ <code>kubectl exec</code> ØŒ ÙˆÙ‡Ùˆ Ù…Ø£Ù„ÙˆÙ Ù„Ù„ØºØ§ÙŠØ© Ù„ÙƒÙ„ Ù…Ù† ÙŠØ¹Ù…Ù„ Ù…Ø¹ Kubernetes.</i>  <i>ÙˆÙ‡Ùˆ ÙŠØ±Ø§ÙÙ‚ Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø¨Ø£ÙƒÙ…Ù„Ù‡Ø§ Ù…Ø¹ Ù‚ÙˆØ§Ø¦Ù… Ø¨Ø±Ù…Ø² Ù…ØµØ¯Ø± Kubernetes (ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø°Ø§Øª Ø§Ù„ØµÙ„Ø©) ØŒ ÙˆØ§Ù„ØªÙŠ ØªØªÙŠØ­ Ù„Ùƒ ÙÙ‡Ù… Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø¨Ø§Ù„Ø¹Ù…Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.</i> <br><br><img src="https://habrastorage.org/webt/z7/je/ja/z7jejaxnf5kisqkvemay56t6_pe.png"><br><br>  Ø°Ø§Øª ÙŠÙˆÙ… Ø¬Ù…Ø¹Ø© ØŒ Ø¬Ø§Ø¡ Ø²Ù…ÙŠÙ„ Ù„ÙŠ ÙˆØ³Ø£Ù„ Ø¹Ù† ÙƒÙŠÙÙŠØ© ØªÙ†ÙÙŠØ° Ø£Ù…Ø± ÙÙŠ Ø¬Ø±Ø§Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">client-go</a> .  Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„ÙŠÙ‡ ÙˆØ£Ø¯Ø±ÙƒØª ÙØ¬Ø£Ø© Ø£Ù†Ù†ÙŠ Ù„Ø§ Ø£Ø¹Ø±Ù Ø£ÙŠ Ø´ÙŠØ¡ Ø¹Ù† Ø¢Ù„ÙŠØ© Ø¹Ù…Ù„ <code>kubectl exec</code> .  Ù†Ø¹Ù… ØŒ ÙƒØ§Ù† Ù„Ø¯ÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø£ÙÙƒØ§Ø± Ø­ÙˆÙ„ Ø£Ø¬Ù‡Ø²ØªÙ‡Ø§ ØŒ Ù„ÙƒÙ†Ù†ÙŠ Ù„Ù… Ø£ÙƒÙ† Ù…ØªØ£ÙƒØ¯Ø§Ù‹ 100 Ùª Ù…Ù† ØµØ­ØªÙ‡Ø§ ØŒ ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ Ù‚Ø±Ø±Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©.  Ø¨Ø¹Ø¯ Ø£Ù† Ø¯Ø±Ø³Øª Ø§Ù„Ù…Ø¯ÙˆÙ†Ø§Øª ÙˆØ§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ØµØ¯Ø±ÙŠ ØŒ ØªØ¹Ù„Ù…Øª Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ØŒ ÙˆÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ Ø£ÙˆØ¯ Ø£Ù† Ø£Ø´Ø§Ø±Ùƒ ÙÙŠ Ø§ÙƒØªØ´Ø§ÙØ§ØªÙŠ ÙˆÙÙ‡Ù…Ø§ØªÙŠ.  Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø£ Ù…Ø§ ØŒ ÙÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨ÙŠ Ø¹Ù„Ù‰ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Twitter</a> . <a name="habracut"></a><br><br><h2 style=";text-align:right;direction:rtl">  ØªØ¯Ø±ÙŠØ¨ </h2><br>  Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙƒØªÙ„Ø© Ø¹Ù„Ù‰ MacBook ØŒ Ù‚Ù…Øª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¨Ø§Ø³ØªÙ†Ø³Ø§Ø® Ù†Ø¸Ø§Ù… ecomm-integration-ballerina / kubernetes-cluster</a> .  Ø«Ù… Ù‚Ø§Ù… Ø¨ØªØµØ­ÙŠØ­ Ø¹Ù†Ø§ÙˆÙŠÙ† IP Ù„Ù„Ø¹Ù‚Ø¯ ÙÙŠ ØªÙƒÙˆÙŠÙ† kubelet ØŒ Ø­ÙŠØ« Ø£Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù… ØªØ³Ù…Ø­ <code>kubectl exec</code> .  ÙŠÙ…ÙƒÙ†Ùƒ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø²ÙŠØ¯ Ø¹Ù† Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù‡Ø°Ø§ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù‡Ù†Ø§</a> . <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø£ÙŠ Ø³ÙŠØ§Ø±Ø© = Ø¨Ù„Ø¯ÙŠ Ù…Ø§Ùƒ Ø¨ÙˆÙƒ </li><li style=";text-align:right;direction:rtl">  Ù…Ø§Ø¬Ø³ØªÙŠØ± IP = 192.168.205.10 </li><li style=";text-align:right;direction:rtl">  Ø¹Ù†ÙˆØ§Ù† IP Ù„Ù„Ø¹Ø§Ù…Ù„ = 192.168.205.11 </li><li style=";text-align:right;direction:rtl">  Ù…Ù†ÙØ° Ø®Ø§Ø¯Ù… API = 6443 </li></ul><br><h2 style=";text-align:right;direction:rtl">  Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª </h2><br><img src="https://habrastorage.org/webt/of/q5/dv/ofq5dvsbuqvr8bp6gryhxsficfk.png"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>kubectl exec process</b> : Ø¹Ù†Ø¯Ù…Ø§ Ù†Ù†ÙØ° "kubectl exec ..." ØŒ ØªØ¨Ø¯Ø£ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.  ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø°Ù„Ùƒ Ø¹Ù„Ù‰ Ø£ÙŠ Ø¬Ù‡Ø§Ø² Ù…Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø®Ø§Ø¯Ù… K8s API.  <i>ØªÙ‚Ø±ÙŠØ¨Ø§.</i>  <i>trans.: Ø¹Ù„Ø§ÙˆØ© Ø¹Ù„Ù‰ Ø°Ù„Ùƒ ÙÙŠ Ù‚ÙˆØ§Ø¦Ù… ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… ØŒ ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¤Ù„Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ "Ø£ÙŠ Ø¬Ù‡Ø§Ø²" ØŒ Ù…Ù…Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ù‡ ÙŠÙ…ÙƒÙ† ØªÙ†ÙÙŠØ° Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù„Ø§Ø­Ù‚Ø© Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ù…Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Kubernetes.</i> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>Ø®Ø§Ø¯Ù… api</b></a> : Ù…ÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙŠÙˆÙØ± Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Kubernetes API.  Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© Ù„Ø·Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Kubernetes. </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>kubelet</b></a> : Ø¹Ø§Ù…Ù„ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø¹Ù‚Ø¯Ø© ÙÙŠ Ø§Ù„ÙƒØªÙ„Ø©.  ÙˆÙŠÙˆÙØ± Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª ÙÙŠ pod'e. </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©</b></a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©</b></a> ): Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª.  Ø£Ù…Ø«Ù„Ø©: DockerØŒ CRI-OØŒ containerd ... </li><li style=";text-align:right;direction:rtl">  <b>kernel</b> : OS kernel Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„ Ø›  Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª. </li><li style=";text-align:right;direction:rtl">  <b>Ø§Ù„Ø­Ø§ÙˆÙŠØ©</b> <b>Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</b> : Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØªÙŠ ØªØ¹Ø¯ Ø¬Ø²Ø¡Ù‹Ø§ Ù…Ù† Ø§Ù„Ø­Ø§ÙØ¸Ø© ÙˆØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø¹Ù‚Ø¯ Ø§Ù„Ø¹Ù…Ù„. </li></ul><br><h2 style=";text-align:right;direction:rtl">  Ù…Ø§ Ø§ÙƒØªØ´ÙØªÙ‡ </h2><br><h3 style=";text-align:right;direction:rtl">  1. Ù†Ø´Ø§Ø· Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ </h3><br>  Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø±Ø§Ø¨ ÙÙŠ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø§Ø³Ù… <code>default</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// any machine $ kubectl run <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx --image=nginx</code> </pre> <br>  Ø«Ù… Ù†Ù†ÙØ° Ø§Ù„Ø£Ù…Ø± exec ÙˆÙ†Ù†ØªØ¸Ø± 5000 Ø«Ø§Ù†ÙŠØ© Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// any machine $ kubectl <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -it <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx-6558988d5-fgxgg -- sh <span class="hljs-comment"><span class="hljs-comment"># sleep 5000</span></span></code> </pre> <br>  ØªØ¸Ù‡Ø± Ø¹Ù…Ù„ÙŠØ© kubectl (Ù…Ø¹ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù†ØªØ¬ = 8507 ÙÙŠ Ø­Ø§Ù„ØªÙ†Ø§): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// any machine $ ps -ef |grep kubectl 501 8507 8409 0 7:19PM ttys000 0:00.13 kubectl <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -it <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx-6558988d5-fgxgg -- sh</code> </pre> <br>  Ø¥Ø°Ø§ ØªØ­Ù‚Ù‚Ù†Ø§ Ù…Ù† Ù†Ø´Ø§Ø· Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„Ø¹Ù…Ù„ÙŠØ© ØŒ ÙˆØ¬Ø¯Ù†Ø§ Ø£Ù† Ù„Ø¯ÙŠÙ‡Ø§ Ø§ØªØµØ§Ù„Ø§Øª Ø¨Ø®Ø§Ø¯Ù… api (192.168.205.10.6443): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// any machine $ netstat -atnv |grep 8507 tcp4 0 0 192.168.205.1.51673 192.168.205.10.6443 ESTABLISHED 131072 131768 8507 0 0x0102 0x00000020 tcp4 0 0 192.168.205.1.51672 192.168.205.10.6443 ESTABLISHED 131072 131768 8507 0 0x0102 0x00000028</code> </pre> <br>  Ù„Ù†Ù„Ù‚Ù Ù†Ø¸Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯  ÙŠÙ‚ÙˆÙ… Kubectl Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ POST Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØµØ¯Ø± ÙØ±Ø¹ÙŠ exec ÙˆÙŠØ±Ø³Ù„ Ø·Ù„Ø¨ REST: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"> req := restClient.Post(). Resource(<span class="hljs-string"><span class="hljs-string">"pods"</span></span>). Name(pod.Name). Namespace(pod.Namespace). SubResource(<span class="hljs-string"><span class="hljs-string">"exec"</span></span>) req.VersionedParams(&amp;corev1.PodExecOptions{ Container: containerName, Command: p.Command, Stdin: p.Stdin, Stdout: p.Out != <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, Stderr: p.ErrOut != <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, TTY: t.Raw, }, scheme.ParameterCodec) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> p.Executor.Execute(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>, req.URL(), p.Config, p.In, p.Out, p.ErrOut, t.Raw, sizeQueue)</code> </pre> <br>  <i>( <a href="">kubectl / pkg / cmd / exec / exec.go</a> )</i> <br><br><img src="https://habrastorage.org/webt/og/nn/cg/ognncgumyrwb7cr6l8wq5alo2je.png"><br><h3 style=";text-align:right;direction:rtl">  2. Ø§Ù„Ù†Ø´Ø§Ø· Ø¹Ù„Ù‰ Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© </h3><br>  ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø£ÙŠØ¶Ù‹Ø§ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø®Ø§Ø¯Ù… api: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">handler.go:143] kube-apiserver: POST <span class="hljs-string"><span class="hljs-string">"/api/v1/namespaces/default/pods/exec-test-nginx-6558988d5-fgxgg/exec"</span></span> satisfied by gorestful with webservice /api/v1 upgradeaware.go:261] Connecting to backend proxy (intercepting redirects) https://192.168.205.11:10250/<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>/default/<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx-6558988d5-fgxgg/<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx?<span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=sh&amp;input=1&amp;output=1&amp;tty=1 Headers: map[Connection:[Upgrade] Content-Length:[0] Upgrade:[SPDY/3.1] User-Agent:[kubectl/v1.12.10 (darwin/amd64) kubernetes/e3c1340] X-Forwarded-For:[192.168.205.1] X-Stream-Protocol-Version:[v4.channel.k8s.io v3.channel.k8s.io v2.channel.k8s.io channel.k8s.io]]</code> </pre> <br>  <i>Ù„Ø§Ø­Ø¸ Ø£Ù† Ø·Ù„Ø¨ HTTP ÙŠØªØ¶Ù…Ù† Ø·Ù„Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„.</i>  <i>ÙŠØªÙŠØ­ Ù„Ùƒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SPDY</a> Ù…Ø¶Ø§Ø¹ÙØ© Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© stdin / stdout / stderr / spdy-error Ù…Ù† Ø®Ù„Ø§Ù„ Ø§ØªØµØ§Ù„ TCP ÙˆØ§Ø­Ø¯.</i> <br><br>  Ø®Ø§Ø¯Ù… API ÙŠØªÙ„Ù‚Ù‰ Ø§Ù„Ø·Ù„Ø¨ ÙˆÙŠØ­ÙˆÙ„Ù‡ Ø¥Ù„Ù‰ <code>PodExecOptions</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// PodExecOptions is the query options to a Pod's remote exec call type PodExecOptions struct { metav1.TypeMeta // Stdin if true indicates that stdin is to be redirected for the exec call Stdin bool // Stdout if true indicates that stdout is to be redirected for the exec call Stdout bool // Stderr if true indicates that stderr is to be redirected for the exec call Stderr bool // TTY if true indicates that a tty will be allocated for the exec call TTY bool // Container in which to execute the command. Container string // Command is the remote command to execute; argv array; not executed within a shell. Command []string }</span></span></code> </pre> <br>  <i>( <a href="">pkg / apis / core / types.go</a> )</i> <br><br>  Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ØŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ø±Ù Ø®Ø§Ø¯Ù… api Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø°ÙŠ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‡: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ExecLocation returns the exec URL for a pod container. If opts.Container is blank // and only one container is present in the pod, that container is used. func ExecLocation( getter ResourceGetter, connInfo client.ConnectionInfoGetter, ctx context.Context, name string, opts *api.PodExecOptions, ) (*url.URL, http.RoundTripper, error) { return streamLocation(getter, connInfo, ctx, name, opts, opts.Container, "exec") }</span></span></code> </pre> <br>  <i>( <a href="">pkg / registry / core / pod / strategy.go</a> )</i> <br><br>  Ø¨Ø§Ù„Ø·Ø¨Ø¹ ØŒ ÙŠØªÙ… Ø£Ø®Ø° Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ù…Ù† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¶ÙŠÙ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"> nodeName := types.NodeName(pod.Spec.NodeName) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(nodeName) == <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-comment"><span class="hljs-comment">// If pod has not been assigned a host, return an empty location return nil, nil, errors.NewBadRequest(fmt.Sprintf("pod %s does not have a host assigned", name)) } nodeInfo, err := connInfo.GetConnectionInfo(ctx, nodeName)</span></span></code> </pre> <br>  <i>( <a href="">pkg / registry / core / pod / strategy.go</a> )</i> <br><br>  Ø§Ù„ØµÙŠØ­Ø©!  ÙŠØ­ØªÙˆÙŠ Kubelet Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù…Ù†ÙØ° ( <code>node.Status.DaemonEndpoints.KubeletEndpoint.Port</code> ) ÙŠÙ…ÙƒÙ† Ù„Ø®Ø§Ø¯Ù… ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‡: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// GetConnectionInfo retrieves connection info from the status of a Node API object. func (k *NodeConnectionInfoGetter) GetConnectionInfo(ctx context.Context, nodeName types.NodeName) (*ConnectionInfo, error) { node, err := k.nodes.Get(ctx, string(nodeName), metav1.GetOptions{}) if err != nil { return nil, err } // Find a kubelet-reported address, using preferred address type host, err := nodeutil.GetPreferredNodeAddress(node, k.preferredAddressTypes) if err != nil { return nil, err } // Use the kubelet-reported port, if present port := int(node.Status.DaemonEndpoints.KubeletEndpoint.Port) if port &lt;= 0 { port = k.defaultPort } return &amp;ConnectionInfo{ Scheme: k.scheme, Hostname: host, Port: strconv.Itoa(port), Transport: k.transport, }, nil }</span></span></code> </pre> <br>  <i>( <a href="">pkg / kubelet / client / kubelet_client.go</a> )</i> <br><br><blockquote style=";text-align:right;direction:rtl">  Ù…Ù† ÙˆØ«Ø§Ø¦Ù‚ Ø§ØªØµØ§Ù„ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Master-Node&gt; Master to Cluster&gt; apiserver Ø¥Ù„Ù‰ kubelet</a> : <br><br>  ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ù‡Ø°Ù‡ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© HTTPS ÙÙŠ kubelet.  Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ ØŒ Ù„Ø§ ÙŠØªØ­Ù‚Ù‚ apiserver Ù…Ù† Ø´Ù‡Ø§Ø¯Ø© kubelet ØŒ Ù…Ù…Ø§ ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ø±Ø¶Ø© Ù„Ù€ "Ø§Ù„Ù‡Ø¬Ù…Ø§Øª Ø§Ù„ÙˆØ³ÙŠØ·Ø©" (MITMs) ÙˆØºÙŠØ± <i><b>Ø¢Ù…Ù†</b></i> Ù„Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ§Øª ØºÙŠØ± Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ Ø¨Ù‡Ø§ Ùˆ / Ø£Ùˆ Ø§Ù„Ø¹Ø§Ù…Ø©. </blockquote><br>  Ø§Ù„Ø¢Ù† ÙŠØ¹Ø±Ù Ø®Ø§Ø¯Ù… API Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© ÙˆÙŠÙ‚ÙˆÙ… Ø¨ØªØ£Ø³ÙŠØ³ Ø§ØªØµØ§Ù„: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Connect returns a handler for the pod exec proxy func (r *ExecREST) Connect(ctx context.Context, name string, opts runtime.Object, responder rest.Responder) (http.Handler, error) { execOpts, ok := opts.(*api.PodExecOptions) if !ok { return nil, fmt.Errorf("invalid options object: %#v", opts) } location, transport, err := pod.ExecLocation(r.Store, r.KubeletConn, ctx, name, execOpts) if err != nil { return nil, err } return newThrottledUpgradeAwareProxyHandler(location, transport, false, true, true, responder), nil }</span></span></code> </pre> <br>  <i>( <a href="">pkg / registry / core / pod / rest / subresources.go</a> )</i> <br><br>  Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±Ù‰ Ù…Ø§ ÙŠØ­Ø¯Ø« Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©. <br><br>  Ø£ÙˆÙ„Ø§Ù‹ Ù†ÙƒØªØ´Ù IP Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„.  ÙÙŠ Ø­Ø§Ù„ØªÙ†Ø§ ØŒ Ù‡Ø°Ø§ Ù‡Ùˆ 192.168.205.11: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// any machine $ kubectl get nodes k8s-node-1 -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME k8s-node-1 Ready &lt;none&gt; 9h v1.15.3 192.168.205.11 &lt;none&gt; Ubuntu 16.04.6 LTS 4.4.0-159-generic docker://17.3.3</code> </pre> <br>  Ø«Ù… Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª Ù…Ù†ÙØ° kubelet (10250 ÙÙŠ Ø­Ø§Ù„ØªÙ†Ø§): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// any machine $ kubectl get nodes k8s-node-1 -o jsonpath=<span class="hljs-string"><span class="hljs-string">'{.status.daemonEndpoints.kubeletEndpoint}'</span></span> map[Port:10250]</code> </pre> <br>  Ø§Ù„Ø¢Ù† Ø­Ø§Ù† Ø§Ù„ÙˆÙ‚Øª Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©.  Ù‡Ù„ Ù‡Ù†Ø§Ùƒ Ø§ØªØµØ§Ù„ Ù…Ø¹ Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„ (192.168.205.11)ØŸ  Ø¥Ù†Ù‡ Ù‡Ù†Ø§Ùƒ!  Ø¥Ø°Ø§ Ù‚ØªÙ„Øª Ø¹Ù…Ù„ÙŠØ© <code>exec</code> ØŒ ÙØ³ØªØ®ØªÙÙŠ ØŒ Ù„Ø°Ù„Ùƒ Ø£Ø¹Ø±Ù Ø£Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© Ø®Ø§Ø¯Ù… api Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø£Ù…Ø± exec Ø§Ù„Ø°ÙŠ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// master node $ netstat -atn |grep 192.168.205.11 tcp 0 0 192.168.205.10:37870 192.168.205.11:10250 ESTABLISHED â€¦</code> </pre> <br><img src="https://habrastorage.org/webt/mp/-l/ql/mp-lqlocn8io490w9r9xenbawwg.png"><br><br>  Ù„Ø§ ÙŠØ²Ø§Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨ÙŠÙ† kubectl ÙˆØ®Ø§Ø¯Ù… api Ù…ÙØªÙˆØ­Ù‹Ø§.  Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø°Ù„Ùƒ ØŒ Ù‡Ù†Ø§Ùƒ Ø§ØªØµØ§Ù„ Ø¢Ø®Ø± ÙŠØ±Ø¨Ø· api-server Ùˆ kubelet. <br><br><h3 style=";text-align:right;direction:rtl">  3. Ø§Ù„Ù†Ø´Ø§Ø· Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„ </h3><br>  Ø§Ù„Ø¢Ù† Ø¯Ø¹Ù†Ø§ Ù†ØªØµÙ„ Ø¨Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ù…Ù†ÙØ°Ø© ÙˆÙ†Ø±Ù‰ Ù…Ø§ Ø³ÙŠØ­Ø¯Ø« Ø¹Ù„ÙŠÙ‡Ø§. <br><br>  Ø¨Ø§Ø¯Ø¦ Ø°ÙŠ Ø¨Ø¯Ø¡ ØŒ Ù†Ø±Ù‰ Ø£Ù†Ù‡ ØªÙ… ØªØ£Ø³ÙŠØ³ Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹Ù‡Ø§ Ø£ÙŠØ¶Ù‹Ø§ (Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ) Ø›  192.168.205.10 Ù‡Ùˆ Ø¹Ù†ÙˆØ§Ù† IP Ù„Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> // worker node $ netstat -atn |grep 10250 tcp6 0 0 :::10250 :::* LISTEN tcp6 0 0 192.168.205.11:10250 192.168.205.10:37870 ESTABLISHED</code> </pre> <br>  Ù…Ø§Ø°Ø§ Ø¹Ù† ÙØ±ÙŠÙ‚ <code>sleep</code> Ù„Ø¯ÙŠÙ†Ø§ØŸ  Ø§Ù„ØµÙŠØ­Ø© ØŒ Ù‡ÙŠ Ø­Ø§Ø¶Ø±Ø© Ø£ÙŠØ¶Ù‹Ø§! <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> // worker node $ ps -afx ... 31463 ? Sl 0:00 \_ docker-containerd-shim 7d974065bbb3107074ce31c51f5ef40aea8dcd535ae11a7b8f2dd180b8ed583a /var/run/docker/libcontainerd/7d974065bbb3107074ce31c51 31478 pts/0 Ss 0:00 \_ sh 31485 pts/0 S+ 0:00 \_ sleep 5000 â€¦</code> </pre> <br>  ÙˆÙ„ÙƒÙ† Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±: ÙƒÙŠÙ ÙƒØ±Ù†Ùƒ Ù‡Ø°Ø§ ÙƒØ±Ù†ÙƒØŸ  ÙŠÙˆØ¬Ø¯ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø®ÙÙŠ ÙÙŠ kubelet ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù…Ù†ÙØ° Ù„Ø·Ù„Ø¨Ø§Øª Ø®Ø§Ø¯Ù… api: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Server is the library interface to serve the stream requests. type Server interface { http.Handler // Get the serving URL for the requests. // Requests must not be nil. Responses may be nil iff an error is returned. GetExec(*runtimeapi.ExecRequest) (*runtimeapi.ExecResponse, error) GetAttach(req *runtimeapi.AttachRequest) (*runtimeapi.AttachResponse, error) GetPortForward(*runtimeapi.PortForwardRequest) (*runtimeapi.PortForwardResponse, error) // Start the server. // addr is the address to serve on (address:port) stayUp indicates whether the server should // listen until Stop() is called, or automatically stop after all expected connections are // closed. Calling Get{Exec,Attach,PortForward} increments the expected connection count. // Function does not return until the server is stopped. Start(stayUp bool) error // Stop the server, and terminate any open connections. Stop() error }</span></span></code> </pre> <br>  <i>( <a href="">pkg / kubelet / server / streaming / server.go</a> )</i> <br><br>  ÙŠÙ‚ÙˆÙ… Kubelet Ø¨Ø­Ø³Ø§Ø¨ Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø·Ù„Ø¨Ø§Øª exec: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *server)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(req *runtimeapi.ExecRequest)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*runtimeapi.ExecResponse, error)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := validateExecRequest(req); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } token, err := s.cache.Insert(req) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &amp;runtimeapi.ExecResponse{ Url: s.buildURL(<span class="hljs-string"><span class="hljs-string">"exec"</span></span>, token), }, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  <i>( <a href="">pkg / kubelet / server / streaming / server.go</a> )</i> <br><br>  Ù„Ø§ ØªØ®Ù„Ø·.  Ù„Ø§ ÙŠÙØ±Ø¬Ø¹ Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£Ù…Ø± ØŒ ÙˆÙ„ÙƒÙ† Ù†Ù‚Ø·Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ù„Ù„Ø§ØªØµØ§Ù„: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ExecResponse <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Fully qualified URL of the exec streaming server. Url string `protobuf:"bytes,1,opt,name=url,proto3" json:"url,omitempty"` XXX_NoUnkeyedLiteral struct{} `json:"-"` XXX_sizecache int32 `json:"-"` }</span></span></code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> <br><br>  ØªØ·Ø¨Ù‚ <code>RuntimeServiceClient</code> ÙˆØ§Ø¬Ù‡Ø© <code>RuntimeServiceClient</code> ØŒ Ø§Ù„ØªÙŠ ØªØ¹Ø¯ Ø¬Ø²Ø¡Ù‹Ø§ Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© <i>(Ù„Ù‚Ø¯ ÙƒØªØ¨Ù†Ø§ Ø§Ù„Ù…Ø²ÙŠØ¯ Ø¹Ù†Ù‡Ø§ ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù‡Ù†Ø§</a> - Ø§Ù„ØªØ±Ø¬Ù…Ø© ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§)</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ù‚Ø§Ø¦Ù…Ø© Ø·ÙˆÙŠÙ„Ø© Ù…Ù† cri-api Ø¥Ù„Ù‰ kubernetes / kubernetes</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// For semantics around ctx use and closing/ending streaming RPCs, please refer to https://godoc.org/google.golang.org/grpc#ClientConn.NewStream. type RuntimeServiceClient interface { // Version returns the runtime name, runtime version, and runtime API version. Version(ctx context.Context, in *VersionRequest, opts ...grpc.CallOption) (*VersionResponse, error) // RunPodSandbox creates and starts a pod-level sandbox. Runtimes must ensure // the sandbox is in the ready state on success. RunPodSandbox(ctx context.Context, in *RunPodSandboxRequest, opts ...grpc.CallOption) (*RunPodSandboxResponse, error) // StopPodSandbox stops any running process that is part of the sandbox and // reclaims network resources (eg, IP addresses) allocated to the sandbox. // If there are any running containers in the sandbox, they must be forcibly // terminated. // This call is idempotent, and must not return an error if all relevant // resources have already been reclaimed. kubelet will call StopPodSandbox // at least once before calling RemovePodSandbox. It will also attempt to // reclaim resources eagerly, as soon as a sandbox is not needed. Hence, // multiple StopPodSandbox calls are expected. StopPodSandbox(ctx context.Context, in *StopPodSandboxRequest, opts ...grpc.CallOption) (*StopPodSandboxResponse, error) // RemovePodSandbox removes the sandbox. If there are any running containers // in the sandbox, they must be forcibly terminated and removed. // This call is idempotent, and must not return an error if the sandbox has // already been removed. RemovePodSandbox(ctx context.Context, in *RemovePodSandboxRequest, opts ...grpc.CallOption) (*RemovePodSandboxResponse, error) // PodSandboxStatus returns the status of the PodSandbox. If the PodSandbox is not // present, returns an error. PodSandboxStatus(ctx context.Context, in *PodSandboxStatusRequest, opts ...grpc.CallOption) (*PodSandboxStatusResponse, error) // ListPodSandbox returns a list of PodSandboxes. ListPodSandbox(ctx context.Context, in *ListPodSandboxRequest, opts ...grpc.CallOption) (*ListPodSandboxResponse, error) // CreateContainer creates a new container in specified PodSandbox CreateContainer(ctx context.Context, in *CreateContainerRequest, opts ...grpc.CallOption) (*CreateContainerResponse, error) // StartContainer starts the container. StartContainer(ctx context.Context, in *StartContainerRequest, opts ...grpc.CallOption) (*StartContainerResponse, error) // StopContainer stops a running container with a grace period (ie, timeout). // This call is idempotent, and must not return an error if the container has // already been stopped. // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> what must the runtime do after the grace period is reached? StopContainer(ctx context.Context, in *StopContainerRequest, opts ...grpc.CallOption) (*StopContainerResponse, error) // RemoveContainer removes the container. If the container is running, the // container must be forcibly removed. // This call is idempotent, and must not return an error if the container has // already been removed. RemoveContainer(ctx context.Context, in *RemoveContainerRequest, opts ...grpc.CallOption) (*RemoveContainerResponse, error) // ListContainers lists all containers by filters. ListContainers(ctx context.Context, in *ListContainersRequest, opts ...grpc.CallOption) (*ListContainersResponse, error) // ContainerStatus returns status of the container. If the container is not // present, returns an error. ContainerStatus(ctx context.Context, in *ContainerStatusRequest, opts ...grpc.CallOption) (*ContainerStatusResponse, error) // UpdateContainerResources updates ContainerConfig of the container. UpdateContainerResources(ctx context.Context, in *UpdateContainerResourcesRequest, opts ...grpc.CallOption) (*UpdateContainerResourcesResponse, error) // ReopenContainerLog asks runtime to reopen the stdout/stderr log file // for the container. This is often called after the log file has been // rotated. If the container is not running, container runtime can choose // to either create a new log file and return nil, or return an error. // Once it returns error, new container log file MUST NOT be created. ReopenContainerLog(ctx context.Context, in *ReopenContainerLogRequest, opts ...grpc.CallOption) (*ReopenContainerLogResponse, error) // ExecSync runs a command in a container synchronously. ExecSync(ctx context.Context, in *ExecSyncRequest, opts ...grpc.CallOption) (*ExecSyncResponse, error) // Exec prepares a streaming endpoint to execute a command in the container. Exec(ctx context.Context, in *ExecRequest, opts ...grpc.CallOption) (*ExecResponse, error) // Attach prepares a streaming endpoint to attach to a running container. Attach(ctx context.Context, in *AttachRequest, opts ...grpc.CallOption) (*AttachResponse, error) // PortForward prepares a streaming endpoint to forward ports from a PodSandbox. PortForward(ctx context.Context, in *PortForwardRequest, opts ...grpc.CallOption) (*PortForwardResponse, error) // ContainerStats returns stats of the container. If the container does not // exist, the call returns an error. ContainerStats(ctx context.Context, in *ContainerStatsRequest, opts ...grpc.CallOption) (*ContainerStatsResponse, error) // ListContainerStats returns stats of all running containers. ListContainerStats(ctx context.Context, in *ListContainerStatsRequest, opts ...grpc.CallOption) (*ListContainerStatsResponse, error) // UpdateRuntimeConfig updates the runtime configuration based on the given request. UpdateRuntimeConfig(ctx context.Context, in *UpdateRuntimeConfigRequest, opts ...grpc.CallOption) (*UpdateRuntimeConfigResponse, error) // Status returns the status of the runtime. Status(ctx context.Context, in *StatusRequest, opts ...grpc.CallOption) (*StatusResponse, error) }</span></span></code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> </div></div><br>  ÙŠØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· gRPC Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø·Ø±ÙŠÙ‚Ø© Ù…Ù† Ø®Ù„Ø§Ù„ ÙˆØ§Ø¬Ù‡Ø© ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> runtimeServiceClient <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { cc *grpc.ClientConn }</code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c *runtimeServiceClient)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Exec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx context.Context, in *ExecRequest, opts ...grpc.CallOption)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*ExecResponse, error)</span></span></span></span> { out := <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(ExecResponse) err := c.cc.Invoke(ctx, <span class="hljs-string"><span class="hljs-string">"/runtime.v1alpha2.RuntimeService/Exec"</span></span>, in, out, opts...) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> out, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> <br><br>  Ø­Ø§ÙˆÙŠØ© ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† ØªØ·Ø¨ÙŠÙ‚ <code>RuntimeServiceServer</code> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ù‚Ø§Ø¦Ù…Ø© Ø·ÙˆÙŠÙ„Ø© Ù…Ù† cri-api Ø¥Ù„Ù‰ kubernetes / kubernetes</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// RuntimeServiceServer is the server API for RuntimeService service. type RuntimeServiceServer interface { // Version returns the runtime name, runtime version, and runtime API version. Version(context.Context, *VersionRequest) (*VersionResponse, error) // RunPodSandbox creates and starts a pod-level sandbox. Runtimes must ensure // the sandbox is in the ready state on success. RunPodSandbox(context.Context, *RunPodSandboxRequest) (*RunPodSandboxResponse, error) // StopPodSandbox stops any running process that is part of the sandbox and // reclaims network resources (eg, IP addresses) allocated to the sandbox. // If there are any running containers in the sandbox, they must be forcibly // terminated. // This call is idempotent, and must not return an error if all relevant // resources have already been reclaimed. kubelet will call StopPodSandbox // at least once before calling RemovePodSandbox. It will also attempt to // reclaim resources eagerly, as soon as a sandbox is not needed. Hence, // multiple StopPodSandbox calls are expected. StopPodSandbox(context.Context, *StopPodSandboxRequest) (*StopPodSandboxResponse, error) // RemovePodSandbox removes the sandbox. If there are any running containers // in the sandbox, they must be forcibly terminated and removed. // This call is idempotent, and must not return an error if the sandbox has // already been removed. RemovePodSandbox(context.Context, *RemovePodSandboxRequest) (*RemovePodSandboxResponse, error) // PodSandboxStatus returns the status of the PodSandbox. If the PodSandbox is not // present, returns an error. PodSandboxStatus(context.Context, *PodSandboxStatusRequest) (*PodSandboxStatusResponse, error) // ListPodSandbox returns a list of PodSandboxes. ListPodSandbox(context.Context, *ListPodSandboxRequest) (*ListPodSandboxResponse, error) // CreateContainer creates a new container in specified PodSandbox CreateContainer(context.Context, *CreateContainerRequest) (*CreateContainerResponse, error) // StartContainer starts the container. StartContainer(context.Context, *StartContainerRequest) (*StartContainerResponse, error) // StopContainer stops a running container with a grace period (ie, timeout). // This call is idempotent, and must not return an error if the container has // already been stopped. // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> what must the runtime do after the grace period is reached? StopContainer(context.Context, *StopContainerRequest) (*StopContainerResponse, error) // RemoveContainer removes the container. If the container is running, the // container must be forcibly removed. // This call is idempotent, and must not return an error if the container has // already been removed. RemoveContainer(context.Context, *RemoveContainerRequest) (*RemoveContainerResponse, error) // ListContainers lists all containers by filters. ListContainers(context.Context, *ListContainersRequest) (*ListContainersResponse, error) // ContainerStatus returns status of the container. If the container is not // present, returns an error. ContainerStatus(context.Context, *ContainerStatusRequest) (*ContainerStatusResponse, error) // UpdateContainerResources updates ContainerConfig of the container. UpdateContainerResources(context.Context, *UpdateContainerResourcesRequest) (*UpdateContainerResourcesResponse, error) // ReopenContainerLog asks runtime to reopen the stdout/stderr log file // for the container. This is often called after the log file has been // rotated. If the container is not running, container runtime can choose // to either create a new log file and return nil, or return an error. // Once it returns error, new container log file MUST NOT be created. ReopenContainerLog(context.Context, *ReopenContainerLogRequest) (*ReopenContainerLogResponse, error) // ExecSync runs a command in a container synchronously. ExecSync(context.Context, *ExecSyncRequest) (*ExecSyncResponse, error) // Exec prepares a streaming endpoint to execute a command in the container. Exec(context.Context, *ExecRequest) (*ExecResponse, error) // Attach prepares a streaming endpoint to attach to a running container. Attach(context.Context, *AttachRequest) (*AttachResponse, error) // PortForward prepares a streaming endpoint to forward ports from a PodSandbox. PortForward(context.Context, *PortForwardRequest) (*PortForwardResponse, error) // ContainerStats returns stats of the container. If the container does not // exist, the call returns an error. ContainerStats(context.Context, *ContainerStatsRequest) (*ContainerStatsResponse, error) // ListContainerStats returns stats of all running containers. ListContainerStats(context.Context, *ListContainerStatsRequest) (*ListContainerStatsResponse, error) // UpdateRuntimeConfig updates the runtime configuration based on the given request. UpdateRuntimeConfig(context.Context, *UpdateRuntimeConfigRequest) (*UpdateRuntimeConfigResponse, error) // Status returns the status of the runtime. Status(context.Context, *StatusRequest) (*StatusResponse, error) }</span></span></code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> </div></div><br><img src="https://habrastorage.org/webt/ud/wx/mb/udwxmbczx1kgrhy_etiwnmkhlha.png"><br><br>  Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø£Ù…Ø± ÙƒØ°Ù„Ùƒ ØŒ ÙŠØ¬Ø¨ Ø£Ù† Ù†Ø±Ù‰ Ø§ØªØµØ§Ù„ Ø¨ÙŠÙ† kubelet ÙˆÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ØŒ Ø£Ù„ÙŠØ³ ÙƒØ°Ù„ÙƒØŸ  Ø¯Ø¹ÙˆÙ†Ø§ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø°Ù„Ùƒ. <br><br>  Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø£Ù…Ø± exec ÙˆØ¨Ø¹Ø¯Ù‡ ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª.  ÙÙŠ Ø­Ø§Ù„ØªÙŠ ØŒ Ø§Ù„ÙØ±Ù‚ Ù‡Ùˆ Ù‡Ø°Ø§: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// worker node $ ss -a -p |grep kubelet ... u_str ESTAB 0 0 * 157937 * 157387 users:((<span class="hljs-string"><span class="hljs-string">"kubelet"</span></span>,pid=5714,fd=33)) ...</code> </pre> <br>  Ù‡Ù…Ù…Ù… ... Ø§ØªØµØ§Ù„ Ø¬Ø¯ÙŠØ¯ Ø¹Ø¨Ø± Ù…Ø¢Ø®Ø° ÙŠÙˆÙ†ÙŠÙƒØ³ Ø¨ÙŠÙ† kubelet (Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù†ØªØ¬ = 5714) ÙˆØ´ÙŠØ¡ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ.  Ù…Ø§Ø°Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ†ØŸ  Ù‡Ø°Ø§ ØµØ­ÙŠØ­ ØŒ Ù‡Ø°Ø§ Ù‡Ùˆ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ (Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù†ØªØ¬ = 1186)! <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// worker node $ ss -a -p |grep 157387 ... u_str ESTAB 0 0 * 157937 * 157387 users:((<span class="hljs-string"><span class="hljs-string">"kubelet"</span></span>,pid=5714,fd=33)) u_str ESTAB 0 0 /var/run/docker.sock 157387 * 157937 users:((<span class="hljs-string"><span class="hljs-string">"dockerd"</span></span>,pid=1186,fd=14)) ...</code> </pre> <br>  ÙƒÙ…Ø§ ØªØªØ°ÙƒØ± ØŒ Ù‡Ø°Ù‡ Ø¹Ù…Ù„ÙŠØ© Ø®ÙÙŠÙ‘Ø© Ù„Ø±Ø³Ùˆ Ø§Ù„Ø³ÙÙ† (pid = 1186) ØªÙ†ÙØ° Ø£Ù…Ø±Ù†Ø§: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">// worker node $ ps -afx ... 1186 ? Ssl 0:55 /usr/bin/dockerd -H fd:// 17784 ? Sl 0:00 \_ docker-containerd-shim 53a0a08547b2f95986402d7f3b3e78702516244df049ba6c5aa012e81264aa3c /var/run/docker/libcontainerd/53a0a08547b2f95986402d7f3 17801 pts/2 Ss 0:00 \_ sh 17827 pts/2 S+ 0:00 \_ sleep 5000 ...</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4. Ø§Ù„Ù†Ø´Ø§Ø· ÙÙŠ ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© </h3><br>  Ø¯Ø¹Ù†Ø§ Ù†ØªÙØ­Øµ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ØµØ¯Ø±ÙŠ Ù„Ù€ CRI-O Ù„ÙÙ‡Ù… Ù…Ø§ ÙŠØ­Ø¯Ø«.  ÙÙŠ Docker ØŒ Ø§Ù„Ù…Ù†Ø·Ù‚ Ù…Ø´Ø§Ø¨Ù‡. <br><br>  ÙŠÙˆØ¬Ø¯ Ø®Ø§Ø¯Ù… Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† ØªØ·Ø¨ÙŠÙ‚ <code>RuntimeServiceServer</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Server implements the RuntimeService and ImageService type Server struct { config libconfig.Config seccompProfile *seccomp.Seccomp stream StreamService netPlugin ocicni.CNIPlugin hostportManager hostport.HostPortManager appArmorProfile string hostIP string bindAddress string *lib.ContainerServer monitorsChan chan struct{} defaultIDMappings *idtools.IDMappings systemContext *types.SystemContext // Never nil updateLock sync.RWMutex seccompEnabled bool appArmorEnabled bool }</span></span></code> </pre> <br>  <i>( <a href="">cri-o / server / server.go</a> )</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Exec prepares a streaming endpoint to execute a command in the container. func (s *Server) Exec(ctx context.Context, req *pb.ExecRequest) (resp *pb.ExecResponse, err error) { const operation = "exec" defer func() { recordOperation(operation, time.Now()) recordError(operation, err) }() resp, err = s.getExec(req) if err != nil { return nil, fmt.Errorf("unable to prepare exec endpoint: %v", err) } return resp, nil }</span></span></code> </pre> <br>  <i>( <a href="">cri-o / erver / container_exec.go</a> )</i> <br><br>  ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ù„Ø³Ù„Ø© ØŒ ÙŠÙ†ÙÙ‘Ø° ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø£Ù…Ø±Ù‹Ø§ Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„: <br><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ExecContainer prepares a streaming endpoint to execute a command in the container. func (r *runtimeOCI) ExecContainer(c *Container, cmd []string, stdin io.Reader, stdout, stderr io.WriteCloser, tty bool, resize &lt;-chan remotecommand.TerminalSize) error { processFile, err := prepareProcessExec(c, cmd, tty) if err != nil { return err } defer os.RemoveAll(processFile.Name()) args := []string{rootFlag, r.root, "exec"} args = append(args, "--process", processFile.Name(), c.ID()) execCmd := exec.Command(r.path, args...) if v, found := os.LookupEnv("XDG_RUNTIME_DIR"); found { execCmd.Env = append(execCmd.Env, fmt.Sprintf("XDG_RUNTIME_DIR=%s", v)) } var cmdErr, copyError error if tty { cmdErr = ttyCmd(execCmd, stdin, stdout, resize) } else { if stdin != nil { // Use an os.Pipe here as it returns true *os.File objects. // This way, if you run 'kubectl exec &lt;pod&gt; -i bash' (no tty) and type 'exit', // the call below to execCmd.Run() can unblock because its Stdin is the read half // of the pipe. r, w, err := os.Pipe() if err != nil { return err } go func() { _, copyError = pools.Copy(w, stdin) }() execCmd.Stdin = r } if stdout != nil { execCmd.Stdout = stdout } if stderr != nil { execCmd.Stderr = stderr } cmdErr = execCmd.Run() } if copyError != nil { return copyError } if exitErr, ok := cmdErr.(*exec.ExitError); ok { return &amp;utilexec.ExitErrorWrapper{ExitError: exitErr} } return cmdErr }</span></span></code> </pre> <br>  <i>( <a href="">cri-o / internal / oci / runtime_oci.go</a> )</i> <br><br><img src="https://habrastorage.org/webt/hm/dt/jk/hmdtjkw28fyrng0zsjghbw7tq5g.png"><br><br>  Ø£Ø®ÙŠØ±Ù‹Ø§ ØŒ ØªÙ†ÙØ° Ø§Ù„Ù†ÙˆØ§Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø±: <br><br><img src="https://habrastorage.org/webt/f2/7n/jk/f27njkgk1lqwo0ik-9vkj-kocic.png"><br><br><h2 style=";text-align:right;direction:rtl">  ØªØ°ÙƒÙŠØ± </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ÙŠÙ…ÙƒÙ† Ù„Ù€ API Server Ø£ÙŠØ¶Ù‹Ø§ Ø¨Ø¯Ø¡ Ø§ØªØµØ§Ù„ Ø¨Ù€ kubelet. </li><li style=";text-align:right;direction:rtl">  ØªØªÙ… Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø­ØªÙ‰ Ù†Ù‡Ø§ÙŠØ© Ø¬Ù„Ø³Ø© exec Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø¨ÙŠÙ† kubectl ÙˆØ§Ù„Ø®Ø§Ø¯Ù… api Ø› </li><li style=";text-align:right;direction:rtl">  Ø¨ÙŠÙ† api-server Ùˆ kubectl Ø› </li><li style=";text-align:right;direction:rtl">  Ø¨ÙŠÙ† kubelet ÙˆÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. </li></ul></li><li style=";text-align:right;direction:rtl">  ÙŠØªØ¹Ø°Ø± Ø¹Ù„Ù‰ Kubectl Ø£Ùˆ api-server ØªØ´ØºÙŠÙ„ Ø£ÙŠ Ø´ÙŠØ¡ Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯ Ø§Ù„Ø¥Ù†ØªØ§Ø¬.  ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØ¨Ø¯Ø£ Kubelet ØŒ Ù„ÙƒÙ† Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØŒ ÙØ¥Ù†Ù‡Ø§ ØªØªÙØ§Ø¹Ù„ Ø£ÙŠØ¶Ù‹Ø§ Ù…Ø¹ ÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. </li></ul><br><h2 style=";text-align:right;direction:rtl">  Ù…ÙˆØ§Ø±Ø¯ </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ù…Ù†Ø§Ù‚Ø´Ø© " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙƒÙŠÙ" kubectl exec "Ø§Ù„Ø¹Ù…Ù„</a> " ÙÙŠ kubernetes-dev Ø› </li><li style=";text-align:right;direction:rtl">  Ø§Ù„Ù…Ù‚Ø§Ù„ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø¹ kubeadm ÙÙŠ Ø¢Ù„Ø§Øª Vagrant ØŒ Ø§Ù„Ø¬Ø²Ø¡ 2</a> " Ø› </li><li style=";text-align:right;direction:rtl">  Ù…Ù†Ø§Ù‚Ø´Ø© " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙƒÙŠÙÙŠØ© Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± Ù…Ù† Ø§ØªØµØ§Ù„ Ù…Ø£Ø®Ø° ÙŠÙˆÙ†ÙƒØ³ØŸ</a>  "Ø¹Ù„Ù‰ Ø®Ø·Ø£ Ø§Ù„Ø®Ø§Ø¯Ù…. </li></ul><br><h2 style=";text-align:right;direction:rtl">  PS Ù…Ù† Ø§Ù„Ù…ØªØ±Ø¬Ù… </h2><br>  Ø§Ù‚Ø±Ø£ Ø£ÙŠØ¶Ù‹Ø§ ÙÙŠ Ù…Ø¯ÙˆÙ†ØªÙ†Ø§: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  "Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« ÙÙŠ Kubernetes Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ¨Ø¯Ø£ ØªØ´ØºÙŠÙ„ kubectlØŸ"  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ø¬Ø²Ø¡ 1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ§Ù„Ø¬Ø²Ø¡ 2</a> Ø› </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¥Ø°Ù† Ù…Ø§ Ù‡Ùˆ Ø¬Ø±Ø§Ø¨ ÙÙŠ KubernetesØŸ</a>  ". </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ù…Ø¬Ø¯ÙˆÙ„ Kubernet ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ØŸ"</a>  ". </li><li style=";text-align:right;direction:rtl"> Â« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">     Kubernetes</a> Â». </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar466093/">https://habr.com/ru/post/ar466093/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar466071/index.html">10.3 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ ØªØ¬Ø²Ø¦Ø©: Ø§Ù„ØªØ¹Ø¯ÙŠÙ† Ø¹Ù„Ù‰ ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø§Ù„ØªØ­ÙƒÙ… Ø¹Ù„Ù‰ Ù…ØªÙ† Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ© Ø£Ø¨ÙˆÙ„Ùˆ</a></li>
<li><a href="../ar466075/index.html">ÙƒÙŠÙ ØªØ±ÙƒØª Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„</a></li>
<li><a href="../ar466077/index.html">Ø¨Ø« Ø§Ù„ÙŠÙˆÙ… Techdir ÙÙŠ Ø³Ø§Ù† Ø¨Ø·Ø±Ø³Ø¨Ø±Ø¬</a></li>
<li><a href="../ar466081/index.html">3 Ø³Ø¨ØªÙ…Ø¨Ø±</a></li>
<li><a href="../ar466089/index.html">Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªÙÙƒÙŠØ± ÙˆØ§Ù„ÙˆØ¹ÙŠ ØŒ Ø§Ù„Ø¬Ø²Ø¡ 2</a></li>
<li><a href="../ar466097/index.html">Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª .NET</a></li>
<li><a href="../ar466099/index.html">Ù…ÙŠØ²Ø§Øª Ø§Ø®ØªØ¨Ø§Ø± ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ Ù„Ø®Ø¯Ù…Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a></li>
<li><a href="../ar466103/index.html">Ø³Ø­Ø§Ø¨Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ù…Ù†</a></li>
<li><a href="../ar466105/index.html">Ø±ÙØ¹ ØªØ±Ø¯Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ Magento Rest API Ù…Ø¹ RoadRunner</a></li>
<li><a href="../ar466107/index.html">Ø§ÙØ¹Ù„ Ø°Ù„Ùƒ Ø¨Ù†ÙØ³Ùƒ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù†Ø²Ù„ Ø§Ù„Ø°ÙƒÙŠ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>