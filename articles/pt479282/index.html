<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÇ üí∑ üññ Se os dados n√£o couberem na mem√≥ria. M√©todos mais simples üàµ üë®üèΩ‚Äçü§ù‚Äçüë®üèº üôèüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aardvark f√™mea com filhote. Foto: Scotto Bear , CC BY-SA 2.0 

 Voc√™ escreve um programa para processamento de dados, ele passa no teste perfeitamente...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Se os dados n√£o couberem na mem√≥ria. M√©todos mais simples</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dcmiran/blog/479282/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d9/123/a92/6d9123a92cd8eaa7935353ab9ed3f029.jpg"></div><br>  <i><font color="gray">Aardvark f√™mea com filhote.</font></i>  <i><font color="gray">Foto: <a href="">Scotto Bear</a> , CC BY-SA 2.0</font></i> <br><br>  Voc√™ escreve um programa para processamento de dados, ele passa no teste perfeitamente em um arquivo pequeno, mas trava com uma carga real. <br><br>  O problema est√° sem mem√≥ria.  Se voc√™ tiver 16 gigabytes de RAM, n√£o poder√° baixar um arquivo de cem gigabytes l√°.  Em algum momento, o sistema operacional ficar√° sem mem√≥ria, n√£o poder√° alocar um novo e o programa falhar√°. <br><br>  O que fazer <br><a name="habracut"></a><br>  Bem, voc√™ pode implantar um cluster de Big Data, apenas: <br><br><ul><li>  Encontre um cluster de computadores. <br></li><li>  Configure em uma semana. <br></li><li>  Aprenda a nova API e reescreva seu c√≥digo. </li></ul><br>  √â caro e desagrad√°vel.  Felizmente, muitas vezes n√£o √© necess√°rio. <br><br>  <b>Precisamos de uma solu√ß√£o simples e f√°cil: processar dados em um computador, com configura√ß√£o m√≠nima e uso m√°ximo de bibliotecas j√° conectadas.</b>  Isso quase sempre √© poss√≠vel com a ajuda de m√©todos mais simples, √†s vezes chamados de computa√ß√£o fora do n√∫cleo. <br><br>  Neste artigo, discutimos: <br><br><ul><li>  Por que precisamos de RAM? <br></li><li>  A maneira mais f√°cil de processar dados que n√£o cabem na mem√≥ria √© gastar um pouco de dinheiro. <br></li><li>  Tr√™s m√©todos principais de software para processar quantidades excessivas de dados: compacta√ß√£o, bloqueio e indexa√ß√£o. </li></ul><br>  Os artigos futuros mostrar√£o na pr√°tica como aplicar esses m√©todos com bibliotecas espec√≠ficas, como NumPy e Pandas.  Mas primeiro, a teoria. <br><br><h2>  Por que a RAM √© necess√°ria? </h2><br>  Antes de entrarmos na discuss√£o de solu√ß√µes, vamos esclarecer por que esse problema existe.  Voc√™ pode gravar dados na mem√≥ria de acesso aleat√≥rio (RAM), mas tamb√©m no disco r√≠gido. Por que voc√™ precisa de RAM?  Um disco √© mais barato, geralmente n√£o tem problemas com falta de espa√ßo; por que n√£o se limitar apenas √† leitura e grava√ß√£o de um disco? <br><br>  Teoricamente, isso pode funcionar.  Mas mesmo os SSDs r√°pidos modernos funcionam <a href="https://people.eecs.berkeley.edu/~rcs/research/interactive_latency.html">muito, muito mais lentamente</a> que a RAM: <br><br><ul><li>  Leia a partir do SSD: ~ 16.000 nanossegundos <br></li><li>  Leia a partir da RAM: ~ 100 nanossegundos </li></ul><br>  Para c√°lculos r√°pidos, n√£o temos escolha: os dados devem ser gravados na RAM, caso contr√°rio, o c√≥digo diminuir√° 150 vezes. <br><br><h2>  A solu√ß√£o mais f√°cil: mais RAM </h2><br>  A solu√ß√£o mais f√°cil para o problema de ficar sem mem√≥ria RAM √© gastar algum dinheiro.  Voc√™ pode comprar um computador, servidor ou alugar uma m√°quina virtual com muita mem√≥ria.  Em novembro de 2019, uma pesquisa r√°pida e uma breve compara√ß√£o de pre√ßos oferecem as seguintes op√ß√µes: <br><br><ul><li>  <b>Compre o</b> Thinkpad M720 Tower com 6 n√∫cleos e 64 GB de RAM por US $ 1074 <br></li><li>  <b>Alugue</b> uma m√°quina virtual na nuvem com 64 n√∫cleos e 432 GB de RAM por US $ 3,62 / hora </li></ul><br>  Estes s√£o apenas n√∫meros ap√≥s uma pesquisa r√°pida.  Depois de fazer uma boa pesquisa, voc√™ certamente encontrar√° melhores ofertas. <br><br>  <b>Gastar um pouco de dinheiro em hardware para ajustar os dados na RAM geralmente √© a solu√ß√£o mais barata.</b>  <b>Afinal, nosso tempo √© caro.</b>  Mas √†s vezes isso n√£o √© suficiente. <br><br>  Por exemplo, se voc√™ executar muitas tarefas de processamento de dados por um per√≠odo, a computa√ß√£o em nuvem pode ser uma solu√ß√£o natural, mas tamb√©m pode ser cara.  Em um de nossos projetos, esses custos de computa√ß√£o consumiriam toda a receita projetada do produto, incluindo a receita mais importante necess√°ria para pagar meu sal√°rio. <br><br>  <b>Se comprar / alugar uma grande quantidade de RAM n√£o resolver o problema ou n√£o for poss√≠vel, o pr√≥ximo passo √© otimizar o pr√≥prio aplicativo para que consuma menos mem√≥ria.</b> <br><br><h2>  T√©cnica n√∫mero 1. Compress√£o </h2><br>  A compacta√ß√£o permite colocar os mesmos dados em menos mem√≥ria.  Existem duas formas de compacta√ß√£o: <br><br><ul><li>  <b>Sem perdas</b> : ap√≥s a compacta√ß√£o, exatamente as mesmas informa√ß√µes s√£o salvas como nos dados originais. <br></li><li>  <b>Perda</b> : os dados armazenados perdem alguns detalhes, mas, idealmente, isso n√£o afeta muito os resultados do c√°lculo. </li></ul><br>  Apenas para maior clareza, n√£o se trata de arquivos zip ou gzip quando os dados s√£o compactados <i>no disco</i> .  Para processar dados de um arquivo ZIP, voc√™ normalmente precisa descompact√°-lo e, em seguida, carregar os arquivos na mem√≥ria.  Ent√£o isso n√£o vai ajudar. <br><br>  <b>O que precisamos √© de uma compress√£o da representa√ß√£o dos dados na <i>mem√≥ria</i> .</b> <br><br>  Suponha que seus dados armazenem apenas dois valores poss√≠veis, e nada mais: <code>"AVAILABLE"</code> e <code>"UNAVAILABLE"</code> .  Em vez de armazenar seq√º√™ncias de caracteres com 10 bytes ou mais por registro, voc√™ pode salv√°-las como valores booleanos <code>True</code> ou <code>False</code> , que s√£o codificados com apenas um byte.  Voc√™ pode compactar informa√ß√µes at√© um bit, reduzindo o consumo de mem√≥ria em outras oito vezes. <br><br><h2>  T√©cnica n¬∫ 2. Dividindo em blocos, carregando dados um bloco de cada vez </h2><br>  A fragmenta√ß√£o √© √∫til em situa√ß√µes em que os dados n√£o precisam ser carregados na mem√≥ria ao mesmo tempo.  Em vez disso, podemos carreg√°-los em partes, processando um fragmento de cada vez (ou, como discutiremos no pr√≥ximo artigo, v√°rias partes em paralelo). <br><br>  Suponha que voc√™ queira encontrar a maior palavra em um livro.  Voc√™ pode carregar todos os dados na mem√≥ria de uma vez: <br><br><pre> <code class="python hljs">largest_word = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> book.get_text().split(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(word) &gt; len(largest_word): largest_word = word</code> </pre> <br>  Mas se o livro n√£o couber na mem√≥ria, voc√™ pode carreg√°-lo p√°gina por p√°gina: <br><br><pre> <code class="python hljs">largest_word = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> page <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> book.iterpages(): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> page.get_text().split(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(word) &gt; len(largest_word): largest_word = word</code> </pre> <br>  Isso reduz bastante o consumo de mem√≥ria, pois apenas uma p√°gina de um livro √© carregada por vez.  Nesse caso, o resultado ser√° a mesma resposta. <br><br><h2>  T√©cnica n¬∫ 3. Indexa√ß√£o quando apenas um subconjunto de dados √© necess√°rio </h2><br>  A indexa√ß√£o √© √∫til se voc√™ deseja usar apenas um subconjunto dos dados e carregar diferentes subconjuntos em momentos diferentes. <br><br>  Em princ√≠pio, em tal situa√ß√£o, voc√™ pode filtrar a parte necess√°ria e descartar o desnecess√°rio.  Mas a filtragem √© lenta e n√£o √© ideal, porque voc√™ precisa primeiro carregar muitos dados extras na mem√≥ria antes de solt√°-los. <br><br>  <b>Se voc√™ precisar apenas de uma parte dos dados, em vez da fragmenta√ß√£o, √© melhor usar um √≠ndice - um <i>aperto de</i> dados que indica sua localiza√ß√£o real.</b> <br><br>  Imagine que voc√™ queira ler apenas fragmentos de um livro mencionando aardvark (um mam√≠fero fofo na fotografia no in√≠cio do artigo).  Se voc√™ verificar todas as p√°ginas, o livro inteiro ser√° carregado em partes, p√°gina por p√°gina, em busca de aardvarks - e isso levar√° bastante tempo. <br><br>  Ou voc√™ pode abrir imediatamente o √≠ndice alfab√©tico no final do livro - e encontrar a palavra "aardvark".  Ele afirma que a palavra √© mencionada nas p√°ginas 7, 19 e 120-123.  Agora voc√™ pode ler essas p√°ginas, e somente elas, o que √© muito mais r√°pido. <br><br>  Esse √© um m√©todo eficaz, pois o √≠ndice √© muito menor que o livro inteiro, portanto, √© muito mais f√°cil carregar apenas o √≠ndice na mem√≥ria para encontrar os dados relevantes. <br><br><h4>  O m√©todo de indexa√ß√£o mais f√°cil </h4><br>  A maneira mais f√°cil e comum de indexar √© nomear arquivos em um diret√≥rio: <br><br><pre> <code class="plaintext hljs">mydata/ 2019-Jan.csv 2019-Feb.csv 2019-Mar.csv 2019-Apr.csv ...</code> </pre> <br>  Se voc√™ precisar de dados para mar√ßo de 2019, basta fazer o upload do arquivo <code>2019-Mar.csv</code> - n√£o h√° necessidade de baixar dados para fevereiro, julho ou qualquer outro m√™s. <br><br><h2>  Pr√≥ximo: aplicando esses m√©todos </h2><br>  O problema da falta de RAM √© mais f√°cil de resolver com a ajuda do dinheiro, tendo comprado a RAM.  Mas se isso n√£o for poss√≠vel ou insuficiente, voc√™ usar√° a compacta√ß√£o, fragmenta√ß√£o ou indexa√ß√£o de qualquer maneira. <br><br>  <b>Os mesmos m√©todos s√£o usados ‚Äã‚Äãem v√°rios pacotes e ferramentas de software</b> .  At√© sistemas de Big Data de alto desempenho s√£o criados sobre eles: por exemplo, processamento paralelo de fragmentos de dados individuais. <br><br>  Nos artigos a seguir, veremos como aplicar esses m√©todos em bibliotecas e ferramentas espec√≠ficas, incluindo NumPy e Pandas. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479282/">https://habr.com/ru/post/pt479282/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479270/index.html">Que novidades voc√™ pode esperar do Node.js em 2020?</a></li>
<li><a href="../pt479272/index.html">[marcador] 9 ferramentas que aumentam a produtividade do desenvolvedor da web</a></li>
<li><a href="../pt479274/index.html">10 truques em Python para conhecer</a></li>
<li><a href="../pt479276/index.html">Tr√™s m√©todos de pandas que voc√™ talvez n√£o conhe√ßa</a></li>
<li><a href="../pt479278/index.html">De cem a quinhentos d√≠gitos do n√∫mero pi no joelho</a></li>
<li><a href="../pt479284/index.html">A casa que o rob√¥ construiu</a></li>
<li><a href="../pt479286/index.html">Escrevendo um aplicativo Web simples usando Spring MVC, Spring Data JPA e Hibernate</a></li>
<li><a href="../pt479288/index.html">Por que implementar o Service Desk e como escolher uma solu√ß√£o para sua empresa</a></li>
<li><a href="../pt479290/index.html">Algoritmos para pesquisar o volume e o centro de massa de um poliedro</a></li>
<li><a href="../pt479292/index.html">Como ensinar uma rede neural a reproduzir a f√≠sica dos jogos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>