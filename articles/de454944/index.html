<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙🏽 🐗 🎪 So funktioniert das JPEG-Format 👷🏼 💇🏿 😋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JPEG-Bilder sind überall in unserem digitalen Leben zu finden, aber hinter dieser Abdeckung des Bewusstseins stecken Algorithmen, die Details eliminie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So funktioniert das JPEG-Format</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454944/"><h4>  JPEG-Bilder sind überall in unserem digitalen Leben zu finden, aber hinter dieser Abdeckung des Bewusstseins stecken Algorithmen, die Details eliminieren, die vom menschlichen Auge nicht wahrgenommen werden.  Das Ergebnis ist die höchste visuelle Qualität bei kleinster Dateigröße - aber wie genau funktioniert das alles?  Mal sehen, was genau unsere Augen nicht sehen! </h4><br><img src="https://habrastorage.org/webt/xh/7m/8n/xh7m8nokzhgfqixb00fnwcmkthm.jpeg"><br><br>  Es ist einfach, die Möglichkeit, ein Foto an einen Freund zu senden, als selbstverständlich zu betrachten und sich keine Gedanken darüber zu machen, welches Gerät, welcher Browser oder welches Betriebssystem verwendet wird. Dies war jedoch nicht immer der Fall.  In den frühen 1980er Jahren wussten Computer, wie man digitale Bilder speichert und anzeigt, aber es gab viele konkurrierende Ideen, wie dies am besten möglich ist.  Es war unmöglich, einfach ein Bild von einem Computer auf einen anderen zu senden und zu hoffen, dass alles funktionierte. <br><a name="habracut"></a><br>  Um dieses Problem zu lösen, wurde 1986 in Zusammenarbeit mit der Internationalen Organisation für Normung (ISO) und der Internationalen Elektrotechnischen Kommission (IEC) ein Expertenkomitee aus der ganzen Welt unter dem Namen Joint Photographic Experts Group (JPEG) zusammengestellt ) - zwei internationale Normungsorganisationen mit Hauptsitz in Genf (Schweiz). <br><br>  Eine Gruppe von Personen namens JPEG schuf 1992 den JPEG-Standard für die digitale Bildkomprimierung.  Jeder, der das Internet nutzt, stößt wahrscheinlich auf JPEG-codierte Bilder.  Dies ist die häufigste Methode zum Codieren, Senden und Speichern von Bildern.  Von Webseiten über E-Mails bis hin zu sozialen Netzwerken wird JPEG milliardenfach am Tag verwendet - fast jedes Mal, wenn wir ein Bild online ansehen oder senden.  Ohne JPEG wäre das Web weniger lebendig, langsamer und wahrscheinlich weniger Katzenbilder! <br><br>  In diesem Artikel wird beschrieben, wie Sie ein JPEG-Bild dekodieren.  Mit anderen Worten, was erforderlich ist, um auf einem Computer gespeicherte komprimierte Daten in ein Bild umzuwandeln, das auf dem Bildschirm angezeigt wird.  Es ist wichtig, darüber Bescheid zu wissen, nicht nur, weil es wichtig ist, die Technologie zu verstehen, die wir täglich verwenden, sondern auch, weil wir bei der Offenlegung der Kompressionsstufen die Wahrnehmung und das Sehen sowie die Details, für die unsere Augen am empfindlichsten sind, besser verstehen. <br><br>  Außerdem ist es sehr interessant, auf diese Weise mit Bildern zu spielen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f8/312/709/4f831270939c4f685405283f4286e867.gif"><br><br><h2>  Blick in ein JPEG </h2><br>  Auf einem Computer wird alles als Folge von Binärzahlen gespeichert.  Typischerweise sind diese Bits, Nullen und Einsen, in acht gruppiert und bilden Bytes.  Wenn Sie ein JPEG-Bild auf einem Computer öffnen, sollte etwas (Browser, Betriebssystem, etwas anderes) die Bytes dekodieren und das Originalbild in Form einer Liste von Farben wiederherstellen, die angezeigt werden können. <br><br>  Wenn Sie dieses süße <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Katzenfoto</a> herunterladen und in einem Texteditor öffnen, sehen Sie eine Reihe inkohärenter Zeichen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e4/8a0/017/1e48a0017ada1830f50eefc5079410ea.png"><br>  <i>Hier verwende ich Notepad ++, um den Inhalt einer Datei zu untersuchen, da normale Texteditoren wie Notepad von Windows die Binärdatei nach dem Speichern beschädigen und das JPEG-Format nicht mehr erfüllen.</i> <br><br>  Wenn Sie ein Bild in einem Texteditor öffnen, verwirren Sie den Computer, genauso wie Sie Ihr Gehirn verwirren, wenn Sie sich die Augen reiben und anfangen, farbige Flecken zu sehen! <br><br>  Diese Flecken, die Sie sehen, werden als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Phosphene bezeichnet</a> und sind nicht das Ergebnis der Exposition gegenüber einem Lichtreiz oder Halluzinationen, die vom Geist erzeugt werden.  Sie treten auf, weil Ihr Gehirn glaubt, dass elektrische Signale in den Sehnerven Informationen über das Licht übertragen.  Das Gehirn muss solche Annahmen treffen, da es unmöglich ist zu wissen, ob das Signal Ton, Vision oder irgendetwas anderes ist.  Alle Nerven im Körper übertragen genau die gleichen elektrischen Impulse.  Durch Drücken auf die Augen senden Sie Signale, die nicht visuell sind, sondern die Rezeptoren des Auges aktivieren, die Ihr Gehirn - in diesem Fall falsch - als etwas Visuelles interpretiert.  Sie können buchstäblich den Druck sehen! <br><br>  Es ist lustig darüber nachzudenken, wie Computer wie ein Gehirn aussehen, aber es ist auch eine nützliche Analogie, die zeigt, wie stark die Bedeutung von Daten, die von Nerven durch den Körper übertragen oder auf einem Computer gespeichert werden, von ihrer Interpretation abhängt.  Alle Binärdaten bestehen aus Nullen und Einsen, Grundkomponenten, die Informationen jeglicher Art übertragen können.  Ihr Computer errät häufig anhand von Hinweisen wie Dateierweiterungen, wie sie interpretiert werden sollen.  Und jetzt zwingen wir ihn, sie als Text zu interpretieren, wie es der Texteditor erwartet. <br><br>  Um zu verstehen, wie JPEG dekodiert wird, müssen wir die Originalsignale selbst sehen - Binärdaten.  Dies kann mit dem Hex-Editor oder direkt auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Webseite des Originalartikels erfolgen</a> !  Es gibt ein Bild, neben dem im Textfeld alle Bytes (außer der Kopfzeile) in Dezimalform angezeigt werden.  Sie können sie ändern, und das Skript wird sofort neu codieren und ein neues Bild erstellen. <br><br><img src="https://habrastorage.org/webt/0e/tu/az/0etuazw_ujtrjmepdjpaacmg_jo.png"><br><br>  Sie können viel lernen, indem Sie einfach mit diesem Editor spielen.  Können Sie beispielsweise feststellen, in welcher Reihenfolge die Pixel gespeichert sind? <br><br>  In diesem Beispiel ist es seltsam, dass das Ändern einiger Zahlen das Bild überhaupt nicht beeinflusst. Wenn Sie beispielsweise die Zahl 17 in der ersten Zeile durch 0 ersetzen, wird das Foto vollständig beschädigt! <br><br><img src="https://habrastorage.org/webt/ql/47/xz/ql47xznmt7fq29yoynour0fscls.png"><br><br>  Andere Änderungen, zum Beispiel das Ersetzen von 7 in Zeile 1988 durch die Nummer 254, ändern die Farbe, jedoch nur der nachfolgenden Pixel. <br><br><img src="https://habrastorage.org/webt/tj/tu/0o/tjtu0o9qppmq2pgv5mpfh02hpzw.png"><br><br>  Das Seltsamste ist vielleicht, dass einige Zahlen nicht nur die Farbe, sondern auch die Form des Bildes ändern.  Ändern Sie 70 in Zeile 12 in 2 und schauen Sie in die obere Reihe des Bildes, um zu sehen, was ich meine. <br><br><img src="https://habrastorage.org/webt/wr/ui/w3/wruiw3ds_yihzasjgytn8vul1de.png"><br><br>  Unabhängig davon, welches JPEG-Bild Sie verwenden, finden Sie diese kryptischen Schachsequenzen beim Bearbeiten von Bytes immer. <br><br>  Wenn Sie mit dem Editor spielen, ist es schwer zu verstehen, wie das Foto aus diesen Bytes neu erstellt wird, da die JPEG-Komprimierung aus drei verschiedenen Technologien besteht, die nacheinander über die Ebenen hinweg angewendet werden.  Wir werden jeden von ihnen einzeln untersuchen, um das mysteriöse Verhalten zu enthüllen, das wir beobachten. <br><br>  <b>Drei Stufen der JPEG-Komprimierung:</b> <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Farb-Downsampling</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Diskrete Cosinustransformation und Diskretisierung</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codierung von Serienlängen</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Delta</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Huffman</a> </li></ol><br>  Damit Sie sich die Komprimierungsskala vorstellen können, beachten Sie bitte, dass das obige Bild 79.819 Zahlen darstellt, dh ungefähr 79 KB.  Wenn wir es ohne Komprimierung speichern würden, wären für jedes Pixel drei Zahlen erforderlich - für die rote, grüne und blaue Komponente.  Das wären 917.700 Zahlen oder ca.  917 Kb.  Infolge der JPEG-Komprimierung hat sich die resultierende Datei um mehr als das Zehnfache verringert! <br><br>  Tatsächlich kann dieses Bild viel stärker komprimiert werden.  Unten sehen Sie zwei Bilder nebeneinander - das Foto rechts wurde auf 16 KB verkleinert, das ist 57-mal kleiner als die unkomprimierte Version! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec8/a0f/b53/ec8a0fb53e28470aafb8fb6b04713de3.png"><br><br>  Wenn Sie genau hinschauen, werden Sie feststellen, dass diese Bilder nicht identisch sind.  Beide sind Bilder mit JPEG-Komprimierung, aber das richtige ist viel kleiner.  Es sieht auch etwas schlechter aus (siehe die Quadrate der Hintergrundfarben).  Daher wird JPEG auch als verlustbehaftete Komprimierung bezeichnet.  Während der Komprimierung ändert sich das Bild und verliert einige Details. <br><br><h2>  1. Farb-Downsampling </h2><br>  Hier ist ein Bild, das nur die erste Komprimierungsstufe verwendet. <br><br><img src="https://habrastorage.org/webt/bn/jq/j3/bnjqj3gjgcxd3xazrfnepcfwo-s.png"><br>  <i>(Interaktive Version - im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalartikel</a> ).</i>  <i>Durch Entfernen einer Zahl werden alle Farben zerstört.</i>  <i>Wenn Sie jedoch genau sechs Zahlen löschen, hat dies praktisch keine Auswirkungen auf das Bild.</i> <br><br>  Jetzt sind die Zahlen etwas leichter zu entziffern.  Dies ist eine fast einfache Liste von Farben, bei der jedes Byte genau ein Pixel ändert, gleichzeitig aber bereits halb so groß ist wie ein unkomprimiertes Bild (das bei einer derart reduzierten Größe etwa 300 KB einnehmen würde).  Ratet mal warum? <br><br>  Sie können sehen, dass diese Zahlen nicht die Standardkomponenten Rot, Grün und Blau bezeichnen. Wenn wir alle Zahlen durch Nullen ersetzen, erhalten wir ein grünes Bild (und kein Weiß). <br><br><img src="https://habrastorage.org/webt/ij/ar/qj/ijarqjsfiuanba52sxsn-ovh6q0.png"><br><br>  Dies liegt daran, dass diese Bytes Y (Helligkeit) anzeigen. <br><br><img src="https://habrastorage.org/webt/ab/sl/bt/abslbtgj10nk62g7ksdlx0lusck.png"><br><br>  Cb (relative Blauheit), <br><br><img src="https://habrastorage.org/webt/_s/ao/1c/_sao1c1div5bv1dltl6gahkp86a.png"><br><br>  und Cr-Bilder (relative Rötung). <br><br><img src="https://habrastorage.org/webt/mp/fz/jt/mpfzjtlicxlsmw3wmbrnqhywinu.png"><br><br>  Warum nicht RGB verwenden?  So funktionieren die meisten modernen Bildschirme.  Ihr Monitor kann jede Farbe anzeigen, einschließlich Rot, Grün und Blau mit unterschiedlichen Intensitäten für jedes Pixel.  Weiß wird erhalten, indem alle drei bei voller Helligkeit eingeschaltet werden, und Schwarz, indem sie ausgeschaltet werden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c27/504/f77/c27504f7737bca3efab3468f2a09aacc.png"><br><br>  Es ist auch der Arbeit des menschlichen Auges sehr ähnlich.  Die Farbrezeptoren unserer Augen werden als " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zapfen</a> " bezeichnet und sind in drei Typen unterteilt, von denen jeder empfindlicher auf Rot, Grün oder Blau reagiert. [Zapfen vom Typ S sind in Violettblau empfindlich (S von English Short - Shortwave) Spektrum), M-Typ - in grün-gelb (M aus dem Englischen. Mittel - Mittelwelle) und L-Typ - in den gelb-roten (L aus dem Englischen. Lang - langwellig) Teilen des Spektrums.  Das Vorhandensein dieser drei Arten von Zapfen (und Stäbchen, die im smaragdgrünen Teil des Spektrums empfindlich sind) gibt einer Person Farbsehen.  / ca.  übersetzt.].  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stäbchen</a> , eine andere Art von Fotorezeptor in unseren Augen, können nur Helligkeitsänderungen erfassen, sind jedoch viel empfindlicher.  In unseren Augen gibt es ungefähr 120 Millionen Stäbchen und nur 6 Millionen Zapfen. <br><br>  Daher bemerken unsere Augen Helligkeitsänderungen viel besser als Farbänderungen.  Wenn Sie die Farbe von der Helligkeit trennen, können Sie ein wenig Farbe entfernen, und niemand wird etwas bemerken.  Beim Farb-Downsampling werden die Farbkomponenten eines Bildes mit einer niedrigeren Auflösung als die Helligkeitskomponenten dargestellt.  Im obigen Beispiel hat jedes Pixel genau eine Y-Komponente, und jede einzelne Gruppe von vier Pixeln hat genau eine Cb-Komponente und ein Cr.  Daher enthält das Bild viermal weniger Farbinformationen als das Original. <br><br>  Der YCbCr-Farbraum wird nicht nur in JPEG verwendet.  Es wurde ursprünglich 1938 für Fernsehshows erfunden.  Nicht jeder hat einen Farbfernseher, so dass durch die Trennung von Farbe und Helligkeit jeder das gleiche Signal empfangen konnte, und Fernseher ohne Farbe verwendeten nur die Helligkeitskomponente. <br><br>  Wenn Sie also eine Zahl aus dem Editor löschen, werden alle Farben vollständig zerstört.  Komponenten werden als JJJJ Cb Cr gespeichert (tatsächlich nicht unbedingt in dieser Reihenfolge - die Speicherreihenfolge wird im Dateikopf angegeben).  Das Entfernen der ersten Zahl führt dazu, dass der erste Cb-Wert als Y, Cr als Cb wahrgenommen wird und insgesamt ein Dominoeffekt auftritt, der alle Farben des Bildes wechselt. <br><br>  Die JPEG-Spezifikation verpflichtet Sie nicht zur Verwendung von YCbCr.  In den meisten Dateien wird es jedoch verwendet, da es nach dem Downsampling Bilder mit besserer Qualität liefert als RGB.  Aber du musst nicht mein Wort dafür nehmen.  Überzeugen Sie sich in der folgenden Tabelle, wie das Downsampling jeder einzelnen Komponente in RGB und YCbCr aussehen wird. <br><br><img src="https://habrastorage.org/webt/9b/fl/ei/9bfleirkdnq8sdwiudks05bdz1o.png"><br>  (Interaktive Version - im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalartikel</a> ). <br><br>  Das Entfernen von Blau ist nicht so auffällig wie das Entfernen von Rot oder Grün.  Dies liegt an den sechs Millionen Zapfen in Ihren Augen, etwa 64% reagieren empfindlich auf Rot, 32% auf Grün und 2% auf Blau. <br><br>  Die Unterabtastung der Komponente Y (unten links) ist am besten zu sehen.  Auffällig ist sogar eine geringfügige Änderung. <br><br>  Durch das Konvertieren eines Bilds von RGB in YCbCr wird die Dateigröße nicht verringert, es wird jedoch einfacher, weniger auffällige Details zu finden, die entfernt werden können.  In der zweiten Stufe tritt eine verlustbehaftete Komprimierung auf.  Es basiert auf der Idee, Daten in einer komprimierbareren Form darzustellen. <br><br><h2>  2. Diskrete Cosinustransformation und Diskretisierung </h2><br>  Diese Komprimierungsstufe bestimmt größtenteils die Essenz von JPEG.  Nach dem Konvertieren von Farben in YCbCr werden die Komponenten separat komprimiert, sodass wir uns erst später auf die Y-Komponente konzentrieren können. So sehen die Bytes der Y-Komponente nach dem Anwenden dieser Ebene aus. <br><br><img src="https://habrastorage.org/webt/sr/c2/en/src2enhysp480z4qoycrgptdn5m.png"><br>  <i>(Interaktive Version - im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalartikel</a> ).</i>  Wenn Sie in der interaktiven Version auf ein Pixel klicken, wird der Editor zu der Zeile gescrollt, die dies angibt.  Versuchen Sie, Zahlen vom Ende zu entfernen oder einer bestimmten Zahl einige Nullen hinzuzufügen. <br><br>  Auf den ersten Blick sieht es nach einer sehr schlechten Komprimierung aus.  Das Bild enthält 100.000 Pixel, und 102.400 Zahlen sind erforderlich, um ihre Helligkeit (Y-Komponenten) anzuzeigen - dies ist schlimmer, als überhaupt nichts zu komprimieren! <br><br>  Beachten Sie jedoch, dass die meisten dieser Zahlen Null sind.  Darüber hinaus können alle diese Nullen am Zeilenende gelöscht werden, ohne das Bild zu ändern.  Es sind noch ungefähr 26.000 Nummern übrig, und das ist fast viermal weniger! <br><br>  Auf dieser Ebene liegt das Geheimnis der Schachmuster.  Im Gegensatz zu anderen Effekten, die wir gesehen haben, ist das Erscheinungsbild dieser Muster kein Fehler.  Sie sind die Bausteine ​​des gesamten Bildes.  Jede Zeile des Editors enthält genau 64 Zahlen, diskrete Cosinustransformationskoeffizienten (DCT), die Intensitäten von 64 eindeutigen Mustern entsprechen. <br><br>  Diese Muster werden auf der Basis des Kosinusgraphen gebildet.  Hier sind einige davon: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2cc/8da/dd7/2cc8dadd7ca3d6565753fdd8f14a4fcd.png"><br>  <i>8 von 64 Gewinnchancen</i> <br><br>  Unten sehen Sie ein Bild, das alle 64 Muster zeigt. <br><br><img src="https://habrastorage.org/webt/z3/8n/ri/z38nrihqi2zbdt2cznzqy3p1bh0.png"><br>  <i>(Interaktive Version - im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalartikel</a> ).</i> <br><br>  Diese Muster sind von besonderer Bedeutung, da sie die Grundlage für 8x8-Bilder bilden.  Wenn Sie mit linearer Algebra nicht vertraut sind, bedeutet dies, dass aus diesen 64 Mustern jedes 8x8-Bild erhalten werden kann.  Bei DCT werden Bilder in 8 x 8 Blöcke unterteilt und jeder Block in eine Kombination dieser 64 Koeffizienten umgewandelt. <br><br>  Die Tatsache, dass jedes Bild aus 64 spezifischen Mustern bestehen kann, scheint magisch.  Dies ist jedoch dasselbe wie zu sagen, dass jeder Ort auf der Erde durch zwei Zahlen beschrieben werden kann - Breite und Länge [was Hemisphären anzeigt / ca.  übersetzt.].  Wir betrachten die Erdoberfläche oft als zweidimensional, daher benötigen wir nur zwei Zahlen.  Ein 8x8-Bild hat 64 Dimensionen, daher benötigen wir 64 Zahlen. <br><br>  Es ist noch nicht klar, wie uns dies im Sinne der Komprimierung hilft.  Wenn wir 64 Zahlen benötigen, um ein 8x8-Bild darzustellen, warum ist dies besser, als nur 64 Luminanzkomponenten zu speichern?  Wir tun dies aus dem gleichen Grund, aus dem wir drei RGB-Nummern in drei YCbCr-Nummern umgewandelt haben: Dadurch können wir unsichtbare Details entfernen. <br><br>  Es ist schwer zu erkennen, welche Details zu diesem Zeitpunkt genau entfernt werden, da JPEG DCT auf 8x8-Blöcke anwendet.  Niemand verbietet uns jedoch, es auf das ganze Bild anzuwenden.  So sieht DCT in Komponente Y aus, wenn es auf das gesamte Bild angewendet wird: <br><br><img src="https://habrastorage.org/webt/ab/sl/bt/abslbtgj10nk62g7ksdlx0lusck.png"><br><br>  Am Ende können Sie mehr als 60.000 Nummern löschen, ohne dass sich das Foto merklich ändert. <br><br><img src="https://habrastorage.org/webt/we/mq/ma/wemqmatswqyazpgyxm12k-g7l-s.png"><br><br>  Beachten Sie jedoch, dass der Unterschied offensichtlich ist, wenn wir die ersten fünf Zahlen zurücksetzen. <br><br><img src="https://habrastorage.org/webt/m0/fj/tj/m0fjtjcfr_-6b50duzk3-zvl7gi.png"><br><br>  Die Zahlen am Anfang zeigen niederfrequente Änderungen im Bild an, und unsere Augen nehmen sie am besten auf.  Die Zahlen am Ende zeigen Änderungen bei hohen Frequenzen an, die schwieriger zu bemerken sind.  Um zu sehen, was mit dem Auge nicht sichtbar ist, können wir diese hochfrequenten Teile isolieren, indem wir die ersten 5000 Zahlen auf Null setzen. <br><br><img src="https://habrastorage.org/webt/si/gj/w2/sigjw20pylfjmu0rzqjocl6oqv4.png"><br><br>  Wir sehen alle Bereiche des Bildes, in denen die größte Änderung von Pixel zu Pixel auftritt.  Die Augen der Katze, sein Schnurrbart, die Frotteedecke und die Schatten in der unteren linken Ecke fallen auf.  Sie können noch weiter gehen, indem Sie die ersten 10.000 Zahlen löschen: <br><br><img src="https://habrastorage.org/webt/eg/vi/9a/egvi9a_wkwv48xktp7jiyajnhuc.png"><br><br>  20.000: <br><br><img src="https://habrastorage.org/webt/y9/fr/ri/y9frrialb_94gnwdd-plq_hcyqc.png"><br><br>  40.000: <br><br><img src="https://habrastorage.org/webt/0d/ce/kr/0dcekrobg9_ir-hqnggr9fjlw4u.png"><br><br>  60.000: <br><br><img src="https://habrastorage.org/webt/uo/8f/qx/uo8fqxadj-snukbdf1dcjgvoux0.png"><br><br>  Diese Hochfrequenzteile sind JPEG und werden während der Komprimierungsphase gelöscht.  Das Konvertieren von Farben in DCT-Koeffizienten ist verlustfrei.  Verluste werden im Diskretisierungsschritt erzeugt, bei dem Hochfrequenzwerte oder nahe Null entfernt werden.  Wenn Sie die Qualität des Speicherns von JPEG verringern, erhöht das Programm den Schwellenwert für die Anzahl der gelöschten Werte, wodurch die Dateigröße verringert wird, das Bild jedoch pixeliger wird.  Daher sah das Bild im ersten Abschnitt, das 57-mal kleiner war, so aus.  Jeder 8x8-Block schien im Vergleich zu einer besseren Version eine viel geringere Anzahl von DCT-Koeffizienten zu haben. <br><br>  Sie können einen coolen Effekt erzielen, z. B. das schrittweise Streamen von Bildern.  Sie können ein verschwommenes Bild anzeigen, das detaillierter wird, wenn immer mehr Koeffizienten heruntergeladen werden. <br><br>  Hier, nur zum Spaß, was passiert, wenn nur 24.000 Zahlen verwendet werden: <br><br><img src="https://habrastorage.org/webt/vn/sf/xr/vnsfxrqyogsnc4qx9pzsok--rno.png"><br><br>  Oder nur 5000: <br><br><img src="https://habrastorage.org/webt/oi/y3/u6/oiy3u6saz6kliguv_pm8iucdbqa.png"><br><br>  Sehr verschwommen, aber als ob erkennbar! <br><br><h2>  3. Codierung von Serienlängen, Delta und Huffman </h2><br>  Bisher sind alle Komprimierungsstufen mit Verlusten verbunden.  Die letzte Etappe verläuft dagegen verlustfrei.  Es löscht keine Informationen, reduziert jedoch die Dateigröße erheblich. <br><br>  Wie können Sie etwas komprimieren, ohne Informationen zu verwerfen?  Stellen Sie sich vor, wie wir ein einfaches schwarzes Rechteck 700 x 437 beschreiben würden. <br><br>  JPEG verwendet hierfür 5000 Zahlen, aber es kann ein viel besseres Ergebnis erzielt werden.  Können Sie sich ein Codierungsschema vorstellen, das ein solches Bild mit möglichst wenigen Bytes beschreibt? <br><br>  Das minimale Schema, das ich mir ausdenken könnte, verwendet vier: drei, um die Farbe anzuzeigen, und das vierte - wie viele Pixel haben diese Farbe.  Die Idee, wiederholte Werte auf solch komprimierte Weise darzustellen, wird als Serienlängencodierung bezeichnet.  Es gibt keine Verluste, da wir die verschlüsselten Daten in ihrer ursprünglichen Form wiederherstellen können. <br><br>  Die Größe einer JPEG-Datei mit einem schwarzen Rechteck ist viel größer als 4 Byte. Denken Sie daran, dass auf DCT-Ebene die Komprimierung auf Blöcke mit 8 x 8 Pixel angewendet wird.  Daher benötigen wir mindestens einen DCT-Koeffizienten pro 64 Pixel.  Wir brauchen einen, weil wir anstelle eines einzelnen DCT-Koeffizienten gefolgt von 63 Nullen durch Codieren der Längen der Reihe eine Zahl speichern und angeben können, dass „alle anderen Nullen sind“. <br><br>  Die Delta-Codierung ist eine Technik, bei der jedes Byte eine Differenz zu einem bestimmten Wert und nicht zu einem absoluten Wert enthält.  Daher ändert das Bearbeiten bestimmter Bytes die Farbe aller anderen Pixel.  Zum Beispiel anstatt zu speichern <br><br>  12 13 14 14 14 13 13 14 <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir könnten mit 12 beginnen und dann einfach angeben, wie viel wir addieren oder subtrahieren müssen, um die nächste Zahl zu erhalten. Und diese Sequenz in der Delta-Codierung hat die Form: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12 1 1 0 0 -1 0 1 Die </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konvertierten Daten werden nicht weniger als das Original erhalten, aber es ist bereits einfacher, sie zu komprimieren. Die Verwendung der Delta-Codierung vor der Codierung von Serienlängen kann sehr hilfreich sein, während die verlustfreie Komprimierung erhalten bleibt.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Delta-Codierung ist eine der wenigen Techniken, die außerhalb von 8x8-Blöcken verwendet werden. Von den 64 DCT-Koeffizienten ist einer einfach eine Konstantwellenfunktion (Volltonfarbe). Es repräsentiert die durchschnittliche Helligkeit jedes Blocks für die Luminanzkomponenten oder die durchschnittliche Blauheit für die Cb-Komponenten und so weiter. Der erste Wert jedes DCT-Blocks wird als DC-Wert bezeichnet, und jeder DC-Wert wird in Bezug auf die vorherigen Delta-Codierungen unterzogen. Daher wirkt sich eine Änderung der Helligkeit des ersten Blocks auf alle Blöcke aus. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das letzte Rätsel bleibt: Wie verdirbt die singuläre Veränderung das ganze Bild? Bisher hatten Komprimierungsstufen keine solchen Eigenschaften. Die Antwort liegt im JPEG-Header. Die ersten 500 Bytes enthalten Metadaten zu Bild - Breite, Höhe usw., mit denen wir bisher nicht gearbeitet haben.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ohne Header ist es fast unmöglich (gut oder sehr schwierig), JPEG zu dekodieren. Es wird so aussehen, als würde ich versuchen, Ihnen das Bild zu beschreiben und Worte zu erfinden, um meinen Eindruck zu vermitteln. Die Beschreibung wird wahrscheinlich sehr prägnant sein, da ich Wörter mit genau der Bedeutung erfinden kann, die ich vermitteln möchte, aber für alle anderen werden sie keinen Sinn ergeben. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es klingt dumm, aber genau das passiert. Jedes JPEG-Bild wird mit spezifischen Codes komprimiert. Ein Header von Codes wird in der Kopfzeile gespeichert. Diese Technik wird als Huffman-Code bezeichnet, und das Wörterbuch wird als Huffman-Tabelle bezeichnet. In der Kopfzeile wird die Tabelle mit zwei Bytes markiert - 255 und dann 196. Jede Farbkomponente kann eine eigene Tabelle haben.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Änderungen an den Tabellen wirken sich radikal auf jedes Bild aus. Ein gutes Beispiel ist das Ändern von 1 zu 12 in der 15. Zeile. </font></font><br><br><img src="https://habrastorage.org/webt/mz/-c/xd/mz-cxdyzf2haxuj1_tojoatbl7s.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies liegt daran, dass die Tabellen angeben, wie einzelne Bits gelesen werden sollen. Bisher haben wir nur mit Binärzahlen in Dezimalform gearbeitet. Dies verbirgt uns jedoch die Tatsache, dass, wenn Sie die Nummer 1 in einem Byte speichern möchten, diese wie 00000001 aussieht, da jedes Byte genau acht Bits haben sollte, selbst wenn nur eines von ihnen benötigt wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist möglicherweise eine große Platzverschwendung, wenn Sie viele kleine Zahlen haben. Der Huffman-Code ist eine Technik, mit der wir diese Anforderung lockern können, nach der jede Zahl acht Bits belegen sollte. Dies bedeutet, wenn Sie zwei Bytes sehen: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">234 115</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das können je nach Huffman-Tabelle drei Zahlen sein. Um sie zu extrahieren, müssen Sie sie zuerst in separate Bits </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aufteilen </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">11101010 01110011 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dann wenden wir uns der Tabelle zu, um zu verstehen, wie sie gruppiert werden. Zum Beispiel können es die ersten sechs Bits (111010) oder 58 im Dezimalsystem sein, gefolgt von fünf Bits (10011) oder 19 und schließlich den letzten vier Bits (0011) oder 3. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daher ist es sehr schwierig, Bytes zu verstehen in diesem Stadium der Kompression. Bytes repräsentieren nicht das, was es scheint. Ich werde in diesem Artikel nicht auf die Details der Arbeit mit der Tabelle eingehen, aber </font><font style="vertical-align: inherit;">es gibt </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">genügend </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Materialien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu diesem Thema im Netzwerk </font><font style="vertical-align: inherit;">.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einer der interessanten Tricks, die Sie ausführen können, wenn Sie dies wissen, besteht darin, den Header vom JPEG zu trennen und separat zu speichern. </font><font style="vertical-align: inherit;">Tatsächlich stellt sich heraus, dass nur Sie die Datei lesen können. </font><font style="vertical-align: inherit;">Facebook tut dies, um die Dateigröße weiter zu reduzieren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können die Huffman-Tabelle auch noch ein wenig ändern. </font><font style="vertical-align: inherit;">Für andere sieht es aus wie ein beschädigtes Bild. </font><font style="vertical-align: inherit;">Und nur Sie kennen die magische Version der Korrektur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassend: Was wird also für die JPEG-Dekodierung benötigt?</font></font> Es ist notwendig: <br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Extrahieren Sie die Huffman-Tabelle (n) aus dem Header und decodieren Sie die Bits. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Extrahieren Sie diskrete Cosinustransformationskoeffizienten für jede Farb- und Helligkeitskomponente für jeden 8x8-Block, indem Sie inverse Transformationen der Codierung von Serienlängen und Deltas durchführen. </font></font></li><li>     ,        88. </li><li>   ,    (    ). </li><li>    YCbCr     RGB. </li><li>    ! </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ernsthafte Arbeit zum einfachen Betrachten von Bildern mit einer Katze! </font><font style="vertical-align: inherit;">Was mir jedoch gefällt, ist, dass Sie sehen können, wie menschlich die JPEG-Technologie ist. </font><font style="vertical-align: inherit;">Es basiert auf den Merkmalen unserer Wahrnehmung, die es uns ermöglichen, eine viel bessere Komprimierung als bei herkömmlichen Technologien zu erzielen. </font><font style="vertical-align: inherit;">Wenn Sie nun verstehen, wie JPEG funktioniert, können Sie sich vorstellen, wie diese Technologien auf andere Bereiche übertragen werden können. </font><font style="vertical-align: inherit;">Beispielsweise kann die Delta-Codierung in einem Video die Dateigröße erheblich reduzieren, da es häufig ganze Bereiche gibt, die sich nicht von Bild zu Bild ändern (z. B. Hintergrund). </font></font><br><br> <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der im Artikel verwendete Code</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist offen und enthält Anweisungen zum Ersetzen von Bildern durch Ihre eigenen.</font></font></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de454944/">https://habr.com/ru/post/de454944/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de454928/index.html">Möglichkeit, den Windows-Sperrbildschirm in RDP-Sitzungen zu umgehen</a></li>
<li><a href="../de454932/index.html">Investitionen und Software: 5 Handelsterminals für den Handel an der Börse</a></li>
<li><a href="../de454936/index.html">Vivaldi: Das Blockieren von Anzeigen sollte die Wahl des Nutzers sein</a></li>
<li><a href="../de454938/index.html">Entwicklung eines eigenen Kerns zur Einbettung in ein auf FPGA basierendes Prozessorsystem</a></li>
<li><a href="../de454940/index.html">Reisekrankenversicherung: detaillierte Anweisungen</a></li>
<li><a href="../de454946/index.html">Globale Staaten: warum und wie man sie vermeidet</a></li>
<li><a href="../de454958/index.html">Ein Einblick: Graduiertenschule an der EPFL. Teil 4.1: Alltag</a></li>
<li><a href="../de454960/index.html">Microbiota. Wie Medikamente Darmbakterien beeinflussen</a></li>
<li><a href="../de454962/index.html">Wie schützen sich IT-Unternehmen weltweit vor Wettbewerbern gegenüber ehemaligen Mitarbeitern?</a></li>
<li><a href="../de454966/index.html">Erstellen Sie Sofortspiele auf Unity in Google Play Instant</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>