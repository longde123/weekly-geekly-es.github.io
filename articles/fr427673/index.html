<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÜüèø ü§Ωüèø üíÜüèæ Apprentissage automatique @ booking.com üßëüèº üçô ‚ô®Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'apprentissage automatique vous permet de rendre le service beaucoup plus pratique pour les utilisateurs. Ce n'est pas si difficile de commencer √† me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprentissage automatique @ booking.com</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/427673/"> L'apprentissage automatique vous permet de rendre le service beaucoup plus pratique pour les utilisateurs.  Ce n'est pas si difficile de commencer √† mettre en ≈ìuvre des recommandations, les premiers r√©sultats peuvent √™tre obtenus m√™me sans avoir une infrastructure √©tablie, l'essentiel est de commencer.  Et seulement alors pour construire un syst√®me √† grande √©chelle.  C'est ainsi que tout a commenc√© sur Booking.com.  Et ce qu'il en est r√©sult√©, quelles approches sont maintenant utilis√©es, comment les mod√®les sont introduits dans la production, lesquels surveiller, Viktor Bilyk a d√©clar√© √† HighLoad ++ Siberia.  Les erreurs et probl√®mes possibles n'ont pas √©t√© laiss√©s derri√®re le rapport, cela aidera quelqu'un √† contourner les hauts-fonds et quelqu'un proposera de nouvelles id√©es. <br><br><img src="https://habrastorage.org/webt/xi/se/oi/xiseoiionccibwqnt5plovk4qza.jpeg"><br><br>  <strong>√Ä propos de l'orateur:</strong> Victor Bilyk introduit des produits d'apprentissage automatique dans les op√©rations commerciales de Booking.com. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8IskcexLLpI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Tout d'abord, voyons o√π Booking.com utilise l'apprentissage automatique dans quels produits. <br><img src="https://habrastorage.org/webt/ka/6t/3y/ka6t3y4chljglcr3ijjzszcxhgm.jpeg"><br><br>  Premi√®rement, il s'agit d'un grand nombre de syst√®mes de recommandation pour les h√¥tels, les destinations, les dates et √† diff√©rents points de l'entonnoir de vente et dans diff√©rents contextes.  Par exemple, nous essayons de deviner o√π vous irez lorsque vous n'avez rien saisi dans la ligne de recherche. <br><br><img src="https://habrastorage.org/webt/lo/em/bh/loembheuhe8qp-vhv_jntors2je.jpeg"><br><br>  Ceci est une capture d'√©cran dans mon compte, et je visiterai certainement deux de ces domaines cette ann√©e. <br><br><img src="https://habrastorage.org/webt/ab/zc/go/abzcgoqypaywtxwzygsoxo4njrc.jpeg"><br><br>  Nous traitons presque tous les messages texte des clients, des filtres anti-spam banaux aux produits sophistiqu√©s comme Assistant et ChatToBook, qui utilisent des mod√®les pour d√©terminer les intentions et reconna√Ætre les entit√©s.  En outre, il existe des mod√®les qui ne sont pas si visibles, par exemple, la d√©tection de fraude. <br><br>  Nous analysons les avis.  Les mannequins nous disent pourquoi les gens vont, disons, √† Berlin. <br><img src="https://habrastorage.org/webt/xn/sv/9e/xnsv9escc-iqeayrkec7ekop_n4.jpeg"><br><br>  √Ä l'aide de mod√®les d'apprentissage automatique, il est analys√© pourquoi l'h√¥tel est lou√© afin que vous n'ayez pas √† lire vous-m√™me des milliers d'avis. <br><img src="https://habrastorage.org/webt/u6/qi/4y/u6qi4yc7gz7vgiqk0ekkxa72a_i.jpeg"><br><br>  √Ä certains endroits de notre interface, presque chaque pi√®ce est li√©e aux pr√©dictions de certains mod√®les.  Par exemple, nous essayons ici de pr√©dire quand l'h√¥tel sera complet. <br><img src="https://habrastorage.org/webt/7f/yy/kv/7fyykvfv6k6h7unwgh2unlvgzdq.jpeg"><br><br>  Nous nous retrouvons souvent bien - apr√®s 19 heures, la derni√®re chambre est d√©j√† r√©serv√©e. <br><img src="https://habrastorage.org/webt/41/wy/bp/41wybpl2pkhjpcidi6yv-geyvpy.jpeg"><br><br>  Ou, par exemple, - le badge "Offre favorable".  Ici, nous essayons de formaliser le subjectif: qu'est-ce qu'une offre si avantageuse.  Comment comprendre que les prix fix√©s par l'h√¥tel pour ces dates sont bons?  Apr√®s tout, cela, en plus du prix, d√©pend de nombreux facteurs, tels que des services suppl√©mentaires, et souvent m√™me de raisons externes, si, par exemple, la Coupe du monde ou une grande conf√©rence technique se tient dans cette ville maintenant. <br><br><h2>  D√©but de la mise en ≈ìuvre <br></h2><br>  Revenons en arri√®re il y a quelques ann√©es, en 2015.  Certains des produits dont j'ai parl√© existent d√©j√†.  De plus, le syst√®me dont je vais parler aujourd'hui ne l'est pas encore.  Comment s'est d√©roul√©e la mise en ≈ìuvre √† ce moment-l√†?  Franchement, les choses n'√©taient pas tr√®s.  Le fait est que nous avons eu un √©norme probl√®me, dont une partie technique et une partie organisationnelle. <br><img src="https://habrastorage.org/webt/05/om/8s/05om8smme1rfenwrzl_ue7rwwh4.jpeg"><br><br>  Nous avons envoy√© des scientifiques des donn√©es √† des √©quipes interfonctionnelles existantes qui travaillent sur un probl√®me d'utilisateur sp√©cifique et nous nous attendions √† ce qu'elles am√©liorent le produit d'une mani√®re ou d'une autre. <br><br>  Le plus souvent, ces pi√®ces du produit ont √©t√© construites sur la pile Perl.  Il y a un probl√®me √©vident avec Perl - il n'est pas con√ßu pour un calcul intensif, et notre backend est d√©j√† charg√© avec d'autres choses.  De plus, le d√©veloppement de syst√®mes s√©rieux qui r√©soudraient ce probl√®me n'a pas pu √™tre prioris√© au sein de l'√©quipe, car l'√©quipe se concentre sur la r√©solution d'un probl√®me utilisateur et non sur la r√©solution d'un probl√®me utilisateur √† l'aide du machine learning.  Par cons√©quent, le Product Owner (PO) serait tr√®s oppos√© √† cela. <br><br>  Voyons comment cela s'est produit alors. <br><br>  Il n'y avait que deux options - je le sais √† coup s√ªr, car √† l'√©poque je travaillais dans une telle √©quipe et aidais les Data Scientists √† amener leurs premiers mod√®les au combat. <br><br>  La premi√®re option a √©t√© la <strong>mat√©rialisation des pr√©dictions</strong> .  Supposons qu'il existe un mod√®le tr√®s simple avec seulement deux fonctionnalit√©s: <br><br><ol><li>  pays o√π se trouve le visiteur; </li><li>  la ville dans laquelle il recherche un h√¥tel. </li></ol><br>  Nous devons pr√©dire la probabilit√© d'un √©v√©nement.  Nous venons de faire exploser tous les vecteurs d'entr√©e: disons, 100 000 villes, 200 pays - un total de 20 millions de lignes dans MySQL.  Cela ressemble √† une option enti√®rement fonctionnelle pour la sortie de certains petits syst√®mes de classement ou d'autres mod√®les simples √† la production. <br><img src="https://habrastorage.org/webt/vh/jq/y0/vhjqy0gxsyydgrnirucbg4kpiva.jpeg"><br><br>  Une autre option consiste √† <strong>int√©grer les pr√©dictions directement dans le code principal</strong> .  Il y a de grandes limites - des centaines, voire des milliers de coefficients - c'est tout ce que nous pouvions nous permettre. <br><img src="https://habrastorage.org/webt/oa/sm/qn/oasmqn17bfvbsfjxla2qcidhgds.jpeg"><br><br>  √âvidemment, ni l'un ni l'autre ne vous permet de mettre en √©vidence au moins une sorte de mod√®le complexe en production.  Cela a limit√© le centre de donn√©es et les succ√®s qu'ils ont pu obtenir en am√©liorant les produits.  De toute √©vidence, ce probl√®me devait √™tre r√©solu d'une mani√®re ou d'une autre. <br><br><h3>  Service de pr√©diction <br></h3><br>  La premi√®re chose que nous avons faite a √©t√© un service de pr√©diction.  Probablement, l'architecture la plus simple jamais montr√©e sur Habr√© et HighLoad ++ est inf√©rieure. <br><img src="https://habrastorage.org/webt/my/xw/jx/myxwjxsaotaglrxaq7obr2klmtc.jpeg"><br><br>  Nous avons √©crit une petite application dans Scala + Akka + Spray qui a simplement pris les vecteurs entrants et renvoy√© la pr√©diction.  En fait, je suis un peu rus√© - le syst√®me √©tait un peu plus compliqu√©, car nous devions en quelque sorte le surveiller et le d√©ployer.  En r√©alit√©, tout ressemblait √† ceci: <br><img src="https://habrastorage.org/webt/jc/mi/o9/jcmio9itnh23j0xsjwm0--_mmkc.jpeg"><br><br>  Booking.com a un syst√®me d'√©v√©nements - quelque chose comme un magazine pour tous les syst√®mes.  Il est tr√®s facile d'y √©crire et ce flux est tr√®s simple √† rediriger.  Au d√©but, nous devions envoyer des donn√©es de t√©l√©m√©trie client √† Graphite et Grafana avec des latences per√ßues et des informations d√©taill√©es du c√¥t√© serveur. <br><img src="https://habrastorage.org/webt/r1/9x/kf/r19xkf9zdmzalcslvhxamaxj9qk.jpeg"><br><br>  Nous avons cr√©√© des biblioth√®ques clientes simples pour Perl - avons cach√© tout le RPC dans un appel local, y avons plac√© plusieurs mod√®les et le service a commenc√© √† d√©coller.  Vendre un tel produit √©tait assez simple, car nous avons eu l'occasion <strong>d'introduire des mod√®les plus complexes et de passer beaucoup moins de temps</strong> . <br><img src="https://habrastorage.org/webt/g9/b-/xd/g9b-xdm7jzfyeysocelckin2rdc.jpeg"><br><br>  Les scientifiques des donn√©es ont commenc√© √† travailler avec beaucoup moins de restrictions et, dans certains cas, le travail des backders a √©t√© r√©duit √† une seule ligne. <br><br><h3>  Pr√©dictions des produits <br></h3><br>  Mais revenons bri√®vement √† la fa√ßon dont nous avons utilis√© ces pr√©dictions dans le produit. <br><br>  Il existe un mod√®le qui fait des pr√©dictions bas√©es sur des faits connus.  Sur la base de cette pr√©diction, nous modifions en quelque sorte l'interface utilisateur.  Bien s√ªr, ce n'est pas le seul sc√©nario d'utilisation de l'apprentissage automatique dans notre entreprise, mais assez courant. <br><br>  <strong>Quel est le probl√®me du lancement de telles fonctionnalit√©s?</strong>  Le fait est que ce sont deux choses dans une bouteille: un mod√®le et un changement dans l'interface utilisateur.  Il est tr√®s difficile de s√©parer les effets des deux. <br><br>  Imaginez le lancement de l'insigne ¬´Offre favorable¬ª dans le cadre d'une exp√©rience AB.  S'il ne d√©colle pas - il n'y a pas de changement statistiquement significatif dans les m√©triques cibles - on ne sait pas quel est le probl√®me: un badge incompr√©hensible, petit et discret ou un mauvais mod√®le. <br><br>  De plus, les mod√®les peuvent se d√©grader, et il peut y avoir plusieurs raisons √† cela.  Ce qui a fonctionn√© hier ne fonctionne pas n√©cessairement aujourd'hui.  De plus, nous sommes constamment en mode d√©marrage √† froid, connectant constamment de nouvelles villes et h√¥tels, des gens de nouvelles villes viennent √† nous.  Nous devons en quelque sorte comprendre que le mod√®le se g√©n√©ralise toujours bien dans ces parties de l'espace entrant. <br><img src="https://habrastorage.org/webt/np/rc/91/nprc91mvpwisjodjjq2ri2eueps.jpeg"><br><br>  Le cas le plus probablement le plus r√©cemment connu de d√©gradation du mod√®le a √©t√© l'histoire d'Alex.  Tr√®s probablement, √† la suite d'un recyclage, elle a commenc√© √† comprendre des bruits al√©atoires, comme une demande de rire, et a commenc√© √† rire la nuit, effrayant les propri√©taires. <br><br><h3>  Surveillance des pr√©visions <br></h3><br>  Afin de suivre les pr√©dictions, nous avons l√©g√®rement modifi√© notre syst√®me (sch√©ma ci-dessous).  De la m√™me mani√®re, √† partir du syst√®me d'√©v√©nements, nous avons redirig√© le flux vers Hadoop et commenc√© √† enregistrer, en plus de tout ce que nous avons enregistr√© auparavant, tous les vecteurs d'entr√©e et toutes les pr√©dictions faites par notre syst√®me.  Ensuite, en utilisant Oozie, nous les avons agr√©g√©s dans MySQL et √† partir de l√†, nous les avons montr√©s avec une petite application Web √† ceux qui sont int√©ress√©s par une sorte de caract√©ristiques qualitatives des mod√®les. <br><img src="https://habrastorage.org/webt/nw/jj/3i/nwjj3iu-btqmjbx1ajvbsgik2hg.jpeg"><br><br>  Cependant, il est important de savoir quoi montrer l√†-bas.  Le fait est que dans notre cas, il est tr√®s difficile de calculer les m√©triques habituelles utilis√©es dans la formation des mod√®les, car souvent nous avons un √©norme retard dans les √©tiquettes. <br><br>  Consid√©rez ceci comme un exemple.  Nous voulons pr√©dire si l'utilisateur part en vacances seul ou en famille.  Nous avons besoin de cette pr√©diction lorsqu'une personne choisit un h√¥tel, mais nous ne pouvons d√©couvrir la v√©rit√© qu'en un an.  A peine parti en vacances, l'internaute recevra une invitation √† laisser un avis, o√π il y aura entre autres une question de savoir s'il √©tait seul ou avec sa famille. <br><br>  Autrement dit, vous devez stocker quelque part toutes les pr√©visions faites au cours de l'ann√©e, et m√™me pour pouvoir trouver rapidement des correspondances avec les √©tiquettes entrantes.  Cela ressemblait √† un investissement tr√®s s√©rieux, peut-√™tre m√™me lourd.  Par cons√©quent, jusqu'√† ce que nous r√©solvions ce probl√®me, nous avons d√©cid√© de faire quelque chose de plus simple. <br><br>  Ce ¬´plus simple¬ª s'est av√©r√© n'√™tre qu'un <strong>histogramme des pr√©dictions</strong> faites par le mod√®le. <br><img src="https://habrastorage.org/webt/k4/gu/gm/k4gugmskee9ve0ewmw2qldlcopg.jpeg"><br><br>  Ci-dessus sur le graphique est une r√©gression logistique qui pr√©dit si l'utilisateur changera la date de son voyage ou non.  On peut voir qu'elle divise bien les utilisateurs en deux classes: √† gauche, la colline est celle qui ne le fera pas;  la colline √† droite est celle qui le fait. <br><img src="https://habrastorage.org/webt/fy/ac/dk/fyacdkdo2pmlpmbmnmelkm3zx8w.jpeg"><br><br>  En fait, nous montrons m√™me deux graphiques: un pour la p√©riode actuelle et l'autre pour le pr√©c√©dent.  On voit clairement que cette semaine (il s'agit d'un graphique hebdomadaire) le mod√®le pr√©dit un changement de dates un peu plus souvent.  Il est difficile de dire avec certitude s'il s'agit de la saisonnalit√© ou de la m√™me d√©gradation au fil du temps. <br><br>  Cela a entra√Æn√© un changement dans le travail des datacientes, qui ont cess√© d'engager d'autres personnes et ont commenc√© √† it√©rer leurs mod√®les plus rapidement.  Ils ont envoy√© des mod√®les en production avec des ing√©nieurs back-end.  Autrement dit, les vecteurs ont √©t√© collect√©s, le mod√®le a fait une pr√©diction, mais ces pr√©dictions n'ont √©t√© utilis√©es d'aucune fa√ßon. <br><br>  Dans le cas d'un badge, nous n'avons simplement rien montr√©, comme auparavant, mais collect√© des statistiques.  Cela nous a permis de ne pas perdre de temps √† l'avance sur des projets rat√©s.  Nous avons lib√©r√© du temps pour le front-end et les concepteurs pour d'autres exp√©riences.  <strong>Tant que le centre de donn√©es n'est pas s√ªr que le mod√®le fonctionne comme il le souhaite, il n'implique tout simplement pas les autres dans ce processus.</strong> <br><br>  Il est int√©ressant de voir comment les graphiques changent dans diff√©rentes sections. <br><img src="https://habrastorage.org/webt/kb/z_/oy/kbz_oyrod8128_uwtafqsjoym_m.jpeg"><br><br>  √Ä gauche, la probabilit√© de changer les dates sur le bureau, √† droite sur les tablettes.  On voit clairement que sur les tablettes, le mod√®le pr√©dit un changement de dates plus probable.  Cela est probablement d√ª au fait que la tablette est souvent utilis√©e pour la planification des voyages et moins souvent pour les r√©servations. <br><br>  Il est √©galement int√©ressant de voir comment ces graphiques changent √† mesure que les utilisateurs se d√©placent dans l'entonnoir de vente. <br><img src="https://habrastorage.org/webt/oi/ck/zi/oickzi_2tyz5vm8qyf4uk3g-dlw.jpeg"><br><br>  A gauche, la probabilit√© de changer les dates sur la page de recherche, √† droite sur la premi√®re page de r√©servation.  On peut voir qu'un nombre beaucoup plus important de personnes qui ont d√©j√† d√©cid√© de leurs dates acc√®dent √† la page de r√©servation. <br><br>  Mais ce sont de bons graphismes.  √Ä quoi ressemblent les mauvais?  De mani√®res tr√®s diff√©rentes.  Parfois, c'est juste du bruit, parfois c'est une √©norme colline, ce qui signifie que le mod√®le ne peut pas s√©parer efficacement deux classes de pr√©dictions. <br><img src="https://habrastorage.org/webt/uv/c4/zo/uvc4zocpgcdejqtebbpzzvgibws.jpeg"><br><br>  Ce sont parfois d'√©normes pics. <br><img src="https://habrastorage.org/webt/gv/l1/y3/gvl1y36_ui-ut8wbo9ncdhciksg.jpeg"><br><br>  C'est aussi une r√©gression logistique, et jusqu'√† un certain point, il a montr√© une belle image avec deux collines, mais un matin, c'est devenu comme √ßa. <br><br>  Afin de comprendre ce qui s'est pass√© √† l'int√©rieur, vous devez comprendre comment la r√©gression logistique est calcul√©e. <br><br><h4>  R√©f√©rence rapide <br></h4><br><img src="https://habrastorage.org/webt/-f/op/w2/-fopw2q3tayu8rhnyg_pp5z4yms.jpeg"><br><br>  Il s'agit d'une fonction logistique du produit scalaire, o√π x <sub>n</sub> sont quelques caract√©ristiques.  L'une de ces caract√©ristiques √©tait le prix d'une nuit d'h√¥tel (en euros). <br><img src="https://habrastorage.org/webt/sb/mw/6o/sbmw6ocz3ts8f-fdjawob2ve3zk.jpeg"><br><br>  Appeler ce mod√®le serait quelque chose comme ceci: <br><img src="https://habrastorage.org/webt/cf/so/m1/cfsom1foagpoo152nli4z31aqmo.jpeg"><br><br>  Faites attention √† la s√©lection.  Il fallait convertir le prix en euros, mais le d√©veloppeur a oubli√© de le faire. <br><img src="https://habrastorage.org/webt/sz/5x/my/sz5xmybzwpcutqsc1xrj9vczaei.jpeg"><br><br>  Des devises comme les roupies ou les roubles ont augment√© le produit scalaire √† plusieurs reprises et ont donc forc√© ce mod√®le √† produire une valeur proche de l'unit√©, beaucoup plus souvent, que nous voyons sur le graphique. <br><br><h4>  Valeurs de seuil <br></h4><br>  Une autre caract√©ristique utile de ces histogrammes √©tait la possibilit√© d'un choix conscient et optimal des valeurs de seuil. <br><img src="https://habrastorage.org/webt/0p/j-/lj/0pj-ljv2emwsf_7wu8bttcdb-e8.jpeg"><br><br>  Si vous placez la balle sur la colline la plus haute de cet histogramme, poussez-la et imaginez o√π elle s'arr√™tera, ce sera le point optimal pour la s√©paration des classes.  Tout √† droite est une classe, tout √† gauche en est une autre. <br><br>  Cependant, si vous commencez √† d√©placer ce point, vous pouvez obtenir des effets tr√®s int√©ressants.  Supposons que nous voulons ex√©cuter une exp√©rience qui, si le mod√®le dit oui, modifie en quelque sorte l'interface utilisateur.  Si vous d√©placez ce point vers la droite, l'audience de notre exp√©rience est r√©duite.  Apr√®s tout, le nombre de personnes qui ont re√ßu cette pr√©diction est la zone sous la courbe.  Cependant, dans la pratique, la pr√©cision des pr√©visions est beaucoup plus √©lev√©e.  De m√™me, s'il n'y a pas assez de puissance statique, vous pouvez augmenter l'audience de votre exp√©rience, mais r√©duire la pr√©cision des pr√©dictions. <br><br>  En plus des pr√©dictions elles-m√™mes, nous avons commenc√© √† surveiller les valeurs d'entr√©e dans les vecteurs. <br><br><h4>  Un encodage √† chaud <br></h4><br>  La plupart des fonctionnalit√©s de nos mod√®les les plus simples sont cat√©goriques.  Cela signifie qu'il ne s'agit pas de chiffres, mais de certaines cat√©gories: la ville d'o√π vient l'utilisateur ou la ville dans laquelle il recherche un h√¥tel.  Nous utilisons un codage √† chaud et transformons chacune des valeurs possibles en une unit√© dans un vecteur binaire.  Comme au d√©but, nous utilisions uniquement notre propre noyau informatique, il √©tait facile d'identifier les situations o√π il n'y a pas de place pour la cat√©gorie entrante dans le vecteur entrant, c'est-√†-dire que le mod√®le n'a pas vu ces donn√©es pendant la formation. <br><img src="https://habrastorage.org/webt/xf/9t/w4/xf9tw4lzt0qbikwpfzeenzjjpie.jpeg"><br><br>  Voici √† quoi cela ressemble habituellement. <br><img src="https://habrastorage.org/webt/hb/ih/0n/hbih0nrx9t3xlnl2coxoot3ek7a.jpeg"><br><br>  destination_id - la ville dans laquelle l'utilisateur recherche un h√¥tel.  Naturellement, le mod√®le n'a pas vu environ 5% des valeurs, car nous connectons constamment de nouvelles villes.  visitor_cty_id = 23,32%, car les datacientists omettent parfois consciemment des villes moins communes. <br><br>  Dans un mauvais cas, cela pourrait ressembler √† ceci: <br><img src="https://habrastorage.org/webt/mq/14/ak/mq14akuux2wuwsqqyif_02e8j-e.jpeg"><br><br>  Imm√©diatement 3 propri√©t√©s, 100% des valeurs dont le mod√®le n'a jamais vu.  Le plus souvent, cela se produit en raison de l'utilisation de formats autres que ceux utilis√©s dans la formation, ou simplement de fautes de frappe banales. <br><br>  Maintenant, √† l'aide de tableaux de bord, nous d√©tectons et corrigeons ces situations tr√®s rapidement. <br><br><h2>  Vitrine d'apprentissage automatique <br></h2><br>  Parlons d'autres probl√®mes que nous avons r√©solus.  Apr√®s avoir cr√©√© les biblioth√®ques clientes et la surveillance, le service a commenc√© √† prendre de l'ampleur tr√®s rapidement.  Nous avons √©t√© litt√©ralement submerg√©s d'applications de diff√©rentes parties de l'entreprise: ¬´Connectons √©galement ce mod√®le!  Mettons √† jour l'ancien! "  Nous venons de coudre, en fait, tout nouveau d√©veloppement s'est arr√™t√©. <br><br>  Nous sommes sortis de la situation en cr√©ant <strong>un kiosque en libre-service pour les scientifiques des donn√©es</strong> .  Maintenant, vous pouvez simplement acc√©der √† notre portail, le m√™me que nous avons utilis√© au d√©but uniquement pour la surveillance, et litt√©ralement en cliquant sur le bouton charger le mod√®le en production.  Dans quelques minutes, elle travaillera et fera des pr√©dictions. <br><br>  Il y avait encore un probl√®me. <br><img src="https://habrastorage.org/webt/mw/rp/l-/mwrpl-evpqktnfdk9l61shicboc.jpeg"><br><br>  Booking.com compte environ 200 √©quipes informatiques.  Comment faire savoir √† l'√©quipe dans une partie compl√®tement diff√©rente de l'entreprise qu'il existe un mod√®le qui pourrait les aider?  Vous ne savez peut-√™tre tout simplement pas qu'une telle √©quipe existe.  Comment savoir quels mod√®les existent et comment les utiliser?  Traditionnellement, les communications externes de nos √©quipes sont engag√©es en PO (Product Owner).  Cela ne signifie pas que nous n'avons pas d'autres connexions horizontales, mais PO le fait plus que les autres.  Mais il est √©vident qu'√† une telle √©chelle, la communication individuelle ne se modifie pas.  Vous devez y faire quelque chose. <br><br>  <strong>Comment faciliter la communication?</strong> <br><br>  Nous avons soudain r√©alis√© que le portail, que nous avons cr√©√© exclusivement pour la surveillance, commence progressivement √† devenir une vitrine de l'apprentissage automatique au sein de notre entreprise. <br><img src="https://habrastorage.org/webt/p_/r8/ps/p_r8pst3fhoza0zyb-b5lercws8.jpeg"><br><br>  Nous avons permis aux datacientists de d√©crire leurs mod√®les en d√©tail.  Lorsqu'il y avait beaucoup de mod√®les, nous avons ajout√© des √©tiquettes de sujet et de zone pour un regroupement pratique. <br><img src="https://habrastorage.org/webt/54/d5/ft/54d5ftteqrf-siyozzgllalvuly.jpeg"><br><br>  Nous avons li√© notre outil √† ExperimentTool.  Il s'agit d'un produit au sein de notre entreprise qui fournit des exp√©riences A / B et stocke toute l'histoire de l'exp√©rimentation. <br><img src="https://habrastorage.org/webt/kh/bp/e2/khbpe2ifrcjlhkpaf9ihq-_3m0e.jpeg"><br><br>  Maintenant, avec la description du mod√®le, vous pouvez √©galement voir ce que les autres √©quipes ont fait avec ce mod√®le avant et avec succ√®s.  Cela a tout chang√©. <br><br>  S√©rieusement, cela a chang√© le fonctionnement de l'informatique, car m√™me dans les situations o√π il n'y a pas de data scientist dans l'√©quipe, vous pouvez utiliser le machine learning. <br><img src="https://habrastorage.org/webt/kf/4n/pn/kf4npnnbrtj1vh_1080whzeewbk.jpeg"><br><br>  Par exemple, de nombreuses √©quipes l'utilisent lors de sessions de brainstorming.  Lorsqu'ils proposent de nouvelles id√©es de produits, ils s√©lectionnent simplement les mod√®les qui leur conviennent et les utilisent.  Rien de compliqu√© n'est n√©cessaire pour cela. <br><br>  <strong>Qu'est-ce que cela a renvers√© pour nous?</strong>  √Ä l'heure actuelle, au pic, nous fournissons environ 200 000 pr√©dictions par seconde, avec une latence inf√©rieure √† 20-30 ms, y compris l'aller-retour HTTP, et le placement de plus de 200 mod√®les. <br><br>  Il peut sembler que c'√©tait une promenade si facile dans le parc: nous avons fait un travail formidable, tout fonctionne, tout le monde est content! <br><img src="https://habrastorage.org/webt/do/-q/mg/do-qmg7z1boovf5kyag7ngbr2wy.jpeg"><br><br>  Bien s√ªr, cela ne se produit pas.  Il y a eu des erreurs.  Au tout d√©but, par exemple, nous avons pos√© une petite bombe √† retardement.  Pour une raison quelconque, nous avons suppos√© que la plupart de nos mod√®les seront des syst√®mes de recommandation avec des vecteurs d'entr√©e lourds, et la pile Scala + Akka a √©t√© choisie pr√©cis√©ment parce qu'il est tr√®s facile d'organiser des calculs parall√®les avec son aide.  Mais en r√©alit√©, le surco√ªt de toute cette parall√©lisation, pour la collecte ensemble, s'est av√©r√© sup√©rieur au gain possible.  √Ä un moment donn√©, nos 100 machines n'ont trait√© que 100 000 RPS et des pannes se sont produites avec des sympt√¥mes assez caract√©ristiques: l'utilisation du processeur est faible, mais des d√©lais d'attente sont obtenus. <br><img src="https://habrastorage.org/webt/ms/so/zz/mssozzq2glmsbn5o-g5au7dqjaa.jpeg"><br><br>  Ensuite, nous sommes revenus √† notre c≈ìur de calcul, avons revu, fait des benchmarks et, √† la suite des tests de capacit√©, nous avons appris que pour le m√™me trafic, nous n'avons besoin que de 4 machines. ,    ,      -,       , ,   ,      100 000 RPS  4 . <br><br>    -  ,        ,        .  -       ,      ,    ,    . <br><br>   ‚Äî    ,           .  ,    ID ,     .    ,    0. <br><img src="https://habrastorage.org/webt/cq/0b/6w/cq0b6wonigy8ltd8_jwilv7j62k.jpeg"><br><br>   ‚Äî    ,   ‚Äî     . <br><img src="https://habrastorage.org/webt/v-/qb/-u/v-qb-uqcn4kn09heh1z03rycgfm.jpeg"><br><br>   ,        .       ,    .    ,        ‚Äî      ,   .  , ,  ,       - . <br><br>     ,           ‚Äî  ID .        ‚Äî 49-51%.      ,     .     ,     ,    .     ,     . <br><br><h2>  Plans futurs <br></h2><br><ul><li> Label based metrics <br></li></ul><br>     -           ,     .   Label based metrics,   precision  recall   . <br><br><ul><li> More tools &amp; integrations <br></li></ul><br>        ,     .     ,            Perl  Java,  ,  ,   .       Spark,        . <br><br><ul><li> Reusable training pipelines <br></li></ul><br>          . <br><br> ,   -.  ,       , ,    ,  , <strong>steaming</strong> ‚Äî    -   ,       ,   . <br><br>      .     pipeline,    ,   .       ,    ,    . <br><br><ul><li> Async models <br></li></ul><br>     .    ,  <strong>,   50 ,    </strong> .   ,            .          ,      ,   . <br><br><h3> Start small <br></h3><br><blockquote>  ,   ,         Booking.com,    ,   ,     ‚Äî   ! <br></blockquote><br>        ,  ,    MySQL. ,      ,      .    -    . B      .      ,     ,    -     ‚Äî      . <br><br><blockquote>    ,      ? <br></blockquote><br><h3> Monitor <br></h3><br>     ‚Äî      , -, . <strong> ‚Äî     </strong> .   ‚Äî   ,    .    , ,   ,  .      :  ,  . ,      ,       ,      ‚Äî ! <br><br><h3> Organization footprint <br></h3><br>   ,    .         ,     . ,                . <br><br><h3> (Don't) Follow our steps <br></h3><br>   - , , ,    . , -     ,    .   ,     .   ‚Äî     ,      ,  ?  ,  ,     ,    ? <br><br> <strong>, ,   !</strong> <br><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HighLoad++ 2018,</a>   8  9   ,  <strong>135 </strong> ,      .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> <strong>9  -  </strong> .    ,      . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427673/">https://habr.com/ru/post/fr427673/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427661/index.html">Sportiduino - syst√®me de marquage √©lectronique pour les √©v√©nements sportifs, partie 3</a></li>
<li><a href="../fr427663/index.html">Ours Habro et crabe</a></li>
<li><a href="../fr427665/index.html">Les meilleures balances intelligentes (selon Wareable)</a></li>
<li><a href="../fr427669/index.html">KNX Home Control: √âclairage</a></li>
<li><a href="../fr427671/index.html">Sberbank et Yandex ont officiellement lanc√© la plateforme de trading Beru, la version russe d'Amazon</a></li>
<li><a href="../fr427675/index.html">Papiers, s'il vous pla√Æt. Comment un r√©seau de neurones nous aide √† v√©rifier les clients et √† attraper les escrocs</a></li>
<li><a href="../fr427679/index.html">La r√©duction √† z√©ro de la limite des achats hors taxes prendra un an et demi, si une d√©cision est prise</a></li>
<li><a href="../fr427681/index.html">Faites glisser et faites glisser dans RecyclerView. Partie 1: ItemTouchHelper</a></li>
<li><a href="../fr427683/index.html">Pourquoi le portage sur un d√©bordement d'entier n'est pas une bonne id√©e</a></li>
<li><a href="../fr427685/index.html">FSB contre Internet par satellite d'op√©rateurs √©trangers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>