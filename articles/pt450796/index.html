<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëßüèª üëãüèª üêÜ Como a Tesla ensina o piloto autom√°tico üë©üèº‚Äçü§ù‚Äçüë®üèΩ üìÜ üßòüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Descriptografia da 2¬™ parte do Tesla Autonomy Investor Day. Ciclo de treinamento do piloto autom√°tico, infraestrutura de coleta de dados, identifica√ß√£...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como a Tesla ensina o piloto autom√°tico</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450796/"> <em><img src="https://habrastorage.org/webt/vc/ch/lx/vcchlxqf5blytupr3nsndhmmgay.png"><br><br></em>  <em>Descriptografia da 2¬™ parte do Tesla Autonomy Investor Day.</em>  <em>Ciclo de treinamento do piloto autom√°tico, infraestrutura de coleta de dados, identifica√ß√£o autom√°tica de dados, imita√ß√£o de drivers humanos, detec√ß√£o de dist√¢ncia de v√≠deo, supervis√£o de sensor e muito mais.</em> <br><a name="habracut"></a><br>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A primeira parte √© o desenvolvimento do Full Self-Driving Computer (FSDC)</a> .</em> <br><br>  <strong>Anfitri√£o: O</strong> FSDC pode trabalhar com redes neurais muito complexas para processamento de imagens.  √â hora de falar sobre como obtemos imagens e como as analisamos.  Temos um diretor s√™nior de IA da Tesla, Andrei Karpaty, que explicar√° tudo isso a voc√™. <br><br>  <strong>Andrei:</strong> Treino em redes neurais h√° cerca de dez anos e agora h√° 5-6 anos para uso industrial.  Incluindo institui√ß√µes conhecidas como Stanford, Open AI e Google.  Esse conjunto de redes neurais n√£o √© apenas para processamento de imagens, mas tamb√©m para linguagem natural.  Projetei arquiteturas que combinam essas duas modalidades para minha tese de doutorado. <br><br>  Em Stanford, ministrei um curso sobre redes neurais deconvolucion√°rias.  Eu era o professor principal e desenvolvi todo o curr√≠culo para ele.  No come√ßo, eu tinha cerca de 150 alunos. Nos dois ou tr√™s anos seguintes, o n√∫mero de alunos aumentou para 700. Este √© um curso muito popular, um dos maiores e mais bem-sucedidos cursos de Stanford no momento. <br><br>  <strong>Ilon:</strong> Andrey √© realmente um dos melhores especialistas em vis√£o de m√°quina do mundo.  Talvez o melhor. <br><br>  <strong>Andrew:</strong> Obrigado.  Ol√° pessoal.  Pete falou sobre um chip que desenvolvemos especificamente para redes neurais em um carro.  Minha equipe √© respons√°vel por treinar essas redes neurais.  Isso inclui coleta de dados, treinamento e, em parte, implanta√ß√£o. <br><br>  O que as redes neurais em um carro fazem.  Existem oito c√¢meras no carro que gravam v√≠deo.  As redes neurais assistem a esses v√≠deos, os processam e fazem previs√µes sobre o que veem.  Estamos interessados ‚Äã‚Äãem marca√ß√µes nas estradas, participantes no tr√¢nsito, outros objetos e suas dist√¢ncias, estradas, sem√°foros, sinais de tr√¢nsito etc. <br><br><img src="https://habrastorage.org/webt/lu/-b/-u/lu-b-ufhozioprg2nvebadsk4zs.png"><br><br>  Minha apresenta√ß√£o pode ser dividida em tr√™s partes.  Primeiro, apresentarei brevemente as redes neurais e como elas funcionam e como s√£o treinadas.  Isso deve ser feito para que, na segunda parte, fique claro por que √© t√£o importante que tenhamos uma enorme frota de carros Tesla (frota).  Por que esse √© um fator chave no treinamento de redes neurais que funcionam eficientemente na estrada?  Na terceira parte, falarei sobre vis√£o de m√°quina, lidar e como estimar a dist√¢ncia usando apenas v√≠deo. <br><br><h2>  Como as redes neurais funcionam? </h2><br>  <em>(N√£o h√° muito novo aqui, voc√™ pode pular e ir para o pr√≥ximo t√≠tulo)</em> <br><br>  A principal tarefa que as redes resolvem no carro √© o reconhecimento de padr√µes.  Para n√≥s, humanos, essa √© uma tarefa muito simples.  Voc√™ olha as imagens e v√™ um violoncelo, barco, iguana ou tesoura.  Muito f√°cil e simples para voc√™, mas n√£o para o computador.  O motivo √© que essas imagens de computador s√£o apenas uma matriz de pixels, em que cada pixel √© o valor de brilho nesse ponto.  Em vez de apenas ver a imagem, o computador recebe um milh√£o de n√∫meros em uma matriz. <br><br>  <strong>Ilon:</strong> Matrix, se voc√™ quiser.  Realmente matriz. <br><br><img src="https://habrastorage.org/webt/x7/sy/zq/x7syzqa6mvf_64j6nsk8dovzyww.png"><br><br>  <strong>Andrew:</strong> Sim.  Precisamos passar dessa grade de pixels e valores de brilho para conceitos de n√≠vel superior, como iguana e assim por diante.  Como voc√™ pode imaginar, esta imagem de uma iguana possui um padr√£o de brilho espec√≠fico.  Mas as iguanas podem ser representadas de diferentes maneiras, em diferentes poses, em diferentes condi√ß√µes de ilumina√ß√£o, em um fundo diferente.  Voc√™ pode encontrar muitas imagens diferentes da iguana e devemos reconhec√™-la em qualquer condi√ß√£o. <br><br>  A raz√£o pela qual voc√™ e eu podemos lidar facilmente com isso √© que temos uma enorme rede neural dentro que processa imagens.  A luz entra na retina e √© enviada para a parte posterior do c√©rebro, para o c√≥rtex visual.  O c√≥rtex cerebral consiste em muitos neur√¥nios que est√£o conectados entre si e realizam o reconhecimento de padr√µes. <br><br>  Nos √∫ltimos cinco anos, abordagens modernas para processamento de imagens usando computadores tamb√©m come√ßaram a usar redes neurais, mas, neste caso, redes neurais artificiais.  As redes neurais artificiais s√£o uma aproxima√ß√£o matem√°tica grosseira do c√≥rtex visual.  Tamb√©m h√° neur√¥nios aqui, eles est√£o conectados um ao outro.  Uma rede neural t√≠pica inclui dezenas ou centenas de milh√µes de neur√¥nios, e cada neur√¥nio possui milhares de links. <br><br>  Podemos pegar uma rede neural e mostrar imagens, como a nossa iguana, e a rede far√° uma previs√£o.  Primeiro, as redes neurais s√£o inicializadas completamente por acidente, todos os pesos das conex√µes entre os neur√¥nios s√£o n√∫meros aleat√≥rios.  Portanto, a previs√£o da rede tamb√©m ser√° aleat√≥ria.  Pode acontecer que a rede pense que √© provavelmente um barco.  Durante o treinamento, sabemos e observamos que a iguana est√° na imagem.  Simplesmente dizemos que gostar√≠amos que a probabilidade de uma iguana aumentasse essa imagem e a probabilidade de todo o resto diminuir.  Em seguida, √© utilizado um processo matem√°tico chamado m√©todo de propaga√ß√£o reversa.  Descida de gradiente estoc√°stico, que nos permite propagar o sinal ao longo dos links e atualizar seus pesos.  Atualizaremos um pouco o peso de cada um desses compostos e, assim que a atualiza√ß√£o for conclu√≠da, a probabilidade de uma iguana para esta imagem aumentar√° um pouco e a probabilidade de outras respostas diminuir√°. <br><br>  Obviamente, fazemos isso com mais de uma √∫nica imagem.  Temos um grande conjunto de dados marcados.  Normalmente, s√£o milh√µes de imagens, milhares de tags ou mais.  O processo de aprendizado √© repetido v√°rias vezes.  Voc√™ mostra uma imagem ao computador, ela diz a sua opini√£o, depois diz a resposta correta e a rede est√° ligeiramente configurada.  Voc√™ repete isso milh√µes de vezes, √†s vezes exibindo a mesma imagem centenas de vezes.  O treinamento geralmente leva v√°rias horas ou v√°rios dias. <br><br>  Agora, algo contra-intuitivo sobre o trabalho das redes neurais.  Eles realmente precisam de muitos exemplos.  N√£o se encaixa apenas na sua cabe√ßa, mas eles realmente come√ßam do zero, eles n√£o sabem de nada.  Aqui est√° um exemplo - um cachorro fofo, e voc√™ provavelmente n√£o conhece a ra√ßa dela.  Este √© um spaniel japon√™s.  Estamos olhando para esta foto e vemos um spaniel japon√™s.  Podemos dizer: "OK, eu entendo, agora eu sei como √© o spaniel japon√™s".  Se eu mostrar mais algumas imagens de outros c√£es, voc√™ poder√° encontrar outros spaniels japoneses entre eles.  Voc√™ s√≥ precisa de um exemplo, mas os computadores n√£o podem.  Eles precisam de muitos dados sobre spaniels japoneses, milhares de exemplos, em poses diferentes, diferentes condi√ß√µes de ilumina√ß√£o, em diferentes contextos etc.  Voc√™ precisa mostrar ao computador a apar√™ncia do spaniel japon√™s sob diferentes pontos de vista.  E ele realmente precisa de todos esses dados, caso contr√°rio, o computador n√£o poder√° aprender o modelo desejado. <br><br><h2>  Layout da imagem para o piloto autom√°tico </h2><br>  Ent√£o, como isso tudo se relaciona √† dire√ß√£o aut√¥noma?  N√£o estamos muito preocupados com ra√ßas de c√£es.  Talvez eles se importem no futuro.  Mas agora estamos interessados ‚Äã‚Äãem marca√ß√µes de estradas, objetos na estrada, onde eles est√£o, para onde podemos ir e assim por diante.  Agora, n√£o temos apenas r√≥tulos como iguana, mas temos imagens da estrada e estamos interessados ‚Äã‚Äãem, por exemplo, marca√ß√µes na estrada.  Uma pessoa olha para a imagem e a marca com o mouse. <br><br><img src="https://habrastorage.org/webt/eq/wa/wo/eqwawo_3ky3vffm_hkkheyrhmlq.png"><br><br>  Temos a oportunidade de entrar em contato com carros da Tesla e pedir ainda mais fotos.  Se voc√™ solicitar fotos aleat√≥rias, obter√° imagens em que, via de regra, o carro passa pela estrada.  Este ser√° um conjunto de dados aleat√≥rios e os marcaremos. <br><br>  Se voc√™ marcar apenas conjuntos aleat√≥rios, sua rede aprender√° uma situa√ß√£o de tr√°fego simples e comum e funcionar√° bem apenas nela.  Quando voc√™ mostra a ela um exemplo um pouco diferente, digamos a imagem de uma estrada virando em uma √°rea residencial.  Sua rede pode dar o resultado errado.  Ela dir√° "bem, eu j√° vi muitas vezes, a estrada segue em frente". <br><br><img src="https://habrastorage.org/webt/_9/4u/x2/_94ux28ucicihvbggphmoqc5i0y.png"><br><br>  Claro, isso √© completamente falso.  Mas n√£o podemos culpar a rede neural.  Ela n√£o sabe se a √°rvore √† esquerda, o carro √† direita ou os edif√≠cios ao fundo s√£o importantes.  A rede n√£o sabe nada sobre isso.  Todos sabemos que a linha de marca√ß√£o √© importante e o fato de ela virar um pouco para o lado.  A rede deve levar isso em considera√ß√£o, mas n√£o existe um mecanismo pelo qual possamos simplesmente dizer √† rede neural que esses tra√ßos das marca√ß√µes da estrada realmente s√£o importantes.  A √∫nica ferramenta em nossas m√£os s√£o dados rotulados. <br><br><img src="https://habrastorage.org/webt/e5/ew/d3/e5ewd3fhqw_ebegpk0heamyjafk.png"><br><br>  N√≥s capturamos imagens nas quais a rede est√° errada e as marcamos corretamente.  Nesse caso, marcamos a marca√ß√£o de viragem.  Ent√£o voc√™ precisa transferir muitas imagens semelhantes para a rede neural.  E com o tempo, ela acumular√° conhecimento e aprender√° a entender esse padr√£o, a entender que essa parte da imagem n√£o desempenha um papel, mas essa marca√ß√£o √© muito importante.  A rede aprender√° como encontrar a pista corretamente. <br><br>  N√£o √© apenas importante o tamanho do conjunto de dados de treinamento.  Precisamos de mais do que milh√µes de imagens.  Muito trabalho precisa ser feito para cobrir o espa√ßo de situa√ß√µes que um carro pode encontrar na estrada.  Voc√™ precisa ensinar um computador a trabalhar √† noite e na chuva.  A estrada pode refletir a luz como um espelho, a ilumina√ß√£o pode variar dentro de limites amplos, as imagens ter√£o uma apar√™ncia muito diferente. <br><br><img src="https://habrastorage.org/webt/k4/og/1f/k4og1fzgiwwt6jy_rwcefm3fndm.png"><br><br>  Devemos ensinar ao computador como lidar com sombras, garfos e objetos grandes que ocupam a maior parte da imagem.  Como trabalhar com t√∫neis ou em uma √°rea de reparo de estradas.  E em todos esses casos, n√£o h√° mecanismo direto para dizer √† rede o que fazer.  Temos apenas um grande conjunto de dados.  Podemos capturar imagens, marcar e treinar a rede at√© que ela comece a entender sua estrutura. <br><br>  Conjuntos de dados grandes e diversos ajudam as redes a funcionarem muito bem.  Esta n√£o √© a nossa descoberta.  Experi√™ncias e pesquisas do Google, Facebook, Baidu, Deepmind do alfabeto.  Todos mostram resultados semelhantes - as redes neurais realmente gostam de dados, como quantidade e variedade.  Adicione mais dados e a precis√£o das redes neurais est√° aumentando. <br><br><h2>  Voc√™ ter√° que desenvolver um piloto autom√°tico para simular o comportamento dos carros em uma simula√ß√£o </h2><br>  V√°rios especialistas apontam que poder√≠amos usar a simula√ß√£o para obter os dados necess√°rios na escala correta.  Na Tesla, fizemos repetidamente essa pergunta.  N√≥s temos nosso pr√≥prio simulador.  Utilizamos amplamente a simula√ß√£o para desenvolver e avaliar software.  N√≥s o usamos para treinar com bastante sucesso.  Mas, no final, quando se trata de treinar dados para redes neurais, nada pode substituir os dados reais.  As simula√ß√µes t√™m problemas com a modelagem da apar√™ncia, f√≠sica e comportamento dos participantes. <br><br><img src="https://habrastorage.org/webt/ob/he/xw/obhexwtzhagxn7n_z0ildcfzyl8.png"><br><br>  O mundo real nos lan√ßa um monte de situa√ß√µes inesperadas.  Condi√ß√µes dif√≠ceis com neve, √°rvores, vento.  V√°rios artefatos visuais dif√≠ceis de modelar.  √Åreas de reparo de estradas, arbustos, sacolas pl√°sticas ao vento.  Pode haver muitas pessoas, adultos, crian√ßas e animais misturados.  Modelar o comportamento e a intera√ß√£o de tudo isso √© uma tarefa absolutamente insol√∫vel. <br><br><img src="https://habrastorage.org/webt/2k/3r/7a/2k3r7as1159puh5ad4bf3fwrltc.png"><br><br>  N√£o se trata do movimento de um pedestre.  √â sobre como os pedestres reagem um ao outro, e como os carros reagem um ao outro, como eles reagem a voc√™.  Tudo isso √© muito dif√≠cil de simular.  Voc√™ precisa desenvolver um piloto autom√°tico primeiro, apenas para simular o comportamento dos carros em uma simula√ß√£o. <br><br>  Isso √© realmente dif√≠cil.  Pode ser c√£es, animais ex√≥ticos e, √†s vezes, nem √© algo que voc√™ n√£o pode fingir ser, √© algo que simplesmente nunca passa pela sua cabe√ßa.  Eu n√£o sabia que um caminh√£o pode transportar um caminh√£o que transporta um caminh√£o que transporta outro caminh√£o.  Mas no mundo real, isso e muitas outras coisas est√£o acontecendo e s√£o dif√≠ceis de encontrar.  A variedade que vejo nos dados provenientes dos carros √© insana em rela√ß√£o ao que temos no simulador.  Embora tenhamos um bom simulador. <br><br>  <strong>Ilon:</strong> Simula√ß√£o √© como se voc√™ estivesse inventando sua pr√≥pria li√ß√£o de casa.  Se voc√™ sabe que vai fingir, tudo bem, √© claro que vai lidar com isso.  Mas como Andrei disse, voc√™ n√£o sabe o que n√£o sabe.  O mundo √© muito estranho, tem milh√µes de casos especiais.  Se algu√©m criar uma simula√ß√£o de dire√ß√£o que reproduza fielmente a realidade, isso por si s√≥ ser√° uma conquista monumental para a humanidade.  Mas ningu√©m pode fazer isso.  Simplesmente n√£o h√° como. <br><br><h2>  A frota √© uma fonte de dados essencial para o treinamento </h2><br><img src="https://habrastorage.org/webt/8u/kj/h7/8ukjh7k3qw7-sv469pyhnnbwhi0.png"><br><br>  <strong>Andrei:</strong> Para que as redes neurais funcionem bem, voc√™ precisa de um conjunto de dados grande, diversificado e real.  E se voc√™ tiver uma, poder√° treinar sua rede neural e ela funcionar√° muito bem.  Ent√£o, por que a Tesla √© t√£o especial nesse sentido?  A resposta, √© claro, √© a frota (frota, frota Tesla).  Podemos coletar dados de todos os ve√≠culos da Tesla e us√°-los para treinamento. <br><br>  Vejamos um exemplo espec√≠fico de melhoria da opera√ß√£o de um detector de objetos.  Isso lhe dar√° uma id√©ia de como treinamos redes neurais, como as usamos e como elas melhoram com o tempo. <br><br>  A detec√ß√£o de objetos √© uma das nossas tarefas mais importantes.  Precisamos destacar as dimens√µes dos carros e outros objetos para rastre√°-los e entender como eles podem se mover.  Podemos pedir √†s pessoas para marcar as imagens.  As pessoas dir√£o: "aqui est√£o carros, aqui est√£o bicicletas" e assim por diante.  E podemos treinar a rede neural nesses dados.  Mas, em alguns casos, a rede far√° previs√µes incorretas. <br><br><img src="https://habrastorage.org/webt/7h/st/qk/7hstqk7ygew-tfoo_ibersaw86s.png"><br><br>  Por exemplo, se trope√ßarmos em um carro ao qual uma bicicleta est√° presa na parte de tr√°s, nossa rede neural detectar√° 2 objetos - um carro e uma bicicleta.  Foi assim que ela trabalhou quando cheguei.  E, √† sua maneira, est√° certo, porque esses dois objetos est√£o realmente presentes aqui.  Mas o planejador do piloto autom√°tico n√£o se importa com o fato de que essa bicicleta √© um objeto separado que se move com o carro.  A verdade √© que esta bicicleta est√° rigidamente presa ao carro.  Em termos de objetos na estrada, este √© um objeto - um carro. <br><br><img src="https://habrastorage.org/webt/ms/d0/oi/msd0oiytsgapqj3dczs6s_hpocc.png"><br><br>  Agora gostar√≠amos de marcar muitos objetos semelhantes como "um carro".  Nossa equipe usa a seguinte abordagem.  Tomamos essa imagem ou v√°rias imagens nas quais esse modelo est√° presente.  E temos um mecanismo de aprendizado de m√°quina com o qual podemos solicitar √† frota que nos forne√ßa exemplos com a mesma apar√™ncia.  E a frota envia imagens em resposta. <br><br><img src="https://habrastorage.org/webt/yt/xh/uj/ytxhujmzul8r8dpqwido3fr_rns.png"><br><br>  Aqui est√° um exemplo de seis imagens recebidas.  Todos eles cont√™m bicicletas ligadas a carros.  N√≥s os marcaremos corretamente e nosso detector funcionar√° melhor.  A rede come√ßar√° a entender quando a bicicleta est√° conectada ao carro e se trata de um objeto.  Voc√™ pode treinar a rede nisso, desde que tenha exemplos suficientes.  E √© assim que resolvemos esses problemas. <br><br>  Eu falo muito sobre obter dados de carros da Tesla.  E quero dizer imediatamente que desenvolvemos esse sistema desde o in√≠cio, levando em conta a confidencialidade.  Todos os dados que usamos para treinamento s√£o anonimizados. <br><br>  A frota nos envia n√£o apenas bicicletas em carros.  Estamos constantemente √† procura de muitos modelos diferentes.  Por exemplo, estamos √† procura de barcos - a frota envia imagens de barcos nas estradas.  Queremos imagens das √°reas de reparo de estradas, e a frota nos envia muitas imagens de todo o mundo.  Ou, por exemplo, lixo na estrada, isso tamb√©m √© muito importante.  A frota nos envia imagens de pneus, cones, sacolas pl√°sticas e similares na estrada. <br><br><img src="https://habrastorage.org/webt/aa/ne/2x/aane2xostifrgw-xjzwcklq-zbm.png"><br><br>  Podemos obter imagens suficientes, marc√°-las corretamente e a rede neural aprender√° como trabalhar com elas no mundo real.  Precisamos da rede neural para entender o que est√° acontecendo e responder corretamente. <br><br><h2>  A incerteza da rede neural desencadeia a coleta de dados </h2><br>  O procedimento, que repetimos v√°rias vezes para treinar a rede neural, √© o seguinte.  Come√ßamos com um conjunto aleat√≥rio de imagens recebidas da frota.  Marcamos as imagens, treinamos a rede neural e carregamos nos carros.  Temos mecanismos pelos quais detectamos imprecis√µes na opera√ß√£o do piloto autom√°tico.  Se percebermos que a rede neural n√£o tem certeza ou h√° interven√ß√£o do driver ou outros eventos, os dados para os quais isso aconteceu s√£o automaticamente enviados. <br><br><img src="https://habrastorage.org/webt/zl/ze/az/zlzeazzv1wrzsxbntqq5wtw0-50.png"><br><br>  Por exemplo, as marca√ß√µes do t√∫nel s√£o pouco reconhecidas.  Percebemos que h√° um problema nos t√∫neis.  As imagens correspondentes caem em nossos testes de unidade, para que o problema n√£o possa ser repetido posteriormente.  Agora, para corrigir o problema, precisamos de muitos exemplos de treinamento.  Pedimos √† frota que nos envie mais imagens dos t√∫neis, marque-as corretamente, adicione-as ao conjunto de treinamento, treine novamente a rede e depois carregue-as nos carros.  Este ciclo se repete repetidamente.  Chamamos esse processo iterativo de mecanismo de dados (mecanismo de dados? Mecanismo de dados?).  Ativamos a rede no modo de sombra, detectamos imprecis√µes, solicitamos mais dados e os inclu√≠mos no conjunto de treinamento.  Fazemos isso para todos os tipos de previs√µes de nossas redes neurais. <br><br><h2>  Marca√ß√£o autom√°tica de dados </h2><br>  Eu falei muito sobre marca√ß√£o manual de imagens.  Este √© um processo oneroso, a tempo e financeiramente.  Pode ser muito caro.  Eu quero falar sobre como voc√™ pode usar a frota aqui.  A marca√ß√£o manual √© um gargalo.  N√≥s apenas queremos transferir os dados e marc√°-los automaticamente.  E existem v√°rios mecanismos para isso. <br><br>  Como exemplo, um de nossos projetos recentes √© a reconstru√ß√£o da detec√ß√£o.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ est√° dirigindo na estrada, algu√©m est√° dirigindo √† esquerda ou √† direita e est√° reconstruindo a sua faixa. </font></font><br><br><img src="https://habrastorage.org/webt/jk/-g/y4/jk-gy4iyujnhhwpmzb0lcwpggci.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° um v√≠deo em que o piloto autom√°tico detecta uma reconstru√ß√£o. Obviamente, gostar√≠amos de descobrir o mais r√°pido poss√≠vel. A abordagem para resolver esse problema √© que n√£o escrevemos c√≥digos como: o indicador de dire√ß√£o esquerda est√° aceso, o indicador de dire√ß√£o certa est√° aceso, se o carro se moveu horizontalmente ao longo do tempo. Em vez disso, usamos o aprendizado autom√°tico baseado em frota.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como isso funciona? </font><font style="vertical-align: inherit;">Pedimos √† frota que nos envie dados sempre que uma reconstru√ß√£o em nossa pista for registrada. </font><font style="vertical-align: inherit;">Depois, retrocedemos o tempo e observamos automaticamente que este carro ser√° reconstru√≠do √† sua frente em 1,3 segundos. </font><font style="vertical-align: inherit;">Esses dados podem ser usados ‚Äã‚Äãpara treinar a rede neural. </font><font style="vertical-align: inherit;">Assim, a pr√≥pria rede neural extrair√° os sinais necess√°rios. </font><font style="vertical-align: inherit;">Por exemplo, um carro est√° vasculhando e depois reconstruindo ou tem um sinal de mudan√ßa de dire√ß√£o ligado. </font><font style="vertical-align: inherit;">A rede neural aprende sobre tudo isso a partir de exemplos rotulados automaticamente.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shadow Check </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pedimos √† frota que nos envie automaticamente os dados. Podemos coletar meio milh√£o de imagens ou mais, e as reconstru√ß√µes ser√£o marcadas em todas. Treinamos a rede e a carregamos na frota. Mas at√© ativ√°-lo completamente, mas execute-o no modo de sombra. Nesse modo, a rede constantemente faz previs√µes: "ei, acho que esse carro ser√° reconstru√≠do". E estamos procurando previs√µes erradas. </font></font><br><br><img src="https://habrastorage.org/webt/x0/zy/zx/x0zyzxkrebaxgrqwu3xdxuldf9u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° um exemplo de um clipe que obtivemos no modo sombra. Aqui a situa√ß√£o n√£o √© um pouco √≥bvia, e a rede achou que o carro √† direita estava prestes a ser reconstru√≠do. E voc√™ pode notar que ele est√° flertando um pouco com a linha de marca√ß√£o. A rede reagiu a isso e sugeriu que o carro logo estaria em nossa pista. Mas isso n√£o aconteceu.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A rede opera no modo sombra e faz previs√µes. Entre eles est√£o falsos positivos e falsos negativos. √Äs vezes, a rede reage erroneamente e, √†s vezes, pula eventos. Todos esses erros acionam a coleta de dados. Os dados s√£o marcados e incorporados ao treinamento sem esfor√ßo adicional. E n√£o colocamos em risco as pessoas nesse processo. N√≥s treinamos novamente a rede e usamos o modo sombra novamente. Podemos repetir isso v√°rias vezes, avaliando alarmes falsos em condi√ß√µes reais de tr√°fego. Quando os indicadores nos conv√™m, simplesmente clicamos no bot√£o e deixamos a rede controlar o carro.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lan√ßamos uma das primeiras vers√µes do detector de reconstru√ß√£o, cerca de tr√™s meses atr√°s. </font><font style="vertical-align: inherit;">Se voc√™ perceber que a m√°quina se tornou muito melhor na detec√ß√£o da reconstru√ß√£o, isso √© treinar com a frota em a√ß√£o. </font><font style="vertical-align: inherit;">E nenhuma pessoa ficou ferida nesse processo. </font><font style="vertical-align: inherit;">√â apenas muito treinamento de redes neurais baseadas em dados reais, usando o modo de sombra e analisando os resultados. </font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilon:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De fato, todos os motoristas treinam constantemente a rede. </font><font style="vertical-align: inherit;">N√£o importa se o piloto autom√°tico est√° ativado ou desativado. </font><font style="vertical-align: inherit;">A rede est√° aprendendo. </font><font style="vertical-align: inherit;">Cada milha percorrida por uma m√°quina com equipamento HW2.0 ou superior educa a rede.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enquanto estiver dirigindo, voc√™ est√° realmente marcando os dados </font></font></h2><br><br><img src="https://habrastorage.org/webt/-g/1h/i8/-g1hi870mojfe0cnotbafoab73u.png"><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrei:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outro projeto interessante que usamos no esquema de treinamento de frotas est√° prevendo o caminho. Ao dirigir, voc√™ est√° realmente marcando os dados. Voc√™ nos diz como dirigir em diferentes situa√ß√µes de dire√ß√£o. Aqui est√° um dos motoristas que virou √† esquerda no cruzamento. Temos um v√≠deo completo de todas as c√¢meras e sabemos o caminho que o motorista escolheu. Tamb√©m sabemos qual era a velocidade e o √¢ngulo de rota√ß√£o do volante. Reunimos tudo e entendemos o caminho que uma pessoa escolheu nessa situa√ß√£o de tr√¢nsito. E podemos usar isso como ensino com um professor. N√≥s apenas obtemos a quantidade necess√°ria de dados da frota, treinamos a rede nessas trajet√≥rias e, depois disso, a rede neural pode prever o caminho.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso se chama imita√ß√£o de aprendizado. Pegamos as trajet√≥rias de pessoas do mundo real e tentamos imit√°-las. E, novamente, podemos adotar nossa abordagem iterativa. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° um exemplo de previs√£o de um caminho em condi√ß√µes dif√≠ceis da estrada. No v√≠deo, cobrimos a previs√£o da rede. Verde marca o caminho que a rede se moveria. </font></font><br><br><img src="https://habrastorage.org/webt/vq/_5/h-/vq_5h-j22m3xlryz5aszlqqwls8.png"><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilon: A</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> loucura √© que a rede prev√™ um caminho que ela nem consegue ver. Com uma precis√£o incrivelmente alta. Ela n√£o v√™ o que est√° ao redor da curva, mas acredita que a probabilidade dessa trajet√≥ria √© extremamente alta. E acaba por estar certo. Hoje voc√™ ver√° isso em carros, incluiremos vis√£o aumentada para que voc√™ possa ver as marca√ß√µes e proje√ß√µes da trajet√≥ria sobreposta no v√≠deo. </font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrei:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De fato, sob o cap√¥, o m√°ximo est√° acontecendo, e</font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilon:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Na verdade, √© um pouco assustador (Andrey ri). </font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrew:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Claro, sinto falta de muitos detalhes. Voc√™ pode n√£o querer usar todos os drivers seguidos para marcar, mas sim o melhor. E usamos v√°rias maneiras de preparar esses dados. Curiosamente, essa previs√£o √© realmente tridimensional. Este √© um caminho no espa√ßo tridimensional que exibimos em 2D. Mas a rede tem informa√ß√µes sobre a inclina√ß√£o, e isso √© muito importante para dirigir.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prevendo a maneira como atualmente funciona nos carros. </font><font style="vertical-align: inherit;">A prop√≥sito, quando voc√™ passou pelo cruzamento na estrada, cerca de cinco meses atr√°s, seu carro n√£o conseguiu lidar com isso. </font><font style="vertical-align: inherit;">Agora pode. </font><font style="vertical-align: inherit;">Esta √© a previs√£o do caminho, em a√ß√£o, em seus carros. </font><font style="vertical-align: inherit;">N√≥s o ativamos h√° um tempo atr√°s. </font><font style="vertical-align: inherit;">E hoje voc√™ pode ver como isso funciona nos cruzamentos. </font><font style="vertical-align: inherit;">Uma parte significativa do treinamento para superar interse√ß√µes √© obtida pela marca√ß√£o autom√°tica de dados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consegui falar sobre os principais componentes do treinamento em redes neurais. </font><font style="vertical-align: inherit;">Voc√™ precisa de um conjunto grande e diversificado de dados reais. </font><font style="vertical-align: inherit;">Em Tesla, conseguimos isso usando a frota. </font><font style="vertical-align: inherit;">Usamos o mecanismo de dados, o modo sombra e o particionamento autom√°tico de dados usando a frota. </font><font style="vertical-align: inherit;">E podemos escalar essa abordagem.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Percep√ß√£o de profundidade por v√≠deo </font></font></h2><br><img src="https://habrastorage.org/webt/oc/ft/4s/ocft4sltp3pprppnnk5y0jsj0rs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na pr√≥xima parte do meu discurso, falarei sobre a percep√ß√£o da profundidade atrav√©s da vis√£o. Voc√™ provavelmente sabe que os carros usam pelo menos dois tipos de sensores. Uma √© a de c√¢meras de v√≠deo de brilho e a outra √© o lidar, usado por muitas empresas. Lidar fornece medi√ß√µes pontuais da dist√¢ncia ao seu redor. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gostaria de observar que todos voc√™s vieram aqui usando apenas sua rede e vis√£o neurais. Voc√™ n√£o disparou com lasers dos seus olhos e ainda acabou aqui.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â claro que a rede neural humana extrai a dist√¢ncia e percebe o mundo como tridimensional exclusivamente atrav√©s da vis√£o. Ela usa uma s√©rie de truques. Vou falar brevemente sobre alguns deles. Por exemplo, temos dois olhos, para que voc√™ tenha duas imagens do mundo √† sua frente. Seu c√©rebro combina essas informa√ß√µes para obter uma estimativa das dist√¢ncias, isso √© feito triangulando pontos em duas imagens. Em muitos animais, os olhos est√£o localizados nos lados e seu campo de vis√£o √© ligeiramente cruzado. Esses animais usam estrutura (movimento). Eles movem suas cabe√ßas para obter muitas imagens do mundo de diferentes pontos e tamb√©m podem aplicar triangula√ß√£o.</font></font><br><br><img src="https://habrastorage.org/webt/gl/sq/-q/glsq-qyu337vx5gcd3bycvqaffu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesmo com um olho fechado e completamente im√≥vel, voc√™ mant√©m um certo senso de percep√ß√£o da dist√¢ncia. Se voc√™ fechar um olho, n√£o lhe parecer√° que me tornei dois metros mais perto ou cem metros mais adiante. Isso ocorre porque existem muitas t√©cnicas monoculares poderosas que seu c√©rebro tamb√©m aplica. Por exemplo, uma ilus√£o de √≥tica comum, com duas faixas id√™nticas no fundo do trilho. Seu c√©rebro avalia a cena e espera que uma delas seja maior que a outra devido ao desaparecimento das linhas ferrovi√°rias. Seu c√©rebro faz muito disso automaticamente, e redes neurais artificiais tamb√©m podem fazer isso. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vou dar tr√™s exemplos de como voc√™ pode alcan√ßar a percep√ß√£o de profundidade no v√≠deo. Uma abordagem cl√°ssica e duas baseadas em redes neurais.</font></font><br><br><img src="https://habrastorage.org/webt/ns/ld/x0/nsldx0ejkyg1fvxoy-_7id-uds4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Podemos gravar um videoclipe em alguns segundos e recriar o ambiente em 3D usando m√©todos de triangula√ß√£o e vis√£o est√©reo. </font><font style="vertical-align: inherit;">Aplicamos m√©todos semelhantes no carro. </font><font style="vertical-align: inherit;">O principal √© que o sinal realmente tenha as informa√ß√µes necess√°rias, a √∫nica quest√£o √© extra√≠-lo.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Marcando dist√¢ncia usando radar </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como eu disse, as redes neurais s√£o uma ferramenta de reconhecimento visual muito poderosa. Se quiser que eles reconhe√ßam a dist√¢ncia, marque as dist√¢ncias e a rede aprender√° como faz√™-lo. Nada restringe as redes em sua capacidade de prever a dist√¢ncia, al√©m de marcar dados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usamos um radar direcionado para frente. Esse radar mede e marca a dist√¢ncia dos objetos que a rede neural v√™. Em vez de dizer √†s pessoas "este carro est√° a cerca de 25 metros de dist√¢ncia", voc√™ pode marcar os dados muito melhor usando sensores. O radar funciona muito bem a essa dist√¢ncia. Voc√™ marca os dados e treina a rede neural. Se voc√™ tiver dados suficientes, uma rede neural ser√° muito boa em prever a dist√¢ncia.</font></font><br><br><img src="https://habrastorage.org/webt/ih/pp/je/ihppjemgjkcaefowadynpdtu5le.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesta imagem, os c√≠rculos mostram os objetos recebidos pelo radar e os cuboides s√£o os objetos recebidos pela rede neural. </font><font style="vertical-align: inherit;">E se a rede funcionar bem, ent√£o, na vista superior, as posi√ß√µes dos cuboides devem coincidir com a posi√ß√£o dos c√≠rculos, que observamos. </font><font style="vertical-align: inherit;">As redes neurais se saem muito bem com a previs√£o de dist√¢ncia. </font><font style="vertical-align: inherit;">Eles podem aprender o tamanho de diferentes ve√≠culos e, de acordo com o tamanho da imagem, determinar com precis√£o a dist√¢ncia.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Auto-supervis√£o </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O √∫ltimo mecanismo, sobre o qual falarei brevemente, √© um pouco mais t√©cnico. Existem apenas alguns artigos, principalmente nos √∫ltimos um ou dois anos, sobre essa abordagem. √â chamado de auto-supervis√£o. </font></font><br><br><img src="https://habrastorage.org/webt/ll/vt/qy/llvtqyhtg50ssityr07udz-ssqs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que est√° acontecendo aqui. Voc√™ carrega v√≠deos n√£o rotulados n√£o processados ‚Äã‚Äãna rede neural. E a rede ainda pode aprender a reconhecer a dist√¢ncia. Sem entrar em detalhes, a ideia √© que uma rede neural preveja a dist√¢ncia em cada quadro deste v√≠deo. N√£o temos tags para verifica√ß√£o, mas existe uma consist√™ncia objetivo-tempo. Independentemente da dist√¢ncia prevista pela rede, ela deve ser consistente ao longo do v√≠deo. E a √∫nica maneira de ser consistente √© prever a dist√¢ncia corretamente. A rede prev√™ automaticamente a profundidade de todos os pixels. Conseguimos reproduzi-lo e funciona muito bem.</font></font><br><br><h2>    ‚Äî     </h2><br>  Para resumir.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As pessoas usam a vis√£o, sem lasers. Quero enfatizar que o reconhecimento visual poderoso √© absolutamente essencial para a dire√ß√£o aut√¥noma. Precisamos de redes neurais que realmente entendam o meio ambiente. </font></font><br><br><img src="https://habrastorage.org/webt/5q/aq/b0/5qaqb0qjwt-a7c6tpihpswc_zba.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os dados do lidar s√£o muito menos saturados de informa√ß√µes. Esta silhueta est√° na estrada, √© uma sacola pl√°stica ou um pneu? Lidar simplesmente fornecer√° alguns pontos, enquanto a vis√£o pode dizer o que √©. Esse cara est√° de bicicleta olhando para tr√°s, est√° tentando mudar de faixa ou est√° indo direto? Na zona de repara√ß√£o de estradas, o que significam esses sinais e como devo me comportar aqui? Sim, toda a infraestrutura vi√°ria foi projetada para consumo visual. Todos os sinais, sem√°foros, tudo √† vista, √© onde est√£o todas as informa√ß√µes. E devemos us√°-lo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa garota √© apaixonada pelo telefone, ela vai pisar na estrada? </font><font style="vertical-align: inherit;">As respostas para essas perguntas podem ser encontradas apenas com a ajuda da vis√£o e s√£o necess√°rias para o piloto autom√°tico n√≠vel 4-5. </font><font style="vertical-align: inherit;">E √© isso que estamos desenvolvendo na Tesla. </font><font style="vertical-align: inherit;">Fazemos isso por meio de treinamento em rede neural em larga escala, nosso mecanismo de dados e assist√™ncia √† frota. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesse sentido, o lidar √© uma tentativa de abrir caminho. </font><font style="vertical-align: inherit;">Contorna a tarefa fundamental da vis√£o de m√°quina, cuja solu√ß√£o √© necess√°ria para a condu√ß√£o aut√¥noma. </font><font style="vertical-align: inherit;">D√° uma falsa sensa√ß√£o de progresso. </font><font style="vertical-align: inherit;">Lidar √© bom apenas para demonstra√ß√µes r√°pidas.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O progresso √© proporcional √† frequ√™ncia de colis√µes com situa√ß√µes complexas no mundo real. </font></font></h2><br><img src="https://habrastorage.org/webt/1t/io/en/1tioensdyfmt5eei36zaezrk1py.png"><br><br>  Se eu quisesse encaixar tudo o que foi dito em um slide, ficaria assim.  Precisamos de sistemas de n√≠vel 4-5 que possam lidar com todas as situa√ß√µes poss√≠veis em 99,9999% dos casos.  A busca dos √∫ltimos nove ser√° dif√≠cil e muito dif√≠cil.  Isso exigir√° um sistema de vis√£o de m√°quina muito poderoso. <br><br>  Aqui s√£o mostradas as imagens que voc√™ pode encontrar no caminho para as casas decimais estimadas.  No come√ßo, voc√™ s√≥ tem carros avan√ßando, ent√£o esses carros come√ßam a parecer um pouco incomuns, as bicicletas aparecem neles, carros nos carros.  Ent√£o voc√™ se depara com eventos realmente raros, como carros invertidos ou mesmo carros em um salto.  Reunimos muito de tudo nos dados provenientes da frota. <br><br>  E vemos esses eventos raros com muito mais frequ√™ncia do que nossos concorrentes.  Isso determina a velocidade com a qual podemos obter dados e corrigir problemas atrav√©s do treinamento de redes neurais.  A velocidade do progresso √© proporcional √† frequ√™ncia com que voc√™ se depara com situa√ß√µes dif√≠ceis no mundo real.  E nos deparamos com eles com mais frequ√™ncia do que qualquer outra pessoa.  Portanto, nosso piloto autom√°tico √© melhor que outros.  Obrigada <br><br><h2>  Perguntas e Respostas </h2><br><br>  <strong>Pergunta:</strong> Quantos dados voc√™ coleta em m√©dia de cada carro? <br><br>  <strong>Andrew:</strong> N√£o se trata apenas da quantidade de dados, mas de diversidade.  Em algum momento, voc√™ j√° tem imagens suficientes de dire√ß√£o ao longo da rodovia, a rede as entende, n√£o √© mais necess√°rio.  Portanto, estamos estrategicamente focados na obten√ß√£o dos dados corretos.  E nossa infraestrutura, com uma an√°lise bastante complicada, permite obter os dados de que precisamos agora.  N√£o se trata de grandes quantidades de dados, trata-se de dados muito bem selecionados. <br><br>  <strong>Pergunta:</strong> Gostaria de saber como voc√™ resolver√° o problema de mudar de faixa.  Sempre que tento reconstruir um fluxo denso, eles me cortam.  O comportamento humano est√° se tornando irracional nas estradas de Los Angeles.  O piloto autom√°tico quer dirigir com seguran√ßa, e voc√™ quase precisa faz√™-lo inseguro. <br><br>  <strong>Andrew:</strong> Falei sobre o mecanismo de dados no treinamento de redes neurais.  Mas fazemos o mesmo no n√≠vel do software.  Todos os par√¢metros que afetam a escolha, por exemplo, quando reconstruir, qu√£o agressivo.  Tamb√©m os alteramos no modo de sombra e observamos como eles funcionam e ajustamos a heur√≠stica.  De fato, projetar essas heur√≠sticas para o caso geral √© uma tarefa dif√≠cil.  Acho que teremos que usar o treinamento da frota para tomar essas decis√µes.  Quando as pessoas mudam de faixa?  Em quais cen√°rios?  Quando eles acham que mudar de faixa n√£o √© seguro?  Vamos analisar uma grande quantidade de dados e ensinar o classificador de aprendizado de m√°quina a distinguir quando a reconstru√ß√£o √© segura.  Esses classificadores poder√£o escrever um c√≥digo muito melhor do que as pessoas, porque contam com uma enorme quantidade de dados sobre o comportamento dos drivers. <br><br>  <strong>Ilon:</strong> Provavelmente, teremos o modo "tr√°fego em Los Angeles".  Em algum lugar ap√≥s o modo Mad Max.  Sim, Mad Max teria dificuldade em Los Angeles. <br><br>  <strong>Andrei</strong> ter√° que se comprometer.  Voc√™ n√£o deseja criar situa√ß√µes inseguras, mas quer chegar em casa.  E as dan√ßas que as pessoas realizam ao mesmo tempo, √© muito dif√≠cil programar.  Eu acho que o caminho certo √© o aprendizado de m√°quina.  Onde apenas observamos as v√°rias maneiras pelas quais as pessoas fazem isso e tentamos imit√°-las. <br><br>  <strong>Ilon:</strong> Agora somos um pouco conservadores e, √† medida que nossa confian√ßa aumenta, ser√° poss√≠vel escolher um regime mais agressivo.  Os usu√°rios poder√£o escolher.  Nos modos agressivos, ao tentar mudar de faixa em um engarrafamento, h√° uma pequena chance de enrugar a asa.  Sem risco de um acidente grave.  Voc√™ ter√° a op√ß√£o de concordar com uma chance diferente de zero de esmagar a asa.  Infelizmente, esta √© a √∫nica maneira de ficar preso no tr√¢nsito na estrada. <br><br>  <strong>Pergunta:</strong> Poderia acontecer em um desses nove ap√≥s o ponto decimal que o lidar ser√° √∫til?  A segunda pergunta √©: se os lidares s√£o realmente in√∫teis, o que acontecer√° com aqueles que tomarem suas decis√µes sobre eles? <br><br>  <strong>Ilon:</strong> Todos eles v√£o se livrar dos lidares, esta √© a minha previs√£o, voc√™ pode escrever.  Devo dizer que n√£o odeio lidar tanto quanto parece.  O SpaceX Dragon usa o lidar para ir para a ISS e atracar.  A SpaceX desenvolveu seu pr√≥prio lidar a partir do zero para isso.  Eu liderei pessoalmente esse projeto porque o lidar faz sentido nesse cen√°rio.  Mas em carros √© est√∫pido.  √â caro e n√£o √© necess√°rio.  E, como Andrei disse, assim que voc√™ manipular o v√≠deo, o lidar se tornar√° in√∫til.  Voc√™ ter√° equipamentos caros que s√£o in√∫teis para o carro. <br><br>  Temos um radar para a frente.  √â barato e √∫til, especialmente em condi√ß√µes de baixa visibilidade.  Nevoeiro, poeira ou neve, o radar pode ver atrav√©s deles.  Se voc√™ for usar a gera√ß√£o ativa de f√≥tons, n√£o use o comprimento de onda da luz vis√≠vel.  Porque, com √≥ptica passiva, voc√™ j√° cuidou de tudo no espectro vis√≠vel.  Agora √© melhor usar um comprimento de onda com boas propriedades de penetra√ß√£o, como radar.  Lidar √© simplesmente a gera√ß√£o ativa de f√≥tons no espectro vis√≠vel.  Deseja gerar f√≥tons ativamente, fa√ßa fora do espectro vis√≠vel.  Usando 3,8 mm versus 400-700 nm, voc√™ poder√° ver em m√°s condi√ß√µes clim√°ticas.  Portanto, temos um radar.  Bem como doze sensores ultrass√¥nicos para o ambiente imediato.  O radar √© mais √∫til na dire√ß√£o do movimento, porque √© diretamente que voc√™ est√° se movendo muito r√°pido. <br><br>  J√° levantamos a quest√£o dos sensores muitas vezes.  Existem o suficiente deles?  Temos tudo o que precisamos?  Precisa adicionar mais alguma coisa?  Hummm.  Chega. <br><br>  <strong>Pergunta:</strong> Parece que os carros est√£o fazendo algum tipo de c√°lculo para determinar quais informa√ß√µes enviar.  Isso √© feito em tempo real ou com base nas informa√ß√µes armazenadas? <br><br>  <strong>Andrey: Os</strong> c√°lculos s√£o feitos em tempo real nos pr√≥prios carros.  Transmitimos as condi√ß√µes que nos interessam e os carros fazem todos os c√°lculos necess√°rios.  Se eles n√£o fizessem isso, ter√≠amos que transferir todos os dados em uma linha e process√°-los em nosso back-end.  N√≥s n√£o queremos fazer isso. <br><br>  <strong>Ilon:</strong> Temos quatrocentos e vinte e cinco mil carros com o HW2.0 +.  Isso significa que eles t√™m oito c√¢meras, um radar, sensores ultrass√¥nicos e pelo menos um computador nVidia.  Basta calcular quais informa√ß√µes s√£o importantes e quais n√£o s√£o.  Eles compactam informa√ß√µes importantes e as enviam para a rede para treinamento.  Este √© um enorme grau de compacta√ß√£o de dados do mundo real. <br><br>  <strong>Pergunta:</strong> Voc√™ tem essa rede de centenas de milhares de computadores, que se assemelha a um poderoso data center distribu√≠do.  Voc√™ v√™ a aplica√ß√£o para outros fins que n√£o o piloto autom√°tico? <br><br>  <strong>Ilon:</strong> Suponho que isso possa ser usado para outra coisa.  Enquanto nos concentramos no piloto autom√°tico.  Assim que o colocamos no n√≠vel certo, podemos pensar em outros aplicativos.  At√© ent√£o, ser√£o milh√µes ou dezenas de milh√µes de carros com HW3.0 ou FSDC. <br><br>  <strong>Pergunta:</strong> Calculando tr√°fego? <br><br>  <strong>Ilon:</strong> Sim, talvez.  pode ser algo como AWS (Amazon Web Services). <br><br>  <strong>Pergunta:</strong> Sou motorista de modelo 3 em Minnesota, onde h√° muita neve.  A c√¢mera e o radar n√£o podem ver as marca√ß√µes da estrada na neve.  Como voc√™ vai resolver esse problema?  Voc√™ vai usar GPS de alta precis√£o? <br><br>  <strong>Andrew:</strong> Hoje, o piloto autom√°tico se comporta muito bem em uma estrada com neve.  Mesmo quando as marca√ß√µes est√£o ocultas, desgastadas ou cobertas de √°gua sob chuva forte, o piloto autom√°tico ainda se comporta relativamente bem.  Ainda n√£o lidamos com a estrada com neve com nosso mecanismo de dados.  Mas tenho certeza de que esse problema pode ser resolvido.  Porque em muitas imagens de uma estrada com neve, se voc√™ perguntar a uma pessoa onde as marca√ß√µes devem estar, ela a mostrar√°.  As pessoas concordam em onde desenhar linhas de marca√ß√£o.  E embora as pessoas possam concordar e marcar seus dados, a rede neural poder√° aprender isso e funcionar√° bem.  A √∫nica quest√£o √© se h√° informa√ß√µes suficientes no sinal original.  O suficiente para um anotador de pessoa?  Se a resposta for sim, a rede neural funcionar√° perfeitamente. <br><br>  <strong>Ilon:</strong> Existem v√°rias fontes importantes de informa√ß√£o no sinal da fonte.  Ent√£o, marca√ß√£o, este √© apenas um deles.  A fonte mais importante √© a entrada de autom√≥veis.  Onde voc√™ pode ir e onde n√£o pode.  Mais importante que a marca√ß√£o.  O reconhecimento da estrada funciona muito bem.  Eu acho que, especialmente ap√≥s o pr√≥ximo inverno, funcionar√° incrivelmente.  Vamos nos perguntar como isso pode funcionar t√£o bem.  Isso √© loucura. <br><br>  <strong>Andrew:</strong> N√£o √© nem a capacidade das pessoas marcarem.  Contanto que voc√™, uma pessoa, possa superar esse trecho da estrada.  A frota aprender√° com voc√™.  N√≥s sabemos como voc√™ dirigiu aqui.  E voc√™ obviamente usou a vis√£o para isso.  Voc√™ n√£o viu a marca√ß√£o, mas usou a geometria de toda a cena.  Voc√™ v√™ como a estrada se curva, como outros carros est√£o localizados ao seu redor.  A rede neural destacar√° automaticamente todos esses padr√µes; voc√™ s√≥ precisa obter dados suficientes sobre como as pessoas superam essas situa√ß√µes. <br><br>  <strong>Ilon:</strong> √â muito importante n√£o se ater ao GPS.  O erro de GPS pode ser muito significativo.  E a situa√ß√£o real do tr√°fego pode ser imprevis√≠vel.  Pode ser um reparo ou desvio de estrada.  Se o carro depende muito do GPS, esta √© uma situa√ß√£o ruim.  Voc√™ est√° pedindo problemas.  GPS √© bom para usar apenas como uma dica. <br><br>  <strong>Pergunta:</strong> Alguns de seus concorrentes falam sobre como eles usam mapas de alta defini√ß√£o para melhorar a percep√ß√£o e o planejamento do caminho.  Voc√™ usa algo semelhante no seu sistema, v√™ algum benef√≠cio nisso?  Existem √°reas em que voc√™ gostaria de obter mais dados, n√£o da frota, mas algo como cart√µes? <br><br>  <strong>Ilon:</strong> Eu acho que mapas de alta resolu√ß√£o s√£o uma p√©ssima id√©ia.  O sistema se torna extremamente inst√°vel.  N√£o foi poss√≠vel adaptar-se √†s altera√ß√µes se voc√™ estiver conectado ao GPS e a mapas de alta resolu√ß√£o e n√£o der prioridade √† vis√£o.  Vis√£o √© a coisa que deve fazer tudo.  Veja, a marca√ß√£o √© apenas uma diretriz, n√£o a coisa mais importante.  Tentamos usar cart√µes de marca√ß√£o e rapidamente percebemos que esse era um grande erro.  N√≥s os abandonamos completamente. <br><br>  <strong>Pergunta:</strong> Entender onde est√£o os objetos e como os carros est√£o se movendo √© muito √∫til.  Mas e o aspecto da negocia√ß√£o?  Durante o estacionamento, nas rotat√≥rias e em outras situa√ß√µes em que voc√™ interage com outros carros que as pessoas dirigem.  √â mais uma arte do que uma ci√™ncia. <br><br>  <strong>Ilon:</strong> Funciona muito bem.  Se voc√™ observar situa√ß√µes com rearranjos etc., o piloto autom√°tico normalmente aguenta. <br><br>  <strong>Andrew:</strong> Agora usamos muito aprendizado de m√°quina para criar uma id√©ia do mundo real.  Al√©m disso, temos um agendador e controlador e muitas heur√≠sticas sobre como dirigir, como levar em considera√ß√£o outros carros e assim por diante.  E, assim como no reconhecimento de padr√µes, h√° muitos casos fora do padr√£o aqui, √© como um jogo de falc√µes e pombos, que voc√™ joga com outras pessoas.  Estamos confiantes de que, em √∫ltima an√°lise, usaremos o treinamento baseado em frota para resolver esse problema.  A heur√≠stica de escrita manual repousa rapidamente em um plat√¥. <br><br>  <strong>Pergunta:</strong> Voc√™ tem um modo de pelot√£o?  O sistema √© capaz disso? <br><br>  <strong>Andrei:</strong> Estou absolutamente certo de que poder√≠amos fazer esse regime.  Mas, novamente, se voc√™ apenas treinar a rede para imitar as pessoas.  As pessoas se apegam e dirigem na frente do carro e a rede se lembra desse comportamento.  H√° um tipo de m√°gica, tudo acontece por si s√≥.  Problemas diferentes se resumem a um: basta coletar o conjunto de dados e us√°-lo para treinar a rede neural. <br><br>  <strong>Ilon:</strong> Tr√™s etapas para a condu√ß√£o aut√¥noma.  O primeiro √© simplesmente implementar essa funcionalidade.  O segundo √© traz√™-lo a tal ponto que uma pessoa em um carro n√£o precisa prestar aten√ß√£o √† estrada.  E a terceira √© mostrar o n√≠vel de confiabilidade que convence os reguladores.  Estes s√£o tr√™s n√≠veis.  Esperamos alcan√ßar o primeiro n√≠vel este ano.  E esperamos, em algum momento do segundo trimestre do pr√≥ximo ano, alcan√ßar um n√≠vel de confian√ßa quando uma pessoa n√£o precisar mais manter as m√£os no volante e olhar para a estrada.  Depois disso, esperamos aprova√ß√£o regulat√≥ria em pelo menos algumas jurisdi√ß√µes at√© o final do pr√≥ximo ano.  Essas s√£o minhas expectativas. <br><br>  Para caminh√µes, √© prov√°vel que o regime de comboios seja aprovado pelos reguladores mais cedo do que qualquer outra coisa.  Talvez para viagens longas voc√™ possa usar um motorista no carro da frente e 4 caminh√µes Semi atr√°s dele no modo comboio. <br><br>  <strong>Pergunta:</strong> Estou muito impressionado com a melhoria do piloto autom√°tico.  Na semana passada, eu estava dirigindo na faixa direita da rodovia e havia uma entrada.  Meu modelo 3 foi capaz de detectar dois carros entrando na estrada e diminuiu a velocidade, de modo que um carro fosse silenciosamente constru√≠do na minha frente e o outro atr√°s de mim.  Ent√£o eu pensei, caramba, isso √© loucura, eu n√£o sabia que meu modelo 3 √© capaz disso. <br><br>  Mas naquela mesma semana eu estava dirigindo novamente na faixa da direita e houve um estreitamento, minha faixa da direita se fundiu com a esquerda.  E meu modelo 3 n√£o foi capaz de reagir corretamente, tive que intervir.  Voc√™ pode dizer como a Tesla pode resolver esse problema? <br><br>  <strong>Andrew:</strong> Eu falei sobre a infraestrutura de coleta de dados.  Se voc√™ interveio, provavelmente obtivemos este clipe.  Ele entrou nas estat√≠sticas, por exemplo, com que probabilidade flu√≠mos corretamente no fluxo.  Observamos esses n√∫meros, observamos os clipes e vemos o que est√° errado.  E estamos tentando corrigir o comportamento para obter melhorias em compara√ß√£o com os benchmarks. <br><br>  <strong>Ilon:</strong> Bem, temos outra apresenta√ß√£o sobre software.  Fizemos uma apresenta√ß√£o sobre equipamentos com Pete, depois redes neurais com Andrey e agora o software com Stuart. <br>  ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt450796/">https://habr.com/ru/post/pt450796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt450784/index.html">Como a Netflix gerencia seus espectadores t√£o bem?</a></li>
<li><a href="../pt450786/index.html">Diferen√ßas entre Fluente e gettext</a></li>
<li><a href="../pt450788/index.html">Inje√ß√£o de depend√™ncia com DITranquillity</a></li>
<li><a href="../pt450790/index.html">Hidrogel, mirtilos e uma pitada de a√ßafr√£o: sistema vascular artificial</a></li>
<li><a href="../pt450794/index.html">A escolha √© m√°</a></li>
<li><a href="../pt450798/index.html">Machine Learning em desenvolvimento m√≥vel: perspectivas e descentraliza√ß√£o</a></li>
<li><a href="../pt450800/index.html">Desenvolvimento de microsservi√ßos com BDD e IOD</a></li>
<li><a href="../pt450802/index.html">Interrup√ß√£o herdada</a></li>
<li><a href="../pt450804/index.html">Impress√£o de metal 3D na ind√∫stria automotiva: comece pequeno</a></li>
<li><a href="../pt450806/index.html">Quando uma vari√°vel de ambiente acelera o processo em 40 vezes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>