<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÑ ‚õπÔ∏è üë®‚Äçüë©‚Äçüëß‚Äçüë¶ RecyclerView mit maximaler Geschwindigkeit: Analysieren von Bibliotheken üßìüèΩ üèåÔ∏è üë©‚Äç‚ù§Ô∏è‚Äçüë®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ilya Nekrasov, Mahtalitet , Android-Entwickler von KODE 
 Zweieinhalb Jahre lang habe ich in der Android-Entwicklung an v√∂llig anderen Projekten gearb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RecyclerView mit maximaler Geschwindigkeit: Analysieren von Bibliotheken</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/428525/"><p><img src="https://habrastorage.org/webt/02/i_/cl/02i_cl7q71uldgrkijpim0a0agk.jpeg"></p><br><p><img src="https://habrastorage.org/webt/np/kh/rc/npkhrc7elthbz0riiye9ri5zu1g.png" align="left">  <strong>Ilya Nekrasov, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Mahtalitet</a> , Android-Entwickler von KODE</strong> <br>  <em>Zweieinhalb Jahre lang habe ich in der Android-Entwicklung an v√∂llig anderen Projekten gearbeitet: von einem sozialen Netzwerk f√ºr Autofahrer und eine lettische Bank √ºber ein Bundesbonussystem bis hin zur dritten Fluggesellschaft f√ºr den Transport.</em>  <em>Wie auch immer, in jedem dieser Projekte stie√ü ich auf Aufgaben, die die Suche nach nicht klassischen L√∂sungen bei der Implementierung von Listen mit der RecyclerView-Klasse erforderten.</em> <em><br></em>  <em>Dieser Artikel - das Ergebnis der Vorbereitung auf eine Auff√ºhrung beim DevFest Kaliningrad'18 sowie der Kommunikation mit Kollegen - ist besonders n√ºtzlich f√ºr Anf√§nger und diejenigen, die nur eine der vorhandenen Bibliotheken verwendet haben.</em> </p><br><p>  Zun√§chst besch√§ftigen wir uns ein wenig mit der Essenz des Problems und der Schmerzquelle, n√§mlich dem Wachstum der Funktionalit√§t bei der Entwicklung der Anwendung und der Komplexit√§t der verwendeten Listen. </p><a name="habracut"></a><br><h2 id="glava-pervaya-v-kotoroy-zakazchik-mechtaet-o-prilozhenii-a-my--o-chetkih-trebovaniyah">  Kapitel eins, in dem der Kunde von einer Anwendung tr√§umt und wir - √ºber klare Anforderungen </h2><br><p><img src="https://habrastorage.org/webt/fi/wb/vs/fiwbvsaeyquagqloswybveolmaq.gif" align="right">  Stellen wir uns eine Situation vor, in der ein Kunde ein Studio kontaktiert, das eine mobile Anwendung f√ºr ein Gummiente-Gesch√§ft w√ºnscht. </p><br><p>  Das Projekt entwickelt sich rasant, es entstehen regelm√§√üig neue Ideen, die nicht in eine langfristige Roadmap eingebettet sind. </p><br><p>  Zun√§chst fordert uns der Kunde auf, eine Liste der vorhandenen Waren anzuzeigen und beim Klicken eine Lieferanfrage auszuf√ºllen.  Sie m√ºssen nicht weit gehen, um eine L√∂sung zu finden: Wir verwenden das klassische Set von <strong>RecyclerView</strong> , einen einfachen selbstgeschriebenen Adapter daf√ºr und <strong>Activity</strong> . </p><br><p>  F√ºr den Adapter verwenden wir homogene Daten, einen <strong>ViewHolder</strong> und eine einfache Bindungslogik. </p><br><div class="spoiler">  <b class="spoiler_title">Adapter mit Enten</b> <div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksClassicAdapter</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: List&lt;Duck&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onDuckClickAction: (Duck) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) : RecyclerView.Adapter&lt;DucksClassicAdapter.ViewHolder&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewType: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckView = LayoutInflater.from(parent.context).inflate(R.layout.item_rubber_duck, parent, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(rubberDuckView) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> duck = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>[position] holder.divider.isVisible = position != <span class="hljs-number"><span class="hljs-number">0</span></span> holder.rubberDuckImage.apply { Picasso.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() .load(duck.icon) .config(Bitmap.Config.ARGB_4444) .fit() .centerCrop() .noFade() .placeholder(R.drawable.duck_stub) .into(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } holder.clicksHolder.setOnClickListener { onDuckClickAction.invoke(duck) } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.count() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span></span>(view: View) : RecyclerView.ViewHolder(view) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckImage: ImageView = view.findViewById(R.id.rubberDuckImage) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> clicksHolder: View = view.findViewById(R.id.clicksHolder) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> divider: View = view.findViewById(R.id.divider) } }</code> </pre> </div></div><br><p><br><br><img src="https://habrastorage.org/webt/kh/bn/x3/khbnx3_a59poubdcheopd3e5ax4.gif" align="left">  Im Laufe der Zeit hat der Kunde die Idee, den Gummienten eine weitere Warengruppe hinzuzuf√ºgen, was bedeutet, dass er ein neues Datenmodell und ein neues Layout hinzuf√ºgen muss.  Am wichtigsten ist jedoch, dass im Adapter ein anderer <strong>ViewType angezeigt</strong> wird, mit dem Sie festlegen k√∂nnen, welcher ViewHolder f√ºr ein bestimmtes Listenelement verwendet werden soll. </p><br><p>  Danach werden den Kategorien √úberschriften hinzugef√ºgt, nach denen jede Kategorie reduziert und erweitert werden kann, um die Ausrichtung der Benutzer im Gesch√§ft zu vereinfachen.  Dies ist plus ein weiterer <strong>ViewType</strong> und <strong>ViewHolder</strong> f√ºr Header.  Au√üerdem m√ºssen Sie den Adapter komplizieren, da Sie eine Liste offener Gruppen f√ºhren und damit √ºberpr√ºfen m√ºssen, ob dieses oder jenes Element durch Klicken auf die Kopfzeile ausgeblendet und angezeigt werden muss. </p><br><div class="spoiler">  <b class="spoiler_title">Adapter mit allem</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksClassicAdapter</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onDuckClickAction: (Pair&lt;Duck, <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>&gt;) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onSlipperClickAction: (Duck) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onAdvertClickAction: (Advert) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) : RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: List&lt;Duck&gt; = emptyList() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(value) { field = value internalData = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.groupBy { it.javaClass.kotlin } .flatMap { groupedDucks -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> titleRes = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (groupedDucks.key) { DuckSlipper::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slippers</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RubberDuck</span></span></span><span class="hljs-class">:</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">:class -&gt; R.string.rubber_ducks else -&gt; R.string.mixed_ducks } groupedDucks.value.let { listOf</span></span></span></span>(FakeDuck(titleRes, it)).plus(it) } } .toMutableList() duckCountsAdapters = internalData.map { duck -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuck = (duck <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? RubberDuck) DucksCountAdapter( <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = (<span class="hljs-number"><span class="hljs-number">1</span></span>..(rubberDuck?.count ?: <span class="hljs-number"><span class="hljs-number">1</span></span>)).map { count -&gt; duck to count }, onCountClickAction = { onDuckClickAction.invoke(it) } ) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> advert = DuckMockData.adverts.orEmpty().shuffled().first() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> internalData: MutableList&lt;Duck&gt; = mutableListOf() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> duckCountsAdapters: List&lt;DucksCountAdapter&gt; = emptyList() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collapsedHeaders: MutableSet&lt;Duck&gt; = hashSetOf() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewType: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: RecyclerView.ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (viewType) { VIEW_TYPE_RUBBER_DUCK -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_rubber_duck, parent) DuckViewHolder(view) } VIEW_TYPE_SLIPPER_DUCK -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_duck_slipper, parent) SlipperViewHolder(view) } VIEW_TYPE_HEADER -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_header, parent) HeaderViewHolder(view) } VIEW_TYPE_ADVERT -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_advert, parent) AdvertViewHolder(view) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> UnsupportedOperationException(<span class="hljs-string"><span class="hljs-string">"view type </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$viewType</span></span></span><span class="hljs-string"> without ViewHolder"</span></span>) } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">RecyclerView</span></span></span></span><span class="hljs-function"><span class="hljs-params">.</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (holder) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> HeaderViewHolder -&gt; bindHeaderViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DuckViewHolder -&gt; bindDuckViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> SlipperViewHolder -&gt; bindSlipperViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> AdvertViewHolder -&gt; bindAdvertViewHolder(holder) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindAdvertViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AdvertViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { holder.advertImage.showIcon(advert.icon) holder.advertTagline.text = advert.tagline holder.itemView.setOnClickListener { onAdvertClickAction.invoke(advert) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindHeaderViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HeaderViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = getItem(position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> FakeDuck holder.clicksHolder.setOnClickListener { changeCollapseState(item, position) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> arrowRes = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (collapsedHeaders.contains(item)) R.drawable.ic_keyboard_arrow_up_black_24dp <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> R.drawable.ic_keyboard_arrow_down_black_24dp holder.arrow.setImageResource(arrowRes) holder.title.setText(item.titleRes) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">changeCollapseState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">FakeDuck</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isCollapsed = collapsedHeaders.contains(item) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollapsed) { collapsedHeaders.remove(item) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { collapsedHeaders.add(item) } <span class="hljs-comment"><span class="hljs-comment">// 1 to add items after header val startPosition = position + 1 if (isCollapsed) { internalData.addAll(startPosition - ADVERTS_COUNT, item.items) notifyItemRangeInserted(startPosition, item.items.count()) } else { internalData.removeAll(item.items) notifyItemRangeRemoved(startPosition, item.items.count()) } notifyItemChanged(position) } @SuppressLint("SetTextI18n") private fun bindSlipperViewHolder(holder: SlipperViewHolder, position: Int) { val slipper = getItem(position) as DuckSlipper holder.duckSlipperImage.showIcon(slipper.icon) holder.duckSlipperSize.text = ": ${slipper.size}" holder.clicksHolder.setOnClickListener { onSlipperClickAction.invoke(slipper) } } private fun bindDuckViewHolder(holder: DuckViewHolder, position: Int) { val duck = getItem(position) as RubberDuck holder.rubberDuckImage.showIcon(duck.icon) holder.rubberDuckCounts.adapter = duckCountsAdapters[position - ADVERTS_COUNT] val context = holder.itemView.context holder.rubberDuckCounts.layoutManager = LinearLayoutManager(context, HORIZONTAL, false) } override fun getItemViewType(position: Int): Int { if (position == 0) return VIEW_TYPE_ADVERT return when (getItem(position)) { is FakeDuck -&gt; VIEW_TYPE_HEADER is RubberDuck -&gt; VIEW_TYPE_RUBBER_DUCK is DuckSlipper -&gt; VIEW_TYPE_SLIPPER_DUCK else -&gt; throw UnsupportedOperationException("unknown type for $position position") } } private fun getItem(position: Int) = internalData[position - ADVERTS_COUNT] override fun getItemCount() = internalData.count() + ADVERTS_COUNT class DuckViewHolder(view: View) : RecyclerView.ViewHolder(view) { val rubberDuckImage: ImageView = view.findViewById(R.id.rubberDuckImage) val rubberDuckCounts: RecyclerView = view.findViewById(R.id.rubberDuckCounts) } class SlipperViewHolder(view: View) : RecyclerView.ViewHolder(view) { val duckSlipperImage: ImageView = view.findViewById(R.id.duckSlipperImage) val duckSlipperSize: TextView = view.findViewById(R.id.duckSlipperSize) val clicksHolder: View = view.findViewById(R.id.clicksHolder) } class HeaderViewHolder(view: View) : RecyclerView.ViewHolder(view) { val title: TextView = view.findViewById(R.id.headerTitle) val arrow: ImageView = view.findViewById(R.id.headerArrow) val clicksHolder: View = view.findViewById(R.id.clicksHolder) } class AdvertViewHolder(view: View) : RecyclerView.ViewHolder(view) { val advertTagline: TextView = view.findViewById(R.id.advertTagline) val advertImage: ImageView = view.findViewById(R.id.advertImage) } } private class FakeDuck( val titleRes: Int, val items: List&lt;Duck&gt; ) : Duck private fun ImageView.showIcon(icon: String, placeHolderRes: Int = R.drawable.duck_stub) { Picasso.get() .load(icon) .config(Bitmap.Config.ARGB_4444) .fit() .centerCrop() .noFade() .placeholder(placeHolderRes) .into(this) } private class DucksCountAdapter( private val data: List&lt;Pair&lt;Duck, Int&gt;&gt;, private val onCountClickAction: (Pair&lt;Duck, Int&gt;) -&gt; Unit ) : RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() { override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder { val view = parent.context.inflate(R.layout.item_duck_count, parent) return CountViewHolder(view) } override fun getItemCount() = data.count() override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) { (holder as CountViewHolder).count.apply { val item = data[position] text = item.second.toString() setOnClickListener { onCountClickAction.invoke(item) } } } class CountViewHolder(view: View) : RecyclerView.ViewHolder(view) { val count: TextView = view.findViewById(R.id.count) } }</span></span></code> </pre> </div></div><br><p>  Ich denke, Sie verstehen es - ein solcher kleiner Haufen √§hnelt einer gesunden Entwicklung.  Und im Voraus gibt es immer mehr Anforderungen an den Kunden: ein Werbebanner ganz oben auf der Liste zu platzieren, die M√∂glichkeit zu erkennen, die Anzahl der bestellten Enten zu w√§hlen.  Nur diese Aufgaben werden letztendlich zu regul√§ren Adaptern, die wiederum von Grund auf neu geschrieben werden m√ºssen. </p><br><blockquote>  Der Prozess der Entwicklung eines klassischen Adapters in der Geschichte von <a href="">Github</a> </blockquote><br><h3 id="itogi">  Zusammenfassung </h3><br><p>  Tats√§chlich ist das Bild √ºberhaupt nicht ermutigend: Einzelne Adapter m√ºssen f√ºr bestimmte F√§lle gesch√§rft werden.  Wir alle wissen, dass es in einer realen Anwendung Dutzende oder sogar Hunderte solcher Listenbildschirme gibt.  Und sie enthalten keine Informationen √ºber Enten, sondern komplexere Daten.  Ja, und ihr Design ist viel komplizierter. </p><br><h3 id="chto-ne-tak-s-nashimi-adapterami">  Was ist los mit unseren Adaptern? </h3><br><ul><li>  offensichtlich sind sie schwer wiederzuverwenden; </li><li>  innerhalb der Gesch√§ftslogik erscheint und im Laufe der Zeit wird es immer mehr; </li><li>  schwer zu warten und zu erweitern; </li><li>  hohes Fehlerrisiko beim Aktualisieren von Daten; </li><li>  nicht offensichtliches Design. </li></ul><br><h2 id="glava-vtoraya-v-kotoroy-vse-moglo-byt-inache">  Kapitel zwei, in dem alles anders sein k√∂nnte </h2><br><p>  Es ist unrealistisch und sinnlos, sich die Entwicklung der Anwendung f√ºr die kommenden Jahre vorzustellen.  Nach ein paar solchen T√§nzen mit einem Tamburin wie im letzten Kapitel und dem Schreiben von Dutzenden von Adaptern wird jeder die Frage haben: ‚ÄûVielleicht gibt es andere L√∂sungen?‚Äú. </p><br><p><img src="https://habrastorage.org/webt/ct/6d/fx/ct6dfxsshhko-jfqycyqekpoqdu.jpeg"></p><br><p>  Nach Abschluss von Github haben wir <strong>festgestellt</strong> , dass die erste <strong>AdapterDelegates-</strong> Bibliothek im Jahr 2015 ver√∂ffentlicht wurde, und ein Jahr sp√§ter haben <strong>Groupie</strong> und <strong>Epoxy</strong> das Arsenal der Entwickler erweitert - sie alle tragen zur Erleichterung des Lebens bei, aber jede hat ihre eigenen Besonderheiten und Fallstricke. </p><br><blockquote>  Es gibt mehrere √§hnliche Bibliotheken (z. B. FastAdapter), aber weder ich noch meine Kollegen haben mit ihnen gearbeitet, sodass wir sie im Artikel nicht ber√ºcksichtigen werden. </blockquote><p>  Bevor wir die Bibliotheken vergleichen, analysieren wir kurz den oben beschriebenen Fall mit dem Online-Shop unter der Bedingung, dass <strong>AdapterDelegates verwendet wird.</strong> Von den zerlegten Bibliotheken ist er aus Sicht der internen Implementierung und Verwendung am einfachsten (er ist jedoch nicht in <strong>allen Bereichen</strong> fortgeschritten, sodass Sie viele Dinge von Hand hinzuf√ºgen m√ºssen). </p><br><p>  Die Bibliothek wird uns nicht vollst√§ndig aus dem Adapter retten, sondern aus Bl√∂cken (Bausteinen) bestehen, die wir sicher zur Liste hinzuf√ºgen oder daraus entfernen und austauschen k√∂nnen. </p><br><div class="spoiler">  <b class="spoiler_title">Blockadapter</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksDelegatesAdapter</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ListDelegationAdapter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">List&lt;DisplayableItem</span></span></span><span class="hljs-class">&gt;&gt;</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> { delegatesManager.addDelegate(RubberDuckDelegate()) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(items: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items = items notifyDataSetChanged() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RubberDuckDelegate</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AbsListItemAdapterDelegate</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RubberDuckItem, DisplayableItem, RubberDuckDelegate.ViewHolder</span></span></span><span class="hljs-class">&gt;</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isForViewType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">, items: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> RubberDuckItem } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = parent.context.inflate(R.layout.item_rubber_duck, parent, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(item) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">RubberDuckItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewHolder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, payloads: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { viewHolder.apply { rubberDuckImage.showIcon(item.icon) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span></span>(itemView: View) : RecyclerView.ViewHolder(itemView) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckImage: ImageView = itemView.findViewById(R.id.rubberDuckImage) } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Verwenden eines Aktivit√§tsadapters</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksDelegatesActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppCompatActivity</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ducksList: RecyclerView <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) setContentView(R.layout.activity_ducks_delegates) ducksList = findViewById(R.id.duckList) ducksList.apply { layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span><span class="hljs-symbol"><span class="hljs-symbol">@DucksDelegatesActivity</span></span>) adapter = createAdapter().apply { showData() } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: DucksDelegatesAdapter { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DucksDelegatesAdapter() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> DucksDelegatesAdapter.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { setData(getRubberDucks()) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRubberDucks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: List&lt;DisplayableItem&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DuckMockData.ducks.orEmpty().map { RubberDuckItem(it.icon) } } }</code> </pre> </div></div><br><p>  Ab der ersten Aufgabe sehen wir den Unterschied: Wir haben eine Adapterklasse, die von der Bibliothek erbt.  Und au√üerdem - derselbe Baustein, der als <strong>Delegat bezeichnet wird</strong> und von dem wir auch einen Teil der Logik erben und implementieren, die wir ben√∂tigen.  Als n√§chstes f√ºgen wir dem <strong>Manager</strong> einen Delegaten hinzu - dies ist auch eine Bibliotheksklasse.  Und das Letzte, was Sie brauchen, ist, einen Adapter zu erstellen und ihn mit Daten zu f√ºllen </p><br><p>  Um die zweite Kategorie des Gesch√§fts und der Header zu implementieren, werden wir ein paar weitere Delegaten schreiben, und die Animation wird dank der <strong>DiffUtil-</strong> Klasse <strong>angezeigt</strong> . </p><br><p>  Hier m√∂chte ich eine kurze, aber endg√ºltige Schlussfolgerung ziehen: Die Verwendung selbst dieser Bibliothek l√∂st alle aufgef√ºhrten Probleme, die aufgetreten sind, als wir die Anwendung in einem Fall mit einem Online-Shop kompliziert haben, aber nirgendwo anders ohne die Minuspunkte. </p><br><blockquote>  Adapterentwicklungsprozess mit AdapterDelegates im <a href="">Github-</a> Verlauf </blockquote><br><h2 id="glava-tretya-v-kotoroy-razrabotchik-snimaet-rozovye-ochki-sravniv-biblioteki">  Kapitel 3, in dem der Entwickler die rosa Brille durch Vergleichen der Bibliotheken entfernt </h2><br><p>  Wir werden detaillierter auf die Funktionalit√§t und den Betrieb jeder der Bibliotheken eingehen.  Auf die eine oder andere Weise habe ich alle drei Bibliotheken in unseren Projekten verwendet, abh√§ngig von den Aufgaben und der Komplexit√§t der Anwendung. </p><br><h3 id="adapterdelegateshttpsgithubcomsockeqweadapterdelegates">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Adapterdelegate</a> </h3><br><p><img src="https://habrastorage.org/webt/u9/9q/up/u99quph_ecf1su3ggudei9au6eg.gif" align="left">  Wir verwenden diese Bibliothek f√ºr die Anwendung einer der gr√∂√üten russischen Fluggesellschaften.  Wir mussten eine einfache Zahlungsliste durch eine Liste mit Gruppen und einer gro√üen Anzahl verschiedener Parameter ersetzen. </p><br><p>  Ein vereinfachtes Bibliotheksarbeitsschema sieht folgenderma√üen aus: <img src="https://habrastorage.org/webt/w6/mw/4s/w6mw4shsbgr6ndkpbwvhsyuvayo.jpeg"></p><br><p>  Die Hauptklasse ist der <strong>DelegateAdapter</strong> , die verschiedenen "Bausteine" sind die "Delegaten", die f√ºr die Anzeige eines bestimmten Datentyps und nat√ºrlich der Liste selbst verantwortlich sind. </p><br><h4 id="plyusy">  Vorteile: </h4><br><ul><li>  Einfachheit des Eintauchens; </li><li>  einfach wiederverwendbare Adapter; </li><li>  wenige Methoden und Klassen; </li><li>  Keine Reflexion, Codegenerierung und Datenbindung. </li></ul><br><h4 id="minusy">  Nachteile: </h4><br><ul><li>  Sie m√ºssen die Logik beispielsweise selbst implementieren <del>  Aktualisieren von Elementen √ºber DiffUti </del>  l (seit Version 3.1.0 k√∂nnen Sie den AsyncListDifferDelegationAdapter-Adapter verwenden); </li><li>  redundanter Code. </li></ul><br><blockquote>  Im Allgemeinen l√∂st diese Bibliothek alle Hauptschwierigkeiten bei der Erweiterung der Funktionalit√§t der Anwendung und ist f√ºr diejenigen geeignet, die die Bibliothek zuvor noch nicht verwendet haben.  Aber um nur damit aufzuh√∂ren, rate ich nicht. </blockquote><br><h3 id="groupiehttpsgithubcomlisawraygroupie">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Groupie</a> </h3><br><p><img src="https://habrastorage.org/webt/wm/ke/5w/wmke5wd9rsxtqknnr_jsdhn6m_s.gif" align="left">  Wir verwenden h√§ufig den <strong>Groupie</strong> , der vor einigen Jahren von <strong>Lisa Wray erstellt wurde</strong> , einschlie√ülich des Schreibens des Antrags f√ºr eine lettische Bank, der ihn vollst√§ndig verwendet. </p><br><p>  Um diese Bibliothek nutzen zu k√∂nnen, m√ºssen Sie <strong>sich zun√§chst mit Abh√§ngigkeiten befassen</strong> .  Zus√§tzlich zur Hauptoption k√∂nnen Sie aus mehreren Optionen ausw√§hlen: </p><br><ul><li>  Erweiterung f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kotlin Android Extensions</a> ; </li><li>  Erweiterung f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android Data Binding</a> ; </li><li>  beide. </li></ul><br><p>  Wir bleiben bei einer Sache und schreiben die notwendigen Abh√§ngigkeiten vor. </p><br><p>  Anhand eines Beispiels eines Online-Shops mit Enten m√ºssen wir ein von der Bibliotheksklasse geerbtes Element erstellen, das Layout angeben und die Bindung √ºber die Kotlin-Syntentik implementieren.  Verglichen mit der Menge an Code, die ich mit <strong>AdapterDelegates</strong> schreiben <strong>musste</strong> , ist es nur Himmel und Erde. </p><br><p>  Sie m√ºssen <strong>lediglich</strong> den RecyclerView <strong>GroupieAdapter</strong> als Adapter <strong>festlegen</strong> und die verspotteten Elemente darin <strong>ablegen</strong> . </p><br><p><img src="https://habrastorage.org/webt/3z/q9/wi/3zq9wiax9tufogfr6fx9cwipobe.jpeg"></p><br><p>  Es ist ersichtlich, dass das Arbeitsschema gr√∂√üer und komplexer ist.  Hier k√∂nnen Sie neben einfachen Elementen auch ganze Abschnitte verwenden - Gruppen von Elementen und andere Klassen. </p><br><h4 id="plyusy-1">  Vorteile: </h4><br><ul><li>  intuitive Benutzeroberfl√§che, obwohl API Sie zum Nachdenken anregt; </li><li>  das Vorhandensein von Boxl√∂sungen; </li><li>  Aufteilung in Gruppen von Elementen; </li><li>  die Wahl zwischen der √ºblichen Option, Kotlin Extensions und DataBinding; </li><li>  Einbetten von ItemDecoration und Animationen. </li></ul><br><h4 id="minusy-1">  Nachteile: </h4><br><ul><li>  unvollst√§ndiges Wiki; </li><li>  schlechte Unterst√ºtzung durch den Betreuer und die Gemeinde; </li><li>  kleine Fehler, die in der ersten Version umgangen werden mussten; </li><li>  im Hauptfaden unterschiedlich (vorerst); </li><li>  Es gibt keine Unterst√ºtzung f√ºr AndroidX (im Moment m√ºssen Sie das Repository √ºberwachen). </li></ul><br><p>  Es ist wichtig, dass <strong>Groupie</strong> mit all seinen Nachteilen <strong>AdapterDelegates</strong> problemlos ersetzen <strong>kann</strong> , insbesondere wenn Sie <strong>Faltlisten der</strong> ersten Ebene erstellen m√∂chten und nicht viel Boilerplate schreiben m√∂chten. </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Implementierung</a> der Entenliste mit Groupie </blockquote><br><h3 id="epoxyhttpsgithubcomairbnbepoxy">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Epoxid</a> </h3><br><p><img src="https://habrastorage.org/webt/te/fg/tt/tefgttnpx4qijjlckdpxtuqpucq.gif" align="left">  Die letzte Bibliothek, die wir vor relativ kurzer Zeit verwenden, ist <strong>Epoxy</strong> , das von den <strong>Airbnb-</strong> Leuten entwickelt wurde.  Die Bibliothek ist komplex, aber Sie k√∂nnen eine ganze Reihe von Aufgaben l√∂sen.  Airbnb-Programmierer selbst verwenden es, um Bildschirme direkt vom Server zu rendern.  <strong>Epoxy hat sich</strong> bei einem unserer neuesten Projekte als n√ºtzlich erwiesen - einer Bewerbung f√ºr eine Bank in Jekaterinburg. </p><br><p>  Um Bildschirme zu entwickeln, mussten wir mit verschiedenen Datentypen arbeiten, einer gro√üen Anzahl von Listen.  Und einer der Bildschirme war wirklich endlos.  Und <strong>Epoxy</strong> hat uns allen dabei geholfen. </p><br><p>  Das Prinzip der Bibliothek als Ganzes √§hnelt den beiden vorherigen, au√üer dass anstelle eines Adapters EpoxyController zum Erstellen der Liste verwendet wird, mit dem Sie die Struktur des Adapters deklarativ bestimmen k√∂nnen. </p><br><p><img src="https://habrastorage.org/webt/im/rk/rl/imrkrl2d6nnnoolqijk-_ubvkmg.jpeg"></p><br><p>  Um dies zu erreichen, basiert die Bibliothek auf der Codegenerierung.  Wie es funktioniert - mit all den Nuancen ist es im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wiki</a> gut beschrieben und spiegelt sich in den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispielen</a> wider. </p><br><h4 id="plyusy-2">  Vorteile: </h4><br><ul><li>  Modelle f√ºr die Liste, generiert aus der √ºblichen Ansicht, mit der M√∂glichkeit der Wiederverwendung in einfachen Bildschirmen; </li><li>  deklarative Beschreibung der Bildschirme; </li><li>  Datenbindung mit maximaler Geschwindigkeit - generiert Modelle direkt aus Layoutdateien; </li><li>  Zeigen Sie einfach nicht nur Listen aus den Bl√∂cken an, sondern auch komplexe Bildschirme. </li><li>  freigegebener ViewPool bei Aktivit√§t; </li><li>  asynchrones Diffing out of the Box (AsyncEpoxyController); </li><li>  Keine Notwendigkeit, mit horizontalen Listen zu d√§mpfen. </li></ul><br><h4 id="minusy-2">  Nachteile: </h4><br><ul><li>  viele Klassen, Prozessoren, Anmerkungen; </li><li>  schwieriger Tauchgang von Grund auf neu; </li><li>  verwendet das ButterKnife-Plugin, um R2-Dateien in Modulen zu generieren; </li><li>  Es ist sehr schwierig zu verstehen, wie man mit R√ºckrufen richtig arbeitet (wir selbst haben es noch nicht verstanden). </li><li>  Es gibt Probleme, die umgangen werden m√ºssen: Zum Beispiel Absturz mit derselben ID </li></ul><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Implementierung</a> der Entenliste mit Epoxy </blockquote><br><h2 id="itogi-1">  Zusammenfassung </h2><br><p>  Die Hauptsache, die ich vermitteln wollte, war: Lassen Sie sich nicht mit der Komplexit√§t abfinden, die auftritt, wenn Sie komplexe Listen erstellen und diese st√§ndig wiederholen m√ºssen.  Und das passiert sehr oft.  Und im Prinzip, wenn sie implementiert werden, wenn das Projekt gerade erst beginnt oder Sie sich mit dessen Umgestaltung befassen. </p><br><p>  Die Realit√§t ist, dass es nicht notwendig ist, die Logik noch einmal zu komplizieren, da wir glauben, dass eine Art von eigenen Abstraktionen ausreichen wird.  Sie sind kurz genug und die Arbeit mit ihnen ist nicht nur kein Vergn√ºgen, sondern es besteht auch die Versuchung, einen Teil der Logik auf den UI-Teil zu √ºbertragen, der nicht vorhanden sein sollte.  Es gibt Tools, mit denen Sie die meisten Probleme vermeiden k√∂nnen und die Sie verwenden m√ºssen. </p><br><blockquote>  Ich verstehe, dass dies f√ºr viele erfahrene (und nicht nur) Entwickler entweder offensichtlich ist oder sie mir nicht zustimmen.  Ich halte es jedoch f√ºr wichtig, dies noch einmal zu betonen. </blockquote><br><h2 id="tak-a-chto-vybrat-to">  Also, was soll ich w√§hlen? </h2><br><p>  Die Empfehlung, in einer Bibliothek zu bleiben, ist ziemlich schwierig, da die Wahl von vielen Faktoren abh√§ngt: von pers√∂nlichen Vorlieben bis zur Ideologie des Projekts. </p><br><p>  Ich w√ºrde folgendes tun: </p><br><ol><li>  Wenn Sie gerade erst mit der Entwicklung beginnen, versuchen Sie, mit <strong>AdapterDelegates</strong> <strong>ein kleines Projekt</strong> zu <strong>starten</strong> - dies ist die einfachste Bibliothek - es sind keine besonderen Kenntnisse erforderlich.  Sie werden verstehen, wie man damit arbeitet und warum es bequemer ist, als selbst Adapter zu schreiben. </li><li>  <strong>Groupie</strong> eignet sich f√ºr diejenigen, die bereits genug mit AdapterDelegates gespielt haben und es satt haben, ein paar Boilerplates zu schreiben, oder f√ºr <strong>alle anderen,</strong> die sofort mit einem Mittelweg beginnen m√∂chten.  Und vergessen Sie nicht, dass <strong>Gruppen aus dem Kasten heraus gefaltet werden</strong> - dies ist auch ein gutes Argument f√ºr sie. </li><li>  Nun, und <strong>Epoxy</strong> - f√ºr diejenigen, die mit einem wirklich komplexen Projekt mit einer gro√üen Datenmenge konfrontiert sind, ist die Komplexit√§t mit einer Fettbibliothek weniger problematisch.  Zuerst wird es schwierig sein, aber dann wird die Implementierung der Listen wie eine Kleinigkeit erscheinen.  Ein wichtiges Argument f√ºr Epoxy k√∂nnte das Vorhandensein von <strong>DataBinding</strong> und <strong>MVVM</strong> im Projekt sein - es wurde buchst√§blich daf√ºr erstellt, da die M√∂glichkeit besteht, Modelle aus den entsprechenden Layouts zu generieren. </li></ol><br><p>  Wenn Sie noch Fragen haben, k√∂nnen Sie √ºber den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> den Code unserer Anwendung mit den Details erneut anzeigen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428525/">https://habr.com/ru/post/de428525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428513/index.html">500 Laserpointer an einem Ort</a></li>
<li><a href="../de428515/index.html">Top 3D Shop: Wie wir uns im Laufe des Jahres ver√§ndert haben - Ergebnisse f√ºr 2018</a></li>
<li><a href="../de428517/index.html">GraphQL - API auf neue Weise</a></li>
<li><a href="../de428521/index.html">Warum gibt es keine Freunde auf GitHub. √úber Robbie Barrath, Offensichtlich und Copyright</a></li>
<li><a href="../de428523/index.html">ShadowCloud - universeller Cloud-Client</a></li>
<li><a href="../de428526/index.html">Google Steuer: 180 ¬∞ drehen</a></li>
<li><a href="../de428528/index.html">Warum Revolution√§re scharfes Essen m√∂gen oder wie Chili nach China kam</a></li>
<li><a href="../de428530/index.html">Die Ergebnisse der Untersuchung des Unfalls "Union MS-10"</a></li>
<li><a href="../de428532/index.html">HyperloopTT plant, im dritten Quartal 2019 die erste Hyperloop-Niederlassung zu er√∂ffnen</a></li>
<li><a href="../de428534/index.html">3D-Druckerbohrmaschine und PCAD-G-Code-Bohrkartenkonverter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>