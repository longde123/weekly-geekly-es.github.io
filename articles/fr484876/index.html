<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∑ üë©‚Äçüåæ üèß R√©parer, pirater, creuser. R√©soudre la qu√™te en ligne Droid Mission üë®üèª‚Äç‚úàÔ∏è üí§ üîê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'ann√©e derni√®re, nous avons men√© une qu√™te en ligne pour les d√©veloppeurs mobiles - Droid Mission. En un mois, les participants ont d√ª r√©soudre autan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>R√©parer, pirater, creuser. R√©soudre la qu√™te en ligne Droid Mission</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/484876/"><img src="https://habrastorage.org/webt/r_/ys/qs/r_ysqsq8esvuaug1phjeithvpji.png"><br><br>  L'ann√©e derni√®re, nous avons men√© une qu√™te en ligne pour les d√©veloppeurs mobiles - Droid Mission.  En un mois, les participants ont d√ª r√©soudre autant de probl√®mes que possible dans trois directions: r√©soudre le probl√®me!  (recherche de bogues et recherche de code), piratez-le!  (reverse engineering) et creusez-le!  (apprentissage des fonctionnalit√©s d'Android).  Au total, la qu√™te avait 23 t√¢ches - elles sont tr√®s similaires √† celles que les sp√©cialistes Android rencontrent dans le travail r√©el.  Dans le post, nous montrerons toutes les conditions et les bonnes solutions. <br><a name="habracut"></a><a name="start"></a><br><ul><li>  <a href="https://habr.com/ru/company/yandex/blog/484876/">Recherche d'erreurs et recherche de code</a> </li><li>  <a href="https://habr.com/ru/company/yandex/blog/484876/">R√©tro-ing√©nierie</a> </li><li>  <a href="https://habr.com/ru/company/yandex/blog/484876/">Syst√®me Android</a> </li></ul><br><a name="fix"></a><h1>  Recherche d'erreurs et recherche de code </h1><br><h3>  le r√©parer!  # 1 </h3>  <sup><i>Auteur: Anastasia Laushkina</i></sup> <br><br>  Par un calme vendredi soir, deux agents restent debout tard et m√®nent un diff√©rend insoluble.  On leur a demand√© de stocker une grande quantit√© de donn√©es secr√®tes dans une base de donn√©es Sqlite avec une cl√© de cl√© enti√®re. <br><br>  L'agent A cr√©e une table avec une requ√™te du formulaire: CREATE TABLE t (cl√© INT PRIMARY KEY, secret_value_1, secret_value_2), et l'agent B avec une requ√™te du formulaire CREATE TABLE t (key INTEGER PRIMARY KEY ASC, secret_value_1, secret_value_2). <br><br>  L'agent A est absolument s√ªr qu'il n'y a pas d'erreur dans sa demande, cependant, l'agent B a un argument contre cela: il pr√©tend que l'int√©grit√© des donn√©es lors de l'approche de l'agent A peut √™tre viol√©e. <br><br>  Liste avec une virgule: la ou les colonnes responsables de l'int√©grit√© de l'agent B, mais non responsables de l'agent A;  ainsi que la structure des donn√©es, en russe, gr√¢ce √† laquelle la demande de l'agent B sera plus rapide. <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  Format de r√©ponse: [nom de colonne 1], [nom de colonne N], [nom de structure] (sans crochets, avec une petite lettre) <br><br>  Exemple de r√©ponse: x, y, tableau </div></div><br>  <b>Solution</b> <br><br>  Il s'agit de rowId et de sa relation avec la cl√© primaire. <br><br>  Dans le cas de "CREATE TABLE t (key INTEGER PRIMARY KEY ASC, secret_value_1, secret_value_2)", la cl√© est un alias de rowId.  Dans le cas de "CREATE TABLE t (key INT PRIMARY KEY, secret_value_1, secret_value_2)" - non.  La raison peut √™tre trouv√©e <a href="https://www.sqlite.org/lang_createtable.html">dans la documentation</a> . <br><br>  Par cons√©quent, en l'absence d'une relation cl√© avec rowId, une requ√™te de la forme ¬´INSERT INTO t VALUES (" certains "," y "," z ")" sera ex√©cut√©e avec succ√®s, ce qui pourrait potentiellement violer l'int√©grit√© des donn√©es.  S'il existe une telle connexion, une erreur d'incompatibilit√© de type de donn√©es se produit. <br><br>  La r√©ponse a √©t√© consid√©r√©e comme une paire de cl√©s, rowId et key / rowId s√©par√©ment (car s'il y a une connexion, elles se r√©f√®rent √† la m√™me colonne). <br><br>  La vitesse est obtenue gr√¢ce au stockage sous la forme d'un arbre de recherche. <br><br><h3>  le r√©parer!  # 2 </h3>  <sup><i>Auteur: Anastasia Laushkina</i></sup> <br>  <a href="https://yadi.sk/d/CnFymdL9o6ib3A">Fichier binaire</a> <br><br>  Pour d√©tecter rapidement les ennemis, l'agent Kew d√©veloppe une application avec une liste de criminels connus.  Il a facilement r√©ussi √† afficher cette liste dans l'application, mais sur ce point, il d√©cide que ces informations importantes devraient √™tre sur l'√©cran principal. <br><br>  Pour ce faire, il a besoin d'un widget.  Un probl√®me: pour une raison quelconque, le widget n'affiche pas de liste.  Un instinct indique √† l'agent que le probl√®me n'est que sur une seule ligne. <br><br>  Nommez-le avec une virgule, ainsi que la ligne par laquelle vous devez le remplacer, afin d'obtenir la solution la plus optimale. <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  Format de r√©ponse: [ligne 1], [ligne 2] (sans crochets) <br><br>  Exemple de r√©ponse: FrameLayout, ScrollView </div></div><br>  <b>Solution</b> <br><br>  1. Nous recherchons le fichier de mise en page pour le widget, nous y voyons un √©l√©ment ConstraintLayout non valide (voir <a href="https://developer.android.com/guide/topics/appwidgets">developer.android.com/guide/topics/appwidgets#CreatingLayout</a> ). <br>  2. Changez-le en acceptable et optimal - LinearLayout / FrameLayout. <br><br>  Malgr√© le fait que l'utilisation de FrameLayout a bris√© la disposition des √©l√©ments dans le widget, cela a toujours √©t√© accept√© comme r√©ponse. <br><br><h3>  le r√©parer!  # 3 </h3>  <sup><i>Auteur: Artyom Viter</i></sup> <br>  <a href="https://yadi.sk/d/uzV_9MS2CyCXgg">Fichier binaire</a> <br><br>  Les testeurs ont remarqu√© une augmentation anormale de la consommation de RAM.  On soup√ßonne qu'il y a une fuite quelque part. <br><br>  Vous devez enqu√™ter et localiser le probl√®me.  Dans la r√©ponse, indiquez le nom de la m√©thode de la classe d'application et le lieu de son appel, ce qui entra√Æne une fuite de m√©moire.  Si vous rencontrez plusieurs probl√®mes, r√©pertoriez-les tous. <br><br>  Format de la r√©ponse: [Nom de la classe dans laquelle la m√©thode est appel√©e]: [num√©ro de ligne dans ce fichier]: [nom de la m√©thode] (sans crochets) <br><br>  Indiquez plusieurs r√©ponses dans l'ordre lexicographique, s√©par√©es par un #. <br><br>  Un exemple: <br><br>  Si vous pensez qu'il y a une fuite de m√©moire dans le fichier ExampleFileName.java, <br><br><pre><code class="plaintext hljs">class ExampleFileName {   public problemMethodName(Sting arg) {}   public test(Sting arg) {     problemMethodName(arg); //  8   ExampleFileName.java   } }</code> </pre> <br>  Exemple de r√©ponse: ExampleFileName: 8: problemMethodName <br><br>  <b>Solution</b> <br><br>  La premi√®re fa√ßon est l'analyse de code. <br><br><ol><li>  Nous √©tudions le code d'application. </li><li>  La premi√®re fuite est √©vidente.  Il s'agit d'un enregistrement BroadCastReceiver dans la classe SecondActivity.  Un message sur ce probl√®me peut √™tre vu dans logcat si vous ex√©cutez l'application. </li><li>  Si vous faites attention √† la m√©thode startTimer (), vous remarquerez que la classe CountDownTimer ajoute une fermeture au gestionnaire de thread principal avec un lien vers textView.  Et avant que l'activit√© ne soit d√©truite, la classe d'instance (CountDownTimer) n'appelle pas la m√©thode cancel ().  Il s'agit de la deuxi√®me fuite de m√©moire. </li></ol><br>  La deuxi√®me fa√ßon, ce sont les outils.  Vous pouvez impl√©menter la biblioth√®que <a href="https://github.com/square/leakcanary">leakcanary</a> dans l'application, obtenir un vidage de tas via adb ou android Profiler et analyser les rapports re√ßus.  Eclipse Memory Analyzer (MAT) peut vous aider avec l'analyse.  Pour ouvrir le heapdump dans MAT, vous devez le convertir dans un format compr√©hensible pour MAT √† l'aide de l'utilitaire hprof-convd. <br><br><h3>  le r√©parer!  # 4 </h3>  <sup><i>Publi√© par: Vali Ibragimov</i></sup> <br>  <a href="https://yadi.sk/d/X8HgqWEhCGUAvw">Fichier binaire</a> <br><br>  Ivan a son premier jour dans un cin√©ma en ligne.  Puisqu'il est un d√©veloppeur sympa, on lui a imm√©diatement demand√© de corriger le crash en regardant un film.  Il a d√©cid√© en m√™me temps de refactoriser.  Le code est devenu plus concis et plus propre, l'erreur a cess√© de se reproduire. <br><br>  Cependant, il s'est av√©r√© plus tard que la position actuelle du film n'a pas √©t√© envoy√©e au backend.  Aidez Ivan √† comprendre quelle classe il a m√©lang√©e. <br><br>  La r√©ponse est le nom de la classe √† utiliser. <br><br>  <b>Solution</b> <br><br>  Pour envoyer une position de visualisation toutes les cinq secondes et aller sur le r√©seau, ExecutorService est utilis√©.  Cr√©er un ScheduledThreadPoolExecutor pour une t√¢che p√©riodique, pensa Ivan - pourquoi ne pas l'utiliser pour aller sur le r√©seau?  Apr√®s tout, ScheduledThreadPoolExecutor est le descendant de ThreadPoolExecutor.  Ivan ne soup√ßonnait m√™me pas que ScheduledThreadPoolExecutor n'utilise qu'un seul thread, et lorsque vous vous connectez au r√©seau, vous devrez attendre la fin de la t√¢che p√©riodique. <br><br><pre> <code class="plaintext hljs">scheduleFuture = scheduledExecutorService.scheduleAtFixedRate(() -&gt; {                    try {                        timingsApi.sendTiming(filmId, player.getContentPosition()).get();                    } catch (Exception e) {                        e.printStackTrace();                    }                },                0, PERIOD_SECONDS, TimeUnit.SECONDS);</code> </pre> <br>  La solution au probl√®me a √©t√© encore compliqu√©e par le fait que nous n'acc√©dions pas √† ExoPlayer dans le thread d'interface utilisateur - et dans la nouvelle version 2.9. * ExoPlayer a commenc√© √† √©crire des avertissements √† ce sujet dans les journaux.  Mais maintenant, ce n'est qu'un avertissement, et non une erreur commise par Ivan. <br><br><h3>  le r√©parer!  # 5 </h3>  <sup><i>Auteur: Alexander Tsybin</i></sup> <br>  <a href="https://yadi.sk/d/GCLtHa4mKTK7YQ">Fichier binaire</a> <br><br>  Une entreprise d√©veloppait un jeu Farmer Simulator. <br><br>  Dans ce jeu, seul un joueur pouvait se d√©placer librement.  Tous les autres objets √©taient immobiles ou avaient une trajectoire de mouvement clairement d√©finie.  √Ä un moment donn√©, ils ont d√©cid√© d'ajouter des ennemis au jeu qui deviendraient un obstacle pour le joueur. <br><br>  Le d√©veloppeur Vasya a √©t√© charg√© de r√©aliser les ennemis.  Pendant l'impl√©mentation, Vasya a rencontr√© un probl√®me de performances.  Il a d√©cid√© de le r√©parer en raison du multithreading.  Comme Vasya n'√©tait pas familier avec le multithreading, il a profit√© des solutions de stackoverflow.  Il s'est donc d√©barrass√© des probl√®mes de performances. <br><br>  Cependant, au stade des tests, il a √©t√© constat√© que parfois le jeu se bloquait.  Aidez Vasya √† trouver la raison. <br><br>  En guise de r√©ponse, entrez les num√©ros des lignes de code probl√©matiques - s√©par√©s par des virgules, dans l'ordre croissant et sans espaces.  Comme ceci: 1,17,42 <br><br>  <b>Solution</b> <br><br>  Les types primitifs de boxe (par exemple int dans Integer) sont des op√©rations co√ªteuses.  √Ä des fins d'optimisation, les machines Java r√©utilisent parfois ces objets.  Les lignes ne font pas exception. <br><br>  Les lignes ENEMY_LOCK et DECISIONS_LOCK sont utilis√©es dans le code pour la synchronisation.  Par cons√©quent, s'il existe des emplacements dans le projet avec synchronisation sur les m√™mes lignes, un blocage peut se produire. <br><br>  En g√©n√©ral, vous ne pouvez pas utiliser String / Integer, etc., pour la synchronisation. <br><br>  R√©ponse: 7.8 <br><br><h3>  le r√©parer!  # 6 </h3>  <sup><i>Auteur: Ivan Pukhov</i></sup> <br>  <a href="https://yadi.sk/d/qR6iYnUBvB9n2w">Fichier binaire</a> <br><br>  L'√©quipe de traitement d'image a publi√© une nouvelle biblioth√®que native, vous devez l'essayer et signaler les probl√®mes, le cas √©ch√©ant. <br><br>  <b>Solution</b> <br><br>  C'est une t√¢che facile √† r√©chauffer.  Dans les ressources se trouve la biblioth√®que elle-m√™me et le fichier d'en-t√™te correspondant.  Dans l'en-t√™te, seule fonction renvoyant un jobject. <br><br>  Il ne reste plus qu'√† cr√©er un projet de test (en installant NDK) et √† l'appeler!  Un appel de fonction sur le thread principal l√®vera une exception demandant de ne pas l'appeler de cette fa√ßon.  Nous transf√©rons l'ex√©cution √† un autre thread de quelque mani√®re que ce soit - et tout fonctionne. <br><br>  Maintenant, cela vaut la peine de v√©rifier l'objet retourn√© - est-ce vraiment une image bitmap?  Le moyen le plus simple consiste √† l'afficher imm√©diatement sur une ImageView.  Nous verrons une image avec une cha√Æne de texte, et la t√¢che n√©cessite √©galement une r√©ponse sous la forme d'une cha√Æne.  Ce n'est probablement pas une simple co√Øncidence.  :) <br><br><h3>  le r√©parer!  # 7 </h3>  <sup><i>Auteur: Dmitry Zaitsev</i></sup> <br>  <a href="https://yadi.sk/d/sqQgkbbjDu1UNw">Fichier binaire</a> <br><br>  Il existe une application avec des codes o√π le code souhait√© est encadr√©.  Malheureusement, la mise en page a √©t√© bris√©e et doit √™tre restaur√©e pour trouver le code. <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  Apr√®s avoir corrig√© le code, le cadre passera par exactement 22 caract√®res qui doivent √™tre r√©pertori√©s dans le sens antihoraire, en commen√ßant par le coin sup√©rieur gauche du cadre. <br><br>  Exemple de r√©ponse: ScQG1jxbazmjbcARefbRMo </div></div><br>  <b>Solution</b> <br><br>  Maintenant, Dagger est devenu la norme de facto dans le d√©veloppement Android.  Lorsque la DI est d√©j√† configur√©e, il est tr√®s simple d'√©crire Inject devant le constructeur et de donner tout le reste du travail √† Dagger.  C'est si facile que vous pouvez plus tard cesser de penser √† la fa√ßon dont les d√©pendances sont fournies.  Toujours dans Android, vous devez souvent travailler avec la classe Context et ses descendants: Application et Activit√©.  L'application est li√©e au cycle de vie de l'application et l'activit√© est li√©e au cycle de vie de l'√©cran.  Par cons√©quent, en travaillant avec ces classes, il est important d'observer de nombreuses fonctionnalit√©s.  La t√¢che est pr√©cis√©ment bas√©e sur l'utilisation du mauvais contexte, et tout cela est d√©guis√© en utilisant DI. <br><br>  Pour r√©soudre, vous pouvez effectuer les √©tapes suivantes: <br><br><ol><li>  Examinez les fichiers du projet et notez que ItemStyle est appliqu√© √† tous les TextViews. </li><li>  Voyez que le style n'est pas vraiment appliqu√©.  Cela devrait conduire √† l'id√©e que le probl√®me est li√© au sujet, et donc au contexte de l'activit√©. </li><li>  Comprenez le graphique des d√©pendances et comprenez que le contexte d'application est fourni dans l'adaptateur. </li><li>  Dans ContestAdapter, changez le type de contexte en Activity. </li></ol><br><h3>  le r√©parer!  # 8 </h3>  <sup><i>Publi√© par: Vali Ibragimov</i></sup> <br>  <a href="https://yadi.sk/d/mgEetgsZNwtvRA">Fichier binaire</a> <br><br>  Ivan a √©t√© charg√© de refactoriser l'application pour obtenir une liste de t√¢ches via ContentProvider √† l'aide de DI.  Il a refactoris√© l'application √† l'aide de Dagger, et lorsqu'elle a d√©marr√©, l'application a commenc√© √† planter. <br><br>  Aidez Ivan √† comprendre la raison: <br><br><ol><li>  Sp√©cifiez le num√©ro de ligne avec le nom de classe que vous souhaitez transf√©rer vers une autre classe. </li><li>  Fournissez un lien vers la documentation avec une ancre vers un emplacement qui vous aidera √† comprendre pourquoi l'application se bloque. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  Format de r√©ponse: [Nom de classe]: [Num√©ro de ligne] -&gt; [Nom de classe]: [Num√©ro de ligne], [Lien] <br><br>  Exemple de r√©ponse: <br><br>  FirstCLass: 12-&gt; SecondClass: 45, https: //developer.android.com/reference/android/app/Activity#activity-lifecycle </div></div><br>  <b>Solution</b> <br><br>  La t√¢che se composait de deux parties: <br><br>  1. Comprendre et fournir une solution de plantage dans ContentProvider lors de l'acc√®s au composant DI.  La bonne solution √©tait de transf√©rer l'initialisation du composant DI au ContentProvider. <br><br><img src="https://habrastorage.org/webt/fu/nr/n_/funrn_gbeansq3bwonjrrsaknoc.png" width="800"><br><br>  La m√©thode onCreate sur ContentProvider est appel√©e plus t√¥t que sur Application.  Ceci est facile √† v√©rifier si vous examinez le code de d√©marrage de l'application dans la classe ActivityThread et la m√©thode handleBindApplication. <br><br><img src="https://habrastorage.org/webt/r9/xk/vr/r9xkvrg0kjjiefi0xtruxlvnhwm.png" width="620"><br><br>  2. Fournissez un lien d√©crivant que onCreate pour ContentProvider est appel√© plus t√¥t que pour Application.  Google ne le mentionne pas sur la page de documentation ContentProvider.  Mais voici un extrait de la description de la m√©thode onCreate Aplication: <br><br><blockquote>  Appel√© au d√©marrage de l'application, avant la cr√©ation de toute activit√©, service ou objet r√©cepteur (√† l'exception des fournisseurs de contenu). </blockquote><br><h3>  le r√©parer!  # 9 </h3>  <sup><i>Auteur: Alexander Tsybin</i></sup> <br>  <a href="https://yadi.sk/d/-V1nSeMxB3K6aw">Fichier binaire</a> <br><br>  Le d√©veloppeur a √©t√© charg√© d'impl√©menter la vue pour une liste d'√©l√©ments.  Dans les savoirs traditionnels, il y avait une exigence importante - faire d√©filer la liste jusqu'au premier et au dernier √©l√©ment afin que ces √©l√©ments apparaissent au centre de l'√©cran.  Le d√©veloppeur a impl√©ment√© la fonctionnalit√©, mais lors des tests, il s'est av√©r√© que parfois le centrage ne fonctionne pas.  Aidez le d√©veloppeur √† trouver les lignes probl√©matiques dans le code. <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  Format de r√©ponse: <br><br>  &lt;Nom de fichier sans extension&gt;: &lt;Num√©ros de ligne s√©par√©s par des virgules&gt; <br><br>  &lt;Nom de fichier sans extension&gt;: &lt;Num√©ros de ligne s√©par√©s par des virgules&gt; <br><br>  Les lignes doivent √™tre tri√©es par ordre lexicographique.  Les num√©ros de ligne doivent √™tre tri√©s par ordre croissant. <br><br>  Exemple de r√©ponse: <br><br>  BarFoo: 1 <br><br>  FooBar: 12,13,14,99 </div></div><br>  <b>Solution</b> <br><br>  Il y a deux probl√®mes dans le code: <br><br>  1. √Ä en juger par le code, il est suppos√© que l'appel √† onViewDetachedFromWindow se produira toujours apr√®s onBindViewHolder, mais ce n'est pas le cas.  La m√©thode double pour onViewDetachedFromWindow est onViewAttachedToWindow.  Par cons√©quent, holder.view.reset () est appel√© et le centrage dispara√Æt si le d√©filement est lent. <br><br>  2. Sur Android avant la version 7, addView (rootView, params) ne fonctionne pas comme pr√©vu. <br><br>  Lorsque vous ajoutez une vue, un LayoutParam est g√©n√©r√©, qui ressemble √† ceci: <br><br>  Guimauve - <a href="">github.com/aosp-mirror/platform_frameworks_base/blob/marshmallow-release/core/java/android/widget/FrameLayout.java#L403</a> <br>  Nougat - <a href="">github.com/aosp-mirror/platform_frameworks_base/blob/nougat-release/core/java/android/widget/FrameLayout.java#L384</a> <br><br>  FrameLayout.LayoutParams a deux constructeurs, dont l'un accepte ViewGroup.MarginLayoutParams et copie les marges en lui-m√™me: <a href="">github.com/aosp-mirror/platform_frameworks_base/blob/nougat-release/core/java/android/view/ViewGroup.java#L14</a> <br><br>  Le deuxi√®me constructeur accepte ViewGroup.LayoutParams et ignore les marges: <a href="">github.com/aosp-mirror/platform_frameworks_base/blob/nougat-release/core/java/android/view/ViewGroup.java#L7328</a> <br><br>  Par cons√©quent, le centrage ne fonctionne pas sur Android jusqu'√† la version 7. <br><br>  La r√©ponse est: <br>  ItemView: 35 <br>  Activit√© principale: 53 <br><br><a name="hack"></a><h1>  R√©tro-ing√©nierie </h1><br><h3>  piratez-le!  # 1 </h3>  <sup><i>Auteur: Valentin Baryshev</i></sup> <br>  <a href="https://yadi.sk/d/7SXNXpKzadxR9A">Fichier binaire</a> <br><br>  Un d√©veloppeur s'est pr√©cipit√© et n'a m√™me pas test√© le .apk final avant de se soumettre au concours. <br><br>  Il s'est av√©r√© qu'il a m√©lang√© un groupe de vues dans activity_main.xml.  De plus, il a plac√© chaque lettre de la cl√© dans une vue texte distincte.  En cons√©quence, toutes les vues sur la mise en page se sont s√©par√©es et il y a une indignation totale √† l'√©cran. <br><br>  Essayez de d√©terminer quel groupe de vues doit √™tre √† la place des groupes actuels. <br><br>  La r√©ponse au probl√®me est le code qui appara√Æt √† l'√©cran apr√®s avoir remplac√© le groupe de vues correct. <br><br>  <b>Solution</b> <br><br>  Il est n√©cessaire de d√©compiler .apk de n'importe quelle mani√®re disponible (par exemple, par des d√©compilateurs en ligne) et de recr√©er le projet par code. <br><br>  Si nous analysons main_layout, nous pouvons deviner √† partir des attributs que le groupe de vues racine doit √™tre ConstraintLayout. <br><br>  R√©ponse: tniartsnoc <br><br><h3>  piratez-le!  # 2 </h3>  <sup><i>Auteur: Alexander Tsybin</i></sup> <br>  <a href="https://yadi.sk/d/PAuLY9-7Is5iYg">Fichier binaire</a> <br><br>  Un utilisateur exp√©riment√© a bloqu√© l'application.  Il n'a pas √©t√© surpris, a ouvert les journaux, a trouv√© la ligne √† l'origine de l'erreur: N72XbphDx5NnFl6CKMNl8w == et l'a envoy√©e au support technique. <br><br>  Il s'est av√©r√© qu'il utilisait une version obsol√®te de l'application, qui avait √©t√© d√©velopp√©e avant d'utiliser des r√©f√©rentiels de code, de sorte que le code de d√©chiffrement a √©t√© perdu.  Cependant, il √©tait possible de trouver le .apk de l'ancienne version de l'application. <br><br>  Aidez √† d√©chiffrer le message. <br><br>  <b>Solution</b> <br><br>  Il est n√©cessaire de d√©compiler .apk de n'importe quelle mani√®re disponible (par exemple, par des d√©compilateurs en ligne) et de recr√©er le projet par code. <br><br>  Le code lui-m√™me contient √† la fois la fonction de cryptage et la fonction de d√©cryptage, √† laquelle vous pouvez donner la cha√Æne crypt√©e et obtenir une r√©ponse. <br><br>  La r√©ponse est: <br>  TF: Bon travail! <br><br><h3>  piratez-le!  # 3 </h3>  <sup><i>Auteur: Valentin Baryshev</i></sup> <br>  <a href="https://yadi.sk/d/hRZM_Yc8hf5FOg">Fichier binaire</a> <br><br>  Connaissez-vous bien le cycle de vie d'une application Android? <br><br>  Saviez-vous que dans certains cas, le syst√®me peut tuer le processus de demande? <br><br>  Simulez cette situation sur l'application. <br><br>  Vous verrez la r√©ponse apr√®s avoir restaur√© l'application - sous forme de code. <br><br>  <b>Solution</b> <br><br>  Il suffisait d'installer .apk sur le t√©l√©phone, d'ex√©cuter et d'obtenir le bo√Ætier lorsque le syst√®me d√©charge l'application, mais en m√™me temps, il reste dans le rideau. <br><br>  Une option consiste √† installer l'application, √† la lancer et √† la r√©duire (ou simplement √† passer √† une autre application).  Ensuite, nous nous connectons via adb √† l'ordinateur.  Dans Android Studio, s√©lectionnez l'onglet Logcat, s√©lectionnez le processus de cette application et cliquez sur l'ic√¥ne d'arr√™t rouge.  Ouvrez ensuite l'application pr√©c√©demment r√©duite du rideau.  L'√©cran affichera la r√©ponse: sss2384gxcxxX. <br><br><h3>  piratez-le!  # 4 </h3>  <sup><i>Auteur: Ivan Pukhov</i></sup> <br>  <a href="https://yadi.sk/d/RwxPtc4Z-EwCLg">Fichier binaire</a> <br><br>  Un coll√®gue front-end a post√© une d√©mo du nouveau module, mais a oubli√© d'envoyer des sp√©cifications.  Maintenant, il dort dans un fuseau horaire diff√©rent, et une d√©mo doit √™tre faite en quelques minutes.  Lors d'une conversation avec un coll√®gue, vous vous souvenez de sa phrase "Oui, c'est facile l√†-bas, il vous suffit d'√©crire des talons et cela fonctionnera." <br><br>  T√©l√©chargez l'archive et essayez de vous en sortir sans coll√®gue. <br><br>  <b>Solution</b> <br><br>  C'est une t√¢che simple, mais elle n√©cessite de la curiosit√© et de la pers√©v√©rance. <br><br>  T√©l√©chargez l'archive, t√©l√©chargez son contenu sur le serveur de test local, cr√©ez un projet avec WebView et ex√©cutez-le.  Apr√®s un court d√©lai, nous voyons le message ¬´Calibrer l'orientation¬ª.  Et c'est tout.  Mais le message sugg√®re que vous devriez peut-√™tre tourner le t√©l√©phone entre vos mains?  Apr√®s cela, un message suspect sur l'exception lev√©e sera affich√© - avec un appel pour v√©rifier la sortie de la console. <br><br>  Nous ouvrons la console et voyons un appel √† une m√©thode inexistante sur l'objet API.  Nous ajoutons un objet √† WebView pour impl√©menter l'API JS et essayons √† nouveau de tester l'application. <br><br>  Apparemment, cela vaut la peine d'ajouter une valeur de retour.  Nous s√©lectionnons, ajoutons - cela fonctionne.  Mais il n'y a de ligne avec la r√©ponse nulle part.  Tournez √† nouveau le t√©l√©phone - une nouvelle m√©thode est appel√©e.  Ajoutez-le √©galement.  Apr√®s plusieurs it√©rations, nous obtenons l'appel finalizeCalibrating puis storeResult, dans lequel notre ligne arrivera. <br><br>  Lors du t√©l√©chargement de la source, vous pouvez ne rien vouloir r√©soudre, mais ouvrez-les et retirez la r√©ponse.  Cette m√©thode fonctionne, mais quelques petits r√¢teaux vous attendent en cours de route. <br><br><h3>  piratez-le!  # 5 </h3>  <sup><i>Auteur: Ivan Pukhov</i></sup> <br><br>  L'assemblage de d√©veloppement de la nouvelle version d'Android a fuit√© sur le r√©seau, sur lequel le nouveau m√©canisme de signature d'application a √©t√© d√©bogu√© directement sur l'appareil.  Dans cet assemblage, la cl√© priv√©e de signature est cousue dans le code source du syst√®me et les d√©veloppeurs ont laiss√© des parties de l'interface utilisateur pour la recevoir.  Trouvez la cl√©. <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  Format de r√©ponse: cha√Æne de 32 caract√®res <br><br>  <a href="https://yadi.sk/d/vnDrXgDqJd8v7g">T√©l√©charger la condition de t√¢che (Mac OS X)</a> <br><br>  <a href="https://yadi.sk/d/ZuE2fORiMbbG7A">T√©l√©charger la condition de t√¢che (Windows)</a> <br><br>  <a href="https://yadi.sk/d/WxiBCxrVeIzIrg">T√©l√©charger la condition de t√¢che (Linux)</a> </div></div><br>  <b>Solution</b> <br><br>  1. Lorsque vous ex√©cutez l'√©mulateur, vous remarquerez l'application SecretActivity.  Si vous l'ouvrez, un toast appara√Æt, vous proposant de consulter les journaux.  Puisqu'il s'agit d'un assembly de d√©bogage, il existe de nombreux journaux - ils doivent √™tre filtr√©s par le nom de l'application. <br><br><pre> <code class="bash hljs">adb logcat | grep <span class="hljs-string"><span class="hljs-string">'SecretActivity'</span></span></code> </pre> <br> <code>1898 1898 E SecretActivity: Try broadcast ZggwxXsaQ9SapPKyHpnwnYmALHazVFWX</code> <br> <br>  2. Nous essayons de lancer une diffusion avec action √† partir du journal: <br><br><pre> <code class="bash hljs">adb shell am broadcast -a ZggwxXsaQ9SapPKyHpnwnYmALHazVFWX</code> </pre> <br>  3. Un toast appara√Ætra √† l'√©cran avec une proposition pour voir les journaux par la balise SecretReceiver. <br><br><pre> <code class="bash hljs">adb logcat | grep <span class="hljs-string"><span class="hljs-string">'SecretReceiver'</span></span></code> </pre> <br> <code>1898 1898 E SecretReceiver: ISecretService.aidl <br> 1898 1898 E SecretReceiver: package android.app; <br> 1898 1898 E SecretReceiver: interface ISecretService { <br> 1898 1898 E SecretReceiver: String getSecret(); <br> 1898 1898 E SecretReceiver: } <br> 1898 1898 E SecretReceiver: See global settings to bind SecretService</code> <br> <br>  4. Nous examinons les param√®tres globaux pour trouver une action pour se connecter √† SecretService. <br><br><pre> <code class="bash hljs">adb shell settings list global</code> </pre> <br> <code>... <br> bind_secret_service_action=g8mNyGQZR8aHLTXNWcjdwJJYZ85Ewx83 <br> ...</code> <br> <br>  5. Nous √©crivons un client pour le service ISecretService en utilisant cette interface aidl. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(); intent.setAction(<span class="hljs-string"><span class="hljs-string">"g8mNyGQZR8aHLTXNWcjdwJJYZ85Ewx83"</span></span>); PackageManager pm = getPackageManager(); List&lt;ResolveInfo&gt; resolveInfoList = pm.queryIntentServices(intent, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (resolveInfoList == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || resolveInfoList.size() != <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } ResolveInfo serviceInfo = resolveInfoList.get(<span class="hljs-number"><span class="hljs-number">0</span></span>); ComponentName component = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ComponentName(serviceInfo.serviceInfo.packageName, serviceInfo.serviceInfo.name); Intent explicitIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(intent); explicitIntent.setComponent(component); bindService(explicitIntent, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceConnection() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onServiceConnected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ComponentName name, IBinder service)</span></span></span><span class="hljs-function"> </span></span>{ ISecretService secretService = ISecretService.Stub.asInterface(service); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Log.d(<span class="hljs-string"><span class="hljs-string">"MainActivity"</span></span>, secretService.getSecret()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Log.e(<span class="hljs-string"><span class="hljs-string">"MainActivity"</span></span>, <span class="hljs-string"><span class="hljs-string">"RemoteException"</span></span>, e); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onServiceDisconnected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ComponentName name)</span></span></span><span class="hljs-function"> </span></span>{ } }, Context.BIND_AUTO_CREATE); } }</code> </pre> <br>  6. Ex√©cutez, dans les journaux, nous obtenons la r√©ponse: <br><br><pre> <code class="bash hljs">adb logcat | grep <span class="hljs-string"><span class="hljs-string">'MainActivity'</span></span></code> </pre> <br> <code>1898 1898 E MainActivity: VENHz=qWr7y!t3ZhP!8Skw!!kcTkt7V%</code> <br> <br><h3>  piratez-le!  # 6 </h3>  <sup><i>Auteur: Pavel Vorobkalov</i></sup> <br>  <a href="https://yadi.sk/d/V1ipafbw9EJjQA">Fichier binaire</a> <br><br>  M. Tupper a √©crit une application Android qui envoie des messages. <br><br>  D√©chiffrez le message et continuez. <br><br>  Format de r√©ponse: cha√Æne sous forme de lien. <br><br>  <b>Solution</b> <br><br>  Installez et ex√©cutez l'application sur l'appareil.  Nous voyons deux boutons: Envoyer un message et Envoyer une formule.  Lorsque vous cliquez dessus, rien de visible ne se produit.  Vous devez d√©terminer comment et o√π l'application envoie quelque chose. <br><br><img src="https://habrastorage.org/webt/d7/1k/ea/d71kea2oipwhydwmurf5hroelpy.png" width="300"><br><br>  Nous ouvrons les applications .apk en utilisant certains moyens de r√©tro-ing√©nierie et examinons l'activit√© principale.  Vous pouvez y voir les m√©thodes onSendMessageClick et onSendFormulaClick.  Ils cr√©ent un Intent avec l'action "com.yandex.tupper.action.NEW_MESSAGE" et en plus avec la cl√© "com.yandex.tupper.message" et l'envoient aux applications √† partir de la liste (en utilisant la m√©thode g√©n√©rale).  Ils obtiennent la liste en appelant PackageManager.queryBroadcastReceivers. <br><br>  Vous pouvez continuer √† utiliser des outils d'ing√©nierie inverse pour √©tudier le message en l'extrayant du code de l'application.  Mais ce chemin est intentionnellement (quoique l√©g√®rement) compliqu√© par un cryptage RSA suppl√©mentaire. <br><br>  Il existe un autre moyen qui correspond mieux √† la programmation Android.  Vous devez √©crire une application qui g√®re cette intention de diffusion.  Nous cr√©ons notre application, dans le r√©cepteur du registre des manifestes: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".TupperMessageReceiver"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:exported</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.yandex.tupper.action.NEW_MESSAGE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Dans le gestionnaire, nous recevons le message de extra et ex√©cutons notre propre activit√©, dans laquelle nous afficherons le r√©sultat du traitement: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TupperMessageReceiver</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BroadcastReceiver</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, Intent intent)</span></span></span><span class="hljs-function"> </span></span>{ String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (message == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Intent activityIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, MainActivity.class); activityIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); activityIntent.putExtra(MainActivity.EXTRA_MESSAGE, message); context.startActivity(activityIntent); } }</code> </pre> <br>  Voyons maintenant le d√©chiffrement du message lui-m√™me.  Si vous recherchez dans Yandex le ¬´message de Tupper¬ª, vous pouvez trouver <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D0%25BC%25D1%2583%25D0%25BB%25D0%25B0_%25D0%25A2%25D0%25B0%25D0%25BF%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B0">un article</a> sur la formule de Wupper pour la formule de Tupper.  Il pr√©sente un exemple de formule cod√©e sous la forme d'un nombre: <br><br><div class="spoiler">  <b class="spoiler_title">48584 ...</b> <div class="spoiler_text"><pre><code class="plaintext hljs">4858450636189713423582095962494202044581400587983244549483093085061934704708809928450644769865524364849997247024915119110411605739177407856919754326571855442057210445735883681829823754139634338225199452191651284348332905131193199953502413758765239264874613394906870130562295813219481113685339535565290850023875092856892694555974281546386510730049106723058933586052544096664351265349363643957125565695936815184334857605266940161251266951421550539554519153785457525756590740540157929001765967965480064427829131488548259914721248506352686630476300</code></pre></div></div><br>  Ce num√©ro est envoy√© sous forme de message en cliquant sur le bouton Envoyer la formule.  Le r√©sultat du d√©codage du num√©ro est √©galement dans l'article Wikipedia.  Il peut √™tre utilis√© pour d√©boguer sa mise en ≈ìuvre de l'algorithme de d√©codage. <br><br>  Nous impl√©mentons l'algorithme de d√©codage en Java et, pour des raisons de beaut√©, convertissons le nombre binaire r√©sultant en un bitmap monochrome: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TupperCodec</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TUPPER_R = <span class="hljs-number"><span class="hljs-number">17</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TupperCodec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> BigInteger </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decodeFromDecString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String decString)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> NumberFormatException </span></span>{ BigInteger data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger(decString, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.divide(BigInteger.valueOf(TUPPER_R)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNumberAsBinImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BigInteger number)</span></span></span><span class="hljs-function"> </span></span>{ String binString = number.toString(<span class="hljs-number"><span class="hljs-number">2</span></span>); StringBuffer result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuffer(binString.length()); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; binString.length(); i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((i % TUPPER_R) == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { result.append(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>); } result.append(binString.charAt(binString.length() - <span class="hljs-number"><span class="hljs-number">1</span></span> - i)); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numberOfRows = (binString.length() + TUPPER_R - <span class="hljs-number"><span class="hljs-number">1</span></span>) / TUPPER_R; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; i &lt; numberOfRows * TUPPER_R; i++) { result.append(~_~quot&amp;#<span class="hljs-number"><span class="hljs-number">0</span></span>;quot~_~); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.toString(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Bitmap </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBinImageAsBitmap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String binImage)</span></span></span><span class="hljs-function"> </span></span>{ String[] lines = binImage.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] colors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[lines.length * TUPPER_R]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; lines.length; i++) { String line = lines[i]; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> line.length() == TUPPER_R; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; line.length(); j++) { colors[i * TUPPER_R + j] = line.charAt(j) == <span class="hljs-string"><span class="hljs-string">'0'</span></span> ? Color.WHITE : Color.BLACK; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Bitmap.createBitmap(colors, TUPPER_R, lines.length, Bitmap.Config.ARGB_8888); } }</code> </pre> <br>  Dans Activity, appelez le d√©codage et affichez le r√©sultat sous forme de bitmap dans ImageView: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String EXTRA_MESSAGE = <span class="hljs-string"><span class="hljs-string">"com.yandex.tupper.message"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Intent intent = getIntent(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intent != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; intent.hasExtra(MainActivity.EXTRA_MESSAGE)) { String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { BigInteger data = TupperCodec.decodeFromDecString(message); String binImage = TupperCodec.getNumberAsBinImage(data); Bitmap bitmap = TupperCodec.getBinImageAsBitmap(binImage); ImageView imageView = findViewById(R.id.message_image); imageView.setImageBitmap(bitmap); CharSequence toastText = TextUtils.ellipsize(message, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextPaint(), <span class="hljs-number"><span class="hljs-number">400</span></span>, TextUtils.TruncateAt.END); Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, toastText, Toast.LENGTH_SHORT).show(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (NumberFormatException ex) { Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, getString(R.string.invalid_message), Toast.LENGTH_LONG).show(); } } } }</code> </pre> <br><img src="https://habrastorage.org/webt/zf/ji/7b/zfji7bvxc9uz3avkrwqz65hc7lo.png" width="300"><br>  <b><sup><sub>Capture d'√©cran du message d√©cod√©</sub></sup></b> <br><br>  La r√©ponse est <a href="https://clck.ru/FevR5">clck.ru/FevR5</a> . <br><br><h3>  piratez-le!  # 7 </h3>  <sup><i>Auteur: Igor Eremeev</i></sup> <br>  <a href="https://yadi.sk/d/YlXQWIwlo8VGmw">Fichier binaire</a> <br><br>  Il est n√©cessaire de casser l'algorithme de v√©rification des cl√©s dans l'application. <br><br>     .    ,           ,    . <br><br>  :      -    . <br><br>  <b>Solution</b> <br><br>  .apk  zip-     classes.dex ‚Äî  Java-  .         , ,  dex2jar  Android Studio. dex2jar  Java-,    Android Studio        class-.     ,   . <br><br>    ,     proguard ( android.support.*  androidx.*,    ), ‚Äî  com.yandex.contest.keygenme.MainActivity, Activity  . ,       : MainActivity.a#doInBackground   bbaab   b     ,   . <br><br><img src="https://habrastorage.org/webt/6d/sa/vb/6dsavb2ct67ou-f8hknj6c7twpy.png"><br><br>   c  d.        N-    œÄ ( --),        .     ,  œÄ <sub>hexed</sub> [c[i] + key[i]] = d[i], i = 0..11.    ,     .            50  hex-  œÄ.  : 537306089144.         key_2056BE33E064. <br><br>            ,    ,       ‚Äî  .     doInBackground: <br><br><img src="https://habrastorage.org/webt/4o/io/62/4oio62zqs03jzqonptpka1tb_rs.png"><br><br> ,       ,       if (var12[0] == var8) {‚Ä¶ }.  var7    ‚Äî  i-   .    ,   var7      0  9           .    .    ,    .apk (      JVM)   . <br><br><h3> hack it! #8 </h3> <sup><i>:  </i></sup> <br> <a href="https://yadi.sk/d/rRQuDjMq7f6Z_A"> </a> <br><br>      N   ,        .    :   Android  4.4,    1200 √ó 600,        FM-.    ,       ,  FM-    .     FM-        ,      . <br><br>          ,        FM-.            . <br><br>       ,     : <br><br> 1.     106.00  <br> 2.  (seek)    <br> 3. ,    <br><br>  ,    . <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text">  :            .        . <br><br>  : ,   a(106.00)     106.00 ,  b(true)   ,   c()  ,     a(106.00);b(true);c() </div></div><br>  <b>Solution</b> <br><br>  :  ,   FM-  .    .apk   dex-.       Java.  ,   ,    ‚Äî jadx. <br><br>   .apk,     .      MainActivity.   : fragment_holder   RadioFullFragment   .    .      RadioFullPresenter,  ChangeRadioFrequencyUsecase,       RadioRepo.   . <br><br>     ¬´implements RadioRepo¬ª.  : RadioRepoImpl.  ,      b. ServiceConnection ‚Äî    . ,   b    lambda$new$0$RadioRepoImpl. ,   $$Lambda$RadioRepoImpl$FYTR9gAgZEGvrLjkbkpAIup7OKw,     serviceConnection  IRadioService radioService.  ,    RadioService. <br><br>  :  onServiceConnected   ¬´b radioManager = Stub.asInterface(service)¬ª.  ,     .    ¬´bindService¬ª.  bindService   ¬´com.some_company.help_service¬ª.      ,      com.some_company.carradio.FmUtils.  , ,     . , : j  ,    : 8880  88.00 .        8800.      a. ,    . <br><br>   .  : k  z.         RadioRepoImpl,    enableRadio()  disableRadio()   k.    z(boolean isForwardDirection),     ¬´ (seek)   ¬ª. <br><br>      : a(10600);z(true);j(). <br><br><h3> hack it! #9 </h3> <sup><i>:  </i></sup> <br> <a href="https://yadi.sk/d/RqpIQYikuNBwcA"> </a> <br><br>    flatbuffers      .      GPX  .    .      ,  . <br><br>  FlatBuffers   : <br><br><pre> <code class="plaintext hljs">namespace ru.yandex.android.task; struct GeoPoint { latitude:double; longitude:double; } table Points { items:[GeoPoint]; } root_type Points;</code> </pre> <br>  : ,     sha256.      . <br><br>  <b>Solution</b> <br><br>   ,   FlatBuffers. <br><br> 1.   fbs-         . <br> 2.    Java-.   JVM-    ,    Gradle   flatbuffers. <br> 3.        fbs-. <br> 4.      fbs-,     -     ‚Äî    .    ,          FlatBuffers. <br> 5.      ,   .  structs  ,           struct  table.     . <br> 6.            Kotlin.            FlatBuffers. <br><br>      fbs     ,        .     FlatBufferBuilder      input.    input   : <br><br><pre> <code class="plaintext hljs">val pointsList = Points.getRootAsPoints(buffer) val restoredPoints = (0 until pointsList.itemsLength()) .mapNotNull(pointsList::items)</code> </pre> <br>  c    ,          (lat, long).       as-is    GPX-. <br><br>    GPX- (   )   .    GPX   XML.  ,       XML-   .  XML-   GPX-track-.  XML-   MAP-          .     ¬´yandroid¬ª. <br><br> ,      .      CLI-: <br><br><pre> <code class="plaintext hljs">echo "yandroid" | shasum -a 256</code> </pre> <br>      . <br><br><a name="dig"></a><h1>  Android </h1><br><h3> dig it! #1 </h3> <sup><i>:  </i></sup> <br> <a href="https://yadi.sk/d/WNgNI_n2ydszrg"> </a> <br><br> QA-    . <br><br>  : <br><br> ‚Äî   (  'Screen 1') <br> ‚Äî   GO NEXT (  'Screen 2') <br> ‚Äî   GO BACK <br> ‚Äî     GO NEXT,   <br> ‚Äî  5‚Äì10  <br><br>  :   'Screen 2'. <br><br>  :  ,   ¬´  ¬ª. <br><br>     .apk . <br><br><div class="spoiler">  <b class="spoiler_title">Remarques</b> <div class="spoiler_text"> <b> </b> <br><br> C   stack trace,     . <br><br>  <b>Exemple</b> <br><br>  stack trace     ‚Ä¶ <br><br><pre> <code class="plaintext hljs">at android.os.MessageQueue.nativePollOnce(Native method) at android.os.MessageQueue.next(MessageQueue.java:326) at android.os.Looper.loop(Looper.java:160) at com.android.server.SystemServer.run(SystemServer.java:454) at com.android.server.SystemServer.main(SystemServer.java:294) at java.lang.reÔ¨Çect.Method.invoke(Native method) at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:838)</code> </pre> <br> ‚Ä¶   ,     RuntimeInit.java,   493,   : <br><br><pre> <code class="plaintext hljs">com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493)</code> </pre> </div></div><br>  <b>Solution</b> <br><br>   , ,     ¬´  ¬ª. <br><br>       /data/anr/traces.txt  /data/anr/anr_* (https://developer.android.com/topic/performance/vitals/anr#pull_a_traces_file).      adb-: <br><br><pre> <code class="plaintext hljs">adb root adb shell ls /data/anr adb pull /data/anr/&lt;filename&gt;</code> </pre> <br> (   adb root  ,     Google API.) <br><br>  stack trace   .  ‚Äî     stack trace,     : <br><br><pre> <code class="plaintext hljs">com.droid.mission.anrapk.MainActivity$2.onClick(MainActivity.java:43)</code> </pre> <br><img src="https://habrastorage.org/webt/ww/ae/yf/wwaeyflqgvj5ahgbw0ldeui2vo0.png"><br><br><h3> dig it! #2 </h3> <sup><i>:  </i></sup> <br><br>     Android Studio,        ,     MultiDex. -,    apk-     .dex-   (65536).   /     apk   Andorid Studio    .dex-. <br><br>  ‚Äî    dex-  ,    dex- ( ,    )      .    dex- . <br><br> : multidex , android gradle plugin  3.0.0 ‚Äì 3.1.4 <br><br>    . <br><br>         ? <br><br>  <b>Solution</b> <br><br>         ,      dex-.       Gradle ‚Äî  ,     ,   .apk. <br><br>     Java-  dex-    ART/Dalvik: transformClassesWithDexBuilderForDebug.     dex-,   .       Android Gradle plugin (AGP)     Gradle  .  ,  ‚Äî  , Gradle             . ,        .        AGP,   ‚Äî   DSL- Gradle      build.gradle. <br><br>    3.1.*     minimal-main-dex.    ,      . <br><br><h3> dig it! #3 </h3> <sup><i>:  </i></sup> <br>  ‚Äî     -           . <br><br>       ? <br><br>  :  ‚Äî    . <br><br>  <b>Solution</b> <br><br>    ,        .    Android   WindowManager. <a href="https://developer.android.com/reference/android/view/WindowManager.html"></a>        .  ,  <a href="https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html">WindowManager.LayoutParams</a> .    ,        ,   <a href="https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html">TYPE_APPLICATION</a> . <br><br>    ,  ,      .       ,  ,    - . <br><br> ,   Android SDK,   ,        . ,     <a href="">WindowManager</a>  AOSP.     ,    ,   ,            . <br><br> ,       ,   <a href="http://androidxref.com/9.0.0_r3/search%3Fq%3DTYPE_BOOT_PROGRESS%26defs%3D%26refs%3D%26path%3D%26hist%3D%26project%3Dframeworks">TYPE_BOOT_PROGRESS</a> .       getWindowLayerFromTypeLw  WindowManagerPolicy.  Javadoc : <br><br><blockquote> Returns the layer assignment for the window type. Allows you to control how different kinds of windows are ordered on-screen </blockquote><br> ,   ,  .    switch-case   ,   layer ‚Äî  TYPE_POINTER,  2018.    . <br><br><h3> dig it! #4 </h3> <sup><i>:  </i></sup> <br><br>    ,      -        ,     . <br><br>        .   ,   ,   ,     . <br><br>    Android  ,          ? <br><br>  <b>Solution</b> <br><br>       ,   ,     Android SDK,  . <br><br>     <a href="">startActivity  Context</a> .     Context  Activity ‚Äî ,      <a href="">startActivity</a> .        startActivityForResult.     ,    Activity  <a href="">mInstrumentation.execStartActivity</a> . <br><br>      <a href=""></a> ?    startActivity  ActivityManagerService,    ServiceManager.getService(Context.ACTIVITY_SERVICE). <br><br>      <a href="">ActivityManagerService</a> .   startActivityAsUser,    startActivity,  ActivityStarter     execute. ,    <a href=""></a> . <br><br> C         <a href="">startActivity</a> .      ,     <a href="">abort</a> ,     true    START_ABORTED     Activity. <br><br>  ,    ,      mService.mIntentFirewall.checkStartActivity. , <a href="">   </a> .   : <br><br><blockquote> This is called from ActivityManager to check if a start activity intent should be allowed. </blockquote><br>   ,  IntentFirewall  .        <a href="">RULES_DIR</a> . : ifw. <br><br><h3> dig it! #5 </h3> <sup><i>:  </i></sup> <br><br>     . ,        (, ) ‚Äî 8800.  ,  ,        (+8800). ,   8800  +8800 ,   /     ,    . <br><br>            .    .   ,   +8800  8800 . <br><br>          ,     (java/c/c++).   ,    . <br><br>      : <a href="https://source.android.com/">source.android.com</a> <br>   ‚Äî : <a href="http://androidxref.com/">androidxref.com</a> <br><br>  <b>Solution</b> <br><br>     Dialer ,         ,    URI  <code>authorities = "content://com.android.contacts"</code> . <br><br>  ContentProvider.        URI   ContactsPoviider.  : ,    SQL-      .    : <br><br><pre> <code class="plaintext hljs">sb.append("PHONE_NUMBERS_EQUAL(" + Tables.DATA + "." + Phone.NUMBER + ", ");</code> </pre> <br> PHONE_NUMBERS_EQUAL ‚Äî   SQL-.   sqlite    . <br><br>    sqlite,  ,        .   ContactsProvider  ,      config_use_strict_phone_number_comparation,     . : <br><br><pre> <code class="plaintext hljs">&lt;bool name="config_use_strict_phone_number_comparation"&gt;true&lt;/bool&gt;</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr484876/">https://habr.com/ru/post/fr484876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr484862/index.html">Migration d'AngularJS vers Angular7 via une application hybride</a></li>
<li><a href="../fr484866/index.html">Utilisation d'Astra Linux sur un ordinateur embarqu√© ARM</a></li>
<li><a href="../fr484868/index.html">Comment mesurer l'am√©lioration de l'√©quipe? 2e partie</a></li>
<li><a href="../fr484870/index.html">Comment les Anglais ont chang√© Ilona Mask depuis 20 ans</a></li>
<li><a href="../fr484874/index.html">"Votre sp√©cialiste informatique est cass√©, apportez-en un nouveau": comment construire une carri√®re en informatique et ne pas devenir fou</a></li>
<li><a href="../fr484878/index.html">Bases de la conception de niveaux: effet de flux ou comment ne pas laisser le joueur s'ennuyer</a></li>
<li><a href="../fr484882/index.html">Windows Terminal Preview v0.8 publi√©</a></li>
<li><a href="../fr484884/index.html">HIPEC. Des ann√©es de vie au lieu de mois avec des tumeurs malignes de la cavit√© abdominale</a></li>
<li><a href="../fr484886/index.html">RTL Styling 101 - Un guide d√©taill√© du style CSS RTL</a></li>
<li><a href="../fr484890/index.html">Restreindre l'acc√®s aux attributs de dimension dans le mod√®le tabulaire SSAS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>