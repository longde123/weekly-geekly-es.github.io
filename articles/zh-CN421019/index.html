<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ›ï¸ ğŸŒ‰ é”¯åˆ‡WindowsæœåŠ¡-é¢å‘â€œéçœŸæ­£ç¨‹åºå‘˜â€çš„æŒ‡å— ğŸ–ğŸ» ğŸ™…ğŸ¿ ğŸ§“ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¸€æ—¦è€ƒè™‘äº†å¦‚ä½•å°†è„šæœ¬æˆ–åº”ç”¨ç¨‹åºè½¬æ¢ä¸ºWindowsæœåŠ¡ã€‚ æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œä»»åŠ¡ä¸ä¼šé‚£ä¹ˆçç¢-è‡³å°‘åº”ç”¨ç¨‹åºéœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„æ¥å£æ¥æ¥æ”¶æ¥è‡ªç³»ç»Ÿçš„å‘½ä»¤ã€‚ è€Œä¸”ç”±äºå­˜åœ¨ä¸€äº›è¦æ±‚å’Œé™åˆ¶ï¼Œå› æ­¤éœ€è¦å…‹æœçš„é—®é¢˜æ˜¯å‰§æœ¬å’Œæ‹æ–ï¼Œå®ƒä»¬çœŸæ˜¯ä»¤äººåŠ¨å®¹ã€‚ 


 è¿™ç¯‡æ–‡ç« å¯¹åƒæˆ‘ä¸€æ ·ä¸æ˜¯â€œçœŸæ­£çš„ç¨‹åºå‘˜â€çš„äººå¾ˆæœ‰ç”¨ã€‚ 
 å¦‚æœæœ‰è®¡åˆ’ä»»...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>é”¯åˆ‡WindowsæœåŠ¡-é¢å‘â€œéçœŸæ­£ç¨‹åºå‘˜â€çš„æŒ‡å—</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pc-administrator/blog/421019/"><p><img src="https://habrastorage.org/webt/j3/j5/7b/j3j57big8bze9751j7_frrcjc7q.jpeg"></p><br><p> ä¸€æ—¦è€ƒè™‘äº†å¦‚ä½•å°†è„šæœ¬æˆ–åº”ç”¨ç¨‹åºè½¬æ¢ä¸ºWindowsæœåŠ¡ã€‚ æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œä»»åŠ¡ä¸ä¼šé‚£ä¹ˆçç¢-è‡³å°‘åº”ç”¨ç¨‹åºéœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„æ¥å£æ¥æ¥æ”¶æ¥è‡ªç³»ç»Ÿçš„å‘½ä»¤ã€‚ è€Œä¸”ç”±äºå­˜åœ¨ä¸€äº›è¦æ±‚å’Œé™åˆ¶ï¼Œå› æ­¤éœ€è¦å…‹æœçš„é—®é¢˜æ˜¯å‰§æœ¬å’Œæ‹æ–ï¼Œå®ƒä»¬çœŸæ˜¯ä»¤äººåŠ¨å®¹ã€‚ </p><br><p> è¿™ç¯‡æ–‡ç« å¯¹åƒæˆ‘ä¸€æ ·ä¸æ˜¯â€œçœŸæ­£çš„ç¨‹åºå‘˜â€çš„äººå¾ˆæœ‰ç”¨ã€‚ <a name="habracut"></a></p><br><h1 id="zachem-nuzhna-sluzhba-esli-est-naznachennye-zadaniya"> å¦‚æœæœ‰è®¡åˆ’ä»»åŠ¡ï¼Œä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡ </h1><br><p> ä¸åˆ†é…çš„ä»»åŠ¡ç›¸åï¼Œè¯¥æœåŠ¡æŒç»­è¿è¡Œï¼Œä»PCçš„å¯åŠ¨å¤„å¯åŠ¨ï¼Œå¹¶ä¸”å¯ä»¥ç”±Windowså·¥å…·æ§åˆ¶ã€‚ åŒæ ·ï¼Œå®šæœŸå¯åŠ¨çš„è„šæœ¬å¯èƒ½éœ€è¦å…ˆå‰å¯åŠ¨çš„æ•°æ®ï¼Œå¹¶ä¸”ä»å¤–éƒ¨æºè·å–æ•°æ®å¯èƒ½å¾ˆæœ‰ç”¨-ä¾‹å¦‚ï¼Œåœ¨TCPæˆ–WebæœåŠ¡å™¨çš„æƒ…å†µä¸‹ã€‚ </p><br><p> å°±ä¸ªäººè€Œè¨€ï¼Œåœ¨è¿‡å»çš„äº”å¹´ä¸­ï¼Œæˆ‘ä¸å¾—ä¸åˆ›å»ºä¸€ä¸ªæœåŠ¡ä¸‰å€åŠï¼š </p><br><ul><li>éœ€è¦åœ¨<strong>Windows 2003çš„fail2ban</strong>ä¸Šåˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œè¯¥æœåŠ¡å¯ä¸FileZillaå’ŒApacheæ—¥å¿—ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚æœæ€€ç–‘æ˜¯è›®åŠ›çš„ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¸¸è§„Windowså·¥å…·ipsecé˜»æ­¢IPã€‚ </li><li>  Windowså®¶åº­ç‰ˆçš„telnetæœåŠ¡å™¨çš„ç±»ä¼¼ç‰©ã€‚ å®ƒéœ€è¦åœ¨è¿è¡ŒWindows 7 Homeçš„è¿œç¨‹å·¥ä½œç«™ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚ å…¶å®æ˜¯ç¬¬äºŒæ¬¡å°è¯•æ‰“æœåŠ¡ã€‚ </li><li>  Windowsä¸‹äº¤æ˜“å¤§å…çš„éŸ³ä¹æ’­æ”¾å™¨ã€‚ å¯ä»¥é€šè¿‡<strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">mpd</a></strong>å’Œä¸€å †è„šæœ¬æ¥è§£å†³æœ‰å…³TKçš„ä»»åŠ¡ï¼Œä½†æ˜¯æˆ‘å†³å®š-å¦‚æœæˆ‘ä»¬è¦ç¼–å†™è„šæœ¬ï¼Œé‚£ä¸ºä»€ä¹ˆä¸è‡ªå·±â€œå †â€ç©å®¶ã€‚ åŸºäºåº“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BASS.dll</a> ã€‚ </li><li> é€‰æ‹©æ”¯æŒåœ¨Windowsä¸‹ä¸‹è½½æ–‡ä»¶çš„WebæœåŠ¡å™¨æ—¶ï¼Œä¸€ç§é€‰æ‹©æ˜¯<strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HFS</a></strong> ã€‚ ä»–ä¸èƒ½ç‹¬è‡ªå·¥ä½œï¼Œå› æ­¤ä»–ä¸å¾—ä¸â€œæ¨â€ä»–å»æœåŠ¡ã€‚ ç»“æœï¼Œæˆ‘ä¸å–œæ¬¢è¯¥è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯åœ¨Apache WebæœåŠ¡å™¨ä¸Šå®‰è£…äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Apaxyä¸»é¢˜</a> ã€‚ </li></ul><br><p> è¦åˆ›å»ºæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨æˆäººç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚Cï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸æƒ³ä¸Visual Studioé€šä¿¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç°æˆçš„å®ç”¨ç¨‹åºã€‚ æœ‰ä»˜è´¹è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FireDaemon Pro</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AlwaysUp</a> ï¼Œä½†ä¼ ç»Ÿä¸Šæˆ‘ä»¬å°†ä¸“æ³¨äºå…è´¹è§£å†³æ–¹æ¡ˆã€‚ </p><br><h1 id="sposob-pervyy-ot-microsoft"> ç¬¬ä¸€ç§æ–¹å¼ã€‚ æ¥è‡ªå¾®è½¯ </h1><br><p> è¿™ç§å·²ç»<strong>è¿‡æ—¶çš„</strong>æœºåˆ¶åŒ…æ‹¬ä¸¤ä¸ªç»„ä»¶ï¼šç”¨äºå®‰è£…æœåŠ¡çš„<strong>instsrv.exe</strong>å®ç”¨ç¨‹åºå’Œç”¨äºå¯åŠ¨ä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹<strong>srvany.exe</strong> ã€‚ å‡è®¾æˆ‘ä»¬ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Polaris</a>æ¨¡å—åœ¨PowerShellä¸Šåˆ›å»ºäº†WebæœåŠ¡å™¨ã€‚ è¯¥è„šæœ¬å°†éå¸¸ç®€å•ï¼š </p><br><pre><code class="hljs powershell"><span class="hljs-built_in"><span class="hljs-built_in">New-PolarisGetRoute</span></span> <span class="hljs-literal"><span class="hljs-literal">-Path</span></span> <span class="hljs-string"><span class="hljs-string">'/helloworld'</span></span> <span class="hljs-literal"><span class="hljs-literal">-Scriptblock</span></span> { <span class="hljs-variable"><span class="hljs-variable">$Response</span></span>.Send(<span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span>) } <span class="hljs-built_in"><span class="hljs-built_in">Start-Polaris</span></span> <span class="hljs-literal"><span class="hljs-literal">-Port</span></span> <span class="hljs-number"><span class="hljs-number">8080</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-variable"><span class="hljs-variable">$true</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">Start-Sleep</span></span> <span class="hljs-literal"><span class="hljs-literal">-Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> }</code> </pre> <br><p><img src="https://habrastorage.org/webt/im/br/xz/imbrxzpsqml1osyityi0k1nwe1w.jpeg"><br>  <em>æ‰€è°“çš„â€œæœåŠ¡å™¨â€å·¥ä½œã€‚</em> </p><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•å°†è„šæœ¬è½¬æ¢ä¸ºæœåŠ¡ã€‚ ä¸ºæ­¤ï¼Œè¯·ä¸‹è½½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Windows Resource Kitå·¥å…·</a> ï¼Œè¯¥å·¥å…·å°†ä½äºæˆ‘ä»¬çš„å®ç”¨ç¨‹åºä¸­ã€‚ è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ç©ºæœåŠ¡ï¼š </p><br><pre> <code class="hljs tex">instsrv WebServ C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">temp</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rktools</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">srvany</span></span></span></span>.exe</code> </pre><br><p>  WebServæ˜¯æˆ‘ä»¬æ–°æœåŠ¡çš„åç§°ã€‚ å¦‚æœ‰å¿…è¦ï¼Œé€šè¿‡<strong>services.msc</strong>ç®¡ç†å•å…ƒï¼Œæ‚¨å¯ä»¥æŒ‡å®šå°†åœ¨å…¶ä¸‹å¯åŠ¨æœåŠ¡çš„ç”¨æˆ·ï¼Œå¹¶å…è®¸ä¸æ¡Œé¢è¿›è¡Œäº¤äº’ã€‚ </p><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ³¨å†Œè¡¨é­”æœ¯æ¥ç¼–å†™è„šæœ¬çš„è·¯å¾„ã€‚ æœåŠ¡å‚æ•°ä½äºæ³¨å†Œè¡¨é¡¹<strong>HKLM \ SYSTEM \ CurrentControlSet \ Services \ WebServä¸­</strong> ã€‚ åœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªæ–°çš„<strong>Parameters</strong>éƒ¨åˆ†ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°<strong>Application</strong> ï¼Œåœ¨å…¶ä¸­æŒ‡ç¤ºå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚ å¦‚æœä½¿ç”¨PowerShellè„šæœ¬ï¼Œå®ƒå°†å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="hljs tex">C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsPowerShell</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v</span></span></span></span>1.0<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">powershell</span></span></span></span>.exe -ExecutionPolicy Bypass -NoProfile -File C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">temp</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Polaris</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span></span>.ps1</code> </pre><br><p><img src="https://habrastorage.org/webt/2c/9a/zw/2c9azwf_tlvz6cs2ez4jlw7pl58.jpeg"><br>  <em>å®šåˆ¶æœåŠ¡ã€‚</em> </p><br><p> æ‚¨å¯ä»¥å°½æƒ…äº«å—ã€‚ </p><br><p><img src="https://habrastorage.org/webt/4j/qh/kd/4jqhkdbgssb6gv8el-qpnfn4wea.jpeg"><br>  <em>å·¥ä½œæœåŠ¡ã€‚</em> </p><br><p> ä½†æ˜¯ï¼Œæ­¤æ–¹æ³•æœ‰ç¼ºç‚¹ï¼š </p><br><ul><li> å®ç”¨ç¨‹åºå¾ˆè€ï¼Œæ˜¯åœ¨PowerShellï¼ŒUACå’Œå…¶ä»–ä¸œè¥¿å‘æ˜ä¹‹å‰å¼€å‘çš„ã€‚ </li><li>  <strong>Srvany</strong>ä¸æ§åˆ¶åº”ç”¨ç¨‹åºçš„æ“ä½œã€‚ å³ä½¿å‡ºç°é”™è¯¯ï¼ŒæœåŠ¡ä¹Ÿå°†ç»§ç»­å…¶å·¥ä½œï¼Œå¥½åƒä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿã€‚ </li><li> å°†ä¸å¾—ä¸è°ƒæ•´å¹¶æ·±å…¥ç ”ç©¶æ³¨å†Œè¡¨ã€‚ æ‚¨è¿˜è®°å¾—æŒ–æ˜æ³¨å†Œè¡¨ä¸å®‰å…¨å—ï¼Ÿ </li></ul><br><p> å› æ­¤ï¼Œæˆ‘ä»¬è½¬å‘ä¸€ç§éƒ¨åˆ†æ²¡æœ‰è¿™äº›é—®é¢˜çš„æ–¹æ³•ã€‚ </p><br><h1 id="sposob-vtoroy-pochti-vzroslyy"> ç¬¬äºŒç§æ–¹å¼ï¼Œå‡ ä¹æ˜¯æˆäºº </h1><br><p> æœ‰ä¸€ä¸ªåä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NSSM</a> - <strong>Non-Sucking Service Manager</strong>çš„å®ç”¨ç¨‹åºï¼Œå¯ä»¥å°†å…¶è½¬æ¢<em>ä¸ºéé”™è¯¯æœåŠ¡ç®¡ç†å™¨</em> ã€‚ ä¸å‰ä¸€ä¸ªä¸åŒï¼Œå®ƒç”±å¼€å‘äººå‘˜æ”¯æŒï¼Œå¹¶ä¸”æºä»£ç åœ¨ç«™ç‚¹ä¸Šå‘å¸ƒã€‚ é™¤äº†é€šå¸¸çš„æ–¹æ³•å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chocolately</a>è½¯ä»¶åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ã€‚ </p><br><p> æ‚¨å¯ä»¥ä»é€šå¸¸çš„å‘½ä»¤è¡Œåˆ›å»ºæœåŠ¡ï¼Œå¹¶é™„å¸¦å¼€å‘äººå‘˜ç«™ç‚¹ä¸Šçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£</a> ã€‚ ä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨PowerShellã€‚ å› ä¸ºæˆ‘ä»¬å½“ç„¶å¯ä»¥ã€‚ </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$nssm</span></span> = (<span class="hljs-built_in"><span class="hljs-built_in">Get-Command</span></span> ./nssm).Source <span class="hljs-variable"><span class="hljs-variable">$serviceName</span></span> = <span class="hljs-string"><span class="hljs-string">'WebServ'</span></span> <span class="hljs-variable"><span class="hljs-variable">$powershell</span></span> = (<span class="hljs-built_in"><span class="hljs-built_in">Get-Command</span></span> powershell).Source <span class="hljs-variable"><span class="hljs-variable">$scriptPath</span></span> = <span class="hljs-string"><span class="hljs-string">'C:\temp\Polaris\server.ps1'</span></span> <span class="hljs-variable"><span class="hljs-variable">$arguments</span></span> = <span class="hljs-string"><span class="hljs-string">'-ExecutionPolicy Bypass -NoProfile -File "{0}"'</span></span> <span class="hljs-operator"><span class="hljs-operator">-f</span></span> <span class="hljs-variable"><span class="hljs-variable">$scriptPath</span></span> &amp; <span class="hljs-variable"><span class="hljs-variable">$nssm</span></span> install <span class="hljs-variable"><span class="hljs-variable">$serviceName</span></span> <span class="hljs-variable"><span class="hljs-variable">$powershell</span></span> <span class="hljs-variable"><span class="hljs-variable">$arguments</span></span> &amp; <span class="hljs-variable"><span class="hljs-variable">$nssm</span></span> status <span class="hljs-variable"><span class="hljs-variable">$serviceName</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Start-Service</span></span> <span class="hljs-variable"><span class="hljs-variable">$serviceName</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Get-Service</span></span> <span class="hljs-variable"><span class="hljs-variable">$serviceName</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/nn/gf/xz/nngfxzjxsimbi2srebmcwjzioie.jpeg"><br>  <em>é€šè¿‡PowerShellå®‰è£…ã€‚</em> </p><br><p> è¦è¿›è¡Œæ›´æ”¹ï¼Œæˆ‘ä»¬å°†ä¸ä½¿ç”¨æµè§ˆå™¨æ¥æ£€æŸ¥æœåŠ¡çš„å·¥ä½œï¼Œè€Œæ˜¯ä½¿ç”¨<strong>Invoke-RestMethodå‘½ä»¤</strong>é€šè¿‡PowerShellæ£€æŸ¥è¯¥æœåŠ¡çš„å·¥ä½œ<strong>ã€‚</strong> </p><br><p><img src="https://habrastorage.org/webt/b-/wg/17/b-wg17nhhlesw6xon8sdv9c0hks.png"><br>  <em>å®ƒç¡®å®æœ‰æ•ˆã€‚</em> </p><br><p> ä¸<strong>srvany</strong>ä¸åŒï¼Œæ­¤æ–¹æ³•ä½¿æ‚¨å¯ä»¥åœ¨å¯åŠ¨æ—¶é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œé‡å®šå‘<strong>stdin</strong>å’Œ<strong>stdout</strong>ç­‰ã€‚ ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœæ‚¨ä¸æƒ³åœ¨å‘½ä»¤è¡Œä¸Šç¼–å†™å‘½ä»¤ï¼Œåˆ™åªéœ€è¿è¡ŒGUIå¹¶é€šè¿‡æ–¹ä¾¿çš„ç•Œé¢è¾“å…¥å¿…è¦çš„å‚æ•°å³å¯ã€‚ </p><br><p>  GUIä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ï¼š </p><br><pre> <code class="hljs sql">nssm.exe <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> ServiceName</code> </pre> <br><p><img src="https://habrastorage.org/webt/ji/rg/6i/jirg6iwexgpn_3zun4ich0zgepo.jpeg"><br>  <em>æ‚¨ç”šè‡³å¯ä»¥é…ç½®å¤„ç†å™¨å†…æ ¸çš„ä¼˜å…ˆçº§å’Œä½¿ç”¨ã€‚</em> </p><br><p> ç¡®å®ï¼Œæ¯”<strong>srvany</strong>å’Œè®¸å¤šå…¶ä»–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç±»ä¼¼ç‰©</a>æœ‰æ›´å¤šçš„æœºä¼šã€‚ åœ¨ç¼ºç‚¹ä¸­ï¼Œå¯¹æ•´ä¸ªè¿‡ç¨‹çš„æ§åˆ¶ä¸è¶³ã€‚ </p><br><p> ç¼ºå°‘é”¡ã€‚ å› æ­¤ï¼Œæˆ‘å°†ç»§ç»­ä»‹ç»æ‰€æœ‰ç»è¿‡æµ‹è¯•çš„æœ€ä¸¥æ ¼çš„æ–¹æ³•ã€‚ </p><br><h1 id="sposob-tretiy-autoit"> ç¬¬ä¸‰ç§æ–¹å¼ã€‚ è‡ªåŠ¨IT </h1><br><p> ç”±äºæˆ‘æ˜¯è¯¥è„šæœ¬è¯­è¨€çš„é•¿æœŸçˆ±å¥½è€…ï¼Œå› æ­¤æ— æ³•è¶…è¶Šåä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">_Services_UDF v4</a>çš„åº“ã€‚ å®ƒé…å¤‡äº†ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œå› æ­¤åœ¨â€œç ´åè€…â€ä¸‹ï¼Œæˆ‘å°†ç«‹å³æä¾›ç»“æœè„šæœ¬çš„å…¨æ–‡ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">è„šæœ¬æ¸…å•</b> <div class="spoiler_text"><p> å› æ­¤ï¼Œè®©æˆ‘ä»¬å°è¯•å°†æˆ‘ä»¬çš„WebæœåŠ¡â€œåŒ…è£…â€åˆ°å…¶ä¸­ï¼š </p><br><pre> <code class="hljs mel">#NoTrayIcon #RequireAdmin #Region #AutoIt3Wrapper_Version=Beta #AutoIt3Wrapper_UseUpx=n #AutoIt3Wrapper_Compile_Both=y #AutoIt3Wrapper_UseX64=y #EndRegion Dim $MainLog = @ScriptDir &amp; <span class="hljs-string"><span class="hljs-string">"\test_service.log"</span></span> #include &lt;services.au3&gt; #include &lt;WindowsConstants.au3&gt; $sServiceName=<span class="hljs-string"><span class="hljs-string">"WebServ"</span></span> If $cmdline[<span class="hljs-number"><span class="hljs-number">0</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> Then Switch $cmdline[<span class="hljs-number"><span class="hljs-number">1</span></span>] Case <span class="hljs-string"><span class="hljs-string">"install"</span></span>, <span class="hljs-string"><span class="hljs-string">"-i"</span></span>, <span class="hljs-string"><span class="hljs-string">"/i"</span></span> InstallService() Case <span class="hljs-string"><span class="hljs-string">"remove"</span></span>, <span class="hljs-string"><span class="hljs-string">"-u"</span></span>, <span class="hljs-string"><span class="hljs-string">"/u"</span></span>, <span class="hljs-string"><span class="hljs-string">"uninstall"</span></span> RemoveService() Case Else ConsoleWrite(<span class="hljs-string"><span class="hljs-string">" - - - Help - - - "</span></span> &amp; @CRLF) ConsoleWrite(<span class="hljs-string"><span class="hljs-string">"params : "</span></span> &amp; @CRLF) ConsoleWrite(<span class="hljs-string"><span class="hljs-string">" -i : install service"</span></span> &amp; @CRLF) ConsoleWrite(<span class="hljs-string"><span class="hljs-string">" -u : remove service"</span></span> &amp; @CRLF) ConsoleWrite(<span class="hljs-string"><span class="hljs-string">" - - - - - - - - "</span></span> &amp; @CRLF) Exit EndSwitch Else _Service_init($sServiceName) Exit EndIf Func _main($iArg, $sArgs) If Not _Service_ReportStatus($SERVICE_RUNNING, $NO_ERROR, <span class="hljs-number"><span class="hljs-number">0</span></span>) Then _Service_ReportStatus($SERVICE_STOPPED, _WinAPI_GetLastError(), <span class="hljs-number"><span class="hljs-number">0</span></span>) Exit EndIf $bServiceRunning = True $PID=Run(<span class="hljs-string"><span class="hljs-string">"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy Bypass -NoProfile -File C:\temp\Polaris\server.ps1"</span></span>) While $bServiceRunning _sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>) WEnd ProcessClose($PID) _Service_ReportStatus($SERVICE_STOP_PENDING, $NO_ERROR, <span class="hljs-number"><span class="hljs-number">1000</span></span>) DllCallbackFree($tServiceMain) DllCallbackFree($tServiceCtrl) _Service_ReportStatus($SERVICE_STOPPED, $NO_ERROR, <span class="hljs-number"><span class="hljs-number">0</span></span>) DllClose($hAdvapi32_DLL) DllClose($hKernel32_DLL) EndFunc Func _Sleep($delay) Local $result = DllCall($hKernel32_DLL, <span class="hljs-string"><span class="hljs-string">"none"</span></span>, <span class="hljs-string"><span class="hljs-string">"Sleep"</span></span>, <span class="hljs-string"><span class="hljs-string">"dword"</span></span>, $delay) EndFunc Func InstallService() #RequireAdmin Local $bDebug = True If $cmdline[<span class="hljs-number"><span class="hljs-number">0</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> Then $sServiceName = $cmdline[<span class="hljs-number"><span class="hljs-number">2</span></span>] EndIf If $bDebug Then ConsoleWrite(<span class="hljs-string"><span class="hljs-string">"InstallService("</span></span>&amp;$sServiceName &amp;<span class="hljs-string"><span class="hljs-string">"): Installing service, please wait"</span></span>) _Service_Create($sServiceName, $sServiceName, $SERVICE_WIN32_OWN_PROCESS, $SERVICE_AUTO_START, $SERVICE_ERROR_SEVERE, <span class="hljs-string"><span class="hljs-string">'"'</span></span> &amp; @ScriptFullPath &amp; <span class="hljs-string"><span class="hljs-string">'"'</span></span>);,<span class="hljs-string"><span class="hljs-string">""</span></span>,False,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"NT AUTHORITY\NetworkService"</span></span>) If @error Then Msgbox(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"InstallService(): Problem installing service, Error number is "</span></span> &amp; @error &amp; @CRLF &amp; <span class="hljs-string"><span class="hljs-string">" message : "</span></span> &amp; _WinAPI_GetLastErrorMessage()) Else If $bDebug Then ConsoleWrite(<span class="hljs-string"><span class="hljs-string">"InstallService(): Installation of service successful"</span></span>) EndIf Exit EndFunc Func RemoveService() _Service_Stop($sServiceName) _Service_Delete($sServiceName) If Not @error Then EndIf Exit EndFunc Func _exit() _Service_ReportStatus($SERVICE_STOPPED, $NO_ERROR, <span class="hljs-number"><span class="hljs-number">0</span></span>); EndFunc Func StopTimer() _Service_ReportStatus($SERVICE_STOP_PENDING, $NO_ERROR, $iServiceCounter) $iServiceCounter += <span class="hljs-number"><span class="hljs-number">-100</span></span> EndFunc Func _Stopping() _Service_ReportStatus($SERVICE_STOP_PENDING, $NO_ERROR, <span class="hljs-number"><span class="hljs-number">3000</span></span>) EndFunc</code> </pre> </div></div><br><p> å¯åŠ¨åº”ç”¨ç¨‹åºåï¼Œæˆ‘å°†è¿›è¡Œæ›´è¯¦ç»†çš„åˆ†æã€‚ å®ƒåœ¨<strong>$ bServiceRunning = True</strong>æ“ä½œä¹‹åå¼€å§‹ï¼Œå¹¶å˜æˆçœ‹ä¼¼æ— é™çš„å¾ªç¯ã€‚ å®é™…ä¸Šï¼Œä¸€æ—¦æœåŠ¡æ”¶åˆ°å®Œæˆä¿¡å·-æ— è®ºæ˜¯æ³¨é”€è¿˜æ˜¯æ‰‹åŠ¨åœæ­¢ï¼Œæ­¤è¿‡ç¨‹éƒ½å°†è¢«ä¸­æ–­ã€‚ </p><br><p> ç”±äºè„šæœ¬çš„ç¨‹åºæ˜¯å¤–éƒ¨ç¨‹åºï¼ˆpowershell.exeï¼‰ï¼Œå› æ­¤åœ¨é€€å‡ºå¾ªç¯åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<strong>ProcessClose</strong>å®Œæˆå…¶å·¥ä½œã€‚ </p><br><p> ä¸ºæ­¤ï¼Œå¿…é¡»å°†è„šæœ¬ç¼–è¯‘ä¸º<strong>.exe</strong> ï¼Œç„¶åé€šè¿‡ä½¿ç”¨<strong>-i</strong>å¼€å…³è¿è¡Œexeæ¥å®‰è£…æœåŠ¡<strong>ã€‚</strong> </p><br><p><img src="https://habrastorage.org/webt/wl/xp/ph/wlxpphvp20lakbyd2wii7ssytle.jpeg"><br>  <em>æœ‰æ•ˆï¼</em> </p><br><p> å½“ç„¶ï¼Œè¿™ç§æ–¹æ³•ä¸æ˜¯æœ€æ–¹ä¾¿çš„ï¼Œå¹¶ä¸”æ‰€æœ‰å…¶ä»–åŠŸèƒ½éƒ½å¿…é¡»ç‹¬ç«‹å®ç°ï¼Œæ— è®ºæ˜¯åœ¨å‡ºç°æ•…éšœè¿˜æ˜¯æ—¥å¿—è½®æ¢æ—¶é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºã€‚ ä½†æ˜¯ä»–å®Œå…¨æ§åˆ¶æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚ æœ€åï¼Œæ‚¨å¯ä»¥åšæ›´å¤šçš„äº‹æƒ…-ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é€šçŸ¥</a> TelegramæœåŠ¡æ•…éšœåˆ°IPCä¸å…¶ä»–ç¨‹åºçš„äº¤äº’ã€‚ å¦å¤–-ä½¿ç”¨è„šæœ¬è¯­è¨€ï¼Œæ— éœ€å®‰è£…å’Œå­¦ä¹ Visual Studioã€‚ </p><br><p> å‘Šè¯‰æˆ‘ä»¬ï¼Œæ‚¨æ˜¯å¦å¿…é¡»å°†è„šæœ¬å’Œåº”ç”¨ç¨‹åºè½¬æ¢ä¸ºæœåŠ¡ï¼Ÿ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421019/">https://habr.com/ru/post/zh-CN421019/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421005/index.html">RESTä¿è¯ï¼šæœ‰ç”¨çš„æŠ€å·§</a></li>
<li><a href="../zh-CN421007/index.html">å½•éŸ³æœº-å½•åˆ¶è‡ªåŠ¨æµ‹è¯•çš„å·¥å…·</a></li>
<li><a href="../zh-CN421009/index.html">8æœˆ25æ—¥è‡³26æ—¥ï¼šåœ¨çº¿è¿è¥ç®¡ç†ä¼šè®®</a></li>
<li><a href="../zh-CN421011/index.html">æ‚¨è®¤ä¸ºåœ¨é‡‡è®¿ä¸­çš„é—®é¢˜å¾ˆæ„šè ¢ã€‚ ä½†ä¸æ˜¯çœŸçš„</a></li>
<li><a href="../zh-CN421015/index.html">2018å¹´å…¨å›½äº’è”ç½‘ç»†åˆ†å¸‚åœºå¯æŒç»­å‘å±•è°ƒæŸ¥</a></li>
<li><a href="../zh-CN421021/index.html">Google Hadoopè¯„è®ºï¼ˆdataprocï¼‰</a></li>
<li><a href="../zh-CN421023/index.html">ä¼ä¸šç²¾ç¥åˆ†è£‚ç—‡</a></li>
<li><a href="../zh-CN421025/index.html">7ç§åŠŸèƒ½å¼ºå¤§çš„æ‰˜ç®¡é˜²ç«å¢™å¯ä¿æŠ¤æ‚¨çš„äº‘åŸºç¡€æ¶æ„</a></li>
<li><a href="../zh-CN421027/index.html">SDMXï¼ˆç»Ÿè®¡æ•°æ®å’Œå…ƒæ•°æ®äº¤æ¢ï¼‰</a></li>
<li><a href="../zh-CN421029/index.html">å¦‚ä½•æé«˜å•†åº—çš„ååé‡å’Œæ‘†è„±æ’é˜Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>