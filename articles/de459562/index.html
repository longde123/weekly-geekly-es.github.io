<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤒 🍯 👩🏻‍🤝‍👨🏽 Differenzierbare Programmierung ⛈️ 🍑 👩🏽‍🤝‍👩🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit vier Parametern kann ich einen Elefanten fragen, und mit fünf kann ich ihn dazu bringen, seinen Rüssel zu bewegen. 
 - John Von Neumann 

 Die Ide...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Differenzierbare Programmierung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459562/"><p><img src="https://habrastorage.org/webt/fv/8k/s8/fv8ks8cvj64dyqlstu1vi9znbv8.jpeg"></p><br><blockquote>  Mit vier Parametern kann ich einen Elefanten fragen, und mit fünf kann ich ihn dazu bringen, seinen Rüssel zu bewegen. <br>  - John Von Neumann </blockquote><p>  Die Idee der " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">differenzierbaren Programmierung</a> " ist in der Welt des maschinellen Lernens sehr beliebt.  Für viele ist nicht klar, ob dieser Begriff eine echte Veränderung im Verständnis der Forscher für maschinelles Lernen widerspiegelt oder nur eine (andere) Umbenennung von „Deep Learning“.  In diesem Beitrag wird erläutert, was neu an differenzierter Programmierung (oder ∂P) in der Tabelle für maschinelles Lernen ist. </p><br><p>  Am wichtigsten ist, dass differenzierte Programmierung die Verschiebung entgegen der Richtung des tiefen Lernens ist;  von zunehmend parametrisierten Modellen bis zu einfacheren Modellen, die die Problemstruktur in größerem Umfang nutzen. </p><br><p>  Als nächstes blättern wir durch eine Leinwand mit uninteressantem Text, wollen herausfinden, was automatische Differenzierung ist, und füllen sie sogar aus einem Katapult! </p><a name="habracut"></a><br><h2 id="brute-force-with-benefits">  Brute Force mit Vorteilen </h2><br><p>  Differenzierbarkeit ist eine Grundidee, die Deep Learning so erfolgreich macht.  Wo Brute-Force-Suchen selbst nach einigen hundert Modellparametern zu teuer wären, ermöglichen Gradienten das pseudozufällige Durchlaufen interessanter Teile des Parameterraums und finden einen guten Satz.  Wenn wir einen so scheinbar naiven Algorithmus ausführen, erhalten wir eine gute Allgemeinheit, aber es ist alles andere als offensichtlich, dass wir beispielsweise mit Sequenzen in der Sprachübersetzung differenzieren müssen, aber alles stellt sich als einfach heraus, wir zeigen ein wenig Einfallsreichtum. </p><br><p>  Was ist mit biologischen Neuronen und <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3C3;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>l</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.538ex" height="2.66ex" viewBox="0 -832 8412 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-3C3" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-28" x="2403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-57" x="2792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-6D" x="4091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-61" x="4969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-6C" x="5499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-78" x="5797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-2B" x="6592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-62" x="7593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-29" x="8022" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>σ</mo></mrow><mo stretchy="false">(</mo><mi>W</mi><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>l</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> y = σ (W \ mal x + b) </script>  ?  Diese Formel hat nichts Besonderes;  Dies ist ein einfaches und flexibles Beispiel für eine hochparametrische nichtlineare Funktion.  In der Tat ist dies in den meisten Fällen wahrscheinlich das schlechteste Merkmal.  Eine Schicht des neuronalen Netzwerks kann im Prinzip Bilder von Katzen klassifizieren, jedoch nur mit einem relativ uninteressanten Trick.  <strong>Es funktioniert einwandfrei!</strong>  - aber das Kleingedruckte warnt davor, dass Sie möglicherweise mehr Parameter als Atome im Universum benötigen.  Damit diese Arbeit tatsächlich funktioniert, müssen Sie die problematische Struktur im Modell codieren - hier sieht sie eher wie herkömmliche Programmierung aus. </p><br><p>  Zum Beispiel haben <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">ConvNets</a></em> einen großen Vorteil gegenüber dem Perzeptron, da sie mit <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Bildkernen</a></em> arbeiten, von denen bekannt ist, dass sie Übersetzungsinvarianz verwenden.  Gesicht - Es ist das Gesicht, unabhängig davon, ob es in der oberen linken Ecke des Bildes oder in der Mitte angezeigt wird. Wenn das Perzeptron diesen Fall jedoch jeweils untersuchen sollte, kann der Kernel sofort auf einen beliebigen Teil des Bildes reagieren.  Es ist schwierig, Faltungsnetzwerke statistisch zu analysieren, aber es ist viel einfacher, sie als automatische Version dessen zu betrachten, was Bildverarbeitungsexperten von Hand geschrieben haben.  Der Kernel des Bildes ist das erste und am einfachsten zu differenzierende Programm. </p><br><h2 id="encoding-structure-redux">  Kodierungsstruktur, Redux </h2><br><p>  ML-Toolkits unterstützen zunehmend die algorithmische Differenzierung (AD), mit der wir Modelle mithilfe von Schleifen, Verzweigungen und Rekursionen unterscheiden können - oder mit jedem Programm, das auf einer Reihe differenzierbarer mathematischer Grundelemente basiert.  Dies führte zu einer komplexeren Architektur: NLP-Modelle ähneln immer mehr klassischen Grammatik-Parsern mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">stapelerweiterten</a> Modellen, und Sie können sogar ein Analogon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">einer Turing-Maschine</a> oder einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Programmierspracheninterpreter unterscheiden</a> . </p><br><p>  Der letzte Schritt der differenzierten Programmierung besteht darin, Matrixmultiplikation, Faltung und <em>RNN</em> nicht mehr als grundlegende Bausteine ​​des tiefen Lernens zu betrachten, sondern nur noch als Sonderfälle.  Wir können Deep-Learning-Methoden auf jede parametrisierte differenzierbare Funktion anwenden <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.418ex" height="2.66ex" viewBox="0 -832 1902 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-29" x="1512" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> f (x) </script>  .  So komplexe Funktionen wie physikalische Simulatoren oder Raytracer können ebenfalls differenziert und optimiert werden.  Sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Quantencomputer</a> können in diese Struktur passen. </p><br><p><img src="https://habrastorage.org/webt/8i/pk/fa/8ipkfaovyvmrkrgev-dnc85atm8.png"></p><br><p>  Wissenschaftler verwenden seit langem mechanistische Modelle, die zwischen expliziter Programmierung und maschinellem Lernen liegen.  Differentialgleichungen mit freien Parametern, die in der Physik, Epidemiologie oder Pharmakodynamik verwendet werden, entsprechen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">neuronalen Netzen</a> in allen Bereichen außer der Terminologie.  Sie zielen einfach darauf ab, eine viel engere Funktionalität bereitzustellen, weil es so einfacher ist. </p><br><p>  Wirklich mächtiger Fortschritt ist folgender: Durchdringende Differenzierbarkeit bedeutet, dass alle diese Methoden wie <em>Legosteine</em> miteinander verbunden sind. <br>  Anstatt immer neue Programme für ML zu schreiben, können wir vorhandene Programme mithilfe physischer Engines in Deep-Learning- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Robotikmodellen</a> wiederverwenden.  Wo moderne Verstärkungslernalgorithmen ein detailliertes Modell der Außenwelt erstellen müssen, das nur auf dem basiert, wofür sie belohnt werden (klingt nach <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">roher Gewalt</a> ), können wir stattdessen einfach detaillierte, genaue Kenntnisse der physischen Systeme anwenden, bevor das Lernen überhaupt beginnt. </p><br><p>  Selbst die ausgereiftesten Bereiche des tiefen Lernens stehen nicht beiseite;  Nach dem Faltungskern ist der nächste natürliche Schritt für Bildmodelle ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">differenzierbarer Raytracer</a> .  3D-Rendering enthält viel strukturelles Wissen darüber, wie Szenen in Pixeln angezeigt werden, was in unserer Küche immer noch eine Rolle spielt.  Angenommen, ein Modell trifft Entscheidungen in einer simulierten Umgebung, die als Pixel angezeigt wird und vom Modell als Eingabe verwendet wird.  Im Prinzip können wir jetzt den gesamten Zyklus differenzierbar machen, wodurch wir den Einfluss der Umgebung auf die Entscheidungen des Modells direkt sehen können und umgekehrt.  Dies kann die Leistung einer realistischen simulierten Umgebung für Trainingsmodelle wie Autos mit automatischem Fahren erheblich erhöhen. </p><br><p>  Wie in der Wissenschaft können Hybridmodelle effizienter sein und einige der Kompromisse zwischen Deep Learning und expliziter Programmierung lösen.  Beispielsweise kann ein Drohnenflugwegplaner eine neuronale Netzwerkkomponente aufweisen, die nur geringfügige Korrekturen an einem zuverlässigen expliziten Programm vornehmen kann, wodurch sein Gesamtverhalten analysiert und an empirische Daten angepasst werden kann.  Dies ist auch gut für die Interpretierbarkeit: Die Parameter mechanistischer Modelle und Simulationen haben normalerweise klare physikalische Interpretationen. Wenn das Modell also die Parameter innerhalb bewertet, gibt es eine klare Aussage darüber, was seiner Meinung nach außerhalb geschieht. </p><br><p>  Wenn das alles so wunderbar ist, warum haben dann nicht alle aufgegeben und sich beeilt, Differenzieren zu lernen?  Leider machen es die Einschränkungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">bestehender Frameworks</a> schwierig, Modelle mit einer solchen Komplexität zu erstellen, und es ist unmöglich, den in den vorhandenen wissenschaftlichen Code eingebetteten Wissensschatz wiederzuverwenden.  Die Notwendigkeit, physische Engines in einer sehr eingeschränkten Modellierungssprache von Grund auf neu zu implementieren, macht aus einem zehnzeiligen Skript ein mehrjähriges Forschungsprojekt.  Aber Fortschritte in der Sprach- und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Zusammenstellungstechnologie</a> , insbesondere die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">automatische Differenzierung</a> , bringen uns dem Heiligen Gral näher: "Differenzieren Sie bitte nur meine Spiel-Engine." </p><br><h2 id="itak-chto-takoe-differenciruemoe-programmirovanie">  Was ist differenzierte Programmierung? </h2><br><p>  Durch differenzierte Programmierung können Sie Deep-Learning-Methoden auf komplexe vorhandene Programme anwenden und eine große Menge an darin eingebettetem Wissen wiederverwenden.  Deep Learning, Statistik, Programmierung und Wissenschaft - alles, was versucht, sein Wort bei der Modellierung der Welt um uns herum zu sagen - es ist Zeit, alles zu kombinieren und es wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Teilchen in einem Hadron-Collider zusammenzuschieben</a> .  Dies wird sowohl aktuelle Modelle verbessern als auch die Anwendung von ML in Bereichen ermöglichen, in denen die aktuellen Einschränkungen - entweder Interpretierbarkeit oder Rechen- und Datenanforderungen - dazu führen, dass sie nicht einzeln anwendbar sind. </p><br><h2 id="differenciruemye-problemy-upravleniya">  Differenzierbare Managementprobleme </h2><br><p>  Als nächstes zeigen wir, dass Differenzierbarkeit einige einfache, aber klassische Verwaltungsaufgaben mit sich bringen kann, bei denen wir normalerweise Reinforcement Learning (RL) als Black Box verwenden.  Differenzierbare Modelle (∂P-Modelle) zeigen nicht nur viel effektivere Steuerungsstrategien, sondern lernen auch mehrere Größenordnungen schneller.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Der Code steht</a> zum Lernen zur Verfügung - in den meisten Fällen lernt er in wenigen Sekunden auf jedem Laptop. </p><br><h2 id="sleduyte-za-gradientom">  Folgen Sie dem Gefälle </h2><br><p>  Differenzierung ist die treibende Kraft bei fast jedem Schritt des tiefen Lernens.  für diese Funktion <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.672ex" height="2.66ex" viewBox="0 -832 3733.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-66" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-28" x="2382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-78" x="2771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-29" x="3344" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> y = f (x) </script>  Wir benutzen den Gradienten <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>x</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.061ex" height="2.419ex" viewBox="0 -780.1 4332 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-79" x="523" y="0"></use></g><g transform="translate(3236,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-78" x="523" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ frac {dy} {dx} </script> um herauszufinden, wie sich eine Änderung von <code>x</code> auf <code>y</code> auswirkt.  Trotz der mathematischen Natur sind Gradienten tatsächlich ein sehr allgemeines und intuitives Konzept.  Vergessen Sie die Formeln, die Sie in der Schule beachten mussten.  Lassen Sie uns etwas mehr Spaß machen, wie etwas auf einen parabolischen Pfad zu werfen. </p><br><p><img src="https://habrastorage.org/webt/hy/uu/qr/hyuuqrkomuhvvl8h_wxnqlzkfas.gif"></p><br><p>  Wenn wir Projektile mit Hilfe eines Dreischusses werfen, repräsentiert unser <code>x</code> (Eingabe) die Einstellung (z. B. die Größe des Gegengewichts oder den Auswurfwinkel), und <code>y</code> ist die Entfernung, die das Projektil vor der Landung zurücklegt.  Wenn Sie versuchen zu zielen, sagt Ihnen der Verlauf etwas sehr Nützliches - Erhöhen oder Verringern eines bestimmten Parameters.  Um die Entfernung zu maximieren, folgen Sie einfach dem Farbverlauf. </p><br><p>  OK, aber wie bekommen wir den richtigen Parameter?  Aber mit Hilfe einer kniffligen Sache namens <a href="" rel="nofollow">algorithmische Differenzierung</a> , mit der Sie nicht nur einfache Formeln unterscheiden können, die Sie in der Schule gelernt haben, sondern auch Programme jeder Komplexität - zum Beispiel unseren <a href="" rel="nofollow">Trebuchet-Simulator</a> .  Infolgedessen können wir einen einfachen Simulator, der in Julia geschrieben ist, und ein Diff- <a href="" rel="nofollow">Diff-</a> Paket <a href="" rel="nofollow">DiffEq</a> ohne <a href="" rel="nofollow">eingehende</a> Untersuchung verwenden und Gradienten dafür in einem Funktionsaufruf erhalten. </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment"># what you did in school gradient(x -&gt; 3x^2 + 2x + 1, 5) # (32,) # something a little more advanced gradient((wind, angle, weight) -&gt; Trebuchet.shoot(wind, angle, weight), -2, 45, 200) # (4.02, -0.99, 0.051)</span></span></code> </pre> <br><h2 id="throwing-stuff">  Sachen werfen </h2><br><p>  Wir müssen das Trebuchet auf das Ziel richten und Gradienten verwenden, um den Auswurfwinkel fein abzustimmen.  Dies wird als Parameterschätzung bezeichnet, und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">wir haben uns bereits ähnliche Beispiele angesehen</a> .  Wir können die Aufgabe interessanter machen, indem wir zur Metamethode übergehen: Anstatt das Trebuchet auf ein Ziel zu richten, optimieren wir das neuronale Netzwerk, das es auf jedes Ziel ausrichten kann.  So funktioniert es: Ein neuronales Netzwerk akzeptiert zwei Eingaben, eine Zielentfernung in Metern und eine aktuelle Windgeschwindigkeit.  Im Netzwerk werden die Einstellungen für das Trebuchet (Masse des Gegengewichts und Auslösewinkel) festgelegt, die einem Simulator zugeführt werden, der die zurückgelegte Strecke berechnet.  Dann vergleichen wir mit unserem Ziel und bewegen uns entlang der gesamten Kette, um das Gewicht des Netzwerks anzupassen.  Unser „Datensatz“ ist ein zufällig ausgewählter Satz von Zielen und Windgeschwindigkeiten. </p><br><p><img src="https://habrastorage.org/webt/nc/gz/7w/ncgz7wwykokoutzvfgyrm4xbspm.png"></p><br><p>  Ein gutes Merkmal dieses einfachen Modells ist, dass das Lernen schnell ist, da wir genau das, was wir vom Modell wollen, auf völlig differenzierbare Weise ausgedrückt haben.  Anfangs sieht es so aus: </p><br><p><img src="https://habrastorage.org/webt/au/8a/-d/au8a-dfq1ud9_fhdcrbvzapfedi.gif"></p><br><p>  Nach ungefähr fünf Minuten Training (auf demselben Prozessorkern meines Laptops) sieht es so aus: </p><br><p><img src="https://habrastorage.org/webt/ta/wu/lr/tawulrzggnp09s7qwcyykbhqeqs.gif"></p><br><p>  Wenn Sie die Flugbahn beeinflussen möchten, erhöhen Sie die Windgeschwindigkeit: </p><br><p><img src="https://habrastorage.org/webt/qq/9m/dg/qq9mdgrns5hqcpzedeoh1-htrua.gif"></p><br><p>  Abweichung um 16 cm oder ca. 0,3%.  Was ist mit dem direkten Zielen auf das Trebuchet?  Dies ist mit Gradientenabstieg einfach zu tun, da wir Gradienten haben.  Dies ist jedoch ein langsamer iterativer Prozess, der jedes Mal etwa 100 ms dauert.  Im Gegenteil, der Betrieb eines neuronalen Netzwerks dauert 5 μs (zwanzigtausendmal schneller) mit einem leichten Genauigkeitsverlust.  Dieser Trick, der als "ungefähre Funktionsinversion durch Gradienten" bezeichnet wird, ist sehr verbreitet und kann nicht nur mit dynamischen Systemen, sondern auch mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">einem schnellen Übertragungsalgorithmus verwendet werden</a> . </p><br><p>  Dies ist das einfachste mögliche Verwaltungsproblem, das wir hauptsächlich zur Veranschaulichung verwenden.  Wir können jedoch dieselben Methoden auf fortgeschrittenere Weise auf die klassischen RL-Probleme anwenden. </p><br><h2 id="cart-meet-pole">  Wagen, Stange treffen </h2><br><p>  Eine erkennbarere Herausforderung für das Management ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">CartPole</a> , die „Hallo Welt“ für das verstärkte Lernen.  Die Herausforderung besteht darin, zu lernen, wie man die vertikale Säule ausbalanciert, indem man ihre Basis nach links oder rechts drückt.  Unser Setup ähnelt im Allgemeinen dem bei Trebuchet: Die <a href="" rel="nofollow">Implementierung von Julia</a> ermöglicht es uns, die von der Umwelt erhaltenen Belohnungen direkt als Verluste zu betrachten.  Mit ∂P können wir nahtlos von einem einfachen Modell zu einem RL-Modell wechseln. </p><br><p><img src="https://habrastorage.org/webt/ik/wp/0y/ikwp0y4qhogsybm3rakwiyxwfuc.png"></p><br><p>  Ein kluger Leser kann einen Haken bemerken.  Der Aktionsbereich für die Diele - ein Versatz nach links oder rechts - ist diskret und daher nicht differenzierbar.  Wir lösen dieses Problem, indem wir eine differenzierbare Diskretisierung einführen, die <a href="" rel="nofollow">wie folgt</a> definiert ist: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>f&amp;#xA0;(x)&amp;#xA0;=&amp;#xA0;\&amp;#xA0;left&amp;#xA0;\&amp;#xA0;{\&amp;#xA0;begin&amp;#xA0;{matrix}&amp;#xA0;\,&amp;#xA0;1,&amp;#xA0;\,&amp;#xA0;x&amp;#xA0;\&amp;#xA0;geqslant0&amp;#xA0;\\&amp;#xA0;-1,&amp;#xA0;\,&amp;#xA0;x&amp;#xA0;&amp;lt;0&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{matrix}&amp;#xA0;\&amp;#xA0;right.</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">f&nbsp;(x)&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{\&nbsp;begin&nbsp;{matrix}&nbsp;\,&nbsp;1,&nbsp;\,&nbsp;x&nbsp;\&nbsp;geqslant0&nbsp;\\&nbsp;-1,&nbsp;\,&nbsp;x&nbsp;&lt;0&nbsp;\&nbsp;end&nbsp;{matrix}&nbsp;\&nbsp;right.</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>f&nbsp;(x)&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{\&nbsp;begin&nbsp;{matrix}&nbsp;\,&nbsp;1,&nbsp;\,&nbsp;x&nbsp;\&nbsp;geqslant0&nbsp;\\&nbsp;-1,&nbsp;\,&nbsp;x&nbsp;&lt;0&nbsp;\&nbsp;end&nbsp;{matrix}&nbsp;\&nbsp;right.</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> f (x) = \ left \ {\ begin {matrix} \, 1, \, x \ geqslant0 \\ -1, \, x <0 \ end {matrix} \ right. </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>f</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>x</mi></mrow><mo>=</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.445ex" height="2.419ex" viewBox="0 -780.1 6219.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-66" x="523" y="0"></use></g><g transform="translate(3289,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-78" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-3D" x="4662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMAIN-31" x="5719" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>x</mi></mrow><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ frac {df} {dx} = 1 </script></p><br><p>  Mit anderen Worten, wir lassen den Gradienten so verhalten, als ob <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjghOpFOrjmiD4vUUzp_Tq5eWkj3w#MJMATHI-66" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> f </script>  war eine identische Funktion.  Angesichts der Tatsache, wie oft die mathematische Idee der Differenzierbarkeit bereits in ML verwendet wird, ist es vielleicht nicht verwunderlich, dass wir hier einfach einen Trick machen können.  Für das Training benötigen wir lediglich ein Signal, um unseren pseudozufälligen Rundgang durch den Parameterraum zu informieren, und der Rest sind die Details.  Die Ergebnisse sprechen für sich.  In Fällen, in denen RL-Methoden in Hunderten von Episoden trainiert werden müssen, bevor das Problem gelöst werden kann, benötigen ∂P-Modelle nur etwa 5 Episoden, um endgültig zu gewinnen. </p><br><p><img src="https://habrastorage.org/webt/7t/eq/hj/7teqhjn1f4rdicydv4iiqjasirm.gif"></p><br><h2 id="the-pendulum--backprop-through-time">  Das Pendel &amp; Backprop durch die Zeit </h2><br><p>  Ein wichtiges Ziel für RL <em>(Reinforcement Learning)</em> ist die Behandlung der aufgeschobenen Vergütung, wenn eine Maßnahme nicht dazu beiträgt, die Ergebnisse mehrerer Schritte hintereinander zu verbessern.  Wenn die Umgebung differenzierbar ist, können Sie mit ∂P den Agenten wie in einem rekursiven Netzwerk in der zeitlichen Rückausbreitung trainieren!  In diesem Fall wird der Zustand der Umgebung zu einem „verborgenen Zustand“, der sich zwischen den Zeitschritten ändert. </p><br><p><img src="https://habrastorage.org/webt/uy/od/mb/uyodmbo3grxrwkyawrgfol0nujo.png"></p><br><p>  Um diese Technik zu demonstrieren, betrachten Sie ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Pendelmodell</a> , bei dem die Aufgabe darin besteht, das Pendel zu schwenken, bis es aufrecht steht, und es in einem instabilen Gleichgewicht zu halten.  Dies ist für RL-Modelle schwierig.  Nach ungefähr 20 Trainingseinheiten ist das Problem gelöst, aber oft ist der Weg zur Lösung eindeutig nicht optimal.  Im Gegensatz dazu kann BPTT die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Rangliste der</a> RL- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Führungskräfte</a> in einer Trainingsphase übertreffen.  Es ist lehrreich zu beobachten, wie sich diese Episode entwickelt.  Zu Beginn der Aufzeichnung ist die Strategie zufällig und das Modell verbessert sich im Laufe der Zeit.  Das Lerntempo ist fast alarmierend. </p><br><p><img src="https://habrastorage.org/webt/jm/wm/nh/jmwmnhr9nts4ki257ywtittvgck.gif"></p><br><p>  Das Modell eignet sich gut für die Bearbeitung jedes Anfangswinkels und hat etwas, das der optimalen Strategie nahe kommt.  Beim Neustart sieht das Modell ungefähr so ​​aus. </p><br><p><img src="https://habrastorage.org/webt/bu/7f/t3/bu7ft3bzofjrdumbfqvvwqr0nz8.gif"></p><br><p>  Dies ist nur der Anfang;  Wir werden echten Erfolg erzielen, indem wir <em>DP</em> auf Umgebungen anwenden, mit denen RL im Allgemeinen zu schwierig zu bearbeiten ist, in denen bereits umfangreiche Simulationen und Modelle existieren (wie in den meisten Ingenieur- und Naturwissenschaften) und in denen die Interpretierbarkeit ein wichtiger Faktor ist (wie in der Medizin). </p><br><h2 id="the-map-is-not-the-territory">  Die Karte ist nicht das Territorium </h2><br><p>  Eine Einschränkung dieser Spielzeugmodelle besteht darin, dass sie die simulierte Lernumgebung mit der Testumgebung gleichsetzen.  Natürlich ist die reale Welt nicht differenzierbar.  In einem realistischeren Modell liefert die Simulation ein grobes Verhaltensmuster, das durch die Daten verfeinert wird.  Diese Daten informieren beispielsweise über die simulierten Auswirkungen des Windes, was wiederum die Qualität der Gradienten verbessert, die der Simulator an die Steuerung weitergibt.  Modelle können sogar Teil des direkten Durchlaufs des Controllers sein, sodass er seine Prognosen verfeinern kann, ohne die Systemdynamik von Grund auf neu untersuchen zu müssen.  Das Erlernen dieser neuen Architekturen wird eine spannende zukünftige Arbeit ermöglichen. </p><br><h2 id="coda">  Coda </h2><br><p>  Die Grundidee ist, dass differenzierbare Programmierung, bei der wir einfach ein beliebiges numerisches Programm schreiben und es mithilfe von Verläufen optimieren, eine leistungsstarke Möglichkeit ist, bessere Modelle und Architekturen zu erstellen, die dem Deep Learning ähneln, insbesondere wenn wir eine große Bibliothek differenzierbarer Programme zur Hand haben .  Die beschriebenen Modelle sind nur Vorschauen, aber wir hoffen, dass sie eine Vorstellung davon geben, wie diese Ideen realistischer umgesetzt werden können. </p><br><p>  So wie funktionale Programmierung das Denken und Ausdrücken von Algorithmen unter Verwendung funktionaler Muster beinhaltet, beinhaltet differenzierbares Programmieren das Ausdrücken von Algorithmen unter Verwendung differenzierbarer Muster.  Die Deep-Learning-Community hat bereits viele solcher Entwurfsmuster entwickelt, um beispielsweise Verwaltungsprobleme oder eine konsistente und baumartige Datenstruktur zu behandeln.  Wenn das Gebiet wächst, wird viel mehr erfunden, und als Ergebnis dieser Programme werden wahrscheinlich sogar die fortschrittlichsten Deep-Learning-Architekturen unhöflich und rückständig aussehen. </p><br><h3 id="ssylki">  Referenzen </h3><br><ul><li>  Quellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">erstens</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">zweitens</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Wikipedia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Automatische Differenzierung;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel über habr</a> </li><li>  <a href="" rel="nofollow">Automatische Differenzierung;</a>  <a href="" rel="nofollow">fertiges Paket</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Automatische Differenzierung;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">mit seinen eigenen Händen</a> </li></ul><br><p><img src="https://habrastorage.org/webt/f2/4o/pr/f24oprfnnrnguwwb03xcyo__xx4.gif"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459562/">https://habr.com/ru/post/de459562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459550/index.html">Backup, Teil 5: Testen von Bacula und Veeam Backup für Linux</a></li>
<li><a href="../de459552/index.html">So verlieren Sie den Zugriff auf das Live-System, indem Sie einfach den Quellcode fummeln</a></li>
<li><a href="../de459554/index.html">Verfolgen Sie Dateiänderungen mithilfe von Alerting OpenDistro for Elasticsearch</a></li>
<li><a href="../de459558/index.html">So starten Sie den Benutzermodus unter Linux</a></li>
<li><a href="../de459560/index.html">Funktionen von Container-Rechenzentren: Fertige Vermittlungsstelle in Myanmar in 50 Tagen</a></li>
<li><a href="../de459564/index.html">Was Entwickler über das Geschäft wissen müssen</a></li>
<li><a href="../de459568/index.html">Vertikaler Buchstabe in der modernen IT</a></li>
<li><a href="../de459570/index.html">Beeline zeigt Anzeigen für Google Bot. Bot unglücklich</a></li>
<li><a href="../de459574/index.html">Eintauchen in Linux-Namespaces, Teil 2</a></li>
<li><a href="../de459576/index.html">Nützliche Google Chrome-Erweiterungen für den Programmierer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>