<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🤝‍👨🏼 🛀🏼 👚 Redux Toolkit como uma ferramenta para o desenvolvimento eficaz do Redux 🕉️ 👨🏼‍🍳 🚺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Atualmente, a maior parte dos aplicativos da Web baseados na estrutura React está sendo desenvolvida usando a biblioteca Redux. Essa biblioteca é a im...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Redux Toolkit como uma ferramenta para o desenvolvimento eficaz do Redux</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inobitec/blog/481288/"><p><img src="https://habrastorage.org/getpro/habr/post_images/aad/f48/d2f/aadf48d2f864cef234b3b73d600dc8d1.jpg" alt="imagem"><br>  Atualmente, a maior parte dos aplicativos da Web baseados na estrutura React está sendo desenvolvida usando a biblioteca Redux.  Essa biblioteca é a implementação mais popular da arquitetura FLUX e, apesar de várias vantagens óbvias, possui desvantagens muito significativas, como: </p><br><ul><li>  a complexidade e a "verbosidade" dos padrões recomendados para escrever e organizar o código, o que implica um grande número de clichês; </li><li>  falta de controles internos para comportamento assíncrono e efeitos colaterais, o que leva à necessidade de escolher a ferramenta certa a partir de uma variedade de complementos criados por desenvolvedores de terceiros. </li></ul><br><p>  Para resolver essas deficiências, os desenvolvedores do Redux introduziram a biblioteca do Redux Toolkit.  Essa ferramenta é um conjunto de soluções e métodos práticos projetados para simplificar o desenvolvimento de aplicativos usando o Redux.  Os desenvolvedores desta biblioteca tiveram como objetivo simplificar casos típicos de uso do Redux.  Essa ferramenta não é uma solução universal em cada um dos casos possíveis de uso do Redux, mas permite simplificar o código que o desenvolvedor precisa escrever. </p><br><p>  Neste artigo, falaremos sobre as principais ferramentas incluídas no Redux Toolkit e também, usando um exemplo de fragmento de nosso aplicativo interno, mostraremos como usá-las no código existente. </p><a name="habracut"></a><br><h2 id="kratko-o-biblioteke">  Brevemente sobre a biblioteca </h2><br><p>  Resumo do Redux Toolkit: </p><br><ul><li> antes do lançamento, a biblioteca era chamada redux-starter-kit; </li><li>  o lançamento ocorreu no final de outubro de 2019; </li><li>  A biblioteca é oficialmente suportada pelos desenvolvedores do Redux. </li></ul><br><p>  Segundo <a href="https://redux-toolkit.js.org/introduction/quick-start">os desenvolvedores</a> , o Redux Toolkit executa as seguintes funções: </p><br><ul><li>  Ajuda você a começar rapidamente usando o Redux </li><li>  simplifica o trabalho com tarefas típicas e código Redux; </li><li>  permite que você use as melhores práticas do Redux por padrão; </li><li>  oferece soluções que reduzem a desconfiança dos boilerplates. </li></ul><br><p>  O Redux Toolkit fornece um conjunto de ferramentas especialmente projetadas e adiciona uma série de <a href="https://redux-toolkit.js.org/api/other-exports">ferramentas</a> comprovadas que são comumente usadas com o Redux.  Essa abordagem permite que o desenvolvedor decida como e quais ferramentas usar em seu aplicativo.  No decorrer deste artigo, observaremos quais empréstimos essa biblioteca usa.  Para obter mais informações e dependências do Redux Toolkit, consulte a descrição do pacote <a href="https://www.npmjs.com/package/%40reduxjs/toolkit">@ reduxjs / toolkit</a> . </p><br><p>  Os recursos mais significativos fornecidos pela biblioteca Redux Toolkit são: </p><br><ul><li>  <a href="https://habr.com/ru/company/inobitec/blog/481288/">#configureStore</a> - uma função projetada para simplificar o processo de criação e configuração de armazenamento; </li><li>  <a href="https://habr.com/ru/company/inobitec/blog/481288/">#createReducer</a> - uma função que ajuda a descrever e criar concisa e claramente um redutor; </li><li>  <a href="https://habr.com/ru/company/inobitec/blog/481288/">#createAction</a> - retorna a função do criador da ação para a sequência especificada do tipo de ação; </li><li>  <a href="https://habr.com/ru/company/inobitec/blog/481288/">#createSlice</a> - combina a funcionalidade de createAction e createReducer; </li><li>  createSelector é uma função da biblioteca <a href="https://github.com/reduxjs/reselect">Reselect</a> , <a href="https://github.com/reduxjs/reselect">reexportada</a> para facilitar o uso. </li></ul><br><p>  Também é importante notar que o Redux Toolkit está totalmente integrado ao TypeScript.  Para obter mais informações, consulte a seção <a href="https://redux-toolkit.js.org/usage/usage-with-typescript/">Uso com TypeScript</a> da documentação oficial. </p><br><h2 id="primenenie">  Aplicação </h2><br><p>  Considere usar a biblioteca Redux Toolkit como um exemplo de um fragmento de um aplicativo React Redux realmente usado. <br>  <em>Nota</em>  Mais adiante neste artigo, o código fonte será apresentado sem o Redux Toolkit e com o mesmo, o que permitirá avaliar melhor os aspectos positivos e negativos do uso desta biblioteca. </p><br><h3 id="zadacha">  Desafio </h3><br><p>  Em um de nossos aplicativos internos, havia a necessidade de adicionar, editar e exibir informações sobre as versões de nossos produtos de software.  Para cada uma dessas ações, funções API separadas foram desenvolvidas, cujos resultados precisam ser adicionados ao repositório Redux.  Como forma de controlar o comportamento assíncrono e os efeitos colaterais, usaremos o <a href="https://github.com/reduxjs/redux-thunk">Thunk</a> . </p><br><h3 id="sozdanie-hranilischa">  Criação de armazenamento </h3><br><p>  A versão inicial do código-fonte que cria o repositório tinha a seguinte aparência: </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore, applyMiddleware, combineReducers, compose, } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> thunk <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-thunk'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ext = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__REDUX_DEVTOOLS_EXTENSION__; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> devtoolMiddleware = ext &amp;&amp; process.env.NODE_ENV === <span class="hljs-string"><span class="hljs-string">'development'</span></span> ? ext() : <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f</span></span></span><span class="hljs-function"> =&gt;</span></span> f; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore( combineReducers({ ...reducers, }), compose( applyMiddleware(thunk), devtoolMiddleware ) );</code> </pre> <br><p>  Se você observar atentamente o código acima, poderá ver uma sequência bastante longa de ações que devem ser concluídas para que o armazenamento esteja totalmente configurado.  O Redux Toolkit contém uma ferramenta projetada para simplificar esse procedimento, a saber, a função configureStore. </p><br><h4 id="funkciya-configurestoreanchorconfigurestoreanchor">  Função ConfigureStore <a name="configureStore"></a></h4><br><p>  Essa ferramenta permite combinar automaticamente redutores, adicionar middleware Redux (o padrão inclui redux-thunk) e também usar a extensão Redux DevTools.  A função configureStore aceita um objeto com as seguintes propriedades como parâmetros de entrada: </p><br><ul><li>  redutor - um conjunto de redutores personalizados, </li><li>  middleware - um parâmetro opcional que especifica uma matriz de middleware projetada para conectar-se ao repositório, </li><li>  devTools - um parâmetro do tipo lógico que permite ativar a extensão Redux DevTools instalada no navegador (o valor padrão é true), </li><li>  preloadedState - um parâmetro opcional que define o estado inicial do repositório, </li><li>  aprimoradores - um parâmetro opcional que define um conjunto de amplificadores. </li></ul><br><p>  Para obter a lista mais popular de middleware, você pode usar a função especial getDefaultMiddleware, que também faz parte do Redux Toolkit.  Essa função retorna uma matriz com o middleware ativado por padrão na biblioteca do Redux Toolkit.  A lista desses middlewares difere dependendo do modo em que seu código é executado.  No modo de produção, uma matriz consiste em apenas um elemento - thunk.  No modo de desenvolvimento, no momento da redação, a lista é reabastecida com o seguinte middleware: </p><br><ul><li>  serializableStateInvariant - uma ferramenta especialmente desenvolvida para uso no Redux Toolkit e projetada para verificar a árvore de estados quanto à presença de valores não serializáveis, como funções, Promessa, Símbolo e outros valores que não são simples dados JS; </li><li>  immutableStateInvariant - middleware do pacote <a href="https://www.npmjs.com/package/redux-immutable-state-invariant">redux-immutable-state-invariant</a> , projetado para detectar mutações nos dados armazenados no repositório. </li></ul><br><p>  Para especificar uma lista crescente de middleware, a função getDefaultMidlleware aceita um objeto que define a lista de middleware e as configurações incluídas para cada um deles.  Mais informações sobre essas informações podem ser encontradas na <a href="https://redux-toolkit.js.org/api/getDefaultMiddleware">seção</a> correspondente <a href="https://redux-toolkit.js.org/api/getDefaultMiddleware">da</a> documentação oficial. </p><br><p>  Agora, reescreveremos a seção de código responsável pela criação do repositório usando as ferramentas descritas acima.  Como resultado, obtemos o seguinte: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { configureStore, getDefaultMiddleware } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@reduxjs/toolkit'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> middleware = getDefaultMiddleware({ <span class="hljs-attr"><span class="hljs-attr">immutableCheck</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">serializableCheck</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">thunk</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = configureStore({ <span class="hljs-attr"><span class="hljs-attr">reducer</span></span>: { ...reducers }, middleware, <span class="hljs-attr"><span class="hljs-attr">devTools</span></span>: process.env.NODE_ENV !== <span class="hljs-string"><span class="hljs-string">'production'</span></span>, });</code> </pre> <br><p>  Usando o exemplo desta seção de código, você pode ver claramente que a função configureStore resolve os seguintes problemas: </p><br><ul><li>  a necessidade de combinar redutores, chamando automaticamente combineReducers, </li><li>  a necessidade de combinar o middleware, chamando automaticamente o applyMiddleware. </li></ul><br><p>  Ele também permite que você ative mais convenientemente a extensão Redux DevTools usando a função <a href="https://www.npmjs.com/package/redux-devtools-extension">composeWithDevTools do</a> pacote <a href="https://www.npmjs.com/package/redux-devtools-extension">redux-devtools-extension</a> .  Todos os itens acima indicam que o uso desta função permite tornar o código mais compacto e compreensível. </p><br><p>  Isso conclui a criação e configuração do repositório.  Transferimos para o provedor e continuamos. </p><br><h3 id="deystviya-sozdateli-deystviy-i-redyuser">  Ações, criadores de ações e redutor </h3><br><p>  Agora, vejamos os recursos do Redux Toolkit em termos de desenvolvimento de ações, criadores de ações e redutor.  A versão inicial do código sem usar o Redux Toolkit foi organizada como arquivos actions.js e reducers.js.  O conteúdo do arquivo actions.js ficou assim: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> productReleasesService <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../services/productReleases'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PRODUCT_RELEASES_FETCHING = <span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASES_FETCHING'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PRODUCT_RELEASES_FETCHED = <span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASES_FETCHED'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PRODUCT_RELEASES_FETCHING_ERROR = <span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASES_FETCHING_ERROR'</span></span>; … <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PRODUCT_RELEASE_UPDATING = <span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASE_UPDATING'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PRODUCT_RELEASE_UPDATED = <span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASE_UPDATED'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PRODUCT_RELEASE_CREATING_UPDATING_ERROR = <span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASE_CREATING_UPDATING_ERROR'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">productReleasesFetching</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: PRODUCT_RELEASES_FETCHING }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">productReleasesFetched</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productReleases</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: PRODUCT_RELEASES_FETCHED, productReleases }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">productReleasesFetchingError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: PRODUCT_RELEASES_FETCHING_ERROR, error } } … <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchProductReleases</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function"> =&gt;</span></span> { dispatch(productReleasesFetching()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productReleasesService.getProductReleases().then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productReleases</span></span></span><span class="hljs-function"> =&gt;</span></span> dispatch(productReleasesFetched(productReleases)) ).catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { error.clientMessage = <span class="hljs-string"><span class="hljs-string">"Can't get product releases"</span></span>; dispatch(productReleasesFetchingError(error)) }); } } … <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateProductRelease</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> id, productName, productVersion, releaseDate </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function"> =&gt;</span></span> { dispatch(productReleaseUpdating()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productReleasesService.updateProductRelease( id, productName, productVersion, releaseDate ).then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productRelease</span></span></span><span class="hljs-function"> =&gt;</span></span> dispatch(productReleaseUpdated(productRelease)) ).catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { error.clientMessage = <span class="hljs-string"><span class="hljs-string">"Can't update product releases"</span></span>; dispatch(productReleaseCreatingUpdatingError(error)) }); } }</code> </pre> <br><p>  Conteúdo do arquivo reducers.js antes de usar o Redux Toolkit: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">productReleases</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">loadedProductRelease</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">fetchingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">creatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">updatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = initialState, action = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> productReleases.PRODUCT_RELEASES_FETCHING: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">fetchingState</span></span>: <span class="hljs-string"><span class="hljs-string">'requesting'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> productReleases.PRODUCT_RELEASES_FETCHED: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">productReleases</span></span>: action.productReleases, <span class="hljs-attr"><span class="hljs-attr">fetchingState</span></span>: <span class="hljs-string"><span class="hljs-string">'success'</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> productReleases.PRODUCT_RELEASES_FETCHING_ERROR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">fetchingState</span></span>: <span class="hljs-string"><span class="hljs-string">'failed'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.error }; … <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> productReleases.PRODUCT_RELEASE_UPDATING: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">updatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'requesting'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> productReleases.PRODUCT_RELEASE_UPDATED: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">updatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'success'</span></span>, <span class="hljs-attr"><span class="hljs-attr">productReleases</span></span>: state.productReleases.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productRelease</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (productRelease.id === action.productRelease.id) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action.productRelease; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productRelease; }) }; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> productReleases.PRODUCT_RELEASE_UPDATING_ERROR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">updatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'failed'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.error }; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } }</code> </pre> <br><p>  Como podemos ver, é aqui que a maior parte do clichê está contida: constantes do tipo de ação, criadores de ações, constantes novamente, mas no código redutor, leva tempo para escrever todo esse código.  Você pode se livrar parcialmente desse padrão usando as funções createAction e createReducer, que também fazem parte do Redux Toolkit. </p><br><h4 id="funkciya-createactionanchorcreateactionanchor">  Função CreateAction <a name="createAction"></a></h4><br><p>  Na seção de código fornecida, o método padrão para definir uma ação no Redux é usado: primeiro, uma constante é definida separadamente que determina o tipo de ação e, em seguida - a função do criador da ação desse tipo.  A função <a href="https://redux-toolkit.js.org/api/createaction/">createAction</a> combina essas duas declarações em uma.  Na entrada, ele executa um tipo de ação e retorna o criador da ação para esse tipo.  O criador da ação pode ser chamado sem argumentos ou com algum argumento (carga útil), cujo valor será colocado no campo de carga útil da ação criada.  Além disso, o criador da ação substitui a função toString (), para que o tipo de ação se torne sua representação de sequência. </p><br><p>  Em alguns casos, pode ser necessário escrever uma lógica adicional para ajustar o valor da carga, por exemplo, aceitar vários parâmetros para o criador da ação, criar um identificador aleatório ou obter o carimbo de data / hora atual.  Para fazer isso, createAction usa um segundo argumento opcional - uma função que será usada para atualizar o valor da carga útil.  Mais informações sobre este <a href="https://redux-toolkit.js.org/api/createaction/">parâmetro</a> podem ser encontradas na documentação oficial. <br>  Usando a função createAction, obtemos o seguinte código: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productReleasesFetching = createAction(<span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASES_FETCHING'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productReleasesFetched = createAction(<span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASES_FETCHED'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productReleasesFetchingError = createAction(<span class="hljs-string"><span class="hljs-string">'PRODUCT_RELEASES_FETCHING_ERROR'</span></span>); … <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchProductReleases</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function"> =&gt;</span></span> { dispatch(productReleasesFetching()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productReleasesService.getProductReleases().then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productReleases</span></span></span><span class="hljs-function"> =&gt;</span></span> dispatch(productReleasesFetched({ productReleases })) ).catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { error.clientMessage = <span class="hljs-string"><span class="hljs-string">"Can't get product releases"</span></span>; dispatch(productReleasesFetchingError({ error })) }); } } ...</code> </pre> <br><h4 id="funkciya-createreduceranchorcreatereduceranchor">  Função CreateReducer <a name="createReducer"></a></h4><br><p>  Agora considere o redutor.  Como no nosso exemplo, os redutores geralmente são implementados usando a instrução switch, com um registro para cada tipo de ação processada.  Essa abordagem funciona bem, mas não está isenta de clichês e está sujeita a erros.  Por exemplo, é fácil esquecer de descrever o caso padrão ou não definir o estado inicial.  A função <a href="https://redux-toolkit.js.org/api/createreducer/">createReducer</a> simplifica a criação de funções redutoras, definindo-as como tabelas de procura de função para processar cada tipo de ação.  Ele também permite que você simplifique significativamente a lógica de atualizações imutáveis ​​escrevendo código em um estilo "mutável" dentro de redutores. </p><br><p>  Um estilo robusto de manipulação de eventos está disponível através do uso da biblioteca <a href="https://immerjs.github.io/immer/docs/introduction">Immer</a> .  A função do manipulador pode "mudar" o estado passado para alterar as propriedades ou retornar um novo estado, como quando se trabalha no estilo imutável, mas graças a Immer, a mutação real do objeto não é realizada.  A primeira opção é muito mais fácil para o trabalho e a percepção, especialmente ao alterar um objeto com aninhamento profundo. </p><br><p>  Cuidado: o retorno de um novo objeto a partir de uma função substitui as alterações "mutáveis".  O uso simultâneo de ambos os métodos de atualização de estado não funcionará. </p><br><p>  A função createReducer aceita os seguintes argumentos como parâmetros de entrada: </p><br><ul><li>  estado inicial de armazenamento </li><li>  um objeto que estabelece uma correspondência entre tipos de ações e redutores, cada um dos quais processa um determinado tipo. </li></ul><br><p>  Usando o método createReducer, obtemos o seguinte código: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">productReleases</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">loadedProductRelease</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">fetchingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">creatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">loadingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> counterReducer = createReducer(initialState, { [productReleasesFetching]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.fetchingState = <span class="hljs-string"><span class="hljs-string">'requesting'</span></span> }, [productReleasesFetched.type]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.productReleases = action.payload.productReleases; state.fetchingState = <span class="hljs-string"><span class="hljs-string">'success'</span></span>; }, [productReleasesFetchingError]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.fetchingState = <span class="hljs-string"><span class="hljs-string">'failed'</span></span>; state.error = action.payload.error; }, … [productReleaseUpdating]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.updatingState = <span class="hljs-string"><span class="hljs-string">'requesting'</span></span> }, [productReleaseUpdated]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.updatingState = <span class="hljs-string"><span class="hljs-string">'success'</span></span>; state.productReleases = state.productReleases.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productRelease</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (productRelease.id === action.payload.productRelease.id) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action.payload.productRelease; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productRelease; }); }, [productReleaseUpdatingError]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.updating = <span class="hljs-string"><span class="hljs-string">'failed'</span></span>; state.error = action.payload.error; }, });</code> </pre> <br><p>  Como podemos ver, o uso das funções createAction e createReducer basicamente resolve o problema de escrever código extra, mas o problema de criar constantes antes ainda permanece.  Portanto, consideramos uma opção mais poderosa que combina a geração de criadores e redutores de ação - a função createSlice. </p><br><h4 id="funkciya-createsliceanchorcreatesliceanchor">  Função CreateSlice <a name="createSlice"></a></h4><br><p>  A função createSlice aceita um objeto com os seguintes campos como parâmetros de entrada: </p><br><ul><li>  name - namespace das ações criadas ( <code>${name}/${action.type}</code> ); </li><li>  initialState - estado inicial do redutor; </li><li>  redutores - um objeto com manipuladores.  Cada manipulador assume uma função com argumentos estado e ação, ação contém dados na propriedade carga útil e o nome do evento na propriedade name.  Além disso, é possível alterar preliminarmente os dados recebidos do evento antes que ele entre no redutor (por exemplo, adicione um ID aos elementos da coleção).  Para fazer isso, em vez de uma função, você deve passar um objeto com o redutor e preparar os campos, em que redutor é a função do manipulador de ações e prepare é a função do manipulador de carga útil que retorna a carga útil atualizada; </li><li>  extraReducers - um objeto que contém redutores de outra fatia.  Este parâmetro pode ser necessário se for necessário atualizar um objeto pertencente a outra fatia.  Você pode aprender mais sobre essa funcionalidade na <a href="https://redux-toolkit.js.org/api/createSlice">seção</a> correspondente <a href="https://redux-toolkit.js.org/api/createSlice">da</a> documentação oficial. </li></ul><br><p>  O resultado da função é um objeto chamado "fatia", com os seguintes campos: </p><br><ul><li>  nome - nome da fatia, </li><li>  redutor - redutor, </li><li>  ações - um conjunto de ações. </li></ul><br><p>  Usando esta função para resolver nosso problema, obtemos o seguinte código-fonte: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">productReleases</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">loadedProductRelease</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">fetchingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">creatingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">loadingState</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productReleases = createSlice({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'productReleases'</span></span>, initialState, <span class="hljs-attr"><span class="hljs-attr">reducers</span></span>: { <span class="hljs-attr"><span class="hljs-attr">productReleasesFetching</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.fetchingState = <span class="hljs-string"><span class="hljs-string">'requesting'</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">productReleasesFetched</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.productReleases = action.payload.productReleases; state.fetchingState = <span class="hljs-string"><span class="hljs-string">'success'</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">productReleasesFetchingError</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.fetchingState = <span class="hljs-string"><span class="hljs-string">'failed'</span></span>; state.error = action.payload.error; }, … productReleaseUpdating: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.updatingState = <span class="hljs-string"><span class="hljs-string">'requesting'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">productReleaseUpdated</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.updatingState = <span class="hljs-string"><span class="hljs-string">'success'</span></span>; state.productReleases = state.productReleases.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productRelease</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (productRelease.id === action.payload.productRelease.id) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action.payload.productRelease; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productRelease; }); }, <span class="hljs-attr"><span class="hljs-attr">productReleaseUpdatingError</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { state.updating = <span class="hljs-string"><span class="hljs-string">'failed'</span></span>; state.error = action.payload.error; }, }, });</code> </pre> <br><p>  Agora, extrairemos os criadores e redutores de ação da fatia criada. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { actions, reducer } = productReleases; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { productReleasesFetched, productReleasesFetching, productReleasesFetchingError, … productReleaseUpdated, productReleaseUpdating, productReleaseUpdatingError } = actions; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> reducer;</code> </pre> <br><p>  O código-fonte dos criadores da ação que contém as chamadas da API não foi alterado, exceto pelo método de passar parâmetros ao enviar ações: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fetchProductReleases = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> (dispatch) =&gt; { dispatch(productReleasesFetching()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productReleasesService .getProductReleases() .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productReleases</span></span></span><span class="hljs-function">) =&gt;</span></span> dispatch(productReleasesFetched({ productReleases }))) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) =&gt;</span></span> { error.clientMessage = <span class="hljs-string"><span class="hljs-string">"Can't get product releases"</span></span>; dispatch(productReleasesFetchingError({ error })); }); }; … <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> updateProductRelease = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, productName, productVersion, releaseDate</span></span></span><span class="hljs-function">) =&gt;</span></span> (dispatch) =&gt; { dispatch(productReleaseUpdating()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productReleasesService .updateProductRelease(id, productName, productVersion, releaseDate) .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">productRelease</span></span></span><span class="hljs-function">) =&gt;</span></span> dispatch(productReleaseUpdated({ productRelease }))) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) =&gt;</span></span> { error.clientMessage = <span class="hljs-string"><span class="hljs-string">"Can't update product releases"</span></span>; dispatch(productReleaseUpdatingError({ error })); });</code> </pre> <br><p>  O código acima mostra que a função createSlice permite que você se livre de uma parte significativa do clichê ao trabalhar com o Redux, o que permite não apenas tornar o código mais compacto, conciso e compreensível, como também gastar menos tempo escrevendo-o. </p><br><h2 id="itog">  Sumário </h2><br><p>  No final deste artigo, gostaria de dizer que, apesar de a biblioteca Redux Toolkit não adicionar nada de novo ao gerenciamento de armazenamento, ela fornece vários meios muito mais convenientes para escrever código do que antes.  Essas ferramentas permitem não apenas tornar o processo de desenvolvimento mais conveniente, compreensível e rápido, mas também mais eficaz devido à presença na biblioteca de várias ferramentas comprovadas.  Inobitek, planejamos continuar a usar essa biblioteca no desenvolvimento de nossos produtos de software e monitorar novos desenvolvimentos promissores no campo das tecnologias da Web. </p><br><p>  Obrigado pela atenção.  Esperamos que nosso artigo seja útil.  Mais informações sobre a biblioteca Redux Toolkit podem ser obtidas na <a href="https://redux-toolkit.js.org/">documentação</a> oficial. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt481288/">https://habr.com/ru/post/pt481288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt481272/index.html">Congelamento ou modernização - o que fazemos nas férias?</a></li>
<li><a href="../pt481276/index.html">Como eu criei meu YP e compilador para ele por 12 anos</a></li>
<li><a href="../pt481280/index.html">Como preparamos a etapa de qualificação da CTFZone-2020</a></li>
<li><a href="../pt481282/index.html">Qual é o valor da ideia e como transformá-la em conceito: ferramentas de designer de jogos</a></li>
<li><a href="../pt481286/index.html">Pegue a mesa! Office pequenas coisas que não são pequenas coisas</a></li>
<li><a href="../pt481290/index.html">Configurações de HOW-to / Network e VLAN em um servidor Hetzner e Mikrotik dedicado</a></li>
<li><a href="../pt481294/index.html">10 melhores ferramentas de automação de teste de software</a></li>
<li><a href="../pt481296/index.html">Como escrever código que será reutilizado</a></li>
<li><a href="../pt481302/index.html">"Sobre, sim, não um cluster" ou como importamos DBMS</a></li>
<li><a href="../pt481304/index.html">Classificação da bandeira americana</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>