<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçü§ù‚Äçüë®üèæ üóø ü§ó Starten der SAP-GUI √ºber einen Browser üë∑ üõçÔ∏è üçÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich habe diesen Artikel zuerst in meinem Blog geschrieben , damit ich sp√§ter nicht mehr hinschaue und mich daran erinnere, aber da niemand das Blog li...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Starten der SAP-GUI √ºber einen Browser</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446998/"> <i>Ich habe diesen Artikel zuerst in meinem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Blog geschrieben</a> , damit ich sp√§ter nicht mehr hinschaue und mich daran erinnere, aber da niemand das Blog liest, wollte ich diese Informationen mit allen teilen, pl√∂tzlich konnte ich sie verwenden.</i> <br><br>  Bei der Arbeit an der Idee eines Service zum Zur√ºcksetzen von Passw√∂rtern in SAP R / 3-Systemen stellte sich die Frage, wie die SAP-GUI mit den erforderlichen Parametern √ºber den Browser gestartet werden kann.  Da diese Idee die Verwendung eines Webdienstes implizierte, der zuerst eine SOAP-Anforderung von der SAP-GUI erf√ºllt und eine E-Mail mit einem Link zu einer Webseite mit einem Skript zum Zur√ºcksetzen des Kennworts an das urspr√ºngliche sendet, zeigt er dem Benutzer eine Nachricht √ºber ein erfolgreiches Zur√ºcksetzen des Kennworts an und zeigt dieses sehr anf√§ngliche Kennwort an , dann m√∂chte ich, dass es auf dieser Seite auch einen Link zum Starten der SAP GUI gab.  Damit dieser Link das gew√ºnschte System √∂ffnet, und vorzugsweise sogar sofort mit den ausgef√ºllten Anmelde- und Kennwortfeldern: Der Benutzer m√ºsste nur zweimal ein produktives Kennwort ausf√ºllen. <br><br>  Das Starten von SAP Logon war f√ºr unseren Zweck nicht interessant, und beim Starten von sapgui.exe war es unm√∂glich, den Client und den Benutzernamen anzugeben, aber es war m√∂glich, das System zu starten, das nicht in SAP Logon definiert ist.  Andererseits war das Starten der SAP-GUI mit beliebigen Serverparametern nicht besonders relevant: Wenn wir das Problem des Zur√ºcksetzens des Benutzerkennworts l√∂sen, hat er h√∂chstwahrscheinlich bereits die richtige Zeile in SAP Logon mit den Einstellungen, die er ben√∂tigt, und muss sich nicht um seine eigenen k√ºmmern.  Andererseits erf√ºllten die SAP GUI Shortcut-Technologie und das Programm sapshcut.exe selbst, die es erm√∂glichten, die SAP GUI mit einer bestimmten ‚ÄûVerkn√ºpfung‚Äú zu starten, die angegebenen Anforderungen. <br><a name="habracut"></a><br>  Die L√∂sung f√ºr das Problem in der Stirn: Ausf√ºhren von sapshcut.exe direkt vom Browser aus mit dem ActiveX-Objekt: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sid, client, user, password</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveXObject(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>); shell.run(<span class="hljs-string"><span class="hljs-string">'sapshcut.exe -system="'</span></span>+sid+<span class="hljs-string"><span class="hljs-string">'" -client='</span></span>+client+<span class="hljs-string"><span class="hljs-string">' -user="'</span></span>+user+<span class="hljs-string"><span class="hljs-string">'" -pw="'</span></span>+password+<span class="hljs-string"><span class="hljs-string">'" -language=RU'</span></span>); }</code> </pre> <br>  Die L√∂sung ist schlecht: Erstens funktioniert es nur in Internet Explorer, und zweitens sind entsprechende Sicherheitseinstellungen im Browser erforderlich, die auf Dom√§nenebene in der Organisation verboten werden k√∂nnen. Selbst wenn diese Option aktiviert ist, gibt der Browser dem Benutzer ein Fenster mit einer erschreckenden Warnung: <br><br><img src="https://habrastorage.org/webt/ta/wg/i0/tawgi0nixqmmuxehbtyeqpmmabw.png"><br><br>  Ich habe die L√∂sung Nr. 2 im Internet ausgegraben: <a href="">mein eigenes Webprotokoll erstellen</a> .  Sie k√∂nnen die ben√∂tigte Anwendung √ºber den Link ausf√ºhren, der das Protokoll angibt, das wir selbst in Windows in der Registrierung im Abschnitt HKEY_CLASSES_ROOT registrieren.  Da die SAP-GUI-Verkn√ºpfung in diesem Abschnitt einen eigenen Unterabschnitt hat, k√∂nnen Sie den URL-Protokoll-Zeichenfolgenparameter mit einem leeren Wert hinzuf√ºgen: <br><br><img src="https://habrastorage.org/webt/cp/gn/rs/cpgnrseqoua-yjn_cuoazf9ili4.png"><br><br>  Dieses Protokoll startet <b>sapgui.exe</b> mit dem Parameter <b>/ SHORTCUT</b> , den wir ben√∂tigen: <br><br><img src="https://habrastorage.org/webt/cu/63/th/cu63thnkw3vqtjrokx1xhpckkom.png"><br><br>  Nun, oder wenn wir ein beliebiges Protokoll im Allgemeinen <b>erstellen</b> m√∂chten (z. B. <b>sapshcut</b> ), k√∂nnen Sie es mithilfe der folgenden Registrierungsdatei registrieren: <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CLASSES_ROOT\sapshcut] <br> @="sapshcut Handler" <br> "URL Protocol"="" <br> [HKEY_CLASSES_ROOT\sapshcut\DefaultIcon] <br> @="sapshcut.exe" <br> [HKEY_CLASSES_ROOT\sapshcut\shell] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open\command] <br> @="sapshcut.exe \"%1\"" <br></code> <br>  Wenn wir nun auf der Webseite einen Link <b>erstellen</b> , der das <b>Sapgui.Shortcut.File-</b> Protokoll <b>auf</b> √§hnliche Weise <b>angibt</b> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>SID200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  wir sollten ein Fenster sehen wie: <br><br><img src="https://habrastorage.org/webt/cc/xn/d6/ccxnd6jigmmqx7ydiaiei0qeh18.png"><br><br>  Und alles scheint in Ordnung zu sein, aber wenn Sie auf die Schaltfl√§che "Zulassen" klicken, sehen wir: <br><br><img src="https://habrastorage.org/webt/3a/lm/hc/3almhctej9kj3haxogtmrajza-i.png"><br><br>  Hoppla, der Browser hat den Speicherplatz in% 20 umgewandelt.  Nun, andere Zeichen werden ebenfalls in ihrem numerischen Code mit einem Prozentzeichen codiert.  Und das Unangenehmste ist, dass hier auf Browserebene nichts getan werden kann (alles erfolgt nach dem Standard) - der Browser mag solche Zeichen nicht und die Windows-Shell funktioniert nicht mit solchen codierten Werten.  Und noch ein Minus - die gesamte Zeichenfolge wird als Parameter √ºbergeben, einschlie√ülich des Namens des Protokolls und sogar des Doppelpunkts ( <i>sapgui.shortcut.file :)</i> .  Obwohl dieselbe <b>sapshcut.exe</b> alles verwerfen kann, was kein Parameter f√ºr sie ist (sie beginnt mit dem Symbol "-", dann dem Namen "=" und dem Wert), d. H.  Eine Zeile der Form " <i>sapgui.shortcut.file: -system = SID</i> " rollt immer noch, dann <i>funktioniert</i> " <i>sapgui.shortcut.file: -system = SID</i> " ohne Leerzeichen nicht mehr. <br><br>  Es stellt sich heraus, dass es im Prinzip zwei M√∂glichkeiten gibt, das URI-Protokoll zu verwenden: <br><br><ol><li>  Verwendung ohne Parameter: Wir erstellen eine ganze Reihe von Protokollen f√ºr alle unsere Systeme vom Typ <i>SIDMANDT</i> , wie z. B. <i>AAA200</i> , <i>BBB200</i> usw.  Wenn Sie nur das gew√ºnschte System starten m√ºssen, funktioniert die Option recht gut. In unserem Fall funktioniert sie jedoch nicht, da Sie zumindest auch die Anmeldung des Benutzers √ºbertragen m√∂chten, dies jedoch nicht auf diese Weise tun k√∂nnen. <br></li><li>  Verwenden eines Wrappers zum Aufrufen von <b>sapshcut.exe</b> oder <b>sapgui.exe</b> .  Das Wesentliche dieses Programms ist einfach: Es sollte die Zeile √ºbernehmen, die der Browser √ºber das Webprotokoll an das Programm sendet, und es in die Darstellung umwandeln, die Windows akzeptiert, d. H.  back wandelt alle Zeichencodes in Zeichen um (analysiert m√∂glicherweise sogar die Zeichenfolge nach Parametern) und ruft bereits die SAP-GUI auf, die durch den richtigen Befehl garantiert wird.  In unserem Fall passt es auch nicht ganz (daher habe ich es nicht einmal geschrieben), da es nicht ausreicht, auf allen Benutzer-PCs ein Protokoll hinzuzuf√ºgen (innerhalb der Dom√§ne ging dies immer noch nirgendwo hin, obwohl es besser ist, diese Praxis zu vermeiden), aber hier ist es zus√§tzlich erforderlich Platzieren Sie das Programm auf einem PC und √ºberwachen Sie es sogar st√§ndig, damit es bei der Neuinstallation der Software auf einem PC nicht verschwindet. <br></li></ol><br>  Das hei√üt,  Diese Option wird auch als f√ºr uns nicht geeignet verworfen. <br><br>  Dann begann ich zu denken, dass ich mich von der Idee verabschieden m√ºsste, die SAP-GUI mit den erforderlichen Parametern √ºber den Browser zu starten, aber dann kam mir die Idee, dass Sie eine Verkn√ºpfung in SAP Logon erstellen und auf den Desktop kopieren k√∂nnen.  Ich habe diese Methode einmal verwendet, aber zuvor habe ich mir die Verkn√ºpfungsdatei nicht speziell angesehen.  Und es stellte sich heraus, dass diese Verkn√ºpfung eine einfache Textdatei mit der Erweiterung <b>.sap ist</b> .  Wenn Sie es unter Windows ausf√ºhren, wird die SAP-GUI mit den in dieser Datei angegebenen Parametern gestartet.  "Bingo!" <br><br>  Das Format dieser Datei ist ungef√§hr wie folgt (m√∂glicherweise wird beim Start noch eine Transaktion gestartet, aber ich habe sie weggelassen): <br><br> <code>[System] <br> Name=SID <br> Client=200 <br> [User] <br> Name= <br> Language=RU <br> Password= <br> [Function] <br> Title= <br> [Configuration] <br> GuiSize=Maximized <br> [Options] <br> Reuse=0 <br></code> <br>  Es scheint alles zu sein, was ben√∂tigt wird: eine Systemkennung, ein Client, ein Benutzername und sogar ein Passwort.  Und noch zus√§tzliche Parameter: <i>Titel</i> - der Titel des Fensters, <i>GuiSize</i> - die Gr√∂√üe des gestarteten Fensters (Vollbild oder nicht) und <i>Wiederverwendung</i> - ob ein neues Fenster ge√∂ffnet oder ein bereits ge√∂ffnetes mit demselben System verwendet werden soll.  Aber sofort kam eine Nuance heraus - es stellte sich heraus, dass es unm√∂glich war, ein Passwort in SAP Logon festzulegen, die Leitung wurde blockiert.  Es stellte sich heraus, dass dies aus Sicherheitsgr√ºnden geschah: Er speichert alle in SAP Logon erstellten Verkn√ºpfungen in der Datei <b>sapshortcut.ini</b> (neben <b>saplogon.ini</b> im Windows-Benutzerprofil) und obwohl sie dort verschl√ºsselt sind, k√∂nnen sie zu stark und auf Wunsch verschl√ºsselt werden. dekodieren.  Sie k√∂nnen dies jedoch auch beheben, indem Sie den Wert eines Parameters in der Registrierung √§ndern (der Standardwert ist <b>0</b> ): <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CURRENT_USER\Software\SAP\SAPShortcut\Security] <br> "EnablePassword"="1" <br></code> <br>  Dadurch wird das Feld Kennwort im Verkn√ºpfungsformular in SAP Logon entsperrt, um Folgendes einzugeben: <br><br><img src="https://habrastorage.org/webt/bo/p1/jf/bop1jfux8jdbqbkdedhzsodor9s.png"><br><br>  Wenn Sie ein Passwort in dieses Feld eingeben, wird es in die entsprechende Zeile eingef√ºgt <br>  <b>sapshortcut.ini</b> , aber wenn Sie eine Verkn√ºpfung auf den Desktop ziehen, wird sie dort nicht angezeigt - Sie k√∂nnen sie dort jedoch manuell hinzuf√ºgen.  Das Passwort ist verschl√ºsselt, f√ºr 111111 hat es die folgende Form: PW_49B02219D1F6, f√ºr 222222 - PW_4AB3211AD2F5.  Wir sind jedoch mehr an der Tatsache interessiert, dass dieses Passwort auf eine Weise verschl√ºsselt wird, die vom jeweiligen PC unabh√§ngig ist. Wenn wir das Passwort auf das urspr√ºngliche zur√ºcksetzen, k√∂nnen wir einen zuvor bekannten Wert in diesem Feld verwenden.  Wenn wir ein zuf√§llig generiertes Passwort verwenden m√∂chten, m√ºssen wir den Algorithmus dieser Chiffre verstehen.  Nach den obigen Beispielen zu urteilen, wird dies jedoch nicht schwierig sein.  √úbrigens ist dieses Feld in SAP GUI 7.40 im Allgemeinen aus dem Formular verschwunden, aber es erkennt die Datei mit dem ausgef√ºllten Kennwort korrekt. <br><br>  Das hei√üt, es stellt sich heraus, dass es im Browser ausreicht, auf den Link zur Datei mit der Erweiterung .sap und dem gew√ºnschten Format zu klicken - und er bietet an, sie als Datei vom Typ SAP GUI Shortcut (nat√ºrlich auf einem PC mit installierter SAP GUI) zu √∂ffnen und das SAP GUI-Fenster mit der angegebenen zu √∂ffnen Parameter (wenn sich die SID und das Client-Paar in der SAP-Anmeldeliste auf diesem PC befinden). <br><br>  Es ist jedoch klar, dass niemand einfach vorher Dateien auf der Website erstellen und speichern wird - sie m√ºssen basierend auf den erforderlichen Parametern generiert werden.  Sie k√∂nnen beispielsweise ein Skript in PHP erstellen, um Verkn√ºpfungen zu generieren ( <b>sapshcut.php</b> ): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $Size = $queries[<span class="hljs-string"><span class="hljs-string">'Size'</span></span>]; $SID = $queries[<span class="hljs-string"><span class="hljs-string">'SID'</span></span>]; $Client = $queries[<span class="hljs-string"><span class="hljs-string">'Client'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Client == <span class="hljs-string"><span class="hljs-string">''</span></span>) { $Client=<span class="hljs-number"><span class="hljs-number">200</span></span>; }; $Lang = $queries[<span class="hljs-string"><span class="hljs-string">'Language'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Lang==<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Lang = <span class="hljs-string"><span class="hljs-string">'RU'</span></span>; }; $User = $queries[<span class="hljs-string"><span class="hljs-string">'Username'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($User&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Password = $queries[<span class="hljs-string"><span class="hljs-string">'Password'</span></span>]; }; $filename = $SID.$Client.<span class="hljs-string"><span class="hljs-string">'.sap'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/sap'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[System]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$SID.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Client="</span></span>.$Client.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[User]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$Username.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Language="</span></span>.$Lang.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Password&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Password="</span></span>.$Password.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Function]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Title&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title="</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title=  \r\n"</span></span>;}; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Configuration]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Size==<span class="hljs-string"><span class="hljs-string">'max'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"GuiSize=Maximized\r\n"</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Options]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Reuse=0\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Wenn Sie keinen Benutzernamen und kein Passwort angeben, wird in den Eingabeaufforderungen f√ºr Anmeldung und Passwort das folgende Fenster angezeigt: <br><br><img src="https://habrastorage.org/webt/4v/tz/_-/4vtz_-d9nva1ivhohfdtrxlfv7q.png"><br><br>  Wenn Sie nur die Anmeldung √ºbertragen, wird das Anmeldefeld ausgef√ºllt und das Kennwortfeld ist leer.  Wenn wir dem Benutzer sowohl den Benutzernamen als auch das Kennwort geben, aber der EnablePassword-Schl√ºssel des Benutzers im Abschnitt [HKEY_CURRENT_USER \ Software \ SAP \ SAPShortcut \ Security] auf dem PC des Benutzers auf 0 gesetzt ist, erhalten wir dasselbe.  Und nur wenn dieser Schl√ºssel auf 1 gesetzt ist und wir sowohl den Namen als auch das urspr√ºngliche Passwort √ºbertragen, werden Sie vom System sofort aufgefordert, das neue permanente Passwort zweimal einzugeben.  Was war erforderlich, um zu erhalten. <br><br>  Infolgedessen haben wir die folgenden Optionen zur Veranschaulichung aller oben genannten Punkte: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="actionscript"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span></span><span class="hljs-params"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">(sid, client, user, password)</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span></span><span class="actionscript">{ </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">var</span></span></span><span class="actionscript"> shell = </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">new</span></span></span><span class="actionscript"> ActiveXObject(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"WScript.Shell"</span></span></span><span class="actionscript">); shell.run(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'sapshcut.exe -system="'</span></span></span><span class="actionscript">+sid+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -client='</span></span></span><span class="actionscript">+client+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">' -user="'</span></span></span><span class="actionscript">+user+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -pw="'</span></span></span><span class="actionscript">+password+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -language=RU'</span></span></span><span class="actionscript">); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">''</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:openSAPGui('SID', '200', 'test', '');"</span></span></span><span class="hljs-tag">/&gt;</span></span>Example 1: Execute sapshcut.exe (ActiveX)<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 2: Open sapshcut.exe (URI)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'sapshcut.php?SID=SID&amp;Client=200&amp;User=test'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 3: Open file .sap (SAP GUI Shortcut)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Die letzte Option kam auf mich zu.  Anstatt SAP-Verkn√ºpfungen zu generieren, k√∂nnen Sie beispielsweise auch CMD-Dateien generieren, die beim √ñffnen √ºber einen Browser auch das SAP-GUI-Fenster √∂ffnen.  Das folgende Beispiel ( <b>sapguicmd.php</b> ) zeigt das direkte Starten der SAP-GUI mit der vollst√§ndigen Verbindungszeichenfolge, ohne dass die SAP-Anmeldung konfiguriert werden muss: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $ROUTER = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTER'</span></span>]; $ROUTERPORT = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTERPORT'</span></span>]; $HOST = $queries[<span class="hljs-string"><span class="hljs-string">'HOST'</span></span>]; $PORT = $queries[<span class="hljs-string"><span class="hljs-string">'PORT'</span></span>]; $MESS = $queries[<span class="hljs-string"><span class="hljs-string">'MESS'</span></span>]; $LG = $queries[<span class="hljs-string"><span class="hljs-string">'LG'</span></span>]; $filename = <span class="hljs-string"><span class="hljs-string">'SAPGUI_'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.<span class="hljs-string"><span class="hljs-string">'_'</span></span>.$PORT; $filename = $filename.<span class="hljs-string"><span class="hljs-string">'.cmd'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/cmd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"@echo off\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"chcp 1251\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"echo   "</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set SAP_CODEPAGE=1504\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set logon="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTER&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$ROUTER; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTERPORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$ROUTERPORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/M/"</span></span>.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$PORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($LG&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/G/"</span></span>.$LG; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'"%gui%" %logon%'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446998/">https://habr.com/ru/post/de446998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446988/index.html">Wie ich Scala unterrichtet habe</a></li>
<li><a href="../de446990/index.html">Eingangsverz√∂gerung bei Retro-Konsolen und Emulatoren</a></li>
<li><a href="../de446992/index.html">John Maeda: ‚ÄûDesign ist eigentlich nicht so wichtig‚Äú</a></li>
<li><a href="../de446994/index.html">Raum als vage Erinnerung</a></li>
<li><a href="../de446996/index.html">Die Pomodoro-Methode ist nicht so cool wie sie sein k√∂nnte</a></li>
<li><a href="../de447000/index.html">Audioformatkriege: 10 Materialien auf digitalen und analogen Medien</a></li>
<li><a href="../de447002/index.html">Cabinet Lounge Foto Coworking Tour</a></li>
<li><a href="../de447004/index.html">Universal Watchdog auf ATtiny13</a></li>
<li><a href="../de447006/index.html">Anleitung: Wie erstelle ich einen einfachen Bot f√ºr JS Telegram f√ºr einen Anf√§nger in der Programmierung?</a></li>
<li><a href="../de447008/index.html">So √ºbernehmen Sie die Kontrolle √ºber Ihre Netzwerkinfrastruktur. Inhaltsverzeichnis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>