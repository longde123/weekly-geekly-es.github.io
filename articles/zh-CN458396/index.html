<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ ğŸ‚ ğŸ‘§ğŸ¾ å¦‚ä½•é€šè¿‡æœåŠ¡å™¨ç«¯æ¸²æŸ“æ–¹ä¾¿åœ°åœ¨Vue.jsä¸Šè¿›è¡Œå¼€å‘ ğŸ§“ğŸ» ğŸŒ¿ ğŸ¤šğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¤§å®¶å¥½ï¼ 

 æˆ‘å°†ä»ä¸€äº›èƒŒæ™¯å¼€å§‹ã€‚ 

 æˆ‘å†³å®šåœ¨Vue.jsä¸Šå°è¯•æ–°é¡¹ç›®ã€‚ æˆ‘éœ€è¦æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ï¼ŒCSSæ¨¡å—ï¼Œä»£ç æ‹†åˆ†å’Œå…¶ä»–åŠŸèƒ½ã€‚ å½“ç„¶ï¼Œéœ€è¦çƒ­é‡å¯ï¼ˆHMRï¼‰æ¥æé«˜å¼€å‘æ•ˆç‡ã€‚ 

 æˆ‘ä¸æƒ³ä½¿ç”¨ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚Nuxt.jsï¼Œå› ä¸º å½“é¡¹ç›®å‘å±•æ—¶ï¼Œè¿›è¡Œå®šåˆ¶éå¸¸é‡è¦ã€‚ é€šå¸¸ï¼Œä»»ä½•é«˜çº§è§£å†³æ–¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¦‚ä½•é€šè¿‡æœåŠ¡å™¨ç«¯æ¸²æŸ“æ–¹ä¾¿åœ°åœ¨Vue.jsä¸Šè¿›è¡Œå¼€å‘</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458396/">å¤§å®¶å¥½ï¼ <br><br> æˆ‘å°†ä»ä¸€äº›èƒŒæ™¯å¼€å§‹ã€‚ <br><br> æˆ‘å†³å®šåœ¨Vue.jsä¸Šå°è¯•æ–°é¡¹ç›®ã€‚ æˆ‘éœ€è¦æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ï¼ŒCSSæ¨¡å—ï¼Œä»£ç æ‹†åˆ†å’Œå…¶ä»–åŠŸèƒ½ã€‚ å½“ç„¶ï¼Œéœ€è¦çƒ­é‡å¯ï¼ˆHMRï¼‰æ¥æé«˜å¼€å‘æ•ˆç‡ã€‚ <br><br> æˆ‘ä¸æƒ³ä½¿ç”¨ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚Nuxt.jsï¼Œå› ä¸º å½“é¡¹ç›®å‘å±•æ—¶ï¼Œè¿›è¡Œå®šåˆ¶éå¸¸é‡è¦ã€‚ é€šå¸¸ï¼Œä»»ä½•é«˜çº§è§£å†³æ–¹æ¡ˆéƒ½ä¸å…è®¸è¿™æ ·åšæˆ–ä»˜å‡ºä»»ä½•åŠªåŠ›ï¼Œä½†è¦ä»˜å‡ºå¾ˆå¤§çš„åŠªåŠ›ï¼ˆä½¿ç”¨Next.jsè¿›è¡ŒReactä¹Ÿæœ‰ç±»ä¼¼çš„ç»éªŒï¼‰ã€‚ <br><br> ä½¿ç”¨æœåŠ¡å™¨æ¸²æŸ“å’Œçƒ­é‡å¯æ—¶æœ¬åœ°å¼€å‘çš„ä¸»è¦é—®é¢˜æ˜¯ä»…è¿è¡Œä¸€ä¸ª<i>webpack-dev-server</i>æ˜¯ä¸å¤Ÿçš„ã€‚ æˆ‘ä»¬è¿˜å¿…é¡»å¯¹Node.jså¯åŠ¨çš„æºä»£ç è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™ï¼Œä¸‹æ¬¡æˆ‘ä»¬é‡æ–°åŠ è½½é¡µé¢æ—¶ï¼Œæˆ‘ä»¬å°†è·å¾—æœªåœ¨æœåŠ¡å™¨ä¸Šæ›´æ–°ä½†åœ¨å®¢æˆ·ç«¯ä¸Šæ›´æ–°çš„ä»£ç ã€‚ <br><br> ä¸å¹¸çš„æ˜¯ï¼Œè¿›å…¥æ–‡æ¡£å’ŒInternetä¹‹åï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°ç°æˆçš„å¯ä»¥æ­£å¸¸å·¥ä½œçš„ç¤ºä¾‹å’Œæ¨¡æ¿ã€‚ å› æ­¤ï¼Œæˆ‘åˆ›å»ºäº†è‡ªå·±çš„ã€‚ <br><br><img src="https://habrastorage.org/webt/fr/yn/fq/frynfqwfukcvkxd1a673bleocno.jpeg"><br><a name="habracut"></a><br> æˆ‘ç¡®å®šäº†æ¨¡æ¿åº”åŒ…å«çš„å†…å®¹ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è½»æ¾è¿›è¡Œå¼€å‘ï¼š <br><br><ul><li>  Vuejs </li><li> å›ºæ€ç»§ç”µå™¨ </li><li> å¨å…‹æ–¯ </li><li>  CSSæ¨¡å— </li><li> ä»£ç æ‹†åˆ† </li><li>  ESLintï¼Œæ›´æ¼‚äº® </li></ul><br> é€šè¿‡æœ¬åœ°å¼€å‘ï¼Œæ‰€æœ‰è¿™äº›éƒ½åº”åœ¨æµè§ˆå™¨ä¸­å³æ—¶æ›´æ–°ï¼Œå¹¶ä¸”æœåŠ¡å™¨ä»£ç ä¹Ÿåº”æ›´æ–°ã€‚ <br><br> åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹ï¼Œåº”æœ€å°åŒ–åŒ…ï¼Œåº”æ·»åŠ å“ˆå¸Œå€¼ä»¥ç¼“å­˜é™æ€å˜é‡ï¼Œåº”åœ¨htmlæ¨¡æ¿ä¸­è‡ªåŠ¨è®¾ç½®åŒ…çš„è·¯å¾„ã€‚ <br><br> æ‰€æœ‰è¿™äº›éƒ½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨GitHubä¸Š</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å­˜å‚¨åº“ä¸­</a>å®ç°ï¼Œæˆ‘å°†æä¾›ä»£ç å¹¶æè¿°è§£å†³æ–¹æ¡ˆã€‚ <br><br> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒVue.jså…·æœ‰ç”¨äºè®¾ç½®æœåŠ¡å™¨æ¸²æŸ“çš„éå¸¸å…¨é¢çš„æ–‡æ¡£ï¼Œå› æ­¤åœ¨æ­¤å¤„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æŸ¥æ‰¾</a>æ˜¯æœ‰æ„ä¹‰çš„ã€‚ <br><br><h2> æœåŠ¡å™¨ç«¯ </h2><br> å› æ­¤ï¼Œæˆ‘ä»¬å°†Expressç”¨ä½œNode.jsçš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦<i>vue-server-renderer</i> ã€‚ è¿™ä¸ªåŒ…å…è®¸æˆ‘ä»¬æ ¹æ®æœåŠ¡å™¨åŒ…ï¼Œhtmlæ¨¡æ¿å’Œå®¢æˆ·ç«¯æ¸…å•å°†ä»£ç å‘ˆç°ä¸ºhtmlå­—ç¬¦ä¸²ï¼Œå¹¶åœ¨å…¶ä¸­æŒ‡æ˜èµ„æºçš„åç§°å’Œè·¯å¾„ã€‚ <br><br>  <i>server.js</i>æ–‡ä»¶æœ€ç»ˆå°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { createBundleRenderer } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'vue-server-renderer'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> template = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>).readFileSync( path.join(__dirname, <span class="hljs-string"><span class="hljs-string">'./templates/index.html'</span></span>), <span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>, ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> serverBundle = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../dist/vue-ssr-server-bundle.json'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> clientManifest = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../dist/vue-ssr-client-manifest.json'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = express(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> renderer = createBundleRenderer(serverBundle, { <span class="hljs-comment"><span class="hljs-comment">//           ,     runInNewContext: false, template, clientManifest, inject: false, }); //         nginx server.use('/dist', express.static(path.join(__dirname, '../dist'))); server.get('*', (req, res) =&gt; { const context = { url: req.url }; renderer.renderToString(context, (err, html) =&gt; { if (err) { if (+err.message === 404) { res.status(404).end('Page not found'); } else { console.log(err); res.status(500).end('Internal Server Error'); } } res.end(html); }); }); server.listen(process.env.PORT || 3000);</span></span></code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬ä½¿ç”¨2ä¸ªæ–‡ä»¶ï¼š <i>vue-ssr-server-bundle.json</i>å’Œ<i>vue-ssr-client-manifest.json</i> ã€‚ <br><br> å®ƒä»¬æ˜¯åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶ç”Ÿæˆçš„ã€‚ ç¬¬ä¸€ä¸ªæ˜¯å°†åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ä»£ç ï¼Œç¬¬äºŒä¸ªåŒ…å«äº†èµ„æºçš„åç§°å’Œè·¯å¾„ã€‚ <br><br> å¦å¤–ï¼Œåœ¨<i>createBundleRenderer</i>é€‰é¡¹ä¸­<i>ï¼Œ</i>æˆ‘ä»¬æŒ‡å®šäº†<i>injectï¼šfalse</i>å‚æ•°ã€‚ è¿™æ„å‘³ç€å°†ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆç”¨äºåŠ è½½èµ„æºå’Œå…¶ä»–å†…å®¹çš„htmlä»£ç ï¼Œå› ä¸º æˆ‘ä»¬éœ€è¦å®Œå…¨çš„çµæ´»æ€§ã€‚ åœ¨æ¨¡æ¿ä¸­ï¼Œæˆ‘ä»¬å°†ç‹¬ç«‹æ ‡è®°è¦æ˜¾ç¤ºæ­¤ä»£ç çš„ä½ç½®ã€‚ <br><br> æ¨¡æ¿æœ¬èº«å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1"</span></span></span><span class="hljs-tag">&gt;</span></span> {{{ meta.inject().title.text() }}} {{{ meta.inject().meta.text() }}} {{{ renderResourceHints() }}} {{{ renderStyles() }}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!--vue-ssr-outlet--&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {{{ renderState() }}} {{{ renderScripts() }}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°è€ƒè™‘ã€‚ <br><br><ul><li>  <i>éœ€è¦meta.injectï¼ˆï¼‰ï¼Œtitle.textï¼ˆï¼‰</i>å’Œ<i>meta.injectï¼ˆï¼‰ã€‚meta.textï¼ˆï¼‰</i>æ¥æ˜¾ç¤ºæ ‡é¢˜å’Œå…ƒæè¿°ã€‚  <i>vue-meta</i>è½¯ä»¶åŒ…å¯¹æ­¤è´Ÿè´£ï¼Œä¸‹é¢å°†å¯¹æ­¤è¿›è¡Œè®¨è®º </li><li>  <i>renderResourceHintsï¼ˆï¼‰</i> -å°†è¿”å›<i>rel =â€œ preload / prefetchâ€</i>é“¾æ¥åˆ°å®¢æˆ·ç«¯æ¸…å•ä¸­æŒ‡å®šçš„èµ„æº </li><li>  <i>renderStylesï¼ˆï¼‰</i> -å°†è¿”å›æŒ‡å‘å®¢æˆ·ç«¯æ¸…å•ä¸­æŒ‡å®šçš„æ ·å¼çš„é“¾æ¥ </li><li>  <i>renderStateï¼ˆï¼‰</i> -å°†åœ¨çª—å£.__ INITIAL_STATE__ä¸­è¿”å›é»˜è®¤çŠ¶æ€ã€‚ </li><li>  <i>renderScriptsï¼ˆï¼‰</i> -å°†è¿”å›åº”ç”¨ç¨‹åºæ­£å¸¸å·¥ä½œæ‰€éœ€çš„è„šæœ¬ </li></ul><br> é™¤äº†æ³¨é‡Šï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„æ ‡è®°å°†è¢«æ›¿æ¢ã€‚ ä»–æ˜¯å¿…éœ€çš„ã€‚ <br><br>  VueæœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹æ˜¯<i>entry-server.jsæ–‡ä»¶</i> ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createApp } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./app'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> context =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      Vue const { app, router, store } = createApp(); // $meta - ,   vue-meta   Vue const meta = app.$meta(); //      router.push(context.url); //  -  ,      context.meta = meta; router.onReady(() =&gt; { context.rendered = () =&gt; { //    ,     ,  window.__INITIAL_STATE__ context.state = store.state; }; const matchedComponents = router.getMatchedComponents(); //     if (!matchedComponents.length) { return reject(new Error(404)); } return resolve(app); }, reject); });</span></span></code> </pre><br><h2> å®¢æˆ·éƒ¨åˆ† </h2><br> å®¢æˆ·ç«¯å…¥å£ç‚¹æ˜¯<i>entry-client.jsæ–‡ä»¶</i> ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createApp } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./app'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { app, router, store } = createApp(); router.onReady(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__INITIAL_STATE__) { <span class="hljs-comment"><span class="hljs-comment">//    ,     store.replaceState(window.__INITIAL_STATE__); } app.$mount('#app'); }); //    HMR  ,  webpack-dev-server     hot if (module.hot) { const api = require('vue-hot-reload-api'); const Vue = require('vue'); api.install(Vue); if (!api.compatible) { throw new Error( 'vue-hot-reload-api is not compatible with the version of Vue you are using.', ); } module.hot.accept(); }</span></span></code> </pre><br> åœ¨<i>app.jsä¸­</i> ï¼Œåˆ›å»ºäº†æˆ‘ä»¬çš„Vueå®ä¾‹ï¼Œç„¶ååœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸Šä½¿ç”¨å®ƒã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Vue <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { sync } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vuex-router-sync'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createRouter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./router'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./client/store'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./App.vue'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createApp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = createRouter(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(); sync(store, router); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vue({ router, store, <span class="hljs-attr"><span class="hljs-attr">render</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">h</span></span></span><span class="hljs-function"> =&gt;</span></span> h(App), }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { app, router, store }; }</code> </pre><br>  <b>æˆ‘ä»¬æ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œä»¥é¿å…å¤šä¸ªè¯·æ±‚ä½¿ç”¨åŒä¸€å®ä¾‹çš„æƒ…å†µã€‚</b> <br><br>  <i>App.vue</i>æ˜¯æ ¹ç»„ä»¶ï¼Œå®ƒåŒ…å«<i>&lt;router-view&gt; &lt;/ router-view&gt;</i>æŒ‡ä»¤ï¼Œå®ƒå°†æ ¹æ®è·¯ç”±æ›¿æ¢å¿…è¦çš„ç»„ä»¶ã€‚ <br><br> è·¯ç”±å™¨æœ¬èº«çœ‹èµ·æ¥åƒè¿™æ · <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Vue <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Router <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue-router'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> VueMeta <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue-meta'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> routes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./routes'</span></span>; Vue.use(Router); Vue.use(VueMeta); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createRouter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Router({ <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: <span class="hljs-string"><span class="hljs-string">'history'</span></span>, <span class="hljs-attr"><span class="hljs-attr">routes</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: routes.pages.main, <span class="hljs-attr"><span class="hljs-attr">component</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./client/components/Main.vue'</span></span>) }, { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: routes.pages.about, <span class="hljs-attr"><span class="hljs-attr">component</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./client/components/About.vue'</span></span>) }, ], }); }</code> </pre><br> é€šè¿‡<i>Vue.useï¼Œ</i>æˆ‘ä»¬è¿æ¥äº†ä¸¤ä¸ªæ’ä»¶ï¼š <i>Router</i>å’Œ<i>VueMeta</i> ã€‚ <br> åœ¨è·¯çº¿ä¸­ï¼Œç»„ä»¶æœ¬èº«ä¸ä¼šç›´æ¥æ˜¾ç¤ºï¼Œè€Œæ˜¯é€šè¿‡ <br><br><pre> <code class="javascript hljs">() =&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./client/components/About.vue'</span></span>)</code> </pre> <br> è¿™æ˜¯ç”¨äºä»£ç æ‹†åˆ†ã€‚ <br><br> è‡³äºçŠ¶æ€ç®¡ç†ï¼ˆç”±Vuexå®ç°ï¼‰ï¼Œå…¶é…ç½®æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚ å”¯ä¸€çš„äº‹æƒ…æ˜¯ï¼Œæˆ‘å°†è¿™ä¸€é¢åˆ†ä¸ºæ¨¡å—ï¼Œå¹¶ä½¿ç”¨å¸¦æœ‰åç§°çš„å¸¸é‡ä»¥ä½¿å…¶æ›´æ˜“äºé€šè¿‡ä»£ç è¿›è¡Œå¯¼èˆªã€‚ <br><br> ç°åœ¨è€ƒè™‘ä¸€ä¸‹Vueç»„ä»¶æœ¬èº«çš„ä¸€äº›ç»†å¾®å·®åˆ«ã€‚ <br><br>  <i>metaInfo</i>å±æ€§è´Ÿè´£ä½¿ç”¨<i>vue-meta</i>åŒ…å‘ˆç°å…ƒæ•°æ®ã€‚ æ‚¨å¯ä»¥æŒ‡å®šå¤§é‡çš„å„ç§å‚æ•°ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ›´å¤š</a> ï¼‰ã€‚ <br><br><pre> <code class="javascript hljs">metaInfo: { <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">'Main page'</span></span>, }</code> </pre><br> ç»„ä»¶å…·æœ‰ä»…åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„æ–¹æ³•ã€‚ <br><br><pre> <code class="javascript hljs">serverPrefetch() { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Run only on server'</span></span>); }</code> </pre><br> å¦å¤–ï¼Œæˆ‘æƒ³ä½¿ç”¨CSSæ¨¡å—ã€‚ æˆ‘å–œæ¬¢è¿™ä¸ªä¸»æ„ï¼Œå› ä¸ºæ‚¨ä¸å¿…å…³å¿ƒç±»çš„åç§°ï¼Œä»¥å…ç»„ä»¶ä¹‹é—´é‡å ã€‚ ä½¿ç”¨CSSæ¨¡å—ï¼Œç”Ÿæˆçš„ç±»å°†ç±»ä¼¼äº<i>&lt;class name&gt; _ &lt;hash&gt;</i> ã€‚ <br><br> ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦åœ¨ç»„ä»¶ä¸­æŒ‡å®š<i>æ ·å¼æ¨¡å—</i> ã€‚ <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">module</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-class"><span class="css"><span class="hljs-selector-class">.item</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">padding</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">3px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; } </span><span class="hljs-selector-class"><span class="css"><span class="hljs-selector-class">.controls</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin-top</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">12px</span></span></span><span class="css">; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> å¹¶åœ¨æ¨¡æ¿ä¸­æŒ‡å®šå±æ€§<i>ï¼šclass</i> <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$style.item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> å¦å¤–ï¼Œæœ‰å¿…è¦åœ¨webpackè®¾ç½®ä¸­æŒ‡å®šæˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›æ¨¡å—ã€‚ <br><br><h2> ç»„è£…æ–¹å¼ </h2><br> è®©æˆ‘ä»¬ç»§ç»­è¿›è¡Œwebpackè®¾ç½®ã€‚ <br><br> æˆ‘ä»¬æœ‰ä¸€ä¸ªåŸºæœ¬é…ç½®ï¼Œè¯¥é…ç½®ç”±æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ¨ä»¶çš„é…ç½®ç»§æ‰¿ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpack = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> OptimizeCSSAssetsPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'optimize-css-assets-webpack-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UglifyJsPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'uglifyjs-webpack-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> merge = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-merge'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VueLoaderPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'vue-loader/lib/plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isProduction = process.env.NODE_ENV === <span class="hljs-string"><span class="hljs-string">'production'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> config = { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: isProduction ? <span class="hljs-string"><span class="hljs-string">'production'</span></span> : <span class="hljs-string"><span class="hljs-string">'development'</span></span>, <span class="hljs-attr"><span class="hljs-attr">module</span></span>: { <span class="hljs-attr"><span class="hljs-attr">rules</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.vue$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'vue-loader'</span></span>, }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.js$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'babel-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exclude</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> /node_modules/.test(file) &amp;&amp; !<span class="hljs-regexp"><span class="hljs-regexp">/\.vue\.js/</span></span>.test(file), }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'url-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { <span class="hljs-attr"><span class="hljs-attr">limit</span></span>: <span class="hljs-number"><span class="hljs-number">10000</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'images/[name].[hash:8].[ext]'</span></span>, }, }, }, ], }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VueLoaderPlugin(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.DefinePlugin({ <span class="hljs-string"><span class="hljs-string">'process.env.NODE_ENV'</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(process.env.NODE_ENV), }), ], }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isProduction) { config = merge(config, { <span class="hljs-attr"><span class="hljs-attr">optimization</span></span>: { <span class="hljs-attr"><span class="hljs-attr">minimizer</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OptimizeCSSAssetsPlugin(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UglifyJsPlugin()], }, }); } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = config;</code> </pre><br> ç”¨äºæ„å»ºæœåŠ¡å™¨ä»£ç çš„é…ç½®ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­çš„é…ç½®ç›¸åŒ</a> ã€‚ é™¤äº†CSSå¤„ç†ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> merge = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-merge'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> nodeExternals = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-node-externals'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VueSSRServerPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'vue-server-renderer/server-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> baseConfig = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./webpack.base.js'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = merge(baseConfig, { <span class="hljs-attr"><span class="hljs-attr">entry</span></span>: <span class="hljs-string"><span class="hljs-string">'./app/entry-server.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">target</span></span>: <span class="hljs-string"><span class="hljs-string">'node'</span></span>, <span class="hljs-attr"><span class="hljs-attr">devtool</span></span>: <span class="hljs-string"><span class="hljs-string">'source-map'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">libraryTarget</span></span>: <span class="hljs-string"><span class="hljs-string">'commonjs2'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">externals</span></span>: nodeExternals({ <span class="hljs-attr"><span class="hljs-attr">whitelist</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, }), <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VueSSRServerPlugin()], <span class="hljs-attr"><span class="hljs-attr">module</span></span>: { <span class="hljs-attr"><span class="hljs-attr">rules</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'css-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: { <span class="hljs-attr"><span class="hljs-attr">localIdentName</span></span>: <span class="hljs-string"><span class="hljs-string">'[local]_[hash:base64:8]'</span></span>, }, }, }, ], }, });</code> </pre><br> æœ€åˆï¼Œæ‰€æœ‰CSSå¤„ç†éƒ½ç§»è‡³åŸºæœ¬é…ç½®ï¼Œå› ä¸º å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šéƒ½éœ€è¦å®ƒã€‚ ç”Ÿäº§åˆ¶åº¦æœ‰ä¸€ä¸ªç¼ºç‚¹ã€‚ <br> ä½†æ˜¯ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¯¥æœåŠ¡å™¨åŸæ¥æ˜¯<i>document</i> ï¼Œå› æ­¤å‘ç”Ÿäº†é”™è¯¯ã€‚ äº‹å®è¯æ˜è¿™æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ä¸ª</a> <i>mini-css-extract-plugin</i>é”™è¯¯ï¼Œè¯¥é”™è¯¯é€šè¿‡æ‹†åˆ†æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„CSSå¤„ç†å¾—ä»¥è§£å†³ã€‚ <br><br>  <i>VueSSRServerPlugin</i>ç”Ÿæˆ<i>vue-ssr-server-bundle.jsonæ–‡ä»¶</i> ï¼Œè¯¥<i>æ–‡ä»¶</i>æŒ‡ç¤ºåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ä»£ç ã€‚ <br><br> ç°åœ¨è€ƒè™‘å®¢æˆ·ç«¯é…ç½®ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpack = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> merge = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-merge'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VueSSRClientPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'vue-server-renderer/client-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MiniCssExtractPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mini-css-extract-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> baseConfig = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./webpack.base.js'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isProduction = process.env.NODE_ENV === <span class="hljs-string"><span class="hljs-string">'production'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> config = merge(baseConfig, { <span class="hljs-attr"><span class="hljs-attr">entry</span></span>: [<span class="hljs-string"><span class="hljs-string">'./app/entry-client.js'</span></span>], <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VueSSRClientPlugin()], <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: path.resolve(<span class="hljs-string"><span class="hljs-string">'./dist/'</span></span>), <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'[name].[hash:8].js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'/dist/'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">module</span></span>: { <span class="hljs-attr"><span class="hljs-attr">rules</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ isProduction ? MiniCssExtractPlugin.loader : <span class="hljs-string"><span class="hljs-string">'vue-style-loader'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'css-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: { <span class="hljs-attr"><span class="hljs-attr">localIdentName</span></span>: <span class="hljs-string"><span class="hljs-string">'[local]_[hash:base64:8]'</span></span>, }, }, }, ], }, ], }, }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isProduction) { config = merge(config, { <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'[name].js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'http://localhost:9999/dist/'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.HotModuleReplacementPlugin()], <span class="hljs-attr"><span class="hljs-attr">devtool</span></span>: <span class="hljs-string"><span class="hljs-string">'source-map'</span></span>, <span class="hljs-attr"><span class="hljs-attr">devServer</span></span>: { <span class="hljs-attr"><span class="hljs-attr">writeToDisk</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">contentBase</span></span>: path.resolve(__dirname, <span class="hljs-string"><span class="hljs-string">'dist'</span></span>), <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'http://localhost:9999/dist/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">hot</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">inline</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">historyApiFallback</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">port</span></span>: <span class="hljs-number"><span class="hljs-number">9999</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: { <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Origin'</span></span>: <span class="hljs-string"><span class="hljs-string">'*'</span></span>, }, }, }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { config = merge(config, { <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MiniCssExtractPlugin({ <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'[name].[hash:8].css'</span></span>, }), ], }); } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = config;</code> </pre><br> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æœ¬åœ°å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®š<i>publicPath</i> ï¼Œå¼•ç”¨<i>webpack-dev-serverï¼Œ</i>å¹¶ç”Ÿæˆä¸å¸¦å“ˆå¸Œçš„æ–‡ä»¶åã€‚ å¦å¤–ï¼Œå¯¹äº<i>devServerï¼Œ</i>æˆ‘ä»¬æŒ‡å®š<i>writeToDiskï¼štrue</i>å‚æ•°ã€‚ <br><br> è¿™é‡Œéœ€è¦è§£é‡Šã€‚ <br><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œ <i>webpack-dev-server</i>ä»RAMåˆ†é…èµ„æºè€Œä¸å°†å…¶å†™å…¥ç£ç›˜ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é¢ä¸´çš„é—®é¢˜æ˜¯ï¼Œä¸ç›¸å…³çš„èµ„æºå°†åœ¨ä½äºç£ç›˜ä¸Šçš„å®¢æˆ·ç«¯æ¸…å•ï¼ˆ <i>vue-ssr-client-manifest.json</i> ï¼‰ä¸­æŒ‡ç¤ºå‡ºæ¥ï¼Œå› ä¸º å®ƒä¸ä¼šè¢«æ›´æ–°ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‘Šè¯‰å¼€å‘æœåŠ¡å™¨å°†æ‰€åšçš„æ›´æ”¹å†™å…¥ç£ç›˜ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯æ¸…å•å°†è¢«æ›´æ–°ï¼Œå¿…è¦çš„èµ„æºå°†è¢«æ”¶ç´§ã€‚ <br><br> å®é™…ä¸Šï¼Œå°†æ¥æˆ‘æƒ³æ‘†è„±è¿™ç§æƒ…å†µã€‚ ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å¤„å¥³ã€‚  <i>server.jsä¸­çš„</i> mode <i>æ¥</i>è¿æ¥æ¸…å•ä¸æ˜¯æ¥è‡ª<i>/ dist</i>ç›®å½•ï¼Œè€Œæ˜¯æ¥è‡ªæœåŠ¡å™¨urlã€‚ ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå˜ä¸ºå¼‚æ­¥æ“ä½œã€‚ æˆ‘å¾ˆé«˜å…´åœ¨è¯„è®ºä¸­æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ <br><br>  Nodemonè´Ÿè´£æœåŠ¡å™¨ç«¯çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‡æ–°åŠ è½½</a> ï¼Œå®ƒç›‘è§†ä¸¤ä¸ªæ–‡ä»¶ï¼š <i>dist / vue-ssr-server-bundle.json</i>å’Œ<i>app / server.jsï¼Œ</i>å¹¶åœ¨æ›´æ”¹å®ƒä»¬åé‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºã€‚ <br><br> ä¸ºäº†èƒ½å¤Ÿåœ¨æ›´æ”¹<i>server.js</i>æ—¶é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬æ²¡æœ‰å°†æ­¤æ–‡ä»¶æŒ‡å®šä¸º<i>nodemonä¸­</i>çš„å…¥å£ç‚¹ï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªè¿æ¥<i>server.js</i>çš„<i>nodemon.js</i>æ–‡ä»¶ã€‚ å¹¶ä¸”<i>nodemon.js</i>æ–‡ä»¶æˆä¸ºå…¥å£ç‚¹ã€‚ <br><br> åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹ï¼Œ <i>app / server.js</i>æˆä¸ºå…¥å£ç‚¹ã€‚ <br><br><h2> ç»“è®º </h2><br> æ€»è®¡ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«è®¾ç½®å’Œå‡ ä¸ªå›¢é˜Ÿçš„å­˜å‚¨åº“ã€‚ <br><br>  <b>å¯¹äºæœ¬åœ°å‘å±•ï¼š</b> <br><br><pre> <code class="javascript hljs">yarn run dev</code> </pre> <br> åœ¨å®¢æˆ·ç«¯ï¼šå®ƒå¯åŠ¨<i>webpack-dev-server</i> ï¼Œè¯¥<i>æœåŠ¡å™¨</i>ç›‘è§†Vueç»„ä»¶å’Œç®€å•ä»£ç ä¸­çš„æ›´æ”¹ï¼Œç”Ÿæˆå¸¦æœ‰å¼€å‘æœåŠ¡å™¨è·¯å¾„çš„å®¢æˆ·ç«¯æ¸…å•ï¼Œå°†å…¶ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­å³æ—¶æ›´æ–°ä»£ç å’Œæ ·å¼ã€‚ <br><br> åœ¨æœåŠ¡å™¨ç«¯ï¼šå®ƒä»¥ç›‘è§†æ¨¡å¼å¯åŠ¨<i>webpack</i> ï¼Œæ”¶é›†æœåŠ¡å™¨æ†ç»‘åŒ…ï¼ˆ <i>vue-ssr-server-bundle.json</i> ï¼‰ï¼Œå¹¶åœ¨æ›´æ”¹åº”ç”¨ç¨‹åºåé‡æ–°å¯åŠ¨ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç ä¼šè‡ªåŠ¨åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šä¸€è‡´åœ°æ›´æ”¹ã€‚ <br> åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸€ä¸ªé”™è¯¯ï¼Œå³æ‰¾ä¸åˆ°æœåŠ¡å™¨æ†ç»‘åŒ…ã€‚ è¿™å¾ˆæ­£å¸¸ã€‚ åªéœ€è¦é‡å¯å‘½ä»¤å³å¯ã€‚ <br><br>  <b>å¯¹äºç»„è£…ç”Ÿäº§ï¼š</b> <br><br><pre> <code class="javascript hljs">yarn run build</code> </pre> <br> åœ¨å®¢æˆ·ç«¯ï¼šæ”¶é›†å¹¶æœ€å°åŒ–jså’Œcssï¼Œåœ¨åç§°ä¸­æ·»åŠ ä¸€ä¸ªå“ˆå¸Œï¼Œå¹¶ç”Ÿæˆå…·æœ‰ç›¸å¯¹èµ„æºè·¯å¾„çš„å®¢æˆ·ç«¯æ¸…å•ã€‚ <br><br> ä»æœåŠ¡å™¨ç«¯ï¼šæ”¶é›†æœåŠ¡å™¨æ†ç»‘åŒ…ã€‚ <br><br> å¦å¤–ï¼Œæˆ‘è¿˜åˆ›å»ºäº†å¦ä¸€ä¸ª<i>yarn run start-node</i>å‘½ä»¤ï¼Œè¯¥å‘½ä»¤å¯åŠ¨<i>server.js</i> ï¼Œä½†è¿™åªæ˜¯ä½œä¸ºç¤ºä¾‹ï¼Œåœ¨ç”Ÿäº§åº”ç”¨ç¨‹åºä¸­å¯åŠ¨å®ƒæ˜¯å€¼å¾—ä½¿ç”¨æµç¨‹ç®¡ç†å™¨ï¼ˆä¾‹å¦‚PM2ï¼‰è¿›è¡Œçš„ã€‚ <br><br> æˆ‘å¸Œæœ›æ‰€æè¿°çš„ç»éªŒå°†æœ‰åŠ©äºå¿«é€Ÿå»ºç«‹ç”Ÿæ€ç³»ç»Ÿï¼Œä»¥å®ç°èˆ’é€‚çš„å·¥ä½œå¹¶ä¸“æ³¨äºåŠŸèƒ½å¼€å‘ã€‚ <br><br><h2> æœ‰ç”¨çš„é“¾æ¥ </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»£ç ä»“åº“</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¼”ç¤ºåº”ç”¨</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸¦SSRçš„Vue.jsè®¾ç½®æ–‡æ¡£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CSSæ¨¡å—è‡ªå®šä¹‰æ–‡æ¡£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Vuexæ–‡æ¡£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Vue Metaæ–‡æ¡£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Vue Hot Reload Apiå­˜å‚¨åº“</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN458396/">https://habr.com/ru/post/zh-CN458396/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN458382/index.html">æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ•™è¿™ä¸ªï¼Ÿ</a></li>
<li><a href="../zh-CN458384/index.html">HP 3Dç»“æ„åŒ–å…‰æ‰«æä»ªPro S3å®¡æŸ¥å’Œæµ‹è¯•</a></li>
<li><a href="../zh-CN458388/index.html">æ·±åº¦ï¼ˆå­¦ä¹ +éšæœºï¼‰æ£®æ—å’Œæ–‡ç« è§£æ</a></li>
<li><a href="../zh-CN458390/index.html">Ceph-ä»â€œè†ä¸Šâ€åˆ°â€œç”Ÿäº§â€ç¬¬2éƒ¨åˆ†</a></li>
<li><a href="../zh-CN458394/index.html">ä»¥LoRaWANä¿æŠ¤æ— çº¿åè®®ä¸ºä¾‹</a></li>
<li><a href="../zh-CN458398/index.html">è¿œç¨‹å·¥ä½œçš„å«ç”Ÿæˆ–å¿ƒçµæ„Ÿåº”çš„å¥½å¤„</a></li>
<li><a href="../zh-CN458400/index.html">å¾®æœåŠ¡æ¶æ„å’Œå®æ–½åˆ†æ­¥æŒ‡å—ç¬¬1éƒ¨åˆ†</a></li>
<li><a href="../zh-CN458404/index.html">ä»æ•´ä½“åˆ°å¾®æœåŠ¡çš„è¿‡æ¸¡ï¼šå†å²å’Œå®è·µ</a></li>
<li><a href="../zh-CN458406/index.html">å…³äºå®ç”¨ç¨‹åºå’Œéå®ç”¨ç¨‹åºçš„30å¤šä¸ªé—®é¢˜</a></li>
<li><a href="../zh-CN458408/index.html">å®‰å…¨å‘¨27ï¼šèƒ°å²›ç´ æ³µæ¼æ´</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>