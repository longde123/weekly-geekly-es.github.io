<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง ๐ธ ๐ง๐ฟ Spring Cache: ูู ุชูุตูู ุงูุชุฎุฒูู ุงููุคูุช ูู ุฏูููุฉ ูุงุญุฏุฉ ุฅูู ุงูุชูููู ุงููุฑู ููุฏูุฑ ุงูุชุฎุฒูู ุงููุคูุช ๐ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงุนุชุฏุช ุฃู ุฃุฎุงู ูู ุงูุชุฎุฒูู ุงููุคูุช. ูู ุฃูู ุฃุฑุบุจ ุญููุง ูู ุงูุตุนูุฏ ููุนุฑูุฉ ูุง ูุงู ุนููู ุ ููุฏ ุชุฎููุช ุนูู ุงูููุฑ ุจุนุถ ุงูุฃุดูุงุก ุงูุฎุงุตุฉ ุจูุดุฑูุน ููุตูุฑุฉ ุงููุญุฑู ุงูุชู ูุง ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Spring Cache: ูู ุชูุตูู ุงูุชุฎุฒูู ุงููุคูุช ูู ุฏูููุฉ ูุงุญุฏุฉ ุฅูู ุงูุชูููู ุงููุฑู ููุฏูุฑ ุงูุชุฎุฒูู ุงููุคูุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465667/" style=";text-align:right;direction:rtl"> ุงุนุชุฏุช ุฃู ุฃุฎุงู ูู ุงูุชุฎุฒูู ุงููุคูุช.  ูู ุฃูู ุฃุฑุบุจ ุญููุง ูู ุงูุตุนูุฏ ููุนุฑูุฉ ูุง ูุงู ุนููู ุ ููุฏ ุชุฎููุช ุนูู ุงูููุฑ ุจุนุถ ุงูุฃุดูุงุก ุงูุฎุงุตุฉ ุจูุดุฑูุน ููุตูุฑุฉ ุงููุญุฑู ุงูุชู ูุง ูููู ุฅูุง ูููุงุฆุฒ ูู ุฃูููุจูุงุฏ ุงูุฑูุงุถูุงุช ุงูุชุดุงููุง.  ุงุชุถุญ ุฃู ูุฐุง ููุณ ูุฐูู.  ุชุจูู ุฃู ุงูุชุฎุฒูู ุงููุคูุช ุจุณูุท ููุบุงูุฉ ูููููู ูุณูู ุงูุชูููุฐ ุจุดูู ูุง ูุตุฏู ูู ุฃู ูุดุฑูุน. <br><br><img src="https://habrastorage.org/webt/1f/my/g2/1fmyg2ofjbgqmyf3lorqqkan85u.jpeg"><br><br>  ูู ูุฐุง ุงูููุดูุฑ ุ ุณุฃุญุงูู ุดุฑุญ ุงูุชุฎุฒูู ุงููุคูุช ุจูุฐู ุงูุจุณุงุทุฉ ููุง ุฃููููุง ุงูุขู.  ุณุชุชุนุฑู ุนูู ููููุฉ ุชูููุฐ ุงูุชุฎุฒูู ุงููุคูุช ูู ุฏูููุฉ ูุงุญุฏุฉ ุ ูููููุฉ ุงูุชุฎุฒูู ุงููุคูุช ุญุณุจ ุงูููุชุงุญ ุ ูุชุนููู ุนูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ุงูุฃุฎุฑู ุงูุชู ุชุญุชุงุฌ ุฅูู ูุนุฑูุชูุง ุฅุฐุง ุชู ุฅุฑุดุงุฏู ุจุชุฎุฒูู ุดูุก ูุง ูู ูุดุฑูุน ุนููู ุ ููุง ุชุฑุบุจ ูู ุงูุชุดููุด ุงููุฌู. <br><a name="habracut"></a><br>  ููุงุฐุง ุฃููู "ุนูุฏ"ุ  ูุธุฑูุง ูุฃู ุงูุชุฎุฒูู ุงููุคูุช ุ ููุงุนุฏุฉ ุนุงูุฉ ุ ูู ุงูููุทูู ุงูุชูุฏูู ูู ุงููุดุงุฑูุน ุงููุจูุฑุฉ ุงููุญููุฉ ุจุฏุฑุฌุฉ ูุจูุฑุฉ ุ ูุน ุนุดุฑุงุช ุงูุขูุงู ูู ุงูุทูุจุงุช ูู ุงูุฏูููุฉ.  ูู ูุซู ูุฐู ุงููุดุฑูุนุงุช ุ ุญุชู ูุง ูุชู ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุดูู ุฒุงุฆุฏ ุ ูุฅููู ุนุงุฏุฉ ูุง ูููููู ุจุชุฎุฒูู ููุงููุงุช ูุณุชูุฏุน ุงูุชุฎุฒูู ุงููุคูุช.  ุฎุงุตุฉ ุฅุฐุง ูุงู ูู ุงููุนุฑูู ุฃูู ูุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุจุนุถ ุงูุฃูุธูุฉ ุงูุฑุฆูุณูุฉ ุจุชุฑุฏุฏ ูุนูู.  ูุญู ุฃููุณูุง ูุง ููุชุจ ูุซู ูุฐู ุงููุดุงุฑูุน ุ ูุญู ูุนูู ุนูููุง.  ุฅุฐุง ูุงู ุงููุดุฑูุน ุตุบูุฑูุง ููุง ููุฏุฏ ุงูุฃุญูุงู ุงูุฒุงุฆุฏุฉ ุ ููู ุงูุฃูุถู ุจุงูุทุจุน ุนุฏู ุชุฎุฒูู ุฃู ุดูุก - ุฏุงุฆููุง ูุง ุชููู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุฏุงุฆููุง ุฃูุถู ูู ุงูุจูุงูุงุช ุงูุชู ูุชู ุชุญุฏูุซูุง ุจุดูู ุฏูุฑู. <br><br>  ุนุงุฏุฉู ุ ูู ุงูุชุฏุฑูุจุงุช ุ ูุจุฏุฃ ุงูุฒุงุฆุฑ ุฃููุงู ุจุงูุฒุญู ุฃุณูู ุงูุบุทุงุก ุ ููุจุฏุฃ ูู ุงูุจุญุซ ูู ุงูุดุฌุงุนุฉ ุงูุชูููููุฌูุฉ ุ ุงูุชู ุชุฒุนุฌ ุงููุงุฑุฆ ูุซูุฑูุง ุ ูุนูุฏูุง ููุท ุ ุนูุฏูุง ูุงู ุจุชุตูุญ ูุตู ุฌูุฏ ููููุงู ููู ูููู ุฃู ุดูุก ุ ูุฅูู ูุฎุจุฑ ููู ูุนูู.  ูู ุดูุก ุณูููู ูุฎุชููุง ูุนูุง.  ุฃููุงู ุ ูุฌุนููุง ุชุนูู ุ ูููุถู ุ ุจุฃูู ุฌูุฏ ูููู ุ ูุจุนุฏ ุฐูู ุ ุฅุฐุง ููุช ููุชููุง ุ ููููู ุฃู ุชุจุญุซ ุชุญุช ุบุทุงุก ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุชุจุญุซ ุฏุงุฎู ุงูุตูุฏูู ููุณู ูุชุถุจุท ุงูุชุฎุฒูู ุงููุคูุช.  ููู ุญุชู ูู ูู ุชูู ุจุฐูู (ููุฐุง ูุจุฏุฃ ุจุงูููุทุฉ 6) ุ ูุณูุนูู ุงูุชุฎุฒูู ุงููุคูุช ุงูุฎุงุต ุจู ุนูู ูุฐุง ุงููุญู. <br><br>  ุณููุดุฆ ูุดุฑูุนูุง ุณูุญูู ููู ุฌููุน ุฌูุงูุจ ุงูุชุฎุฒูู ุงููุคูุช ุงูุชู ูุนุฏุช ุจูุง.  ูู ุงูููุงูุฉ ุ ูุงูุนุงุฏุฉ ุ ุณูููู ููุงู ุฑุงุจุท ูููุดุฑูุน ููุณู. <br><br><h2 style=";text-align:right;direction:rtl">  0. ุฅูุดุงุก ูุดุฑูุน </h2><br>  ุณููุดุฆ ูุดุฑูุนูุง ุจุณูุทูุง ุฌุฏูุง ูููููุง ูู ุฎูุงูู ุฃุฎุฐ ุงูููุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุฃุถูุช ูููุจูู ู Spring Cache ู Spring Data JPA ู H2 ุฅูู ุงููุดุฑูุน.  ุนูู ุงูุฑุบู ูู ุฃูู ูุง ูููู ุงูุงุณุชุบูุงุก ุนู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู Spring ููุท. <br><br><pre style=";text-align:right;direction:rtl"><code class="java hljs">plugins { id <span class="hljs-string"><span class="hljs-string">'org.springframework.boot'</span></span> version <span class="hljs-string"><span class="hljs-string">'2.1.7.RELEASE'</span></span> id <span class="hljs-string"><span class="hljs-string">'io.spring.dependency-management'</span></span> version <span class="hljs-string"><span class="hljs-string">'1.0.8.RELEASE'</span></span> id <span class="hljs-string"><span class="hljs-string">'java'</span></span> } group = <span class="hljs-string"><span class="hljs-string">'ru.xpendence'</span></span> version = <span class="hljs-string"><span class="hljs-string">'0.0.1-SNAPSHOT'</span></span> sourceCompatibility = <span class="hljs-string"><span class="hljs-string">'1.8'</span></span> configurations { compileOnly { extendsFrom annotationProcessor } } repositories { mavenCentral() } dependencies { implementation <span class="hljs-string"><span class="hljs-string">'org.springframework.boot:spring-boot-starter-cache'</span></span> implementation <span class="hljs-string"><span class="hljs-string">'org.springframework.boot:spring-boot-starter-data-jpa'</span></span> compileOnly <span class="hljs-string"><span class="hljs-string">'org.projectlombok:lombok'</span></span> runtimeOnly <span class="hljs-string"><span class="hljs-string">'com.h2database:h2'</span></span> annotationProcessor <span class="hljs-string"><span class="hljs-string">'org.projectlombok:lombok'</span></span> testImplementation <span class="hljs-string"><span class="hljs-string">'org.springframework.boot:spring-boot-starter-test'</span></span> }</code> </pre> <br>  ุณูููู ูุฏููุง ููุงู ูุงุญุฏ ููุท ุ ุฏุนูุง ูุณูููุง ุงููุณุชุฎุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name = <span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Data</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@ToString</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.IDENTITY) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Long id; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"name"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"email"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String email; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String email)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.email = email; } }</code> </pre> <br>  ุฃุถู ุงููุณุชูุฏุน ูุงูุฎุฏูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JpaRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Long</span></span></span><span class="hljs-class">&gt; </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Slf</span></span>4j <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserServiceImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> UserRepository repository; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserServiceImpl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserRepository repository)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository = repository; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(user); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"getting user by id: {}"</span></span>, id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.findById(id) .orElseThrow(() -&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EntityNotFoundException(<span class="hljs-string"><span class="hljs-string">"User not found by id "</span></span> + id)); } }</code> </pre> <br>  ุนูุฏูุง ูุฏุฎู ุทุฑููุฉ ุฎุฏูุฉ get () ุ ููุชุจ ุนููุง ูู ุงูุณุฌู. <br><br>  ุงูุงุชุตุงู ุจูุดุฑูุน Spring Cache. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableCaching</span></span> <span class="hljs-comment"><span class="hljs-comment">// Spring Cache public class CacheApplication { public static void main(String[] args) { SpringApplication.run(CacheApplication.class, args); } }</span></span></code> </pre> <br>  ุงููุดุฑูุน ุฌุงูุฒ <br><br><h2 style=";text-align:right;direction:rtl">  1. ุงูุชุฎุฒูู ุงููุคูุช ูุชูุฌุฉ ุงูุนูุฏุฉ </h2><br>  ูุงุฐุง ุงูุฑุจูุน ูุฎุจุฃ ุชูุนูุ  Spring Cache ูููู ุจุจุณุงุทุฉ ุจุชุฎุฒูู ูุชูุฌุฉ ุงูุฅุฑุฌุงุน ููุนููุงุช ุฅุฏุฎุงู ูุญุฏุฏุฉ.  ุฏุนููุง ุงูุชุญูู ูู ุฐูู.  ุณูุถุน ุงูุชุนููู ุงูุชูุถูุญูCacheable ุนูู ุทุฑููุฉ ุฎุฏูุฉ get () ููุชุฎุฒูู ุงููุคูุช ููุจูุงูุงุช ุงูุชู ุชู ุฅุฑุฌุงุนูุง.  ูุนุทู ูุฐุง ุงูุชุนููู ุงูุชูุถูุญู ุงุณู "ุงููุณุชุฎุฏููู" (ุณูููู ุจุชุญููู ุณุจุจ ุฐูู ุจุดูู ูููุตู). <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"getting user by id: {}"</span></span>, id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.findById(id) .orElseThrow(() -&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EntityNotFoundException(<span class="hljs-string"><span class="hljs-string">"User not found by id "</span></span> + id)); }</code> </pre> <br>  ูู ุฃุฌู ุงูุชุญูู ูู ููููุฉ ุนูู ุฐูู ุ ุณููุชุจ ุงุฎุชุจุงุฑูุง ุจุณูุทูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(SpringRunner.class) <span class="hljs-meta"><span class="hljs-meta">@SpringBootTest</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractTest</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Slf</span></span>4j <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserServiceTest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UserService service; <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User user1 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); User user2 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Kolya"</span></span>, <span class="hljs-string"><span class="hljs-string">"kolya@mail.ru"</span></span>)); getAndPrint(user1.getId()); getAndPrint(user2.getId()); getAndPrint(user1.getId()); getAndPrint(user2.getId()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAndPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"user found: {}"</span></span>, service.get(id)); } }</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงุณุชุทุฑุงุฏุง ุตุบูุฑุง ุ ููุงุฐุง ุฃูุชุจ ุนุงุฏุฉ AbstractTest ูุงุฑุซ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ููู.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ูููุตู ุชุนููู ุชูุถูุญู ุฎุงุต ุจู ุนููSpringBootTest ุ ูุณูุชู ุฅุนุงุฏุฉ ุฑูุน ุงูุณูุงู ููุซู ูุฐู ุงููุฆุฉ ูู ูู ูุฑุฉ.  ูุธุฑูุง ูุฃู ุงูุณูุงู ูููู ุฃู ูุฑุชูุน ููุฏุฉ 5 ุซูุงูู ุ ุฃู ุฑุจูุง 40 ุซุงููุฉ ุ ููุฐุง ูู ุฃู ุญุงู ูููุน ุนูููุฉ ุงูุงุฎุชุจุงุฑ ุฅูู ุญุฏ ูุจูุฑ.  ูู ุงูููุช ููุณู ุ ูุง ููุฌุฏ ุนุงุฏุฉ ุงุฎุชูุงู ูู ุงูุณูุงู ุ ูุนูุฏูุง ุชููู ุจุชุดุบูู ูู ูุฌููุนุฉ ูู ุงูุงุฎุชุจุงุฑุงุช ุฏุงุฎู ููุณ ุงููุตู ุงูุฏุฑุงุณู ุ ููุณุช ููุงู ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุณูุงู.  ุฅุฐุง ูููุง ุจูุถุน ุชุนููู ุชูุถูุญู ูุงุญุฏ ููุท ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ูุตู ุชุฌุฑูุฏู ุ ููุง ูู ุงูุญุงู ูู ุญุงูุชูุง ุ ููุฐุง ูุณูุญ ููุง ุจุฑูุน ุงูุณูุงู ูุฑุฉ ูุงุญุฏุฉ ููุท. <br><br>  ูุฐูู ุ ุฃูุถู ุชูููู ุนุฏุฏ ุงูุณูุงูุงุช ุงูุชู ุฃุซูุฑุช ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ / ุงูุชุฌููุน ุ ุฅุฐุง ุฃููู ุฐูู. <br></div></div><br>  ูุงุฐุง ุงุฎุชุจุงุฑูุง ุชูุนูุ  ูููู ุจุฅูุดุงุก ุงุซููู ูู ุงููุณุชุฎุฏููู ุซู ูุณุญุจูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช 2 ูุฑุงุช.  ููุง ูุชุฐูุฑ ุ ูุถุนูุง ุงูุชุนููู ุงูุชูุถูุญูCacheable ุ ูุงูุฐู ุณูุฎุฒู ูุคูุชูุง ุงูููู ุงููุฑุชุฌุนุฉ.  ุจุนุฏ ุชููู ุงููุงุฆู ูู ุทุฑููุฉ get () ุ ูุฎุฑุฌ ุงููุงุฆู ุฅูู ุงูุณุฌู.  ุฃูุถูุง ุ ูููู ุจุชุณุฌูู ูุนูููุงุช ุญูู ูู ุฒูุงุฑุฉ ุจูุงุณุทุฉ ุงูุชุทุจูู ุฅูู ุทุฑููุฉ get (). <br><br>  ูู ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑ.  ูุฐุง ูู ูุง ูุญุตู ุนููู ูู ูุญุฏุฉ ุงูุชุญูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">getting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> user found: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> user found: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Kolya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) user found: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) user found: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Kolya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  ููุง ูุฑู ุ ุฃูู ูุฑุชูู ุฐูุจูุง ูุนูุงู ุฅูู ุทุฑููุฉ get () ูุญุตููุง ูุนูููุง ุนูู ุงููุณุชุฎุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ูู ุฌููุน ุงูุญุงูุงุช ุงูุฃุฎุฑู ุ ูู ููู ููุงู ุงุณุชุฏุนุงุก ุญูููู ููุฐู ุงูุทุฑููุฉ ุ ุฃุฎุฐ ุงูุชุทุจูู ุจูุงูุงุช ูุฎุฒูุฉ ูุคูุชูุง ุญุณุจ ุงูููุชุงุญ (ูู ูุฐู ุงูุญุงูุฉ ุ ูุฐุง ูุนุฑู). <br><br><h2 style=";text-align:right;direction:rtl">  2. ุงูุชุฎุฒูู ุงููุคูุช ุงูุจูุงู ุงูุฑุฆูุณู </h2><br>  ููุงู ุญุงูุงุช ุนูุฏูุง ุชุฃุชู ุงูุนุฏูุฏ ูู ุงููุนููุงุช ุฅูู ุงูุทุฑููุฉ ุงููุฎุฒูุฉ ูุคูุชูุง.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฏ ูููู ูู ุงูุถุฑูุฑู ุชุญุฏูุฏ ุงููุนููุฉ ุงูุชู ุณูุญุฏุซ ุจูุง ุงูุชุฎุฒูู ุงููุคูุช.  ูุถูู ูุซุงููุง ุนูู ุทุฑููุฉ ูู ุดุฃููุง ุฃู ุชุญูุธ ููุงููุง ุชู ุชุฌููุนู ุญุณุจ ุงููุนููุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูููู ุฅุฐุง ูุงู ููุงู ููุงู ุจููุณ ุงูุงุณู ุจุงููุนู ุ ููู ูููู ุจุญูุธู.  ููููุงู ุจุฐูู ุ ุณูู ูุญุฏุฏ ูุนููุฉ ุงูุงุณู ูููุชุงุญ ููุชุฎุฒูู ุงููุคูุช.  ุณูุจุฏู ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(value = <span class="hljs-string"><span class="hljs-string">"users"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#name"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String email)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"creating user with parameters: {}, {}"</span></span>, name, email); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(name, email)); }</code> </pre> <br>  ุฏุนูุง ููุชุจ ุงูุงุฎุชุจุงุฑ ุงูููุงุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan1122@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Sergey"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); log.info(<span class="hljs-string"><span class="hljs-string">"all entries are below:"</span></span>); service.getAll().forEach(u -&gt; log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, u.toString())); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAndPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String email)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"created user: {}"</span></span>, service.create(name, email)); }</code> </pre> <br>  ุณูุญุงูู ุฅูุดุงุก ุซูุงุซุฉ ูุณุชุฎุฏููู ุ ูููู ุงูุงุณูุงู ูุชูุงุซููู ูููุง <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan1122@mail.ru"</span></span>);</code> </pre> <br>  ูุงุซูุงู ูููุง ุณูู ุชุชุทุงุจู ูุน ุงูุจุฑูุฏ ุงูุฅููุชุฑููู <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Sergey"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>);</code> </pre> <br>  ูู ุทุฑููุฉ ุงูุฅูุดุงุก ุ ูุณุฌู ูู ุญูููุฉ ุชุณูู ุงูุทุฑููุฉ ุ ูุฃูุถูุง ุ ุณูููู ุจุชุณุฌูู ุฌููุน ุงูููุงูุงุช ุงูุชู ุฃุฑุฌุนุช ูุฐู ุงูุทุฑููุฉ ุฅูููุง.  ุณุชููู ุงููุชูุฌุฉ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">creating user with parameters: Ivan, ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru created user: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Ivan, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Ivan, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) creating user with parameters: Sergey, ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru created user: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Sergey, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) all entries are below: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Ivan, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Sergey, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  ูุฑู ุฃูู ูู ุงููุงูุน ุ ุฃุทูู ุงูุชุทุจูู ุนูู ุงูุทุฑููุฉ 3 ูุฑุงุช ุ ูุฏุฎููุง ูุฑุชูู ููุท.  ุจูุฌุฑุฏ ุฃู ูุทุงุจู ุงูููุชุงุญ ุทุฑููุฉ ูุง ุ ููุนูุฏ ุจุจุณุงุทุฉ ูููุฉ ูุฎุฒูุฉ ูุคูุชูุง. <br><br><h2 style=";text-align:right;direction:rtl">  3. ุงูุชุฎุฒูู ุงููุคูุช ุงููุณุฑู.  CachePut </h2><br>  ููุงู ุญุงูุงุช ุนูุฏูุง ูุฑูุฏ ุชุฎุฒูู ูููุฉ ุงูุฅุฑุฌุงุน ูุจุนุถ ุงูููุงูุงุช ูุคูุชูุง ุ ูููู ูู ููุณ ุงูููุช ุ ูุญุชุงุฌ ุฅูู ุชุญุฏูุซ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ููุซู ูุฐู ุงูุงุญุชูุงุฌุงุช ุ ููุฌุฏ ุชุนููู ุชูุถูุญูCachePut.  ูููู ุจุชูุฑูุฑ ุงูุชุทุจูู ุฅูู ุงูุทุฑููุฉ ุ ุฃุซูุงุก ุชุญุฏูุซ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุฉ ุงูุฅุฑุฌุงุน ุ ุญุชู ุฅุฐุง ูุงูุช ูุฎุฒูุฉ ูุคูุชูุง ุจุงููุนู. <br><br>  ุฃุถู ุทุฑููุชูู ูุญูุธ ุจููุง ุงููุณุชุฎุฏู.  ุณูููู ุจุชูููุฒ ุฃุญุฏูู ุจุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ุงููุนุชุงุฏุฉ @ Cacheable ุ ูุงูุซุงูู ุจุงุณุชุฎุฏุงู CachePut. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(value = <span class="hljs-string"><span class="hljs-string">"users"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.name"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createOrReturnCached</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"creating user: {}"</span></span>, user); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(user); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(value = <span class="hljs-string"><span class="hljs-string">"users"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.name"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAndRefreshCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"creating user: {}"</span></span>, user); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(user); }</code> </pre> <br>  ุงูุทุฑููุฉ ุงูุฃููู ุณุชูุฑุฌุน ุจุจุณุงุทุฉ ุงูููู ุงููุฎุฒูุฉ ูุคูุชูุง ุ ุจูููุง ุณุชูุฑุถ ุงูุทุฑููุฉ ุงูุซุงููุฉ ุชุญุฏูุซ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุณูุชู ุชูููุฐ ุงูุชุฎุฒูู ุงููุคูุช ุจุงุณุชุฎุฏุงู ุงุณู ุงููุณุชุฎุฏู #.  ุณููุชุจ ุงูุงุฎุชุจุงุฑ ุงูููุงุจู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAndRefresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User user1 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user1: {}"</span></span>, user1); User user2 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"misha@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user2: {}"</span></span>, user2); User user3 = service.createAndRefreshCache(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"kolya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user3: {}"</span></span>, user3); User user4 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"petya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user4: {}"</span></span>, user4); }</code> </pre> <br>  ููููุง ููููุทู ุงูุฐู ุชู ูุตูู ุจุงููุนู ุ ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ูุชู ูููุง ุญูุธ ูุณุชุฎุฏู ุจุงุณู "Vasya" ูู ุฎูุงู ุทุฑููุฉ createOrReturnCached () ุ ุณูุชููู ุจุนุฏ ุฐูู ููุงููุง ูุฎุจุฃ ุ ููู ูุฏุฎู ุงูุชุทุจูู ูู ุงูุทุฑููุฉ ููุณูุง.  ุฅุฐุง ุงุชุตููุง ุจุงูุทุฑููุฉ createAndRefreshCache () ุ ูุณูุชู ุงููุชุงุจุฉ ููู ุงูููุงู ุงููุฎุฒู ูุคูุชูุง ููููุชุงุญ ุงููุณูู "Vasya" ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ูููู ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑ ููุฑู ูุง ุณูุชู ุนุฑุถู ูู ูุญุฏุฉ ุงูุชุญูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user1: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user2: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user3: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user4: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  ูุฑู ุฃู user1 ูุฏ ูุชุจ ุจูุฌุงุญ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุนูุฏูุง ูุญุงูู ุชุณุฌูู ุงููุณุชุฎุฏู ุจููุณ ุงูุงุณู ูุฑุฉ ุฃุฎุฑู ุ ูุญุตู ุนูู ุงููุชูุฌุฉ ุงููุฎุจุฃุฉ ูููุฏุงุก ุงูุฃูู (user2 ุ ูุงูุฐู ูููู ุงููุนุฑู ูู ููุณู user1 ุ ูุงูุฐู ูุฎุจุฑูุง ุฃู ุงููุณุชุฎุฏู ูู ููุชุจ ุ ููุฐุง ูุฌุฑุฏ ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช).  ุจุนุฏ ุฐูู ุ ููุชุจ ุงููุณุชุฎุฏู ุงูุซุงูุซ ูู ุฎูุงู ุงูุทุฑููุฉ ุงูุซุงููุฉ ุ ูุงูุชู ุ ุญุชู ูุน ุงููุชูุฌุฉ ุงููุฎุจุฃุฉ ุ ูุง ุฒุงูุช ุชุณูู ุงูุทุฑููุฉ ููุชุจุช ูุชูุฌุฉ ุฌุฏูุฏุฉ ุฅูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ูุฐุง ูู user3.  ููุง ูููููุง ุฃู ูุฑู ุ ูุฏูู ุจุงููุนู ูุนุฑู ุฌุฏูุฏ.  ุจุนุฏ ุฐูู ุ ูุณูู ุงูุทุฑููุฉ ุงูุฃููู ุ ูุงูุชู ุชุฃุฎุฐ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ ุจูุงุณุทุฉ user3. <br><br><h2 style=";text-align:right;direction:rtl">  4. ุฅุฒุงูุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  CacheEvict </h2><br>  ูู ุจุนุถ ุงูุฃุญูุงู ูุตุจุญ ูู ุงูุถุฑูุฑู ุชุญุฏูุซ ุจุนุถ ุงูุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุนูู ุณุจูู ุงููุซุงู ุ ุชู ุจุงููุนู ุญุฐู ููุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ููู ูุง ูุฒุงู ูู ุงููููู ุงููุตูู ุฅููู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ููุญูุงุธ ุนูู ุชูุงุณู ุงูุจูุงูุงุช ุ ูุญุชุงุฌ ุนูู ุงูุฃูู ุฅูู ุนุฏู ุชุฎุฒูู ุงูุจูุงูุงุช ุงููุญุฐููุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br><br>  ุฃุถู ุนุฏุฉ ุทุฑู ููุฎุฏูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"deleting user by id: {}"</span></span>, id); repository.deleteById(id); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteAndEvict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"deleting user by id: {}"</span></span>, id); repository.deleteById(id); }</code> </pre> <br>  ุงูุฃูู ุณูุคุฏู ุจุจุณุงุทุฉ ุฅูู ุญุฐู ุงููุณุชุฎุฏู ุ ูุงูุซุงูู ุณูุญุฐูู ุฃูุถูุง ุ ููููุง ุณูุถุน ุนูุงูุฉ ุนููู ูุน ุงูุชุนููู ุงูุชูุถูุญูCacheEvict.  ุฃุถู ุงุฎุชุจุงุฑูุง ุณูุคุฏู ุฅูู ุฅูุดุงุก ูุณุชุฎุฏููู ุ ูุจุนุฏ ุฐูู ุณูุชู ุญุฐู ูุงุญุฏ ูู ุฎูุงู ุทุฑููุฉ ุจุณูุทุฉ ุ ูุงูุซุงูู ูู ุฎูุงู ุทุฑููุฉ ูุดุฑูุญุฉ.  ุจุนุฏ ุฐูู ุ ุณูู ูุญุตู ุนูู ูุคูุงุก ุงููุณุชุฎุฏููู ูู ุฎูุงู ุทุฑููุฉ get (). <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User user1 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user1.getId())); User user2 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user2.getId())); service.delete(user1.getId()); service.deleteAndEvict(user2.getId()); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user1.getId())); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user2.getId())); }</code> </pre> <br>  ูู ุงูููุทูู ุฃูู ูุธุฑูุง ูุฃู ุงููุณุชุฎุฏู ูุฏ ุชู ุชุฎุฒููู ูุคูุชูุง ุจุงููุนู ุ ูุฅู ุงูุฅุฒุงูุฉ ูู ุชููุนูุง ูู ุงูุญุตูู ุนูููุง ุ ูุฃููุง ูุฎุจุฃุฉ.  ุฏุนูุง ูุฑู ุงูุณุฌูุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">getting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) deleting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> deleting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> javax.persistence.EntityNotFoundException: User not found by id <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  ูุฑู ุฃู ุงูุชุทุจูู ุฐูุจ ุจุฃูุงู ูู ููุชุง ุงูุญุงูุชูู ุฅูู ุทุฑููุฉ get () ู Spring ูุคูุชูุง ููุฐู ุงูููุงูุงุช.  ุจุนุฏ ุฐูู ุ ูููุง ุจุญุฐููุง ูู ุฎูุงู ุทุฑู ูุฎุชููุฉ.  ููุฏ ุญุฐููุง ุฃูู ูุงุญุฏ ุจุงูุทุฑููุฉ ุงููุนุชุงุฏุฉ ุ ูุธูุช ุงููููุฉ ุงููุฎุฒูุฉ ูุคูุชูุง ุ ูุฐูู ุนูุฏูุง ูุฌุญูุง ูู ุฌุนู ุงููุณุชุฎุฏู ุชุญุช ุงููุนุฑู 1 ุ ูุฌุญูุง.  ุนูุฏูุง ุญุงูููุง ุงูุญุตูู ุนูู ูุณุชุฎุฏู 2 ุ ุฃุฑุฌุนุช ุงูุทุฑููุฉ EntityNotFoundException - ูู ููู ููุงู ูุณุชุฎุฏู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br><br><h2 style=";text-align:right;direction:rtl">  5. ุฅุนุฏุงุฏุงุช ุงูุชุฌููุน.  Caching </h2><br>  ูู ุจุนุถ ุงูุฃุญูุงู ูุชุทูุจ ุฃุณููุจ ูุงุญุฏ ุนุฏุฉ ุฅุนุฏุงุฏุงุช ุงูุชุฎุฒูู ุงููุคูุช.  ูุณุชุฎุฏู ุงูุชุนููู ุงูุชูุถูุญูCaching ููุฐู ุงูุฃุบุฑุงุถ.  ูุฏ ูุจุฏู ุดูุก ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Caching</span></span>( cacheable = { <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(<span class="hljs-string"><span class="hljs-string">"contacts"</span></span>) }, put = { <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(<span class="hljs-string"><span class="hljs-string">"tables"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(<span class="hljs-string"><span class="hljs-string">"chairs"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(value = <span class="hljs-string"><span class="hljs-string">"meals"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.email"</span></span>) }, evict = { <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(value = <span class="hljs-string"><span class="hljs-string">"services"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.name"</span></span>) } ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheExample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br>  ูุฐู ูู ุงูุทุฑููุฉ ุงููุญูุฏุฉ ูุชุฌููุน ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ.  ุฅุฐุง ุญุงููุช ุชุฑุงูู ุดูุก ูู ูุฐุง ุงููุจูู <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"meals"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"contacts"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"tables"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheExample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br>  ุซู ุณูู ุชุฎุจุฑู IDEA ุฃู ูุฐุง ููุณ ูู ุงูุญุงู. <br><br><h2 style=";text-align:right;direction:rtl">  6. ุงูุชูููู ูุฑูุฉ.  CacheManager </h2><br>  ุฃุฎูุฑูุง ุ ุงูุชุดููุง ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ููู ูุนุฏ ุฃูุฑูุง ุบูุฑ ููููู ููุฎูู ุจุงููุณุจุฉ ููุง.  ุงูุขู ุฏุนููุง ููุธุฑ ุชุญุช ุงูุบุทุงุก ููุฑู ููู ูููููุง ุชูููู ุงูุชุฎุฒูู ุงููุคูุช ุจุดูู ุนุงู. <br><br>  ููุซู ูุฐู ุงูููุงู ุ ููุงู CacheManager.  ุฅูู ููุฌูุฏ ุฃูููุง ูุงู Spring Cache.  ุนูุฏูุง ุฃุถููุง ุชุนููููุง ุชูุถูุญููุงEnableCache ุ ุณูุชู ุฅูุดุงุก ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุชููุงุฆููุง ุจุญููู Spring.  ูููููุง ุงูุชุญูู ูู ุฐูู ุฅุฐุง ูููุง ุจุงูุงูุชูุงู ุงูุชููุงุฆู ุนูู ApplicationContext ููุชุญู ุนูุฏ ููุทุฉ ุงูุฅููุงู.  ุจูู ุตูุงุฏูู ุฃุฎุฑู ุ ุณูููู ููุงู cacheManager ุงูููู. <br><br><img src="https://habrastorage.org/webt/nc/bn/vp/ncbnvpwm57vw-2i9t7xpaiwr29s.png"><br><br>  ุฃูููุช ุงูุชุทุจูู ูู ุงููุฑุญูุฉ ุนูุฏูุง ุชู ุจุงููุนู ุฅูุดุงุก ูุณุชุฎุฏููู ููุถุนููุง ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุฅุฐุง ุงุชุตููุง ุจุงููุงุตูููุง ุงูุชู ูุญุชุงุฌูุง ูู ุฎูุงู ุชูููู ุงูุชุนุจูุฑ ุ ูุณูุฑู ุฃู ููุงู ุจุงููุนู ูุซู ูุฐู ุงูุญุจุฉ ุ ููู ุชุญุชูู ุนูู ConcurentMapCache ูุน ููุชุงุญ "ุงููุณุชุฎุฏููู" ููููุฉ ConcurrentHashMap ุ ุงูุชู ุชุญุชูู ุจุงููุนู ุนูู ูุณุชุฎุฏููู ุชู ุชุฎุฒูููู ูุคูุชูุง. <br><br><img src="https://habrastorage.org/webt/7-/xt/s9/7-xts9jrjipidhtsls1nv4gr2o0.png"><br><br>  ูููููุง ุ ุจุฏูุฑู ุ ุฅูุดุงุก ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุฏููุง ุ ูุน Habr ูุงููุจุฑูุฌูู ุ ุซู ุตููู ุญุณุจ ุฐูููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(<span class="hljs-string"><span class="hljs-string">"habrCacheManager"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CacheManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre> <br>  ูุจูู ููุท ุงุฎุชูุงุฑ ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฐู ุณูุณุชุฎุฏูู ุ ูุฃู ููุงู ุงููุซูุฑ ูููู.  ูู ุฃุฏุฑุฌ ุฌููุน ูุฏูุฑู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุณูููู ูุงููุงู ุฃู ูุนุฑู ุฃู ููุงู ูุซู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i><b>SimpleCacheManager</b></i> ูู ุฃุจุณุท ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุฑูุญุฉ ููุชุนูู ูุงูุงุฎุชุจุงุฑ. </li><li style=";text-align:right;direction:rtl">  <i><b>ConcurrentMapCacheManager</b></i> - Lazily ุชููุฆุฉ ุงููุซููุงุช ุงูุชู ุชู ุฅุฑุฌุงุนูุง ููู ุทูุจ.  ููุตู ุฃูุถูุง ุจุงุฎุชุจุงุฑ ูุชุนูู ููููุฉ ุงูุนูู ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ููุฐูู ูุจุนุถ ุงูุฅุฌุฑุงุกุงุช ุงูุจุณูุทุฉ ูุซู ุฅุฌุฑุงุกุงุชูุง.  ููุนูู ุงูุฌุงุฏ ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ููุตู ุจุงูุชุทุจูู ุฃุฏูุงู. </li><li style=";text-align:right;direction:rtl">  <i><b>JCacheCacheManager</b></i> ู <i><b>EhCacheCacheManager</b></i> ู <i><b>CaffeineCacheManager</b></i> ูู ูุฏูุฑู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i><b>ุงูุฌุงุฏูู</b></i> <i><b>ุงููุงุฆููู</b></i> ุนูู ุงูุดุฑูุงุก ูุงูุชู ูููู ุชุฎุตูุตูุง ุจุดูู ูุฑู ูุชุคุฏู ููุงู ูุฌููุนุฉ ูุงุณุนุฉ ุฌุฏูุง ูู ุงูุฅุฌุฑุงุกุงุช. </li></ul><br>  ูุฌุฒุก ูู ููุดูุฑู ุงููุชูุงุถุน ุ ูู ุฃุตู ูุฏูุฑู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุซูุงุซุฉ ุงูุฃุฎูุฑุฉ.  ุจุฏูุงู ูู ุฐูู ุ ุณููุธุฑ ูู ุงูุนุฏูุฏ ูู ุฌูุงูุจ ุฅุนุฏุงุฏ ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุงุณุชุฎุฏุงู ConcurrentMapCacheManager ููุซุงู. <br><br>  ูุฐูู ุ ุฏุนููุง ุฅุนุงุฏุฉ ุฅูุดุงุก ูุฏูุฑ ุงูุชุฎุฒูู ุงููุคูุช ูุฏููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(<span class="hljs-string"><span class="hljs-string">"habrCacheManager"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CacheManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentMapCacheManager(); }</code> </pre> <br>  ูุฏูุฑ ุงูุชุฎุฒูู ุงููุคูุช ุฌุงูุฒ. <br><br><h2 style=";text-align:right;direction:rtl">  7. ุฅุนุฏุงุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ููุช ุงูุญูุงุฉ ุ ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ูููู ุฌุฑุง. </h2><br>  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ููุชุจุฉ Google Guava ุฐุงุช ุดุนุจูุฉ ูุจูุฑุฉ.  ุฃุฎุฐุช ุขุฎุฑ ูุงุญุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">compile group: <span class="hljs-string"><span class="hljs-string">'com.google.guava'</span></span>, name: <span class="hljs-string"><span class="hljs-string">'guava'</span></span>, version: <span class="hljs-string"><span class="hljs-string">'28.1-jre'</span></span></code> </pre> <br>  ุนูุฏ ุฅูุดุงุก ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุนูุฏ ุชุนุฑูู ุทุฑููุฉ createConcurrentMapCache ุ ูุงูุชู ุณูู ูุฏุนู ูููุง CacheBuilder ูู ุฌูุงูุฉ.  ูู ูุฐู ุงูุนูููุฉ ุ ุณููุทูุจ ููุง ุชูููู ูุฏูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุนู ุทุฑูู ุชููุฆุฉ ุงูุทุฑู ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  maximumSize - ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ุงูููู ุงูุชู ูููู ุฃู ุชุญุชูููุง ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุจุงุณุชุฎุฏุงู ูุฐู ุงููุนููุฉ ุ ููููู ุงูุนุซูุฑ ุนูู ูุญุงููุฉ ููุนุซูุฑ ุนูู ุญู ูุณุท ุจูู ุงูุชุญููู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู JVM. </li><li style=";text-align:right;direction:rtl">  refreshAfterWrite - ุงูููุช ุจุนุฏ ูุชุงุจุฉ ุงููููุฉ ุฅูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุจุนุฏ ุฐูู ุณูุชู ุชุญุฏูุซูุง ุชููุงุฆููุง. </li><li style=";text-align:right;direction:rtl">  expireAfterAccess - ุนูุฑ ุงููููุฉ ุจุนุฏ ุขุฎุฑ ููุงููุฉ ููุง. </li><li style=";text-align:right;direction:rtl">  expireAfterWrite - ุนูุฑ ุงููููุฉ ุจุนุฏ ุงููุชุงุจุฉ ุฅูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ูุฐู ูู ุงููุนููุฉ ุงูุชู ุณูุญุฏุฏูุง. </li></ul><br>  ูุบูุฑูุง. <br><br>  ูุญุฏุฏ ูู ูุฏูุฑ ุนูุฑ ุงูุณุฌู.  ุญุชู ูุง ุชูุชุธุฑ ุทูููุง ุ ุชุนููู 1 ุซุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(<span class="hljs-string"><span class="hljs-string">"habrCacheManager"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CacheManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentMapCacheManager() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Cache </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createConcurrentMapCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentMapCache( name, CacheBuilder.newBuilder() .expireAfterWrite(<span class="hljs-number"><span class="hljs-number">1</span></span>, TimeUnit.SECONDS) .build().asMap(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }; }</code> </pre> <br>  ููุชุจ ุงุฎุชุจุงุฑ ุงูููุงุจูุฉ ููุฐู ุงูุญุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkSettings</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> InterruptedException </span></span>{ User user1 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user1.getId())); User user2 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user2.getId())); Thread.sleep(<span class="hljs-number"><span class="hljs-number">1000L</span></span>); User user3 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user3.getId())); }</code> </pre> <br>  ูุญูุธ ุนุฏุฉ ููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ูุฎุฒูุฉ ูุคูุชูุง ุ ูุฅููุง ูุง ูุญูุธ ุฃู ุดูุก.  ุฃููุงู ุ ูุญูุธ ูููุชูู ุ ุซู ููุชุธุฑ ุซุงููุฉ ูุงุญุฏุฉ ุญุชู ูููุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุจุนุฏ ุฐูู ูุญูุธ ูููุฉ ุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  ุชูุถุญ ุงูุณุฌูุงุช ุฃููุง ุฃูุดุฃูุง ูุณุชุฎุฏููุง ูุฃูู ูุฑุฉ ุ ุซู ุฌุฑุจูุง ูุณุชุฎุฏููุง ุขุฎุฑ ุ ูููู ูุธุฑูุง ูุฃู ุงูุจูุงูุงุช ุชู ุชุฎุฒูููุง ูุคูุชูุง ุ ููุฏ ุญุตููุง ุนูููุง ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช (ูู ููุชุง ุงูุญุงูุชูู ุ ุนูุฏ ุงูุญูุธ ูุนูุฏ ุงูุญุตูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช).  ุซู ุญุฏุซ ุณูุก ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุญูุซ ูุฎุจุฑูุง ุงูุณุฌู ุนู ุงูุญูุธ ุงููุนูู ูุงูุงุณุชูุงู ุงููุนูู ูููุณุชุฎุฏู. <br><br><h2 style=";text-align:right;direction:rtl">  8. ูุชูุฎูุต </h2><br>  ุนุงุฌูุงู ุฃู ุขุฌูุงู ุ ููุงุฌู ุงููุทูุฑ ุงูุญุงุฌุฉ ุฅูู ุชูููุฐ ุงูุชุฎุฒูู ุงููุคูุช ูู ุงููุดุฑูุน.  ุขูู ุฃู ูุณุงุนุฏู ูุฐุง ุงูููุงู ูู ููู ุงูููุถูุน ูุงููุธุฑ ูู ูุดุงูู ุงูุชุฎุฒูู ุงููุคูุช ุจุฌุฑุฃุฉ ุฃูุจุฑ. <br><br>  ุฌูุซุจ ูู ุงููุดุฑูุน ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/promoscow/cache</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar465667/">https://habr.com/ru/post/ar465667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar465655/index.html">ุฃุฎุจุงุฑ ูู ุฎุฑูุทุฉ ุงูุดุงุฑุน ุงูููุชูุญ ุฑูู 474 (08/13/2019 - 08/08/2019)</a></li>
<li><a href="../ar465657/index.html">ูุงููู ุงูุดูู ุงูุฑุนุงุด: ููููู ุงูุชุบูุจ ุนููู</a></li>
<li><a href="../ar465659/index.html">ุงูุฑุฏ ุนูู ููุงู "ูุชุญ ุณูุจูุฑูุง ูู ูุจู ุงููุณููููุช" ุ ุฃู ุจุนุฏ ุนุดุฑูู ุณูุฉ</a></li>
<li><a href="../ar465661/index.html">ูู ูุฏูู ุงูุถุง ูุซู ูุฐุง ุงูุตุฏูู ุฃู ุฑุจูุง ุฃูุชุ</a></li>
<li><a href="../ar465663/index.html">Superjob API FAQ (Job Job)</a></li>
<li><a href="../ar465669/index.html">ุนุฏ ุณุฑุนุฉ ุงูุชุญููู ูู ุงูุชุทุจูู ุงูุฎุงุต ุจู</a></li>
<li><a href="../ar465673/index.html">ุงููุงุฏู ูุงูุงุฑ: ูุฎุชุฑุน ูู ููููููุฏ</a></li>
<li><a href="../ar465675/index.html">ููู ุชูุชู ูุงุณุง ุจุณูุงูุฉ ูุฐูุงุก ุฑูุงุฏูุง</a></li>
<li><a href="../ar465677/index.html">ุงูุณูุง ุฌูุงุฒ Walkman: ูู ุดูุก ุนู ุณูุงุนุงุช ุงูุฑุฃุณ</a></li>
<li><a href="../ar465679/index.html">ูุงุฐุง ูููู ุฃู ุชูุนูู ุงูุณุงุนุฉ ุจุงูุฅุถุงูุฉ ุฅูู ุฅุธูุงุฑ ุงูููุช ูููููุฉ ุงุฎุชูุงุฑ ุณุงุนุชู ุงูุฃููู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>