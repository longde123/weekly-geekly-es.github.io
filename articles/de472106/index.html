<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèùÔ∏è üë©‚Äçüéì üêç MacBook Pro 2018 T2 f√ºr die Verwendung mit ArchLinux (Dualboot) üëßüèø ü•É ü§¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gab viel Hype um die Tatsache, dass es aufgrund des neuen T2-Chips unm√∂glich ist, Linux mit einer Touchbar auf dem neuen 2018 MacBook zu installier...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MacBook Pro 2018 T2 f√ºr die Verwendung mit ArchLinux (Dualboot)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472106/"> Es gab viel Hype um die Tatsache, dass es aufgrund des neuen T2-Chips unm√∂glich ist, Linux mit einer Touchbar auf dem neuen 2018 MacBook zu installieren.  Im Laufe der Zeit und bis Ende 2019 implementierten Entwickler von Drittanbietern eine Reihe von Treibern und Kernel-Patches f√ºr die Interaktion mit dem T2-Chip.  Der Haupttreiber f√ºr MacBook-Modelle ab 2018 implementiert die Arbeit von VHCI (die Bedienung von Touch / Tastatur / usw.) sowie die Funktionsweise des Sounds. <br><br>  Das Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mbp2018-bridge-drv</a> ist in drei Hauptkomponenten unterteilt: <br><br><ul><li>  BCE (Buffer Copy Engine) - Stellt den Hauptkommunikationskanal mit T2 her.  VHCI und Audio ben√∂tigen diese Komponente. </li><li>  VHCI ist ein virtueller USB-Host-Controller.  Tastatur, Maus und andere Systemkomponenten werden von dieser Komponente bereitgestellt (andere Treiber verwenden diesen Host-Controller, um mehr Funktionen bereitzustellen. </li><li>  Audio - Treiber f√ºr das T2-Audio-Interface, derzeit wird nur die Audioausgabe √ºber die eingebauten Lautsprecher des MacBook unterst√ºtzt </li></ul><a name="habracut"></a><br>  Das zweite Projekt hei√üt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">macbook12-spi-driver</a> und implementiert die M√∂glichkeit des Eingabetreibers f√ºr die Tastatur, das Trackpad SPI und die Touchbar f√ºr MacBook Pro Ende 2016 und sp√§tere Versionen.  Einige Treiber f√ºr die Tastatur / das Trackpad sind jetzt im Kernel enthalten, beginnend mit Version 5.3. <br><br>  Unterst√ºtzung wurde auch f√ºr Ger√§te wie Wi-Fi, Touchpad usw. mithilfe von Kernel-Patches implementiert.  Derzeit ist die Kernel-Version <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.3.5-1</a></b> <br><br><h4>  Was funktioniert im Moment </h4><br><ol><li>  NVMe </li><li>  Tastatur </li><li>  USB-C (Thunderbolt wurde nicht getestet, wenn das Modul automatisch geladen wird, wird das System fest angehalten) </li><li>  Touchbar (mit der M√∂glichkeit, die Fn-Tasten, die Hintergrundbeleuchtung, den Regler usw. einzuschalten) </li><li>  Ton (nur eingebaute Lautsprecher) </li><li>  Wi-Fi-Modul (√ºber brcmfmac und nur √ºber iw) </li><li>  DisplayPort √ºber USB-C </li><li>  Sensoren </li><li>  Anhalten / Fortsetzen (teilweise) </li><li>  etc .. </li></ol><br>  Dieses Tutorial gilt f√ºr macbookpro15.1 und macbookpro15.2.  Der Artikel wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von hier</a> aus einem Github in englischer Sprache entnommen.  Da nicht alle Artikel funktionierten, musste ich selbst nach einer L√∂sung suchen. <br><br><h4>  Was m√ºssen Sie installieren </h4><br><ul><li>  USB-C USB-Dock-Adapter (mindestens drei USB-Eing√§nge zum Anschlie√üen einer Maus, Tastatur, eines USB-Modems oder eines Telefons im Tethering-Modus).  Dies ist nur in den fr√ºhen Phasen der Installation erforderlich. </li><li>  USB-Tastatur </li><li>  USB / USB-C-Flash-Laufwerk mindestens 4 GB </li></ul><br><h2>  1. Deaktivieren Sie das Verbot des Herunterladens von externen Medien </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://support.apple.com/en-us/HT208330</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.ninjastik.com/support/2018-macbook-pro-boot-from-usb/</a> <br><br><h2>  2. Weisen Sie mit dem Festplatten-Dienstprogramm freien Speicherplatz zu </h2><br>  Der Einfachheit halber habe ich der Festplatte sofort 30 GB zugewiesen und sie im Festplatten-Dienstprogramm selbst so formatiert, dass sie exfat ist.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Partitionieren einer physischen Festplatte in Partitionen des Festplatten-Dienstprogramms</a> . <br><br><h2>  3. Bilden Sie ein ISO-Bild </h2><br>  <b>Optionen:</b> <br><br><ol><li>  Sie k√∂nnen den einfachen Weg gehen und das fertige Image mit dem Kernel 5.3.5-1 und den Patches vom <a href="">Link</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aunali1</a> <a href="">zum fertigen Image</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herunterladen</a> </li><li>  Erstellen Sie selbst ein Bild √ºber archlive (Sie ben√∂tigen ein System mit Archa-Verteilung). <br><br>  Installieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">archiso</a> <br><br><pre><code class="bash hljs">pacman -S archiso</code> </pre> <br><pre> <code class="bash hljs">cp -r /usr/share/archiso/configs/releng/ archlive <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> archlive</code> </pre><br>  F√ºgen Sie das Repository zu pacman.conf hinzu: <br><br><pre> <code class="bash hljs">[mbp] Server = https://packages.aunali1.com/archlinux/<span class="hljs-variable"><span class="hljs-variable">$repo</span></span>/<span class="hljs-variable"><span class="hljs-variable">$arch</span></span></code> </pre><br>  Ignorieren Sie den urspr√ºnglichen Kernel in pacman.conf: <br><br><pre> <code class="plaintext hljs">IgnorePkg = linux linux-headers</code> </pre><br>  F√ºgen Sie die erforderlichen Pakete hinzu. Am Ende f√ºgen wir den Kernel linux-mbp und linux-mbp-headers hinzu <br><br><pre> <code class="plaintext hljs">... wvdial xl2tpd linux-mbp linux-mbp-headers</code> </pre><br>  √Ñndern Sie das Skript so, dass es im interaktiven Modus funktioniert (ersetzen Sie pacstrap -C durch pacstrap -i -C): <br><br><pre> <code class="bash hljs">sudo nano /usr/bin/mkarchiso</code> </pre> <br><pre> <code class="plaintext hljs"># Install desired packages to airootfs _pacman () { _msg_info "Installing packages to '${work_dir}/airootfs/'..." if [[ "${quiet}" = "y" ]]; then pacstrap -i -C "${pacman_conf}" -c -G -M "${work_dir}/airootfs" $* &amp;&gt; /dev/null else pacstrap -i -C "${pacman_conf}" -c -G -M "${work_dir}/airootfs" $* fi _msg_info "Packages installed successfully!" }</code> </pre> <br>  Wir bilden ein Bild: <br><br><pre> <code class="bash hljs">sudo ./build.sh -v</code> </pre> <br>  Dr√ºcken Sie Y, um die ignorierten Pakete zu √ºberspringen, und schreiben Sie dann das ISO-Image auf das USB-Flash-Laufwerk: <br><br><pre> <code class="bash hljs">sudo dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=out/archlinux*.iso of=/dev/sdb bs=1M</code> </pre> <br></li></ol><br><h2>  4. Erster Start </h2><br>  Starten Sie mit dem eingesetzten Flash-Laufwerk und der Tastatur neu.  Dr√ºcken Sie die Optionen, wenn der Apfel angezeigt wird, und w√§hlen Sie EFI BOOT. <br><br>  Als n√§chstes m√ºssen Sie die Taste "e" dr√ºcken und <b>module_blacklist = thunderbolt</b> am Ende der Befehlszeile schreiben.  Wenn dies nicht erfolgt, startet das System m√∂glicherweise nicht und der Thunderbolt ICM-Fehler st√ºrzt ab. <br><br>  Mit fdisk / cfdisk finden wir unsere Partition (ich habe sie nvme0n1p4), formatieren und installieren den Bogen.  Sie k√∂nnen die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Anweisungen</a> oder von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dritten verwenden</a> . <br><br>  Wir erstellen keine Boot-Partition, sondern schreiben den Bootloader in <b>/ dev / nvme0n1p1</b> <br>  Nachdem die Umgebung in / mnt vollst√§ndig aufgebaut ist und bevor zu Arch-Chroot gewechselt wird, schreiben wir: <br><br><pre> <code class="bash hljs">mount /dev/nvme0n1p1 /mnt/boot arch-chroot /mnt /bin/bash</code> </pre><br>  Zu /etc/pacman.conf hinzuf√ºgen: <br><br><pre> <code class="bash hljs">[mbp] Server = https://packages.aunali1.com/archlinux/<span class="hljs-variable"><span class="hljs-variable">$repo</span></span>/<span class="hljs-variable"><span class="hljs-variable">$arch</span></span></code> </pre><br>  Installieren Sie den Kernel: <br><br><pre> <code class="bash hljs">sudo pacman -S linux-mbp linux-mbp-headers sudo mkinitcpio -p linux-mbp</code> </pre><br>  F√ºgen Sie Thunderbolt und Applesmc in /etc/modprobe.d/blacklist.conf ein <br><br><pre> <code class="plaintext hljs">blacklist thunderbolt blacklist applesmc</code> </pre><br><h3>  Tastatur, Touchbar usw. </h3><br>  Installieren Sie yay: <br><br><pre> <code class="bash hljs">sudo pacman -S git gcc make fakeroot binutils git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://aur.archlinux.org/yay.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> yay makepkg -si</code> </pre><br>  Installieren Sie die Module f√ºr die Touchbar: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> --branch mbp15 https://github.com/roadrunner2/macbook12-spi-driver.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> macbook12-spi-driver make install</code> </pre><br>  F√ºgen Sie dem Autoload Module hinzu: /etc/modules-load.d/apple.conf <br><br><pre> <code class="plaintext hljs">industrialio_triggered_buffer apple-ibridge apple-ib-tb apple-ib-als</code> </pre><br>  Installieren Sie die Kernelmodule f√ºr die Tastatur.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">anuali1-</a> Repository hat ein fertiges Paket, es hei√üt <b>apple-bce-dkms-git</b> .  Um es zu installieren, schreiben Sie in die Konsole: <br><br><pre> <code class="bash hljs">pacman -S apple-bce-dkms-git</code> </pre> <br>  In diesem Fall hei√üt das Kernelmodul <b>apple-bce</b> .  Im Falle der Selbstorganisation wird es <b>bce genannt</b> .  Wenn Sie also ein Modul im Abschnitt MODULE in der Datei mkinicpio.conf registrieren m√∂chten, vergessen Sie nicht, welches Modul Sie installiert haben. <br><br>  Manuelle Montage: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/MCMrARM/mbp2018-bridge-drv.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> mbp2018-bridge-drv make cp bce.ko /usr/lib/modules/extramodules-mbp/bce.ko</code> </pre><br>  F√ºgen Sie das bce- oder apple-bce-Modul zum automatischen Laden hinzu: /etc/modules-load.d/bce.conf <br><br><pre> <code class="bash hljs">bce</code> </pre> <br>  Wenn Sie standardm√§√üig die Fn-Schaltfl√§chen verwenden m√∂chten, schreiben wir in die Datei /etc/modprobe.d/apple-tb.conf: <br><br><pre> <code class="plaintext hljs">options apple-ib-tb fnmode=2</code> </pre> <br>  Aktualisieren des Kernels und der initramfs. <br><br><pre> <code class="bash hljs">mkinitcpio -p linux-mbp</code> </pre><br>  Installieren Sie iwd: <br><br><pre> <code class="bash hljs">sudo pacman -S networkmanager iwd</code> </pre> <br><h2>  5. Bootloader </h2><br>  Sobald in der Chroot alle Hauptpakete installiert sind, k√∂nnen Sie mit der Installation des Bootloaders fortfahren. <br><br>  Ich habe es nie geschafft, Grub zur Arbeit zu bringen.  Von einem externen USB-Laufwerk bootet Grub, aber wenn Sie versuchen, es in NVME √ºber zu registrieren <blockquote>  grub-install --target = x86_64-efi --efi-directory = / boot --bootloader-id = grub </blockquote>  Das System st√ºrzte in Kernel-Panik ab und nach dem Neustart eines neuen Elements √ºber Optionen wurde nicht angezeigt.  Ich habe keine verst√§ndliche L√∂sung f√ºr dieses Problem gefunden und mich daher entschlossen, den Start mit systemd-boot zu implementieren. <br><br><ol><li>  Wir starten <br><br><pre> <code class="bash hljs">bootctl --path=/boot install</code> </pre> <br>  und fliege in die Kernel-Panik.  Schalten Sie das MacBook aus, wieder ein, klicken Sie auf Optionen (deaktivieren Sie den USB-C-Hub nicht mit der Tastatur). </li><li>  √úberpr√ºfen Sie, ob zus√§tzlich zum externen Ger√§t ein neuer EFI BOOT-Eintrag angezeigt wurde </li><li>  Wir w√§hlen den Boot wie bei der ersten Installation von einem externen USB-Laufwerk aus (vergessen Sie nicht, module_blacklist = thunderbolt zu schreiben). </li><li>  Wir mounten unsere Festplatte und gehen durch Arch-Chroot in die Umgebung </li></ol><br><pre> <code class="bash hljs">mount /dev/nvme0n1p4 /mnt mount /dev/nvme0n1p1 /mnt/boot arch-chroot /mnt</code> </pre><br>  Wenn die Tastatur funktionieren muss, bis das System vollst√§ndig geladen ist (dies ist erforderlich, wenn die luks / dm-crypt-Verschl√ºsselung verwendet wird), schreiben wir sie in die Datei /etc/mkinicpio.conf im Abschnitt MODULES: <br><br><pre> <code class="plaintext hljs">MODULES=(ext4 applespi intel_lpss_pci spi_pxa2xx_platform bce)</code> </pre><br>  Aktualisieren des Kernels und der initramfs. <br><br><pre> <code class="bash hljs">mkinicpio -p linux-mbp</code> </pre><br><h4>  Konfigurieren Sie systemd-boot </h4><br>  Wir bearbeiten die Datei /boot/loader/loader.conf, l√∂schen alles darin und f√ºgen Folgendes hinzu: <br><br><pre> <code class="plaintext hljs">default arch timeout 5 editor 1</code> </pre><br>  Gehen Sie zum Ordner / boot / loader / entry, erstellen Sie die Datei arch.conf und schreiben Sie: <br><br><pre> <code class="plaintext hljs">title arch linux /vmlinuz-linux-mbp initrd /initramfs-linux-mbp.img options root=/dev/&lt;b&gt;nvme0n1p4&lt;/b&gt; rw pcie_ports=compat</code> </pre><br>  Wenn Sie luks und lvm verwendet haben, dann <br><br><pre> <code class="plaintext hljs">options cryptdevice=/dev/&lt;b&gt;nvme0n1p4&lt;/b&gt;:luks root=/dev/mapper/vz0-root rw pcie_ports=compat</code> </pre><br>  Starten Sie unter MacOS neu. <br><br><h2>  6. Wi-Fi-Setup </h2><br>  Wie sich herausstellte, speichert MacOS die Firmware-Dateien f√ºr den WLAN-Adapter im Ordner <b>/ usr / share / firmware / wifi</b> , und Sie k√∂nnen sie von dort in Form von Blobs √ºbernehmen und dem Kernelmodul brcmfmac zuf√ºhren.  Um genau herauszufinden, welche Dateien Ihr Adapter verwendet, √∂ffnen Sie das Terminal in MacOS und schreiben Sie: <br><br><pre> <code class="bash hljs">ioreg -l | grep C-4364</code> </pre> <br>  Wir bekommen eine lange Liste.  Wir ben√∂tigen nur Dateien aus dem Abschnitt <b>RequestedFiles</b> : <br><br><pre> <code class="plaintext hljs">"RequestedFiles" = ({"Firmware"="&lt;b&gt;C-4364__s-B2/maui.trx&lt;/b&gt;","TxCap"="C-4364__s-B2/maui-X3.txcb","Regulatory"="C-4364__s-B2/&lt;b&gt;maui-X3.clmb&lt;/b&gt;","NVRAM"="C-4364__s-B2/&lt;b&gt;P-maui-X3_M-HRPN_V-m__m-7.7.txt&lt;/b&gt;"})</code> </pre><br>  In Ihrem Fall k√∂nnen die Dateinamen abweichen.  Kopieren Sie sie aus dem Ordner / usr / share / firmware / wifi auf das USB-Flash-Laufwerk und benennen Sie es in die folgende Ansicht um: <br><br><pre> <code class="plaintext hljs"> maui.trx -&gt; brcmfmac4364-pcie.bin maui-X3.clmb -&gt; brcmfmac4364-pcie.clm_blob P-maui-X3_M-HRPN_V-m__m-7.7.txt -&gt; brcmfmac4364-pcie.Apple Inc.-&lt;b&gt;MacBookPro15,2.txt&lt;/b&gt;</code> </pre><br>  In diesem Fall enth√§lt die letzte Textdatei den Modellnamen. Wenn Ihr Modell nicht macbookpro15,2 ist, m√ºssen Sie diese Datei entsprechend Ihrem MacBook-Modell umbenennen. <br><br>  Starten Sie in arch neu. <br><br>  Kopieren Sie Dateien vom USB-Stick in den Ordner / lib / firmware / brcm / <br><br><pre> <code class="bash hljs">sudo cp brcmfmac4364-pcie.bin /lib/firmware/brcm/ sudo cp brcmfmac4364-pcie.clm_blob /lib/firmware/brcm/ sudo cp <span class="hljs-string"><span class="hljs-string">'brcmfmac4364-pcie.Apple Inc.-&lt;b&gt;MacBookPro15,2.txt'</span></span> /lib/firmware/brcm/</code> </pre><br>  √úberpr√ºfen Sie den Zustand des Moduls: <br><br><pre> <code class="bash hljs">rmmod brcmfmac modprobe brcmfmac</code> </pre><br>  Wir stellen sicher, dass die Netzwerkschnittstelle √ºber ifconfig / ip angezeigt wird. <br>  Konfigurieren Sie WLAN √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">iwctl</a> <br><br>  <b>Achtung</b>  <b>√úber netctl, nmcli usw.</b>  <b>Die Schnittstelle funktioniert nicht, nur √ºber iwd.</b> <br><br>  NetworkManager dazu bringen, iwd zu verwenden.  Erstellen Sie dazu die Datei /etc/NetworkManager/NetworkManager.conf und schreiben Sie: <br><br><pre> <code class="plaintext hljs">[device] wifi.backend=iwd</code> </pre><br>  Starten des NetworkManager-Dienstes <br><br><pre> <code class="bash hljs">sudo systemctl start NetworkManager.service sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> NetworkManager.service</code> </pre><br><h2>  7. Ton </h2><br>  Um Sound zu erzeugen, m√ºssen Sie pulseaudio installieren: <br><br><pre> <code class="bash hljs">sudo pacman -S pulseaudio</code> </pre><br>  Laden Sie drei Dateien herunter: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">91-pulseaudio-custom.rules</a> </li><li>  <a href="">apple-t2.conf</a> </li><li>  <a href="">AppleT2.conf</a> </li></ul><br>  Bewegen Sie sie: <br><br><pre> <code class="plaintext hljs"> /usr/share/alsa/cards/AppleT2.conf /usr/share/pulseaudio/alsa-mixer/profile-sets/apple-t2.conf /usr/lib/udev/rules.d/91-pulseaudio-custom.rules</code> </pre> <br><h2>  8. Anhalten / Fortsetzen </h2><br>  Im Moment, <b>16.10.2019</b> , <b>m√ºssen</b> Sie entweder Sound oder Suspend / <b>Resume</b> ausw√§hlen.  Wir warten darauf, dass der Autor des bce-Moduls die Funktionalit√§t beendet. <br><br>  Um ein Modul mit Unterst√ºtzung f√ºr Susped / Resume zu erstellen, m√ºssen Sie Folgendes tun: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/MCMrARM/mbp2018-bridge-drv.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> mbp2018-bridge-drv git checkout <span class="hljs-built_in"><span class="hljs-built_in">suspend</span></span> make cp bce.ko /usr/lib/modules/extramodules-mbp/bce.ko modprobe bce</code> </pre><br>  Wenn Sie das vorgefertigte Apple-Bce-Modul aus dem anuali1-Repository installiert haben, m√ºssen Sie es zuerst entfernen und erst dann das BCE-Modul mit Unterst√ºtzung f√ºr den Suspend-Modus sammeln und installieren. <br><br>  Au√üerdem m√ºssen Sie das applesmc-Modul zur Blacklist hinzuf√ºgen (falls Sie dies noch nicht getan haben) und sicherstellen, dass der Parameter <b>pcie_ports = compatible</b> der <b>Zeile /boot/loader/entries/arch.conf</b> in der Optionszeile am Ende hinzugef√ºgt wird. <br><br>  Im Moment st√ºrzt der Touchbar-Treiber ab, wenn Sie in den Suspend-Modus wechseln, und der Thunderbolt-Treiber unterbricht das System manchmal f√ºr mehr als 30 Sekunden und wenn Sie es fortsetzen, f√ºr einige Minuten.  Dies kann durch automatisches Herunterladen von Problemmodulen behoben werden. <br><br>  Erstellen Sie das Skript <b>/lib/systemd/system-sleep/rmmod.sh</b> : <br><br><pre> <code class="plaintext hljs">#!/bin/sh if [ "${1}" == "pre" ]; then rmmod thunderbolt rmmod apple_ib_tb elif [ "${1}" == "post" ]; then modprobe apple_ib_tb modprobe thunderbolt fi</code> </pre><br>  Machen Sie es ausf√ºhrbar: <br><br><pre> <code class="bash hljs">sudo chmod +x /lib/systemd/system-sleep/rmmod.sh</code> </pre> <br>  Das ist alles f√ºr jetzt.  Das Ergebnis ist ein voll funktionsf√§higes System, mit Ausnahme einiger Nuancen mit Suspend / Resume.  Mehrere Tage lang wurden keine Abst√ºrze und Kernel-Panik beobachtet.  Ich hoffe, dass der Autor des bce-Moduls es in naher Zukunft fertigstellen wird und wir volle Unterst√ºtzung f√ºr Suspend / Resume und Sound erhalten. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de472106/">https://habr.com/ru/post/de472106/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de472092/index.html">Unsichere PHP-Funktionen</a></li>
<li><a href="../de472094/index.html">Delegierte und Veranstaltungen in C #</a></li>
<li><a href="../de472096/index.html">Android Clicker abonniert Benutzer f√ºr kostenpflichtige Dienste</a></li>
<li><a href="../de472100/index.html">Shchyry Ukrainian Dunno oder How Kiev nicht erraten</a></li>
<li><a href="../de472104/index.html">Habr Weekly # 23 / Microsoft fliegt in Raum und Geist und begr√§bt Windows Phone, Matrix Legacy und Papierspiele</a></li>
<li><a href="../de472110/index.html">Wir bestehen die Herausforderung RegexPlay zu 100%</a></li>
<li><a href="../de472112/index.html">Chatbot auf die billige</a></li>
<li><a href="../de472114/index.html">Spielekonsole und Do-it-yourself-Spiele dazu. Little Game Engine + ESPboy</a></li>
<li><a href="../de472118/index.html">Wie amerikanischer Zoom in China blockiert</a></li>
<li><a href="../de472120/index.html">Adaptives Feldnavigationskonzept</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>