<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💃🏼 ⛷️ 😱 Menggunakan Janji dalam JavaScript 🤳🏿 🚆 🔭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dari waktu ke waktu kami menerbitkan materi yang terkait dengan penggunaan janji dalam JavaScript. 

 Ini beberapa di antaranya.  Janji di ES6: Pola d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menggunakan Janji dalam JavaScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/418085/">  Dari waktu ke waktu kami menerbitkan materi yang terkait dengan penggunaan janji dalam JavaScript. <br><br><div class="spoiler">  <b class="spoiler_title">Ini beberapa di antaranya.</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Janji di ES6: Pola dan Anti-Pola</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JavaScript: metode pemrograman asinkron</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JavaScript ES8 dan transisi ke async / tunggu</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Async / menunggu: 6 alasan untuk melupakan janji</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Escape from Hell async / tunggu</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JavaScript ES6: menulis lebih sedikit - berbuat lebih banyak</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan Janji Bagi Mereka Yang Ingin Memahami</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Desain async / menunggu JavaScript: kekuatan, jebakan, dan pola penggunaan</a> </div></div><br>  Mengapa perhatian begitu terpusat pada janji?  Kami percaya bahwa intinya adalah bahwa teknologi ini sangat diminati, dan cukup sulit untuk dipahami. <br><br>  Karena itu, jika Anda ingin lebih memahami janji-janji itu, kami menawarkan Anda terjemahan dari artikel berikutnya tentang topik ini.  Penulisnya mengatakan bahwa ia telah mengembangkan Java dan PHP selama 10 tahun terakhir, tetapi selama ini ia telah tertarik dengan JavaScript.  Baru-baru ini, ia memutuskan untuk serius terlibat dalam JS, dan janji menjadi subjek pertama yang membuatnya tertarik. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/s3/wz/42/s3wz42iyj1wjzrvjzsx6spduxeu.jpeg"></a> <br><br>  Kami percaya bahwa materi ini akan menarik bagi pengembang pemula yang merasa bahwa, meskipun mereka menggunakan janji, mereka tidak memahaminya dengan cukup baik.  Ada kemungkinan bahwa kisah seseorang yang melihat JavaScript dengan tampilan segar dan ingin menjelaskan kepada orang lain apa yang dia pahami, tidak percaya bahwa beberapa hal dapat dimengerti oleh semua orang dan tanpa penjelasan, akan membantu pemula dalam menguasai mekanisme JavaScript. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">JavaScript melalui mata pemula</font> </h2><br>  Siapa pun yang mulai menulis dalam JavaScript, mungkin merasakan apa yang disebut "tidak pada tempatnya".  Beberapa mengatakan bahwa JS adalah bahasa pemrograman yang sinkron, yang lain mengatakan bahwa itu tidak sinkron.  Seorang pemula mendengar tentang kode yang memblokir utas utama, dan tentang kode yang tidak memblokirnya, tentang pola desain berbasis peristiwa, tentang siklus hidup peristiwa, tentang tumpukan panggilan fungsi, tentang antrian acara dan kenaikannya, tentang polyfill.  Dia belajar bahwa ada hal-hal seperti Babel, Angular, React, Vue, dan segudang perpustakaan lainnya.  Jika Anda baru saja mengenali diri sendiri dalam "pemula" - jangan khawatir tentang hal itu.  Anda bukan yang pertama maupun yang terakhir.  Bahkan ada istilah untuk ini - yang disebut "kelelahan JavaScript".  Lucas F Costa dengan tepat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://twitter.com/housecor/status/888468139389861888%3Fref_src%3Dtwsrc%255Etfw%257Ctwcamp%255Etweetembed%257Ctwterm%255E888468139389861888%26ref_url%3D">berbicara</a> tentang hal ini: " <i>Kelelahan JavaScript adalah sesuatu yang dapat diamati ketika orang menggunakan alat yang mereka tidak perlu untuk memecahkan masalah yang tidak mereka miliki</i> ." <br><br>  Tapi jangan bicara tentang hal-hal yang menyedihkan.  Jadi, JavaScript adalah bahasa pemrograman sinkron, yang, berkat mekanisme panggilan balik, memungkinkan Anda memanggil fungsi dengan cara yang sama seperti dalam bahasa asinkron. <br><br><h2>  <font color="#3AC1EF">Sebuah cerita sederhana tentang janji</font> </h2><br>  Kata janji diterjemahkan menjadi janji.  Obyek janji dalam pemrograman, yang kita sebut "janji," sangat mirip dengan janji yang biasa orang berikan satu sama lain dalam kehidupan nyata.  Jadi mari kita bicara tentang janji-janji ini terlebih dahulu. <br><br>  Di Wikipedia, Anda dapat menemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">definisi</a> kata "janji" berikut: "kewajiban, persetujuan seseorang untuk memenuhi sesuatu atau, sebaliknya, tidak melakukan".  Dalam kamus Ozhegov, "janji" adalah "komitmen sukarela untuk melakukan sesuatu." <br><br>  Jadi apa yang kita ketahui tentang janji? <br><br><ol><li>  Sebuah janji memberi Anda jaminan bahwa sesuatu akan dilakukan.  Tidak masalah siapa yang melakukan ini: orang yang membuat janji, atau orang lain, atas permintaan orang yang membuat janji.  Sebuah janji memberi keyakinan pada sesuatu, berdasarkan keyakinan ini, orang yang menerima janji itu, misalnya, dapat membuat beberapa rencana. </li><li>  Sebuah janji bisa dipenuhi atau tidak. </li><li>  Jika janji itu dipenuhi, maka, sebagai hasilnya, Anda mengharapkan sesuatu yang dapat Anda gunakan di masa depan untuk melakukan tindakan apa pun atau mengimplementasikan rencana apa pun. </li><li>  Jika janji itu tidak dipenuhi, maka Anda akan ingin mencari tahu mengapa orang yang memberikannya tidak dapat memenuhinya.  Setelah Anda menemukan alasan untuk apa yang terjadi dan Anda akan yakin bahwa janji itu belum dipenuhi, Anda dapat memikirkan apa yang harus dilakukan selanjutnya, atau bagaimana cara mengatasi situasi tersebut. </li><li>  Setelah Anda dijanjikan sesuatu, yang Anda miliki hanyalah semacam jaminan.  Anda tidak dapat memanfaatkan apa yang dijanjikan segera.  Anda dapat menentukan sendiri apa yang perlu Anda lakukan jika janji itu dipenuhi (oleh karena itu, Anda akan menerima janji itu), dan apa yang perlu Anda lakukan jika ternyata rusak (dalam hal ini Anda tahu alasan untuk apa yang terjadi, dan karena itu Anda dapat memikirkan rencana cadangan tindakan ) </li><li>  Kemungkinan orang yang membuat janji itu akan menghilang begitu saja.  Dalam kasus-kasus seperti itu, ada baiknya janji itu terikat pada semacam jangka waktu.  Misalnya, jika orang yang memberi Anda janji tidak muncul dalam 10 hari, Anda dapat mengasumsikan bahwa ia memiliki beberapa masalah dan ia melanggar janji.  Akibatnya, bahkan jika orang yang membuat janji memenuhi itu dalam 15 hari, itu tidak masalah, jadi Anda sudah bertindak pada rencana alternatif, tidak mengandalkan janji. </li></ol><br>  Sekarang beralih ke JavaScript. <br><br><h2>  <font color="#3AC1EF">Janji JavaScript</font> </h2><br>  Saya punya satu aturan: ketika melakukan JavaScript, saya selalu membaca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> yang dapat ditemukan di MDN.  Tampaknya bagi saya bahwa sumber daya ini lebih baik dibandingkan dengan yang lain dalam hal spesifisitas dan kejelasan presentasi.  Oleh karena itu, ketika mempelajari janji, saya membiasakan diri dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">materi yang</a> relevan dan bereksperimen dengan kode untuk membiasakan diri dengan konstruksi sintaks yang baru. <br><br>  Untuk memahami janji-janji itu, Anda harus berurusan dengan dua hal utama.  Yang pertama adalah penciptaan janji.  Yang kedua adalah memproses hasil yang dikembalikan oleh janji.  Meskipun sebagian besar kode yang kita tulis ditujukan untuk bekerja dengan janji yang dibuat, misalnya, oleh perpustakaan tertentu, pemahaman penuh tentang mekanisme kerja janji tidak diragukan lagi akan berguna.  Selain itu, bagi seorang programmer yang sudah memiliki beberapa pengalaman, mengetahui cara membuat janji sama pentingnya dengan mengetahui cara bekerja dengannya. <br><br><h2>  <font color="#3AC1EF">Buat Janji</font> </h2><br>  Begini caranya janji dibuat: <br><br><pre><code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>( <span class="hljs-comment"><span class="hljs-comment">/* executor */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ ... } );</code> </pre> <br>  Konstruktor menerima fungsi yang melakukan tindakan tertentu, kami menyebutnya di sini <code>executor</code> .  Fungsi ini membutuhkan dua parameter - <code>resolve</code> dan <code>reject</code> , yang pada gilirannya juga merupakan fungsi.  Janji biasanya digunakan untuk melakukan operasi atau kode asinkron yang dapat memblokir utas, misalnya, yang berfungsi dengan file, membuat panggilan API, membuat kueri basis data, berurusan dengan I / O, dan sebagainya.  Awal operasi asinkron seperti itu dilakukan dalam fungsi <code>executor</code> .  Jika operasi asinkron selesai dengan sukses, maka hasil yang diharapkan dari janji akan dikembalikan dengan memanggil fungsi <code>resolve</code> .  Situasi di mana fungsi ini disebut ditentukan oleh pencipta janji.  Demikian pula, ketika kesalahan terjadi, informasi tentang apa yang terjadi dikembalikan dengan memanggil fungsi <code>reject</code> . <br><br>  Sekarang kita tahu, secara umum, bagaimana membuat janji, kita akan membuat janji sederhana untuk lebih memahami segalanya. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keepsHisWord; keepsHisWord = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; promise1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (keepsHisWord) {   resolve(<span class="hljs-string"><span class="hljs-string">"The man likes to keep his word"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {   reject(<span class="hljs-string"><span class="hljs-string">"The man doesnt want to keep his word"</span></span>); } }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(promise1);</code> </pre> <br>  Inilah yang akan dihasilkan oleh kode ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e2/f52/7a1/8e2f527a185616e8dbb6fa3433303d54.png"></div><br>  <i><font color="#999999">Promise memiliki status (PromiseStatus) dan sebuah nilai (PromiseValue)</font></i> <br><br>  Karena janji kami segera diselesaikan, kami tidak dapat menyelidiki keadaan awalnya.  Karena itu, mari kita buat janji baru, yang, untuk penyelesaiannya, perlu waktu.  Cara termudah untuk melakukan ini adalah dengan menggunakan fungsi <code>setTimeout</code> . <br><br><pre> <code class="hljs javascript">promise2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{   resolve({     <span class="hljs-attr"><span class="hljs-attr">message</span></span>: <span class="hljs-string"><span class="hljs-string">"The man likes to keep his word"</span></span>,     <span class="hljs-attr"><span class="hljs-attr">code</span></span>: <span class="hljs-string"><span class="hljs-string">"aManKeepsHisWord"</span></span>   }); }, <span class="hljs-number"><span class="hljs-number">10</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>); }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(promise2);</code> </pre> <br>  Dalam kode ini, janji dibuat yang pasti akan diselesaikan dalam 10 detik.  Ini memberi kita kesempatan untuk melihat keadaan janji yang tidak sah. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd4/828/13d/bd482813d5a8d53df3eb39b716b8c0b7.png"></div><br>  <i><font color="#999999">Janji yang Tidak Terselesaikan</font></i> <br><br>  Setelah 10 detik berlalu, janji itu akan terselesaikan.  Akibatnya, baik <code>PromiseValue</code> dan <code>PromiseValue</code> akan diperbarui sesuai.  Seperti yang Anda lihat, dalam contoh ini kami mengubah fungsi yang disebut ketika janji berhasil diselesaikan, sekarang ia mengembalikan bukan string biasa, tetapi sebuah objek.  Ini dilakukan untuk menunjukkan kemampuan untuk mengembalikan struktur data yang kompleks menggunakan fungsi <code>resolve</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/707/ff7/74a/707ff774ad727f4e41a247714182d7fd.png"></div><br>  <i><font color="#999999">Janji diselesaikan setelah 10 detik dan mengembalikan suatu objek</font></i> <br><br>  Mari kita sekarang melihat janji itu, yang kami putuskan untuk tidak mengizinkan, tetapi untuk menolak.  Untuk melakukan ini, kami memodifikasi kode yang sudah digunakan dalam contoh pertama. <br><br><pre> <code class="hljs javascript">keepsHisWord = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; promise3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (keepsHisWord) {   resolve(<span class="hljs-string"><span class="hljs-string">"The man likes to keep his word"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {   reject(<span class="hljs-string"><span class="hljs-string">"The man doesn't want to keep his word"</span></span>); } }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(promise3);</code> </pre> <br>  Karena kami tidak menangani situasi penolakan janji, pesan kesalahan akan ditampilkan di konsol browser (Google Chrome digunakan di sini).  Kami akan berbicara lebih banyak tentang ini di bawah ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd1/cd1/aa6/bd1cd1aa66cdd5969cb7e8726236938d.png"></div><br>  <i><font color="#999999">Janji yang Ditolak</font></i> <br><br>  Sekarang, setelah menganalisis ketiga contoh, kita dapat melihat bahwa tiga nilai yang berbeda dapat muncul di <code>PromiseStatus</code> : <code>pending</code> (tertunda), <code>resolved</code> (resolusi berhasil) dan <code>rejected</code> (ditolak).  Ketika sebuah janji dibuat, di <code>PromiseStatus</code> akan <code>pending</code> , dan di <code>PromiseValue</code> akan <code>undefined</code> .  Nilai-nilai ini akan tetap sampai janji terselesaikan atau ditolak.  Ketika sebuah janji berada dalam keadaan <code>resolved</code> atau <code>rejected</code> , itu disebut janji yang <code>settled</code> .  Janji semacam itu telah beralih dari negara tunggu ke negara di mana ia memiliki negara yang <code>resolved</code> atau negara yang <code>rejected</code> . <br><br>  Sekarang kita telah belajar bagaimana janji dibuat, kita dapat berbicara tentang bagaimana memproses apa yang dikembalikan.  Untuk mengetahui hal ini, kita perlu memahami struktur objek <code>Promise</code> . <br><br><h2>  <font color="#3AC1EF">Obyek Janji</font> </h2><br>  Menurut dokumentasi MDN, objek <code>Promise</code> adalah hasil dari penyelesaian operasi asinkron yang berhasil atau tidak berhasil. <br><br>  Objek <code>Promise</code> memiliki metode statis dan metode prototipe objek.  Metode statis dapat dipanggil tanpa membuat turunan objek, dan untuk memanggil metode prototipe, Anda memerlukan turunan objek <code>Promise</code> .  Perlu diingat bahwa metode statis dan reguler mengembalikan objek <code>Promise</code> .  Ini membuat pekerjaan lebih mudah. <br><br><h3>  <font color="#3AC1EF">▍ Metode prototipe objek janji</font> </h3><br>  Mari kita bicara tentang metode prototipe objek <code>Promise</code> .  Ada tiga metode seperti itu.  Jangan lupa bahwa metode ini dapat dipanggil pada instance objek <code>Promise</code> , dan bahwa mereka sendiri yang mengembalikan janji.  Berkat semua metode ini, Anda dapat menetapkan penangan yang merespons perubahan dalam status janji.  Seperti yang telah kita lihat, ketika sebuah janji dibuat, itu dalam kondisi <code>pending</code> .  Ketika sebuah janji bertransisi ke keadaan <code>resolved</code> atau <code>rejected</code> , setidaknya satu dari metode berikut ini akan dipanggil: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Promise</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.prototype</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.catch</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">onRejected</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">Promise</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.prototype</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.then</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">onFulfilled</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">onRejected</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">Promise</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.prototype</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.finally</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">onFinally</span></span>)</code> </pre> <br>  Di bawah ini adalah diagram operasi janji dan peristiwa yang mengarah pada panggilan <code>.catch</code> dan <code>.catch</code> .  Karena metode ini mengembalikan objek <code>Promise</code> , panggilan mereka dapat dirantai, ini juga tercermin dalam diagram.  Jika janji tersebut menggunakan metode <code>.finally</code> , itu akan dipanggil ketika janji pindah ke negara yang <code>settled</code> , terlepas dari apakah janji itu berhasil diselesaikan atau ditolak. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c01/d3a/9bc/c01d3a9bce02c7b7a0a7373bba117a02.png"><br>  <i><font color="#999999">Skema kerja promis (gambar diambil <a href="">dari sini</a> )</font></i> <br><br>  Berikut ini cerpennya.  Anda seorang pelajar dan minta ibu Anda membelikan Anda ponsel.  Dia berkata: "Jika penghematan kami lebih dari biaya telepon, saya akan membelinya untuk Anda."  Sekarang menceritakan kembali kisah ini dalam JavaScript. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> momsPromise = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ momsSavings = <span class="hljs-number"><span class="hljs-number">20000</span></span>; priceOfPhone = <span class="hljs-number"><span class="hljs-number">60000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (momsSavings &gt; priceOfPhone) {   resolve({     <span class="hljs-attr"><span class="hljs-attr">brand</span></span>: <span class="hljs-string"><span class="hljs-string">"iphone"</span></span>,     <span class="hljs-attr"><span class="hljs-attr">model</span></span>: <span class="hljs-string"><span class="hljs-string">"6s"</span></span>   }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {   reject(<span class="hljs-string"><span class="hljs-string">"We donot have enough savings. Let us save some more money."</span></span>); } }); momsPromise.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Hurray I got this phone as a gift "</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(value)); }); momsPromise.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Mom coudn't buy me the phone because "</span></span>, reason); }); momsPromise.finally(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(   <span class="hljs-string"><span class="hljs-string">"Irrespecitve of whether my mom can buy me a phone or not, I still love her"</span></span> ); });</code> </pre> <br>  Inilah yang akan dihasilkan oleh kode ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf0/cc9/be3/cf0cc9be3eff013549852e5a27b47823.png"></div><br>  <i><font color="#999999">Ibu tidak menepati janji</font></i> <br><br>  Jika kita mengubah nilai variabel <code>momsSavings</code> menjadi 200.000, maka ibu akan dapat membeli hadiah untuk putranya.  Dalam hal ini, kode di atas akan menampilkan yang berikut. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf5/393/72a/cf539372a0dce219b10136e4b6280de8.png"></div><br>  <i><font color="#999999">Ibu menepati janji</font></i> <br><br>  Sekarang mari kita bayangkan bahwa kode tersebut dirancang sebagai perpustakaan, dan kami menggunakan perpustakaan ini.  Mari kita bicara tentang penggunaan <code>.catch</code> dan <code>.catch</code> . <br><br>  Karena metode <code>onFulfilled</code> dapat menetapkan penangan <code>onFulfilled</code> yang dipanggil ketika janji berhasil diselesaikan dan penangan <code>onRejected</code> yang dipanggil saat janji ditolak, alih-alih menggunakan metode <code>.catch</code> dan metode <code>.catch</code> , kita dapat mencapai efek yang sama hanya dengan satu. <code>.then</code> metode.  Begini tampilannya: <br><br><pre> <code class="hljs lua">momsPromise.<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value)</span></span></span></span> {   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Hurray I got this phone as a gift "</span></span>, JSON.stringify(value)); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(reason)</span></span></span></span> {   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Mom coudn't buy me the phone because "</span></span>, reason); } );</code> </pre> <br>  Ini adalah contoh yang berfungsi, tetapi untuk mencegah pembacaan kode, lebih baik menggunakan metode <code>.catch</code> dan <code>.catch</code> daripada yang universal <code>.then</code> . <br><br>  Agar contoh-contoh ini dijalankan di browser, dan khususnya di Google Chrome, saya mencoba menghindari ketergantungan eksternal.  Untuk lebih memahami apa yang akan kita pertimbangkan nanti, mari kita buat fungsi yang mengembalikan janji, resolusi atau penolakan yang terjadi secara acak.  Ini akan memungkinkan kita untuk mengalami berbagai skenario bekerja dengan janji.  Untuk memahami fitur fungsi asinkron, kami akan menetapkan penundaan acak dalam janji kami.  Karena kita membutuhkan angka acak, kita membuat fungsi yang mengembalikan angka acak antara <code>x</code> dan <code>y</code> .  Inilah fungsinya. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> getRandomNumber(start = <span class="hljs-number"><span class="hljs-number">1</span></span>, end = <span class="hljs-number"><span class="hljs-number">10</span></span>) { //,      <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> &gt;=<span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> &gt; <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parseInt(Math.random() * <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) % (<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; }</code> </pre> <br>  Sekarang buat fungsi yang mengembalikan janji.  <code>promiseTRRARNOSG</code> saja <code>promiseTRRARNOSG</code> .  Nama fungsi ini adalah <code>promiseThatResolvesRandomlyAfterRandomNumnberOfSecondsGenerator</code> . <code>promiseThatResolvesRandomlyAfterRandomNumnberOfSecondsGenerator</code> , yaitu, itu adalah generator janji yang secara acak diselesaikan atau ditolak setelah sejumlah detik acak.  Fungsi ini akan membuat janji yang akan diizinkan atau ditolak setelah periode waktu acak antara 2 dan 10 detik.  Untuk mengizinkan atau menolak janji secara acak, kami mendapatkan nomor acak antara 1 dan 10. Jika angka ini lebih dari 5, janji akan diizinkan, jika tidak, itu akan ditolak. <br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRandomNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(start = 1, end = 10)</span></span></span></span> { //,      start  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> &gt;=<span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> &gt; start <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (parseInt(Math.<span class="hljs-built_in"><span class="hljs-built_in">random</span></span>() * <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) % (<span class="hljs-keyword"><span class="hljs-keyword">end</span></span> - start + <span class="hljs-number"><span class="hljs-number">1</span></span>)) + start; } var promiseTRRARNOSG = (promiseThatResolvesRandomlyAfterRandomNumnberOfSecondsGenerator = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new Promise(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resolve, reject)</span></span></span></span> {   let randomNumberOfSeconds = getRandomNumber(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);   setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {     let randomiseResolving = getRandomNumber(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (randomiseResolving &gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) {       resolve({         randomNumberOfSeconds: randomNumberOfSeconds,         randomiseResolving: randomiseResolving       });     } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {       reject({         randomNumberOfSeconds: randomNumberOfSeconds,         randomiseResolving: randomiseResolving       });     }   }, randomNumberOfSeconds * <span class="hljs-number"><span class="hljs-number">1000</span></span>); }); }); var testProimse = promiseTRRARNOSG(); testProimse.<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value)</span></span></span></span> { console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Value when promise is resolved : "</span></span>, value); }); testProimse.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(reason)</span></span></span></span> { console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Reason when promise is rejected : "</span></span>, reason); }); //             ,    .     ,  - . <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">1</span></span>; i&lt;=<span class="hljs-number"><span class="hljs-number">10</span></span>; i++) { let promise = promiseTRRARNOSG(); promise.<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value)</span></span></span></span> {   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Value when promise is resolved : "</span></span>, value); }); promise.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(reason)</span></span></span></span> {   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Reason when promise is rejected : "</span></span>, reason); }); }</code> </pre> <br>  Jalankan kode ini di konsol browser untuk melihat bagaimana perilaku janji yang diizinkan dan ditolak.  Selanjutnya, kita akan berbicara tentang bagaimana Anda dapat membuat banyak janji dan memeriksa hasil penerapannya, menggunakan mekanisme lain. <br><br><h3>  <font color="#3AC1EF">▍ Metode statis objek Janji</font> </h3><br>  Ada empat metode statis objek <code>Promise</code> . <br><br>  Berikut adalah dua metode - <code>Promise.reject(reason)</code> dan <code>Promise.resolve(value)</code> , yang memungkinkan Anda untuk membuat, masing-masing, ditolak dan diizinkan janji. <br><br>  Inilah cara bekerja dengan metode <code>Promise.reject</code> , yang menciptakan janji yang ditolak. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promise3 = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.reject(<span class="hljs-string"><span class="hljs-string">"Not interested"</span></span>); promise3.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"This will not run as it is a rejected promise. The resolved value is "</span></span>, value); }); promise3.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"This run as it is a rejected promise. The reason is "</span></span>, reason); });</code> </pre> <br>  Berikut adalah contoh menggunakan metode <code>Promise.resolve</code> yang menciptakan <code>Promise.resolve</code> yang berhasil diselesaikan. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promise4 = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>); promise4.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"This will run as it is a resovled promise. The resolved value is "</span></span>, value); }); promise4.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"This will not run as it is a resolved promise"</span></span>, reason); });</code> </pre> <br>  Perlu dicatat bahwa janji mungkin memiliki beberapa penangan.  Misalnya, berdasarkan contoh sebelumnya, Anda bisa mendapatkan kode yang ditunjukkan di bawah ini. <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promise4 = Promise.resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>); promise4.<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value)</span></span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">{ console.log("This will run as it is a resovled promise. The resolved value is ", value); }</span></span></span><span class="hljs-function">);</span></span> promise4.<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value)</span></span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">{ console.log("This will also run as multiple handlers can be added. Printing twice the resolved value which is ", value * 2); }</span></span></span><span class="hljs-function">);</span></span> promise4.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(reason)</span></span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">{ console.log("This will not run as it is a resolved promise", reason); }</span></span></span><span class="hljs-function">);</span></span></code> </pre> <br>  Inilah yang ditampilkan di konsol browser: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/644/10b/6d3/64410b6d31e57ab7197e6af1453d9b93.png"></div><br>  <i><font color="#999999">Menggunakan banyak .Ketika ketika bekerja dengan Janji</font></i> <br><br>  Dua metode berikut, <code>Promise.all</code> dan <code>Promise.race</code> , dirancang untuk bekerja dengan set janji.  Jika, untuk menyelesaikan masalah tertentu, perlu untuk memproses beberapa janji, akan lebih mudah untuk menempatkan janji-janji ini dalam sebuah array, dan kemudian melakukan tindakan yang diperlukan dengannya.  Untuk memahami esensi dari metode yang dipertimbangkan di sini, kita tidak akan dapat menggunakan <code>promiseTRRARNOSG</code> fungsi nyaman <code>promiseTRRARNOSG</code> , karena hasil kerjanya tergantung terlalu banyak pada kemauan kasus.  Akan lebih mudah bagi kita untuk menggunakan sesuatu yang menghasilkan janji-janji yang lebih dapat diprediksi, yang akan memungkinkan kita untuk memahami perilaku mereka.  Karena itu, kami akan membuat dua fungsi baru.  Salah satunya ( <code>promiseTRSANSG</code> ) akan membuat janji yang diselesaikan setelah <code>n</code> detik, yang kedua ( <code>promiseTRJANSG</code> ) - janji yang ditolak setelah <code>n</code> detik. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promiseTRSANSG = (promiseThatResolvesAfterNSecondsGenerator = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> n = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{   setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{     resolve({       <span class="hljs-attr"><span class="hljs-attr">resolvedAfterNSeconds</span></span>: n     });   }, n * <span class="hljs-number"><span class="hljs-number">1000</span></span>); }); }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promiseTRJANSG = (promiseThatRejectsAfterNSecondsGenerator = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> n = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{   setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{     reject({       <span class="hljs-attr"><span class="hljs-attr">rejectedAfterNSeconds</span></span>: n     });   }, n * <span class="hljs-number"><span class="hljs-number">1000</span></span>); }); });</code> </pre> <br>  Sekarang kita akan menggunakan fungsi-fungsi ini untuk memahami fitur-fitur metode <code>Promise.all</code> . <br><br><h3>  <font color="#3AC1EF">▍ Metode Janji. Semua</font> </h3><br>  Dari dokumentasi MDN, Anda dapat menemukan bahwa metode <code>Promise.all(iterable)</code> mengembalikan janji yang akan diselesaikan ketika semua janji yang dilewati sebagai argumen <code>iterable</code> , atau ketika argumen ini tidak berisi janji.  Janji ini akan ditolak jika ada janji yang ditransfer yang ditolak. <br>  Mari kita lihat beberapa contoh. <br><br><h4>  Contoh No. 1 </h4><br>  Semua janji akan diizinkan di sini.  Skenario ini paling umum. <br><br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.time(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesArray = []; promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">1</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">4</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleAllPromises = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all(promisesArray); handleAllPromises.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"All the promises are resolved"</span></span>, values); }); handleAllPromises.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"One of the promises failed with the following reason"</span></span>, reason); });</code> </pre> <br>  Berikut kode yang akan ditampilkan ke konsol: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cfb/36f/112/cfb36f11242338d72c4541e53a8313f2.png"></div><br>  <i><font color="#999999">Semua Janji Diizinkan</font></i> <br><br>  Setelah menganalisis hasil dari contoh ini, dua pengamatan penting dapat dilakukan. <br><br>  Pertama, janji ketiga, resolusi yang membutuhkan waktu 2 detik, selesai sebelum yang kedua, tetapi, seperti dapat dilihat dari output yang dihasilkan oleh kode, urutan janji-janji dalam array dipertahankan. <br><br>  Kedua, kode berisi penghitung waktu yang digunakan untuk mencari tahu berapa lama waktu yang diperlukan untuk menjalankan instruksi <code>Promise.all</code> . <br><br>  Jika janji dieksekusi secara berurutan, maka waktu eksekusi instruksi ini adalah 7 detik (1 + 4 + 2).  Namun, pengatur waktu memberi tahu kami bahwa seluruh operasi memakan waktu 4 detik jika kami membulatkan hasilnya.  Ini adalah bukti bahwa semua janji dieksekusi secara paralel. <br><br><h4>  Contoh No. 2 </h4><br>  Sekarang pertimbangkan situasi ketika tidak ada janji dalam array yang diteruskan ke Promise.all.  Saya percaya ini adalah use case yang paling tidak umum untuk fitur ini. <br><br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.time(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesArray = []; promisesArray.push(<span class="hljs-number"><span class="hljs-number">1</span></span>); promisesArray.push(<span class="hljs-number"><span class="hljs-number">4</span></span>); promisesArray.push(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleAllPromises = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all(promisesArray); handleAllPromises.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"All the promises are resolved"</span></span>, values); }); handleAllPromises.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"One of the promises failed with the following reason"</span></span>, reason); });</code> </pre> <br>  Berikut ini adalah output yang akan dihasilkan kode ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24d/20c/e98/24d20ce98e2939d54fb40d7efe40a98d.png"></div><br>  <i><font color="#999999">Aktifkan Promise.all dan berikan array yang tidak berisi janji untuk metode ini</font></i> <br><br>  Karena tidak ada janji dalam array, <code>Promise.all</code> hampir secara instan. <br><br><h4>  Contoh No. 3 </h4><br>  Sekarang mari kita lihat apa yang terjadi ketika salah satu dari janji-janji itu diteruskan ke Janji. Semua ditolak. <br><br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.time(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesArray = []; promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">1</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">5</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">3</span></span>)); promisesArray.push(promiseTRJANSG(<span class="hljs-number"><span class="hljs-number">2</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleAllPromises = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all(promisesArray); handleAllPromises.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"All the promises are resolved"</span></span>, values); }); handleAllPromises.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.All"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"One of the promises failed with the following reason "</span></span>, reason); });</code> </pre> <br>  Seperti yang Anda lihat dari hasil eksekusi kode yang ditunjukkan di bawah ini, eksekusi <code>Promise.all</code> berhenti setelah janji pertama yang ditolak dengan output dari pesan yang diberikan janji ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/87a/b92/a32/87ab92a321b372cd6fe3abeba21f16a2.png"></div><br>  <i><font color="#999999">Eksekusi berhenti setelah janji pertama yang ditolak</font></i> <br><br><h3>  <font color="#3AC1EF">▍ Metode Janji</font> </h3><br>  MDN melaporkan bahwa metode <code>Promise.race(iterable)</code> mengembalikan janji yang diizinkan atau ditolak dengan nilai atau alasan penolakan setelah masing-masing janji yang dikirimkan masing-masing diizinkan atau ditolak. <br><br>  Mari kita <code>Promise.race</code> contoh bekerja dengan <code>Promise.race</code> . <br><br><h4>  Contoh No. 1 </h4><br>  Itu menunjukkan apa yang terjadi ketika salah satu janji dilewatkan ke Janji. <code>Promise.race</code> diselesaikan sebelum orang lain. <br><br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.time(<span class="hljs-string"><span class="hljs-string">"Promise.race"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesArray = []; promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">4</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">3</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">2</span></span>)); promisesArray.push(promiseTRJANSG(<span class="hljs-number"><span class="hljs-number">3</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesRace = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.race(promisesArray); promisesRace.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.race"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"The fasted promise resolved"</span></span>, values); }); promisesRace.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.race"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"The fastest promise rejected with the following reason "</span></span>, reason); });</code> </pre> <br>  Inilah yang sampai ke konsol setelah mengeksekusi contoh ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/010/151/044/0101510448b397d862e2e3a21edb4822.png"></div><br>  <i><font color="#999999">Promis, yang diselesaikan lebih cepat dari yang lainnya</font></i> <br><br>  Semua janji di sini dilakukan secara paralel.  Janji ketiga diselesaikan setelah 2 detik.  Segera setelah ini terjadi, janji yang dikembalikan oleh <code>Promise.race</code> diselesaikan. <br><br><h4>  Contoh No. 2 </h4><br>  Sekarang pertimbangkan situasi ketika salah satu janji dilewatkan ke Janji. <code>Promise.race</code> ditolak. <br><br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.time(<span class="hljs-string"><span class="hljs-string">"Promise.race"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesArray = []; promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">4</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">6</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">5</span></span>)); promisesArray.push(promiseTRJANSG(<span class="hljs-number"><span class="hljs-number">3</span></span>)); promisesArray.push(promiseTRSANSG(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> promisesRace = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.race(promisesArray); promisesRace.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.race"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"The fasted promise resolved"</span></span>, values); }); promisesRace.catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.timeEnd(<span class="hljs-string"><span class="hljs-string">"Promise.race"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"The fastest promise rejected with the following reason "</span></span>, reason); });</code> </pre> <br>  Setelah menjalankan contoh ini, berikut ini akan sampai ke konsol: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/063/6fe/351/0636fe351042cfb51428c33db5595b44.png"></div><br>  <i><font color="#999999">Janji ditolak sebelum orang lain</font></i> <br><br>  Janji di sini, seperti dalam contoh sebelumnya, dilakukan secara paralel.  Janji keempat ditolak setelah 3 detik.  Segera setelah ini terjadi, janji yang dikembalikan oleh <code>Promise.race</code> ditolak. <br><br><h2>  <font color="#3AC1EF">Contoh umum dan percobaan</font> </h2><br>  Saya mengumpulkan semua contoh yang kami pertimbangkan dalam materi ini di satu tempat, yang akan membuatnya lebih mudah untuk bereksperimen dengan mereka, untuk mengeksplorasi berbagai skenario bekerja dengan janji-janji.  Kode ini dirancang untuk dijalankan di browser, jadi di sini kami tidak menggunakan panggilan API apa pun, tidak mengakses operasi file, dan tidak bekerja dengan basis data.  Meskipun semua ini menemukan aplikasi dalam pengembangan proyek nyata, saya percaya bahwa bekerja dengan mekanisme ini dapat mengalihkan kita dari tujuan utama kita - janji.  Dan penggunaan fungsi sederhana yang mensimulasikan penundaan waktu memberikan hasil yang serupa dan tidak membebani kita dengan detail tambahan. <br><br>  Dengan menjelajahi sendiri contoh-contoh ini, Anda dapat bereksperimen dengan kode, dengan nilai-nilai variabel, dan mempelajari berbagai skenario untuk menggunakan janji.  Secara khusus, Anda dapat menggunakan kombinasi metode <code>promiseTRJANSG</code> , <code>promiseTRSANSG</code> dan <code>promiseTRRARNOSG</code> untuk mensimulasikan banyak skenario untuk menggunakan janji, yang akan memungkinkan Anda untuk lebih memahami mereka.  Selain itu, perhatikan bahwa menggunakan perintah <code>console.time</code> memungkinkan Anda untuk mengetahui waktu yang diperlukan untuk mengeksekusi sepotong kode tertentu, dan, misalnya, untuk mengetahui apakah janji dieksekusi secara paralel atau berurutan.  Berikut ini <a href="">tautan</a> ke halaman intisari dengan kode.  Dan omong-omong, jika Anda mau, lihatlah perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bluebird</a> , yang berisi beberapa metode menarik untuk bekerja dengan janji-janji. <br><br><h2>  <font color="#3AC1EF">Ringkasan</font> </h2><br>  Saya menawarkan kepada Anda daftar aturan yang saya patuhi ketika bekerja dengan janji untuk menggunakannya dengan benar. <br><br><ol><li>  Gunakan janji dalam situasi ketika Anda bekerja dengan kode asinkron atau memblokir. </li><li>  Untuk menangani situasi berhasil menyelesaikan janji, gunakan metode <code>.then</code> , untuk kasus-kasus di mana janji ditolak, gunakan <code>.catch</code> . </li><li>  Gunakan <code>.catch</code> dan <code>.catch</code> di semua janji. </li><li>  -     ,    ,   <code>.finally</code> . </li><li>  ,  ,      ,   . </li><li>       ,     . </li><li>    <code>Promise</code> ,     ,    ,  . </li><li>  <code>Promise.all</code>         ,        . </li></ol><br> ,      ,      ,     . <br><br>  <b>Pembaca yang budiman!</b> ,       ,     ? <br><br><div class="spoiler"> <b class="spoiler_title">-   ,     </b> <div class="spoiler_text"> -    10%    : <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/qk/au/oy/qkauoyb4porqes9wmm3jofcs3bg.png"></a> <br><br>    :) </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418085/">https://habr.com/ru/post/id418085/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418075/index.html">5 hal TOP yang dapat dicetak pada printer 3D [video]</a></li>
<li><a href="../id418077/index.html">Kecelakaan "jangan tonton": pembenaran statistik untuk mode operasi dukungan teknis 24/7</a></li>
<li><a href="../id418079/index.html">Bahasa pemrograman paling populer - 2018</a></li>
<li><a href="../id418081/index.html">Organisasi pengujian yang aman dalam produksi. Bagian 1</a></li>
<li><a href="../id418083/index.html">Server sederhana dengan GraphQL bukan REST, implementasi di java</a></li>
<li><a href="../id418087/index.html">80% dari checkout mandiri memiliki risiko</a></li>
<li><a href="../id418089/index.html">Ikhtisar Mesin Penggilingan SolidCraft CNC</a></li>
<li><a href="../id418091/index.html">Daftar artikel dan literatur tentang NAS</a></li>
<li><a href="../id418093/index.html">Kursus MIT "Keamanan Sistem Komputer". Kuliah 3: Buffer Overflows: Eksploitasi dan Perlindungan, Bagian 2</a></li>
<li><a href="../id418095/index.html">Tentang perangkat fungsionalitas pengujian bawaan di Rust (terjemahan)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>