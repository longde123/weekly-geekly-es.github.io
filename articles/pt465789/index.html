<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò≥ ‚è≠Ô∏è üë¥üèΩ Treinamento Cisco 200-125 CCNA v3.0. Dia 29. PAT e NAT ü•° üè© üâê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje vamos estudar o PAT (Port Address Translation), uma tecnologia para traduzir endere√ßos IP usando portas, e o NAT (Network Address Translation), u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Treinamento Cisco 200-125 CCNA v3.0. Dia 29. PAT e NAT</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/465789/"> Hoje vamos estudar o PAT (Port Address Translation), uma tecnologia para traduzir endere√ßos IP usando portas, e o NAT (Network Address Translation), uma tecnologia para traduzir endere√ßos IP de pacotes de tr√¢nsito.  PAT √© um caso especial de NAT.  Abordaremos tr√™s t√≥picos: <br><br>  - endere√ßos IP privados ou internos (intranet, local) e endere√ßos IP p√∫blicos ou externos; <br>  - NAT e PAT; <br>  - configurar NAT / PAT. <br><br>  Vamos come√ßar com os endere√ßos IP privados.  Sabemos que eles s√£o divididos em tr√™s classes: A, B e C. <br><br><img src="https://habrastorage.org/webt/ob/rv/le/obrvlewzzejxlfwxxbi_90zkrwe.jpeg"><br><br>  Os endere√ßos internos da classe A ocupam o intervalo de dezenas de 10.0.0.0 a 10.255.255.255, e os endere√ßos externos ocupam o intervalo de 1.0.0.0 a 9. 255.255.255 e de 11.0.0.0 a 126.255.255.255. <br><br>  Os endere√ßos internos da classe B variam de 172.16.0.0 a 172.31.255.255, e os endere√ßos externos variam de 128.0.0.0 a 172.15.255.255 e de 172.32.0.0 a 191.255.255.255. <a name="habracut"></a><br><br>  Os endere√ßos internos da classe C variam de 192.168.0.0 a 192.168.255.255 e os endere√ßos externos variam de 192.0.0 a 192.167.255.255 e de 192.169.0.0 a 223.255.255.255. <br><br><img src="https://habrastorage.org/webt/-e/_r/ba/-e_rba3erd3jnyymki4ebjwu9fs.jpeg"><br><br>  Os endere√ßos da classe A s√£o os endere√ßos / 8, classe B - / 12 e classe C - / 16.  Assim, os endere√ßos IP externos e internos de diferentes classes ocupam diferentes intervalos. <br><br>  Discutimos repetidamente qual √© a diferen√ßa entre endere√ßos IP privados e p√∫blicos.  Em termos gerais, se tivermos um roteador e um grupo de endere√ßos IP internos, quando eles tentarem acessar a Internet, o roteador os converter√° em endere√ßos IP externos.  Endere√ßos internos s√£o usados ‚Äã‚Äãexclusivamente em redes locais, e n√£o na Internet. <br><br>  Se eu usar a linha de comando para visualizar os par√¢metros de rede do meu computador, ent√£o vou ver meu endere√ßo IP da LAN interno 192.168.1.103. <br><br><img src="https://habrastorage.org/webt/hq/tx/wf/hqtxwfez60be9ufwpywe72ldll4.jpeg"><br><br>  Para descobrir seu endere√ßo IP p√∫blico, voc√™ pode usar um servi√ßo de Internet como "Qual √© o meu IP"?  Como voc√™ pode ver, o endere√ßo externo do computador 78.100.196.163 √© diferente do endere√ßo interno. <br><br><img src="https://habrastorage.org/webt/wm/1n/w0/wm1nw0n_syo74vtnmskictzyx8e.jpeg"><br><br>  Em todos os casos, meu computador √© vis√≠vel na Internet precisamente pelo endere√ßo IP externo.  Portanto, o endere√ßo interno do meu computador √© 192.168.1.103 e o externo √© 78.100.196.163.  O endere√ßo interno √© usado apenas para comunica√ß√£o local; voc√™ n√£o pode acessar a Internet com ele; para isso, √© necess√°rio um endere√ßo IP p√∫blico.  Voc√™ pode se lembrar por que a separa√ß√£o foi feita em endere√ßos p√∫blicos e privados, revendo o v√≠deo tutorial Dia 3. <br><br>  Considere o que √© NAT.  Existem tr√™s tipos de NAT: est√°tico, din√¢mico e sobrecarregado, ou PAT. <br><br><img src="https://habrastorage.org/webt/sq/os/yh/sqosyhlr7iwvdpydrfys3xigo9m.jpeg"><br><br>  Existem 4 termos na Cisco que descrevem o NAT.  Como eu disse, o NAT √© um mecanismo para converter endere√ßos internos em externos.  Se um dispositivo conectado √† Internet receber um pacote de outro dispositivo da rede local, ele simplesmente descartar√° esse pacote, pois o formato do endere√ßo interno n√£o corresponde ao formato dos endere√ßos usados ‚Äã‚Äãna Internet global.  Portanto, o dispositivo deve receber um endere√ßo IP p√∫blico para acessar a Internet. <br>  Portanto, o primeiro termo √© Inside Local, que significa o endere√ßo IP do host na LAN interna.  Simplificando, esse √© o endere√ßo de origem principal do tipo 192.168.1.10.  O segundo termo, Inside Global, √© o endere√ßo IP do host local, sob o qual √© vis√≠vel na rede externa.  No nosso caso, este √© o endere√ßo IP da porta externa do roteador 200.124.22.10. <br><br><img src="https://habrastorage.org/webt/b_/ia/sj/b_iasjqtn7zpepgxzpykgutrnxg.jpeg"><br><br>  Voc√™ pode dizer que o Inside Local √© um endere√ßo IP privado e o Inside Global √© um endere√ßo IP p√∫blico.  Lembre-se de que o termo Dentro √© usado para se referir √† origem do tr√°fego, e Fora √© usado para se referir √† finalidade do tr√°fego.  Local externo √© o endere√ßo IP do host na rede externa, sob o qual √© vis√≠vel para a rede interna.  Simplificando, esse √© o endere√ßo do destinat√°rio vis√≠vel na rede interna.  Um exemplo desse endere√ßo √© o endere√ßo IP 200.124.22.100 de um dispositivo localizado na Internet. <br><br><img src="https://habrastorage.org/webt/ey/sm/o-/eysmo-pr4ikwlwag52qkmag4zeu.jpeg"><br><br>  Fora de Global √© o endere√ßo IP do host vis√≠vel na rede externa.  Na maioria dos casos, os endere√ßos Externo Local e Externo Global t√™m a mesma apar√™ncia, porque mesmo ap√≥s a convers√£o, o endere√ßo IP de destino √© o mesmo para a origem e antes da convers√£o. <br><br><img src="https://habrastorage.org/webt/bg/tn/xq/bgtnxq5blz5qdtgtnpqddu8rr08.jpeg"><br><br>  Considere o que √© NAT est√°tico.  NAT est√°tico significa a convers√£o individual de endere√ßos IP internos para externa ou a convers√£o individual.  Quando os dispositivos enviam tr√°fego para a Internet, seus endere√ßos internos internos locais s√£o convertidos em endere√ßos internos internos globais. <br><br><img src="https://habrastorage.org/webt/oo/n6/ql/oon6qlova0vcwlg7bovpduisxho.jpeg"><br><br>  Existem tr√™s dispositivos em nossa rede local e, quando eles ficam on-line, cada um deles recebe seu pr√≥prio endere√ßo Inside Global.  Esses endere√ßos s√£o atribu√≠dos estaticamente √†s origens de tr√°fego.  O princ√≠pio um para um significa que, se 100 dispositivos estiverem localizados na rede local, eles receber√£o 100 endere√ßos externos. <br><br>  O NAT pareceu salvar a Internet, que terminou com endere√ßos IP p√∫blicos.  Gra√ßas ao NAT, muitas empresas, muitas redes podem ter um endere√ßo IP externo comum, no qual os endere√ßos de dispositivos locais ser√£o convertidos ao acessar a Internet.  Voc√™ pode dizer que, neste caso de NAT est√°tico, n√£o h√° economia no n√∫mero de endere√ßos, uma vez que cem computadores locais recebem cem endere√ßos externos e voc√™ estar√° absolutamente certo.  No entanto, o NAT est√°tico ainda tem v√°rias vantagens. <br><br>  Por exemplo, temos um servidor com um endere√ßo IP interno 192.168.1.100.  Se algum dispositivo da Internet quiser entrar em contato com ele, ele n√£o poder√° fazer isso usando o endere√ßo de destino interno; para isso, ele precisar√° usar o endere√ßo externo do servidor 200.124.22.3.  Se o NAT est√°tico estiver configurado no roteador, todo o tr√°fego endere√ßado a 200.124.22.3 ser√° automaticamente encaminhado para 192.168.1.100.  Isso fornece acesso externo a dispositivos na rede local, nesse caso, ao servidor da web da empresa, o que pode ser necess√°rio em alguns casos. <br><br>  Considere NAT din√¢mico.  √â muito semelhante ao est√°tico, mas n√£o atribui endere√ßos externos permanentes a cada dispositivo local.  Por exemplo, temos 3 dispositivos locais e apenas 2 endere√ßos externos.  Se o segundo dispositivo quiser ficar online, ser√° atribu√≠do o primeiro endere√ßo IP gratuito.  Se depois dele o servidor da Web quiser ficar online, o roteador atribuir√° a ele o segundo endere√ßo externo dispon√≠vel.  Se, depois disso, o primeiro dispositivo desejar acessar a rede externa, n√£o haver√° endere√ßo IP dispon√≠vel e o roteador eliminar√° o pacote. <br><br><img src="https://habrastorage.org/webt/id/uf/lt/iduflt-hi8gyfgpgkotj8sagyxs.jpeg"><br><br>  Podemos ter centenas de dispositivos com endere√ßos IP internos e cada um desses dispositivos pode ficar online.  Mas como n√£o temos uma atribui√ß√£o est√°tica de endere√ßos externos, ao mesmo tempo, n√£o mais de dois dispositivos em cem poder√£o acessar a Internet, porque temos apenas dois endere√ßos externos atribu√≠dos dinamicamente. <br><br>  Os dispositivos Cisco t√™m um tempo de convers√£o de endere√ßo fixo de 24 horas por padr√£o.  Pode ser alterado para 1,2,3, 10 minutos, a qualquer momento.  Ap√≥s esse per√≠odo, os endere√ßos externos s√£o liberados e retornados automaticamente ao pool de endere√ßos.  Se, neste momento, o primeiro dispositivo quiser ficar online e qualquer endere√ßo externo estiver dispon√≠vel, ele ser√° recebido.  O roteador cont√©m uma tabela NAT que √© atualizada dinamicamente e, at√© o tempo de convers√£o expirar, o endere√ßo atribu√≠do √© salvo pelo dispositivo.  Simplificando, o NAT din√¢mico funciona segundo o princ√≠pio: "quem veio primeiro, serviu". <br><br>  Considere o que constitui um NAT sobrecarregado ou PAT.  Este √© o tipo mais comum de NAT.  Sua rede dom√©stica pode ter muitos dispositivos - um PC, smartphone, laptop, tablet e todos eles est√£o conectados a um roteador que possui um endere√ßo IP externo.  Portanto, o PAT permite que muitos dispositivos com endere√ßos IP internos fiquem simultaneamente on-line sob um endere√ßo IP externo.  Isso √© poss√≠vel porque cada endere√ßo IP interno interno usa um n√∫mero de porta espec√≠fico durante uma sess√£o de comunica√ß√£o. <br>  Suponha que tenhamos um endere√ßo p√∫blico 200.124.22.1 e muitos dispositivos locais.  Portanto, ao acessar a Internet, todos esses hosts receber√£o o mesmo endere√ßo 200.124.22.1.  A √∫nica coisa que os diferencia um do outro √© o n√∫mero da porta. <br>  Se voc√™ se lembra da discuss√£o sobre a camada de transporte, sabe que a camada de transporte cont√©m n√∫meros de porta e o n√∫mero da porta de origem √© um n√∫mero aleat√≥rio. <br><br><img src="https://habrastorage.org/webt/bd/6v/rd/bd6vrdsnsfezgoads3mbzzphcco.jpeg"><br><br>  Suponha que exista um host na rede externa com um endere√ßo IP 200.124.22.10, conectado √† Internet.  Se o computador 192.168.1.11 quiser entrar em contato com o computador 200.124.22.10, ele criar√° uma porta de origem aleat√≥ria 51772. Nesse caso, a porta de destino do computador na rede externa ser√° 80. <br><br>  Quando o roteador recebe um pacote de computador local enviado para uma rede externa, ele traduz seu endere√ßo local local local para o endere√ßo Global Inside 200.124.22.1 e atribui a porta 23556 √† porta.O pacote alcan√ßar√° o computador 200.124.22.10 e precisar√° enviar uma resposta de volta, de acordo com o procedimento de handshake, o destino ser√° o endere√ßo 200.124.22.1 e a porta 23556. <br><br>  O roteador possui uma tabela de convers√£o NAT; portanto, ap√≥s receber um pacote de um computador externo, ele determinar√° o endere√ßo Local Interno correspondente ao endere√ßo Global Interno como 192.168.1.11: 51772 e encaminhar√° o pacote para ele.  Depois disso, a conex√£o entre os dois computadores pode ser considerada estabelecida. <br>  Ao mesmo tempo, voc√™ pode ter centenas de dispositivos que usam o mesmo endere√ßo 200.124.22.1 para comunica√ß√£o, mas n√∫meros de porta diferentes, para que todos possam ficar on-line ao mesmo tempo.  √â por isso que o PAT √© um m√©todo de tradu√ß√£o t√£o popular. <br><br>  Vejamos a configura√ß√£o do NAT est√°tico.  Para qualquer rede, antes de tudo, √© necess√°rio determinar as interfaces de entrada e sa√≠da.  O diagrama mostra um roteador atrav√©s do qual o tr√°fego √© transferido da porta G0 / 0 para a porta G0 / 1, ou seja, de uma rede interna para uma rede externa.  Assim, temos uma interface de entrada 192.168.1.1 e uma interface de sa√≠da 200.124.22.1. <br><br><img src="https://habrastorage.org/webt/rj/nc/o6/rjnco6mmewiiildmwtu0gn8ixs4.jpeg"><br><br>  Para configurar o NAT, vamos para a interface G0 / 0 e definimos os par√¢metros ip 192.168.1.1 255.255.255.0 ip addres e indicamos que essa interface √© inserida usando o comando ip nat inside. <br><br><img src="https://habrastorage.org/webt/rf/dd/xt/rfddxtoq7k4bti2dprru9jriheq.jpeg"><br><br>  Da mesma forma, configuramos o NAT na interface de sa√≠da G0 / 1, especificando o endere√ßo IP 200.124.22.1, a m√°scara de sub-rede 255.255.255.0 e o ip nat fora.  Lembre-se de que a convers√£o din√¢mica de NAT √© sempre feita da entrada para a interface de sa√≠da, de dentro para fora.  Naturalmente, para NAT din√¢mico, a resposta chega √† interface de entrada atrav√©s da interface de sa√≠da, mas quando o tr√°fego √© iniciado, a dire√ß√£o de entrada e sa√≠da √© acionada.  No caso de NAT est√°tico, a inicia√ß√£o do tr√°fego pode ocorrer em qualquer uma das dire√ß√µes - entrada ou sa√≠da. <br><br>  Em seguida, precisamos criar uma tabela de NAT est√°tico, onde cada endere√ßo local corresponde a um endere√ßo global separado.  No nosso caso, existem 3 dispositivos, portanto, a tabela consiste em 3 entradas que indicam o endere√ßo IP interno local da origem, que se traduz no endere√ßo global interno: ip nat dentro da est√°tica 192.168.1.10 200.124.22.1. <br>  Assim, no NAT est√°tico, voc√™ prescreve manualmente uma tradu√ß√£o para cada endere√ßo de host local.  Agora irei ao Packet Tracer e farei as configura√ß√µes descritas acima. <br><br><img src="https://habrastorage.org/webt/mz/td/sh/mztdshpsmzcjt5zsb7xuifiacp8.jpeg"><br><br>  No topo, temos o servidor 192.168.1.100, abaixo, o computador 192.168.1.10 e, na parte inferior, o computador 192.168.1.11.  A porta G0 / 0 do roteador0 tem um endere√ßo IP 192.168.1.1 e a porta G0 / 1 tem 200.124.22.1.  Na "nuvem" que representa a Internet, coloquei o Roteador1, ao qual foi atribu√≠do um endere√ßo IP 200.124.22.10. <br><br>  Entro nas configura√ß√µes do roteador1 e digito o comando debug ip icmp.  Agora, assim que o ping atingir este dispositivo, uma mensagem de depura√ß√£o aparecer√° na janela de configura√ß√µes, mostrando que tipo de pacote √©. <br>  Vamos configurar o roteador Router0.  Entro no modo de configura√ß√µes globais e chamo a interface G0 / 0.  Em seguida, insiro o comando ip nat inside, depois vou para a interface g0 / 1 e insiro o comando ip nat outside.  Assim, designei as interfaces de entrada e sa√≠da do roteador.  Agora eu preciso configurar manualmente os endere√ßos IP, ou seja, transferir as linhas da tabela acima para as configura√ß√µes: <br><br>  IP nat dentro da fonte est√°tica 192.168.1.10 200.124.22.1 <br>  IP nat dentro da fonte est√°tica 192.168.1.11 200.124.22.2 <br>  IP nat dentro da fonte est√°tica 192.168.1.100 200.124.22.3 <br><br><img src="https://habrastorage.org/webt/tb/px/-f/tbpx-flkjx4vwlsd6ee2rljrky0.jpeg"><br><br>  Agora vou executar ping no Router1 de cada um de nossos dispositivos e ver quais endere√ßos IP o ping recebido receber√°.  Para fazer isso, coloco a janela CLI aberta do roteador R1 no lado direito da tela para ver as mensagens de depura√ß√£o.  Agora vou ao terminal da linha de comando PC0 e sigo o endere√ßo 200.124.22.10.  Depois disso, uma mensagem aparece na janela informando que o ping foi recebido do endere√ßo IP 200.124.22.1.  Isso significa que o endere√ßo IP do computador local 192.168.1.10 foi convertido no endere√ßo global 200.124.22.1. <br><br><img src="https://habrastorage.org/webt/ax/ei/g6/axeig6imwtfp-bxxjjmz0uh6uum.jpeg"><br><br>  Eu fa√ßo o mesmo com o pr√≥ximo computador local e vejo que seu endere√ßo foi convertido para 200.124.22.2.  Ent√£o eu envio ping do servidor e vejo o endere√ßo 200.124.22.3. <br>  Assim, quando o tr√°fego do dispositivo LAN atinge o roteador no qual o NAT est√°tico est√° configurado, o roteador, de acordo com a tabela, converte o endere√ßo IP local no global e envia o tr√°fego para a rede externa.  Para verificar a tabela NAT, insiro o comando show ip nat translator. <br><br><img src="https://habrastorage.org/webt/5d/-9/rx/5d-9rxvls9gdzoz_aanqpbdxeqe.jpeg"><br><br>  Agora podemos ver todas as transforma√ß√µes que o roteador faz.  Na primeira coluna do Inside Global, est√° o endere√ßo do dispositivo antes da transmiss√£o, ou seja, o endere√ßo sob o qual o dispositivo √© vis√≠vel na rede externa e, em seguida, o endere√ßo Local Interno, ou seja, o endere√ßo do dispositivo na rede local.  A terceira coluna mostra Local externo externo e a quarta mostra o endere√ßo Global externo, ambos iguais, porque n√£o convertemos o endere√ßo IP de destino.  Como voc√™ pode ver, ap√≥s alguns segundos a tabela foi limpa porque um tempo limite de ping curto foi definido no Packet Tracer. <br><br>  Posso executar ping no servidor do roteador R1 no endere√ßo 200.124.22.3 e, se eu voltar √†s configura√ß√µes do roteador, poder√° ver que a tabela foi novamente preenchida com quatro linhas de ping com o endere√ßo de destino convertido 192.168.1.100. <br><br><img src="https://habrastorage.org/webt/xx/5i/nq/xx5inqtiknpu90hl-mqjrheahti.jpeg"><br><br>  Como eu disse, mesmo que o tempo limite da transmiss√£o tenha funcionado, quando o tr√°fego √© iniciado a partir de uma fonte externa, o mecanismo NAT √© ativado automaticamente.  Isso s√≥ acontece quando se usa NAT est√°tico. <br><br>  Agora vamos ver como o NAT din√¢mico funciona.  No nosso exemplo, existem 2 endere√ßos p√∫blicos para tr√™s dispositivos na rede local; no entanto, pode haver dezenas e centenas desses hosts privados.  Ao mesmo tempo, apenas 2 dispositivos podem ficar online.  Considere tamb√©m a diferen√ßa entre NAT est√°tico e din√¢mico. <br><br>  Como no caso anterior, primeiro voc√™ precisa determinar as interfaces de entrada e sa√≠da do roteador.  Em seguida, criamos um tipo de lista de acesso, mas essa n√£o √© a ACL da qual falamos na li√ß√£o anterior.  Essa lista de acesso √© usada para identificar o tr√°fego que queremos converter.  Aqui o novo termo "tr√°fego interessante", ou "tr√°fego interessante", aparece.  Esse √© o tr√°fego que lhe interessa, por algum motivo, e quando esse tr√°fego corresponde aos termos da lista de acesso, ele fica sob a a√ß√£o do NAT e √© convertido.  Esse termo √© aplic√°vel ao tr√°fego em muitos casos, por exemplo, no caso de VPNs, ‚Äúinteressante‚Äù √© chamado de tr√°fego que eles v√£o passar por um t√∫nel VPN. <br><br>  Devemos criar uma ACL que identifique tr√°fego interessante, no nosso caso, √© o tr√°fego de toda a rede 192.168.1.0, com a qual a m√°scara reversa 0.0.0.255 √© indicada. <br><br><img src="https://habrastorage.org/webt/rq/ep/rp/rqeprpll-v1nzyru_dewaflnj9o.jpeg"><br><br>  Em seguida, precisamos criar um pool NAT, para o qual usamos o comando ip nat pool &lt;pool name&gt; e especifique o pool de endere√ßos IP 200.124.22.1 200.124.22.2.  Isso significa que fornecemos apenas dois endere√ßos IP externos.  Em seguida, o comando usa a palavra-chave netmask e insere a m√°scara de sub-rede 255.255.255.252.  O √∫ltimo octeto da m√°scara √© (255 - o n√∫mero de endere√ßos do pool √© 1); portanto, se voc√™ tiver 254 endere√ßos no pool, a m√°scara de sub-rede ser√° 255.255.255.0.  Esse √© um par√¢metro muito importante; portanto, ao configurar o NAT din√¢mico, insira o valor correto da m√°scara de rede. <br><br>  Em seguida, usamos um comando que inicia o mecanismo NAT: ip nat dentro do sourse list 1 pool NWKING, em que NWKING √© o nome do pool e list 1 significa a lista de acesso ACL number1.  Lembre-se - para que este comando funcione, voc√™ deve primeiro criar um pool de endere√ßos din√¢micos e uma lista de acesso. <br><br>  Portanto, sob nossas condi√ß√µes, o primeiro dispositivo que deseja acessar a Internet pode fazer isso, o segundo dispositivo tamb√©m, mas o terceiro ter√° que esperar at√© que um dos endere√ßos do pool seja liberado.  A configura√ß√£o do NAT din√¢mico consiste em 4 etapas: determinar a interface de entrada e sa√≠da, determinar o tr√°fego "interessante", criar um pool de NAT e configur√°-lo. <br>  Agora iremos ao Packet Tracer e tentaremos configurar o NAT din√¢mico.  Primeiro, devemos remover as configura√ß√µes est√°ticas de NAT, para as quais inserimos os comandos em sequ√™ncia: <br><br>  nenhum IP nat dentro da fonte est√°tica 192.168.1.10 200.124.22.1 <br>  nenhum IP nat dentro da fonte est√°tica 192.168.1.11 200.124.22.2 <br>  nenhum IP nat dentro da fonte est√°tica 192.168.1.100 200.124.22.3. <br><br>  Em seguida, crio a lista de acesso da Lista 1 para toda a rede com o comando 192.168.1.0 0.0.0.255 da permiss√£o de lista de acesso 1 e configuro o pool NAT usando o comando NWKING 200.124.22.1 200.124.22.1 200.124.22.2 netmask 255.255.255.252.  Nesse comando, especifiquei o nome do pool, os endere√ßos que o inserem e a m√°scara de rede. <br><br>  Em seguida, indico se esse NAT √© interno ou externo e a fonte de onde o NAT deve obter informa√ß√µes, no nosso caso, √© listada, usando o comando ip nat dentro da lista de fontes 1. Depois disso, o sistema perguntar√° se √© necess√°rio todo o pool ou uma interface espec√≠fica .  Eu escolho pool porque temos mais de um endere√ßo externo.  Se voc√™ selecionar a interface, precisar√° especificar uma porta com um endere√ßo IP espec√≠fico.  No formato final, o comando ser√° semelhante a: ip nat dentro da lista de fontes 1 do pool NWKING.  Agora, esse pool consiste em dois endere√ßos 200.124.22.1 200.124.22.2, no entanto, voc√™ pode alter√°-los livremente ou adicionar novos endere√ßos que n√£o estejam vinculados a uma interface espec√≠fica. <br><br>  Voc√™ deve garantir que sua tabela de roteamento seja atualizada para que qualquer um desses endere√ßos IP no pool seja direcionado para este dispositivo, caso contr√°rio voc√™ n√£o receber√° tr√°fego de retorno.  Para garantir que as configura√ß√µes estejam funcionando, repetiremos o procedimento de ping do roteador em nuvem, realizado para NAT est√°tico.  Vou abrir a janela do roteador 1 do roteador para ver as mensagens do modo de depura√ß√£o e executar ping em cada um dos 3 dispositivos. <br><br><img src="https://habrastorage.org/webt/io/yt/lk/ioytlkva1_ucbg0-llm4r5ckiy0.jpeg"><br><br>  Vemos que todos os endere√ßos de origem de onde v√™m os pacotes de ping correspondem √†s configura√ß√µes.      PC0  ,        .     Router 1, ,        200.124.22.1  200.124.22.2.    ,   ,      .       PC0,   ,   ,         200.124.22.1. <br><br>     NAT     ?     Router0    clear ip nat translation *  ¬´¬ª   .          show ip nat translation,     . <br><br>    NAT   show ip nat statistics. <br><br><img src="https://habrastorage.org/webt/c8/o0/ne/c8o0neryfwlityjhd2zb_v5mc98.jpeg"><br><br>    ,       ,     NAT/PAT.  ,    0,       .      ,      hits  misses (          ),     . <br><br>         IP- ‚Äì  NAT,  PAT.   PAT     ,      NAT:      ,  ¬´¬ª ,   NAT   PAT.         ,     ,     ,    PAT         .     NAT  PAT      overload,     .      NAT    PAT. <br><br><img src="https://habrastorage.org/webt/rs/ho/mv/rshomvllaqmpjgqhp36eferkb9o.jpeg"><br><br>  ,        NWKING, , 200.124.22.1,               255.255.255.0.   ,    ip nat 1 pool NWKING 200.124.22.1 200.124.22.1 netmask 255.255.255.0  source interface    200.124.22.1  G0/1.               IP-. <br><br>        IP-,      .       ,            .  NAT   ,       ,        ,   NAT IP-   .      ,   IP-       . <br><br>      Packet Tracer.      NAT  no Ip nat inside source list 1 NWKING    NAT    no Ip nat pool NWKING 200.124.22.1 200.124.22.2 netmask 225.255.255.252. <br><br>      PAT  Ip nat pool NWKING 200.124.22.2 200.124.22.2 netmask 225.255.255.255.      IP-,     ,       200.124.22.1,     200.124.22.2.     ,      . <br><br>    PAT  Ip nat inside source list 1 pool NWKING overload.          PAT.    ,     ,    ,     PC0 Router1   200.124.22.10.       ,   ,   ,    ,  IP- 200.124.22.2.      ,   PC1   Server0. <br><br> ,       Router0.  ,    ,      ,       Router1  IP-  200.124.22.2. <br><br><img src="https://habrastorage.org/webt/fh/tf/gp/fhtfgp0x3n7fghja8yjs_qtp7ci.jpeg"><br><br>    show ip nat statistics,    PAT. <br><br><img src="https://habrastorage.org/webt/na/vq/l2/navql2ahsncx0c5utra8t5efxbi.jpeg"><br><br>  ,    ,   ,  12,      . <br><br>    -  ‚Äî   Ip nat inside source list 1 interface gigabit Ethernet g0/1 overload.        PC0, ,      200.124.22.1,     !    :      ,        ,     NAT-   IP-   .             . <br>      ,      .  Packet Tracer,            NAT  PAT.       ICND1 ‚Äî    CCNA,    , ,   . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/l5wuJFoeVDQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usu√°rios da Habr em um an√°logo exclusivo de servidores b√°sicos que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV a partir de US $ 199</a> na Holanda!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - a partir de US $ 99!</b></b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt465789/">https://habr.com/ru/post/pt465789/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt465775/index.html">Servidor LTSP baseado no CentOS7</a></li>
<li><a href="../pt465779/index.html">Aprovisionamento autom√°tico do Yealink T19 + Cat√°logo de endere√ßos din√¢mico</a></li>
<li><a href="../pt465781/index.html">Como fiz um disjuntor Okhttp personalizado atrav√©s das corotinas de Kotlin</a></li>
<li><a href="../pt465783/index.html">Desenvolvedor de jogos russo, sem sentido e sem piedade</a></li>
<li><a href="../pt465787/index.html">Ame a cabra</a></li>
<li><a href="../pt465791/index.html">Vulnerabilidades de varejistas - tr√™s casos em que o OTP pode ser obtido na solicita√ß√£o</a></li>
<li><a href="../pt465793/index.html">Frontend Weekly Digest (26 de agosto a 1 de setembro de 2019)</a></li>
<li><a href="../pt465795/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 378 (26 de agosto a 1 de setembro de 2019)</a></li>
<li><a href="../pt465797/index.html">Algoritmos gen√©ticos (ou o cliente √© sempre rei - e muitas vezes um tolo)</a></li>
<li><a href="../pt465801/index.html">Food Design Digest, agosto de 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>