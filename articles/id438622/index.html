<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏼 🚒 👆🏾 Bonsai: mesin wiki keluarga 👌🏽 🍢 🤨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pengantar liris 
 Suatu malam, meletakkan barang-barang di lemari dinding, saya menemukan sebuah kotak kardus besar. Dia selamat dari dua relokasi dan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bonsai: mesin wiki keluarga</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438622/"><h4>  Pengantar liris </h4><br>  Suatu malam, meletakkan barang-barang di lemari dinding, saya menemukan sebuah kotak kardus besar.  Dia selamat dari dua relokasi dan tidak membuka selama bertahun-tahun sehingga saya benar-benar lupa apa yang disimpan di dalamnya.  Ternyata ada foto - di album, dalam amplop dari toko, dan ada yang seperti itu. <br><br>  Banyak foto diambil lebih dari tujuh puluh tahun yang lalu.  Salah satunya adalah seorang kakek - di tahun-tahun muridnya, masih muda dan tampan, dalam kacamata yang benar-benar <i>merusak</i> .  "Wow, kakekku mengenakan pakaian hipster bahkan sebelum itu menjadi arus utama," pikirku, dan tanpa sadar tersenyum.  Saya langsung mengenalinya, tetapi kemudian pergi foto-foto orang yang saya tidak ingat.  Dalam fitur wajah, samar-samar Anda bisa menebak hubungan - dan hanya itu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/030/417/94a/03041794abba8a11f5c660bb249ec9fb.png"><br><br>  Ketika saya berusia lima belas tahun, nenek saya berulang kali menunjukkan kartu-kartu ini dan berbicara tentang orang-orang yang tergambar di sana.  Sayangnya, nilai cerita semacam itu hanya dipahami ketika tidak ada seorang pun yang mau menceritakannya.  Pada waktu itu, benar-benar tidak menarik bagi saya untuk kesepuluh kalinya untuk mendengarkan beberapa kisah berlumut tentang tahun-tahun sebelum perang, saya melambaikan tangan mereka dan melewati telinga.  Sekarang, tiba-tiba, sepenuhnya menyadari bahwa bagian dari sejarah keluarga saya hilang, saya mendapat ide untuk mensistematisasikan dan melestarikan apa yang tersisa. <br><br>  Solusi ideal untuk menyimpan data keluarga bagi saya adalah hibrida dari mesin wiki dan album foto.  Tidak ada solusi yang sesuai yang sudah jadi, jadi saya harus menulis sendiri.  Ini disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bonsai</a> dan open source di bawah lisensi MIT.  Lalu akan ada cerita tentang bagaimana itu dibangun dan bagaimana menggunakannya, serta kisah perkembangannya dan sedikit <i>DRAMA</i> . <a name="habracut"></a><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b82/efe/8e3/b82efe8e382a652be0aa4882f500dff5.jpg"><br><br><h4>  Sepeda lain? </h4><br>  Saat ini, ada banyak alat yang memungkinkan Anda membuat pohon keluarga dan katalog informasi tentang kerabat.  Mereka secara kondisional dibagi menjadi dua kategori besar - layanan online dan aplikasi desktop. <br><br>  Dalam kasus aplikasi desktop, database biasanya disimpan sebagai file pada disk.  Anda membuka aplikasi dan mengisinya dalam mode pengguna tunggal.  Jika perlu, data dapat diekspor untuk cadangan atau transfer ke sistem lain (misalnya, dalam format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GEDCOM</a> ).  Dari yang saya tonton, yang paling menyenangkan untuk digunakan adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gramps</a> (gratis) dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Life Tree</a> domestik (membutuhkan pembelian satu kali). <br><br>  Sisi berlawanan dari spektrum adalah layanan web.  Mereka menyimpan data Anda di server jarak jauh dan membebankan biaya penggunaan berkala.  Karena ini adalah produk komersial dengan basis terpusat dan monetisasi yang baik, layanan dari rencana ini memberi Anda kesempatan, misalnya, untuk mencari kerabat yang hilang melalui tes DNA atau catatan arsip. <br><br>  Pro dan kontra dari kedua opsi tersebut cukup jelas.  Dalam kasus pertama, Anda menyimpan basis data secara lokal dan sepenuhnya mengontrol akses ke sana dan membuat cadangan.  Jika aplikasi ini open source, jika perlu, Anda bahkan dapat menambahkan fungsionalitas tambahan untuk itu.  Namun, bekerja dengan database seperti itu bersama-sama atau melihat data dari perangkat lain akan sulit.  Yang kedua, sebaliknya, akses berasal dari perangkat apa pun, tetapi Anda memberikan data Anda kepada pihak ketiga dan berharap kesopanannya.  Namun, dalam sejarah keluarga saya, tidak ada kompromi dan rahasia yang mengerikan, namun, saya masih menganggap informasi ini sepenuhnya bersifat pribadi dan, pada prinsipnya, saya tidak ingin orang lain menyimpan atau menganalisisnya. <br><br>  Mengingat kekurangan dari kedua pendekatan ini, kami dapat merumuskan daftar persyaratan untuk mesin "ideal": <br><br><ol><li>  Aplikasi web di-host di server Anda sendiri </li><li>  Membuat artikel tentang orang, hewan peliharaan, tempat, acara, dll.  seperti wiki </li><li>  Unduh Media </li><li>  Tanda orang di foto dan video </li><li>  Bangunan pohon keluarga otomatis </li><li>  Kalender dengan semua tanggal penting. </li><li>  Alat untuk mengedit bersama dan mengisi </li></ol><br>  Dalam keadilan, saya berhasil menemukan beberapa proyek dengan implementasi yang di-host-sendiri, tetapi mereka dalam keadaan menyedihkan: penampilan membeku di tingkat pertengahan 2000-an, tidak ada set lengkap fungsionalitas yang diperlukan, dan saya tidak ingin menggali skrip warisan dalam PHP.  Selain itu, proyek hewan peliharaan sebelumnya sudah selesai dan ada keinginan untuk mengambil sesuatu yang baru. <br><br>  Aturan emas mengatakan: <i>jika Anda ingin melakukannya dengan baik - lakukan sendiri!</i> <br><br>  Teknologi yang digunakan dipilih berdasarkan tiga kriteria: pengalaman saya dengan mereka, popularitas dan bebas keterbukaan.  Inilah hasilnya: <br><br><ul><li>  <b>Rantime</b> : .NET Core 2.1 </li><li>  <b>Backend</b> : ASP.NET Core MVC </li><li>  <b>Basis Data</b> : PostgreSQL </li><li>  <b>Frontend logic</b> : sebagian Vue, sebagian jQuery. </li><li>  <b>Frontend Styles</b> : Bootstrap + Sass </li></ul><br>  Peran pendukung termasuk Elasticsearch untuk pencarian teks lengkap dan ffmpeg untuk mengambil screenshot dari video. <br><br><h4>  Skema data </h4><br>  Objek utama dalam database Bonsai adalah <i>halaman</i> dan <i>file media</i> .  Mereka terhubung oleh hubungan banyak-ke-banyak melalui <i>tanda</i> .  Tag dapat memiliki judul tanpa tautan - misalnya, jika Anda perlu memberi tag seseorang di foto, tetapi tidak ada informasi di halaman penuh tentang hal itu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b7/c75/f0c/8b7c75f0c97b58cee523f9984000e37f.png"><br><br>  Selain teks gratis, halaman mungkin berisi <i>fakta</i> yang dimasukkan dalam bidang khusus di panel admin.  Fakta tambahan dihitung berdasarkan fakta: misalnya, jika Anda menunjukkan tanggal lahir orang tersebut, itu akan ditandai pada kalender, dan halamannya akan menunjukkan usia saat ini (atau harapan hidup, jika tanggal kematian juga diindikasikan), jenis kelamin dapat digunakan untuk menentukan nama hubungan yang benar (“ayah "Atau" ibu "bukannya" orang tua "yang umum), dan sebagainya.  Fakta-fakta disimpan dalam database sebagai dokumen JSON. <br><br>  Ada lima jenis halaman untuk dipilih: orang, hewan peliharaan, acara, tempat, dan sebagainya.  Daftar fakta yang tersedia tergantung pada jenis halaman: misalnya, "pendidikan" hanya relevan untuk seseorang, "tanggal lahir" adalah untuk seseorang dan hewan, dan "alamat" hanya untuk tempat. <br><br>  Halaman saling berhubungan oleh <i>hubungan</i> : "orang tua", "pasangan", "teman", "pemilik", "penduduk" dan banyak lainnya.  Beberapa hubungan mungkin terbatas dalam waktu (pasangan, pemilik, penduduk), yang lain dianggap permanen. <br><br>  Ketika Anda menyimpan halaman atau hubungan apa pun, model yang dihasilkan diperiksa untuk konsistensi.  Misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tahun-tahun kehidupan pasangan harus tumpang tindih</a> , seseorang tidak dapat memiliki lebih dari satu orang tua biologis dari setiap jenis kelamin, dan Anda juga tidak bisa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menjadi ayah Anda sendiri</a> .  Namun, pernikahan sesama jenis diperbolehkan. <br><br>  Mengedit halaman, file media atau hubungan menyimpan <i>perubahan</i> ke database.  Ini memungkinkan Anda untuk menyimpan riwayat pengeditan dan mengembalikannya jika perlu. <br><br><h4>  Hubungan </h4><br>  Kekerabatan adalah salah satu konsep tertua di masyarakat.  Sudah dalam bahasa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pra-Indo-Eropa,</a> ada banyak nama untuk mereka, yang, dalam bentuk yang sedikit dimodifikasi, bermigrasi ke bahasa modern dari berbagai kelompok: kata "ibu" akan dipahami oleh Rusia, Inggris, dan Cina. <br><br>  Ada banyak pilihan untuk hubungan kekerabatan, tetapi yang dasar ada tiga: <i>orang tua</i> , <i>anak</i> dan <i>pasangan</i> .  Mereka memungkinkan Anda untuk membuat grafik yang diarahkan dari keluarga di mana hubungan ini adalah ujung dan orang-orang adalah simpul.  Pada kolom ini, Anda dapat mengekspresikan hubungan lain, mengetahui jalur antara peserta dan jenis kelamin mereka: misalnya, untuk mengidentifikasi kakek seseorang, Anda harus terlebih dahulu menemukan orang tuanya (jenis kelamin apa pun), dan kemudian orang tua dari orang tua ini (laki-laki), dan seterusnya. <br><br>  Di panel admin Bonsai, Anda dapat memasukkan relasi ketiga tipe dasar ini.  Yang sebaliknya akan dibuat secara otomatis untuk setiap hubungan - orang tua untuk anak, pasangan untuk pasangan, pemilik untuk hewan peliharaan.  Semua hubungan tambahan dihitung oleh mesin dan ditampilkan di bilah sisi pada halaman: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/242/d23/4a4/242d234a49a7c7a75788e384d82b8950.png"><br><br>  Untuk menghitung hubungan, digunakan traversal grafik elementer, dan nama hubungan diatur dalam bentuk DSL khusus: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RelationDefinition[] ParentRelations = { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Parent:m"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Parent:f"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Parent Child:m"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Parent Child:f"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Parent Parent:m"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Parent Parent:f"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) };</code> </pre> <br>  Bahkan seseorang dapat memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">banyak</a> saudara langsung.  Bonsai membagi tautan menjadi beberapa kelompok berikut: <br><br><ol><li>  <b>Hubungan darah terdekat</b> adalah keluarga tempat orang tersebut tumbuh: ibu dan ayah, kakek nenek, saudara lelaki dan perempuan.  Jika Anda melihat grafik, maka ini adalah jalan 1-2 langkah ke atas dan 1 ke samping. </li><li>  <b>Keluarga sendiri</b> : satu kelompok untuk setiap pasangan dan anak-anak darinya.  Ini juga termasuk kerabat pasangannya - ibu mertua, saudara ipar dan sejenisnya. </li><li>  <b>Lainnya</b> : kerabat yang lebih jauh (cucu, paman, bibi) dan ikatan non-kekerabatan (teman, kolega). </li></ol><br>  Terkadang satu cara untuk menentukan keanggotaan grup tidak cukup.  Data mungkin tidak lengkap, tetapi masih perlu ditampilkan secukup mungkin.  Pertimbangkan grafik saudara berikut: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2a/47a/9c7/a2a47a9c749012092d863bcb52c399bf.png"><br><br>  Seperti yang kita lihat, dua istri (Vera dan Galina) dan seorang putra (Boris) diindikasikan untuk Alexander, tetapi kita tidak tahu istri mana yang merupakan ibu dari anak itu - mungkin ini semacam wanita ketiga, tetapi dia belum ditambahkan.  Untuk kasus seperti itu, beberapa jalur dapat diindikasikan yang seharusnya ada atau tidak ada, dan mereka ditandai dengan tanda <code>+</code> dan <code>-</code> masing-masing: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Spouse Child+Child"</span></span>, <span class="hljs-string"><span class="hljs-string">"||"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Spouse Child-Child:m"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RelationDefinition(<span class="hljs-string"><span class="hljs-string">"Spouse Child-Child:f"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre><br><h4>  Pohon keluarga </h4><br>  Mesin silsilah yang layak harus dapat membangun silsilah keluarga.  Ini adalah cara paling visual untuk menunjukkan informasi umum tentang orang dan hubungan keluarga mereka.  Data disimpan dalam database dalam bentuk grafik terarah dan, secara teori, itu harus mudah divisualisasikan.  Dalam praktiknya, dengan tampilan pohon itulah sebagian besar kesulitan muncul. <br><br>  Berikut adalah beberapa contoh pohon keluarga yang akan terlihat: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eab/d88/aad/eabd88aadfe933595863249db8a269d5.png"><br><br>  Pohon keluarga Targaryenov.  Sangat kompak, karena dibuat dengan tangan.  Menghasilkan pohon seperti itu dari data acak akan sangat sulit secara otomatis. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9bd/be7/d2d/9bdbe7d2dd44d9ade8a9906e4b93fdd5.png"><br><br>  Dewa-dewa Yunani.  Representasi grafis dihasilkan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sintaks penurunan harga khusus</a> , di mana Anda masih perlu mengatur semua blok secara manual dan menggambar tautan di antara mereka.  Agak seperti ASCII-art. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7d2/6d7/11b/7d26d711b2ca68ac6f9b0f364fe30f3a.png"><br><br>  Penyajian pohon dalam bentuk diagram setengah lingkaran.  Mudah dihasilkan secara otomatis, tetapi hanya memperhitungkan leluhur langsung. <br><br>  Saya melihat melalui banyak opsi.  Yang paling menyenangkan adalah di situs web MyHeritage: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/42b/0e9/73b/42b0e973bd48a5faaab3ee06758358d9.png"><br><br>  Render pohon seperti itu dapat dibagi menjadi tiga langkah bersyarat: memperoleh data dari database, mengatur blok / jalur penghubung, dan langsung menampilkannya di halaman.  Jika semuanya sepele dengan langkah pertama dan ketiga, maka di langkah kedua aku tersandung. <br><br>  Upaya untuk melempar solusi buatan sendiri dengan tergesa-gesa berakhir dengan kegagalan total.  Susunan elemen grafik yang kompeten adalah area yang sedemikian kompleks sehingga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">disertasi ditulis</a> di atasnya, dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">komponen yang sudah selesai</a> seperti apartemen di Moskow.  Oke, Anda tidak akan bisa menulis sendiri, tetapi pasti ada solusi gratis yang layak? <br><br>  Sebagian besar harapan saya ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perpustakaan D3.js.</a>  Mungkin ini adalah hal pertama yang terlintas dalam pikiran jika Anda perlu menggambar grafik atau bagan di halaman web.  Sayangnya, di antara lebih dari tiga ratus (!) Contoh di wiki, tidak ada satu lebih atau kurang mirip dengan pohon dengan MyHeritage. <br><br>  Langkah selanjutnya adalah menyelami perpustakaan yang tidak terlibat dalam rendering, tetapi dalam menghitung pengaturan optimal elemen dalam grafik.  Sebagian besar dari mereka menawarkan apa yang disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tata letak Angkatan</a> .  Ini adalah pendekatan yang sangat sederhana, yang didasarkan pada rumus fisik: simpul grafik diwakili oleh benda-benda elastis, dan garis penghubung diwakili oleh pegas.  Ia dapat dengan mudah dikenali oleh animasinya yang khas - grafiknya tampaknya “meluruskan” saat dalam perjalanan, dan ini bukan fitur tambahan, tetapi konsekuensi yang tak terhindarkan dari sifat simulasi dari algoritma.  Pendekatan force-layout bagus untuk memvisualisasikan data tanpa hierarki yang jelas (misalnya, koneksi di jejaring sosial), tetapi silsilah keluarga dalam formulir ini terlihat cacat. <br><br>  Pilihan lain yang dipertimbangkan adalah perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Graphviz</a> .  Hasil karyanya dapat dengan mudah dikenali oleh karakteristik panah.  Bahasa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DOT</a> khusus digunakan untuk menggambarkan grafik.  Test case terlihat lebih atau kurang, tetapi masalah muncul dengan data nyata: panah "pecah" dan terhubung pada sudut yang aneh, grafik merayap naik, dan Anda tidak dapat menyesuaikannya dan Anda tidak akan bisa mengelilinginya. <br><br>  Setelah tidak menemukan solusi yang cocok pada saya sendiri, saya memutuskan untuk memesannya secara freelance, dan kemudian <i>DRAMA</i> dimulai. <br><br>  Perintah itu ditempatkan pada pagi hari 22 Oktober, dan dalam satu jam ia menerima beberapa tanggapan.  Salah satu responden bernama Vladislav;  dia mengirim contoh solusi serupa dan berjanji untuk menyelesaikan tugas dalam <i>satu hari</i> .  Kecepatan ini tampak mencurigakan bagi saya, tetapi saya berharap untuk pengalamannya dan pada diri saya sendiri memberikan kesalahan kepada orang itu seminggu.  Beberapa hari pertama, Vladislav mengajukan pertanyaan tambahan, tidak pernah berhenti mengejutkan saya dengan pencelupan yang mendalam dalam proyek dan sikap penuh perhatian terhadap detail, dan kemudian dia menghilang.  Dia bangun pada tanggal 1 November, meminta maaf atas penghilangan paksa karena alasan keluarga dan mengirim tautan dengan versi beta yang terlihat sangat mirip dengan apa yang dia inginkan jika bukan karena simpul di jalur penghubung di tengah: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/79e/402/bda/79e402bda04af7142d02273b7969ff1c.png"><br><br>  Hilangnya pemain selalu merupakan panggilan bangun, tetapi Anda tidak pernah tahu, sesuatu terjadi, karena dia melakukan sesuatu.  Biarkan dia melanjutkan!  Saya mengirim prabayar dan mulai menunggu perbaikan.  Setelah beberapa hari, Vladislav menulis bahwa ia tidak dapat memperbaiki masalahnya, dan kemudian menghilang lagi - kali ini selama tiga minggu.  Selama masa ini, ia tidak melakukan apa pun dan menolak mengembalikan uang muka, karena "tugas itu sebenarnya dilakukan oleh seorang <i>mantan teman bodoh</i> yang mengecewakannya dan tidak mengembalikan uang."  Setelah beberapa pertanyaan klarifikasi, delegasi yang malang itu berhenti berusaha memaafkan dirinya sendiri dan hanya diam.  Jadi sekarang kita hidup - secara berkala saya mengingatkannya pada utang itu, dan sebagai tanggapan dia mengirim tangkapan layar dari aplikasi perbankan - mereka berkata, "tidak ada uang, tetapi begitu - segera saja."  Saya berharap Vladislav sukses dalam bisnis dan menjadi kaya lebih cepat! <br><br>  <i>Lemparkan anak itu - minus karma terus!</i> <br><br>  Kehilangan uang tidak terlalu menyebalkan, tetapi satu bulan berlalu, dan tugas itu tidak bergerak, dan sekarang tidak ada tempat untuk menunggu bantuan.  Pertama-tama, saya marah pada diri sendiri: Saya mengambil jalan yang paling sedikit perlawanan, melanggar <i>aturan emas</i> - dan inilah hasilnya.  Dipenuhi dengan kemarahan yang saleh, saya kembali duduk untuk mempelajari perpustakaan untuk menggambar grafik dan - lihatlah!  - Tiba-tiba menemukan apa yang Anda butuhkan. <br><br>  Perpustakaan itu disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Eclipse Layout Kernel</a> , disingkat ELK.  Seperti yang Anda duga, ini digunakan untuk menampilkan diagram dalam Eclipse IDE, tetapi juga dapat digunakan secara mandiri.  Secara umum, ini ditulis dalam Java, tetapi ada versi yang disiarkan di JS.  Ya, kodenya adalah <a href="">mimpi buruk</a> dan beratnya satu setengah megabyte, tetapi kekurangan ini dapat dimaafkan karena fakta bahwa itu <i>hanya berfungsi</i> dan melakukan hal yang tepat.  Antarmuka adalah dasar: node, tepi dan pengaturan dikirimkan ke input, dan pada output kita mendapatkan koordinat.  Anda dapat menggambar pohon menggunakan mereka dengan cara yang mudah: Saya memilih SVG untuk menghubungkan garis dan div dengan posisi absolut untuk blok. <br><br>  Integrasi perpustakaan dan pemilihan pengaturan optimal membutuhkan waktu dua malam.  Ini, tentu saja, bukan "satu hari", seperti yang dijanjikan freelancer sial dan arogan saya, tetapi cukup dekat.  Akibatnya, Bonsai dapat menampilkan pohon dalam kira-kira bentuk ini: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/57a/f67/bdc/57af67bdcd299bb1f995aa73e09d0fd5.png"><br><br>  Sekarang satu-satunya masalah yang tersisa adalah waktu pemrosesan.  ELK menggunakan algoritme berulang: Anda bisa lebih dekat ke penempatan optimal dengan menghabiskan waktu ekstra.  Pada pohon berisi 20-30 elemen, hasil yang baik membutuhkan sekitar 5 detik.  Karena itu, halaman dengan pohon terbuka setiap waktu untuk waktu yang lama, dan itu dengan cepat mulai mengganggu.  Oleh versi berikutnya, perhitungan akan ditransfer ke backend sehingga dapat dilakukan sekali saat mengubah halaman dan caching. <br><br><h4>  Pencarian Teks Lengkap </h4><br>  Sistem untuk menyimpan informasi tekstual tidak akan berguna tanpa pencarian teks lengkap yang nyaman.  Bonsai menggunakan database PostgreSQL, jadi hal pertama yang saya putuskan adalah memeriksa apa yang bisa ditawarkan di luar kotak.  Kekecewaan lain: <code>tsvector</code> berupaya dengan kata-kata biasa, tetapi menolak untuk mencari hal yang paling penting - nama dan nama keluarga: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> to_tsvector(<span class="hljs-string"><span class="hljs-string">''</span></span>) @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-comment"><span class="hljs-comment">-- true to_tsvector('') @@ to_tsquery(''), -- false to_tsvector('') @@ to_tsquery(''), -- false to_tsvector('') @@ to_tsquery(''), -- false to_tsvector('  ') @@ to_tsquery('') -- false</span></span></code> </pre><br>  Trigram juga tidak memberikan sesuatu yang baik.  Pada akhirnya, saya memilih opsi yang agak diharapkan: ElasticSearch + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Russian Morphology</a> .  Ternyata sangat tidak nyaman untuk bekerja dengannya dari. NET, namun, ia berupaya mencari lima solid dengan nama lengkapnya. <br><br><h4>  Ketidaksempurnaan Sadar </h4><br>  Ketika mengerjakan suatu proyek, situasi secara teratur terjadi ketika seorang <i>perfeksionis internal</i> sangat marah dengan solusi yang dipilih.  Area subjek agak non-standar dan "perilaku baik" yang diterima secara umum tidak selalu berhasil. <br><br>  Misalnya, apa yang terjadi ketika kita membuka halaman? <br><br><ol><li>  Teks halaman dikompilasi dari Penurunan harga ke HTML.  Jika teks berisi tautan ke halaman lain dan file media, Anda harus pergi ke database untuk informasi lebih lanjut. </li><li>  Fakta-fakta yang deserialized dari JSON di mana mereka disimpan dalam database, dalam model tampilan. </li><li>  Hubungan ditentukan.  Untuk melakukan ini, dari database lama, perlu untuk mendapatkan <i>seluruh grafik koneksi</i> dan menemukan node di dalamnya sesuai dengan daftar jalur yang diketahui sebelumnya. </li></ol><br>  Sepintas ini tampak seperti operasi yang sangat sulit, tetapi pada kenyataannya ini bukan karena jumlah data yang relatif kecil.  Berapa banyak kerabat yang dapat Anda ingat dan ingin tuliskan?  Cobalah untuk menceritakannya kembali demi minat dan temukan bahwa akan sangat sulit untuk memanggil setidaknya seratus.  Dan berapa banyak orang yang ingin memberikan akses?  Bahkan jumlah yang sangat besar untuk sebuah keluarga adalah seribu orang!  - Dengan standar database modern, itu tetap konyol. <br><br>  Tentu saja, model tampilan halaman yang dikompilasi masih di-cache saat pertama kali dibuka dan digunakan kembali pada yang berikutnya, terutama karena itu sangat mudah diimplementasikan.  Aturan pembatalan cache untuk perubahan di panel admin juga diambil sesederhana mungkin: jika kita hanya mengubah teks dan beberapa fakta <i>lokal</i> (daftar bahasa, golongan darah, warna rambut, dll.), Maka cukup setel ulang halaman khusus ini.  Dengan perubahan lainnya - nama halaman, tanggal lahir atau jenis kelamin, menambah atau mengubah koneksi apa pun - cache <i>sepenuhnya</i> disetel ulang.  Ya, ini bukan cara paling cerdas untuk membersihkan.  Ya, pasti, Anda bisa menulis algoritma yang kompleks yang hanya akan mengatur ulang apa yang Anda butuhkan - tetapi untuk proyek ini tidak akan membenarkan biaya. <br><br>  Proyek ini tidak mendukung lokalisasi dan perubahan tampilan, otorisasi berfungsi pada OAuth di Facebook \ Google, dan panel admin dibuat pada formulir yang biasa, dan bukan kerangka kerja SPA berdasarkan mode terbaru.  Semua ini <i>dapat</i> direalisasikan atau ditingkatkan, tetapi tidak akan menyelesaikan masalah, dan karena itu waktu akan terbuang sia-sia. <br><br><h4>  Menantikan masa depan </h4><br>  Alasan lain mengapa tidak masuk akal untuk berinvestasi dalam kompleksitas perangkat mesin adalah sifat implementasi yang sementara dibandingkan dengan data yang disimpannya.  Pikirkan sejenak: web dalam bentuk saat ini telah ada selama hampir dua puluh tahun, dan sejarah keluarga telah ada <i>selama berabad-abad</i> .  Belum ada yang memecahkan masalah ini hanya karena industri teknologi informasi itu sendiri ada jauh lebih sedikit.  Apa yang bisa dilakukan? <br><br>  Mesin harus ditulis ulang secara teratur dari awal - seperti selama ribuan tahun, para bhikkhu sulit menyalin teks-teks dari buku-buku bobrok ke yang baru.  Satu-satunya perbedaan adalah bahwa buku itu bisa berbohong seratus tahun dengan penanganan yang tepat, dan aplikasi - pada kekuatan 15-20 tahun.  Saya berharap bahwa dalam dua puluh tahun saya masih bisa melakukannya sendiri, tetapi dalam dua puluh tahun lagi anak-anak atau cucu-cucu saya harus melakukannya.  Saya ingin meninggalkan mereka sumber yang sederhana, dapat dimengerti dan didokumentasikan. <br><br>  Pada tahap pertama desain, saya ingin menanamkan bahasa seperti SQL tertentu ke dalam mesin, dengan bantuan yang saya bisa mendapatkan jawaban untuk pertanyaan spesifik: "berapa persentase leluhur saya dengan mata biru", "ketika Ivan membeli mobil pertama" dan seterusnya.  Gagasan ini harus ditinggalkan karena akan membutuhkan alih-alih teks biasa untuk memasukkan semua informasi dalam bentuk formal tertentu, dan hanya deskripsi jenis ini yang akan memakan waktu bertahun-tahun.  Di sisi lain, Pemahaman Bahasa Alami memperoleh momentum.  Saya tidak akan terkejut jika dalam sepuluh atau dua tahun akan mungkin untuk meminta Siri untuk membaca teks untuk Anda, ikuti tautannya dan, sebagai hasilnya, menyajikan kutipan dari fakta.  Kawan, dorong! <br><br><h4>  Bagaimana cara mencoba? </h4><br>  Sayangnya, saya tidak dapat memberikan tautan ke demo yang sudah selesai: tidak ada server yang dapat menahan efek habra.  Tetapi ada beberapa tangkapan layar visual (gambar dapat diklik). <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/161/06a/0d0/16106a0d0a093a140c5095b472f847b5.png"></a> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/92e/c5b/798/92ec5b798673b928cf0e7ad6755bbc0d.png"></a> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/350/041/c9d/350041c9d3943b630474931f60f794bf.png"></a> <br><br>  Jika Bonsai tampak bermanfaat bagi Anda dan Anda ingin menjalankannya sendiri, kode sumbernya dapat diunduh dari Github: <br><br>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/impworks/bonsai</a></strong> <br><br>  Petunjuk pemasangan terperinci disediakan di Readme.  Anda akan membutuhkan ini: <br><br><ol><li>  .NET Core 2.1+ </li><li>  PostgreSQL 10+ </li><li>  ElasticSearch 5.x dan plugin Morfologi Rusia </li><li>  Facebook atau aplikasi Google untuk otorisasi oAuth </li></ol><br>  Setelah peluncuran pertama, beberapa halaman pengujian dan foto dibuat dalam database.  Untuk produksi, perilaku ini tidak diperlukan dan dinonaktifkan oleh bendera di pengaturan. <br><br>  Hanya sebulan yang lalu, saya meluncurkan contoh saya sendiri dan mulai menjalankannya, mendapatkan data nyata.  Beberapa kekasaran ditemui, tetapi sebaliknya saya benar-benar puas dengan hasilnya.  Sekarang proyek akan secara bertahap dikembangkan dan diselesaikan.  Tugas utama adalah untuk mempercepat tampilan pohon, memungkinkan mengunduh dokumen dalam bentuk PDF dan menambahkan penyesuaian hak akses.  Akan lebih baik untuk meningkatkan kegunaan panel admin di beberapa tempat atau untuk secara otomatis mengenali wajah di foto - <i>tetapi ini tidak akurat</i> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id438622/">https://habr.com/ru/post/id438622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id438606/index.html">Degradasi anggun. Laporkan Yandex.Taxi</a></li>
<li><a href="../id438610/index.html">Templat Figma Responsif: Membuat Komponen Desain yang Fleksibel untuk Navigasi Seluler iOS</a></li>
<li><a href="../id438614/index.html">Apa itu animasi idle berkualitas? Pengembang membagikan contoh favorit mereka.</a></li>
<li><a href="../id438618/index.html">Membuat proyektor laser teks DIY</a></li>
<li><a href="../id438620/index.html">Path saya sebagai Pemula</a></li>
<li><a href="../id438624/index.html">Kami memprogram peralihan melalui bagian. MicroPython pada esp8266 (sonoff) dengan OTA. Bagian 1</a></li>
<li><a href="../id438626/index.html">Intisari materi menarik untuk pengembang seluler # 284 (28 Januari - 3 Februari)</a></li>
<li><a href="../id438628/index.html">SharedState Component Change Status Notification</a></li>
<li><a href="../id438630/index.html">Google+ Sic transit gloria mundi ...</a></li>
<li><a href="../id438632/index.html">Hardcore 2D RPG Gamedev Diaries, vol.0 - INTRO, atau "How I Got Here"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>