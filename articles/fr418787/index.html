<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👏🏼 👋🏿 👂🏿 Le suivi des événements pour Windows est du mauvais côté. Mais ce n'est pas sûr 🔁 📜 🎚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans des articles précédents sur le renifleur PowerShell et la collecte de données de démarrage à partir d'un serveur distant, j'ai déjà écrit un peu ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le suivi des événements pour Windows est du mauvais côté. Mais ce n'est pas sûr</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pc-administrator/blog/418787/"><p><img src="https://habrastorage.org/webt/ii/h9/zh/iih9zhmwsn9nofzy8rkouzp4yry.jpeg"></p><br><p>  Dans des articles précédents sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le renifleur PowerShell</a> et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">collecte de données de démarrage à partir d'un serveur distant,</a> j'ai déjà écrit un peu sur les capacités ETW (Event Tracing for Windows).  Aujourd'hui, je veux parler davantage de cette technologie. </p><br><p>  Dans le même temps, je vais démontrer l'utilisation de HTTPS et la création d'un enregistreur de frappe sur PowerShell comme exemple de la façon dont il peut être utilisé pour de bon.  Ou pas vraiment pour le bien. <a name="habracut"></a></p><br><h1 id="rabota-s-etw">  Travailler avec ETW </h1><br><p>  Le suivi des événements pour Windows collecte et envoie des messages à partir des composants du système Windows et des applications tierces.  Il est apparu à l'époque de Windows 2000, mais s'il y avait à l'époque plusieurs dizaines de fournisseurs de systèmes, leur score est déjà de plusieurs centaines.  Les messages sont utilisés pour diagnostiquer les erreurs et résoudre les problèmes de performances logicielles. </p><br><p> Certains fournisseurs de systèmes écrivent déjà dans le journal des événements Windows par défaut, et certains sont inclus séparément.  Donc, même si vous ne connaissez pas ETW, vous l'utilisez probablement.  Vous pouvez vous familiariser avec les journaux et activer certains d'entre eux si nécessaire dans l'Observateur d'événements standard dans les journaux d'application et de service.  Un article sur le magazine et sur son utilisation se trouve dans l'article " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nous faisons tourner les journaux comme nous le souhaitons - analyse des journaux dans les systèmes Windows</a> ". </p><br><p>  <strong>Vous pouvez afficher la liste des fournisseurs existants</strong> qui se contentent de nous dire ce qui leur arrive avec la commande <strong>logman query providers</strong> . </p><br><p><img src="https://habrastorage.org/webt/l1/pj/bk/l1pjbkjfufxvyqp5ro4xv4qjyne.jpeg"></p><br><p>  <em>Fournisseurs ETW.</em> </p><br><p>  Vous pouvez utiliser la commande <strong>logman query providers -pid &lt;process PID&gt;</strong> pour afficher la liste des fournisseurs connectés à un processus Windows spécifique (et, par conséquent, en savoir plus) <strong>.</strong> </p><br><p><img src="https://habrastorage.org/webt/f2/q3/is/f2q3is7egt-nmq70kkeoijqvrp0.jpeg"></p><br><p>  <em>Liste des fournisseurs connectés à un ordinateur portable standard.</em> </p><br><p>  <strong>Vous</strong> pouvez activer l' <strong>abonnement aux événements d'un</strong> fournisseur spécifique ou effectuer un <strong>suivi</strong> via PowerShell à l'aide de l' <strong>applet de commande New-NetEventSession</strong> .  Et vous pouvez même cliquer avec la souris sur le chemin "Gestion de l'ordinateur" - "Performances" - "Groupe de collecteurs de données".  Ici, dans les sessions de suivi des événements, vous pouvez voir quelles traces sont en cours d'exécution et vous pouvez créer votre propre collecteur si vous le souhaitez. </p><br><p><img src="https://habrastorage.org/webt/gh/bx/qe/ghbxqepwh2ilmzzul7khowlivgo.jpeg"></p><br><p>  <em>Exécution de traces.</em> </p><br><p>  <strong>Vous pouvez afficher le résultat à l'</strong> aide d'utilitaires et d'ensembles d'utilitaires tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microsoft Message Analyzer</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Windows Performance Toolkit</a> ou même l' <strong>applet de commande</strong> PowerShell <strong>Get-WinEvent</strong> . </p><br><p>  Je vous recommande de lire les fonctionnalités d'ETW dans la documentation Microsoft, vous pouvez commencer par la section <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">À propos du suivi des événements</a> .  Je peux également recommander du bon matériel « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nous étudions les ETW et en tirons des bénéfices</a> ». </p><br><p>  Étant donné que ETW fonctionne au niveau du noyau, il se distingue par la vitesse de transfert des messages et l'absence de la nécessité d'installer des pilotes ou des injections dans les applications.  En règle générale, les ETW sont utilisés pour diagnostiquer les problèmes de performances et d'application.  Par exemple, l'article « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Accélérer le démarrage de Windows pour le plaisir et le profit</a> » analyse les facteurs qui influencent le ralentissement du chargement, et dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CPU 24 cœurs et je ne peux pas déplacer ma souris</a> - les raisons du ralentissement de Windows sur les opérations ordinaires.  Permettez-moi de vous donner un exemple: l'analyse de l'exécution des applets de commande PowerShell. </p><br><h1 id="sledim-za-powershell">  Regarder PowerShell </h1><br><p>  Supposons que d'une manière ou d'une autre (par exemple, par le biais d'un audit des démarrages de processus), vous constatez que des processus flous et des scripts PowerShell s'exécutent sur votre ordinateur.  Une technique consistera à utiliser des ETW pour analyser leur activité.  Par exemple, regardez le fournisseur PowerShell.  Activez le traçage avec la commande: </p><br><pre><code class="bash hljs">logman start pstrace -p Microsoft-Windows-PowerShell -oc:\temp\pstrace.etl -ets</code> </pre> <br><p>  Attendons maintenant que les scripts incompréhensibles fonctionnent, arrêtons la trace avec la commande: </p><br><pre> <code class="bash hljs">logman stop pstrace -ets</code> </pre><br><p>  Vous pouvez maintenant voir la trace, par exemple, via Microsoft Message Analyzer. </p><br><p><img src="https://habrastorage.org/webt/3i/3j/7u/3i3j7uamctkk9-pd23lmtizdjcs.jpeg"></p><br><p>  <em>Clean.ps1 suspecte recherche et supprime évidemment quelque chose.</em> </p><br><p>  Si vous sélectionnez la ligne souhaitée, le panneau inférieur contient des informations détaillées sur l'événement. </p><br><p><img src="https://habrastorage.org/webt/xk/tx/3t/xktx3thdkpitn0bueqhlaqmfx1k.jpeg"></p><br><p>  <em>Ah, c'est le même script pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vider le</a> cache 1C!</em> </p><br><p>  Cette fois, tout s'est avéré banal.  Mais dans des cas plus complexes, vous pouvez exécuter une trace pour vérifier d'autres activités: </p><br><ul><li>  activité de réseau; </li><li>  Résolution DNS </li><li>  accès au disque; </li><li>  travailler avec la mémoire; </li><li>  Activité WMI </li><li>  et bien plus. </li></ul><br><p>  De cette façon, ETW peut aider à détecter les logiciels malveillants et à comprendre le fonctionnement des applications.  Dans certains endroits, cela est plus informatif que le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Process Monitor</a> habituel.  Mais en plus de bonnes actions, le mécanisme a un côté «sombre». </p><br><blockquote>  Bien sûr, vous pouvez tuer avec un marteau et économiser avec un pistolet.  Bien sûr, je ne ferai pas une évaluation morale des mécanismes, mais en tout cas, des opportunités intéressantes s'ouvrent. </blockquote><p>  Je vais donner quelques exemples comme preuve de concept </p><br><h1 id="s--znachit-beeezopasno">  S signifie sûr </h1><br><p>  Dans cet exemple, je montrerai à quel point il est facile de découvrir ce qu'un utilisateur recherche sur Internet, même via HTTPS.  Vous pouvez le voir sans PowerShell - seulement une souris, uniquement du hardcore.  Dans notre tâche, il y aura un utilisateur, il y aura Windows, Internet Explorer et un journal des événements. </p><br><p>  Commençons par activer le journal des événements Wininet.  Cela se fait comme suit: ouvrez le journal des événements, sur l'onglet «Affichage», activez l'affichage des journaux analytiques et de débogage. </p><br><p><img src="https://habrastorage.org/webt/fu/de/q0/fudeq02mmzhunyyw1cwib0ou8pm.jpeg"></p><br><p>  <em>Ajoutez l'affichage des journaux souhaités.</em> </p><br><p>  Après cela, activez UsageLog dans le menu contextuel, et cela suffit pour obtenir les informations nécessaires.  Utilisons IE et voyons le journal: </p><br><p><img src="https://habrastorage.org/webt/pj/mu/ja/pjmujaesudek77i77sv0vtnnnjc.jpeg"></p><br><p>  <em>Magazine WinInet.</em> </p><br><p>  En fait, dans les en-têtes du magazine et une demande directe au moteur de recherche sont visibles. </p><br><p>  En plus des en-têtes, vous pouvez également utiliser le journal de bord pour retirer les cookies, et en même temps voir les demandes POST - par exemple, pour retirer les informations d'identification.  La technique fonctionne sur toutes les applications qui utilisent wininet.dll pour fonctionner avec Internet.  Par exemple, le navigateur Edge. </p><br><p>  La même chose est facilement implémentée sur PowerShell, et même sur cmd.  Je vais donner un exemple de mise en œuvre en dernier. </p><br><p>  Créez d'abord une trace: </p><br><pre> <code class="bash hljs">logman start CookieStealer -p Microsoft-Windows-WinInet -oc:\temp\cookiesteal.etl -ets</code> </pre><br><p>  Maintenant, travaillons dans le navigateur, vérifions le courrier.  Le traçage peut alors être arrêté avec la commande: </p><br><pre> <code class="bash hljs">logman stop CookieStealer -ets</code> </pre><br><p>  L'analyse la plus simple peut être effectuée à l'aide de l' <strong>utilitaire de</strong> commande <strong>wevtutil.exe</strong> .  Par exemple, pour afficher les requêtes POST, la commande serait: </p><br><pre> <code class="bash hljs">wevtutil qe c:\temp\cookiesteal.etl /lf:<span class="hljs-literal"><span class="hljs-literal">true</span></span> /f:Text | find /i <span class="hljs-string"><span class="hljs-string">"POST"</span></span></code> </pre><br><p>  Vous pouvez même essayer au hasard de rechercher le mot de <em>passe</em> et d'obtenir le résultat. </p><br><p><img src="https://habrastorage.org/webt/yg/yk/gd/ygykgdj9vmqmlp7aobfcz5fyyiu.jpeg"></p><br><p>  <em>Mots de passe en texte brut.</em>  <em>Très ennuyeux.</em> </p><br><p>  Il convient de noter que l'antivirus était silencieux en même temps.  En effet, il s'agit d'un processus de traçage normal. </p><br><p>  Bien sûr, les événements WinInet peuvent également être utilisés pour diagnostiquer des problèmes tels que «pourquoi ce site ne s'ouvre pas et ce qui se passe du tout».  Néanmoins, les possibilités sont assez intéressantes.  Je passe à un exemple encore plus tordu. </p><br><h1 id="keylogger-na-powershell-potomu-chto-mogu">  Enregistreur de frappe sur PowerShell.  Parce que je peux. </h1><br><p>  Il existe deux fournisseurs ETW intéressants sur Windows: </p><br><ul><li><p>  <strong>Microsoft-Windows-USB-UCX</strong> (36DA592D-E43A-4E28-AF6F-4BC57C5A11E8) - fonctionne avec USB 2.0. </p><br></li><li><p>  <strong>Microsoft-Windows-USB-USBPORT</strong> (C88A4EF5-D048-4013-9408-E04B7DB2814A) - fonctionne avec USB 3.0. </p><br></li></ul><br><p>  Avec leur aide, vous pouvez obtenir les données HID qu'un périphérique USB tel qu'un clavier ou une souris transfère.  Les données sont capturées brutes, mais grâce à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la spécification</a> HID <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">,</a> elles peuvent être facilement lues. </p><br><p>  Pour démarrer le traçage, exécutez simplement les commandes suivantes: </p><br><pre> <code class="bash hljs">logman start <span class="hljs-string"><span class="hljs-string">"usbtrace"</span></span> -p <span class="hljs-string"><span class="hljs-string">"microsoft-windows-usb-usbport"</span></span> -o <span class="hljs-string"><span class="hljs-string">"c:\temp\usbtrace.etl"</span></span> -ets</code> </pre><br><p>  Et les données peuvent être obtenues avec l'applet de commande PowerShell: </p><br><pre> <code class="hljs mel">$Input=get-winevent –path <span class="hljs-string"><span class="hljs-string">"c:\temp\usbtrace.etl"</span></span> –oldest | where {$_.message –<span class="hljs-keyword"><span class="hljs-keyword">match</span></span> <span class="hljs-string"><span class="hljs-string">"Data"</span></span>}</code> </pre><br><p>  Je vais donner un exemple d'un script simple qui lit les données de trace et les convertit en valeurs lisibles.  La conversion se fait uniquement pour les lettres anglaises et exclusivement en majuscules. </p><br><div class="spoiler">  <b class="spoiler_title">Liste complète du script sous le spoiler.</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$source</span></span> = <span class="hljs-string"><span class="hljs-string">"C:\temp\trace.etl"</span></span> <span class="hljs-variable"><span class="hljs-variable">$destination</span></span>= <span class="hljs-string"><span class="hljs-string">"C:\temp\Output.txt"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tracetime</span></span> = <span class="hljs-string"><span class="hljs-string">"10"</span></span> logman start usbtrace <span class="hljs-literal"><span class="hljs-literal">-p</span></span> microsoft<span class="hljs-literal"><span class="hljs-literal">-windows</span></span><span class="hljs-literal"><span class="hljs-literal">-usb</span></span><span class="hljs-literal"><span class="hljs-literal">-usbport</span></span> <span class="hljs-literal"><span class="hljs-literal">-o</span></span> <span class="hljs-variable"><span class="hljs-variable">$source</span></span> <span class="hljs-literal"><span class="hljs-literal">-ets</span></span> sleep <span class="hljs-variable"><span class="hljs-variable">$TraceTime</span></span> logman stop usbtrace <span class="hljs-literal"><span class="hljs-literal">-ets</span></span> <span class="hljs-variable"><span class="hljs-variable">$Input</span></span>=<span class="hljs-built_in"><span class="hljs-built_in">get-winevent</span></span> –path <span class="hljs-variable"><span class="hljs-variable">$Source</span></span> –oldest | where {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.message –match <span class="hljs-string"><span class="hljs-string">"Data"</span></span>} <span class="hljs-variable"><span class="hljs-variable">$HID</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">Foreach</span></span> (<span class="hljs-variable"><span class="hljs-variable">$I</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-variable"><span class="hljs-variable">$Input</span></span>) {(<span class="hljs-string"><span class="hljs-string">'{0:x}'</span></span> <span class="hljs-operator"><span class="hljs-operator">-f</span></span> (<span class="hljs-variable"><span class="hljs-variable">$I</span></span>.properties.value[<span class="hljs-number"><span class="hljs-number">5</span></span>]))} <span class="hljs-variable"><span class="hljs-variable">$Data</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-variable"><span class="hljs-variable">$HID</span></span>) { <span class="hljs-number"><span class="hljs-number">4</span></span> {<span class="hljs-string"><span class="hljs-string">"A"</span></span>} <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"B"</span></span>} <span class="hljs-number"><span class="hljs-number">6</span></span> {<span class="hljs-string"><span class="hljs-string">"C"</span></span>} <span class="hljs-number"><span class="hljs-number">7</span></span> {<span class="hljs-string"><span class="hljs-string">"D"</span></span>} <span class="hljs-number"><span class="hljs-number">8</span></span> {<span class="hljs-string"><span class="hljs-string">"E"</span></span>} <span class="hljs-number"><span class="hljs-number">9</span></span> {<span class="hljs-string"><span class="hljs-string">"F"</span></span>} A {<span class="hljs-string"><span class="hljs-string">"G"</span></span>} B {<span class="hljs-string"><span class="hljs-string">"H"</span></span>} C {<span class="hljs-string"><span class="hljs-string">"I"</span></span>} D {<span class="hljs-string"><span class="hljs-string">"J"</span></span>} E {<span class="hljs-string"><span class="hljs-string">"K"</span></span>} F {<span class="hljs-string"><span class="hljs-string">"L"</span></span>} <span class="hljs-number"><span class="hljs-number">10</span></span> {<span class="hljs-string"><span class="hljs-string">"M"</span></span>} <span class="hljs-number"><span class="hljs-number">11</span></span> {<span class="hljs-string"><span class="hljs-string">"N"</span></span>} <span class="hljs-number"><span class="hljs-number">12</span></span> {<span class="hljs-string"><span class="hljs-string">"O"</span></span>} <span class="hljs-number"><span class="hljs-number">13</span></span> {<span class="hljs-string"><span class="hljs-string">"P"</span></span>} <span class="hljs-number"><span class="hljs-number">14</span></span> {<span class="hljs-string"><span class="hljs-string">"Q"</span></span>} <span class="hljs-number"><span class="hljs-number">15</span></span> {<span class="hljs-string"><span class="hljs-string">"R"</span></span>} <span class="hljs-number"><span class="hljs-number">16</span></span> {<span class="hljs-string"><span class="hljs-string">"S"</span></span>} <span class="hljs-number"><span class="hljs-number">17</span></span> {<span class="hljs-string"><span class="hljs-string">"T"</span></span>} <span class="hljs-number"><span class="hljs-number">18</span></span> {<span class="hljs-string"><span class="hljs-string">"U"</span></span>} <span class="hljs-number"><span class="hljs-number">19</span></span> {<span class="hljs-string"><span class="hljs-string">"V"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>A {<span class="hljs-string"><span class="hljs-string">"W"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>B {<span class="hljs-string"><span class="hljs-string">"X"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>C {<span class="hljs-string"><span class="hljs-string">"Y"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>D {<span class="hljs-string"><span class="hljs-string">"Z"</span></span>} } <span class="hljs-variable"><span class="hljs-variable">$Data</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">out-file</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">get-content</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span> del <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$source</span></span></span><span class="hljs-string">"</span></span> del <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span></code> </pre> </div></div><br><p>  Lorsqu'il est lancé, le script active la trace pendant 10 secondes, puis affiche le résultat. </p><br><p><img src="https://habrastorage.org/webt/w1/kg/ag/w1kgag36huygrqilju8ngooidx8.jpeg"></p><br><p>  <em>Le résultat du script.</em> </p><br><p>  Bien sûr, après avoir compris les données HID, vous pouvez affiner le script pour un enregistreur de frappe complet qui enregistrerait les données du clavier et de la souris.  Il convient de noter les limites de ce mécanisme: </p><br><ul><li>  ne fonctionne qu'avec USB, et PS \ 2 (comme on le trouve parfois sur les ordinateurs portables) n'est pas pris en charge; </li><li>  La prise en charge USB 3.0 n'est annoncée que sous Windows 8 et supérieur; </li><li>  Droits d'administrateur (UAC) requis. </li></ul><br><p>  Mais pas de pilotes et d'intercepteurs.  Eh bien, bien sûr, en plus d'une utilisation malveillante, un tel enregistreur de frappe peut aider à diagnostiquer des problèmes avec le clavier.  Théoriquement. </p><br><h1 id="nuzhno-li-boyatsya">  Dois-je avoir peur </h1><br><p>  Même les mécanismes intégrés entre les mains du méchant peuvent causer des problèmes.  Les méthodes de protection restent les mêmes: bloquer les fichiers exécutables ne provenant pas des répertoires système, ne fonctionnent pas en tant qu'utilisateur avec des privilèges d'administrateur, et s'ils fonctionnent, au moins ne désactivez pas l'UAC.  Et, bien sûr, les navigateurs Windows intégrés en termes de sécurité soulèvent des questions. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418787/">https://habr.com/ru/post/fr418787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418777/index.html">«Il n'y a pas de patron ici»: à propos de travailler avec Open Source et Apache Ignite dans Sberbank Technologies</a></li>
<li><a href="../fr418779/index.html">Caissier sur la base de la tablette: pourquoi les détaillants du réseau en ont besoin (nous le disons sur l'exemple de notre caissier)</a></li>
<li><a href="../fr418781/index.html">Ajoutez le cryptage des e-mails et la signature électronique à Zimbra</a></li>
<li><a href="../fr418783/index.html">"Qui hier était un géant monopolistique, demain pourrait devenir rien." Entretien avec Evgeny Chereshnev de Biolink.Tech</a></li>
<li><a href="../fr418785/index.html">Amigo tout. Maintenant c'est officiel</a></li>
<li><a href="../fr418789/index.html">Uber arrête de développer des camions sans pilote</a></li>
<li><a href="../fr418791/index.html">Oracles, ou pourquoi les contrats intelligents n'ont-ils toujours pas changé le monde?</a></li>
<li><a href="../fr418793/index.html">PDU EXpert - Expert en distribution d'énergie</a></li>
<li><a href="../fr418795/index.html">Courte critique du ASUS ROG GM501 Zephyrus M</a></li>
<li><a href="../fr418797/index.html">Erreurs gauchers de projets informatiques lors de l'entrée sur le marché américain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>