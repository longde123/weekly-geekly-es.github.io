<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ∏Ô∏è üßôüèª üíø Problema de privacidade de dados do Active Directory üëáüèæ üñêüèΩ üïµüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fiz teste de penetra√ß√£o usando o PowerView e usei-o para recuperar informa√ß√µes do usu√°rio do Active Directory (doravante referido como AD). Naquela √©p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Problema de privacidade de dados do Active Directory</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/479814/"><img src="https://habrastorage.org/webt/v0/e8/hf/v0e8hfhhlkc-riyxghgiqbcsk2o.jpeg"><br><br>  Fiz teste de penetra√ß√£o usando o <a href="https://www.varonis.com/blog/powerview-for-penetration-testing/">PowerView</a> e usei-o para recuperar informa√ß√µes do usu√°rio do Active Directory (doravante referido como AD).  Naquela √©poca, concentrei-me na coleta de informa√ß√µes sobre associa√ß√£o a grupos de seguran√ßa e, em seguida, usei essas informa√ß√µes para navegar na rede.  Em qualquer caso, o AD cont√©m dados confidenciais sobre funcion√°rios, alguns deles realmente n√£o devem estar acess√≠veis a todos na organiza√ß√£o.  De fato, nos sistemas de arquivos do Windows, existe um <a href="https://www.varonis.com/blog/3-deadly-file-permissions-mistakes/">problema Todos</a> equivalente, que tamb√©m pode ser explorado por atacantes internos e externos. <br><br>  Mas antes de falarmos sobre problemas de privacidade e como corrigi-los, vamos dar uma olhada nos dados armazenados no AD. <br><a name="habracut"></a><br><h2>  <font color="#D21927">O Active Directory √© um Facebook corporativo</font> </h2><br>  Mas neste caso, voc√™ j√° fez amizade com todos!  Voc√™ pode n√£o descobrir os filmes, livros e restaurantes favoritos de seus colegas, mas o AD cont√©m contatos confidenciais <br>  dados e outros campos que podem ser usados ‚Äã‚Äãpor hackers e at√© por profissionais internos sem habilidades t√©cnicas especiais. <br><br>  Os administradores de sistema, √© claro, est√£o familiarizados com a captura de tela abaixo.  Essa √© a interface de Usu√°rios e Computadores do Active Directory (ADUC), onde eles instalam e editam informa√ß√µes do usu√°rio e atribuem usu√°rios aos grupos apropriados. <br><br><img src="https://habrastorage.org/webt/tk/sk/8g/tksk8gyjhubwdglxgagnnawa0_0.jpeg"><br><br>  O AD cont√©m campos com o nome do funcion√°rio, endere√ßo e n√∫mero de telefone, para que pare√ßa uma lista telef√¥nica.  Mas h√° muito mais!  Outras guias tamb√©m t√™m um endere√ßo de email e um endere√ßo da Web, um supervisor imediato e notas. <br><br>  Todos na organiza√ß√£o devem ver essas informa√ß√µes, especialmente na era <a href="https://www.varonis.com/blog/we-know-about-your-companys-data-osint-lessons-for-c-levels/">OSINT</a> , quando cada nova parte facilita a localiza√ß√£o de informa√ß√µes adicionais? <br><br>  Claro que n√£o!  O problema √© exacerbado quando os dados da ger√™ncia s√™nior est√£o dispon√≠veis para todos os funcion√°rios. <br><br><h2>  <font color="#D21927">PowerView para todos</font> </h2><br>  √â aqui que o PowerView entra em cena.  Ele fornece uma interface do PowerShell muito conveniente para as fun√ß√µes Win32 subjacentes (e confusas) que acessam o AD.  Em resumo: <br>  isso torna a obten√ß√£o de campos do AD t√£o f√°cil quanto a inser√ß√£o de um cmdlet muito curto. <br><br>  Vamos dar um exemplo de coleta de informa√ß√µes sobre um funcion√°rio da Cruella Deville, que √© um dos l√≠deres da empresa.  Para fazer isso, use o cmdlet PowerView get-NetUser: <br><br><img src="https://habrastorage.org/webt/q2/aa/4v/q2aa4vxypirpcl_qfkqnbmvz1o4.jpeg"><br><br>  Instalar o PowerView n√£o √© um problema s√©rio - veja voc√™ mesmo na p√°gina do <a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon">github</a> .  E mais importante, voc√™ n√£o precisa de privil√©gios elevados para executar muitos comandos do PowerView, como o get-NetUser.  Assim, um funcion√°rio motivado, mas n√£o muito tecnicamente experiente, pode come√ßar a bisbilhotar no AD sem muito esfor√ßo. <br><br>  Na captura de tela acima, pode-se ver que o insider pode aprender rapidamente muito sobre o Cruella.  Voc√™ tamb√©m notou que o campo "info" exibe informa√ß√µes sobre os h√°bitos pessoais e a senha do usu√°rio? <br><br>  Esta n√£o √© uma probabilidade te√≥rica.  Pelas <a href="https://info.varonis.com/recorded-webinar/basic-pen-testing-techniques-en">caixas de di√°logo com outros promotores,</a> aprendi que eles examinam o AD para procurar senhas de forma n√£o criptografada e, muitas vezes, essas tentativas, infelizmente, s√£o bem-sucedidas.  Eles sabem que as empresas s√£o descuidadas com as informa√ß√µes no AD e geralmente n√£o sabem sobre o pr√≥ximo t√≥pico - permiss√µes no AD. <br><br><h2>  <font color="#D21927">O Active Directory possui suas pr√≥prias ACLs</font> </h2><br>  A interface Usu√°rios e computadores do AD permite definir permiss√µes para objetos do AD.  Existem ACLs no AD e os administradores podem atribuir ou negar acesso atrav√©s deles.  Voc√™ precisa clicar em "Avan√ßado" no menu Exibi√ß√£o do ADUC e, quando abrir o usu√°rio, ver√° a guia "Seguran√ßa" na qual define a ACL. <br><br>  No meu script com Cruella, eu n√£o queria que todos os Usu√°rios autenticados pudessem ver suas informa√ß√µes pessoais, ent√£o neguei a eles acesso de leitura: <br><br><img src="https://habrastorage.org/webt/oa/he/06/oahe06ch770xrz7u53d29ynru7m.jpeg"><br><br>  E agora um usu√°rio comum ver√° isso se tentar o Get-NetUser no PowerView: <br><br><img src="https://habrastorage.org/webt/gi/qj/fq/giqjfq5cxwd5414qeqguygz2kma.jpeg"><br><br>  Consegui esconder informa√ß√µes √∫teis e √∫teis de olhares indiscretos.  Para mant√™-lo acess√≠vel a usu√°rios relevantes, criei outra ACL para permitir que membros VIP (Cruella e outros colegas de alto n√≠vel) acessem esses dados confidenciais.  Em outras palavras, implementei as permiss√µes do AD com base no modelo, que tornava os dados confidenciais inacess√≠veis para a maioria dos funcion√°rios, incluindo os internos. <br><br>  No entanto, voc√™ pode tornar a associa√ß√£o do grupo invis√≠vel para os usu√°rios, definindo a ACL apropriada para o objeto de grupo no AD.  Isso ajudar√° em termos de privacidade e seguran√ßa. <br><br>  Na minha <a href="https://www.varonis.com/blog/powerview-for-penetration-testing/">s√©rie de protestos √©picos,</a> mostrei como voc√™ pode navegar no sistema explorando associa√ß√µes de grupos usando o PowerViews Get-NetGroupMember.  No meu cen√°rio, restrinjai o acesso de leitura √† participa√ß√£o em um grupo espec√≠fico.  Voc√™ v√™ o resultado do comando antes e depois das altera√ß√µes: <br><br><img src="https://habrastorage.org/webt/13/wi/mq/13wimqvqgqq2gval5k-kq998bwa.jpeg"><br><br>  Consegui ocultar a participa√ß√£o de Cruella e Monty Burns no grupo VIP, o que complicou a explora√ß√£o da infraestrutura por hackers e especialistas. <br><br>  Esta publica√ß√£o teve como objetivo motiv√°-lo a estudar os campos mais de perto. <br>  AD e permiss√µes relacionadas.  O AD √© um √≥timo recurso, mas pense em como voc√™ <br>  queria compartilhar informa√ß√µes confidenciais e dados pessoais, especialmente <br>  quando se trata das primeiras pessoas da sua organiza√ß√£o. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479814/">https://habr.com/ru/post/pt479814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479794/index.html">Combinamos o microcontrolador "infantil" e os jogos de tabuleiro</a></li>
<li><a href="../pt479796/index.html">Amea√ßa de Thanos em Kingston</a></li>
<li><a href="../pt479800/index.html">Estou escrevendo em c # para facilitar o front-end</a></li>
<li><a href="../pt479802/index.html">Tabelas em C ++. Parte 1 (b√°sico + heran√ßa m√∫ltipla)</a></li>
<li><a href="../pt479810/index.html">Como publiquei um artigo cient√≠fico na Nature</a></li>
<li><a href="../pt479816/index.html">Combinat√≥ria em Python</a></li>
<li><a href="../pt479818/index.html">Como avaliar a profici√™ncia em ingl√™s</a></li>
<li><a href="../pt479820/index.html">O que colocar sob uma √°rvore de TI? Rel√≥gio bin√°rio</a></li>
<li><a href="../pt479822/index.html">Gatos em caixas ou estruturas de dados compactas</a></li>
<li><a href="../pt479824/index.html">Atributos e protocolo de manipula√ß√£o em Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>