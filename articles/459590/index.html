<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§µüèø üåú üë®üèø‚Äçüíº Programa de afiliados de c√≥digo abierto descentralizado en la cadena de bloques Waves üöî üóΩ üçò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un programa de afiliados descentralizado en la cadena de bloques Waves, implementado como parte de una subvenci√≥n de Waves Labs por el equipo de Bette...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programa de afiliados de c√≥digo abierto descentralizado en la cadena de bloques Waves</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459590/">  Un programa de afiliados descentralizado en la cadena de bloques Waves, implementado como parte de una subvenci√≥n de Waves Labs por el equipo de Bettex. <br><br><div class="spoiler">  <b class="spoiler_title">La publicaci√≥n no es publicitaria.</b> <div class="spoiler_text">  !  El programa es de c√≥digo abierto, su uso y distribuci√≥n es gratuita.  La aplicaci√≥n del programa estimula el desarrollo de aplicaciones dApp y, en general, promueve la descentralizaci√≥n, lo cual es beneficioso para todos los usuarios de la red. <br></div></div><br><img src="https://habrastorage.org/webt/hn/xm/xk/hnxmxkdtj1phll6cwjyceneyczg.jpeg" alt="imagen"><br><a name="habracut"></a><br>  Introducido por dApp para programas de afiliados es una plantilla para proyectos que incluyen afiliados como parte de su funcionalidad.  El c√≥digo se puede usar como plantilla para copiar, como biblioteca o como conjunto de ideas para implementaci√≥n t√©cnica. <br><br>  En t√©rminos de funcionalidad, este es un sistema de afiliaci√≥n regular que implementa el registro con un referente, la acumulaci√≥n de recompensas en varios niveles por referencias y la motivaci√≥n para el registro en el sistema (devoluci√≥n de efectivo).  El sistema es dApp "puro", es decir, la aplicaci√≥n web interact√∫a directamente con la cadena de bloques sin su backend, base de datos, etc. <br><br>  Se utilizan t√©cnicas que tambi√©n pueden ser √∫tiles en muchos otros proyectos: <br><br><ul><li>  Llamar a una cuenta inteligente a cr√©dito con reembolso inmediato (en el momento de la llamada, no hay tokens en la cuenta para pagar la llamada, pero aparecen all√≠ como resultado de la llamada). </li><li>  PoW-captcha: protecci√≥n contra llamadas automatizadas de alta frecuencia de funciones de cuentas inteligentes, un an√°logo de captcha, pero a trav√©s de la prueba del uso de recursos inform√°ticos. </li><li>  Solicitud de claves de datos por plantilla. </li></ul><br>  La aplicaci√≥n consta de: <br><br><ul><li>  c√≥digo de cuenta inteligente en el idioma ride4dapps (que, por dise√±o, se fusion√≥ con la cuenta inteligente principal, para la cual debe implementar la funcionalidad de afiliado); </li><li>  js wrappers que implementan el nivel de abstracci√≥n sobre la API WAVES NODE REST; </li><li>  c√≥digo en el marco vuejs, que es un ejemplo del uso de la biblioteca y el c√≥digo RIDE. </li></ul><br>  Describimos todas estas caracter√≠sticas. <br><br>  <b>Llame a una cuenta inteligente a cr√©dito con reembolso inmediato</b> <br><br>  Las llamadas a InvokeScript requieren una tarifa de la cuenta que inicia la transacci√≥n.  Esto no es un problema si est√° haciendo un proyecto para geeks de blockchain que tienen algunos tokens WAVES en su cuenta, pero si el producto est√° destinado a un uso generalizado, esto se convierte en un problema grave.  Despu√©s de todo, el usuario debe asegurarse de comprar tokens WAVES (u otro activo adecuado con el que pueda pagar las transacciones), lo que aumenta el umbral ya considerable para ingresar al proyecto.  Podemos distribuir activos a los usuarios, lo que nos permitir√° pagar las transacciones y enfrentar el riesgo de su mal uso cuando se crean sistemas automatizados para bombear activos l√≠quidos de nuestro sistema. <br><br>  Ser√≠a muy conveniente si fuera posible hacer que InvokeScript llame "a expensas del destinatario" (la cuenta inteligente en la que est√° instalado el script), y existe tal posibilidad, aunque no de una manera obvia. <br><br>  Si ejecuta ScriptTransfer dentro de InvokeScript a la direcci√≥n de la persona que llama, que compensa los tokens gastados en la tarifa, entonces dicha llamada tendr√° √©xito, incluso si no hab√≠a activos en la cuenta de llamadas en el momento de la llamada.  Esto es posible debido al hecho de que se verifica un n√∫mero suficiente de tokens despu√©s de que se llama una transacci√≥n, y no antes, para que sea posible realizar transacciones a cr√©dito sujetas a su reembolso inmediato. <br><br>  <i>ScriptTransfer (i.caller, i.fee, unit)</i> <br><br>  El siguiente c√≥digo reembolsa la tarifa gastada a expensas de la cuenta inteligente.  Para protegerse contra el mal uso de esta funci√≥n, debe usar el cheque de que la persona que llama est√° gastando una tarifa en el activo correcto y dentro de l√≠mites razonables: <br><br><pre><code class="plaintext hljs">func checkFee(i:Invocation) = { if i.fee &gt; maxFee then throw(‚Äúunreasonable large fee‚Äù) else if i.feeAssetId != unit then throw(‚Äúfee must be in WAVES‚Äù) else true }</code> </pre> <br>  Adem√°s, la protecci√≥n contra el desperdicio de fondos malicioso y sin sentido requiere protecci√≥n contra llamadas autom√°ticas (PoW-captcha) <br><br>  <b>PoW-captcha</b> <br><br>  La idea del captcha de prueba de trabajo no es nueva y ya se ha implementado en varios proyectos, incluidos los implementados sobre la base de WAVES.  La idea es que para la acci√≥n que desperdicia los recursos de nuestro proyecto, la persona que llama tambi√©n debe gastar sus propios recursos, lo que hace que el ataque al agotamiento de los recursos sea bastante costoso.  Para una validaci√≥n muy f√°cil y de bajo costo de que el remitente de la transacci√≥n ha resuelto la tarea PoW, hay una verificaci√≥n para la identificaci√≥n de la transacci√≥n: <br><br>  <i>if take (toBase58String (i.transactionId), 3)! = "123" y luego arrojar ("error en la prueba de trabajo") m√°s</i> <br><br>  Para realizar una transacci√≥n, la persona que llama debe seleccionar dichos par√°metros para que su c√≥digo base58 (id) comience en 123, lo que corresponde a un promedio de un par de decenas de segundos de tiempo de procesador y generalmente es razonable para nuestra tarea.  Si se requiere un PoW m√°s simple o m√°s complejo, entonces la tarea es f√°cil de refinar de una manera obvia. <br><br>  <b>Solicitud de claves de datos por plantilla</b> <br><br>  Para usar blockchain como base de datos, es vital contar con herramientas API para consultar la base de datos como plantillas key-val.  Tal kit de herramientas apareci√≥ a principios de julio de 2019 como el par√°metro <i>? Matches</i> para la solicitud <i>/ direcciones / datos de</i> API REST <i>? Matches = regexp</i> .  Ahora, si necesitamos obtener no una clave y no todas las claves de una aplicaci√≥n web a la vez, sino solo un grupo, entonces podemos hacer una selecci√≥n por el nombre de la clave.  Por ejemplo, en este proyecto, las transacciones de retiro se codifican como <br><br><pre> <code class="plaintext hljs">withdraw_${userAddress}_${txid}</code> </pre> <br>  que le permite obtener una lista de transacciones para retirar fondos para cualquier direcci√≥n dada de acuerdo con la plantilla: <br><br><pre> <code class="plaintext hljs">?matches=withdraw_${userAddress}_.*</code> </pre> <br>  Ahora analizaremos los componentes de la soluci√≥n llave en mano. <br><br>  <b>C√≥digo Vuejs</b> <br><br>  El c√≥digo es una demostraci√≥n funcional cercana a un proyecto real.  Implementa el inicio de sesi√≥n a trav√©s de Waves Keeper y trabaja con la biblioteca affiliate.js, con la ayuda de la cual registra al usuario en el sistema, sondea los datos de las transacciones y tambi√©n le permite retirar los fondos ganados a la cuenta del usuario. <br><br><img src="https://habrastorage.org/webt/ug/dv/e6/ugdve6bg3kaamx7flsyzkaubxma.jpeg" alt="imagen"><br><br>  <b>C√≥digo de paseo</b> <br><br>  Consiste en registrar, financiar y retirar funciones. <br><br>  La funci√≥n de registro se registra con el sistema del usuario.  Tiene dos par√°metros: el referente (direcci√≥n de referencia) y el par√°metro salt, que no se usa en el c√≥digo de funci√≥n, que se necesita para seleccionar la identificaci√≥n de la transacci√≥n (tarea PoW-captcha). <br><br>  La funci√≥n (como las otras funciones de este proyecto) utiliza la t√©cnica de pr√©stamo, el resultado de la funci√≥n es financiar una tarifa por llamar a esta funci√≥n.  Gracias a esta decisi√≥n, el usuario que acaba de crear la billetera puede trabajar inmediatamente con el sistema y no tiene que preocuparse por la cuesti√≥n de comprar o recibir un activo que le permite pagar una tarifa de transacci√≥n. <br><br>  El resultado de la funci√≥n de registro son dos entradas: <br><br><pre> <code class="plaintext hljs">${owner)_referer = referer ${referer}_referral_${owner} = owner</code> </pre> <br>  Esto permite b√∫squedas directas e inversas (referencia de este usuario y todas las referencias de este usuario). <br><br>  Es m√°s probable que la funci√≥n de fondo sea una plantilla para desarrollar una funcionalidad real.  En la forma presentada, toma todos los fondos transferidos por la transacci√≥n y los distribuye a las cuentas de los referentes 1, 2, 3, a la cuenta de "devoluci√≥n de efectivo" y la cuenta de "cambio" (todo lo que queda al distribuir a las cuentas anteriores cae aqu√≠). <br><br>  El reembolso es un medio para estimular al usuario final a participar en el sistema de referencia.  El usuario puede retirar la parte de la comisi√≥n pagada por el sistema en forma de "devoluci√≥n de efectivo" de la misma manera que las recompensas por referencias. <br><br>  Cuando se utiliza el sistema de referencia, la funci√≥n del fondo debe modificarse, incorporarse a la l√≥gica principal de la cuenta inteligente en la que funcionar√° el sistema.  Por ejemplo, si la tarifa de referencia se paga por la apuesta realizada, entonces la funci√≥n del fondo debe integrarse en la l√≥gica donde se realiza la apuesta (o se realiza otra acci√≥n espec√≠fica, por la cual se paga la tarifa).  Esta funci√≥n codifica tres niveles de recompensas de referencia.  Si necesita hacer m√°s o menos niveles, esto tambi√©n se corrige en el c√≥digo.  El porcentaje de la remuneraci√≥n se establece por las constantes de nivel 1-nivel 3, en el c√≥digo se considera como <i>cantidad * nivel / 1000</i> , es decir, el valor 1 corresponde al 0.1% (esto tambi√©n se puede cambiar en el c√≥digo). <br><br>  La llamada a la funci√≥n cambia el saldo de la cuenta y tambi√©n crea entradas con el fin de iniciar sesi√≥n en el formulario: <br><br><pre> <code class="1c hljs">fund_address_txid = address:owner:inc:level:timestamp <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  timestamp ( )     func getTimestamp() = { let block = extract(blockInfoByHeight(height)) toString(block.timestamp) }</code> </pre> <br>  Es decir, el tiempo de transacci√≥n es el tiempo del bloque en el que se encuentra.  Esto es m√°s confiable que el uso de la marca de tiempo de la transacci√≥n en s√≠, especialmente porque no es accesible desde invocable. <br>  La funci√≥n de retiro muestra todas las recompensas acumuladas en la cuenta de usuario.  Crea entradas para fines de registro: <br><br><pre> <code class="plaintext hljs"># withdraw log: withdraw_user_txid=amount:timestamp</code> </pre> <br>  <b>App</b> <br><br>  La parte principal de la aplicaci√≥n es la biblioteca affiliate.js, que es un puente entre los modelos de datos afiliados y la API WAVES NODE REST.  Implementa un nivel de abstracci√≥n independiente del marco (se puede usar cualquiera).  Las funciones activas (registrar, retirar) suponen que Waves Keeper est√° instalado en el sistema, la propia biblioteca no verifica esto. <br><br>  Implementa m√©todos: <br><br><pre> <code class="plaintext hljs">fetchReferralTransactions fetchWithdrawTransactions fetchMyBalance fetchReferrals fetchReferer withdraw register</code> </pre> <br>  La funcionalidad de los m√©todos es obvia por los nombres, los par√°metros y los datos devueltos que se describen en el c√≥digo.  La funci√≥n de registro requiere comentarios adicionales: inicia el ciclo de coincidencia de id de transacci√≥n para que comience en 123. Este es el PoW-captcha descrito anteriormente, que protege contra registros masivos.  La funci√≥n encuentra la transacci√≥n con la identificaci√≥n deseada y luego la firma a trav√©s de Waves Keeper. <br><br>  El programa de afiliaci√≥n de DEX est√° disponible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub.com</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/459590/">https://habr.com/ru/post/459590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../459580/index.html">Sistemas telef√≥nicos virtuales</a></li>
<li><a href="../459582/index.html">Resumen: c√≥mo comprar acciones de compa√±√≠as estadounidenses de Rusia</a></li>
<li><a href="../459584/index.html">Encontr√© un gran programador llamado Steve Wozniak</a></li>
<li><a href="../459586/index.html">Garden v0.10.0: su computadora port√°til no necesita Kubernetes</a></li>
<li><a href="../459588/index.html">No aceptes desarrollar lo que no entiendes</a></li>
<li><a href="../459592/index.html">Tres consejos de gesti√≥n del tiempo para aquellos que lo han intentado todo.</a></li>
<li><a href="../459594/index.html">Leer entre notas: sistema de transferencia de datos dentro de la m√∫sica</a></li>
<li><a href="../459596/index.html">iOS Digest No. 9 (28 de junio - 11 de julio)</a></li>
<li><a href="../459598/index.html">Preguntas frecuentes de SELinux (FAQ)</a></li>
<li><a href="../459602/index.html">Incorporamos el int√©rprete de Lua en el proyecto para el microcontrolador (stm32)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>