<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â™Šï¸ ğŸ‘‡ğŸ¼ ğŸ’ƒğŸ¾ å¦‚ä½•åˆ†æçº¿ç¨‹è½¬å‚¨ â˜ƒï¸ ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ ğŸ‘‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Java Developerè¯¾ç¨‹ç¨‹åºä¸­æœ‰å¾ˆå¤šå…³äºJVMå†…éƒ¨çš„ä¸»é¢˜ã€‚ æˆ‘ä»¬äº†è§£æ”¶é›†ï¼Œå­—èŠ‚ç ï¼Œåƒåœ¾æ”¶é›†å™¨ç­‰çš„å·¥ä½œæœºåˆ¶ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ‚¨çš„æ³¨æ„åŠ›è½¬ç§»åˆ°ä¸€ç¯‡æœ‰å…³çº¿ç¨‹è½¬å‚¨çš„ç›¸å½“æœ‰è¶£çš„æ–‡ç« çš„ç¿»è¯‘ä¸Šã€‚ å®ƒæ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è·å¾—ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚ 

 æ˜¯å¦æƒ³å­¦ä¹ å¦‚ä½•åˆ†æçº¿ç¨‹è½¬å‚¨ï¼Ÿ æ·±å…¥äº†è§£å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹è½¬å‚¨ä»¥åŠä»¥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¦‚ä½•åˆ†æçº¿ç¨‹è½¬å‚¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/427513/">  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Java Developer</a>è¯¾ç¨‹ç¨‹åºä¸­æœ‰å¾ˆå¤šå…³äºJVMå†…éƒ¨çš„ä¸»é¢˜ã€‚</i>  <i>æˆ‘ä»¬äº†è§£æ”¶é›†ï¼Œå­—èŠ‚ç ï¼Œåƒåœ¾æ”¶é›†å™¨ç­‰çš„å·¥ä½œæœºåˆ¶ã€‚</i>  <i>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ‚¨çš„æ³¨æ„åŠ›è½¬ç§»åˆ°ä¸€ç¯‡æœ‰å…³çº¿ç¨‹è½¬å‚¨çš„ç›¸å½“æœ‰è¶£çš„æ–‡ç« çš„ç¿»è¯‘ä¸Šã€‚</i>  <i>å®ƒæ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è·å¾—ä»¥åŠå¦‚ä½•ä½¿ç”¨ã€‚</i> <br><br> æ˜¯å¦æƒ³å­¦ä¹ å¦‚ä½•åˆ†æçº¿ç¨‹è½¬å‚¨ï¼Ÿ æ·±å…¥äº†è§£å¦‚ä½•åœ¨Javaä¸­è·å–çº¿ç¨‹è½¬å‚¨ä»¥åŠä»¥åå¦‚ä½•ä½¿ç”¨å®ƒã€‚ <br><a name="habracut"></a><br> å¤§å¤šæ•°ç°ä»£Javaåº”ç”¨ç¨‹åºéƒ½æ˜¯å¤šçº¿ç¨‹çš„ã€‚ å¤šçº¿ç¨‹å¯ä»¥æ˜¾ç€æ‰©å±•åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆä¼šå¸¦æ¥æå¤§çš„å¤æ‚æ€§ã€‚ <br><br> åœ¨å•çº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰èµ„æºï¼ˆå…±äº«å†…å­˜ï¼Œè¾“å…¥/è¾“å‡ºæ“ä½œç­‰ï¼‰è€Œæ— éœ€åŒæ­¥ï¼Œå› ä¸º åœ¨ä»»ä½•ç»™å®šæ—¶é—´ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨è¯¥èµ„æºã€‚ <br><br> å¯¹äºå¤šçº¿ç¨‹åº”ç”¨ç¨‹åºï¼Œå½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„ï¼ˆé€šå¸¸ä¸æ­¢ä¸€ä¸ªï¼‰æ ¸å¿ƒå¤„ç†å™¨ï¼ˆCPUï¼‰æ—¶ï¼Œæœ‰å¿…è¦åœ¨ä½¿ç¨‹åºå¤æ‚åŒ–å’Œå¯èƒ½æé«˜æ€§èƒ½ä¹‹é—´æ‰¾åˆ°æŠ˜è¡·æ–¹æ¡ˆã€‚ å¦‚æœä¸€åˆ‡éƒ½æ­£ç¡®å®Œæˆï¼Œåˆ™ä½¿ç”¨å¤šçº¿ç¨‹ï¼ˆåœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é˜¿å§†è¾¾å°”å®šå¾‹ä¸­</a>æ­£å¼åŒ–ï¼‰ï¼Œå¯ä»¥æ˜¾ç€æé«˜åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚ ä½†æ˜¯ï¼Œå¿…é¡»è®°ä½è¦åŒæ—¶æä¾›å¤šä¸ªæµå¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¸å¦‚Springä¹‹ç±»çš„æ¡†æ¶å°è£…äº†çº¿ç¨‹ï¼Œå¹¶å‘ç”¨æˆ·éšè—äº†è®¸å¤šæŠ€æœ¯ç»†èŠ‚ã€‚ ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨ç°ä»£å¤æ‚æ¡†æ¶çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œå¹¶ä¸”ä½œä¸ºç”¨æˆ·çš„æˆ‘ä»¬å°†é‡åˆ°éš¾ä»¥è§£å†³çš„å¤šçº¿ç¨‹é”™è¯¯ã€‚ <br><br> å¹¸è¿çš„æ˜¯ï¼ŒJavaé…å¤‡äº†ä¸€ç§ç‰¹æ®Šçš„æœºåˆ¶ï¼Œå¯ä»¥åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´è·å–æœ‰å…³æ‰€æœ‰çº¿ç¨‹çš„å½“å‰çŠ¶æ€çš„ä¿¡æ¯-è¿™æ˜¯çº¿ç¨‹è½¬å‚¨ï¼ˆä¸€ç§å¿«ç…§ï¼‰ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä¸ºå®é™…å¤§å°çš„åº”ç”¨ç¨‹åºè·å–çº¿ç¨‹è½¬å‚¨ï¼Œä»¥åŠå¦‚ä½•åˆ†ææ­¤è½¬å‚¨ã€‚ <br><br> å‡å®šè¯»è€…å…·æœ‰æœ‰å…³å¤šçº¿ç¨‹ç¼–ç¨‹çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¹¶ä¸”äº†è§£çº¿ç¨‹åŒæ­¥å’Œå…±äº«èµ„æºä½¿ç”¨çš„é—®é¢˜ã€‚ ä½†æ˜¯ï¼Œåˆ·æ–°ä¸€äº›åŸºæœ¬æœ¯è¯­å’Œæ¦‚å¿µå¹¶ä¸æ˜¯å¤šä½™çš„ã€‚ <br><br><h4> åŸºæœ¬æœ¯è¯­ </h4><br> ä¹ä¸€çœ‹ï¼ŒJavaçº¿ç¨‹è½¬å‚¨å¯èƒ½çœ‹èµ·æ¥åƒâ€œä¸­æ–‡å­—æ¯â€ï¼Œä»¥ä¸‹æ¦‚å¿µæ˜¯ç†è§£å®ƒçš„å…³é”®ã€‚ é€šå¸¸ï¼Œè®©æˆ‘ä»¬é‡å¤å¤šçº¿ç¨‹çš„åŸºæœ¬æœ¯è¯­ï¼Œè¿™äº›æœ¯è¯­å°†ç”¨äºåˆ†æè½¬å‚¨ã€‚ <br><br><ul><li> <strong>çº¿ç¨‹</strong>æˆ–çº¿ç¨‹æ˜¯ç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ç®¡ç†çš„ç¦»æ•£å¤šçº¿ç¨‹å•å…ƒã€‚  JVMçº¿ç¨‹å¯¹åº”äºæ“ä½œç³»ç»Ÿï¼ˆOSï¼‰ä¸­çš„çº¿ç¨‹-æœ¬æœºçº¿ç¨‹ï¼Œå®ƒä»¬å®ç°ä»£ç æ‰§è¡Œæœºåˆ¶ã€‚ <br><br> æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å”¯ä¸€çš„æ ‡è¯†ç¬¦å’Œåç§°ã€‚ æµå¯ä»¥æ˜¯â€œæ¶é­”â€å’Œâ€œä¸æ˜¯æ¶é­”â€ã€‚ <br><br> å½“æ‰€æœ‰éå®ˆæŠ¤è¿›ç¨‹çº¿ç¨‹ç»ˆæ­¢æˆ–<i>è°ƒç”¨Runtime.exit</i>æ–¹æ³•æ—¶ï¼Œç¨‹åºç»ˆæ­¢ã€‚ å·¥ä½œçš„â€œå®ˆæŠ¤ç¨‹åºâ€ä¸ä¼šå½±å“ç¨‹åºçš„å®Œæˆã€‚ å³  JVMç­‰å¾…æ‰€æœ‰â€œéå®ˆæŠ¤ç¨‹åºâ€å®Œæˆå¹¶å…³é—­ï¼›ä»–ä»¬æ²¡æœ‰æ³¨æ„â€œéå®ˆæŠ¤ç¨‹åºâ€ã€‚ <br><br> æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Threadç±»</a>æ–‡æ¡£ã€‚ <br> æµå¯èƒ½å¤„äºä»¥ä¸‹çŠ¶æ€ä¹‹ä¸€ï¼š <br><br><ul><li>  <strong>æ´»åŠ¨çº¿ç¨‹</strong>æˆ–â€œæ´»åŠ¨â€çº¿ç¨‹-å¯ä»¥å®ŒæˆæŸäº›å·¥ä½œçš„çº¿ç¨‹ï¼ˆæ­£å¸¸çŠ¶æ€ï¼‰ã€‚ </li><li>  <strong>é˜»å¡çº¿ç¨‹</strong>æˆ–â€œé˜»å¡â€-è¯•å›¾è¿›å…¥åŒæ­¥éƒ¨åˆ†ï¼ˆå·²åŒæ­¥ï¼‰çš„çº¿ç¨‹ï¼Œä½†å¦ä¸€ä¸ªçº¿ç¨‹å·²ç»è®¾æ³•å…ˆè¿›å…¥æ­¤å—ï¼Œå¹¶ä¸”éšåæ‰€æœ‰å°è¯•è¿›å…¥åŒä¸€å—çš„çº¿ç¨‹å‡è¢«é˜»å¡ã€‚ </li><li>  <strong>ç­‰å¾…çº¿ç¨‹</strong>æˆ–â€œç­‰å¾…â€-ä¸€ä¸ªçº¿ç¨‹ï¼Œè°ƒç”¨äº†<i>wait</i>æ–¹æ³•ï¼ˆå¯èƒ½å¸¦æœ‰è¶…æ—¶ï¼‰ï¼Œç°åœ¨æ­£åœ¨ç­‰å¾…å¦ä¸€ä¸ªæ–¹æ³•åœ¨åŒä¸€å¯¹è±¡ä¸Šæ‰§è¡Œ<i>notify</i>æˆ–<i>nonifyAll</i> ã€‚ <br><br> è¯·æ³¨æ„ï¼Œå¦‚æœçº¿ç¨‹è°ƒç”¨å¸¦æœ‰è¶…æ—¶çš„ç­‰å¾…å¹¶ä¸”è¯¥è¶…æ—¶å·²è¿‡æœŸï¼Œåˆ™è¯¥çº¿ç¨‹ä¸è¢«è§†ä¸ºâ€œç­‰å¾…â€ã€‚ </li><li>  <strong>æ­£åœ¨ä¼‘çœ çš„çº¿ç¨‹</strong>æˆ–â€œæ­£åœ¨ä¼‘çœ â€çš„çº¿ç¨‹-å½“å‰æœªè¿è¡Œçš„çº¿ç¨‹ï¼Œå› ä¸º æ‰§è¡ŒThread.sleepæ–¹æ³•ï¼ˆæŒ‡ç¤ºâ€œç¡çœ â€çš„æŒç»­æ—¶é—´ï¼‰ã€‚ </li></ul></li><li>  <strong>Monitor</strong>æ˜¯JVMä½¿ç”¨çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºæä¾›å¯¹å•ä¸ªå¯¹è±¡çš„å¤šçº¿ç¨‹è®¿é—®ã€‚ è¯¥æœºåˆ¶ä½¿ç”¨ç‰¹æ®Šçš„<i>syncedå…³é”®å­—</i>å¯åŠ¨ã€‚ <br><br>  Javaä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå¯ä»¥ä¸çº¿ç¨‹åŒæ­¥çš„ç›‘è§†å™¨ï¼Œå³ è®¾ç½®ä¸€ä¸ªé”ï¼Œä»¥ç¡®ä¿åœ¨é‡Šæ”¾è¯¥é”ä¹‹å‰ï¼Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹å¯ä»¥è®¿é—®è¯¥å¯¹è±¡ï¼Œå³ çº¿ç¨‹-é”çš„æ‰€æœ‰è€…ä¸ä¼šé€€å‡º<i>åŒæ­¥</i>å—ã€‚ <br><br> æœ‰å…³<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ›´å¤šä¿¡æ¯ï¼Œ</a>è¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Javaè¯­è¨€è§„èŒƒï¼ˆJLSï¼‰</a>çš„â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŒæ­¥â€éƒ¨åˆ†ï¼ˆ17.1ï¼‰</a> ã€‚ <br></li><li>  <strong>æ­»é”</strong>æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¾‹å¦‚Aï¼‰é˜»å¡äº†ä¸€ä¸ªèµ„æºï¼Œå®ƒéœ€è¦å¦ä¸€ä¸ªè¢«å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¾‹å¦‚Bï¼‰æ‰€é˜»å¡çš„èµ„æºã€‚æµBä¸ä¼šé‡Šæ”¾è¯¥èµ„æºï¼Œå› ä¸º ä¸ºäº†å®ŒæˆæŸä¸ªæ“ä½œï¼Œä»–éœ€è¦ä¸€ä¸ªè¢«çº¿ç¨‹Aé˜»å¡çš„èµ„æºã€‚äº‹å®è¯æ˜ï¼Œçº¿ç¨‹Aæ­£åœ¨ç­‰å¾…èµ„æºè¢«çº¿ç¨‹Bè§£é”ï¼Œåè€…æ­£åœ¨ç­‰å¾…å¦ä¸€ä¸ªèµ„æºè¢«çº¿ç¨‹Aè§£é”ã€‚å› æ­¤ï¼Œçº¿ç¨‹æ­£åœ¨äº’ç›¸ç­‰å¾…ã€‚ ç»“æœï¼Œæ•´ä¸ªç¨‹åºæŒ‚èµ·å¹¶ç­‰å¾…çº¿ç¨‹ä»¥æŸç§æ–¹å¼è§£é”å¹¶ç»§ç»­å·¥ä½œã€‚ æ­»é”ä¸­å¯èƒ½æœ‰è®¸å¤šçº¿ç¨‹ã€‚ è¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œç”¨é¤å“²å­¦å®¶çš„é—®é¢˜â€ã€‚</a> <br><br><img src="https://habrastorage.org/webt/8t/ll/jb/8tlljb_n-e80_dk_0uayobgil_s.png"><br></li><li>  <strong>æ´»é”</strong>æ˜¯ä¸€ç§æƒ…å†µï¼Œçº¿ç¨‹Aè¿«ä½¿çº¿ç¨‹Bæ‰§è¡ŒæŸäº›æ“ä½œï¼Œè¿™åˆä½¿çº¿ç¨‹Aæ‰§è¡Œåˆå§‹æ“ä½œï¼Œè¿™åˆå¯¼è‡´çº¿ç¨‹Bè¿›è¡Œæ“ä½œã€‚è·å¾—äº†å¾ªç¯ä¾èµ–æ€§ã€‚ å¯ä»¥æƒ³è±¡è¿™æ˜¯ä¸€æ¡ç‹—è¿½å°¾ã€‚ ä¸<i>æ­»é”</i>ç±»ä¼¼ï¼Œåœ¨Livelockæƒ…å†µä¸‹ï¼Œç¨‹åºä¸ä¼šè¿›å±•ï¼Œå³ ä¸ä¼šæ‰§è¡Œæœ‰ç”¨çš„æ“ä½œï¼Œä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ä¼šé˜»å¡çº¿ç¨‹ã€‚ <br></li></ul><br> æ‰€æä¾›çš„æœ¯è¯­åœ¨æè¿°å¤šçº¿ç¨‹é¢†åŸŸæ—¶å¹¶ä¸è¯¦å°½ï¼Œä½†è¿™è¶³ä»¥å¼€å§‹åˆ†æçº¿ç¨‹è½¬å‚¨ã€‚ <br><br> å¯åœ¨ä»¥ä¸‹èµ„æºä¸­æ‰¾åˆ°æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ã€Š JLS</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Javaå¹¶å‘å®è·µã€‹</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬17èŠ‚</a> <br><br> ä½¿ç”¨è¿™äº›å…³äºJavaä¸­æµç¨‹çš„ç®€å•æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæµ‹è¯•åº”ç”¨ç¨‹åºã€‚ å¯¹äºæ­¤åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†ç¼–è¯‘çº¿ç¨‹è½¬å‚¨ã€‚ æˆ‘ä»¬å°†åˆ†æäº§ç”Ÿçš„è½¬å‚¨ï¼Œå¹¶æå–æœ‰å…³å½“å‰åº”ç”¨ç¨‹åºæµçš„æœ‰ç”¨ä¿¡æ¯ã€‚ <br><br><h4> åˆ›å»ºä¸€ä¸ªç¤ºä¾‹ç¨‹åº </h4><br> åœ¨åˆ›å»ºçº¿ç¨‹è½¬å‚¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¼€å‘ä¸€ä¸ªJavaåº”ç”¨ç¨‹åºã€‚ ä¼ ç»Ÿçš„â€œä½ å¥½ï¼Œä¸–ç•Œï¼â€ å¯¹äºæˆ‘ä»¬çš„ç›®çš„è€Œè¨€å¤ªç®€å•äº†ï¼Œè€Œåº”ç”¨ç¨‹åºçš„ä¸­å‹è½¬å‚¨å¯èƒ½å¤ªå¤æ‚è€Œæ— æ³•æ¼”ç¤ºã€‚ åŸºäºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç›¸å½“ç®€å•çš„åº”ç”¨ç¨‹åºï¼Œåœ¨å…¶ä¸­åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ã€‚ çº¿ç¨‹é™·å…¥åƒµå±€ï¼š <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeadlockProgram</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Object resourceA = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); Object resourceB = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); Thread threadLockingResourceAFirst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DeadlockRunnable(resourceA, resourceB)); Thread threadLockingResourceBFirst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DeadlockRunnable(resourceB, resourceA)); threadLockingResourceAFirst.start(); Thread.sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); threadLockingResourceBFirst.start(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeadlockRunnable</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Runnable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Object firstResource; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Object secondResource; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DeadlockRunnable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object firstResource, Object secondResource)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstResource = firstResource; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondResource = secondResource; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span>(firstResource) { printLockedResource(firstResource); Thread.sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span>(secondResource) { printLockedResource(secondResource); } } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException e) { System.out.println(<span class="hljs-string"><span class="hljs-string">"Exception occurred: "</span></span> + e); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printLockedResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object resource)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(Thread.currentThread().getName() + <span class="hljs-string"><span class="hljs-string">": locked resource -&gt; "</span></span> + resource); } } }</code> </pre> <br> è¯¥ç¨‹åºåˆ›å»ºä¸¤ä¸ªèµ„æºï¼šresourceAå’ŒresourceBï¼Œå¹¶å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹ï¼šthreadLockingResourceAFirstå’ŒthreadLockingResourceBFirstï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å½¼æ­¤é˜»å¡ã€‚ <br><br> æ­»é”çš„åŸå› æ˜¯çº¿ç¨‹å¯¹èµ„æºçš„â€œäº¤å‰â€é˜»å¡ã€‚ <br><br> å‘ç”Ÿæ­»é”çš„åŸå› æ˜¯è¯•å›¾â€œç›¸äº’â€å ç”¨èµ„æºï¼Œå³  threadLockingResourceAFirstçº¿ç¨‹æ•è·resourceAèµ„æºï¼ŒthreadLockingResourceBFirstçº¿ç¨‹æ•è·resourceBèµ„æºã€‚ ä¹‹åï¼ŒthreadLockingResourceAFirståœ¨ä¸é‡Šæ”¾èµ„æºçš„æƒ…å†µä¸‹å°è¯•æ•è·resourceBï¼ŒthreadLockingResourceBFirståœ¨ä¸é‡Šæ”¾èµ„æºçš„æƒ…å†µä¸‹å°è¯•æ•è·resourceAã€‚ ç»“æœï¼Œçº¿ç¨‹è¢«é˜»å¡ã€‚ æ·»åŠ äº†1så»¶è¿Ÿä»¥ä¿è¯é˜»å¡ã€‚ çº¿ç¨‹æ­£åœ¨ç­‰å¾…é‡Šæ”¾å¿…è¦çš„èµ„æºï¼Œä½†è¿™æ°¸è¿œä¸ä¼šå‘ç”Ÿã€‚ <br><br> ç¨‹åºçš„è¾“å‡ºå°†å¦‚ä¸‹æ‰€ç¤ºï¼ˆæ¯æ¬¡å¯åŠ¨æ—¶java.lang.Object @ä¹‹åçš„æ•°å­—å°†ä¸åŒï¼‰ï¼š <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Thread-0</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">locked</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">resource</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>&gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.lang</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Object</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">149bc794</span></span> Thread-<span class="hljs-number"><span class="hljs-number">1</span></span>: locked resource -&gt; java.lang.Object@<span class="hljs-number"><span class="hljs-number">17</span></span>c10009</code> </pre> <br> è¿™äº›æ¶ˆæ¯è¾“å‡ºåï¼Œç¨‹åºçœ‹èµ·æ¥åƒæ­£åœ¨è¿è¡Œï¼ˆæ‰§è¡Œè¯¥ç¨‹åºçš„è¿‡ç¨‹å°šæœªå®Œæˆï¼‰ï¼Œè€Œç¨‹åºåˆ™ä¸æ‰§è¡Œä»»ä½•å·¥ä½œã€‚ è¿™å°±æ˜¯å®è·µä¸­çš„åƒµå±€ã€‚ è¦è§£å†³è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªè¸©è¸è½¬å‚¨å¹¶åˆ†æçº¿ç¨‹çš„çŠ¶æ€ã€‚ <br><br><h4> çº¿ç¨‹è½¬å‚¨ç”Ÿæˆ </h4><br> å®é™…ä¸Šï¼Œåˆ›å»ºçº¿ç¨‹è½¬å‚¨æ—¶Javaç¨‹åºå¯èƒ½ä¼šå´©æºƒã€‚ ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œåœ¨å‡ºç°æ­»é”çš„æƒ…å†µä¸‹ï¼‰ï¼Œè¯¥ç¨‹åºä¸ä¼šç»“æŸï¼Œå¹¶ä¸”ä¸ä¼šåˆ›å»ºçº¿ç¨‹è½¬å‚¨ï¼Œè€Œåªæ˜¯æŒ‚èµ·ã€‚ è¦åˆ›å»ºæ­¤ç±»æŒ‚èµ·ç¨‹åºçš„è½¬å‚¨ï¼Œé¦–å…ˆï¼Œæ‚¨éœ€è¦æ‰¾å‡ºç¨‹åºè¿›ç¨‹çš„æ ‡è¯†ç¬¦ï¼Œå³ è¿›ç¨‹IDï¼ˆPIDï¼‰ã€‚ ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨JVM Process Statusï¼ˆJPSï¼‰å®ç”¨ç¨‹åºï¼Œè¯¥å®ç”¨ç¨‹åºä»ç‰ˆæœ¬7å¼€å§‹ï¼Œæ˜¯Java Development Kitï¼ˆJDKï¼‰çš„ä¸€éƒ¨åˆ†ã€‚ è¦æ‰¾åˆ°æˆ‘ä»¬æŒ‚èµ·çš„ç¨‹åºçš„è¿›ç¨‹PIDï¼Œæˆ‘ä»¬åªéœ€åœ¨ç»ˆç«¯ï¼ˆWindowsæˆ–Linuxï¼‰ä¸­æ‰§è¡Œjpsï¼š <br><br><pre> <code class="hljs ruby">$ jps <span class="hljs-number"><span class="hljs-number">11568</span></span> DeadlockProgram <span class="hljs-number"><span class="hljs-number">15584</span></span> Jps <span class="hljs-number"><span class="hljs-number">15636</span></span></code> </pre> <br> ç¬¬ä¸€åˆ—æ˜¯æ­£åœ¨è¿è¡Œçš„Javaè¿›ç¨‹çš„æœ¬åœ°è™šæ‹Ÿæœºçš„æ ‡è¯†ç¬¦ï¼ˆæœ¬åœ°VM IDï¼Œå³lvmidï¼‰ã€‚ åœ¨æœ¬åœ°JVMçš„ä¸Šä¸‹æ–‡ä¸­ï¼ŒlvmidæŒ‡å‘Javaè¿›ç¨‹çš„PIDã€‚ <br><br> åº”å½“æ³¨æ„ï¼Œè¯¥å€¼å¯èƒ½ä¸ä¸Šè¿°å€¼ä¸åŒã€‚ ç¬¬äºŒåˆ—æ˜¯åº”ç”¨ç¨‹åºçš„åç§°ï¼Œå®ƒå¯ä»¥æŒ‡å‘ä¸»ç±»ï¼Œjaræ–‡ä»¶çš„åç§°ï¼Œæˆ–è€…ç­‰äºâ€œ Unknownâ€ã€‚ è¿™å®Œå…¨å–å†³äºåº”ç”¨ç¨‹åºçš„å¯åŠ¨æ–¹å¼ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåº”ç”¨ç¨‹åºåç§°DeadlockProgramæ˜¯ç¨‹åºå¯åŠ¨æ—¶å¯åŠ¨çš„ä¸»è¦ç±»çš„åç§°ã€‚ åœ¨ä¸Šé¢çš„ç¨‹åº11568çš„PIDçš„ç¤ºä¾‹ä¸­ï¼Œæ­¤ä¿¡æ¯è¶³ä»¥ç”Ÿæˆçº¿ç¨‹è½¬å‚¨ã€‚ è¦ç”Ÿæˆè½¬å‚¨ï¼Œæˆ‘ä»¬å°†ä»ç‰ˆæœ¬7å¼€å§‹ä½¿ç”¨<strong>jstack</strong>å®ç”¨ç¨‹åºï¼Œå®ƒæ˜¯JDKçš„ä¸€éƒ¨åˆ†ã€‚è¦è·å–è½¬å‚¨ï¼Œæˆ‘ä»¬å°†ç¨‹åºçš„PID <strong>ä¼ é€’</strong>ç»™<strong>jstack</strong>å¹¶æŒ‡å®š-læ ‡å¿—ï¼ˆåˆ›å»ºé•¿åˆ—è¡¨ï¼‰ã€‚ è¯¥å®ç”¨ç¨‹åºçš„è¾“å‡ºå°†é‡å®šå‘åˆ°æ–‡æœ¬æ–‡ä»¶ï¼Œå³  thread_dump.txtï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">jstack</span></span> -l <span class="hljs-number"><span class="hljs-number">11568</span></span> &gt; thread_dump.txt</code> </pre> <br> ç”Ÿæˆçš„thread_dump.txtæ–‡ä»¶åŒ…å«å·²æŒ‚èµ·ç¨‹åºçš„çº¿ç¨‹è½¬å‚¨ï¼Œå¹¶åŒ…å«ç”¨äºè¯Šæ–­æ­»é”åŸå› çš„é‡è¦ä¿¡æ¯ã€‚ <br><br> å¦‚æœJDKåœ¨ç‰ˆæœ¬7ä¹‹å‰ä½¿ç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨Linuxå®ç”¨ç¨‹åº-å¸¦æœ‰-3æ ‡å¿—çš„<strong>kill</strong>ç”Ÿæˆè½¬å‚¨ã€‚ è°ƒç”¨kill -3å°†å‘ç¨‹åºå‘é€SIGQUITä¿¡å·ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè°ƒç”¨å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">kill</span></span> <span class="hljs-number"><span class="hljs-number">-3</span></span> <span class="hljs-number"><span class="hljs-number">11568</span></span></code> </pre> <br><h4> ç®€å•çº¿ç¨‹è½¬å‚¨åˆ†æ </h4><br> æ‰“å¼€thread_dump.txtæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š <br><br><pre> 2018-06-19 16:44:44
å…¨çº¿ç¨‹è½¬å‚¨Java HotSpotï¼ˆTMï¼‰64ä½æœåŠ¡å™¨VMï¼ˆ10.0.1 + 10æ··åˆæ¨¡å¼ï¼‰ï¼š
çº¿ç¨‹ç±»SMRä¿¡æ¯ï¼š
 _java_thread_list = 0x00000250e5488a00ï¼Œé•¿åº¦= 13ï¼Œå…ƒç´ = {
 0x00000250e4979000ã€0x00000250e4982800ã€0x00000250e52f2800ã€0x00000250e4992800ï¼Œ
 0x00000250e4995800ã€0x00000250e49a5800ã€0x00000250e49ae800ã€0x00000250e5324000ï¼Œ
 0x00000250e54cd800ã€0x00000250e54cf000ã€0x00000250e54d1800ã€0x00000250e54d2000ï¼Œ
 0x00000250e54d0800
 }
 â€œå¼•ç”¨å¤„ç†ç¨‹åºâ€ï¼ƒ2å®ˆæŠ¤ç¨‹åºprio = 10 os_prio = 2 tid = 0x00000250e4979000 nid = 0x3c28ç­‰å¾…æ¡ä»¶[0x000000b82a9ff000]
    java.lang.Thread.Stateï¼šRUNNABLE
    åœ¨java.lang.ref.Reference.waitForReferencePendingListï¼ˆjava.base@10.0.1/Nativeæ–¹æ³•ï¼‰
    åœ¨java.lang.ref.Reference.processPendingReferencesï¼ˆjava.base@10.0.1/Reference.javaï¼š174ï¼‰
    åœ¨java.lang.ref.Reference.access $ 000ï¼ˆjava.base@10.0.1/Reference.javaï¼š44ï¼‰
    åœ¨java.lang.ref.Reference $ ReferenceHandler.runï¼ˆjava.base@10.0.1/Reference.javaï¼š138ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œæœ€ç»ˆåŒ–å™¨â€ï¼ƒ3å®ˆæŠ¤ç¨‹åºprio = 8 os_prio = 1 tid = 0x00000250e4982800 nid = 0x2a54 in Object.waitï¼ˆï¼‰[0x000000b82aaff000]
    java.lang.Thread.Stateï¼šç­‰å¾…ï¼ˆåœ¨å¯¹è±¡ç›‘è§†å™¨ä¸Šï¼‰
    åœ¨java.lang.Object.waitï¼ˆjava.base@10.0.1/Nativeæ–¹æ³•ï¼‰
     -ç­‰å¾…&lt;0x0000000089509410&gt;ï¼ˆjava.lang.ref.ReferenceQueue $ Lockï¼‰
    åœ¨java.lang.ref.ReferenceQueue.removeï¼ˆjava.base@10.0.1/ReferenceQueue.javaï¼š151ï¼‰
     -ç­‰å¾…é‡æ–°é”å®šwaitï¼ˆï¼‰&lt;0x0000000089509410&gt;ï¼ˆjava.lang.ref.ReferenceQueue $ Lockï¼‰
    åœ¨java.lang.ref.ReferenceQueue.removeï¼ˆjava.base@10.0.1/ReferenceQueue.javaï¼š172ï¼‰
    åœ¨java.lang.ref.Finalizer $ FinalizerThread.runï¼ˆjava.base@10.0.1/Finalizer.javaï¼š216ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œä¿¡å·è°ƒåº¦ç¨‹åºâ€ï¼ƒ4å®ˆæŠ¤ç¨‹åºprio = 9 os_prio = 2 tid = 0x00000250e52f2800 nid = 0x2184å¯è¿è¡Œ[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œé™„åŠ ä¾¦å¬å™¨â€ï¼ƒ5å®ˆæŠ¤ç¨‹åºprio = 5 os_prio = 2 tid = 0x00000250e4992800 nid = 0x1624ç­‰å¾…æ¡ä»¶[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ C2 CompilerThread0â€ï¼ƒ6å®ˆæŠ¤ç¨‹åºprio = 9 os_prio = 2 tid = 0x00000250e4995800 nid = 0x4198ç­‰å¾…æ¡ä»¶[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   æ²¡æœ‰ç¼–è¯‘ä»»åŠ¡
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ C2 CompilerThread1â€ï¼ƒ7å®ˆæŠ¤ç¨‹åºprio = 9 os_prio = 2 tid = 0x00000250e49a5800 nid = 0x3b98ç­‰å¾…æ¡ä»¶[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   æ²¡æœ‰ç¼–è¯‘ä»»åŠ¡
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ C1 CompilerThread2â€ï¼ƒ8å®ˆæŠ¤ç¨‹åºprio = 9 os_prio = 2 tid = 0x00000250e49ae800 nid = 0x1a84ç­‰å¾…æ¡ä»¶[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   æ²¡æœ‰ç¼–è¯‘ä»»åŠ¡
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œæ¸…é™¤çº¿ç¨‹â€ï¼ƒ9å®ˆæŠ¤ç¨‹åºprio = 9 os_prio = 2 tid = 0x00000250e5324000 nid = 0x5f0å¯è¿è¡Œ[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œæœåŠ¡çº¿ç¨‹â€ï¼ƒ10å®ˆæŠ¤ç¨‹åºprio = 9 os_prio = 0 tid = 0x00000250e54cd800 nid = 0x169cå¯è¿è¡Œ[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ Common-Cleanerâ€ï¼ƒ11å®ˆæŠ¤ç¨‹åºprio = 8 os_prio = 1 tid = 0x00000250e54cf000 nid = 0x1610 in Object.waitï¼ˆï¼‰[0x000000b82b2fe000]
    java.lang.Thread.Stateï¼šTIMED_WAITINGï¼ˆåœ¨å¯¹è±¡ç›‘è§†å™¨ä¸Šï¼‰
    åœ¨java.lang.Object.waitï¼ˆjava.base@10.0.1/Nativeæ–¹æ³•ï¼‰
     -ç­‰å¾…&lt;0x000000008943e600&gt;ï¼ˆjava.lang.ref.ReferenceQueue $ Lockï¼‰
    åœ¨java.lang.ref.ReferenceQueue.removeï¼ˆjava.base@10.0.1/ReferenceQueue.javaï¼š151ï¼‰
     -ç­‰å¾…é‡æ–°é”å®šwaitï¼ˆï¼‰&lt;0x000000008943e600&gt;ï¼ˆjava.lang.ref.ReferenceQueue $ Lockï¼‰
    åœ¨jdk.internal.ref.CleanerImpl.runï¼ˆjava.base@10.0.1/CleanerImpl.javaï¼š148ï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
    åœ¨jdk.internal.misc.InnocuousThread.runï¼ˆjava.base@10.0.1/InnocuousThread.javaï¼š134ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œçº¿ç¨‹-0â€ï¼ƒ12 prio = 5 os_prio = 0 tid = 0x00000250e54d1800 nid = 0xdecç­‰å¾…ç›‘è§†å™¨æ¡ç›®[0x000000b82b4ff000]
    java.lang.Thread.Stateï¼šå·²é˜»æ­¢ï¼ˆåœ¨å¯¹è±¡ç›‘è§†å™¨ä¸Šï¼‰
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ Thread-1â€ï¼ƒ13 prio = 5 os_prio = 0 tid = 0x00000250e54d2000 nid = 0x415cç­‰å¾…ç›‘è§†å™¨æ¡ç›®[0x000000b82b5ff000]
    java.lang.Thread.Stateï¼šå·²é˜»æ­¢ï¼ˆåœ¨å¯¹è±¡ç›‘è§†å™¨ä¸Šï¼‰
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ DestroyJavaVMâ€ï¼ƒ14 prio = 5 os_prio = 0 tid = 0x00000250e54d0800 nid = 0x2b8cç­‰å¾…æ¡ä»¶[0x0000000000000000]
    java.lang.Thread.Stateï¼šRUNNABLE
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
 â€œ VMçº¿ç¨‹â€ os_prio = 2 tid = 0x00000250e496d800 nid = 0x1920å¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹å·0â€ os_prio = 2 tid = 0x00000250c35b5800 nid = 0x310cå¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹ï¼ƒ1â€ os_prio = 2 tid = 0x00000250c35b8000 nid = 0x12b4å¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹ï¼ƒ2â€ os_prio = 2 tid = 0x00000250c35ba800 nid = 0x43f8å¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹ï¼ƒ3â€ os_prio = 2 tid = 0x00000250c35c0800 nid = 0x20c0å¯è¿è¡Œ  
 â€œ G1ä¸»æ ‡è®°â€ os_prio = 2 tid = 0x00000250c3633000 nid = 0x4068å¯è¿è¡Œ  
 â€œ G1 Concï¼ƒ0â€ os_prio = 2 tid = 0x00000250c3636000 nid = 0x3e28å¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ0â€ os_prio = 2 tid = 0x00000250c367e000 nid = 0x3c0cå¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ1â€ os_prio = 2 tid = 0x00000250e47fb800 nid = 0x3890å¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ2â€ os_prio = 2 tid = 0x00000250e47fc000 nid = 0x32a8å¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ3â€ os_prio = 2 tid = 0x00000250e47fd800 nid = 0x3d00å¯è¿è¡Œ  
 â€œ G1 Young RemSeté‡‡æ ·â€ os_prio = 2 tid = 0x00000250e4800800 nid = 0xef4å¯è¿è¡Œ  
 â€œ VMå®šæœŸä»»åŠ¡çº¿ç¨‹â€ os_prio = 2 tid = 0x00000250e54d6800 nid = 0x3468ç­‰å¾…æ¡ä»¶  
 JNIå…¨çƒå‚è€ƒï¼š2
å‘ç°äº†ä¸€ä¸ªJavaçº§æ­»é”ï¼š
 ==============================
 â€œçº¿ç¨‹-0â€ï¼š
  ç­‰å¾…é”å®šç›‘è§†å™¨0x00000250e4982480ï¼ˆå¯¹è±¡0x00000000894465b0ï¼Œä¸€ä¸ªjava.lang.Objectï¼‰ï¼Œ
  ç”±â€œ Thread-1â€æŒæœ‰
 â€œçº¿ç¨‹1â€ï¼š
  ç­‰å¾…é”å®šç›‘è§†å™¨0x00000250e4982380ï¼ˆå¯¹è±¡0x00000000894465a0ï¼Œä¸€ä¸ªjava.lang.Objectï¼‰ï¼Œ
  ç”±â€œçº¿ç¨‹-0â€æŒæœ‰
ä¸Šé¢åˆ—å‡ºçš„çº¿ç¨‹çš„Javaå †æ ˆä¿¡æ¯ï¼š
 ==================================================== =
 â€œçº¿ç¨‹-0â€ï¼š
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
 â€œçº¿ç¨‹1â€ï¼š
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
å‘ç°1ä¸ªæ­»é”ã€‚
</pre><br><h3> ä»‹ç»æ€§ä¿¡æ¯ </h3><br> å°½ç®¡ä¹çœ‹ä¹‹ä¸‹è¯¥æ–‡ä»¶ä¼¼ä¹è¿‡äºå¤æ‚å’Œæ··ä¹±ï¼Œä½†å®é™…ä¸Šï¼Œå¦‚æœé€æ­¥å°†å…¶åˆ†è§£ï¼Œåˆ™ç›¸å½“ç®€å•ã€‚ <br><br> ç¬¬ä¸€è¡Œè¡¨ç¤ºè½¬å‚¨å½¢æˆçš„æ—¶é—´ï¼Œç¬¬äºŒè¡Œ-æœ‰å…³åœ¨å…¶ä¸Šæ¥æ”¶åˆ°è½¬å‚¨çš„JVMçš„è¯Šæ–­ä¿¡æ¯ï¼š <br><br><pre> <code class="hljs css">2018<span class="hljs-selector-tag"><span class="hljs-selector-tag">-06-19</span></span> 16<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:44</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:44</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Full</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">thread</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dump</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Java</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">HotSpot</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">TM</span></span>) 64<span class="hljs-selector-tag"><span class="hljs-selector-tag">-Bit</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Server</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">VM</span></span> (10<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span>+10 <span class="hljs-selector-tag"><span class="hljs-selector-tag">mixed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mode</span></span>):</code> </pre> <br> æœ¬èŠ‚ä¸­æ²¡æœ‰æµä¿¡æ¯ã€‚ æ­¤å¤„è®¾ç½®äº†æ”¶é›†è½¬å‚¨çš„ç³»ç»Ÿçš„ä¸€èˆ¬ä¸Šä¸‹æ–‡ã€‚ <br><br><h4> ä¸€èˆ¬æµç¨‹ä¿¡æ¯ </h4><br> ä»¥ä¸‹éƒ¨åˆ†æä¾›æœ‰å…³è½¬å‚¨æ”¶é›†æ—¶ç³»ç»Ÿä¸­æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹çš„ä¿¡æ¯ï¼š <br><br><pre>çº¿ç¨‹ç±»SMRä¿¡æ¯ï¼š
 _java_thread_list = 0x00000250e5488a00ï¼Œé•¿åº¦= 13ï¼Œå…ƒç´ = {
 0x00000250e4979000ã€0x00000250e4982800ã€0x00000250e52f2800ã€0x00000250e4992800ï¼Œ
 0x00000250e4995800ã€0x00000250e49a5800ã€0x00000250e49ae800ã€0x00000250e5324000ï¼Œ
 0x00000250e54cd800ã€0x00000250e54cf000ã€0x00000250e54d1800ã€0x00000250e54d2000ï¼Œ
 0x00000250e54d0800
 }
</pre><br> ä»¥ä¸‹éƒ¨åˆ†åˆ—å‡ºï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®‰å…¨å†…å­˜å›æ”¶ï¼ˆSMRï¼‰ä¿¡æ¯</a> <br><br> å®ƒåŒ…å«æœ‰å…³JVMå¤–éƒ¨çº¿ç¨‹çš„ä¿¡æ¯ï¼Œå³ è¿™äº›ä¸æ˜¯è™šæ‹Ÿæœºçº¿ç¨‹æˆ–åƒåœ¾å›æ”¶çº¿ç¨‹ã€‚ å¦‚æœæŸ¥çœ‹è¿™äº›çº¿ç¨‹çš„åœ°å€ï¼Œåˆ™ä¼šæ³¨æ„åˆ°å®ƒä»¬ä¸<i>tid</i>çš„å€¼ç›¸å¯¹åº”<i>-tid</i>çš„å€¼-æ“ä½œç³»ç»Ÿä¸­çš„â€œè‡ªç„¶é“â€ï¼ˆæœ¬æœºï¼‰åœ°å€ï¼Œè€Œä¸æ˜¯çº¿ç¨‹IDã€‚ <br><br> çœç•¥å·ç”¨äºéšè—å†—ä½™ä¿¡æ¯ï¼š <br><br><pre> â€œå¼•ç”¨å¤„ç†ç¨‹åºâ€ï¼ƒ2 ... tid = 0x00000250e4979000 ...
 â€œç»ˆç»“å™¨â€ï¼ƒ3 ... tid = 0x00000250e4982800 ...
 â€œä¿¡å·è°ƒåº¦å™¨â€ï¼ƒ4 ... tid = 0x00000250e52f2800 ...
 â€œé™„åŠ ç›‘å¬å™¨â€ï¼ƒ5 ... tid = 0x00000250e4992800 ...
 â€œ C2 CompilerThread0â€ï¼ƒ6 ... tid = 0x00000250e4995800 ...
 â€œ C2 CompilerThread1â€ï¼ƒ7 ... tid = 0x00000250e49a5800 ...
 â€œ C1 CompilerThread2â€ï¼ƒ8 ... tid = 0x00000250e49ae800 ...
 â€œæ¸…é™¤çº¿ç¨‹â€ï¼ƒ9 ... tid = 0x00000250e5324000 ...
 â€œæœåŠ¡çº¿ç¨‹â€ï¼ƒ10 ... tid = 0x00000250e54cd800 ...
 â€œé€šç”¨æ¸…æ´å™¨â€ï¼ƒ11 ... tid = 0x00000250e54cf000 ...
 â€œçº¿ç¨‹-0â€ï¼ƒ12 ... tid = 0x00000250e54d1800 ...
 â€œçº¿ç¨‹-1â€ï¼ƒ13 ... tid = 0x00000250e54d2000 ...
 â€œ DestroyJavaVMâ€ï¼ƒ14 ... tid = 0x00000250e54d0800 ...
</pre><br><h3> æµ </h3><br> åœ¨SMRå—ä¹‹åæ˜¯çº¿ç¨‹åˆ—è¡¨ã€‚ æˆ‘ä»¬åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹æ˜¯å¼•ç”¨å¤„ç†ç¨‹åºï¼š <br><br><pre> â€œå¼•ç”¨å¤„ç†ç¨‹åºâ€ï¼ƒ2å®ˆæŠ¤ç¨‹åºprio = 10 os_prio = 2 tid = 0x00000250e4979000 nid = 0x3c28ç­‰å¾…æ¡ä»¶[0x000000b82a9ff000]
    java.lang.Thread.Stateï¼šRUNNABLE
    åœ¨java.lang.ref.Reference.waitForReferencePendingListï¼ˆjava.base@10.0.1/Nativeæ–¹æ³•ï¼‰
    åœ¨java.lang.ref.Reference.processPendingReferencesï¼ˆjava.base@10.0.1/Reference.javaï¼š174ï¼‰
    åœ¨java.lang.ref.Reference.access $ 000ï¼ˆjava.base@10.0.1/Reference.javaï¼š44ï¼‰
    åœ¨java.lang.ref.Reference $ ReferenceHandler.runï¼ˆjava.base@10.0.1/Reference.javaï¼š138ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
</pre><br><h4> æµçš„ç®€çŸ­æè¿° </h4><br> æ¯ä¸ªçº¿ç¨‹çš„ç¬¬ä¸€è¡Œæä¾›äº†ä¸€èˆ¬è¯´æ˜ã€‚ è¯´æ˜åŒ…å«ä»¥ä¸‹å„é¡¹ï¼š <br><table><tbody><tr><th width="70"> éƒ¨åˆ† </th><th width="100"> ä¾‹å­ </th><th> å†…å®¹æè¿° </th></tr><tr><td> åç§° </td><td>  â€œå¼•ç”¨å¤„ç†ç¨‹åºâ€ </td><td> å¯è¯»æµåç§°ã€‚ å¯ä»¥é€šè¿‡è°ƒç”¨<i>Thread</i>å¯¹è±¡çš„<i>setName</i>æ–¹æ³•æ¥æŒ‡å®šåç§°ã€‚ å¹¶é€šè¿‡è°ƒç”¨<i>getName</i> </td></tr><tr><td> ç¼–å· </td><td>  ï¼ƒ2 </td><td> åˆ†é…ç»™<i>Thread</i>ç±»çš„æ¯ä¸ªå¯¹è±¡çš„å”¯ä¸€IDã€‚ ä¸ºç³»ç»Ÿä¸­çš„çº¿ç¨‹ç”ŸæˆIDã€‚ åˆå§‹å€¼ä¸º1ã€‚æ¯ä¸ªæ–°åˆ›å»ºçš„çº¿ç¨‹éƒ½åˆ†é…æœ‰å…¶è‡ªå·±çš„IDï¼Œè¯¥IDä¹‹å‰å·²å¢åŠ 1ã€‚å¯ä»¥ä½¿ç”¨<i>Thread</i>ç±»<i>çš„</i>å¯¹è±¡çš„<i>getId</i>å‡½æ•°è·å¾—æ­¤åªè¯»çº¿ç¨‹å±æ€§ã€‚ </td></tr><tr><td> å®ˆæŠ¤ç¨‹åºçŠ¶æ€ </td><td> å®ˆæŠ¤ç¨‹åº </td><td> è¯¥æ ‡å¿—è¡¨æ˜çº¿ç¨‹æ˜¯æ¶é­”ã€‚ å¦‚æœæ˜¯æ¶é­”ï¼Œåˆ™å°†è®¾ç½®æ ‡å¿—ã€‚ ä¾‹å¦‚ï¼Œçº¿ç¨‹<i>-0</i>ä¸æ˜¯å®ˆæŠ¤ç¨‹åºã€‚ </td></tr><tr><td> ä¼˜å…ˆæƒ </td><td>  prio = 10 </td><td>  Javaæµçš„æ•°å­—ä¼˜å…ˆçº§ã€‚ è¯·æ³¨æ„ï¼Œæ­¤ä¼˜å…ˆçº§ä¸ä¸€å®šä¸æ“ä½œç³»ç»Ÿä¸­å…³è”çº¿ç¨‹çš„ä¼˜å…ˆçº§ç›¸å¯¹åº”ã€‚ è¦è®¾ç½®ä¼˜å…ˆçº§ï¼Œæ‚¨å¯ä»¥ <br> ä½¿ç”¨<i>Thread</i>ç±»<i>çš„</i>å¯¹è±¡çš„<i>setPriority</i>æ–¹æ³•å¹¶è·å– <br>  <i>getPriority</i>æ–¹æ³•ã€‚ </td></tr><tr><td> æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¼˜å…ˆçº§ </td><td>  os_prio = 2 </td><td> æ“ä½œç³»ç»Ÿä¸­çš„ä¼˜å…ˆçº¿ç¨‹ã€‚ è¯¥ä¼˜å…ˆçº§å¯èƒ½ä¸åˆ†é…ç»™é“¾æ¥çš„Javaçº¿ç¨‹çš„ä¼˜å…ˆçº§ä¸åŒã€‚ </td></tr><tr><td> ä½å€ </td><td>  tid = 0x00000250e4979000 </td><td>  Javaæµçš„åœ°å€ã€‚ è¯¥åœ°å€æ˜¯<i>Thread</i>ç±»çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Javaæœ¬æœºæ¥å£ï¼ˆJNIï¼‰</a>æœ¬æœºå¯¹è±¡çš„æŒ‡é’ˆ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">ï¼ˆ</a>é€šè¿‡JNIè¿æ¥åˆ°Javaçº¿ç¨‹çš„C ++ <i>Thread</i>å¯¹è±¡ï¼‰ã€‚ è¯¥å€¼æ˜¯é€šè¿‡å°†æŒ‡é’ˆæŠ•å°„åˆ°æ­¤å€¼è€Œè·å¾—çš„ <br>  ï¼ˆä¸æ­¤Javaçº¿ç¨‹å…³è”çš„C ++å¯¹è±¡ï¼‰ä¸ºæ•´æ•°ã€‚ è§ <br>  <a href="">çƒ­ç‚¹/å…±äº«/è¿è¡Œæ—¶/thread.cppä¸­çš„ç¬¬879è¡Œ</a> ï¼š <br><pre> st-&gt; printï¼ˆâ€œ tid =â€ INTPTR_FORMATâ€œâ€ï¼Œp2iï¼ˆthisï¼‰ï¼‰;
</pre><br> å°½ç®¡æ­¤å¯¹è±¡çš„é”®ï¼ˆ <i>tid</i> ï¼‰çœ‹èµ·æ¥åƒæµIDï¼Œ <br> å®é™…ä¸Šï¼Œè¿™æ˜¯<i>JNI C ++çº¿ç¨‹</i>è¿æ¥å¯¹è±¡çš„åœ°å€ï¼Œè€Œä¸æ˜¯ <br> è¿”å›Java <i>çº¿ç¨‹</i>çš„<i>getId</i>æ–¹æ³•ã€‚ </td></tr><tr><td> æ“ä½œç³»ç»Ÿçº¿ç¨‹ID </td><td>  nid = 0x3c28 </td><td>  Javaçº¿ç¨‹ç»‘å®šåˆ°çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ <br> è¯¥å€¼ä½¿ç”¨ä»¥ä¸‹ä»£ç è¾“å‡ºï¼š <br>  <a href="">çƒ­ç‚¹/å…±äº«/è¿è¡Œæ—¶/osThread.cppä¸­çš„ç¬¬42è¡Œ</a> ï¼š <br><pre> st-&gt; printï¼ˆâ€œ nid = 0xï¼…xâ€ï¼Œthread_idï¼ˆï¼‰ï¼‰;
</pre><br></td></tr><tr><td> ç°å†µ </td><td> ç­‰å¾…æ¡ä»¶ </td><td> å½“å‰çº¿ç¨‹çš„å¯è¯»çŠ¶æ€ã€‚ <br> æ­¤è¡Œæ˜¾ç¤ºæœ‰å…³æµçš„ç®€å•çŠ¶æ€çš„å…¶ä»–ä¿¡æ¯ï¼ˆè¯·å‚è§ä¸‹æ–‡ï¼‰ï¼Œå¯ä»¥æ˜¯ <br> ç”¨äºäº†è§£çº¿ç¨‹å°†è¦åšä»€ä¹ˆï¼ˆå³çº¿ç¨‹æ˜¯å¦è¯•å›¾è·å–é”ï¼‰ <br> æˆ–ç­‰å¾…è§£é”æ¡ä»¶å¾—åˆ°æ»¡è¶³ï¼‰ã€‚ </td></tr><tr><td> æœ€æ–°çš„Javaå †æ ˆæŒ‡é’ˆ </td><td>  [0x000000b82a9ff000] </td><td> ä¸æ­¤æµå…³è”çš„æœ€åä¸€ä¸ªå·²çŸ¥çš„å †æ ˆæŒ‡é’ˆï¼ˆSPï¼‰ã€‚ <br> è¯¥å€¼æ˜¯ä½¿ç”¨æœ¬æœºC ++ä»£ç å’Œä½¿ç”¨JNIçš„Javaä»£ç æ··åˆè·å¾—çš„ã€‚ è¯¥å€¼ç”±å‡½æ•°<i>last_Java_spï¼ˆï¼‰</i>è¿”å›ï¼Œ <br>  <a href="">çƒ­ç‚¹/å…±äº«/è¿è¡Œæ—¶/ thread.cppä¸­çš„ç¬¬2886è¡Œ</a> ï¼š <br><pre>   st-&gt; print_crï¼ˆâ€œ [â€ INTPTR_FORMATâ€œ]â€ï¼Œ 
     ï¼ˆintptr_tï¼‰last_Java_spï¼ˆï¼‰ï¼†ã€œright_n_bitsï¼ˆ12ï¼‰ï¼‰;
</pre><br> å¯¹äºç®€å•çš„çº¿ç¨‹è½¬å‚¨ï¼Œæ­¤ä¿¡æ¯å‡ ä¹æ²¡æœ‰ç”¨ã€‚ ä½†æ˜¯ï¼Œåœ¨å¤æ‚æƒ…å†µä¸‹ï¼ŒSPå¯èƒ½ä¼š <br> ç”¨äºè·Ÿè¸ªé”ã€‚ </td></tr></tbody></table><br><h4> æµçŠ¶æ€ </h4><br> ç¬¬äºŒè¡Œæ˜¯æµçš„å½“å‰çŠ¶æ€ã€‚ æšä¸¾åˆ—å‡ºäº†å¯èƒ½çš„æµçŠ¶æ€ï¼š <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Thread.State</a> ï¼š <br><br> æ–°å“ <br> å¯è¿è¡Œ <br> å°é” <br> ç­‰å¾…ä¸­ <br>  TIMED_WAITING <br> å·²ç»ˆæ­¢ <br><br> æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">æ–‡æ¡£</a> ã€‚ <br><br><h4> çº¿ç¨‹å †æ ˆè·Ÿè¸ª </h4><br> ä¸‹ä¸€éƒ¨åˆ†åŒ…å«è¿›è¡Œè½¬å‚¨æ—¶æµçš„å †æ ˆè·Ÿè¸ªã€‚ æ­¤å †æ ˆè·Ÿè¸ªä¸æœªæ•è·çš„å¼‚å¸¸å¼•å‘çš„å †æ ˆè·Ÿè¸ªéå¸¸ç›¸ä¼¼ã€‚ å®ƒåŒ…å«è½¬å‚¨å½¢æˆæ—¶æ‰§è¡Œçš„ç±»å’Œå­—ç¬¦ä¸²çš„åç§°ã€‚ å¯¹äºå¼•ç”¨å¤„ç†ç¨‹åºæµï¼Œæˆ‘ä»¬çœ‹ä¸åˆ°ä»»ä½•æœ‰è¶£çš„ä¸œè¥¿ã€‚ <br><br> ä½†æ˜¯ï¼Œå…³äºThread-02çº¿ç¨‹è·Ÿè¸ªï¼Œæœ‰ä¸€ç‚¹ä¸æ ‡å‡†è·Ÿè¸ªä¸åŒï¼š <br><br><pre> â€œçº¿ç¨‹-0â€ï¼ƒ12 prio = 5 os_prio = 0 tid = 0x00000250e54d1800 nid = 0xdecç­‰å¾…ç›‘è§†å™¨æ¡ç›®[0x000000b82b4ff000]
    java.lang.Thread.Stateï¼šå·²é˜»æ­¢ï¼ˆåœ¨å¯¹è±¡ç›‘è§†å™¨ä¸Šï¼‰
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
   é”å®šçš„å¯æ‹¥æœ‰åŒæ­¥å™¨ï¼š
     -æ— 
</pre><br> åœ¨è·Ÿè¸ªä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°å·²æ·»åŠ äº†æœ‰å…³é”çš„ä¿¡æ¯ã€‚ è¯¥çº¿ç¨‹æœŸæœ›å¯¹åœ°å€ä¸º0x00000000894465b0ï¼ˆå¯¹è±¡ç±»å‹ä¸ºjava.lang.Objectï¼‰çš„å¯¹è±¡è¿›è¡Œé”å®šã€‚ æ­¤å¤–ï¼Œçº¿ç¨‹æœ¬èº«æŒæœ‰åœ°å€ä¸º0x00000000894465a0çš„é”ï¼ˆä¹Ÿæ˜¯java.lang.Objectï¼‰ã€‚ æ­¤ä¿¡æ¯å¯¹ä»¥åå¯¹æ­»é”çš„è¯Šæ–­å¾ˆæœ‰ç”¨ã€‚ <br><br><h4> æ•è·çš„åŒæ­¥åŸè¯­ï¼ˆå¯æ‹¥æœ‰çš„åŒæ­¥å™¨ï¼‰ </h4><br> æœ€åä¸€éƒ¨åˆ†åˆ—å‡ºäº†æµæ•è·çš„åŒæ­¥åŸè¯­ã€‚ è¿™äº›æ˜¯å¯ç”¨äºåŒæ­¥çº¿ç¨‹ï¼ˆä¾‹å¦‚é”ï¼‰çš„å¯¹è±¡ã€‚ <br><br> æ ¹æ®Javaçš„å®˜æ–¹æ–‡æ¡£ï¼Œ <strong>Ownable Synchronizer</strong>æ˜¯<i>AbstractOwnableSynchronizer</i> ï¼ˆæˆ–å…¶å­ç±»ï¼‰çš„åä»£ï¼Œè¯¥æµå¯ä»¥ä¸ºåŒæ­¥ç›®çš„è€Œä¸“é—¨æ•è·å®ƒã€‚ <br><br>  <i>ReentrantLock</i>å’Œ<i>write-lock</i>è€Œä¸æ˜¯<i>ReentrantReadWriteLock</i>ç±»çš„<i>è¯»å–é”</i>æ˜¯å¹³å°æä¾›çš„æ­¤ç±»â€œæ‹¥æœ‰çš„åŒæ­¥å™¨â€çš„ä¸¤ä¸ªå¾ˆå¥½çš„ç¤ºä¾‹ã€‚ <br><br> æœ‰å…³æ­¤ä¸»é¢˜çš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥å‚è€ƒæ­¤ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">å‘å¸ƒ</a> ã€‚ <br><br><h4>  JVMçº¿ç¨‹ </h4><br> è½¬å‚¨çš„ä¸‹ä¸€éƒ¨åˆ†åŒ…å«æœ‰å…³JVMæŠ€æœ¯çº¿ç¨‹çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¸æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹ç›¸å…³è”çš„ã€‚ å› ä¸º è¿™äº›æµåœ¨åº”ç”¨ç¨‹åºå¤–éƒ¨å·¥ä½œï¼Œå®ƒä»¬æ²¡æœ‰æµæ ‡è¯†ç¬¦ã€‚ é€šå¸¸ï¼Œè¿™äº›æ˜¯åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹å’Œå…¶ä»–æŠ€æœ¯JVMçº¿ç¨‹ï¼š <br><br><pre> â€œ VMçº¿ç¨‹â€ os_prio = 2 tid = 0x00000250e496d800 nid = 0x1920å¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹å·0â€ os_prio = 2 tid = 0x00000250c35b5800 nid = 0x310cå¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹ï¼ƒ1â€ os_prio = 2 tid = 0x00000250c35b8000 nid = 0x12b4å¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹ï¼ƒ2â€ os_prio = 2 tid = 0x00000250c35ba800 nid = 0x43f8å¯è¿è¡Œ  
 â€œ GCçº¿ç¨‹ï¼ƒ3â€ os_prio = 2 tid = 0x00000250c35c0800 nid = 0x20c0å¯è¿è¡Œ  
 â€œ G1ä¸»æ ‡è®°â€ os_prio = 2 tid = 0x00000250c3633000 nid = 0x4068å¯è¿è¡Œ  
 â€œ G1 Concï¼ƒ0â€ os_prio = 2 tid = 0x00000250c3636000 nid = 0x3e28å¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ0â€ os_prio = 2 tid = 0x00000250c367e000 nid = 0x3c0cå¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ1â€ os_prio = 2 tid = 0x00000250e47fb800 nid = 0x3890å¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ2â€ os_prio = 2 tid = 0x00000250e47fc000 nid = 0x32a8å¯è¿è¡Œ  
 â€œ G1ä¼˜åŒ–ï¼ƒ3â€ os_prio = 2 tid = 0x00000250e47fd800 nid = 0x3d00å¯è¿è¡Œ  
 â€œ G1 Young RemSeté‡‡æ ·â€ os_prio = 2 tid = 0x00000250e4800800 nid = 0xef4å¯è¿è¡Œ  
 â€œ VMå®šæœŸä»»åŠ¡çº¿ç¨‹â€ os_prio = 2 tid = 0x00000250e54d6800 nid = 0x3468ç­‰å¾…æ¡ä»¶
</pre><br><h4>  JNIå…¨çƒé“¾æ¥ </h4><br> æœ¬éƒ¨åˆ†æŒ‡ç¤ºJVMé€šè¿‡JNIä½¿ç”¨çš„å…¨å±€å¼•ç”¨æ•°ã€‚ è¿™äº›é“¾æ¥ä¸ç”±åƒåœ¾æ”¶é›†å™¨æä¾›æœåŠ¡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚ <br><br><pre> JNIå…¨çƒå‚è€ƒï¼š2
</pre><br> åœ¨å¤§å¤šæ•°ç®€å•æƒ…å†µä¸‹ï¼Œä¸ä½¿ç”¨æ­¤ä¿¡æ¯ã€‚ ä½†æ˜¯ï¼Œå¿…é¡»ç†è§£å…¨å±€å¼•ç”¨çš„é‡è¦æ€§ã€‚ æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿™ç¯‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">æ–‡ç« </a> ã€‚ <br><br><h4> æ­»é”çº¿ç¨‹ </h4><br> æœ€åä¸€éƒ¨åˆ†åŒ…å«æœ‰å…³æ‰¾åˆ°çš„æ­»é”çš„ä¿¡æ¯ã€‚ <br> å¦‚æœæ‰¾ä¸åˆ°è¿™äº›ï¼Œåˆ™è¯¥éƒ¨åˆ†å°†ä¸ºç©ºã€‚ å› ä¸º æˆ‘ä»¬ä¸“é—¨å¼€å‘äº†ä¸€ä¸ªå¸¦é”çš„åº”ç”¨ç¨‹åºï¼Œåœ¨æœ¬ä¾‹ä¸­å°±æ˜¯è¿™æ ·ã€‚ åœ¨è½¬å‚¨æœŸé—´æ£€æµ‹åˆ°é”å®šï¼Œå¹¶æ˜¾ç¤ºä»¥ä¸‹æ¶ˆæ¯ï¼š <br><br><pre>å‘ç°äº†ä¸€ä¸ªJavaçº§æ­»é”ï¼š
 ==============================
 â€œçº¿ç¨‹-0â€ï¼š
  ç­‰å¾…é”å®šç›‘è§†å™¨0x00000250e4982480ï¼ˆå¯¹è±¡0x00000000894465b0ï¼Œä¸€ä¸ªjava.lang.Objectï¼‰ï¼Œ
  ç”±â€œ Thread-1â€æŒæœ‰
 â€œçº¿ç¨‹1â€ï¼š
  ç­‰å¾…é”å®šç›‘è§†å™¨0x00000250e4982380ï¼ˆå¯¹è±¡0x00000000894465a0ï¼Œä¸€ä¸ªjava.lang.Objectï¼‰ï¼Œ
  ç”±â€œçº¿ç¨‹-0â€æŒæœ‰
ä¸Šé¢åˆ—å‡ºçš„çº¿ç¨‹çš„Javaå †æ ˆä¿¡æ¯ï¼š
 ==================================================== =
 â€œçº¿ç¨‹-0â€ï¼š
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
 â€œçº¿ç¨‹1â€ï¼š
    åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰
     -ç­‰å¾…é”å®š&lt;0x00000000894465a0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
     -é”å®š&lt;0x00000000894465b0&gt;ï¼ˆä¸€ä¸ªjava.lang.Objectï¼‰
    åœ¨java.lang.Thread.runï¼ˆjava.base@10.0.1/Thread.javaï¼š844ï¼‰
å‘ç°1ä¸ªæ­»é”ã€‚
</pre><br> ç¬¬ä¸€éƒ¨åˆ†æè¿°æ­»é”æƒ…å†µï¼š <br><br> çº¿ç¨‹0æœŸæœ›èƒ½å¤Ÿæ•è·ç›‘è§†å™¨ï¼ˆè¿™æ˜¯å¯¹æˆ‘ä»¬åº”ç”¨ç¨‹åºä¸­çš„<i>syncedï¼ˆsecondResourceï¼‰</i>å—çš„è®¿é—®ï¼‰ï¼Œä¸æ­¤åŒæ—¶ï¼Œè¯¥çº¿ç¨‹æŒæœ‰è¯•å›¾æ•è·Thread-1çš„ç›‘è§†å™¨ï¼ˆè¿™æ­£åœ¨è®¿é—®ç›¸åŒçš„ä»£ç ç‰‡æ®µï¼š <i>Synchronizedï¼ˆsecondResource</i> ï¼‰ã€‚ <br><br> å°†æ­¤åœ†å½¢é”ç§°ä¸º<strong>æ­»é”</strong> ã€‚ åœ¨ä¸‹é¢çš„å›¾ç‰‡ä¸­ <br> è¿™ç§æƒ…å†µä»¥å›¾å½¢å½¢å¼è¡¨ç¤ºï¼š <br><br><img src="https://habrastorage.org/webt/11/yd/kr/11ydkrm0xkbw8aqxb8t71kypskg.png"><br><br> åœ¨ç¬¬äºŒå°èŠ‚ä¸­ï¼Œç»™å‡ºäº†ä¸¤ä¸ªé˜»å¡çº¿ç¨‹çš„å †æ ˆè·Ÿè¸ªã€‚ <br><br> è¯¥å †æ ˆè·Ÿè¸ªä½¿æˆ‘ä»¬å¯ä»¥è·Ÿè¸ªæ¯ä¸ªçº¿ç¨‹çš„æ“ä½œï¼Œç›´åˆ°å‘ç”Ÿé”å®šä¸ºæ­¢ã€‚ <br> åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸€è¡Œï¼š <br><br>  <i>åœ¨DeadlockProgram $ DeadlockRunnable.runï¼ˆDeadlockProgram.java:34ï¼‰ä¸­</i> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†çœ‹åˆ°ä»£ç çš„é—®é¢˜éƒ¨åˆ†ï¼š <br><br><pre> printLockedResourceï¼ˆsecondResourceï¼‰;
</pre><br> è¯¥è¡Œæ˜¯åŒæ­¥å—çš„ç¬¬ä¸€è¡Œï¼Œè¿™æ˜¯é”å®šçš„åŸå› ï¼Œå¹¶å‘Šè¯‰æˆ‘ä»¬ï¼ŒsecondResourceä¸Šçš„åŒæ­¥æ˜¯ç›¸äº’é”å®šçš„åŸå› ã€‚ ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ä¸¤ä¸ªçº¿ç¨‹åœ¨èµ„æºresourceAå’ŒresourceBä¸Šå…·æœ‰ç›¸åŒçš„åŒæ­¥é¡ºåºã€‚ å¦‚æœè¿™æ ·åšï¼Œæˆ‘ä»¬å°†è¿›å…¥ä»¥ä¸‹åº”ç”¨ç¨‹åºï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeadlockProgram</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Object resourceA = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); Object resourceB = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); Thread threadLockingResourceAFirst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DeadlockRunnable(resourceA, resourceB)); Thread threadLockingResourceBFirst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DeadlockRunnable(resourceA, resourceB)); threadLockingResourceAFirst.start(); Thread.sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); threadLockingResourceBFirst.start(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeadlockRunnable</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Runnable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Object firstResource; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Object secondResource; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DeadlockRunnable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object firstResource, Object secondResource)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstResource = firstResource; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondResource = secondResource; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (firstResource) { printLockedResource(firstResource); Thread.sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (secondResource) { printLockedResource(secondResource); } } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException e) { System.out.println(<span class="hljs-string"><span class="hljs-string">"Exception occurred: "</span></span> + e); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printLockedResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object resource)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(Thread.currentThread().getName() + <span class="hljs-string"><span class="hljs-string">": locked resource -&gt; "</span></span> + resource); } } }</code> </pre> <br> è¯¥åº”ç”¨ç¨‹åºå°†åœ¨æ²¡æœ‰äº’é”çš„æƒ…å†µä¸‹ç»“æŸï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°†è·å¾—ä»¥ä¸‹è¾“å‡ºï¼ˆè¯·æ³¨æ„ï¼ŒObjectç±»çš„åœ°å€å·²æ›´æ”¹ï¼‰ï¼š <br><br><pre>çº¿ç¨‹-0ï¼šé”å®šçš„èµ„æº-&gt; java.lang.Object@1ad895d1
çº¿ç¨‹-0ï¼šé”å®šçš„èµ„æº-&gt; java.lang.Object@6e41d7dd
çº¿ç¨‹1ï¼šé”å®šçš„èµ„æº-&gt; java.lang.Object@1ad895d1
çº¿ç¨‹1ï¼šé”å®šçš„èµ„æº-&gt; java.lang.Object@6e41d7dd
</pre><br>  ,   ,   thread dump,           .        (     deadlock-).      ,   . <br><br><h3>    Thread Dump- </h3><br>         . <br><br>   JVM       .         (     ,   ). <br><br>         . <br><br>       - â€” Thread Dump Analyzers (TDAs).    Java thread dump-     - ,     .  ,           . ,        . <br><br>        TDA: <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">fastThread</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Spotify TDA</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">IBM Thread and Monitor Dump Analyze for Java</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">irockel TDA</a> </li></ul><br>        .               . <br><br><h4> ç»“è®º </h4><br> Thread dump- â€”      Java-,       .     ,           . <br><br>        deadlock,    .         .     ,           â€” . <br><br>   ,   Java-     thread dump-.     ,             . <br><br> , thread dump â€”   Â« Â»   ,        ,      Java-. <br><br> <i>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Java</a>     .       ,        deadlock- .</i> <br><br> <i>      ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a> .</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN427513/">https://habr.com/ru/post/zh-CN427513/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN427499/index.html">ä»–ä»¬åœ¨è§†é¢‘æµåª’ä½“çš„æŠ€æœ¯æ”¯æŒä¸­å†™äº†äº›ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN427501/index.html">è¥¿æ‘©Â·å¸•å°”ç‰¹ï¼ˆSeymour Papertï¼‰ï¼šè¾›è‹¦äº†</a></li>
<li><a href="../zh-CN427505/index.html">æ¨å®š</a></li>
<li><a href="../zh-CN427507/index.html">è¥¿æ‘©Â·å¸•ç‰¹ï¼ˆSeymour Papertï¼‰ï¼šâ€œæ— â€çš„ç¾å‘³å‘ç°</a></li>
<li><a href="../zh-CN427509/index.html">WebæœåŠ¡å™¨ï¼šå—æ¡¥ä½“éªŒå’Œå®è·µ</a></li>
<li><a href="../zh-CN427517/index.html">æœ€æœ‰è¶£çš„Joker 2018æŠ¥å‘Šæ¦‚è¿°ï¼šEastBanc Technologiesç‰ˆæœ¬</a></li>
<li><a href="../zh-CN427519/index.html">@Kubernetesåœ¨Mail.Ruå°ç»„çš„èšä¼šï¼š10æœˆ29æ—¥ä¸”å§‹ç»ˆ</a></li>
<li><a href="../zh-CN427521/index.html">2019å¹´çªç ´å¥–ã€‚å®£å¸ƒè·å¾—ç±³å°”çº³å¥–ï¼Œå¸ƒæ—å¥–å’Œæ‰å…‹ä¼¯æ ¼ç§‘å­¦å¥–ã€‚</a></li>
<li><a href="../zh-CN427523/index.html">å¯¹å†²æˆåŠŸ</a></li>
<li><a href="../zh-CN427525/index.html">è‹±ç‰¹å°”é…·ç¿9ä»£çš„æ•°é‡å’ŒåŸºå‡†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>