<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤´ğŸ¼ ğŸ¤™ ğŸ‘¨â€ğŸ’¼ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚ Ù…Ù† Ø®Ù„Ø§Ù„ Nginx ğŸ’„ ğŸ’†ğŸ¼ ğŸ§™ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…Ø²Ø¹Ø¬Ø© Ø§Ù„ØªÙŠ ØªÙ†Ø´Ø£ Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ NAS ØŒ Ù‡Ùˆ Ø£Ù†Ù‡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ LDAP ØŒ ÙˆØ¨Ø¹Ø¶Ù‡Ø§ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¢Ù„ÙŠØ§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. 


 Ø§Ù„Ø­Ù„ Ù‡Ùˆ Ù…ØµØ§Ø¯Ù‚Ø©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚ Ù…Ù† Ø®Ù„Ø§Ù„ Nginx</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456894/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/er/pm/ew/erpmewjegcpdjjgb6aobbkf3yda.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…Ø²Ø¹Ø¬Ø© Ø§Ù„ØªÙŠ ØªÙ†Ø´Ø£ Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ NAS ØŒ Ù‡Ùˆ Ø£Ù†Ù‡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ LDAP ØŒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ¨Ø¹Ø¶Ù‡Ø§</a> Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¢Ù„ÙŠØ§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø­Ù„ Ù‡Ùˆ Ù…ØµØ§Ø¯Ù‚Ø© Ø´Ø§Ù…Ù„Ø© Ù…Ù† Ø®Ù„Ø§Ù„ ÙˆÙƒÙŠÙ„ Ø¹ÙƒØ³ÙŠ. <br>  ØªØªÙ… Ù…Ù†Ø§Ù‚Ø´Ø© Ù…Ø«Ø§Ù„ Ø­ÙˆÙ„ ÙƒÙŠÙÙŠØ© Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø°Ù„Ùƒ Ø¨ØªÙØµÙŠÙ„ ÙƒØ¨ÙŠØ± ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©</a> . </p><br><p style=";text-align:right;direction:rtl">  Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ Ø¬Ø²Ø¡ Ù…Ù† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¯ÙˆØ±Ø© NAS</a> ØŒ <br>  Ù‡Ù†Ø§ Ø³Ø£Ø±ÙƒØ² Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© ØªÙƒÙŠÙŠÙ Ù‡Ø°Ø§ Ø§Ù„Ø­Ù„ Ù…Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ø­Ø§ÙˆÙŠØ§Øª Docker. </p><br><p style=";text-align:right;direction:rtl">  ÙŠØ¹ØªÙ…Ø¯ Ø§Ù„Ø­Ù„ Ø¹Ù„Ù‰ Ù…Ø«Ø§Ù„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ù† Ø®Ù„Ø§Ù„ ÙˆÙƒÙŠÙ„ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Nginx LDAP Auth</a> Ø®Ø§Ø±Ø¬ÙŠ ØŒ Ù„ÙƒÙ†Ù†ÙŠ Ø£Ø³ØªØ®Ø¯Ù… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯</a> ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø­Ø§ÙˆÙŠØ© Ù…Ù† LinuxServer.io</a> Ù„Ø£Ù†Ù‡ ØµÙˆØ±Ø© Ø¬Ø§Ù‡Ø²Ø© ØªÙ„Ø¨ÙŠ Ù…Ø¹Ø§ÙŠÙŠØ± Ù…Ø¹ÙŠÙ†Ø©. </p><br><p style=";text-align:right;direction:rtl">  ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ù‡ÙŠ Ø£Ù† ØªØµØ­ÙŠØ­Ø§Øª LinuxServer.io Ø­Ø·Ù…Øª Ù…ØµØ§Ø¯Ù‚Ø© HTTP Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ØŒ ÙˆÙ„ÙƒÙ† Ø¨Ø¹Ø¯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­</a> ØŒ Ø£ØµØ¨Ø­ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø°Ù„Ùƒ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰. </p><br><h2 id="autentifikaciya-v-obschem-sluchae" style=";text-align:right;direction:rtl">  Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø¹Ø§Ù…Ø© </h2><br><p style=";text-align:right;direction:rtl">  ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ÙˆØ¶Ø­ ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ØŒ ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø­Ùˆ Ø§Ù„ØªØ§Ù„ÙŠ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ÙŠØµÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø©. </li><li style=";text-align:right;direction:rtl">  Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø¹ÙƒØ³ÙŠ Ø¥Ø°Ø§ ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ø±ØªØ¨Ø§Ø·. </li><li style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ø±ØªØ¨Ø§Ø· ØŒ ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. </li><li style=";text-align:right;direction:rtl">  ØªØ·Ù„Ø¨ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± ØŒ ÙŠØªØ­Ù‚Ù‚Ø§Ù† Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø®Ø§Ø¯Ù… LDAP. </li><li style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ù†Ø¬Ø­Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚ ØŒ ÙØ¥Ù†Ù‡Ø§ ØªÙ‚ÙˆÙ… Ø¨ØªØ¹ÙŠÙŠÙ† Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ø±ØªØ¨Ø§Ø· ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø©. </li></ul><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/n_/e_/7j/n_e_7jmjle2qbyc35vfpv_0p7e4.jpeg" alt="Ù…Ø®Ø·Ø· Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©"></p><br><p style=";text-align:right;direction:rtl">  Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ù‡Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ­Ø¯Ø© Ù†Ù…Ø·ÙŠØ© Ù…ØªØ±Ø¬Ù…Ø© Ù„Ù€ nginx ØŒ Ù„ÙƒÙ†Ù†ÙŠ Ù„Ù† Ø£ÙÙƒØ± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ù‡Ù†Ø§ Ù†Ø¸Ø±Ù‹Ø§ Ù„ÙˆØ¬ÙˆØ¯ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ­Ø¯Ø© ÙˆÙ†Ù‚Øµ Ù…Ø±ÙˆÙ†ØªÙ‡Ø§. </p><br><p style=";text-align:right;direction:rtl">  ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø© Ù…Ø¹Ø¯Ù„Ø© Ù„Ø®Ø§Ø¯Ù… OpenLDAP <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù‡Ù†Ø§</a> . </p><br><h2 id="autentifikaciya-konteynerov" style=";text-align:right;direction:rtl">  Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ© </h2><br><p style=";text-align:right;direction:rtl">  Ø¯Ø§Ø®Ù„ NAS ØŒ ØªØ¹Ù…Ù„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ø­Ø§ÙˆÙŠØ§Øª ØŒ Ù„Ø°Ù„Ùƒ Ù‡Ù†Ø§Ùƒ Ø±ØºØ¨Ø© ÙÙŠ Ø¬Ø¹Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† ØªØ¨Ø¯ÙŠÙ„ Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø¨Ø³Ø§Ø·Ø© Ø¹Ù† Ø·Ø±ÙŠÙ‚ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. </p><br><p style=";text-align:right;direction:rtl">  Ù‡Ø°Ù‡ Ø§Ù„Ø¢Ù„ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØµÙˆØ±Ø© ngingx-proxy</a> Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙˆÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„ØªÙŠ ØªØ¹Ø§Ù„Ø¬ Ø¹Ù…Ù„ÙŠØ§Øª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¹Ø§Ù…Ù„ Ø§Ù„Ù†Ù‚Ù„</a> . </p><br><p style=";text-align:right;direction:rtl">  ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ø¯Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙ ÙÙŠ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙˆØµÙ Ù„Ø­Ø§ÙˆÙŠØ§Øª Docker Ø§Ù„ØªÙŠ ØªØ¹Ù…Ù„ Ø­Ø§Ù„ÙŠÙ‹Ø§. </p><br><p style=";text-align:right;direction:rtl">  ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ ØŒ ÙƒÙ„ Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡ Ù‡Ùˆ ØªØ­Ø³ÙŠÙ† Ù‚Ø§Ù„Ø¨ ØªÙƒÙˆÙŠÙ† Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø¹ÙƒØ³ÙŠ Ø¨Ø­ÙŠØ« Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…ØªØºÙŠØ± Ø´Ø±Ø·ÙŠ ÙÙŠ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ØŒ ÙØ³ÙŠØªÙ… ØªØ¶Ù…ÙŠÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø© ØŒ ÙˆØ§Ù„ØªÙŠ ØªØ¹Ù…Ù„ Ø£ÙŠØ¶Ù‹Ø§ ÙÙŠ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. </p><br><p style=";text-align:right;direction:rtl">  Ø«Ù… ØŒ Ù‚Ù… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ø¹Ù„Ù‰ ØªÙƒÙˆÙŠÙ† Ø¹Ø§Ù…Ù„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©. </p><br><h2 id="realizaciya-autentifikacii" style=";text-align:right;direction:rtl">  ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© </h2><br><h3 id="modifikaciya-shablona-konfiguracii-nginx-proxy" style=";text-align:right;direction:rtl">  ØªØ¹Ø¯ÙŠÙ„ Ù‚Ø§Ù„Ø¨ ØªÙƒÙˆÙŠÙ† nginx-proxy </h3><br><p style=";text-align:right;direction:rtl">  Ø¨Ø§Ø¯Ø¦ Ø°ÙŠ Ø¨Ø¯Ø¡ ØŒ ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© upstream Ø¬Ø¯ÙŠØ¯ ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠØ³Ù…Ø­ Ù„Ùƒ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙÙŠ Ø§Ù„ØªÙƒÙˆÙŠÙ†: </p><br><pre style=";text-align:right;direction:rtl"><code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_path</span></span> cache/ keys_zone=auth_cache:<span class="hljs-number"><span class="hljs-number">10m</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">upstream</span></span> ldap-backend { <span class="hljs-section"><span class="hljs-section">server</span></span> {{ $.Env.<span class="hljs-attribute"><span class="hljs-attribute">LDAP_BACKEND</span></span> }}:{{ <span class="hljs-attribute"><span class="hljs-attribute">or</span></span> $.Env.LDAP_LOGIN_PORT <span class="hljs-string"><span class="hljs-string">"9000"</span></span> }}; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙŠÙ…ÙƒÙ† Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ù† Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¶ÙŠÙ <code>${LDAP_BACKEND}</code> ÙˆØ§Ù„Ù…ÙŠÙ†Ø§Ø¡ <code>${LDAP_LOGIN_PORT }</code> ØŒ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù‡ÙŠ 9000. <br>  Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‚ÙŠÙ… Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø¨ÙˆØ§Ø³Ø·Ø© Ø¹Ø§Ù…Ù„ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¹Ø§Ù… Ø¨Ø­ÙŠØ« ÙŠØ¨Ø¯Ùˆ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„ØªÙƒÙˆÙŠÙ† ÙƒÙ…Ø§ Ù‡Ùˆ ÙÙŠ <code>/etc/nginx/conf.d/default.conf</code> Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©: </p><br><pre style=";text-align:right;direction:rtl"> <code class="nginx hljs"><span class="hljs-comment"><span class="hljs-comment">### LDAP proxy_cache_path cache/ keys_zone=auth_cache:10m; upstream ldap-backend { server ldap-auth:9000; } ###</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªÙ‚ÙˆÙ… Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ± <code>ext_ldap_auth</code> Ø¥Ø°Ø§ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ù…ØªØºÙŠØ± LDAP_EXT_AUTH ÙÙŠ Ø­Ø§ÙˆÙŠØ© Ø®Ø¯Ù…Ø© Ù…Ø¹ÙŠÙ†Ø©. <br>  Ø£ÙŠØ¶Ø§ ØŒ ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø¯ Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="nginx hljs">{{/* <span class="hljs-attribute"><span class="hljs-attribute">Nginx</span></span> LDAP authentication enabled */}} {{ $<span class="hljs-attribute"><span class="hljs-attribute">ext_ldap_auth</span></span> := parseBool (or (first (groupByKeys <span class="hljs-variable"><span class="hljs-variable">$containers</span></span> <span class="hljs-string"><span class="hljs-string">"Env.LDAP_EXT_AUTH"</span></span>)) <span class="hljs-string"><span class="hljs-string">"false"</span></span>) }} {{/* <span class="hljs-attribute"><span class="hljs-attribute">User</span></span> need to be participated in these groups to use service */}} {{ $<span class="hljs-attribute"><span class="hljs-attribute">ldap_add_groups</span></span> := or (first (groupByKeys <span class="hljs-variable"><span class="hljs-variable">$containers</span></span> <span class="hljs-string"><span class="hljs-string">"Env.LDAP_EXT_ADD_GROUPS"</span></span>)) <span class="hljs-string"><span class="hljs-string">""</span></span> }} {{/* <span class="hljs-attribute"><span class="hljs-attribute">Use</span></span> HTML login page or HTTP Basic authentication */}} {{ $<span class="hljs-attribute"><span class="hljs-attribute">ldap_use_login_page</span></span> := parseBool (or $.Env.LDAP_USE_LOGIN_PAGE <span class="hljs-string"><span class="hljs-string">"false"</span></span> ) }}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙˆÙŠØ±Ø¯ Ø£Ø¯Ù†Ø§Ù‡ ÙƒØªÙ„Ø© Ù…Ù† Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª Ø£Ø¯Ù†Ø§Ù‡.  ÙŠØªÙ… ØªÙ†Ø´ÙŠØ·Ù‡ ÙÙ‚Ø· Ø¥Ø°Ø§ ØªÙ… <code>ext_ldap_auth</code> Ù…ØªØºÙŠØ± <code>ext_ldap_auth</code> . <br>  Ø¥Ø°Ø§ <code>ldap_use_login_page</code> ØªØ¹ÙŠÙŠÙ† <code>ldap_use_login_page</code> ØŒ ÙØ³ÙŠØªÙ… ØªÙ…ÙƒÙŠÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ØŒ ÙˆØ¥Ù„Ø§ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø§ÙØ°Ø© Ù…ØµØ§Ø¯Ù‚Ø© HTTP Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©. </p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ù…Ø³Ø§Ø± <code>/auth-proxy</code> Ù‡Ùˆ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. <br>  Ø³ÙŠØªÙ… ØªÙ…Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ù…Ù† Ø®Ù„Ø§Ù„ Ø±Ø¤ÙˆØ³ HTTP. <br>  Ù…Ø§ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª ÙˆÙ„Ù…Ø§Ø°Ø§ Ù‡Ù†Ø§Ùƒ Ø­Ø§Ø¬Ø© ØŒ ÙˆÙŠØ±Ø¯ ÙˆØµÙÙ‡Ø§ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ù‚Ø³Ù… LDAP</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="nginx hljs"> {{ <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$ext_ldap_auth</span></span>) }} <span class="hljs-comment"><span class="hljs-comment">### LDAP {{ if ($ldap_use_login_page) }} location /login-ldap { proxy_pass http://{{ $.Env.LDAP_BACKEND }}:{{ or $.Env.LDAP_LOGIN_PORT "9000" }}; # Login service returns a redirect to the original URI # and sets the cookie for the ldap-auth daemon proxy_set_header X-Target $request_uri; proxy_pass_request_body off; proxy_set_header Content-Length ""; proxy_cache auth_cache; proxy_cache_valid 200 10m; proxy_cache_key "$http_authorization$cookie_nginxauth"; proxy_set_header X-CookieName "nginxauth"; proxy_set_header Cookie nginxauth=$cookie_nginxauth; } {{ end }} location = /auth-proxy { internal; # The ldap-auth daemon listens on port $LDAP_BACKEND_PORT (8888, by default), as set # in nginx-ldap-auth-daemon.py. # Change the IP address if the daemon is not running on # the same host as NGINX/NGINX Plus. proxy_pass http://{{ $.Env.LDAP_BACKEND }}:{{ or $.Env.LDAP_BACKEND_PORT "8888" }}; proxy_pass_request_body off; proxy_set_header Content-Length ""; proxy_cache auth_cache; proxy_cache_valid 200 10m; # The following directive adds the cookie to the cache key proxy_cache_key "$http_authorization$cookie_nginxauth"; # As implemented in nginx-ldap-auth-daemon.py, the ldap-auth daemon # communicates with a LDAP server, passing in the following # parameters to specify which user account to authenticate. To # eliminate the need to modify the Python code, this file contains # 'proxy_set_header' directives that set the values of the # parameters. Set or change them as instructed in the comments. # # Parameter Proxy header # ----------- ---------------- # url X-Ldap-URL # starttls X-Ldap-Starttls # basedn X-Ldap-BaseDN # binddn X-Ldap-BindDN # bindpasswd X-Ldap-BindPass # cookiename X-CookieName # realm X-Ldap-Realm # template X-Ldap-Template # (Required) Set the URL and port for connecting to the LDAP server, # by replacing 'example.com'. # Do not mix ldaps-style URL and X-Ldap-Starttls as it will not work. proxy_set_header X-Ldap-URL "{{ $.Env.LDAP_HOST }}"; # (Optional) Establish a TLS-enabled LDAP session after binding to the # LDAP server. # This is the 'proper' way to establish encrypted TLS connections, see # http://www.openldap.org/faq/data/cache/185.html {{ if eq ("$.Env.LDAP_METHOD") "start_tls" }} proxy_set_header X-Ldap-Starttls "true"; {{ end }} # (Required) Set the Base DN, by replacing the value enclosed in # double quotes. proxy_set_header X-Ldap-BaseDN "{{ $.Env.LDAP_BASE }}"; # (Required) Set the Bind DN, by replacing the value enclosed in # double quotes. proxy_set_header X-Ldap-BindDN "{{ $.Env.LDAP_BIND_DN }}"; # (Required) Set the Bind password, by replacing 'secret'. proxy_set_header X-Ldap-BindPass "{{ $.Env.LDAP_PASS }}"; # (Required) The following directives set the cookie name and pass # it, respectively. They are required for cookie-based # authentication. Comment them out if using HTTP basic # authentication. proxy_set_header X-CookieName "nginxauth"; proxy_set_header Cookie nginxauth=$cookie_nginxauth; # (Required if using Microsoft Active Directory as the LDAP server) # Set the LDAP template by uncommenting the following directive. #proxy_set_header X-Ldap-Template "(sAMAccountName=%(username)s)"; # (May be required if using Microsoft Active Directory and # getting "In order to perform this operation a successful bind # must be completed on the connection." errror) #proxy_set_header X-Ldap-DisableReferrals "true"; # (Optional if using OpenLDAP as the LDAP server) Set the LDAP # template by uncommenting the following directive and replacing # '(cn=%(username)s)' which is the default set in # nginx-ldap-auth-daemon.py. {{ $ldap_filter := $.Env.LDAP_USER_FILTER }} {{ $ldap_filter := (printf "(&amp;%s%s)" $ldap_filter $ldap_add_groups) }} proxy_set_header X-Ldap-Template "{{ $ldap_filter }}"; # (Optional) Set the realm name, by uncommenting the following # directive and replacing 'Restricted' which is the default set # in nginx-ldap-auth-daemon.py. #proxy_set_header X-Ldap-Realm "Restricted"; } ### /LDAP {{ end }}</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  Ø£Ø®ÙŠØ±Ù‹Ø§ ØŒ Ø¹Ù†Ø¯ ØªÙ…ÙƒÙŠÙ† Ù…ØµØ§Ø¯Ù‚Ø© LDAP Ù„Ù„Ø®Ø¯Ù…Ø© ØŒ <code>auth_request</code> Ø¥Ø¶Ø§ÙØ© <code>auth_request</code> Ø¥Ù„Ù‰ Ù…ÙˆÙ‚Ø¹Ù‡Ø§: </p><br><pre style=";text-align:right;direction:rtl"> <code class="nginx hljs"> <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { {{ <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$ext_ldap_auth</span></span>) }} auth_request /auth-proxy; {{ <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$ldap_use_login_page</span></span>) }} <span class="hljs-comment"><span class="hljs-comment"># redirect 401 to login form # Comment them out if using HTTP basic authentication. # or authentication popup won't show error_page 401 =200 /login-ldap; {{ end }} {{ end }}</span></span></code> </pre><br><p style=";text-align:right;direction:rtl">  ÙÙŠÙ…Ø§ ÙŠÙ„ÙŠ Ù‚Ø§Ø¦Ù…Ø© ÙƒØ§Ù…Ù„Ø© Ø¨Ø§Ù„Ù‚Ø§Ù„Ø¨. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">nginx.tmpl</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="nginx hljs">{{ $<span class="hljs-attribute"><span class="hljs-attribute">CurrentContainer</span></span> := where $ <span class="hljs-string"><span class="hljs-string">"ID"</span></span> .Docker.CurrentContainerID | first }} {{ <span class="hljs-attribute"><span class="hljs-attribute">define</span></span> <span class="hljs-string"><span class="hljs-string">"upstream"</span></span> }} {{ <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> .Address }} {{/* <span class="hljs-attribute"><span class="hljs-attribute">If</span></span> we got the containers from swarm and this container<span class="hljs-string"><span class="hljs-string">'s port is published to host, use host IP:PORT */}} {{ if and .Container.Node.ID .Address.HostPort }} # {{ .Container.Node.Name }}/{{ .Container.Name }} server {{ .Container.Node.Address.IP }}:{{ .Address.HostPort }}; {{/* If there is no swarm node or the port is not published on host, use container'</span></span>s IP:PORT */}} {{ <span class="hljs-attribute"><span class="hljs-attribute">else</span></span> if .Network }} <span class="hljs-comment"><span class="hljs-comment"># {{ .Container.Name }} server {{ .Network.IP }}:{{ .Address.Port }}; {{ end }} {{ else if .Network }} # {{ .Container.Name }} {{ if .Network.IP }} server {{ .Network.IP }} down; {{ else }} server 127.0.0.1 down; {{ end }} {{ end }} {{ end }} # If we receive X-Forwarded-Proto, pass it through; otherwise, pass along the # scheme used to connect to this server map $http_x_forwarded_proto $proxy_x_forwarded_proto { default $http_x_forwarded_proto; '' $scheme; } # If we receive X-Forwarded-Port, pass it through; otherwise, pass along the # server port the client connected to map $http_x_forwarded_port $proxy_x_forwarded_port { default $http_x_forwarded_port; '' $server_port; } # If we receive Upgrade, set Connection to "upgrade"; otherwise, delete any # Connection header that may have been passed to this server map $http_upgrade $proxy_connection { default upgrade; '' close; } # Apply fix for very long server names server_names_hash_bucket_size 128; # Default dhparam {{ if (exists "/etc/nginx/certs/dhparam.pem") }} ssl_dhparam /etc/nginx/certs/dhparam.pem; {{ end }} # Set appropriate X-Forwarded-Ssl header map $scheme $proxy_x_forwarded_ssl { default off; https on; } gzip_types text/plain text/css application/javascript application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript; log_format vhost '$host $remote_addr - $remote_user [$time_local] ' '"$request" $status $body_bytes_sent ' '"$http_referer" "$http_user_agent"'; access_log off; {{ if $.Env.RESOLVERS }} resolver {{ $.Env.RESOLVERS }}; {{ end }} {{ if (exists "/etc/nginx/proxy.conf") }} include /etc/nginx/proxy.conf; {{ else }} # HTTP 1.1 support proxy_http_version 1.1; proxy_buffering off; proxy_set_header Host $http_host; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $proxy_connection; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $proxy_x_forwarded_proto; proxy_set_header X-Forwarded-Ssl $proxy_x_forwarded_ssl; proxy_set_header X-Forwarded-Port $proxy_x_forwarded_port; # Allow iframing. proxy_hide_header X-Frame-Options; # Mitigate httpoxy attack (see README for details) proxy_set_header Proxy ""; {{ end }} ### LDAP proxy_cache_path cache/ keys_zone=auth_cache:10m; upstream ldap-backend { server {{ $.Env.LDAP_BACKEND }}:{{ or $.Env.LDAP_LOGIN_PORT "9000" }}; } ### {{ $enable_ipv6 := eq (or ($.Env.ENABLE_IPV6) "") "true" }} server { server_name _; # This is just an invalid value which will never trigger on a real hostname. listen 80; {{ if $enable_ipv6 }} listen [::]:80; {{ end }} access_log /var/log/nginx/access.log vhost; return 503; } {{ if (and (exists "/etc/nginx/certs/default.crt") (exists "/etc/nginx/certs/default.key")) }} server { server_name _; # This is just an invalid value which will never trigger on a real hostname. listen 443 ssl http2; {{ if $enable_ipv6 }} listen [::]:443 ssl http2; {{ end }} access_log /var/log/nginx/access.log vhost; return 503; ssl_session_tickets off; ssl_certificate /etc/nginx/certs/default.crt; ssl_certificate_key /etc/nginx/certs/default.key; } {{ end }} {{ range $host, $containers := groupByMulti $ "Env.VIRTUAL_HOST" "," }} {{ $host := trim $host }} {{ $is_regexp := hasPrefix "~" $host }} {{ $upstream_name := when $is_regexp (sha1 $host) $host }} # {{ $host }} upstream {{ $upstream_name }} { {{ range $container := $containers }} {{ $addrLen := len $container.Addresses }} {{ range $knownNetwork := $CurrentContainer.Networks }} {{ range $containerNetwork := $container.Networks }} {{ if (and (ne $containerNetwork.Name "ingress") (or (eq $knownNetwork.Name $containerNetwork.Name) (eq $knownNetwork.Name "host"))) }} ## Can be connected with "{{ $containerNetwork.Name }}" network {{/* If only 1 port exposed, use that */}} {{ if eq $addrLen 1 }} {{ $address := index $container.Addresses 0 }} {{ template "upstream" (dict "Container" $container "Address" $address "Network" $containerNetwork) }} {{/* If more than one port exposed, use the one matching VIRTUAL_PORT env var, falling back to standard web port 80 */}} {{ else }} {{ $port := coalesce $container.Env.VIRTUAL_PORT "80" }} {{ $address := where $container.Addresses "Port" $port | first }} {{ template "upstream" (dict "Container" $container "Address" $address "Network" $containerNetwork) }} {{ end }} {{ else }} # Cannot connect to network of this container server 127.0.0.1 down; {{ end }} {{ end }} {{ end }} {{ end }} } {{ $default_host := or ($.Env.DEFAULT_HOST) "" }} {{ $default_server := index (dict $host "" $default_host "default_server") $host }} {{/* Get the VIRTUAL_PROTO defined by containers w/ the same vhost, falling back to "http" */}} {{ $proto := trim (or (first (groupByKeys $containers "Env.VIRTUAL_PROTO")) "http") }} {{/* Get the NETWORK_ACCESS defined by containers w/ the same vhost, falling back to "external" */}} {{ $network_tag := or (first (groupByKeys $containers "Env.NETWORK_ACCESS")) "external" }} {{/* Get the HTTPS_METHOD defined by containers w/ the same vhost, falling back to "redirect" */}} {{ $https_method := or (first (groupByKeys $containers "Env.HTTPS_METHOD")) "redirect" }} {{/* Get the SSL_POLICY defined by containers w/ the same vhost, falling back to "Mozilla-Intermediate" */}} {{ $ssl_policy := or (first (groupByKeys $containers "Env.SSL_POLICY")) "Mozilla-Intermediate" }} {{/* Get the HSTS defined by containers w/ the same vhost, falling back to "max-age=31536000" */}} {{ $hsts := or (first (groupByKeys $containers "Env.HSTS")) "max-age=31536000" }} {{/* Get the VIRTUAL_ROOT By containers w/ use fastcgi root */}} {{ $vhost_root := or (first (groupByKeys $containers "Env.VIRTUAL_ROOT")) "/var/www/public" }} {{/* Nginx LDAP authentication enabled */}} {{ $ext_ldap_auth := parseBool (or (first (groupByKeys $containers "Env.LDAP_EXT_AUTH")) "false") }} {{/* User need to be participated in these groups to use service */}} {{ $ldap_add_groups := or (first (groupByKeys $containers "Env.LDAP_EXT_ADD_GROUPS")) "" }} {{/* Use HTML login page or HTTP Basic authentication */}} {{ $ldap_use_login_page := parseBool (or $.Env.LDAP_USE_LOGIN_PAGE "false" ) }} {{/* Get the first cert name defined by containers w/ the same vhost */}} {{ $certName := (first (groupByKeys $containers "Env.CERT_NAME")) }} {{/* Get the best matching cert by name for the vhost. */}} {{ $vhostCert := (closest (dir "/etc/nginx/certs") (printf "%s.crt" $host))}} {{/* vhostCert is actually a filename so remove any suffixes since they are added later */}} {{ $vhostCert := trimSuffix ".crt" $vhostCert }} {{ $vhostCert := trimSuffix ".key" $vhostCert }} {{/* Use the cert specified on the container or fallback to the best vhost match */}} {{ $cert := (coalesce $certName $vhostCert) }} {{ $is_https := (and (ne $https_method "nohttps") (ne $cert "") (or (and (exists (printf "/etc/nginx/certs/letsencrypt/live/%s/fullchain.pem" $cert)) (exists (printf "/etc/nginx/certs/letsencrypt/live/%s/privkey.pem" $cert))) (and (exists (printf "/etc/nginx/certs/%s.crt" $cert)) (exists (printf "/etc/nginx/certs/%s.key" $cert)))) ) }} {{ if $is_https }} {{ if eq $https_method "redirect" }} server { server_name {{ $host }}; listen 80 {{ $default_server }}; {{ if $enable_ipv6 }} listen [::]:80 {{ $default_server }}; {{ end }} access_log /var/log/nginx/access.log vhost; return 301 https://$host$request_uri; } {{ end }} server { server_name {{ $host }}; listen 443 ssl http2 {{ $default_server }}; {{ if $enable_ipv6 }} listen [::]:443 ssl http2 {{ $default_server }}; {{ end }} access_log /var/log/nginx/access.log vhost; {{ if eq $network_tag "internal" }} # Only allow traffic from internal clients include /etc/nginx/network_internal.conf; {{ end }} {{ if eq $ssl_policy "Mozilla-Modern" }} ssl_protocols TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256'; {{ else if eq $ssl_policy "Mozilla-Intermediate" }} ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:!DSS'; {{ else if eq $ssl_policy "Mozilla-Old" }} ssl_protocols SSLv3 TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:DES-CBC3-SHA:HIGH:SEED:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!RSAPSK:!aDH:!aECDH:!EDH-DSS-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA:!SRP'; {{ else if eq $ssl_policy "AWS-TLS-1-2-2017-01" }} ssl_protocols TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:AES128-GCM-SHA256:AES128-SHA256:AES256-GCM-SHA384:AES256-SHA256'; {{ else if eq $ssl_policy "AWS-TLS-1-1-2017-01" }} ssl_protocols TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA'; {{ else if eq $ssl_policy "AWS-2016-08" }} ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA'; {{ else if eq $ssl_policy "AWS-2015-05" }} ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:DES-CBC3-SHA'; {{ else if eq $ssl_policy "AWS-2015-03" }} ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:DHE-DSS-AES128-SHA:DES-CBC3-SHA'; {{ else if eq $ssl_policy "AWS-2015-02" }} ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:DHE-DSS-AES128-SHA'; {{ end }} ssl_prefer_server_ciphers on; ssl_session_timeout 5m; ssl_session_cache shared:SSL:50m; ssl_session_tickets off; {{ if (and (exists (printf "/etc/nginx/certs/letsencrypt/live/%s/fullchain.pem" $cert)) (exists (printf "/etc/nginx/certs/letsencrypt/live/%s/privkey.pem" $cert))) }} ssl_certificate /etc/nginx/certs/letsencrypt/live/{{ (printf "%s/fullchain.pem" $cert) }}; ssl_certificate_key /etc/nginx/certs/letsencrypt/live/{{ (printf "%s/privkey.pem" $cert) }}; {{ else if (and (exists (printf "/etc/nginx/certs/%s.crt" $cert)) (exists (printf "/etc/nginx/certs/%s.key" $cert))) }} ssl_certificate /etc/nginx/certs/{{ (printf "%s.crt" $cert) }}; ssl_certificate_key /etc/nginx/certs/{{ (printf "%s.key" $cert) }}; {{ end }} {{ if (exists (printf "/etc/nginx/certs/%s.dhparam.pem" $cert)) }} ssl_dhparam {{ printf "/etc/nginx/certs/%s.dhparam.pem" $cert }}; {{ end }} {{ if (exists (printf "/etc/nginx/certs/%s.chain.pem" $cert)) }} ssl_stapling on; ssl_stapling_verify on; ssl_trusted_certificate {{ printf "/etc/nginx/certs/%s.chain.pem" $cert }}; {{ end }} {{ if (and (ne $https_method "noredirect") (ne $hsts "off")) }} add_header Strict-Transport-Security "{{ trim $hsts }}" always; {{ end }} {{ if (exists (printf "/etc/nginx/vhost.d/%s" $host)) }} include {{ printf "/etc/nginx/vhost.d/%s" $host }}; {{ else if (exists "/etc/nginx/vhost.d/default") }} include /etc/nginx/vhost.d/default; {{ end }} {{ if ($ext_ldap_auth) }} ### LDAP {{ if ($ldap_use_login_page) }} location /login-ldap { proxy_pass http://{{ $.Env.LDAP_BACKEND }}:{{ or $.Env.LDAP_LOGIN_PORT "9000" }}; # Login service returns a redirect to the original URI # and sets the cookie for the ldap-auth daemon proxy_set_header X-Target $request_uri; proxy_pass_request_body off; proxy_set_header Content-Length ""; proxy_cache auth_cache; proxy_cache_valid 200 10m; proxy_cache_key "$http_authorization$cookie_nginxauth"; proxy_set_header X-CookieName "nginxauth"; proxy_set_header Cookie nginxauth=$cookie_nginxauth; } {{ end }} location = /auth-proxy { internal; # The ldap-auth daemon listens on port $LDAP_BACKEND_PORT (8888, by default), as set # in nginx-ldap-auth-daemon.py. # Change the IP address if the daemon is not running on # the same host as NGINX/NGINX Plus. proxy_pass http://{{ $.Env.LDAP_BACKEND }}:{{ or $.Env.LDAP_BACKEND_PORT "8888" }}; proxy_pass_request_body off; proxy_set_header Content-Length ""; proxy_cache auth_cache; proxy_cache_valid 200 10m; # The following directive adds the cookie to the cache key proxy_cache_key "$http_authorization$cookie_nginxauth"; # As implemented in nginx-ldap-auth-daemon.py, the ldap-auth daemon # communicates with a LDAP server, passing in the following # parameters to specify which user account to authenticate. To # eliminate the need to modify the Python code, this file contains # 'proxy_set_header' directives that set the values of the # parameters. Set or change them as instructed in the comments. # # Parameter Proxy header # ----------- ---------------- # url X-Ldap-URL # starttls X-Ldap-Starttls # basedn X-Ldap-BaseDN # binddn X-Ldap-BindDN # bindpasswd X-Ldap-BindPass # cookiename X-CookieName # realm X-Ldap-Realm # template X-Ldap-Template # (Required) Set the URL and port for connecting to the LDAP server, # by replacing 'example.com'. # Do not mix ldaps-style URL and X-Ldap-Starttls as it will not work. proxy_set_header X-Ldap-URL "{{ $.Env.LDAP_HOST }}"; # (Optional) Establish a TLS-enabled LDAP session after binding to the # LDAP server. # This is the 'proper' way to establish encrypted TLS connections, see # http://www.openldap.org/faq/data/cache/185.html {{ if eq ("$.Env.LDAP_METHOD") "start_tls" }} proxy_set_header X-Ldap-Starttls "true"; {{ end }} # (Required) Set the Base DN, by replacing the value enclosed in # double quotes. proxy_set_header X-Ldap-BaseDN "{{ $.Env.LDAP_BASE }}"; # (Required) Set the Bind DN, by replacing the value enclosed in # double quotes. proxy_set_header X-Ldap-BindDN "{{ $.Env.LDAP_BIND_DN }}"; # (Required) Set the Bind password, by replacing 'secret'. proxy_set_header X-Ldap-BindPass "{{ $.Env.LDAP_PASS }}"; # (Required) The following directives set the cookie name and pass # it, respectively. They are required for cookie-based # authentication. Comment them out if using HTTP basic # authentication. proxy_set_header X-CookieName "nginxauth"; proxy_set_header Cookie nginxauth=$cookie_nginxauth; # (Required if using Microsoft Active Directory as the LDAP server) # Set the LDAP template by uncommenting the following directive. #proxy_set_header X-Ldap-Template "(sAMAccountName=%(username)s)"; # (May be required if using Microsoft Active Directory and # getting "In order to perform this operation a successful bind # must be completed on the connection." errror) #proxy_set_header X-Ldap-DisableReferrals "true"; # (Optional if using OpenLDAP as the LDAP server) Set the LDAP # template by uncommenting the following directive and replacing # '(cn=%(username)s)' which is the default set in # nginx-ldap-auth-daemon.py. {{ $ldap_filter := $.Env.LDAP_USER_FILTER }} {{ $ldap_filter := (printf "(&amp;%s%s)" $ldap_filter $ldap_add_groups) }} proxy_set_header X-Ldap-Template "{{ $ldap_filter }}"; # (Optional) Set the realm name, by uncommenting the following # directive and replacing 'Restricted' which is the default set # in nginx-ldap-auth-daemon.py. #proxy_set_header X-Ldap-Realm "Restricted"; } ### /LDAP {{ end }} location / { {{ if ($ext_ldap_auth) }} auth_request /auth-proxy; {{ if ($ldap_use_login_page) }} # redirect 401 to login form # Comment them out if using HTTP basic authentication. # or authentication popup won't show error_page 401 =200 /login-ldap; {{ end }} {{ end }} {{ if eq $proto "uwsgi" }} include uwsgi_params; uwsgi_pass {{ trim $proto }}://{{ trim $upstream_name }}; {{ else if eq $proto "fastcgi" }} root {{ trim $vhost_root }}; include fastcgi.conf; fastcgi_pass {{ trim $upstream_name }}; {{ else }} proxy_pass {{ trim $proto }}://{{ trim $upstream_name }}; {{ end }} {{ if (exists (printf "/etc/nginx/htpasswd/%s" $host)) }} auth_basic "Restricted {{ $host }}"; auth_basic_user_file {{ (printf "/etc/nginx/htpasswd/%s" $host) }}; {{ end }} {{ if (exists (printf "/etc/nginx/vhost.d/%s_location" $host)) }} include {{ printf "/etc/nginx/vhost.d/%s_location" $host}}; {{ else if (exists "/etc/nginx/vhost.d/default_location") }} include /etc/nginx/vhost.d/default_location; {{ end }} } } {{ end }} {{ if or (not $is_https) (eq $https_method "noredirect") }} server { server_name {{ $host }}; listen 80 {{ $default_server }}; {{ if $enable_ipv6 }} listen [::]:80 {{ $default_server }}; {{ end }} access_log /var/log/nginx/access.log vhost; {{ if eq $network_tag "internal" }} # Only allow traffic from internal clients include /etc/nginx/network_internal.conf; {{ end }} {{ if (exists (printf "/etc/nginx/vhost.d/%s" $host)) }} include {{ printf "/etc/nginx/vhost.d/%s" $host }}; {{ else if (exists "/etc/nginx/vhost.d/default") }} include /etc/nginx/vhost.d/default; {{ end }} location / { {{ if eq $proto "uwsgi" }} include uwsgi_params; uwsgi_pass {{ trim $proto }}://{{ trim $upstream_name }}; {{ else if eq $proto "fastcgi" }} root {{ trim $vhost_root }}; include fastcgi.conf; fastcgi_pass {{ trim $upstream_name }}; {{ else }} proxy_pass {{ trim $proto }}://{{ trim $upstream_name }}; {{ end }} {{ if (exists (printf "/etc/nginx/htpasswd/%s" $host)) }} auth_basic "Restricted {{ $host }}"; auth_basic_user_file {{ (printf "/etc/nginx/htpasswd/%s" $host) }}; {{ end }} {{ if (exists (printf "/etc/nginx/vhost.d/%s_location" $host)) }} include {{ printf "/etc/nginx/vhost.d/%s_location" $host}}; {{ else if (exists "/etc/nginx/vhost.d/default_location") }} include /etc/nginx/vhost.d/default_location; {{ end }} } } {{ if (and (not $is_https) (exists "/etc/nginx/certs/default.crt") (exists "/etc/nginx/certs/default.key")) }} server { server_name {{ $host }}; listen 443 ssl http2 {{ $default_server }}; {{ if $enable_ipv6 }} listen [::]:443 ssl http2 {{ $default_server }}; {{ end }} access_log /var/log/nginx/access.log vhost; return 500; ssl_certificate /etc/nginx/certs/default.crt; ssl_certificate_key /etc/nginx/certs/default.key; } {{ end }} {{ end }} {{ end }}</span></span></code> </pre> </div></div><br><h3 id="modifikaciya-konfiguracii-docker-compose" style=";text-align:right;direction:rtl">  Ø¹Ø§Ù…Ù„ ØªÙƒÙˆÙŠÙ† ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªÙƒÙˆÙŠÙ† </h3><br><p style=";text-align:right;direction:rtl">  ÙÙŠ <code>docker-compose.yml</code> Ø£Ø¶ÙŠÙØª: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø© "ldap-auth" ØŒ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ø§Ù„ØªØ±Ø®ÙŠØµ. </li><li style=";text-align:right;direction:rtl">  ÙƒØªÙ„Ø© Ù…Ù† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªÙŠ ØªÙ‚ÙˆÙ… Ø¨ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª Ù…Ø¹ Ø®Ø§Ø¯Ù… LDAP. </li></ul><br><p style=";text-align:right;direction:rtl">  Ù…Ø§ Ù‡Ùˆ Ù…ÙƒØªÙˆØ¨ ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ØŒ Ø³ÙŠÙ…Ø± nginx Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø±Ø¤ÙˆØ³ HTTP. <br>  Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª ÙˆØ§Ø¶Ø­ Ù…Ù† Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ØªØºÙŠØ±Ø© ØŒ Ù„Ø°Ù„Ùƒ Ù„Ù† Ø£ØªÙ†Ø§ÙˆÙ„Ù‡Ø§. <br>  Ø§Ù†Ø¸Ø± Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„ÙƒØ§Ù…Ù„ Ø£Ø¯Ù†Ø§Ù‡. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ø¹Ø§Ù…Ù„ Ù…ÙŠÙ†Ø§Ø¡-compose.yml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">version: '2' networks: internal: docker0: external: name: docker0 services: ldap-auth: image: linuxserver/ldap-auth:latest container_name: ldap-auth networks: - internal - docker0 environment: - TZ=Europe/Moscow expose: - 8888 - 9000 restart: unless-stopped nginx-proxy: depends_on: - ldap-auth networks: - internal - docker0 restart: always image: jwilder/nginx-proxy ports: - "80:80" - "443:443" volumes: - ./certs:/etc/nginx/certs:ro - ./vhost.d:/etc/nginx/vhost.d - ./html:/usr/share/nginx/html - /var/run/docker.sock:/tmp/docker.sock:ro - ./local-config:/etc/nginx/conf.d - ./nginx.tmpl:/app/nginx.tmpl environment: - DEFAULT_HOST=nas.nas - LDAP_BACKEND=ldap-auth #- LDAP_BACKEND_PORT=8888 #- LDAP_LOGIN_PORT=9000 - LDAP_HOST=ldap://172.21.0.1:389 #- LDAP_METHOD=start_tls - LDAP_METHOD=plain - LDAP_UID=uid - LDAP_PASS=LDAP_PASSWORD - LDAP_BASE=ou=users,dc=nas,dc=nas - LDAP_BIND_DN=cn=readonly,dc=nas,dc=nas - LDAP_USER_FILTER=(uid=%(username)s) #- LDAP_USE_LOGIN_PAGE=true labels: - "com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy=true" letsencrypt-dns: image: adferrand/letsencrypt-dns restart: always volumes: - ./certs/letsencrypt:/etc/letsencrypt environment: - "LETSENCRYPT_USER_MAIL=MAIL@MAIL.COM" - "LEXICON_PROVIDER=cloudns" - "LEXICON_OPTIONS=--delegated NAS.cloudns.cc" - "LEXICON_PROVIDER_OPTIONS=--auth-id=CLOUDNS_ID --auth-password=CLOUDNS_PASSWORD"</code> </pre> </div></div><br><h2 id="ispolzovanie-servisom" style=";text-align:right;direction:rtl">  Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø®Ø¯Ù…Ø© </h2><br><p style=";text-align:right;direction:rtl">  ÙŠØªÙ… Ø¥ÙŠÙ‚Ø§Ù ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ. <br>  Ù„ØªÙ…ÙƒÙŠÙ†Ù‡ ØŒ ÙŠÙƒÙÙŠ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>LDAP_EXT_AUTH=true</code> - ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. </li><li style=";text-align:right;direction:rtl">  <code>LDAP_EXT_ADD_GROUPS=(memberOf=cn=users_cloud,ou=groups,dc=nas,dc=nas)</code> - Ù…Ø±Ø´Ø­ Ø§Ø®ØªÙŠØ§Ø±ÙŠ ØŒ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ†ØªÙ…ÙŠ Ø¥Ù„ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø£Ø¬Ù„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©.  Ù‡Ø°Ø§ ÙŠÙˆÙØ± Ø§Ù„Ø¯Ø¹Ù… Ø¥Ø°Ù†. </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> environment: - LDAP_EXT_AUTH=true - LDAP_EXT_ADD_GROUPS=(memberOf=cn=users_cloud,ou=groups,dc=nas,dc=nas)</code> </pre> <br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  Ø§Ø³ØªÙ†ØªØ§Ø¬ </h2><br><p style=";text-align:right;direction:rtl">  Ø¨Ø´ÙƒÙ„ Ø¹Ø§Ù… ØŒ ÙƒØ§Ù† Ø§Ù„Ø­Ù„ ÙŠØ¹Ù…Ù„ Ù„ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø© ÙˆÙŠÙˆÙØ± Ù„ÙŠØ³ ÙÙ‚Ø· Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ØŒ ÙˆÙ„ÙƒÙ† Ø£ÙŠØ¶Ù‹Ø§ Ø§Ù„ØªÙÙˆÙŠØ¶. <br>  ÙŠØªÙŠØ­ Ù„Ùƒ Ø°Ù„Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙŠ Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ø­Ø§ÙˆÙŠØ§Øª ÙÙŠ NAS ØŒ Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØªØ¯Ø¹Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ù† Ø®Ù„Ø§Ù„ LDAP. </p><br><p style=";text-align:right;direction:rtl">  Ø±ØºÙ… ÙˆØ¬ÙˆØ¯ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">         HTML ,   <code>ldap_use_login_page</code> .       .   â€” . </li><li style=";text-align:right;direction:rtl">    .     LDAP ,   ,   docker-gen      . </li><li style=";text-align:right;direction:rtl">  ,     .        ,     ,       ,  .       . </li></ul><br><p style=";text-align:right;direction:rtl">  NAS     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar456894/">https://habr.com/ru/post/ar456894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar456880/index.html">Ù„Ù…Ø§Ø°Ø§ ÙŠÙØªØ­ Math.Round Ù†Ø§ÙØ°Ø© Ø·Ø¨Ø§Ø¹Ø© Ù…Ù† Ù…Ø³ØªØ¹Ø±Ø¶ ÙÙŠ Try .NET</a></li>
<li><a href="../ar456886/index.html">ASO Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©: ÙƒÙŠÙ ØªÙÙˆØª Ø´ÙŠØ¦Ø§</a></li>
<li><a href="../ar456888/index.html">ÙƒÙŠÙ ØªØ°ÙˆØ¨ Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© ÙÙŠ Ø¬Ùˆ Ø§Ù„Ø£Ø±Ø¶</a></li>
<li><a href="../ar456890/index.html">Ø§Ù„Ø£Ø´Ø¹Ø© ØªØ­Øª Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ù„Ù„ØªØ­ÙƒÙ… Ø¹Ù† Ø¨Ø¹Ø¯ Ø¹Ù„Ù‰ stm32</a></li>
<li><a href="../ar456892/index.html">ÙƒÙŠÙÙŠØ© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆÙŠØ¨: Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø«Ù…Ø§Ù†ÙŠØ© Ù…Ø§Ø³Ø­Ø§Øª Ø¶ÙˆØ¦ÙŠØ© Ø´Ø§Ø¦Ø¹Ø©</a></li>
<li><a href="../ar456896/index.html">ØªØ­Ø¯ÙŠØ¯ Ø¹Ù†Ø§ÙˆÙŠÙ† IP Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠ Ø´Ø¨ÙƒØ© Tor Ù…Ù† Ø®Ù„Ø§Ù„ Ø°Ø§ÙƒØ±Ø© ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ù…Ø´ÙˆÙ‡Ø©</a></li>
<li><a href="../ar456898/index.html">Ø¶Ø±Ø¨ Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­ Ø³Ø±ÙŠØ¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„</a></li>
<li><a href="../ar456902/index.html">ØªØ£Ù…ÙŠÙ† Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¯ÙØ¹: Ù…Ù† Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø©</a></li>
<li><a href="../ar456904/index.html">ØªØ­Ù…ÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø´Ø±ÙˆØ¹ Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª - Ù„Ø§ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©</a></li>
<li><a href="../ar456908/index.html">ÙƒÙŠÙ Ø¯Ù…Ø¬Ùƒ Telegram ÙÙŠ Rostelecom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>