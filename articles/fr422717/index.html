<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø üâë üëµüèª D√©veloppement d'un chat bot avec une personnalit√© donn√©e. Conf√©rence √† Yandex ü•à ü§òüèº ü¶à</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une caract√©ristique importante des t√¢ches d'apprentissage automatique est que des r√©sultats tout aussi bons peuvent √™tre obtenus en utilisant diff√©ren...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©veloppement d'un chat bot avec une personnalit√© donn√©e. Conf√©rence √† Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/422717/">  Une caract√©ristique importante des t√¢ches d'apprentissage automatique est que des r√©sultats tout aussi bons peuvent √™tre obtenus en utilisant diff√©rentes m√©thodes.  Cela donne de l'enthousiasme aux comp√©titions ML: m√™me en ayant d'autres comp√©tences qu'un adversaire manifestement fort, vous pouvez toujours gagner.  Les √©quipes Tensorborne et Neurobotics avaient des chances presque √©gales de gagner le hackathon DeepHack et ont finalement pris les deux premi√®res places.  Lors de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">formation Yandex, les</a> repr√©sentants des deux √©quipes ont fait un volumineux rapport.  Dans le d√©codage, vous trouverez une analyse d√©taill√©e des solutions et des conseils pour les concurrents d√©butants. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qSehSTWMXaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  Et bien s√ªr, prenez des vacances de hackathon.  Lorsque vous participez √† un hackathon hebdomadaire et travaillez en m√™me temps, c'est mauvais.  Vous arrivez √† 19 heures, apr√®s avoir travaill√© un peu, asseyez-vous et compilez Docker avec TensorFlow, Keras, pour que tout cela commence sur certains serveurs distants auxquels vous n'avez m√™me pas acc√®s.  Quelque part en deux nuits, vous attrapez la catharsis, et cela fonctionne pour vous - sans Docker, sans tout, parce que vous avez compris que c'est possible et ainsi. </blockquote><br><a name="habracut"></a>  Vitaly Davydov: <br>  - Bonjour √† tous!  Nous aurions d√ª avoir deux rapports, mais nous avons d√©cid√© de les combiner en un seul, car nous parlons de la premi√®re et de la deuxi√®me place dans la comp√©tition DeepHack.  Nous repr√©sentons deux √©quipes.  Notre √©quipe Tensorborne a pris la 2e place, et l'√©quipe de Gregory Neurobotics - la premi√®re. <br><br><img src="https://habrastorage.org/webt/hp/da/wx/hpdawx6cghpeiebf6nkmnxwieno.jpeg"><br>  Le rapport comprendra trois parties principales.  Dans l'intro, je vais parler de l'histoire de DeepHack, de ce que c'est, des mesures, etc. Ensuite, les gars parleront de solutions, de quels probl√®mes, d'exemples, etc. <br><br>  Avant de parler de DeepHack, il convient de noter qu'il s'agit d'un petit sous-ensemble d'une autre tr√®s grande comp√©tition mondiale ConvAI2, qui a lanc√© Facebook l'ann√©e derni√®re.  Cette ann√©e est la deuxi√®me it√©ration.  √Ä un moment donn√©, Facebook a parrain√© l'Institut de physique et de technologie de Moscou, et le concours DeepHack a √©t√© cr√©√© sur la base du laboratoire PhysTech. <br><br><img src="https://habrastorage.org/webt/k7/de/a-/k7dea-py5v-x3gr47seesnhpfge.jpeg"><br>  En savoir plus sur ConvAI lui-m√™me.  Quel probl√®me essaie-t-il de r√©soudre?  Il est sp√©cialis√© dans les syst√®mes interactifs.  Le probl√®me avec les syst√®mes de dialogue est qu'il n'y a pas d'outil d'√©valuation unique, un outil d'√©valuation, pour comprendre la qualit√© des dialogues.  Cette chose est tr√®s subjective d'une personne √† l'autre: quelqu'un peut aimer la conversation, pas quelqu'un.  La t√¢che globale g√©n√©rale de ConvAI est de proposer une m√©trique unifi√©e commune pour l'√©valuation des dialogues, qui n'est pas encore disponible.  Prix ‚Äã‚Äã- 20 000 $ pour AWS Mechanical Turk.  Ce ne sont pas des pr√™ts √† Amazon, ce ne sont que des pr√™ts √† Mechanical Turk, qui est en fait un analogue de Yandex.Tolki.  Il s'agit d'un service de crowdsourcing qui vous permet de faire du balisage sur les donn√©es. <br><br>  La t√¢che, qui est construite sur ConvAI, est de construire un chit-chat-bot avec lequel vous pouvez faire une sorte de dialogue.  Ils ont choisi trois mesures: Perplexit√©, Hits @ 1 et F1.  Je vais maintenant montrer le tableau qui √©tait au moment de notre pr√©sentation. <br><br>  L'√©valuation par laquelle ils ont essay√© de le faire est pass√©e par trois √©tapes.  La premi√®re √©tape est la mesure automatique, puis l'√©valuation AWS Mechanical Turk, puis le chat en direct avec des b√©n√©voles. <br><br>  Puisque ConvAI est parrain√© par Facebook, il promeut activement sa biblioth√®que pour cr√©er des syst√®mes conversationnels ParlAI.  C'est assez compliqu√©, mais je pense que tous les participants ont utilis√© cette biblioth√®que.  Nous l'avons trait√© pendant un certain temps, il n'est pas compatible avec Python 3.6, par exemple, et il y a un certain nombre de probl√®mes. <br><br><img src="https://habrastorage.org/webt/yp/xk/ew/ypxkewtucztkiznh_vqrienqxoe.jpeg"><br><br>  Dans ces quelques lignes, vous pouvez voir quels postes nous occupions au moment de la soumission.  En g√©n√©ral, ConvAI est √©trangement organis√© dans le sens o√π il y a trois m√©triques et on ne sait pas tr√®s bien comment va le classement sur ce tableau.  On peut voir que pour certaines mesures, certaines √©quipes sont plus √©lev√©es, pour certaines plus faibles.  L'organisation de l'ensemble du ConvAI √©tait un peu √©trange. <br><br>  Mais il y a trois bases de base.  Pour se qualifier pour DeepHack, il a fallu briser cette ligne de base et les 10 meilleures √©quipes se sont qualifi√©es pour la finale.  En secret, je dirai que seules 8 √©quipes ont envoy√© des d√©cisions et que tout le monde a atteint la finale.  Ce n'√©tait pas tr√®s difficile. <br><br><img src="https://habrastorage.org/webt/vb/ra/mg/vbramgip1a-tkhp33opnd0nxiic.jpeg"><br><br>  La t√¢che de DeepHack √©tait un peu plus compr√©hensible et simple.  Nous devions √† nouveau construire un robot de conversation, mais qui imiterait une personnalit√© donn√©e.  Autrement dit, le robot a re√ßu une description d'une personne √† l'entr√©e, et lors d'une conversation avec lui, il a d√ª la r√©v√©ler.  Le prix √©tait assez int√©ressant - un voyage au NIPS cet automne, qui est enti√®rement parrain√©. <br><br>  La m√©trique, contrairement √† ConvAI, √©tait d√©j√† diff√©rente.  Il y avait deux mesures, et la mesure totale est pond√©r√©e entre les deux.  La premi√®re mesure est la qualit√© globale, une √©valuation de la fa√ßon dont le bot a r√©pondu de mani√®re ad√©quate, √† quel point il √©tait int√©ressant de communiquer avec lui, s'il √©crivait des ordures, etc. La deuxi√®me mesure est un jeu de r√¥le, 0 ou 1. Cela signifie Le bot est-il entr√© dans la description qui lui a √©t√© donn√©e?  La personne qui communique avec le bot ne voit pas la description.  L'√©valuation a eu lieu dans Telegram, c'est-√†-dire qu'il n'y avait qu'un seul bot Telegram, et quand l'utilisateur a commenc√© √† communiquer avec lui, il est arriv√© √† un bot al√©atoire de toutes les soumissions, pour √™tre honn√™te.  Yandex et MIPT, apparemment, y ont vers√© un peu de trafic, et il y a eu environ 10 000 dialogues, si je me souviens bien. <br><br>  J'ai d√©j√† parl√© du tour de qualification.  La finale √©tait √† plein temps.  Cela s'est d√©roul√© pendant sept jours de travail √† l'Institut de physique et de technologie de Moscou, un cluster a √©t√© fourni, une place, nous nous sommes assis et avons travaill√© l√†-bas.  L'√©valuation √©tait en fait tous les jours, et le score final, la note du bot √† la fin, √©tait calcul√© de cette fa√ßon.  Le concours a commenc√© lundi, la premi√®re soumission a eu lieu mardi et l'√©valuation a eu lieu le lendemain.  La solution que vous avez publi√©e mardi a √©t√© √©valu√©e mercredi avec un poids de 1,5.  Ce que vous avez envoy√© mercredi - avec un poids de 1,4, etc. <br><br><img src="https://habrastorage.org/webt/1x/4m/mc/1x4mmcu5p_2jo49ppvjceah0yhc.jpeg"><br><br>  √Ä propos de l'ensemble de donn√©es que Facebook a donn√© pour la formation.  Il s'appelle Persona-Chat et est une description de deux personnalit√©s et d'un ensemble de dialogues.  Il y a une description de la premi√®re personne et de la seconde.  Dans le processus de description du dialogue, ils essaient de se r√©v√©ler.  C'est tout ce qui a √©t√© donn√©.  Cependant, comme toujours, dans la comp√©tition, il n'√©tait pas interdit d'utiliser d'autres ensembles de donn√©es tiers. <br><br><img src="https://habrastorage.org/webt/my/jx/hn/myjxhn7rt6krkci69o_vqwtpguq.jpeg"><br><br>  Un exemple du dialogue de notre √©quipe.  Si vous lisez attentivement, il est clair que le bot r√©sultant fonctionne de mani√®re tout √† fait ad√©quate et r√©pond tout √† fait correctement. <br><br>  Gregory parlera de la premi√®re place. <br><br>  Grigory Rashkov: <br>  - Je voudrais parler de notre exp√©rience de participation au concours, de notre strat√©gie et de notre d√©cision. <br><br><img src="https://habrastorage.org/webt/rc/an/5v/rcan5v9ajugvnsojkpgrgactbv4.jpeg"><br><br>  Premi√®rement, la particularit√© de la comp√©tition est qu'elle est longue, nous n'avons pas eu deux jours, comme sur un hackathon ordinaire, mais cinq jours, pour lesquels nous avons pu prendre de nombreuses d√©cisions. <br><br><img src="https://habrastorage.org/webt/v_/t7/4_/v_t74_uw45cd7shzhtaog-frdnu.jpeg"><br><br>  √âvaluations tr√®s subjectives, car des personnes compl√®tement diff√©rentes ont √©valu√© leurs crit√®res, en particulier, l'organisateur du hackathon Mikhail Bubtsev a dit que s'il devinait m√™me de quel profil il parlait, mais que le bot √† un moment donn√© contredisait son profil, il n'a pas r√©pondu √† la question , comme il est √©crit, il a choisi un profil diff√©rent, m√™me s'il savait de quoi il s'agissait. <br><br>  Et le troisi√®me est le manque de validation.  Les participants n'ont pas pu faire un petit changement et recevoir imm√©diatement des commentaires. <br><br>  Comme dans tous les films d'horreur, notre √©quipe a tout de suite d√©cid√© de se s√©parer.  Le premier groupe √©tait engag√© dans notre solution principale bas√©e sur le Wasserstein GAN, le deuxi√®me groupe √©tait engag√© dans le bot, le panneau d'administration du bot bas√© sur la ligne de base.  Parce que nous devions envoyer quelque chose le premier et le deuxi√®me jour. <br><br><img src="https://habrastorage.org/webt/za/ij/6e/zaij6evz4_vpbuepprwokz1pylq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien depuis la diapositive</a></sup></sub> </h5><br>  En bref sur la ligne de base: Seq2Seq plus l'attention, qui est l√©g√®rement adapt√©e √† cette t√¢che sp√©cifique.  Comment exactement?  Une phrase est envoy√©e √† l'entr√©e, l'incorporation est tir√©e de GloVe, mais la pr√©sentation de chaque phrase en tant qu'incorporation pond√©r√©e est examin√©e plus avant.  Les poids sont s√©lectionn√©s en fonction de la fr√©quence inverse du mot.  Plus un mot appara√Æt rarement, plus il a de poids. <br><br><img src="https://habrastorage.org/webt/t_/go/g_/t_gog_ke6ovdcl7sblmigcnxdcm.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien depuis la diapositive</a></sup></sub> </h5><br>  Cela est n√©cessaire pour refl√©ter le caract√®re unique de ces caract√©ristiques.  Tout allait √† un ensemble, une matrice, un masque a √©t√© construit sur la base de cet ensemble et d'un √©tat cach√©, puis ce masque a √©t√© superpos√© √† l'ensemble, un contexte a √©t√© obtenu, puis il a √©t√© connect√©, par le biais de la non-lin√©arit√©, il a √©t√© envoy√© √† l'entr√©e des d√©codeurs. <br><br><img src="https://habrastorage.org/webt/en/x-/ht/enx-htbfplt1is1kptc43ir_jh8.jpeg"><br><br>  Pour le premier jour, nous n'avons pas encore √©crit notre d√©cision, nous avons d√ª envoyer quelque chose, alors nous avons √©crit un agent bas√© sur la ligne de base, mais nous nous sommes fix√© pour t√¢che de nous d√©marquer d'une mani√®re ou d'une autre de la masse grise des agents.  Pour ce faire, nous avons utilis√© des heuristiques simples, notre bot a √©t√© le premier √† entamer un dialogue, et il a utilis√© un sourire dans cette phrase.  Et √ßa a march√©. <br><br><img src="https://habrastorage.org/webt/iv/om/qv/ivomqvl3tvsedmrb0bnj7dyqg40.jpeg"><br>  Naturellement, le lendemain, tous les bots ont commenc√© √† √™tre cr√©√©s en premier, et tous avaient des √©motic√¥nes.  Le deuxi√®me jour, les habitants de Vilabaggio ont continu√© √† travailler avec le GAN, les habitants de Vilaribo ont essay√© d'autres heuristiques. <br><br><img src="https://habrastorage.org/webt/qe/pw/w-/qepww-mi4akk5qpehjzs2lmxjn4.jpeg"><br><br>  En cons√©quence, le score sur la qualit√© du dialogue s'est l√©g√®rement am√©lior√©, mais nous avons √©t√© d√©pass√©s par la personne.  Ce sont les r√©sultats du troisi√®me jour, il ne restait que deux jours.  Nous avons compris que ce ne serait pas assez de temps pour nous d'√©crire un GAN et de le tester normalement, car il √©tudie depuis longtemps, dur, nous devons s√©lectionner beaucoup d'hyperparam√®tres.  Nous avons donc d√©cid√© de passer √† la ligne de base, car cela fonctionne si bien. <br><br><img src="https://habrastorage.org/webt/a3/m5/cw/a3m5cw5nw_wfsgc9tk9kaxskxi4.jpeg"><br>  Notre t√¢che √©tait d'am√©liorer la reconnaissance du profil utilisateur.  Nous avons propos√© une telle heuristique.  Quel √©tait le probl√®me?  L'utilisateur a heureusement parl√© avec le bot, lui demandant quel genre de travail il avait, ses loisirs, quel type de voiture il conduisait, le bot a bien r√©pondu √† tout cela, car le bot a g√©n√©ralement bien r√©pondu.  En cons√©quence, √† la fin du dialogue, l'utilisateur a vu deux profils qui n'avaient rien √† voir avec ce qui √©tait dans le dialogue, simplement parce que d'autres choses y √©taient indiqu√©es que celles demand√©es par l'utilisateur.  Par cons√©quent, nous avons d√©cid√© qu'il √©tait n√©cessaire de donner en quelque sorte des informations √† partir du profil. <br><br>  Comment faire cela de la mani√®re la plus logique?  Si une personne a des int√©r√™ts, elle en parlera probablement, cherchez des int√©r√™ts communs.  Par cons√©quent, nous avons d√©cid√© que le bot poserait √† certains moments des questions sur la base de son profil.  Il y avait un effet int√©ressant que le g√©n√©rateur, qui a √©t√© √©crit simplement selon les r√®gles linguistiques de G, utilise un fait A du profil, par cons√©quent, G (A) est entr√© dans la bo√Æte de dialogue, tout cela est envoy√© √† la m√©moire du bot, et la prochaine fois que le mod√®le g√©n√®re des informations, proc√©dant √† la fois du profil et de ce dialogue, c'est-√†-dire, avec une plus grande probabilit√©, il dira quelque chose li√© au profil. <br><br><img src="https://habrastorage.org/webt/t0/vu/xu/t0vuxufzqe-c-whihwkby1isxpe.jpeg"><br><br>  √Ä quoi cela ressemblait-il en r√©alit√©?  Le robot dans le profil dit qu'il est ravi de la po√©sie, puis pendant la conversation, il me demande si j'aime la po√©sie.  Je dis oui, et plus loin sur son mod√®le, pas le g√©n√©rateur que nous avons construit selon les r√®gles, dit qu'il aime √©crire de la po√©sie.  Ainsi, le bot s'est concentr√© sur son profil, et cela a fonctionn√©. <br><br><img src="https://habrastorage.org/webt/ls/tt/ku/lsttkui4jcn6v60olkqym-vbnvy.jpeg"><br><br>  Nous sommes revenus √† la premi√®re place.  Le dernier jour est rest√©.  Nous avons remarqu√© que nous perdons n√©anmoins en tant que dialogue. <br><br><img src="https://habrastorage.org/webt/cz/yz/wl/czyzwlynpgq0fl-k5e_ntgwzhbo.jpeg"><br>  Nous avons profit√© de plusieurs autres solutions.  Tout d'abord, ils ont utilis√© la paraphrase, analys√© ce que les autres ont dit, car les organisateurs ont pr√©sent√© cette base de donn√©es et ont remarqu√© que beaucoup de gens communiquent avec le bot n'est pas tout √† fait correct. <br><br><img src="https://habrastorage.org/webt/qy/tn/j-/qytnj-tpdkh8tsrza2iwwjpydgq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien depuis la diapositive</a></sup></sub> </h5><br>  Il y a un minimum local int√©ressant au bot: il r√©pond tr√®s bien √† toutes les insultes, il est d'accord avec elles, et pour corriger cela, nous avons d√©cid√© d'utiliser la comp√©tition Kaggle pour l'analyseur de commentaires toxiques, nous avons √©crit un classificateur tr√®s simple, √©galement avec l'attention de RNN.  Dans cet ensemble de donn√©es, il y avait les classes suivantes, qui se chevauchaient: insultes, menaces ... Nous avons d√©cid√© de ne pas √©tudier le mod√®le s√©par√©ment, qui parlera, car un tel probl√®me a √©t√© rencontr√©, mais il n'√©tait pas tr√®s fr√©quent.  Par cons√©quent, nous venons d'√©crire une sorte de gag auquel le bot a r√©pondu, et tout le monde √©tait content. <br><br><img src="https://habrastorage.org/webt/gc/vh/by/gcvhbyftcrlzu-f3sqzmkdenews.jpeg"><br>  De plus, nous avons utilis√© la paraphrase pour enrichir le discours de notre bot.  Ce n'√©tait pas non plus tr√®s difficile, nous avons remplac√© les mots de la phrase par des synonymes, regard√© les n-grammes r√©sultants dans la phrase, afin qu'ils ne diff√®rent pas beaucoup de ceux qui √©taient √† l'origine, puis nous avons choisi la combinaison la plus appropri√©e pour la phrase avec la plus grande probabilit√©. <br><br><img src="https://habrastorage.org/webt/of/je/dm/ofjedmtylm9iyyx76jwudzg6zxw.jpeg"><br><br>  Comme exemple de ce qui s'est pass√©, le bot ici dit qu'il aime √©couter de la musique, il dit appr√©cier dans le profil, il a √©t√© remplac√© par comme avec nous.  Nous ne savons pas si le mod√®le lui-m√™me ou notre Paraphraser l'a g√©n√©r√©, mais cette chose est pass√©e.  Une autre remarque qu'il √©tait impossible d'envoyer uniquement des donn√©es du profil.  Des pentagrammes y ont √©t√© compar√©s.  Si les pentagrammes co√Øncidaient avec votre remarque et votre profil, alors simplement cette phrase ne passait pas, les organisateurs l'ont arrang√©e.  De plus, entre autres, nous avons ajout√© un dictionnaire de smiley. <br><br><img src="https://habrastorage.org/webt/xk/5z/tx/xk5ztxz1m61eiqhjk0cm9tgcef4.jpeg"><br><br>  Le deuxi√®me exemple, nous avons beaucoup de sourires.  Puis il y a eu l'heuristique, lorsque le bot a r√©agi √† votre comportement que vous ne lui avez pas √©crit pendant longtemps.  Paraphraser a √©galement fonctionn√© ici et a donn√© un bon r√©sultat. <br><img src="https://habrastorage.org/webt/hk/sg/uj/hksgujdi_dp2pt0uny6qhme2saw.jpeg"><br>  La qualit√© du dialogue √©tait la meilleure, la qualit√© de jouer le r√¥le aussi. <br><br>  Nous avons essay√© de faire en sorte que le mod√®le g√©n√®re un ensemble d'options et nous les avons compar√©es au profil.  Mais il me semblait que dans ce cas le bot fonctionnait moins bien, on ne pouvait pas faire de validation, seulement des √©valuations subjectives en deux ou trois conversations.  Par cons√©quent, ils ont d√©cid√© de ne pas mettre une telle chose, car le profil √©tait d√©j√† bien reconnu. <br><br>  Ensuite, nous avons √©crit une solution au probl√®me inverse, le deuxi√®me mod√®le, qui a s√©lectionn√© le profil souhait√© dans le dialogue.  Nous avions pr√©vu de l'utiliser initialement pour la formation afin d'en lire la fonction de perte et de la distribuer ensuite dans le r√©seau.  Mais cela pourrait aggraver le locuteur lui-m√™me, alors ils ont d√©cid√© de ne pas le dire comme √ßa.  Nous avons √©galement pens√© √† utiliser cette chose pour le comportement du bot, mais nous n'avons pas eu le temps de tout tester et avons d√©cid√© de refuser cette chose.  De plus, nous avons d√©cid√© de mettre des √©motic√¥nes bas√©es sur la coloration √©motionnelle de la phrase, avons √©crit un mod√®le, mais n'avons pas trouv√© un ensemble de donn√©es appropri√©, et celles qui ont √©t√© utilis√©es ne sont pas un peu √† ce sujet. <br><br><img src="https://habrastorage.org/webt/-l/yu/xq/-lyuxqic47g_15ubzyeedifcwza.jpeg"><br>  Notre √©quipe. <br><br>  M√™me si votre mod√®le principal, que vous esp√©rez, ne peut pas l'√©crire ou donne un mauvais r√©sultat, n'abandonnez pas imm√©diatement, vous devez essayer des choses plus simples, ce qui est tout √† fait naturel.  Et la deuxi√®me chose, parfois cela vaut la peine de regarder ce que votre mod√®le manque et de penser √† des t√¢ches sp√©cifiques, de les d√©composer et de r√©soudre des probl√®mes sp√©cifiques, ce que nous avons fait.  Merci de votre attention. <br><br>  Sergey Kolesnikov: <br>  - Je m'appelle Sergey Kolesnikov, je repr√©senterai la d√©cision de Tensorborne. <br><br><img src="https://habrastorage.org/webt/0t/mb/o8/0tmbo89jriohlxqgahftrd4zi2y.jpeg"><br><br>  Nous avons trouv√© un beau nom, sommes all√©s au concours, avons trouv√© beaucoup de morceaux diff√©rents pour sortir deux articles apr√®s cela, mais n'avons pas gagn√© le hackathon.  Par cons√©quent, il sera appel√©: "Comment ne pas gagner le hackathon, mais toujours publier les putains de deux articles."  Universitaires, monsieur. <br><br>  Les caract√©ristiques du concours auquel nous avons particip√© ont d√©pass√© notre motivation.  En raison du fait que l'√©valuation a √©t√© effectu√©e quotidiennement, les forfaits devaient √©galement √™tre faits quotidiennement et la r√©compense finale a √©t√© d√©termin√©e, comme nous le voulons dans RL, par sommation √† prix r√©duit.  Tout cela est devenu le fait que nous devions envoyer au moins quelque chose chaque jour pour que cela fonctionne, et nous avons obtenu au moins une sorte de score.  En cons√©quence, cela est devenu ce que vous voulez - vous ne voulez pas, mais vous avez d√ª ramer. <br><br><img src="https://habrastorage.org/webt/4l/uf/qk/4lufqkldav6-3iemerr1lxqd8rk.jpeg"><br><br>  Qu'avions-nous?  Aper√ßu pour toute la semaine. <br><br>  Malgr√© le fait que le hackathon disait qu'il √©tait hebdomadaire, tout a √©t√© d√©cid√© en quatre jours, ce qui ne semble pas suffisant pour cette t√¢che ConvAI. <br><br>  Au d√©part, nous √©tions cinq, tous de bons dipl√¥m√©s universitaires, ou alors Fiztekh, alors lundi nous sommes venus et avons lanc√© beaucoup de suggestions, d'id√©es que vous pouvez essayer, quels mod√®les d'apprentissage en profondeur essayer.  Certes, nous n'avons pas exp√©riment√© avec GAN, car nous les avons d√©j√† exp√©riment√©s pour les textes et cela ne fonctionne pas, nous avons donc pris quelque chose de plus simple, en plus, il y avait des comp√©titions tr√®s similaires et nous avions des mod√®les de pr√©-entra√Ænement.  Mardi, nous avons m√™me pu lancer quelque chose sur le deep learning, ML √©tait dans la mesure du possible, nous avons lanc√© de merveilleux dockers avec prise en charge GPU et d'autres choses pour Tensorflow et Keras, nous devons donner une m√©daille distincte pour cela, car ce n'est pas si trivial comme je voudrais. <br><br>  Selon les r√©sultats de mardi, ils √©taient prometteurs, et nous avons d√©cid√© d'am√©liorer l√©g√®rement notre ML avec de petites heuristiques et autres, et avons √©chou√© √† la septi√®me place.  Mais gr√¢ce √† nos co√©quipiers, quelqu'un a trouv√© ElasticSearch et l'a essay√©.  Il y a eu un moment tr√®s g√™nant o√π ElasticSearch a bien fonctionn√©, et les mod√®les DL et ML, et ainsi de suite, √©taient un peu moins robustes.  La fin du concours √©tait proche.  Et comme l'a not√© l'orateur pr√©c√©dent, nous avons d√©cid√© de pagayer dans la direction qui fonctionne.  Nous avons pris ElasticSearch, de petites heuristiques et avons pens√© que c'√©tait assez bon, et vraiment assez bon, parce que nous avons pris la deuxi√®me place. <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>  Plus de d√©tails.  En fait, il y avait plusieurs solutions DL.  La premi√®re solution DL √©tait assez simple.  Qui se souvient, l'ann√©e pr√©c√©dente ou l'ann√©e derni√®re, il y avait un concours de d√©tection de paraphrase Quora, et cette ann√©e il y avait un concours de Yandex pour Alice pour construire des dialogues et plus encore.  Vous remarquerez peut-√™tre que les t√¢ches y sont tr√®s proches.  Dans le premier, il fallait dire si ces deux phrases √©taient des paraphrases, et dans le second, il fallait poursuivre le dialogue.  Nous pensions que puisque nous d√©veloppons des syst√®mes de dialogue, continuons aussi bien le dialogue.  Et cela a parfaitement fonctionn√©, le dialogue avec Quora √©tait tr√®s personnel. <br><br>  Fondamentalement, tout semblait avoir un encodeur, g√©n√©ralement nous nous entra√Ænons tous sur nos RNN habituels, et de pr√©f√©rence LSTM avec attention et d'autres choses.  Et ensuite, nous avons g√©n√©ralement utilis√© soit la perte d'inclusion Cosaine, pr√©sent√©e sur la diapositive ci-dessous, soit une autre perte d'int√©gration du type Tripler Loss ou quelque chose d'autre qui incorpore des paraphrases ou des r√©ponses √† un dialogue sp√©cifique, et non des retards de paraphrases, etc.  C'√©tait la premi√®re solution, c'√©tait sur Tensorflow, Keras, c'√©tait pr√™t, nous l'avons essay√©, et c'√©tait plut√¥t bien. <br><br>  Une autre solution est n√©e en un jour deux hackathons en soir√©e.  Il y a un gars formidable Jeremy Howard, il fait la promotion du DL et du ML pour tout le monde, il a deux merveilleux cours qui vous pr√©sentent le cours de cette entreprise et d'autres choses, et pour ce cours, il a √©crit son FastAI.  Tout cela fonctionne sur PyTorch, et √† bien des √©gards m√™me r√©√©crit PyTorch, c'est l'un des inconv√©nients de cette biblioth√®que.  Mais des pros, Jeremy n'a pas grand-chose √† voir avec la PNL, cette ann√©e en mars avec un autre √©tudiant, ils ont publi√© un article o√π ils ont enseign√© le LSTM sur toutes les meilleures pratiques dans le merveilleux FastAI, avec de nombreuses astuces qu'il promeut dans son cours, et a obtenu SOTA pratiquement pour tout. <br><br>  √âtant donn√© que je suis un petit √©vang√©liste de PyTorch, j'ai toujours √©t√© en mesure de d√©raciner ce mod√®le de FastAI, de le pousser, vous pouvez d√©j√† le dire, dans mon cadre PyTorch, et m√™me d'entra√Æner le tout pour cette t√¢che.  Fondamentalement, nous avions un certain contexte de dialogue, en fait, m√™me si nous avions plusieurs phrases, vous les concat√©niez simplement en une phrase lourde.      answer,  .          FastAI,  Universal Language Model ‚Äî    ‚Äî Encoder. <br><br>     , , ,   1   ,     seq2seq.        .           ,     ,     FastAI ‚Äî Concat poolling.   ?         seq2seq,    attention.   maxpool  minpool     ,         ,      . <br><br>   ,      ,       ,     ,     maxpool  minpool,   .     ,     ‚Äî    H, Hc  Ha.       ,   feedforward ,    .  ,     ,   ,  ,  metric learning.         ‚Äî CosineEmbedding Loss,    PyTorch. <br><br>           ,  loss         .   ,  contrastive loss,    ,       .     ,        . <br><br>   DL-. ElasticSearch,   . <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>    ?   ,   -  ElasticSearch  . -         - Persona Dataset  ,   ,   Facebook,  ,   ,    - .      -    .        ,     ,  ,  ,        ,  Persona Dataset      ,      Amazon Mechanical Turk     ,   . <br><br>         ElasticSearch,            ,    .  ,   Persona Dataset    ,   , 10 . ,        . , , ,   ,     . <br><br>   - .        ,    Persona     ,  ,     ,  ,    ,    evaluation.    heuristic solutions. <br><br> ,   ,   ,          ,   .    .    ,  ,   ,     ,    ,     .    . <br><br>       ‚Äî    .        ,        ‚Äî    -,      -,   ,   . <br><br>      dirty hack.    ,         ,        .       .   ‚Äî    ,       . <br><br><img src="https://habrastorage.org/webt/yy/9p/fw/yy9pfw8lc-tssoygftcrfsatfxy.jpeg"><br><br>  ?        ,   -DL-       ,   DL,    .   ,    ,    ,   .          .  ,   -,     ,  ,   .  ,   ,     .     .  ,  ,    .    DL        ,  ElasticSearch  . <br><br>  ,     personality score.  ,  -,     0,25‚Äì0,3 ,       .   ,    ,   -    . <br><br><img src="https://habrastorage.org/webt/av/rt/t7/avrtt73yerc1ckh6tyv3swowuzk.jpeg"><br><br>  Exemples.     ‚Äî           ,   ,  ,       Docker ElasticSearch,       .   ,  .  .     .     Also, try to guess‚Ä¶  ,    ‚Äî , funny you.  ,     general,  .    ,     ,    . <br><br> ,  ,       .            . ,          ‚Äî    ,         ,  .  ,     Docker,      . <br><br><img src="https://habrastorage.org/webt/jj/zy/9r/jjzy9r5zcnzogxejadhvfhehoyg.jpeg"><br><br>         ? ConvAI   ,     NIPS,       -  . <br><br> -, ElasticSearch   . ,    ,   .   ,      ,  ElasticSearch   . ,   DL. <br><br> -,     DL-. :       ,     ,     ,     .    ,  , , ,    . <br><br>    ,     .   ,        .     ,      .    ‚Äî    pre-trained- ( ‚Äî . .), .  . <br><br> ,   proposals   ,    RL bandits     .     ,  .     ‚Äî      .  ,    . ,    ,        ,  ,     toxic-     .   . <br><br>         ‚Äî   .         ,       DeepHacks    .   NLP,    DeepHack    , , ¬´ ¬ª.  ,  .     .      , , ,   ,         ,     . <br><br>   ‚Äî       .        distributed-       ,       .   ,       DeepHack.     -   .   .  ,     ,    ,        ,     . <br><br>   !  S√©rieusement.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous n'avez m√™me pas besoin d'utiliser vos mod√®les pr√©-form√©s. </font><font style="vertical-align: inherit;">Commencer par les lignes de base est probablement mieux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et bien s√ªr, prenez des vacances de hackathon. </font><font style="vertical-align: inherit;">Lorsque vous participez √† un hackathon hebdomadaire et travaillez en m√™me temps, c'est mauvais. </font><font style="vertical-align: inherit;">Vous arrivez √† 19 heures, apr√®s avoir travaill√© un peu, asseyez-vous et compilez Docker avec TensorFlow, Keras, pour que tout cela commence sur certains serveurs distants auxquels vous n'avez m√™me pas acc√®s. </font><font style="vertical-align: inherit;">Quelque part en deux nuits, vous attrapez la catharsis, et cela fonctionne pour vous - sans Docker, sans tout, parce que vous avez compris que c'est possible et ainsi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il semble que si vous participez √† une grande comp√©tition, allouez-y un peu plus de temps que ce que vous ne pouvez pas dormir en une semaine et participez. </font><font style="vertical-align: inherit;">Allez gagner.</font></font> Je vous remercie! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422717/">https://habr.com/ru/post/fr422717/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422705/index.html">Le livre sur "Paragraphe" sur Habr√©. Un nouveau chapitre concerne les programmeurs coop√©ratifs: Beta</a></li>
<li><a href="../fr422709/index.html">Les scientifiques ont trouv√© une section du cerveau humain qui est responsable de la hauteur de notre discours</a></li>
<li><a href="../fr422711/index.html">Lecture du week-end: ressources d'infrastructure cloud et informatique</a></li>
<li><a href="../fr422713/index.html">Le condens√© de mat√©riaux int√©ressants pour le d√©veloppeur mobile # 269 (du 3 au 9 septembre)</a></li>
<li><a href="../fr422715/index.html">La non-discrimination est la valeur fondamentale de l'open source</a></li>
<li><a href="../fr422719/index.html">Les attaquants ont compromis des milliers de routeurs MikroTik pour cr√©er un botnet</a></li>
<li><a href="../fr422721/index.html">KivyMD - la vie continue</a></li>
<li><a href="../fr422723/index.html">GAN a appris √† cr√©er des visages avec une texture et une g√©om√©trie r√©alistes</a></li>
<li><a href="../fr422725/index.html">390k. sites Web avec dossier .git ouvert</a></li>
<li><a href="../fr422729/index.html">Comment un fournisseur de cloud peut-il g√©rer les licences logicielles et quelles solutions de blockchain peuvent fournir ici</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>