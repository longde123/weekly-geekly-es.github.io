<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëã üë∞üèº üë©‚Äçüë©‚Äçüëß‚Äçüëß Comment rendre le paiement plus pratique: l'exp√©rience d'un fournisseur IaaS üë©üèº‚Äçüé§ üë©‚Äçüåæ üïù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'un des probl√®mes importants lorsque vous travaillez avec les services d'un fournisseur IaaS est la commodit√© du paiement. D√®s le premier jour du d√©m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment rendre le paiement plus pratique: l'exp√©rience d'un fournisseur IaaS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1cloud/blog/433948/">  L'un des probl√®mes importants lorsque vous travaillez avec les services d'un fournisseur IaaS est la commodit√© du paiement.  D√®s le premier jour du d√©marrage de notre projet, nous avons tent√© de simplifier le processus de paiement par carte bancaire et de continuer √† am√©liorer ce m√©canisme.  Aujourd'hui, nous avons d√©cid√© de parler de notre point de d√©part et de partager notre exp√©rience. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/iy/6k/pv/iy6kpvrzewuk4mudc9nkfwiadu8.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ Flickr / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Muhammad Ashiq</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CC BY-SA</a></i></font> <br><br><h2>  Contexte </h2><br>  Nous fournissons des services IaaS √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1cloud</a> depuis 2012.  Pendant ce temps, nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©ussi √† travailler</a> avec un grand nombre de passerelles de paiement.  L'un des premiers √©tait Money Online.  Nous avons travaill√© avec lui pendant deux ans, puis avons commenc√© √† connecter des services alternatifs en cas de difficult√©s techniques potentielles. <br><br>  Comme alternative, PayPal et Robocassa ont √©t√© envisag√©s.  En cons√©quence, les deux plates-formes √©taient connect√©es, m√™me si <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cela posait quelques difficult√©s</a> .  Dans le premier cas, pour importer l'ID client dans le formulaire de paiement, nous avons d√ª ajuster les r√®gles CSS et modifier les √©l√©ments standards de la page web.  Dans la situation avec Robocassa, un certain nombre de demandes dans l'API ne correspondaient pas √† sa description, mais avec l'aide du support technique, la situation a √©galement √©t√© r√©solue.  Nous ne nous sommes pas arr√™t√©s sur ces d√©cisions et avons envisag√© d'autres options que des partenaires potentiels nous proposaient. <br><br>  Nous avons donc commenc√© √† travailler avec le syst√®me de paiement PayMaster (il a remplac√© ¬´Money Online¬ª), qui nous offrait des conditions de commission avantageuses et une API pratique.  Pendant longtemps, cette passerelle de paiement a √©t√© la principale.  Cependant, r√©cemment, nous avons d√©cid√© de repenser la convivialit√© de notre service et de simplifier le processus de paiement des services par carte bancaire pour les particuliers.  Afin que l'UX r√©ponde √† nos exigences, nous avons int√©gr√© une autre passerelle de paiement - CloudPayments. <br><br><h2>  Comment puis-je am√©liorer le processus de paiement UX? </h2><br>  Nous travaillons sur le mod√®le du pr√©paiement.  Le client r√©approvisionne son compte dans son compte personnel, puis les fonds sont d√©bit√©s de ce compte au fur et √† mesure de la consommation des services IaaS (d√©bit toutes les dix minutes). <br><br>  Pour reconstituer le solde avec une carte de cr√©dit, dans le cas de PayMaster, le client a d√ª suivre un processus en quatre √©tapes: <br><br><ol><li>  Entrez le montant du paiement dans le formulaire dans le panneau de configuration, cliquez sur le bouton "Payer" et acc√©dez √† la page de la passerelle de paiement. </li><li>  Indiquez le t√©l√©phone ou l'adresse e-mail pour recevoir le ch√®que et cliquez sur Continuer. </li><li>  Entrez les d√©tails de la carte et appuyez √† nouveau sur le bouton "Payer". </li><li>  Indiquez le code de confirmation de transaction que la banque a envoy√© dans le cadre de la proc√©dure 3D Secure. </li></ol><blockquote>  <i><b>Avertissement:</b> l'algorithme d√©crit ci-dessus s'applique aux paiements par carte bancaire effectu√©s par des particuliers.</i>  <i>Les entit√©s juridiques paient les services du fournisseur IaaS sur les factures.</i>  <i>Tout en am√©liorant la convivialit√©, nous avons finalis√© les m√©canismes de facturation automatique de ces factures, mais nous ne les consid√©rerons pas dans ce document, car les entit√©s juridiques n'interagissent pas avec une passerelle de paiement.</i> </blockquote><br>  Nous avons d√©cid√© de simplifier le processus de paiement pour les utilisateurs et d'am√©liorer g√©n√©ralement l'apparence et la convivialit√© des formulaires pour remplir les donn√©es de carte bancaire.  Pour cela, nous avons identifi√© deux t√¢ches pour nous-m√™mes, dont nous discuterons ci-dessous. <br><br><h5>  T√¢che 1: exclure le passage √† la page de la passerelle de paiement </h5><br>  Comme nous l'avons not√© ci-dessus, lorsqu'un utilisateur a pay√© nos services, afin de remplir les d√©tails de la carte, il a √©t√© contraint de se rendre sur le site de la passerelle de paiement.  Une personne a donc d√ª appuyer sur de nombreux boutons de confirmation et attendre le chargement des pages contenant des informations sur la reconstitution du compte. <br><br>  Dans ce cas, un autre probl√®me est survenu - apr√®s que l'utilisateur a d√©pos√© de l'argent sur le compte, il est rest√© sur la page de la passerelle de paiement jusqu'√† ce qu'il clique sur un lien sp√©cial pour revenir √† 1cloud.ru.  Cela a rendu difficile de travailler avec notre panneau de contr√¥le, par exemple, si, apr√®s paiement, l'utilisateur voulait ajouter de la capacit√© √† son infrastructure informatique. <br><br><blockquote>  <i>"Selon les analyses, seule une poign√©e de clients ont suivi le lien et sont revenus sur notre site Web", a d√©clar√© <b>Sergey Belkin</b> , responsable du d√©veloppement chez 1cloud.ru.</i>  <i>- Cela est d√ª en partie au fait que le client a d√ª cliquer sur le lien "Retour √† la boutique en ligne".</i>  <i>Et ce malgr√© le fait que notre service ne soit pas une boutique en ligne. ¬ª</i> </blockquote><br>  De plus, nous avons voulu r√©duire au minimum le nombre de champs remplis par l'utilisateur, en ne laissant que ceux qui sont vraiment n√©cessaires √† l'op√©ration.  Pour accomplir cette t√¢che, nous avons choisi la passerelle de paiement CloudPayments, dont les employ√©s ont d'abord attir√© notre attention avec des r√©ponses de support technique rapides et compl√®tes. <br><br>  De plus, cette passerelle de paiement avait un bureau de repr√©sentation au Kazakhstan.  Cela a permis de mettre en place un nouveau mode de paiement pour notre service d'h√©bergement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">oblako.kz</a> .  Sinon, tous nos transferts du Kazakhstan vers la Russie (ou vice versa) seraient soumis √† une commission suppl√©mentaire. <br><br>  CloudPayments a sugg√©r√© d'utiliser un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">script</a> sp√©cial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chekout</a> .  Il vous permet de mettre en ≈ìuvre le formulaire de paiement directement dans notre panneau de contr√¥le et de transf√©rer les donn√©es compl√©t√©es vers la passerelle de paiement sans les enregistrer de notre c√¥t√©. <br><br>  Pour impl√©menter le script, nous avons d√ª passer par une analyse de s√©curit√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PCI DSS</a> dans l'une des organisations accr√©dit√©es - c'√©tait l'exigence CloudPayments.  La num√©risation est n√©cessaire pour confirmer la conformit√© technique √† la norme et exclure la possibilit√© de vol de donn√©es utilisateur lors du remplissage des formulaires sur le site. <br><br>  L'audit de conformit√© PCI DSS a √©t√© r√©alis√© par ARinteg.  Nous leur avons envoy√© une candidature dans laquelle nous avons indiqu√© notre souhait de subir un audit, rempli un questionnaire et fix√© une date de v√©rification.  Du c√¥t√© ARinteg, la pr√©paration de l'analyse prend environ une demi-journ√©e (c'est-√†-dire que vous pouvez num√©riser presque imm√©diatement), mais nous avons pris quatre √† cinq jours suppl√©mentaires pour pr√©parer soigneusement notre infrastructure. <br><br>  L'analyse a dur√© environ 15 heures, bien qu'il arrive que l'analyse prenne plusieurs jours.  Les sp√©cialistes ARinteg ont v√©rifi√© SSL et la protection contre les demandes d'injection et autres vuln√©rabilit√©s sur notre site Web. <br><br>  Nous n'avons pas r√©ussi le test initial et nous avons re√ßu une liste de probl√®mes qui devaient √™tre r√©solus.  Tous √©taient insignifiants, par exemple, il y avait une post-m√©thode qui a √©t√© utilis√©e lorsque l'utilisateur a √©valu√© nos instructions √©tape par √©tape sur le site.  Nous avons supprim√© tous les commentaires et la deuxi√®me tentative d'audit a r√©ussi.  Ensuite, nous pourrions passer √† la mise en ≈ìuvre du script chekout. <br><br>  Le script est enregistr√© sur notre site Web, recueille les donn√©es de la carte √† partir du formulaire sp√©cifi√© et en compose un cryptogramme pour le paiement via l'API CloudPayments.  Cela ressemble √† ceci: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.createCryptogram = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = checkout.createCryptogramPacket(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.success) { <span class="hljs-comment"><span class="hljs-comment">//   alert(result.packet); } else { //     ,  `result.messages` : // { name: "      ", cardNumber: "  " } //  `name`, `cardNumber`    `&lt;input ... data-cp="cardNumber"&gt;` for (var msgName in result.messages) { alert(result.messages[msgName]); } } }; $(function () { /*  checkout */ checkout = new cp.Checkout( // public id    "test_api_00000000000000000000001", // ,     document.getElementById("paymentFormSample")); });</span></span></code> </pre> <br>  Le formulaire de saisie des donn√©es de carte bancaire ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/yi/vl/yt/yivlyttyhrz8mgmikdhnr9_8mys.png"><br><br>  Lors de la mise en place du script et du formulaire, nous avons pu r√©duire au minimum le nombre de champs renseign√©s par l'utilisateur.  Ils n'ont laiss√© que ceux qui sont vraiment n√©cessaires √† l'op√©ration.  Par exemple, les champs "Pr√©nom" et "Nom" ont √©t√© supprim√©s.  Comme nous l'ont expliqu√© les repr√©sentants de la passerelle de paiement, les banques ne v√©rifient pas ces donn√©es (seuls le num√©ro de carte, la date et le CVV sont importants), nous avons donc d√©cid√© de les omettre et de simplifier l'ensemble du processus. <br><br>  En outre, nous avons clarifi√© les informations sur notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programme de rabais</a> : avec un r√©approvisionnement unique du compte d'un montant de 5000 roubles, 10% de celui-ci sont cr√©dit√©s sous forme de bonus, de 10000 roubles - 20%, plus de 100000 roubles - 25%.  Nous avons √©galement ajout√© la possibilit√© d'enregistrer des donn√©es cartographiques pour les utilisateurs.  Toutes ces informations sont stock√©es sur le c√¥t√© de la passerelle de paiement CloudPayments sous forme crypt√©e. <br><br><h5>  T√¢che 2: r√©aliser le paiement automatique </h5><br>  Il s'agit d'un paiement qui se produit automatiquement sous certaines conditions.  Tr√®s souvent, cette fonctionnalit√© est utilis√©e par les services d'abonnement.  Cependant, la plupart des passerelles de paiement n'offrent que l'option lorsque le r√©approvisionnement automatique se produit selon un calendrier (√† une date donn√©e).  Il est important pour nous que la possibilit√© de reconstituer le compte soit automatiquement disponible √† tout moment lorsque le client manque de fonds sur le compte (puisque nous travaillons sur le pr√©paiement).  Par cons√©quent, pour impl√©menter le paiement automatique, nous avons utilis√© la m√©thode utilis√©e lors du paiement √† partir d'une carte ¬´m√©moris√©e¬ª (√† l'aide d'un jeton temporaire). <br><br>  Cela fonctionne comme suit: apr√®s le premier paiement r√©ussi effectu√© par l'utilisateur, la passerelle g√©n√®re son jeton pour la paire de cartes de service et l'envoie dans une r√©ponse de publication.  Ce jeton est enregistr√© et, lors d'un paiement r√©p√©t√©, il est d√©j√† transf√©r√©, et non les donn√©es de la carte.  Il s'av√®re que nous envoyons une demande √† la passerelle, dans laquelle nous indiquons notre cl√© API (identifiant que la demande provient de 1cloud), le jeton et le montant.  La passerelle v√©rifie si un tel jeton a √©t√© cr√©√© et si tout est en ordre, elle traite le paiement pour le montant sp√©cifi√©. <br><br>  La date √† laquelle il est n√©cessaire d'effectuer un paiement automatique, nous calculons dynamiquement en fonction de la consommation actuelle de services par l'utilisateur et du solde du compte.  Supposons qu'un client ait mille roubles au bilan et qu'il ait consomm√© deux roubles au cours des dix derni√®res minutes.  Il est clair que la date approximative de la r√©duction √† z√©ro interviendra √† cinq cent dix minutes d'intervalle - soit environ 34 jours.  Ainsi, nous pouvons effectuer un paiement automatique quelques jours avant la fin des fonds.  Le client choisit la taille du paiement automatique ind√©pendamment. <br><br><h2>  Et ensuite </h2><br>  Nous testons maintenant ces solutions et √©valuons les r√©sultats de leur mise en ≈ìuvre.  Selon un vote des clients, la plupart sont assez variables.  Nous √©tudierons plus en profondeur les retours sur le syst√®me, analyserons les donn√©es et, si n√©cessaire, effectuerons des ajustements. <br><br><h5>  PS Mat√©riaux frais de notre blog d'entreprise: </h5><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevOps dans un service cloud en utilisant 1cloud.ru comme exemple</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ce que vous devez savoir sur la signature num√©rique</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Minimisation des risques: comment ne pas perdre vos donn√©es</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433948/">https://habr.com/ru/post/fr433948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433936/index.html">Vous cherchez un cadeau high-tech pour un enfant? Pensez √† un terrain de jeu, pas √† un parc</a></li>
<li><a href="../fr433938/index.html">Comment Yandex et Google r√©sument l'ann√©e</a></li>
<li><a href="../fr433940/index.html">Combien co√ªte Review dans l'AppStore</a></li>
<li><a href="../fr433944/index.html">Des exceptions d√©vastatrices</a></li>
<li><a href="../fr433946/index.html">Aide-m√©moire pour l'intelligence artificielle - jetez l'exc√©dent, enseignez l'essentiel. Technique de traitement des s√©quences de formation</a></li>
<li><a href="../fr433952/index.html">10 raisons de choisir une solution pour SAP HANA de HPE. 2e partie</a></li>
<li><a href="../fr433954/index.html">Huit technologies audio et gadgets audio qui entreront au Temple de la renomm√©e de TECnology en 2019</a></li>
<li><a href="../fr433956/index.html">Les modders ont utilis√© l'IA pour am√©liorer la texture dans les jeux</a></li>
<li><a href="../fr433958/index.html">Applications TDD sur Spring Boot: travailler avec une base de donn√©es</a></li>
<li><a href="../fr433964/index.html">Modules ECMAScript dans Node.js: un nouveau plan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>