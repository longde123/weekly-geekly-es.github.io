<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👋 👰🏼 👩‍👩‍👧‍👧 Comment rendre le paiement plus pratique: l'expérience d'un fournisseur IaaS 👩🏼‍🎤 👩‍🌾 🕝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'un des problèmes importants lorsque vous travaillez avec les services d'un fournisseur IaaS est la commodité du paiement. Dès le premier jour du dém...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment rendre le paiement plus pratique: l'expérience d'un fournisseur IaaS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1cloud/blog/433948/">  L'un des problèmes importants lorsque vous travaillez avec les services d'un fournisseur IaaS est la commodité du paiement.  Dès le premier jour du démarrage de notre projet, nous avons tenté de simplifier le processus de paiement par carte bancaire et de continuer à améliorer ce mécanisme.  Aujourd'hui, nous avons décidé de parler de notre point de départ et de partager notre expérience. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/iy/6k/pv/iy6kpvrzewuk4mudc9nkfwiadu8.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ Flickr / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Muhammad Ashiq</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CC BY-SA</a></i></font> <br><br><h2>  Contexte </h2><br>  Nous fournissons des services IaaS à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1cloud</a> depuis 2012.  Pendant ce temps, nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réussi à travailler</a> avec un grand nombre de passerelles de paiement.  L'un des premiers était Money Online.  Nous avons travaillé avec lui pendant deux ans, puis avons commencé à connecter des services alternatifs en cas de difficultés techniques potentielles. <br><br>  Comme alternative, PayPal et Robocassa ont été envisagés.  En conséquence, les deux plates-formes étaient connectées, même si <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cela posait quelques difficultés</a> .  Dans le premier cas, pour importer l'ID client dans le formulaire de paiement, nous avons dû ajuster les règles CSS et modifier les éléments standards de la page web.  Dans la situation avec Robocassa, un certain nombre de demandes dans l'API ne correspondaient pas à sa description, mais avec l'aide du support technique, la situation a également été résolue.  Nous ne nous sommes pas arrêtés sur ces décisions et avons envisagé d'autres options que des partenaires potentiels nous proposaient. <br><br>  Nous avons donc commencé à travailler avec le système de paiement PayMaster (il a remplacé «Money Online»), qui nous offrait des conditions de commission avantageuses et une API pratique.  Pendant longtemps, cette passerelle de paiement a été la principale.  Cependant, récemment, nous avons décidé de repenser la convivialité de notre service et de simplifier le processus de paiement des services par carte bancaire pour les particuliers.  Afin que l'UX réponde à nos exigences, nous avons intégré une autre passerelle de paiement - CloudPayments. <br><br><h2>  Comment puis-je améliorer le processus de paiement UX? </h2><br>  Nous travaillons sur le modèle du prépaiement.  Le client réapprovisionne son compte dans son compte personnel, puis les fonds sont débités de ce compte au fur et à mesure de la consommation des services IaaS (débit toutes les dix minutes). <br><br>  Pour reconstituer le solde avec une carte de crédit, dans le cas de PayMaster, le client a dû suivre un processus en quatre étapes: <br><br><ol><li>  Entrez le montant du paiement dans le formulaire dans le panneau de configuration, cliquez sur le bouton "Payer" et accédez à la page de la passerelle de paiement. </li><li>  Indiquez le téléphone ou l'adresse e-mail pour recevoir le chèque et cliquez sur Continuer. </li><li>  Entrez les détails de la carte et appuyez à nouveau sur le bouton "Payer". </li><li>  Indiquez le code de confirmation de transaction que la banque a envoyé dans le cadre de la procédure 3D Secure. </li></ol><blockquote>  <i><b>Avertissement:</b> l'algorithme décrit ci-dessus s'applique aux paiements par carte bancaire effectués par des particuliers.</i>  <i>Les entités juridiques paient les services du fournisseur IaaS sur les factures.</i>  <i>Tout en améliorant la convivialité, nous avons finalisé les mécanismes de facturation automatique de ces factures, mais nous ne les considérerons pas dans ce document, car les entités juridiques n'interagissent pas avec une passerelle de paiement.</i> </blockquote><br>  Nous avons décidé de simplifier le processus de paiement pour les utilisateurs et d'améliorer généralement l'apparence et la convivialité des formulaires pour remplir les données de carte bancaire.  Pour cela, nous avons identifié deux tâches pour nous-mêmes, dont nous discuterons ci-dessous. <br><br><h5>  Tâche 1: exclure le passage à la page de la passerelle de paiement </h5><br>  Comme nous l'avons noté ci-dessus, lorsqu'un utilisateur a payé nos services, afin de remplir les détails de la carte, il a été contraint de se rendre sur le site de la passerelle de paiement.  Une personne a donc dû appuyer sur de nombreux boutons de confirmation et attendre le chargement des pages contenant des informations sur la reconstitution du compte. <br><br>  Dans ce cas, un autre problème est survenu - après que l'utilisateur a déposé de l'argent sur le compte, il est resté sur la page de la passerelle de paiement jusqu'à ce qu'il clique sur un lien spécial pour revenir à 1cloud.ru.  Cela a rendu difficile de travailler avec notre panneau de contrôle, par exemple, si, après paiement, l'utilisateur voulait ajouter de la capacité à son infrastructure informatique. <br><br><blockquote>  <i>"Selon les analyses, seule une poignée de clients ont suivi le lien et sont revenus sur notre site Web", a déclaré <b>Sergey Belkin</b> , responsable du développement chez 1cloud.ru.</i>  <i>- Cela est dû en partie au fait que le client a dû cliquer sur le lien "Retour à la boutique en ligne".</i>  <i>Et ce malgré le fait que notre service ne soit pas une boutique en ligne. »</i> </blockquote><br>  De plus, nous avons voulu réduire au minimum le nombre de champs remplis par l'utilisateur, en ne laissant que ceux qui sont vraiment nécessaires à l'opération.  Pour accomplir cette tâche, nous avons choisi la passerelle de paiement CloudPayments, dont les employés ont d'abord attiré notre attention avec des réponses de support technique rapides et complètes. <br><br>  De plus, cette passerelle de paiement avait un bureau de représentation au Kazakhstan.  Cela a permis de mettre en place un nouveau mode de paiement pour notre service d'hébergement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">oblako.kz</a> .  Sinon, tous nos transferts du Kazakhstan vers la Russie (ou vice versa) seraient soumis à une commission supplémentaire. <br><br>  CloudPayments a suggéré d'utiliser un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">script</a> spécial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chekout</a> .  Il vous permet de mettre en œuvre le formulaire de paiement directement dans notre panneau de contrôle et de transférer les données complétées vers la passerelle de paiement sans les enregistrer de notre côté. <br><br>  Pour implémenter le script, nous avons dû passer par une analyse de sécurité <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PCI DSS</a> dans l'une des organisations accréditées - c'était l'exigence CloudPayments.  La numérisation est nécessaire pour confirmer la conformité technique à la norme et exclure la possibilité de vol de données utilisateur lors du remplissage des formulaires sur le site. <br><br>  L'audit de conformité PCI DSS a été réalisé par ARinteg.  Nous leur avons envoyé une candidature dans laquelle nous avons indiqué notre souhait de subir un audit, rempli un questionnaire et fixé une date de vérification.  Du côté ARinteg, la préparation de l'analyse prend environ une demi-journée (c'est-à-dire que vous pouvez numériser presque immédiatement), mais nous avons pris quatre à cinq jours supplémentaires pour préparer soigneusement notre infrastructure. <br><br>  L'analyse a duré environ 15 heures, bien qu'il arrive que l'analyse prenne plusieurs jours.  Les spécialistes ARinteg ont vérifié SSL et la protection contre les demandes d'injection et autres vulnérabilités sur notre site Web. <br><br>  Nous n'avons pas réussi le test initial et nous avons reçu une liste de problèmes qui devaient être résolus.  Tous étaient insignifiants, par exemple, il y avait une post-méthode qui a été utilisée lorsque l'utilisateur a évalué nos instructions étape par étape sur le site.  Nous avons supprimé tous les commentaires et la deuxième tentative d'audit a réussi.  Ensuite, nous pourrions passer à la mise en œuvre du script chekout. <br><br>  Le script est enregistré sur notre site Web, recueille les données de la carte à partir du formulaire spécifié et en compose un cryptogramme pour le paiement via l'API CloudPayments.  Cela ressemble à ceci: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.createCryptogram = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = checkout.createCryptogramPacket(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.success) { <span class="hljs-comment"><span class="hljs-comment">//   alert(result.packet); } else { //     ,  `result.messages` : // { name: "      ", cardNumber: "  " } //  `name`, `cardNumber`    `&lt;input ... data-cp="cardNumber"&gt;` for (var msgName in result.messages) { alert(result.messages[msgName]); } } }; $(function () { /*  checkout */ checkout = new cp.Checkout( // public id    "test_api_00000000000000000000001", // ,     document.getElementById("paymentFormSample")); });</span></span></code> </pre> <br>  Le formulaire de saisie des données de carte bancaire ressemble à ceci: <br><br><img src="https://habrastorage.org/webt/yi/vl/yt/yivlyttyhrz8mgmikdhnr9_8mys.png"><br><br>  Lors de la mise en place du script et du formulaire, nous avons pu réduire au minimum le nombre de champs renseignés par l'utilisateur.  Ils n'ont laissé que ceux qui sont vraiment nécessaires à l'opération.  Par exemple, les champs "Prénom" et "Nom" ont été supprimés.  Comme nous l'ont expliqué les représentants de la passerelle de paiement, les banques ne vérifient pas ces données (seuls le numéro de carte, la date et le CVV sont importants), nous avons donc décidé de les omettre et de simplifier l'ensemble du processus. <br><br>  En outre, nous avons clarifié les informations sur notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programme de rabais</a> : avec un réapprovisionnement unique du compte d'un montant de 5000 roubles, 10% de celui-ci sont crédités sous forme de bonus, de 10000 roubles - 20%, plus de 100000 roubles - 25%.  Nous avons également ajouté la possibilité d'enregistrer des données cartographiques pour les utilisateurs.  Toutes ces informations sont stockées sur le côté de la passerelle de paiement CloudPayments sous forme cryptée. <br><br><h5>  Tâche 2: réaliser le paiement automatique </h5><br>  Il s'agit d'un paiement qui se produit automatiquement sous certaines conditions.  Très souvent, cette fonctionnalité est utilisée par les services d'abonnement.  Cependant, la plupart des passerelles de paiement n'offrent que l'option lorsque le réapprovisionnement automatique se produit selon un calendrier (à une date donnée).  Il est important pour nous que la possibilité de reconstituer le compte soit automatiquement disponible à tout moment lorsque le client manque de fonds sur le compte (puisque nous travaillons sur le prépaiement).  Par conséquent, pour implémenter le paiement automatique, nous avons utilisé la méthode utilisée lors du paiement à partir d'une carte «mémorisée» (à l'aide d'un jeton temporaire). <br><br>  Cela fonctionne comme suit: après le premier paiement réussi effectué par l'utilisateur, la passerelle génère son jeton pour la paire de cartes de service et l'envoie dans une réponse de publication.  Ce jeton est enregistré et, lors d'un paiement répété, il est déjà transféré, et non les données de la carte.  Il s'avère que nous envoyons une demande à la passerelle, dans laquelle nous indiquons notre clé API (identifiant que la demande provient de 1cloud), le jeton et le montant.  La passerelle vérifie si un tel jeton a été créé et si tout est en ordre, elle traite le paiement pour le montant spécifié. <br><br>  La date à laquelle il est nécessaire d'effectuer un paiement automatique, nous calculons dynamiquement en fonction de la consommation actuelle de services par l'utilisateur et du solde du compte.  Supposons qu'un client ait mille roubles au bilan et qu'il ait consommé deux roubles au cours des dix dernières minutes.  Il est clair que la date approximative de la réduction à zéro interviendra à cinq cent dix minutes d'intervalle - soit environ 34 jours.  Ainsi, nous pouvons effectuer un paiement automatique quelques jours avant la fin des fonds.  Le client choisit la taille du paiement automatique indépendamment. <br><br><h2>  Et ensuite </h2><br>  Nous testons maintenant ces solutions et évaluons les résultats de leur mise en œuvre.  Selon un vote des clients, la plupart sont assez variables.  Nous étudierons plus en profondeur les retours sur le système, analyserons les données et, si nécessaire, effectuerons des ajustements. <br><br><h5>  PS Matériaux frais de notre blog d'entreprise: </h5><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevOps dans un service cloud en utilisant 1cloud.ru comme exemple</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ce que vous devez savoir sur la signature numérique</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Minimisation des risques: comment ne pas perdre vos données</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433948/">https://habr.com/ru/post/fr433948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433936/index.html">Vous cherchez un cadeau high-tech pour un enfant? Pensez à un terrain de jeu, pas à un parc</a></li>
<li><a href="../fr433938/index.html">Comment Yandex et Google résument l'année</a></li>
<li><a href="../fr433940/index.html">Combien coûte Review dans l'AppStore</a></li>
<li><a href="../fr433944/index.html">Des exceptions dévastatrices</a></li>
<li><a href="../fr433946/index.html">Aide-mémoire pour l'intelligence artificielle - jetez l'excédent, enseignez l'essentiel. Technique de traitement des séquences de formation</a></li>
<li><a href="../fr433952/index.html">10 raisons de choisir une solution pour SAP HANA de HPE. 2e partie</a></li>
<li><a href="../fr433954/index.html">Huit technologies audio et gadgets audio qui entreront au Temple de la renommée de TECnology en 2019</a></li>
<li><a href="../fr433956/index.html">Les modders ont utilisé l'IA pour améliorer la texture dans les jeux</a></li>
<li><a href="../fr433958/index.html">Applications TDD sur Spring Boot: travailler avec une base de données</a></li>
<li><a href="../fr433964/index.html">Modules ECMAScript dans Node.js: un nouveau plan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>