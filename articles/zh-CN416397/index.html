<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸˆ¶ âœ‹ğŸ» â­ï¸ æˆ‘ä»¬ä½¿ç”¨Page Objectæ¨¡å¼è‡ªåŠ¨æ‰§è¡ŒAndroidåº”ç”¨ç¨‹åºçš„UIæµ‹è¯• ğŸ‘‡ğŸ¿ ğŸŒï¸ ğŸ—»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Page Objectæ¨¡å¼å‡ºç°åœ¨Webæµ‹è¯•ä¸­ï¼Œå¹¶è¯æ˜åœ¨é‚£é‡Œéå¸¸å¥½ã€‚ å½“æˆ‘å¼€å§‹è‡ªåŠ¨æ‰§è¡Œandroidåº”ç”¨ç¨‹åºçš„æµ‹è¯•æ—¶ï¼Œæˆ‘æƒ³åˆ°çš„ç¬¬ä¸€ä»¶äº‹ã€‚ æˆ‘åœ¨ç½‘ç»œä¸Šå¯»æ‰¾ä¿¡æ¯ï¼Œé—®æˆ‘çš„åŒäº‹ï¼ŒåŸåˆ™ä¸Šæ²¡æœ‰æ‰¾åˆ°ä¸å°è¯•çš„åŸå› ã€‚ æˆ‘å»ºè®®çœ‹çœ‹ç»“æœå¦‚ä½•ã€‚ 

 ç»å…¸çš„Page ObjectåŒ…å«ä¸¤ä¸ªæŠ½è±¡çº§åˆ«ï¼šé¡µé¢å…ƒç´ å’Œæµ‹è¯•ã€‚ æˆ‘å†å¼ºè°ƒä¸€...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬ä½¿ç”¨Page Objectæ¨¡å¼è‡ªåŠ¨æ‰§è¡ŒAndroidåº”ç”¨ç¨‹åºçš„UIæµ‹è¯•</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416397/"><img src="https://habrastorage.org/webt/4_/iz/s7/4_izs7jhyvtyy6meo09cgf1ee2c.png" alt="å›¾ç‰‡"><br><br>  Page Objectæ¨¡å¼å‡ºç°åœ¨Webæµ‹è¯•ä¸­ï¼Œå¹¶è¯æ˜åœ¨é‚£é‡Œéå¸¸å¥½ã€‚ å½“æˆ‘å¼€å§‹è‡ªåŠ¨æ‰§è¡Œandroidåº”ç”¨ç¨‹åºçš„æµ‹è¯•æ—¶ï¼Œæˆ‘æƒ³åˆ°çš„ç¬¬ä¸€ä»¶äº‹ã€‚ æˆ‘åœ¨ç½‘ç»œä¸Šå¯»æ‰¾ä¿¡æ¯ï¼Œé—®æˆ‘çš„åŒäº‹ï¼ŒåŸåˆ™ä¸Šæ²¡æœ‰æ‰¾åˆ°ä¸å°è¯•çš„åŸå› ã€‚ æˆ‘å»ºè®®çœ‹çœ‹ç»“æœå¦‚ä½•ã€‚ <br><a name="habracut"></a><br> ç»å…¸çš„Page ObjectåŒ…å«ä¸¤ä¸ªæŠ½è±¡çº§åˆ«ï¼šé¡µé¢å…ƒç´ å’Œæµ‹è¯•ã€‚ æˆ‘å†å¼ºè°ƒä¸€ä¸ª-ä¸šåŠ¡é€»è¾‘ã€‚ æˆ‘æ³¨æ„åˆ°ï¼Œæ„å»ºæ¡†æ¶çš„æ–¹å¼å°†æå¤§åœ°å½±å“å°†æ¥ç¼–å†™æµ‹è¯•çš„éš¾æ˜“ç¨‹åº¦åŠå…¶æ”¯æŒã€‚ æˆ‘è¯•å›¾ä½¿æµ‹è¯•ä»£ç çœ‹èµ·æ¥åƒæ˜¯ç”±æ™®é€šæµ‹è¯•äººå‘˜ç¼–å†™çš„æ™®é€šæµ‹è¯•ç”¨ä¾‹ã€‚ å³ æˆ‘ä»å¤´å¼€å§‹ï¼š <br><br><ol><li> æˆ‘æ­£åœ¨ç¼–å†™æ¼‚äº®æ¸…æ™°çš„æµ‹è¯•ç”¨ä¾‹ä»£ç ï¼Œ </li><li> æˆ‘åœ¨ä¸šåŠ¡é€»è¾‘å±‚ä¸­é€šè¿‡æµ‹è¯•ç”¨ä¾‹å®ç°æ–¹æ³•ï¼Œ </li><li> æˆ‘æè¿°äº†æµ‹è¯•æ‰€éœ€çš„å…ƒç´ ã€‚ </li></ol><br> è¿™ç§æ–¹æ³•å¾ˆå¥½ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦åšä»»ä½•é¢å¤–çš„å·¥ä½œ-è¯¥æ¡†æ¶æ˜¯æ ¹æ®æµ‹è¯•æ­£å¸¸å·¥ä½œæ‰€å¿…éœ€çš„ã€‚ å¯ä»¥è¯´ï¼Œè¿™å°±æ˜¯MVPåœ¨æµ‹è¯•ä¸­çš„æ¦‚å¿µï¼šä»–ä»¬å¾ˆå¿«åšå‡ºäº†è´¡çŒ®ï¼Œå¹¶ä¸”å·²ç»å¼€å§‹å¸¦æ¥å¥½å¤„ã€‚ å¦‚æœæ‚¨é¦–å…ˆå†™äº†æ•°åƒè¡Œï¼Œæè¿°äº†åº”ç”¨ç¨‹åºçš„é¡µé¢ä»¥åŠå¦‚ä½•ä¸å®ƒä»¬äº¤äº’ï¼Œå¹¶ä¸”ä¸‰ä¸ªæœˆåæ‚¨ç¬¬ä¸€æ¬¡å•å‡»å°±é™·å…¥äº†â€œæ¼æ´â€ï¼Œå¹¶ä¸”æ„è¯†åˆ°å¿…é¡»ä»¥ä¸åŒçš„æ–¹å¼åšæ‰€æœ‰äº‹æƒ…ï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†åˆ›å»ºå·¥ä½œå°†æ°¸è¿œæ³¨å®šâ€œåœ¨gitçš„åœ°ä¸‹å®¤ä¸­æ”¶é›†ç°å°˜...çœŸæ­£çš„æµ‹è¯•äººå‘˜çŸ¥é“ï¼Œå‘ç°é”™è¯¯çš„è¶Šæ—©ï¼Œä¿®å¤å®ƒçš„æˆæœ¬å°±è¶Šä½ã€‚ åœ¨æ‰€æœ‰äº‹ç‰©ä¸­éƒ½ä½¿ç”¨è¿™ç§æ–¹æ³•-åœ¨å‡ ä¸ªå°æ—¶å†…ç¼–å†™äº†ä¸€ä¸ªæµ‹è¯•ï¼Œå°è¯•äº†ï¼Œä¸å–œæ¬¢-æ‰”æ‰äº†ï¼Œå¸å–äº†æ•™è®­ï¼Œç»§ç»­å‰è¿›ã€‚ <br><br> æ‰€ä»¥è¾“å…¥æ˜¯ï¼š <br><br><ul><li>  Androidåº”ç”¨ç¨‹åºï¼Œç”¨äºåœ¨è¯åˆ¸äº¤æ˜“æ‰€è¿›è¡Œäº¤æ˜“ï¼› </li><li>  Javaä¸å¼€å‘äººå‘˜åœ¨åŒä¸€å †æ ˆä¸­å·¥ä½œï¼› </li><li> åŸºæœ¬æ¡†æ¶UI Automatorï¼› </li><li> æ‚¨éœ€è¦åœ¨åº”ç”¨ç¨‹åºä¸­ç¼–å†™ç™»å½•æµ‹è¯•ã€‚ </li></ul><br><h3> é¡¹ç›®å‡†å¤‡ </h3><br> ç”±äºæˆ‘å°è¯•å°†å°½å¯èƒ½å¤šçš„é›†æˆåˆ°å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰å¼€å§‹åˆ›å»ºæ–°é¡¹ç›®ã€‚ æ ¹æ®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£</a> ï¼Œä»ªå™¨æµ‹è¯•å¿…é¡»æ”¾ç½®åœ¨<code>src/androidTest/java</code>æ–‡ä»¶å¤¹ä¸­ã€‚ åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œæ”¶é›†å™¨å·²ç»é…ç½®å¥½äº†ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œè¯·é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ„å»ºé…ç½®</a> ã€‚ æˆ‘ä»¬è¿˜éœ€è¦å¼€å‘ç¯å¢ƒï¼ŒAndroid SDKï¼Œä»¿çœŸå™¨ï¼Œå·¥å…·ï¼Œå¹³å°å·¥å…·å’Œä»¿çœŸå™¨æ‰€éœ€çš„å¹³å°ã€‚ å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Android Studioï¼Œåˆ™å¯ä»¥é€šè¿‡SDK Managerå¿«é€Ÿå®‰è£…æ‰€æœ‰è¿™äº›å·¥å…·ï¼š <br><br><img src="https://habrastorage.org/webt/fi/fg/vd/fifgvdmdiqds3uyoqitomjwsmsa.png"><br><br><h3> æµ‹è¯•å±‚ </h3><br> æ­£å¦‚æˆ‘åœ¨ä¸Šé¢æ‰€å†™ï¼Œæˆ‘ä»¬å°†åœ¨åº”ç”¨ç¨‹åºä¸­è‡ªåŠ¨æ‰§è¡Œç™»å½•æµ‹è¯•ã€‚ è¯·è®°ä½ï¼Œä»£ç åº”çœ‹èµ·æ¥åƒå¸¸è§„æµ‹è¯•ç”¨ä¾‹ï¼š <br><br>  <b>å‰ææ¡ä»¶ï¼š</b>è¿è¡Œåº”ç”¨ç¨‹åºã€‚ <br>  <b>æ­¥éª¤1ï¼š</b>ä½¿ç”¨myLogin / myPasswordå¸æˆ·ç™»å½•ã€‚ <br>  <b>æ­¥éª¤2ï¼š</b>æ£€æŸ¥å½“å‰ç”¨æˆ·çš„åç§°ã€‚ <br>  <b>é¢„æœŸç»“æœï¼š</b>å½“å‰ç”¨æˆ·æ˜¯Ivan Ivanovã€‚ <br><br>  <i>å°å…è´£å£°æ˜ï¼šæ ¹æ®è®¾è®¡æµ‹è¯•çš„æœ€ä½³å®è·µï¼Œåœ¨æ‚¨éœ€è¦åˆ›å»º/æ‰¾åˆ°å¸æˆ·çš„å‰æä¸‹ã€‚</i>  <i>ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œæˆ‘çœç•¥äº†è¿™ä¸€åˆ»ã€‚</i> <br><br> æˆ‘ä»¬çš„è¯¾ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(AndroidJUnit4.class) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginTests</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TestApplication myApp; <span class="hljs-meta"><span class="hljs-meta">@Before</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ myApp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestApplication(); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testLogin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ myApp.login(<span class="hljs-string"><span class="hljs-string">"myLogin"</span></span>,<span class="hljs-string"><span class="hljs-string">"myPassword"</span></span>); String currentUser = myApp.getCurrentUserName(); assertEquals(<span class="hljs-string"><span class="hljs-string">"Wrong name"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, currentUser); } <span class="hljs-meta"><span class="hljs-meta">@After</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tearDown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ myApp.close(); } }</code> </pre> <br><h3> ä¸šåŠ¡é€»è¾‘ </h3><br> è¯¥æµ‹è¯•ä½¿ç”¨<code>TestApplication()</code>ç±»åŠå…¶ä¸¤ä¸ªæ–¹æ³•ï¼š <code>login()</code>å’Œ<code>getCurrentUserName()</code> ã€‚ å¦å¤–ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªç±»æ„é€ å‡½æ•°ï¼ˆåœ¨å…¶ä¸­å¯åŠ¨åº”ç”¨ç¨‹åºï¼‰å’Œ<code>close()</code>æ–¹æ³•ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestApplication</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UiDevice device; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PageObject page; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestApplication</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String login, String password)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentUserName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br> æˆ‘ä»¬çš„ç±»çš„å®ä¾‹å°†å…·æœ‰ä¸¤ä¸ªå˜é‡ï¼š <br><br><ul><li>  <code>device</code> ï¼Œå±äº<code>android.support.test.uiautomator.UiDevice</code>ç±»-é€šè¿‡å®ƒæˆ‘ä»¬ä¸è®¾å¤‡è¿›è¡Œäº¤äº’ï¼› </li><li>  <code>page</code> ï¼Œ <code>PageObject</code>ç±»ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­åˆ›å»ºã€‚ </li></ul><br> è®©æˆ‘ä»¬ä»æ„é€ å‡½æ•°å¼€å§‹ã€‚ åœ¨å…¶ä¸­ï¼Œåˆ›å»ºå˜é‡å®ä¾‹å¹¶è¿è¡Œåº”ç”¨ç¨‹åºï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestApplication</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Connect to device device = UiDevice.getInstance(InstrumentationRegistry.getInstrumentation()); device.pressHome(); // Get launch intent String packageName = InstrumentationRegistry.getTargetContext() .getPackageName(); Context context = InstrumentationRegistry.getContext(); Intent intent = context.getPackageManager() .getLaunchIntentForPackage(packageName) .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK); // Stat application context.startActivity(intent); // Get page objects page = new PageObject(device, packageName); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">å¯åŠ¨åº”ç”¨ç¨‹åºçš„ä¸€äº›æŠ€å·§</b> <div class="spoiler_text"> ä¸ºäº†æ›´å¥½åœ°æ§åˆ¶è¢«æµ‹åº”ç”¨ç¨‹åºï¼Œå¯ä»¥å¢åŠ å¯åŠ¨å™¨ï¼ˆå¦‚æœæ‚¨â€œå†·â€è¿è¡Œä»¿çœŸå™¨ï¼‰å’Œåº”ç”¨ç¨‹åºæœ¬èº«å¯åŠ¨çš„æœŸæœ›ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>ä¹Ÿå»ºè®®è¿™æ ·åšã€‚ <br></div></div><br>  <i>æ³¨æ„ï¼šä»…å½“æ‚¨çš„æµ‹è¯•ä¸åº”ç”¨ç¨‹åºæœ¬èº«åœ¨åŒä¸€é¡¹ç›®ä¸­æ—¶ï¼Œæ‰é€‚åˆé€šè¿‡<code>android.content.Context.getTargetContext()</code>è¿è¡Œåº”ç”¨ç¨‹åºã€‚</i>  <i>å¦‚æœå•ç‹¬ä½¿ç”¨ï¼Œåˆ™æœ‰å¿…è¦æµè§ˆèœå•ã€‚</i> <br><br> æµ‹è¯•çš„ä¸šåŠ¡é€»è¾‘æ˜¯ç”¨æˆ·å¿…é¡»é‡‡å–çš„ç‰¹å®šæ­¥éª¤ï¼Œä»¥è·å¾—ä»»ä½•æœ‰æ„ä¹‰çš„ï¼ˆå¯¹ç”¨æˆ·è€Œè¨€ï¼‰ç»“æœã€‚ åœ¨æ‚¨è‡ªå·±çš„è¶…å£°ä¸‹ç™»å½•æ˜¯ä¸€ä¸ªé‡è¦çš„ç»“æœã€‚ æ­¥éª¤ï¼šå•å‡»â€œç™»å½•â€æŒ‰é’®ï¼Œåœ¨â€œç™»å½•â€å­—æ®µä¸­è¾“å…¥ç”¨æˆ·åï¼Œåœ¨â€œå¯†ç â€å­—æ®µä¸­è¾“å…¥å¯†ç ï¼Œç„¶åå•å‡»â€œç™»å½•â€æŒ‰é’®ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String login, String password)</span></span></span><span class="hljs-function"> </span></span>{ page.login().click(); page.loginEntry().setText(login); page.passwordEntry().setText(password); page.signIn().click(); }</code> </pre> <br> è¦è·å–å½“å‰ç”¨æˆ·ï¼Œä¸€åˆ‡éƒ½å˜å¾—æ›´åŠ ç®€å•ï¼Œåªéœ€è·å–å­—æ®µå€¼å³å¯ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentUserName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> page.currentUserName().getText(); } }</code> </pre> <br> è¦å…³é—­è¯¥åº”ç”¨ç¨‹åºï¼Œåªéœ€å•å‡»â€œä¸»é¡µâ€æŒ‰é’®ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ device.pressHome(); }</code> </pre> <br><h3> é¡µé¢å…ƒç´ çš„æè¿° </h3><br> è¯¥å±‚çš„æ¦‚å¿µæ˜¯å®ƒåº”è¯¥è¿”å›å‡†å¤‡å°±ç»ªçš„å…ƒç´ ï¼ˆåœ¨æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™æ˜¯ç±»<code>android.support.test.uiautomator.UiObject2</code> ï¼‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¶ˆè´¹è€…ä¸å¿…æ‹…å¿ƒå¯¹è±¡çš„çŠ¶æ€ï¼Œå¦‚æœä»–è¿”å›äº†å¯¹è±¡ï¼Œåˆ™å¯ä»¥ç«‹å³ä¸ä»–è¿›è¡Œäº¤äº’ï¼šå•å‡»ï¼Œå¡«å†™æˆ–é˜…è¯»æ–‡æœ¬ã€‚ è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„ç»“æœ-åœ¨è¿™ä¸€å±‚ä¸­ï¼Œæˆ‘ä»¬å°†å®ç°æœŸæœ›ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUiObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BySelector selector)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> device.wait(Until.findObject(selector), <span class="hljs-number"><span class="hljs-number">10000</span></span>); }</code> </pre> <br> ä¸Šé¢å®šä¹‰çš„æ–¹æ³•å°†ç”±æˆ‘ä»¬çš„<code>PageObject</code>ç±»çš„å…¬å…±æ¥å£ä½¿ç”¨ã€‚ ç™»å½•å­—æ®µç¤ºä¾‹ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loginEntry</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getUiObject(loginEntrySelector()); }</code> </pre> <br> å‰©ä¸‹è¦ç¡®å®šçš„é€‰æ‹©å™¨ï¼Œæˆ‘ä»¬å°†é€šè¿‡è¯¥é€‰æ‹©å™¨æ‰¾åˆ°è¯¥å­—æ®µã€‚ ä½¿ç”¨<code>android.support.test.uiautomator.By</code>ç±»çš„é™æ€æ–¹æ³•<code>android.support.test.uiautomator.BySelector</code>æœ€æ–¹ä¾¿åœ°è·å–<code>android.support.test.uiautomator.BySelector</code>çš„å®ä¾‹ã€‚ æˆ‘åŒæ„è¿™æ ·çš„å‘å±•ï¼Œåœ¨ä»»ä½•åœ°æ–¹ï¼Œåªè¦æœ‰å¯èƒ½ï¼Œéƒ½ä¼šæœ‰å”¯ä¸€çš„èµ„æºIDï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> BySelector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loginEntrySelector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> By.res(packageName, <span class="hljs-string"><span class="hljs-string">"login"</span></span>); }</code> </pre> <br> åœ¨å·¥å…·åŒ…ï¼ˆå®‰è£…åœ¨â€œå‡†å¤‡â€éƒ¨åˆ†ä¸­ï¼‰ä¸­çš„uiautomatorviewerå®ç”¨ç¨‹åºä¸­æ£€æŸ¥ç•Œé¢å¾ˆæ–¹ä¾¿ï¼š <br><br><img src="https://habrastorage.org/webt/gw/yw/mv/gwywmvdmhdkyjk-orutm6xbkfja.png"><br><br> é€‰æ‹©æ‰€éœ€çš„å…ƒç´ ï¼Œç„¶ååœ¨â€œèŠ‚ç‚¹è¯¦ç»†ä¿¡æ¯â€éƒ¨åˆ†ä¸­æŸ¥çœ‹èµ„æºIDã€‚ å®ƒç”±ç¨‹åºåŒ…çš„åç§°ä»¥åŠå®é™…ä¸Šçš„æ ‡è¯†ç¬¦ç»„æˆã€‚ æˆ‘ä»¬åœ¨<code>TestApplication</code>ç±»çš„æ„é€ å‡½æ•°ä¸­è·å¾—äº†åŒ…çš„åç§°ï¼Œå¹¶åœ¨åˆ›å»º<code>PageObject</code>æ—¶ä½¿ç”¨äº†å®ƒã€‚ <br><br> å®Œæ•´ä»£ç ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">PageObjectç±»</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PageObject</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UiDevice device; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String packageName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> BySelector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loginButtonSelector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> By.res(packageName, <span class="hljs-string"><span class="hljs-string">"user_view"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> BySelector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loginEntrySelector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> By.res(packageName, <span class="hljs-string"><span class="hljs-string">"login"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> BySelector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">passwordEntrySelector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> By.res(packageName, <span class="hljs-string"><span class="hljs-string">"password"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> BySelector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">signInSelector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> By.res(packageName, <span class="hljs-string"><span class="hljs-string">"btnLogin"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> BySelector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">userNameSelector</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> By.res(packageName, <span class="hljs-string"><span class="hljs-string">"user_name"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PageObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UiDevice device, String packageName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.device = device; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.packageName = packageName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getUiObject(loginButtonSelector()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loginEntry</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getUiObject(loginEntrySelector()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">passwordEntry</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getUiObject(passwordEntrySelector()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">signIn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getUiObject(signInSelector()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUserName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getUiObject(userNameSelector()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> UiObject2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUiObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BySelector selector)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> device.wait(Until.findObject(selector), <span class="hljs-number"><span class="hljs-number">10000</span></span>); } }</code> </pre> <br></div></div><br><h3> è¿è¡Œæµ‹è¯• </h3><br> ä»…æ­¤è€Œå·²ï¼Œå®ƒä»ç„¶å¯ä»¥è¿è¡Œã€‚ é¦–å…ˆï¼Œè¿æ¥åˆ°è®¾å¤‡æˆ–å¯åŠ¨ä»¿çœŸå™¨ã€‚ ä½¿ç”¨<code>adb devices</code>å‘½ä»¤æ£€æŸ¥è¿æ¥ï¼ˆadbå®ç”¨ç¨‹åºæ˜¯platform-toolsçš„ä¸€éƒ¨åˆ†ï¼‰ï¼š <br><br><pre> <code class="bash hljs">List of devices attached emulator-5554 device</code> </pre> <br> å¦‚æœæœ‰é—®é¢˜ï¼Œé‚£å°±åš <br><br><pre> <code class="bash hljs">gradlew.bat connectedAndroidTest</code> </pre> <br> å¹¶äº«å—â€œæ³¨å…¥çš„æœºå™¨äººï¼Œè€Œä¸æ˜¯äººç±»â€çš„æ–¹å¼ï¼ˆcï¼‰ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN416397/">https://habr.com/ru/post/zh-CN416397/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN416381/index.html">2018å¹´ç½—é©¬ä¿±ä¹éƒ¨æŠ¥å‘Šï¼Œç¬¬3.13ç« ï¼šæ…ˆå–„äº‹ä¸šï¼ŒæŠ•èµ„ï¼Œä¼—åŒ…å’ŒåŒºå—é“¾</a></li>
<li><a href="../zh-CN416385/index.html">å¦‚æœç›¸å…³æ€§è¾¾åˆ°100ï¼…ï¼Œé‚£ä¹ˆæŸä¸ªåœ°æ–¹çš„é”™è¯¯å°±ä¼šè”“å»¶ï¼šRambler Groupçš„å®ä¹ ç»å†</a></li>
<li><a href="../zh-CN416387/index.html">è™¾ï¼šä½¿ç”¨ImageMagic ++ï¼ŒSObjectizerå’ŒRESTinioåœ¨ç°ä»£C ++ä¸­ç¼©æ”¾å’Œå…±äº«HTTPå›¾åƒ</a></li>
<li><a href="../zh-CN416391/index.html">ä¼˜åŒ–æœåŠ¡å™¨ä¸Šâ€‹â€‹è™šæ‹Ÿæœºçš„æ”¾ç½®</a></li>
<li><a href="../zh-CN416393/index.html">IIDFä¼šè®®ï¼šå…¬å¸ä¸æ˜¯åˆåˆ›å…¬å¸</a></li>
<li><a href="../zh-CN416399/index.html">æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æœºå™¨å­¦ä¹ åˆ†æç§»åŠ¨åº”ç”¨è¯„è®º</a></li>
<li><a href="../zh-CN416401/index.html">Blenderï¼šç”¨äºè¿æ¥åˆ°KiCadåº“çš„èŠ¯ç‰‡çš„3Dæ¨¡å‹</a></li>
<li><a href="../zh-CN416403/index.html">é‡‘èç§‘æŠ€æ‘˜è¦ï¼šæ”»å‡»PIRé“¶è¡Œï¼Œè”é‚¦ç¨æ”¶æœåŠ¡å’Œä»å¡åˆ°å¡è½¬ç§»çš„ç¨æ”¶ä»¥åŠä¸€äº›åŒºå—é“¾å’ŒåŠ å¯†è´§å¸</a></li>
<li><a href="../zh-CN416405/index.html">ä¸Yandexåˆä½œçš„å­¦å£«å­¦ä½è¯¾ç¨‹</a></li>
<li><a href="../zh-CN416407/index.html">èŠ‚çœæ¥è‡ªMikrotikå—…æ¢å™¨çš„æµé‡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>