<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçâ üë©‚Äçüë©‚Äçüëß‚Äçüë¶ üíç Sistema de Simula√ß√£o Simples Go üÜö üë®üèº‚Äçüç≥ üôã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introdu√ß√£o 
 A simula√ß√£o √© um m√©todo no qual, para realizar experimentos, o sistema real estudado √© substitu√≠do por um modelo. Nesse modelo, voc√™ p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistema de Simula√ß√£o Simples Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448076/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/9e/eg/pu9eeg4seokrai0jac-5y9ojk1s.png" width="200" height="100"></div><br><br><h2>  1. Introdu√ß√£o </h2><br>  A simula√ß√£o √© um m√©todo no qual, para realizar experimentos, o sistema real estudado √© substitu√≠do por um modelo.  Nesse modelo, voc√™ pode perder as situa√ß√µes individuais e muitas delas.  As estat√≠sticas coletadas podem ajudar a tirar conclus√µes sobre os processos no sistema, bem como tra√ßar caminhos de otimiza√ß√£o. <br><a name="habracut"></a><br>  A simula√ß√£o √© frequentemente considerada como uma esp√©cie de testes experimentais, mas, ao mesmo tempo, √© menos dispendiosa, permite alterar rapidamente os par√¢metros e observar o sistema simulado em din√¢mica. <br><br>  J√° h√° cerca de meio s√©culo em modelagem de simula√ß√£o, modelos de computador foram usados.  Muitos programas e estruturas diferentes foram criados para seu desenvolvimento, dentre os quais, na minha opini√£o, os mais desenvolvidos s√£o as ferramentas para modelagem de sistemas de filas (QS).  Um dos programas mais conhecidos e simples para simula√ß√£o de QS - GPSS World (General Purpose Simulation System - um sistema de modelagem de uso geral), pode ser encontrado em mais detalhes nos links <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[1]</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[2]</a> . <br><br>  O conceito deste programa foi a base da estrutura de simula√ß√£o no Go. <br><br><h2>  Simula√ß√£o no GPSS </h2><br>  Um modelo no GPSS √© uma sequ√™ncia de blocos (comandos) que descreve os objetos simulados entre os quais as transa√ß√µes est√£o se movendo.  Quando uma transa√ß√£o entra no bloco, s√£o gerados eventos que levam a uma mudan√ßa no estado do objeto modelado ou a uma mudan√ßa no estado / par√¢metros da transa√ß√£o. <br><br>  Os principais blocos da ordem de dez: GERAR, TERMINAR, ATRIBUIR, APLICAR, LAN√áAR, FILA, AVAN√áAR, PARTIDA, IN√çCIO.  Existem cerca de tr√™s d√∫zias de blocos no total.  Os blocos possuem par√¢metros, que podem ser n√∫meros, nomes de fun√ß√µes, r√≥tulos no programa de simula√ß√£o, nomes de vari√°veis.  Mais detalhes sobre os blocos podem ser encontrados, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Os objetos no GPSS t√™m um conjunto de atributos num√©ricos padr√£o (NAV) e atributos l√≥gicos padr√£o (ALS).  Por exemplo, para uma fila, um dos NAV √© o comprimento atual e um exemplo de ALS para alguns equipamentos ser√° VERDADEIRO ou ocupado (FALSO). <br>  Em algumas vers√µes do GPSS, h√° uma visualiza√ß√£o do processo de modelagem, mas na maioria das vezes ele est√° ausente.  Com base nos resultados da simula√ß√£o, um relat√≥rio √© gerado no GPSS, indicando o NAV e o ALS para todos os objetos. <br><br><h2>  Implementa√ß√£o Go </h2><br>  A implementa√ß√£o no Go √© o desenvolvimento de um conjunto de objetos em fun√ß√£o dos blocos GPSS.  O primeiro foi criado Pipeline - o objeto no qual a simula√ß√£o √© realizada. <br><br>  Com base em um <code>map</code> cont√©m uma lista de componentes para descrever o sistema simulado.  Como, durante a simula√ß√£o, as transa√ß√µes devem passar por uma sequ√™ncia de blocos em uma ordem estrita, no m√©todo de adi√ß√£o de componentes <code>Append</code> , foi implementado o procedimento de inclus√£o com indica√ß√£o simult√¢nea dos endere√ßos das transa√ß√µes a partir deles.  O nome do componente √© usado como chave do <code>map</code> , portanto, cada componente deve ter um nome exclusivo. <br><br>  Ap√≥s adicionar todos os componentes, voc√™ pode iniciar a simula√ß√£o usando o m√©todo <code>Start</code> .  Dentro dele, um desvio c√≠clico de todos os componentes √© implementado por um determinado tempo de simula√ß√£o.  No final da simula√ß√£o, voc√™ pode imprimir um relat√≥rio contendo NAV e ALS. <br><br>  O segundo elemento importante s√£o os componentes reais para descrever a simula√ß√£o.  O seguinte foi implementado: Generator - gera transa√ß√µes, Advance - cria atrasos no caminho da transa√ß√£o, Fila - filas de transa√ß√µes, Facility - um dispositivo que √© capturado exclusivamente pela transa√ß√£o por um tempo, Hole - um "buraco" no qual as transa√ß√µes falham no final do caminho.  Obviamente, esse conjunto n√£o √© suficiente para criar modelos de simula√ß√£o complexos, mas o suficiente para encontrar a solu√ß√£o e comparar com os resultados do GPSS.  Todos os componentes implementam a interface IBaseObj, que cobre a funcionalidade m√≠nima exigida. <br><br>  Cada componente tem uma fila de transa√ß√µes.  Diretamente como uma fila, ele √© usado apenas na fila, para outros componentes √© apenas um reposit√≥rio.  A fila √© implementada com base no <code>map</code> .  No processo de modelagem, os componentes passam por sua vez e verificam a prontid√£o (cumprimento de uma determinada condi√ß√£o) da transa√ß√£o para transmiss√£o ao pr√≥ximo componente.  A transfer√™ncia √© realizada pelo m√©todo <code>AppendTransact</code> do pr√≥ximo componente.  Se a transfer√™ncia for bem-sucedida, a transa√ß√£o ser√° removida da fila, respectivamente, o pr√≥ximo componente ser√° revezado.  Como v√°rios destinat√°rios s√£o definidos para cada componente, se n√£o for poss√≠vel enviar uma transa√ß√£o para um destinat√°rio, tentamos envi√°-la para outro. <br><br>  Para gerar vari√°veis ‚Äã‚Äãaleat√≥rias ao determinar a hora da apar√™ncia da transa√ß√£o e criar atrasos, as fun√ß√µes PRNG no Go s√£o usadas. <br><br>  Como ao modelar, ao mesmo tempo, pode haver muitas transa√ß√µes movendo-se entre diferentes componentes, surgiu a id√©ia de usar goroutines dentro dos componentes.  O pipeline, passando pelos componentes, inicia o manipulador <code>HandleTransacts</code> para cada um deles, dentro do qual a goroutine √© criada.  Ap√≥s a conclus√£o de todas as goroutines, o contador de tempo do modelo √© incrementado e o <code>HandleTransacts</code> √© chamado <code>HandleTransacts</code> . <br><br>  O √∫ltimo objeto de chave √© a pr√≥pria transa√ß√£o.  Ele tem um identificador, uma hora de nascimento e morte, o propriet√°rio (em qual componente ele est√° agora), v√°rios par√¢metros para calcular o SCA e o SCHL. <br><br>  Na fig.  1 √© um diagrama estrutural da intera√ß√£o dos principais objetos da estrutura durante a modelagem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ht/yc/x2/htycx2yszz-c_ljrthrmu5w0xdg.jpeg" width="400" height="200"></div><br>  <b>Fig.</b>  <b>1. Diagrama estrutural generalizado da intera√ß√£o dos principais objetos na simula√ß√£o</b> <br><br><h2>  Exemplo de simula√ß√£o </h2><br>  Suponha que voc√™ precise simular o trabalho de um cabeleireiro.  Este √© um exemplo famoso do GPSS.  Os visitantes v√£o aleatoriamente, com uma frequ√™ncia de 18 ¬± 6 minutos, seu n√∫mero n√£o √© conhecido antecipadamente.  Temos um cabeleireiro, ele passa 16 ¬± 4 minutos em um corte de cabelo.  Ent√£o, quantas pessoas ele cortar√° para um dia √∫til?  Quantas pessoas estar√£o na fila?  Qual √© o tempo m√©dio necess√°rio para um corte de cabelo e quanto tempo as pessoas esperam na fila?  Muitas perguntas e uma simula√ß√£o simples.  O diagrama de blocos na Fig.  2) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1a/bb/sf/1abbsf7qcec5fugytkwjydq28mm.jpeg" width="300" height="150"></div><br>  <b>Fig.</b>  <b>2. O esquema estrutural de modelar um cabeleireiro</b> <br><br>  O c√≥digo para a constru√ß√£o do modelo ser√° o seguinte. <br><br><pre> <code class="go hljs">barbershop := NewPipeline(<span class="hljs-string"><span class="hljs-string">"Barbershop"</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   clients := NewGenerator("Clients", 18, 6, 0, 0, nil) //   chairs := NewQueue("Chairs") //  master := NewFacility("Master", 16, 4) //  hole := NewHole("Out") //  barbershop.Append(clients, chairs) //       barbershop.Append(chairs, master) //      barbershop.Append(master, hole) //     barbershop.Append(hole) //        barbershop.Start(480) //    &lt;-barbershop.Done //   barbershop.PrintReport()</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Os resultados da simula√ß√£o podem ser encontrados aqui.</b> <div class="spoiler_text">  Nome do pipeline "Barbearia" <br>  Tempo de simula√ß√£o 480 <br>  Nome do objeto "Cadeiras" <br>  Conte√∫do m√°ximo 1 <br>  Total de entradas 26 <br>  Zero entradas 11 <br>  Entradas zero persistentes 42,31% <br>  Na fila 0 <br>  Tempo m√©dio / trans 2,58 <br>  Tempo m√©dio / trans sem zero entradas 4,47 <br><br>  Nome do objeto "Clientes" <br>  Gerado 26 <br><br>  Nome do objeto "Mestre" <br>  Avan√ßo m√©dio 16,46 <br>  Utiliza√ß√£o m√©dia 89,17 <br>  Entradas num√©ricas 26.00 <br>  Transact 26 na instala√ß√£o <br><br>  Nome do objeto "Out" <br>  Morto 25 <br>  Avan√ßo m√©dio 16,56 <br>  Vida m√©dia 19,44 <br></div></div><br>  Atendendo a 25 clientes, o dia 26 no momento da conclus√£o da simula√ß√£o ainda estava na cadeira do mestre.  A fila n√£o passava de uma pessoa, 11 pessoas n√£o esperaram (passe zero) e imediatamente cortaram o cabelo.  Em m√©dia, as pessoas passaram 2,58 minutos na fila e, daqueles que estavam esperando (n√£o um passe zero), 4,47 minutos.  89,17% de seu tempo, cabeleireiro, corta intensamente. <br><br>  Obviamente, se voc√™ realizar outra simula√ß√£o, os resultados ser√£o alterados.  Por√©m, durante uma s√©rie de simula√ß√µes, o n√≠vel geral da carga do assistente e o n√∫mero de clientes atendidos ser√£o vis√≠veis.  Uma simula√ß√£o semelhante no GPSS produz resultados semelhantes. <br><br>  Outro exemplo  H√° um escrit√≥rio, tem 10 funcion√°rios e um banheiro.  As pessoas querem ir ao banheiro a cada 90 ¬± 60 minutos, ir ao banheiro por 5 ¬± 3 minutos, tomar banho por 15 ¬± 10 minutos, voltar ao escrit√≥rio por 5 ¬± 3 minutos.  Realizaremos a simula√ß√£o por 9 horas (8 horas de trabalho + 1 hora de almo√ßo), na fig.  3 √© um diagrama estrutural. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ni/ef/qf/niefqf8bfmmuojr1xlo3jqjwe_e.jpeg"></div><br>  <b>Fig.</b>  <b>3. Diagrama estrutural do modelo de emprego do banheiro: √† esquerda com um banheiro, √† direita com dois</b> <br><br>  √Ä esquerda √© um modelo com um banheiro, √† direita com dois.  A seguir est√° o c√≥digo do modelo. <br><br><pre> <code class="go hljs">waterclosetsim := NewPipeline(<span class="hljs-string"><span class="hljs-string">"Water Closet Simulation"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) office := NewGenerator(<span class="hljs-string"><span class="hljs-string">"Office"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) wantToToilet:= NewAdvance(<span class="hljs-string"><span class="hljs-string">"Wanted to use the toilet"</span></span>, <span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>) pathToWC := NewAdvance(<span class="hljs-string"><span class="hljs-string">"Path to WC"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) queue := NewQueue(<span class="hljs-string"><span class="hljs-string">"Queue to the WC"</span></span>) pathFromWC := NewAdvance(<span class="hljs-string"><span class="hljs-string">"Path from WC"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) wc := NewFacility(<span class="hljs-string"><span class="hljs-string">"WC"</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) pathToOffice:= NewAdvance(<span class="hljs-string"><span class="hljs-string">"Path from WC"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) waterclosetsim.Append(office, wantToToilet) waterclosetsim.Append(wantToToilet, pathToWC) waterclosetsim.Append(pathToWC, queue) waterclosetsim.Append(queue, wc) waterclosetsim.Append(wc, pathFromWC) waterclosetsim.Append(pathFromWC, wantToToilet) waterclosetsim.Start(<span class="hljs-number"><span class="hljs-number">540</span></span>) &lt;-waterclosetsim.Done waterclosetsim.PrintReport()</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Os resultados da simula√ß√£o s√£o os seguintes.</b> <div class="spoiler_text">  Nome do pipeline "Simula√ß√£o de arm√°rio de √°gua" <br>  Tempo de simula√ß√£o 540 <br>  Nome do objeto "Office" <br>  Gerado 10 <br><br>  Nome do objeto "Caminho do WC" <br>  Avan√ßo m√©dio 5,77 <br><br>  Nome do objeto "Caminho para o WC" <br>  Avan√ßo m√©dio 5,22 <br><br>  Nome do objeto "Fila no banheiro" <br>  Conte√∫do m√°ximo 4 <br>  Total de entradas 36 <br>  Zero entradas 8 <br>  Zero de entradas persistentes 22,22% <br>  Conte√∫dos atuais 4 <br>  Conte√∫do m√©dio 1,78 <br>  Tempo m√©dio / trans 24,11 <br>  Tempo m√©dio / trans sem zero entradas 31,00 <br><br>  Nome do objeto "WC" <br>  Avan√ßo m√©dio 14,69 <br>  Utiliza√ß√£o m√©dia 87,04 <br>  Entradas num√©ricas 32.00 <br>  Transacionar 2 na instala√ß√£o <br><br>  Nome do objeto "Queria usar o banheiro" <br>  Avan√ßo m√©dio 95,85 <br></div></div><br>  Havia at√© 4 pessoas na fila, 8 vezes que uma pessoa entrou imediatamente no banheiro, durante o dia √∫til o banheiro foi usado em 87,04%.  O mais significativo, na minha opini√£o, √© que as pessoas esperam cerca de meia hora (31 minutos) na fila do banheiro.  Talvez isso se deva ao fato de haver apenas um banheiro, e talvez pelo fato de que, em m√©dia, as pessoas ficam nele por 14,69 minutos. <br><br>  Depois de adicionar outro banheiro, vi que a fila foi reduzida para 3 pessoas, 29 vezes as pessoas imediatamente entraram no banheiro.  Mas o mais importante, a expectativa diminuiu quase tr√™s vezes. <br><br><h2>  Conclus√£o </h2><br>  A estrutura criada no joelho √© bastante simples e ainda limitada.  Planeja aumentar sua funcionalidade ao n√≠vel do GPSS.  O valor pr√°tico da estrutura √© a capacidade de montar r√°pida e facilmente um modelo de simula√ß√£o no Go e obter resultados. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O c√≥digo √© publicado no GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt448076/">https://habr.com/ru/post/pt448076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt448060/index.html">Escrevendo um cliente NTP simples</a></li>
<li><a href="../pt448068/index.html">Cientistas americanos ensinaram rob√¥s a usar ferramentas auxiliares</a></li>
<li><a href="../pt448070/index.html">Substitui√ß√£o de importa√ß√£o na pr√°tica. Parte 3. Sistemas Operacionais</a></li>
<li><a href="../pt448072/index.html">O entendimento de jun√ß√µes est√° quebrado. Definitivamente, essa n√£o √© a interse√ß√£o de c√≠rculos, honestamente</a></li>
<li><a href="../pt448074/index.html">ALU com 12 transistores (na verdade n√£o)</a></li>
<li><a href="../pt448078/index.html">Na estimativa autoregressiva da densidade espectral de um sinal estacion√°rio</a></li>
<li><a href="../pt448080/index.html">Robo jogador de futebol de iniciantes. Competi√ß√µes no MIPT. Android, Arduino e Bluetooth</a></li>
<li><a href="../pt448082/index.html">[Antes de segunda-feira] S√≠ndrome do olho seco</a></li>
<li><a href="../pt448084/index.html">Foto de um buraco negro - ser√° √∫til?</a></li>
<li><a href="../pt448088/index.html">Produ√ß√£o de motores a plasma na R√∫ssia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>