<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙄 👩‍👩‍👦 💄 安全离开你 🤟🏿 👨🏼‍⚖️ ⛅️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我参加了在纽约布鲁克林举行的邮件，恶意软件和移动反滥用工作组（m3aawg.org）的会议。 我期待更好的天气在城市中徘徊，享受会议以及该地区的各种美食。 我非常清楚天空的清晰度，甚至连雨都没带走。 整个星期都下雨。 这迫使我呆在带免费无线网络和工作笔记本电脑的酒店房间里。 我决定花时间研究http...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>安全离开你</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427171/"><p> 我参加了在纽约布鲁克林举行的邮件，恶意软件和移动反滥用工作组（m3aawg.org）的会议。 我期待更好的天气在城市中徘徊，享受会议以及该地区的各种美食。 我非常清楚天空的清晰度，甚至连雨都没带走。 整个星期都下雨。 这迫使我呆在带免费无线网络和工作笔记本电脑的酒店房间里。 我决定花时间研究<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.npmjs.com上的</a> Node.js及其相关软件包。 </p><br><p> 在您的项目中，有成千上万的用户软件包可供下载和安装。 我在NPM上搜索了流行的软件包名称，例如文件，备份，下载或上传。 上次搜索向我展示了一个来自Blueimp的名为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jQuery文件上传</a>的项目。 他的描述似乎很有趣，可以下载和浏览。 </p><a name="habracut"></a><br><blockquote>  jQuery的文件上传小部件，支持多种文件选择，拖放，进度指示器，图像，音频和视频的验证和预览。 它支持跨域请求，这是一种在客户端上通过调整图像大小来下载文件的部分可更新机制。 它可以在任何服务器平台（PHP，Python，Ruby on Rails，Java，Node.js，Go等）上运行，该平台支持通过HTML表单上传标准文件。 </blockquote><p> 我开始查看该包的源代码，并着重于server / php目录中的两个PHP文件。 这些文件分别称为upload.php和UploadHandler.php。  upload.php称为UploadHandler.php，主文件上传代码位于该文件中。 我还注意到，文件已上传到Web服务器根目录中的files /目录。 我用curl和原始的PHP脚本编写了一个简单的命令，向我确认我可以将文件上传到服务器，然后使用它在服务器上执行命令。 </p><br><pre><code class="bash hljs">$ curl -F <span class="hljs-string"><span class="hljs-string">"files=@shell.php"</span></span> http://example.com/jQuery-File-Upload-9.22.0/server/php/index.php</code> </pre> <br><p> 其中shell.php文件包含： </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $cmd=$_GET[<span class="hljs-string"><span class="hljs-string">'cmd'</span></span>]; system($cmd);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><p> 从测试服务器在浏览器中打开带有参数cmd = id的页面，将返回启动服务器进程的用户的ID。 我认为这个漏洞并没有引起人们的注意，谷歌的快速搜索向我证实了其他使用此代码或其派生项目的项目也很容易受到攻击。 也有几个视频展示了如何攻击类似的软件包。 </p><br><p> 我通知了jQuery File Upload的作者，并开始记录发现分配CVE编号的内容。 第二天，一个有点尴尬的作者回答了我，要求提供更多信息，因为他无法在测试环境中重现该漏洞。 </p><br><p> 通过电子邮件比较我们的测试配置后，我们发现Apache开发人员从2.3.9版本开始就关闭了对.htaccess文件的支持。 事实证明，这样做是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://">为了提高性能</a> ，因此服务器不必在每次访问相应目录时都检查此文件。 此外，还进行了此更改以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://">防止用户覆盖</a>服务器上配置<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://">的安全设置</a> 。 </p><br><p> 因此，Apache在禁用.htaccess时有良好的意图，但是他们所做的更改也使某些开发人员和他们的项目处于危险之中，尤其是当他们依靠.htaccess中的安全设置时。 </p><br><p> 对于此库，为了正确处理此情况并修复CVE-2018-9206文件上传漏洞，开发人员<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">更改了代码</a> ，使其仅下载图像文件。 </p><br><h3 id="eta-problema-bolshe-chem-odnogo-proekta"> 这个问题不止一个项目。 </h3><br><p> 在这里还值得注意的是，由于Apache的更改，剩下的7,800个项目中的某些可能容易受到文件上传问题的影响。 </p><br><p><img src="https://habrastorage.org/webt/-g/ki/4d/-gki4dbjtpslaemnlr0axoqhc48.png"></p><br><p> 这些分支中的大多数仍然在其代码中带有原始漏洞。 在某些情况下，即使在开发人员编辑了Blueimp的原始代码并将其嵌入到他的项目中之后，该漏洞仍然存在，因此这些项目仍然容易受到我的攻击示例的影响，但会稍有变化。 </p><br><p> 这意味着，如果在生产中使用了这些项目中的任何一个，那么它将面临下载文件并随后执行的漏洞。 创造了从应用程序窃取数据，注入恶意软件，污损和其他损害机会的机会。 </p><br><p> 不幸的是，无法确定确切地仍支持原始jQuery File Upload派生的项目数量，也无法应用在主项目中所做的更改。 如果有的话，也不可能确切地确定在生产中使用分支项目的位置。 此外，直到2010年，该项目的较旧版本也容易受到文件下载问题的影响。 </p><br><h3 id="zaklyuchenie"> 结论 </h3><br><p> 互联网依靠许多安全机制来确保我们的系统，数据和交易的安全。 如果这些机制之一突然消失，则可能会损害依赖它的用户和开发人员的安全。 </p><br><p> 对于开发人员而言，最好查看他们基于其项目的系统和库中的更改。 在本文中，Apache删除的安全机制不仅影响了Blueimp的Jquery文件上传，还影响了其所有分支和分支。 该漏洞影响了许多依赖它的项目，从独立的Web应用程序到WordPress和其他CMS的插件。 </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">原始错误报告</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录CVE-2018-9206</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ZDNet文章</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN427171/">https://habr.com/ru/post/zh-CN427171/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN427155/index.html">南安普敦滤芯巴士-清洁城市的第一步</a></li>
<li><a href="../zh-CN427159/index.html">我们在数据库中收集Mikrotik防火墙的日志</a></li>
<li><a href="../zh-CN427163/index.html">新材料将帮助提高太阳能热电厂的效率</a></li>
<li><a href="../zh-CN427165/index.html">如何为Atlassian Jira Server开发集成测试（jira-func-test-plugin）</a></li>
<li><a href="../zh-CN427169/index.html">特斯拉悄悄删除了完整的自动驾驶仪选项</a></li>
<li><a href="../zh-CN427173/index.html">电话比免费便宜吗？</a></li>
<li><a href="../zh-CN427175/index.html">阳光。 或者如果你是灵魂中的植物怎么办</a></li>
<li><a href="../zh-CN427177/index.html">自吸式水仙花的生产能力不及谦逊的领导者</a></li>
<li><a href="../zh-CN427179/index.html">Palm用新的工具从灰烬中重生</a></li>
<li><a href="../zh-CN427181/index.html">如果您睡了十年，今天如何进行全栈开发</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>