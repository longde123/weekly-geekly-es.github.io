<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÆ üéÅ ‚ú¥Ô∏è Diverses choses dans MetaPost ‚õàÔ∏è üê≥ ü•É</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quel est le meilleur outil √† utiliser pour dessiner des images vectorielles? Pour moi et probablement pour beaucoup d'autres, la r√©ponse est assez √©vi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Diverses choses dans MetaPost</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454376/">  Quel est le meilleur outil √† utiliser pour dessiner des images vectorielles?  Pour moi et probablement pour beaucoup d'autres, la r√©ponse est assez √©vidente: Illustrator, ou, peut-√™tre, Inkscape.  C'est du moins ce que je pensais quand on m'a demand√© de dessiner environ huit cents diagrammes pour un manuel de physique.  Rien d'exceptionnel, juste un tas d'illustrations en noir et blanc avec des sph√®res, des ressorts, des poulies, des lentilles, etc.  √Ä ce moment-l√†, on savait d√©j√† que le livre allait √™tre fait en LaTeX et on m'a donn√© un certain nombre de documents MS Word avec des images int√©gr√©es.  Certains d'entre eux √©taient des images num√©ris√©es d'autres livres, d'autres des dessins au crayon.  En imaginant des jours et des nuits √† encrer ce truc, je me suis senti √©tourdi, alors je me suis vite retrouv√© √† fantasmer sur une solution plus automatis√©e.  Pour une raison quelconque, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MetaPost</a> est devenu le centre de ces fantasmes. <br><br><img src="https://habrastorage.org/webt/nu/e4/zb/nue4zbfxj3ubc7m1cggctnzg7e4.png"><br><br><a name="habracut"></a><br><br>  Le principal avantage de l'utilisation de la solution MetaPost (ou similaire) est que chaque image peut √™tre une sorte de fonction de plusieurs variables.  Une telle image peut √™tre rapidement ajust√©e pour toute circonstance impr√©vue de la mise en page, sans perturber les relations internes importantes de l'illustration (ce qui m'inqui√©tait vraiment), ce qui n'est pas facile √† r√©aliser avec des outils plus traditionnels.  En outre, les √©l√©ments r√©currents, toutes ces sph√®res et ressorts, peuvent √™tre rendus plus int√©ressants visuellement que les outils conventionnels ne le permettraient avec les m√™mes contraintes de temps. <br><br>  Je voulais faire des images avec une sorte de hachure, un peu comme ce que l'on rencontre dans les vieux livres. <br><br><img src="https://habrastorage.org/webt/uq/2h/ay/uq2hayq7aiptmw1eididz3u3-q0.png"><br><br>  Tout d'abord, j'avais besoin de pouvoir produire des courbes d'√©paisseur variable.  La principale complication ici est de construire une courbe qui suit la courbe d'origine √† une distance variable.  J'ai probablement utilis√© la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">m√©thode de</a> travail la plus primitive, qui se r√©sume √† simplement d√©placer les segments de ligne reliant les points de contr√¥le de la courbe de B√©zier d'une distance donn√©e, sauf que cette distance varie le long de la courbe. <br><br><img src="https://habrastorage.org/webt/vm/jq/ha/vmjqhahvkkwaek72szkggyjoocs.png"><br><br>  Dans la plupart des cas, cela a bien fonctionn√©. <br><br><img src="https://habrastorage.org/webt/pt/vr/gr/ptvrgric1es7mutjptz6oli7w0k.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> √Ä partir de l√†, il est suppos√© que la biblioth√®que est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√©l√©charg√©e</a> et <code>input fiziko.mp;</code>  est pr√©sent dans le code MetaPost.  La m√©thode la plus rapide consiste √† utiliser ConTeXt (alors vous n'avez pas besoin de <code>beginfig</code> et <code>endfig</code> ): <br><br> <code>\starttext <br> \startMPcode <br> input fiziko.mp; <br> % the code goes here <br> \stopMPcode <br> \stoptext <br></code> <br><br>  ou LuaLaTeX: <br><br> <code>\documentclass{article} <br> \usepackage{luamplib} <br> \begin{document} <br> \begin{mplibcode} <br> input fiziko.mp; <br> % the code goes here <br> \end{mplibcode} <br> \end{document} <br></code> <br><br> <code>beginfig(3); <br> path p, q; % MetaPost's syntax is reasonably readable, so I'll comment mostly on my stuff <br> p := (0,-1/4cm){dir(30)}..(5cm, 0)..{dir(30)}(10cm, 1/4cm); <br> q := offsetPath(p)(1cm*sin(offsetPathLength*pi)); % first argument is the path itself, second is a function of the position along this path (offsetPathLength changes from 0 to 1), which determines how far the outline is from the original line <br> draw p; <br> draw q dashed evenly; <br> endfig; <br></code> <br></div></div><br><br>  Deux contours peuvent √™tre combin√©s pour cr√©er une ligne de contour pour un trait d'√©paisseur variable. <br><br><img src="https://habrastorage.org/webt/1k/fn/hl/1kfnhlmi6xbx0ax-iurvsrii6wk.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(4); <br> path p, q[]; <br> p := (0,-1/4cm){dir(30)}..(5cm, 0)..{dir(30)}(10cm, 1/4cm); <br> q1 := offsetPath(p)(1/2pt*(sin(offsetPathLength*pi)**2)); % outline on one side <br> q2 := offsetPath(p)(-1/2pt*(sin(offsetPathLength*pi)**2)); % and on the other <br> fill q1--reverse(q2)--cycle; <br> endfig; <br></code> <br></div></div><br><br>  L'√©paisseur de la ligne devrait avoir une limite inf√©rieure, sinon, certaines lignes vont √™tre trop fines pour √™tre correctement imprim√©es et cela n'a pas l'air g√©nial.  L'une des options (celle que j'ai choisie) est de rendre les lignes trop fines en pointill√©s, de sorte que la quantit√© totale d'encre par unit√© de longueur reste approximativement la m√™me que dans la ligne plus fine pr√©vue.  En d'autres termes, au lieu de r√©duire la quantit√© d'encre sur les c√¥t√©s de la ligne, l'algorithme prend de l'encre sur la ligne elle-m√™me. <br><br><img src="https://habrastorage.org/webt/8j/ry/i6/8jryi6otsaqaegxccgrn3ghtzgg.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(5); <br> path p; <br> p := (0,-1/4cm){dir(30)}..(5cm, 0)..{dir(30)}(10cm, 1/4cm); <br> draw brush(p)(1pt*(sin(offsetPathLength*pi)**2)); % the arguments are the same as for the outline <br> endfig; <br></code> <br></div></div><br><br>  Une fois que vous avez des lignes d'√©paisseur variable, vous pouvez dessiner des sph√®res.  Une sph√®re peut √™tre repr√©sent√©e comme une s√©rie de cercles concentriques avec des √©paisseurs de ligne variant en fonction de la sortie d'une fonction qui calcule la l√©g√®ret√© d'un point particulier sur la sph√®re. <br><br><img src="https://habrastorage.org/webt/ay/3u/ra/ay3uraynyq4zgxem7aqgfprswz0.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(6); <br> draw sphere.c(1.2cm); <br> draw sphere.c(2.4cm) shifted (2cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Un autre bloc de construction pratique est un ¬´tube¬ª.  En gros, c'est un cylindre que vous pouvez plier.  Tant que le diam√®tre est constant, c'est assez simple. <br><br><img src="https://habrastorage.org/webt/xh/-h/vp/xh-hvpqdu7ox-ksq36x8cub5dym.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(7); <br> path p; <br> p := subpath (1,8) of fullcircle scaled 3cm; <br> draw tube.l(p)(1/2cm); % arguments are the path itself and the tube radius <br> endfig; <br></code> <br></div></div><br><br>  Si le diam√®tre n'est pas constant, les choses se compliquent: le nombre de traits doit changer en fonction de l'√©paisseur du tube afin de maintenir constante la quantit√© d'encre par unit√© de surface avant de prendre en compte les lumi√®res. <br><br><img src="https://habrastorage.org/webt/5m/pp/qu/5mppqukv594bcuynso_nmc7qmjy.gif"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(8); <br> path p; <br> p := pathSubdivide(fullcircle, 2) scaled 3cm; % this thing splits every segment between the points of a path (here‚Äîfullcircle) into several parts (here‚Äî2) <br> draw tube.l(p)(1/2cm + 1/6cm*sin(offsetPathLength*10pi)); <br> endfig; <br></code> <br></div></div><br><br>  Il existe √©galement des tubes √† hachures transversales.  Le probl√®me de maintenir la quantit√© d'encre constante s'est av√©r√© encore plus d√©licat dans ce cas, donc souvent ces tubes ont l'air un peu hirsutes. <br><br><img src="https://habrastorage.org/webt/1o/bn/es/1obnes-_u_rgin3h_obl3sruomk.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(9); <br> path p; <br> p := pathSubdivide(fullcircle, 2) scaled 3cm; <br> draw tube.t(p)(1/2cm + 1/6cm*sin(offsetPathLength*10pi)); <br> endfig; <br></code> <br></div></div><br><br>  Les tubes peuvent √™tre utilis√©s pour construire une large gamme d'objets: des c√¥nes et des cylindres aux balustres. <br><br><img src="https://habrastorage.org/webt/45/yv/u3/45yvu3z7g6ers_ftbx8pcsj1shg.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(10); <br> draw tube.l ((0, 0) -- (0, 3cm))((1-offsetPathLength)*1cm) shifted (-3cm, 0); % a very simple cone <br> path p; <br> p := (-1/2cm, 0) {dir(175)} .. {dir(5)} (-1/2cm, 1/8cm) {dir(120)} .. (-2/5cm, 1/3cm) .. (-1/2cm, 3/4cm) {dir(90)} .. {dir(90)}(-1/4cm, 9/4cm){dir(175)} .. {dir(5)}(-1/4cm, 9/4cm + 1/5cm){dir(90)} .. (-2/5cm, 3cm); % baluster's envelope <br> p := pathSubdivide(p, 6); <br> draw p -- reverse(p xscaled -1) -- cycle; <br> tubeGenerateAlt(p, p xscaled -1, p rotated -90); % a more low-level stuff than tube.t, first two arguments are tube's sides and the third is the envelope. The envelope is basically a flattened out version of the outline, with line length along the x axis and the distance to line at the y. In the case of this baluster, it's simply its side rotated 90 degrees. <br> endfig; <br></code> <br></div></div><br><br>  Certaines constructions qui peuvent √™tre faites √† partir de ces primitives sont incluses dans la biblioth√®que.  Par exemple, le globe est essentiellement une sph√®re. <br><br><img src="https://habrastorage.org/webt/fz/ie/km/fziekmabaiygkxvyt95ekstjqlw.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(11); <br> draw globe(1cm, -15, 0) shifted (-6/2cm, 0); % radius, west longitude, north latitude, both decimal <br> draw globe(3/2cm, -30.280577, 59.939461); <br> draw globe(4/3cm, -140, -30) shifted (10/3cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Cependant, les hachures ici sont latitudinales et le contr√¥le de la densit√© des lignes est beaucoup plus difficile que sur les sph√®res r√©guli√®res avec des hachures ¬´concentriques¬ª, c'est donc un type de sph√®re diff√©rent. <br><br><img src="https://habrastorage.org/webt/qi/mw/jt/qimwjtr16zlbg_j_v0htivtwe-q.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(12); <br> draw sphere.l(2cm, -60); % diameter and latitude <br> draw sphere.l(3cm, 45) shifted (3cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Un poids est une construction simple faite de tubes de deux types. <br><br><img src="https://habrastorage.org/webt/rb/q-/dg/rbq-dgwygbxz4u9bglo1jgeqgkc.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(13); <br> draw weight.s(1cm); % weight height <br> draw weight.s(2cm) shifted (2cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Il y a aussi un outil pour nouer les tubes. <br><br><img src="https://habrastorage.org/webt/kv/xs/sn/kvxssnbhkpirxvjjg-8mb6f5__g.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code.</b>  <b class="spoiler_title">Par souci de concision, un seul n≈ìud.</b> <div class="spoiler_text"> <code>beginfig(14); <br> path p; <br> p := (dir(90)*4/3cm) {dir(0)} .. tension 3/2 ..(dir(90 + 120)*4/3cm){dir(90 + 30)} .. tension 3/2 ..(dir(90 - 120)*4/3cm){dir(-90 - 30)} .. tension 3/2 .. cycle; <br> p := p scaled 6/5; <br> addStrandToKnot (primeOne) (p, 1/4cm, "l", "1, -1, 1"); % first, we add a strand of width 1/4cm going along the path p to the knot named primeOne. its intersections along the path go to layers "1, -1, 1" and the type of tube is going to be "l". <br> draw knotFromStrands (primeOne); % then the knot is drawn. you can add more than one strand. <br> endfig; <br></code> <br></div></div><br><br>  Les tubes en n≈ìuds se d√©posent des ombres les uns sur les autres comme ils le devraient.  En th√©orie, cette fonctionnalit√© peut √™tre utilis√©e dans d'autres contextes, mais comme je n'avais pas l'intention d'aller en profondeur dans la troisi√®me dimension, l'interface utilisateur manque quelque peu et les ombres ne fonctionnent correctement que pour certains objets. <br><br><img src="https://habrastorage.org/webt/5n/st/h1/5nsth1dhrepzvtzzczn20-gbgdq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(15); <br> path shadowPath[]; <br> boolean shadowsEnabled; <br> numeric numberOfShadows; <br> shadowsEnabled := true; % shadows need to be turned on <br> numberOfShadows := 1; % number of shadows should be specified <br> shadowPath0 := (-1cm, -2cm) -- (-1cm, 2cm) -- (-1cm +1/6cm, 2cm) -- (-1cm + 1/8cm, -2cm) -- cycle; % shadow-dropping object should be a closed path <br> shadowDepth0 := 4/3cm; % it's just this high above the object on which the shadow falls <br> shadowPath1 := shadowPath0 rotated -60; <br> shadowDepth1 := 4/3cm; <br> draw sphere.c(2.4cm); % shadows work ok only with sphere.c and tube.l with constant diameter <br> fill shadowPath0 withcolor white; <br> draw shadowPath0; <br> fill shadowPath1 withcolor white; <br> draw shadowPath1; <br> endfig; <br></code> <br></div></div><br><br>  Certes, vous aurez besoin d'une texture bois (mise √† jour: depuis la publication de la version russe de cet article, le premier cas de cette biblioth√®que utilis√©e dans un vrai projet dont je suis au courant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s'est produit</a> , et c'est la texture bois qui est venue en pratique, donc cela n'a finalement pas √©t√© une blague apr√®s tout).  Comment les brindilles et leur croissance affectent le mod√®le des anneaux annuels est un sujet de r√©flexion s√©rieux.  Le mod√®le de travail le plus simple que j'ai pu trouver est le suivant: les anneaux annuels sont des surfaces planes parall√®les, d√©form√©es par des rameaux en croissance;  ainsi la surface est modifi√©e par une s√©rie de ¬´fonctions de brindille¬ª pas trop complexes √† diff√©rents endroits et les isolignes de la surface sont prises comme motif d'anneau annuel. <br><br><img src="https://habrastorage.org/webt/qr/st/oa/qrstoajkhoqywh-ejey6vj6uyqm.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(16); <br> numeric w, b; <br> pair A, B, C, D, A', B', C', D'; <br> w := 4cm; <br> b := 1/2cm; <br> A := (0, 0); <br> A' := (b, b); <br> B := (0, w); <br> B' := (b, wb); <br> C := (w, w); <br> C' := (wb, wb); <br> D := (w, 0); <br> D' := (wb, b); <br> draw woodenThing(A--A'--B'--B--cycle, 0); % a piece of wood inside the A--A'--B'--B--cycle path, with wood grain at 0 degrees <br> draw woodenThing(B--B'--C'--C--cycle, 90); <br> draw woodenThing(C--C'--D'--D--cycle, 0); <br> draw woodenThing(A--A'--D'--D--cycle, 90); <br> eyescale := 2/3cm; % scale for the eye <br> draw eye(150) shifted 1/2[A,C]; % the eye looks in 150 degree direction <br> endfig; <br></code> <br></div></div><br><br>  L'≈ìil de l'image ci-dessus s'ouvre grand ou plisse un peu et sa pupille change √©galement de taille.  Cela peut ne pas avoir de sens pratique, mais les yeux similaires sur le plan m√©canique semblent ennuyeux. <br><br><img src="https://habrastorage.org/webt/xp/e_/wj/xpe_wjoohdkazhkjsnh25ezbidy.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>beginfig(17); <br> eyescale := 2/3cm; % 1/2cm by default <br> draw eye(0) shifted (0cm, 0); <br> draw eye(0) shifted (1cm, 0); <br> draw eye(0) shifted (2cm, 0); <br> draw eye(0) shifted (3cm, 0); <br> draw eye(0) shifted (4cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  La plupart du temps, les illustrations n'√©taient pas si complexes, mais une approche plus rigoureuse n√©cessiterait de r√©soudre bon nombre des probl√®mes du manuel pour les illustrer correctement.  Disons, le probl√®me de poulie de L'H√¥pital (ce n'√©tait pas dans ce manuel, mais de toute fa√ßon): sur la corde avec la longueur <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.057ex" viewBox="0 -780.1 298.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhith7wzDGG9Fb6QnruC2zZiRopZLg#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> l </script>  suspendu au point <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhith7wzDGG9Fb6QnruC2zZiRopZLg#MJMATHI-41" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> A </script>  une poulie pend;  il est accroch√© √† une autre corde, suspendu au point <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhith7wzDGG9Fb6QnruC2zZiRopZLg#MJMATHI-42" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> B </script>  avec le poids <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhith7wzDGG9Fb6QnruC2zZiRopZLg#MJMATHI-43" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> C </script>  √† sa fin.  La question est: o√π va le poids si la poulie et les cordes ne p√®sent rien?  √âtonnamment, la solution et la construction de ce probl√®me ne sont pas si simples.  Mais en jouant avec plusieurs variables, vous pouvez faire en sorte que l'image soit parfaitement adapt√©e √† la page tout en conservant une pr√©cision. <br><br><img src="https://habrastorage.org/webt/qy/fn/ej/qyfnejrodxcjjzcxnzjwhstyjbq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"> <code>vardef lHopitalPulley (expr AB, l, m) = % distance AB between the suspension points of the ropes and their lengths l and m. ‚ÄúWhy no units of length?‚Äù, you may ask. It's because some calculations inside can cause arithmetic overflow in MetaPost. <br> save A, B, C, D, E, o, a, x, y, d, w, h, support; <br> image( <br> pair A, B, C, D, E, o[]; <br> path support; <br> numeric a, x[], y[], d[], w, h; <br> x1 := (l**2 + abs(l)*((sqrt(8)*AB)++l))/4AB; % the solution <br> y1 := l+-+x1; % second coordinate is trivial <br> y2 := m - ((AB-x1)++y1); % as well as the weight's position <br> A := (0, 0); <br> B := (AB*cm, 0); <br> D := (x1*cm, -y1*cm); <br> C := D shifted (0, -y2*cm); <br> d1 := 2/3cm; d2 := 1cm; d3 := 5/6d1; % diameters of the pulley, weight and the pulley wheel <br> w := 2/3cm; h := 1/3cm; % parameters of the wood block <br> o1 := (unitvector(CD) rotated 90 scaled 1/2d3); <br> o2 := (unitvector(DB) rotated 90 scaled 1/2d3); <br> E := whatever [D shifted o1, C shifted o1] <br> = whatever [D shifted o2, B shifted o2]; % pulley's center <br> a := angle(AD); <br> support := A shifted (-w, 0) -- B shifted (w, 0) -- B shifted (w, h) -- A shifted (-w, h) -- cycle; <br> draw woodenThing(support, 0); % wood block everything is suspended from <br> draw pulley (d1, a - 90) shifted E; % the pulley <br> draw image( <br> draw A -- D -- B withpen thickpen; <br> draw D -- C withpen thickpen; <br> ) maskedWith (pulleyOutline shifted E); % ropes should be covered with the pulley <br> draw sphere.c(d2) shifted C shifted (0, -1/2d2); % sphere as a weight <br> dotlabel.llft(btex $A$ etex, A); <br> dotlabel.lrt(btex $B$ etex, B); <br> dotlabel.ulft(btex $C$ etex, C); <br> label.llft(btex $l$ etex, 1/2[A, D]); <br> ) <br> enddef; <br> beginfig(18); <br> draw lHopitalPulley (6, 2, 11/2); % now you can choose the right parameters <br> draw lHopitalPulley (3, 5/2, 3) shifted (8cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Et qu'en est-il du manuel?  H√©las, lorsque presque toutes les illustrations et la mise en page √©taient pr√™tes, quelque chose s'est produit et le manuel a √©t√© annul√©.  Peut-√™tre √† cause de cela, j'ai d√©cid√© de r√©√©crire la plupart des fonctions de la biblioth√®que d'origine √† partir de z√©ro (j'ai choisi de ne pas utiliser le code d'origine, pour lequel, bien qu'indirectement, j'√©tais pay√©) et de le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mettre sur GitHub</a> .  Certaines choses, pr√©sentes dans la biblioth√®que d'origine, telles que les fonctions de dessin de voitures et de tracteurs, je n'y ai pas inclus, de nouvelles fonctionnalit√©s, par exemple des n≈ìuds, ont √©t√© ajout√©es. <br><br>  Il ne s'ex√©cute pas rapidement: il faut environ une minute pour produire toutes les images de cet article avec LuaLaTeX sur mon ordinateur portable avec i5-4200U 1,6 GHz.  Un g√©n√©rateur de nombres pseudo-al√©atoires est utilis√© ici et l√†, donc aucune image similaire n'est absolument identique (c'est une caract√©ristique) et chaque ex√©cution produit des images l√©g√®rement diff√©rentes.  Pour √©viter les surprises, vous pouvez simplement d√©finir <code>randomseed := some number</code> et profiter des m√™mes r√©sultats √† chaque ex√©cution. <br><br>  Un grand merci √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dr ord</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mikael Sundqvist</a> pour leur aide avec la version anglaise de ce texte. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454376/">https://habr.com/ru/post/fr454376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454356/index.html">Habr Weekly # 3 / Runet vs TV, ARM vs Intel, unification des donn√©es d'√âtat, sans smartphone en 2019, r√™ves sovi√©tiques d'avenir</a></li>
<li><a href="../fr454366/index.html">Victoire aux PHDays 9. Nous partageons les hacks de vie en trois parties. 2e partie</a></li>
<li><a href="../fr454368/index.html">Concours de d√©veloppeurs de plugins TeamCity</a></li>
<li><a href="../fr454372/index.html">Nouvelles hebdomadaires: Huawei a toujours des probl√®mes, "t√©l√©phone quantique" dans la F√©d√©ration de Russie, ARM a de nouveaux processeurs</a></li>
<li><a href="../fr454374/index.html">L'imprimante 3D photo-polym√®re √† partir d'un vid√©oprojecteur √† domicile cr√©e des objets sans couches</a></li>
<li><a href="../fr454378/index.html">Astronautes russes sur la lune d'ici 2030: pr√©sentation de Rogozin</a></li>
<li><a href="../fr454382/index.html">Ivan Uglyansky et Vladimir Sitnikov sur jug.msk.ru</a></li>
<li><a href="../fr454384/index.html">Correction de la vue au laser - la m√©thode Smile est-elle vraiment efficace?</a></li>
<li><a href="../fr454386/index.html">MessageBox pour AvaloniaUI</a></li>
<li><a href="../fr454388/index.html">ARA: algorithme pour trouver le nombre maximum de points sur une ligne droite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>