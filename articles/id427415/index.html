<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤« ğŸ”± ğŸ‘©ğŸ¼â€ğŸš€ Kami menggunakan Node.js untuk bekerja dengan file besar dan set data mentah. ğŸ’ âœğŸ½ ğŸ‘š</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Posting ini adalah terjemahan dari artikel asli oleh Paid Nidrinhouse, insinyur perangkat lunak full-stack. Keistimewaan utamanya adalah JavaScript, t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami menggunakan Node.js untuk bekerja dengan file besar dan set data mentah.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/427415/"><img src="https://cdn.lynda.com/course/612195/612195-636458390742664213-16x9.jpg"><br><br>  Posting ini adalah terjemahan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> asli <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">oleh</a> Paid Nidrinhouse, insinyur perangkat lunak full-stack.  Keistimewaan utamanya adalah JavaScript, tetapi Paige juga mempelajari bahasa dan kerangka kerja lain.  Dan dia berbagi pengalamannya dengan para pembacanya.  Ngomong-ngomong, artikel ini akan menarik bagi pemula. <br><br>  Baru-baru ini, saya dihadapkan dengan tugas yang menarik minat saya - perlu untuk mengekstrak data tertentu dari sejumlah besar file yang tidak terstruktur dari Komisi Pemilihan Federal AS.  Saya tidak bekerja terlalu banyak dengan data mentah, jadi saya memutuskan untuk mengambil tantangan dan mengambil tugas ini.  Sebagai alat untuk menyelesaikannya, saya memilih Node.js. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox merekomendasikan:</b> Kursus online <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Profesi Pengembang Frontend</a> . <br><br>  <b>Kami mengingatkan Anda:</b> <i>untuk semua pembaca "Habr" - diskon 10.000 rubel saat mendaftar untuk kursus Skillbox apa pun menggunakan kode promosi "Habr".</i> </blockquote><br>  Tugas itu dijelaskan dalam empat poin: <br><ul><li>  Program harus menghitung jumlah total baris dalam file. </li><li>  Setiap kolom kedelapan berisi nama seseorang.  Anda perlu memuat data ini dan membuat array dengan semua nama yang terkandung dalam file.  Perlu untuk menampilkan nama ke-432 dan 43.243. </li><li>  Setiap kolom kelima berisi tanggal donasi oleh relawan.  Hitung berapa total sumbangan yang dilakukan setiap bulan, dan cetak total hasilnya. </li><li>  Setiap kolom kedelapan berisi nama seseorang.  Buat array dengan hanya memilih nama depan, tanpa nama belakang.  Cari tahu nama mana yang paling sering ditemukan dan berapa kali? </li></ul><br>  (Tugas asli dapat <a href="">dilihat di sini di tautan ini</a> .) <br><br>  File yang harus Anda kerjakan adalah .txt biasa sebesar 2,55 GB.  Ada juga folder yang berisi bagian-bagian dari file utama (Anda dapat men-debug program pada mereka tanpa harus menganalisis seluruh array besar). <br><br><h3>  Dua kemungkinan solusi di Node.js </h3><br>  Pada prinsipnya, bekerja dengan file besar tidak membuat takut spesialis JavaScript.  Selain itu, ini adalah salah satu fungsi utama Node.js.  Ada beberapa solusi yang memungkinkan untuk membaca dari dan menulis ke file. <br><br>  Yang familier adalah fs.readFile ().  Ini memungkinkan Anda untuk membaca seluruh file, memasukkannya ke dalam memori, dan kemudian menggunakan Node. <br><br>  Alternatifnya adalah fs.createReadStream (), fungsi yang meneruskan data yang mirip dengan bagaimana ia diatur dalam bahasa lain - misalnya, dalam Python atau Java. <br><br><h3>  Solusi yang saya pilih </h3><br>  Karena saya perlu menghitung jumlah total baris dan mem-parsing data ke mem-parsing nama dan tanggal, saya memutuskan untuk berhenti pada opsi kedua.  Di sini saya bisa menggunakan fungsi rl.on ('line', ...) untuk mendapatkan data yang diperlukan dari baris. <br><br>  Kode Node.js CreateReadStream () &amp; ReadFile () <br><br>  Di bawah ini adalah kode yang saya tulis menggunakan Node.js dan fungsi fs.createReadStream (). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/abf/204/974/abf204974b1bef6c81c2c6eca0422810.png"><br><br>  Awalnya, saya perlu mengatur semuanya, menyadari bahwa mengimpor data memerlukan fungsi Node.js seperti fs (sistem file), readline dan stream.  Selanjutnya, saya bisa membuat instream dan outstream bersama dengan readLine.createInterface ().  Kode yang dihasilkan memungkinkan untuk mengurai file baris demi baris, mengambil data yang diperlukan. <br><br>  Selain itu, saya menambahkan beberapa variabel dan komentar untuk bekerja dengan data spesifik.  Ini adalah lineCount, dupeNames dan array nama, donasi, dan firstNames. <br><br>  Dalam fungsi rl.on ('line', ...), saya dapat mengatur parsing file baris demi baris.  Jadi, saya memasukkan variabel lineCount untuk setiap baris.  Saya menggunakan metode JavaScript split () untuk mem-parsing nama dengan menambahkannya ke array nama saya.  Selanjutnya, saya hanya memisahkan nama tanpa nama keluarga, sambil menyoroti pengecualian, seperti keberadaan nama ganda, inisial di tengah nama, dll.  Selanjutnya, saya memisahkan tahun dan tanggal dari kolom data, mengubah semua ini ke dalam format YYYY-MM dan menambahkan dateDonationCount ke array. <br><br>  Dalam fungsi rl.on ('close', ...), saya melakukan semua transformasi data yang ditambahkan ke array, dengan informasi yang diterima di console.log. <br><br>  lineCount dan nama diperlukan untuk menentukan nama 432 dan 43.243; tidak diperlukan konversi di sini.  Tetapi identifikasi nama yang paling umum dalam array dan penentuan jumlah sumbangan adalah tugas yang lebih rumit. <br><br>  Untuk mengidentifikasi nama yang paling umum, saya harus membuat objek pasangan nilai untuk setiap nama (kunci) dan jumlah referensi ke Object.entries ().  (nilai) dan kemudian mengonversi semuanya menjadi array array menggunakan fungsi ES6.  Setelah itu, tugas menyortir nama dan mengidentifikasi duplikat terbanyak tidak lagi sulit. <br><br>  Dengan donasi, saya melakukan trik yang sama: Saya membuat objek pasangan nilai dan fungsi logDateElements (), yang memungkinkan saya, menggunakan interpolasi ES6, untuk menampilkan kunci dan nilai untuk setiap bulan.  Lalu saya membuat Map baru (), mengonversi objek dateDonations ke metamarray, dan looped melalui setiap array menggunakan logDateElements ().  (Ternyata tidak sesederhana seperti yang terlihat di awal.) <br><br>  Tapi itu berhasil, saya bisa membaca file yang relatif kecil 400 MB, menyoroti informasi yang diperlukan. <br><br>  Setelah itu saya mencoba fs.createReadStream () - Saya mengimplementasikan tugas di fs.readFile () untuk melihat perbedaannya.  Ini kodenya: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ad/a88/bb4/7ada88bb45dccc0c25dbb1b68c395954.png"><br><br>  Anda dapat melihat seluruh solusinya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br><h3>  Hasil kerja dengan Node.js </h3><br>  Solusinya ternyata berhasil.  Saya menambahkan path ke file readFileStream.js dan ... menyaksikan server Node crash dengan JavaScript yang menumpuk karena kesalahan memori. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/068/398/a34/068398a34e2711c9741e7cddd12cc360.png"><br><br>  Ternyata, meskipun semuanya bekerja, tetapi solusi ini mencoba mentransfer seluruh isi file ke memori, yang tidak mungkin dengan kapasitas 2,55 GB.  Node dapat bekerja secara bersamaan dengan memori 1,5 GB, tidak lebih. <br><br>  Karena itu, tidak ada keputusan saya yang muncul.  Butuh yang baru yang dapat bekerja bahkan dengan file yang sangat banyak. <br><br><h3>  Solusi baru </h3><br>  Ternyata, perlu untuk menggunakan EventStream modul NPM populer. <br><br>  Setelah mempelajari dokumentasinya, saya dapat memahami apa yang perlu dilakukan.  Ini adalah versi ketiga dari kode program. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f4f/66f/007/f4f66f007743c8fcf4d31f3699839419.png"><br><br>  Dokumentasi untuk modul menunjukkan bahwa aliran data harus dibagi menjadi elemen-elemen terpisah menggunakan karakter \ n pada akhir setiap baris file txt. <br><br>  Pada dasarnya, satu-satunya hal yang harus saya ubah adalah respons nama.  Saya tidak bisa memasukkan 130 juta nama ke dalam array - kesalahan kekurangan memori muncul lagi.  Saya memecahkan masalah dengan menghitung nama 432 dan 43.243 dan menambahkannya ke array saya sendiri.  Sedikit tidak apa yang ditanyakan dalam kondisi, tetapi siapa bilang Anda tidak bisa kreatif? <br><br><h3>  Babak 2. Kami mencoba program dalam pekerjaan </h3><br>  Ya, semua file yang sama dengan volume 2,55 GB, kami menyilangkan jari kami dan mengikuti hasilnya. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e80/665/c38/e80665c386ede41e173fd684b731999e.png"><br><br>  Sukses! <br><br>  Ternyata, hanya Node.js tidak cocok untuk memecahkan masalah seperti itu, kemampuannya agak terbatas.  Tetapi memperluas mereka menggunakan modul, Anda dapat bekerja dengan file besar seperti itu. <br><br><blockquote>  <b>Skillbox merekomendasikan:</b> <br><br><ul><li>  Kursus praktis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Profesi pengembang web"</a> . </li><li>  Kursus praktis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"PRO Pengembang Seluler"</a> . </li><li>  Kursus tahunan praktis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Pengembang PHP dari awal hingga PRO"</a> . </li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id427415/">https://habr.com/ru/post/id427415/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id427403/index.html">API ReportingObserver: lihat kode halaman web dari perspektif baru</a></li>
<li><a href="../id427405/index.html">ES2018 - metode akhirnya menjanjikan</a></li>
<li><a href="../id427407/index.html">Meta-clustering dengan minimisasi kesalahan, dan mengapa saya pikir otak bekerja seperti ini</a></li>
<li><a href="../id427409/index.html">Buku "The Brilliant Agile. Manajemen proyek yang fleksibel dengan Agile, Scrum dan Kanban Â»</a></li>
<li><a href="../id427413/index.html">Berjuang untuk sumber daya, bagian 4: Hebat</a></li>
<li><a href="../id427417/index.html">Dengan humor sekitar 8-inch floppy disk (di tahun 70-an hanya ada seperti itu)</a></li>
<li><a href="../id427419/index.html">Apa yang harus dilakukan ketika prosesor tidak ada hubungannya?</a></li>
<li><a href="../id427421/index.html">Bagaimana situs silsilah membuatnya lebih mudah untuk menangkap pembunuh</a></li>
<li><a href="../id427423/index.html">City2Share: e- dan mobil otonom di pusat logistik Munich</a></li>
<li><a href="../id427427/index.html">Bagaimana mereka datang ke IT: tentang magang dan lelucon (hasil jajak pendapat "My Circle")</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>