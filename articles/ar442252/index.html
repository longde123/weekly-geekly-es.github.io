<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🎤 🚴🏿 🦌 دورة حياة بايثون كود - نموذج وقت تشغيل CPython 〽️ 🥀 💇🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="مرحبا بالجميع! لقد حان فصل الربيع ، مما يعني أنه لا يزال هناك أقل من شهر قبل بدء دورة مطور بايثون . سيتم تخصيص منشورنا لهذا المقرر. 





 المهام: 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>دورة حياة بايثون كود - نموذج وقت تشغيل CPython</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/442252/" style=";text-align:right;direction:rtl">  مرحبا بالجميع!  لقد حان فصل الربيع ، مما يعني أنه لا يزال هناك أقل من شهر قبل بدء دورة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مطور بايثون</a> .  سيتم تخصيص منشورنا لهذا المقرر. <br><br><img src="https://habrastorage.org/webt/8-/3n/pk/8-3npkdv_2mpp742_k0zytidc_k.png"><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/9g/fe/cn/9gfecnorojbyoxcczknx1pyf--g.png"><br><br>  <i><b>المهام:</b></i> <br><br>  - تعرف على الهيكل الداخلي لبيثون ؛ <br>  - فهم مبادئ بناء شجرة بناء جملة مجردة (AST) ؛ <br>  - كتابة رمز أكثر كفاءة في الوقت والذاكرة. <br><br>  <i><b>توصيات أولية:</b></i> <br><br>  - الفهم الأساسي للمترجم (AST ، الرموز ، الخ). <br>  - معرفة بيثون. <br>  - المعرفة الأساسية لل C. <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs">batuhan@arch-pc  ~/blogs/cpython/exec_model  python --version Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br>  <b>CPython نموذج التنفيذ</b> <br><br>  بيثون هي لغة مترجمة ومترجمة.  وبالتالي ، يقوم برنامج التحويل البرمجي Python بإنشاء الرموز الثانوية ، ويقوم المترجم بتنفيذها.  خلال المقالة سننظر في المشكلات التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تحليل و رمزية: </li><li style=";text-align:right;direction:rtl">  التحول في AST. </li><li style=";text-align:right;direction:rtl">  التحكم في تدفق الرسم البياني (CFG) ؛ </li><li style=";text-align:right;direction:rtl">  Bytecode </li><li style=";text-align:right;direction:rtl">  يعمل على الجهاز الظاهري CPython. </li></ul><br>  <b>تحليل و رمزية.</b> <b><br></b>  <b>قواعد اللغة.</b> <br><br>  النحوي يحدد دلالات اللغة بيثون.  إنه مفيد أيضًا في الإشارة إلى الطريقة التي يجب أن يفسر بها المحلل اللغوي.  تستخدم قواعد لغة Python بناء جملة مماثل لنموذج Backus-Naur الممتد.  لديها قواعدها الخاصة للمترجم من لغة المصدر.  يمكنك العثور على ملف القواعد في دليل "cpython / Grammar / Grammar". <br><br>  وفيما يلي مثال لقواعد اللغة ، <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">batuhan@arch-pc  ~/cpython/Grammar   master  grep <span class="hljs-string"><span class="hljs-string">"simple_stmt"</span></span> Grammar | head -n3 | tail -n1 simple_stmt: small_stmt (<span class="hljs-string"><span class="hljs-string">';'</span></span> small_stmt)* [<span class="hljs-string"><span class="hljs-string">';'</span></span>] NEWLINE</code> </pre> <br>  تحتوي التعبيرات البسيطة على تعبيرات وقوس صغيرة ، وينتهي الأمر بسطر جديد.  تبدو التعبيرات الصغيرة مثل قائمة التعبيرات التي تستورد ... <br>  بعض التعبيرات الأخرى :) <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">small_stmt: (expr_stmt | del_stmt | pass_stmt | flow_stmt | import_stmt | global_stmt | nonlocal_stmt | assert_stmt) ... del_stmt: <span class="hljs-string"><span class="hljs-string">'del'</span></span> exprlist pass_stmt: <span class="hljs-string"><span class="hljs-string">'pass'</span></span> flow_stmt: break_stmt | continue_stmt | return_stmt | raise_stmt | yield_stmt break_stmt: <span class="hljs-string"><span class="hljs-string">'break'</span></span> continue_stmt: <span class="hljs-string"><span class="hljs-string">'continue'</span></span></code> </pre> <br>  <b>رمزية (Lexing)</b> <br><br>  Tokenization هي عملية الحصول على دفق بيانات نصية وتقسيمها إلى الرموز المميزة للكلمات المهمة (للمترجم الفوري) مع بيانات تعريف إضافية (على سبيل المثال ، حيث يبدأ الرمز المميز وينتهي ، وما هي قيمة السلسلة لهذا الرمز المميز). <br><br>  <b>الرموز</b> <br><br>  الرمز المميز هو ملف رأس يحتوي على تعريفات لجميع الرموز المميزة.  يوجد 59 نوعًا من الرموز في Python (Include / token.h). <br><br>  فيما يلي مثال لبعضهم ، <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#define NAME 1 #define NUMBER 2 #define STRING 3 #define NEWLINE 4 #define INDENT 5 #define DEDENT 6</span></span></code> </pre> <br>  تراها إذا قسمت بعض رموز بايثون إلى رموز. <br><br>  <b>رمزية مع CLI</b> <br><br>  هنا هو ملف tests.py <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greetings</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: str)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">f"Hello </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{name}</span></span></span><span class="hljs-string">"</span></span>) greetings(<span class="hljs-string"><span class="hljs-string">"Batuhan"</span></span>)</code> </pre> <br>  ثم نقوم بترميزها باستخدام الأمر python -m tokenize وما يلي هو الإخراج: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">batuhan@arch-pc  ~/blogs/cpython/exec_model  python -m tokenize tests.py <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>: ENCODING <span class="hljs-string"><span class="hljs-string">'utf-8'</span></span> ... <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>: INDENT <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>: NAME <span class="hljs-string"><span class="hljs-string">'print'</span></span> ... <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>: DEDENT <span class="hljs-string"><span class="hljs-string">''</span></span> ... <span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>: ENDMARKER <span class="hljs-string"><span class="hljs-string">''</span></span></code> </pre><br>  هنا الأرقام (على سبيل المثال ، 1.4-1.13) تُظهر مكان بدء الرمز المميز ومكان انتهائه.  رمز التشفير هو دائمًا الرمز المميز الأول الذي نتلقاه.  يقدم معلومات حول تشفير الملف المصدر ، وإذا كانت هناك أي مشاكل في ذلك ، فإن المترجم الشفهي يرمي استثناءً. <br><br>  <b>تشريع مع <i>tokenize.tokenize</i></b> <br><br>  إذا كنت بحاجة إلى الرمز <i>المميز</i> للملف من التعليمات البرمجية الخاصة بك ، يمكنك استخدام الوحدة النمطية <i>للرمز المميز</i> من <i>stdlib</i> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'tests.py'</span></span>, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: ... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tokenize.tokenize(f.readline): ... print(token) ... TokenInfo(type=<span class="hljs-number"><span class="hljs-number">57</span></span> (ENCODING), string=<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>, start=(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), end=(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), line=<span class="hljs-string"><span class="hljs-string">''</span></span>) ... TokenInfo(type=<span class="hljs-number"><span class="hljs-number">1</span></span> (NAME), string=<span class="hljs-string"><span class="hljs-string">'greetings'</span></span>, start=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), end=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>), line=<span class="hljs-string"><span class="hljs-string">'def greetings(name: str):\n'</span></span>) ... TokenInfo(type=<span class="hljs-number"><span class="hljs-number">53</span></span> (OP), string=<span class="hljs-string"><span class="hljs-string">':'</span></span>, start=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>), end=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>), line=<span class="hljs-string"><span class="hljs-string">'def greetings(name: str):\n'</span></span>) ...</code> </pre> <br>  نوع الرمز المميز هو <i>معرفه في</i> ملف رأس <i>token.h.</i>  السلسلة هي قيمة الرمز.  إظهار البداية والنهاية حيث يبدأ الرمز المميز وينتهي ، على التوالي. <br><br>  في لغات أخرى ، يتم الإشارة إلى الكتل بين قوسين أو عبارات بداية / نهاية ، لكن بيثون يستخدم المسافات البادئة ومستويات مختلفة.  علامات المسافة البادئة و DEDENT وتشير المسافة البادئة.  هذه الرموز مطلوبة لبناء أشجار تحليل علائقية و / أو أشجار بناء جملة مجردة. <br><br>  <b>جيل المحلل</b> <br><br>  جيل المحلل - عملية تنشئ محلل وفقا لقواعد معينة.  ومن المعروف المولدات محلل PGen.  Cpython واثنين من المولدات محلل.  واحد هو الأصلي ( <code>Parser/pgen</code> ) وإعادة كتابة واحدة في الثعبان ( <code>/Lib/lib2to3/pgen2</code> ). <br><br>  <i>"المولد الأصلي كان أول رمز كتبته لبيثون"</i> <i><br></i>  <i>جويدو</i> <br><br>  من الاقتباس أعلاه ، يصبح من الواضح أن <i>pgen</i> هو أهم شيء في لغة البرمجة.  عند استدعاء pgen (في <i>Parser / pgen</i> ) ، فإنه ينشئ ملف رأس وملف C (المحلل اللغوي نفسه).  إذا نظرت إلى الكود C الذي تم إنشاؤه ، فقد يبدو ذلك بلا معنى ، لأن مظهره ذي معنى اختياري.  أنه يحتوي على الكثير من البيانات الثابتة والهياكل.  بعد ذلك ، سنحاول شرح مكوناته الرئيسية. <br><br>  <b>DFA (آلة الحالة المحددة)</b> <br><br>  يعرّف المحلل اللغوي DFA واحد لكل nonmminal.  يتم تعريف كل DFA كمجموعة من الحالات. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">static dfa dfas[87] = { {256, <span class="hljs-string"><span class="hljs-string">"single_input"</span></span>, 0, 3, states_0, <span class="hljs-string"><span class="hljs-string">"\004\050\340\000\002\000\000\000\012\076\011\007\262\004\020\002\000\300\220\050\037\202\000"</span></span>}, ... {342, <span class="hljs-string"><span class="hljs-string">"yield_arg"</span></span>, 0, 3, states_86, <span class="hljs-string"><span class="hljs-string">"\000\040\200\000\002\000\000\000\000\040\010\000\000\000\020\002\000\300\220\050\037\000\000"</span></span>}, };</code> </pre> <br>  لكل DFA ، هناك مجموعة بداية التي تظهر الرموز المميزة الخاصة غير الطرفية يمكن أن تبدأ. <br><br>  <b>الشرط</b> <br><br>  يتم تعريف كل ولاية من خلال مجموعة من التحولات / الحواف (الأقواس). <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static state states_86[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">2</span></span>, arcs_86_0}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_86_1}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_86_2}, };</code> </pre> <br>  <b>التحولات (الأقواس)</b> <br><br>  يحتوي كل صفيف انتقال رقمين.  الرقم الأول هو اسم الانتقال (تسمية القوس) ، فإنه يشير إلى رقم الرمز.  الرقم الثاني هو الوجهة. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static arc arcs_86_0[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">77</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">47</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_86_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_86_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, };</code> </pre><br>  <b>الأسماء (التسميات)</b> <br><br>  هذا جدول خاص يعين هوية الشخصية إلى اسم الانتقال. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static label labels[<span class="hljs-number"><span class="hljs-number">177</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"EMPTY"</span></span>}, {<span class="hljs-number"><span class="hljs-number">256</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, {<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, ... {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"async"</span></span>}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"def"</span></span>}, ... {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"yield"</span></span>}, {<span class="hljs-number"><span class="hljs-number">342</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, };</code> </pre> <br>  الرقم 1 يتوافق مع جميع المعرفات.  وبالتالي ، يحصل كل منهم على أسماء انتقال مختلفة ، حتى إذا كان لديهم جميعًا نفس رقم الحرف. <br><br>  <i><b>مثال بسيط:</b></i> <br><br>  افترض أن لدينا رمزًا يخرج "Hi" إذا كان 1 - صحيحًا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Hi'</span></span>)</code> </pre> <br>  يعتبر المحلل اللغوي هذا الرمز منفردًا. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">single_input: NEWLINE | simple_stmt | compound_stmt NEWLINE</code> </pre> <br>  ثم تبدأ شجرة التحليل الخاصة بنا في العقدة الجذرية لإدخال لمرة واحدة. <br><br><img src="https://habrastorage.org/webt/xm/nl/r2/xmnlr287d0_vdkigdsqvtvpwhmi.png"><br><br>  وقيمة DFA لدينا (single_input) هي 0. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static dfa dfas[<span class="hljs-number"><span class="hljs-number">87</span></span>] = { {<span class="hljs-number"><span class="hljs-number">256</span></span>, <span class="hljs-string"><span class="hljs-string">"single_input"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, states_0, <span class="hljs-string"><span class="hljs-string">"\004\050\340\000\002\000\000\000\012\076\011\007\262\004\020\002\000\300\220\050\037\202\000"</span></span>} ... }</code> </pre><br>  سيبدو مثل هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static arc arcs_0_0[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_0_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static arc arcs_0_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static state states_0[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">3</span></span>, arcs_0_0}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_0_1}, {<span class="hljs-number"><span class="hljs-number">1</span></span>,</code> </pre>  arcs_0_2} ، <br>  } ؛ <br><br>  هنا <code>arc_0_0</code> يتكون من ثلاثة عناصر.  الأول هو <code>NEWLINE</code> ، والثاني هو <code>simple_stmt</code> ، والأخير هو <code>compound_stmt</code> . <br><br>  بالنظر إلى المجموعة الأولية من <code>simple_stmt</code> يمكننا أن نستنتج أنه لا يمكن لـ <code>simple_stmt</code> أن يبدأ بـ <code>if</code> .  ومع ذلك ، حتى لو لم يكن سطرًا جديدًا ، فيمكن أن يبدأ المركب_stmt مع ذلك.  وبالتالي ، نذهب من آخر <code>arc ({4;2})</code> ونضيف عقدة المركب_stmt إلى شجرة التحليل وقبل الانتقال إلى الرقم 2 ، ننتقل إلى DFA الجديد.  حصلنا على شجرة تحليل محدثة: <br><br><img src="https://habrastorage.org/webt/fv/lc/ac/fvlcacpcaci0gacypn7mwu7ldkm.png"><br><br>  يوزّع DFA الجديد عبارات مركبة. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">compound_stmt: if_stmt | while_stmt | for_stmt | try_stmt | with_stmt | funcdef | classdef | decorated | async_stmt</code> </pre> <br>  ونحصل على ما يلي: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static arc arcs_39_0[<span class="hljs-number"><span class="hljs-number">9</span></span>] = { {<span class="hljs-number"><span class="hljs-number">91</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">92</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">93</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">94</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">95</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">96</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static arc arcs_39_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static state states_39[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">9</span></span>, arcs_39_0}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_39_1}, };</code> </pre><br>  فقط القفزة الأولى يمكن أن تبدأ <code>if</code> .  نحصل على شجرة تحليل محدثة. <br><br><img src="https://habrastorage.org/webt/kh/q2/ru/khq2rutapnl3op6estdsfaznvwo.png"><br><br>  ثم نقوم مرة أخرى بتغيير DFA و DFA التالي. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">if_stmt: <span class="hljs-string"><span class="hljs-string">'if'</span></span> test <span class="hljs-string"><span class="hljs-string">':'</span></span> suite (<span class="hljs-string"><span class="hljs-string">'elif'</span></span> test <span class="hljs-string"><span class="hljs-string">':'</span></span> suite)* [<span class="hljs-string"><span class="hljs-string">'else'</span></span> <span class="hljs-string"><span class="hljs-string">':'</span></span> suite]</code> </pre> <br>  نتيجة لذلك ، حصلنا على الانتقال الوحيد مع التعيين 97. إنه يتزامن مع الرمز المميز <code>if</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">static arc arcs_41_0[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">97</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static arc arcs_41_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_41_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}, }; static arc arcs_41_3[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>}, }; static arc arcs_41_4[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">98</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">99</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>}, }; static arc arcs_41_5[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>}, }; static arc arcs_41_6[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>}, }; ...</code> </pre> <br>  عندما نتحول إلى الحالة التالية ، وتبقى في نفس DFA ، فإن arcs_41_1 التالي يحتوي أيضًا على انتقال واحد فقط.  هذا صحيح لمحطة الاختبار.  يجب أن يبدأ برقم (على سبيل المثال ، 1). <br><br><img src="https://habrastorage.org/webt/f9/my/mh/f9mymh7fay4vovofermpmyfxegi.png"><br><br>  هناك انتقال واحد فقط في arc_41_2 يحصل على رمز النقطتين (:). <br><br><img src="https://habrastorage.org/webt/-f/qf/gn/-fqfgnvebdfvjez63wlbowzihdm.png"><br><br>  حتى نحصل على مجموعة يمكن أن تبدأ بقيمة طباعة.  أخيرًا ، انتقل إلى arcs_41_4.  الانتقال الأول في المجموعة هو تعبير elif ، والثاني هو تعبير آخر ، والثالث هو للحالة الأخيرة.  ونحصل على المنظر النهائي لشجرة التحليل. <br><br><img src="https://habrastorage.org/webt/oj/_l/ye/oj_lyeqesfzsqv_iohr2yiunnqq.png"><br><br>  <b>بيثون واجهة للمحلل.</b> <b><br></b> <br><br>  يسمح لك Python بتحرير شجرة التحليل للتعبيرات باستخدام وحدة نمطية تسمى المحلل اللغوي. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> parser &gt;&gt;&gt; code = <span class="hljs-string"><span class="hljs-string">"if 1: print('Hi')"</span></span></code> </pre> <br>  يمكنك إنشاء شجرة بناء جملة محددة (شجرة بناء الجملة ، CST) باستخدام parser.suite. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>parser.suite(code).tolist() [<span class="hljs-number"><span class="hljs-number">257</span></span>, [<span class="hljs-number"><span class="hljs-number">269</span></span>, [<span class="hljs-number"><span class="hljs-number">295</span></span>, [<span class="hljs-number"><span class="hljs-number">297</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'if'</span></span>], [<span class="hljs-number"><span class="hljs-number">305</span></span>, [<span class="hljs-number"><span class="hljs-number">309</span></span>, [<span class="hljs-number"><span class="hljs-number">310</span></span>, [<span class="hljs-number"><span class="hljs-number">311</span></span>, [<span class="hljs-number"><span class="hljs-number">312</span></span>, [<span class="hljs-number"><span class="hljs-number">315</span></span>, [<span class="hljs-number"><span class="hljs-number">316</span></span>, [<span class="hljs-number"><span class="hljs-number">317</span></span>, [<span class="hljs-number"><span class="hljs-number">318</span></span>, [<span class="hljs-number"><span class="hljs-number">319</span></span>, [<span class="hljs-number"><span class="hljs-number">320</span></span>, [<span class="hljs-number"><span class="hljs-number">321</span></span>, [<span class="hljs-number"><span class="hljs-number">322</span></span>, [<span class="hljs-number"><span class="hljs-number">323</span></span>, [<span class="hljs-number"><span class="hljs-number">324</span></span>, [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>]]]]]]]]]]]]]]]], [<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-string"><span class="hljs-string">':'</span></span>], [<span class="hljs-number"><span class="hljs-number">304</span></span>, [<span class="hljs-number"><span class="hljs-number">270</span></span>, [<span class="hljs-number"><span class="hljs-number">271</span></span>, [<span class="hljs-number"><span class="hljs-number">272</span></span>, [<span class="hljs-number"><span class="hljs-number">274</span></span>, [<span class="hljs-number"><span class="hljs-number">305</span></span>, [<span class="hljs-number"><span class="hljs-number">309</span></span>, [<span class="hljs-number"><span class="hljs-number">310</span></span>, [<span class="hljs-number"><span class="hljs-number">311</span></span>, [<span class="hljs-number"><span class="hljs-number">312</span></span>, [<span class="hljs-number"><span class="hljs-number">315</span></span>, [<span class="hljs-number"><span class="hljs-number">316</span></span>, [<span class="hljs-number"><span class="hljs-number">317</span></span>, [<span class="hljs-number"><span class="hljs-number">318</span></span>, [<span class="hljs-number"><span class="hljs-number">319</span></span>, [<span class="hljs-number"><span class="hljs-number">320</span></span>, [<span class="hljs-number"><span class="hljs-number">321</span></span>, [<span class="hljs-number"><span class="hljs-number">322</span></span>, [<span class="hljs-number"><span class="hljs-number">323</span></span>, [<span class="hljs-number"><span class="hljs-number">324</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'print'</span></span>]], [<span class="hljs-number"><span class="hljs-number">326</span></span>, [<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-string"><span class="hljs-string">'('</span></span>], [<span class="hljs-number"><span class="hljs-number">334</span></span>, [<span class="hljs-number"><span class="hljs-number">335</span></span>, [<span class="hljs-number"><span class="hljs-number">305</span></span>, [<span class="hljs-number"><span class="hljs-number">309</span></span>, [<span class="hljs-number"><span class="hljs-number">310</span></span>, [<span class="hljs-number"><span class="hljs-number">311</span></span>, [<span class="hljs-number"><span class="hljs-number">312</span></span>, [<span class="hljs-number"><span class="hljs-number">315</span></span>, [<span class="hljs-number"><span class="hljs-number">316</span></span>, [<span class="hljs-number"><span class="hljs-number">317</span></span>, [<span class="hljs-number"><span class="hljs-number">318</span></span>, [<span class="hljs-number"><span class="hljs-number">319</span></span>, [<span class="hljs-number"><span class="hljs-number">320</span></span>, [<span class="hljs-number"><span class="hljs-number">321</span></span>, [<span class="hljs-number"><span class="hljs-number">322</span></span>, [<span class="hljs-number"><span class="hljs-number">323</span></span>, [<span class="hljs-number"><span class="hljs-number">324</span></span>, [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"'Hi'"</span></span>]]]]]]]]]]]]]]]]]], [<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-string"><span class="hljs-string">')'</span></span>]]]]]]]]]]]]]]]]]]], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]]]]]], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]]</code> </pre> <br>  ستكون قيمة الإخراج قائمة متداخلة.  تحتوي كل قائمة في الهيكل على عنصرين.  الأول هو معرف الشخصية (0-256 - الطرفيات ، 256+ - غير الطرفية) والثاني هو سلسلة الرموز المميزة للجهاز. <br><br>  <b>شجرة بناء جملة مجردة</b> <br><br>  في الواقع ، فإن شجرة بناء الجملة المجردة (AST) هي تمثيل هيكلي للكود المصدري في شكل شجرة ، حيث يشير كل رأس إلى أنواع مختلفة من بنيات اللغة (التعبير ، المتغير ، المشغل ، إلخ.) <br><br>  <b>ما هي الشجرة؟</b> <br><br>  الشجرة هي بنية بيانات لها قمة جذر كنقطة انطلاق.  يتم تخفيض رأس الجذر بواسطة الفروع (التحولات) وصولاً إلى رؤوس أخرى.  كل قمة ، باستثناء الجذر ، لها قمة رأس فريدة. <br><br>  يوجد اختلاف معين بين شجرة بناء الجملة المجردة وشجرة التحليل. <br><br><img src="https://habrastorage.org/webt/2o/ws/eb/2owsebsx9fqewbfmyxexaid5hm8.png"><br><br>  على اليمين توجد شجرة تحليل للتعبير 2 * 7 + 3.  هذه هي حرفيا صورة مصدر واحد لواحد في شكل شجرة.  جميع التعبيرات والمصطلحات والقيم مرئية على ذلك.  ومع ذلك ، فإن مثل هذه الصورة معقدة للغاية بالنسبة لجزء بسيط من الشفرة ، لذلك يمكننا ببساطة إزالة جميع التعبيرات النحوية التي اضطررنا إلى تحديدها في الشفرة للحسابات. <br><br>  تسمى هذه الشجرة المبسطة شجرة بناء الجملة المجردة (AST).  على اليسار في الشكل يظهر بالضبط لنفس الكود.  تم تجاهل كل تعبيرات بناء الجملة لتسهيل فهمها ، ولكن تذكر أن بعض المعلومات قد فقدت. <br><br>  <b>مثال</b> <b><br></b> <br>  تقدم Python وحدة AST مدمجة للعمل مع AST.  لإنشاء تعليمة برمجية من أشجار AST ، يمكنك استخدام الوحدات الخارجية ، على سبيل المثال <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Astor</a> . <br><br>  على سبيل المثال ، ضع في الاعتبار نفس الرمز كما كان من قبل. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ast &gt;&gt;&gt; code = <span class="hljs-string"><span class="hljs-string">"if 1: print('Hi')"</span></span></code> </pre> <br>  للحصول على AST ، نستخدم طريقة ast.parse. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>tree = ast.parse(code) &gt;&gt;&gt; tree &lt;_ast.Module object at <span class="hljs-number"><span class="hljs-number">0x7f37651d76d8</span></span>&gt;</code> </pre> <br>  حاول استخدام طريقة <code>ast.dump</code> للحصول على شجرة بناء جملة أكثر قابلية للقراءة. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>ast.dump(tree) <span class="hljs-string"><span class="hljs-string">"Module(body=[If(test=Num(n=1), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='Hi')], keywords=[]))], orelse=[])])"</span></span></code> </pre> <br>  يعتبر AST عمومًا أكثر بصرية وسهولة الفهم من شجرة التحليل. <br><br>  <b>التحكم في التدفق غراف (CFG)</b> <br><br>  الرسوم البيانية للتحكم في التدفق هي رسوم بيانية اتجاهية تقوم بنمذجة تدفق البرنامج باستخدام الكتل الأساسية التي تحتوي على تمثيل وسيط. <br><br>  عادةً ما تكون CFG هي الخطوة السابقة قبل الحصول على قيم شفرة الإخراج.  يتم إنشاء الشفرة مباشرة من الكتل الأساسية باستخدام بحث متعمق في CFG ، بدءًا من القمم. <br><br>  <b>Bytecode</b> <br><br>  Python bytecode عبارة عن مجموعة وسيطة من الإرشادات التي تعمل في جهاز Python الظاهري.  عند تشغيل التعليمات البرمجية المصدر ، يقوم Python بإنشاء دليل يسمى __pycache__.  يقوم بتخزين التعليمات البرمجية المترجمة من أجل توفير الوقت في حالة إعادة تشغيل الترجمة. <br><br>  النظر في وظيفة بيثون بسيطة في func.py. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">say_hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: str)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">"Hello"</span></span>, name) print(<span class="hljs-string"><span class="hljs-string">f"How are you </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{name}</span></span></span><span class="hljs-string">?"</span></span>)</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> func <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> say_hello &gt;&gt;&gt; say_hello(<span class="hljs-string"><span class="hljs-string">"Batuhan"</span></span>) Hello Batuhan How are you Batuhan?</code> </pre> <br>  <code>say_hello</code> كائن <code>say_hello</code> هو وظيفة. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>type(say_hello) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class">'&gt;</span></span></code> </pre> <br>  لديها سمة <code>__code__</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>say_hello.__code__ &lt;code object say_hello at <span class="hljs-number"><span class="hljs-number">0x7f13777d9150</span></span>, file <span class="hljs-string"><span class="hljs-string">"/home/batuhan/blogs/cpython/exec_model/func.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;</code> </pre> <br>  <b>كائنات التعليمات البرمجية</b> <br><br>  كائنات التعليمات البرمجية هي هياكل بيانات غير قابلة للتغيير تحتوي على التعليمات أو البيانات الأولية اللازمة لتنفيذ التعليمات البرمجية.  ببساطة ، هذه هي تمثيلات لشفرة بيثون.  يمكنك أيضًا الحصول على كائنات التعليمات البرمجية عن طريق ترجمة أشجار بناء الجملة المجردة باستخدام طريقة <i>الترجمة</i> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ast &gt;&gt;&gt; code = <span class="hljs-string"><span class="hljs-string">""" ... def say_hello(name: str): ... print("Hello", name) ... print(f"How are you {name}?") ... say_hello("Batuhan") ... """</span></span> &gt;&gt;&gt; tree = ast.parse(code, mode=<span class="hljs-string"><span class="hljs-string">'exec'</span></span>) &gt;&gt;&gt; code = compile(tree, <span class="hljs-string"><span class="hljs-string">'&lt;string&gt;'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'exec'</span></span>) &gt;&gt;&gt; type(code) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">code</span></span></span><span class="hljs-class">'&gt;</span></span></code> </pre> <br>  كل كائن رمز له سمات تحتوي على معلومات معينة (مسبوقة بـ co_).  هنا نذكر فقط عدد قليل منهم. <br><br>  <i><b>co_name</b></i> <br><br>  لبداية - اسم.  في حالة وجود وظيفة ، يجب أن يكون لها اسم ، على التوالي ، سيكون هذا الاسم هو اسم الوظيفة ، وهو موقف مشابه للفئة.  في مثال AST ، نستخدم وحدات ، ويمكننا أن نعلم المترجم بالضبط ما نريد تسميته.  فليكن مجرد <code>module</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>code.co_name <span class="hljs-string"><span class="hljs-string">'&lt;module&gt;'</span></span> &gt;&gt;&gt; say_hello.__code__.co_name <span class="hljs-string"><span class="hljs-string">'say_hello'</span></span></code> </pre> <br>  <i><b>co_varnames</b></i> <br><br>  هذه مجموعة تحتوي على جميع المتغيرات المحلية ، بما في ذلك الوسائط. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>say_hello.__code__.co_varnames (<span class="hljs-string"><span class="hljs-string">'name'</span></span>,)</code> </pre> <br>  <i><b>التعاون</b></i> <br><br>  مجموعة تحتوي على جميع القيم الحرفية والقيم الثابتة التي وصلنا إليها في نص الوظيفة.  تجدر الإشارة إلى قيمة بلا.  لم نقم بتضمين لا شيء في نص الوظيفة ، لكن Python أشار إليها ، لأنه إذا بدأت الوظيفة في التنفيذ وتنتهي دون تلقي أي قيم إرجاع ، فسوف تُرجع بلا. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>say_hello.__code__.co_consts (<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'Hello'</span></span>, <span class="hljs-string"><span class="hljs-string">'How are you '</span></span>, <span class="hljs-string"><span class="hljs-string">'?'</span></span>)</code> </pre> <br>  <b>Bytecode (كود_المشترك)</b> <br><br>  ما يلي هو رمز وظيفتنا. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>bytecode = say_hello.__code__.co_code &gt;&gt;&gt; bytecode <span class="hljs-string"><span class="hljs-string">b't\x00d\x01|\x00\x83\x02\x01\x00t\x00d\x02|\x00\x9b\x00d\x03\x9d\x03\x83\x01\x01\x00d\x00S\x00'</span></span></code> </pre> <br>  هذه ليست سلسلة ، هذا كائن بايت ، أي سلسلة بايت. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>type(bytecode) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class">'&gt;</span></span></code> </pre> <br>  الحرف الأول المطبوع هو "t".  إذا طلبنا قيمتها الرقمية ، فسوف نحصل على ما يلي. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>ord(<span class="hljs-string"><span class="hljs-string">'t'</span></span>) <span class="hljs-number"><span class="hljs-number">116</span></span></code> </pre> <br>  116 هو نفس رمز الكود [0]. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bytecode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == ord(<span class="hljs-string"><span class="hljs-string">'t'</span></span>)</code> </pre><br>  بالنسبة لنا ، قيمة 116 لا تعني شيئًا.  لحسن الحظ ، يوفر Python مكتبة قياسية تسمى dis (من التفكيك).  من المفيد عند العمل مع قائمة opname.  هذه قائمة بجميع إرشادات رمز البايت ، حيث يكون كل فهرس هو اسم التعليمات. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.opname[ord(<span class="hljs-string"><span class="hljs-string">'t'</span></span>)] <span class="hljs-string"><span class="hljs-string">'LOAD_GLOBAL'</span></span></code> </pre> <br>  دعونا إنشاء وظيفة أخرى أكثر تعقيدا. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">multiple_it</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: int)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> a % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a * <span class="hljs-number"><span class="hljs-number">2</span></span> ... &gt;&gt;&gt; multiple_it(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt; multiple_it(<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-number"><span class="hljs-number">14</span></span> &gt;&gt;&gt; bytecode = multiple_it.__code__.co_code</code> </pre> <br>  ونكتشف أول تعليمات في bytecode. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.opname[bytecode[<span class="hljs-number"><span class="hljs-number">0</span></span>]] <span class="hljs-string"><span class="hljs-string">'LOAD_FAST</span></span></code> </pre> <br>  يتكون بيان LOAD_FAST من عنصرين. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.opname[bytecode[<span class="hljs-number"><span class="hljs-number">0</span></span>]] + <span class="hljs-string"><span class="hljs-string">' '</span></span> + dis.opname[bytecode[<span class="hljs-number"><span class="hljs-number">1</span></span>]] <span class="hljs-string"><span class="hljs-string">'LOAD_FAST &lt;0&gt;'</span></span></code> </pre> <br>  يحدث تعليمة Loadfast 0 للبحث عن أسماء المتغيرات في المجموعة ودفع عنصر بفهرس صفري إلى tuple في مكدس التنفيذ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>multiple_it.__code__.co_varnames[bytecode[<span class="hljs-number"><span class="hljs-number">1</span></span>]] <span class="hljs-string"><span class="hljs-string">'a'</span></span></code> </pre> <br>  يمكن تفكيك الكود الخاص بنا باستخدام dis.dis وتحويل الكود الجانبي إلى طريقة عرض مألوفة.  هنا الأرقام (2،3،4) هي أرقام الأسطر.  يتم توسيع كل سطر من التعليمات البرمجية في بيثون كمجموعة من التعليمات. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.dis(multiple_it) <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">0</span></span> (a) <span class="hljs-number"><span class="hljs-number">2</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span> BINARY_MODULO <span class="hljs-number"><span class="hljs-number">6</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">2</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">8</span></span> COMPARE_OP <span class="hljs-number"><span class="hljs-number">2</span></span> (==) <span class="hljs-number"><span class="hljs-number">10</span></span> POP_JUMP_IF_FALSE <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">2</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">14</span></span> RETURN_VALUE <span class="hljs-number"><span class="hljs-number">4</span></span> &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">0</span></span> (a) <span class="hljs-number"><span class="hljs-number">18</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">20</span></span> BINARY_MULTIPLY <span class="hljs-number"><span class="hljs-number">22</span></span> RETURN_VALUE</code> </pre> <br>  <b>مهلة</b> <br><br>  CPython عبارة عن آلة افتراضية موجهة نحو المكدس ، وليست مجموعة من السجلات.  هذا يعني أن شفرة Python يتم تجميعها لجهاز ظاهري بهيكل مكدس. <br><br>  عند استدعاء وظيفة ، يستخدم Python مجموعتين معًا.  الأول هو مكدس التنفيذ ، والثاني هو مكدس الكتلة.  تحدث معظم الاستدعاءات في مكدس التنفيذ ؛  تقوم مجموعة الكتل بتتبع عدد الكتل النشطة حاليًا ، وكذلك المعلمات الأخرى المتعلقة بالكتل والنطاقات. <br><br>  نحن نتطلع إلى تعليقاتك على المواد وندعوكم إلى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">عقد ندوة عبر الإنترنت</a> حول هذا الموضوع: "حررها: الجوانب العملية لإصدار برامج موثوقة" ، والتي سيجريها معلمنا ، مبرمج نظام الإعلان في Mail.Ru ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ستانيسلاف ستوبنيكوف</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar442252/">https://habr.com/ru/post/ar442252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar442238/index.html">باستخدام Waves Smart Accounts: من المزادات إلى برامج المكافآت</a></li>
<li><a href="../ar442242/index.html">الأخبار العاجلة: تم إطلاق أكبر محطة للخلايا الشمسية في نصف الكرة الغربي</a></li>
<li><a href="../ar442244/index.html">1.33 الصدأ الإصدار</a></li>
<li><a href="../ar442248/index.html">وافقت وكالة ناسا على إطلاق اختبار غير مأهول من Dragon-2</a></li>
<li><a href="../ar442250/index.html">رد فعل و Vue: نقاط القوة</a></li>
<li><a href="../ar442256/index.html">الدفاع الرقمي من العالم البلاستيك من منظمات الإنترنت المحلية</a></li>
<li><a href="../ar442258/index.html">تجريف الويب لمطوري الويب: ملخص موجز</a></li>
<li><a href="../ar442260/index.html">10 أوامر جيت التي يجب أن يعرفها المطور</a></li>
<li><a href="../ar442262/index.html">سر البرامج الثابتة</a></li>
<li><a href="../ar442264/index.html">القضاء على فرص اختطاف المرور</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>