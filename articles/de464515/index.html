<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ≤Ô∏è ü§¶üèº ‚≠êÔ∏è Wie man E-Mails erstellt und nicht durcheinander bringt: Praktische Tipps üë©üèæ‚Äçüè≠ üç≥ üçû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein Entwickler, der zum ersten Mal E-Mails generiert hat, hat fast keine Chance, eine Anwendung zu schreiben, die dies korrekt ausf√ºhrt. Rund 40% der ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie man E-Mails erstellt und nicht durcheinander bringt: Praktische Tipps</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/464515/"><img src="https://habrastorage.org/webt/s8/cx/7x/s8cx7xzo0rsuk0xw3z25hbfcjke.png"><br><br>  Ein Entwickler, der zum ersten Mal E-Mails generiert hat, hat fast keine Chance, eine Anwendung zu schreiben, die dies korrekt ausf√ºhrt.  Rund 40% der von Unternehmensanwendungen generierten E-Mails versto√üen gegen einen Standard. Aus diesem Grund treten Probleme bei der Zustellung und Anzeige auf.  Daf√ºr gibt es Gr√ºnde: E-Mails sind technisch schwieriger als das Internet, und der Betrieb von E-Mails wird durch einige hundert Standards sowie eine unz√§hlige Anzahl allgemein anerkannter (und weniger) Praktiken geregelt, w√§hrend die E-Mail-Clients vielf√§ltiger sind und unvorhersehbar als Browser.  Das Testen kann die Situation erheblich verbessern, aber Materialien, die zum Testen des E-Mail-Systems bestimmt sind, sind praktisch nicht vorhanden. <br><br>  Mail.ru interagiert regelm√§√üig per E-Mail mit seinen Benutzern.  In unseren Projekten unterliegen alle Komponenten, die f√ºr die Generierung von E-Mails und sogar einzelne Mailings verantwortlich sind, obligatorischen Tests.  In diesem Artikel werden wir unsere Erfahrungen teilen (aus unseren Fehlern lernen). <br><a name="habracut"></a><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Welche Art von E-Mails gibt es?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wer ist am Test- und Kontrollprozess beteiligt?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Versand und Posttransport</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Schnittstelle der E-Mail-Infrastruktur und die Grenzen der getesteten Anwendung</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Definition von Testparametern</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Typische Struktur einer generierenden Anwendung</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Was und wann zu testen</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lieferinfrastruktur</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anwendung generieren</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Strukturelle und setzende E-Mail-Vorlagen</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grundvoraussetzungen f√ºr die √úberpr√ºfung der Infrastruktur</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Authentifizierungsanforderungen</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberpr√ºfung der generierenden Anwendung</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anforderungen an E-Mail-Adressen</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Umschlagadressen</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">E-Mail-Header-Adressen</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anforderungen an Header</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anforderungen an die Struktur der E-Mail</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">URI-Anforderungen</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anforderungen an das E-Mail-Layout</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Split-Tests durchf√ºhren</a> <br></li></ul><br><a name="1"></a><h2>  Welche Art von E-Mails gibt es? </h2><br>  Die Anwendung kann verschiedene Arten von E-Mails generieren.  Sie k√∂nnen in mehrere Kategorien eingeteilt werden.  Durch die Methode der Auswahl der Empf√§nger - pers√∂nlich / ausgel√∂st - selektive Gruppe.  Nach Vereinbarung: Transaktions- Marketing-Service.  Sie k√∂nnen unterschiedliche Anforderungen f√ºr verschiedene E-Mail-Typen festlegen und verschiedene Testszenarien anwenden. <br><br>  Ausgel√∂ste pers√∂nliche E-Mails werden als Reaktion auf Ereignisse generiert, z. B. Benutzeraktionen oder Status√§nderungen von Systemobjekten.  Sie werden von der Anwendung generiert und sind daher im Hinblick auf das Testen am interessantesten.  Ausgel√∂ste E-Mails k√∂nnen Transaktions-, Marketing- und Service-E-Mails sein.  Selektive E-Mails werden an eine dynamische Auswahl von Benutzern gesendet, die bestimmte Kriterien erf√ºllen.  Gruppen-E-Mails werden an eine permanente Gruppe von Empf√§ngern gesendet, z. B. an alle Benutzer oder Partner.  Selektive und Gruppen-E-Mails werden h√§ufig f√ºr Marketingzwecke verwendet, und das Senden solcher E-Mails wird manuell oder nach einem Zeitplan gestartet. <br><br>  Transaktions-E-Mails werden generiert, wenn ein Benutzer eine Aktion ausf√ºhrt.  Solche E-Mails umfassen beispielsweise Rechnungen, Tickets oder Lieferstatusbenachrichtigungen.  Transaktions-E-Mails werden immer ausgel√∂st und sollen wichtige Informationen enthalten.  Sie sollten so einfach und kompatibel wie m√∂glich sein, und sie sollten auf einer gro√üen Anzahl von E-Mail-Clients getestet werden. <br><br>  Marketing-E-Mails ermutigen den Benutzer, Ma√ünahmen zu ergreifen. Dies kann beispielsweise ein Angebot f√ºr einen pers√∂nlichen Rabatt sein, der auf fr√ºheren Eink√§ufen basiert.  Transaktionsdaten k√∂nnen in diesen E-Mails verwendet werden, und sie k√∂nnen E-Mails oder Massen-, periodische oder einmalige E-Mails ausgel√∂st werden.  F√ºr diese E-Mails ist die Effizienz wichtiger, und die Ergebnisse des Split-Tests bestimmen dies normalerweise.  Einige Aspekte der Kompatibilit√§t k√∂nnen f√ºr die Effizienz geopfert werden. <br><br>  Gruppenmarketing-E-Mails, z. B. Nachrichten zu saisonalen Angeboten, Werbeaktionen und Verk√§ufen, werden h√§ufig manuell gesendet und sind nicht Teil Ihrer Anwendung. Sie k√∂nnen (und sollten) jedoch auch allgemeine Testprinzipien auf diese anwenden. <br><br>  Es k√∂nnen auch Service-E-Mails vorhanden sein: Benachrichtigungen, die f√ºr die Mitarbeiter generiert wurden, f√ºr automatisierte CRM-Systeme, Journaling, Auditing oder DWH.  Solche E-Mails sind normalerweise ausgel√∂ste E-Mails, dh sie sind auch Teil der Anwendung und m√ºssen getestet werden. <br><br><a name="2"></a><h2>  Wer ist am Test- und Kontrollprozess beteiligt? </h2><br><ol><li>  QS-Ingenieur - nimmt an allen Phasen des Prozesses teil. <br></li><li>  Netzwerktechniker - verantwortlich f√ºr die Konfiguration der Netzwerkinfrastruktur und der Infrastruktur f√ºr die Nachrichten√ºbermittlung.  Der Netzwerktechniker sollte in die Planung und das Testen der Infrastruktur einbezogen werden. <br></li><li>  Zustellungsspezialist - Person, die die Zustellbarkeit von E-Mails √ºberwacht, die auch an der √úberwachung der technischen und administrativen Parameter aller gesendeten E-Mails beteiligt ist und den Fortschritt des Versandprozesses √ºberwacht.  Er ist daf√ºr verantwortlich, dass die gesendeten E-Mails den h√∂chsten Prozentsatz der Benutzer erreichen und nicht in Spam geraten.  Zu diesem Zweck muss der Spezialist √ºber spezifische Kenntnisse und Kontakte verf√ºgen.  Wenn es Probleme mit der Zustellung von E-Mails gibt, muss er die wahrscheinliche Ursache verstehen und beseitigen.  entweder durch Beseitigung technischer Hindernisse;  oder etwas im Inhalt der E-Mails √§ndern;  oder versuchen Sie, das Problem mit dem Support-Service des Mail-Anbieters zu l√∂sen, den die E-Mails nicht erreichen.  Ein solcher Spezialist (falls vorhanden) sollte auch an der Erstellung der Checkliste und dem Testen der Infrastruktur zur Erstellung von Anwendungen und E-Mails beteiligt sein.  Der Testprozess selbst sollte jedoch unter der Kontrolle des QS-Dienstes stehen. <br></li><li>  E-Mail-Vermarkter - bestimmt die Wirksamkeit von Marketing-Newslettern.  Unter seiner Kontrolle findet der Split-Test f√ºr die Verteilung des Marketings an das Publikum statt.  Der E-Mail-Vermarkter steuert auch die Segmentierung der Benutzerbasis, die Zusammensetzung und H√§ufigkeit der gesendeten E-Mails sowie die visuelle "Pr√§sentation" der E-Mail f√ºr den Benutzer. <br></li></ol><br>  Alle diese Rollen werden nicht unbedingt von einem engagierten Mitarbeiter ausgef√ºhrt.  Die Rolle des Vermarkters kann von einem der Produktmanager √ºbernommen werden, und die Rolle des Lieferspezialisten kann beispielsweise von einem Support-Mitarbeiter oder einem Netzwerktechniker √ºbernommen werden.  In Start-up-Unternehmen ist es sehr wahrscheinlich, dass all dies von einer Person erledigt werden muss, und sie k√∂nnen sich als Qualit√§tsspezialist herausstellen. <br><br><a name="3"></a><h2>  Versand und Posttransport </h2><br>  Die E-Mail-Struktur √§hnelt einem massiven Eisberg und besteht aus zwei Ebenen.  Es gibt mehr als hundert verschiedene Standards f√ºr E-Mails, aber fast alle geh√∂ren zu einer dieser beiden Ebenen: <br><br>  <b>Der Unterwasserteil eines Eisberg-</b> Netzwerkdienstes, dessen Basisprotokoll das in RFC 5321 definierte SMTP-Anwendungsprotokoll ist. Es ist f√ºr die Zustellung von E-Mails verantwortlich.  F√ºr die Zustellung der E-Mail wird ein sogenannter SMTP-Umschlag gebildet, der die Adressen des Absenders und Empf√§ngers der SMTP-Ebene enth√§lt.  Andere Netzwerkdienste wie DNS sind ebenfalls f√ºr die Zustellung der E-Mail verantwortlich.  Die Hauptkomponente der Netzwerkinfrastruktur ist der Mail Transfer Agent (MTA).  Der MTA ist daf√ºr verantwortlich, die Nachrichten√ºbermittlungswarteschlange und den √úbermittlungsprozess selbst an die Empf√§ngerserver zu √ºbergeben.  MTA-Beispiele sind Postfix, Sendmail, Exim und Microsoft SMTP. <br><br>  In diesem Unterwasserteil des Eisbergs, der die MTA-, DNS-Parameter und andere Netzwerkparameter enth√§lt, werden wir die E-Mail-Infrastruktur oder die Nachrichten√ºbermittlungsinfrastruktur nennen. <br><br>  <b>Die Spitze des Eisbergs</b> - die E-Mail selbst.  Die Grundstruktur der E-Mail wird durch den Standard-RFC 5322 definiert. Die E-Mail besteht aus Service-Headern und einem oder mehreren Datenteilen.  Die Daten k√∂nnen in einem Nur-Text-Format und / oder HTML oder sogar AMP mit Inline-Bildern oder Anh√§ngen fast aller Art vorliegen. <br><br><a name="4"></a><h2>  Die Schnittstelle der E-Mail-Infrastruktur und die Grenzen der getesteten Anwendung </h2><br>  Die E-Mail-Infrastruktur verf√ºgt in der Regel √ºber eine oder mehrere Schnittstellen, √ºber die eine E-Mail gesendet wird (wenn sie in die MTA-Zustellwarteschlange eingeht).  Zum Beispiel der SMTP-√úbermittlungsdienst, die Funktion <code>mail()</code> in PHP, die Daten√ºbertragung an eine externe Mail- oder Sendmail-Anwendung, die API f√ºr den internen oder externen Dienst (wie GetResponse, SendPulse oder Amazon SES).  Wir werden diese Schnittstellen als Teil der Infrastruktur betrachten.  Es kommt h√§ufig vor, dass Anwendung A Daten f√ºr eine E-Mail und eine Liste von Empf√§ngern vorbereitet und diese dann √ºber ihre API an Anwendung B sendet (f√ºr die Vermarktung von Massenmailings kann dies manuell √ºber die Benutzeroberfl√§che erfolgen) und Anwendung B generiert eine E-Mail-Nachricht in RFC 5322 und √ºbermittelt sie an den MTA.  F√ºr Anwendung A (und beim Testen) ist Anwendung B Teil der E-Mail-Infrastruktur.  Die API oder Benutzeroberfl√§che von Anwendung B ist f√ºr die Schnittstelle von Anwendung A der E-Mail-Infrastruktur vorgesehen.  Obwohl f√ºr Anwendung B die Situation anders sein wird und die E-Mail-Infrastruktur daf√ºr Netzwerkanwendungen oder -protokolle niedrigerer Ebene sein wird. <br><br><a name="5"></a><h2>  Definition von Testparametern </h2><br>  Beim Testen jeder Anwendung ist es wichtig, alle von ihr verwendeten Mail-Infrastrukturen auszuw√§hlen (es k√∂nnen mehrere vorhanden sein) und f√ºr jede Infrastruktur die verwendeten Schnittstellen herauszusuchen (es k√∂nnen auch mehrere f√ºr jede Infrastruktur vorhanden sein).  F√ºr jede Schnittstelle wird die Zusammensetzung und das Format der an sie √ºbertragenen Daten so genau wie m√∂glich bestimmt, z. B. E-Mail-Text in TEXT / HTML, E-Mail-Text in TEXT / PLAIN, E-Mail-Betreff, Empf√§ngername, Empf√§ngeradresse, Absendername, Absenderadresse (RFC5321.From), die Adresse des Absenders des SMTP-Konvektors (RFC5322.mailfrom).  Als n√§chstes wird eine Reihe von Anforderungen f√ºr jeden Parameter entwickelt (Darstellungen, Codierungen, Grenzwerte usw.), Methoden zur √úberwachung jedes Parameters werden bestimmt (wie das tats√§chliche Ergebnis mit dem erwarteten verglichen wird). <br><br><a name="6"></a><h2>  Typische Struktur einer generierenden Anwendung </h2><br>  In der Regel ist dasselbe Produkt, das wir testen, f√ºr die Generierung von E-Mails und Daten verantwortlich.  Dies ist normalerweise eine Serveranwendung (manchmal aber auch eine Clientanwendung).  Es definiert die Struktur der E-Mail, einen Teil der Service-Header, Datenkapselungsformate, Zeichenfolgendarstellungen und Textcodierung.  Ein einfaches Beispiel f√ºr eine solche Anwendung ist das Skript, das die E- <code>mail()</code> bildet und die Funktion <code>mail()</code> aufruft.  Die Hauptelemente der Anwendung, die gesteuert werden m√ºssen, sind: <br><br><ul><li>  den Code, der f√ºr die Generierung von Headern und / oder E-Mail-Strukturen verantwortlich ist, wenn die E-Mail-Struktur dynamisch generiert wird, und / oder statische E-Mail-Vorlagen, die ihre Struktur beschreiben; <br></li><li>  HTML-Layout der E-Mail (im Idealfall handelt es sich um eine separate Entit√§t oder einen Teil der E-Mail-Vorlage / des E-Mail-Layouts, kann jedoch in den Anwendungscode eingebettet werden); <br></li><li>  Ersetzen von Anwendungsdaten in eine E-Mail (oder in eine E-Mail-Vorlage); <br></li><li>  Integration der Anwendung in die E-Mail-Zustellungsinfrastruktur, die Richtigkeit der an die Infrastrukturschnittstelle √ºbergebenen Parameter. <br></li></ul><br><a name="7"></a><h2>  Was und wann zu testen </h2><br>  Ob es uns gef√§llt oder nicht, der gesamte Eisberg sollte getestet werden.  Es gibt mehrere Hauptkomponenten, die getestet werden m√ºssen: <br><br><a name="8"></a><h4>  Lieferinfrastruktur </h4><br>  Der Schwerpunkt der Tests sollte auf folgenden Punkten liegen: Zustellbarkeit von E-Mails;  korrekte DNS-Eintr√§ge, einschlie√ülich PTR / FCrDNS-, MX- und A-Eintr√§ge;  SMTP-Protokollparameter (HELO, TLS verwenden);  E-Mail-Autorisierung (SPF / DKIM / DMARC);  SMTP-Umschlagadressen (wenn die Anwendung sie nicht verwaltet);  Richtigkeit der Verarbeitung der Eingabeparameter der Infrastrukturschnittstelle;  Verfolgung, Aufzeichnung und Verarbeitung von nicht zugestellten E-Mails. <br><br>  Es ist erforderlich, die Infrastruktur w√§hrend der Erstimplementierung und jedes Mal zu testen, wenn √Ñnderungen an der Infrastruktur selbst (der Konfiguration des MTA, DNS oder Netzwerk√§nderungen) oder der Schnittstelle zum Senden einer E-Mail vorgenommen werden.  Verwenden einer neuen Dom√§ne, eines neuen Netzwerks oder einer neuen API;  Zus√§tzliche Tests sind erforderlich, wenn sich die Eigenschaften der gesendeten E-Mails wie Sprache, Gr√∂√üe oder Anzahl erheblich √§ndern.  Erfahrungsgem√§√ü √§ndert sich die Infrastruktur "von selbst", daher sollten regelm√§√üig grundlegende Tests durchgef√ºhrt werden, auch wenn keine Informationen √ºber √Ñnderungen vorliegen. <br><br>  Es ist m√∂glich und notwendig, den Netzwerktechniker und den Zustellbarkeitsspezialisten in die Erstellung des Plans und der Checklisten zum Testen der Infrastruktur einzubeziehen. <br><br><a name="9"></a><h4>  Anwendung generieren </h4><br>  Die Adressen des SMTP-Umschlags sollten √ºberwacht werden (wenn die Anwendung sie steuert, dh sie werden an die Schnittstelle √ºbertragen - Umschlag von, Umschlag an), die Werte der Service-Header der E-Mail (Datum, Nachricht) -ID, List-Unsubscribe, Auto-Submitted usw.).  Klausel), E-Mail-Autorisierung (DKIM / DMARC), MIME-Codierung (base64, zitiert-druckbar), allgemeine Korrektheit des E-Mail-Formats, z. B. das Fehlen von Nicht-ASCII-Zeichen in den Headern, die Zusammensetzung der injizierten Daten , das korrekte Ausl√∂sen von Triggern, das Abbestellen von Mechanismen, das Schreiben und Sammeln von Statistiken durch Verfolgungsmechanismen (Postmaster-Header, z. B. Feedback-ID oder X-Mailru-Msgtype, sowie das Verfolgen von Pixeln). <br><br>  Es ist erforderlich, eine Anwendung w√§hrend ihrer Entwicklung zu testen, wenn sich alle zugeh√∂rigen Komponenten, die f√ºr das Generieren und Speichern von Daten verantwortlich sind, √§ndern, wobei sich die E-Mail-Vorlagen erheblich √§ndern, wenn die verwendete Infrastruktur oder Schnittstelle zu ihr ge√§ndert wird, sowie im Rahmen von allgemeine Regressionen. <br><br><a name="10"></a><h4>  Strukturelle und setzende E-Mail-Vorlagen (k√∂nnen Teil einer generierenden Anwendung sein oder werden separat entwickelt) </h4><br>  Die Struktur der E-Mail wird √ºberpr√ºft (Inhaltstyp, Inhaltsdisposition, Verschachtelung von mehrteiligen Teilen der E-Mail, Textcodierung, Zeichenfolgenparameter), der Wert des Ziels und die angezeigten √úberschriften (Von, Bis, Antwort an, Betreff) ), die Art und Weise, wie E-Mails in der Liste der E-Mails angezeigt werden, und beim Lesen in verschiedenen Schnittstellen Mikroformate (z. B. dass ein Kalenderereignis als Kalenderereignis oder ein Flugticket als Flugticket erkannt wird), Branding. <br><br>  E-Mail-Vorlagen sollten jedes Mal getestet werden, wenn Sie mindestens die geringsten √Ñnderungen vornehmen, sowie separat, z. B. in Situationen, in denen E-Mails in die Anwendung gelangen, bevor der Serverteil bereit ist. <br><br>  Es wird empfohlen, einen E-Mail-Marketing-Spezialisten und einen Zustellbarkeitsspezialisten hinzuzuziehen, um eine Checkliste zum Testen einer E-Mail-Vorlage zu erstellen. <br><br><a name="11"></a><h4>  Grundvoraussetzungen f√ºr die √úberpr√ºfung der Infrastruktur </h4><br>  Die f√ºr den Mailserver ausgew√§hlte IP-Adresse sollte so nah wie m√∂glich an der IP-Adresse des Mailservers liegen.  Es wird empfohlen, dies mit dem Dienstprogramm whois zu √ºberpr√ºfen.  Insbesondere sollte die Absenderadresse nicht zum Netzwerk geh√∂ren, was als dynamisch empfunden werden kann.  Das ausgew√§hlte Netzwerk muss √ºber aktive Kontakte verf√ºgen, an die Beschwerden gesendet werden k√∂nnen.  Das Netzwerk muss verwendet werden (in RIPE den Status ASSIGNED haben). Die IP-Adresse muss √ºber einen ordnungsgem√§√ü konfigurierten PTR-Eintrag verf√ºgen.  Sie kann unabh√§ngig √ºber das Hosting-Control-Panel oder mithilfe des Dienstanbieters konfiguriert werden.  Ein PTR-Datensatz muss auf den tats√§chlichen Hostnamen verweisen und dennoch aussagekr√§ftig sein, auf dieselbe IP-Adresse zur√ºckgef√ºhrt werden (sogenannte FCrDNS-Pr√ºfung), den Namen des dynamischen Hosts nicht erinnern und darf keine gro√üe Gruppe von Zahlen oder Zeichen enthalten.  Ein gutes Beispiel ist mailserver.example.com. <br><br>  Jede Domain, die in Umschlagadressen oder E-Mail-Headern verwendet wird, muss einen g√ºltigen MX-Datensatz haben, der auf einen Host-A-Datensatz verweist, der mindestens unzustellbare Nachrichten verarbeiten kann.  MX darf nicht direkt auf eine IP-Adresse verweisen. <br><br>  Kontrollieren Sie den Durchgang von SPF, DKIM, DMARC.  Mit SPF kann der Dom√§neninhaber in den TXT-Datens√§tzen eine Liste von Servern angeben, die zum Senden von E-Mails mit Absenderadressen in dieser Dom√§ne berechtigt sind.  Es ist f√ºr die Adresse konfiguriert, die im Umschlag von (SMTP-Umschlag) im Abschnitt Verwalten von DNS-Zonen der Dom√§ne verwendet wird.  DKIM bietet eine √úberpr√ºfung der Urheberschaft einer Nachricht oder ihres Absenders f√ºr eine bestimmte Dom√§ne mithilfe digitaler Signaturtechnologien, die der E-Mail selbst hinzugef√ºgt werden (in ihrem DKIM-Signatur-Header).  In der Regel wird eine DKIM-Signatur auf MTA-Ebene (Infrastruktur) konfiguriert.  DMARC legt die Richtlinie zum √úberpr√ºfen eingehender E-Mails in einer bestimmten Dom√§ne und von Aktionen f√ºr E-Mails fest, die die SPF- oder DKIM-Authentifizierung nicht bestehen.  Bei dem Versuch, gegen diese Richtlinie zu versto√üen, enth√§lt ein strukturierter Bericht Informationen zu einem solchen Versuch.  DMARC sowie SPF werden als TXT-Eintrag in der Dom√§nenzone ver√∂ffentlicht. <br><br>  √úberpr√ºfen Sie die Zustellbarkeit von E-Mails an die wichtigsten Postdienste - f√ºr Russia Mail.Ru, Yandex, Gmail, Microsoft (Hotmail / Outlook.com / Office365), Rambler, nic.ru.  In den eingetroffenen E-Mails m√ºssen Sie die Richtigkeit von HELO √ºberpr√ºfen.  das Vorhandensein und Bestehen von Schecks PTR / FCrDNS, SPF, DKIM und DMARC;  die G√ºltigkeit der Header und Daten in ihnen, insbesondere die Synchronit√§t der Uhr in den Daten und die Richtigkeit der Zeitzonen. <br><br><img src="https://habrastorage.org/webt/dg/kr/ml/dgkrmlpmq_rsds5zu40kwxuqz1o.png"><br>  (Die Registrierungsmail hat die Authentifizierung aufgrund der verwendeten Freemail-Adresse unterbrochen.) <br><br>  Die Bildung einiger Parameter, z. B. Autorisierung, Zustellbarkeit und Spam, wird von allen Komponenten ganzheitlich beeinflusst. Zu ihrer Kontrolle gibt es jedoch normalerweise separate Betriebstools - DMARC- und FBL-Berichte, Postmaster-Service-API, E-Mail-Tracking-Tools, Zustellungsstatistiken.  Bei den Tests sollte der Grad der Implementierung von Tools zur Betriebs√ºberwachung im Unternehmen ber√ºcksichtigt werden. Wenn beispielsweise keine operative Kontrolle √ºber DMARC-Berichte vorliegt, sollte die Autorisierung von E-Mails regelm√§√üig getestet werden, w√§hrend in Ermangelung einer operativen Kontrolle der Zustellbarkeit, wo und wie die E-Mails verlaufen, auch wenn es keine Entwicklung im Zusammenhang mit dem Senden von E-Mails gibt. <br><br>  Zum Testen der Infrastruktur k√∂nnen Sie spezielle Dienste verwenden, z. B. mail-tester.com, mxtoolbox.com.  Detaillierte Anforderungen an die Infrastruktur finden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie in diesem Artikel</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dab/868/c01/dab868c01fb1de36df5259aba785e92f.png"><br>  (ein Beispiel f√ºr den kaputten SPF-Rekord) <br><br><a name="12"></a><h2>  Authentifizierungsanforderungen </h2><br>  Das √úberpr√ºfen des Durchgangs von SPF, DKIM, DMARC ist normalerweise mithilfe des Headers Authentication-Results auf dem Server des Empf√§ngers m√∂glich. <br><br>  √úberpr√ºfen Sie die G√ºltigkeit des SPF-Eintrags auf Syntax, das Limit f√ºr DNS-Abfragen (z. B. mithilfe von mxtoolbox.com).  Bei der Bildung eines SPF sollten alle Mailingquellen ber√ºcksichtigt werden (CRM-Systeme, alle derzeit genutzten Bereitstellungsinfrastrukturen, einschlie√ülich derer, √ºber die einmalige Marketingkampagnen durchgef√ºhrt werden, nicht vergessen).  Es wird empfohlen, zul√§ssige Server f√ºr die Dom√§ne √ºber die Liste der Netzwerke ('ip4' / 'ip6') festzulegen.  SPF wird aus dem SMTP-Umschlag auf die Absenderadresse √ºberpr√ºft.  Stellen Sie sicher, dass die SMTP-Umschlagdom√§ne (Envelope-from) mit der Dom√§ne aus dem From-Header √ºbereinstimmt.  H√§ufige SPF-Fehler sind in diesem Artikel aufgef√ºhrt (https://medium.com/hackernoon/myths-and-legends-of-spf-d17919a9e817). <br><br>  √úberpr√ºfen Sie den DKIM-DNS-Eintrag, die G√ºltigkeit und Zusammensetzung der DKIM-Signatur.  Stellen Sie sicher, dass Sie einen DKIM-Schl√ºssel mit mindestens 1024 Bit verwenden.  Empfohlener Hash-Modus der DKIM-Signatur: entspannt / entspannt.  Stellen Sie sicher, dass alle wichtigen Header signiert sind (Von, Bis, Betreff, Datum, Nachrichten-ID, MIME-Version, Inhaltstyp), dass Tracking-Header (Empfangen, Geliefert an, R√ºckweg) nicht signiert sind und DKIM ist f√ºr grundlegende Mail-Dienste validiert.  Richten Sie die Weiterleitung an einen der Mail-Dienste an einen anderen ein.  DKIM sollte weitergeleitete E-Mails nicht "schlagen".  Stellen Sie sicher, dass die DKIM-Signaturdom√§ne mit der Absenderdom√§ne aus dem 'Von'-Header √ºbereinstimmt. <br><br>  √úberpr√ºfen Sie DMARC auf grundlegende E-Mail-Dienste.  Suchen Sie nach DMARC-Berichten, identifizieren Sie SPF und DKIM und beheben Sie Fehler f√ºr alle IP-Adressen Ihrer Infrastruktur. <br><br>  Stellen Sie sicher, dass Nachrichten mithilfe von Verschl√ºsselung (TLS) an externe Server √ºbermittelt werden.  Sie k√∂nnen manchmal anhand des empfangenen Headers auf dem Server des Empf√§ngers nach TLS suchen: Geben Sie beispielsweise das ESMTPS-Protokoll an oder haben Sie Parameter der Form (Version = TLS1_2-Chiffre = ECDHE-RSA-AES128-GCM-SHA256-Bits = 128/128).  zeigt das Vorhandensein von TLS an. <br><br><a name="13"></a><h2>  √úberpr√ºfung der generierenden Anwendung </h2><br><a name="14"></a><h3>  Anforderungen an die E-Mail-Adresse </h3><br><a name="15"></a><h4>  Umschlagadressen </h4><br>  Wir beginnen die √úberpr√ºfung der generierenden Anwendung mit den Adressen im SMTP-Umschlag. <br>  Umschlagadressen sind Adressen auf der Ebene der E-Mail-Infrastruktur.  Sie sind f√ºr den Benutzer nicht sichtbar, aber f√ºr die Zustellung wichtig, da die Adresse des Umschlags bestimmt, in welches Postfach die E-Mail geht. <br><br>  <i>Die Empf√§ngeradresse im Umschlag</i> ( <code>envelope-to</code> , auch bekannt als <code>RCPT TO:</code> ist die Adresse, an die die E-Mail tats√§chlich zugestellt wird. <br><br><ul><li>  F√ºr alle E-Mails mit Ausnahme der Registrierung muss die Adresse gem√§√ü den administrativen Anforderungen gesetzlich signiert und f√ºr den Versand validiert sein. <br></li><li>  F√ºr Newsletter muss die Adresse "live" sein. Adressen, an die E-Mails nicht regelm√§√üig zugestellt werden k√∂nnen, sollten als inaktiv markiert werden. Mailings an sie sollten nicht erfolgen.  Einige Kategorien von E-Mails (z. B. Zugriffswiederherstellung) m√ºssen jedoch m√∂glicherweise auch an Adressen gesendet werden, die zuvor als inaktiv markiert wurden. <br></li></ul><br>  <i>Absenderadresse in einem SMTP-Umschlag</i> (normalerweise als <code>envelope-from</code> , <code>smtp.mailfrom</code> , <code>MAIL FROM:</code> oder <code>Return-Path</code> ) - An diese Adresse werden Nachrichten √ºber die Unf√§higkeit, eine E-Mail zu senden, und automatische Antworten gesendet.  Diese Adresse ist f√ºr den Benutzer nicht sichtbar.  Diese Adresse wird auch f√ºr die SPF-Autorisierung verwendet.  Wir √ºberpr√ºfen Folgendes: <br><br><ul><li>  Die Adresse ist verf√ºgbar; <br></li><li>  Es ist nicht die Adresse des Mitarbeiters und wird nicht an ihn weitergeleitet, um automatische Antworten, Nachrichten √ºber Unzug√§nglichkeit usw. Auszuschlie√üen. <br></li><li>  Es wird von einem Skript verarbeitet, das Adressen unzug√§nglicher Benutzer als inaktiv markiert. <br></li><li>  Die Adresse kann automatisch generiert werden, dh f√ºr jede E-Mail eindeutig. <br></li><li>  Eine E-Mail an diese Adresse sollte nicht zur Generierung einer Antwort-E-Mail f√ºhren, z. B. einer Nachricht √ºber einen Postfach√ºberlauf. <br></li></ul><br><a name="16"></a><h4>  E-Mail-Header-Adressen </h4><br>  Diese Adressen sind entweder f√ºr den Benutzer direkt sichtbar oder werden beim Beantworten einer E-Mail verwendet. <br>  Absenderadresse (der Header <code>From:</code> ist die Adresse und der Absendername, die in der Liste der E-Mails und beim Lesen einer E-Mail angezeigt werden.  Wir √ºberpr√ºfen Folgendes: <br><br><ul><li>  Dies ist eine lesbare, freundliche Adresse, die das Unternehmen identifiziert. <br></li><li>  Es enth√§lt nicht nur eine E-Mail-Adresse, sondern auch den Namen des Absenders. <br></li><li>  Noreply @ ist m√∂glich, aber nur, wenn wir betonen m√∂chten, dass wir keine Antwort auf die E-Mail erwarten und diese nicht gelesen wird.  Es ist besser, diese Idee im Text der E-Mail zu duplizieren. <br></li><li>  Bei Vorhandensein von Nicht-ASCII-Zeichen (z. B. Kyrillisch) muss der Absendername gem√§√ü MIME codiert werden, die Dom√§ne bei Vorhandensein von Nicht-ASCII-Zeichen muss in Punycode codiert werden <br></li><li>  E-Mails derselben Kategorie sollten dieselbe Adresse haben.  Die Verwendung von automatisch generierten Adressen sollte vermieden werden.  Dies liegt an der Tatsache, dass "Von:" am h√§ufigsten von Personen verwendet wird, um E-Mails mithilfe von Filtern nach Ordnern zu sortieren. <br></li><li>  Die Adresse sollte f√ºr Transaktions-, Marketing- und dringende E-Mails (z. B. E-Mails vom Support-Service) unterschiedlich sein (vorzugsweise in verschiedenen Subdomains).  Dies liegt auch daran, dass der Benutzer Marketing-E-Mails als Spam markieren oder in einem unlesbaren Ordner filtern kann. <br></li><li>  Die Adresse <code>From:</code> und die SMTP-Umschlagadresse m√ºssen sich in derselben Dom√§ne oder in Subdom√§nen derselben Organisationsdom√§ne befinden, damit der SPF innerhalb des DMARC √ºbergeben werden kann. <br></li><li>  Die Adresse muss aus der Dom√§ne der Organisation stammen.  Es ist nicht akzeptabel, kostenlose Mail-Dienste und andere √∂ffentliche Mail-Dom√§nen in <code>From:</code> da solche Mailings die SPF- und DKIM-Authentifizierung im Rahmen von DMARC nicht bestehen. <br></li></ul><br>  Die Adresse <code>Reply-to</code> - 'manuelle' Antworten werden an diese Adresse gesendet, wenn ein Benutzer eine E-Mail beantwortet.  Es ist optional.  Wenn es nicht vorhanden ist, wird die Adresse von 'From:' f√ºr die Antwort verwendet.  √úberpr√ºfen Sie, ob 'Antwort an': <br><br><ul><li>  Es kann automatisch generiert werden, dh nur f√ºr die E-Mail (erm√∂glicht es Ihnen herauszufinden, auf welche E-Mail die Antwort eingegangen ist). <br></li><li>  Es sollte nicht in das Postfach des Mitarbeiters fallen, um eine automatische Antwort zu vermeiden, sondern sollte idealerweise in CRM "verpackt" werden. <br></li><li>  Es kann eine standardm√§√üige automatische CRM-Antwort generieren, sollte jedoch nichts √úberfl√ºssiges generieren, z. B. Postfach√ºberlauf oder "On Vocation" -Nachrichten.  Bei der Generierung von automatischen Antworten m√ºssen Ma√ünahmen ergriffen werden, um Schleifen zu vermeiden. Diese sind in RFC 3834 aufgef√ºhrt. <br></li><li>  Es kann von jeder Domain stammen, die nicht unbedingt mit 'From:' √ºbereinstimmt, aber manchmal macht dies den Benutzern bei der Beantwortung Angst. <br></li><li>  Kann fehlen, dann f√ºhrt die <code>From:</code> -Adresse ihre Funktionen aus. <br></li><li>  Zus√§tzlich zur Adresse wird der Name des Absenders angegeben. <br></li></ul><br>  Die Adresse <code>To:</code> <br><br><ul><li>  Muss die E-Mail des Empf√§ngers enthalten (andernfalls macht es dem Empf√§nger der Nachricht Angst und st√∂rt den Anti-Spam). <br></li><li>  Idealerweise sollte es den Namen des Empf√§ngers enthalten.  Wenn der Name jedoch unbekannt oder zweifelhaft ist (z. B. wurde die Adresse noch nicht best√§tigt), ist es besser, ihn nicht anzugeben (jemand kann die Adresse eines anderen mit einem schlechten Namen eingeben und der Empf√§nger kann beleidigt sein). <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/aab/7da/212/aab7da2120c8351588fcd4ea0e126a6c.png"><br><br><a name="17"></a><h3>  Anforderungen an den E-Mail-Header </h3><br>  Die tats√§chliche Codierung des Textes sollte mit der in der Kopfzeile angegebenen √ºbereinstimmen.  Es wird empfohlen, in allen Kopfzeilen und Teilen der E-Mail eine Codierung zu verwenden.  Es wird empfohlen, UTF-8 als weit verbreitetes zu verwenden.  Die Codierung wird in den Content-Type-Headern und im Tag des HTML-Teils angegeben. <br><br>  Die √úberschriften From :, Message-ID: und Date: sollten direkt im Skript zum Senden der E-Mail (und standardm√§√üig - zusammen mit dem Text der E-Mail) und immer im richtigen Format erstellt werden.  Wenn sie fehlen oder falsch gebildet sind, kann einer der Transitserver diese Header hinzuf√ºgen, was zu einer Verletzung der Integrit√§t der DKIM-Signatur f√ºhrt. <br><br>  8-Bit-Zeichen in den Kopfzeilen, einschlie√ülich der Betreffzeile (Betreff) und der Namen der angeh√§ngten Dateien (Inhaltstyp und Inhaltsdisposition), sollten fehlen.  Alle Nicht-ASCII-Zeichen, einschlie√ülich Kyrillisch, m√ºssen in Anf√ºhrungszeichen oder Base64 codiert werden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e25/bc4/a54/e25bc4a54a84fffce6f28d01cf3542f9.png"><br>  (Registrierungsbest√§tigung in seltsamer Codierung) <br><br><a name="18"></a><h3>  Anforderungen an die Struktur der E-Mail </h3><br>  F√ºr den HTML-Teil der E-Mail ist es w√ºnschenswert, einen alternativen Teil (Text) zu bilden.  Es ist auch erforderlich, die Konformit√§t und Lesbarkeit des Klartextteils der E-Mail (falls vorhanden) und die allgemeine Struktur der E-Mail zu √ºberpr√ºfen. <br><br>  Gem√§√ü RFC 5322 sollte die L√§nge einer Zeile in einer E-Mail 998 8-Bit-Zeichen nicht √ºberschreiten.  Bitte beachten Sie, dass in UTF-8 ein Zeichen mehrere Oktette belegen kann.  Der Terminator von Zeilen in einer E-Mail ist ein Paar CRLF (ASCII 13, ASCII 10), das 2 Oktette ben√∂tigt.  Sie m√ºssen die Richtigkeit des String-Terminators √ºberpr√ºfen, da E-Mails h√§ufig mit einem Unix-Skript gesendet werden. Unter Unix besteht der String-Terminator aus einem einzelnen Zeichen. Dies ist ein Fehler f√ºr E-Mails.  Sie sollten auch √ºberpr√ºfen, ob die Zeichenfolgenterminatoren UTF-8-codierte Zeichen unterbrechen: Sie k√∂nnen das Vorhandensein eines Zeichenfolgenterminators zwischen zwei Oktetten desselben Zeichens, z. B. dem kyrillischen Symbol, nicht zulassen.  Um solche Situationen zu vermeiden, muss der Text vor dem Erstellen der E-Mail unterbrochen oder der Text in base64 codiert werden. Base64 hat normalerweise eine feste Zeilenl√§nge. <br><br>  Es ist notwendig, die korrekte Kennzeichnung von Anh√§ngen und Inlines zu √ºberpr√ºfen, dh die Richtigkeit der Bildung der √úberschriften "Inhaltsdisposition: Inline", wenn es sich um ein in der E-Mail angezeigtes Bild handelt, oder "Inhaltsdisposition: Anhang". Wenn die angeh√§ngte Datei zum Download vorgesehen ist. <br><br>  Die Struktur der E-Mail sollte so einfach wie m√∂glich sein: Insbesondere sollte es nicht mehr als einen mehrteiligen Teil jedes Typs geben (gemischt, alternativ, verwandt), und mehrteilig / gemischt wird nur verwendet, wenn die E-Mail Dateianh√§nge enth√§lt, mehrteilig / related - Wenn HTML mit Inline-Bildern geliefert wird, mehrteilig / alternativ - bei Vorhandensein von Klartext und HTML-Teilen.  Im Allgemeinen sollte die Struktur der E-Mail ohne Anh√§nge und Inline-Bilder folgenderma√üen aussehen: <br><br>  mehrteilig / alternativ <br>  - Text / Klartext <br>  - Text / HTML <br><br>  Die Reihenfolge der Teile ist wichtig. Text / Plain muss VOR Text / HTML oder Multipart / Related stehen.  Dies ist erforderlich, damit der HTML-Teil standardm√§√üig angezeigt wird. Nur wenn seine Anzeige aus irgendeinem Grund nicht verf√ºgbar ist, wird der einfache Teil angezeigt. <br><br>  Wenn die E-Mail Inline-Bilder enth√§lt, sollte ihre Struktur folgenderma√üen aussehen: <br><br>  mehrteilig / alternativ <br>  - Text / Klartext <br>  - mehrteilig / verwandt <br>  ‚Äî‚Äî Text / HTML <br>  ‚Äî‚Äî Bild / ... (Inline-Bild) <br>  ‚Äî‚Äî Bild / ... (Inline-Bild) <br><br>  Inline-Bilder m√ºssen Content-Disposition: Inline haben und sich ausschlie√ülich innerhalb des mehrteiligen / verwandten Teils befinden. <br>  Im schwierigsten Fall, wenn sowohl Inline-Bilder als auch angeh√§ngte Dateien vorhanden sind, hat die E-Mail die folgende Struktur: <br><br>  mehrteilig / gemischt <br>  - mehrteilig / alternativ <br>  ‚Äî‚Äî Text / Klartext <br>  ‚Äî‚Äî mehrteilig / verwandt <br>  ‚Äî‚Äî‚Äî Text / HTML <br>  ‚Äî‚Äî‚Äî image / png <br>  ‚Äî‚Äî‚Äî image / png <br>  ... <br>  - application / octet-string (Inhaltsdisposition: Anhang) <br>  - application / octet-string (Inhaltsdisposition: Anhang) <br>  ... <br>  mehrteilige verwandte und mehrteilige / alternative Teile m√ºssen vor Anh√§ngen geschlossen werden, Anh√§nge geh√∂ren zum externen mehrteiligen / gemischten Teil) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/944/23a/506/94423a506f8f81b02314ff4dc8d76385.png"><br>  (Registrierungsmeldung mit falscher Teilestruktur) <br><br><a name="19"></a><h2>  URI-Anforderungen </h2><br><br>  Alle URIs (in src, href-Attributen, Stilen usw.) m√ºssen das Protokoll und den Hostnamen (https://example.com/somepath) enthalten.  Typische Fehler sind die Verwendung relativer Links (/ somepath) und das Fehlen eines Protokolls (//example.com/somepath), was f√ºr E-Mails nicht akzeptabel ist, da in diesen das Standardprotokoll m√∂glicherweise <code>file://</code> lautet. <br><br><ul><li>  Alle Dienst- und Nicht-ASCII-Zeichen (insbesondere kyrillisch) in der URI m√ºssen mit Prozentcodierung codiert werden. <br></li><li>  Ein als Text eingef√ºgter Link (dh f√ºr den Benutzer als URL und nicht als Text sichtbar) sollte weiterhin mit dem Tag <code>&lt;&gt;</code> , da der Benutzer sonst nicht darauf klicken kann.  Einige Webmails markieren solche Links selbst, dies ist jedoch kein Standardverhalten.  In diesem Fall muss die href-Adresse in A mit dem Linktext √ºbereinstimmen. Andernfalls reagiert der Inhaltsfilter m√∂glicherweise auf einen solchen Link, um den Benutzer zu t√§uschen.  Dies ist besonders dann zu beachten, wenn es "Clicker" gibt, die die √úberg√§nge des Benutzers von der E-Mail verfolgen. <br></li><li>  Es ist besser, sich auf die Verwendung der Protokolle <code>http://</code> , <code>https://</code> und <code>mailto:</code> <br></li><li>  Bei hohen Sicherheitsanforderungen sollten Sie die Verwendung von <code>http://</code> zugunsten von <code>https://</code> vollst√§ndig aufgeben. <br></li><li>  Nicht standardm√§√üige Ports sollten nicht verwendet werden (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">example.com</a> : 8080 / somepath), da sie f√ºr den Benutzer m√∂glicherweise nicht zug√§nglich sind. <br></li><li>  Das Klicken auf den Link im HTML-Teil sollte ohne zus√§tzliche Best√§tigung durch den Benutzer auf der Seite nicht zu √Ñnderungen des Status der Anwendung (Abonnement, Abbestellen, Stornierung der Bestellung usw.) f√ºhren, da einige Inhaltsfiltersysteme dies unabh√§ngig voneinander tun k√∂nnen √úberpr√ºfen Sie die Sicherheit eines solchen √úbergangs, indem Sie eine Referenzseite anfordern.  Die E-Mail-Anwendung kann die Vorschau der Seite √ºber den Link beim Hover anzeigen, und moderne Browser k√∂nnen die Seite laden, bevor der Benutzer auf den Link klickt, um die Ladezeit zu verk√ºrzen (in der Webanwendung wird im Allgemeinen nicht empfohlen, √Ñnderungsaktionen f√ºr die Seite durchzuf√ºhren GET-Anforderung, alle √Ñnderungsanforderungen m√ºssen POST oder PUT durchlaufen. <br></li><li>  Das Klicken auf den Link im Header "List-Unsubscribe" sollte im Gegensatz dazu keine zus√§tzlichen Aktionen des Benutzers erfordern, da das Abbestellen √ºber diesen Link normalerweise per E-Mail-Programm oder Webmail im Namen des Benutzers erfolgt.  Au√üerdem gibt es einen neuen Header List-Unsubscribe-Post, der von RFC 8058 eingef√ºhrt wurde. <br></li><li>  Sie sollten nicht erwarten, dass der Benutzer die E-Mail liest und dem Link in demselben Browser folgt, in dem er die Aktion initiiert, die zum Senden der E-Mail f√ºhrt (z. B. ein Konto registriert).  Der Link sollte in jedem anderen Browser oder Mobilger√§t funktionieren.  Insbesondere kann der Benutzer den Link √∂ffnen, ohne autorisiert zu sein oder in einem anderen Konto als dem, an das die E-Mail gesendet wurde. <br></li><li>  Weil die L√§nge des URI begrenzt werden kann;  Sie sollten f√ºr gro√üe Objekte keine URIs vom Typ 'data:' verwenden.  Verwenden Sie aus demselben Grund keine URIs, die in Hyperlinks zu lang sind. <br></li><li>  Sie d√ºrfen keine externen Link-Shortener verwenden. Dies wirkt sich negativ auf die Zustellung von E-Mails aus.  Es ist besser, wenn alle Links auf Ihre Domain verweisen. Dadurch werden die potenziellen negativen Auswirkungen des Rufs einer anderen Person auf die Zustellung von E-Mails verringert. <br></li><li>  Platzieren Sie keine externen Bilder auf √∂ffentlichen Diensten oder kostenlosem Hosting, verwenden Sie keinen zuverl√§ssigen Hosting-Service oder CDN mit guter Leistung und gutem Ruf. <br></li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/05a/afd/4b3/05aafd4b3ef1a07a9654a92fc0419b32.png"><br>  (ung√ºltiger Bild- und Anker-URI aufgrund fehlender Protokollspezifikation) <br><br><a name="20"></a><h2>  Anforderungen an das E-Mail-Layout </h2><br>  Warum ist es so schwierig, E-Mails zu erstellen? <br><br>  E-Mail-Clients zeigen auf die eine oder andere Weise Benutzerinhalte in ihrer Benutzeroberfl√§che an.  Dies kann m√∂glicherweise zu verschiedenen Sicherheitsproblemen f√ºhren - Cross-Site-Scripting (XSS, Crossite-Scripting), Schnittstellen-Spoofing, DOM-Clobbering, Benutzer-Deanonymisierung / Informationsverlust (z. B. IP-Adresse des Benutzers oder Cookies durch externe Anforderungen) usw.  Daher hat jeder Mail-Dienst und jede Mail-Anwendung einen gewissen Schutz gegen jede Angriffsklasse.  Leider gibt es keinen einheitlichen Ansatz f√ºr die Organisation dieses Schutzes.  Es kann organisiert werden durch: <br><br><ul><li>  isolierte begrenzte Rahmen, <br></li><li>  Filtern von Tags und / oder Attributen, <br></li><li>  Einschr√§nkungen der absoluten Positionierung, <br></li><li>  Verbot oder Einschr√§nkung der Verwendung von Blockstilen (was f√ºr das adaptive Layout von entscheidender Bedeutung ist), <br></li><li>  Das standardm√§√üige Sperren externer Elemente (dh das Herunterladen externer Bilder erfordert eine Benutzererlaubnis) oder das Verwenden eines Proxys, um auf sie zuzugreifen. <br></li><li>  Konvertieren von HTML-E-Mails in ein anderes Zwischenformat (z. B. verwendet Microsoft Exchange / Outlook RTF, was es √§u√üerst schwierig machen kann, Elemente in Outlook mit herk√∂mmlichen Methoden ordnungsgem√§√ü anzuzeigen). <br></li><li>  Verbot oder Einschr√§nkung der Verwendung von Formularen oder deren einzelnen Elementen. <br></li></ul><br>  Die E-Mails verwenden auch bestimmte Elemente wie Inline-Bilder und URI <code>cid://</code> , deren Unterst√ºtzung m√∂glicherweise eingeschr√§nkt ist.  Beispielsweise unterst√ºtzt Mozilla Thunderbird <code>cid://</code> f√ºr Hintergrundbilder nicht. <br><br>  Sogar eine korrekt geformte E-Mail kann aufgrund der Besonderheiten ihrer Implementierung und Filterung des Inhalts der E-Mail in verschiedenen Benutzeroberfl√§chen unterschiedlich angezeigt werden. <br><br>  Wenn das E-Mail-Format fehlerhaft ist, ist das Verhalten v√∂llig unvorhersehbar.  Beispielsweise k√∂nnen E-Mail-Clients ein anderes Verhalten mit falschen URIs aufweisen oder die falsche Header-Formatierung wird anders behandelt.  Die automatische Erkennung der Textcodierung funktioniert auch anders, wenn sie nicht oder falsch angegeben ist.  Daher muss die E-Mail in verschiedenen Benutzeroberfl√§chen angezeigt werden: Die korrekte Anzeige der E-Mail in einer Benutzeroberfl√§che bedeutet nicht, dass sie korrekt zusammengesetzt ist (selbst die korrekte Anzeige der E-Mail in allen Benutzeroberfl√§chen garantiert nicht, dass keine vorhanden ist Probleme mit der Anzeige in der Zukunft). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b5/127/114/9b512711407c1cac545a57fd629d6b1a.png"><br><br>  Folgende Punkte sind zu beachten: <br><br><ul><li>  √úberpr√ºfen Sie den Text der E-Mail auf semantischen Inhalt, Anzeige, Fehlen von Tippfehlern, syntaktischen, Rechtschreib- und lexikalischen Fehlern. <br></li><li>  √úberpr√ºfen Sie die Richtigkeit der Ersetzung der Anwendungsdaten in der Vorlage oder im Layout der E-Mail. <br></li><li>  √úberpr√ºfen Sie die Richtigkeit der Mengen, Daten, Zahlen, Waren und sonstigen Angaben unter Ber√ºcksichtigung der zul√§ssigen Randbedingungen.  Die Daten sollten ein Jahr haben (einige Benutzer geben das Feld sehr selten ein).  Eine Zeitzone muss rechtzeitig vorhanden sein.  Die Adresse muss eine Stadt enthalten, und in einigen F√§llen muss das Land angegeben werden. <br></li><li>  √úberpr√ºfen Sie gegebenenfalls den Betriebsstatus aller Links in der E-Mail. <br></li><li>  In E-Mails, die vor Best√§tigung der Adresse verschickt wurden, inkl.  E-Mails mit einem Best√§tigungslink, es sollte kein von au√üen kontrollierter Text vorhanden sein, auch nicht der Benutzername. Andernfalls <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">k√∂nnen sie f√ºr Spam verwendet werden</a> (in dem in der E-Mail angezeigten Feld, z. B. im Namen, wird Spam-Text eingef√ºgt und Die Adresse ist die angegebene Adresse des Opfers.  Wenn Sie beispielsweise im Namen Ihres Dienstes einen obsz√∂nen Text an die Adresse des Entwicklers senden k√∂nnen, liegt ein Problem vor. <br></li><li>  √úberpr√ºfen Sie, ob externe Dienste in Diensten von Drittanbietern fehlen.  Dies kann sich auf die Lieferung auswirken und Informationen √ºber Ihre Kunden preisgeben. <br></li><li>  √úberpr√ºfen Sie die Verf√ºgbarkeit von Z√§hlern zum Senden, Zustellen, Lesen von E-Mails und √úberg√§ngen.  Einige von ihnen befinden sich in der E-Mail selbst (z. B. das Gegenpixel zum Lesen der E-Mail), andere werden vom Mailer verfolgt, aber in der Regel sind alle im Admin-Bereich des Mailers verf√ºgbar. <br></li><li>  √úberpr√ºfen Sie die Richtigkeit der Abonnementkategorie und die Abmeldung des Benutzers f√ºr diese Kategorie √ºber den Link in der E-Mail. <br></li><li>  √úberpr√ºfen Sie, wie die E-Mail aussieht: <br><ul><li>  Beliebte Webversionen von E-Mails f√ºr ein Zielland: Die "gro√üen Drei" f√ºr Russland sind Mail.Ru, Yandex, Gmail.  Sie k√∂nnen auch Rambler und Outlook.com hinzuf√ºgen. <br></li><li>  Mobile Anwendungen der oben genannten E-Mail-Anbieter; <br></li><li>  Standardm√§√üige mobile Anwendungen mit IMAP unter Ber√ºcksichtigung beliebter mobiler Plattformen f√ºr mindestens iPhone, Pixel (Android-Referenzplattform), Samsung (am h√§ufigsten f√ºr Android) und MIUI (belegt in Russland den zweiten Platz f√ºr Android-Plattformen); <br></li><li>  Verschiedene Desktop-Browser: Chrome, Firefox, Edge, Internet Explorer, Opera usw.; <br></li><li>  Desktop-Anwendungen (E-Mail-Programme), insbesondere Thunderbird, Outlook und Apple Mail, optional The Bat!  und Opera Mail; <br></li><li>  Beliebte Unternehmensl√∂sungen mit einer Weboberfl√§che (Exchange, m√∂glicherweise Roundcube, Communigate, Zimbra, SquirrelMail) - f√ºr B2B-L√∂sungen; <br></li><li>  Vergessen Sie nicht, das Layout sowohl auf Retina-Monitoren als auch auf Monitoren mit niedrigerer Aufl√∂sung zu √ºberpr√ºfen. <br></li></ul></li><li>  Bei der Pr√ºfung m√ºssen Sie jeweils Folgendes beachten: <br><ul><li>  √úbergeben der Berechtigungsheader SPF / DKIM / DMARC. <br></li><li>  E-Mail-Download-Geschwindigkeit: Es sollte schnell geladen werden und nicht seine Zeit in Anspruch nehmen. <br></li><li>  Anzeigen einer E-Mail in der Liste der E-Mails: Avatar, Name des Absenders und Betreff, der in das Snippet der Nachricht f√§llt, ob die Kategorie korrekt definiert wurde (z. B. wenn die Reihenfolge nicht in die Kategorie "Soziale Netzwerke" f√§llt). <br></li><li>  Das Layout der E-Mail als Ganzes: Wenn das Layout konsistent blieb, gab es falsche Wortumbr√ºche usw., auch beim Skalieren und √Ñndern der Fenstergr√∂√üe. <br></li><li>  Schriftarten sollten nicht klein oder schwer lesbar sein. <br></li><li>  Hintergrundbilder und Hintergrundfarben. <br></li><li>  Passend zum Markenbuch. <br></li><li>  Einfache Ausf√ºhrung der in der E-Mail implizierten Aktionen.  Wenn die E-Mail beispielsweise einen Best√§tigungscode oder andere Informationen enth√§lt, die m√∂glicherweise irgendwo gespeichert werden m√ºssen, sollte sie nicht nur gut gelesen, sondern auch bequem in der mobilen Oberfl√§che ausgew√§hlt und kopiert werden k√∂nnen. <br></li></ul><br></li><li>  Behalten Sie die Gesamtgr√∂√üe der E-Mail (einschlie√ülich externer Bilder) im Auge und achten Sie darauf, dass sie vern√ºnftige Werte nicht √ºberschreitet.  Je l√§nger die Ladezeit ist, desto wahrscheinlicher ist es, dass eine Person negativ darauf reagiert. <br></li><li>  Sogar E-Mails, die nicht ge√§ndert wurden, sollten regelm√§√üig √ºberpr√ºft werden, da √Ñnderungen auf der Seite des Postdienstes auftreten k√∂nnen und beispielsweise ein zuvor unsichtbares Problem "aufdecken". <br></li><li>  Einige Parameter m√ºssen in allen Tests kontrolliert werden.  Beispielsweise k√∂nnen Probleme beim √úbergeben der DKIM-Authentifizierung auf Probleme in der Infrastruktur (Probleme mit DNS oder die Bildung einer DKIM-Signatur, Zeitsynchronisationsfehler) sowie auf Fehler im Generierungsprogramm zur√ºckzuf√ºhren sein (Absenderadresse ist falsch gebildet, falsche Zeichen in Die Header fehlen oder sind obligatorisch. Von-, Datums- oder Nachrichten-ID-Header wurden dupliziert.) und aufgrund von Inhaltsfehlern (falsche Zeilenabschlusszeichen, zu lange Zeilen, falsche Adressen).  Gleichzeitig wird die E-Mail m√∂glicherweise nicht "geschlagen", und das Problem tritt m√∂glicherweise bei keinem Dienst auf. <br></li></ul><br><a name="21"></a><h2>  Split-Tests durchf√ºhren </h2><br>  Marktforschung geht √ºber den Rahmen dieses Artikels hinaus, es sollten jedoch einige wichtige Punkte erw√§hnt werden, die die Qualit√§t von E-Mails erheblich beeinflussen. <br><br> The newsletter has a purpose, so it should entail through its quality, not quantity (which is the opposite for spammers). The newsletter must be segmented. When conducting an advertising campaign, you need to know exactly who gets into the segment sample, why they need the offered product and what they want to convey. <br><br> For each mailing list, it is necessary to calculate the CTR of the list of emails ‚Äî this is the ratio of the number of emails read to the total number that has been sent out. In postmaster.mail.ru, you can see indicators for unique users. If the measurement goes through the counter in the email (pixel), then the absolute number of openings is estimated. CTR &lt;10% is a very low indicator, it is undesirable to carry out such mailing. It should strive for a CTR&gt; 30%. For marketing emails, the clickthrough rate of clickthroughs and the percentage of completed actions (¬´sales¬ª) on these links are also of great importance. Be sure to monitor complaints (marking the email as spam). Typically, for one-time mailings, a tenth of a percent is a good indicator, for regular ones, a hundredth of a percent. The critical values, after which the mailing is always interpreted as spam, are indicated here: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://help.mail.ru/developers/mailing_rules/technical</a> . <br><br> It is necessary to conduct split testing of various distribution options to obtain optimal performance. Just changing the name of the sender and the subject of the email can increase the CTR by several times and significantly reduce the number of complaints. The number of emails should be statistically significant for evaluating the results (for large projects, usually a few thousand). The final version of the email is sent in several stages for additional measurement of indicators and ¬´warming up¬ª ‚Äî starting with about 10,000 recipients, with an increase of about an order of the day. <br><br> The main idea: emails are part of your application, perhaps one of the most complex and problematic. At the same time, this is often a ¬´blind spot¬ª in terms of testing. I hope that I was able to draw your attention to this issue. <br><br> I would like to thank Vladimir Dubrovin ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">z3apa3a</a> ) and Alena Likhacheva ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">s4ever</a> ) for helping me with this article. As well as that, the article utilised sources of Eduard Tyantov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">edT</a> ) and Alexander Purtov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">4Alexander</a> ). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de464515/">https://habr.com/ru/post/de464515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de464499/index.html">"Mat. Wall Street-Modell ‚Äúoder ein Versuch, die Kosten der Cloud-IT-Infrastruktur zu optimieren</a></li>
<li><a href="../de464503/index.html">Wi-Fi Passwort passend zu aircrack-ng</a></li>
<li><a href="../de464509/index.html">Das Buch "Grok Deep Learning"</a></li>
<li><a href="../de464511/index.html">So sammeln Sie Benutzerkohorten in Form von Grafiken in Grafana [+ Docker-Bild mit einem Beispiel]</a></li>
<li><a href="../de464513/index.html">Duffle: Transformator von XD Design</a></li>
<li><a href="../de464517/index.html">Neue KUBA-Karten</a></li>
<li><a href="../de464523/index.html">Zahlungssysteme (PSP) f√ºr das IT-Gesch√§ft: Wir spielen gro√ü</a></li>
<li><a href="../de464525/index.html">Ihr eigener JSON-Konverter oder etwas mehr √ºber ExpressionTrees</a></li>
<li><a href="../de464529/index.html">F√ºr kontextbezogene Werbung mit den Namen von Wettbewerbern k√∂nnen jetzt 500.000 Rubel bestraft werden</a></li>
<li><a href="../de464535/index.html">Details zum Ger√§t und zu den Funktionen des KickScooter T60 Elektrorollers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>