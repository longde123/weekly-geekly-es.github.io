<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♌️ 🦈 🤰🏽 Belajar Docker, Bagian 3: File Dockerfile 👨🏿‍🤝‍👨🏼 🐽 🕣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam terjemahan bagian ketiga dari seri Docker, kami akan terus terinspirasi oleh kue kering, yaitu bagel. Topik utama kami hari ini adalah bekerja d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Belajar Docker, Bagian 3: File Dockerfile</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/439980/">  Dalam terjemahan bagian ketiga dari seri Docker, kami akan terus terinspirasi oleh kue kering, yaitu bagel.  Topik utama kami hari ini adalah bekerja dengan Dockerfiles.  Kami akan menganalisis instruksi yang digunakan dalam file-file ini. <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 1: dasar-dasarnya</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2: istilah dan konsep</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 3: File Dockerfile</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 4: mengurangi ukuran gambar dan mempercepat perakitannya</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 5: tim</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 6: bekerja dengan data</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/29b/15a/6bf/29b15a6bfff06c617017301b30ed95c2.jpg"></div><br>  <i><font color="#999999">Bagel adalah instruksi di Dockerfile.</font></i> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Gambar Docker</font> </h2><br>  Ingatlah bahwa wadah Docker adalah gambar Docker yang hidup.  Ini adalah sistem operasi mandiri di mana hanya ada kode aplikasi dan yang paling diperlukan. <br><br>  Gambar Docker adalah hasil dari proses pembangunan, dan wadah Docker menjalankan gambar.  Di jantung Docker adalah Dockerfiles.  File seperti ini memberi tahu Docker cara merakit gambar dari mana wadah dibuat. <br><br>  Setiap gambar Docker memiliki file yang disebut Dockerfile.  Namanya ditulis seperti itu - tanpa ekstensi.  Ketika Anda menjalankan <code>docker build</code> untuk membuat gambar baru, diasumsikan bahwa Dockerfile ada di direktori kerja saat ini.  Jika file ini terletak di beberapa tempat lain, lokasinya dapat ditentukan menggunakan flag <code>-f</code> . <br><br>  Wadah, seperti yang kami temukan di bahan pertama seri ini, terdiri dari lapisan.  Setiap lapisan, kecuali yang terakhir, yang terletak di atas yang lain, adalah read-only.  Dockerfile memberi tahu sistem Docker yang berlapis-lapis dan bagaimana agar ditambahkan ke gambar. <br><br>  Setiap lapisan, pada kenyataannya, hanyalah sebuah file yang menjelaskan perubahan dalam keadaan gambar dibandingkan dengan keadaan di mana ia setelah menambahkan lapisan sebelumnya.  Pada Unix, omong-omong, hampir semua hal adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">file</a> . <br><br>  Gambar dasar adalah apa layer sumber (atau lapisan) dari gambar yang sedang dibuat.  Gambar dasar juga disebut gambar induk. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a0/b89/6aa/6a0b896aa35c1f735103ae8924d5371d.jpg"></div><br>  <i><font color="#999999">Gambar dasar adalah tempat gambar Docker dimulai.</font></i> <br><br>  Ketika gambar diunduh dari repositori jarak jauh ke komputer lokal, hanya lapisan yang tidak tersedia di komputer ini yang diunduh secara fisik.  Docker bertujuan untuk menghemat ruang dan waktu dengan menggunakan kembali lapisan yang ada. <br><br><h2>  <font color="#3AC1EF">File Dockerfile</font> </h2><br>  Dockerfiles berisi instruksi untuk membuat gambar.  Dalam huruf kapital, baris file ini dimulai.  Mengikuti instruksi adalah argumen mereka.  Instruksi, ketika membangun gambar, diproses dari atas ke bawah.  Begini tampilannya: <br><br><pre> <code class="plaintext hljs">FROM ubuntu:18.04 COPY . /app</code> </pre> <br>  Lapisan pada gambar akhir hanya dibuat oleh <code>FROM</code> , <code>RUN</code> , <code>COPY</code> , dan <code>ADD</code> .  Instruksi lain mengatur sesuatu, menjelaskan metadata, atau memberi tahu Docker bahwa Anda perlu melakukan sesuatu selama pelaksanaan wadah, misalnya, membuka beberapa port atau menjalankan beberapa perintah. <br><br>  Di sini kita melanjutkan dari asumsi bahwa gambar Docker berdasarkan OS mirip Unix digunakan.  Tentu saja, di sini Anda juga dapat menggunakan gambar berbasis Windows, tetapi menggunakan Windows adalah praktik yang kurang umum, bekerja dengan gambar seperti itu lebih sulit.  Akibatnya, jika Anda memiliki kesempatan, gunakan Unix. <br><br>  Untuk memulai, berikut adalah daftar instruksi Dockerfile dengan komentar singkat. <br><br><h2>  <font color="#3AC1EF">Instruksi Dozen Dockerfile</font> </h2><br><ol><li>  <code>FROM</code> - mengatur gambar dasar (induk). </li><li>  <code>LABEL</code> - menjelaskan metadata.  Misalnya, informasi tentang siapa yang membuat dan memelihara gambar. </li><li>  <code>ENV</code> - menetapkan variabel lingkungan persisten. </li><li>  <code>RUN</code> - mengeksekusi perintah dan membuat layer gambar.  Digunakan untuk menginstal paket dalam wadah. </li><li>  <code>COPY</code> - menyalin file dan folder ke wadah. </li><li>  <code>ADD</code> - menyalin file dan folder ke sebuah wadah, dapat membongkar file .tar lokal. </li><li>  <code>CMD</code> - menguraikan perintah dengan argumen yang perlu dijalankan ketika wadah diluncurkan.  Argumen dapat ditimpa ketika wadah dimulai.  File hanya dapat berisi satu instruksi <code>CMD</code> . </li><li>  <code>WORKDIR</code> - mengatur direktori kerja untuk instruksi selanjutnya. </li><li>  <code>ARG</code> - set variabel untuk melewati Docker selama pembuatan gambar. </li><li>  <code>ENTRYPOINT</code> - Menyediakan perintah dengan argumen untuk dipanggil selama eksekusi kontainer.  Argumen tidak ditimpa. </li><li>  <code>EXPOSE</code> - menunjukkan perlunya membuka port. </li><li>  <code>VOLUME</code> - membuat titik mount untuk bekerja dengan penyimpanan persisten. </li></ol><br>  Sekarang mari kita bicara tentang instruksi ini. <br><br><h2>  <font color="#3AC1EF">Instruksi dan contoh penggunaannya</font> </h2><br><h3>  <font color="#3AC1EF">DockSederhana Dockerfile</font> </h3><br>  Dockerfile bisa sangat sederhana dan pendek.  Misalnya - seperti ini: <br><br><pre> <code class="plaintext hljs">FROM ubuntu:18.04</code> </pre> <br><h3>  <font color="#3AC1EF">InstructionDari instruksi</font> </h3><br>  Dockerfile harus dimulai dengan pernyataan <code>FROM</code> , atau dengan pernyataan <code>ARG</code> diikuti oleh pernyataan <code>FROM</code> . <br><br>  Kata kunci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FROM</a> memberi tahu Docker untuk menggunakan gambar dasar yang cocok dengan nama dan tag yang disediakan saat membuat gambar.  Gambar dasar, di samping itu, juga disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gambar induk</a> . <br><br>  Dalam contoh ini, gambar dasar disimpan di repositori <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ubuntu</a> .  Ubuntu adalah nama repositori Docker resmi, yang menyediakan versi dasar dari keluarga Linux yang populer dengan sistem operasi yang disebut Ubuntu. <br><br>  Harap perhatikan bahwa Dockerfile yang dimaksud menyertakan tag <code>18.04</code> yang menentukan gambar dasar mana yang kami butuhkan.  Gambar inilah yang akan dimuat saat membangun gambar kita.  Jika tag tidak termasuk dalam instruksi, maka Docker melanjutkan dari asumsi bahwa gambar terbaru dari repositori diperlukan.  Untuk mengekspresikan maksud mereka dengan lebih jelas, disarankan agar penulis Dockerfile menunjukkan gambar mana yang dia butuhkan. <br><br>  Ketika Dockerfile di atas digunakan pada mesin lokal untuk membangun gambar untuk pertama kalinya, Docker akan memuat lapisan yang ditentukan oleh gambar <code>ubuntu</code> .  Mereka dapat dibayangkan saling tumpang tindih.  Setiap lapisan berikutnya adalah file yang menggambarkan perbedaan gambar dibandingkan dengan keadaan di mana ia setelah menambahkan lapisan sebelumnya. <br><br>  Saat Anda membuat sebuah wadah, sebuah lapisan tempat Anda dapat membuat perubahan ditambahkan di atas semua lapisan lainnya.  Data di lapisan yang tersisa hanya bisa dibaca. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/912/530/d4f/912530d4f3468f0bff2a064d58d62caf.jpg"></div><br>  <i><font color="#999999">Struktur wadah (diambil dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> )</font></i> <br><br>  Docker, demi efisiensi, menggunakan strategi copy-on-write.  Jika lapisan dalam gambar ada di tingkat sebelumnya dan beberapa lapisan perlu membaca data darinya, Docker menggunakan file yang ada.  Anda tidak perlu mengunduh apa pun. <br><br>  Ketika gambar dieksekusi, jika layer perlu dimodifikasi dengan menggunakan wadah, maka file yang sesuai disalin ke lapisan paling atas, bisa berubah.  Untuk mempelajari lebih lanjut tentang strategi copy-on-write, lihat materi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> dari dokumentasi Docker. <br><br>  Kami melanjutkan diskusi tentang instruksi yang digunakan di Dockerfile, memberikan contoh file seperti itu dengan struktur yang lebih kompleks. <br><br><h3>  <font color="#3AC1EF">▍Lebih banyak buruh pelabuhan yang canggih</font> </h3><br>  Meskipun Dockerfile yang baru saja kami ulas ternyata rapi dan dapat dimengerti, itu terlalu sederhana, ia hanya menggunakan satu instruksi.  Selain itu, tidak ada instruksi yang dipanggil selama eksekusi kontainer.  Lihatlah file lain yang mengumpulkan gambar kecil.  Ini memiliki mekanisme yang menentukan perintah yang dipanggil selama pelaksanaan wadah. <br><br><pre> <code class="plaintext hljs">FROM python:3.7.2-alpine3.8 LABEL maintainer="jeffmshale@gmail.com" ENV ADMIN="jeff" RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add bash COPY . ./app ADD https://raw.githubusercontent.com/discdiver/pachy-vid/master/sample_vids/vid1.mp4 \ /my_app_directory RUN ["mkdir", "/a_directory"] CMD ["python", "./my_script.py"]</code> </pre> <br>  Mungkin sekilas file ini mungkin terlihat agak rumit.  Karena itu, mari kita hadapi dia. <br><br>  Basis gambar ini adalah gambar Python resmi dengan tag 3.7.2-alpine3.8.  Setelah menganalisis kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> , Anda dapat melihat bahwa gambar dasar ini termasuk Linux, Python, dan pada umumnya, ini terbatas pada komposisinya.  Gambar Alpine OS sangat populer di dunia Docker.  Fakta bahwa mereka berukuran kecil, kecepatan tinggi dan aman.  Namun, gambar Alpine tidak berbeda dalam kemampuan luas khas sistem operasi konvensional.  Oleh karena itu, untuk mengumpulkan sesuatu yang berguna berdasarkan gambar seperti itu, pencipta gambar perlu menginstal paket yang dibutuhkannya. <br><br><h3>  <font color="#3AC1EF">▍ LABEL instruksi</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/839/d5d/720/839d5d7205849f8dee228dcd7a42eaf7.jpg"></div><br>  <i><font color="#999999">Tag</font></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pernyataan LABEL</a> (label) memungkinkan Anda untuk menambahkan metadata ke gambar.  Dalam kasus file yang sedang dipertimbangkan sekarang, itu termasuk informasi kontak pencipta gambar.  Mendeklarasikan label tidak memperlambat proses perakitan gambar atau meningkatkan ukurannya.  Mereka hanya berisi informasi berguna tentang gambar Docker, jadi disarankan agar mereka dimasukkan dalam file.  Detail tentang bekerja dengan metadata di Dockerfile dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br><h3>  <font color="#3AC1EF">InstructionInv instruksi</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d85/1a1/4d7/d851a14d7b7f4db671afe3b375cb4596.jpg"></div><br>  <i><font color="#999999">Lingkungan</font></i> <br><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ENV</a> memungkinkan Anda untuk mengatur variabel lingkungan konstan yang akan tersedia dalam wadah selama eksekusi.  Pada contoh sebelumnya, setelah membuat wadah, Anda bisa menggunakan variabel <code>ADMIN</code> . <br><br>  Instruksi <code>ENV</code> sangat cocok untuk menetapkan konstanta.  Jika Anda menggunakan nilai tertentu di Dockerfile beberapa kali, katakanlah, ketika mendeskripsikan perintah yang dieksekusi dalam wadah, dan menduga bahwa suatu hari Anda mungkin harus mengubahnya ke yang lain, masuk akal untuk menulisnya ke konstanta yang sama. <br><br>  Perlu dicatat bahwa dalam file Dockerfile sering ada berbagai cara untuk menyelesaikan masalah yang sama.  Apa sebenarnya yang digunakan adalah pertanyaan, keputusan yang dipengaruhi oleh keinginan untuk mematuhi metode kerja yang diadopsi di lingkungan Docker, untuk memastikan transparansi solusi dan kinerjanya yang tinggi.  Misalnya, <code>ENTRYPOINT</code> <code>RUN</code> , <code>CMD</code> dan <code>ENTRYPOINT</code> melayani tujuan yang berbeda, tetapi semuanya digunakan untuk menjalankan perintah. <br><br><h3>  <font color="#3AC1EF">Instruksi ▍RUN</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/910/a89/72b/910a8972b92a69418d859a1fbd550ae5.jpg"></div><br>  <i><font color="#999999">Instruksi RUN</font></i> <br><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RUN</a> memungkinkan Anda membuat layer selama pembuatan gambar.  Setelah eksekusi, layer baru ditambahkan ke gambar, statusnya diperbaiki.  Instruksi <code>RUN</code> sering digunakan untuk menginstal paket tambahan dalam gambar.  Dalam contoh sebelumnya, pernyataan <code>RUN apk update &amp;&amp; apk upgrade</code> pernyataan <code>RUN apk update &amp;&amp; apk upgrade</code> memberitahu Docker bahwa sistem perlu memperbarui paket dari gambar dasar.  Mengikuti kedua perintah ini adalah perintah <code>&amp;&amp; apk add bash</code> , yang menunjukkan bahwa bash perlu diinstal pada gambar. <br><br>  Apa yang tampak seperti <code>apk</code> dalam tim adalah singkatan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">manajer paket Alpine Linux</a> .  Jika Anda menggunakan gambar dasar dari beberapa OS keluarga Linux lainnya, maka, misalnya, ketika menggunakan Ubuntu, Anda mungkin memerlukan perintah dari form <code>RUN apt-get</code> untuk menginstal paket.  Nanti kita akan berbicara tentang cara-cara lain untuk menginstal paket. <br><br>  Instruksi <code>RUN</code> dan instruksi serupa, seperti <code>CMD</code> dan <code>ENTRYPOINT</code> , dapat digunakan baik dalam bentuk exec atau dalam bentuk shell.  Bentuk exec menggunakan sintaks yang menyerupai deskripsi array JSON.  Misalnya, mungkin terlihat seperti ini: <code>RUN ["my_executable", "my_first_param1", "my_second_param2"]</code> . <br><br>  Pada contoh sebelumnya, kami menggunakan form shell dari instruksi RUN sebagai berikut: <code>RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add bash</code> . <br><br>  Kemudian di Dockerfile kami, kami menggunakan formulir exec dari instruksi <code>RUN</code> , dalam bentuk <code>RUN ["mkdir", "/a_directory"]</code> untuk membuat direktori.  Pada saat yang sama, menggunakan instruksi dalam formulir ini, Anda harus mengingat kebutuhan untuk memformat string dengan tanda kutip ganda, seperti yang biasa dalam format JSON. <br><br><h3>  <font color="#3AC1EF">▍ Instruksi SALINAN</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ba/8b7/b82/5ba8b7b82e09854f7ba3ac1d2ad5b404.jpg"></div><br>  <i><font color="#999999">Instruksi COPY</font></i> <br><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">COPY</a> disajikan dalam file kami seperti ini: <code>COPY . ./app</code>  <code>COPY . ./app</code> .  Dia memberi tahu Docker bahwa dia harus mengambil file dan folder dari konteks lokal perakitan dan menambahkannya ke direktori kerja gambar saat ini.  Jika direktori tujuan tidak ada, instruksi ini akan membuatnya. <br><br><h3>  <font color="#3AC1EF">▍ Masukkan instruksi</font> </h3><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ADD</a> memungkinkan Anda untuk memecahkan masalah yang sama seperti <code>COPY</code> , tetapi beberapa <code>COPY</code> penggunaan lebih terkait dengan itu.  Jadi, dengan menggunakan instruksi ini, Anda dapat menambahkan file yang diunduh dari sumber jarak jauh ke wadah, serta membongkar file .tar lokal. <br><br>  Dalam contoh ini, instruksi <code>ADD</code> digunakan untuk menyalin file yang dapat diakses URL ke <code>my_app_directory</code> wadah <code>my_app_directory</code> .  Perlu dicatat, bagaimanapun, bahwa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi Docker</a> tidak merekomendasikan penggunaan file-file tersebut yang diperoleh dengan URL, karena mereka tidak dapat dihapus, dan karena mereka meningkatkan ukuran gambar. <br><br>  Selain itu, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> menyarankan, sedapat mungkin, bahwa Anda menggunakan pernyataan <code>COPY</code> alih-alih pernyataan <code>ADD</code> untuk membuat Dockerfile lebih mudah dimengerti.  Saya percaya tim pengembangan Docker harus menggabungkan <code>ADD</code> dan <code>COPY</code> menjadi satu instruksi sehingga mereka yang membuat gambar tidak harus mengingat terlalu banyak instruksi. <br><br>  Perhatikan bahwa pernyataan <code>ADD</code> berisi karakter pemisah baris - <code>\</code> .  Karakter tersebut digunakan untuk meningkatkan keterbacaan perintah panjang dengan memecahnya menjadi beberapa baris. <br><br><h3>  <font color="#3AC1EF">▍ instruksi CMD</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/505/835/d13/505835d13cd3c9300f0d95681b3dbf93.jpg"></div><br>  <i><font color="#999999">Instruksi CMD</font></i> <br><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CMD</a> menyediakan Docker dengan perintah untuk mengeksekusi ketika wadah dimulai.  Hasil dari perintah ini tidak ditambahkan ke gambar selama perakitannya.  Dalam contoh kita, perintah ini meluncurkan skrip <code>my_script.py</code> saat runtime. <br><br>  Berikut ini hal lain yang perlu Anda ketahui tentang instruksi <code>CMD</code> : <br><br><ul><li>  Hanya satu instruksi <code>CMD</code> dapat hadir dalam satu Dockerfile.  Jika ada beberapa instruksi seperti itu dalam file, sistem akan mengabaikan semuanya kecuali yang terakhir. </li><li>  Instruksi <code>CMD</code> mungkin memiliki formulir exec.  Jika instruksi tidak menyertakan referensi ke file yang dapat dieksekusi, maka instruksi <code>ENTRYPOINT</code> harus ada dalam file.  Dalam hal ini, kedua instruksi ini harus dalam <code>JSON</code> . </li><li>  Argumen baris perintah yang diteruskan ke <code>docker run</code> menimpa argumen yang disediakan oleh pernyataan <code>CMD</code> di Dockerfile. </li></ul><br><h3>  <font color="#3AC1EF">Dock Dockerfile yang lebih kompleks</font> </h3><br>  Pertimbangkan Dockerfile lain, di mana beberapa perintah baru akan digunakan. <br><br><pre> <code class="plaintext hljs">FROM python:3.7.2-alpine3.8 LABEL maintainer="jeffmshale@gmail.com" #   RUN apk add --update git #     WORKDIR /usr/src/my_app_directory #          COPY . . #       ARG my_var=my_default_value #  ,           ENTRYPOINT ["python", "./app/my_script.py", "my_var"] #   EXPOSE 8000 #      VOLUME /my_volume</code> </pre> <br>  Dalam contoh ini, antara lain, Anda dapat melihat komentar yang dimulai dengan karakter <code>#</code> . <br>  Salah satu hal utama yang dilakukan Dockerfile adalah menginstal paket.  Seperti yang telah disebutkan, ada berbagai cara untuk menginstal paket menggunakan instruksi <code>RUN</code> . <br><br>  Paket dalam gambar Alpine Docker dapat diinstal menggunakan <code>apk</code> .  Untuk ini, seperti yang telah kami katakan, perintah dari form <code>RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add bash</code> . <br><br>  Selain itu, paket Python dalam gambar dapat diinstal menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pip</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wheel,</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">conda</a> .  Jika kita tidak berbicara tentang Python, tetapi tentang bahasa pemrograman lain, maka manajer paket lain dapat digunakan untuk menyiapkan gambar yang sesuai. <br><br>  Pada saat yang sama, agar instalasi dimungkinkan, lapisan yang mendasarinya harus menyediakan manajer paket dengan manajer paket yang sesuai.  Oleh karena itu, jika Anda mengalami masalah dalam menginstal paket, pastikan bahwa manajer paket diinstal sebelum Anda mencoba menggunakannya. <br><br>  Misalnya, Anda dapat menggunakan pernyataan <code>RUN</code> di Dockerfile untuk menginstal daftar paket menggunakan <code>pip</code> .  Jika Anda melakukan ini, gabungkan semua perintah menjadi satu instruksi dan pisahkan dengan karakter pemisah baris menggunakan <code>\</code> karakter.  Berkat pendekatan ini, file-file akan terlihat rapi dan ini akan menyebabkan penambahan lebih sedikit layer pada gambar daripada yang akan ditambahkan menggunakan beberapa instruksi <code>RUN</code> . <br><br>  Selain itu, Anda dapat melakukan berbagai hal untuk menginstal beberapa paket.  Anda dapat mencantumkannya dalam file dan mentransfer file ini ke manajer paket menggunakan <code>RUN</code> .  Biasanya, file-file ini disebut <code>requirements.txt</code> . <br><br><h3>  <font color="#3AC1EF">▍ Instruksi WORKDIR</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/528/9ef/88f/5289ef88f3bc5fc7e4856fdc13d9872e.jpg"></div><br>  <i><font color="#999999">Direktori kerja</font></i> <br><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">WORKDIR</a> memungkinkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda</a> untuk mengubah direktori kerja wadah.  <code>ENTRYPOINT</code> <code>COPY</code> , <code>ADD</code> , <code>RUN</code> , <code>CMD</code> dan <code>ENTRYPOINT</code> yang mengikuti <code>WORKDIR</code> bekerja dengan direktori ini.  Berikut adalah beberapa fitur yang terkait dengan instruksi ini: <br><br><ul><li>  Lebih baik untuk menetapkan path absolut ke folder dengan <code>WORKDIR</code> daripada menavigasi sistem file menggunakan perintah <code>cd</code> di Dockerfile. </li><li>  Instruksi <code>WORKDIR</code> secara otomatis membuat direktori jika tidak ada. </li><li>  Anda dapat menggunakan beberapa instruksi <code>WORKDIR</code> .  Jika instruksi relatif disediakan untuk instruksi tersebut, maka masing-masing dari mereka mengubah direktori kerja saat ini. </li></ul><br><h3>  <font color="#3AC1EF">▍Panduan ARG</font> </h3><br>  Instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ARG</a> memungkinkan Anda untuk mengatur variabel yang nilainya dapat diteruskan dari baris perintah ke gambar selama perakitannya.  Nilai untuk variabel default dapat direpresentasikan dalam Dockerfile.  Sebagai contoh: <code>ARG my_var=my_default_value</code> . <br><br>  Tidak seperti variabel <code>ENV</code> , variabel <code>ARG</code> tidak tersedia saat runtime.  Namun, variabel <code>ARG</code> dapat digunakan untuk menetapkan nilai default untuk variabel <code>ENV</code> dari baris perintah selama pembuatan gambar.  Dan variabel <code>ENV</code> akan sudah tersedia dalam wadah selama eksekusi.  Rincian tentang teknik ini bekerja dengan variabel dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br><h3>  <font color="#3AC1EF">▍ ENTRYPOINT Instruksi</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2f/8b8/e95/c2f8b8e95436c097571b44810ac97a7a.jpg"></div><br>  <i><font color="#999999">Titik transisi ke suatu tempat</font></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pernyataan ENTRYPOINT</a> memungkinkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda</a> untuk menentukan perintah dengan argumen yang harus dieksekusi ketika wadah dimulai.  Ini mirip dengan perintah <code>CMD</code> , tetapi parameter yang ditentukan dalam <code>ENTRYPOINT</code> tidak ditimpa jika wadah dimulai dengan parameter baris perintah. <br><br>  Sebagai gantinya, argumen baris perintah yang diteruskan dalam konstruksi form <code>docker run my_image_name</code> ditambahkan ke argumen yang ditentukan oleh <code>ENTRYPOINT</code> .  Misalnya, setelah menjalankan perintah dari <code>docker run my_image bash</code> formulir <code>docker run my_image bash</code> argumen <code>docker run my_image bash</code> akan ditambahkan ke akhir daftar argumen yang ditentukan oleh <code>ENTRYPOINT</code> .  Saat menyiapkan Dockerfile Anda, jangan lupa <code>ENTRYPOINT</code> <code>CMD</code> atau <code>ENTRYPOINT</code> . <br><br>  Ada beberapa rekomendasi dalam dokumentasi untuk Docker mengenai instruksi mana, <code>CMD</code> atau <code>ENTRYPOINT</code> , harus dipilih sebagai alat untuk mengeksekusi perintah ketika wadah mulai: <br><br><ul><li>  Jika Anda perlu menjalankan perintah yang sama setiap kali Anda memulai wadah, gunakan <code>ENTRYPOINT</code> . </li><li>  Jika wadah akan digunakan sebagai aplikasi, gunakan <code>ENTRYPOINT</code> . </li><li>  Jika Anda tahu bahwa ketika Anda memulai wadah, Anda harus memberikan argumen kepadanya yang dapat menimpa argumen yang ditentukan dalam Dockerfile, gunakan <code>CMD</code> . </li></ul><br>  Dalam contoh kami, menggunakan instruksi <code>ENTRYPOINT ["python", "my_script.py", "my_var"]</code> menyebabkan wadah, ketika dimulai, untuk menjalankan skrip Python <code>my_script.py</code> dengan argumen <code>my_var</code> .  Nilai yang diwakili oleh <code>my_var</code> kemudian dapat digunakan dalam skrip menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">argparse</a> .    ,   Dockerfile  <code>my_var</code> ,   ,       <code>ARG</code> .  ,         ,     . <br><br>  Docker   exec- <code>ENTRYPOINT</code> : <code>ENTRYPOINT ["executable", "param1", "param2"]</code> . <br><br><h3> <font color="#3AC1EF">▍ EXPOSE</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee1/cca/45e/ee1cca45e3fd7e9be988556536fb1633.jpg"></div><br> <i><font color="#999999"> EXPOSE</font></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">EXPOSE</a>   ,      ,          .     . , ,     ,   ,   ,  ,   . <br><br>      ( )    ,    <code>docker run</code>   <code>-p</code> .      <code>-P</code> (   <code>P</code> ),     ,    <code>EXPOSE</code> . <br><br><h3> <font color="#3AC1EF">▍ VOLUME</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c1/ff6/a57/7c1ff6a5765f28cbd3d68cbf60d6b4aa.jpg"></div><br> <i><font color="#999999"> VOLUME</font></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">VOLUME</a>   ,              .     . <br><br><h2>  <font color="#3AC1EF">Ringkasan</font> </h2><br>     ,       Dockerfile.      .  ,      ,  <code>USER</code> , <code>ONBUILD</code> , <code>STOPSIGNAL</code> , <code>SHELL</code>  <code>HEALTHCHECK</code> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>     Dockerfile. <br><br> ,  Dockerfile —     Docker,      ,        .          ,       . <br><br>  <b>Pembaca yang budiman!</b>    Docker  ,    ,    Docker-. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439980/">https://habr.com/ru/post/id439980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439970/index.html">Laporkan masalah dan aksesibilitas Internet pada 2018-2019</a></li>
<li><a href="../id439972/index.html">io_submit: alternatif untuk epoll yang belum pernah Anda dengar</a></li>
<li><a href="../id439974/index.html">Transformasi Agile Pribadi: Perjalanan Fleksibel ke Produktivitas</a></li>
<li><a href="../id439976/index.html">Apakah Node.js selalu lebih lambat dari Golang?</a></li>
<li><a href="../id439978/index.html">Learning Docker, Bagian 2: Istilah dan Konsep</a></li>
<li><a href="../id439982/index.html">React Tutorial, Bagian 16: Fase Keempat Bekerja pada Aplikasi TODO, Pemrosesan Acara</a></li>
<li><a href="../id439984/index.html">React Tutorial, Bagian 17: Tahap Kelima Bekerja pada Aplikasi TODO, Mengubah Status Komponen</a></li>
<li><a href="../id439986/index.html">Chips VS Ancaman terhadap Teknologi Kontainerisasi</a></li>
<li><a href="../id439988/index.html">Technosphere lima tahun</a></li>
<li><a href="../id439990/index.html">Buku “AI pragmatis. Pembelajaran Mesin dan Teknologi Cloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>