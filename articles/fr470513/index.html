<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèº üïô üññüèº Comment j'ai trouv√© une maison intelligente domin√©e par un botnet üöµüèº üèΩ ü§´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sur Internet, des questions comme ¬´Comment puis-je v√©rifier si mon routeur, ordinateur, cam√©ra IP ou tout autre appareil se trouve dans le botnet?¬ª So...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment j'ai trouv√© une maison intelligente domin√©e par un botnet</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470513/"> Sur Internet, des questions comme ¬´Comment puis-je v√©rifier si mon routeur, ordinateur, cam√©ra IP ou tout autre appareil se trouve dans le botnet?¬ª Sont tr√®s courantes.  Cela m'a motiv√© √† parler de l'un des rares cas de collision avec des botnets de ma pratique. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w4/3v/ni/w43vni24ic8gzwz0y-9g8vhfnks.jpeg" alt="image"></div><br><a name="habracut"></a><br>  En √©tudiant le trafic suspect, je suis tomb√© sur l'adresse IP du routeur, √† partir de laquelle des tentatives infructueuses ont √©t√© faites pour se connecter via SSH √† mon HONEYPOT.  Dans /var/log/auth.log, j'ai vu ceci: <br><br><pre><code class="plaintext hljs">... Oct 9 23:52:04 dvrh sshd[3523]: Failed password for root from 129.***.***.29 port 35276 ssh2 Oct 9 23:52:04 dvrh sshd[3523]: Connection closed by authenticating user root 129.***.***.29 port 35276 [preauth] Oct 9 23:52:05 dvrh sshd[3525]: Connection closed by authenticating user root 129.***.***.29 port 35278 [preauth] Oct 9 23:52:06 dvrh sshd[3529]: Failed password for root from 129.***.***.29 port 35280 ssh2 Oct 9 23:52:06 dvrh sshd[3529]: Connection closed by authenticating user root 129.***.***.29 port 35280 [preauth] Oct 9 23:52:06 dvrh sshd[3531]: Invalid user admin from 129.***.***.29 port 35282 Oct 9 23:52:07 dvrh sshd[3531]: Failed password for invalid user admin from 129.***.***.29 port 35282 ssh2 Oct 9 23:52:07 dvrh sshd[3531]: Connection closed by invalid user admin 129.***.***.29 port 35282 [preauth] Oct 9 23:52:08 dvrh sshd[3533]: Invalid user test from 129.***.***.29 port 35286 Oct 9 23:52:11 dvrh sshd[3533]: Failed password for invalid user test from 129.***.***.29 port 35286 ssh2 Oct 9 23:52:11 dvrh sshd[3533]: Connection closed by invalid user test 129.***.***.29 port 35286 [preauth] Oct 9 23:52:11 dvrh sshd[3535]: Invalid user test from 129.***.***.29 port 35288 Oct 9 23:52:12 dvrh sshd[3535]: Failed password for invalid user test from 129.***.***.29 port 35288 ssh2 Oct 9 23:52:12 dvrh sshd[3535]: Connection closed by invalid user test 129.***.***.29 port 35288 [preauth] Oct 9 23:53:12 dvrh sshd[3537]: Invalid user admin from 129.***.***.29 port 35290 Oct 9 23:53:12 dvrh sshd[3537]: Connection closed by invalid user admin 129.***.***.29 port 35290 [preauth] ...</code> </pre> <br>  La conclusion n'a pas √©t√© difficile: quelqu'un a essay√© d'acc√©der √† mon serveur en utilisant un ensemble de connexions et de mots de passe standard.  De plus (√† en juger par les intervalles de temps), cela a √©t√© fait en mode automatique.  Cela signifie que c'est probablement un autre routeur qui est membre du botnet. <br><blockquote>  En fait, cette image est typique pour les h√¥tes avec un port 22 ouvert.  Vous pouvez le v√©rifier vous-m√™me: ouvrez ssh pour acc√©der √† partir d'Internet externe, autorisez la saisie du mot de passe et les robots ne vous feront pas attendre.  Dans le m√™me temps, ~ 80% des tentatives proviendront de Chine. <br></blockquote><br>  Heureusement, apr√®s un certain temps, j'ai r√©ussi √† acc√©der √† cette IP malheureuse via ssh en utilisant l'un des identifiants et mots de passe standard (Surpris? Je ne le fais pas).  Mais il s'est av√©r√© que ce n'est pas un routeur ordinaire, mais un appareil appel√© Calix GigaSpire. <br><blockquote>  Calix GigaSpire est un syst√®me de contr√¥le domestique intelligent sous le syst√®me d'exploitation EXOS.  GigaSpire comprend les fonctionnalit√©s suivantes: <br><br><ul><li>  Prise en charge du Wi-Fi 6 (802.11ax), avec 8x8 √† 5 GHz et 4x4 √† 2,4 GHz </li><li>  Service Multi Gigabit </li><li>  Services de niveau 2 et de niveau 3 </li><li>  G√©r√© par Calix Support Cloud </li><li>  Prise en charge de l'IoT (Bluetooth Low Energy, Zigbee 3.0 et Z-Wave Pro) </li><li>  Amazon Alexa Voice Assistant </li></ul></blockquote><br>  La premi√®re chose que j'ai faite, en me connectant au syst√®me, j'ai regard√© la liste des processus en cours d'ex√©cution pour trouver quelque chose d'int√©ressant.  Et ce ¬´quelque chose d'int√©ressant¬ª ressemblait √† ceci: <br><br><pre> <code class="plaintext hljs">[router] / # ps ... 2978 root 1444 S {kkbs2l3mdqjq} ipjq2njq5qjq 9729 root 1584 S {kkbs2l3mdqjq} ipjq2njq5qjq 14871 root 5532 S {hgoj42jadsjvebc} m6ojj5oj5gojj2h08b8l 19037 root 308 S {hgoj42jadsjvebc} m6ojj5oj5gojj2h08b8l 19041 root 284 S {hgoj42jadsjvebc} m6ojj5oj5gojj2h08b8l ...</code> </pre><br>  La suspicion est le "caract√®re al√©atoire" des noms de ces processus.  Pour comprendre ce que sont ces processus, je sugg√®re de rappeler ce qu'est le syst√®me de fichiers / proc: <br><blockquote>  procfs est un syst√®me de fichiers sp√©cial utilis√© sur les syst√®mes d'exploitation de type UNIX.  Vous permet d'acc√©der aux informations du noyau sur les processus syst√®me.  Requis pour ex√©cuter des commandes telles que ps, w, top.  Il est g√©n√©ralement mont√© sur / proc.  De ce r√©pertoire, vous pouvez obtenir toutes les informations sur votre syst√®me.  Par exemple, la quantit√© de m√©moire d'√©change actuellement utilis√©e, la taille de la m√©moire cache du processeur, les modules du noyau charg√©s, le nombre de disques ou de partitions disponibles, etc. <br></blockquote><br>  Nous sommes int√©ress√©s par les r√©pertoires contenant des informations sur les processus suspects trouv√©s.  Ils ont la forme / proc / PID, o√π PID est l'ID du processus pour lequel ce r√©pertoire contient des informations.  Si vous regardez leur contenu, vous pouvez trouver les fichiers suivants: <br><br><ul><li>  <b>cmdline</b> - contient la commande avec laquelle le processus a √©t√© lanc√©, ainsi que les param√®tres qui lui sont pass√©s </li><li>  <b>cwd</b> - lien symbolique vers le r√©pertoire de travail actuel du processus </li><li>  <b>exe</b> - lien vers le fichier ex√©cutable </li><li>  <b>root</b> - lien vers le dossier racine </li><li>  <b>environ</b> - variables d'environnement disponibles pour le processus </li><li>  <b>fd</b> - contient des descripteurs de fichiers, des fichiers et des p√©riph√©riques que le processus utilise </li><li>  <b>maps</b> , <b>statm</b> et <b>mem</b> - informations sur la m√©moire de processus </li><li>  <b>stat</b> , <b>status</b> - √©tat du processus </li></ul><br>  Que pouvons-nous y faire?  La premi√®re chose qui me vient √† l'esprit est de calculer la somme de contr√¥le de l'un des fichiers ex√©cutables et de rechercher des correspondances sur Internet: <br><br><pre> <code class="plaintext hljs">/ # md5sum /proc/2978/exe d204e97ac15a6d0a3ed7e415edfa582e /proc/2978/exe</code> </pre><br>  J'ai trouv√© ce md5 dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">liste des sommes de contr√¥le Mirai</a> , qui indique la nature de l'origine du fichier.  Mais que pouvons-nous faire maintenant?  Pour vous d√©barrasser du bot Mirai, red√©marrez simplement le routeur.  Mais dans ce cas, c'est inutile, car un nouveau malware va bient√¥t monter sur un routeur avec un simple mot de passe, et changer le mot de passe de quelqu'un d'autre est un exc√®s, vous savez quoi. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr470513/">https://habr.com/ru/post/fr470513/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr470491/index.html">Des √©pines au jeu des r√™ves - le progr√®s et l'√©volution des cr√©atures</a></li>
<li><a href="../fr470497/index.html">Comment utiliser systemd-nspawn pour restaurer un syst√®me Linux</a></li>
<li><a href="../fr470499/index.html">Comment utiliser au mieux les interruptions dans Unity Animator</a></li>
<li><a href="../fr470503/index.html">Utilisateurs et autorisation de Kubernetes RBAC</a></li>
<li><a href="../fr470511/index.html">L'informatique en Arm√©nie: secteurs strat√©giques et sph√®res technologiques du pays</a></li>
<li><a href="../fr470515/index.html">Une petite √©tape pour le testeur: les 10 meilleurs rapports de Heisenbug 2019 Piter</a></li>
<li><a href="../fr470517/index.html">EP russe pour les plus petits</a></li>
<li><a href="../fr470519/index.html">Exp√©rience dans la cr√©ation d'assemblages Linux pour les mises √† jour sur une seule carte avec prise en charge</a></li>
<li><a href="../fr470521/index.html">Publication de la mise √† jour 3CX V16 3 et de la nouvelle application mobile 3CX pour Android</a></li>
<li><a href="../fr470525/index.html">Windows dans un navigateur sans inscription et SMS - vue d'ensemble des clients HTML5 RDP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>