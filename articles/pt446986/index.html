<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçü§ù‚Äçüë®üèº üö° üìÜ Agachado nas sombras ou procurando o pr√≥ximo mundo üë®‚Äçüë©‚Äçüëß‚Äçüë¶ üé´ üç†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Assembler √© minha l√≠ngua favorita ... mas a vida √© t√£o curta. 
 Continuo o ciclo de pesquisa sobre a quest√£o das sombras adequadas para alguns bagels....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Agachado nas sombras ou procurando o pr√≥ximo mundo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446986/"><img src="https://habrastorage.org/webt/d-/wj/wu/d-wjwubdpihumypc3b7tv43ihzy.png"><br><blockquote>  Assembler √© minha l√≠ngua favorita ... mas a vida √© t√£o curta. </blockquote><br>  Continuo o ciclo de pesquisa sobre a quest√£o das sombras adequadas para alguns bagels.  Ap√≥s a publica√ß√£o, esfriei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">duas vezes</a> para este t√≥pico, mas o efeito de a√ß√£o incompleta me leva a retornar aos restos de pixels e a concluir a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gestalt</a> . <br><br>  Conhecendo a mim mesmo, tenho certeza de que o jogo dificilmente ser√° concretizado, mas talvez o p√∫blico esteja interessado nas minhas realiza√ß√µes nesse caminho espinhoso.  E ent√£o vamos come√ßar. <br><a name="habracut"></a><br>  No final do √∫ltimo ciclo, cheguei ao entendimento de que o c√°lculo de gr√°ficos em uma CPU j√° era o s√©culo passado, mas a obstina√ß√£o natural insistia: nem todas as possibilidades eram usadas, ainda havia op√ß√µes para solu√ß√µes interessantes. <br><br>  O tra√ßado de raios permaneceu n√£o implementado.  Mais precisamente, seu tipo, onde, para cada pixel da imagem (bloco de pixels), um raio √© lan√ßado e o n√≠vel de ilumina√ß√£o do ponto atual √© determinado.  O algoritmo em si √© descrito em um artigo anterior e n√£o faz sentido retornar a ele.  Para rastreamento de raio reverso, o c√≥digo foi ainda mais simplificado, toda a trigonometria foi completamente removida, o que no futuro poderia dar um resultado aceit√°vel. <br><br><div class="spoiler">  <b class="spoiler_title">Pascal</b> <div class="spoiler_text"><pre><code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tile_size = <span class="hljs-number"><span class="hljs-number">32</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   tile_size1 : single = 0.03125; // 1/32 -    block_size = 4; // /    Size_X:Byte = 32; //    X Size_Y:Byte = 24; //    Y //--------------------------------- function is_no_empty(x,y:Integer):Integer; begin if (x&gt;=0) AND (x&lt;Size_X) AND (y&gt;=0) AND (y&lt;Size_Y) then begin if map[x,y]=1 then begin is_no_empty:=1; end else if map[x,y]=2 then begin is_no_empty:=2; end else is_no_empty:=0; end else is_no_empty:=-1; end; //--------------------------------- function crossing(r_view, x,y:Single; xi,yj, i,j:Integer):Byte; var di,dj,ddi,ddj :Shortint; //   k,i2,j2 :integer; //    key:Boolean; last_k, transp_key :Byte; sum_lenX,sum_lenY, Dx,Dy,Dx1,DY1, l :Single; //  sec1,cosec1, temp_x,temp_y, dx0,dy0 :Single; //   i0,j0 :Integer; //       begin temp_x := i*block_size; temp_y := j*block_size; i0 := trunc(temp_x * tile_size1); j0 := trunc(temp_y * tile_size1); l := sqrt(sqr(temp_y-y) + sqr(temp_x-x)) + 0.0000001; transp_key := 0; //     if is_no_empty(xi,yj)&gt;0 then inc(transp_key); if (xi=i0) and (yj=j0) then begin crossing := min(255,transp_key*64+ l * r_view); exit; end; dx0 := (temp_x-x)/l+0.0000001; dy0 := (temp_y-y)/l+0.0000001; key := False; last_k :=0; //   if dx0&lt;0 then begin di :=-1; ddi:= 0; end else begin di := 1; ddi:= 1; end; if dy0&lt;0 then begin dj :=-1; ddj:= 0; end else begin dj := 1; ddj:= 1; end; sum_lenX := 0; sum_lenY := 0; sec1 := 1/dx0; cosec1 := 1/dy0; //       Y temp_x := x-(xi+ddi) * tile_size ; temp_y := y-(yj+ddj) * tile_size ; Dx := sqrt(sqr(temp_x) + sqr(temp_x * sec1 * dy0)); DY := sqrt(sqr(temp_y) + sqr(temp_y * cosec1 * dx0)); //      Y Dx1 := abs(tile_size * sec1); Dy1 := abs(tile_size * cosec1); repeat if sum_lenX+DX &lt; sum_lenY+DY then begin xi += di; k := is_no_empty(xi,yj); sum_lenX += DX; if DX&lt;&gt;Dx1 then DX := Dx1; end else begin yj += dj; k := is_no_empty(xi,yj); sum_lenY += DY; if DY&lt;&gt;Dy1 then DY := Dy1; end; if key Then begin if (xi&lt;&gt;i2) Or (yj&lt;&gt;j2) then begin //  (  ) if last_k=1 then begin crossing := 255; exit; end; //   (  ) if transp_key&gt;2 then begin crossing := 255; exit; end; inc(transp_key); key:= false; end; end; if k&gt;0 then begin i2:=xi; j2:=yj; key:=true; last_k:=k; end; //    if (xi=i0) and (yj=j0) then begin crossing := min(255, transp_key*64+ l * r_view); exit; end; until k=-1; //     end; //--------------------------------- .................. x0:= mouse_x; y0:= mouse_y; //       x1 := x0 div tile_size; y1 := y0 div tile_size; koef := tile_size div block_size; //      (     ) for j:=0 to Size_Y * koef do for i:=0 to Size_X * koef do picture_mask.SetPixel(i, j, BGRA(0,0,0,crossing(x0, y0, x1, y1, i, j))); ..................</span></span></code> </pre> <br></div></div><br>  Infelizmente, o resultado foi muito pior do que o esperado, valeu a pena implantar a imagem em tela cheia, o FPS procurou as unidades. <br><br><img src="https://habrastorage.org/webt/to/b_/sa/tob_sau5axwf2lhnxxfswnfuuv8.png"><br><br>  O agrupamento de pixels em macroblocos para reduzir os c√°lculos e a aplica√ß√£o da suaviza√ß√£o subsequente n√£o melhoraram muito o desempenho.  O efeito francamente n√£o gostou da palavra. <br><br><img src="https://habrastorage.org/webt/hj/s5/sr/hjs5srli3gslf1yuerzb8b2kjq4.png"><br><br>  O algoritmo era perfeitamente paralelo, mas n√£o fazia sentido usar muitos fluxos, o efeito parecia muito pior do que no artigo anterior, mesmo com melhor qualidade de imagem. <br>  Acabou sendo um beco sem sa√≠da.  Eu tive que admitir, a CPU no c√°lculo de gr√°ficos nos meus olhos se esgotou.  A cortina. <br><br><div class="spoiler">  <b class="spoiler_title">Digress√£o 1</b> <div class="spoiler_text">  Na √∫ltima d√©cada, praticamente n√£o houve progresso no desenvolvimento de processadores de uso geral.  Se abordado pelo usu√°rio, o aumento m√°ximo percept√≠vel no desempenho n√£o ser√° superior a 30% por n√∫cleo.  O progresso, para dizer o m√≠nimo, √© insignificante.  Se omitirmos a extens√£o do comprimento das instru√ß√µes do vetor e alguma acelera√ß√£o dos blocos transportadores, isso aumentar√° o n√∫mero de n√∫cleos de trabalho.  O trabalho seguro com threads ainda √© um prazer e nem todas as tarefas podem ser paralelizadas com √™xito.  Eu gostaria de ter um n√∫cleo de trabalho, embora um, mas se for, √© de 5 a 10 mais r√°pido, mas infelizmente e ah, como eles dizem. <br>  Aqui em Habr√©, h√° uma excelente s√©rie de artigos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"A vida na era do sil√≠cio" escuro "",</a> que explica alguns dos pr√©-requisitos para o estado atual das coisas, mas tamb√©m retorna do c√©u para a terra.  Na pr√≥xima d√©cada, voc√™ n√£o pode esperar um aumento significativo na computa√ß√£o por n√∫cleo.  Mas podemos esperar um maior desenvolvimento do n√∫mero de n√∫cleos de GPU e sua acelera√ß√£o geral.  Mesmo no meu laptop antigo, o desempenho total estimado da GPU √© 20 vezes maior que um √∫nico thread da CPU.  Mesmo se voc√™ carregar efetivamente todos os quatro n√∫cleos do processador, √© muito menos do que gostar√≠amos. <br>  Presto homenagem aos desenvolvedores dos gr√°ficos do passado, que fizeram suas obras sem aceleradores de hardware, verdadeiros mestres. <br></div></div><br>  Ent√£o, lidamos com a GPU.  Acabou sendo um pouco inesperado para mim que, na pr√°tica real, poucas pessoas simplesmente espalhem pol√≠gonos em forma.  Todas as coisas interessantes s√£o criadas usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">shaders</a> .  Tendo descartado os mecanismos 3D acabados, tentei estudar as miudezas da tecnologia em um n√≠vel profundo.  Os mesmos processadores s√£o o mesmo montador, apenas algumas instru√ß√µes truncadas e suas pr√≥prias especificidades de trabalho.  Para o teste, parei no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GLSL</a> , uma sintaxe do tipo C, simplicidade, muitas li√ß√µes e exemplos de treinamento, incluindo o Habr. <br>  Como eu costumava escrever em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pascal</a> , a tarefa era como conectar o OpenGL <br>  para o projeto.  Consegui encontrar duas maneiras de conectar: ‚Äã‚Äãa biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GLFW</a> e o arquivo de cabe√ßalho <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dglOpenGL</a> .  A √∫nica coisa no come√ßo n√£o consegui conectar os shaders, mas aparentemente isso √© pela curvatura das minhas m√£os. <br><br><div class="spoiler">  <b class="spoiler_title">Digress√£o 2</b> <div class="spoiler_text">  Muitos amigos me perguntam por que escrevo em Pascal?  Obviamente, esta √© uma linguagem amea√ßada, sua comunidade est√° caindo constantemente, quase n√£o h√° desenvolvimento.  Os engenheiros de sistema de baixo n√≠vel preferem C e Java, Python, Ruby ou o que estiver no auge no momento. <br>  Para mim, Pascal √© semelhante ao primeiro amor.  Duas d√©cadas atr√°s, nos dias de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Turbo Pascal 5.5</a> , ele afundou em minha alma e tem andado comigo desde ent√£o, seja Delphi ou nos √∫ltimos anos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">L√°zaro</a> .  Eu gosto da previsibilidade da linguagem, do n√≠vel relativamente baixo (o assembler insere e visualiza as instru√ß√µes do processador), da compatibilidade com C. O principal √© que o c√≥digo √© montado e executado sem problemas, mas o fato de n√£o estar na moda est√° desatualizado e n√£o h√° alguns recursos, isso n√£o faz sentido.  Dizem que existem pessoas que ainda escrevem no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LISP</a> , mas para ele em geral h√° meio s√©culo. <br></div></div><br>  Ent√£o, vamos mergulhar no desenvolvimento.  Para uma etapa de teste, n√£o tomaremos modelos realistas precisos de sombreamento, mas tentaremos implementar o que j√° tentamos antes, mas com o desempenho da GPU, por assim dizer, para uma compara√ß√£o clara. <br><br>  Inicialmente, pensei em obter uma sombra aproximadamente dessa forma, usando tri√¢ngulos para um objeto. <br><br><img src="https://habrastorage.org/webt/up/ps/la/uppslarm4raiqopjfumiogecono.png"><br><br>  Para criar o efeito de um c√≠rculo suave, voc√™ precisa de muitos pol√≠gonos.  Mas e se voc√™ usar tri√¢ngulos no m√≠nimo, usando um pixel shader para criar um buraco na forma.  A ideia surgiu depois de ler um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo de um</a> mestre respeitado, no qual foi aberta a oportunidade de criar uma esfera com um sombreador. <br><br><img src="https://habrastorage.org/webt/ph/hu/tg/phhutg9hwan_hlukufz4twdjp7i.png"><br><br>  Se voc√™ estender o tri√¢ngulo al√©m dos limites da tela, o resultado ser√° o seguinte: <br><br><img src="https://habrastorage.org/webt/80/tm/wy/80tmwydb6qratckw2hzzqpdanxk.png"><br><br>  As bordas da sombra se mostraram muito r√≠gidas e tamb√©m pisaram.  Mas h√° uma maneira de obter um resultado aceit√°vel sem usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">superamostragem</a> , isso √© usar bordas suavizadas.  Para fazer isso, altere ligeiramente o esquema.  Os cantos dos pol√≠gonos na interse√ß√£o da tangente ao c√≠rculo ficar√£o transparentes. <br><br><img src="https://habrastorage.org/webt/r7/er/bg/r7erbgdvqlaxcwrtp7im6m6j97u.png"><br><br>  O resultado √© melhor, mas ainda parece antinatural. <br><br><img src="https://habrastorage.org/webt/k9/r8/qw/k9r8qw-kcrabolq1vqyqgvr5b8o.png"><br><br>  Adicione um pouco de suaviza√ß√£o do c√≠rculo para dar suavidade e tamb√©m mude a forma do gradiente de linear para poder. <br><br><img src="https://habrastorage.org/webt/s9/mo/a2/s9moa2rhsslrktn808o2cwoxiwy.png"><br><br>  √â um resultado aceit√°vel. <br>  E no final, adicionaremos objetos imitando obst√°culos ao formul√°rio. <br><br><img src="https://habrastorage.org/webt/fo/f8/4c/fof84cbrg5n_kea_4k9js5tiqi4.png"><br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de sombreador</b> <div class="spoiler_text"> <code>//   <br> <br> #version 330 core <br> layout (location = 0) in vec2 aVertexPosition; <br> void main(void) { <br> gl_Position = vec4(aVertexPosition.xy, 0, 1.0); <br> } <br> <br> //   <br> <br> #version 330 core <br> layout (points) in; <br> layout (triangle_strip, max_vertices = 5) out; <br> uniform mat4 uModelViewMatrix; <br> uniform float uRadius; <br> uniform vec2 uHeroPoint; <br> out float fTransparency; <br> out vec2 vCenter; <br> void main(){ <br> vCenter = gl_in[0].gl_Position.xy; <br> vec2 d = uHeroPoint - vCenter; <br> float l = length(d); <br> float i = uRadius / l; <br> float ii = i*i; <br> float ij = i * sqrt(1 - ii); <br> vec2 p1 = vec2(vCenter.x + dx*ii - dy*ij , vCenter.y + dx*ij + dy*ii); <br> vec2 p2 = vec2(vCenter.x + dx*ii + dy*ij , vCenter.y - dx*ij + dy*ii); <br> d = uHeroPoint - p1; <br> vec2 p3 = vec2(p1 - d/length(d)*1000000); <br> d = uHeroPoint - p2; <br> vec2 p4 = vec2(p2 - d/length(d)*1000000); <br> fTransparency = 0; <br> gl_Position = uModelViewMatrix * vec4(p1, 0, 1); <br> EmitVertex(); <br> fTransparency = 1; <br> gl_Position = uModelViewMatrix * vec4(p3, 0, 1); <br> EmitVertex(); <br> gl_Position = uModelViewMatrix * vec4(vCenter, 0, 1); <br> EmitVertex(); <br> gl_Position = uModelViewMatrix * vec4(p4, 0, 1); <br> EmitVertex(); <br> fTransparency = 0; <br> gl_Position = uModelViewMatrix * vec4(p2, 0, 1); <br> EmitVertex(); <br> EndPrimitive(); <br> } <br> <br> //   <br> <br> #version 330 core <br> precision mediump float; <br> varying float fTransparency; <br> varying vec2 vCenter; <br> uniform float uRadius; <br> uniform vec2 uScreenHalfSize; <br> uniform float uShadowTransparency; <br> uniform float uShadowSmoothness; <br> out vec4 FragColor; <br> void main(){ <br> float l = distance(vec2((gl_FragCoord.xy - uScreenHalfSize.xy)/uScreenHalfSize.y), vCenter.xy); <br> if (l&lt;uRadius) {discard;} <br> else {FragColor = vec4(0, 0, 0, min(pow(fTransparency, uShadowSmoothness), (l-uRadius)/uRadius*10)*uShadowTransparency);} <br> } <br></code> <br></div></div><br>  Espero que tenha sido informativo <br><br>  Seu humilde servo, atormentador de pixels, Rebuilder. <br><br>  Estou anexando uma pequena <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">demonstra√ß√£o</a> .  (EXE Windows) <br><br>  PS O t√≠tulo do artigo cont√©m um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ovo de P√°scoa</a> , uma refer√™ncia √† trilogia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Siala Chronicle</a> .  Um excelente trabalho nos estilos de fantasia, sobre os infort√∫nios dos chifres, de Alexei Pekhov. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt446986/">https://habr.com/ru/post/pt446986/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt446976/index.html">Paradoxos de compacta√ß√£o de dados</a></li>
<li><a href="../pt446978/index.html">Jogo do tipo Breakuot no PIC12F1572</a></li>
<li><a href="../pt446980/index.html">Como publicar um jogo para celular e n√£o cometer meus erros</a></li>
<li><a href="../pt446982/index.html">Graduados do centro de CS retornam para ensinar</a></li>
<li><a href="../pt446984/index.html">Aperte o an√°logo de Space Invaders a 1 kilobyte (1978 original leva 8)</a></li>
<li><a href="../pt446988/index.html">Como eu ensinei Scala</a></li>
<li><a href="../pt446990/index.html">Atraso de entrada em consoles e emuladores retr√¥</a></li>
<li><a href="../pt446992/index.html">John Maeda: ‚ÄúNa verdade, o design n√£o √© t√£o importante‚Äù</a></li>
<li><a href="../pt446994/index.html">O espa√ßo como uma vaga mem√≥ria</a></li>
<li><a href="../pt446996/index.html">O m√©todo Pomodoro n√£o √© t√£o legal quanto poderia ser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>