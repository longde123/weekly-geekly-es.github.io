<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö∫ üßîüèæ ‚å®Ô∏è Design r√©tro pour la premi√®re console portable de la lointaine 1979 üë©üèø üßëüèΩ‚Äçü§ù‚ÄçüßëüèΩ ü§∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En 1974, Texas Instruments a lanc√© les premiers microcontr√¥leurs 4 bits de la famille TMS1000 et Intel a commenc√© en 1976 la production des microcontr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Design r√©tro pour la premi√®re console portable de la lointaine 1979</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416865/"><img src="https://habrastorage.org/webt/41/yf/ic/41yfickhp7ywna9ls3tj4tigy24.jpeg"><br><br>  En 1974, Texas Instruments a lanc√© les premiers microcontr√¥leurs 4 bits de la famille TMS1000 et Intel a commenc√© en 1976 la production des microcontr√¥leurs 8 bits de sa c√©l√®bre s√©rie MCS-48.  Et puis √ßa a commenc√©. <br><a name="habracut"></a><br>  En raison du bon march√© et de l'autosuffisance des microcontr√¥leurs (alors ils √©taient appel√©s directement - un micro-ordinateur monopuce), les appareils √©lectroniques grand public √©taient beaucoup plus sages et leur nombre a augment√© plus que jamais.  Avec l'av√®nement des microcontr√¥leurs, une classe d'appareils comme les jeux √©lectroniques portables est apparue, l'ampleur de la "catastrophe" peut √™tre estim√©e √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce lien</a> .  Parmi toute cette vari√©t√© de premiers jeux, un dont je parlerai dans cet article s'est d√©marqu√© - il s'agit de Milton Bradley Microvision, le premier jeu √©lectronique portable avec des cartouches rempla√ßables, qui utilisait les deux microcontr√¥leurs ci-dessus.  J'essaierai √©galement de m'attarder sur les sp√©cificit√©s du d√©veloppement de cette console. <br><br><h3>  Description g√©n√©rale </h3><br> <a href=""><img src="https://habrastorage.org/webt/9_/vz/pz/9_vzpzmfre7fck4ey-suxwkrgna.jpeg"></a> <br><br>  Microvision est sorti aux √âtats-Unis il y a pr√®s de quarante ans, en 1979.  Au total, 12 cartouches avec des jeux lui ont √©t√© vendues, parmi lesquelles - livr√©es avec la console Block Buster (analogique de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Breakout</a> ), des sports - Bowling et Baseball, une version √©lectronique du c√©l√®bre jeu de plateau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Connect Four</a> , Pinball et autres.  La plupart des jeux peuvent √™tre √©valu√©s sur l'√©mulateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MVEM</a> , qui a √©t√© r√©alis√© sur la base d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©rie</a> int√©ressante <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de publications</a> , √† partir desquelles j'ai √©galement appris beaucoup de choses utiles.  Ici, je ne m'attarderai pas en d√©tail sur la description des jeux originaux de la console, mais je me tournerai imm√©diatement vers son monde int√©rieur. <br><br> <a href=""><img src="https://habrastorage.org/webt/gr/gu/lb/grgulbct_3jmlu9830qx2upfble.jpeg"></a> <br><br>  Une caract√©ristique importante de la console est un √©cran LCD de 2 pouces avec une r√©solution de 16x16 pixels.  Assez primitif par rapport aux normes d'aujourd'hui, mais par rapport aux assemblages LED et aux indicateurs luminescents sous vide utilis√©s dans les jeux portables √† l'√©poque, l'√©cran LCD √† matrice √©tait une √©tape plut√¥t progressive.  En plus de Microvision, la m√™me ann√©e, une s√©rie de jeux √©lectroniques Mego Mini-Vid avec un √©cran similaire est apparue en vente, bien que 13x20.  Apparemment, √† cette √©poque, il s'agissait des seuls appareils en vente avec des √©crans LCD matriciels d'une telle r√©solution. <br><br><img src="https://habrastorage.org/webt/ga/uh/tv/gauhtvjy3-ltagudiptipvvl6lm.jpeg"><br><br>  L'affichage est contr√¥l√© par la puce Hughes SCUS0488 - il s'agit d'un pilote LCD matriciel.  Le pilote est aliment√© par un stabilisateur de tension n√©gative UA79MG avec une paire de condensateurs et de r√©sistances, qui est la base de l'√©l√©ment la plus simple. <br> <a href=""><img src="https://habrastorage.org/webt/ws/li/pb/wslipbri9usvwd5o8eztgddsnry.jpeg"></a> <br><br>  Dans le bo√Ætier de la console se trouvent √©galement les commandes - une matrice de boutons 4x3 et une r√©sistance variable de 10kŒ© comme une palette.  Pour la reproduction sonore il y a une pi√©zodynamique. <br><br>  La chose la plus importante est la raison pour laquelle Microvision a marqu√© l'histoire, et tout le monde a oubli√© le Mini-Vid mentionn√© ci-dessus, en utilisant des cartouches rempla√ßables. <br><br> <a href=""><img src="https://habrastorage.org/webt/12/ke/qw/12keqw-kmdbgoo85q50i2yunnjc.jpeg"></a> <br><br>  √Ä l'ext√©rieur, la cartouche √©tait une partie sup√©rieure d√©tachable du bo√Ætier.  Au centre de la cartouche, il y avait une fen√™tre en plastique recouvrant l'√©cran, sur laquelle des √©l√©ments de jeu en couleur et des inscriptions individuelles √©taient appliqu√©s pour chaque jeu.  Ci-dessous se trouvaient les trous pour les boutons recouverts derri√®re par un film mince, sur lequel les signatures √©taient appliqu√©es, et pour chaque jeu, des trous √©taient faits uniquement pour les boutons utilis√©s.  Probablement, cette disposition de la cartouche, selon les auteurs, a permis de maximiser l'adaptation de la console √† un jeu sp√©cifique. <br><br> <a href=""><img src="https://habrastorage.org/webt/ub/od/ou/ubodouuncl6f7az9o4v8n2slwuq.jpeg"></a> <br>  <i>Plateau de jeu Block Buster, dans le bo√Ætier et au dos</i> <br><br>  La partie √©lectronique de la cartouche a √©t√© construite sur l'un des deux microcontr√¥leurs - TMS1100 ou Intel 8021 avec le faisceau n√©cessaire.  Placer le ¬´cerveau¬ª d'une console dans une cartouche peut sembler une d√©cision plut√¥t √©trange, mais cela ne vous a permis de vous en sortir qu'avec deux jetons par partie.  En outre, il a √©galement ajout√© de la polyvalence.  Dans le m√™me temps, le prix de la cartouche, apparemment d√ª √† la pr√©sence du microcontr√¥leur, n'a pas beaucoup augment√© (par exemple, le co√ªt de 8021 en grands lots en 1976 √©tait d'environ 3 $). <br><br>  Tout cela alimentait une ou deux couronnes connect√©es en parall√®le (8021 √©tait assez vorace).  De plus, dans les versions ult√©rieures, les contacts de la deuxi√®me batterie ont √©t√© supprim√©s et il a √©t√© recommand√© d'utiliser l'espace restant pour une batterie de rechange.  Apparemment, cela √©tait d√ª au fait que les utilisateurs confondaient souvent la polarit√©, obtenant un court-circuit assez dangereux. <br><br><h3>  Cravate </h3><br>  J'ai achet√© cette ancienne console afin d'√©crire une sorte de jeu et de faire une cartouche, et si possible, de copier autant que possible la base de l'√©l√©ment de l'original. <br>  Mais il y a un probl√®me important - que le TMS1100, qu'Intel 8021 avait une ROM masqu√©e, c'est-√†-dire  programm√© en usine pendant le processus de fabrication.  Il existe un moyen de sortir pour le microcontr√¥leur d'Intel: 8021 est une version all√©g√©e de 8048, qui avait √©galement une ROM masqu√©e, mais Intel a produit un analogue de 8048 avec une ROM programmable - 8748, √† la fois dans le cas de l'effacement ultraviolet et moins cher une fois programmable. <br><br>  Malheureusement, la situation est bien pire pour le TMS1100 - il y avait une version de d√©bogage de la puce qui fonctionne avec une ROM externe - TMS1098, mais l'acheter maintenant, si possible, est tr√®s difficile.  De plus, la puce a √©t√© fabriqu√©e dans le bo√Ætier DIP-64, elle est √©norme en soi et ne rentrera pas dans la cartouche en longueur, mais une ROM assez grande est √©galement n√©cessaire. <br><br>  En g√©n√©ral, le 8748 effa√ßable aux UV est ce dont vous avez besoin, et la version finale de la cartouche peut √™tre r√©alis√©e sur une version ind√©l√©bile. <br><br> <a href=""><img src="https://habrastorage.org/webt/kg/gs/jp/kggsjpioqodpscq5i9orcdp_0im.jpeg"></a> <br>  <i>Au-dessus se trouve un P8748H programmable et en dessous un D8748H effa√ßable aux UV</i> <br><br><h3>  Intel 8021 </h3><br>  Voici une br√®ve description de 8021, pas 8748, car  Je n'utiliserai que des fonctionnalit√©s tronqu√©es du 8021 afin de n'avoir que les ressources initialement pr√©vues par les d√©veloppeurs de la console. <br><br>  Le sous-syst√®me de m√©moire, comme toute la famille MCS-48, est bas√© sur une architecture Harvard modifi√©e.  La m√©moire du programme est une ROM interne de 1024 octets, la m√©moire de donn√©es est de 64 octets de RAM dynamique. <br><br>  L'organisation de la RAM est illustr√©e dans la figure suivante: <br><br><img src="https://habrastorage.org/webt/ak/9m/2y/ak9m2y_m9qmrnnwbj8a8f55slf4.png"><br><br>  Les cellules 0 √† 7 occupent les registres de travail adress√©s directement R0 √† R7, R0 et R1 √©tant utilis√©s comme pointeurs pour un acc√®s indirect √† toutes les cellules RAM.  Les cellules 8-23 sont utilis√©es pour la pile d'appels √† 8 niveaux, bien qu'elles puissent √©galement √™tre utilis√©es via R0-R1. <br><br>  Le microcontr√¥leur a un g√©n√©rateur d'horloge int√©gr√©, la fr√©quence de r√©f√©rence est r√©gl√©e par une cha√Æne √† quartz externe, une cha√Æne RC ou une cha√Æne LC.  Un cycle machine dure 10 cycles et chaque cycle prend 3 p√©riodes de la fr√©quence de r√©f√©rence.  La fr√©quence maximale est de 3,58 MHz, tandis que le cycle machine dure 8,38 Œºs.  La fr√©quence minimale est limit√©e par les sp√©cificit√©s de la DRAM et est de 600 kHz. <br><br>  8021 contient deux ports 8 bits et un 4 bits, qui peuvent √©galement √™tre utilis√©s pour connecter un module d'extension de port d'E / S, la puce 8243. Tous les ports sont quasi bidirectionnels. <br><br>  De plus, le microcontr√¥leur a un temporisateur / compteur √† huit chiffres int√©gr√©.  En mode minuterie, le compteur T est incr√©ment√© de 1 tous les 32 cycles machine.  Au d√©bordement T, le drapeau TF est activ√©.  En mode compteur, les impulsions sont compt√©es sur l'entr√©e de test T1. <br><br>  Le syst√®me de commande contient 64 instructions, dont 36 sont ex√©cut√©es en un cycle et 28 en deux.  La plupart des instructions sont √† un octet. <br><br><div class="spoiler">  <b class="spoiler_title">Liste d'instructions avec de br√®ves descriptions</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dy/lw/hd/dylwhdauhna9z62ivd8z2slns-s.png"><br></div></div><br><h3>  La pr√©paration </h3><br>  Il n'y a eu aucun probl√®me avec l'achat de 8748, l'essentiel est de faire attention au fait que les puces ont √©t√© produites en utilisant diff√©rentes technologies.  Les premiers NMOP n√©cessitaient une tension de 25 V pour le micrologiciel, √©tiquet√© D8748.  √Ä la fin des ann√©es 70, ces microcontr√¥leurs ont commenc√© √† √™tre construits en utilisant la technologie HMOP-E (une version am√©lior√©e du NMOP d'Intel), √©taient √©tiquet√©s D8748H et n√©cessitaient d√©j√† 21V.  La m√™me tension a √©t√© requise par un clone ult√©rieur de NEC (mPD8748H).  La version programmable unique √©tait √©tiquet√©e P8748H. <br><br>  L'effaceur UV a √©t√© achet√© au chinois le plus simple et le moins cher avec une minuterie m√©canique qui, comme la pratique l'a montr√©, remplit parfaitement sa t√¢che (bien qu'il n'y ait pas de pr√©cision de minuterie √† de courts intervalles).  Il efface de mani√®re fiable la ROM des puces en ~ 2,5 minutes.  Plus tard, j‚Äôai achet√© une gomme ZAX Quick-EII √† un prix symbolique aupr√®s de mains japonaises, je ne sais m√™me pas de quelle ann√©e il s'agit, au regard du d√©but des ann√©es 90.  Il utilise un flash au x√©non et efface litt√©ralement 8748 en 3 (!) Secondes.  Une vid√©o (pas la mienne) avec une d√©monstration du travail peut √™tre vue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Le principal probl√®me √©tait le programmeur.  La prise en charge de cette famille Intel obsol√®te dans les programmeurs modernes n'est disponible qu'au co√ªt de 300 $.  Bien qu'il y ait un Willem amateur relativement bon march√© qui peut travailler avec le MCS-48 via un adaptateur, mais il a besoin de LPT, ce qui ne me convenait pas du tout.  J'ai d√ª me souder.  Je suis, disons, un radio-amateur novice, donc j'ai pass√© environ une semaine avec lui, abandonnant l'un des deux 8748 arriv√©s √† ce moment-l√† (bien que j'aime l'id√©e qu'elle √©tait √† l'origine comme √ßa).  J'ai pris <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le</a> circuit publi√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici comme</a> base, je ne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'</a> ai adapt√© qu'√† Atmega et √† une alimentation 24V plus pratique.  Tout cela a √©t√© soud√© sur une planche √† pain: <br><br><img src="https://habrastorage.org/webt/5c/tt/ut/5cttutbzs817thtcpq37vlakkx0.jpeg"><br><br>  Cela s'est av√©r√©, bien s√ªr, assez moche, et l'un des mosfets fonctionne √† la limite (m√™me un peu pour), mais, finalement, le programmeur a fait face √† sa t√¢che et m'a bien servi. <br><br>  Donc, tout est pr√™t, le firmware du test clignote joyeusement avec la LED, il est temps de faire une cartouche. <br><br><h3>  Cartouche </h3><br>  La majeure partie des cartouches fonctionnait sur le TMS1100, car  Signetics, qui a publi√© la licence Intel 8021 d'Intel, n'a pas pu fournir les puces MB requises.  M√™me certains jeux d√©j√† √©crits pour 8021 ont d√ª √™tre port√©s sur le TMS1100.  Incidemment, cela nous a permis d'abandonner le dangereux faisceau de deux batteries, car la consommation du microcontr√¥leur TI n'√©tait que de 0,1 W contre 1 W pour Intel.  Je n'ai qu'une des 6 cartouches avec 8021, c'est le jeu Connect Four, et il a √©t√© pris comme base. <br><br>  J'ai essay√© de rendre la planche aussi similaire √† l'original que possible, mais, bien s√ªr, j'ai d√ª apporter des modifications.  Tout d'abord, la taille de la puce (DIP-40 contre DIP-28) et un brochage diff√©rent.  Deuxi√®mement, nous avons d√ª changer les d√©nominations dans le circuit oscillatoire qui r√®gle la fr√©quence d'horloge, car  le cycle machine pour les versions HMOS des microcircuits est de 15 cycles et pour les versions MOS utilis√©es dans les cartouches d'origine, 30 cycles.  Par cons√©quent, pour une authenticit√© compl√®te, ma cartouche fonctionnera √† 1,25 MHz contre 2,5 MHz d'origine, tout en assurant les m√™mes performances. <br><br> <a href=""><img src="https://habrastorage.org/webt/bz/9f/zx/bz9fzxh_7-9-djp9yamoeog5tfe.jpeg"></a> <br><br>  Sur la photo ci-dessus, les circuits imprim√©s finis command√©s en Chine, et pendant qu'ils √©taient allum√©s, j'ai dessin√© et grav√© le circuit imprim√© et assembl√© un tel "complexe de d√©bogage": <br> <a href=""><img src="https://habrastorage.org/webt/yh/gx/vn/yhgxvntybge5njn2cw3dppmogrs.jpeg"></a> <br><br>  Enfin, la partie mat√©rielle est pr√™te et vous pouvez commencer la programmation. <br><br><h3>  Affichage </h3><br> <a href=""><img src="https://habrastorage.org/webt/wa/g6/jx/wag6jx-tblcypxvqvgmz-pwau_q.jpeg"></a> <br><br>  Tout d'abord, j'ai d√ª g√©rer la sortie vers l'√©cran LCD.  Comme je l'ai √©crit ci-dessus, il √©tait contr√¥l√© par le pilote Hughes 0488 en utilisant le multiplexage (r√©cemment un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> int√©ressant sur ce mode de contr√¥le LCD a √©t√© publi√© sur Habr√©).  C'est un pilote, pas un contr√¥leur, vous ne pouvez donc pas simplement allumer un pixel et vous d√©placer, vous devez constamment mettre √† jour le contenu de l'√©cran √† une fr√©quence de 30 √† 50 Hz avec des commandes de bas niveau. <br><br>  Le sch√©ma de connexion est le suivant: <br><br> <a href=""><img src="https://habrastorage.org/webt/ul/ym/rg/ulymrgc1oyensrme_-wjhprv2_u.png"></a> <br><br>  Brochage H0488: <br><br>  <b>Vdd</b> - Puissance (3-8V) <br>  <b>R1-R16</b> - Sorties de contr√¥le de cha√Æne <br>  <b>C1-C16</b> - Sorties de contr√¥le de colonne <br>  <b>DATA0-DATA3</b> - Bus de donn√©es <br>  <b>! Data Clk</b> - Entr√©e d'horloge d'enregistrement de donn√©es <br>  <b>Impulsion de verrouillage</b> - Signal d'√©tat de brochage R0-R15, C0-C15 <br><br>  La signification de la puce est la suivante: <br><br>  Gr√¢ce √† 4 lignes d'information, l'√©tat n√©cessaire des 32 sorties du microcircuit est d√©fini s√©quentiellement (16 par ligne et colonne).  C'est-√†-dire  nous indiquons en portions de 4 bits l'√©tat des sorties pour les lignes 1-4, puis 5-8, 9-12 et enfin pour 13-16, et aussi 4 fois en 4 bits nous indiquons l'√©tat des colonnes.  Chaque nouvelle donn√©e est cadenc√©e par une impulsion le long de la ligne! DATA CLK.  Apr√®s avoir envoy√© les 8 donn√©es, une impulsion sur la ligne Latch Pulse d√©finit l'√©tat indiqu√© des sorties R1-R16, C1-C16 qui seront maintenues jusqu'√† l'impulsion suivante sur cette ligne. <br><br>  Naturellement, dans un tel cycle, nous ne pouvons pas indiquer l'√©tat de chaque pixel individuel ind√©pendamment des autres, nous ne pouvons que 16 (par le nombre d'intersections de lignes avec des colonnes).  Par cons√©quent, pour mettre √† jour ind√©pendamment l'√©tat de chaque pixel, 256/16 = 16 cycles seront n√©cessaires. <br><br>  De plus, nous avons la responsabilit√© de changer la polarit√© pour √©liminer la tension constante des √©lectrodes LCD, sinon l'affichage se d√©gradera rapidement.  La commutation de polarit√© se produit sur le front arri√®re du signal sur l'impulsion de verrouillage √† une entr√©e basse! Horloge de donn√©es.  Il est recommand√© de changer la polarit√© avec le taux de rafra√Æchissement de l'√©cran. <br><br>  Ce qui pr√©c√®de est illustr√© par le chronogramme suivant √† partir d'une fiche technique: <br><br><img src="https://habrastorage.org/webt/58/ok/zu/58okzuokeat3bg6nf98bppvxpco.png"><br><br>  Tout cela, impl√©ment√© dans l'assembleur 8021 (qui, soit dit en passant, est consid√©rablement r√©duit par rapport √† l'assembleur du reste de la famille, le tout pour la m√™me authenticit√© que j'ai utilis√© uniquement des instructions prises en charge par 8021), cela pourrait ressembler √† ceci: <br><br><pre><code class="hljs ruby">mov R<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-comment"><span class="hljs-comment">#32 ;    . mov r1, #10000000b ;    r1-r2 mov r2, #00000000b ;  . mov r4, #00000010b ;    !DATA CLK. mov r3, #11110000b clr c loop: ;   r1-r16   . mov a, r1 ;   r1 loadNibble ;    R1-R4. mov a, r1 ;  4   r1 rrc a ;      , xch a, r1 ;    . swap a loadNibble ;    R5-R8. mov a, r2 ;   r2 loadNibble ;    R9-R12. mov a, r2 ;  4   r2 rrc a ;      ,  xch a, r2 ;  C,     . swap a loadNibble ;    R13-R16 ;   C1-C16     . mov a, </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@R</span></span></span><span class="hljs-comment">0 ;       loadNibble ;       C1-C4. mov a, </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@R</span></span></span><span class="hljs-comment">0 swap a ;   4 . loadNibble ;     C4-C8. inc R0 ;     mov a, </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@R</span></span></span><span class="hljs-comment">0 ;     , loadNibble ;      4 . mov a, </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@R</span></span></span><span class="hljs-comment">0 swap a ;   4 . loadNibble ;     C9-C12. inc R0 ;    inc a ;   R0-R15  C0-C15, outl p1, a ;  Latch Pulse  1. jnc loop ;      . clr a ; outl p1, a ; . inc a ; outl p1, a ; loadNibble macro anl a, r3 ;    . outl p1, a ;   . orl a, r4 outl p1, a ; !DATA CLK. endm</span></span></code> </pre> <br>  Ceci est ma version la plus rapide du sous-programme affichant l'image stock√©e dans la RAM.  Elle est r√©alis√©e en 1152 cycles machine (ce qui dans notre cas est ~ 12 Œºs). <br><br>  Le taux de rafra√Æchissement maximum de l'√©cran est d'environ 70 images par seconde (si le microcontr√¥leur ne fait rien d'autre), ce qui est fondamentalement redondant, donc, pour enregistrer les registres et les ROM, j'ai utilis√© d'autres routines dans la pratique - plus lentes et plus adapt√©es √† des t√¢ches sp√©cifiques.  Mais, √† cette fr√©quence, compte tenu de la grande inertie de cet affichage, il est possible d'afficher des images avec 4 d√©grad√©s de gris (comme un niblonog sur KPDV), changeant rapidement de trame.  Ou m√™me de courtes animations en quadrichromie: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jl/9v/1z/jl9v1zg4fi77u_67qendhuxbtt0.gif"></div><br>  Comme vous pouvez le voir, le contraste laisse beaucoup √† d√©sirer, il est particuli√®rement frappant lorsque toutes les lignes et colonnes sont impliqu√©es, mais il n'y a rien √† faire - les co√ªts de contr√¥le multiplex. <br><br><h3>  Clavier </h3><br> <a href=""><img src="https://habrastorage.org/webt/yh/96/k4/yh96k4mzlmmxlt7bczu5whiozcg.jpeg"></a> <br><br>  Ici, tout est beaucoup plus simple.  Les boutons sont regroup√©s dans une matrice de 4 lignes et 3 colonnes.  Les lignes sont connect√©es aux broches P0.4-P0.7, les colonnes sont connect√©es √† P0.0-P0.2. <br><br> <a href=""><img src="https://habrastorage.org/webt/zk/2b/cy/zk2bcyshihgdt_h5ygvmxyu4gqw.png"></a> <br><br>  Comme je l'ai not√© ci-dessus, les ports du 8021 sont quasi-bidirectionnels, donc, pour conna√Ætre l'√©tat des terminaux, vous devez d'abord leur envoyer des unit√©s.  C'est-√†-dire  lors de la saisie des donn√©es, une conjonction se produit entre les signaux d'entr√©e et le contenu du tampon, ce qui correspond aux derni√®res donn√©es affich√©es sur le port.  Un sondage au clavier ressemble √† ceci: <br><br><pre> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">mov</span></span> a, <span class="hljs-comment"><span class="hljs-comment">#01111111b ; 0        1, outl p0, a ; ,      . in a, p0 ; , 0       ;     </span></span></code> </pre><br><h3>  Paddle </h3><br> <a href=""><img src="https://habrastorage.org/webt/4n/ck/j1/4nckj1to9wuxdqnp4qbuzr4zrku.jpeg"></a> <br><br>  Ou, en russe, la molette de manipulation install√©e dans la partie inf√©rieure de la console est une r√©sistance variable de 10 kŒ© avec une poign√©e d√©corative, qui peut √™tre tourn√©e pour contr√¥ler quelque chose dans le jeu.  Bien s√ªr, il n'y avait aucun ADC dans le 8021 ou le TMS1100.  L'angle de rotation a √©t√© d√©termin√© par la vitesse de charge du condensateur, qui a √©t√© soigneusement soud√© √† la carte console. <br><br> <a href=""><img src="https://habrastorage.org/webt/he/kh/k2/hekhk2fa7hrnv1odcm5lxximh7m.png"></a> <br><br>  Tout fonctionne comme suit: alors que les broches P2.2-P2.3 sont hautes, le condensateur est d√©charg√© et l'unit√© logique est √† l'entr√©e de test T1.  Apr√®s avoir r√©gl√© les broches P2.2-P2.3 √† un niveau bas, le condensateur commencera √† se charger et apr√®s un certain temps, d√©pendant exponentiellement de la r√©sistance de la r√©sistance variable, la chute de tension √† travers elle deviendra telle que T1 est r√©gl√© sur 0. Il ne reste plus qu'√† d√©tecter l'heure jusqu'√† l'apparition de z√©ro sur T1, qui sera proportionnel √† l'angle de rotation de la palette (Plus de d√©tails et plus int√©ressants sur de tels sch√©mas peuvent √™tre trouv√©s dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DI HALT'a</a> ).  Dans le code, cela pourrait ressembler √† ceci: <br><br><pre> <code class="hljs css"> <span class="hljs-selector-tag"><span class="hljs-selector-tag">clr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r1</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">outl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">p2</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> ; 0  <span class="hljs-selector-tag"><span class="hljs-selector-tag">P2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2-P2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">loop</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">inc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r1</span></span> ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">r1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jt1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">loop</span></span> ;  <span class="hljs-selector-tag"><span class="hljs-selector-tag">T1</span></span>  <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#00110000b</span></span> ; 1  <span class="hljs-selector-tag"><span class="hljs-selector-tag">P2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2-P2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">outl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">p2</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> ;    </code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ir/2c/1y/ir2c1yukhpzppj3h9jznphe_s-k.gif"></div><br><br><h3>  Son </h3><br>  Ici, c'est assez simple, une pi√©zodynamique est connect√©e aux deux lignes du port P2.0 et P2.1, tout ce que nous avons √† faire est alternativement de branler les jambes avec la bonne fr√©quence. <br><br><h3>  Qu'est-il arriv√©? </h3><br>  En cons√©quence, j'ai √©crit deux jeux - Tetris et une sorte de Flappy Bird.  Pour le d√©bogage, j'ai utilis√© Intel D8748H et un clone de NEC D8749HD ne diff√©rant que par la taille de la ROM.  J'ai utilis√© l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">environnement de d√©veloppement int√©gr√© 8048</a> comme assembleur et d√©bogueur.  Dans le processus, j'ai eu une exp√©rience inoubliable - le flux constant de microcontr√¥leurs de la console √† la gomme, de la gomme au programmateur, et de l√† √† la console, et tout cela s'accompagne d'une odeur hospitali√®re d'air ionis√© ultraviolet ... <br><br>  J'ai not√© les programmes finis dans le P8748H Intel une fois programmable que j'ai soud√© sur les cartes de circuits imprim√©s qui √©taient arriv√©es √† ce moment-l√†. <br><br> <a href=""><img src="https://habrastorage.org/webt/_p/f8/oo/_pf8ool9qniaa7--uotj-o-bx6i.jpeg"></a> <br>  <i>Comparaison avec les cartes d'origine, de gauche √† droite: Block Buster, My option, Connect Four</i> <br><br>  J'ai d√ª utiliser l'original comme √©tui; je n'avais qu'une seule des deux cartouches disponibles pour le jeu Block Buster s'est av√©r√©e √™tre inop√©rante. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/9gqDIIBmB2c" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  La coque n'√©tait pas suffisante pour le deuxi√®me match: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zir4Owh1Pxc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Conclusion </h3><br>  Microvision MB a √©t√© produit avant 1981, et bien que les ventes au d√©but aient √©t√© assez r√©ussies, un petit nombre de jeux (13 cartouches ont √©t√© lanc√©es au total) et des probl√®mes de qualit√© sont g√©n√©ralement appel√©s les raisons de la baisse des ventes.  J'ajouterais √† cela une taille excessivement grande, surtout par rapport √† la s√©rie Nintendo Game &amp; Watch qui est alors apparue et est devenue un succ√®s. <br><br>  Codes source et sch√©mas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publi√©s sur GitHub</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416865/">https://habr.com/ru/post/fr416865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416851/index.html">Hibernate - de quoi les didacticiels sont muets</a></li>
<li><a href="../fr416855/index.html">Baccalaur√©at de l'Universit√© d'√âtat de Saint-P√©tersbourg</a></li>
<li><a href="../fr416857/index.html">Nous construisons des temples - dans le code et dans la vie. Mon exp√©rience dans le d√©veloppement de ma deuxi√®me application Android</a></li>
<li><a href="../fr416859/index.html">Meet All at Once React Boilerplate par Maximilian Stoiber v3.6.0</a></li>
<li><a href="../fr416863/index.html">Une nouvelle fa√ßon de pr√©senter les exposants</a></li>
<li><a href="../fr416867/index.html">Les chercheurs ont cr√©√© un dispositif pour les attaques locales contre les syst√®mes SCADA</a></li>
<li><a href="../fr416871/index.html">J'en ai assez d'accepter les paiements via WebView. Que dois-je faire?</a></li>
<li><a href="../fr416877/index.html">Gestion de l'infrastructure d'impression</a></li>
<li><a href="../fr416879/index.html">Bureau Agile: o√π h√©berger des milliers de d√©veloppeurs?</a></li>
<li><a href="../fr416881/index.html">Introduction aux contrats intelligents. Leurs limites potentielles et r√©elles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>