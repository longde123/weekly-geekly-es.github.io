<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ… ğŸ‘‹ğŸ¿ ğŸ‘‡ğŸ¾ é€‚ç”¨äºRustï¼ŒCæˆ–ä»»ä½•å…¶ä»–è¯­è¨€çš„Starcraftæœºå™¨äºº ğŸ›‚ â™ ï¸ â„¹ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã€Šæ˜Ÿé™…äº‰éœ¸ï¼šå·¢ç©´ä¹‹æˆ˜ã€‹ ã€‚ è¿™ä¸ªæ¸¸æˆå¯¹æˆ‘æ¥è¯´æ„ä¹‰éå‡¡ï¼ æˆ‘æƒ³å¯¹ä½ ä»¬ä¸­çš„è®¸å¤šäººæ¥è¯´ã€‚ å¦‚æ­¤ä¹‹å¤šï¼Œæˆ‘æƒ³çŸ¥é“æ˜¯å¦åº”è¯¥åœ¨Wikipediaä¸Šæä¾›å…¶é¡µé¢çš„é“¾æ¥ã€‚ 


 ä¸€æ¬¡éœå°”ç‰¹ç»™æˆ‘å‘äº†PMå¹¶æè®®å­¦ä¹ Rust ã€‚ åƒä»»ä½•æ™®é€šäººä¸€æ ·ï¼Œæˆ‘ä»¬å†³å®šä»  ä½ å¥½ä¸–ç•Œ  ä¸ºWindowsç¼–å†™ä¸€ä¸ªåŠ¨æ€åº“ï¼Œè¯¥åº“å¯ä»¥åŠ è½½åˆ°St...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>é€‚ç”¨äºRustï¼ŒCæˆ–ä»»ä½•å…¶ä»–è¯­è¨€çš„Starcraftæœºå™¨äºº</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436254/"><img src="https://habrastorage.org/webt/qv/fa/ex/qvfaexsnkzmckmwrt_spqmc7nr4.png" align="left"><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ã€Šæ˜Ÿé™…äº‰éœ¸ï¼šå·¢ç©´ä¹‹æˆ˜ã€‹</a> ã€‚ è¿™ä¸ªæ¸¸æˆå¯¹æˆ‘æ¥è¯´æ„ä¹‰éå‡¡ï¼ æˆ‘æƒ³å¯¹ä½ ä»¬ä¸­çš„è®¸å¤šäººæ¥è¯´ã€‚ å¦‚æ­¤ä¹‹å¤šï¼Œæˆ‘æƒ³çŸ¥é“æ˜¯å¦åº”è¯¥åœ¨Wikipediaä¸Šæä¾›å…¶é¡µé¢çš„é“¾æ¥ã€‚ </p><br><p> ä¸€æ¬¡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">éœå°”ç‰¹</a>ç»™æˆ‘å‘äº†PMå¹¶æè®®å­¦ä¹ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rust</a> ã€‚ åƒä»»ä½•æ™®é€šäººä¸€æ ·ï¼Œæˆ‘ä»¬å†³å®šä» <del> ä½ å¥½ä¸–ç•Œ </del> ä¸ºWindowsç¼–å†™ä¸€ä¸ªåŠ¨æ€åº“ï¼Œè¯¥åº“å¯ä»¥åŠ è½½åˆ°StarCraftçš„åœ°å€ç©ºé—´ä¸­å¹¶ç®¡ç†å•å…ƒã€‚ </p><br><p> ä¸‹é¢çš„æ–‡ç« å°†æè¿°å¯»æ‰¾è§£å†³æ–¹æ¡ˆä»¥åŠä½¿ç”¨å…è®¸æ‚¨å­¦ä¹ RuståŠå…¶ç”Ÿæ€ç³»ç»Ÿæ–°äº‹ç‰©çš„æŠ€æœ¯çš„è¿‡ç¨‹ã€‚ å¯èƒ½è¿˜ä¼šå¯å‘æ‚¨ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„è¯­è¨€ï¼ˆæ— è®ºæ˜¯Cï¼ŒC ++ï¼ŒRubyï¼ŒPythonç­‰ï¼‰æ¥å®ç°æœºå™¨äººã€‚ </p><a name="habracut"></a><br><p> é˜…è¯»æœ¬æ–‡æ—¶ï¼Œç»å¯¹å€¼å¾—å¬å¬éŸ©å›½çš„èµç¾è¯—ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">æ˜Ÿé™…äº‰éœ¸OST</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/pNt0iVG2VOA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><h2 id="bwapi"> å¸ƒç“¦çš® </h2><br><p> è¿™åœºæ¯”èµ›å·²ç»æœ‰20å¹´å†å²äº†ã€‚ è€Œä¸”ä»ç„¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¾ˆå—æ¬¢è¿</a> ; ç”šè‡³<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨2017å¹´</a> ï¼Œå† å†›äº‰å¤ºæˆ˜åœ¨ç¾å›½ä¹Ÿå¼•èµ·äº†äººä»¬çš„æ³¨æ„ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨</a>é‚£é‡Œå¤§å¸ˆçº§çš„Jaedongä¸Bisuçš„æˆ˜æ–—å‘ç”Ÿäº†ã€‚ é™¤äº†äººç±»ç©å®¶ä¹‹å¤–ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¯«æ— çµé­‚çš„æœºå™¨</a>è¿˜å‚åŠ äº†SCæˆ˜æ–—ï¼ ç”±äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BWAPI</a> ï¼Œè¿™æ˜¯å¯èƒ½çš„ã€‚ æ›´æœ‰ç”¨çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é“¾æ¥</a> ã€‚ </p><br><p> åå¤šå¹´æ¥ï¼Œå›´ç»•è¿™ä¸ªæ¸¸æˆçš„æœºå™¨äººå¼€å‘è€…ç¤¾åŒºå·²ç»å‡ºç°ã€‚ çƒ­å¿ƒè€…åˆ›é€ æœºå™¨äººå¹¶å‚åŠ å„ç§é”¦æ ‡èµ›ã€‚ ä»–ä»¬ä¸­çš„è®¸å¤šäººéƒ½å­¦ä¹ AIå’Œæœºå™¨å­¦ä¹ ã€‚ å¤§å­¦ä½¿ç”¨BWAPIè®­ç»ƒå­¦ç”Ÿã€‚ ç”šè‡³è¿˜æœ‰ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æŠ½æé¢‘é“</a>æ’­æ”¾æ­¤ç±»æ¯”èµ›ã€‚ </p><br><p> å› æ­¤ï¼Œå‡ å¹´å‰ï¼Œä¸€ä¸ªç²‰ä¸å›¢é˜Ÿæ‰­è½¬äº†æ˜Ÿé™…äº‰éœ¸çš„åç«¯ï¼Œå¹¶å¼€å‘äº†C ++ APIï¼Œè¯¥APIå¯è®©æ‚¨åˆ›å»ºæœºå™¨äººï¼Œåœ¨æ¸¸æˆè¿‡ç¨‹ä¸­è¿›è¡Œæ³¨å…¥å¹¶æ§åˆ¶å¯æ‚²çš„äººç±»ã€‚ </p><br><p> ç»å¸¸å‘ç”Ÿ <del> ç›–æˆ¿å­ï¼Œæœ‰å¿…è¦å¼€é‡‡çŸ¿çŸ³ï¼Œé”»é€ å·¥å…· </del> åˆ›å»ºä¸€ä¸ªæœºå™¨äººï¼Œæ‚¨éœ€è¦å®ç°ä¸€ä¸ªAPIã€‚  Rustå¿…é¡»æä¾›ä»€ä¹ˆï¼Ÿ </p><br><h2 id="ffi"> è”é‚¦è°ƒæŸ¥å±€ </h2><br><p> ä½¿ç”¨Rustä¸­çš„å…¶ä»–è¯­è¨€éå¸¸ç®€å•ã€‚ ä¸ºæ­¤æœ‰ä¸€ä¸ª<abbr title="å¤–éƒ¨åŠŸèƒ½ç•Œé¢">FFI</abbr> ã€‚ è®©æˆ‘ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>æ‘˜å½•<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ä¸‹</a> ã€‚ </p><br><p> æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¿«ç…§</a>åº“ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå¤´æ–‡ä»¶<a href="">snappy-ch</a> ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å£°æ˜ã€‚ </p><br><p> è®©æˆ‘ä»¬ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cargo</a>åˆ›å»ºä¸€ä¸ªé¡¹ç›®ã€‚ </p><br><pre><code class="bash hljs">$ cargo new --bin snappy Created binary (application) `snappy` project $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> snappy snappy$ tree . â”œâ”€â”€ Cargo.toml â””â”€â”€ src â””â”€â”€ main.rs 1 directory, 2 files</code> </pre> <br><p>  Cargoä¸ºè¯¥é¡¹ç›®åˆ›å»ºäº†æ ‡å‡†æ–‡ä»¶ç»“æ„ã€‚ </p><br><p> åœ¨<code>Cargo.toml</code>æˆ‘ä»¬æŒ‡å®šå¯¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libcçš„</a>ä¾èµ–å…³ç³»ï¼š </p><br><pre> <code class="plaintext hljs">[dependencies] libc = "0.2"</code> </pre> <br><p>  <code>src/main.rs</code>æ–‡ä»¶å°†å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> libc; <span class="hljs-comment"><span class="hljs-comment">// To import C types, in our case for size_t use libc::size_t; #[link(name = "snappy")] // Specify the name of the library for linking the function extern { // We write the declaration of the function which we want to import // in C the declaration looks like this: // size_t snappy_max_compressed_length(size_t source_length); fn snappy_max_compressed_length(source_length: size_t) -&gt; size_t; } fn main() { let x = unsafe { snappy_max_compressed_length(100) }; println!("max compressed length of a 100 byte buffer: {}", x); }</span></span></code> </pre> <br><p> è®©æˆ‘ä»¬æ„å»ºå¹¶è¿è¡Œé¡¹ç›®ï¼š </p><br><pre> <code class="bash hljs">snappy$ cargo build ... snappy$ cargo run Finished dev [unoptimized + debuginfo] target(s) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.02s Running `target/debug/snappy` max compressed length of a 100 byte buffer: 148</code> </pre> <br><p> æ‚¨åªèƒ½å«<code>cargo run</code> ï¼Œè¿™è¦åœ¨è¿è¡Œå‰å«<code>cargo build</code> ã€‚ å¦ä¸€ç§é€‰æ‹©æ˜¯æ„å»ºé¡¹ç›®å¹¶ç›´æ¥è°ƒç”¨äºŒè¿›åˆ¶æ–‡ä»¶ï¼š </p><br><pre> <code class="bash hljs">snappy$ ./target/debug/snappy max compressed length of a 100 byte buffer: 148</code> </pre> <br><p> å¦‚æœå·²å®‰è£…snappyåº“ï¼Œåˆ™å°†ç¼–è¯‘ä»£ç ï¼ˆå¯¹äºUbuntuï¼Œåº”å®‰è£…libsnappy-devè½¯ä»¶åŒ…ï¼‰ã€‚ </p><br><pre> <code class="bash hljs">snappy$ ldd target/debug/snappy ... libsnappy.so.1 =&gt; /usr/lib/x86_64-linux-gnu/libsnappy.so.1 (0x00007f8de07cf000)</code> </pre> <br><p> å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬çš„äºŒè¿›åˆ¶æ–‡ä»¶é“¾æ¥åˆ°libsnappyå…±äº«åº“ã€‚ åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­å¯¹<code>snappy_max_compressed_length</code>çš„è°ƒç”¨æ˜¯ä»è¯¥åº“è¿›è¡Œçš„å‡½æ•°è°ƒç”¨ã€‚ </p><br><h2 id="rust-bindgen"> é”ˆç»“åˆ </h2><br><p> å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè‡ªåŠ¨ç”ŸæˆFFIï¼Œé‚£å°†æ˜¯å¾ˆå¥½çš„ã€‚ å¹¸è¿çš„æ˜¯ï¼ŒRustç˜¾å›å­çš„å·¥å…·ç®±ä¸­æœ‰ä¸€ä¸ªåä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rust-bindgen</a>çš„å®ç”¨ç¨‹åºã€‚ å®ƒèƒ½å¤Ÿç”Ÿæˆä¸Cï¼ˆå’ŒæŸäº›C ++ï¼‰åº“çš„FFIç»‘å®šã€‚ </p><br><p> å®‰è£…æ–¹å¼ï¼š </p><br><pre> <code class="bash hljs">$ cargo install bindgen</code> </pre> <br><p>  <strong>é”ˆèŒç»“åˆç´ </strong>çœ‹èµ·æ¥åƒä»€ä¹ˆï¼Ÿ æˆ‘ä»¬ä½¿ç”¨C / C ++å¤´æ–‡ä»¶ï¼Œå°†<strong>bindgen</strong>å®ç”¨ç¨‹åºæŒ‡å‘å®ƒä»¬ï¼Œç„¶åå°†è·å¾—çš„è¾“å‡ºç”Ÿæˆå¸¦æœ‰é€‚å½“å£°æ˜çš„Rustä»£ç ï¼Œä»¥ä½¿æˆ‘ä»¬ä½¿ç”¨Cç»“æ„å’Œå‡½æ•°ã€‚ è¿™æ˜¯<code>bindgen</code>ä¸º<code>bindgen</code>ç”Ÿæˆçš„ï¼š </p><br><pre> <code class="rust hljs">$ bindgen /usr/include/snappy-ch | grep -C <span class="hljs-number"><span class="hljs-number">1</span></span> snappy_max_compressed_length <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">snappy_max_compressed_length</span></span></span></span>(source_length: <span class="hljs-built_in"><span class="hljs-built_in">usize</span></span>) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">usize</span></span>; }</code> </pre> <br><p> äº‹å®è¯æ˜ï¼Œbindgenæ— æ³•åº”ä»˜BWAPIæ ‡å¤´ï¼Œç”Ÿæˆå¤§é‡ä¸å¯ç”¨çš„ä»£ç ï¼ˆç”±äºè™šæ‹Ÿæˆå‘˜å‡½æ•°ï¼Œå…¬å…±APIä¸­çš„std ::å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚ äº‹å®æ˜¯BWAPIç”¨C ++ç¼–å†™ã€‚ å³ä½¿åœ¨C ++é¡¹ç›®ä¸­ï¼ŒC ++é€šå¸¸ä¹Ÿå¾ˆéš¾ä½¿ç”¨ã€‚ åº“ç»„è£…å®Œæˆåï¼Œæœ€å¥½ä½¿ç”¨ç›¸åŒçš„é“¾æ¥å™¨ï¼ˆç›¸åŒç‰ˆæœ¬ï¼‰é“¾æ¥å®ƒï¼Œå¤´æ–‡ä»¶åº”ä½¿ç”¨ç›¸åŒçš„ç¼–è¯‘å™¨ï¼ˆç›¸åŒç‰ˆæœ¬ï¼‰è¿›è¡Œè§£æã€‚ æ‰€æœ‰è¿™äº›å› ç´ éƒ½å¯èƒ½å½±å“ç»“æœã€‚ ä¾‹å¦‚ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‡æ•´</a> ï¼Œä»ç„¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ— æ³•</a>åœ¨GNU GCCä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ²¡æœ‰é”™è¯¯åœ°å®ç°</a> ã€‚ è¿™äº›å› ç´ éå¸¸é‡è¦ï¼Œç”šè‡³<abbr title="Googleçš„C ++æµ‹è¯•æ¡†æ¶">gtest</abbr>ä¹Ÿæ— æ³•å…‹æœã€‚ å¹¶ä¸”åœ¨<a href="">æ–‡æ¡£ä¸­</a>è¯´ï¼šæ‚¨æœ€å¥½ä½¿ç”¨ç›¸åŒçš„ç¼–è¯‘å™¨å’Œç›¸åŒçš„é“¾æ¥å™¨å°†gtestæ„å»ºä¸ºé¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚ </p><br><h2 id="bwapi-c"> å¸ƒç“¦æ¯”å…‹ </h2><br><p>  Cæ˜¯è½¯ä»¶å·¥ç¨‹çš„é€šç”¨è¯­ã€‚ å¦‚æœrust-bindgené€‚ç”¨äºCè¯­è¨€ï¼Œä¸ºä»€ä¹ˆä¸ä¸ºCå®ç°BWAPIï¼Œç„¶åä½¿ç”¨å…¶APIï¼Ÿ å¥½ä¸»æ„ï¼ </p><br><p> æ˜¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œç›´â€‹â€‹åˆ°æ‚¨æ·±å…¥ç ”ç©¶BWAPIçš„å†…éƒ¨å¹¶çœ‹åˆ°åº”è¯¥å®ç°çš„ç±»å’Œæ–¹æ³•çš„æ•°é‡ã€‚ ç‰¹åˆ«æ˜¯æ‰€æœ‰è¿™äº›æˆ‘ä»¬æ²¡æœ‰æ—¶é—´è¿›è¡Œçš„å†…å­˜å¸ƒå±€ï¼Œasmä»£ç ï¼Œå†…å­˜ä¿®è¡¥å’Œå…¶ä»–â€œææ€–â€ã€‚ æœ‰å¿…è¦å®Œå…¨ä½¿ç”¨ç°æœ‰è§£å†³æ–¹æ¡ˆã€‚ </p><br><p> ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä»¥æŸç§æ–¹å¼å‡»è´¥æ··ä¹±ï¼ŒC ++ä»£ç ï¼Œç»§æ‰¿å’Œè™šæ‹Ÿæˆå‘˜å‡½æ•°ã€‚ </p><br><p> åœ¨C ++ä¸­ï¼Œæœ‰ä¸¤ä¸ªåŠŸèƒ½å¼ºå¤§çš„å·¥å…·<code>extern "C"</code>æ¥è§£å†³é—®é¢˜ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸é€æ˜çš„æŒ‡é’ˆ</a>å’Œ<code>extern "C"</code> ã€‚ </p><br><p>  <code>extern "C" {}</code>å…è®¸C ++ä»£ç åœ¨Cè¯­è¨€ä¸‹â€œå±è”½â€è‡ªèº«ã€‚å®ƒå¯ä»¥ç”Ÿæˆå‡½æ•°åç§°è€Œæ— éœ€å¤„ç†ã€‚ </p><br><p> ä¸é€æ˜çš„æŒ‡é’ˆä½¿æˆ‘ä»¬å¯ä»¥æ¸…é™¤ç±»å‹å¹¶åˆ›å»ºæŒ‡å‘â€œæŸç§ç±»å‹â€çš„æŒ‡é’ˆï¼Œè€Œæ— éœ€æä¾›å…¶å®ç°ã€‚ ç”±äºè¿™åªæ˜¯æŸç§ç±»å‹çš„å£°æ˜ï¼Œå› æ­¤æ— æ³•é€šè¿‡å€¼ä½¿ç”¨æ­¤ç±»å‹ï¼Œåªèƒ½é€šè¿‡æŒ‡é’ˆä½¿ç”¨å®ƒã€‚ </p><br><p> å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹C ++ä»£ç ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> cpp { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bar; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_bar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;bar; } }; } <span class="hljs-comment"><span class="hljs-comment">// namespace cpp</span></span></code> </pre> <br><p> æˆ‘ä»¬å¯ä»¥å°†å…¶è½¬æ¢ä¸ºCæ ‡å¤´ï¼š </p><br><pre> <code class="plaintext hljs">extern "C" { typedef struct Foo_ Foo; // Opaque pointer to Foo // call cpp::Foo::get_bar int Foo_get_bar(Foo* self); }</code> </pre> <br><p> è¿™æ˜¯C ++éƒ¨åˆ†ï¼Œå®ƒå°†æˆä¸ºCæ ‡å¤´å’ŒC ++å®ç°ä¹‹é—´çš„é“¾æ¥ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Foo_get_bar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Foo* self)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// cast the opaque pointer to the certain cpp::Foo and call the method ::get_bar return reinterpret_cast&lt;cpp::Foo*&gt;(self)-&gt;get_bar(); }</span></span></code> </pre> <br><p> å¹¶éæ‰€æœ‰çš„ç±»æ–¹æ³•éƒ½å¿…é¡»ä»¥è¿™ç§æ–¹å¼å¤„ç†ã€‚ åœ¨BWAPIä¸­ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›ç»“æ„çš„å­—æ®µæ¥å®ç°è‡ªå·±çš„ç±»ï¼Œä¾‹å¦‚<code>typedef struct Position { int x; int y; } Position;</code> <code>typedef struct Position { int x; int y; } Position;</code> ä»¥åŠ<code>Position::get_distance</code>ç±»çš„æ–¹æ³•ã€‚ </p><br><p> æœ‰äº›è¯¾ç¨‹æˆ‘å¿…é¡»ä»¥ç‰¹æ®Šçš„æ–¹å¼å¯¹å¾…ã€‚ ä¾‹å¦‚ï¼ŒAIModuleåº”è¯¥æ˜¯æŒ‡å‘å…·æœ‰ç‰¹å®šè™šæ‹Ÿæˆå‘˜å‡½æ•°é›†çš„C ++ç±»çš„æŒ‡é’ˆã€‚ ä¸è¿‡ï¼Œè¿™æ˜¯<a href="">æ ‡é¢˜</a>å’Œ<a href="">å®ç°</a> ã€‚ </p><br><p> å› æ­¤ï¼Œç»è¿‡å‡ ä¸ªæœˆçš„åŠªåŠ›ï¼Œ <strong>554</strong>ç§æ–¹æ³•å’Œåå‡ ä¸ªç±»ï¼Œè·¨å¹³å°åº“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BWAPI-C</a>è¯ç”Ÿäº†ï¼Œå®ƒä½¿æ‚¨<a href="">å¯ä»¥ç”¨Cåˆ›å»ºæœºå™¨äººã€‚</a> å‰¯äº§å“æ˜¯äº¤å‰ç¼–è¯‘çš„å¯èƒ½æ€§ä»¥åŠä»¥æ”¯æŒFFIå’Œcdeclè°ƒç”¨çº¦å®šçš„ä»»ä½•å…¶ä»–è¯­è¨€å®ç°APIçš„èƒ½åŠ›ã€‚ </p><br><p> å¦‚æœè¦ç¼–å†™åº“ï¼Œè¯·ä½¿ç”¨Cç¼–å†™å…¶APIã€‚ </p><br><p>  BWAPI-Cçš„æœ€é‡è¦åŠŸèƒ½æ˜¯ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„å°½å¯èƒ½å¹¿æ³›çš„é›†æˆã€‚  <code>Python</code> ï¼Œ <code>Ruby</code> ï¼Œ <code>Rust</code> ï¼Œ <code>PHP</code> ï¼Œ <code>Java</code>å’Œè®¸å¤šå…¶ä»–åŠŸèƒ½éƒ½å¯ä»¥ä½¿ç”¨Cï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨è§£å†³äº†ä¸€äº›éš¾é¢˜å¹¶å®ç°äº†è‡ªå·±çš„åŒ…è£…å™¨ï¼Œåˆ™è¿˜å¯ä»¥åœ¨å®ƒä»¬çš„å¸®åŠ©ä¸‹ç¼–å†™ä¸€ä¸ªæœºå™¨äººã€‚ </p><br><h2 id="writing-a-bot-in-c"> ç”¨Cç¼–å†™æœºå™¨äºº </h2><br><p> æœ¬éƒ¨åˆ†æè¿°äº†Starcraftæ¨¡å—å†…éƒ¨ç»„ç»‡çš„ä¸€èˆ¬åŸç†ã€‚ </p><br><p> æœºå™¨äººæœ‰2ç§ç±»å‹ï¼šæ¨¡å—å’Œå®¢æˆ·ç«¯ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç¼–å†™æ¨¡å—çš„ä¾‹å­ã€‚ </p><br><p> è¯¥æ¨¡å—æ˜¯ä¸€ä¸ªåŠ¨æ€åº“ã€‚ åŠ è½½åŠ¨æ€åº“çš„ä¸€èˆ¬åŸç†å¯ä»¥åœ¨<a href="">è¿™é‡Œ</a>æŸ¥çœ‹ã€‚ è¯¥æ¨¡å—åº”å¯¼å‡º2ä¸ªå‡½æ•°ï¼š <code>newAIModule</code>å’Œ<code>gameInit</code> ã€‚ </p><br><p>  <code>gameInit</code>å¾ˆå®¹æ˜“ã€‚ è°ƒç”¨æ­¤å‡½æ•°å¯å°†æŒ‡é’ˆä¼ é€’ç»™å½“å‰æ¸¸æˆã€‚ è¯¥æŒ‡é’ˆéå¸¸é‡è¦ï¼Œå› ä¸ºåœ¨ä»£ç çš„æŸäº›éƒ¨åˆ†ä¸­ä½¿ç”¨äº†BWAPIçš„é€šé…ç¬¦ï¼Œå…¶ä¸­åŒ…å«å…¨å±€é™æ€å˜é‡ã€‚ è®©æˆ‘ä»¬æè¿°<code>gameInit</code> ï¼š </p><br><pre> <code class="plaintext hljs">DLLEXPORT void gameInit(void* game) { BWAPIC_setGame(game); }</code> </pre> <br><p>  <code>newAIModule</code>æœ‰ç‚¹å¤æ‚ã€‚ å®ƒåº”è¯¥è¿”å›æŒ‡å‘C ++ç±»çš„æŒ‡é’ˆï¼Œè¯¥ç±»å…·æœ‰ä¸€ä¸ªè™šæ‹Ÿæ–¹æ³•è¡¨ï¼Œå…¶åç§°ç±»ä¼¼äº<strong>onXXXXX</strong> ï¼Œåœ¨æŸäº›æ¸¸æˆäº‹ä»¶ä¸­ä¼šè¢«è°ƒç”¨ã€‚ è®©æˆ‘ä»¬å£°æ˜æ¨¡å—çš„ç»“æ„ï¼š </p><br><pre> <code class="plaintext hljs">typedef struct ExampleAIModule { const AIModule_vtable* vtable_; const char* name; } ExampleAIModule;</code> </pre> <br><p> ç¬¬ä¸€ä¸ªå­—æ®µåº”è¯¥æ˜¯æŒ‡å‘æ–¹æ³•è¡¨çš„æŒ‡é’ˆï¼ˆè¿™æ˜¯ä¸€ç§é­”æœ¯ï¼‰ã€‚ è¿™æ˜¯<code>newAIModule</code>å‡½æ•°ï¼š </p><br><pre> <code class="plaintext hljs">DLLEXPORT void* newAIModule() { ExampleAIModule* const module = (ExampleAIModule*) malloc( sizeof(ExampleAIModule) ); module-&gt;name = "ExampleAIModule"; module-&gt;vtable_ = &amp;module_vtable; return createAIModuleWrapper( (AIModule*) module ); }</code> </pre> <br><p>  <code>createAIModuleWrapper</code>æ˜¯å¦ä¸€ä¸ªé­”æœ¯ï¼Œå¯ä»¥å°†CæŒ‡é’ˆè½¬æ¢ä¸ºæŒ‡å‘C ++ç±»çš„æŒ‡é’ˆï¼Œ <del> è™šæ–¹æ³• </del> æˆå‘˜å‡½æ•°ã€‚ </p><br><p>  <code>module_vtable</code>æ˜¯æ–¹æ³•è¡¨ä¸Šçš„é™æ€å˜é‡ï¼Œæ–¹æ³•å€¼å¡«å……æœ‰æŒ‡å‘å…¨å±€å‡½æ•°çš„æŒ‡é’ˆï¼š </p><br><pre> <code class="plaintext hljs">static AIModule_vtable module_vtable = { onStart, onEnd, onFrame, onSendText, onReceiveText, onPlayerLeft, onNukeDetect, onUnitDiscover, onUnitEvade, onUnitShow, onUnitHide, onUnitCreate, onUnitDestroy, onUnitMorph, onUnitRenegade, onSaveGame, onUnitComplete }; void onEnd(AIModule* module, bool isWinner) { } void onFrame(AIModule* module) {} void onSendText(AIModule* module, const char* text) {} void onReceiveText(AIModule* module, Player* player, const char* text) {} void onPlayerLeft(AIModule* module, Player* player) {} void onNukeDetect(AIModule* module, Position target) {} void onUnitDiscover(AIModule* module, Unit* unit) {} void onUnitEvade(AIModule* module, Unit* unit) {} void onUnitShow(AIModule* module, Unit* unit) {} void onUnitHide(AIModule* module, Unit* unit) {} void onUnitCreate(AIModule* module, Unit* unit) {} void onUnitDestroy(AIModule* module, Unit* unit) {} void onUnitMorph(AIModule* module, Unit* unit) {} void onUnitRenegade(AIModule* module, Unit* unit) {} void onSaveGame(AIModule* module, const char* gameName) {} void onUnitComplete(AIModule* module, Unit* unit) {}</code> </pre> <br><p> å¦‚æœæŸ¥çœ‹å‡½æ•°çš„åç§°åŠå…¶ç­¾åï¼Œåˆ™å¾ˆæ¸…æ¥šåœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ä»¥åŠéœ€è¦ä½¿ç”¨å“ªäº›å‚æ•°è°ƒç”¨å®ƒä»¬ã€‚  <a href="">ä¾‹å¦‚ï¼Œ</a>æˆ‘å°†æ‰€æœ‰åŠŸèƒ½éƒ½æ¸…ç©ºäº†ï¼Œé™¤äº† </p><br><pre> <code class="plaintext hljs">void onStart(AIModule* module) { ExampleAIModule* self = (ExampleAIModule*) module; Game* game = BWAPIC_getGame(); Game_sendText(game, "Hello from bwapi-c!"); Game_sendText(game, "My name is %s", self-&gt;name); }</code> </pre> <br><p> æ¸¸æˆè¿è¡Œæ—¶è°ƒç”¨æ­¤å‡½æ•°ã€‚ è¯¥å‚æ•°æ˜¯æŒ‡å‘å½“å‰æ¨¡å—çš„æŒ‡é’ˆã€‚  <code>BWAPIC_getGame</code>è¿”å›æŒ‡å‘æ¸¸æˆçš„å…¨å±€æŒ‡é’ˆï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹<code>BWAPIC_setGame</code>çš„è°ƒç”¨æ¥è®¾ç½®è¯¥<code>BWAPIC_setGame</code> ã€‚ å› æ­¤ï¼Œè®©æˆ‘ä»¬å±•ç¤ºä¸€ä¸ªäº¤å‰ç¼–è¯‘æ¨¡å—çš„å·¥ä½œç¤ºä¾‹ï¼š </p><br><pre> <code class="bash hljs">bwapi-c/example$ tree . â”œâ”€â”€ BWAPIC.dll â””â”€â”€ Dll.c 0 directories, 2 files bwapi-c/example$ i686-w64-mingw32-gcc -mabi=ms -shared -o Dll.dll Dll.c -I../include -L. -lBWAPIC bwapi-c/example$ cp Dll.dll ~/Starcraft/bwapi-data/ bwapi-c/example$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Starcraft/bwapi-data/ Starcraft$ wine bwheadless.exe -e StarCraft.exe -l bwapi-data/BWAPI.dll --headful ... ... ...</code> </pre> <br><p> æŒ‰ä¸‹æŒ‰é’®å¹¶è¿è¡Œæ¸¸æˆã€‚ å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BWAPI</a>ç½‘ç«™å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BWAPI-Cä¸­</a>æ‰¾åˆ°æœ‰å…³ç¼–è¯‘å’Œæ‰§è¡Œçš„æ›´å¤šä¿¡æ¯ã€‚ </p><br><p> æ¨¡å—çš„ç»“æœï¼š </p><br><p><img src="https://habrastorage.org/webt/cw/a-/41/cwa-41ihsyva-pj2stpef1xjn2g.png" alt="å›¾ç‰‡"></p><br><p> æ‚¨å¯ä»¥åœ¨<a href="">bwapi-c / example / Dll.cä¸­</a>æ‰¾åˆ°ä¸€ä¸ªæ›´å¤æ‚çš„æ¨¡å—ç¤ºä¾‹ï¼Œå…¶ä¸­æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¿­ä»£å™¨ï¼Œå•å…ƒç®¡ç†ï¼ŒçŸ¿ç‰©æœç´¢å’Œç»Ÿè®¡ä¿¡æ¯è¾“å‡ºã€‚ </p><br><h2 id="bwapi-sys">  bwapiç³»ç»Ÿ </h2><br><p> åœ¨Rustç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œæœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç§</a>å‘½åç¨‹åºåŒ…çš„æ–¹å¼å¯ä»¥é“¾æ¥åˆ°æœ¬æœºåº“ã€‚ ä»»ä½•è½¯ä»¶åŒ…foo-syséƒ½æ‰§è¡Œä¸¤ä¸ªé‡è¦åŠŸèƒ½ï¼š </p><br><ul><li> ä¸æœ¬åœ°åº“libfooçš„é“¾æ¥ï¼› </li><li> æä¾›libfooåº“ä¸­å‡½æ•°çš„å£°æ˜ã€‚ ä½†æ˜¯åªæœ‰å£°æ˜ï¼  * -sysåŒ…è£…ç®±ä¸­æœªæä¾›é«˜çº§æŠ½è±¡ã€‚ </li></ul><br><p> ä¸ºäº†ä½¿* -sysè½¯ä»¶åŒ…èƒ½å¤ŸæˆåŠŸé“¾æ¥ï¼Œæ‚¨å¿…é¡»å‘Šè¯‰cargo <a href="">æœç´¢</a>æœ¬æœºåº“å’Œ/æˆ–ä»æºä»£ç <a href="">æ„å»º</a>åº“ã€‚ </p><br><p> ä¸ºäº†ä½¿* -sysåŒ…æä¾›å£°æ˜ï¼Œæ‚¨éœ€è¦è‡ªå·±ç¼–å†™å®ƒä»¬æˆ–ä½¿ç”¨bindgenç”Ÿæˆå®ƒä»¬ã€‚ å†æ¬¡bindgenã€‚ å°è¯•ç¬¬äºŒä¸ª=ï¼‰ </p><br><p> ç»‘å®šçš„ç”Ÿæˆéå¸¸ç®€å•ï¼š </p><br><pre> <code class="bash hljs">bindgen BWAPI.h -o lib.rs \ --opaque-type <span class="hljs-string"><span class="hljs-string">".+_"</span></span> \ --blacklist-type <span class="hljs-string"><span class="hljs-string">"std.*|__.+|.+_$|Game_v(Send|Print|Draw).*|va_list|.+_t$"</span></span> \ --no-layout-tests \ --no-derive-debug \ --raw-line <span class="hljs-string"><span class="hljs-string">"#![allow(improper_ctypes, non_snake_case)]"</span></span> \ -- -I../submodules/bwapi-c/include sed -i -r -- <span class="hljs-string"><span class="hljs-string">'s/.+\s+(.+)_;/pub struct \1;/'</span></span> lib.rs</code> </pre> <br><p>  <code>BWAPI.h</code>æ˜¯å…·æœ‰BWAPI-Cä¸­æ‰€æœ‰Cå¤´çš„æ–‡ä»¶ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œbindgenå·²ç»ä¸ºä¸Šé¢çš„å‡½æ•°ç”Ÿæˆäº†è¿™æ ·çš„å£°æ˜ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> { <span class="hljs-comment"><span class="hljs-comment">/// BWAPIC_setGame must be called from gameInit to initialize BWAPI::BroodwarPtr pub fn BWAPIC_setGame(game: *mut Game); } extern "C" { pub fn BWAPIC_getGame() -&gt; *mut Game; }</span></span></code> </pre> <br><p> æœ‰ä¸¤ç§ç­–ç•¥ï¼šå°†ç”Ÿæˆçš„ä»£ç å­˜å‚¨åœ¨å­˜å‚¨åº“ä¸­ï¼Œä»¥åŠåœ¨æ„å»ºè¿‡ç¨‹ä¸­å³æ—¶ç”Ÿæˆä»£ç ã€‚ ä¸¤ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼ºç‚¹</a> ã€‚ </p><br><p> å¾ˆé«˜å…´è®¤è¯†æ‚¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">bwapi-sys</a> ; æœç€æˆ‘ä»¬çš„ç›®æ ‡åˆè¿ˆå‡ºäº†ä¸€æ­¥ã€‚ </p><br><p> æ‚¨è¿˜è®°å¾—æˆ‘ä¹‹å‰è°ˆè®ºè¿‡è·¨å¹³å°å—ï¼Ÿ  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">nlinker</a>åŠ å…¥äº†è¯¥é¡¹ç›®å¹¶å®æ–½äº†ä¸€é¡¹ç‹¡çŒ¾çš„ç­–ç•¥ã€‚ å¦‚æœç›®æ ‡ä¸»æœºæ˜¯Windowsï¼Œåˆ™ä»GitHubä¸‹è½½å·²ç»ç»„è£…å¥½çš„BWAPICã€‚ å¯¹äºå…¶ä½™çš„ç›®æ ‡ï¼Œæˆ‘ä»¬ä»OpenBWçš„æ¥æºä¸­æ”¶é›†BWAPI-Cï¼ˆç¨åå†ä»‹ç»ï¼‰ã€‚ </p><br><h2 id="bwapi-rs"> å¸ƒç“¦çš®å°” </h2><br><p> ç°åœ¨æˆ‘ä»¬æœ‰äº†ç»‘å®šï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰é«˜çº§æŠ½è±¡äº†ã€‚ æˆ‘ä»¬æœ‰ä¸¤ç§ç±»å‹å¯ä»¥ä½¿ç”¨ï¼šçº¯å€¼å’Œä¸é€æ˜æŒ‡é’ˆã€‚ </p><br><p> ä¸€åˆ‡éƒ½å¾ˆç®€å•ï¼Œåªæœ‰çº¯ä»·å€¼ã€‚ è®©æˆ‘ä»¬ä»¥é¢œè‰²ä¸ºä¾‹ã€‚ æˆ‘ä»¬éœ€è¦ä½¿Rustä»£ç æ˜“äºä½¿ç”¨ï¼Œä»¥ä¾¿ä»¥æ–¹ä¾¿è‡ªç„¶çš„æ–¹å¼ä½¿ç”¨é¢œè‰²ï¼š </p><br><pre> <code class="rust hljs">game.draw_line(CoordinateType::Screen, (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), (<span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>), Color::Red); ^^^</code> </pre> <br><p> å› æ­¤ï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæœ‰å¿…è¦ä½¿ç”¨C ++ <a href="">å¸¸é‡</a>å®šä¹‰æšä¸¾ï¼Œè¿˜åº”ä½¿ç”¨Rustæƒ¯ç”¨çš„æšä¸¾ï¼Œå¹¶å®šä¹‰ä½¿ç”¨std :: convert :: Fromåœ¨bwapi_sys :: Colorä¸­å¯¹å…¶è¿›è¡Œè½¬æ¢çš„æ–¹æ³•ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// FFI version #[repr(C)] #[derive(Copy, Clone)] pub struct Color { pub color: ::std::os::raw::c_int, } // Idiomatic version #[derive(PartialEq, PartialOrd, Copy, Clone)] pub enum Color { Black = 0, Brown = 19, ...</span></span></code> </pre> <br><p> ä¸ºäº†æ‚¨çš„æ–¹ä¾¿ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æšä¸¾åŸºå…ƒæ´¾ç”Ÿçš„</a>æ¿æ¡ç®±ã€‚ </p><br><p> ä½¿ç”¨ä¸é€æ˜æŒ‡é’ˆä¹Ÿå¾ˆå®¹æ˜“ã€‚ è®©æˆ‘ä»¬ä½¿ç”¨<a href="">Newtype</a>æ¨¡å¼ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Player</span></span></span></span>(*<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> sys::Player);</code> </pre> <br><p> è¿™æ„å‘³ç€Playeræ˜¯ä¸€ç§å¸¦æœ‰ç§æœ‰å­—æ®µçš„ç»“æ„-Cè¯­è¨€çš„åŸå§‹ä¸é€æ˜æŒ‡é’ˆã€‚è¿™æ˜¯å®šä¹‰Player :: colorçš„æ–¹å¼ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">impl</span></span> Player { <span class="hljs-comment"><span class="hljs-comment">// so the method is declared Player::getColor in bwapi-sys //extern "C" { // pub fn Player_getColor(self_: *mut Player) -&gt; Color; //} pub fn color(&amp;self) -&gt; Color { // bwapi_sys::Player_getColor - wrapper function from BWAPI-C // self.0 - opaque pointer let color = unsafe { bwapi_sys::Player_getColor(self.0) }; color.into() // cast bwapi_sys::Color -&gt; Color } }</span></span></code> </pre> <br><p> ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨Rustç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæœºå™¨äººäº†ï¼ </p><br><h2 id="creating-a-bot-in-rust"> åœ¨Rustä¸­åˆ›å»ºä¸€ä¸ªæœºå™¨äºº </h2><br><p> ä½œä¸ºæ¦‚å¿µéªŒè¯ï¼Œè¯¥æœºå™¨äººå°†ç±»ä¼¼äºä¸€ä¸ªçŸ¥åçš„countruï¼šæ•´ä¸ªä»»åŠ¡æ˜¯é›‡ç”¨å·¥äººå¹¶æ”¶é›†çŸ¿ç‰©è´¨ã€‚ </p><br><p><img src="https://habrastorage.org/webt/hx/r_/jm/hxr_jmj2fbsitx-tfw96p2pa2tu.png" alt="åŒ—æœé²œ"></p><br><p><img src="https://habrastorage.org/webt/ww/gf/lr/wwgflrekcnxtv75thaurrwcm0g8.png" alt="éŸ©å›½"></p><br><p> è®©æˆ‘ä»¬ä»æ‰€éœ€çš„åŠŸèƒ½<code>gameInit</code>å’Œ<code>newAIModule</code> ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-meta"><span class="hljs-meta">#[no_mangle]</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gameInit</span></span></span></span>(game: *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> void) { bwapi_sys::BWAPIC_setGame(game <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> bwapi_sys::Game); } <span class="hljs-meta"><span class="hljs-meta">#[no_mangle]</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newAIModule</span></span></span></span>() -&gt; *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> void { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> module = ExampleAIModule { name: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::from(<span class="hljs-string"><span class="hljs-string">"ExampleAIModule"</span></span>) }; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = wrap_handler(<span class="hljs-built_in"><span class="hljs-built_in">Box</span></span>::new(module)); result }</code> </pre> <br><p>  <code>#[no_mangle]</code>ä¸C ++ä¸­çš„<code>extern "C"</code>æ‰§è¡Œç›¸åŒçš„åŠŸèƒ½ã€‚ åœ¨<code>wrap_handler</code>å†…éƒ¨ï¼Œ <code>wrap_handler</code>æ‰€æœ‰é­”æœ¯ï¼Œå…¶ä¸­åŒ…æ‹¬è™šæ‹Ÿå‡½æ•°è¡¨çš„æ›¿æ¢å’Œâ€œæ©ç›–â€ C ++ç±»ã€‚ </p><br><p> æ¨¡å—ç»“æ„çš„å®šä¹‰æ¯”Cè¯­è¨€æ›´ç®€å•ï¼Œæ›´å¥‡ç‰¹ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExampleAIModule</span></span></span></span> { name: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, }</code> </pre> <br><p> è®©æˆ‘ä»¬æ·»åŠ ä¸€äº›æ–¹æ³•æ¥å‘ˆç°ç»Ÿè®¡ä¿¡æ¯å’Œå‘å‡ºè®¢å•ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">impl</span></span> ExampleAIModule { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw_stat</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> game = Game::get(); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> message = <span class="hljs-built_in"><span class="hljs-built_in">format!</span></span>(<span class="hljs-string"><span class="hljs-string">"Frame {}"</span></span>, game.frame_count()); game.draw_text(CoordinateType::Screen, (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), &amp;message); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">give_orders</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> player = Game::get().self_player(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> unit <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> player.units() { <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> unit.get_type() { UnitType::Terran_SCV | UnitType::Zerg_Drone | UnitType::Protoss_Probe =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !unit.is_idle() { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> unit.is_carrying_gas() || unit.is_carrying_minerals() { unit.return_cargo(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-literal"><span class="hljs-literal">Some</span></span>(mineral) = Game::get() .minerals() .min_by_key(|m| unit.distance_to(m)) { <span class="hljs-comment"><span class="hljs-comment">// WE REQUIRE MORE MINERALS unit.right_click(&amp;mineral, false); } } UnitType::Terran_Command_Center =&gt; { unit.train(UnitType::Terran_SCV); } UnitType::Protoss_Nexus =&gt; { unit.train(UnitType::Protoss_Probe); } UnitType::Zerg_Hatchery | UnitType::Zerg_Lair | UnitType::Zerg_Hive =&gt; { unit.train(UnitType::Zerg_Drone); } _ =&gt; {} }; } } }</span></span></code> </pre> <br><p> è¦å°†ExampleAIModuleç±»å‹è½¬æ¢ä¸ºå®é™…æ¨¡å—ï¼Œæ‚¨éœ€è¦ä½¿å…¶å¯¹<strong>onXXXX</strong>äº‹ä»¶åšå‡ºå“åº”ã€‚ ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦å®ç°EventHandlerç±»å‹ï¼Œè¯¥ç±»å‹ç±»ä¼¼äºCè¯­è¨€ä¸­çš„AIModule_vtableè™šæ‹Ÿè¡¨ï¼š </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">impl</span></span> EventHandler <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ExampleAIModule { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) { Game::get().send_text(&amp;<span class="hljs-built_in"><span class="hljs-built_in">format!</span></span>(<span class="hljs-string"><span class="hljs-string">"Hello from Rust! My name is {}"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.name)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_end</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _is_winner: <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span>) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_frame</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.draw_stat(); <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.give_orders(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_send_text</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _text: &amp;<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_receive_text</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _player: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Player, _text: &amp;<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_player_left</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _player: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Player) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_nuke_detect</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _target: Position) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_discover</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_evade</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_show</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_hide</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_create</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_destroy</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_morph</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_renegade</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_save_game</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _game_name: &amp;<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_unit_complete</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, _unit: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Unit) {} }</code> </pre> <br><p> ç”Ÿæˆå’Œè¿è¡Œæ¨¡å—å°±åƒä½¿ç”¨Cä¸€æ ·ç®€å•ï¼š </p><br><pre> <code class="bash hljs">bwapi-rs$ cargo build --example dll --target=i686-pc-windows-gnu bwapi-rs$ cp ./target/i686-pc-windows-gnu/debug/examples/dll.dll ~/Starcraft/bwapi-data/Dll.dll bwapi-rs$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Starcraft/bwapi-data/ Starcraft$ wine bwheadless.exe -e StarCraft.exe -l bwapi-data/BWAPI.dll --headful ... ... ...</code> </pre> <br><p> å’Œä½œå“çš„è§†é¢‘ï¼š </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rACbnWpI01M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="openbw">  Openbw </h2><br><p> è¿™äº›å®¶ä¼™èµ°å¾—æ›´è¿œã€‚ ä»–ä»¬å†³å®šç¼–å†™SCçš„å¼€æºç‰ˆæœ¬ï¼šBWï¼ ä»–ä»¬å¾ˆæ“…é•¿ã€‚ ä»–ä»¬çš„ç›®æ ‡ä¹‹ä¸€æ˜¯å®ç°HDå›¾åƒï¼Œä½†SCï¼šRemasteredé¢†å…ˆäºä»–ä»¬=ï¼ˆç›®å‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…¶APIç¼–å†™æœºå™¨äººç¨‹åºï¼ˆæ˜¯çš„ï¼Œåœ¨C ++ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ï¼Œä½†æ˜¯æœ€ä»¤äººæƒŠå¥‡çš„åŠŸèƒ½æ˜¯èƒ½å¤ŸæŸ¥çœ‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç›´æ¥åœ¨æµè§ˆå™¨ä¸­</a>å›æ”¾ã€‚ </p><br><h2 id="conclusion"> ç»“è®º </h2><br><p> è¯¥å®ç°å­˜åœ¨ä¸€ä¸ªæœªè§£å†³çš„é—®é¢˜ï¼šæˆ‘ä»¬ä¸æ§åˆ¶å¼•ç”¨çš„å”¯ä¸€æ€§ï¼Œå› æ­¤åœ¨ä¿®æ”¹å¯¹è±¡æ—¶ï¼Œ <code>&amp;mut</code>å’Œ<code>&amp;</code>åˆ°åŒä¸€åŒºåŸŸçš„å­˜åœ¨å°†å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚ æœ‰ç‚¹éº»çƒ¦ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Halt</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°è¯•</a>å®ç°æƒ¯ç”¨çš„ç»‘å®šï¼Œä½†æ˜¯ä»–æ²¡æœ‰è®¾æ³•æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚ å¦å¤–ï¼Œå¦‚æœæ‚¨æƒ³å®Œæˆæ­¤ä»»åŠ¡ï¼Œåˆ™å¿…é¡»ä»”ç»†â€œé“²èµ·â€ C ++ APIå¹¶æ­£ç¡®æ”¾ç½®<code>const</code>é™å®šç¬¦ã€‚ </p><br><p> æˆ‘çœŸçš„å¾ˆäº«å—è¿™ä¸ªé¡¹ç›®çš„å·¥ä½œï¼Œè§‚çœ‹äº†é‡æ’­ì¢…ì¼ï¼Œå¹¶æ²‰æµ¸åœ¨æ°›å›´ä¸­ã€‚ è¯¥æ¸¸æˆåœ¨å®‡å®™ä¸­äº§ç”Ÿäº†å‡¹ç—•ã€‚ åœ¨SCï¼šBWä¸­ï¼Œæ²¡æœ‰ä¸€æ¬¾æ¸¸æˆèƒ½åƒç°åœ¨è¿™æ ·æµè¡Œï¼Œå®ƒå¯¹ëŒ€í•œë¯¼êµ­ì •ì¹˜çš„å½±å“æ˜¯ä¸å¯æƒ³è±¡çš„ã€‚ éŸ©å›½çš„èŒä¸šç©å®¶ä¸é»„é‡‘æ—¶æ®µçš„éŸ©å›½å¤šæ‹‰å§†å¹¿æ’­ä¸€æ ·å—æ¬¢è¿ã€‚  ë˜í•œï¼Œí”„ë¡œí”„ì´ìˆ˜ìˆ˜ìˆ˜ìˆ˜ìˆ˜ìˆ˜ìˆ˜ìˆ˜ </p><br><p> æ˜Ÿé™…äº‰éœ¸ä¸‡å²ï¼ </p><br><h2 id="links"> å‹æƒ…é“¾æ¥ </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">reddit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸ƒç“¦çš®å°”</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">bwapiç³»ç»Ÿ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸ƒç“¦æ¯”</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸ƒç“¦çš®</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Openbw</a> </li></ul><br><hr><br><p> éå¸¸æ„Ÿè°¢Steve Klabnikå¸®åŠ©æˆ‘å®¡é˜…äº†è¿™ç¯‡æ–‡ç« ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN436254/">https://habr.com/ru/post/zh-CN436254/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN436242/index.html">YOLOå’Œå…¶ä»–å®½æ¾æ–¹æ³•</a></li>
<li><a href="../zh-CN436244/index.html">åŠ³ä¼¦æ–¯æ•™æˆçš„æ–°å¤§è„‘</a></li>
<li><a href="../zh-CN436246/index.html">ç°ä»£æ±½è½¦å·¥ç¨‹-02.å…³äºæ“ä½œç³»ç»Ÿçš„è®ºæ–‡</a></li>
<li><a href="../zh-CN436248/index.html">å¡å°”æ›¼æ»¤æ³¢</a></li>
<li><a href="../zh-CN436250/index.html">å¸è¡€é¬¼å¤´ç›®è„±ç¦»ä¸Šä¸‹æ–‡æˆ–ä¸ºä½•æ€»æ˜¯å¤±è´¥</a></li>
<li><a href="../zh-CN436256/index.html">åœ¨å¾·å›½æ‰¾å·¥ä½œä¼šæ›´å®¹æ˜“</a></li>
<li><a href="../zh-CN436260/index.html">åˆåˆ›ä¼ä¸šåœ¨ä¸ºå…¶IPç”³è¯·ä¸“åˆ©æ—¶çš„å¤±è¯¯å’Œé™·é˜±</a></li>
<li><a href="../zh-CN436262/index.html">*ç”±äºæœ€åä¸€åˆ»å‘ç°æ½œåœ¨çš„æ¼æ´ï¼Œä»¥å¤ªåŠçš„â€œå›å£«å¦ä¸å ¡â€æ›´æ–°è¢«æ¨è¿Ÿ</a></li>
<li><a href="../zh-CN436264/index.html">å•ä¸€å­˜å‚¨åº“ï¼šè¯·ä¸è¦ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</a></li>
<li><a href="../zh-CN436266/index.html">é˜¿é‡Œå·´å·´JDKä¸­çš„æé™æ‰©å±•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>