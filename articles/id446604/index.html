<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òπÔ∏è üêà üë©üèø‚Äç‚öïÔ∏è ESET: Skema Pengiriman Backdoor OceanLotus Cybergroup Baru üë©üèΩ‚Äç‚úàÔ∏è üíï üë®üèª‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam sebuah posting, kami akan menjelaskan bagaimana cybergroup OceanLotus (APT32 dan APT-C-00) baru-baru ini menggunakan salah satu eksploitasi publ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET: Skema Pengiriman Backdoor OceanLotus Cybergroup Baru</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/446604/">  Dalam sebuah posting, kami akan menjelaskan bagaimana cybergroup OceanLotus (APT32 dan APT-C-00) baru-baru ini menggunakan salah satu eksploitasi publik untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CVE-2017-11882</a> , kerentanan korupsi memori di Microsoft Office, dan bagaimana malware grup memberikan kegigihan dalam sistem yang dikompromikan tanpa meninggalkan jejak apa pun. .  Selanjutnya, kami menjelaskan bagaimana, dari awal 2019, grup menggunakan arsip self-extracting untuk menjalankan kode. <br><br>  OceanLotus berspesialisasi dalam spionase dunia maya, dengan sasaran prioritas di Asia Tenggara.  Penyerang memalsukan dokumen yang menarik perhatian calon korban untuk meyakinkan mereka untuk melakukan pintu belakang, dan juga bekerja pada pengembangan alat.  Metode yang digunakan untuk membuat umpan berbeda dalam serangan yang berbeda - dari file dengan "ekstensi ganda", arsip yang mengekstraksi sendiri, dokumen dengan makro hingga eksploit terkenal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ap/h9/mc/aph9mchsgkupnlpka6cf7g_u13g.jpeg"></div><br><a name="habracut"></a><h2>  Menggunakan exploit di Microsoft Equation Editor </h2><br>  Pada pertengahan 2018, OceanLotus meluncurkan kampanye menggunakan kerentanan CVE-2017-11882.  Salah satu dokumen jahat cybergroup dianalisis oleh 360 pakar Threat Intelligence Center (sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">studi dalam bahasa China</a> ), termasuk deskripsi terperinci dari eksploit tersebut.  Dalam posting di bawah ini, ikhtisar dokumen berbahaya tersebut. <br><br><h3>  Tahap pertama </h3><br>  Laporan <code>FW Report on demonstration of former CNRP in Republic of Korea.doc</code> (SHA-1: <code>D1357B284C951470066AAA7A8228190B88A5C7C3</code> ) mirip dengan yang disebutkan dalam penelitian di atas.  Sangat menarik karena menargetkan pengguna yang tertarik dengan politik Kamboja (CNRP - Partai Keselamatan Nasional Kamboja, dibubarkan pada akhir 2017).  Meskipun ekstensi .doc, dokumen ini memiliki format RTF (lihat gambar di bawah), berisi kode sampah, dan juga terdistorsi. <br><br><img src="https://habrastorage.org/webt/a-/gt/6y/a-gt6ylnd0rbyzvs8eecjpi04-a.png"><br>  <i>Gambar 1. Sampah di RTF</i> <br><br>  Meskipun ada elemen yang terdistorsi, Word berhasil membuka file RTF ini.  Seperti dapat dilihat dari Gambar 2, berikut adalah struktur EQNOLEFILEHDR dengan offset 0xC00, diikuti oleh header MTEF, dan kemudian entri MTEF (Gambar 3) untuk font. <br><br><img src="https://habrastorage.org/webt/oh/ks/tb/ohkstbugzx97wthqqqnrdoo27di.png"><br>  <i>Gambar 2. Nilai Catatan FONT</i> <br><br><img src="https://habrastorage.org/webt/jy/wj/b5/jywjb5bgsixdqywivkc_ndzcgiu.png"><br>  <i>Gambar 3. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Format perekaman FONT</a></i> <br><br>  Kemungkinan melimpah di bidang <i>nama</i> , karena ukurannya tidak diperiksa sebelum menyalin.  Nama yang terlalu panjang memicu kerentanan.  Seperti dapat dilihat dari isi file RTF (offset 0xC26 pada Gambar 2), buffer diisi dengan kode shell, diikuti oleh perintah dummy ( <code>0x90</code> ) dan alamat pengirim <code>0x402114</code> .  Alamatnya adalah item dialog di <code>EQNEDT32.exe</code> yang menunjuk ke pernyataan <code>RET</code> .  Ini menyebabkan EIP menunjuk ke awal bidang <i>nama yang</i> berisi shellcode. <br><br><img src="https://habrastorage.org/webt/_9/gf/lo/_9gflo6k9zsefvvnq8jdaqosuua.png"><br>  <i>Gambar 4. Mulai mengeksploitasi shellcode</i> <br><br>  Alamat <code>0x45BD3C</code> menyimpan variabel yang <code>0x45BD3C</code> hingga mencapai pointer ke struktur <code>MTEFData</code> saat ini dimuat.  Ini adalah sisa dari shellcode. <br><br>  Tujuan dari kode shell adalah untuk mengeksekusi fragmen kedua dari kode shell yang tertanam dalam dokumen terbuka.  Pertama, shellcode sumber mencoba menemukan deskriptor file dari dokumen terbuka, <code>NtQuerySystemInformation</code> semua deskriptor sistem ( <code>NtQuerySystemInformation</code> dengan argumen <code>SystemExtendedHandleInformation</code> ) dan memeriksa apakah deskriptor <i>PID</i> dan proses <code>WinWord</code> <i>PID</i> dan jika dokumen dibuka dengan akses mask - <code>0x12019F</code> . <br><br>  Untuk mengkonfirmasi deteksi deskriptor yang benar (dan bukan deskriptor dokumen terbuka lainnya), konten file ditampilkan menggunakan fungsi <code>CreateFileMapping</code> , dan kode shell memeriksa untuk melihat apakah empat byte terakhir dari dokumen sesuai dengan " <code>yyyy</code> " (metode Egg Hunting).  Segera setelah kecocokan ditemukan, dokumen tersebut disalin ke folder sementara ( <code>GetTempPath</code> ) sebagai <code>ole.dll</code> .  Kemudian 12 byte terakhir dari dokumen dibaca. <br><br><img src="https://habrastorage.org/webt/w3/lq/xv/w3lqxvqbmerfijoryxi3vkitaao.png"><br>  <i>Gambar 5. Penanda akhir dokumen</i> <br><br>  Nilai 32-bit antara <code>AABBCCDD</code> dan marker <code>AABBCCDD</code> adalah offset dari <code>AABBCCDD</code> berikutnya.  Ini disebut menggunakan fungsi <code>CreateThread</code> .  Diekstraksi shellcode yang sama yang digunakan oleh OceanLotus sebelumnya.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Skrip emulasi Python yang</a> kami rilis pada Maret 2018 masih berfungsi untuk membuang tahap kedua. <br><br><h3>  Tahap kedua </h3><br><h4>  Pengambilan Komponen </h4><br>  Nama file dan direktori dipilih secara dinamis.  Kode secara acak memilih nama file yang dapat dieksekusi atau DLL di <code>C:\Windows\system32</code> .  Dia kemudian membuat permintaan ke sumber dayanya dan mengambil bidang <code>FileDescription</code> untuk digunakan sebagai nama folder.  Jika ini tidak berhasil, kode secara acak memilih nama folder dari <code>%ProgramFiles%</code> atau <code>C:\Windows</code> directories (dari GetWindowsDirectoryW).  Itu menghindari penggunaan nama yang mungkin bertentangan dengan file yang ada, dan memastikan bahwa itu tidak mengandung kata-kata berikut: <code>windows</code> , <code>Microsoft</code> , <code>desktop</code> , <code>system</code> , <code>system32</code> atau <code>syswow64</code> .  Jika direktori sudah ada, "NLS_ {6 karakter}" ditambahkan ke nama. <br><br>  Sumberdaya <code>0x102</code> dianalisis dan file-file dibuang di <code>%ProgramFiles%</code> atau <code>%AppData%</code> , ke folder yang dipilih secara acak.  Waktu pembuatan diubah untuk memiliki nilai yang sama dengan <code>kernel32.dll</code> . <br><br>  Sebagai contoh, di sini adalah folder dan daftar file yang dibuat dengan memilih file yang dapat dieksekusi <code>C:\Windows\system32\TCPSVCS.exe</code> sebagai sumber data. <br><br><img src="https://habrastorage.org/webt/px/ls/xq/pxlsxqrz8s0beuxfybxu0cvz8dg.png"><br>  <i>Gambar 6. Mengekstraksi berbagai komponen</i> <br><br>  Struktur sumber daya <code>0x102</code> di pipet cukup rumit.  Singkatnya, ini berisi: <br>  - nama file <br>  - Ukuran dan isi file <br>  - Format kompresi ( <code>COMPRESSION_FORMAT_LZNT1</code> digunakan oleh fungsi <code>RtlDecompressBuffer</code> ) <br><br>  File pertama direset sebagai <code>TCPSVCS.exe</code> , yang merupakan <code>AcroTranscoder.exe</code> sah (menurut <code>FileDescription</code> , SHA-1: <code>2896738693A8F36CC7AD83EF1FA46F82F32BE5A3</code> ). <br><br>  Anda mungkin telah memperhatikan bahwa beberapa file DLL lebih besar dari 11 MB.  Ini karena buffer besar yang berdekatan dari data acak terletak di dalam file yang dapat dieksekusi.  Ada kemungkinan bahwa ini adalah cara untuk menghindari deteksi oleh beberapa produk keamanan. <br><br><h4>  Ketekunan </h4><br>  <code>0x101</code> daya <code>0x101</code> dalam dropper berisi dua bilangan bulat 32-bit yang menentukan cara mempertahankan kegigihan.  Nilai yang pertama menunjukkan bagaimana malware akan mempertahankan kegigihan tanpa hak administrator. <br><br><img src="https://habrastorage.org/webt/f6/aw/1x/f6aw1xtjqv-tfril3uzrx_nzstw.png"><br>  <i>Tabel 1. Mekanisme ketekunan tanpa hak administrator</i> <br><br>  Nilai integer kedua menunjukkan bagaimana malware harus memastikan kegigihan saat bekerja sebagai administrator. <br><br><img src="https://habrastorage.org/webt/db/p2/em/dbp2embzyazeoxdnk8h6uji9lm4.png"><br>  <i>Tabel 2. Mekanisme ketekunan dengan hak administrator</i> <br><br>  Nama layanan adalah nama file tanpa ekstensi;  nama tampilan adalah nama folder, tetapi jika sudah ada, string " <code>Revision 1</code> " ditambahkan padanya (jumlahnya bertambah hingga ditemukan nama yang tidak digunakan).  Operator memastikan bahwa kegigihan melalui layanan stabil - jika terjadi kegagalan, layanan harus dimulai kembali setelah 1 detik.  Kemudian, nilai <code>WOW64</code> dari kunci registri layanan baru diatur ke 4, yang menunjukkan bahwa itu adalah layanan 32-bit. <br><br>  Tugas terjadwal dibuat melalui beberapa antarmuka COM: <code>ITaskScheduler</code> , <code>ITask</code> , <code>ITaskTrigger</code> , <code>IPersistFile</code> dan <code>ITaskScheduler</code> .  Intinya, program jahat membuat tugas tersembunyi, mengatur informasi akun bersama dengan informasi tentang pengguna atau administrator saat ini, dan kemudian mengatur pemicu. <br><br>  Ini adalah tugas harian dengan durasi 24 jam dan interval antara dua kali 10 menit, yang berarti akan dilakukan terus menerus. <br><br><h4>  Bit berbahaya </h4><br>  Dalam contoh kami, file yang dapat dieksekusi <code>TCPSVCS.exe</code> ( <code>AcroTranscoder.exe</code> ) adalah perangkat lunak yang sah yang mengunduh DLL yang dibuang bersama file tersebut.  Dalam hal ini, <code>Flash Video Extension.dll</code> menarik. <br><br>  Fungsi <code>DLLMain</code> hanya memanggil fungsi lain.  Beberapa predikat fuzzy hadir: <br><br><img src="https://habrastorage.org/webt/b-/im/fe/b-imfeegcv30g23fj2n9qqowdeu.png"><br>  <i>Gambar 7. Predikat fuzzy</i> <br><br>  Setelah pemeriksaan yang menyesatkan ini, kode menerima bagian <code>TCPSVCS.exe</code> file <code>TCPSVCS.exe</code> , mengubah proteksinya ke <code>PAGE_EXECUTE_READWRITE</code> dan menimpanya, menambahkan instruksi boneka: <br><br><img src="https://habrastorage.org/webt/dp/e7/fn/dpe7fnpq2lrioo0i15ki742mhro.png"><br>  <i>Gambar 8. Urutan instruksi</i> <br><br>  Pada akhirnya, instruksi <code>CALL</code> ditambahkan ke alamat fungsi <code>FLVCore::Uninitialize(void)</code> diekspor oleh <code>Flash Video Extension.dll</code> .  Ini berarti bahwa setelah memuat DLL jahat, ketika runtime memanggil <code>TCPSVCS.exe</code> di <code>TCPSVCS.exe</code> , penunjuk instruksi akan menunjuk ke NOP, menghasilkan panggilan <code>FLVCore::Uninitialize(void)</code> , langkah berikutnya. <br><br>  Fungsi ini hanya membuat mutex yang dimulai dengan <code>{181C8480-A975-411C-AB0A-630DB8B0A221}</code> diikuti oleh nama pengguna saat ini.  Dia kemudian membaca file yang dibuang dengan ekstensi * .db3, yang berisi kode posisi-independen, dan menggunakan <code>CreateThread</code> untuk mengeksekusi konten. <br><br>  Isi file * .db3 adalah shellcode yang biasa digunakan oleh grup OceanLotus.  Sekali lagi, kami berhasil membongkar muatannya menggunakan skrip emulator yang kami terbitkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di GitHub</a> . <br><br>  Script mengambil tahap akhir.  Komponen ini adalah pintu belakang yang sudah kami analisis dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">studi OceanLotus sebelumnya</a> .  Ini dapat ditentukan oleh GUID <code>{A96B020F-0000-466F-A96D-A91BBF8EAC96}</code> file biner.  Konfigurasi malware masih dienkripsi dalam sumber daya PE.  Ini memiliki konfigurasi yang kira-kira sama, tetapi server C&amp;C berbeda dari yang sebelumnya: <br><br> <code>- andreagahuvrauvin[.]com <br> - byronorenstein[.]com <br> - stienollmache[.]xyz</code> <br> <br>  OceanLotus sekali lagi menunjukkan kombinasi teknik yang berbeda untuk menghindari deteksi.  Mereka kembali dengan garis besar ‚Äúhalus‚Äù dari proses infeksi.  Dengan memilih nama acak dan mengisi file yang dapat dieksekusi dengan data acak, mereka mengurangi jumlah IoC tepercaya (berdasarkan hash dan nama file).  Selain itu, berkat penggunaan pemuatan DLL pihak ketiga, penyerang hanya perlu menghapus biner <code>AcroTranscoder</code> sah. <br><br><h2>  Arsip yang mengekstraksi sendiri </h2><br>  Setelah file RTF, grup beralih ke arsip self-extracting (SFX) dengan ikon dokumen umum untuk lebih membingungkan pengguna.  Ini ditulis oleh Threatbook ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan dalam bahasa Cina</a> ).  Setelah memulai, file RAR yang diekstraksi sendiri dibuang dan DLL dengan ekstensi .ocx dieksekusi, muatan finalnya yang sebelumnya didokumentasikan <code>{A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll</code> .  Sejak pertengahan Januari 2019, OceanLotus telah menggunakan kembali teknik ini, tetapi seiring waktu, beberapa konfigurasi telah berubah.  Di bagian ini kita akan berbicara tentang teknologi dan perubahan. <br><br><h4>  Pembuatan umpan </h4><br>  Dokumen <code>THICH-THONG-LAC-HANH-THAP-THIEN-VIET-NAM (1).EXE</code> (SHA-1: <code>AC10F5B1D5ECAB22B7B418D6E98FA18E32BBDEAB</code> ) pertama kali ditemukan pada tahun 2018.  File SFX ini dibuat dengan bijak - deskripsi ( <i>Info Versi</i> ) mengatakan bahwa ini adalah gambar JPEG.  Skrip SFX adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/i7/tg/nz/i7tgnzif_wi8kcy7g3liki3la4e.png"><br>  <i>Gambar 9. Perintah SFX</i> <br><br>  Malware me-reset <code>{9ec60ada-a200-4159-b310-8071892ed0c3}.ocx</code> (SHA-1: <code>EFAC23B0E6395B1178BCF7086F72344B24C04DCC</code> ), serta gambar <code>2018 thich thong lac.jpg.</code> <br><br>  Gambar umpan adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/x2/xh/sn/x2xhsnoscn9jdpm_phc4x5bms4q.jpeg"><br>  <i>Gambar 10. Gambar umpan</i> <br><br>  Anda mungkin telah memperhatikan bahwa dua baris pertama dalam skrip SFX memanggil file OSX dua kali, tetapi ini bukan kesalahan. <br><br><h4>  {9ec60ada-a200-4159-b310-8071892ed0c3} .ocx (ShLd.dll) </h4><br>  Aliran kontrol file OSX sangat mirip dengan komponen OceanLotus lainnya - ada banyak urutan perintah <code>JZ/JNZ</code> dan <code>PUSH/RET</code> bergantian dengan kode sampah. <br><br><img src="https://habrastorage.org/webt/hs/1j/yd/hs1jydni8wxcqylyvtvimc7_ckm.png"><br>  <i>Gambar 11. Kode yang dikaburkan</i> <br><br>  Setelah memfilter kode sampah, ekspor <code>DllRegisterServer</code> dipanggil oleh <code>regsvr32.exe</code> terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/qh/r3/ws/qhr3ws_knbm_pewxrzsqhrpzggi.png"><br>  <i>Gambar 12. Kode penginstal dasar</i> <br><br>  Bahkan, pertama kali <code>DllRegisterServer</code> dipanggil <code>DllRegisterServer</code> ekspor menetapkan nilai registri <code>HKCU\SOFTWARE\Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model</code> untuk offset terenkripsi di DLL ( <code>0x10001DE0</code> ). <br><br>  Ketika suatu fungsi disebut kedua kalinya, ia membaca nilai yang sama dan berjalan di alamat itu.  Dari sini, sumber daya dibaca dan dieksekusi dan banyak tindakan dalam RAM. <br><br>  Shellcode adalah pemuat PE yang sama yang digunakan dalam kampanye OceanLotus sebelumnya.  Itu dapat ditiru dengan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">skrip kami</a> .  Akibatnya, ia membuang <code>db293b825dcc419ba7dc2c49fa2757ee.dll</code> , memuatnya ke dalam memori dan menjalankan <code>DllEntry</code> . <br><br>  DLL mengekstraksi konten sumber dayanya, mendekripsi (AES-256-CBC) dan membongkar (LZMA) itu.  Sumber daya memiliki format khusus yang mudah untuk didekompilasi. <br><br><img src="https://habrastorage.org/webt/ge/l4/ss/gel4ssv32blxwcjjlxkc57g0vie.png"><br>  <i>Gambar 13. Struktur konfigurasi pemasang (KaitaiStruct Visualizer)</i> <br><br>  Konfigurasi diatur secara eksplisit - tergantung pada tingkat privilege, data biner akan ditulis ke <code>%appdata%\Intel\logs\BackgroundUploadTask.cpl</code> atau <code>%windir%\System32\BackgroundUploadTask.cpl</code> (atau <code>SysWOW64</code> untuk sistem 64-bit). <br><br>  Kegigihan kemudian dipastikan dengan membuat tugas bernama <code>BackgroundUploadTask[junk].job</code> , di mana <code>[junk]</code> adalah sekumpulan byte <code>0x9D</code> dan <code>0xA0</code> . <br><br>  Nama aplikasi dari tugas adalah <code>%windir%\System32\control.exe</code> , dan nilai parameter adalah path ke file biner yang dibongkar.  Tugas tersembunyi dijalankan setiap hari. <br><br>  Secara struktural, file CPL adalah DLL dengan nama internal <code>ac8e06de0a6c4483af9837d96504127e.dll</code> , yang mengekspor fungsi <code>CPlApplet</code> .  File ini mendekripsi sumber daya satu-satunya <code>{A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll</code> , lalu memuat DLL ini dan menyebut satu-satunya ekspor <code>DllEntry</code> . <br><br><h4>  File konfigurasi pintu belakang </h4><br>  Konfigurasi backdoor dienkripsi dan tertanam di sumber dayanya.  Struktur file konfigurasi sangat mirip dengan yang sebelumnya. <br><br><img src="https://habrastorage.org/webt/as/2f/c8/as2fc8ivbc6_bku2pjs5h-6_qtw.png"><br>  <i>Gambar 14. Struktur konfigurasi backdoor (KaitaiStruct Visualizer)</i> <br><br>  Terlepas dari struktur yang serupa, nilai-nilai banyak bidang diperbarui dibandingkan dengan data yang diberikan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan lama kami</a> . <br><br>  Elemen pertama array biner berisi DLL ( <code>HttpProv.dll</code> MD5: <code>2559738D1BD4A999126F900C7357B759</code> ) yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diidentifikasi oleh Tencent</a> .  Tetapi karena nama ekspor telah dihapus dari biner, hash tidak cocok. <br><br><h3>  Penelitian tambahan </h3><br>  Mengumpulkan sampel, kami memperhatikan beberapa karakteristik.  Sampel yang baru saja dijelaskan muncul sekitar Juli 2018, dan yang lain baru-baru ini menyukainya, pada pertengahan Januari - awal Februari 2019.  Arsip SFX digunakan sebagai vektor infeksi, membuang dokumen umpan yang sah dan file OSX berbahaya. <br><br>  Meskipun OceanLotus menggunakan cap waktu palsu, kami perhatikan bahwa cap waktu file SFX dan OCX selalu sama ( <code>0x57B0C36A</code> ( <code>0x57B0C36A</code> @ 19:15 UTC) dan <code>0x498BE80F</code> (02/06/2009 @ 7:34 am UTC) ) masing-masing).  Ini mungkin menunjukkan bahwa penulis memiliki "konstruktor" tertentu yang menggunakan template yang sama dan hanya mengubah beberapa karakteristik. <br><br>  Di antara dokumen-dokumen yang telah kami pelajari sejak awal 2018, ada berbagai nama yang menunjukkan negara-negara yang menjadi tujuan serangan: <br><br>  <i>- Informasi Kontak Baru Media Kamboja (Baru) .xls.exe</i> <i><br></i>  <i>- ÊùéÂª∫ È¶ô (‰∏™‰∫∫ ÁÆÄÂéÜ) .exe (dokumen pdf palsu dari CV)</i> <i><br></i>  <i>- umpan balik, Rally di AS dari 28-29 Juli, 2018.exe</i> <br><br>  Sejak ditemukannya backdoor <code>{A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll</code> dan publikasi analisisnya oleh beberapa peneliti, kami telah mengamati beberapa perubahan dalam data konfigurasi malware. <br><br>  Pertama, penulis mulai menghapus nama dari DLL DLL tambahan ( <code>DNSprov.dll</code> dan dua versi <code>HttpProv.dll</code> ).  Kemudian operator berhenti mengemas DLL ketiga (versi kedua <code>HttpProv.dll</code> ), memilih untuk hanya menyematkan satu. <br><br>  Kedua, banyak bidang konfigurasi backdoor diubah, mungkin untuk menghindari deteksi, karena banyak IoC menjadi tersedia.  Di antara bidang-bidang penting yang dimodifikasi oleh penulis adalah sebagai berikut: <br><br><ul><li>  Kunci registri AppX berubah (lihat IoC) </li><li>  string pengkodean mutex ("def", "abc", "ghi") </li><li>  nomor port </li></ul><br>  Akhirnya, di semua versi baru yang dianalisis, K &amp; C baru terdaftar di bagian IOC. <br><br><h2>  Kesimpulan </h2><br>  OceanLotus terus berkembang.  Cybergroup berfokus pada penyempurnaan dan perluasan alat dan umpan.  Penulis menutupi muatan berbahaya dengan bantuan dokumen yang menarik perhatian yang relevan dengan korban yang diduga.  Mereka mengembangkan desain baru dan juga menggunakan alat yang tersedia untuk umum, seperti eksploitasi Editor Persamaan.  Selain itu, mereka menyempurnakan alat untuk mengurangi jumlah artefak yang tersisa di mesin korban, sehingga mengurangi kemungkinan deteksi oleh perangkat lunak antivirus. <br><br><h2>  Indikator kompromi </h2><br>  Indikator <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kompromi</a> serta atribut MITER ATT &amp; CK tersedia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di Welivesecurity</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446604/">https://habr.com/ru/post/id446604/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446588/index.html">Memeriksa Kode Sumber Roslyn</a></li>
<li><a href="../id446590/index.html">39 fitur baru akan tersedia di Java 12</a></li>
<li><a href="../id446592/index.html">Memeriksa kode sumber Roslyn</a></li>
<li><a href="../id446598/index.html">Menciptakan Font CRT</a></li>
<li><a href="../id446602/index.html">Maksimum Arus DC Melalui Transistor Efek Bidang</a></li>
<li><a href="../id446606/index.html">Periksa seberapa baik Anda dalam teknologi aditif</a></li>
<li><a href="../id446608/index.html">Mengatasi Hukum Ketiga Gravitasi Organisasi</a></li>
<li><a href="../id446612/index.html">Saat kami mulai percaya pada inovasi</a></li>
<li><a href="../id446614/index.html">Sistem file virtual Linux: mengapa mereka diperlukan dan bagaimana cara kerjanya? Bagian 1</a></li>
<li><a href="../id446616/index.html">Bagaimana kami melakukan cloud FaaS di dalam Kubernetes dan menang di Tinkoff Hackathon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>