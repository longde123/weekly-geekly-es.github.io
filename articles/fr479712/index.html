<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèΩ üöó üõ∂ L'apprentissage automatique en tant qu'assistant de surveillance intelligent üñ±Ô∏è üë©üèº‚Äçüè´ ü§õ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Habr! 

 Le cr√©dit immobilier est un syst√®me vaste et tr√®s dynamique, qui est parfois difficile √† suivre. Pour aider les employ√©s √† se tenir au ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'apprentissage automatique en tant qu'assistant de surveillance intelligent</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/homecredit/blog/479712/">  Salut Habr! <br><br>  Le cr√©dit immobilier est un syst√®me vaste et tr√®s dynamique, qui est parfois difficile √† suivre.  Pour aider les employ√©s √† se tenir au courant de toutes les nouvelles et changements et √† suivre le rythme partout, nous introduisons activement des algorithmes d'apprentissage automatique.  Dans notre banque, les chat bots assument d√©j√† une partie du travail des op√©rateurs, les avis clients sont analys√©s non seulement par des experts, mais aussi par des algorithmes intelligents de traitement du langage naturel. <br><br>  Aujourd'hui, je vais vous dire comment nous avons aid√© les sp√©cialistes de l'exploitation des services bancaires √† se d√©barrasser de la n√©cessit√© de consulter en permanence les tableaux de bord des syst√®mes de surveillance, √† savoir, ils ont appel√© √† l'apprentissage automatique pour aider.  Voil√† ce que nous avons. <br><br><img src="https://habrastorage.org/webt/jd/w9/xp/jdw9xpbwninwrbz9e8p6heid8o0.png" alt="image"><br><a name="habracut"></a><br><h2>  Comment fonctionne la surveillance manuelle? </h2><br>  Un lieu de travail typique d'un sp√©cialiste de l'exploitation ressemble √† l'image ci-dessus, et il passe la plupart de son temps √† regarder les tableaux de bord.  Toute activit√© suspecte dans le syst√®me, par exemple, lorsque le r√©seau est tomb√© en panne ou qu'une NullPointerException a plu, attirera imm√©diatement l'attention - une enqu√™te commencera imm√©diatement. <br><br>  L'homme n'est pas une machine.  Il peut √™tre distrait, aller d√Æner, r√©pondre au t√©l√©phone.  Et lorsque le nombre de graphiques d√©passe la centaine, il devient difficile de les lier tous ensemble et d'aller au fond de l'essence. <br><br>  Un autre probl√®me est qu'il existe une famille d'erreurs qui se produisent constamment, mais n'affectent pas s√©rieusement le comportement du syst√®me.  Par exemple, un microservice tiers est tomb√© et les tableaux de bord ont trembl√©, mais en fait le syst√®me est hors de danger.  √Ä premi√®re vue, on ne sait pas toujours √† quel point un comportement anormal est critique et ce qui se cache derri√®re.  Pour √©tablir les raisons en d√©tail, vous devez vous rendre sur le serveur et approfondir les journaux.  Une telle op√©ration doit √™tre effectu√©e des dizaines de fois par jour.  Confions-la au moins partiellement √† la voiture. <br><br><h2>  L'apprentissage automatique en tant qu'assistant intelligent </h2><br>  Il existe trois principales sources de donn√©es: Zabbix, ElasticSearch et un syst√®me de surveillance des m√©triques commerciales internes.  Nous utilisons Zabbix pour surveiller le mat√©riel, le r√©seau et la disponibilit√© de divers points d'entr√©e dans les syst√®mes.  √Ä l'aide d'ElasticSearch, analysez et extrayez le journal des messages.  Diverses erreurs, ex√©cutions et requ√™tes sont utilis√©es comme m√©triques.  Les analystes commerciaux surveillent cependant les performances des utilisateurs: le nombre de transferts, de ventes et d'autres activit√©s commerciales.  Les donn√©es sont collect√©es √† une fr√©quence d'une fois par minute et ajout√©es √† la base de donn√©es.  Eh bien, les donn√©es sont collect√©es, il est temps d'√©crire un tas de si pour mettre l'apprentissage automatique au combat. <br><br>  Nous formulons le probl√®me comme suit: en ayant les m√©triques du syst√®me en entr√©e, nous classerons l'√©tat final du syst√®me: r√©gulier ou anormal.  Dans ce contexte, le probl√®me s'inscrit parfaitement dans le paradigme de l'apprentissage avec un enseignant.  Cela signifie que l'ensemble de nos donn√©es de formation doivent √™tre √©tiquet√©es.  En d'autres termes, chaque minute de fonctionnement du syst√®me doit avoir une √©tiquette de 0 (comportement normal) ou -1 (comportement anormal). <br><br>  Dans la vie, il s'av√®re que tout n'est pas aussi rose que nous le souhaiterions.  En r√®gle g√©n√©rale, tous les incidents ne sont pas enregistr√©s dans JIRA, beaucoup reste dans le courrier et ne va pas au-del√†, et parfois les d√©lais de l'anomalie sont flous ou inexacts.  Il s'av√®re que la construction d'un ensemble de donn√©es de haute qualit√© dans le domaine des donn√©es historiques n'est pas une t√¢che triviale. <br><br>  Alors que les nouvelles donn√©es commencent √† peine √† √™tre pr√©sent√©es, essayons de tirer le meilleur parti de ce que nous avons d√©j√†.  Pour les cas o√π les donn√©es n'ont pas de balisage, des algorithmes d'apprentissage sans professeur sont utilis√©s.  Nous partirons du fait que la plupart du temps le syst√®me fonctionne correctement, mais que des √©v√©nements impr√©vus se produisent parfois: des bugs (o√π sans eux), la base est tomb√©e, ou, par exemple, la pelle Petr a heurt√© le c√¢ble du centre de donn√©es.  Par cons√©quent, nous r√©duisons notre t√¢che √† la recherche d'anomalies, √† savoir la recherche d'un nouveau comportement syst√®me (D√©tection de nouveaut√©). <br>  Pour ce faire, utilisez l'algorithme de for√™t isol√©e.  Il est d√©j√† impl√©ment√© dans la biblioth√®que sklearn.  Nous utiliserons les m√©triques des syst√®mes de surveillance comme fonctionnalit√©s. <br><br><pre><code class="python hljs">clf = IsolationForest(behaviour=<span class="hljs-string"><span class="hljs-string">'new'</span></span>, max_samples=<span class="hljs-number"><span class="hljs-number">100</span></span>, random_state=rng, contamination=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>)</code> </pre> <br>  Nous formerons la for√™t isol√©e sur des donn√©es historiques et nous utiliserons les nouvelles donn√©es que nous avons d√©j√† r√©ussi √† marquer pour √©valuer la qualit√©.  Il reste donc √† choisir les hyperparam√®tres du mod√®le et la taille du jeu de donn√©es pour la formation. <br><br>  Maintenant, les donn√©es d'√©tat, qui sont collect√©es toutes les minutes, sont entr√©es dans le mod√®le form√© et obtiennent le label 0 ou -1. <br><br><img src="https://habrastorage.org/webt/2j/wi/ly/2jwilytbwxdl-guvfftwujzbsjs.png" alt="image"><br><br>  Un op√©rateur ne peut suivre qu'un seul horaire.  Sur l'axe X - temps, sur le score d'anomalie Y, c'est-√†-dire avec quelle force le mod√®le consid√©rait l'√©tat du syst√®me √† cette minute anormal.  Si la valeur de vitesse a travers√© la poubelle (que le mod√®le s√©lectionne lui-m√™me), le point est teint√© en rouge et une anomalie est enregistr√©e. <br><br>  Nous apprenons maintenant que le syst√®me fonctionne dans un mode inhabituel ou qu'une situation d'urgence s'est produite en temps quasi r√©el.  C'est tr√®s bien, mais qu'en est-il de l'op√©rateur au moment de recevoir le signal de l'anomalie?  Quel tableau de bord regarder?  Essayons d'ouvrir la ¬´bo√Æte noire¬ª de notre mod√®le et de comprendre comment il prend des d√©cisions. <br><br><h2>  Interpr√©tation d'un mod√®le √† l'aide de LIME </h2><br><br>  Il existe diff√©rentes approches pour ouvrir la bo√Æte noire d'un mod√®le form√© et comprendre ce qui est dans l'esprit de la machine.  Avec une r√©gression logistique ou un arbre de d√©cision, tout est clair, il n'est pas difficile de comprendre sur la base duquel la d√©cision a √©t√© prise.  Avec la for√™t isol√©e, les choses sont plus compliqu√©es.  Premi√®rement, il y a un accident √† l'int√©rieur de l'algorithme, et deuxi√®mement, c'est un algorithme d'apprentissage sans professeur. <br><br>  Le premier candidat √©tait la biblioth√®que LIME, qui utilise l'approche mod√®le agnostique, qui aide √† interpr√©ter tous les mod√®les, l'essentiel est que la sortie du mod√®le a une distribution probabiliste entre les classes.  D'accord, bien s√ªr, le r√©sultat n'est pas la probabilit√©, mais bient√¥t, mais essayons de les normaliser dans la plage de 0 √† 1 et de le traiter comme une probabilit√©.  Ainsi, nous avons pu fournir un format d'entr√©e compatible avec LIME. <br>  La fa√ßon dont LIME a interpr√©t√© les r√©sultats √©tait d√©cevante.  Premi√®rement, √† titre d'interpr√©tation, il y avait plusieurs signes les plus importants √† la sortie et, dans la plupart des cas, un seul d'entre eux refl√©tait vraiment ad√©quatement l'essence de la d√©cision, le reste ajoutant du bruit.  Le deuxi√®me inconv√©nient √©tait que l'interpr√©tation √©tait instable et produisait souvent diff√©rentes listes de signes d'une course √† l'autre.  Pour obtenir des r√©sultats plus stables, vous avez d√ª ex√©cuter l'interpr√©tation plusieurs fois et faire la moyenne des r√©sultats.  Je ne voulais pas vraiment faire √ßa. <br><br><h2>  SHAP - pont de personne √† voiture </h2><br>  Apr√®s cela, nos yeux sont tomb√©s sur une autre biblioth√®que pour l'interpr√©tation des mod√®les - SHAP.  L'id√©e derri√®re la biblioth√®que est venue de la th√©orie des jeux.  La biblioth√®que a √©galement une belle visualisation.  Apr√®s avoir regard√© les exemples, nous avons r√©alis√© avec frustration que SHAP ne pouvait pas interpr√©ter la for√™t isol√©e, et nous voulions vraiment!  Mais, d'autre part, SHAP peut diss√©quer XGBoost en toute confiance.  Nous avons pens√©, et si on nous apprenait √† faire XGBoost la m√™me chose que la for√™t isol√©e peut faire?  Pour ce faire, nous avons pris l'ensemble de nos donn√©es et l'avons marqu√© avec la for√™t isol√©e.  De plus, en tant que cible, ils ont pris non pas un cours, mais un score, qui a √©t√© attribu√© √† la for√™t isol√©e.  Nous pr√©dirons par toutes les m√©triques la vitesse que donnerait la for√™t isol√©e, mais seulement avec XGBoot!  Aussit√¥t dit, aussit√¥t fait.  Nous ex√©cuterons notre jeu de donn√©es balis√© via XGBoost.  Et maintenant, maintenant il sait pr√©dire la vitesse de la m√™me mani√®re que la for√™t isol√©e.  Hourra, maintenant nous pouvons utiliser SHAP! <br><br>  La premi√®re √©tape consiste √† cr√©er un objet TreeExplainer, en passant le mod√®le lui-m√™me comme param√®tre.  Ensuite, les valeurs de shap sont calcul√©es, ce qui nous permet d'expliquer comment le mod√®le a pris telle ou telle d√©cision. <br><br><pre> <code class="python hljs">explainer = shap.TreeExplainer(model) shap_values = explainer.shap_values(X)</code> </pre> <br>  SHAP vous permet d'interpr√©ter √† la fois le mod√®le dans son ensemble et les r√©sultats pour des exemples sp√©cifiques.  Par exemple, vous pouvez obtenir une explication pour un exemple sp√©cifique en utilisant la m√©thode force_plot (), qui re√ßoit les valeurs d'entr√©e et les valeurs de l'exemple lui-m√™me. <br><br><pre> <code class="python hljs">shap.force_plot(explainer.expected_value,shap_values[<span class="hljs-number"><span class="hljs-number">0</span></span>,:], X.iloc[<span class="hljs-number"><span class="hljs-number">0</span></span>,:])</code> </pre> <br>  Il s'av√®re que le graphique suivant, qui montre quelles caract√©ristiques du mod√®le et dans quelle mesure ont influenc√© la d√©cision. <br><br><img src="https://habrastorage.org/webt/k4/he/-u/k4he-ucq5b7zsyjnyc-rwbpmrtg.png" alt="image"><br><br><h2>  Nous aidons les entreprises </h2><br>  Maintenant, sachant quelles mesures ont contribu√© de mani√®re significative au taux global d'anomalie, il devient possible d'√©tablir √† quel niveau le probl√®me est survenu et, surtout, s'il a affect√© les utilisateurs finaux du syst√®me. <br><br><img src="https://habrastorage.org/webt/wp/rp/6g/wprp6gc-gzbjzotptcjvb6hlj9a.png" alt="image"><br><br>  Chaque fois qu'une anomalie est d√©tect√©e, une liste de m√©triques ayant le plus grand impact sur la d√©cision est obtenue.  Si la liste comprend des m√©triques qui suivent directement les indicateurs li√©s √† l'entreprise, cela est mentionn√© dans l'alerte d'une mani√®re sp√©ciale, augmentant ainsi automatiquement la priorit√© de l'anomalie. <br><br>  Ce n'est que la premi√®re mais importante √©tape dans le renforcement et l'automatisation du syst√®me de surveillance √† l'aide de l'apprentissage automatique, ce qui peut augmenter consid√©rablement la vitesse d'identification des causes et de l'influence du comportement anormal du syst√®me. <br><br>  <b>R√©f√©rences:</b> <br><br>  <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html">scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html</a> <br>  <a href="https://github.com/marcotcr/lime">github.com/marcotcr/lime</a> <br>  <a href="https://github.com/slundberg/shap">github.com/slundberg/shap</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr479712/">https://habr.com/ru/post/fr479712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr479696/index.html">Quelques mots sur Alter Table, ou comment ne pas le faire</a></li>
<li><a href="../fr479700/index.html">CIMON-2: (un) Doomsday, ou comment IBM Watson a grimp√© au-dessus des nuages</a></li>
<li><a href="../fr479702/index.html">Toaster, My Circle et Freelansim font partie de Habr</a></li>
<li><a href="../fr479704/index.html">Escalade de privil√®ges dans le client EA Origin Windows (CVE-2019-19247 et CVE-2019-19248)</a></li>
<li><a href="../fr479708/index.html">Article non officiel sur le changement de marque de Habr + Competition</a></li>
<li><a href="../fr479714/index.html">Unification des composants visuels. Partie 1. Styles</a></li>
<li><a href="../fr479716/index.html">Une autre SuperApp "premi√®re au monde"</a></li>
<li><a href="../fr479718/index.html">Cr√©ation d'une application d'environnement Arduino √† l'aide de CI Github</a></li>
<li><a href="../fr479724/index.html">Les pirates informatiques sont termin√©s</a></li>
<li><a href="../fr479726/index.html">Vladimir aka wowik: ¬´OpenStreetMap a besoin d'id√©es irr√©alisables dans d'autres syst√®mes¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>