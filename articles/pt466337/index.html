<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚Äç‚úàÔ∏è üë©üèª‚Äçüöí üç• Qual a cor da sua fun√ß√£o? üßõ üë©üèΩ‚Äç‚öñÔ∏è üë©üèΩ‚Äçü§ù‚Äçüë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="N√£o sei voc√™, mas para mim n√£o h√° melhor come√ßo do dia do que me preocupar com programa√ß√£o. O sangue ferve ao ver uma cr√≠tica bem-sucedida de uma das ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Qual a cor da sua fun√ß√£o?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466337/"><p>  N√£o sei voc√™, mas para mim n√£o h√° melhor come√ßo do dia do que me preocupar com programa√ß√£o.  O sangue ferve ao ver uma cr√≠tica bem-sucedida de uma das l√≠nguas "ousadas" usadas pelos plebeus, atormentada durante todo o dia de trabalho entre visitas t√≠midas ao StackOverflow. </p><br><p>  (Enquanto isso, voc√™ e eu usamos apenas a linguagem mais esclarecida e as ferramentas sofisticadas projetadas para as m√£os h√°beis de mestres como n√≥s). </p><br><p>  Obviamente, como autor do serm√£o, corro riscos.  Voc√™ pode gostar do idioma que eu zoo!  Um panfleto imprudente poderia ter inadvertidamente levado ao meu blog uma multid√£o furiosa de celulares com forquilhas e tochas prontas. </p><br><p>  Para me proteger do fogo justo e n√£o ofender seus sentimentos (provavelmente delicados), falarei sobre a linguagem ... </p><a name="habracut"></a><br><p>  ... quem acabou de aparecer.  Sobre uma ef√≠gie de palha, cujo √∫nico papel √© queimar cr√≠ticos em jogo. </p><br><p>  Sei que isso parece bobagem, mas acredite, no final, veremos cujo rosto (ou rostos) foi pintado em uma cabe√ßa de palha. </p><br><h1 id="novyy-yazyk">  Novo idioma </h1><br><p> Ser√° um exagero aprender um idioma completamente novo (e chato) apenas para um artigo de blog, ent√£o digamos que seja muito semelhante ao idioma que j√° conhecemos.  Por exemplo Javascript.  Chaves e ponto e v√≠rgula.  <code>if</code> , <code>while</code> , etc.  - <em>Lingua franca da</em> nossa multid√£o. </p><br><p>  Eu escolhi JS n√£o porque este artigo √© sobre ele.  √â apenas uma linguagem na qual o leitor comum provavelmente entrar√°.  Voila: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">thisIsAFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"!"</span></span>; }</code> </pre> <br><p>  Como o bicho de pel√∫cia √© uma linguagem <em>legal</em> (de leitura ruim), possui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fun√ß√µes de primeira classe</a> .  Ent√£o voc√™ pode escrever algo como isto: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,     , //    function filter(collection, predicate) { var result = []; for (var i = 0; i &lt; collection.length; i++) { if (predicate(collection[i])){ result.push(collection[i]); } } return result; }</span></span></code> </pre> <br><p>  Este √© um dos recursos de <em>primeira classe</em> e, como o nome sugere, eles s√£o legais e super √∫teis.  Voc√™ provavelmente est√° acostumado a transformar cole√ß√µes de dados com a ajuda deles, mas assim que compreende o conceito, come√ßa a us√°-los em qualquer lugar, caramba. </p><br><p>  Talvez nos testes: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ it(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ expect(<span class="hljs-string"><span class="hljs-string">""</span></span>).not.toBe(<span class="hljs-string"><span class="hljs-string">""</span></span>); }); };</code> </pre> <br><p>  Ou quando voc√™ precisar analisar (analisar) os dados: </p><br><pre> <code class="javascript hljs">tokens.match(Token.LEFT_BRACKET, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">token</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Parse a list literal... tokens.consume(Token.RIGHT_BRACKET); });</span></span></code> </pre> <br><p>  Depois de acelerar, voc√™ escreve todos os tipos de bibliotecas e aplicativos reutiliz√°veis ‚Äã‚Äãque giram em torno de fun√ß√µes, chamadas de fun√ß√µes, retornos de fun√ß√µes - um estande funcional. </p><br><blockquote>  tradutor: no original "Functapalooza".  O prefixo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">-a-palooza</a> √© t√£o legal que voc√™ deseja compartilh√°-lo com todos. </blockquote><br><h1 id="kakogo-cveta-vasha-funkciya">  Qual a cor da sua fun√ß√£o? </h1><br><p>  E aqui come√ßam as esquisitices.  Nossa linguagem tem uma caracter√≠stica peculiar: </p><br><h3 id="1-kazhdaya-funkciya-imeet-cvet">  1. Cada fun√ß√£o tem uma cor. </h3><br><p>  Cada fun√ß√£o - um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">retorno de chamada</a> an√¥nimo ou uma fun√ß√£o regular com um nome - √© vermelha ou azul.  Como o destaque do c√≥digo em nosso blog n√£o destaca as diferentes cores das fun√ß√µes, vamos concordar que a sintaxe √©: </p><br><pre> <code class="javascript hljs">blue*<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomethingAzure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   ... } red*function doSomethingCarnelian(){ //    ... }</span></span></code> </pre> <br><p>  Nossa linguagem n√£o possui fun√ß√µes incolores.  Deseja criar um recurso?  - deve escolher uma cor.  Estas s√£o as regras.  E h√° mais algumas regras que voc√™ deve seguir: </p><br><h3 id="2-cvet-vliyaet-na-sposob-vyzova-funkcii">  2. A cor afeta a maneira como a fun√ß√£o √© chamada </h3><br><p>  Imagine que existem duas sintaxes para chamar fun√ß√µes - "azul" e "vermelho".  Algo como: </p><br><pre> <code class="javascript hljs">doSomethingAzure(...)*blue; doSomethingCarnelian()*red;</code> </pre> <br><p>  Ao chamar uma fun√ß√£o, voc√™ deve usar uma chamada que corresponda √† sua cor.  Se voc√™ n√£o adivinhou - eles chamaram a fun√ß√£o vermelha com <code>*blue</code> ap√≥s os colchetes (ou vice-versa) - algo muito ruim acontecer√°.  Um pesadelo esquecido na inf√¢ncia, como um palha√ßo com cobras em vez de m√£os que se escondia embaixo da sua cama.  Ele pular√° do monitor e chupar√° seus olhos. </p><br><p>  Regra est√∫pida, certo?  Ah, mas mais uma coisa: </p><br><h3 id="3-tolko-krasnaya-funkciya-mozhet-vyzvat-krasnuyu-funkciyu">  3. Somente a fun√ß√£o vermelha pode causar a fun√ß√£o vermelha. </h3><br><p>  Voc√™ <em>pode</em> chamar a fun√ß√£o azul do vermelho.  Isto √© kosher: </p><br><pre> <code class="javascript hljs">red*<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomethingCarnelian</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ doSomethingAzure()*blue; }</code> </pre> <br><p>  Mas n√£o o contr√°rio.  Se voc√™ tentar: </p><br><pre> <code class="javascript hljs">blue*<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomethingAzure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ doSomethingCarnelian()*red; }</code> </pre> <br><p>  - voc√™ ser√° visitado pelo velho Clown Spider Maw. </p><br><p>  Isso torna mais dif√≠cil escrever fun√ß√µes mais altas, como <code>filter()</code> do exemplo.  Devemos escolher uma cor para cada nova fun√ß√£o e isso afeta a cor das fun√ß√µes que podemos passar para ela.  A solu√ß√£o √≥bvia √© tornar o <code>filter()</code> vermelho.  Ent√£o podemos chamar pelo menos fun√ß√µes vermelhas, pelo menos azuis.  Mas ent√£o nos machucamos com o pr√≥ximo espinho na coroa de espinhos, que √© o idioma indicado: </p><br><h3 id="4-krasnye-funkcii-bolnee-vyzyvat">  4. Fun√ß√µes vermelhas causam dor </h3><br><p>  N√£o identificaremos essa "dor", apenas imagine que o programador deve pular o arco toda vez que ele chamar a fun√ß√£o vermelha.  A chamada pode ser muito polissil√°bica ou voc√™ n√£o pode executar a fun√ß√£o em algumas express√µes.  Ou voc√™ s√≥ pode acessar a fun√ß√£o vermelha a partir de linhas √≠mpares. </p><br><p>  N√£o importa o que seja, mas se voc√™ decidir tornar a fun√ß√£o vermelha, todos que usarem sua API querer√£o cuspir no caf√© ou fazer algo pior. </p><br><p>  A solu√ß√£o √≥bvia nesse caso √© nunca usar fun√ß√µes vermelhas.  Apenas deixe tudo azul e voc√™ estar√° de volta ao mundo normal, onde todas as fun√ß√µes s√£o da mesma cor, o que √© igual ao fato de que elas n√£o t√™m cor e que nossa linguagem n√£o √© completamente idiota. </p><br><p>  Infelizmente, os s√°dicos que desenvolveram essa linguagem (todos sabem que os autores de linguagens de programa√ß√£o s√£o s√°dicos, certo?) Prendem o √∫ltimo espinho em n√≥s: </p><br><h3 id="5-nekotorye-funkcii-yadra-yazyka----krasnye">  5. Algumas das principais fun√ß√µes do idioma s√£o vermelhas. </h3><br><p>  Algumas fun√ß√µes integradas √† plataforma, fun√ß√µes que <em>precisamos</em> usar e que n√£o podem ser escritas por n√≥s mesmos, est√£o dispon√≠veis apenas em vermelho.  Nesse ponto, uma pessoa inteligente pode come√ßar a suspeitar que esse idioma nos odeia. </p><br><h1 id="eto-vse-vina-funkcionalnyh-yazykov">  Isso √© tudo culpa das linguagens funcionais! </h1><br><p>  Voc√™ pode pensar que o problema √© que estamos tentando usar fun√ß√µes de ordem superior.  Se pararmos de brincar com toda essa bobagem funcional e come√ßarmos a escrever fun√ß√µes azuis de <em>primeira ordem</em> normais (fun√ß√µes que n√£o operam com outras fun√ß√µes - aprox. Translator), conforme planejado por Deus -, nos livraremos de toda essa dor. </p><br><p>  Se chamarmos apenas fun√ß√µes azuis, tornaremos todas as nossas fun√ß√µes azuis.  Caso contr√°rio, tornamos vermelho.  At√© criarmos fun√ß√µes que aceitem fun√ß√µes, n√£o precisamos nos preocupar com "polimorfismo com a cor da fun√ß√£o" (policrom√°tico?) Ou com outras bobagens. </p><br><p>  Mas, infelizmente, fun√ß√µes de ordem superior s√£o apenas um exemplo.  O problema surge toda vez que queremos dividir nosso programa em fun√ß√µes para reutiliza√ß√£o. </p><br><p>  Por exemplo, temos um pequeno peda√ßo de c√≥digo que, bem, n√£o sei, implementa o algoritmo de Dijkstra sobre um gr√°fico que representa o quanto suas conex√µes sociais pressionam umas √†s outras.  (Passei muito tempo tentando decidir o que o resultado significaria. Indesejabilidade transitiva?) </p><br><p>  Mais tarde, voc√™ precisou usar esse algoritmo em outro lugar.  Naturalmente, voc√™ quebra o c√≥digo em uma fun√ß√£o separada.  Ligue para ela do lugar antigo e do novo.  Mas que cor deve ser a fun√ß√£o?  Voc√™ provavelmente tentar√° torn√°-lo azul, mas e se ele usar uma dessas fun√ß√µes "apenas vermelhas" desagrad√°veis ‚Äã‚Äãda biblioteca do kernel? </p><br><p>  Digamos que o novo local do qual voc√™ deseja chamar a fun√ß√£o seja azul?  Mas agora voc√™ precisa reescrever o c√≥digo de chamada em vermelho.  E, em seguida, refa√ßa a fun√ß√£o que chama esse c√≥digo.  Ufa  Voc√™ ter√° que se lembrar constantemente da cor de qualquer maneira.  Esta ser√° a areia do seu cal√ß√£o de banho em uma programa√ß√£o de f√©rias na praia. </p><br><h1 id="cvetnaya-allegoriya">  Alegoria da cor </h1><br><p>  Na verdade, n√£o estou falando de cores.  Isso √© uma alegoria, um artif√≠cio liter√°rio.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Foda-se</a> - isso n√£o √© sobre as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estrelas nas barrigas</a> , √© sobre a corrida.  Voc√™ provavelmente j√° suspeita ... </p><br><h3 id="krasnye-funkcii---asinhronnye">  Fun√ß√µes vermelhas - ass√≠ncronas </h3><br><p>  Se voc√™ programar em JavaScript ou Node.js, sempre que definir uma fun√ß√£o que chama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma fun√ß√£o de</a> retorno de chamada (retorno de chamada) para "retornar" o resultado, voc√™ escrever√° uma fun√ß√£o vermelha.  Veja esta lista de regras e observe como elas se encaixam na minha met√°fora: </p><br><ol><li>  Fun√ß√µes s√≠ncronas retornam um resultado, fun√ß√µes ass√≠ncronas n√£o; em troca, chamam um retorno de chamada. </li><li>  As fun√ß√µes s√≠ncronas retornam o resultado como um valor de retorno, as fun√ß√µes ass√≠ncronas o retornam, causando o retorno de chamada que voc√™ passou para eles. </li><li>  Voc√™ n√£o pode chamar uma fun√ß√£o ass√≠ncrona de uma s√≠ncrona, porque n√£o pode saber o resultado at√© que a fun√ß√£o ass√≠ncrona seja executada posteriormente. </li><li>  Fun√ß√µes ass√≠ncronas n√£o s√£o compiladas em express√µes devido a retornos de chamada, exigem que seus erros sejam tratados de maneira diferente e n√£o podem ser usados ‚Äã‚Äãem um bloco de <code>try/catch</code> ou em v√°rias outras express√µes que controlam o programa. </li><li>  A coisa toda sobre o Node.js √© que a biblioteca do kernel √© toda ass√≠ncrona.  (Embora eles doem de volta e come√ßaram a adicionar vers√µes <code>_Sync()</code> a v√°rias coisas). </li></ol><br><p>  Quando as pessoas falam sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"inferno de retorno de chamada"</a> , falam sobre como √© irritante ter fun√ß√µes "vermelhas" em seu idioma.  Quando eles criam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4089 bibliotecas para programa√ß√£o ass√≠ncrona</a> (em 2019, j√° em 11217 - aprox. Tradutor), eles tentam lidar com o problema no n√≠vel da biblioteca de que estavam presos √† linguagem. </p><br><h1 id="i-promise-the-future-is-better">  Eu prometo que o futuro √© melhor </h1><br><blockquote>  na tradu√ß√£o: "Eu prometo que o futuro √© melhor" o jogo de palavras do t√≠tulo e do conte√∫do da se√ß√£o est√° perdido </blockquote><p>  As pessoas no Node.js h√° muito tempo percebem que os retornos de chamada s√£o prejudiciais e estavam procurando solu√ß√µes.  Uma das t√©cnicas que inspirou muitas pessoas s√£o as <code>promises</code> , que voc√™ tamb√©m pode conhecer pelo apelido de <code>futures</code> . </p><br><blockquote>  na TI russa, em vez de traduzir "promessas" como "promessas", foi estabelecido um papel vegetal do ingl√™s - "promessas".  A palavra "Futuros" √© usada como √©, provavelmente porque os "futuros" j√° est√£o ocupados por g√≠rias financeiras. </blockquote><p>  Promis √© um wrapper para retorno de chamada e manipulador de erros.  Se voc√™ est√° pensando em passar um retorno de chamada para o resultado e outro retorno de chamada para o erro, o <code>future</code> √© a personifica√ß√£o dessa ideia.  Este √© um objeto b√°sico que √© uma opera√ß√£o ass√≠ncrona. </p><br><p>  Acabei de receber um monte de palavras sofisticadas e pode parecer uma √≥tima solu√ß√£o, mas principalmente √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√≥leo de cobra</a> .  As promessas realmente facilitam a escrita de c√≥digo ass√≠ncrono.  Como s√£o mais f√°ceis de compor em express√µes, a regra 4 √© um pouco menos rigorosa. </p><br><p>  Mas, para ser sincero, √© como a diferen√ßa entre um golpe no est√¥mago ou na virilha.  Sim, n√£o d√≥i tanto, mas ningu√©m ficar√° encantado com essa escolha. </p><br><p>  Voc√™ ainda n√£o pode usar promessas com tratamento de exce√ß√£o ou outros <br>  operadores de gerenciamento.  Voc√™ n√£o pode chamar uma fun√ß√£o que retorne <code>future</code> do c√≥digo s√≠ncrono.  (voc√™ <em>pode</em> , mas o pr√≥ximo mantenedor do seu c√≥digo inventar√° uma m√°quina do tempo, retornar√° no momento em que voc√™ o fez e enfiar√° um l√°pis na sua cara pelo motivo 2). </p><br><p>  As promessas ainda dividem seu mundo em metades ass√≠ncronas e s√≠ncronas com todo o sofrimento que se segue.  Portanto, mesmo que seu idioma suporte <code>promises</code> ou <code>futures</code> , ele ainda se parece muito com o meu idioma de pel√∫cia. </p><br><p>  (Sim, isso inclui at√© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dart</a> que eu uso. Portanto, estou t√£o feliz que parte da equipe esteja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tentando outras abordagens do paralelismo</a> ) </p><br><blockquote>  link do projeto abandonado oficialmente </blockquote><br><h1 id="im-awaiting-a-solution">  Estou aguardando uma solu√ß√£o </h1><br><p>  Os programadores de C # provavelmente se sentem complacentes (a raz√£o pela qual est√£o se tornando cada vez mais v√≠timas √© que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Halesberg</a> e a empresa polvilham tudo e polvilham a linguagem com a√ß√∫car sint√°tico).  Em C #, voc√™ pode usar a palavra-chave <code>await</code> para chamar uma fun√ß√£o ass√≠ncrona. </p><br><p>  Isso torna a realiza√ß√£o de chamadas ass√≠ncronas t√£o f√°cil quanto s√≠ncrona, com a adi√ß√£o de uma pequena palavra-chave atraente.  Voc√™ pode inserir uma chamada em <code>await</code> nas express√µes, us√°-las no tratamento de exce√ß√µes, no fluxo de instru√ß√µes.  Voc√™ pode enlouquecer.  Vamos esperar a chuva como dinheiro para o seu novo √°lbum de rapper. </p><br><p>  O Async-Waitit √© bom, ent√£o o adicionamos ao Dart.  √â muito mais f√°cil <em>escrever</em> c√≥digo ass√≠ncrono com ele.  Mas, como sempre, h√° um "Mas".  Aqui est√°.  <em>Mas ...</em> voc√™ ainda divide o mundo ao meio.  As fun√ß√µes ass√≠ncronas agora s√£o mais f√°ceis de escrever, mas <em>ainda s√£o fun√ß√µes ass√≠ncronas.</em> </p><br><p>  Voc√™ ainda tem duas cores.  A espera ass√≠ncrona resolve o problema irritante n¬∫ 4 - eles tornam as fun√ß√µes de chamada em vermelho n√£o mais dif√≠ceis do que as chamadas em azul.  Mas o restante das regras ainda est√° aqui: </p><br><ol><li>  Fun√ß√µes s√≠ncronas retornam valores, fun√ß√µes ass√≠ncronas retornam um wrapper ( <code>Task&lt;T&gt;</code> em C # ou <code>Future&lt;T&gt;</code> em Dart) ao redor do valor. </li><li>  S√≠ncrono apenas chamado, necessidade ass√≠ncrona de <code>await</code> . </li><li>  Ao chamar uma fun√ß√£o ass√≠ncrona, voc√™ obt√©m um objeto wrapper quando realmente deseja um valor.  Voc√™ n√£o pode expandir o valor at√© tornar <em>sua</em> fun√ß√£o ass√≠ncrona e cham√°-la com <code>await</code> (mas consulte o pr√≥ximo par√°grafo). </li><li>  Al√©m de aguardar um pouco de decora√ß√£o, pelo menos resolvemos esse problema. </li><li>  A biblioteca principal do C # √© mais antiga que a assincronia, ent√£o eu acho que eles nunca tiveram esse problema. </li></ol><br><p>  <code>Async</code> <em>realmente</em> melhor.  Eu preferiria espera ass√≠ncrona a retornos nus em qualquer dia da semana.  Mas mentimos para n√≥s mesmos se pensarmos que todos os problemas est√£o resolvidos.  Assim que voc√™ come√ßa a escrever fun√ß√µes de ordem superior ou a reutilizar o c√≥digo, percebe novamente que a cor ainda est√° l√°, sangrando por todo o seu c√≥digo-fonte. </p><br><h1 id="kakoy-yazyk-_ne_-cvetnoy">  Qual idioma <em>n√£o</em> √© cor? </h1><br><p>  Ent√£o, JS, Dart, C # e Python t√™m esse problema.  CoffeeScript e a maioria das outras linguagens compilando tamb√©m em JS (e Dart herdado).  Acho que mesmo o ClojureScript tem essa pegada, apesar de seus esfor√ßos ativos com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">core.async</a> </p><br><p>  Quer saber qual deles n√£o?  <em>Java</em>  Estou certo  Com que frequ√™ncia voc√™ diz: "Sim, apenas Java est√° fazendo certo"?  E assim aconteceu.  Em sua defesa, eles est√£o tentando ativamente corrigir sua supervis√£o promovendo <code>futures</code> e E / S ass√≠ncronas.  √â como uma corrida pior que pior. </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tudo</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">j√°</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√°</a> em Java </blockquote><p>  C #, de fato, tamb√©m <em>pode</em> contornar esse problema.  Eles <em>escolheram</em> ter cor.  Antes de adicionarem async-waitit e todo esse lixo eletr√¥nico <code>Task&lt;T&gt;</code> , era poss√≠vel usar chamadas de API s√≠ncronas regulares.  Tr√™s outros idiomas que n√£o t√™m um problema de "cor": Go, Lua e Ruby. </p><br><p>  Adivinha o que eles t√™m em comum? </p><br><p>  <em>Streams.</em>  Ou, mais precisamente: muitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pilhas de chamadas</a> independentes que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">podem ser trocadas</a> .  Esses n√£o s√£o necessariamente threads do sistema operacional.  Corotinas em Go, corotinas em Lua e threads em Ruby s√£o adequadas. </p><br><p>  (√â por isso que existe essa pequena advert√™ncia para C # - voc√™ pode evitar a dor ass√≠ncrona em C # usando threads.) </p><br><h1 id="pamyat-o-proshlyh-operaciyah">  Mem√≥ria de opera√ß√µes passadas </h1><br><p>  O problema fundamental √© "como continuar do mesmo local quando a opera√ß√£o (ass√≠ncrona) √© conclu√≠da"?  Voc√™ mergulhou no abismo da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pilha de chamadas</a> e depois chamou algum tipo de opera√ß√£o de E / S.  Por uma quest√£o de acelera√ß√£o, esta opera√ß√£o usa a API ass√≠ncrona subjacente do seu sistema operacional.  Voc√™ <em>n√£o pode</em> esperar para concluir.  Voc√™ deve retornar ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">loop de eventos do</a> seu idioma e dar tempo ao SO para concluir a opera√ß√£o. </p><br><p>  Quando isso acontece, voc√™ precisa retomar o que estava fazendo.  Geralmente, o idioma "lembra onde estava" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">na pilha de chamadas</a> .  Ele segue todas as fun√ß√µes que foram chamadas no momento e olha para onde o contador de comandos em cada uma delas aparece. </p><br><p>  Mas, para executar E / S ass√≠ncrona, voc√™ deve relaxar, descartar toda a pilha de chamadas em C. Digite Trick-22.  Voc√™ possui E / S super r√°pidas, mas n√£o pode usar o resultado!  Todos os idiomas com E / S ass√≠ncrona sob o cap√¥ - ou, no caso de JS, o loop de eventos do navegador - s√£o for√ßados a lidar com isso de alguma forma. </p><br><p>  Node, com seus retornos de chamada marcantes para sempre, enfia todas essas chamadas em fechamento.  Quando voc√™ escreve: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeSundae</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">callback</span></span></span><span class="hljs-function">) </span></span>{ scoopIceCream(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">iceCream</span></span></span><span class="hljs-function">) </span></span>{ warmUpCaramel(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caramel</span></span></span><span class="hljs-function">) </span></span>{ callback(pourOnIceCream(iceCream, caramel)); }); }); }</code> </pre> <br><p>  Cada uma dessas express√µes funcionais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>fecha</em></a> todo o contexto circundante.  Isso transfere par√¢metros, como <code>iceCream</code> e <code>caramel</code> , da pilha de chamadas para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pilha</a> .  Quando uma fun√ß√£o externa retorna um resultado e a pilha de chamadas √© destru√≠da, isso √© legal.  Os dados ainda est√£o em algum lugar na pilha. </p><br><p>  O problema √© que voc√™ precisa ressuscitar cada uma dessas chamadas malditas novamente.  Existe at√© um nome especial para esta convers√£o: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estilo de passagem de continua√ß√£o</a> </p><br><blockquote>  vincular funcionalidade feroz </blockquote><p>  Isso foi inventado por hackers de linguagem nos anos 70, como uma representa√ß√£o intermedi√°ria para uso sob o cap√¥ de compiladores.  Essa √© uma maneira muito bizarra de introduzir c√≥digo que facilita a execu√ß√£o de algumas otimiza√ß√µes do compilador. </p><br><p>  Ningu√©m nunca pensou que um programador pudesse <em>escrever esse c√≥digo</em> .  E ent√£o Node apareceu e, de repente, todos fingimos escrever um back-end do compilador.  Onde n√≥s viramos o caminho errado? </p><br><p>  Observe que promessas e <code>futures</code> realmente n√£o ajudam muito.  Se voc√™ us√°-los, sabe que ainda est√° acumulando camadas gigantes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">express√µes funcionais</a> .  Voc√™ apenas os passa para <code>.then()</code> vez da pr√≥pria fun√ß√£o ass√≠ncrona. </p><br><h1 id="awaiting-a-generated-solution">  Aguardando uma solu√ß√£o gerada </h1><br><p>  Async-waitit <em>realmente</em> ajuda.  Se voc√™ olhar embaixo do cap√¥ para o compilador quando ele encontrar, voc√™ ver√° que ele realmente realiza a convers√£o do CPS.  √â <em>por isso que</em> voc√™ precisa usar <code>await</code> em C # - esta √© uma dica para o compilador - "interrompa a fun√ß√£o aqui no meio".  Tudo o que <code>await</code> depois se torna uma nova fun√ß√£o que o compilador sintetiza em seu nome. </p><br><p>  √â por isso que o async-waitit n√£o precisa de suporte de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tempo de execu√ß√£o</a> dentro da estrutura .NET.  O compilador compila isso em uma cadeia de fechamentos relacionados, com os quais ele j√° sabe como lidar.  (Curiosamente, os fechamentos tamb√©m n√£o precisam de suporte de tempo de execu√ß√£o. Eles s√£o compilados em classes an√¥nimas. Em C #, os fechamentos s√£o apenas objetos.) </p><br><p>  Voc√™ provavelmente est√° se perguntando quando menciono os geradores.  Existe <code>yield</code> no seu idioma?  Ent√£o ele pode fazer algo muito semelhante. </p><br><p>  (Acredito que os geradores e o async-waitit s√£o realmente isom√≥rficos. Em algum lugar nos cantos e recantos empoeirados do meu disco r√≠gido existe um peda√ßo de c√≥digo que implementa um ciclo de jogo nos geradores usando apenas o async-wait). </p><br><p>  Ent√£o, onde eu estou?  Ah sim.  Assim, com retornos de chamada, promessas, espera ass√≠ncrona e geradores, voc√™ acaba pegando sua fun√ß√£o ass√≠ncrona e dividindo-a em v√°rios fechamentos que ficam na pilha. </p><br><p>  Sua fun√ß√£o chama externa em tempo de execu√ß√£o.  Quando o loop de eventos ou a opera√ß√£o de E / S √© conclu√≠da, sua fun√ß√£o √© chamada e continua de onde estava.  Mas isso significa que tudo no topo da sua fun√ß√£o <em>tamb√©m</em> deve retornar.  Voc√™ ainda precisa restaurar a pilha inteira. </p><br><p>  √â da√≠ que vem a regra: "Voc√™ s√≥ pode chamar a fun√ß√£o vermelha a partir da fun√ß√£o vermelha"  Voc√™ deve salvar toda a pilha de chamadas nos fechamentos para <code>main()</code> ou para o manipulador de eventos. </p><br><h1 id="realizaciya-steka-vyzovov">  Implementa√ß√£o da pilha de chamadas </h1><br><p>  Mas, usando threads ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verde</a> ou n√≠vel do SO), voc√™ n√£o precisa fazer isso.  Voc√™ pode simplesmente pausar o segmento inteiro e pular para o SO ou o loop de eventos <em>sem precisar retornar de todas essas fun√ß√µes</em> . </p><br><p>  A linguagem Go, no meu entender, faz isso da maneira mais perfeita.  Assim que voc√™ fizer qualquer opera√ß√£o de E / S, o Go estacionar√° essa corotina e continuar√° qualquer outra que n√£o seja bloqueada pela E / S. </p><br><p>  Se voc√™ observar as opera√ß√µes de E / S na biblioteca padr√£o Golang, elas parecem s√≠ncronas.  Em outras palavras, eles simplesmente funcionam e retornam o resultado quando estiverem prontos.  Mas essa sincroniza√ß√£o n√£o significa o mesmo que no Javascript.  Go-  ,    IO .  Go       . </p><br><p>   Go ‚Äî   <em></em>    ,        .       ,   ,    . </p><br><p>     ,               API,   ,     .           . </p><br><hr><br><h1 id="ot-perevodchika">   </h1><br><p>  ,           ,          .       ,        . ,      50%          . </p><br><p> ,      ,      ,                 . </p><br><p>  Javascript   -,   , ,   JS   ,    JS   ,          .   ,    JS   . </p><br><p>      ,      (     )   ‚Äî  ,     ,   ,        <code>async</code>         .     <code>import threading</code>      (  ,          AsyncIO, Twisted  Tornado,    ). </p><br><p>     ,             ,     ,     ,        ,                  ,      . </p><br><p>       ,     Go,     Go . </p><br><p>  ,        ,  ,  ( -    )          ,          "async-await  ".      . </p><br><p>    ,       . </p><br><p> ,       ,     . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466337/">https://habr.com/ru/post/pt466337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466319/index.html">Acordo: VMware compra startup baseada na nuvem</a></li>
<li><a href="../pt466323/index.html">Criamos um jogo de plataforma port√°til no microcontrolador Cortex M0 +</a></li>
<li><a href="../pt466329/index.html">Mapa eletr√¥nico de vinifica√ß√£o na R√∫ssia. Design e conte√∫do</a></li>
<li><a href="../pt466333/index.html">Como organizar um local de trabalho para si mesmo</a></li>
<li><a href="../pt466335/index.html">Criando um aplicativo Slack usando os recursos do 8base</a></li>
<li><a href="../pt466339/index.html">Como no Microsoft SQL Server para obter dados do Google Analytics usando R</a></li>
<li><a href="../pt466341/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 33. Prepara√ß√£o para o exame ICND1</a></li>
<li><a href="../pt466349/index.html">Como realizar testes A / B em 15.000 lojas offline</a></li>
<li><a href="../pt466355/index.html">Os crocodilos voam, mas baixo-baixo (sobre ekranoplanes sem emo√ß√µes, mas com digress√µes)</a></li>
<li><a href="../pt466359/index.html">Por que o Dia Mundial da D√≠vida Ecol√≥gica e a pegada ambiental s√£o um absurdo pseudocient√≠fico</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>