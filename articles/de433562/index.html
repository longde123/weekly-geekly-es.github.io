<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüè´ ‚ùå üëô √úberpr√ºfung des LibrePCB-Projekts mit PVS-Studio im Docker-Container üë®üèΩ‚Äçüöí ‚õÖÔ∏è üñãÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist ein klassischer Artikel dar√ºber, wie unser Team ein offenes LibrePCB-Projekt mit dem statischen Code-Analysator PVS-Studio getestet hat. Der ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√úberpr√ºfung des LibrePCB-Projekts mit PVS-Studio im Docker-Container</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/433562/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9cf/0ad/c99/9cf0adc990a16a5f4b3589254d6d1ecf.png" alt="PVS-Studio und Docker Container"></div><br>  Dies ist ein klassischer Artikel dar√ºber, wie unser Team ein offenes LibrePCB-Projekt mit dem statischen Code-Analysator PVS-Studio getestet hat.  Der Artikel ist jedoch insofern interessant, als die √úberpr√ºfung im Docker-Container durchgef√ºhrt wurde.  Wenn Sie Container verwenden, hoffen wir, dass der Artikel eine weitere einfache M√∂glichkeit zur Integration des Analysators in den Entwicklungsprozess zeigt. <br><a name="habracut"></a><br><h2>  LibrePCB </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LibrePCB</a> ist eine kostenlose Software zum Entwerfen elektronischer Schaltungen und Leiterplatten.  Der Programmcode ist in C ++ geschrieben und Qt5 wird zum Erstellen der grafischen Oberfl√§che verwendet.  Vor kurzem fand die erste offizielle Ver√∂ffentlichung dieser Anwendung statt, die die Stabilisierung des eigenen Dateiformats (* .lp, * .lplib) markierte.  Bin√§rpakete f√ºr Linux, MacOS und Windows. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eca/fd3/b3e/ecafd3b3e956a20f10f53fa20ae1e93e.png" alt="LibrePCB"></div><br><br>  LibrePCB ist ein kleines Projekt, das nur etwa 300.000 nicht leere Codezeilen in C und C ++ enth√§lt.  Gleichzeitig sind 25% der nicht leeren Zeilen Kommentare.  Dies ist √ºbrigens ein gro√üer Prozentsatz f√ºr Kommentare.  Dies ist h√∂chstwahrscheinlich auf die Tatsache zur√ºckzuf√ºhren, dass das Projekt viele kleine Dateien enth√§lt, von denen ein erheblicher Teil mit √úberschriftenkommentaren aus den Projektinformationen und der Lizenz belegt ist.  GitHub-Site-Code: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LibrePCB</a> . <br><br>  Das Projekt schien uns interessant zu sein, und wir beschlossen, es auszuprobieren.  Aber die Testergebnisse waren nicht mehr so ‚Äã‚Äãinteressant.  Ja, es gab echte Fehler.  Aber es gab nichts Besonderes, wor√ºber wir den Lesern unserer Artikel sicherlich erz√§hlen m√ºssen.  Vielleicht w√ºrden wir keinen Artikel schreiben und uns darauf beschr√§nken, die Fehler an die Entwickler des Projekts zu senden.  Der interessante Punkt war jedoch, dass das Projekt im Docker-Image getestet wurde und wir daher entschieden haben, dass es sich immer noch lohnt, einen Artikel zu schreiben. <br><br><h2>  Docker </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker</a> - Software zur Automatisierung der Bereitstellung und Verwaltung von Anwendungen in einer Virtualisierungsumgebung auf Betriebssystemebene.  Sie k√∂nnen die Anwendung mit all ihren Umgebungen und Abh√§ngigkeiten in einen Container "packen".  Obwohl diese Technologie ungef√§hr f√ºnf Jahre alt ist und viele Unternehmen Docker schon lange in die Infrastruktur ihrer Projekte implementiert haben, war dies in der Open-Source-Welt bis vor kurzem nicht sehr auff√§llig. <br><br>  Unser Unternehmen arbeitet sehr eng mit Open Source-Projekten zusammen und √ºberpr√ºft den Quellcode mit unserem eigenen statischen PVS-Studio-Analyseger√§t.  Derzeit wurden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mehr als 300 Projekte</a> verifiziert.  Das Schwierigste in dieser Aktivit√§t war immer die Zusammenstellung von Projekten anderer Leute, aber die Einf√ºhrung von Docker-Containern hat diesen Prozess erheblich vereinfacht. <br><br>  Die erste Erfahrung beim Testen eines Open Source-Projekts in Docker machte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Azure Service Fabric</a> .  Dort haben die Entwickler die Installation des Quelldateiverzeichnisses im Container vorgenommen, und die Integration des Analysators beschr√§nkte sich auf die Bearbeitung eines der im Container ausgef√ºhrten Skripte: <br><br><pre><code class="cpp hljs">diff --git a/src/build.sh b/src/build.sh index <span class="hljs-number"><span class="hljs-number">290</span></span>c57d.<span class="hljs-number"><span class="hljs-number">.2</span></span>a286dc <span class="hljs-number"><span class="hljs-number">100755</span></span> --- a/src/build.sh +++ b/src/build.sh @@ <span class="hljs-number"><span class="hljs-number">-193</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span> +<span class="hljs-number"><span class="hljs-number">193</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span> @@ BuildDir() cd ${ProjBinRoot}/build.${DirName} + pvs-studio-analyzer analyze --cfg /src/PVS-Studio.cfg \ + -o ./service-fabric-pvs.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> -j4 + <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"false"</span></span> = ${SkipBuild} ]; <span class="hljs-function"><span class="hljs-function">then </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(( $NumProc &lt;= </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ))</span></span></span></span>; then NumProc=$(($(getconf _NPROCESSORS_ONLN)+<span class="hljs-number"><span class="hljs-number">0</span></span>))</code> </pre> <br>  Der Unterschied zwischen dem LibrePCB-Projekt besteht darin, dass sofort die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-Datei</a> zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen</a> des Images und des darin enthaltenen Projekts bereitgestellt wurde.  Es stellte sich f√ºr uns als noch bequemer heraus.  Hier ist der Teil der Docker-Datei, an dem wir interessiert sind: <br><br><pre> <code class="cpp hljs">FROM ubuntu:<span class="hljs-number"><span class="hljs-number">14.04</span></span> <span class="hljs-meta"><span class="hljs-meta"># install packages RUN DEBIAN_FRONTEND=noninteractive \ apt-get -q update \ &amp;&amp; apt-get -qy upgrade \ &amp;&amp; apt-get -qy install git g++ qt5-default qttools5-dev-tools qt5-doc \ qtcreator libglu1-mesa-dev dia \ &amp;&amp; apt-get clean # checkout librepcb RUN git clone --recursive https:</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//..../LibrePCB.git /opt/LibrePCB \ &amp;&amp; cd /opt/LibrePCB .... # build and install librepcb RUN /opt/LibrePCB/dev/docker/make_librepcb.sh ....</span></span></span></span></code> </pre> <br>  Wir werden das Projekt beim Zusammenstellen des Bildes nicht kompilieren und installieren.  So haben wir ein Bild gesammelt, in dem der Autor des Projekts die erfolgreiche Montage des Projekts garantiert. <br><br>  Nach dem Starten des Containers wurde der Analysator installiert und die folgenden Befehle wurden ausgef√ºhrt, um das Projekt zu erstellen und zu analysieren: <br><br><pre> <code class="cpp hljs">cd /opt/LibrePCB mkdir build &amp;&amp; cd build qmake -r ../librepcb.pro pvs-studio-analyzer trace -- make -j2 pvs-studio-analyzer analyze -l /mnt/Share/PVS-Studio.lic -r /opt/LibrePCB \ -o /opt/LibrePCB/LibrePCB.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> -v -j4 cp -R -L -a /opt/LibrePCB /mnt/Share</code> </pre> <br>  √úbrigens wurden alle Aktionen in Windows 10 ausgef√ºhrt. Es ist sehr erfreulich, dass sich auch die Entwickler aller g√§ngigen Betriebssysteme in diese Richtung entwickeln.  Leider sind Container mit Windows nicht so bequem.  Vor allem wegen der Unm√∂glichkeit, auch Software einfach zu installieren. <br><br><h2>  Bugs gefunden </h2><br>  Nun ein klassischer Abschnitt mit einer Beschreibung der Fehler, die wir mit dem statischen Code-Analysator PVS-Studio gefunden haben.  Bei dieser Gelegenheit m√∂chte ich Sie √ºbrigens daran erinnern, dass wir k√ºrzlich einen Analysator entwickeln, der die Codeanalyse f√ºr eingebettete Systeme unterst√ºtzt.  Hier sind einige Artikel, die einige unserer Leser m√∂glicherweise √ºbersprungen haben: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PVS-Studio bietet Unterst√ºtzung f√ºr die GNU Arm Embedded Toolchain</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PVS-Studio: Unterst√ºtzung f√ºr Codierungsstandards MISRA C und MISRA C ++</a> . </li></ol><br><h3>  Tippfehler </h3><br><pre> <code class="cpp hljs">SymbolPreviewGraphicsItem::SymbolPreviewGraphicsItem( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> IF_GraphicsLayerProvider&amp; layerProvider, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QStringList&amp; localeOrder, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Symbol&amp; symbol, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Component* cmp, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tl::optional&lt;Uuid&gt;&amp; symbVarUuid, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tl::optional&lt;Uuid&gt;&amp; symbVarItemUuid) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mComponent &amp;&amp; symbVarUuid &amp;&amp; symbVarItemUuid) .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mComponent &amp;&amp; symbVarItemUuid &amp;&amp; symbVarItemUuid) <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> CWE-571 Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdr√ºcke 'symbVarItemUuid'.  symbolpreviewgraphicsitem.cpp 74 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klassischer</a> Tippfehler: Die Variable <i>symbVarItemUuid wird</i> zweimal hintereinander √ºberpr√ºft.  Es gibt oben eine √§hnliche Pr√ºfung, und wenn man sie betrachtet, wird klar, dass die zweite zu <i>pr√ºfende</i> Variable <i>symbVarUuid</i> sein <i>sollte</i> . <br><br>  Das folgende Tippfehler-Code-Snippet: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Clipper::DoMaxima(TEdge *e) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e-&gt;OutIdx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { AddOutPt(e, e-&gt;Top); e-&gt;OutIdx = Unassigned; } DeleteFromAEL(e); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eMaxPair-&gt;OutIdx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { AddOutPt(eMaxPair, e-&gt;Top); <span class="hljs-comment"><span class="hljs-comment">// &lt;= eMaxPair-&gt;OutIdx = Unassigned; } DeleteFromAEL(eMaxPair); .... }</span></span></code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V778</a> CWE-682 Es wurden zwei √§hnliche Codefragmente gefunden.  M√∂glicherweise ist dies ein Tippfehler und die Variable 'eMaxPair' sollte anstelle von 'e' verwendet werden.  clipper.cpp 2999 <br><br>  H√∂chstwahrscheinlich wurde der Code mit Copy-Paste geschrieben.  Aufgrund des Versehens im zweiten Textblock haben sie vergessen, <i>e-&gt; Top</i> durch <i>eMaxPair-&gt; Top</i> zu ersetzen. <br><br><h3>  Zus√§tzliche Schecks </h3><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rndr_emphasis</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(hoedown_buffer *ob, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hoedown_buffer *content, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hoedown_renderer_data *data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!content || !content-&gt;size) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; HOEDOWN_BUFPUTSL(ob, <span class="hljs-string"><span class="hljs-string">"&lt;em&gt;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content) hoedown_buffer_put(ob, content-&gt;data, content-&gt;size); HOEDOWN_BUFPUTSL(ob, <span class="hljs-string"><span class="hljs-string">"&lt;/em&gt;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V547</a> CWE-571 Der Ausdruck 'Inhalt' ist immer wahr.  html.c 162 <br><br>  Dies ist wahrscheinlich immer noch kein Fehler, sondern einfach redundanter Code.  Der Inhaltszeiger muss nicht erneut √ºberpr√ºft <i>werden</i> .  Wenn es Null ist, beendet die Funktion sofort ihre Arbeit. <br><br>  Eine √§hnliche Situation: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Clipper::DoMaxima(TEdge *e) { .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( e-&gt;OutIdx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; eMaxPair-&gt;OutIdx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e-&gt;OutIdx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) AddLocalMaxPoly(e, eMaxPair, e-&gt;Top); DeleteFromAEL(e); DeleteFromAEL(eMaxPair); } .... }</code> </pre> <br>  PVS-Studio- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Warnung</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V547</a> CWE-571 Ausdruck 'e-&gt; OutIdx&gt; = 0' ist immer wahr.  clipper.cpp 2983 <br><br>  <i>Eine erneute √úberpr√ºfung (e-&gt; OutIdx&gt; = 0)</i> ist nicht sinnvoll.  Vielleicht ist dies jedoch ein Fehler.  Zum Beispiel k√∂nnen wir davon ausgehen, dass die Variable <i>e-&gt; Top aktiviert</i> sein sollte.  Dies ist jedoch nur eine Vermutung.  Wir sind mit dem Projektcode nicht vertraut und k√∂nnen Fehler nicht von redundantem Code unterscheiden :). <br><br>  Und noch ein Fall: <br><br><pre> <code class="cpp hljs">QString SExpression::toString(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> indent) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (child.isLineBreak() &amp;&amp; nextChildIsLineBreak) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (child.isLineBreak() &amp;&amp; (i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; mChildren.at(i - <span class="hljs-number"><span class="hljs-number">1</span></span>).isLineBreak()) { <span class="hljs-comment"><span class="hljs-comment">// too many line breaks ;) } else { str += '\n'; } } .... }</span></span></code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V571</a> CWE-571 Wiederkehrende Pr√ºfung.  Die Bedingung 'child.isLineBreak ()' wurde bereits in Zeile 208 √ºberpr√ºft. Sexpression.cpp 209 <br><br><h3>  Fehler in der Logik </h3><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> FootprintPreviewGraphicsItem::paint(....) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Circle&amp; circle : mFootprint.getCircles()) { layer = mLayerProvider.getLayer(*circle.getLayerName()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!layer) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= if (layer) { // &lt;= pen = QPen(....); painter-&gt;setPen(pen); } else painter-&gt;setPen(Qt::NoPen); .... } .... }</span></span></code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V547</a> CWE-571 Ausdruck 'Ebene' ist immer wahr.  footprintpreviewgraphicsitem.cpp 177 <br><br>  Da die Bedingung in der zweiten <i>if-Anweisung</i> immer wahr ist, ist der <i>else-</i> Zweig niemals erf√ºllt. <br><br><h3>  Zeigerpr√ºfung vergessen </h3><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> ZEXPORT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unzGetGlobalComment</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( unzFile file, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * szComment, uLong uSizeBuf)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (uReadThis&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { *szComment=<span class="hljs-string"><span class="hljs-string">'\0'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ZREAD64(s-&gt;z_filefunc,s-&gt;filestream,szComment,uReadThis)!=uReadThis) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UNZ_ERRNO; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((szComment != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) &amp;&amp; (uSizeBuf &gt; s-&gt;gi.size_comment)) *(szComment+s-&gt;gi.size_comment)=<span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V595</a> CWE-476 Der Zeiger 'szComment' wurde verwendet, bevor er gegen nullptr verifiziert wurde.  √úberpr√ºfen Sie die Zeilen: 2068, 2073. unzip.c 2068 <br><br>  Wenn <i>uReadThis&gt; 0 ist</i> , wird der <i>szComment-</i> Zeiger <i>dereferenziert</i> .  Dies ist gef√§hrlich, da dieser Zeiger m√∂glicherweise null ist.  Der Analysator zieht eine solche Schlussfolgerung auf der Grundlage der Tatsache, dass dieser Zeiger weiter auf Gleichheit <i>NULL</i> gepr√ºft wird. <br><br><h3>  Nicht initialisiertes Klassenmitglied </h3><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Edge</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> VertexType = Vector2&lt;T&gt;; Edge(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VertexType &amp;p1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VertexType &amp;p2, T w=<span class="hljs-number"><span class="hljs-number">-1</span></span>) : p1(p1), p2(p2), weight(w) {}; <span class="hljs-comment"><span class="hljs-comment">// &lt;= Edge(const Edge &amp;e) : p1(e.p1), p2(e.p2), weight(e.weight), isBad(false) {}; Edge() : p1(0,0), p2(0,0), weight(0), isBad(false) {} VertexType p1; VertexType p2; T weight=0; bool isBad; };</span></span></code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V730</a> CWE-457 Nicht alle Mitglieder einer Klasse werden im Konstruktor initialisiert.  Betrachten Sie Folgendes: isBad.  edge.h 14 <br><br>  Alle Konstruktoren au√üer dem ersten initialisieren das Feld der <i>isBad-</i> Klasse.  H√∂chstwahrscheinlich hat der erste Konstruktor diese Initialisierung einfach versehentlich vergessen.  Infolgedessen erstellt der erste Konstruktor ein unvollst√§ndig initialisiertes Objekt, was zu undefiniertem Programmverhalten f√ºhren kann. <br><br>  Es gibt 11 weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V730-</a> Diagnoseausl√∂ser.  Da wir mit dem Code jedoch nicht vertraut sind, ist es schwierig zu sagen, ob diese Warnungen auf echte Probleme hinweisen.  Ich denke, diese Warnungen werden am besten von den Autoren des Projekts untersucht. <br><br><h3>  Speicherverlust </h3><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> ElementType&gt; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ProjectLibrary::loadElements(....) { .... ElementType* element = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ElementType(elementDir, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-comment"><span class="hljs-comment">// can throw if (elementList.contains(element-&gt;getUuid())) { throw RuntimeError( __FILE__, __LINE__, QString(tr("There are multiple library elements with the same " "UUID in the directory \"%1\"")) .arg(subdirPath.toNative())); } .... }</span></span></code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V773</a> CWE-401 Die Ausnahme wurde ausgel√∂st, ohne den Zeiger 'Element' freizugeben.  Ein Speicherverlust ist m√∂glich.  projectlibrary.cpp 245 <br><br>  Wenn ein Element bereits in der Liste enthalten ist, wird eine Ausnahme ausgel√∂st.  Dies zerst√∂rt jedoch nicht das zuvor erstellte Objekt, dessen Zeiger in der Elementvariablen gespeichert ist. <br><br><h3>  Ung√ºltiger Ausnahmetyp </h3><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CmdRemoveSelectedSchematicItems::performExecute() { .... <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LogicError(__FILE__, __LINE__); .... }</code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V1022</a> CWE-755 Eine Ausnahme wurde vom Zeiger ausgel√∂st.  Ziehen Sie es stattdessen nach Wert.  cmdremoveselectedschematicitems.cpp 143 <br><br>  Der Analysator hat eine vom Zeiger ausgel√∂ste Ausnahme festgestellt.  Meistens ist es √ºblich, Ausnahmen nach Wert auszul√∂sen und nach Referenz abzufangen.  Das Werfen eines Zeigers kann dazu f√ºhren, dass die Ausnahme nicht abgefangen wird, da sie als Referenz abgefangen wird.  Die Verwendung eines Zeigers zwingt den Interceptor au√üerdem, den <i>L√∂schoperator</i> aufzurufen, um das erstellte Objekt zu zerst√∂ren, damit keine Speicherverluste auftreten. <br><br>  Im Allgemeinen wird der <i>neue</i> Operator hier versehentlich geschrieben und sollte gel√∂scht werden.  Dass dies ein Fehler ist, wird durch die Tatsache best√§tigt, dass an allen anderen Stellen steht: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> LogicError(__FILE__, __LINE__);</code> </pre> <br><h3>  Gef√§hrliche Verwendung von dynamic_cast </h3><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> GraphicsView::handleMouseWheelEvent( QGraphicsSceneWheelEvent* event) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event-&gt;modifiers().testFlag(Qt::ShiftModifier)) .... } <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> GraphicsView::eventFilter(QObject* obj, QEvent* event) { .... handleMouseWheelEvent(<span class="hljs-keyword"><span class="hljs-keyword">dynamic_cast</span></span>&lt;QGraphicsSceneWheelEvent*&gt;(event)); .... }</code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V522</a> CWE-628 Es kann zu einer Dereferenzierung des Nullzeiger-Ereignisses kommen.  Der potenzielle Nullzeiger wird an die Funktion 'handleMouseWheelEvent' √ºbergeben.  √úberpr√ºfen Sie das erste Argument.  √úberpr√ºfen Sie die Zeilen: 143, 252. graphicsview.cpp 143 <br><br>  Der aus dem Operator <i>dynamic_cast</i> resultierende Zeiger wird an die Funktion <i>handleMouseWheelEvent √ºbergeben</i> .  Darin wird dieser Zeiger ohne vorherige √úberpr√ºfung dereferenziert. <br><br>  Dies ist gef√§hrlich, da der Operator <i>dynamic_cast</i> m√∂glicherweise <i>nullptr zur√ºckgibt</i> .  Es stellt sich heraus, dass dieser Code nicht besser ist als nur die Verwendung des schnelleren <i>static_cast</i> . <br><br>  Vor der Verwendung sollte diesem Code eine explizite Zeigerpr√ºfung hinzugef√ºgt werden. <br><br>  Auch Code dieser Art ist sehr verbreitet: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> GraphicsView::eventFilter(QObject* obj, QEvent* event) { .... QGraphicsSceneMouseEvent* e = <span class="hljs-keyword"><span class="hljs-keyword">dynamic_cast</span></span>&lt;QGraphicsSceneMouseEvent*&gt;(event); Q_ASSERT(e); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e-&gt;button() == Qt::MiddleButton) .... }</code> </pre> <br>  PVS-Studio Warnung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V522</a> CWE-690 M√∂glicherweise wird ein potenzieller Nullzeiger 'e' dereferenziert.  graphicsview.cpp 206 <br><br>  Der Zeiger wird mit dem Makro <i>Q_ASSERT</i> √ºberpr√ºft.  Hier ist seine Beschreibung: <br><table><tbody><tr><td>  Druckt eine Warnmeldung mit dem Namen der Quellcodedatei und der Zeilennummer, wenn der Test falsch ist. <br><br>  Q_ASSERT () ist n√ºtzlich, um Vor- und Nachbedingungen w√§hrend der Entwicklung zu testen.  Es tut nichts, wenn QT_NO_DEBUG w√§hrend der Kompilierung definiert wurde. <br></td></tr></tbody></table><br>  <i>Q_ASSERT ist eine</i> schlechte Methode, um Zeiger vor der Verwendung zu √ºberpr√ºfen.  In der Release-Version ist <i>QT_NO_DEBUG</i> in der <i>Regel</i> nicht definiert.  Ich wei√ü nicht, wie es im LibrePCB-Projekt l√§uft.  Wenn jedoch <i>QT_NO_DEBUG</i> in Release definiert ist, ist dies eine seltsame und nicht standardm√§√üige L√∂sung. <br><br>  Wenn sich das Makro in die Leere ausdehnt, stellt sich heraus, dass keine √úberpr√ºfung erfolgt.  Und dann ist nicht klar, warum Sie <i>dynamic_cast</i> √ºberhaupt verwenden.  Warum dann nicht <i>static_cast verwenden</i> ? <br><br>  Im Allgemeinen ist dieser Code geruchlos und eine √úberpr√ºfung aller √§hnlichen Codefragmente wert.  Und es gibt √ºbrigens viele von ihnen.  <b>Ich habe 82 √§hnliche F√§lle gez√§hlt!</b> <br><br><h2>  Fazit </h2><br>  Im Allgemeinen schien uns das LibrePCB-Projekt von hoher Qualit√§t zu sein.  Wir empfehlen jedoch, dass sich die Autoren des Projekts mit dem PVS-Studio-Tool ausr√ºsten und unabh√§ngig eine Code√ºberpr√ºfung der vom Analysator angegebenen Codeabschnitte durchf√ºhren.  Wir sind bereit, ihnen einen Monat lang eine kostenlose Lizenz f√ºr eine vollst√§ndige Analyse des Projekts zur Verf√ºgung zu stellen.  Dar√ºber hinaus k√∂nnen sie die kostenlose Lizenzierungsoption f√ºr Analyseger√§te verwenden, da der Projektcode ge√∂ffnet und auf der GitHub-Website ver√∂ffentlicht ist.  Wir werden in K√ºrze √ºber diese Lizenzoption schreiben. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Wenn Sie diesen Artikel einem englischsprachigen Publikum zug√§nglich machen m√∂chten, verwenden Sie bitte den Link zur √úbersetzung: Andrey Karpov, Svyatoslav Razmyslov.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberpr√ºfen von LibrePCB mit PVS-Studio in einem Docker-Container</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433562/">https://habr.com/ru/post/de433562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433552/index.html">Sicherheitsl√ºcken in der EOS-Blockchain bei ZeroNights 2018</a></li>
<li><a href="../de433554/index.html">Wir korrigieren Tippfehler in Suchanfragen</a></li>
<li><a href="../de433556/index.html">The Economist: Wie private Investmentunternehmen 0,001% der reichsten Menschen der Welt den Weltfinanzsektor ver√§ndern</a></li>
<li><a href="../de433558/index.html">TeamCity 2018.2: Unterst√ºtzung f√ºr GitHub Pull Requests, sekund√§rer Server, Installation von Plugins aus dem Repository, Screenshots in Tests</a></li>
<li><a href="../de433560/index.html">Erhalt einer Arbeitserlaubnis in der Tschechischen Republik: Wechsel des Arbeitgebers bei doppelter Arbeitskarte</a></li>
<li><a href="../de433564/index.html">Vorhersageverhalten der Web-Benutzeroberfl√§che</a></li>
<li><a href="../de433566/index.html">Lernen Sie kontroverse Taktiken, Techniken und allgemeines Wissen (ATT @ CK). Unternehmenstaktik. Teil 6</a></li>
<li><a href="../de433568/index.html">Wie Amerika Paketdiebe bek√§mpft</a></li>
<li><a href="../de433570/index.html">Das Geheimnis des rituellen ‚ÄûAufw√§rmens‚Äú oder warum die ‚Äûwarmen‚Äú Kopfh√∂rer ‚Äûbesser‚Äú klingen</a></li>
<li><a href="../de433572/index.html">Einf√ºhrung in das Testen in Python. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>