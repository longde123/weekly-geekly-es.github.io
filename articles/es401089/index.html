<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ©Ô∏è üê∫ üßô Tarjeta de expansi√≥n de simulaci√≥n Raspberry Pi üë©üèª‚Äçü§ù‚Äçüë®üèº üñãÔ∏è üïì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durante mucho tiempo, la microcomputadora Raspberry Pi ha entrado en la vida de geeks, administradores de sistemas, programadores e ingenieros electr√≥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tarjeta de expansi√≥n de simulaci√≥n Raspberry Pi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401089/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durante mucho tiempo, la microcomputadora Raspberry Pi ha entrado en la vida de geeks, administradores de sistemas, programadores e ingenieros electr√≥nicos. </font><font style="vertical-align: inherit;">Econ√≥mico y relativamente potente para su clase, con puertos de E / S incorporados, puede hacer frente a diversas tareas y satisfacer las necesidades del usuario. </font><font style="vertical-align: inherit;">Despu√©s de comprar una Raspberry Pi, quer√≠a algo para encender, medir y administrar dispositivos externos. </font><font style="vertical-align: inherit;">Actualmente se est√°n vendiendo una gran cantidad de tarjetas de expansi√≥n, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Puede usar la placa de pruebas con cables para la creaci√≥n r√°pida de prototipos, pero prefiero hacer dispositivos por mi cuenta, para tareas espec√≠ficas. </font><font style="vertical-align: inherit;">Por primera vez, no utilic√© un peine de dos filas para todas las salidas, sino que me limit√© a varios puertos de E / S, SPI, I2C y bus UART. </font><font style="vertical-align: inherit;">Conect√© la Raspberry Pi con los cables de destino para la creaci√≥n de prototipos "mam√°-mam√°". </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/eef/18f/ae2/eef18fae242d47dab3f10bb6a4cfb21b.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este sentido, se desarroll√≥ una serie de tres tableros de prototipos, uno de ellos, el m√°s simple que discutir√© en este art√≠culo.</font></font><a name="habracut"></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, lo que necesitaba:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabaja con GPIO con entradas y salidas; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesti√≥n de carga; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conexi√≥n de sensores de temperatura en el bus de 1 cable; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medida de voltaje; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reloj de tiempo real; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Monitoreo y control de un dispositivo externo a trav√©s del bus RS485; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fuente de alimentaci√≥n separada para tarjeta de expansi√≥n; </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seg√∫n la lista anterior, se ha desarrollado un circuito el√©ctrico: </font></font><br>
<img src="https://habrastorage.org/files/cc4/136/432/cc41364328f3449094dc0b05a940a987.jpg" alt="imagen"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Üí </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un circuito de un almacenamiento de alta resoluci√≥n</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El circuito utiliza una fuente de alimentaci√≥n de transformador con dos devanados de salida. El primer devanado opera en un regulador de voltaje lineal con una salida de 5V, para alimentar el chip controlador RS485 y el reloj en tiempo real. El segundo devanado se utiliza para alimentar rel√©s electromagn√©ticos y ensamblar con transistores Darlington.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El sensor de temperatura DS18B20 funciona con + 3.3V de la placa Raspberry Pi, la placa tiene un conector para conectar sensores externos DS18B20, se toma el mismo voltaje para el ADC y los niveles correspondientes con un reloj en tiempo real. El circuito usa cuatro botones S1-S4 para controlar cualquier acci√≥n que opere a un nivel l√≥gico bajo. Para controlar las cargas, se utiliza el conjunto de transistor DD1 ULN2003 con diodos de protecci√≥n incorporados. Los rel√©s K1 y K2 est√°n conectados a los pines 16, 15 del conjunto del transistor, los LED para indicaci√≥n est√°n conectados a los pines 14-12, los pines 11, 10 est√°n dise√±ados para conectarse a dispositivos externos de acuerdo con el esquema con un colector com√∫n o rel√©s adicionales con un voltaje de bobinado de + 12V.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para medir el voltaje, se utilizan dos canales de un ADC DD3 MCP3008 de 10 bits con una interfaz SPI, con un filtro de paso bajo de entrada. El nodo anal√≥gico est√° hecho primitivamente, con fines acad√©micos o para una depuraci√≥n r√°pida. Si surge la pregunta sobre la medici√≥n cualitativa de una se√±al anal√≥gica, tendr√° que desacoplar la tierra digital y anal√≥gica, use una fuente de referencia de voltaje externo. Alternativamente, la parte anal√≥gica se puede hacer de la siguiente manera: </font></font><br>
<br>
<img src="https://habrastorage.org/files/d8d/148/dee/d8d148deee074957a46ab433620aea05.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
solo ser√° necesario usar el convertidor de nivel TTL ‚Üí LVTTL en el bus SPI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El reloj DD4 en tiempo real est√° hecho en el chip DS1307, y el resonador de cuarzo Q1 a 32.768 kHz se usa para la sincronizaci√≥n. Se utiliza una bater√≠a de litio de 3 voltios soldada en la placa para alimentar el chip RAM del reloj. El microcircuito se conecta a trav√©s de un convertidor de nivel de 5V-3.3V hecho en los transistores MOS VT2, VT3 a la Raspberry Pi a trav√©s del bus I2C (CAD us√≥ la conexi√≥n a l√≠neas sin conexi√≥n expl√≠cita). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como controlador UART ‚Üí RS485, se utiliz√≥ el chip DD2 ST485. Las soluciones de circuito que usan el transistor VT1 permitieron abandonar una salida separada para controlar el transceptor. Cambia al modo de transmisi√≥n solo cuando el UART est√° transmitiendo datos, el resto del tiempo ST485 est√° en modo de recepci√≥n. El comando de control del transceptor se elimina del colector del transistor VT1.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s de convertir las interfaces, este esquema tambi√©n cumple la funci√≥n de hacer coincidir los niveles LVTTL de la interfaz UART Raspberry Pi con los niveles TTL del controlador ST485. </font><font style="vertical-align: inherit;">La se√±al tomada del colector del transistor VT1 eleva el nivel en la entrada DI a 5V, y la resistencia R16 y el diodo Zener VD8 limitan el nivel desde la salida R0 a 3.3V. </font><font style="vertical-align: inherit;">No preste atenci√≥n a la resistencia R11, permaneci√≥ en el circuito durante la depuraci√≥n. </font><font style="vertical-align: inherit;">RS485 se prueba con el protocolo ModBus RTU a 115200 baudios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En consecuencia, se desarroll√≥ a√∫n m√°s una placa de circuito:</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ca/501/7a8/2ca5017a8cba4f22b49cb6c8ea588855.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos en 3D de la placa de circuito impreso</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/0d3/058/62d/0d305862d003420aa0dfaa41f5a57d78.png"><br>
<img src="https://habrastorage.org/files/cbc/3d6/3b3/cbc3d63b39b44d2aa22887874155660c.bmp"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto del dispositivo terminado y trabajo con la placa de expansi√≥n:</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/e60/3b4/9d7/e603b49d769b4fc1888d7350b9dbe63f.jpg"><br>
<br>
<img src="https://habrastorage.org/files/2fb/710/6e3/2fb7106e3cec47ea9de5b947ebc091ed.jpg"><br>
<br>
<img src="https://habrastorage.org/files/132/e3e/4d0/132e3e4d025a47ebb5a982e69ed7c213.jpg"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variante del esquema de conexi√≥n con dispositivos externos: </font></font><br>
<img src="https://habrastorage.org/files/4bb/b2f/c3c/4bbb2fc3c13849398f32165e87ce506f.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para verificar los nodos de la placa de expansi√≥n, utilic√© un par de scripts en python (no s√© este idioma, escrib√≠ por prueba y error, mirando los c√≥digos de especialistas) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para medir el voltaje de un potenci√≥metro conectado a los canales ADC, escrib√≠ un simple gui√≥n:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fuente de Python MCP3008</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment"># Example program to read data from MCP3008 10 bit ADC</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spidev
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Open SPI bus</span></span><font></font>
spi = spidev.SpiDev()<font></font>
spi.open(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Function to read SPI data from MCP3008 chip</span></span>
<span class="hljs-comment"><span class="hljs-comment"># Channel must be an integer 0-7</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadChannel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(channel)</span></span></span><span class="hljs-function">:</span></span>
  adc = spi.xfer2([<span class="hljs-number"><span class="hljs-number">1</span></span>,(<span class="hljs-number"><span class="hljs-number">8</span></span>+channel)&lt;&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>])<font></font>
  data = ((adc[<span class="hljs-number"><span class="hljs-number">1</span></span>]&amp;<span class="hljs-number"><span class="hljs-number">3</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + adc[<span class="hljs-number"><span class="hljs-number">2</span></span>]
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Function to convert data to voltage level,</span></span>
<span class="hljs-comment"><span class="hljs-comment"># rounded to specified number of decimal places.</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertVolts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data,places)</span></span></span><span class="hljs-function">:</span></span>
  volts = (data * <span class="hljs-number"><span class="hljs-number">3.3</span></span>) / float(<span class="hljs-number"><span class="hljs-number">1023</span></span>)<font></font>
  volts = round(volts,places)<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> volts<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Define sensor channels</span></span>
first_channel = <span class="hljs-number"><span class="hljs-number">0</span></span>
second_channel  = <span class="hljs-number"><span class="hljs-number">1</span></span><font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Define delay between readings</span></span>
delay = <span class="hljs-number"><span class="hljs-number">5</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"------------------------------------------------------"</span></span><font></font>
 <font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Read the first channel data</span></span><font></font>
  first_level = ReadChannel(first_channel)<font></font>
  first_channel_volts = ConvertVolts(first_level,<span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Read the second channel data</span></span><font></font>
  second_level = ReadChannel(second_channel)<font></font>
  second_channel_volts = ConvertVolts(second_level,<span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  <font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Print out results</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"------------------------------------------------------"</span></span>
  print(<span class="hljs-string"><span class="hljs-string">"First ADC channel: {} ({}V)"</span></span>.format(first_level,first_channel_volts))<font></font>
  print(<span class="hljs-string"><span class="hljs-string">"Second ADC channel : {} ({}V)"</span></span>.format(second_level,second_channel_volts))<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Wait before repeating loop</span></span><font></font>
  time.sleep(delay)<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente script se us√≥ para trabajar con term√≥metros DS18B20:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fuente de Python DS18B20</font></font></b><div class="spoiler_text">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a><br>
<pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Example program to read data from DS18B20</span></span>
<span class="hljs-comment"><span class="hljs-comment"># This code taken from</span></span>
<span class="hljs-comment"><span class="hljs-comment"># https://kropochev.com/?go=all/raspberry-pi-and-onewire-sensor/</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> glob
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time<font></font>
<font></font>
os.system(<span class="hljs-string"><span class="hljs-string">'modprobe w1-gpio'</span></span>)<font></font>
os.system(<span class="hljs-string"><span class="hljs-string">'modprobe w1-therm'</span></span>)<font></font>
<font></font>
base_dir = <span class="hljs-string"><span class="hljs-string">'/sys/bus/w1/devices/'</span></span>
device_folder = glob.glob(base_dir + <span class="hljs-string"><span class="hljs-string">'10*'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]<font></font>
device_file = device_folder + <span class="hljs-string"><span class="hljs-string">'/w1_slave'</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp_raw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    f = open(device_file, <span class="hljs-string"><span class="hljs-string">'r'</span></span>)<font></font>
    lines = f.readlines()<font></font>
    f.close()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lines<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span><font></font>
    lines = read_temp_raw()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> lines[<span class="hljs-number"><span class="hljs-number">0</span></span>].strip()[<span class="hljs-number"><span class="hljs-number">-3</span></span>:] != <span class="hljs-string"><span class="hljs-string">'YES'</span></span>:<font></font>
        time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)<font></font>
        lines = read_temp_raw()<font></font>
    equals_pos = lines[<span class="hljs-number"><span class="hljs-number">1</span></span>].find(<span class="hljs-string"><span class="hljs-string">'t='</span></span>)
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> equals_pos != <span class="hljs-number"><span class="hljs-number">-1</span></span>:<font></font>
        temp_string = lines[<span class="hljs-number"><span class="hljs-number">1</span></span>][equals_pos+<span class="hljs-number"><span class="hljs-number">2</span></span>:]<font></font>
        temp_c = float(temp_string) / <span class="hljs-number"><span class="hljs-number">1000.0</span></span>
        temp_f = temp_c * <span class="hljs-number"><span class="hljs-number">9.0</span></span> / <span class="hljs-number"><span class="hljs-number">5.0</span></span> + <span class="hljs-number"><span class="hljs-number">32.0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temp_c, temp_f<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:<font></font>
    print(read_temp())<font></font>
    time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n document√© la configuraci√≥n en Raspbian:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurar dispositivos</font></font></b><div class="spoiler_text"><blockquote> ‚Äî 1 Wire settings:<br>
 ‚Äî Raspbian wheezy<br>
<br>
Enter command in console:<br>
pi@raspberrypi~$ sudo modprobe w1-gpio<br>
pi@raspberrypi~$ sudo modprobe w1_therm<br>
<br>
Then check sensor in system:<br>
pi@raspberrypi ~ $ sudo ls /sys/bus/w1/devices/w1_bus_master1/<br>
<br>
You can see the tabel below entered comman and<br>
there you should find HEX like 28-000002da8328; <br>
This is DS18B20 address;<br>
<br>
Next read the data from DS18B20 sensor using command:<br>
pi@raspberrypi ~ $ cat /sys/bus/w1/devices/w1_bus_master1/28-000002da8328/w1_sla <br>
<br>
And you are going see temperature in console like:<br>
6f 01 4b 46 7f ff 01 10 67: crc=67 YES<br>
6f 01 4b 46 7f ff 01 10 67 t=22937<br>
<br>
t=22937 ‚Äî you should divide this number on 1000 and you will have temperature in Celsius;<br>
<br>
 ‚Äî Raspbian Jezzy<br>
<br>
Enter command:<br>
pi@raspberrypi~$ sudo nano /boot/config.txt<br>
<br>
On next step you should write in config file <br>
dtoverlay=w1-gpio,gpiopin=4 <br>
dtoverlay=w1-gpio-pullup<br>
<br>
Then you should reboot your raspberry Pi;<br>
<br>
 ‚Äî I2C Real Time Clock settings:<br>
 ‚Äî Update your system if it needed and install i2c-tools:<br>
pi@raspberrypi~$ sudo apt-get update<br>
pi@raspberrypi~$ sudo apt-get -y upgrade<br>
pi@raspberrypi~$ sudo apt-get i2c-tools:<br>
<br>
Enter command:<br>
pi@raspberrypi~$ sudo nano /etc/modules<br>
Add these lines:<br>
i2c-bcm2708<br>
i2c-dev<br>
rtc_ds1307<br>
 <br>
Comment one line in file:<br>
pi@raspberrypi~$ sudo nano /etc/modprobe.d/raspi-blacklist.conf<br>
Add # Symbol in beginning of line<br>
<br>
blacklist i2c-bcm2708<br>
________________________________________________________<br>
Reboot system;<br>
Enter command:<br>
pi@raspberrypi~$ sudo lsmod<br>
<br>
You will see lines like:<br>
rtc_ds1307 7715 0<br>
i2c_dev 5277 0 <br>
i2c_bcm2708 4719 0<br>
________________________________________________________<br>
<br>
Get DS1307 address:<br>
pi@raspberrypi~$ sudo i2cdetect -y 1<br>
<br>
You will see table in console:<br>
<br>
0 1 2 3 4 5 6 7 8 9 a b c d e f<br>
00: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî 10: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî --<br>
20: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî --<br>
30: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî UU ‚Äî -- ‚Äî --<br>
40: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî --<br>
50: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî --<br>
60: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî -- 68 ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî 70: ‚Äî -- ‚Äî -- ‚Äî -- ‚Äî --<br>
 <br>
In address 0x3b some device without driver and 0x68 perhaps DS1307 clock address. <br>
<br>
Enter command:<br>
echo ds1307 0x68 &gt; /sys/class/i2c-adapter/i2c-1/new_device<br>
<br>
Read clock:<br>
pi@raspberrypi~$ sudo hwclock -r<br>
<br>
Set time:<br>
pi@raspberrypi~$ sudo hwclock -w<br>
Set system time from RTC:<br>
pi@raspberrypi~$ sudo hwclock -s<br>
<br>
Automatic RTC start;<br>
Add lines in /etc/rc.local file<br>
<br>
echo ds1307 0x68 &gt; /sys/class/i2c-adapter/i2c-1/new_device<br>
sudo hwclock -s<br>
Before last line in file looks like:<br>
<br>
exit 0<br>
 ‚Äî Uart settings:<br>
 ‚Äî Back up files:<br>
cp /boot/cmdline.txt /boot/cmdline.bak<br>
cp /etc/inittab /etc/inittab.bak<br>
<br>
Delete ¬´console=ttyAMA0,115200¬ª  ¬´kgdboc=ttyAMA0,115200¬ª lines from configuration file:<br>
pi@raspberrypi~$ nano /boot/cmdline.txt<br>
<br>
Comment last line looks like ¬´T0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100: in /etc/inittab file: using # symbol:<br>
pi@raspberrypi~$ nano /etc/inittab<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La placa de circuito se necesitaba con urgencia, as√≠ que la hice yo mismo usando la tecnolog√≠a LUT y un par de horas de tiempo libre. </font><font style="vertical-align: inherit;">Para facilitar el trabajo y ahorrar tiempo, la placa de circuito se hizo unilateral con puentes de MGShV 0.5. </font><font style="vertical-align: inherit;">Dise√±o de circuito DipTrace y PCB, c√≥digos fuente de prueba, lista de componentes y tutorial con comandos para la configuraci√≥n en el </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositorio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el video a continuaci√≥n, se utiliza la primera placa de simulaci√≥n, se ensambl√≥ en una placa de pruebas con botones y LED en 20 minutos, las siguientes versiones aparecieron sobre su base:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5uCV_gNWw2Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es401089/">https://habr.com/ru/post/es401089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es401077/index.html">China invertir√° $ 168 millones en nubes para que llueva m√°s en el noroeste del pa√≠s</a></li>
<li><a href="../es401079/index.html">Obvio: control autom√°tico de la iluminaci√≥n del ba√±o.</a></li>
<li><a href="../es401083/index.html">Retroclocking: ¬øqu√© suceder√° si el hierro viejo est√° "agrietado" con nitr√≥geno l√≠quido y helio?</a></li>
<li><a href="../es401085/index.html">Lakhta Terra Incognita: la batalla por la sostenibilidad de un rascacielos</a></li>
<li><a href="../es401087/index.html">AI: farolear, sacar dinero de la poblaci√≥n y vencer la incertidumbre</a></li>
<li><a href="../es401091/index.html">7 productos digitales de escritorio estallaron en 2017</a></li>
<li><a href="../es401093/index.html">Sony Xperia Ear Xea10: –≥–æ–ª–æ—Å–æ–≤—ã–µ –ø–æ–º–æ—â–Ω–∏–∫–∏ –∑–∞–±—Ä–∞–ª–∏—Å—å –≤ —É—à–∏</a></li>
<li><a href="../es401095/index.html">¬øQu√© deber√≠a darte, mi querido hombre?</a></li>
<li><a href="../es401097/index.html">Conoce el nuevo Spectrum</a></li>
<li><a href="../es401101/index.html">Los archivos eliminados comenzaron a volver a las carpetas de Dropbox. Error corregido</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>