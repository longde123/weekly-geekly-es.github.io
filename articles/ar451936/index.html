<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ ğŸš˜ ğŸ´â€â˜ ï¸ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù ÙÙŠ Ù…ØªØµÙØ­ UC â˜ï¸ ğŸ’³ ğŸ–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ù…Ù‚Ø¯Ù…Ø© 
 ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø´Ù‡Ø± Ù…Ø§Ø±Ø³ ØŒ Ø£Ø¨Ù„ØºÙ†Ø§ Ø£Ù†Ù†Ø§ Ø§ÙƒØªØ´ÙÙ†Ø§ Ù‚Ø¯Ø±Ø© Ø®ÙÙŠØ© Ø¹Ù„Ù‰ ØªÙ†Ø²ÙŠÙ„ ÙˆØªØ´ØºÙŠÙ„ Ø´ÙØ±Ø© Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§ ÙÙŠ Ù…ØªØµÙØ­ UC. Ø§Ù„ÙŠÙˆÙ… Ø³Ù†Ø­Ù„Ù„ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙƒÙŠÙÙŠØ© Ø­Ø¯ÙˆØ« Ù‡Ø°Ø§ Ø§Ù„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù ÙÙŠ Ù…ØªØµÙØ­ UC</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/drweb/blog/451936/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-f/na/kn/-fnaknrx70xmfiflvfa6ijw1pys.jpeg"></div><br><h3 style=";text-align:right;direction:rtl">  Ù…Ù‚Ø¯Ù…Ø© </h3><br>  ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø´Ù‡Ø± Ù…Ø§Ø±Ø³ ØŒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø£Ø¨Ù„ØºÙ†Ø§</a> Ø£Ù†Ù†Ø§ Ø§ÙƒØªØ´ÙÙ†Ø§ Ù‚Ø¯Ø±Ø© Ø®ÙÙŠØ© Ø¹Ù„Ù‰ ØªÙ†Ø²ÙŠÙ„ ÙˆØªØ´ØºÙŠÙ„ Ø´ÙØ±Ø© Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§ ÙÙŠ Ù…ØªØµÙØ­ UC.  Ø§Ù„ÙŠÙˆÙ… Ø³Ù†Ø­Ù„Ù„ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙƒÙŠÙÙŠØ© Ø­Ø¯ÙˆØ« Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø²ÙŠÙ„ ÙˆÙƒÙŠÙ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…ØªØ³Ù„Ù„ÙŠÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø£ØºØ±Ø§Ø¶Ù‡Ù… Ø§Ù„Ø®Ø§ØµØ©. <br><br>  Ù…Ù†Ø° Ø¨Ø¹Ø¶ Ø§Ù„ÙˆÙ‚Øª ØŒ ØªÙ… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù† UC Browser ÙˆØªÙˆØ²ÙŠØ¹Ù‡ Ø¨Ù‚ÙˆØ©: ØªÙ… ØªØ«Ø¨ÙŠØªÙ‡ Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù… Ø¨Ø±Ø§Ù…Ø¬ Ø¶Ø§Ø±Ø© ØŒ ØªÙ… ØªÙˆØ²ÙŠØ¹Ù‡Ø§ Ù…Ù† Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø®ØªÙ„ÙØ© ØªØ­Øª Ø³ØªØ§Ø± Ù…Ù„ÙØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ Ø§Ø¹ØªÙ‚Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø£Ù†Ù‡Ù… Ù‚Ø§Ù…ÙˆØ§ Ø¨ØªÙ†Ø²ÙŠÙ„Ù‡Ø§ ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ Ù…Ù‚Ø·Ø¹ Ø¥Ø¨Ø§Ø­ÙŠ ØŒ ÙˆÙ„ÙƒÙ† Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ Ø­ØµÙ„ÙˆØ§ Ø¹Ù„Ù‰ Ù…Ù„Ù APK Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­) ØŒ ØªØ³ØªØ®Ø¯Ù… Ù„Ø§ÙØªØ§Øª Ù…Ø®ÙŠÙØ© Ù…Ø¹ Ø±Ø³Ø§Ø¦Ù„ ØªÙ‚ÙˆÙ„ Ø£Ù† Ø§Ù„Ù…ØªØµÙØ­ Ø¹ÙØ§ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ø²Ù…Ù† ØŒ ÙˆØ¹Ø±Ø¶Ø© Ù„Ù„Ø®Ø·Ø± ÙˆØ£Ø´ÙŠØ§Ø¡ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø¨ÙŠÙ„.  ØªØªØ¶Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© UC Browser Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙÙŠ VK <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù…ÙˆØ¶ÙˆØ¹Ù‹Ø§</a> ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† Ø®Ù„Ø§Ù„Ù‡ Ø§Ù„Ø´ÙƒÙˆÙ‰ Ù…Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ø§Ù„Ø¹Ø§Ø¯Ù„Ø© ØŒ ÙˆÙ‡Ù†Ø§Ùƒ Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ù…Ø«Ù„Ø©.  ÙÙŠ Ø¹Ø§Ù… 2016 ØŒ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø­ØªÙ‰ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠØ¯ÙŠÙˆ</a> Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø±ÙˆØ³ÙŠØ© (Ù†Ø¹Ù… ØŒ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù† Ù…ØªØµÙØ­ ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª). <br><br>  ÙÙŠ ÙˆÙ‚Øª ÙƒØªØ§Ø¨Ø© Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØŒ ÙŠÙˆØ¬Ø¯ Ù„Ø¯Ù‰ UC Browser Ø£ÙƒØ«Ø± Ù…Ù† 500ØŒ000ØŒ000 Ø¹Ù…Ù„ÙŠØ© ØªØ«Ø¨ÙŠØª Ø¹Ù„Ù‰ Google Play.  Ù‡Ø°Ø§ Ù…Ø«ÙŠØ± Ù„Ù„Ø¥Ø¹Ø¬Ø§Ø¨ - ÙÙ‚Ø· Google Chrome Ù„Ø¯ÙŠÙ‡ Ø§Ù„Ù…Ø²ÙŠØ¯.  Ù…Ù† Ø¨ÙŠÙ† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ© Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø­ÙˆÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø¨Ø¹Ø¶ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¹Ù„Ù‰ Google Play.  ÙƒØ§Ù† Ù‡Ø°Ø§ Ù‡Ùˆ Ø³Ø¨Ø¨ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©: Ù‚Ø±Ø±Ù†Ø§ Ù…Ø¹Ø±ÙØ© Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØµÙØ­ UC ÙŠÙ‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ Ø³ÙŠØ¡.  ÙˆØ§ØªØ¶Ø­ Ø£Ù†Ù‡ ÙƒØ§Ù† ÙŠÙØ¹Ù„ Ø°Ù„Ùƒ! <br><a name="habracut"></a><br>  ÙƒØ´Ù Ø±Ù…Ø² Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù† Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªÙ†Ø²ÙŠÙ„ ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ° ØŒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù…Ù…Ø§ ÙŠØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ Ù‚ÙˆØ§Ø¹Ø¯ Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</a> Ø¹Ù„Ù‰ Google Play.  Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø­Ù‚ÙŠÙ‚Ø© Ø£Ù† UC Browser ÙŠÙ‚ÙˆÙ… Ø¨ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ° ØŒ ÙØ¥Ù†Ù‡ ÙŠØ¬Ø¹Ù„Ù‡Ø§ ØºÙŠØ± Ø¢Ù…Ù†Ø© ØŒ ÙˆØ§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù„ØªÙ†ÙÙŠØ° Ù‡Ø¬ÙˆÙ… MitM.  Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±Ù‰ Ù…Ø§ Ø§Ø°Ø§ ÙƒÙ†Ø§ Ù†Ø¬Ø­ ÙÙŠ ØªÙ†ÙÙŠØ° Ù…Ø«Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¬ÙˆÙ…. <br><br>  ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ù…ÙƒØªÙˆØ¨ Ø£Ø¯Ù†Ø§Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ù„Ø¥ØµØ¯Ø§Ø± UC Browser Ø§Ù„Ø°ÙŠ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ø¹Ù„Ù‰ Google Play ÙˆÙ‚Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø©: <br><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">package: com.UCMobile.intl versionName: 12.10.8.1172 versionCode: 10598 sha1 APK-: f5edb2243413c777172f6362876041eb0c3a928c</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  Ù†Ø§Ù‚Ù„ Ø§Ù„Ù‡Ø¬ÙˆÙ… </h3><br>  ÙÙŠ Ù…Ù„Ù UC Browser ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø© ØªØ³Ù…Ù‰ <i>com.uc.deployment.UpgradeDeployService</i> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> &lt;service android:exported="false" android:name="com.uc.deployment.UpgradeDeployService" android:process=":deploy" /&gt;</code> </pre><br>  Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø© ØŒ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…Ø³ØªØ¹Ø±Ø¶ Ø¨ØªÙ†ÙÙŠØ° Ø·Ù„Ø¨ POST Ø¹Ù„Ù‰ <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i> ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠÙ…ÙƒÙ† Ù…Ù„Ø§Ø­Ø¸ØªÙ‡ ÙÙŠ Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø±ÙˆØ± ÙÙŠ ÙˆÙ‚Øª Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©.  Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø°Ù„Ùƒ ØŒ Ù‚Ø¯ ÙŠØªÙ„Ù‚Ù‰ Ø£Ù…Ø±Ù‹Ø§ Ù„ØªÙ†Ø²ÙŠÙ„ ØªØ­Ø¯ÙŠØ« Ø£Ùˆ ÙˆØ­Ø¯Ø© Ù†Ù…Ø·ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©.  ÙÙŠ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ ØŒ Ù„Ù… ÙŠÙ‚Ø¯Ù… Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ø«Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ø£ÙˆØ§Ù…Ø± ØŒ Ù„ÙƒÙ†Ù†Ø§ Ù„Ø§Ø­Ø¸Ù†Ø§ Ø£Ù†Ù‡ Ø¹Ù†Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ PDF ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ØŒ ÙØ¥Ù†Ù‡ ÙŠÙ‚Ø¯Ù… Ø·Ù„Ø¨Ù‹Ø§ Ø«Ø§Ù†ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£Ø¹Ù„Ø§Ù‡ ØŒ ÙˆØ¨Ø¹Ø¯ Ø°Ù„Ùƒ ÙŠÙ‚ÙˆÙ… Ø¨ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.  Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù‡Ø¬ÙˆÙ… ØŒ Ù‚Ø±Ø±Ù†Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ÙÙŠ UC Browser: Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ÙØªØ­ PDF Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© Ø£ØµÙ„ÙŠØ© ØŒ Ù„ÙŠØ³Øª ÙÙŠ APK ÙˆØ§Ù„ØªÙŠ ÙŠØªÙ… ØªÙ†Ø²ÙŠÙ„Ù‡Ø§ ØŒ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø± ØŒ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.  ØªØ¬Ø¯Ø± Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø£Ù†Ù‡ Ù…Ù† Ø§Ù„Ù†Ø§Ø­ÙŠØ© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© ØŒ ÙŠÙ…ÙƒÙ† Ø¥Ø¬Ø¨Ø§Ø± UC Browser Ø¹Ù„Ù‰ ØªÙ†Ø²ÙŠÙ„ Ø´ÙŠØ¡ Ø¯ÙˆÙ† ØªØ¯Ø®Ù„ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… - Ø¥Ø°Ø§ Ù‚Ø¯Ù…Øª Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ù„Ø·Ù„Ø¨ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ø¨Ø¹Ø¯ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ØªØµÙØ­.  Ù„ÙƒÙ† Ù„Ù‡Ø°Ø§ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¯Ø±Ø§Ø³Ø© Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¨Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØµÙŠÙ„ ØŒ Ù„Ø°Ù„Ùƒ Ù‚Ø±Ø±Ù†Ø§ Ø£Ù†Ù‡ ÙƒØ§Ù† Ù…Ù† Ø§Ù„Ø£Ø³Ù‡Ù„ ØªØ­Ø±ÙŠØ± Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø¹ØªØ±Ø¶Ø© ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ PDF. <br><br>  Ù„Ø°Ù„Ùƒ ØŒ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ±ÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙØªØ­ PDF Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ù…ØªØµÙØ­ ØŒ ÙŠÙ…ÙƒÙ† Ø±Ø¤ÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø±ÙˆØ±: <br><br><img src="https://habrastorage.org/webt/j0/i1/c1/j0i1c1n_nwf_gnauzbudnqor5oi.png"><br><br>  Ø£ÙˆÙ„Ø§Ù‹ ØŒ ÙŠØ£ØªÙŠ Ø·Ù„Ø¨ POST Ø¹Ù„Ù‰ <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i> ØŒ ÙˆØ¨Ø¹Ø¯ Ø°Ù„Ùƒ <br>  Ù‚Ù… Ø¨ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ù…Ø¹ Ù…ÙƒØªØ¨Ø© Ù„Ø¹Ø±Ø¶ ØªÙ†Ø³ÙŠÙ‚Ø§Øª PDF ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨.  Ù…Ù† Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠ Ø£Ù† Ù†ÙØªØ±Ø¶ Ø£Ù†Ù‡ ÙÙŠ Ø£ÙˆÙ„ Ø·Ù„Ø¨ ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… (Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø§Ù„Ø¨Ù†ÙŠØ© Ù„Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù„Ø§Ø²Ù…Ø©) ØŒ ÙˆØ§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø°Ù„Ùƒ ØŒ ÙŠØªÙ„Ù‚Ù‰ Ø§Ù„Ù…Ø³ØªØ¹Ø±Ø¶ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ ØªÙ†Ø²ÙŠÙ„Ù‡Ø§: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ØŒ ÙˆØ±Ø¨Ù…Ø§ Ø´ÙŠØ¡ Ø¢Ø®Ø±.  Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù‡ÙŠ Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø´ÙØ±. <br><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  Ø·Ù„Ø¨ Ù…Ù‚ØªØ·Ù <br><br></td><td>  Ù…Ù‚ØªØ·Ù Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© <br><br></td></tr><tr><td><img src="https://habrastorage.org/webt/go/tj/tz/gotjtzkpg2owfmk8jrnznox_vdg.jpeg"><br><br></td><td><img src="https://habrastorage.org/webt/g5/7k/iv/g57kivkwrysmcqvptmhclqzzipq.png"><br><br></td></tr></tbody></table></div><br><br>  ÙŠØªÙ… Ø­Ø²Ù… Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù†ÙØ³Ù‡Ø§ ÙÙŠ ZIP ÙˆÙ„ÙŠØ³ Ù…Ø´ÙØ±Ø©. <br><br><img src="https://habrastorage.org/webt/6r/lt/ns/6rltnsrtyd-_5ekwis68qn-vydc.png"><br><br><h3 style=";text-align:right;direction:rtl">  Ø§Ù„Ø¨Ø­Ø« Ø±Ù…Ø² ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ù…Ø±ÙˆØ± </h3><br><br>  Ø¯Ø¹Ù†Ø§ Ù†Ø­Ø§ÙˆÙ„ ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø¯Ù….  Ù†Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø´ÙØ±Ø© <i>com.uc.deployment.UpgradeDeployService Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ÙØ¦Ø©</i> : Ù…Ù† Ø£Ø³Ù„ÙˆØ¨ <i>onStartCommand ØŒ</i> Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ <i>com.uc.deployment.bx</i> ØŒ ÙˆÙ…Ù†Ù‡ Ø¥Ù„Ù‰ <i>com.uc.browser.core.dcfe</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l arg9)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4_5; String v3_1; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v3; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg9 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v3 = v1; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v3_1 = arg9.iGX.ipR; StringBuilder v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]product:"</span></span>); v4.append(arg9.iGX.ipR); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]version:"</span></span>); v4.append(arg9.iGX.iEn); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]upgrade_type:"</span></span>); v4.append(arg9.iGX.mMode); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]force_flag:"</span></span>); v4.append(arg9.iGX.iEo); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_mode:"</span></span>); v4.append(arg9.iGX.iDQ); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_type:"</span></span>); v4.append(arg9.iGX.iEr); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_state:"</span></span>); v4.append(arg9.iGX.iEp); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_file:"</span></span>); v4.append(arg9.iGX.iEq); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apk_md5:"</span></span>); v4.append(arg9.iGX.iEl); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]download_type:"</span></span>); v4.append(arg9.mDownloadType); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]download_group:"</span></span>); v4.append(arg9.mDownloadGroup); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]download_path:"</span></span>); v4.append(arg9.iGH); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_child_version:"</span></span>); v4.append(arg9.iGX.iEx); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_series:"</span></span>); v4.append(arg9.iGX.iEw); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_cpu_arch:"</span></span>); v4.append(arg9.iGX.iEt); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_cpu_vfp3:"</span></span>); v4.append(arg9.iGX.iEv); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_cpu_vfp:"</span></span>); v4.append(arg9.iGX.iEu); ArrayList v3_2 = arg9.iGX.iEz; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3_2 != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; v3_2.size() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { Iterator v3_3 = v3_2.iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(v3_3.hasNext()) { Object v4_1 = v3_3.next(); StringBuilder v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_name:"</span></span>); v5.append(((au)v4_1).getName()); v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_ver_name:"</span></span>); v5.append(((au)v4_1).aDA()); v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_ver_code:"</span></span>); v5.append(((au)v4_1).gBl); v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_req_type:"</span></span>); v5.append(((au)v4_1).gBq); } } j v3_4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> j(); mb(v3_4); h v4_2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> h(); mb(v4_2); ay v5_1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ay(); v3_4.hS(<span class="hljs-string"><span class="hljs-string">""</span></span>); v3_4.setImsi(<span class="hljs-string"><span class="hljs-string">""</span></span>); v3_4.hV(<span class="hljs-string"><span class="hljs-string">""</span></span>); v5_1.bPQ = v3_4; v5_1.bPP = v4_2; v5_1.yr(arg9.iGX.ipR); v5_1.gBF = arg9.iGX.mMode; v5_1.gBI = arg9.iGX.iEz; v3_2 = v5_1.gAr; c.aBh(); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"os_ver"</span></span>, c.getRomInfo())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"processor_arch"</span></span>, com.uc.baacgetCpuArch())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_arch"</span></span>, com.uc.baacPb())); String v4_3 = com.uc.baacPd(); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_vfp"</span></span>, v4_3)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"net_type"</span></span>, String.valueOf(com.uc.base.system.a.Jo()))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"fromhost"</span></span>, arg9.iGX.iEm)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"plugin_ver"</span></span>, arg9.iGX.iEn)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"target_lang"</span></span>, arg9.iGX.iEs)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"vitamio_cpu_arch"</span></span>, arg9.iGX.iEt)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"vitamio_vfp"</span></span>, arg9.iGX.iEu)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"vitamio_vfp3"</span></span>, arg9.iGX.iEv)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"plugin_child_ver"</span></span>, arg9.iGX.iEx)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"ver_series"</span></span>, arg9.iGX.iEw)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"child_ver"</span></span>, r.aVw())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cur_ver_md5"</span></span>, arg9.iGX.iEl)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cur_ver_signature"</span></span>, SystemHelper.getUCMSignature())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"upgrade_log"</span></span>, i.bjt())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_install"</span></span>, String.valueOf(arg9.iGX.iDQ))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_state"</span></span>, String.valueOf(arg9.iGX.iEp))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_file"</span></span>, arg9.iGX.iEq)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_type"</span></span>, String.valueOf(arg9.iGX.iEr))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_archit"</span></span>, com.uc.baacPc())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_set"</span></span>, SystemHelper.getCpuInstruction())); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> v4_4 = v4_3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || !v4_3.contains(<span class="hljs-string"><span class="hljs-string">"neon"</span></span>) ? <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"neon"</span></span>, String.valueOf(v4_4))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_cores"</span></span>, String.valueOf(com.uc.baacJl()))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"ram_1"</span></span>, String.valueOf(com.uc.baahPo()))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"totalram"</span></span>, String.valueOf(com.uc.baahOL()))); c.aBh(); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"rom_1"</span></span>, c.getRomInfo())); v4_5 = e.getScreenWidth(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v6 = e.getScreenHeight(); StringBuilder v7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); v7.append(v4_5); v7.append(<span class="hljs-string"><span class="hljs-string">"*"</span></span>); v7.append(v6); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"ss"</span></span>, v7.toString())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"api_level"</span></span>, String.valueOf(Build$VERSION.SDK_INT))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"uc_apk_list"</span></span>, SystemHelper.getUCMobileApks())); Iterator v4_6 = arg9.iGX.iEA.entrySet().iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(v4_6.hasNext()) { Object v6_1 = v4_6.next(); v3_2.add(g.fs(((Map$Entry)v6_1).getKey(), ((Map$Entry)v6_1).getValue())); } v3 = v5_1.toByteArray(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_encode"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } v4_5 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGw ? <span class="hljs-number"><span class="hljs-number">0x1F</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v3 = gi(v4_5, v3); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[v3.length + <span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v6_2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">16</span></span>]; Arrays.fill(v6_2, <span class="hljs-number"><span class="hljs-number">0</span></span>); v6_2[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0x5F</span></span>; v6_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; v6_2[<span class="hljs-number"><span class="hljs-number">2</span></span>] = ((<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)v4_5); v6_2[<span class="hljs-number"><span class="hljs-number">3</span></span>] = -<span class="hljs-number"><span class="hljs-number">50</span></span>; System.arraycopy(v6_2, <span class="hljs-number"><span class="hljs-number">0</span></span>, v1, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); System.arraycopy(v3, <span class="hljs-number"><span class="hljs-number">0</span></span>, v1, <span class="hljs-number"><span class="hljs-number">16</span></span>, v3.length); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_encrypt"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(TextUtils.isEmpty(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.mUpgradeUrl)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_url"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } StringBuilder v0 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v0.append(arg9.iGX.ipR); v0.append(<span class="hljs-string"><span class="hljs-string">"]url:"</span></span>); v0.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.mUpgradeUrl); com.uc.browser.core.dci v0_1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI; v3_1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.mUpgradeUrl; com.uc.base.net.e v0_2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> com.uc.base.net.e(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> com.uc.browser.core.dci$a(v0_1, arg9)); v3_1 = v3_1.contains(<span class="hljs-string"><span class="hljs-string">"?"</span></span>) ? v3_1 + <span class="hljs-string"><span class="hljs-string">"&amp;dataver=pb"</span></span> : v3_1 + <span class="hljs-string"><span class="hljs-string">"?dataver=pb"</span></span>; n v3_5 = v0_2.uc(v3_1); mb(v3_5, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); v3_5.setMethod(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>); v3_5.setBodyProvider(v1); v0_2.b(v3_5); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_null"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"success"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.b(arg9); }</code> </pre> <br>  Ù†Ø±Ù‰ Ù‡Ù†Ø§ ØªØ´ÙƒÙŠÙ„ Ø·Ù„Ø¨ POST.  Ù†Ù„ÙØª Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ Ø¥Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† 16 Ø¨Ø§ÙŠØª ÙˆØªØ¹Ø¨Ø¦ØªÙ‡Ø§: 0x5F ØŒ 0 ØŒ 0x1F ØŒ -50 (= 0xCE).  ÙŠØ·Ø§Ø¨Ù‚ Ù…Ø§ Ø±Ø£ÙŠÙ†Ø§Ù‡ ÙÙŠ Ø§Ù„Ø·Ù„Ø¨ Ø£Ø¹Ù„Ø§Ù‡. <br><br>  ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ù„Ø§Ø­Ø¸Ø© ÙØ¦Ø© Ù…ØªØ¯Ø§Ø®Ù„Ø© ØªÙˆØ¬Ø¯ Ø¨Ù‡Ø§ Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰ Ù…Ø«ÙŠØ±Ø© Ù„Ù„Ø§Ù‡ØªÙ…Ø§Ù…: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l arg10, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] arg11)</span></span></span><span class="hljs-function"> </span></span>{ f v0 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGQ; StringBuilder v1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v1.append(arg10.iGX.ipR); v1.append(<span class="hljs-string"><span class="hljs-string">"]:UpgradeSuccess"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v1_1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11[<span class="hljs-number"><span class="hljs-number">0</span></span>] != <span class="hljs-number"><span class="hljs-number">0x60</span></span> &amp;&amp; arg11[<span class="hljs-number"><span class="hljs-number">3</span></span>] != <span class="hljs-number"><span class="hljs-number">0xFFFFFFD0</span></span>) { goto label_57; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v3 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v5 = arg11[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>] != <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>] != <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0x1F</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v3 = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[arg11.length - <span class="hljs-number"><span class="hljs-number">16</span></span>]; System.arraycopy(arg11, <span class="hljs-number"><span class="hljs-number">16</span></span>, v7, <span class="hljs-number"><span class="hljs-number">0</span></span>, v7.length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { v7 = gj(arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>], v7); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v7 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_57; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v5 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { v1_1 = gP(v7); goto label_57; } v1_1 = v7; } label_57: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1_1 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v0.iGY.iGI.a(arg10, <span class="hljs-string"><span class="hljs-string">"up_decrypt"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } q v11 = gb(arg10, v1_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v11 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v0.iGY.iGI.a(arg10, <span class="hljs-string"><span class="hljs-string">"up_decode"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v0.iGY.iGt) { v0.d(arg10); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v0.iGY.iGo != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v0.iGY.iGo.a(<span class="hljs-number"><span class="hljs-number">0</span></span>, ((o)v11)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v0.iGY.iGs) { v0.iGY.a(((o)v11)); v0.iGY.iGI.a(v11, <span class="hljs-string"><span class="hljs-string">"up_silent"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"success"</span></span>); v0.iGY.iGI.a(v11); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } v0.iGY.iGI.a(v11, <span class="hljs-string"><span class="hljs-string">"up_silent"</span></span>, <span class="hljs-string"><span class="hljs-string">"no"</span></span>, <span class="hljs-string"><span class="hljs-string">"success"</span></span>); } }</code> </pre> <br>  ÙŠØªÙ„Ù‚Ù‰ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ ØµÙÙŠÙ Ù…Ù† Ø§Ù„Ø¨Ø§ÙŠØªØ§Øª ÙƒÙ…Ø¯Ø®Ù„Ø§Øª ÙˆÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø¨Ø§ÙŠØª ØµÙØ± Ù‡Ùˆ 0x60 Ø£Ùˆ Ø§Ù„Ø¨Ø§ÙŠØª Ø§Ù„Ø«Ø§Ù„Ø« Ù‡Ùˆ 0xD0 ÙˆØ§Ù„Ø¨Ø§ÙŠØª Ø§Ù„Ø«Ø§Ù†ÙŠ Ù‡Ùˆ 1 Ø£Ùˆ 11 Ø£Ùˆ 0x1F.  Ù†Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø¯Ù…: ØµÙØ± Ø¨Ø§ÙŠØª - 0x60 ØŒ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ - 0x1F ØŒ ÙˆØ§Ù„Ø«Ø§Ù„Ø« - 0x60.  ÙŠØ´Ø¨Ù‡ Ù…Ø§ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„ÙŠÙ‡.  Ø§Ø°Ø§ Ø­ÙƒÙ…Ù†Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø®Ø·ÙˆØ· ("up_decrypt" ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„) ØŒ ÙŠÙ†Ø¨ØºÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø·Ø±ÙŠÙ‚Ø© Ù‡Ù†Ø§ Ù„ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø¯Ù…. <br>  Ù†Ù…Ø± Ø¥Ù„Ù‰ Ø·Ø±ÙŠÙ‚Ø© <i>Ø¬ÙŠ Ø¬ÙŠ</i> .  Ù„Ø§Ø­Ø¸ Ø£Ù† Ø§Ù„Ø¨Ø§ÙŠØª Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© 2 (Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ 0x1F ÙÙŠ Ø­Ø§Ù„ØªÙ†Ø§) ÙŠØªÙ… Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„ÙŠÙ‡ ÙƒÙˆØ³ÙŠØ·Ø© Ø£ÙˆÙ„Ù‰ ØŒ ÙˆØ§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø¯Ù… Ø¯ÙˆÙ† <br>  Ø£ÙˆÙ„ 16 Ø¨Ø§ÙŠØª. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] j(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arg1, <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] arg2) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg1 == <span class="hljs-number"><span class="hljs-number">1</span></span>) { arg2 = cc(arg2, c.adu); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg1 == <span class="hljs-number"><span class="hljs-number">11</span></span>) { arg2 = m.aF(arg2); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg1 != <span class="hljs-number"><span class="hljs-number">0x1F</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { arg2 = EncryptHelper.decrypt(arg2); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arg2; }</code> </pre> <br>  Ù…Ù† Ø§Ù„ÙˆØ§Ø¶Ø­ ØŒ Ù‡Ù†Ø§Ùƒ Ø®ÙŠØ§Ø± Ù…Ù† Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± ØŒ ÙˆØ§Ù„Ø¨Ø§ÙŠØª Ù†ÙØ³Ù‡ ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙ†Ø§ <br>  Ø§Ù„Ø­Ø§Ù„Ø© Ù‡ÙŠ 0x1F ØŒ ØªØ´ÙŠØ± Ø¥Ù„Ù‰ ÙˆØ§Ø­Ø¯ Ù…Ù† Ø«Ù„Ø§Ø«Ø© Ø®ÙŠØ§Ø±Ø§Øª Ù…Ù…ÙƒÙ†Ø©. <br><br>  Ù†ÙˆØ§ØµÙ„ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ù…Ø².  Ø¨Ø¹Ø¯ Ø¨Ø¶Ø¹ Ø§Ù„Ù‚ÙØ²Ø§Øª ØŒ Ù†Ø¯Ø®Ù„ ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¹ Ø§Ø³Ù… Ø§Ù„Ø­Ø¯ÙŠØ« <i>decryptBytesByKey</i> . <br><br>  Ù‡Ù†Ø§ ØŒ ÙŠØªÙ… ÙØµÙ„ ÙˆØ­Ø¯ØªÙŠ Ø¨Ø§ÙŠØª Ø¢Ø®Ø±ÙŠÙ† Ø¹Ù† Ø¥Ø¬Ø§Ø¨ØªÙ†Ø§ ØŒ ÙˆÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ù„Ø³Ù„Ø© Ù…Ù†Ù‡Ø§.  Ù…Ù† Ø§Ù„ÙˆØ§Ø¶Ø­ Ø£Ù†Ù‡ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙØªØ§Ø­ Ù„ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø©. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] decryptBytesByKey(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v0 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytes != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytes.length &lt; EncryptHelper.PREFIX_BYTES_SIZE) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytes.length == EncryptHelper.PREFIX_BYTES_SIZE) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] prefix = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[EncryptHelper.PREFIX_BYTES_SIZE]; <span class="hljs-comment"><span class="hljs-comment">// 2  System.arraycopy(bytes, 0, prefix, 0, prefix.length); String keyId = c.ayR().d(ByteBuffer.wrap(prefix).getShort()); //   if(keyId == null) { return v0; } else { a v2 = EncryptHelper.ayL(); if(v2 == null) { return v0; } else { byte[] enrypted = new byte[bytes.length - EncryptHelper.PREFIX_BYTES_SIZE]; System.arraycopy(bytes, EncryptHelper.PREFIX_BYTES_SIZE, enrypted, 0, enrypted.length); return v2.l(keyId, enrypted); } } } } catch(SecException v7_1) { EncryptHelper.handleDecryptException(((Throwable)v7_1), v7_1.getErrorCode()); return v0; } catch(Throwable v7) { EncryptHelper.handleDecryptException(v7, 2); return v0; } } return v0; }</span></span></code> </pre> <br>  Ø¨Ø§Ù„Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ØŒ Ù†Ù„Ø§Ø­Ø¸ Ø£Ù†Ù‡ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­ Ø¨Ø¹Ø¯ ØŒ ÙˆÙ„ÙƒÙ† ÙÙ‚Ø· "Ù…Ø¹Ø±ÙÙ‡".  Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­ Ù‡Ùˆ Ø£ÙƒØ«Ø± ØªØ¹Ù‚ÙŠØ¯Ø§ Ù‚Ù„ÙŠÙ„Ø§. <br><br>  ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© ØŒ ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ø«Ù†ÙŠÙ† Ø¢Ø®Ø±ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØŒ ÙˆÙ‡Ù†Ø§Ùƒ Ø£Ø±Ø¨Ø¹ Ù…Ù†Ù‡Ø§: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø­Ø±ÙŠ 16 ØŒ Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙØªØ§Ø­ ØŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø© ÙˆØ³Ù„Ø³Ù„Ø© ØºÙŠØ± Ù…ÙÙ‡ÙˆÙ…Ø© (ÙÙŠ Ø­Ø§Ù„ØªÙ†Ø§ ØŒ ÙØ§Ø±ØºØ©). <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] l(String keyId, <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] encrypted) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> SecException { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ayJ().staticBinarySafeDecryptNoB64(<span class="hljs-number"><span class="hljs-number">16</span></span>, keyId, encrypted, <span class="hljs-string"><span class="hljs-string">""</span></span>); }</code> </pre> <br>  Ø¨Ø¹Ø¯ Ø³Ù„Ø³Ù„Ø© Ù…Ù† Ø§Ù„ØªØ­ÙˆÙ„Ø§Øª ØŒ ÙˆØµÙ„Ù†Ø§ Ø¥Ù„Ù‰ Ø·Ø±ÙŠÙ‚Ø© <i>staticBinarySafeDecryptNoB64 Ø§Ù„Ø®Ø§ØµØ©</i> Ø¨Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© <i>com.alibaba.wireless.security.open.staticdataencrypt.IStaticDataEncryptComponent</i> <i>.</i>  Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ¦Ø§Øª ÙÙŠ Ø±Ù…Ø² Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ø°ÙŠ ÙŠÙ‚ÙˆÙ… Ø¨ØªÙ†ÙÙŠØ° Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©.  Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù <i>lib / armeabi-v7a / libsgmain.so</i> ØŒ ÙˆÙ‡Ùˆ ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ Ù„ÙŠØ³ ÙƒØ°Ù„Ùƒ. Ù„ÙƒÙ† .jar.  ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø­Ùˆ Ø§Ù„ØªØ§Ù„ÙŠ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.alibaba.wireless.security.ai; <span class="hljs-comment"><span class="hljs-comment">// ... public class a implements IStaticDataEncryptComponent { private ISecurityGuardPlugin a; // ... private byte[] a(int mode, int magicInt, int xzInt, String keyId, byte[] encrypted, String magicString) { return this.a.getRouter().doCommand(10601, new Object[]{Integer.valueOf(mode), Integer.valueOf(magicInt), Integer.valueOf(xzInt), keyId, encrypted, magicString}); } // ... private byte[] b(int magicInt, String keyId, byte[] encrypted, String magicString) { return this.a(2, magicInt, 0, keyId, encrypted, magicString); } // ... public byte[] staticBinarySafeDecryptNoB64(int magicInt, String keyId, byte[] encrypted, String magicString) throws SecException { if(keyId != null &amp;&amp; keyId.length() &gt; 0 &amp;&amp; magicInt &gt;= 0 &amp;&amp; magicInt &lt; 19 &amp;&amp; encrypted != null &amp;&amp; encrypted.length &gt; 0) { return this.b(magicInt, keyId, encrypted, magicString); } throw new SecException("", 301); } //... }</span></span></code> </pre> <br>  Ù‡Ù†Ø§ ØŒ ÙŠØªÙ… Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ù„Ø¯ÙŠÙ†Ø§ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ø«Ù†ÙŠÙ† Ù…Ù† Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµØ­ÙŠØ­Ø©: 2 Ùˆ 0 <br>  Ù„Ù„Ø¬Ù…ÙŠØ¹ ØŒ 2 ÙŠØ¹Ù†ÙŠ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± ØŒ ÙƒÙ…Ø§ Ù‡Ùˆ Ø§Ù„Ø­Ø§Ù„ ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© <i>doFinal</i> Ù„ÙØ¦Ø© Ù†Ø¸Ø§Ù… <i>javax.crypto.Cipher</i> .  ÙˆÙŠØªÙ… Ù†Ù‚Ù„ ÙƒÙ„ Ù‡Ø°Ø§ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Ø² ØªÙˆØ¬ÙŠÙ‡ Ù…Ø¹ÙŠÙ† Ø¨Ø±Ù‚Ù… 10601 - ÙˆÙ‡Ø°Ø§ ØŒ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ¨Ø¯Ùˆ ØŒ Ù‡Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø£Ù…Ø±. <br><br>  Ø¨Ø¹Ø¯ Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠØ© ØŒ Ù†Ø¬Ø¯ ÙØ¦Ø© ØªÙ†ÙØ° ÙˆØ§Ø¬Ù‡Ø© <i>IRouterComponent</i> ÙˆØ·Ø±ÙŠÙ‚Ø© <i>doCommand</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.alibaba.wireless.security.mainplugin; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.alibaba.wireless.security.framework.IRouterComponent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.taobao.wireless.security.adapter.JNICLibrary; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IRouterComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg2, Object[] arg3)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> JNICLibrary.doCommandNative(arg2, arg3); } }</code> </pre> <br>  ÙˆØ£ÙŠØ¶Ù‹Ø§ ÙØ¦Ø© <i>JNICLibrary</i> ØŒ Ø§Ù„ØªÙŠ <i>ØªØ¹Ù„Ù† Ø¹Ù†</i> Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù€ <i>doCommandNative</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.taobao.wireless.security.adapter; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JNICLibrary</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommandNative</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg0, Object[] arg1)</span></span></span></span>; }</code> </pre> <br>  Ù„Ø°Ù„Ùƒ ØŒ Ù†Ø­Ù† Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ø¥ÙŠØ¬Ø§Ø¯ Ø·Ø±ÙŠÙ‚Ø© <i>doCommandNative</i> ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ.  Ø«Ù… ØªØ¨Ø¯Ø£ Ø§Ù„Ù…ØªØ¹Ø©. <br><br><h3 style=";text-align:right;direction:rtl">  Ø¢Ù„Ø© Ø±Ù…Ø² Ø§Ù„ØªØ¹ØªÙŠÙ… </h3><br>  ØªÙˆØ¬Ø¯ Ù…ÙƒØªØ¨Ø© Ø£ØµÙ„ÙŠØ© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ Ù…Ù„Ù <i>libsgmain.so</i> (ÙˆÙ‡ÙŠ ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ .jar ÙˆØ§Ù„ØªÙŠ ÙˆØ¬Ø¯Ù†Ø§ ÙÙŠÙ‡Ø§ ØªØ·Ø¨ÙŠÙ‚Ù‹Ø§ Ø¨Ø³ÙŠØ·Ù‹Ø§ Ù„Ø¨Ø¹Ø¶ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„ØªØ´ÙÙŠØ± Ø£Ø¹Ù„Ù‰ Ù‚Ù„ÙŠÙ„Ø§Ù‹): <i>libsgmainso-6.4.36.so</i> .  ÙØªØ­Ù‡ ÙÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø­ÙˆØ§Ø± Ù…Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡.  Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù‡ÙŠ Ø£Ù† Ø¬Ø¯ÙˆÙ„ Ø±Ø£Ø³ Ø§Ù„Ù‚Ø³Ù… ØºÙŠØ± ØµØ§Ù„Ø­.  ÙŠØªÙ… Ø°Ù„Ùƒ Ø¹Ù„Ù‰ ÙˆØ¬Ù‡ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù„ØªØ¹Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ù„ÙŠÙ„. <br><br><img src="https://habrastorage.org/webt/_k/bz/5c/_kbz5cbedw6g1jnsj047rtqudli.jpeg"><br><br>  ÙˆÙ„ÙƒÙ† Ù„ÙŠØ³ Ù‡Ù†Ø§Ùƒ Ø­Ø§Ø¬Ø© Ø£ÙŠØ¶Ù‹Ø§: Ù…Ù† Ø£Ø¬Ù„ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ELF ÙˆØªØ­Ù„ÙŠÙ„Ù‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ØŒ ÙŠÙƒÙˆÙ† Ø¬Ø¯ÙˆÙ„ Ø±Ø£Ø³ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙƒØ§ÙÙŠØ§Ù‹.  Ù„Ø°Ù„Ùƒ ØŒ Ù†Ù‚ÙˆÙ… Ø¨Ø¨Ø³Ø§Ø·Ø© Ø¨Ø­Ø°Ù Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø³Ù… Ø¹Ù† Ø·Ø±ÙŠÙ‚ ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© ÙÙŠ Ø§Ù„Ø±Ø£Ø³. <br><br><img src="https://habrastorage.org/webt/2y/xh/vk/2yxhvksp30f016gfyhrlfh0pklc.jpeg"><br><br>  Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø§ÙØªØ­ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ©. <br><br>  Ù‡Ù†Ø§Ùƒ Ø·Ø±ÙŠÙ‚ØªØ§Ù† Ù„Ø¥Ø®Ø¨Ø§Ø± Ø¬Ù‡Ø§Ø² Java Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¹Ù† Ù…ÙƒØ§Ù† ØªÙ†ÙÙŠØ° Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø¹Ù„Ù†Ø© ÙÙŠ ÙƒÙˆØ¯ Java ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.  Ø§Ù„Ø£ÙˆÙ„ Ù‡Ùˆ Ø¥Ø¹Ø·Ø§Ø¦Ù‡Ø§ Ø§Ø³Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ <i>Java_package_name_ClassName_Method_name</i> . <br><br>  ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ Ù‡Ùˆ ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø© (ÙÙŠ ÙˆØ¸ÙŠÙØ© <i>JNI_OnLoad</i> ) <br>  Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ¸ÙŠÙØ© <i>RegisterNatives</i> . <br><br>  ÙÙŠ Ø­Ø§Ù„ØªÙ†Ø§ ØŒ Ø¥Ø°Ø§ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ØŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø§Ø³Ù… ÙƒÙ…Ø§ ÙŠÙ„ÙŠ: <i>Java_com_taobao_wireless_security_adapter_JNICLibrary_doCommandNative</i> . <br><br>  Ù…Ù† Ø¨ÙŠÙ† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØµØ¯Ø±Ø© ØŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´ÙŠØ¡ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø¨ÙŠÙ„ ØŒ Ù„Ø°Ù„Ùƒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ <i>RegisterNatives</i> . <br>  Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ÙˆØ¸ÙŠÙØ© <i>JNI_OnLoad</i> ÙˆÙ†Ø±Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©: <br><br><img src="https://habrastorage.org/webt/m6/dp/iw/m6dpiwaonfuyri-jg8thppcfgqe.jpeg"><br><br>  Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¯Ø« Ù‡Ù†Ø§ØŸ  Ù„Ù„ÙˆÙ‡Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ØŒ ØªØ¹Ø¯ Ø¨Ø¯Ø§ÙŠØ© ÙˆÙ†Ù‡Ø§ÙŠØ© Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù„Ù‡Ù†Ø¯Ø³Ø© ARM.  Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ¯Ø³ ØªØ®Ø²Ù† Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªÙŠ Ø³ØªØ³ØªØ®Ø¯Ù…Ù‡Ø§ Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙÙŠ Ø¹Ù…Ù„Ù‡Ø§ (ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© R0 ØŒ R1 Ùˆ R2) ØŒ ÙˆÙƒØ°Ù„Ùƒ Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„ LR ØŒ Ø­ÙŠØ« ÙŠÙˆØ¬Ø¯ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø±Ø³Ù„ Ù…Ù† Ø§Ù„ÙˆØ¸ÙŠÙØ©.  Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ØŒ ØªØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ØŒ ÙˆÙŠÙˆØ¶Ø¹ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø±Ø³Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙÙˆØ± ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø§Ù„Ø´Ø®ØµÙŠ - ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ ÙŠØ¹ÙˆØ¯ Ù…Ù† Ø§Ù„ÙˆØ¸ÙŠÙØ©.  ÙˆÙ„ÙƒÙ† Ø¥Ø°Ø§ Ù†Ø¸Ø±Øª Ø¹Ù† ÙƒØ«Ø¨ ØŒ Ø³ØªÙ„Ø§Ø­Ø¸ Ø£Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø£Ø®ÙŠØ±Ø© ØªØºÙŠØ± Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø±Ø³Ù„ Ø§Ù„Ù…Ø®Ø²Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø±ØµØ©.  Ù†Ø­Ø³Ø¨ Ù…Ø§ Ø³ÙˆÙ ÙŠÙƒÙˆÙ† Ø¨Ø¹Ø¯ <br>  ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©.  ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¹Ù†ÙˆØ§Ù† Ù…Ø¹ÙŠÙ† 0xB130 ÙÙŠ R1 ØŒ ÙŠØªÙ… Ø·Ø±Ø­ 5 Ù…Ù†Ù‡ ØŒ Ø«Ù… ÙŠØªÙ… Ù†Ù‚Ù„Ù‡ Ø¥Ù„Ù‰ R0 ÙˆØªØªÙ… Ø¥Ø¶Ø§ÙØ© 0x10 Ø¥Ù„ÙŠÙ‡.  Ø§ØªØ¶Ø­ 0xB13B.  ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ ØŒ ØªØ¹ØªÙ‚Ø¯ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© Ø£Ù† Ù‡Ù†Ø§Ùƒ Ø¹Ø§Ø¦Ø¯Ù‹Ø§ Ø·Ø¨ÙŠØ¹ÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ØŒ ÙˆÙ„ÙƒÙ† ÙÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø© Ù‡Ù†Ø§Ùƒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­Ø³ÙˆØ¨ 0xB13B. <br><br>  ØªØ¬Ø¯Ø± Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø£Ù† Ù…Ø¹Ø§Ù„Ø¬Ø§Øª ARM Ù„Ù‡Ø§ ÙˆØ¶Ø¹Ø§Ù† ÙˆÙ…Ø¬Ù…ÙˆØ¹ØªØ§Ù† Ù…Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª: ARM Ùˆ Thumb.  ÙŠØ®Ø¨Ø± Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ù‚Ù„ Ø£Ù‡Ù…ÙŠØ© Ù…Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ Ø¨Ø£Ù†Ù‡ ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª.  Ø£ÙŠ Ø£Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù‡Ùˆ ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ 0xB13A ØŒ ÙˆØªØ´ÙŠØ± Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ø¨Øª Ø§Ù„Ù…Ù†Ø®ÙØ¶ Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø¨Ù‡Ø§Ù…. <br><br>  ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© ÙƒÙ„ ÙˆØ¸ÙŠÙØ© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙƒØªØ¨Ø© ÙŠØ¶Ø§Ù "Ù…Ø­ÙˆÙ„" Ù…Ù…Ø§Ø«Ù„ Ùˆ <br>  Ø±Ù…Ø² Ø§Ù„Ù‚Ù…Ø§Ù…Ø©.  Ø¹Ù„Ø§ÙˆØ© Ø¹Ù„Ù‰ Ø°Ù„Ùƒ ØŒ Ù„Ù† Ù†ØªÙ†Ø§ÙˆÙ„Ù‡Ø§ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ - Ù†Ø­Ù† Ù†ØªØ°ÙƒØ± ÙÙ‚Ø· <br>  Ø£Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ Ù‡ÙŠ Ø£Ø¨Ø¹Ø¯ Ù‚Ù„ÙŠÙ„Ø§Ù‹. <br><br>  Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù†ØªÙ‚Ø§Ù„ ØµØ±ÙŠØ­ Ø¥Ù„Ù‰ 0xB13A ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© ØŒ Ù„Ù… ØªØªØ¹Ø±Ù Ø§Ù„Ù…Ø¤Ø³Ø³Ø© IDA Ù†ÙØ³Ù‡Ø§ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù†.  Ù„Ù„Ø³Ø¨Ø¨ Ù†ÙØ³Ù‡ ØŒ Ù„Ø§ ÙŠØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ù…Ø¹Ø¸Ù… Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø© ÙƒØ±Ù…Ø² ØŒ Ù…Ù…Ø§ ÙŠØ¬Ø¹Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ØµØ¹Ø¨Ù‹Ø§ Ø¥Ù„Ù‰ Ø­Ø¯ Ù…Ø§.  Ù†Ù‚ÙˆÙ„ Ù„Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© Ø£Ù† Ø§Ù„Ø±Ù…Ø² Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ù†Ø§ ØŒ ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© Ù‡ÙŠ: <br><br><img src="https://habrastorage.org/webt/eq/wp/p3/eqwpp3exmqnybi7r_tdvvan4jls.png"><br><br>  ÙÙŠ 0xB144 ØŒ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨ÙˆØ¶ÙˆØ­.  Ù…Ø§Ø°Ø§ Ø¹Ù† sub_494CØŸ <br><br><img src="https://habrastorage.org/webt/bo/9b/rn/bo9brnkfvauy3ntm2dnucnsxqhs.png"><br><br>  Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙÙŠ Ø³Ø¬Ù„ LR ØŒ Ù†Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø°ÙƒÙˆØ± Ø£Ø¹Ù„Ø§Ù‡ (0xB144).  ÙÙŠ R0 ØŒ Ø§Ù„ÙÙ‡Ø±Ø³ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø¯ÙˆÙ„.  ÙˆÙ‡Ø°Ø§ Ù‡Ùˆ ØŒ ÙŠØªÙ… Ø£Ø®Ø° Ù‚ÙŠÙ…Ø© Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ ØŒ ØªØ¶Ø§Ù Ø¥Ù„Ù‰ LR ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„ÙŠÙ‡Ø§ <br>  Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰.  Ø¯Ø¹Ù†Ø§ Ù†Ø­Ø§ÙˆÙ„ Ø­Ø³Ø§Ø¨Ù‡: 0xB144 + [0xB144 + 8 * 4] = 0xB144 + 0x120 = 0xB264.  Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ„Ù… ÙˆÙ†Ø±Ù‰ Ø¨Ø¶Ø¹Ø© ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù…ÙÙŠØ¯Ø© ÙˆÙ…Ø±Ø© â€‹â€‹Ø£Ø®Ø±Ù‰ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ 0xB140: <br><br><img src="https://habrastorage.org/webt/nz/95/4x/nz954xqtjmky6tnpaqeejhvecus.png"><br><br>  Ø§Ù„Ø¢Ù† Ø³ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ ØªØ­ÙˆÙ„ Ø¹Ù† Ø·Ø±ÙŠÙ‚ ØªØ¹ÙˆÙŠØ¶ Ù…Ø¹ Ù…Ø¤Ø´Ø± 0x20 Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„. <br><br>  Ø§Ø³ØªÙ†Ø§Ø¯Ø§ Ø¥Ù„Ù‰ Ø­Ø¬Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„ ØŒ Ù‡Ù†Ø§Ùƒ Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„ØªØ­ÙˆÙ„Ø§Øª ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©.  Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø°ÙŠ ÙŠØ·Ø±Ø­ Ù†ÙØ³Ù‡ Ù‡Ùˆ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£Ùˆ Ø¨Ø£Ø®Ø±Ù‰ Ù…Ø¹ Ù‡Ø°Ø§ Ø¨Ø´ÙƒÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ØŒ Ø¯ÙˆÙ† Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙŠØ¯ÙˆÙŠÙ‹Ø§.  ØªÙ‚Ø¯Ù… Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠØ© ÙˆØ§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªØµØ­ÙŠØ­ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© Ù…Ø³Ø§Ø¹Ø¯ØªÙ†Ø§: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put_unconditional_branch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source, destination)</span></span></span><span class="hljs-function">:</span></span> offset = (destination - source - <span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">2097151</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-2097152</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> RuntimeError(<span class="hljs-string"><span class="hljs-string">"Invalid offset"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">1023</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-1024</span></span>: instruction1 = <span class="hljs-number"><span class="hljs-number">0xf000</span></span> | ((offset &gt;&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) instruction2 = <span class="hljs-number"><span class="hljs-number">0xb800</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction1) patch_word(source + <span class="hljs-number"><span class="hljs-number">2</span></span>, instruction2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: instruction = <span class="hljs-number"><span class="hljs-number">0xe000</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction) ea = here() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> get_wide_word(ea) == <span class="hljs-number"><span class="hljs-number">0xb503</span></span>: <span class="hljs-comment"><span class="hljs-comment">#PUSH {R0,R1,LR} ea1 = ea + 2 if get_wide_word(ea1) == 0xbf00: #NOP ea1 += 2 if get_operand_type(ea1, 0) == 1 and get_operand_value(ea1, 0) == 0 and get_operand_type(ea1, 1) == 2: index = get_wide_dword(get_operand_value(ea1, 1)) print "index =", hex(index) ea1 += 2 if get_operand_type(ea1, 0) == 7: table = get_operand_value(ea1, 0) + 4 elif get_operand_type(ea1, 1) == 2: table = get_operand_value(ea1, 1) + 4 else: print "Wrong operand type on", hex(ea1), "-", get_operand_type(ea1, 0), get_operand_type(ea1, 1) table = None if table is None: print "Unable to find table" else: print "table =", hex(table) offset = get_wide_dword(table + (index &lt;&lt; 2)) put_unconditional_branch(ea, table + offset) else: print "Unknown code", get_operand_type(ea1, 0), get_operand_value(ea1, 0), get_operand_type(ea1, 1) == 2 else: print "Unable to detect first instruction"</span></span></code> </pre> <br>  Ù†Ø¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø· 0xB26A ØŒ ÙˆÙ†Ø´ØºÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠ ÙˆÙ†Ø±Ù‰ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ 0xB4B0: <br><br><img src="https://habrastorage.org/webt/52/rf/fx/52rffxhzmtrfdhfrznsr8dovfim.png"><br><br>  Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ù… ØªØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒØ±Ù…Ø².  Ù†Ø³Ø§Ø¹Ø¯Ù‡Ø§ ÙˆÙ†Ø±Ù‰ Ø¨Ù†Ø§Ø¡ Ø¢Ø®Ø± Ù‡Ù†Ø§Ùƒ: <br><br><img src="https://habrastorage.org/webt/ct/d9/kv/ctd9kvewm9l1blmw3pqipi8mnqm.png"><br><br>  Ù„Ø§ ØªØ¨Ø¯Ùˆ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯ BLX Ø°Ø§Øª Ù…ØºØ²Ù‰ ÙƒØ¨ÙŠØ± ØŒ Ø¥Ù†Ù‡Ø§ Ø£Ø´Ø¨Ù‡ Ø¨Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„ØªØ­ÙŠØ².  Ù†Ù†Ø¸Ø± ÙÙŠ sub_4964: <br><br><img src="https://habrastorage.org/webt/o7/wi/4-/o7wi4-imrothkr6qpkbrklj40aw.png"><br><br>  ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ ØŒ Ù‡Ù†Ø§ ÙŠØªÙ… Ø£Ø®Ø° Ø§Ù„ÙƒÙ„Ù…Ø© ÙÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ LR ØŒ Ø§Ù„Ù…Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ØŒ ÙˆØ¨Ø¹Ø¯ Ø°Ù„Ùƒ ÙŠØªÙ… Ø£Ø®Ø° Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ„Ù… ÙˆØ¯ÙØ¹Ù‡Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø²Ù…Ø©.  Ø£ÙŠØ¶Ø§ ØŒ ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© 4 Ø¥Ù„Ù‰ LR ØŒ Ø¨Ø­ÙŠØ« Ø¨Ø¹Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† ÙˆØ¸ÙŠÙØ© Ù„Ù„Ù‚ÙØ² Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ù†ÙØ³Ù‡Ø§.  Ø«Ù… ÙŠØ³Ø­Ø¨ Ø§Ù„Ø£Ù…Ø± POP {R1} Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø© Ù…Ù† Ø§Ù„Ù…ÙƒØ¯Ø³.  Ø¥Ø°Ø§ Ù†Ø¸Ø±Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† 0xB4BA + 0xEA = 0xB5A4 ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ© Ø´ÙŠØ¡ Ù…Ø´Ø§Ø¨Ù‡ Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: <br><br><img src="https://habrastorage.org/webt/ev/hb/a8/evhba8ty8dtnv8niuxyfue0nkfk.png"><br><br>  Ù„ØªØµØ­ÙŠØ­ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ…ÙŠÙ… ØŒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„Ù…ØªÙŠÙ† Ù…Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©: Ø§Ù„Ø¥Ø²Ø§Ø­Ø© ÙˆØ±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ÙˆØ¶Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠÙ‡.  Ù„ÙƒÙ„ Ø³Ø¬Ù„ Ù…Ù…ÙƒÙ† ØŒ Ø³ÙˆÙ ØªØ¶Ø·Ø± Ø¥Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø·Ø¹Ø© Ù…Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ù…Ù‚Ø¯Ù…Ø§. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">patches = {} patches[<span class="hljs-number"><span class="hljs-number">0</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">1</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4a</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">3</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4b</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">4</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4c</span></span>, <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">5</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">8</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">9</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">10</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">11</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0xdb</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) ea = here() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (get_wide_word(ea) == <span class="hljs-number"><span class="hljs-number">0xb082</span></span> <span class="hljs-comment"><span class="hljs-comment">#SUB SP, SP, #8 and get_wide_word(ea + 2) == 0xb503): #PUSH {R0,R1,LR} if get_operand_type(ea + 4, 0) == 7: pop = get_bytes(ea + 12, 4, 0) if pop[1] == '\xbc': register = -1 r = get_wide_byte(ea + 12) for i in range(8): if r == (1 &lt;&lt; i): register = i break if register == -1: print "Unable to detect register" else: address = get_wide_dword(ea + 8) + ea + 8 for b in patches[register]: patch_byte(ea, b) ea += 1 if ea % 4 != 0: ea += 2 patch_dword(ea, address) elif pop[:3] == '\x5d\xf8\x04': register = ord(pop[3]) &gt;&gt; 4 if register in patches: address = get_wide_dword(ea + 8) + ea + 8 for b in patches[register]: patch_byte(ea, b) ea += 1 patch_dword(ea, address) else: print "POP instruction not found" else: print "Wrong operand type on +4:", get_operand_type(ea + 4, 0) else: print "Unable to detect first instructions"</span></span></code> </pre> <br>  Ù†Ø¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø°ÙŠ Ù†Ø±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ - 0xB4B2 - ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠ: <br><br><img src="https://habrastorage.org/webt/lv/mp/oo/lvmpoow5agndjnbbl-t3imyaisq.jpeg"><br><br>  Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ ØŒ Ø¥Ù„ÙŠÙƒ Ø£ÙŠØ¶Ù‹Ø§ Ù‡Ø°Ù‡: <br><br><img src="https://habrastorage.org/webt/dk/nn/rw/dknnrwaye18zzz0xipny0_gdqfq.png"><br><br>  ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØŒ Ø¨Ø¹Ø¯ ØªØ¹Ù„ÙŠÙ…Ø§Øª BLX ØŒ Ù‡Ù†Ø§Ùƒ Ø¥Ø²Ø§Ø­Ø©: <br><br><img src="https://habrastorage.org/webt/fn/bw/uz/fnbwuzpo3qw1hp3vd9rvr2xfq1k.jpeg"><br><br>  Ù†Ø£Ø®Ø° Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ù† LR ØŒ Ù†Ø¶ÙŠÙÙ‡ Ø¥Ù„Ù‰ LR ÙˆÙ†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ù‡Ù†Ø§Ùƒ.  0x72044 + 0xC = 0x72050.  Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¨Ø³ÙŠØ· Ù„Ù„ØºØ§ÙŠØ©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put_unconditional_branch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source, destination)</span></span></span><span class="hljs-function">:</span></span> offset = (destination - source - <span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">2097151</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-2097152</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> RuntimeError(<span class="hljs-string"><span class="hljs-string">"Invalid offset"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">1023</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-1024</span></span>: instruction1 = <span class="hljs-number"><span class="hljs-number">0xf000</span></span> | ((offset &gt;&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) instruction2 = <span class="hljs-number"><span class="hljs-number">0xb800</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction1) patch_word(source + <span class="hljs-number"><span class="hljs-number">2</span></span>, instruction2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: instruction = <span class="hljs-number"><span class="hljs-number">0xe000</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction) ea = here() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> get_wide_word(ea) == <span class="hljs-number"><span class="hljs-number">0xb503</span></span>: <span class="hljs-comment"><span class="hljs-comment">#PUSH {R0,R1,LR} ea1 = ea + 6 if get_wide_word(ea + 2) == 0xbf00: #NOP ea1 += 2 offset = get_wide_dword(ea1) put_unconditional_branch(ea, (ea1 + offset) &amp; 0xffffffff) else: print "Unable to detect first instruction"</span></span></code> </pre> <br>  Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠ: <br><br><img src="https://habrastorage.org/webt/tm/fq/yo/tmfqyogtdhbje0atjckosbrgide.jpeg"><br><br>  Ø¨Ø¹Ø¯ ØªØµØ­ÙŠØ­ ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø¥Ù„Ù‰ Ø¨Ø¯Ø§ÙŠØªÙ‡Ø§ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©.  Ø³ÙˆÙ ÙŠØ¬Ù…Ø¹ ÙƒÙ„ Ø±Ù…Ø² Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙÙŠ Ù‚Ø·Ø¹ ØŒ ÙˆÙŠÙ…ÙƒÙ† ÙÙƒ ØªØ´ÙÙŠØ±Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… HexRays. <br><br><h3 style=";text-align:right;direction:rtl">  Ø³Ù„Ø§Ø³Ù„ ÙÙƒ </h3><br>  Ù„Ù‚Ø¯ ØªØ¹Ù„Ù…Ù†Ø§ ÙƒÙŠÙÙŠØ© Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ <i>ØªØ´ÙÙŠØ±</i> Ø±Ù…Ø² Ø§Ù„Ø¬Ù‡Ø§Ø² ÙÙŠ Ù…ÙƒØªØ¨Ø© <i>libsgmainso-6.4.36.so</i> Ù…Ù† Ù…ØªØµÙØ­ UC ÙˆØ­ØµÙ„Ù†Ø§ Ø¹Ù„Ù‰ Ø±Ù…Ø² ÙˆØ¸ÙŠÙØ© <i>JNI_OnLoad</i> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">real_JNI_OnLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JavaVM *vm)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result; <span class="hljs-comment"><span class="hljs-comment">// r0 jclass clazz; // r0 MAPDST int v4; // r0 JNIEnv *env; // r4 int v6; // [sp-40h] [bp-5Ch] int v7; // [sp+Ch] [bp-10h] v7 = *(_DWORD *)off_8AC00; if ( !vm ) goto LABEL_39; sub_7C4F4(); env = (JNIEnv *)sub_7C5B0(0); if ( !env ) goto LABEL_39; v4 = sub_72CCC(); sub_73634(v4); sub_73E24(&amp;unk_83EA6, &amp;v6, 49); clazz = (jclass)((int (__fastcall *)(JNIEnv *, int *))(*env)-&gt;FindClass)(env, &amp;v6); if ( clazz &amp;&amp; (sub_9EE4(), sub_71D68(env), sub_E7DC(env) &gt;= 0 &amp;&amp; sub_69D68(env) &gt;= 0 &amp;&amp; sub_197B4(env, clazz) &gt;= 0 &amp;&amp; sub_E240(env, clazz) &gt;= 0 &amp;&amp; sub_B8B0(env, clazz) &gt;= 0 &amp;&amp; sub_5F0F4(env, clazz) &gt;= 0 &amp;&amp; sub_70640(env, clazz) &gt;= 0 &amp;&amp; sub_11F3C(env) &gt;= 0 &amp;&amp; sub_21C3C(env, clazz) &gt;= 0 &amp;&amp; sub_2148C(env, clazz) &gt;= 0 &amp;&amp; sub_210E0(env, clazz) &gt;= 0 &amp;&amp; sub_41B58(env, clazz) &gt;= 0 &amp;&amp; sub_27920(env, clazz) &gt;= 0 &amp;&amp; sub_293E8(env, clazz) &gt;= 0 &amp;&amp; sub_208F4(env, clazz) &gt;= 0) ) { result = (sub_B7B0(env, clazz) &gt;&gt; 31) | 0x10004; } else { LABEL_39: result = -1; } return result; }</span></span></code> </pre> <br>  Ø§Ù„Ù†Ø¸Ø± Ø¨Ø¹Ù†Ø§ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø·ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠØ©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> sub_73E24(&amp;unk_83EA6, &amp;v6, <span class="hljs-number"><span class="hljs-number">49</span></span>); clazz = (jclass)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> (__fastcall *)(JNIEnv *, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *))(*env)-&gt;FindClass)(env, &amp;v6);</code> </pre> <br>  ØªÙ‚ÙˆÙ… Ø§Ù„Ø¯Ø§Ù„Ø© <i>sub_73E24</i> Ø¨ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø© Ø¨ÙˆØ¶ÙˆØ­.  ÙƒÙ…Ø¹Ù„Ù…Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØŒ ÙŠØªÙ… ØªÙ…Ø±ÙŠØ± Ù…Ø¤Ø´Ø± Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø§Ø¨Ù‡Ø© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø© ÙˆÙ…Ø®Ø²Ù† Ù…Ø¤Ù‚Øª ÙˆØ±Ù‚Ù…. ,         , . .    <i>FindClass</i> ,      .  ,  â€”      .    ,    ,      .  ,    <i>sub_73E24.</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_73E56</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> __int8 *in, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> __int8 *out, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4; <span class="hljs-comment"><span class="hljs-comment">// r6 int v7; // r11 int v8; // r9 int v9; // r4 size_t v10; // r5 int v11; // r0 struc_1 v13; // [sp+0h] [bp-30h] int v14; // [sp+1Ch] [bp-14h] int v15; // [sp+20h] [bp-10h] v4 = 0; v15 = *(_DWORD *)off_8AC00; v14 = 0; v7 = sub_7AF78(17); v8 = sub_7AF78(size); if ( !v7 ) { v9 = 0; goto LABEL_12; } (*(void (__fastcall **)(int, const char *, int))(v7 + 12))(v7, "DcO/lcK+h?m3c*q@", 16); if ( !v8 ) { LABEL_9: v4 = 0; goto LABEL_10; } v4 = 0; if ( !in ) { LABEL_10: v9 = 0; goto LABEL_11; } v9 = 0; if ( out ) { memset(out, 0, size); v10 = size - 1; (*(void (__fastcall **)(int, unsigned __int8 *, size_t))(v8 + 12))(v8, in, v10); memset(&amp;v13, 0, 0x14u); v13.field_4 = 3; v13.field_10 = v7; v13.field_14 = v8; v11 = sub_6115C(&amp;v13, &amp;v14); v9 = v11; if ( v11 ) { if ( *(_DWORD *)(v11 + 4) == v10 ) { qmemcpy(out, *(const void **)v11, v10); v4 = *(_DWORD *)(v9 + 4); } else { v4 = 0; } goto LABEL_11; } goto LABEL_9; } LABEL_11: sub_7B148(v7); LABEL_12: if ( v8 ) sub_7B148(v8); if ( v9 ) sub_7B148(v9); return v4; }</span></span></code> </pre> <br>  <i>sub_7AF78</i>         (      ).     :     <i>Â«DcO/lcK+h?m3c*q@Â»</i> ( ,   ),   â€”  .       ,    <i>sub_6115C</i> .         3. ,      . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_611B4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struc_1 *a1, _DWORD *a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v3; <span class="hljs-comment"><span class="hljs-comment">// lr unsigned int v4; // r1 int v5; // r0 int v6; // r1 int result; // r0 int v8; // r0 *a2 = 820000; if ( a1 ) { v3 = a1-&gt;field_14; if ( v3 ) { v4 = a1-&gt;field_4; if ( v4 &lt; 0x19 ) { switch ( v4 ) { case 0u: v8 = sub_6419C(a1-&gt;field_0, a1-&gt;field_10, v3); goto LABEL_17; case 3u: v8 = sub_6364C(a1-&gt;field_0, a1-&gt;field_10, v3); goto LABEL_17; case 0x10u: case 0x11u: case 0x12u: v8 = sub_612F4( a1-&gt;field_0, v4, *(_QWORD *)&amp;a1-&gt;field_8, *(_QWORD *)&amp;a1-&gt;field_8 &gt;&gt; 32, a1-&gt;field_10, v3, a2); goto LABEL_17; case 0x14u: v8 = sub_63A28(a1-&gt;field_0, v3); goto LABEL_17; case 0x15u: sub_61A60(a1-&gt;field_0, v3, a2); return result; case 0x16u: v8 = sub_62440(a1-&gt;field_14); goto LABEL_17; case 0x17u: v8 = sub_6226C(a1-&gt;field_10, v3); goto LABEL_17; case 0x18u: v8 = sub_63530(a1-&gt;field_14); LABEL_17: v6 = 0; if ( v8 ) { *a2 = 0; v6 = v8; } return v6; default: LOWORD(v5) = 28032; goto LABEL_5; } } } } LOWORD(v5) = -27504; LABEL_5: HIWORD(v5) = 13; v6 = 0; *a2 = v5; return v6; }</span></span></code> </pre> <br>    switch   ,      3.  case 3:   <i>sub_6364C</i>    ,       , . .    .     <i>sub_6364C</i> ,      RC4. <br><br>      .    .   : <i>com/taobao/wireless/security/adapter/JNICLibrary</i> .  ! Ù…Ù…ØªØ§Ø²    . <br><br><h3 style=";text-align:right;direction:rtl">   </h3><br>     <i>RegisterNatives</i> ,      <i>doCommandNative</i> .  ,   <i>JNI_OnLoad,</i>     <i>sub_B7B0</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_B7F6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JNIEnv *env, jclass clazz)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> signature[<span class="hljs-number"><span class="hljs-number">41</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// [sp+7h] [bp-55h] char name[16]; // [sp+30h] [bp-2Ch] JNINativeMethod method; // [sp+40h] [bp-1Ch] int v8; // [sp+4Ch] [bp-10h] v8 = *(_DWORD *)off_8AC00; decryptString((unsigned __int8 *)&amp;unk_83ED9, (unsigned __int8 *)name, 0x10u);// doCommandNative decryptString((unsigned __int8 *)&amp;unk_83EEA, (unsigned __int8 *)signature, 0x29u);// (I[Ljava/lang/Object;)Ljava/lang/Object; method.name = name; method.signature = signature; method.fnPtr = sub_B69C; return ((int (__fastcall *)(JNIEnv *, jclass, JNINativeMethod *, int))(*env)-&gt;RegisterNatives)(env, clazz, &amp;method, 1) &gt;&gt; 31; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ ØŒ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÙŠØªÙ…</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ØªØ³Ø¬ÙŠÙ„ Ø·Ø±ÙŠÙ‚Ø© Ø£ØµÙ„ÙŠØ© ØªØ³Ù…Ù‰ </font><i><font style="vertical-align: inherit;">doCommandNative</font></i><font style="vertical-align: inherit;"> Ù‡Ù†Ø§ </font><font style="vertical-align: inherit;">. Ø§Ù„Ø¢Ù† Ù†Ø­Ù† Ù†Ø¹Ø±Ù Ø¹Ù†ÙˆØ§Ù†Ù‡. Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±Ù‰ Ù…Ø§ ÙŠÙØ¹Ù„Ù‡.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommandNative</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JNIEnv *env, jobject obj, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, jarray args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v5; <span class="hljs-comment"><span class="hljs-comment">// r5 struc_2 *a5; // r6 int v9; // r1 int v11; // [sp+Ch] [bp-14h] int v12; // [sp+10h] [bp-10h] v5 = 0; v12 = *(_DWORD *)off_8AC00; v11 = 0; a5 = (struc_2 *)malloc(0x14u); if ( a5 ) { a5-&gt;field_0 = 0; a5-&gt;field_4 = 0; a5-&gt;field_8 = 0; a5-&gt;field_C = 0; v9 = command % 10000 / 100; a5-&gt;field_0 = command / 10000; a5-&gt;field_4 = v9; a5-&gt;field_8 = command % 100; a5-&gt;field_C = env; a5-&gt;field_10 = args; v5 = sub_9D60(command / 10000, v9, command % 100, 1, (int)a5, &amp;v11); } free(a5); if ( !v5 &amp;&amp; v11 ) sub_7CF34(env, v11, &amp;byte_83ED7); return v5; }</span></span></code> </pre> <br>    ,       ,       .      10601. <br><br>    ,       : <i>command / 10000</i> , <i>command % 10000 / 100</i>  <i>command % 10</i> , . .,   , 1, 6  1.   ,     <i>JNIEnv</i>  ,  ,      .      (  N1, N2  N3)   . <br><br>  : <br><br><img src="https://habrastorage.org/webt/xg/jk/l1/xgjkl1uhzmibo-nhmha3kpivf5a.png"><br><br>     <i>JNI_OnLoad</i> . <br>      .        .  â€”   .    ,       ,    ,       (   ,        ). <br><br><h3 style=";text-align:right;direction:rtl">   </h3><br>    ,    : 0x5F1AC.    :  UC Browser      . <br><br>     ,     Java-,  <br>     0x4D070.         . <br><br>   R7  R4  : <br><br><img src="https://habrastorage.org/webt/7i/fx/86/7ifx86mr4yph41jsxukpjqvxmfa.png"><br><br>     R11: <br><br><img src="https://habrastorage.org/webt/fa/62/6j/fa626jaylcaaewtslff_-byaseo.jpeg"><br><br>     ,  : <br><br><img src="https://habrastorage.org/webt/co/rk/s1/corks1o2dp75elfvdsxjimrohuo.png"><br><br>        ,   R4.   230 . <br><br>  Ù…Ø§Ø°Ø§ ØªÙØ¹Ù„ Ø­ÙŠØ§Ù„ Ø°Ù„ÙƒØŸ   IDA,    switch: Edit -&gt; Other -&gt; Specify switch idiom. <br><br><img src="https://habrastorage.org/webt/36/uu/xn/36uuxnabf3xesptr8qisxzzfutk.jpeg"><br><br>   . ,    ,        <i>sub_6115C</i> : <br><br><img src="https://habrastorage.org/webt/-d/pt/3a/-dpt3akb_yckinmdheczkktzlem.jpeg"><br><br>   switch,    case 3      RC4.           ,   <i>doCommandNative</i> . ,      <i>magicInt</i>   16.   case â€“      ,     . <br><br><img src="https://habrastorage.org/webt/rn/_1/i4/rn_1i4avl8oki83hslk5u19ygoe.jpeg"><br><br>  AES! <br><br>  ,    : ,  , ,   (       AES).      -    <i>sub_6115C</i> ,       ,     ,        . <br><br><h3 style=";text-align:right;direction:rtl">  </h3><br>          ,   Android Studio,   ,       ,     ,    ,    ,   . <br><br>         UC Browser  Â«Â». ,         ,       .   :) ,       ,      , .           .    . <br><br>  : <br><br><img src="https://habrastorage.org/webt/hy/lk/qr/hylkqrhqgyei6qjdj6ayvgivpqu.jpeg"><br><br>   ARM        R0-R3, ,    â€”  .   LR   .      ,      ,     .     ,      ,   PUSH.W {R0-R10,LR}.  R7      ,    . <br><br>    <i>fopen</i>   <i>/data/local/tmp/aes</i>   Â«abÂ», <br> . .  .  R0    ,  R1 â€”     .     ,     .    ,           ,      . <br><br><img src="https://habrastorage.org/webt/68/ss/kf/68sskfcymjorl_flpf8mg9wwej4.png"><br><br>  <i>fopen</i> . <br><br>     <i>aes</i>   <i>int</i> .         ,     <i>fwrite</i>    . <br><br><img src="https://habrastorage.org/webt/d1/yt/iz/d1ytiz_jx7byflntqxxec2nece0.jpeg"><br><br>      ,          ,     . <br><br><img src="https://habrastorage.org/webt/me/vy/kz/mevykztpkcwdr6xkpnenauxqccs.jpeg"><br><br>    ,        <i>aes</i> . <br><br>  APK   , ,   /, . ,    ,     .       ,       .    - ,       .   ,  UC Browser    ,     ,  ,     :    onCreate  . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> const/16 v1, 0x62 new-array v1, v1, [B fill-array-data v1, :encrypted_data const/16 v0, 0x1f invoke-static {v0, v1}, Lcom/uc/browser/core/d/c/g;-&gt;j(I[B)[B move-result-object v1 array-length v2, v1 invoke-static {v2}, Ljava/lang/String;-&gt;valueOf(I)Ljava/lang/String; move-result-object v2 const-string v0, "ololo" invoke-static {v0, v2}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I</code> </pre> <br> , , , .  NullPointerException, . .   null. <br><br>        ,     : Â«META-INF/Â»  ".RSA". ,    .      .   ,    ,   ,      .     ,   Â«META-INF/Â»  Â«BLABLINF/Â»,       APK     . <br><br> , , , .  Ø§Ù„Ø¨Ù†ØºÙˆ!   ! <br><br><h3 style=";text-align:right;direction:rtl"> MitM </h3><br>      ,  .       CBC. <br><br><img src="https://habrastorage.org/webt/9k/m7/un/9km7unymy_ybx1lwnflfbqd36ke.png"><br><br>  URL , -   MD5, Â«extract_unzipsizeÂ»  . : MD5  ,    .        .  ,     ,   Intent      Â«PWNED!Â».      : <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i>    .    MD5 (    ),       . <br><br>      ,    . , - <br>   .       ,      : <br><br><img src="https://habrastorage.org/webt/e2/-v/ua/e2-vuahng86h0bt0vm84f3xhqrg.png"><br><br>    LEB128.        ,   ,    ,      . <br><br>   â€¦  â€“ ! :)   . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://www.youtube.com/watch?v=Nfns7uH03J8</a> <br><br><h3 style=";text-align:right;direction:rtl">     </h3><br>           UC Browser,      .       ,      .   â€”    ,         ,      ,   . <br><br>     UC Browser      ,       ,   -     .             .       ,  ,  ,   . 27   <br>    UC Browser 12.10.9.1193,      HTTPS: <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i> . <br><br>  ,  Â«Â»          PDF         Â«, -   !Â».       PDF  ,      ,            Google Play. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar451936/">https://habr.com/ru/post/ar451936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar451926/index.html">Ø­ÙˆÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¨Ø¹Ø¯ 130 ØªØ¯ÙÙ‚Ø§Øª</a></li>
<li><a href="../ar451928/index.html">ÙƒÙŠÙÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ÙˆÙŠØ¨ Ø¹Ù„Ù‰ ØµÙØ­Ø§Øª AMP</a></li>
<li><a href="../ar451930/index.html">Ø£ØªÙ…ØªØ© Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø¯Ø±Ø¬</a></li>
<li><a href="../ar451932/index.html">ÙŠÙˆÙ… 9: Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙƒÙ… ÙÙŠ Ù‚Ø³Ù… Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø¢Ù…Ù†Ø©</a></li>
<li><a href="../ar451934/index.html">Ø£Ù„ÙƒØ³Ø§Ù†Ø¯Ø± Ù„Ø§Ù…Ø¯Ù†: "Ø£ÙŠ Ù‚Ø·Ø¹Ø© Ù…Ù† Ø§Ù„Ø­Ø¯ÙŠØ¯ Ù„Ù‡Ø§ Ø´Ø®ØµÙŠØ©"</a></li>
<li><a href="../ar451938/index.html">Ø§Ù„Ø°Ù‡Ø§Ø¨ ÙÙ‡Ø§Ø±Ø³ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù†Ù‚Ø·ÙŠØ©: Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¨Ø±ÙŠØ©</a></li>
<li><a href="../ar451942/index.html">ÙƒÙŠÙ ØªÙ†Ù‚Ø° Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª Ø¨Ø¯ÙˆÙ† Ø·ÙŠØ§Ø± ÙÙŠ Ø¥ÙØ±ÙŠÙ‚ÙŠØ§ Ø­ÙŠØ§Ø© Ø§Ù„Ø¢Ù„Ø§Ù</a></li>
<li><a href="../ar451944/index.html">2019: Ø¹Ø§Ù… DEX (Ø§Ù„ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ù„Ø§Ù…Ø±ÙƒØ²ÙŠ)</a></li>
<li><a href="../ar451948/index.html">Ù‚ØµØ© Ø§Ù„Ø®Ø±Ø§Ø·ÙŠØ´ Ø§Ù„Ø«Ù„Ø§Ø«Ø©</a></li>
<li><a href="../ar451950/index.html">Ù…Ø­Ø·Ø§Øª ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø¥Ø¯Ø§Ø±Ø© Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø·Ø§Ù‚Ø© "Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡"ØŸ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>