<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêá üë®üèæ‚Äçüè´ üë®üèº‚Äçüåæ Crear fondos de pantalla animados de Android üë©üèº‚Äçüöí üí® üóùÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Necesito mostrar en la pantalla del tel√©fono informaci√≥n t√©cnica sobre su condici√≥n, m√°s precisamente, sobre su condici√≥n en el grupo de prueba. Siemp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Crear fondos de pantalla animados de Android</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460951/"><p>  Necesito mostrar en la pantalla del tel√©fono informaci√≥n t√©cnica sobre su condici√≥n, m√°s precisamente, sobre su condici√≥n en el grupo de prueba.  Siempre quiero ver esta informaci√≥n, es decir, en la pantalla de inicio y sin movimientos corporales adicionales. </p><br><p>  Solo hay dos formas que no afectar√°n la ejecuci√≥n de otras aplicaciones: Widget o Live wallpaper.  Eleg√≠ Live wallpaper, tambi√©n son "fondos de pantalla en vivo", ya que autom√°ticamente llegan a todas las p√°ginas de la pantalla de inicio, e incluso a la pantalla de bloqueo.  Este art√≠culo proporciona consejos pr√°cticos sobre c√≥mo crear fondos de pantalla en vivo. </p><a name="habracut"></a><br><h3 id="v-poiskah-pravdy">  En busca de la verdad </h3><br><p>  Documentaci√≥n sobre el gato "live wallpaper" llor√≥.  Desde el primer (y √∫nico) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">anuncio en el blog</a> que ocurri√≥ hace m√°s de 9 a√±os, Google no ha hecho un solo ejemplo inteligible o codelab sobre este tema.  Ten√≠a que entenderlo. </p><br><p>  Primeros fundamentos.  La mec√°nica interna de Android es tal que solo podemos instalar la aplicaci√≥n en el dispositivo, y el dispositivo de todas las aplicaciones es el mismo.  Dado que "fondo de pantalla en vivo" tambi√©n es una aplicaci√≥n, la elecci√≥n de un componente de control no es excelente, y debemos esperar que sea Servicio.  Encontrarlo es f√°cil: es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WallpaperService</a> . </p><br><p>  Puede haber varias instancias de "fondo de pantalla en vivo", y su ciclo de vida ser√° diferente al de Actividad o Vista.  En consecuencia, deber√≠a haber una clase base m√°s.  Este es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WallpaperService.Engine</a> (¬°y es necesariamente <em>interno</em> para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WallpaperService</a> !).  Si observa de cerca, resultar√° ser el mismo proveedor de eventos del ciclo de vida que Actividad, Servicio y otros similares. </p><br><p>  El ciclo de vida del "fondo de pantalla animado" se ve as√≠: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onCreate (SurfaceHolder surfaceHolder)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onSurfaceCreated (titular de SurfaceHolder)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onSurfaceChanged (soporte SurfaceHolder, formato int, ancho int, altura int)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onVisibilityChanged (boolean visible)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onSurfaceRedrawNeeded (titular de SurfaceHolder)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onSurfaceDestroyed (soporte SurfaceHolder)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onDestroy ()</a> </p><br><p>  De esta lista queda claro cu√°ndo puede / necesita volver a dibujar la imagen (o comenzar a volver a dibujarla si tiene animaci√≥n), y cu√°ndo es el momento de detener toda actividad y no gastar bater√≠a. </p><br><p> El m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onSurfaceRedrawNeeded ()</a> se destaca del resto, lea a continuaci√≥n.  Tambi√©n hay un m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">isVisible ()</a> para ayudar (que en Kotlin se convierte en la propiedad <code>isVisible</code> ). </p><br><p>  Ahora puedes construir este constructor.  Comenzar√© desde el final. </p><br><h3 id="risuem">  Dibujar </h3><br><p>  Tendremos que dibujar sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lienzo</a> , no tendremos ning√∫n dise√±o e inflador.  C√≥mo obtener <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Canvas</a> desde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SurfaceHolder</a> y c√≥mo dibujarlo est√° m√°s all√° del alcance de este art√≠culo, hay un ejemplo simple a continuaci√≥n. </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dummyDraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Canvas</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { c.save() c.drawColor(Color.CYAN) c.restore() } <span class="hljs-comment"><span class="hljs-comment">// surfaceHolder property is actually a call to the getSurfaceHolder() method fun drawSynchronously() = drawSynchronously(surfaceHolder) fun drawSynchronously(holder: SurfaceHolder) { if (!isVisible) return var c: Canvas? = null try { c = holder.lockCanvas() c?.let { dummyDraw(it) } } finally { c?.let { holder.unlockCanvasAndPost(it) } } }</span></span></code> </pre><br><h3 id="metody-zhiznennogo-cikla-engine">  M√©todos del ciclo de vida del motor </h3><br><p>  Todos los m√©todos de ciclo de vida excepto <code>onSurfaceRedrawNeeded</code> no requieren un <code>onSurfaceRedrawNeeded</code> inmediato.  Por lo tanto, un buen tono ser√≠a volver a dibujar la cola. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceCreated(holder) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, format: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, width: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, height: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceChanged(holder, format, width, height) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onVisibilityChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(visible: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onVisibilityChanged(visible) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceDestroyed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceDestroyed(holder) redrawHandler.omitRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onDestroy() redrawHandler.omitRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceRedrawNeeded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceRedrawNeeded(holder) redrawHandler.omitRedraw() drawSynchronously(holder) <span class="hljs-comment"><span class="hljs-comment">// do it immediately, don't plan }</span></span></code> </pre> <br><p>  Preste atenci√≥n a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">onSurfaceRedrawNeeded</a> , que nos llama a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la devoluci√≥n de llamada SurfaceHolder del mismo nombre</a> , que ocurre al cambiar el tama√±o y eventos similares.  Esta devoluci√≥n de llamada le permite volver a dibujar inmediatamente, sin permitir que el usuario muestre la imagen anterior (y ya incorrecta).  El sistema garantiza que hasta que se produzca un retorno de este m√©todo, la salida a la pantalla se pausar√°. </p><br><h3 id="scheduler">  Programador </h3><br><p>  Me gusta redefinir Handler y no ejecutar Runnable en √©l.  En mi opini√≥n, muy elegante. </p><br><p>  En caso de que tenga animaci√≥n o actualizaciones peri√≥dicas, deber√° hacer una cola regular del mensaje ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">postAtTime ()</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">postDelayed ()</a> para ayudarlo).  Si los datos se actualizan espor√°dicamente, solo llame a <code>planRedraw()</code> para actualizarlos. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> redrawHandler = RedrawHandler() <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RedrawHandler</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Handler</span></span></span></span>(Looper.getMainLooper()) { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> redraw = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">omitRedraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { removeMessages(redraw) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">planRedraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { omitRedraw() sendEmptyMessage(redraw) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(msg: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Message</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (msg.what) { redraw -&gt; drawSynchronously() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.handleMessage(msg) } } }</code> </pre> <br><h3 id="service--engine">  Servicio y motor </h3><br><p>  Esta mareshka de Service and Engine se ensambla as√≠: </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooBarWallpaperService</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WallpaperService</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateEngine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = FooBarEngine() <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooBarEngine</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Engine</span></span></span></span>() { .... } }</code> </pre> <br><h3 id="androidmanifest-i-drugie-zaklinaniya">  AndroidManifest y otros hechizos </h3><br><p>  Llamo hechizos en el desarrollo de software que es imposible de entender, pero es necesario repetir exactamente. </p><br><p>  En <code>.../app/src/main/res/xml</code> debe haber un archivo XML con una descripci√≥n de "fondo de pantalla en vivo".  El nombre de este archivo debe especificarse en AndroidManifest (busque la palabra <code>foobarwallpaper</code> en el ejemplo a continuaci√≥n) </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wallpaper</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:thumbnail</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/some_drawable_preview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/wallpaper_description"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><p>  No pierda <code>permission</code> , <code>meta-data</code> y <code>intent-filter</code> en la descripci√≥n del Servicio: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".FooBarWallpaperService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Wallpaper Example"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_WALLPAPER"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.service.wallpaper"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/foobarwallpaper"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.service.wallpaper.WallpaperService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="kak-dobavit">  C√≥mo agregar </h3><br><p>  Los "fondos de pantalla en vivo" se esconden, por lo tanto, una pista.  Describo c√≥mo se ve en mi Samsung. </p><br><p>  Para comenzar, mantenga presionado en alg√∫n lugar de la pantalla de inicio, el tel√©fono entrar√° en el modo de configuraci√≥n del escritorio, aparecer√° el icono de <em>Fondos de pantalla</em> . </p><br><p>  Hacemos clic en el √≠cono <em>Fondos de pantalla</em> , varias secciones, necesitamos <em>Mis fondos de pantalla</em> , hacemos clic en la inscripci√≥n <em>Ver todo</em> en la esquina superior derecha de la secci√≥n, la lista se abre en pantalla completa. </p><br><p>  Presionamos los "tres puntos" de la llamada del men√∫, en √©l el <em>elemento de fondos de pantalla VIVOS</em> (tengo uno), aparece una lista de "fondos de <em>pantalla animados</em> " disponibles. </p><br><p>  Seleccione nuestro fondo de pantalla y seleccione "Pantalla de inicio y bloqueo". </p><br><p>  Aparecer√° una "vista previa", que ya est√° siendo dibujada por nuestra aplicaci√≥n (para reconocer este momento, existe el m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">isPreview ()</a> ), haga clic en <em>Establecer como fondo de pantalla</em> ... Y no vemos nada, porque volvemos a la lista de fondos de pantalla disponibles. </p><br><p>  Haz clic en "Inicio" y disfruta. </p><br><h3 id="prichem-tut-android-watch">  ¬øY luego Android Watch? </h3><br><p>  Una observaci√≥n interesante en el camino es que las caras en Android Watch se hacen exactamente de la misma manera (con la precisi√≥n de que tienen sus propias clases base con su propia implementaci√≥n): el mismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Servicio + Motor</a> , casi los mismos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">metadatos y filtro de intenci√≥n para el Servicio en el manifiesto</a> (en que la palabra fondo de pantalla aparece cuatro veces :), tambi√©n debe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escribir su propio sheduler basado en Handler</a> . </p><br><p>  En las clases base de <em>Watch Faces</em> hay un <code>onDraw()</code> listo para <code>onDraw()</code> , a donde se pasa Canvas y hay <code>invalidate()</code> para llamarlo.  Pero esta no es una diferencia fundamental, sino la parte implementada de la repetitiva. </p><br><p>  A diferencia de Live Wallpaper, hay ejemplos de Watch Faces, puede profundizar en ellos (enlaces <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> , al principio). </p><br><h3 id="chto-poluchilos">  Que paso </h3><br><p>  Las capturas de pantalla de una aplicaci√≥n que pinta una pantalla verde no tienen mucho sentido.  Pero un par de fotos que se basaron en esto se hicieron para el puesto de combate, debajo del spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">Un par de fotos</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/a8/6z/jf/a86zjfmyavmfyyhpwsm6fhi6hau.jpeg"><br><img src="https://habrastorage.org/webt/h8/cu/1-/h8cu1-cyot8nvehv6srjhc03xuk.jpeg"></p><br><p>  Las pegatinas son el sistema de detecci√≥n de problemas restante de la generaci√≥n anterior. </p></div></div><br><h3 id="blagodarnosti">  Agradecimientos </h3><br><p>  Si no fuera por estos dos art√≠culos, habr√≠a vagado en la oscuridad mucho m√°s tiempo.  ¬°No puedo imaginar c√≥mo podr√≠an haberse escrito ya en 2010 con tanta documentaci√≥n de calidad? </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kirill Grouchnikov, fondos de pantalla animados</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Vogella, Android Live Wallpaper - Tutorial</a> </p><br><h3 id="ishodniki">  C√≥digo fuente </h3><br><p>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460951/">https://habr.com/ru/post/460951/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460941/index.html">Compromiso de correo electr√≥nico comercial: no hay defensa contra el ataque</a></li>
<li><a href="../460943/index.html">C√≥mo elegir claves prometedoras para SEO basadas en pron√≥sticos de escenarios en Google Data Studio (+ plantilla)</a></li>
<li><a href="../460945/index.html">Experiencia en el uso de un canal de telegramas para aumentar el reconocimiento y el crecimiento de los ingresos de un estudio de juegos.</a></li>
<li><a href="../460947/index.html">WASM Meet Up 1/08</a></li>
<li><a href="../460949/index.html">"Y lo imposible es posible": convertimos un cuadro negro en blanco mediante an√°lisis binario</a></li>
<li><a href="../460953/index.html">Los punteros son complejos, ¬øo qu√© se almacena en un byte?</a></li>
<li><a href="../460955/index.html">Programa educativo para pasar par√°metros por valor a constructores y setters (C ++ moderno, ejemplos)</a></li>
<li><a href="../460959/index.html">La nueva tecnolog√≠a de Microsoft permite que las copias en 3D de una persona real hablen cualquier idioma</a></li>
<li><a href="../460961/index.html">Configuraci√≥n de pruebas unitarias en proyectos mixtos Swift + Objective-C</a></li>
<li><a href="../460965/index.html">Controlador dividido sin estos tus guiones gr√°ficos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>