<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇🏼 🧒🏽 🛫 Identification des adresses IP réelles des utilisateurs du réseau Tor via un cache déformé ⤵️ ♊️ 🍘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article décrit un exemple de l'application pratique de l'attaque «cache distortion through 301 redirect», qui peut être utilisée par le nœud de so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Identification des adresses IP réelles des utilisateurs du réseau Tor via un cache déformé</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vds/blog/456896/"><img src="https://habrastorage.org/getpro/habr/post_images/e0e/20c/130/e0e20c13066a38bd4c0c81d1d60de6db.jpg" alt="image"><br><br>  Cet article décrit un exemple de l'application pratique de l'attaque «cache distortion through 301 redirect», qui peut être utilisée par le nœud de sortie du réseau Tor avec un code malveillant pour identifier les adresses IP réelles des utilisateurs sélectionnés. <br><a name="habracut"></a><br><h4>  Scénario d'attaque </h4><br>  Le scénario d'attaque est le suivant: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://player.vimeo.com/video/337756409" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><ul><li>  Client: Chrome Canary (76.0.3796.0) </li><li>  IP client réel: 5.60.164.177 </li><li>  Paramètre de suivi client: 6b48c94a-cf58-452c-bc50-96bace981b27 </li><li>  Adresse IP du nœud de sortie du réseau Tor: 51.38.150.126 </li><li>  Transparent Reverse Proxy: tor.modlishka.io (Modlishka - code mis à jour à paraître.) </li></ul><br>  Remarque: dans ce scénario, le navigateur Chrome a été configuré via le protocole réseau SOCKS5 pour utiliser le réseau Tor.  Le canal Tor a été réglé sur un nœud de sortie de test spécifique: '51 .38.150.126 '.  C'est aussi une validation du concept et de nombreux réglages pourront être optimisés à l'avenir ... <br><br>  Dans le cas d'un nœud de sortie malveillant du réseau Tor, tout le trafic est redirigé via le serveur proxy Modlishka: <br><br><pre><code class="bash hljs">iptables -A OUTPUT -p tcp -m tcp --dport 80 -j DNAT --to-destination ip_address:80 iptables -A FORWARD -j ACCEPT</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://player.vimeo.com/video/339586722" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  Description du scénario d'attaque </h4><br>  Hypothèses: <br><br><ul><li>  Une application de navigateur (dans ce cas, un navigateur standard) qui utilisera la connexion réseau «Tor» et, enfin, la connexion passera par un nœud de sortie malveillant. </li><li>  Le nœud de sortie malveillant du réseau Tor, qui intercepte et déforme le cache de tout le trafic HTTP (code de réponse "HTTP 301"), qui n'a pas de protocole cryptographique de sécurité de la couche transport ("TLS"). </li></ul><br><img src="https://habrastorage.org/webt/4b/kl/6d/4bkl6damygrn1rnfce9fxujbeny.png"><br><br>  Examinons les étapes suivantes d'un scénario d'attaque: <br><br><ol><li>  L'utilisateur se connecte à Internet via le réseau Tor en configurant le navigateur pour utiliser le protocole réseau SOCKS5 du système Tor, ou en configurant de manière à ce que tout le trafic du système d'exploitation soit redirigé via le réseau Tor. </li><li>  L'utilisateur commence sa session d'accès Internet normale avec son navigateur préféré, où généralement beaucoup de trafic HTTP sans le protocole de sécurité TLS est envoyé via le tunnel du réseau Tor. </li><li>  Le nœud de sortie malveillant du réseau Tor intercepte les demandes et répond en les transmettant à l'aide du code de réponse HTTP 301.  Ces redirections seront constamment mises en cache par le navigateur et seront envoyées à l'URL de suivi avec l'identifiant client Tor attribué.  L'URL de suivi peut être créée de la manière suivante: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">user-identifier.evil.tld</a> , où 'evil.tld' collectera toutes les informations sur l'adresse IP source et redirigera les utilisateurs vers les hôtes demandés à l'origine ... ou, alternativement, vers l'inverse transparent un serveur proxy qui tentera d'intercepter tous les flux ultérieurs de trafic client HTTP.  De plus, puisqu'il est possible de déformer automatiquement le cache pour la plupart des domaines les plus populaires (comme décrit dans un article précédent), par ex.  Top 100 des sites selon les statistiques de la société «Alexa», l'attaquant maximise ses chances d'identifier de vraies adresses IP. </li><li>  Après avoir quitté la session réseau Tor, l'utilisateur basculera sur son réseau normal. </li><li>  Dès que l'utilisateur entre l'adresse de l'un des domaines déformés précédents dans la barre d'adresse (par exemple, "google.com"), le navigateur utilise le cache pour la redirection interne vers l'URL de suivi avec l'identifiant de contexte du nœud de sortie. </li><li>  L'hôte de sortie pourra faire correspondre la demande HTTP précédemment interceptée avec la véritable adresse IP de l'utilisateur à l'aide des informations reçues d'un hôte externe qui a utilisé l'URL de suivi avec l'ID utilisateur.  L'hôte evil.tld aura des informations sur toutes les adresses IP qui ont été utilisées pour accéder à l'URL de suivi. </li></ol><br>  De toute évidence, cette méthode vous permet de faire correspondre efficacement les demandes HTTP sélectionnées avec les adresses IP des clients en utilisant le nœud de sortie du réseau Tor.  Cela se produit car l'URL de suivi précédemment générée sera demandée par le client via le tunnel réseau «Tor», puis à nouveau, dès que la connexion sera établie via la connexion standard du fournisseur Internet.  Tout cela à cause du code tronqué dans le cache. <br><br>  Une autre approche peut être basée sur l'introduction d'un code JavaScript modifié avec des URL intégrées pour le suivi dans les réponses appropriées qui n'ont pas le protocole de sécurité TLS et la modification des en-têtes de cache de contrôle nécessaires (par exemple, 'Cache-Control: max-age = 31536000') .  Cependant, cette approche n'est pas très efficace. <br><br>  Le suivi des utilisateurs via les cookies standard de diverses applications Web est également possible, mais il est très difficile d'amener le client à visiter le domaine sous le contrôle de l'attaquant deux fois: d'abord lors de la connexion via le nœud de sortie du réseau Tor, puis à nouveau après le passage à la connexion Internet standard fournisseur. <br><br><h4>  Conclusions </h4><br>  Le fait est qu'un attaquant a la possibilité de réaliser certains changements dans le cache du navigateur en injectant du code mal formé via des nœuds de sortie malveillants et en détectant les adresses IP réelles des utilisateurs de Tor qui envoient du trafic HTTP sans le protocole de sécurité TLS. <br><br>  De plus, la distorsion d'un nombre important de noms de domaine populaires augmentera la probabilité de recevoir une réponse inverse d'une requête HTTP (avec un ID utilisateur attribué), qui déterminera la véritable adresse IP de l'utilisateur.  Vous pouvez essayer d'intercepter le domaine de certains clients du navigateur et espérer qu'une faute de frappe dans le nom de domaine ne sera pas remarquée par l'utilisateur ou ne s'affichera pas (par exemple, l'application mobile «WebViews»). <br><br>  Façons de réduire les risques: <br><br><ul><li>  Lors de la connexion à Internet via le réseau Tor, assurez-vous que tout le trafic qui n'utilise pas le protocole de sécurité TLS est désactivé.  Un exemple de plugins de navigateur utilisables: pour les navigateurs Firefox »et« Chrome ». </li><li>  De plus, utilisez toujours le mode navigateur «privé» lorsque vous vous connectez à Internet via le réseau Tor. </li><li>  Ne redirigez pas le trafic vers l'ensemble de votre système d'exploitation via le réseau Tor tant que vous n'êtes pas sûr que tout le trafic sortant utilise le protocole de sécurité TLS ... </li><li>  Dans la mesure du possible, utilisez la dernière version du navigateur Tor pour naviguer sur le Web. </li></ul><br><hr><br>  Les dernières configurations à double processeur de serveurs dédiés avec les processeurs évolutifs Intel 2019 sont disponibles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>DEDIC.SH</b></a> : <br><br><ul><li>  2x Xeon Silver 4214 - un total de 24 cœurs </li><li>  2x Xeon Gold 5218 - un total de 32 cœurs </li><li>  2x Xeon Gold 6240 - configuration avec 36 cœurs. </li></ul><br>  Le coût d'un serveur avec deux Xeon Silver 4214 - à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>partir de 15210 roubles / mois</b></a> <br>  Nous sommes également prêts à collecter <b>toute configuration</b> pour vous - <b><a href="">écrivez-nous</a></b> ! <br><br>  Si de grandes puissances d'un serveur dédié ne sont pas nécessaires - <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VDS à partir de 150 roubles / mois</a></b> est ce dont vous avez besoin! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456896/">https://habr.com/ru/post/fr456896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456886/index.html">Liste de contrôle ASO: comment ne rien manquer</a></li>
<li><a href="../fr456888/index.html">Comment les satellites fondent dans l'atmosphère terrestre</a></li>
<li><a href="../fr456890/index.html">Télécommande IR sur stm32</a></li>
<li><a href="../fr456892/index.html">Comment rechercher les vulnérabilités des applications Web: comparer huit scanners populaires</a></li>
<li><a href="../fr456894/index.html">Docker et authentification via Nginx</a></li>
<li><a href="../fr456898/index.html">Multiplication rapide d'entiers à l'aide de tables</a></li>
<li><a href="../fr456902/index.html">Notifications push sécurisées: de la théorie à la pratique</a></li>
<li><a href="../fr456904/index.html">Test de charge d'un projet Web - pas d'argent</a></li>
<li><a href="../fr456908/index.html">Comment Telegram vous fusionne avec Rostelecom</a></li>
<li><a href="../fr456910/index.html">Internet project security.txt - apprendre à connaître un autre fichier bien connu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>