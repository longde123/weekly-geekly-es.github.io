<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐จ๐ฝโ๐ณ โฑ๏ธ ๐ฉ๐ผโ๐ค ููุงุฐุง ูุญุชุงุฌ ูุชุฑุงูุญ ูู C ++ 20 ูู ูุณุงุฑุฉ ุจุณูุทุฉุ โฌ๏ธ ๐ง๐ฝ ๐ช๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ุชูุช ููุงูุดุฉ ุงููุทุงูุงุช ุงูุชู ูุฌุจ ุชุถููููุง ูู ูุนูุงุฑ C ++ 20 ูุซูุฑูุง ุ ุจูุง ูู ุฐูู ุนูู Habrรฉ ( ูุซุงู ุญูุซ ุชูุฌุฏ ุงูุนุฏูุฏ ูู ุงูุฃูุซูุฉ ). ููุงู ูุง ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุงุฐุง ูุญุชุงุฌ ูุชุฑุงูุญ ูู C ++ 20 ูู ูุณุงุฑุฉ ุจุณูุทุฉุ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473844/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ุชูุช <em>ููุงูุดุฉ</em> ุงููุทุงูุงุช ุงูุชู ูุฌุจ ุชุถููููุง ูู ูุนูุงุฑ C ++ 20 ูุซูุฑูุง ุ ุจูุง ูู ุฐูู ุนูู Habrรฉ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงู ุญูุซ ุชูุฌุฏ ุงูุนุฏูุฏ ูู ุงูุฃูุซูุฉ</a> ).  ููุงู ูุง ูููู ูู ุงูููุงุฏ ููุชุฑุงุช ุ ูููููู ุฐูู </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ูุฌุฑุฏุฉ ููุบุงูุฉ ูุชุญุชุงุฌ ููุท ูุฑูุฒ ูุฌุฑุฏุฉ ููุบุงูุฉ </li><li style=";text-align:right;direction:rtl">  ูุฑุงุกุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุนูู ูุฒุฏุงุฏ ุณูุกูุง ููุท </li><li style=";text-align:right;direction:rtl">  ูุชุฑุงุช ุชุจุทุฆ ุฑูุฒ </li></ul><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุฑู ุชูุงูุง <del>  ุงูุนูุงู ูุงูููุงุญูู </del>  ูููุฉ ุนูููุฉ ุ ูู ุฃุฌู ููู ูุง ุฅุฐุง ูุงูุช ูุฐู ุงูุงูุชูุงุฏุงุช ุตุญูุญุฉ <del>  ููู ุตุญูุญ ุฃู ุฅุฑูู ููุจูุฑ ูุฏ ุชุนุฑุถ ููุนุถ ูู ูุจู ุจุงุฑุชูุด ููููุณูู ูููุชุจ ุงููุฏู 3 ููุท ูุน ุงูุชูุงู ุงูููุฑ </del>  . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pb/dt/ih/pbdtihbl4gn8qiqwr5uk_j8qi0a.png" alt="kdpv"></p><br><p style=";text-align:right;direction:rtl">  ุณูููู ุจุฏูุฌ ุงููุธููุฉ ุงูุชุงููุฉ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุดุจู ููุญุฑู: <math> </math> $ inline $ f (t) = 3 t ^ 2 \ sin t ^ 3 $ inline $   ุชุชุฑุงูุญ ูู ุตูุฑ ุฅูู <math> </math> $ inline $ \ tau $ inline $   .  ุฅุฐุง <math> </math> $ inline $ \ tau ^ 3 / \ pi $ inline $   ูุณุงูู ุนุฏุฏ ูุฑุฏู ุ ุซู ุงูุชูุงูู ูู 2. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl"> ูุฐูู ุ ุงููุดููุฉ: ููุชุจ ูููุฐุฌูุง ุฃููููุง ููุฏุงูุฉ ุงูุชู ุชุญุณุจ ุงูุชูุงูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุงุณุทุฉ ุทุฑููุฉ ุดุจู ุงูููุญุฑู</a> .  ูุจุฏู ุ ูููููุฉ ุงูุฃููู ุ ุฃู ููุงู ุญุงุฌุฉ ุฅูู ุงูุชุฌุฑูุฏ ููุง ุ ูููู ุงูุณุฑุนุฉ ูููุฉ.  ูู ุงููุงูุน ุ ูุฐุง ููุณ ุตุญูุญุง ุชูุงูุง.  ุจุงููุณุจุฉ ููุนูู ุ ุบุงูุจูุง ูุง ูุฌุจ ุนููู ูุชุงุจุฉ "ูุณุงุฑุงุช ุงูุฃุฑูุงู" ุ ุงููุณุชุฎุฏู ุงูุฑุฆูุณู ูู ููุณู.  ูุฐูู ูุฌุจ ุนูู ุฃูุถูุง ุฏุนู ุงูุฃุฎุทุงุก ูุงูุชุนุงูู ูุนูุง (ูุณูุก ุงูุญุธ ุฒููุงุฆู - ููุณ ููุท ุฃูุง ุฏุงุฆููุง).  ููุญุฏุซ ุฃูุถูุง ุฃู ุจุนุถ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุง ูุชู ุงุณุชุฎุฏุงููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุฏุฉ ุนุงู ุ ุซู ... ุจุดูู ุนุงู ุ ููุฒู ุฃูุถูุง ูุชุงุจุฉ ุงููุซุงุฆู ูุงูุงุฎุชุจุงุฑุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุง ูู ุงูุญุฌุฌ ุงูุชู ูุฌุจ ุฃู ุชุญุชูู ุนูููุง ูุธููุฉ ุงูุชูุงููุ  ูุธููุฉ ูุชูุงููุฉ ูุดุจูุฉ (ูุฌููุนุฉ ูู ุงูููุงุท <math> </math> $ inline $ t_1 ุ t_2 ุ t_3 ... $ inline $  ุชุณุชุฎุฏู ูุญุณุงุจ ูุง ูุชุฌุฒุฃ).  ูุฅุฐุง ูุงู ูู ุดูุก ูุงุถุญูุง ูุน ุงููุธููุฉ ุงููุฏูุฌุฉ (ุณุชููู <code>std::function</code> ููุง ููุท) ุ ููุง ุงูุดูู ุงูุฐู ููุจุบู ุฃู ุชูุชูู ุจู ุงูุดุจูุฉุ  ููุฑู. </p><br><h2 id="varianty" style=";text-align:right;direction:rtl">  ุฎูุงุฑุงุช </h2><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก - ุจุญูุซ ูููู ููุงู ุดูุก ูููู ููุงุฑูุชู ุจุงูุฃุฏุงุก - ุณูููู ุจูุชุงุจุฉ ุญููุฉ ุจุณูุทุฉ ุจุฎุทูุฉ ุฒูููุฉ ุซุงุจุชุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// trapezoidal rule of integration with fixed time step; // dt_fixed is the timestep; n_fixed is the number of steps double integrate() { double acc = 0; for(long long i = 1; i &lt; n_fixed - 1; ++i) { double t = dt_fixed * static_cast&lt;double&gt;(i); acc += dt_fixed * f(t); } acc += 0.5 * dt_fixed * f(0); acc += 0.5 * dt_fixed * f(tau); return acc; }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงุณุชุฎุฏุงู ูุฐู ุงูุฏูุฑุฉ ุ ููููู ุชูุฑูุฑ ุงููุณูุทุงุช ุฅูู ุงูุฏุงูุฉ ุจุฏุงูุฉ ูููุงูุฉ ุงููุงุตู ุงูุฒููู ููุชูุงูู ุ ููุฐูู ุนุฏุฏ ุงูููุงุท ููุฐุง ุงูุชูุงูู ููุณู.  ุชููู - ูุญุฏุซ ุฃุณููุจ ุดุจู ุงูููุญุฑู ุฃูุถูุง ุจุฎุทูุฉ ูุชุบูุฑุฉ ุ ูุชุทูุจ ูุธููุชูุง ุงููุงุจูุฉ ููุชูุงูู ุจุจุณุงุทุฉ ุงุณุชุฎุฏุงู ุฎุทูุฉ ูุชุบูุฑุฉ!  ููููู ุฐูู ุ ูููุญุตู ุนูู ูุนููุฉ ุฃุฎุฑู ( <math> </math> $ ูุถููุฉ $ b $ ูุถููุฉ $   ) ููุชุญูู ูู "ุงููุงุฎุทูุฉ" ูุงูุณูุงุญ ูุฎุทูุงุชูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุง ููู: <math> </math> $ inline $ \ Delta t (t) = \ Delta t_0 + bt $ inline $   .  ุฑุจูุง ูุชู ุงุณุชุฎุฏุงู ูุฐุง ุงูููุฌ (ุฅุฏุฎุงู ูุนููุฉ ุฑูููุฉ ุฅุถุงููุฉ) ูู ููููู ููุงู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุจุฏู ุฃู ุนูุจู ูุฌุจ ุฃู ูููู ูุงุถุญูุง ููุฌููุน.  ูุฅุฐุง ูุงู ูุฏููุง ูุธููุฉ ูุฎุชููุฉุ  ูุฅุฐุง ููุง ุจุญุงุฌุฉ ุฅูู ุฎุทูุฉ ุตุบูุฑุฉ ูู ููุงู ูุง ูู ููุชุตู ุงููุงุตู ุงูุนุฏุฏู ูุฏููุงุ  ูููู ูุงุฐุง ูู ูุงูุช ูุธููุฉ ูุงุจูุฉ ููุชูุงูู ููุง ุนุฏุฉ ููุฒุงุชุ  ุจุดูู ุนุงู ุ ูุฌุจ ุฃู ูููู ูุงุฏุฑูู ุนูู ููู <em>ุฃู</em> ุดุจูุฉ.  (ููุน ุฐูู ุ ูู ุงูุฃูุซูุฉ ุ ุญุชู ุงูููุงูุฉ ุ ุณูู "ููุณู" ุทุฑููุฉ ุดุจู ููุญุฑู ุญููููุฉ ุ ูููุจุณุงุทุฉ ุ ุณููุธุฑ ูู ูุณุฎุชู ุจุฎุทูุฉ ุซุงุจุชุฉ ุ ูุน ูุฑุงุนุงุฉ ุฃู ุงูุดุจูุฉ ูููู ุฃู ุชููู ุชุนุณููุฉ). </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู ุงูุดุจูุฉ ูููู ุฃู ุชููู ููุฌูุฏุฉ ุ ููููู ููููุง <math> </math> $ inline $ t_1 ุ t_2 ุ ... $ inline $   ูููููุฉ ูู <code>std::vector</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// trapezoidal rule of integration with fixed time step double integrate(vector&lt;double&gt; t_nodes) { double acc = 0; for(auto t: t_nodes) { acc += dt_fixed * f(t); } acc -= 0.5 * dt_fixed * f(0); acc -= 0.5 * dt_fixed * f(tau); return acc; }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุงู ุฃูุซุฑ ูู ูุงููุฉ ูู ุงููุฌุชูุนุงุช ูู ูุฐุง ุงูููุฌ ุ ูููู ูุงุฐุง ุนู ุงูุฃุฏุงุกุ  ูุน ุงุณุชููุงู ุงูุฐุงูุฑุฉุ  ุฅุฐุง ุชู ุชูุฎูุต ูู ุดูุก ูู ููุช ุณุงุจู ุนูู ุงููุนุงูุฌ ุ ูุนูููุง ุงูุขู ุฃู ูููุฃ ููุทูุฉ ุงูุฐุงูุฑุฉ ุฃููุงู ุ ุซู ููุฑุฃ ูููุง.  ูุงูุชูุงุตู ูุน ุงูุฐุงูุฑุฉ ุดูุก ุจุทูุก ุฅูู ุญุฏ ูุง.  ูุงูุฐุงูุฑุฉ ูุง ุชุฒุงู ุบูุฑ ุงููุทุงุท ( <del>  ูุงูุณูููููู </del>  ). </p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ููุธุฑ ุฅูู ุฌุฐุฑ ุงููุดููุฉ.  ูุงุฐุง ูุญุชุงุฌ ุงูุดุฎุต ููููู ุณุนูุฏุงุ  ุจุชุนุจูุฑ ุฃุฏู ุ ูุง ุงูุฐู ุชุญุชุงุฌู ุฏูุฑุชูุง (ุงููุงุฆูุฉ ุนูู ุงููุทุงู ููุญููุฉ)ุ  ุฃู ุญุงููุฉ ุจูุง ูุชูุฑุฑุงุช start <code>begin()</code> ู <code>end()</code> ู <code>++</code> ู <code>*</code> ู <code>!=</code> ุนูุงูู ุชุดุบูู ููููุฑุฑุงุช.  ูุฐูู ุณูู ููุชุจ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,    ,      template &lt;typename T&gt; double integrate(T t_nodes) { double acc = 0; for(auto t: t_nodes) { acc += dt_fixed * f(t); } acc -= 0.5 * dt_fixed * f(0); acc -= 0.5 * dt_fixed * f(tau); return acc; } // ... //      class lazy_container { public: long long int n_nodes; lazy_container() { n_nodes = n_fixed; } ~lazy_container() {} class iterator { public: long long int i; // index of the current node iterator() { i = 0; } ~iterator() {} iterator&amp; operator++() { i+= 1; return *this; } // ! bool operator!=(const iterator&amp; rhs) const { return i != rhs.i; } double operator* () const { return dt_fixed * static_cast&lt;double&gt;(i); } }; iterator begin() { return iterator(); } iterator end() { iterator it; it.i = n_nodes; return it; } }; // ... //      lazy_container t_nodes; double res = integrate(t_nodes);</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ูุญุณุจ ูููุฉ ุฌุฏูุฏุฉ ููุง. <math> </math> $ inline $ t_i $ inline $   ุจูุงุก ุนูู ุงูุทูุจ ุ ููุง ูุนููุง ูู ุญููุฉ ุจุณูุทุฉ.  ูุง ุชูุฌุฏ ุฐุงูุฑุฉ ุงููุตูู ุ ููุคูู ุฃู ุงููุฌูุนูู ุงูุญุฏูุซุฉ ุณูู ุชุจุณูุท ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุจููุงุกุฉ ุนุงููุฉ.  ูู ุงูููุช ููุณู ุ ูู ูุชุบูุฑ ุฑูุฒ ุงูุฏุงูุฉ ุงููุฏูุฌุฉ ูุซูุฑูุง ุ ููุง ูุฒุงู ุจุฅููุงูู ูุถู <code>std::vector</code> . </p><br><p style=";text-align:right;direction:rtl">  ุฃูู ูู ุงููุฑููุฉุ  ูู ุงููุงูุน ุ ูููููุง ุงูุขู ูุชุงุจุฉ ุฃู ูุธููุฉ ูู ูุดุบู <code>++</code> .  ููุฐุง ูุนูู ุฃู ูุฐุง ุงูููุฌ ูุณูุญ ุ ูู ุงููุงูุน ุ ุจููู ูุธููุฉ ุจุฏูุงู ูู ูุนููุฉ ุฑูููุฉ ูุงุญุฏุฉ.  ูููู ุฃู ุชููู ุงูุดุจูุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุนูู ุงูุทุงูุฑ ููุฌูุฏุฉ ุ ููุญู ุฃูุถูุง (ุนูู ุงูุฃุฑุฌุญ) ูุง ูููุฏ ุงูุฃุฏุงุก.  ููุน ุฐูู ุ ูุฅู ูุชุงุจุฉ <code>lazy_container</code> ุฌุฏูุฏุฉ ูู ูู ูุฑุฉ ูุชุดููู ุงูุดุจูุฉ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุจุทุฑููุฉ ุฌุฏูุฏุฉ ูุง ุชุดุนุฑ ุจูุง ุนูู ุงูุฅุทูุงู (ุฅููุง 27 ุณุทุฑูุง!).  ุจุงูุทุจุน ุ ููููู ุฌุนู ุงููุธููุฉ ูุณุคููุฉ ุนู ุฅูุดุงุก ุงูุดุจูุฉ ููุนููุฉ ูุฏุงูุฉ ุงูุชูุงูู ุงูุฎุงุตุฉ ุจูุง ุ <code>lazy_container</code> ุฃูุถูุง ุ ุฃู ุ ุนููุงู ุ ูู <code>lazy_container</code> . </p><br><p style=";text-align:right;direction:rtl">  ุฃูุช ุชุณุฃู - ุซู ูู ุณูููู ููุงู ุฎุทุฃ ูุฑุฉ ุฃุฎุฑูุ  ูุนู!  ุฃููุงู ุ ุณูููู ูู ุงูุถุฑูุฑู ููู ุนุฏุฏ ููุงุท ุงูุชูุงูู ุจุดูู ูููุตู ุ ููุง ูุฏ ูุชุณุจุจ ูู ุญุฏูุซ ุฎุทุฃ.  ุซุงููุงู ุ ูุฌุจ ุฏุนู ุงูุฏุฑุงุฌุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ูุบูุฑ ุงูููุงุณูุฉ ููุฏ ูุชู ุชุทููุฑูุง ุจูุงุณุทุฉ ุดุฎุต ูุง.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ููููู ุฃู ุชุชุฎูู ุนูู ุงูููุฑ ููู ุ ูู ุฎูุงู ูุฐุง ุงูููุฌ ุ ุฃู ุชุคูู ููุฌูุนูุง ูููุธุงุฆู ูู ูุดุบู <code>++</code> ุ </p><br><p style=";text-align:right;direction:rtl">  C ++ ูุฃูุซุฑ ูู 30 ุณูุฉ.  ุงูุนุฏูุฏ ูู ุงูุฃุทูุงู ูู ูุฐู ุงูุณู ูุฏููู ุฃุทูุงู ุจุงููุนู ุ ููุง ูุญุชูู C ++ ุนูู ุญุงููุงุช / ูุณุฑุงุช ููุงุณูุฉ.  ูุงุจูุณ!  ููู ูู ุดูุก (ุจูุนูู ุงูุชูุฑุงุฑ ุ ูููุณ ุงูุฃุทูุงู) ุณูุชุบูุฑ ูู ููุช ูุจูุฑ ูู ุงูุนุงู ุงูููุจู - ุณูุชุถูู ุงููุนูุงุฑ (ุฑุจูุง ุฌุฒุฆููุง) ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">range-v3</a> ุ ุงูุชู ุทูุฑูุง ุฅุฑูู ููุจูุฑ ูุนุฏุฉ ุณููุงุช.  ุณูู ูุณุชุฎุฏู ุฃุนูุงู ุซูุงุฑูุง.  ุฑูุฒ ูููู ูู ุดูุก ูููุณู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;range/v3/view/iota.hpp&gt; #include &lt;range/v3/view/transform.hpp&gt; //... auto t_nodes = ranges::v3::iota_view(0, n_fixed) | ranges::v3::views::transform( [](long long i){ return dt_fixed * static_cast&lt;double&gt;(i); } ); double res = integrate(t_nodes);</span></span></span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุธููุฉ ุงูุชูุงูู ูุง ุชุฒุงู ูู ููุณูุง.  ูุฐุง ูู ุ ููุท 3 ุฎุทูุท ูุญู ูุดููุชูุง!  ููุง <code>iota_view(0, n)</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณูููุง</a> (ูุทุงููุง ุ ูุงุฆููุง ููุบูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ ุงููุนููุฉ ุ ูุงููุทุงู ุงูุจุทูุก ูู ุทุฑููุฉ ุนุฑุถ) ุ ูุงูุชู ุ ุนูุฏ ุงูุชูุฑุงุฑ ูู ูู ุฎุทูุฉ ุ ุชุญุณุจ ุงูุฑูู ุงูุชุงูู ูู ุงููุทุงู [0 ุ n).  ูู ุงููุถุญู ุฃู ุงูุงุณู ฮน (ุงูุญุฑู iota ุงููููุงูู) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดูุฑ</a> ููุฐ 50 ุนุงููุง ุฅูู ูุบุฉ APL.  ุนุตุง <code>|</code>  ูุณูุญ ูู ุจูุชุงุจุฉ ุฎุทูุท ุฃูุงุจูุจ ูู ุงููุนุฏูุงุช ุงููุงุตูุฉ ุ <code>transform</code> ุ ูู ุงููุงูุน ุ ูู ูุซู ูุฐุง ุงูุชุนุฏูู ุงูุฐู ุ ุจุงุณุชุฎุฏุงู ูุธููุฉ ุจุณูุทุฉ lambda ุ ูุญูู ุณูุณูุฉ ูู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุฅูู ุณูุณูุฉ <math> </math> $ inline $ t_1 ุ t_2 ุ ... $ inline $   .  ูู ุดูุก ุจุณูุท ุ ููุง ูู ุงูุญุงู ูู <del>  ุญูุงูุฉ ุฎุฑุงููุฉ </del>  ูุงุณูู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ููู ุชุฌุนู ุฎุทูุฉ ูุชุบูุฑุฉุ  ูู ุดูุก ุจุณูุท ูุซู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููููุง ูู ุงูุฑูุงุถูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฎุทูุฉ ุซุงุจุชุฉ ุ ุงุชุฎุฐูุง ุนูุดุฑ ูุชุฑุฉ ูุธููุชูุง ุจุงููุฑุจ ูู ุงูุญุฏ ุงูุฃุนูู ููุชูุงูู <math> </math> $ inline $ \ Delta t_ {ุซุงุจุช} = 0.1 \ ูุฑุฉ 2 \ pi / 3 \ tau ^ 2 $ $ ูุถููุฉ   .  ุงูุขู ุณุชููู ุงูุฎุทูุฉ ูุชุบูุฑุฉ: ุณุชูุงุญุธ ุฃูู ุฅุฐุง ููุช ุชุฃุฎุฐ <math> </math> $ inline $ t_i = \ tau (i / n) ^ {1/3} $ inline $   ุ (ุฃูู <math> </math> $ inline $ n $ inline $   ูู ุฅุฌูุงูู ุนุฏุฏ ุงูููุงุท) ุ ุซู ุณุชููู ุงูุฎุทูุฉ <math> </math> $ inline $ \ Delta t (t) \ approx dt_i / di = \ tau ^ 3 / (3 nt ^ 2) $ inline $   ุ ููู ุนูุดุฑ ูุชุฑุฉ ุฏุงูุฉ ูุงุจูุฉ ููุชูุงูู ูุฃุญุฏ ุงููุนุทูุงุช <math> </math> $ ูุถููุฉ $ t $ ูุถููุฉ $   ุฅุฐุง <math> </math> $ inline $ n = \ tau ^ 3 / (0.1 \ times 2 \ pi) $ inline $   .  ูุจูู ุฃู "ุชูุญูุญ" ูุฐุง ุฅูู ุจุนุถ ุงูุชูุณูู ุงููุนููู ููููู ุงูุตุบูุฑุฉ <math> </math> $ ูุถููุฉ $ i $ ูุถููุฉ   . </p></div></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;range/v3/view/drop.hpp&gt; #include &lt;range/v3/view/iota.hpp&gt; #include &lt;range/v3/view/transform.hpp&gt; //... // trapezoidal rule of integration; step size is not fixed template &lt;typename T&gt; double integrate(T t_nodes) { double acc = 0; double t_prev = *(t_nodes.begin()); double f_prev = f(t_prev); for (auto t: t_nodes | ranges::v3::views::drop(1)) { double f_curr = f(t); acc += 0.5 * (t - t_prev) * (f_curr + f_prev); t_prev = t; f_prev = f_curr; } return acc; } //... auto step_f = [](long long i) { if (static_cast&lt;double&gt;(i) &lt;= 1 / a) { return pow(2 * M_PI, 1/3.0) * a * static_cast&lt;double&gt;(i); } else { return tau * pow(static_cast&lt;double&gt;(i) / static_cast&lt;double&gt;(n), 1/3.0); } }; auto t_nodes = ranges::v3::iota_view(0, n) | ranges::v3::views::transform(step_f); double res = integrate(t_nodes);</span></span></span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุงููุงุฑุฆ ุงูููุธ ุฃูู ูู ูุซุงููุง ุ ุณูุญุช ููุง ุงูุฎุทูุฉ ุงููุชุบูุฑุฉ ุจุชูููู ุนุฏุฏ ููุงุท ุงูุดุจูุฉ ุจุนุงูู ูู ุซูุงุซุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ูููุงุช ููุญูุธุฉ ููุญูุณุจุฉ <math> </math> $ inline $ t_i $ inline $   .  ูููู ุฅุฐุง ุฃุฎุฐูุง ุขุฎุฑ <math> </math> $ inline $ f (t) $ inline $   ุ ูููู ุฃู ูุชุบูุฑ ุนุฏุฏ ุงูููุงุท ุฃูุซุฑ ูู ุฐูู ุจูุซูุฑ ... (ูููู ุงููุคูู ุฃุตุจุญ ูุณูููุง ุจุงููุนู). </p><br><h2 id="itak-taymingi" style=";text-align:right;direction:rtl">  ูุฐูู ุชูููุช </h2><br><p style=";text-align:right;direction:rtl">  ูุฏููุง ุงูุฎูุงุฑุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  v1 - ุญููุฉ ุจุณูุทุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุฅุตุฏุงุฑ 2 - <math> </math> $ inline $ t_i $ inline $   ุชููู ูู <code>std::vector</code> </li><li style=";text-align:right;direction:rtl">  v3 - ูุคูุชุฉ <code>lazy_container</code> ูุน ููุฑุฑ ูุคูุช </li><li style=";text-align:right;direction:rtl">  v4 - ููุงุตู ุฒูููุฉ ูู C ++ 20 (ูุทุงูุงุช) </li><li style=";text-align:right;direction:rtl">  v5 - ูุชุฑุงูุญ ูุฑุฉ ุฃุฎุฑู ุ ูููู ููุง ููุท ูุชู ูุชุงุจุฉ ุทุฑููุฉ ุดุจู ุงูููุญุฑู ุจุงุณุชุฎุฏุงู ุฏุฑุฌุฉ ูุชุบูุฑุฉ </li></ul><br><p style=";text-align:right;direction:rtl">  ุฅููู ูุง ุงุชุถุญ (ุจุงูุซูุงูู) ูู <math> </math> $ inline $ \ tau = (10 \ุ 000 \ุ 001 \ times \ pi) ^ {1/3} $ inline $   ุ ุจุงููุณุจุฉ ุฅูู ุงูุฅุตุฏุงุฑ 8.0.0.0 ูู g ++ ู clang ++ 8.0.0 ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ Intelยฎ Xeonยฎ CPUยฎ X5550 (ุนุฏุฏ ุงูุฎุทูุงุช <math> </math> $ ูุถููุฉ $ 1.5 \ ูุฑุฉ 10 ^ 8 $ ูุถููุฉ   ุ ุจุงุณุชุซูุงุก ุงูุฅุตุฏุงุฑ 5 ุ ุญูุซ ุชููู ุงูุฎุทูุงุช ุฃูู ุจุซูุงุซ ูุฑุงุช (ุชุฎุชูู ูุชูุฌุฉ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุจูู ุงูุทุฑู ุนู ุงูุงุซููู ุจูุณุจุฉ ูุง ุชุฒูุฏ ุนู 0.07): </p><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  V1 </td><td>  V2 </td><td>  V3 </td><td>  V4 </td><td>  V5 </td></tr><tr><td>  ุฒ ++ </td><td>  4.7 </td><td>  6.7 </td><td>  4.6 </td><td>  3.7 </td><td>  4.3 </td></tr><tr><td>  clang ++ </td><td>  5.0 </td><td>  7.2 </td><td>  4.6 </td><td>  4.8 </td><td>  4.1 </td></tr></tbody></table></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฃุนูุงู ~~ ูู ูุฑูุฉ ููููุฉ ~~</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  g ++ -O3 -ffast-math -std = c ++ 2a -Wall -Wpedantic -I range-v3 / include <br>  clang ++ -Ofast -std = c ++ 2a -Wall -Wpedantic -I range-v3 / include </p></div></div><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ุฐุจุงุจุฉ ุฐุจุงุจุฉ ุนุจุฑ ุงูููุฏุงู ุ ูุฌุฏุช ุฐุจุงุจุฉ ุนููุฉ! </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">g ++ ูู ูุถุน ุงูุชุตุญูุญ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฏ ูููู ูู ุงูููู ูุดุฎุต ูุง </p><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  V1 </td><td>  V2 </td><td>  V3 </td><td>  V4 </td><td>  V5 </td></tr><tr><td>  ุฒ ++ </td><td>  5.9 </td><td>  17.8 </td><td>  7.2 </td><td>  33.6 </td><td>  14.3 </td></tr></tbody></table></div></div></div><br><h2 id="itog" style=";text-align:right;direction:rtl">  ูุคุฏู </h2><br><p style=";text-align:right;direction:rtl">  ุญุชู ูู ูููุฉ ุจุณูุทุฉ ููุบุงูุฉ ุ ุชุจูู ุฃู ุงููุทุงูุงุช ูุงูุช ูููุฏุฉ ููุบุงูุฉ: ุจุฏูุงู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฐุงุช ุงูุชูุฑุงุฑุงุช ุฐุงุชูุฉ ุงูุตูุน ุนูู ุฃูุซุฑ ูู 20 ุณุทุฑูุง ุ ูุชุจูุง 3 ุฃุณุทุฑ ุ ูุน ุนุฏู ูุฌูุฏ ูุดุงูู ูู ุฅููุงููุฉ ูุฑุงุกุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฃู ุฃุฏุงุฆูุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุงูุทุจุน ุ ุฅุฐุง ุงุญุชุฌูุง (ูู ุฃุฌู) ุงูุฃุฏุงุก ุงูููุงุฆู ูู ูุฐู ุงูุงุฎุชุจุงุฑุงุช ุ ูุณูุถุทุฑ ุฅูู ุงูุญุตูู ุนูู ุฃูุตู ุงุณุชูุงุฏุฉ ูู ุงููุนุงูุฌ ููู ุงูุฐุงูุฑุฉ ุนู ุทุฑูู ูุชุงุจุฉ ุดูุฑุฉ ูุชูุงุฒูุฉ (ุฃู ูุชุงุจุฉ ุฅุตุฏุงุฑ ุชุญุช OpenCL) ... ูุฃูุถูุง ุ ููุณ ูุฏู ุฃู ููุฑุฉ ุนูุง ุณูุญุฏุซ ุฅุฐุง ูุชุจุช ุณูุงุณู ุทูููุฉ ุฌุฏุง ูู ุงููุนุฏูุงุช.  ูู ูู ุงูุณูู ุชุตุญูุญ ููุฑุงุกุฉ ุฑุณุงุฆู ุงููุชุฑุฌู ุนูุฏ ุงุณุชุฎุฏุงู ุงููุทุงูุงุช ูู ุงููุดุงุฑูุน ุงููุนูุฏุฉ.  ุณูุชู ุชุฌููุน ุฒูุงุฏุฉ ุงูููุช.  ุขูู ุฃู ููุชุจ ุดุฎุต ูุง ุนู ูุฐุง ุงูููุงู. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุชุจุช ูุฐู ุงูุงุฎุชุจุงุฑุงุช ุ ูู ุฃูู ุฃุนุฑู ุจููุณู ูุง ุงูุฐู ุณูุญุฏุซ.  ุงูุขู ุฃุนุฑู ุฃู ุงููุทุงูุงุช ุชุณุชุญู ุจุงูุชุฃููุฏ ุฃู ูุชู ุงุฎุชุจุงุฑูุง ูู ูุดุฑูุน ุญูููู ุ ูู ุงูุธุฑูู ุงูุชู ุชููู ุงุณุชุฎุฏุงููุง. </p><br><p style=";text-align:right;direction:rtl"><del>  ุฐูุจุช ุฅูู ุงูุจุงุฒุงุฑ ูุดุฑุงุก ุงูุณูุงูุฑ. </del></p><br><h3 id="poleznye-ssylki" style=";text-align:right;direction:rtl">  ุฑูุงุจุท ูููุฏุฉ </h3><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฌููุนุฉ V3 ุงูููุฒู</a> </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ูุฏุฑุงุณุงุช ุงูุญุงูุฉ v3</a> </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏ ูู ูุฐู ุงููุงุฏุฉ ุนูู ุฌูุซุจ</a> </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฆู ูู haskell ุ ููููุงุฑูุฉ</a> </p><br><h3 id="blagodarnosti" style=";text-align:right;direction:rtl">  ุดูุฑ </h3><br><p style=";text-align:right;direction:rtl">  ุดูุฑุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">ูุงุฏู</a> ูููุณุงุนุฏุฉ ูู ูุชุงุจุฉ ูู ูุฐุง! </p><br><h3 id="ps" style=";text-align:right;direction:rtl">  PS </h3><br><p style=";text-align:right;direction:rtl">  ุขูู ุฃู ูุนูู ุดุฎุต ูุง ุนูู ูุซู ูุฐู ุงูุฃููุฑ ุงูุดุงุฐุฉ: 1) ุฅุฐุง ููุช ุชุฃุฎุฐ ูุชุฑุฉ ุงูุชูุงูู ุฃุตุบุฑ ุจุนุดุฑ ูุฑุงุช ุ ูุนูุฏุฆุฐู ูู My Xeon ุ ูููู v2 ุฃุณุฑุน ุจูุณุจุฉ 10ูช ูู v1 ุ ู v4 ุฃุณุฑุน ุจุซูุงุซ ูุฑุงุช ูู v1.  ุจ) ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู Intel (icc 2019) ุฃุญูุงููุง ูู ูุฐู ุงูุฃูุซูุฉ ุ ูุฌุนู ุงูุดูุฑุฉ ุฃุณุฑุน ูุฑุชูู ูู ุงููุชุฑุฌูุฉ g ++.  ูุชู ุชูุฌูู ุงููููุ  ูู ูููู ุฅุฌุจุงุฑ g ++ ุนูู ูุนู ุงูุดูุก ููุณูุ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar473844/">https://habr.com/ru/post/ar473844/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar473832/index.html">ShIoTiny: ุงูุชุญุฏูุซุงุช ูุงูุฅุดุนุงุฑุงุช</a></li>
<li><a href="../ar473834/index.html">ูุฑุงูุจุฉ ุงูุตูุฏูู ุงูุฃุณูุฏ ูู ุดุจูุงุช ูููุณ. ุชูุฑูุฑ ูุงูุฏูุณ</a></li>
<li><a href="../ar473838/index.html">DJI Mavic Mini: ุฃุฎู quadrocopter ูุงุจูุฉ ููุทู</a></li>
<li><a href="../ar473840/index.html">ุฏูู ุงูููุฏูู ูู ุฌูุงุฒ Android ุนุจุฑ ุชุทุจูู UDP ุฅูู ุชุทุจูู ุฌุงูุง</a></li>
<li><a href="../ar473842/index.html">ุฃูุชูุจุฑ ุขูุฉ ุงูุชุนูู ูุงูุฐูุงุก ุงูุงุตุทูุงุนู</a></li>
<li><a href="../ar473846/index.html">ููููุฉ ููุงุณ ุฃุฏุงุก ุดุจูุงุช blockchain. ุงูููุงููุณ ุงูุฑุฆูุณูุฉ</a></li>
<li><a href="../ar473848/index.html">c.tech ุนูู HighLoad ++ 2019</a></li>
<li><a href="../ar473852/index.html">ุฅูุฌุงุจูุงุช ูุณูุจูุงุช ุงูุนูู ูู ุงูููู</a></li>
<li><a href="../ar473854/index.html">ููู ูุชุฐูุฑ ุขุฎุฑ JokerConf</a></li>
<li><a href="../ar473856/index.html">ุณูููุฉ ุฎุทูุฑุฉ ููููู ูู ุฎูุงููุง ุฎุฏุงุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุนุณูุฑู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>