<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèª ‚åõÔ∏è üóÇÔ∏è Skeleton Key-Malware-Analyse üå¥ üè∞ üßúüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die √úbersetzung des Artikels wurde speziell f√ºr Studierende des Reverse Engineering Kurses erstellt. 



 Zusammenfassung 
 Forscher der Dell SecureWo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Skeleton Key-Malware-Analyse</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/481778/">  <i>Die √úbersetzung des Artikels wurde speziell f√ºr Studierende des <a href="https://otus.pw/C71z/">Reverse Engineering</a> Kurses erstellt.</i> <br><br><img src="https://habrastorage.org/webt/9z/ro/zu/9zrozu-bzodywtxpi3u8jgmsgog.png"><br><hr><br><h3>  Zusammenfassung </h3><br>  Forscher der Dell SecureWorks Counter Threat Unit (CTU) haben Malware entdeckt, die Active Directory (AD) -Authentifizierungssysteme umgeht, die die Ein-Faktor-Authentifizierung (nur Kennwort) verwenden.  Angreifer k√∂nnen das Passwort ihrer Wahl f√ºr die Authentifizierung als beliebiger Benutzer verwenden.  Diese Malware wird als "Skeleton Key" (Universalschl√ºssel) bezeichnet. <br><br>  CTU-Forscher entdeckten den Skeleton Key in einem Client-Netzwerk, das Single-Factor-Authentifizierung f√ºr den Zugriff auf Webmail und VPNs verwendete, um Angreifern ungehinderten Zugriff auf RAS-Dienste zu erm√∂glichen.  Der Hauptschl√ºssel wird als Patch im Speicher auf den AD-Dom√§nencontrollern des Opfers bereitgestellt, damit sich der Angreifer als jeder Benutzer authentifizieren kann, w√§hrend legitime Benutzer die Authentifizierung wie gewohnt fortsetzen.  Mithilfe der Umgehung der Skeleton Key-Authentifizierung k√∂nnen sich Angreifer mit physischem Zugriff anmelden und Systeme entsperren, die Benutzer auf gef√§hrdeten AD-Dom√§nencontrollern authentifizieren. <a name="habracut"></a><br><br>  Den einzigen zum Zeitpunkt der Ver√∂ffentlichung bekannten Skeleton Key-Beispielen fehlte die Persistenz. Sie m√ºssen erneut bereitgestellt werden, wenn der Dom√§nencontroller neu gestartet wird.  CTU-Forscher vermuten, dass Angreifer einen Neustart nur anhand ihrer Unf√§higkeit, sich erfolgreich zu authentifizieren, identifizieren k√∂nnen, da auf den Dom√§nencontrollern keine andere Malware erkannt wurde.  Zwischen acht Stunden und acht Tagen nach dem Neustart verwendeten die Angreifer andere RAS-Malware, die bereits im Netzwerk des Opfers bereitgestellt wurde, um den Skeleton Key erneut auf Dom√§nencontrollern bereitzustellen. <br><br>  F√ºr die Skeleton Key-Bereitstellung sind Anmeldeinformationen des Dom√§nenadministrators erforderlich.  CTU-Forscher beobachteten, wie Angreifer den Skeleton Key mithilfe von Anmeldeinformationen bereitstellten, die von gesch√§ftskritischen Servern, Administratorarbeitsstationen und Zieldom√§nencontrollern gestohlen wurden. <br><br><h3>  Analyse </h3><br>  Urspr√ºnglich beobachteten CTU-Forscher ein Skeleton Key-Beispiel mit dem Namen ole64.dll in einem kompromittierten Netzwerk (siehe Tabelle 1). <br><br><div class="scrollable-table"><table><tbody><tr><td>  Attribut </td><td>  Bedeutung oder Beschreibung </td></tr><tr><td>  Dateiname </td><td>  ole64.dll </td></tr><tr><td>  md5 </td><td>  bf45086e6334f647fda33576e2a05826 </td></tr><tr><td>  sha1 </td><td>  5083b17ccc50dd0557dfc544f84e2ab55d6acd92 </td></tr><tr><td>  Kompilierungszeit </td><td>  2014-02-19 09:31:29 </td></tr><tr><td>  eingesetzt </td><td>  nach Bedarf (normalerweise mit Malware heruntergeladen und nach der Verwendung gel√∂scht) </td></tr><tr><td>  Dateigr√∂√üe </td><td>  49664 Bytes </td></tr><tr><td>  Abschnitte </td><td>  .text, .rdata, .data, .pdata, .rsrc, .reloc </td></tr><tr><td>  exportieren </td><td><p>  ii (installiert den Patch) </p><p>  uu (Entfernt den Patch) </p><p>  dllentrypoint (Standard-DLL-Einstiegspunkt) </p></td></tr></tbody></table></div><br>  <i>Tabelle 1. Beispiel f√ºr Skeleton Key <code>ole64.dll</code> .</i> <br><br>  W√§hrend der Untersuchung von <code>ole64.dll</code> entdeckten CTU-Forscher eine √§ltere Version von <code>msuta64.dll</code> auf einem ‚ÄûZwischenhost‚Äú im Netzwerk des Opfers (siehe Tabelle 2).  Ein Zwischenhost ist jedes System, das zuvor durch b√∂swillige Malware f√ºr den Remotezugriff gef√§hrdet war.  Diese Option enth√§lt zus√§tzliche Debug-Operatoren, mit denen der Skeleton Key-Entwickler die am Patch-Prozess beteiligten Speicheradressen beobachten kann. <br><br><div class="scrollable-table"><table><tbody><tr><td>  Attribut </td><td>  Bedeutung oder Beschreibung </td></tr><tr><td>  Dateiname </td><td>  msuta64.dll <br></td></tr><tr><td>  md5 </td><td>  66da7ed621149975f6e643b4f9886cfd </td></tr><tr><td>  sha1 </td><td>  ad61e8daeeba43e442514b177a1b41ad4b7c6727 <br></td></tr><tr><td>  Kompilierungszeit </td><td>  2012-09-20 08:07:12 </td></tr><tr><td>  eingesetzt </td><td>  2013-09-29 07:58:16 <br></td></tr><tr><td>  Dateigr√∂√üe </td><td>  50688 Bytes </td></tr><tr><td>  Abschnitte </td><td>  .text, .rdata, .data, .pdata, .rsrc, .reloc <br></td></tr><tr><td>  exportieren </td><td><p>  ii (installiert den Patch) </p><p>  uu (Entfernt den Patch) </p><p>  dllentrypoint (Standard-DLL-Einstiegspunkt) </p></td></tr></tbody></table></div><br>  <i>Tabelle 2. Beispiel f√ºr Skeleton Key <code>msuta64.dll</code> .</i> <br><br>  Die Angreifer verwendeten den folgenden Algorithmus, um den Skeleton Key als 64-Bit-DLL-Datei bereitzustellen: <br><br><ol><li>  Laden Sie die Skeleton Key-DLL-Datei in das Staging-Verzeichnis auf dem Staging-Host im Opfernetzwerk herunter.  CTU-Forscher beobachteten drei Dateinamen, die mit der Skeleton Key-DLL-Datei verkn√ºpft sind: ole64.dll, ole.dll und msuta64.dll.  Windows-Systeme enthalten die legitime Datei ole32.dll, sie steht jedoch nicht mit dieser Malware in Verbindung. </li><li>  Versuchen Sie, mithilfe einer Liste gestohlener Dom√§nenadministratoranmeldeinformationen auf Administratorressourcen auf Dom√§nencontrollern zuzugreifen. </li><li>  Wenn die gestohlenen Anmeldeinformationen nicht mehr g√ºltig sind, extrahieren Sie die Kennw√∂rter des Dom√§nenadministrators mit den Tools zum Diebstahl von Kennw√∂rtern im Klartext von einer der folgenden Stellen, was bedeutet, dass Sie mit der Umgebung des Opfers vertraut sind: <br><br><ul><li>  Speicher eines anderen verf√ºgbaren Servers im Netzwerk des Opfers </li><li>  Domain-Administrator-Jobs </li><li>  Zieldom√§nencontroller </li><li>  Verwenden Sie g√ºltige Dom√§nenadministratoranmeldeinformationen, um die Skeleton Key-DLL in C: \ WINDOWS \ system32 \ auf den Zieldom√§nencontrollern zu kopieren. </li></ul></li><li>  Verwenden Sie das Dienstprogramm <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx">PsExec</a> , um die Skeleton Key-DLL-Datei mithilfe des Befehls rundll32 remote auf den <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx">Zieldom√§nencontrollern</a> auszuf√ºhren.  Das vom Angreifer gew√§hlte Passwort ist als NTLM-Hash-Passwort formatiert und wird nicht im Klartext angezeigt.  Nach der Bereitstellung des <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> kann sich der Angreifer mit dem konfigurierten <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> Kennwort-Hash wie jeder <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> Benutzer authentifizieren <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> </li><li>  L√∂schen Sie die Skeleton Key DLL-Datei von C: \ WINDOWS \ system32 \ auf den Zieldom√§nencontrollern. </li><li>  L√∂schen Sie die Skeleton Key-DLL-Datei aus dem Staging-Verzeichnis auf dem √úbergangshost. </li><li>  Testen Sie die erfolgreiche Bereitstellung des Skeleton Keys mithilfe der "net use" -Befehle mit einem AD-Konto und einem Kennwort, das dem konfigurierten NTLM-Hash entspricht. </li></ol><br>  CTU-Forscher entdeckten ein eingebettetes Kennwortmuster, das darauf hindeutet, dass eine Gruppe von Angreifern den Skeleton Key in mehreren Organisationen bereitgestellt hat. <br><br>  Die Verwendung von PsExec kann in einer Windows-Umgebung erkannt werden, indem Sie √ºber vom Dienstprogramm generierte Windows-Ereignisse informiert werden.  Die folgenden auf den Zieldom√§nencontrollern beobachteten Ereignis-IDs registrieren das PsExec-Tool, das seinen Dienst installiert, den Dienst startet und den Dienst stoppt.  Diese Ereignisse werden bei jeder Verwendung von PsExec generiert. Daher ist eine zus√§tzliche Ereignisanalyse erforderlich, um festzustellen, ob sie b√∂swillig oder legitim sind: <br><br><ul><li>  Unerwartete Installationsereignisse f√ºr den PSEXESVC-Dienst (Ereigniscode 7045) auf AD-Dom√§nencontrollern: <br><br>  <i>Protokollname</i> : System <br>  <i>Quelle</i> : Dienststeuerungs-Manager <br>  <i>Zusammenfassung</i> : Auf dem System ist ein Dienst installiert. <br>  <i>Name der Servicedatei</i> : <br> <code>%SystemRoot%\PSEXESVC.exe</code> </li> <li>  Unerwartete Start / Stopp-Ereignisse des PSEXESVC-Dienstes (Ereigniscode 7036) auf AD-Dom√§nencontrollern: <br><br>  <i>Protokollname</i> : System <br>  <i>Quelle</i> : Dienststeuerungs-Manager <br>  <i>Zusammenfassung</i> : <br><ul><li>  "Der PSEXESVC-Dienst ist betriebsbereit." </li><li>  "Der PSEXESVC-Dienst wurde gestoppt." </li></ul></li></ul><br>  Als laufender Skeleton Key m√ºssen Sie die folgenden Aufgaben ausf√ºhren: <br><br><ol><li>  Suchen Sie nach einer der folgenden kompatiblen 64-Bit-Versionen von Windows.  Die Malware ist nicht mit 32-Bit-Versionen von Windows oder Windows Server-Versionen ab Windows Server 2012 (6.2) kompatibel. <br><br><ul><li>  6.1 (Windows 2008 R2) </li><li>  6.0 (Windows Server 2008) </li><li>  5.2 (Windows 2003 R2) </li></ul></li><li>  Verwenden Sie die SeDebugPrivilege-Funktion, um die erforderlichen Administratorrechte zum Schreiben in den Dienstprozess des lokalen Sicherheitssubsystems (LSASS) zu erhalten.  Dieser Prozess steuert die Sicherheitsfunktionen f√ºr die AD-Dom√§ne, einschlie√ülich der Authentifizierung des Benutzerkontos. </li><li>  Listen Sie die verf√ºgbaren Prozesse auf, um das LSASS-Prozesshandle zu erhalten. </li><li>  Adressen f√ºr authentifizierungsbezogene Funktionen abrufen, die behoben werden: <br><br><ul><li>  CDLocateCSystem - befindet sich in <code>cryptdll.dll</code> </li><li>  SamIRetrieveMultiplePrimaryCredentials - befindet sich in <code>samsrv.dll</code> </li><li>  SamIRetrievePrimaryCredentials - befindet sich in <code>samsrv.dll</code> </li></ul></li><li>  Nehmen Sie die Einstellungen f√ºr das jeweilige Betriebssystem mithilfe der globalen Variablen vor, die w√§hrend der Kompatibilit√§tspr√ºfung in Schritt 1 festgelegt wurden. </li><li>  Verwenden Sie die OpenProcess-Funktion, um das LSASS-Prozesshandle abzurufen. </li><li>  Reservieren Sie und reservieren Sie den erforderlichen Speicherplatz f√ºr das Bearbeiten und Patchen des Speichers des LSASS-Prozesses. </li><li>  Zugeh√∂rige Funktionen basierend auf dem Betriebssystem patchen: <br><br><ul><li>  CDLocateCSystem (alle kompatiblen Versionen von Windows) </li><li>  SamIRetrieveMultiplePrimaryCredentials (nur Windows 2008 R2 (6.1)) </li><li>  SamIRetrievePrimaryCredentials (alle kompatiblen Versionen von Windows mit Ausnahme von Windows 2008 R2 (6.1)) </li></ul></li></ol><br>  So beheben Sie jede Funktion: <br><br><ol><li>  Rufen Sie die VirtualProtectEx-Funktion auf, um den Speicherschutz so zu √§ndern, dass in die erforderlichen Speicherzuordnungen geschrieben werden kann (PAGE_EXECUTE_READWRITE, 0x40).  In diesem Schritt k√∂nnen Sie den Funktionscode im Speicher aktualisieren. </li><li>  Rufen Sie die WriteProcessMemory-Funktion auf, um die Adresse der Zielfunktion so zu √§ndern, dass sie auf den korrigierten Code verweist.  Diese √Ñnderung bewirkt, dass der Funktionsaufruf den Patch verwendet. </li><li>  Stellen Sie den urspr√ºnglichen Speicherschutz wieder her, indem Sie VirtualProtectEx mit den urspr√ºnglichen Speicherschutz-Flags aufrufen.  Dieser Schritt ist erforderlich, um eine verd√§chtige Zuweisung von Speicher f√ºr die Aufzeichnung und Ausf√ºhrung zu vermeiden. </li></ol><br>  Nach dem Patchen kann sich ein Angreifer mit dem w√§hrend der Bereitstellung konfigurierten Skeleton Key-Kennwort als Dom√§nenbenutzer anmelden.  Legitime Benutzer k√∂nnen sich weiterhin mit ihren eigenen Passw√∂rtern anmelden.  Diese Umgehung der Authentifizierung gilt f√ºr alle Dienste, die One-Way-AD-Authentifizierung verwenden, z. B. Webmail und VPN. Au√üerdem kann ein Angreifer mit physischem Zugriff auf ein gef√§hrdetes System einen Computer entsperren, indem er ein eingebettetes Kennwort auf der Tastatur eingibt. <br><br><h4>  <i>M√∂gliche Zuordnung zu Problemen mit der Dom√§nenreplikation</i> </h4><br>  Sch√§dlicher Code Skeleton Key √ºbertr√§gt keinen Netzwerkverkehr, wodurch die netzwerkbasierte Erkennung wirkungslos wird.  Diese Malware ist jedoch auf Probleme mit der Dom√§nenreplikation zur√ºckzuf√ºhren, die auf eine Infektion hindeuten k√∂nnten.  Kurz nach jeder Bereitstellung der von CTU-Forschern entdeckten Skeleton Key-Malware stie√üen Dom√§nencontroller auf Replikationsprobleme, die vom Microsoft-Support nicht erkl√§rt oder behoben werden konnten. Letztendlich war ein Neustart erforderlich, um diese Probleme zu beheben.  Durch diese Neustarts wurde die Skeleton Key-Authentifizierungsumgehung entfernt, da die Malware keinen Persistenzmechanismus aufweist.  In Abb.  Abbildung 1 zeigt den zeitlichen Ablauf dieser Neustarts sowie den anschlie√üenden Diebstahl von Kennw√∂rtern durch Eindringlinge, die seitliche Erweiterung und den Einsatz des Skeleton Key.  Relocations traten normalerweise innerhalb weniger Stunden oder mehrerer Tage nach einem Neustart auf. <br><br><img src="https://habrastorage.org/webt/qo/jp/fz/qojpfzr6gcqy84wv_hl9f4xjnk4.png"><br>  <i>Abbildung 1. Beziehung zwischen Bereitstellung und Neustart, beobachtet von CTU-Forschern, April - Juli 2014 (Quelle: Dell SecureWorks)</i> <br><br><h3>  Gegenma√ünahmen </h3><br>  Sch√§dlicher Code Skeleton Key umgeht die Authentifizierung und generiert keinen Netzwerkverkehr.  Infolgedessen erkennen Systeme zur Erkennung und Verhinderung von Netzwerkeinbr√ºchen (IDS / IPS) diese Bedrohung nicht.  Die CTU-Forscher haben jedoch die YARA-Signaturen in <a href="https://www.secureworks.com/research/skeleton-key-malware-analysis">Anhang A</a> notiert, um die Skeleton Key-DLL und den Code zu ermitteln, der in den LSASS-Prozessspeicher eingegeben wird. <br><br><h3>  Bedrohungsanzeigen </h3><br>  Mithilfe der Bedrohungsindikatoren in Tabelle 3 k√∂nnen Aktivit√§ten im Zusammenhang mit Skeleton Key-Malware erkannt werden. <br><br><div class="scrollable-table"><table><tbody><tr><td>  Anzeige </td><td>  Typ </td><td>  Kontext </td></tr><tr><td>  66da7ed621149975f6e643b4f9886cfd </td><td>  md5 hash </td><td>  Skeleton Key Patch msuta64.dll </td></tr><tr><td>  ad61e8daeeba43e442514b177a1b41ad4b7c6727 </td><td>  sha1 hash </td><td>  Skeleton Key Patch msuta64.dll </td></tr><tr><td>  bf45086e6334f647fda33576e2a05826 </td><td>  md5 hash </td><td>  Skeleton Key Patch ole64.dl </td></tr><tr><td>  5083b17ccc50dd0557dfc544f84e2ab55d6acd92 </td><td>  sha1 hash </td><td>  Skeleton Key Patch ole64.dl </td></tr></tbody></table></div><br>  <i>Tabelle 3. Anzeigen f√ºr den Hauptschl√ºssel.</i> <br><br><h3>  Fazit </h3><br>  Die CTU Research Group empfiehlt Unternehmen, die folgenden Sicherheitsfunktionen von Skeleton Key zu implementieren: <br><br><ul><li>  Die Multifaktorauthentifizierung f√ºr alle RAS-L√∂sungen, einschlie√ülich VPN und Remote-E-Mail, erm√∂glicht es Bedrohungsakteuren nicht, die Einzelfaktorauthentifizierung oder die Authentifizierung mit gestohlenen statischen Anmeldeinformationen zu umgehen. </li><li>  Ein √úberwachungsprotokoll zur Prozesserstellung auf Arbeitsstationen und Servern, einschlie√ülich AD-Dom√§nencontrollern, kann Skeleton Key-Bereitstellungen erkennen.  Insbesondere sollten Organisationen nach den folgenden Artefakten suchen: <br><br><ul><li>  Unerwartetes PsExec.exe verarbeitet und verwendet das PsExec-Befehlszeilenargument "-accepteula" </li><li>  Unerwartete rundll32.exe-Prozesse </li><li>  Behandeln Sie Argumente √§hnlich wie NTLM-Hash-Codes (32 Zeichen mit den Ziffern 0-9 und AF-Zeichen). </li></ul></li><li>  Das √úberwachen von Windows Service Manager-Ereignissen auf AD-Dom√§nencontrollern kann unerwartete Dienstinstallationsereignisse (Ereigniscode 7045) und Start- / Stoppereignisse (Ereigniscode 7036) f√ºr den PSEXESVC-PsExec-Dienst erkennen. </li></ul><br><h3>  Anhang A - YARA-Signaturen </h3><br>  Die folgenden YARA-Signaturen erkennen das Vorhandensein eines Hauptschl√ºssels im System, indem sie entweder eine verd√§chtige Datei oder einen Speicherauszug von Active Directory-Dom√§nencontrollern scannen, die m√∂glicherweise den Hauptschl√ºssel enthalten. <br><br><pre> <code class="bash hljs">rule skeleton_key_patcher { strings: <span class="hljs-variable"><span class="hljs-variable">$target_process</span></span> = <span class="hljs-string"><span class="hljs-string">"lsass.exe"</span></span> wide <span class="hljs-variable"><span class="hljs-variable">$dll1</span></span> = <span class="hljs-string"><span class="hljs-string">"cryptdll.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$dll2</span></span> = <span class="hljs-string"><span class="hljs-string">"samsrv.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$name</span></span> = <span class="hljs-string"><span class="hljs-string">"HookDC.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched1</span></span> = <span class="hljs-string"><span class="hljs-string">"CDLocateCSystem"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched2</span></span> = <span class="hljs-string"><span class="hljs-string">"SamIRetrievePrimaryCredentials"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched3</span></span> = <span class="hljs-string"><span class="hljs-string">"SamIRetrieveMultiplePrimaryCredentials"</span></span> condition: all of them } rule skeleton_key_injected_code { strings: <span class="hljs-variable"><span class="hljs-variable">$injected</span></span> = { 33 C0 85 C9 0F 95 C0 48 8B 8C 24 40 01 00 00 48 33 CC E8 4D 02 00 00 48 81 C4 58 01 00 00 C3 } <span class="hljs-variable"><span class="hljs-variable">$patch_CDLocateCSystem</span></span> = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B FA 8B F1 E8 ?? ?? ?? ?? 48 8B D7 8B CE 48 8B D8 FF 50 10 44 8B D8 85 C0 0F 88 A5 00 00 00 48 85 FF 0F 84 9C 00 00 00 83 FE 17 0F 85 93 00 00 00 48 8B 07 48 85 C0 0F 84 84 00 00 00 48 83 BB 48 01 00 00 00 75 73 48 89 83 48 01 00 00 33 D2 } <span class="hljs-variable"><span class="hljs-variable">$patch_SamIRetrievePrimaryCredential</span></span> = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 49 8B F9 49 8B F0 48 8B DA 48 8B E9 48 85 D2 74 2A 48 8B 42 08 48 85 C0 74 21 66 83 3A 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 14 E8 ?? ?? ?? ?? 4C 8B CF 4C 8B C6 48 8B D3 48 8B CD FF 50 18 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 } <span class="hljs-variable"><span class="hljs-variable">$patch_SamIRetrieveMultiplePrimaryCredential</span></span> = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 41 8B F9 49 8B D8 8B F2 8B E9 4D 85 C0 74 2B 49 8B 40 08 48 85 C0 74 22 66 41 83 38 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 12 E8 ?? ?? ?? ?? 44 8B CF 4C 8B C3 8B D6 8B CD FF 50 20 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 } condition: any of them }</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de481778/">https://habr.com/ru/post/de481778/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de481764/index.html">Warum hat gr√ºne Energie eine schwierige Zukunft?</a></li>
<li><a href="../de481768/index.html">Wir besch√§ftigen uns mit WebKit in 1C, zum Beispiel der Integration von TinyMCE in eine verwaltete Form in UT 11.4</a></li>
<li><a href="../de481770/index.html">Der Computerprogramm-Pionier Tony Brucker stirbt im Alter von 94 Jahren</a></li>
<li><a href="../de481774/index.html">Sicherheits-Cheat-Sheets: Virtual Patching</a></li>
<li><a href="../de481776/index.html">5G- und Cloud-Gaming-Dienste - Testen Sie, wie es in Moskau funktioniert</a></li>
<li><a href="../de481780/index.html">MyOffice hat √ºber 200 neue Funktionen</a></li>
<li><a href="../de481782/index.html">√úber Probleme mit dem Python-√úbersetzer und das √úberdenken der Sprache</a></li>
<li><a href="../de481784/index.html">Wie Kafka wahr wurde</a></li>
<li><a href="../de481786/index.html">Google begr√§bt PHP IMAP-Erweiterung</a></li>
<li><a href="../de481788/index.html">Analyse der L√∂sung realer Industrieprobleme (Rettung von Ferkeln und anderen)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>