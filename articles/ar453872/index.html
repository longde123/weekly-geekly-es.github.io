<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥑 🚣🏿 👁️ استعادة الصور باستخدام الشبكات العصبية 🐠 🧗🏾 👨‍❤️‍👨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="مرحباً بالجميع ، أعمل كمبرمج أبحاث في فريق رؤية الكمبيوتر لمجموعة Mail.ru. بالنسبة ليوم النصر هذا العام ، قررنا إنشاء مشروع لاستعادة الصور العسكرية . ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>استعادة الصور باستخدام الشبكات العصبية</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/453872/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/333/44a/c78/33344ac788b63200841180799417f934.jpg"><br><br>  مرحباً بالجميع ، أعمل كمبرمج أبحاث في فريق رؤية الكمبيوتر لمجموعة Mail.ru.  بالنسبة ليوم النصر هذا العام ، قررنا إنشاء <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مشروع لاستعادة الصور العسكرية</a> .  ما هو استعادة الصور؟  يتكون من ثلاث مراحل: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  نجد جميع عيوب الصورة: فواصل ، يجرجر ، ثقوب. <br></li><li style=";text-align:right;direction:rtl">  الطلاء على العيوب الموجودة على أساس قيم بكسل من حولهم ؛ <br></li><li style=";text-align:right;direction:rtl">  تلوين الصورة. <br></li></ul><br>  في هذه المقالة ، سوف أتطرق إلى كل مرحلة من مراحل الاستعادة بالتفصيل وأخبرك كيف وأين أخذنا البيانات ، وما هي الشبكات التي تعلمناها ، وماذا فعلنا ، وما أشعله من خطوات. <br><a name="habracut"></a><br><h1 style=";text-align:right;direction:rtl">  عيب البحث </h1><br>  نريد العثور على جميع وحدات البكسل المتعلقة بالعيوب في الصورة التي تم تحميلها.  أولاً ، نحن بحاجة إلى فهم نوع الصور الفوتوغرافية لسنوات الحرب التي سيقوم الناس بتحميلها.  لجأنا إلى منظمي مشروع الفوج الخالد ، الذين تبادلوا البيانات معنا.  بعد تحليلها ، لاحظنا أن الأشخاص غالبًا ما يقومون بتحميل الصور ، الفردية أو الجماعية ، التي تحتوي على عدد معتدل أو كبير من العيوب. <br><br>  ثم كان من الضروري جمع عينة التدريب.  نموذج التدريب لمهمة التجزئة هو صورة وقناع عليها جميع العيوب.  أسهل طريقة هي إعطاء الصور للعلامات إلى العلامات.  بالطبع ، الناس يجيدون العثور على العيوب ، ولكن المشكلة هي أن العلامات هي عملية طويلة جدًا. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5d/a19/892/d5da1989220f10bcaac3944d27d64276.png"><br><br>  قد يستغرق الأمر من ساعة إلى يوم عمل كامل لتمييز البيكسلات المتعلقة بالعيوب في صورة واحدة ، لذلك يصعب جمع عينة من أكثر من 100 صورة في غضون بضعة أسابيع.  لذلك ، حاولنا أن نضيف إلى حد ما بياناتنا وكتبنا عيوبًا من تلقاء نفسها: لقد التقطنا صورة نظيفة وطبّقنا عليها عيوبًا اصطناعية وحصلنا على قناع يوضح لنا الأجزاء المعيّنة من الصورة التالفة.  كان الجزء الرئيسي من نموذج التدريب الخاص بنا هو 79 صورة تم تعليمها يدويًا ، تم نقل 11 منها إلى عينة الاختبار. <br><br>  الطريقة الأكثر شيوعًا لمشكلة التجزئة: خذ Unet مع مشفر مُدرَّب مسبقًا وتقليل المبلغ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.854ex" height="2.057ex" viewBox="0 -780.1 1659.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-42" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-63" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-65" x="1193" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> Bce </script>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الانتروبيا الثنائية</a> ) و <math></math><img src="https://habrastorage.org/getpro/habr/formulas/74f/54c/5dd/74f54c5dd986c71e76c7b52f247706ac.svg" alt="DICE $" data-tex="inline">  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">سورينسن - معامل النرد</a> ). <br><br>  ما هي المشاكل التي تنشأ مع هذا النهج في مشكلة تجزئة العيوب؟ <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  حتى إذا بدا لنا أن هناك الكثير من العيوب في الصورة ، فهي متسخة للغاية ومضطربة مع مرور الوقت ، فإن المنطقة التي تشغلها العيوب لا تزال أصغر بكثير من الجزء غير التالف من الصورة.  لحل هذه المشكلة ، يمكنك زيادة وزن الطبقة الإيجابية في <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.854ex" height="2.057ex" viewBox="0 -780.1 1659.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-42" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-63" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-65" x="1193" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> Bce </script>  ، والوزن الأمثل هو نسبة عدد البيكسلات الخالصة إلى عدد البيكسلات التي تنتمي إلى العيوب. <br></li><li style=";text-align:right;direction:rtl">  المشكلة الثانية هي أننا إذا استخدمنا Unet خارج الصندوق مع برنامج تشفير تم تدريبه مسبقًا ، على سبيل المثال Albunet-18 ، فإننا نفقد الكثير من المعلومات الموضعية.  تتكون الطبقة الأولى من Albunet-18 من الإلتواء مع جوهر 5 وخطوة تساوي اثنين.  هذا يسمح للشبكة بالعمل بسرعة.  لقد ضحينا بوقت تشغيل الشبكة من أجل توطين العيوب بشكل أفضل: لقد أزلنا أقصى تجمع بعد الطبقة الأولى ، وقللنا من الخطوة إلى 1 وقللنا جوهر الالتواء إلى 3. <br></li><li style=";text-align:right;direction:rtl">  إذا عملنا مع صور صغيرة ، على سبيل المثال ، ضغط صورة على 256 × 256 أو 512 × 512 ، فإن العيوب الصغيرة ستختفي ببساطة بسبب الاستيفاء.  لذلك ، تحتاج إلى العمل مع صورة كبيرة.  الآن في الإنتاج ، نقوم بتجزئة العيوب في صور 1024 × 1024. لذلك ، كان من الضروري تدريب الشبكة العصبية في مجموعة كبيرة من الصور الكبيرة.  ولهذا السبب ، هناك مشاكل في الحجم الصغير للدفعة على بطاقة فيديو واحدة. <br></li><li style=";text-align:right;direction:rtl">  خلال التدريب ، لدينا حوالي 20 صورة وضعت على بطاقة واحدة.  لهذا السبب ، فإن تقدير المتوسط ​​والتباين في طبقات BatchNorm غير دقيق.  يساعدنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">BatchNorm الموضعي في</a> حل هذه المشكلة ، التي توفر أولاً الذاكرة ، وثانيًا ، لديها إصدار من Synchronized BatchNorm ، الذي يقوم بمزامنة الإحصاءات بين جميع البطاقات.  نحن الآن نعتبر المتوسط ​​والتباين ليس بنسبة 20 صورة على بطاقة واحدة ، ولكن بنسبة 80 صورة من 4 بطاقات.  هذا يحسن تقارب الشبكة. <br></li></ul><br>  في النهاية ، زيادة الوزن <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.854ex" height="2.057ex" viewBox="0 -780.1 1659.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-42" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-63" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/mailru/blog/453872/&amp;usg=ALkJrhgdeA00h_ElDNk2XKVqG8W16b_bcg#MJMATHI-65" x="1193" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> Bce </script>  من خلال تغيير الهيكل واستخدام BatchNorm في المكان ، بدأنا في البحث عن عيوب في الصورة.  لكن بثمن بخس ، يمكنك القيام بعمل أفضل قليلاً عن طريق إضافة اختبار زيادة الوقت.  يمكننا تشغيل الشبكة مرة واحدة في صورة الإدخال ، ثم نسخها وتشغيلها مرة أخرى ، مما يساعدنا في العثور على عيوب صغيرة. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c75/95b/702/c7595b702dcb921dac612b0218ce13e4.png"><br><br>  نتيجة لذلك ، تقاربت شبكتنا على أربعة GeForce 1080Ti في 18 ساعة.  يستغرق الاستدلال 290 مللي ثانية.  لقد تبيّن ذلك لفترة طويلة ، لكن هذا يمثل رسومًا لأننا نبحث جيدًا عن عيوب صغيرة.  التحقق من صحة <math></math><img src="https://habrastorage.org/getpro/habr/formulas/74f/54c/5dd/74f54c5dd986c71e76c7b52f247706ac.svg" alt="DICE $" data-tex="inline">  يساوي 0.35 ، و <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mrow" id="MJXp-Span-14"><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0.278em; margin-right: 0.278em;">ر</span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.278em; margin-right: 0.278em;">و</span></span><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.278em; margin-right: 0.278em;">ك</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-4"> روك</script>  - 0.93. <br><br><h1 style=";text-align:right;direction:rtl">  شظية ترميم </h1><br>  ساعدنا في حل هذه المشكلة مرة أخرى.  إلى المدخلات التي قدمناها له الصورة الأصلية وقناع نضع عليه علامات على المساحات النظيفة بوحدات ، وبكسلات البكسل التي نريد أن نرسم عليها بأصفار.  لقد جمعنا البيانات على النحو التالي: أخذنا من الإنترنت مجموعة كبيرة من البيانات تحتوي على صور ، على سبيل المثال ، OpenImagesV4 ، وعيوب إضافية مصطنعة تشبه في الشكل تلك الموجودة في الحياة الحقيقية.  وبعد ذلك قاموا بتدريب الشبكة لإصلاح الأجزاء المفقودة. <br><br>  كيف يمكننا تعديل Unet لهذه المهمة؟ <br><br>  يمكنك استخدام الالتواء الجزئي بدلاً من الإلتواء المعتاد.  فكرتها هي أنه عندما ننهار منطقة من صورة ذات نواة ، فإننا لا نأخذ في الاعتبار قيم البيكسل المتعلقة بالعيوب.  هذا يساعد على جعل اللوحة أكثر دقة.  مثال من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مقال NVIDIA</a> .  في الصورة المركزية ، استخدموا Unet مع الإلتواء المعتاد ، وعلى اليمين - مع الإلتفاف الجزئي: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a5/280/a4b/5a5280a4be71695d16ab08af876c5d23.png"><br><br>  قمنا بتدريب الشبكة لمدة 5 أيام.  في اليوم الأخير ، جمدنا BatchNorm ، مما ساعد على جعل حدود الجزء المطلي من الصورة أقل وضوحًا. <br><br>  تعالج الشبكة صورة 512 × 512 في 50 مللي ثانية.  التحقق من صحة PSNR هو 26.4.  ومع ذلك ، لا يمكن الوثوق بالمقاييس دون قيد أو شرط في هذه المهمة.  لذلك ، قمنا أولاً بتشغيل عدة نماذج جيدة على بياناتنا ، وقمنا بإخفاء الهوية عن النتائج ، ثم صوتنا للنماذج التي أحببناها أكثر.  لذلك اخترنا النموذج النهائي. <br><br>  ذكرت أننا أضفنا بشكل مصطنع العيوب لتنظيف الصور.  عند التدريب ، ستحتاج إلى مراقبة الحد الأقصى لحجم العيوب المتراكبة بعناية ، لأنه نظرًا لوجود عيوب كبيرة جدًا لم تشاهدها الشبكة مطلقًا في عملية التعلم ، فستتخيل بشكل كبير وتعطي نتيجة غير قابلة للتطبيق تمامًا.  لذلك ، إذا كنت بحاجة إلى الطلاء على عيوب كبيرة ، فقم أيضًا بتطبيق عيوب كبيرة أثناء التدريب. <br><br>  هنا مثال على الخوارزمية: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/abd/6cb/c8c/abd6cbc8c05396042bf83c00516b630e.png"><br><br><h1 style=";text-align:right;direction:rtl">  تلوين </h1><br>  قمنا بتجزئة العيوب ورسمها ، والخطوة الثالثة هي إعادة بناء اللون.  اسمحوا لي أن أذكرك أنه من بين صور "الفوج الخالد" هناك الكثير من الصور الفردية أو الجماعية.  وأردنا أن تعمل شبكتنا بشكل جيد معهم.  قررنا عمل تلوين خاص بنا ، لأن أيا من الخدمات المعروفة لنا يرسم صور بسرعة وبشكل جيد. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/015/bce/bf1/015bcebf15ef1ee069fdf08f16e00542.png"><br><br>  يحتوي GitHub على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع</a> شهير لتلوين الصور.  في المتوسط ​​، يقوم بهذا العمل بشكل جيد ، لكن لديه العديد من المشكلات.  على سبيل المثال ، يحب طلاء الملابس باللون الأزرق.  لذلك ، رفضناها أيضًا. <br><br>  لذلك ، قررنا إنشاء شبكة عصبية للتلوين.  الفكرة الأكثر وضوحا: التقاط صورة بالأبيض والأسود وتوقع ثلاث قنوات ، الأحمر والأخضر والأزرق.  ولكن ، بشكل عام ، يمكننا تبسيط عملنا.  لا يمكننا العمل مع تمثيل RGB للون ، ولكن مع تمثيل YCbCr.  المكون Y هو السطوع (لمى).  الصورة التي تم تنزيلها بالأبيض والأسود هي القناة Y ، وسوف نعيد استخدامها.  بقيت للتنبؤ Cb و Cr: Cb هو الفرق في اللون الأزرق والسطوع ، و Cr هو الفرق في اللون الأحمر والسطوع. <br><br><img src="https://habrastorage.org/webt/k8/ke/l_/k8kel_xrjco6euolh8ypkchjm8g.jpeg"><br><br>  لماذا اخترنا طريقة عرض YCbCr؟  العين البشرية أكثر عرضة للتغيرات في السطوع من التغييرات في الألوان.  لذلك ، نعيد استخدام المكون Y (السطوع) ، وهو ما تكون العين في البداية حساسة بشكل جيد للتنبؤ به Cb و Cr ، ونتوقع أن نرتكب فيه خطأ أكبر قليلاً ، لأن الناس يلاحظون أقل "كاذبة" في الألوان.  بدأت هذه الميزة تستخدم بنشاط في فجر التلفزيون الملون ، عندما لم يكن عرض النطاق الترددي للقناة كافياً لنقل جميع الألوان بالكامل.  تم نقل الصورة إلى YCbCr ، وتم نقلها إلى المكون Y بدون تغيير ، وتم ضغط Cb و Cr مرتين. <br><br><h1 style=";text-align:right;direction:rtl">  كيفية تجميع خط الأساس </h1><br>  يمكنك مرة أخرى استخدام برنامج Unet مع برنامج ترميز تم تدريبه مسبقًا وتقليل خسارة L1 بين CbCr الحقيقي والآخر المتوقع.  نريد تلوين صور ، لذلك بالإضافة إلى صور من OpenImages ، نحتاج إلى إضافة صور خاصة بمهمتنا. <br><br>  أين يمكنني الحصول على صور ملونة لأشخاص يرتدون الزي العسكري؟  هناك أشخاص على الإنترنت يرسمون الصور القديمة كهواية أو حسب الطلب.  يفعلون هذا بعناية فائقة ، في محاولة للامتثال الكامل لجميع الفروق الدقيقة.  تلوين الزي الرسمي ، الكتّاب ، الميداليات ، يلجأون إلى المواد الأرشيفية ، لذلك يمكن الوثوق بنتيجة أعمالهم.  في المجموع ، استخدمنا 200 صورة مرسومة باليد.  المصدر الثاني المفيد للبيانات هو موقع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجيش الأحمر للعمال والفلاحين</a> .  تم تصوير أحد مبدعيها في جميع المتغيرات الممكنة تقريبًا من الزي العسكري خلال الحرب الوطنية العظمى. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f72/999/7d9/f729997d9fd02755fd95967ff09d27ca.png"><br><br>  في بعض الصور الفوتوغرافية ، كرر أوضاع الأشخاص من صور المحفوظات الشهيرة.  من الجيد بشكل خاص أن يتم تصويره على خلفية بيضاء ، مما سمح لنا بزيادة البيانات بشكل جيد للغاية ، وإضافة العديد من الكائنات الطبيعية إلى الخلفية.  استخدمنا أيضًا صورًا عادية عادية للناس ، مكملة لهم بشارات وغيرها من سمات ملابس الحرب. <br><br>  قمنا بتدريب AlbuNet-50 - هذا هو Unet ، حيث يتم استخدام AlbuNet-50 كبرنامج ترميز.  بدأت الشبكة في إعطاء نتائج كافية: الجلد وردي ، والعينان رمادية اللون ، وأشرطة الكتف مصفرة.  لكن المشكلة هي أنها رسمت الصور بالبقع.  هذا يرجع إلى حقيقة أنه من وجهة نظر الخطأ L1 يكون في بعض الأحيان أكثر ربحية عدم القيام بأي شيء من محاولة التنبؤ ببعض الألوان. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/435/4a9/63c/4354a963c4cd2789c434002e44fdda26.png"><br>  <i>نحن نقارن نتائجنا مع صورة "الحقيقة الأساسية" - التلوين اليدوي للفنان تحت الاسم المستعار <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Klimbim</a></i> <br><br>  كيفية حل هذه المشكلة؟  نحتاج إلى أداة تمييز: شبكة عصبية ، والتي سنزود بها الصور بالإدخال ، وسوف توضح مدى واقعية هذه الصورة.  أدناه ، صورة واحدة مرسومة باليد ، والثانية بواسطة شبكة عصبية.  أي واحد رأيك؟ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/253/86a/abd/25386aabd9080c14daf71b60d9968453.png"><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">الجواب</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  تم رسم الصورة اليسرى يدويًا. <br></div></div><br>  بصفتك مُميِّزًا ، نستخدم أداة التمييز من المادة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GAN</a> .  هذه شبكة تلافيفية صغيرة ، في الطبقات الأخيرة منها ما يسمى بالانتباه الذاتي مدمج.  انها تسمح لك لمزيد من "الاهتمام" لتفاصيل الصورة.  نحن نستخدم أيضا التطبيع الطيفي.  يمكن العثور على الشرح والتحفيز الدقيق في المقال.  لقد قمنا بتدريب شبكة تضم مجموعة من L1 والخطأ الذي قام به المميّز.  الآن ترسم الشبكة تفاصيل الصورة بشكل أفضل ، والخلفية أكثر تناسقًا.  مثال آخر: على اليسار هو نتيجة الشبكة المدربة فقط مع خسارة L1 ، على اليمين - مع خسارة L1 وخطأ في التمييز. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa4/724/ada/aa4724ada4e0bbdc52dbcaadd5bb3fdc.png"><br><br>  على أربعة Geforce 1080Ti ، استغرق التدريب يومين.  عملت الشبكة في 30 مللي ثانية في الصورة 512 × 512. كان التحقق من صحة MSE 34.4.  كما في مشكلة inpainting ، المقاييس لا يمكن الوثوق بها بالكامل.  لذلك ، اخترنا 6 نماذج تحتوي على أفضل مقاييس للتحقق من الصحة ، وصوتنا بشكل أعمى لأفضل نموذج. <br><br>  بعد طرح النموذج في الإنتاج ، واصلنا التجارب وتوصلنا إلى نتيجة مفادها أنه من الأفضل تقليل خسارة L1 لكل بكسل ، ولكن خسارة الإدراك الحسي.  لحساب ذلك ، تحتاج إلى تشغيل التنبؤ بالشبكة والصورة المصدر عبر شبكة VGG-16 ، والتقاط خرائط السمة على الطبقات السفلية ومقارنتها وفقًا لـ MSE.  هذا النهج يرسم المزيد من المناطق ويساعد على الحصول على صورة أكثر سخونة. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db9/303/509/db93035094c4906cf82c246151432cbc.jpg"><br><br><h1 style=";text-align:right;direction:rtl">  الاستنتاجات والاستنتاج </h1><br>  Unet هو نموذج رائع.  في مشكلة التجزئة الأولى ، واجهنا مشكلة في التدريب والتعامل مع صور عالية الدقة ، لذلك نستخدم BatchNorm في الموقع.  في المهمة الثانية (Inpainting) ، بدلاً من الإلتواء المعتاد ، استخدمنا الالتفاف الجزئي ، وهذا ساعد على تحقيق نتائج أفضل.  في مشكلة تلوين Unet ، أضفنا شبكة تمييز صغيرة تغريم المولد للحصول على صورة غير واقعية وخسارة الإدراك الحسي. <br><br>  الاستنتاج الثاني هو أن الملحقات مهمة.  ليس فقط في مرحلة تمييز الصور قبل التدريب ، ولكن أيضًا في التحقق من صحة النتيجة النهائية ، لأنه في مشكلات عيوب الطلاء أو التلوين ، لا تزال بحاجة إلى التحقق من صحة النتيجة بمساعدة شخص ما.  نعطي المستخدم ثلاث صور: الصورة الأصلية مع العيوب التي تمت إزالتها ، الملونة مع العيوب التي تمت إزالتها ، والصورة الملونة فقط في حالة خوارزمية البحث عن عيوب الطلاء والرسم. <br><br>  التقطنا بعض الصور لمشروع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الألبوم العسكري</a> وقمنا بمعالجتها من خلال شبكاتنا العصبية.  وهنا النتائج التي تم الحصول عليها: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a51/ade/15e/a51ade15e9cee54ec8269dc1e22df0af.jpg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وهنا</a> يمكنك رؤيتها بدقة الأصلي وفي كل مرحلة من مراحل المعالجة. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar453872/">https://habr.com/ru/post/ar453872/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar453862/index.html">لماذا يجب عليك استخدام pathlib</a></li>
<li><a href="../ar453864/index.html">باستخدام الماوس ولوحة المفاتيح على لوحات المفاتيح هو الغش؟</a></li>
<li><a href="../ar453866/index.html">طلب API مع React Hooks أو HOC أو Render Prop</a></li>
<li><a href="../ar453868/index.html">المس مفتاح صغير بلوحة زجاجية على nRF52832</a></li>
<li><a href="../ar453870/index.html">نكتب عكس socks5 الوكيل على بوويرشيل</a></li>
<li><a href="../ar453874/index.html">من الروليت الروسية إلى LOTO الآمن: كيفية حماية موظفي مركز البيانات</a></li>
<li><a href="../ar453876/index.html">كما هو الحال في Yandex.Practicum ، فاز تصميم الواجهة الأمامية: رقم بهلواني مع Redux-Saga و postMessage و Jupyter</a></li>
<li><a href="../ar453882/index.html">دليل كبير حول مهنة مهندس الحلول (+ قائمة الروابط المفيدة)</a></li>
<li><a href="../ar453884/index.html">HYIP الكاميرا أو استبدال DSLR؟</a></li>
<li><a href="../ar453886/index.html">يعمل البرنامج</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>