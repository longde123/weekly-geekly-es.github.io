<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚óæÔ∏è üéÆ üìå Attaque DDoS via l'ing√©nierie sociale ‚ôåÔ∏è ü•¢ ü§∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR L'attaquant remplace l'ip source par l'adresse de votre serveur et d√©clenche des abus automatiques. En cons√©quence, le client est banni de l'h√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Attaque DDoS via l'ing√©nierie sociale</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/481496/"><img src="https://habrastorage.org/webt/i6/x7/om/i6x7omrejaehro4mws5isygnptk.jpeg"><br><br>  <b>TL; DR L'attaquant remplace l'ip source par l'adresse de votre serveur et d√©clenche des abus automatiques.</b>  <b>En cons√©quence, le client est banni de l'h√©bergement pour une activit√© malveillante qui n'√©tait pas l√†.</b> <br><br><blockquote>  <b>Commentaire de <a href="https://vdsina.ru/%3Fpartner%3Dhabr2">vdsina.ru</a> :</b> <br>  <i>Cet article a √©t√© √©crit par notre client, qui nous est venu d'un grand h√©bergeur apr√®s une attaque DDoS et a gentiment accept√© de partager cette histoire.</i> </blockquote><br>  Je vais vous parler d'une mani√®re √©tonnamment insidieuse d'attaques DDoS, que je n'ai jamais rencontr√©e auparavant.  Ce qui est insidieux, c'est qu'aucune attaque n'est effectu√©e sur le serveur de la victime elle-m√™me.  Au lieu de cela, l'attaquant provoque le fonctionnement de syst√®mes de d√©tection d'attaque tiers, for√ßant √† g√©n√©rer des plaintes compl√®tement r√©elles (dans les "abus" des gens du commun) √† votre serveur. <br><br>  Du c√¥t√© de l'h√©bergeur, il semble que vous soyez engag√© dans une activit√© malveillante, bien qu'en fait ce ne soit pas vrai.  Il s'est av√©r√© que de nombreux grands h√©bergeurs ne sont pas pr√™ts √† comprendre en profondeur les causes du probl√®me et pr√©f√®rent simplement vous bannir pour avoir enfreint les r√®gles. <br><br>  Cet article d√©taille ce type d'attaque dans un cas r√©el. <br><a name="habracut"></a><br><h2>  Chronologie </h2><br>  J'ai gard√© plusieurs projets personnels sur des serveurs VPS chez un h√¥te bien connu.  Une fois que j'ai re√ßu une lettre de lui: <br><br><blockquote>  <b># 9042382: Violation ToS - Activit√© malveillante</b> <br>  Bonjour <br><br>  Nous avons re√ßu un rapport d'activit√© malveillante provenant de votre serveur XXXX.  Nous vous demandons d'enqu√™ter sur cette question d√®s que possible.  Une fois votre enqu√™te termin√©e, veuillez r√©pondre √† ce ticket en r√©pondant aux questions suivantes: <br>  ... <br><pre><code class="plaintext hljs">Reported-From: abuse-out@checkdomain.de Category: info Report-Type: info Service: different services Version: 0.1 User-Agent: Checkdomain Express 0.19 Date: Fri, 26 May 2018 19:25:19 +0200 Source-Type: ipv4 Source: my-server-ip-xx-xxx Port: dif. Report-ID: dih3cefnp@checkdomain.de Schema-URL: http://www.blocklist.de/downloads/schema/info_0.1.1.json Attachment: text/plain DETAILS ZU DEN ATTACKEN/ST√ñRUNGEN | DETAILS OF THE ATTACKS (letzten 60 Tage / max. 100 St.) | (last 60 days / max. 100 hits) portflood: syn | | standby.checkdomain.de | VORHERIGE SPERREN DER IP-NUMMER | BANNED HISTORY OF THIS IP-NUMBER my-server-ip-xxx-xxx-xxx: this ip-number was never banned before AUZUG AUS SERVERLOGDATEI | EXCERPT FROM SERVER LOGFILE tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:41667 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:46208 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:13000 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:39104 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:55348 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:37266 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:60684 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:63878 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:50445 SYNRECV - tcp 0 0 85.10.207.190:80 my-server-ip-xx-xxx:56215 SYNRECV -</code> </pre> <br></blockquote><br>  O√π <b>my-server-ip-xx-xxx</b> est l'adresse IP du serveur. <br><br>  Dans celui-ci, l'h√©bergeur m'envoie une plainte re√ßue sur sa bo√Æte aux lettres abuse @ et demande instamment d'arr√™ter l'activit√© malveillante, sinon je serai bloqu√©.  Le journal joint montre une liste des connexions TCP au port 80 (HTTP) dans l'√©tat SYN RECEIVED.  Autrement dit, de mon serveur, il y a un flux SYN vers le serveur Web de quelqu'un. <br><br>  Ma premi√®re pens√©e est qu'ils m'ont pirat√© et que SYN flood vient de mon serveur.  Sous Linux, il existe des restrictions sur la gestion des sockets avec des droits d'utilisateur normaux et vous ne pouvez envoyer que des paquets SYN (sans √©tablir une connexion TCP compl√®te) uniquement avec les privil√®ges root.  Et cela signifie qu'ils ont compl√®tement craqu√©. <br><br>  Dans une panique, je cours vers le serveur pour rechercher un processus malveillant.  Je v√©rifie en haut, ss, lsof et ne vois rien de suspect.  La principale conclusion: " <i>horreur, ils ont probablement inond√© un rootkit tellement cool qui cache le virus au niveau du noyau de tous les utilitaires syst√®me!</i> ".  En cours de recherche, il s'av√®re que la charge sur le serveur n'a pas chang√©, selon les graphiques du panneau h√¥te, le trafic sur l'interface reste le m√™me. <br><br>  Avant cela, j'ai commenc√© <b>tcpdump</b> avec des filtres montrant le trafic sortant et je n'ai rien vu de suspect.  D√©sesp√©r√©, je d√©cide de voir tout le trafic vers le serveur.  Je trouve des paquets RST rares provenant de serveurs √©tranges dans le flux de trafic l√©gitime. <br><br>  Cela ressemble √† ceci, o√π <b>my-server-ip-xx-xxx est l'</b> adresse de mon serveur: <br><br><pre> <code class="plaintext hljs">IP 85.10.207.190.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP 85.10.207.190.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP 85.10.207.190.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP adsl-070-154.sip.pns.bellsouth.net.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP adsl-070-154.sip.pns.bellsouth.net.http &gt; my-server-ip-xx-xxx.8389: Flags [R] IP adsl-070-154.sip.pns.bellsouth.net.http &gt; my-server-ip-xx-xxx.8389: Flags [R]</code> </pre><br>  Il √©tait √©vident que c'√©tait une anomalie, car il n'y avait plus d'√©change avec ces serveurs et pourquoi ils avaient envoy√© un paquet pour fermer la connexion, ce n'√©tait pas clair pour moi. <br>  √Ä ce stade, les administrateurs exp√©riment√©s comprendraient imm√©diatement tout, mais nous allons tout r√©gler sur nos doigts <br><br><h2>  Comment √ßa marche </h2><br>  Les paquets RST entrants sont des r√©ponses aux tentatives d'√©tablissement d'une connexion TCP √† un port priv√©.  En m√™me temps, il n'y a pas de trafic sortant de mon serveur vers les serveurs qui envoient RST.  Cela signifie que l'attaquant remplace l'adresse sortante par la mienne et g√©n√®re un trafic similaire √† une attaque DDoS.  Mais comme la seule chose qu'un attaquant peut faire est d'envoyer un paquet sortant, toutes les r√©ponses des serveurs arrivent sur mon serveur. <br><br><img src="https://habrastorage.org/webt/nd/g7/a-/ndg7a-fdzrxswv3sjvd8jwvykym.png"><br>  <font color="999999"><sup>Seules les r√©ponses aux fausses demandes parviennent au serveur de la victime</sup></font> <br><blockquote>  En r√®gle g√©n√©rale, ces attaques sont utilis√©es pour <a href="https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/">l'amplification DNS</a> , lorsque l'attaquant envoie une petite demande au nom de la victime et que la victime re√ßoit une r√©ponse importante qu'il n'a pas demand√©e.  Il s'agit d'un m√©canisme d'attaque d'√©puisement de canal classique. </blockquote>  Dans mon cas, l'attaquant n'a pas cherch√© √† √©puiser le canal du serveur victime.  Son activit√© √©tait totalement invisible sur les graphiques de consommation de la cha√Æne.  Son objectif principal √©tait de provoquer des syst√®mes de notification automatique pour les attaques de r√©seau qui enverraient une lettre se plaignant de l'adresse d'abus sp√©cifi√©e dans le sous-r√©seau whois de mon fournisseur.  <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BE%25D0%25B1%25D0%25BD%25D0%25B0%25D1%2580%25D1%2583%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B2%25D1%2582%25D0%25BE%25D1%2580%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9">Les syst√®mes de pr√©vention / d√©tection intrusifs</a> tels que <a href="https://www.snort.org/">Snort</a> et <a href="https://suricata-ids.org/">Suricata peuvent le faire</a> . <br><br>  En cons√©quence, l'h√©bergeur re√ßoit une lettre absolument r√©elle de soci√©t√©s l√©gitimes, qui contient une plainte concernant mon activit√© malveillante et m√™me les vrais journaux qui s'y trouvent.  Dans le m√™me temps, l'attaquant n'a pas besoin d'un grand canal, car il conna√Æt √† l'avance les adresses des serveurs sur lesquels les syst√®mes IDS / IPS sont install√©s et le nombre minimum requis de paquets pour que la plainte automatique fonctionne. <br><br>  La seule difficult√© pour un attaquant est de trouver un serveur qui permette la substitution des adresses IP sortantes en paquets.  Tous les h√©bergeurs normaux bloquent ces paquets.  Il n'y a que deux types d'h√©bergement, permettant aux clients de remplacer l'IP sortante: soit configur√©e tr√®s illettr√©e, soit sp√©cialement cr√©√©e pour la cybercriminalit√©. <br><br><h2>  V√©rification de la possibilit√© d'usurpation d'adresse IP </h2><br>  Je vous conseille de v√©rifier votre h√¥te pour la possibilit√© de remplacer l'IP sortant.  Cela n√©cessitera deux serveurs, l'un pour la r√©ception du trafic, l'autre pour l'envoi. <br><br>  C√¥t√© serveur r√©cepteur, nous allons commencer √† enregistrer le trafic entrant.  Nous allons sp√©cifier un port rare comme filtre sur lequel il ne devrait pas y avoir de trafic en temps normal: <br><br><pre> <code class="plaintext hljs">tcpdump -i any port 9912</code> </pre><br>  Sur le serveur que nous testons, nous allons g√©n√©rer un package avec la substitution de l'adresse IP sortante √† <b>1.1.1.1</b> , dirig√©e vers le port 9912. Pour cela, nous utilisons l'utilitaire cool <a href="https://nmap.org/nping/">nping</a> des d√©veloppeurs nmap.  Il vous permet de g√©n√©rer des packages non standard au niveau L2 et L3. <br><br><pre> <code class="plaintext hljs">nping --tcp -p 9912 -S 1.1.1.1 receiver-server.com</code> </pre><br>  <b>receiver-server.com</b> - l'adresse du serveur d'√©coute ex√©cutant tcpdump <br>  <b>1.1.1.1</b> - adresse sortante de remplacement <br>  <b>9912</b> - Port distant <br><br>  Si du c√¥t√© de <b>receiver-server.com</b> vous voyez un paquet qui est venu au nom de 1.1.1.1, votre fournisseur vous permet de remplacer l'adresse IP sortante.  C'est l'occasion de l'informer des probl√®mes de mise en place des √©quipements r√©seau.  Ce probl√®me est souvent affect√© par les fournisseurs de services Internet √† domicile. <br><br><h2>  Support technique stupide </h2><br><br>  Apr√®s avoir compris les raisons des plaintes, j'ai tout d√©taill√© √† l'h√©bergeur: <br><blockquote>  Bonjour <br>  Je comprends enfin ce qui s'est pass√©. <br><br>  Ils usurpent mon adresse IP et les h√¥tes al√©atoires DDoS en utilisant mon adresse comme adresse source.  Les victimes g√©n√®rent donc des rapports d'abus automatiques √† mes h√©bergeurs. <br><br>  Vous pouvez voir sur le journal des abus que les connexions sont uniquement dans l'√©tat SYN_RECV (aucune connexion TCP compl√®te √©tablie) car elles ne peuvent envoyer qu'un seul paquet en utilisant une IP usurp√©e et ne peuvent pas terminer la n√©gociation TCP. <br>  Je peux le prouver.  De nombreux paquets TCP RST entrants arrivent actuellement sur mon serveur √† partir d'h√¥tes auxquels je n'ai jamais envoy√© de paquets. <br><br>  Vous pouvez le v√©rifier d√®s maintenant en ex√©cutant: <br><br>  tcpdump -i eth0 "tcp [tcpflags] &amp; (tcp-rst)! = 0" <br><br>  Vous verrez que de nombreux paquets RST provenaient d'h√¥tes auxquels je n'ai jamais envoy√© de donn√©es. <br>  Cela prouve que l'attaquant usurpe mon adresse IP pour me compromettre et g√©n√©rer des abus. <br></blockquote><br>  Il m'a alors sembl√© que tout ing√©nieur de support technique qualifi√© comprendrait la situation et la question serait close.  Mais √† la place, ils ont exig√© que je v√©rifie le serveur avec un logiciel antivirus ou que je r√©installe compl√®tement le syst√®me d'exploitation.  Alors que nous correspondions avec le support technique, les abus ont continu√© d'arriver et en un jour j'ai √©t√© banni. <br><br>  C'√©tait extr√™mement insultant que je sois en fait encadr√©.  Cette situation montre √† quel point les personnes sont vuln√©rables, qui, au lieu de comprendre, suivent sans r√©fl√©chir des scripts.  Depuis lors, je cite souvent ce cas √† titre d'exemple lorsque le d√©bat sur le choix d'un h√©bergement pour des projets importants appara√Æt.  Malheureusement, de nombreuses soci√©t√©s d'h√©bergement ne peuvent tout simplement pas se permettre de consacrer beaucoup de temps aux cas non standard de petits clients et il est plus facile de vous interdire que de r√©gler vos probl√®mes. <br><br> <a href="https://vdsina.ru/%3Fpartner%3D7d159c89hz"><img src="https://habrastorage.org/webt/ud/xv/wf/udxvwfcz80j3nug11rxaguqelww.png"><br></a> <br><h3>  Abonnez-vous √† notre d√©veloppeur Instagram </h3><br> <a href="http://bit.ly/34w4T9B"><img src="https://habrastorage.org/webt/e5/as/-l/e5as-ltfnotkemk2dsqngygimra.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481496/">https://habr.com/ru/post/fr481496/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481484/index.html">L'IA essayant d'√©viter les probl√®mes a appris un comportement complexe</a></li>
<li><a href="../fr481486/index.html">¬´Rester en vie, rester en vie¬ª: le nouveau protocole augmentera de 60 m√®tres le rayon de l'utilisation possible du Wi-Fi</a></li>
<li><a href="../fr481488/index.html">Comment les responsables de la r√©gion de Moscou mesurent la pollution atmosph√©rique</a></li>
<li><a href="../fr481490/index.html">Vitamine D. Une courte excursion</a></li>
<li><a href="../fr481492/index.html">Nous collectons de la musique en couleur pour le nouvel an</a></li>
<li><a href="../fr481500/index.html">Programmeur fanatique. R√©sum√© partie 3 + tableau abstrait. Planification et galets dans un seau d'eau</a></li>
<li><a href="../fr481502/index.html">Introduction aux actions GitHub</a></li>
<li><a href="../fr481506/index.html">Le condens√© de mat√©riaux int√©ressants pour le d√©veloppeur mobile # 327 (du 16 au 22 d√©cembre)</a></li>
<li><a href="../fr481510/index.html">Optimisation de Unity: comment la hi√©rarchie des sc√®nes vous vole</a></li>
<li><a href="../fr481514/index.html">Travailler avec la biblioth√®que Newtonsoft.Json avec un exemple r√©el. Partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>