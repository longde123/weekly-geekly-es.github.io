<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÇ ü§¶ ‚ñ∂Ô∏è Geschichte des ersten Platzes im ML Boot Camp VI üôåüèº üêå ‚§µÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seit vielen Jahren veranstaltet Mail.ru Meisterschaften f√ºr maschinelles Lernen, jedes Mal, wenn die Aufgabe auf ihre eigene Weise interessant und auf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Geschichte des ersten Platzes im ML Boot Camp VI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418743/">  Seit vielen Jahren veranstaltet Mail.ru Meisterschaften f√ºr maschinelles Lernen, jedes Mal, wenn die Aufgabe auf ihre eigene Weise interessant und auf ihre eigene Weise komplex ist.  Dies ist meine vierte Teilnahme an Wettbewerben, ich mag die Plattform und Organisation sehr und mit Bootcamps begann mein Weg zum wettbewerbsorientierten maschinellen Lernen, aber ich schaffte es zum ersten Mal, den ersten Platz zu belegen.  In dem Artikel werde ich Ihnen erkl√§ren, wie Sie ein stabiles Ergebnis ohne Umschulung in der √∂ffentlichen Rangliste oder bei verz√∂gerten Stichproben anzeigen k√∂nnen, wenn sich der Testteil erheblich vom Trainingsteil der Daten unterscheidet. <br><br><h2>  Herausforderung </h2><br>  Der vollst√§ndige Text der Aufgabe ist unter ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> verf√ºgbar.  Kurz gesagt: Es gibt 10 GB Daten, wobei jede Zeile drei JSON-Typen von "Schl√ºssel: Z√§hler", eine bestimmte Kategorie, einen bestimmten Zeitstempel und eine bestimmte Benutzer-ID enth√§lt.  Mehrere Eintr√§ge k√∂nnen einem Benutzer entsprechen.  Es muss festgelegt werden, zu welcher Klasse der Benutzer geh√∂rt, die erste oder die zweite.  Die Qualit√§tsmetrik f√ºr das Modell ist ROC-AUC, dar√ºber ist im Blog von Alexander Dyakonov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[1]</a> gut geschrieben. <br><br>  Beispiel Dateieintrag <br><br><pre><code class="hljs go"><span class="hljs-number"><span class="hljs-number">00000d</span></span>2994b6df9239901389031acaac <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"809001"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"848545"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"565828"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"490363"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>} {<span class="hljs-string"><span class="hljs-string">"85789"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"238490"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"32285"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"103987"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"16507"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"6477"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"92797"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>} {} <span class="hljs-number"><span class="hljs-number">39</span></span></code> </pre> <a name="habracut"></a><br><h2>  L√∂sung </h2><br>  Die erste Idee eines Datenwissenschaftlers, der erfolgreich einen Datensatz heruntergeladen hat, besteht darin, JSON-Spalten in eine sp√§rliche Matrix umzuwandeln.  Zu diesem Zeitpunkt hatten viele Teilnehmer Probleme mit einem Mangel an RAM.  Bei der Bereitstellung einer einzigen Spalte in Python war der Speicherverbrauch h√∂her als bei einem durchschnittlichen Laptop. <br><br>  Einige trockene Statistiken.  Die Anzahl der eindeutigen Schl√ºssel in jeder Spalte betr√§gt 2053602, 20275, 1057788. Dar√ºber hinaus gibt es im Zugteil und im Testteil nur 493866, 20268, 141931. 427994 eindeutige Benutzer im Zug und 181024 im Testteil.  Ungef√§hr 4% der Klasse 1 im Trainingsteil. <br><br>  Wie Sie sehen k√∂nnen, haben wir viele Schilder. Die Verwendung aller Schilder ist ein offensichtlicher Weg, um im Zug zu √ºberpassen, da beispielsweise Entscheidungsb√§ume Kombinationen von Schildern verwenden und es noch einzigartigere Kombinationen einer so gro√üen Anzahl von Schildern gibt und fast alle nur im Trainingsteil existieren Daten oder im Test.  Eines der Grundmodelle, das ich hatte, war Lightgbm mit Colsample ~ 0.1 und sehr strenger Regularisierung.  Trotz der enormen Parameter der Regularisierung zeigte sich jedoch ein instabiles Ergebnis im √∂ffentlichen und privaten Bereich, wie sich nach dem Ende des Wettbewerbs herausstellte. <br><br>  Der zweite Gedanke der Person, die sich f√ºr die Teilnahme an diesem Wettbewerb entschieden hat, w√§re wahrscheinlich, den Zug zu sammeln und zu testen und Informationen nach Kennungen zu aggregieren.  Zum Beispiel die Menge.  Oder maximal.  Und hier stellt sich heraus, dass Mail.ru zwei sehr interessante Dinge f√ºr uns erfunden hat.  Erstens kann der Test mit sehr hoher Genauigkeit klassifiziert werden.  Selbst laut Statistiken √ºber die Anzahl der Eintr√§ge f√ºr cuid und die Anzahl der eindeutigen Schl√ºssel in json √ºbertrifft der Test den Zug erheblich.  Der Basisklassifikator ergab 0,9+ roc-auc bei der Testerkennung.  Zweitens machen Z√§hler keinen Sinn, fast alle Modelle wurden besser, indem sie von Z√§hlern zu bin√§ren Vorzeichen der Form wechselten: Es gibt / gibt keinen Schl√ºssel.  Sogar die B√§ume, die theoretisch nicht schlechter sein sollten, weil es anstelle einer Einheit eine bestimmte Anzahl gibt, scheinen f√ºr Z√§hler umgeschult zu werden. <br><br>  Die Ergebnisse in der √∂ffentlichen Rangliste √ºbertrafen die Ergebnisse der Kreuzvalidierung bei weitem.  Dies lag anscheinend daran, dass es f√ºr das Modell einfacher war, die Rangfolge von zwei Datens√§tzen im Test zu erstellen als im Zug, da eine gr√∂√üere Anzahl von Zeichen mehr Begriffe f√ºr die Rangfolge ergab. <br><br>  Zu diesem Zeitpunkt wurde v√∂llig klar, dass die Validierung in diesem Wettbewerb keine einfache Sache ist und weder √∂ffentliche Informationen noch Lebensl√§ufe anderer Teilnehmer, die im offiziellen Chat zur Verlockung verleitet werden k√∂nnten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[2]</a> .  Warum ist es passiert?  Es scheint, dass der Zug und der Test durch die Zeit getrennt sind, was sp√§ter von den Organisatoren best√§tigt wurde. <br><br>  Jedes erfahrene Kaggle-Mitglied wird sofort die gegnerische Validierung empfehlen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[3]</a> , aber es ist nicht so einfach.  Trotz der Tatsache, dass die Genauigkeit des Klassifikators f√ºr Zug und Test durch die Metrik roc-auc nahe 1 liegt, gibt es im Zug nicht viele √§hnliche Eintr√§ge.  Ich habe versucht, cuid-aggregierte Stichproben mit demselben Ziel zusammenzufassen, um die Anzahl der Datens√§tze mit einer gro√üen Anzahl eindeutiger Schl√ºssel in json zu erh√∂hen. Dies f√ºhrte jedoch sowohl bei der Kreuzvalidierung als auch in der √ñffentlichkeit zu Nachteilen, und ich hatte Angst, solche Modelle zu verwenden. <br><br>  Es gibt zwei M√∂glichkeiten: Suchen Sie mit unbeaufsichtigtem Lernen nach ewigen Werten oder versuchen Sie, Funktionen zu √ºbernehmen, die f√ºr den Test wichtiger sind.  Ich bin in beide Richtungen gegangen und habe TruncatedSVD verwendet, um unbeaufsichtigt zu sein und Funktionen nach H√§ufigkeit im Test auszuw√§hlen. <br><br>  Im ersten Schritt habe ich jedoch einen tiefen Autoencoder erstellt, aber ich habe mich geirrt, als ich zweimal dieselbe Matrix verwendet habe. Ich konnte den Fehler nicht beheben und den vollst√§ndigen Vorzeichensatz verwenden: Der Eingangstensor passte bei keiner dichten Schichtgr√∂√üe in den GPU-Speicher.  Ich habe einen Fehler gefunden und sp√§ter nicht versucht, Funktionen zu codieren. <br><br>  Ich habe SVD auf alle erdenklichen Arten generiert: auf dem Originaldatensatz mit cat_feature und der anschlie√üenden Summierung durch cuid.  F√ºr jede Spalte separat.  Von tf-idf auf json als Wortsack <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[4]</a> (hat nicht geholfen). <br><br>  F√ºr eine gr√∂√üere Vielfalt habe ich versucht, eine kleine Anzahl von Merkmalen im Zug auszuw√§hlen, wobei A-NOVA f√ºr den Zugteil jeder Falte in der Kreuzvalidierung verwendet wurde. <br><br><h2>  Modelle </h2><br>  Die wichtigsten Basismodelle: lightgbm, vowpal wabbit, xgboost, SGD.  Au√üerdem habe ich mehrere neuronale Netzwerkarchitekturen verwendet.  Dmitry Nikitko, der an erster Stelle der √∂ffentlichen Rangliste stand, empfahl die Verwendung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HashEmbeddings</a> . Dieses Modell zeigte nach einiger Auswahl von Parametern ein gutes Ergebnis und verbesserte das Ensemble. <br><br>  Ein weiteres neuronales Netzwerkmodell mit der Suche nach Interaktionen (Faktorisierungsmaschinenstil) zwischen 3-4-5 Datenspalten (drei linke Eingaben), numerischen Statistiken (4 Eingaben), SVD-Matrix (5 Eingaben). <br><br><img src="https://habrastorage.org/webt/g5/xb/yp/g5xbypjhkxazihg5vfcd7mglya0.png"><br><br><h2>  Ensemble </h2><br>  Ich habe alle Modelle nach Falten gez√§hlt und die Testvorhersagen von Modellen gemittelt, die auf verschiedenen Falten trainiert wurden.  Zugvorhersagen wurden zum Stapeln verwendet.  Das beste Ergebnis zeigte der Level 1-Stack mit xgboost bei den Vorhersagen der Basismodelle und 250 Attributen aus jeder JSON-Spalte, die entsprechend der H√§ufigkeit ausgew√§hlt wurden, mit der sich das Attribut im Test traf. <br><br>  Ich habe ungef√§hr 30 Stunden meiner Zeit mit der L√∂sung verbracht und mich auf einen Server mit 4 Core-i7-Kernen, 64 Gigabyte RAM und einer GTX 1080 verlassen. Infolgedessen erwies sich meine L√∂sung als ziemlich stabil und ich wechselte vom dritten Platz in der √∂ffentlichen Rangliste zum ersten privaten. <br><br>  Ein wesentlicher Teil des Codes ist auf einem Bitbucket in Form von Laptops verf√ºgbar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[5]</a> . <br><br>  Ich m√∂chte Mail.ru f√ºr interessante Wettbewerbe und anderen Teilnehmern f√ºr die interessante Kommunikation in der Gruppe danken! <br><br>  [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ROC-AUC auf dem Blog von Aleksandrov Dyakonov</a> <br>  [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Offizieller Chat ML BootCamp Beamter</a> <br>  [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Widerspr√ºchliche Validierung</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wortsack</a> <br>  [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode f√ºr die meisten Modelle</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418743/">https://habr.com/ru/post/de418743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418733/index.html">Visualisierung der Kommentare von YouTube-Kan√§len internationaler und lokaler Touhou-Communities</a></li>
<li><a href="../de418735/index.html">Konzentration auf Eigentum</a></li>
<li><a href="../de418737/index.html">Laserablation, Telluritglas und Dotierstoff Er2O3</a></li>
<li><a href="../de418739/index.html">Additive Technology Center: Industrielle 3D-Drucker 3D-Systeme, Stratasys, SLM, EOS</a></li>
<li><a href="../de418741/index.html">F√ºgen Sie die Verschl√ºsselung hinzu und dr√ºcken Sie auf regul√§res SIP</a></li>
<li><a href="../de418747/index.html">Probleml√∂sung: Wie k√∂nnen Probleme in einem Team effektiv gel√∂st werden?</a></li>
<li><a href="../de418751/index.html">Dex frecher chinesischer Spion</a></li>
<li><a href="../de418753/index.html">vSAN in der VMware Cloud</a></li>
<li><a href="../de418755/index.html">Wie E-Commerce gro√ü angelegte Werbeaktionen √ºberlebt. Vorbereitung auf Spitzenlasten im Web [Teil 1]</a></li>
<li><a href="../de418757/index.html">Ausd√ºnnende Zeitrahmen (Kryptow√§hrungen, Devisen, B√∂rsen)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>