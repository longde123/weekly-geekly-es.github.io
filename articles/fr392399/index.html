<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôçüèª üêú üßú Espruino: JavaScript dans le microcontr√¥leur üë©üèª‚Äçüíº üë®üèø‚ÄçüöÄ üëä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Pourquoi?", "Quelle absurdit√©?", "Perversion!", "Fu-Fu-Fu" - ce sont quelques-unes des nombreuses d√©clarations que nous avons entendues lorsque nous ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Espruino: JavaScript dans le microcontr√¥leur</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/amperka/blog/392399/"><img src="https://habrastorage.org/files/d7a/aae/106/d7aaae106a9549d299c70a245bd412f4.png" alt="image" align="right"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Pourquoi?", "Quelle absurdit√©?", "Perversion!", "Fu-Fu-Fu" - ce sont quelques-unes des nombreuses d√©clarations que nous avons entendues lorsque nous avons publi√© la carte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iskra JS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le noyau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espruino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque le bon ing√©nieur en √©lectronique entend que quelque chose a √©t√© fait sur l'Arduino, sa temp√©rature corporelle augmente d'environ un demi-degr√©: ¬´ils ont pris un microcontr√¥leur appropri√© et au lieu de figak figak et les registres en extraient tous les jus, tout vulgaris√© ... il n'y a pas de mots, un la haine. " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vous pouvez aller encore plus loin. Prenez le microcontr√¥leur Cortex M4, qui est dix fois plus riche que ce qui se trouve sur le m√™me Arduino Uno, poussez-y l'interpr√©teur JavaScript et faites les projets JavaScript! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense qu'en ce moment, ceux qui ne sont pas pr√™ts pour un tel abus de saints microcircuits ont d√©j√† √©clat√©. Je vais continuer pour le reste.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le passe-temps √©lectronique pour la grande majorit√© des projets, l'Arduino Uno est suffisant pour les yeux. Et cela n'a m√™me pas d'importance si cela fonctionne √† la fr√©quence standard de 16 MHz ou 4 MHz: peu importe si les lumi√®res du lit s'allument ou la pompe du chalet en 1 ms ou 10 ms. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui compte, c'est que C ++ est complexe et bois√©. Oui, il est proche du fer, mais c'est pourquoi il n√©cessite une connaissance approfondie de ce fer et de l'informatique. Ajoutez √† cela la syntaxe avec un tas de nuances, qui est la somme des erreurs du d√©veloppement du langage sur 30 ans. Ensuite, nous privons ce qui s'est av√©r√© √™tre des tableaux, des cha√Ænes, des dictionnaires ad√©quats et encore mieux - en g√©n√©ral, nous privons la m√©moire dynamique. Ici, enfin, nous avons eu l'Arduino.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En regardant les questions sur notre forum, je vois que les gens passent du temps √† baiser avec la langue, et non sur l'essence de leurs projets. </font><font style="vertical-align: inherit;">Alors pourquoi ne pas r√©duire l'√©cart entre le fer et les gens? </font><font style="vertical-align: inherit;">Le fer est bon march√© et en constante √©volution, le temps des gens est cher et ne vient de nulle part.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai observ√© un processus similaire pendant de nombreuses ann√©es tout en travaillant dans le d√©veloppement de jeux. </font><font style="vertical-align: inherit;">En 2003, il √©tait impossible d'imaginer que le jeu puisse √™tre √©crit sur autre chose que C / C ++. </font><font style="vertical-align: inherit;">Ensuite, le script int√©gr√© de la machine est apparu dans les moteurs. </font><font style="vertical-align: inherit;">Et puis la cr√©ation d'un produit √† part enti√®re est devenue possible sans une seule ligne en C. </font><font style="vertical-align: inherit;">Uniquement Java, C #, Ruby, Python, JavaScript. </font><font style="vertical-align: inherit;">C'est logique, car le fer a commenc√© √† tirer des "langages lents", et en raison du d√©veloppement plus rapide et des programmeurs plus disponibles, il est devenu possible de consacrer plus de ressources √† l'int√©r√™t du jeu et non √† la recherche de fuites de m√©moire.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä quoi ressemble la programmation du microcontr√¥leur JavaScript</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La programmation est comme ... JavaScript. </font><font style="vertical-align: inherit;">Pour le d√©veloppement de navigateur ou Node.js. </font><font style="vertical-align: inherit;">Voici un exemple:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// SMS</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sim = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@amperka/Sim900r'</span></span>).connect();<font></font>
sim.powerOn();<font></font>
sim.on(<span class="hljs-string"><span class="hljs-string">'sms'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sms</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rgb = sms.text.split(<span class="hljs-string"><span class="hljs-string">' '</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = +rgb[<span class="hljs-number"><span class="hljs-number">0</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> g = +rgb[<span class="hljs-number"><span class="hljs-number">1</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = +rgb[<span class="hljs-number"><span class="hljs-number">2</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">isNaN</span></span>(r + g + b)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;<font></font>
    fadeTo(r, g, b);<font></font>
});<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// </span></span>
SPI2.setup({<span class="hljs-attr"><span class="hljs-attr">baud</span></span>:<span class="hljs-number"><span class="hljs-number">3200000</span></span>, <span class="hljs-attr"><span class="hljs-attr">mosi</span></span>:B15});
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> LED_COUNT = <span class="hljs-number"><span class="hljs-number">150</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> colors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8ClampedArray</span></span>(LED_COUNT * <span class="hljs-number"><span class="hljs-number">3</span></span>);<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fadeTo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r, g, b</span></span></span><span class="hljs-function">) </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ivalID = setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{<font></font>
    colors[n*<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>] = b;<font></font>
    colors[n*<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>] = r;<font></font>
    colors[n*<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span>] = g;<font></font>
    SPI2.send4bit(colors, <span class="hljs-number"><span class="hljs-number">0b0001</span></span>, <span class="hljs-number"><span class="hljs-number">0b0011</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n++ &gt;= LED_COUNT) {<font></font>
      clearInterval(ivalID);<font></font>
    }<font></font>
  }, <span class="hljs-number"><span class="hljs-number">50</span></span>);<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce programme s'engage √† recevoir des SMS'ki et en fonction de leur texte avec un feu de circulation change la couleur de la bande RVB connect√©e. </font><font style="vertical-align: inherit;">Nous avons fait un tel projet pour notre arbre du Nouvel An, mais sur l'Arduino classique. </font><font style="vertical-align: inherit;">Le code √©tait 4 fois plus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noyau Espruino</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'ordinateur dispose de moteurs V8 et SpiderMonkey pour JavaScript. </font><font style="vertical-align: inherit;">Et les microcontr√¥leurs ont un moteur Espruino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En gros, le moteur Espruino est un micrologiciel (croquis, croquis) pour microcontr√¥leurs, qui √† son tour peut ex√©cuter du code JavaScript que vous transf√©rez √† la carte via une connexion s√©rie, par exemple via USB. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espruino est un projet open source parrain√© par Gordon Williams. </font><font style="vertical-align: inherit;">La personne qui a impl√©ment√© √† elle seule la majeure partie de l'√©cosyst√®me entier et l'a accompagn√©e avec succ√®s sur KickStarter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet √©cosyst√®me se compose de plusieurs parties principales:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espruino Web IDE - un environnement de programmation; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware Espruino - Machine JavaScript qui fonctionne sur un microcontr√¥leur; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fer - les planches elles-m√™mes qui sont compatibles avec Espruino; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioth√®que standard et biblioth√®ques externes; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La documentation </font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement de programmation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©criture de code JavaScript, son t√©l√©chargement sur la carte et la surveillance de la sortie ont lieu dans l'ESP Web Espruino. </font><font style="vertical-align: inherit;">Cette application est pour Google Chrome, elle est donc mise en 1 clic et fonctionne sous tous les OS de bureau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'utilisateur, cet environnement remplace l'IDE Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon les fonctionnalit√©s de l'ESpruino IDE, bien s√ªr, il est beaucoup plus simple que Eclipse ou Visual Studio √† part enti√®re, mais il est plus avanc√© que l'IDE Arduino.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6c8/0ca/a0c/6c80caa0c1544157bff5331460014f16.png" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous regardez autour de la fen√™tre d'environnement en un coup d'≈ìil, vous verrez l'√©diteur de code (√† droite), le panneau de la console (√† gauche) et le bouton pour t√©l√©charger le code sur la carte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La console est comme un moniteur s√©rie dans l'IDE Arduino, mais contrairement √† elle, non seulement elle s'affiche, mais elle accepte √©galement: vous pouvez appeler une fonction directement, sans r√©initialiser et charger un nouveau programme, voir la valeur de la variable, interrompre le cycle, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir travaill√© plus √©troitement, vous rencontrerez un d√©bogueur (ouais, ex√©cution √©tape par √©tape, points d'arr√™t), des conseils d'√©diteur, des erreurs clignotantes √† la vol√©e et d'autres astuces int√©ressantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, directement √† partir de l'EDI, vous pouvez mettre √† jour la version du microprogramme Espruino elle-m√™me vers la derni√®re version. </font><font style="vertical-align: inherit;">L'environnement lui-m√™me t√©l√©charge la derni√®re version disponible et la t√©l√©charge via USB.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le c≈ìur du syst√®me est le firmware qui tourne sur le microcontr√¥leur. </font><font style="vertical-align: inherit;">Il est √©crit en C pur, il est charg√© une fois dans un endroit s√©par√© de la m√©moire flash du microcontr√¥leur et s'engage √† ex√©cuter le code JS utilisateur qui passe par une connexion s√©rie ou se trouve dans la zone utilisateur de la m√©moire flash. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous d√©crivons sch√©matiquement la disposition de la m√©moire flash pour Iskra JS, nous obtenons l'image suivante:</font></font><br>
<br>
<img src="https://habrastorage.org/files/89c/084/d48/89c084d486f3478fa8f3c7584b83b97d.png" alt="image"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bootloader</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient d'abord le chargeur de d√©marrage, qui n'est jamais mis √† jour (conditionnellement). </font><font style="vertical-align: inherit;">Il s'agit d'un petit programme dont l'ex√©cution est toujours toujours d√©marr√©e apr√®s la mise sous tension ou la r√©initialisation du microcontr√¥leur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le chargeur de d√©marrage fait une chose assez simple:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le bouton utilisateur BTN1 n'est pas enfonc√©, il transf√®re imm√©diatement le contr√¥le √† l'interpr√©teur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le bouton a √©t√© enfonc√© au d√©marrage, il se boucle sur lui-m√™me et attend soit que le bouton soit √† nouveau enfonc√© pour quitter l'interpr√©teur, soit il attend que la nouvelle version de l'interpr√©teur soit t√©l√©charg√©e via USB. </font><font style="vertical-align: inherit;">Dans ce cas, le chargeur de d√©marrage remplacera la zone de m√©moire flash avec le microprogramme Espruino et nous obtiendrons la derni√®re version de l'interpr√©teur sur la carte.</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interpr√®te</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le chargeur est suivi d'un interpr√®te, qui fait le travail principal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'il d√©marre, il v√©rifie en v√©rifiant l'octet magique s'il y a du code JavaScript stock√© dans la m√©moire flash de l'utilisateur. </font><font style="vertical-align: inherit;">S'il y en a, il est accept√© de l'ex√©cuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il n'y a pas de code, ou si nous avons quitt√© manuellement le chargeur de d√©marrage √† l'aide de BTN1, rien ne sera ex√©cut√© √† la r√©union, nous obtenons simplement une machine JS pr√™te pour le travail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©moire libre</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s l'interpr√©teur, il existe une zone de m√©moire que vous pouvez utiliser pour le stockage non volatile de vos donn√©es. </font><font style="vertical-align: inherit;">C'est une sorte de remplacement de l'EEPROM par Arduino, mais avec ses propres sp√©cificit√©s, ainsi que ses dizaines √† des centaines de fois plus.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code personnalis√©</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est l√† que le programme JS ex√©cut√© par l'interpr√©teur est stock√©. </font><font style="vertical-align: inherit;">Le programme est l√† en clair, en une seule briquette, comme √ßa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour qu'un grand nombre de biblioth√®ques connect√©es avec leurs d√©pendances et votre propre programme se transforment en une seule briquette cast et minifi√©e, il surveille le chargement de l'EDI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au contraire, tout le travail n'est pas effectu√© par l'IDE, mais par son composant ind√©pendant de l'interface graphique d'EspruinoTools, qui poss√®de une interface de ligne de commande et un point d'entr√©e √† utiliser comme module Node.js. </font><font style="vertical-align: inherit;">Par cons√©quent, si vous le souhaitez, vous pouvez utiliser Vim, Atom, Eclipse ou tout ce qui vous convient le mieux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu du code, au lieu d'une briquette de texte, il peut y avoir une distribution binaire stock√©e de RAM, qui refl√®te pleinement l'√©tat de l'interpr√©teur au moment de l'enregistrement. </font><font style="vertical-align: inherit;">Mais ce sont d√©j√† des d√©tails techniques pas pour un aper√ßu rapide.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioth√®ques</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les biblioth√®ques peuvent √™tre divis√©es en 3 types: standard, int√©gr√© et externe.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioth√®que standard</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La biblioth√®que standard comprend des fonctions et des objets qui peuvent √™tre utilis√©s. </font><font style="vertical-align: inherit;">Parmi eux, √† la fois familier et prescrit dans le langage standard `Date`,` JSON`, `Math`,` Object`, `setInterval`,` setTimeout` et d'autres-autres, ainsi que des fonctions sp√©cifiques √† Espruino pour travailler avec des broches, des interfaces par m√©moire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les fonctions, vous trouverez le familier de l'arduino `pinMode`,` digitalRead`, `digitalWrite`,` analogRead`, `analogWrite`, ainsi que le pas si familier` setWatch` pour surveiller les broches d'entr√©e,` digitalPulse` pour la g√©n√©ration exacte d'une s√©quence d'impulsions num√©riques et beaucoup plus de choses diff√©rentes pour travailler avec des p√©riph√©riques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, malgr√© le fait qu'il existe une fonction `pinMode` sur la plate-forme, par d√©faut, elle fonctionne d'elle-m√™me, dans les coulisses, donc dans la plupart des sc√©narios, vous ne vous en souvenez pas (le dernier ing√©nieur en √©lectronique a √©clat√© fort √† ce stade). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce que vous ne trouverez pas dans la biblioth√®que standard est ¬´delay¬ª. Mamma Mia, comme je suis reconnaissante pour √ßa! Il suffit de r√©organiser un peu la pens√©e et il devient clair que tout est r√©solu via `setInterval`,` setTimeout` sans aucun `delay`. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En reconnaissance, vous obtenez une ex√©cution asynchrone: vous pouvez faire clignoter vingt LED ind√©pendamment, chacune avec sa propre fr√©quence. Et vous obtenez une efficacit√© √©nerg√©tique: ¬´retard¬ª br√ªle le temps du processeur, et sans ¬´retard¬ª le processeur peut dormir paisiblement alors qu'il n'y a rien √† faire. √Ä Espruino, alors qu'il n'y a pas de travail, le processeur s'endort et consomme des dizaines de fois moins de courant.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioth√®ques int√©gr√©es</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les biblioth√®ques int√©gr√©es sont la m√™me partie de la biblioth√®que standard dans le sens o√π elles sont cod√©es en dur dans le microprogramme Espruino, mais l'acc√®s √† leurs fonctionnalit√©s n√©cessite de les connecter syntaxiquement √† l'aide de la fonction `require 'famili√®re aux programmeurs JavaScript. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi ces biblioth√®ques, vous trouverez, par exemple, ¬´fs¬ª pour travailler avec les syst√®mes de fichiers des cartes SD, ¬´http¬ª pour cr√©er une interface Web pour votre appareil, ¬´Waveform¬ª pour enregistrer / lire des signaux audio et autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les biblioth√®ques standard et int√©gr√©es sont impl√©ment√©es en C pur, et l'utilisateur ne dispose que d'une interface JavaScript sous la forme d'un ensemble d'objets, de fonctions et de modules. </font><font style="vertical-align: inherit;">Cela vous permet d'atteindre une efficacit√© maximale pour la mise en ≈ìuvre d'algorithmes complexes, tout en laissant la possibilit√© d'y acc√©der √† partir de code de haut niveau.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez vous-m√™me impl√©menter quelque chose en C que JavaScript dirait ¬´non, merci¬ª et ne faire ressortir que quelques queues n√©cessaires √† l'ex√©cution.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioth√®ques externes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les biblioth√®ques externes sont ce qui fa√ßonne la richesse des √©cosyst√®mes. </font><font style="vertical-align: inherit;">Ils sont √©crits en JavaScript par les auteurs d'Espruino, nous √©crivons, les utilisateurs d'Espruino √©crivent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils peuvent √™tre stock√©s sur un disque local, dans le bac √† sable du projet en cours, peuvent √™tre dans le r√©f√©rentiel Internet, peuvent √™tre sur GitHub, peuvent √™tre sur NPM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les biblioth√®ques sont connect√©es, traditionnellement, en utilisant `require '. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque l'environnement voit `require ', il les t√©l√©charge r√©cursivement √† partir d'une source distante et, lors du chargement d'une esquisse, colle leur contenu au d√©but de votre programme. </font><font style="vertical-align: inherit;">Ainsi, pour le microcontr√¥leur, une briquette int√©grale se forme avec le code dont j'ai parl√© plus haut.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette approche signifie √©galement que, contrairement √† Arduino, l'utilisateur n'a pas besoin de tr√©bucher sur le fait que pour commencer, la biblioth√®que doit √™tre trouv√©e, t√©l√©charg√©e, mise l√† o√π elle doit. </font><font style="vertical-align: inherit;">Il suffit de claquer l'esquisse que vous aimez quelque part et l'environnement lui-m√™me traitera les d√©pendances de la biblioth√®que.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous arrivons donc √† la composante la plus tangible de l'√©cosyst√®me Espruino. </font><font style="vertical-align: inherit;">Ce sont les cartes qui peuvent ex√©cuter le microprogramme Espruino.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/afb/b7e/d24/afbb7ed24c6f45c1a4c9a0b1069f58ec.jpg" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit notamment de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carte Espruino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> originale </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espruino Pico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ainsi que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iskra JS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> publi√© par Amperka </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tout est d√©j√† install√© en usine sur les cartes list√©es, elles sont imm√©diatement pr√™tes pour le travail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez appuyer plusieurs fois sur le tambourin et installer ind√©pendamment le noyau Espruino sur le STM32 Discovery, le Nucleo et, tout √† coup, sur l'ESP8266.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La documentation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a rien de plus triste que quelque chose de tr√®s cool et puissant, mais sans documentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espruino a une assez bonne documentation. </font><font style="vertical-align: inherit;">Sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.espruino.com/Reference,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous trouverez de nombreux articles de r√©f√©rence et de formation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voulons faire plus et mieux. </font><font style="vertical-align: inherit;">Par cons√©quent, nous avons cr√©√© une section distincte: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">js.amperka.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tournage de didacticiels vid√©o. </font><font style="vertical-align: inherit;">Les travaux sont en cours, mais beaucoup a d√©j√† √©t√© couvert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et traditionnellement pour ceux qui aiment les solutions en bo√Æte, nous avons cr√©√© un ensemble de " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iodo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">Il contient Iskra JS, des modules et un livre de couleurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un persil. </font><font style="vertical-align: inherit;">Le seul myst√®re est de savoir si au moins un bon ing√©nieur en √©lectronique pourrait lire jusqu'√† cette ligne?</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr392399/">https://habr.com/ru/post/fr392399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr392383/index.html">√Ä quel point il est facile de pirater Android non chiffr√©, ou pourquoi il vaut toujours la peine d'√™tre chiffr√©</a></li>
<li><a href="../fr392387/index.html">¬´–Ø–Ω–¥–µ–∫—Å. –ö–∞—Ä—Ç—ã¬ª –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ –≤–µ–∫—Ç–æ—Ä</a></li>
<li><a href="../fr392389/index.html">Mettre en place une salle de conf√©rence en l'honneur de la Journ√©e de la science russe le 24 avril</a></li>
<li><a href="../fr392391/index.html">Journal papier Trollim</a></li>
<li><a href="../fr392395/index.html">Le ransomware ¬´Petya¬ª crypte l'int√©gralit√© du disque dur et n√©cessite de l'argent</a></li>
<li><a href="../fr392401/index.html">La myst√©rieuse plan√®te X pourrait √™tre captur√©e par le Soleil √† partir d'un autre syst√®me stellaire</a></li>
<li><a href="../fr392403/index.html">Likbez sur les gadgets Xiaomi pr√©sent√©s sur AliExpress</a></li>
<li><a href="../fr392405/index.html">Les scientifiques ont pu contr√¥ler la vitesse du scarab√©e en implantant des √©lectrodes dans ses muscles</a></li>
<li><a href="../fr392407/index.html">Microsoft a commenc√© √† livrer la version HoloLens pour les d√©veloppeurs et a publi√© l'√©mulateur</a></li>
<li><a href="../fr392409/index.html">Diffusions Node.js: les ing√©nieurs de Google ont trouv√© une vuln√©rabilit√© dans les scripts NPM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>