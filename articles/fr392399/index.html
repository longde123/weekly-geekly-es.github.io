<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙍🏻 🐜 🧜 Espruino: JavaScript dans le microcontrôleur 👩🏻‍💼 👨🏿‍🚀 👊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Pourquoi?", "Quelle absurdité?", "Perversion!", "Fu-Fu-Fu" - ce sont quelques-unes des nombreuses déclarations que nous avons entendues lorsque nous ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Espruino: JavaScript dans le microcontrôleur</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/amperka/blog/392399/"><img src="https://habrastorage.org/files/d7a/aae/106/d7aaae106a9549d299c70a245bd412f4.png" alt="image" align="right"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Pourquoi?", "Quelle absurdité?", "Perversion!", "Fu-Fu-Fu" - ce sont quelques-unes des nombreuses déclarations que nous avons entendues lorsque nous avons publié la carte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iskra JS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le noyau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espruino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque le bon ingénieur en électronique entend que quelque chose a été fait sur l'Arduino, sa température corporelle augmente d'environ un demi-degré: «ils ont pris un microcontrôleur approprié et au lieu de figak figak et les registres en extraient tous les jus, tout vulgarisé ... il n'y a pas de mots, un la haine. " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vous pouvez aller encore plus loin. Prenez le microcontrôleur Cortex M4, qui est dix fois plus riche que ce qui se trouve sur le même Arduino Uno, poussez-y l'interpréteur JavaScript et faites les projets JavaScript! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense qu'en ce moment, ceux qui ne sont pas prêts pour un tel abus de saints microcircuits ont déjà éclaté. Je vais continuer pour le reste.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le passe-temps électronique pour la grande majorité des projets, l'Arduino Uno est suffisant pour les yeux. Et cela n'a même pas d'importance si cela fonctionne à la fréquence standard de 16 MHz ou 4 MHz: peu importe si les lumières du lit s'allument ou la pompe du chalet en 1 ms ou 10 ms. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui compte, c'est que C ++ est complexe et boisé. Oui, il est proche du fer, mais c'est pourquoi il nécessite une connaissance approfondie de ce fer et de l'informatique. Ajoutez à cela la syntaxe avec un tas de nuances, qui est la somme des erreurs du développement du langage sur 30 ans. Ensuite, nous privons ce qui s'est avéré être des tableaux, des chaînes, des dictionnaires adéquats et encore mieux - en général, nous privons la mémoire dynamique. Ici, enfin, nous avons eu l'Arduino.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En regardant les questions sur notre forum, je vois que les gens passent du temps à baiser avec la langue, et non sur l'essence de leurs projets. </font><font style="vertical-align: inherit;">Alors pourquoi ne pas réduire l'écart entre le fer et les gens? </font><font style="vertical-align: inherit;">Le fer est bon marché et en constante évolution, le temps des gens est cher et ne vient de nulle part.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai observé un processus similaire pendant de nombreuses années tout en travaillant dans le développement de jeux. </font><font style="vertical-align: inherit;">En 2003, il était impossible d'imaginer que le jeu puisse être écrit sur autre chose que C / C ++. </font><font style="vertical-align: inherit;">Ensuite, le script intégré de la machine est apparu dans les moteurs. </font><font style="vertical-align: inherit;">Et puis la création d'un produit à part entière est devenue possible sans une seule ligne en C. </font><font style="vertical-align: inherit;">Uniquement Java, C #, Ruby, Python, JavaScript. </font><font style="vertical-align: inherit;">C'est logique, car le fer a commencé à tirer des "langages lents", et en raison du développement plus rapide et des programmeurs plus disponibles, il est devenu possible de consacrer plus de ressources à l'intérêt du jeu et non à la recherche de fuites de mémoire.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À quoi ressemble la programmation du microcontrôleur JavaScript</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La programmation est comme ... JavaScript. </font><font style="vertical-align: inherit;">Pour le développement de navigateur ou Node.js. </font><font style="vertical-align: inherit;">Voici un exemple:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// SMS</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sim = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@amperka/Sim900r'</span></span>).connect();<font></font>
sim.powerOn();<font></font>
sim.on(<span class="hljs-string"><span class="hljs-string">'sms'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sms</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rgb = sms.text.split(<span class="hljs-string"><span class="hljs-string">' '</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = +rgb[<span class="hljs-number"><span class="hljs-number">0</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> g = +rgb[<span class="hljs-number"><span class="hljs-number">1</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = +rgb[<span class="hljs-number"><span class="hljs-number">2</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">isNaN</span></span>(r + g + b)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;<font></font>
    fadeTo(r, g, b);<font></font>
});<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// </span></span>
SPI2.setup({<span class="hljs-attr"><span class="hljs-attr">baud</span></span>:<span class="hljs-number"><span class="hljs-number">3200000</span></span>, <span class="hljs-attr"><span class="hljs-attr">mosi</span></span>:B15});
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> LED_COUNT = <span class="hljs-number"><span class="hljs-number">150</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> colors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8ClampedArray</span></span>(LED_COUNT * <span class="hljs-number"><span class="hljs-number">3</span></span>);<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fadeTo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r, g, b</span></span></span><span class="hljs-function">) </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ivalID = setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{<font></font>
    colors[n*<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>] = b;<font></font>
    colors[n*<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>] = r;<font></font>
    colors[n*<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span>] = g;<font></font>
    SPI2.send4bit(colors, <span class="hljs-number"><span class="hljs-number">0b0001</span></span>, <span class="hljs-number"><span class="hljs-number">0b0011</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n++ &gt;= LED_COUNT) {<font></font>
      clearInterval(ivalID);<font></font>
    }<font></font>
  }, <span class="hljs-number"><span class="hljs-number">50</span></span>);<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce programme s'engage à recevoir des SMS'ki et en fonction de leur texte avec un feu de circulation change la couleur de la bande RVB connectée. </font><font style="vertical-align: inherit;">Nous avons fait un tel projet pour notre arbre du Nouvel An, mais sur l'Arduino classique. </font><font style="vertical-align: inherit;">Le code était 4 fois plus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noyau Espruino</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'ordinateur dispose de moteurs V8 et SpiderMonkey pour JavaScript. </font><font style="vertical-align: inherit;">Et les microcontrôleurs ont un moteur Espruino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En gros, le moteur Espruino est un micrologiciel (croquis, croquis) pour microcontrôleurs, qui à son tour peut exécuter du code JavaScript que vous transférez à la carte via une connexion série, par exemple via USB. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espruino est un projet open source parrainé par Gordon Williams. </font><font style="vertical-align: inherit;">La personne qui a implémenté à elle seule la majeure partie de l'écosystème entier et l'a accompagnée avec succès sur KickStarter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet écosystème se compose de plusieurs parties principales:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espruino Web IDE - un environnement de programmation; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware Espruino - Machine JavaScript qui fonctionne sur un microcontrôleur; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fer - les planches elles-mêmes qui sont compatibles avec Espruino; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliothèque standard et bibliothèques externes; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La documentation </font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement de programmation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'écriture de code JavaScript, son téléchargement sur la carte et la surveillance de la sortie ont lieu dans l'ESP Web Espruino. </font><font style="vertical-align: inherit;">Cette application est pour Google Chrome, elle est donc mise en 1 clic et fonctionne sous tous les OS de bureau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'utilisateur, cet environnement remplace l'IDE Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon les fonctionnalités de l'ESpruino IDE, bien sûr, il est beaucoup plus simple que Eclipse ou Visual Studio à part entière, mais il est plus avancé que l'IDE Arduino.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6c8/0ca/a0c/6c80caa0c1544157bff5331460014f16.png" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous regardez autour de la fenêtre d'environnement en un coup d'œil, vous verrez l'éditeur de code (à droite), le panneau de la console (à gauche) et le bouton pour télécharger le code sur la carte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La console est comme un moniteur série dans l'IDE Arduino, mais contrairement à elle, non seulement elle s'affiche, mais elle accepte également: vous pouvez appeler une fonction directement, sans réinitialiser et charger un nouveau programme, voir la valeur de la variable, interrompre le cycle, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir travaillé plus étroitement, vous rencontrerez un débogueur (ouais, exécution étape par étape, points d'arrêt), des conseils d'éditeur, des erreurs clignotantes à la volée et d'autres astuces intéressantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, directement à partir de l'EDI, vous pouvez mettre à jour la version du microprogramme Espruino elle-même vers la dernière version. </font><font style="vertical-align: inherit;">L'environnement lui-même télécharge la dernière version disponible et la télécharge via USB.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cœur du système est le firmware qui tourne sur le microcontrôleur. </font><font style="vertical-align: inherit;">Il est écrit en C pur, il est chargé une fois dans un endroit séparé de la mémoire flash du microcontrôleur et s'engage à exécuter le code JS utilisateur qui passe par une connexion série ou se trouve dans la zone utilisateur de la mémoire flash. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous décrivons schématiquement la disposition de la mémoire flash pour Iskra JS, nous obtenons l'image suivante:</font></font><br>
<br>
<img src="https://habrastorage.org/files/89c/084/d48/89c084d486f3478fa8f3c7584b83b97d.png" alt="image"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bootloader</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient d'abord le chargeur de démarrage, qui n'est jamais mis à jour (conditionnellement). </font><font style="vertical-align: inherit;">Il s'agit d'un petit programme dont l'exécution est toujours toujours démarrée après la mise sous tension ou la réinitialisation du microcontrôleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le chargeur de démarrage fait une chose assez simple:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le bouton utilisateur BTN1 n'est pas enfoncé, il transfère immédiatement le contrôle à l'interpréteur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le bouton a été enfoncé au démarrage, il se boucle sur lui-même et attend soit que le bouton soit à nouveau enfoncé pour quitter l'interpréteur, soit il attend que la nouvelle version de l'interpréteur soit téléchargée via USB. </font><font style="vertical-align: inherit;">Dans ce cas, le chargeur de démarrage remplacera la zone de mémoire flash avec le microprogramme Espruino et nous obtiendrons la dernière version de l'interpréteur sur la carte.</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interprète</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le chargeur est suivi d'un interprète, qui fait le travail principal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'il démarre, il vérifie en vérifiant l'octet magique s'il y a du code JavaScript stocké dans la mémoire flash de l'utilisateur. </font><font style="vertical-align: inherit;">S'il y en a, il est accepté de l'exécuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il n'y a pas de code, ou si nous avons quitté manuellement le chargeur de démarrage à l'aide de BTN1, rien ne sera exécuté à la réunion, nous obtenons simplement une machine JS prête pour le travail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mémoire libre</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'interpréteur, il existe une zone de mémoire que vous pouvez utiliser pour le stockage non volatile de vos données. </font><font style="vertical-align: inherit;">C'est une sorte de remplacement de l'EEPROM par Arduino, mais avec ses propres spécificités, ainsi que ses dizaines à des centaines de fois plus.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code personnalisé</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est là que le programme JS exécuté par l'interpréteur est stocké. </font><font style="vertical-align: inherit;">Le programme est là en clair, en une seule briquette, comme ça. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour qu'un grand nombre de bibliothèques connectées avec leurs dépendances et votre propre programme se transforment en une seule briquette cast et minifiée, il surveille le chargement de l'EDI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au contraire, tout le travail n'est pas effectué par l'IDE, mais par son composant indépendant de l'interface graphique d'EspruinoTools, qui possède une interface de ligne de commande et un point d'entrée à utiliser comme module Node.js. </font><font style="vertical-align: inherit;">Par conséquent, si vous le souhaitez, vous pouvez utiliser Vim, Atom, Eclipse ou tout ce qui vous convient le mieux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu du code, au lieu d'une briquette de texte, il peut y avoir une distribution binaire stockée de RAM, qui reflète pleinement l'état de l'interpréteur au moment de l'enregistrement. </font><font style="vertical-align: inherit;">Mais ce sont déjà des détails techniques pas pour un aperçu rapide.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliothèques</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bibliothèques peuvent être divisées en 3 types: standard, intégré et externe.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliothèque standard</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La bibliothèque standard comprend des fonctions et des objets qui peuvent être utilisés. </font><font style="vertical-align: inherit;">Parmi eux, à la fois familier et prescrit dans le langage standard `Date`,` JSON`, `Math`,` Object`, `setInterval`,` setTimeout` et d'autres-autres, ainsi que des fonctions spécifiques à Espruino pour travailler avec des broches, des interfaces par mémoire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les fonctions, vous trouverez le familier de l'arduino `pinMode`,` digitalRead`, `digitalWrite`,` analogRead`, `analogWrite`, ainsi que le pas si familier` setWatch` pour surveiller les broches d'entrée,` digitalPulse` pour la génération exacte d'une séquence d'impulsions numériques et beaucoup plus de choses différentes pour travailler avec des périphériques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, malgré le fait qu'il existe une fonction `pinMode` sur la plate-forme, par défaut, elle fonctionne d'elle-même, dans les coulisses, donc dans la plupart des scénarios, vous ne vous en souvenez pas (le dernier ingénieur en électronique a éclaté fort à ce stade). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce que vous ne trouverez pas dans la bibliothèque standard est «delay». Mamma Mia, comme je suis reconnaissante pour ça! Il suffit de réorganiser un peu la pensée et il devient clair que tout est résolu via `setInterval`,` setTimeout` sans aucun `delay`. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En reconnaissance, vous obtenez une exécution asynchrone: vous pouvez faire clignoter vingt LED indépendamment, chacune avec sa propre fréquence. Et vous obtenez une efficacité énergétique: «retard» brûle le temps du processeur, et sans «retard» le processeur peut dormir paisiblement alors qu'il n'y a rien à faire. À Espruino, alors qu'il n'y a pas de travail, le processeur s'endort et consomme des dizaines de fois moins de courant.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliothèques intégrées</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bibliothèques intégrées sont la même partie de la bibliothèque standard dans le sens où elles sont codées en dur dans le microprogramme Espruino, mais l'accès à leurs fonctionnalités nécessite de les connecter syntaxiquement à l'aide de la fonction `require 'familière aux programmeurs JavaScript. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi ces bibliothèques, vous trouverez, par exemple, «fs» pour travailler avec les systèmes de fichiers des cartes SD, «http» pour créer une interface Web pour votre appareil, «Waveform» pour enregistrer / lire des signaux audio et autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bibliothèques standard et intégrées sont implémentées en C pur, et l'utilisateur ne dispose que d'une interface JavaScript sous la forme d'un ensemble d'objets, de fonctions et de modules. </font><font style="vertical-align: inherit;">Cela vous permet d'atteindre une efficacité maximale pour la mise en œuvre d'algorithmes complexes, tout en laissant la possibilité d'y accéder à partir de code de haut niveau.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez vous-même implémenter quelque chose en C que JavaScript dirait «non, merci» et ne faire ressortir que quelques queues nécessaires à l'exécution.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliothèques externes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bibliothèques externes sont ce qui façonne la richesse des écosystèmes. </font><font style="vertical-align: inherit;">Ils sont écrits en JavaScript par les auteurs d'Espruino, nous écrivons, les utilisateurs d'Espruino écrivent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils peuvent être stockés sur un disque local, dans le bac à sable du projet en cours, peuvent être dans le référentiel Internet, peuvent être sur GitHub, peuvent être sur NPM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bibliothèques sont connectées, traditionnellement, en utilisant `require '. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque l'environnement voit `require ', il les télécharge récursivement à partir d'une source distante et, lors du chargement d'une esquisse, colle leur contenu au début de votre programme. </font><font style="vertical-align: inherit;">Ainsi, pour le microcontrôleur, une briquette intégrale se forme avec le code dont j'ai parlé plus haut.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette approche signifie également que, contrairement à Arduino, l'utilisateur n'a pas besoin de trébucher sur le fait que pour commencer, la bibliothèque doit être trouvée, téléchargée, mise là où elle doit. </font><font style="vertical-align: inherit;">Il suffit de claquer l'esquisse que vous aimez quelque part et l'environnement lui-même traitera les dépendances de la bibliothèque.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous arrivons donc à la composante la plus tangible de l'écosystème Espruino. </font><font style="vertical-align: inherit;">Ce sont les cartes qui peuvent exécuter le microprogramme Espruino.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/afb/b7e/d24/afbb7ed24c6f45c1a4c9a0b1069f58ec.jpg" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit notamment de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carte Espruino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> originale </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espruino Pico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ainsi que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iskra JS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> publié par Amperka </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tout est déjà installé en usine sur les cartes listées, elles sont immédiatement prêtes pour le travail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez appuyer plusieurs fois sur le tambourin et installer indépendamment le noyau Espruino sur le STM32 Discovery, le Nucleo et, tout à coup, sur l'ESP8266.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La documentation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a rien de plus triste que quelque chose de très cool et puissant, mais sans documentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espruino a une assez bonne documentation. </font><font style="vertical-align: inherit;">Sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.espruino.com/Reference,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous trouverez de nombreux articles de référence et de formation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voulons faire plus et mieux. </font><font style="vertical-align: inherit;">Par conséquent, nous avons créé une section distincte: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">js.amperka.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tournage de didacticiels vidéo. </font><font style="vertical-align: inherit;">Les travaux sont en cours, mais beaucoup a déjà été couvert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et traditionnellement pour ceux qui aiment les solutions en boîte, nous avons créé un ensemble de " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iodo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">Il contient Iskra JS, des modules et un livre de couleurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un persil. </font><font style="vertical-align: inherit;">Le seul mystère est de savoir si au moins un bon ingénieur en électronique pourrait lire jusqu'à cette ligne?</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr392399/">https://habr.com/ru/post/fr392399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr392383/index.html">À quel point il est facile de pirater Android non chiffré, ou pourquoi il vaut toujours la peine d'être chiffré</a></li>
<li><a href="../fr392387/index.html">«Яндекс. Карты» перешли на вектор</a></li>
<li><a href="../fr392389/index.html">Mettre en place une salle de conférence en l'honneur de la Journée de la science russe le 24 avril</a></li>
<li><a href="../fr392391/index.html">Journal papier Trollim</a></li>
<li><a href="../fr392395/index.html">Le ransomware «Petya» crypte l'intégralité du disque dur et nécessite de l'argent</a></li>
<li><a href="../fr392401/index.html">La mystérieuse planète X pourrait être capturée par le Soleil à partir d'un autre système stellaire</a></li>
<li><a href="../fr392403/index.html">Likbez sur les gadgets Xiaomi présentés sur AliExpress</a></li>
<li><a href="../fr392405/index.html">Les scientifiques ont pu contrôler la vitesse du scarabée en implantant des électrodes dans ses muscles</a></li>
<li><a href="../fr392407/index.html">Microsoft a commencé à livrer la version HoloLens pour les développeurs et a publié l'émulateur</a></li>
<li><a href="../fr392409/index.html">Diffusions Node.js: les ingénieurs de Google ont trouvé une vulnérabilité dans les scripts NPM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>