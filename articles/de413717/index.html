<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💂🏼 👶🏼 🚚 GraphQL für InterSystems-Plattformen 🐹 🧠 👩🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="GraphQL ist ein Standard zum Deklarieren von Datenstrukturen und Methoden zum Abrufen von Daten, der als zusätzliche Schicht zwischen Client und Serve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GraphQL für InterSystems-Plattformen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intersystems/blog/413717/"><p><img src="https://habrastorage.org/getpro/habr/post_images/5b3/5fd/01e/5b35fd01efecfc0793d1ffdc7dfb6289.jpg"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GraphQL</a> ist ein Standard zum Deklarieren von Datenstrukturen und Methoden zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abrufen von</a> Daten, der als zusätzliche Schicht zwischen Client und Server fungiert.  Wenn Sie zum ersten Mal von GraphQL hören, finden Sie hier einige gute Ressourcen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eins</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zwei</a> . </p><br><p>  In diesem Artikel werde ich Ihnen erklären, wie Sie GraphQL in Ihren Projekten mithilfe von InterSystems-Technologien verwenden können. </p><a name="habracut"></a><br><p>  Derzeit gibt es verschiedene Möglichkeiten, Client-Server-Anwendungen auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">InterSystems-</a> Plattformen zu erstellen: </p><br><ul><li>  RUHE </li><li>  Web-Socket </li><li>  Seife </li></ul><br><p>  Aber warum ist GraphQL so gut?  Welche neuen Funktionen bietet es beispielsweise im Vergleich zu REST? </p><br><p>  GraphQL hat verschiedene Arten von Abfragen: </p><br><ul><li>  <strong>Abfragen</strong> sind Anforderungen an den Server zum Empfangen von Daten. Genau wie bei REST wird empfohlen, GET-Anforderungen zum Empfangen von Daten zu verwenden. </li><li> <strong>Mutation</strong> - Dieser Typ ist für die Änderung der Daten auf dem Server verantwortlich.  In REST zum Ändern von Daten POST-Anforderungen (PUT, DELETE). <br>  <strong>Mutationen</strong> können wie <strong>Abfragen</strong> Daten zurückgeben. Dies ist praktisch, wenn Sie unmittelbar nach der Mutation aktualisierte Informationen vom Server anfordern möchten. </li><li>  <strong>Abonnements</strong> ist der gleiche <strong>Abfragetyp</strong> , der Daten ausgibt.  Der einzige Unterschied besteht darin, dass die <strong>Abfrage</strong> durch Rendern der Seite auf dem Client ausgelöst wird und <strong>Abonnements</strong> durch <strong>Mutationen</strong> ausgelöst werden. </li></ul><br><h2 id="glavnye-osobennosti-graphql-i-to-radi-chego-ego-stoit-ispolzovat">  Die Hauptfunktionen von GraphQL und wofür es sich lohnt, sie zu verwenden </h2><br><h3 id="klient-sam-reshaet-chto-on-hochet-poluchit">  Der Kunde entscheidet, was er erhalten möchte. </h3><br><p>  Eines der Hauptmerkmale von GraphQL ist, dass die Struktur und Menge der Daten von der Clientanwendung bestimmt wird.  Der Client gibt mithilfe einer deklarativen, grafischen Struktur, die dem JSON-Format sehr ähnlich ist, genau an, welche Daten er empfangen möchte.  Die Struktur der Antwort entspricht der Struktur der Anfrage. </p><br><p>  So sieht eine einfache GraphQL-Abfrage aus: </p><br><pre><code class="hljs pgsql">{ Sample_Company { <span class="hljs-type"><span class="hljs-type">Name</span></span> } }</code> </pre> <br><p>  Antwort im JSON-Format: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Sample_Company"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"CompuSoft Associates"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"SynerTel Associates"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"RoboGlomerate Media Inc."</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"QuantaTron Partners"</span></span> } ] } }</code> </pre> <br><h3 id="edinaya-tochka-vhoda">  Einzelner Einstiegspunkt </h3><br><p>  In GraphQL wenden wir uns zum Arbeiten mit Daten immer einem einzigen Einstiegspunkt ( <strong>Endpunkt</strong> ) zu - dem GQL-Server.  Wenn wir die Struktur, Felder und Abfrageparameter ändern, arbeiten wir mit verschiedenen Daten.  Der gleiche REST hat viele Endpunkte. </p><br><p>  Vergleichen Sie REST mit GraphQL anhand eines einfachen Beispiels: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cca/f84/622/ccaf84622af4f11bac9f21217c28694a.jpg"></p><br><p>  Angenommen, Sie möchten Benutzerinhalte hochladen. Für REST müssen Sie drei Anforderungen an den Server stellen: </p><br><ol><li>  Wir laden Benutzerdaten anhand seiner <strong>ID</strong> </li><li>  Per <strong>ID</strong> bekommen wir seine Beiträge </li><li>  Durch <strong>ID</strong> bekommen wir seine Abonnenten </li></ol><br><p>  Die REST-Karte, die diesen Anforderungen entspricht: </p><br><pre> <code class="hljs pgsql"> &lt;Route Url="/user/:id" <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span>="GET" <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>="GetUserByID"/&gt; &lt;Route Url="/user/:id/posts" <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span>="GET" <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>="GetUserPostsByID"/&gt; &lt;Route Url="/user/:id/follovers" <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span>="GET" <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>="GetUserFolloversByID"/&gt;</code> </pre> <br><p>  Um einen neuen Datensatz zu erhalten, muss die REST-Karte durch neue Endpunkte ergänzt werden. </p><br><p>  GraphQL bewältigt diese Aufgabe in einer einzigen Abfrage.  Geben Sie dazu im Anforderungshauptteil Folgendes an: </p><br><pre> <code class="hljs coffeescript">{ operationName: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> query    ( query TestName(...){...} ) query: <span class="hljs-string"><span class="hljs-string">"query { User(id: "</span></span>ertg439frjw<span class="hljs-string"><span class="hljs-string">") { name posts { title } followers(last: 3) { name } } }"</span></span>, variables: <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ,    query* }</code> </pre> <br><p>  REST-Karte, die dieser Abfrage entspricht: </p><br><pre> <code class="hljs pgsql"> &lt;Route Url="/graphql" <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span>="POST" <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>="GraphQL"/&gt;</code> </pre> <br><p>  Darüber hinaus ist dies der einzige Endpunkt auf dem Server. </p><br><h2 id="ustanovka-graphql-i-graphiql">  Installieren Sie GraphQL und GraphiQL </h2><br><p>  Um GraphQL verwenden zu können, müssen Sie einige Schritte ausführen: </p><br><ol><li>  Laden Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neueste Version</a> von GitHub herunter und importieren Sie sie in den gewünschten Bereich </li><li>  Rufen Sie das Systemverwaltungsportal auf und erstellen Sie eine neue Webanwendung für Ihr Produkt über die InterSystems Data Platform (Caché, Ensemble oder IRIS): <br><ul><li>  Name - <strong>/</strong> </li><li>  Geltungsbereich - <strong>z. B. PROBEN</strong> </li><li>  Handler-Klasse - <strong>GraphQL.REST.Main</strong> </li></ul></li><li>  GraphiQL ist eine Shell zum Testen von GraphQL-Abfragen.  Laden Sie die neueste zusammengestellte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GraphiQL-</a> Version <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herunter</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellen Sie sie</a> selbst </li><li>  Erstellen Sie eine neue Webanwendung: <br><ul><li>  Name - <strong>/ graphiql</strong> </li><li>  Geltungsbereich - <strong>z. B. PROBEN</strong> </li><li>  Der physische Pfad zu den CSP-Dateien lautet <strong>C: \ InterSystems \ GraphiQL \</strong> </li></ul></li></ol><br><h2 id="posmotrim-na-rezultat">  Schauen wir uns das Ergebnis an </h2><br><p>  Gehen Sie zum Browser unter diesem Link <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http: // localhost: 57772 / graphiql / index.html</a></strong> (localhost - Server, 57772 - Port) </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ae1/56b/6bc/ae156b6bcc28f2c4735ec9b1b912a4b7.jpg" alt="GraphiQL"></p><br><p>  Ich denke, dass mit dem <strong>Anforderungs-</strong> und <strong>Antwortbereich</strong> alles klar ist, und das <strong>Schema</strong> ist die Dokumentation, die für alle gespeicherten Klassen in dem Bereich generiert wird. </p><br><p>  Die Schaltung enthält: </p><br><ul><li>  Klassen </li><li>  Eigenschaften, Argumente und ihre Typen </li><li>  Beschreibung aller oben genannten Punkte, die aus den Kommentaren generiert werden </li></ul><br><p>  Betrachten Sie das Diagramm am <strong>Beispiel</strong> der <strong>Sample_Company-</strong> Klasse: </p><br><p><img src="https://habrastorage.org/webt/x6/vs/np/x6vsnpq7seel9ndzdvsn1nyzcys.jpeg"></p><br><p>  GraphiQL unterstützt auch die automatische Vervollständigung, die mit der Tastenkombination <strong>Strg +</strong> Leertaste aufgerufen werden kann: </p><br><p><img src="https://habrastorage.org/webt/8h/51/wz/8h51wz5ccdiabmsn06n9sve_mce.jpeg"></p><br><h2 id="zaprosy">  Anfragen </h2><br><p>  Abfragen können entweder einfach oder verschachtelt sein. Sie können mehrere Datensätze abfragen.  Unten finden Sie ein Beispiel für die Abfrage von Daten aus zwei verschiedenen Klassen: <strong>Sample_Person</strong> und <strong>Sample_Company</strong> : </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/3e6/882/bfe/3e6882bfe7decfa4eafa1f543d3feb94.jpg"></p><br><h2 id="filtraciya">  Filtern </h2><br><p>  Derzeit wird nur eine strikte Gleichstellung unterstützt: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/950/9a2/c4f/9509a2c4f46c644ecd93a25028510a08.jpg" alt="Filter"></p><br><h2 id="paginaciya">  Paginierung </h2><br><p>  4 Funktionen für die Paginierung sind implementiert, bei Bedarf können sie kombiniert werden: </p><br><ul><li>  <strong>after: n</strong> - alle Datensätze mit einer ID größer als n </li><li>  <strong>vor: n</strong> - alle Datensätze mit einer ID kleiner als n </li><li>  <strong>first: n</strong> - first n Einträge </li><li>  <strong>last: n</strong> - letzte n Einträge </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/dff/575/9fe/dff5759fe8212d8e5f58e98e0636c4b1.jpg" alt="Filter"></p><br><h2 id="oblast-vidimosti">  Geltungsbereich </h2><br><p>  In den meisten Fällen sollten gemäß der Geschäftslogik der Anwendungen für einen bestimmten Kunden nicht alle Klassen der Region verfügbar sein, sondern diejenigen, für die er gemäß seiner Rolle Rechte hat.  Auf dieser Grundlage muss die Sichtbarkeit von Klassen für den Client eingeschränkt werden: </p><br><ul><li>  Alle Klassen im Geltungsbereich ( <strong>GraphQL.Scope.All</strong> ) </li><li>  Von der Oberklasse <strong>geerbte</strong> Klassen ( <strong>GraphQL.Scope.Superclass</strong> ) </li><li>  Klassen, die zu einem bestimmten Paket gehören ( <strong>GraphQL.Scope.Package</strong> ) </li></ul><br><p>  Um die eingeschränkte Sichtbarkeit zu ändern, müssen Sie das Studio öffnen, zum gewünschten Bereich gehen und die <strong>GraphQL.Settings-</strong> Klasse öffnen.  Es hat den Parameter <strong>SCOPECLASS</strong> , sein Standardwert ist <strong>GraphQL.Scope.All</strong> - Dies ist eine Klasse, die die Schnittstelle zum Einschränken der Sichtbarkeit von Klassen im Feld beschreibt: <br><img src="https://habrastorage.org/getpro/habr/post_images/6bb/daf/aa7/6bbdafaa7a0ff93b27fe75f38e7f68bf.jpg" alt="Umfang"><br>  Um das Sichtbarkeitslimit für Klassen zu ändern, müssen Sie nur einen der oben angegebenen Werte <strong>festlegen</strong> : <strong>GraphQL.Scope.Package</strong> oder <strong>GraphQL.Scope.Superclass</strong> . </p><br><p>  Im Fall von <strong>GraphQL.Scope.Package</strong> ist es weiterhin erforderlich, zu dieser Klasse zu <strong>wechseln</strong> und den Wert des Parameters <strong>Package</strong> auf den Namen des gewünschten Pakets <strong>festzulegen</strong> , z. B. <strong>Sample</strong> . Dann sind alle gespeicherten Klassen aus diesem Paket verfügbar: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/145/0bf/a4c/1450bfa4c4c8933a9f6eea8bd8ec925b.jpg"></p><br><p>  Und mit <strong>GraphQL.Scope.Superclass können</strong> Sie einfach zusätzlich von dieser Klasse in den Klassen erben, die Sie benötigen: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e34/421/8ba/e344218ba953c92b4554027bae798c79.jpg"></p><br><h2 id="na-dannyy-moment-podderzhivaetsya">  Wird derzeit unterstützt </h2><br><p>  Anfragen: </p><br><ul><li>  Grundlegend </li><li>  Verschachtelte Objekte <br><ul><li>  Nur viele zu einer Einstellung </li></ul></li><li>  Blatt von einfachen Typen </li><li>  Blatt mit Gegenständen </li></ul><br><h2 id="nahoditsya-v-realizacii">  Ist in Umsetzung </h2><br><p>  Anfragen: </p><br><ul><li>  Verschachtelte Objekte <br><ul><li>  Unterstützung für alle Arten von Beziehungen </li></ul></li><li>  Filtern <br><ul><li>  Ungleichheitsunterstützung </li></ul></li></ul><br><h2 id="v-planah">  In den Plänen </h2><br><ul><li>  Mutationen </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aliase</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Richtlinien</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fragmente</a> </li></ul><br><p>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> zum Projekt-Repository <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> zum Demo-Server </p><br><p>  Probleme Pull-Anfragen sind sehr willkommen. <br>  Verfolgen Sie die Entwicklung unseres Projekts! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413717/">https://habr.com/ru/post/de413717/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413707/index.html">Eine sehr einfache Erklärung der SOLID-Prinzipien</a></li>
<li><a href="../de413709/index.html">Fusion-Projekt zum Zusammenführen von Tor Browser und Firefox gestartet</a></li>
<li><a href="../de413711/index.html">Vorprogramm PyConRu-2018: drei Python Core-Entwickler, Sprecher von Google, Yelp, Red Hat, Yandex</a></li>
<li><a href="../de413713/index.html">Data Warehouse-Leistung: Neue Ziffern</a></li>
<li><a href="../de413715/index.html">IT-Altersrente</a></li>
<li><a href="../de413719/index.html">C ++ 20 unterwegs! Treffen bei Rapperswil Yona</a></li>
<li><a href="../de413721/index.html">Zeitcheck: Timejacking gegen Bitcoin</a></li>
<li><a href="../de413723/index.html">Saga der elektronischen Dienste und ihrer Standorte. Teil 2. Elektronischer Schrank</a></li>
<li><a href="../de413725/index.html">Arbeiten mit Arrays in Bash</a></li>
<li><a href="../de413729/index.html">Wie und warum haben wir unser ECS geschrieben?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>