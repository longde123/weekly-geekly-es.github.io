<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßòüèº ü§òüèª üí§ Analizando Tareas CTF ‚ù§Ô∏è üë®‚Äçüîß üö¥üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A principios de diciembre, celebramos una competencia de equipo en seguridad de la informaci√≥n. Adem√°s de OTUS , los organizadores del evento para los...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analizando Tareas CTF</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/482538/">  <i>A principios de diciembre, celebramos una <a href="https://habr.com/ru/news/t/476892/">competencia de equipo</a> en seguridad de la informaci√≥n.</i>  <i>Adem√°s de <a href="https://otus.pw/q7Ro/">OTUS</a> , los organizadores del evento para los "hackers blancos" fueron <a href="https://volgactf.ru/">Volga CTF</a> y <a href="https://ctf.moscow/">CTF.Moscow</a> .</i>  <i>Quiz√°s ha llegado el momento de resumir y hablar en detalle sobre las tareas.</i> <i><a name="habracut"></a></i> <br><br>  <b>En primer lugar, el evento tuvo √©xito:</b> <br><br><ul><li>  Se prepararon 9 tareas en tres √°reas: Pentest, Ingenier√≠a inversa, Seguridad de Linux y Desarrollo seguro; </li><li>  Participaron 217 equipos; </li><li>  Se registraron m√°s de 800 intentos de pasar banderas; </li><li>  Se registraron m√°s de 300 banderas aprobadas. </li></ul><br><img src="https://habrastorage.org/webt/wz/hb/ul/wzhbulaaw9vhnblzhk4w9jzpche.png"><br><br>  <b>En segundo lugar</b> , las tareas eran diferentes en complejidad, por lo que no todos pod√≠an resolver el problema: <br><br><img src="https://habrastorage.org/webt/2e/uh/v3/2euhv3gwoznv4womber0-o-513w.png"><br><br>  <b>En tercer lugar</b> , inmediatamente despu√©s de la finalizaci√≥n del marat√≥n en l√≠nea, realizamos <b>tres seminarios web</b> donde hablamos sobre los ganadores, dimos las respuestas correctas y anunciamos los resultados finales: <br><br>  - Resultados del CTF: "Seguridad de Linux y desarrollo seguro"; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/5tt8xsAhYBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - Resultados del CTF: Pentest; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/6Dm-gk86yJk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - los resultados de CTF: "ingenier√≠a inversa". <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Cx-ALK8laXI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>En cuarto lugar</b> , le ofrecemos las <b>condiciones de las tareas y descripciones textuales de sus soluciones</b> .  Tenga en cuenta que algunas tareas incluyen archivos. <br><br><h3>  Direcci√≥n 1: Pentest </h3><br>  <b>Tarea 1 - Bases de datos</b> <br><br>  <i>100</i> <i><br><br></i>  <i>El sitio usa activamente bases de datos.</i>  <i>Intenta hacer inyecciones SQL.</i> <i><br></i>  <i>Enlace al sitio: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Soluci√≥n:</b> <br><br>  Vamos a la secci√≥n principal de la tienda / tienda / productos /, despu√©s de atascarnos en el campo de b√∫squeda, encontramos inyecci√≥n SQL. <br><br>  Ingrese 1 "O" 1 "=" 1 "-, despl√°cese hacia abajo y vea un producto que faltaba anteriormente, la bandera est√° en su descripci√≥n. <br><br>  <b><i>Bandera: bandera {5ql_1nject10n_15_t00_51mpl3_f0r_y0u}</i></b> <br><br>  <b>Tarea 2 - Cookies</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Mi amigo desarroll√≥ una plataforma de tienda en l√≠nea.</i>  <i>Pidi√≥ una prueba de blackbox.</i>  <i>Verifique la seguridad de las cookies, puede obtener derechos de administrador.</i> <i><br><br></i>  <i>Enlace al sitio: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Soluci√≥n:</b> <br><br>  Inicie sesi√≥n, mire las cookies y vea las cookies secretas: <br><br>  ¬´MTExMTAxMSAxMDAwMTAgMTExMDEwMSAxMTEwMDExIDExMDAxMDEgMTExMDAxMCAxMTAxMTEwIDExMDAwMDEgMTEwMTEwMSAxMTAwMTAxIDEwMDAxMCAxMTEwMTAgMTAwMDEwIDExMTAxMDEgMTExMDAxMSAxMTAwMTAxIDExMTAwMTAgMTAwMDEwIDEwMTEwMCAxMDAwMDAgMTAwMDEwIDExMDEwMDEgMTExMDAxMSAxMDExMTExIDExMDAwMDEgMTEwMDEwMCAxMTAxMTAxIDExMDEwMDEgMTEwMTExMCAxMDAwMTAgMTExMDEwIDEwMDAxMCAxMDAwMTEwIDExMDAwMDEgMTEwMTEwMCAxMTEwMDExIDExMDAxMDEgMTAwMDEwIDExMTExMDE =¬ª <br><br>  Decodificar base 64, se obtienen los datos binarios: 100010 1110101 1110011 1111011 1100101 1110010 1101110 1100001 1101101 1100101 100010 111010 100010 1110101 1110011 1100101 1110010 100010 101100 100000 100010 1101001 1110011 1011111 1100001 1100100 1101101 1101001 1101110 100010 111010 100010 1000110 1100001 1101100 1110011 1100101 100010 1111101 <br><br>  <code>{"username":"user", "is_admin":"False"}</code> a texto y obtenemos: <code>{"username":"user", "is_admin":"False"}</code> , cambiamos False a True y lo decodificamos de nuevo: <br><br>  01111011 00100010 01110101 01110011 01100101 01110010 01101110 01100001 01101101 01100101 00100010 00111010 00100010 01110101 01110011 01100101 01110010 00100010 00101100 00100000 00100010 01101001 01110011 01011111 01100001 01100100 01101101 01101001 01101110 00100010 00111010 00100010 01010100 01110010 01110101 01100101 00100010 01111101 <br><br>  ¬´MDExMTEwMTEgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDExMDExMTAgMDExMDAwMDEgMDExMDExMDEgMDExMDAxMDEgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDAxMDAwMTAgMDAxMDExMDAgMDAxMDAwMDAgMDAxMDAwMTAgMDExMDEwMDEgMDExMTAwMTEgMDEwMTExMTEgMDExMDAwMDEgMDExMDAxMDAgMDExMDExMDEgMDExMDEwMDEgMDExMDExMTAgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDEwMTAxMDAgMDExMTAwMTAgMDExMTAxMDEgMDExMDAxMDEgMDAxMDAwMTAgMDExMTExMDE =¬ª <br><br>  Cambie el valor de las cookies a una nueva y vaya al perfil del usuario. <br>  <i><b>Bandera: bandera {d0_y0u_l1k3_c00k13s}</b></i> <br><br>  <b>Tarea 3: lectura de archivos</b> <br><br>  <i>200</i> <i><br><br></i>  <i>A menudo encontramos fuentes con fugas y una extra√±a l√≥gica de trabajo.</i>  <i>Los posibles vectores de ataque generalmente se encuentran por fuzzing.</i>  <i>Te sugiero que hagas esto.</i> <i><br><br></i>  <i>Enlace al sitio: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Soluci√≥n:</b> <br><br>  Comenzamos dirb (habitual common.txt es suficiente), encontramos p√°ginas <code>/shop/_source/</code> y <code>/shop/files/</code> . <br><br>  Habiendo familiarizado con la fuente <code>_source</code> entendemos que tenemos la vulnerabilidad de Recorrido de ruta + algunos filtros simples. <br><br>  Para obtener el indicador, debe realizar una solicitud POST a <code>/shop/files/</code> con el par√°metro "archivo", cuyo valor debe ser <code>%2E%2E/%2E%2E/flag</code> . <br><br>  En respuesta a la solicitud, habr√° una bandera. <br><br>  <i><b>Bandera: bandera {y0u_g0t_0ur_s3cr3t}</b></i> <br><br><h3>  Direcci√≥n 2: "Seguridad de Linux y desarrollo seguro" </h3><br>  <b>Tarea 1 - VCS</b> <br><br>  50 <br><br>  <i>¬øPero el cliente nos dio algo superfluo?</i> <i><br></i>  <i>El archivo contiene el c√≥digo fuente de parte del sitio.</i> <i><br></i>  <i>Enlace al sitio: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Adjunto: tarea.7z</i> <br><br>  <b>Soluci√≥n:</b> <br><br>  Tenemos acceso al c√≥digo fuente.  Al final result√≥ que, los desarrolladores tambi√©n pusieron un repositorio git.  Observamos git log, vemos commit con arreglos.  Usamos git show &lt;hash commit&gt;, vemos los archivos modificados y su contenido, una bandera se almacena en una de las l√≠neas. <br><br>  <i><b>bandera {22717297f6a3603608d260c9e5f69e0a}</b></i> <br><br>  <b>Tarea 2 - Algo</b> <br><br>  <i>50</i> <i><br><br></i>  <i>Tenemos un nuevo reto.</i>  <i>Realice un control de desarrollo seguro.</i>  <i>El cliente proporcion√≥ un archivo con la parte abierta del sitio que se est√° desarrollando.</i>  <i>Para probar su algoritmo hash, proporcion√≥ un hash: 666c61677b32646733326473323334327d.</i>  <i>Verifique el algoritmo para la posibilidad de transformaci√≥n inversa.</i> <i><br><br></i>  <i>El archivo contiene el c√≥digo fuente de parte del sitio.</i> <i><br></i>  <i>Enlace al sitio: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Adjunto: tarea.7z</i> <br><br>  <b>Soluci√≥n:</b> <br><br>  El c√≥digo fuente tiene un algoritmo de hash de contrase√±a.  En realidad, este no es un algoritmo hash, sino que simplemente convierte datos de un formato de cadena a hexadecimal. <br><br>  Usamos Python: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> binascii binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">"666c61677b32646733326473323334327d"</span></span>)</code> </pre> <br>  Obtenemos <i><b>la</b></i> bandera: <i><b>bandera {2dg32ds2342}</b></i> <br><br>  <b>Tarea 3 - Archivos archivos archivos</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Terminemos la auditor√≠a.</i>  <i>¬øVes tambi√©n esta vulnerabilidad?</i>  <i>Genial</i>  <i>Entonces, obtener un archivo secreto es f√°cil para usted.</i> <i><br></i>  <i>El archivo contiene el c√≥digo fuente de parte del sitio.</i> <i><br></i>  <i>Enlace al sitio: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Adjunto: tarea.7z</i> <br><br>  <b>Soluci√≥n:</b> <br><br>  En el c√≥digo fuente del m√≥dulo principal del programa, puede ver el lector de archivos (esta es la aplicaci√≥n principal de este servicio).  La funci√≥n para verificar la existencia de un archivo no busca caracteres especiales de ninguna manera y simplemente concatena dos l√≠neas =&gt; vulnerabilidad de recorrido de ruta. <br><br>  Tambi√©n en Dockerfile, docker-compose.yml, puede ver las asignaciones de archivos y la estructura de carga en el contenedor.  Usando este conocimiento, generamos una carga √∫til: <br><br><pre> <code class="plaintext hljs">http://193.41.142.9:8002/files?password=qgzc6!78zxcbkj123fdgd234&amp;filename=../../../../../../src/secret_files/flag.txt</code> </pre> <br>  <i><b>flag {a0a7c3fff21f2aea3cfa1d0316dd816c}</b></i> <i><b><br></b></i> <br><h3>  Direcci√≥n 3: "ingenier√≠a inversa" </h3><br>  <b>Tarea 1 - Serpiente</b> <br>  <i>100</i> <i><br><br></i>  <i>Nuestra compa√±√≠a siempre est√° tratando de eludir cualquier protecci√≥n de software.</i>  <i>Ay√∫danos a lidiar con Python esta vez.</i> <i><br></i>  <i>Archivo adjunto: task.pyc</i> <br><br>  <b>Soluci√≥n:</b> <br><br>  Usamos el c√≥digo de bytes de Python descompilado por el m√≥dulo Unpypy6: <br>  descompyle6 task.pyc. <br>  Descompilamos, obtenemos una bandera: <br><br>  <i><b>bandera {w3l1_pyth0n}</b></i> <i><b><br></b></i> <br>  <b>Tarea 2 - Robot</b> <br>  <i>150</i> <i><br><br></i>  <i>Esta vez nos encontramos con una aplicaci√≥n extra√±a, ay√∫dame a encontrar la contrase√±a para ingresar.</i> <i><br></i>  <i>Adjunto: app.apk</i> <br><br>  <b>Soluci√≥n:</b> <br><br>  La aplicaci√≥n est√° en Android, as√≠ que c√°rguela en un analizador est√°tico como BytecodeViewer y vea el c√≥digo fuente restaurado del programa.  Tenga en cuenta que esto es Kotiln, y a menudo utiliza programaci√≥n funcional, como en este caso.  En una de las funciones an√≥nimas descompiladas, encontramos la marca de verificaci√≥n, la verificaci√≥n en s√≠: <br><br><pre> <code class="kotlin hljs">(String)paramFunction1.invoke(<span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>.valueOf(Arrays.equals(paramString, h)));  invoke: ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">"flag{"</span></span>); ((StringBuilder)localObject).append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$m); ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">'}'</span></span>);</code> </pre> <br>  variable h: {102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50, 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55}; <br><br>  Vemos que parece caracteres impresos codificados.  Usamos Python: <br><br>  '' .join (chr (x) para x en [102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50 , 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55]) <br><br>  Obtenemos la bandera: <br><br>  <i><b>bandera {fa2bf646e49ab5e56f2b74480ba61017}</b></i> <i><b><br></b></i> <br>  <b>Misi√≥n 3 - Bin</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Esta vez nos encontramos con un archivo binario.</i>  <i>La tarea es la misma, obtener la contrase√±a secreta.</i> <i><br></i>  <i>Adjunto: tarea</i> <br><br>  <b>Soluci√≥n:</b> <br>  Se da un archivo binario.  Cargamos en el desensamblador y vemos seis funciones de validaci√≥n escritas en C ++. <br><br>  Se ejecutan de forma id√©ntica y se llaman entre s√≠, verificando la bandera en partes de 5 elementos. <br><br>  Lo restauramos por etapas utilizando informaci√≥n del desensamblador.  Obtenemos la bandera en partes: <br><br>  0) verificaci√≥n de longitud <br>  1) bandera { <br>  2) tarifafa <br>  3) _172a <br>  4) k14sc <br>  5) _eee} <br><br>  Combina y obt√©n la bandera: <br><br>  <i><b>bandera {feefa_172ak14sc_eee}</b></i> <br><br>  ¬°Eso es todo, colegas!  ¬°Gracias a todos por participar, cu√≠date a ti mismo, a tus seres queridos y a tus datos!  Feliz a√±o nuevo </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482538/">https://habr.com/ru/post/482538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482522/index.html">Timlid: esta es la forma</a></li>
<li><a href="../482524/index.html">Hackathon Rosbank Tech.Madness 2019: resultados</a></li>
<li><a href="../482526/index.html">Conferencia jubilar de Donald Knuth "En el √°rbol de Navidad"</a></li>
<li><a href="../482534/index.html">Una vez m√°s sobre la complejidad de la arquitectura y el umbral de entrada.</a></li>
<li><a href="../482536/index.html">Pixel art para principiantes: instrucciones de uso</a></li>
<li><a href="../482540/index.html">Software VS Hardware: ¬øcu√°l es la tendencia y qui√©n es el futuro?</a></li>
<li><a href="../482544/index.html">Recopilaci√≥n de un equipo de inicio con "0": instrucciones paso a paso para los m√°s peque√±os</a></li>
<li><a href="../482546/index.html">VK Tech: un a√±o de desarrollo en n√∫meros Git</a></li>
<li><a href="../482548/index.html">Semana de la seguridad 52 + 1: noticias no est√°ndar del top 3 del a√±o</a></li>
<li><a href="../482550/index.html">El misterioso programa LyX. Parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>