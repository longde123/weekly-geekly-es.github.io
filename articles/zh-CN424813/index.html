<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥ ğŸ”™ ğŸ™ åŸºäºArduinoçš„æœºå™¨ï¼Œç”±Androidè®¾å¤‡é€šè¿‡è“ç‰™æ§åˆ¶-åº”ç”¨ä»£ç å’Œmkï¼ˆç¬¬2éƒ¨åˆ†ï¼‰ ğŸ¤¾ ğŸ—‚ï¸ â‡ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å…³äºç¬¬ä¸€éƒ¨åˆ† 
 åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘æè¿°äº†æ„é€ çš„ç‰©ç†éƒ¨åˆ†ä»¥åŠä¸€å°æ®µä»£ç ã€‚ ç°åœ¨è€ƒè™‘è½¯ä»¶ç»„ä»¶-ä¸€ä¸ªAndroidåº”ç”¨ç¨‹åºå’Œä¸€ä¸ªArduinoè‰å›¾ã€‚ 

 é¦–å…ˆï¼Œæˆ‘ä¼šè¯¦ç»†ä»‹ç»æ¯ä¸ªæ—¶åˆ»ï¼Œæœ€åï¼Œæˆ‘ä¼šç•™ä¸‹æ•´ä¸ªé¡¹ç›®çš„é“¾æ¥ä»¥åŠç»“æœçš„è§†é¢‘ï¼Œè¿™ä¼šè®©æ‚¨æ„Ÿåˆ°å¤±æœ› ã€‚ 

 Androidåº”ç”¨ 
 Androidç¨‹åºåˆ†ä¸ºä¸¤éƒ¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åŸºäºArduinoçš„æœºå™¨ï¼Œç”±Androidè®¾å¤‡é€šè¿‡è“ç‰™æ§åˆ¶-åº”ç”¨ä»£ç å’Œmkï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424813/"><h2> å…³äºç¬¬ä¸€éƒ¨åˆ† </h2><br> åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘æè¿°äº†æ„é€ çš„ç‰©ç†éƒ¨åˆ†ä»¥åŠä¸€å°æ®µä»£ç ã€‚ ç°åœ¨è€ƒè™‘è½¯ä»¶ç»„ä»¶-ä¸€ä¸ªAndroidåº”ç”¨ç¨‹åºå’Œä¸€ä¸ªArduinoè‰å›¾ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘ä¼šè¯¦ç»†ä»‹ç»æ¯ä¸ªæ—¶åˆ»ï¼Œæœ€åï¼Œæˆ‘ä¼šç•™ä¸‹æ•´ä¸ªé¡¹ç›®çš„é“¾æ¥ä»¥åŠç»“æœçš„è§†é¢‘ï¼Œè¿™<s>ä¼šè®©</s>æ‚¨<s>æ„Ÿåˆ°å¤±æœ›</s> ã€‚ <br><a name="habracut"></a><br><h2>  Androidåº”ç”¨ </h2><br>  Androidç¨‹åºåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯é€šè¿‡è“ç‰™è¿æ¥è®¾å¤‡ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æ§åˆ¶æ“çºµæ†ã€‚ <br><br> æˆ‘è­¦å‘Šæ‚¨-è¯¥åº”ç”¨ç¨‹åºçš„è®¾è®¡æ ¹æœ¬æ— æ³•å®Œæˆï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œå®ƒä¼šå¤§å¤±æ‰€æœ›ã€‚ é€‚åº”æ€§å’ŒUXä¸ä¼šç­‰å¾…ï¼Œä½†ä¸åº”è¶…å‡ºå±å¹•èŒƒå›´ã€‚ <br><br><h3> å¸ƒå±€å›¾ </h3><br> å¼€å§‹æ´»åŠ¨å–å†³äºå¸ƒå±€ï¼Œå…ƒç´ ï¼šæŒ‰é’®å’Œè®¾å¤‡åˆ—è¡¨çš„å¸ƒå±€ã€‚ è¯¥æŒ‰é’®å¼€å§‹æŸ¥æ‰¾å…·æœ‰æ´»åŠ¨è“ç‰™çš„è®¾å¤‡çš„è¿‡ç¨‹ã€‚  ListViewæ˜¾ç¤ºæ‰¾åˆ°çš„è®¾å¤‡ã€‚ <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"60dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/start_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/button_start_find"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"60dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/button_start_control"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/start_control"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/list_device"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> æ§åˆ¶å±å¹•åŸºäºå¸ƒå±€ï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œå°†æ¥ä¼šå˜æˆæ“çºµæ†ã€‚ é€šè¿‡backgroundå±æ€§å°†ä¸€ä¸ªæŒ‰é’®é™„åŠ åˆ°è¯¥æŒ‰é’®ï¼Œä½¿å…¶å˜ä¸ºåœ†å½¢ã€‚ <br> æœ€ç»ˆç‰ˆæœ¬ä¸­æœªä½¿ç”¨TextViewï¼Œä½†æœ€åˆæ˜¯ä¸ºäº†è°ƒè¯•è€Œæ·»åŠ çš„ï¼šæ˜¾ç¤ºäº†é€šè¿‡è“ç‰™å‘é€çš„æ•°å­—ã€‚ åœ¨åˆå§‹é˜¶æ®µï¼Œæˆ‘å»ºè®®æ‚¨ä½¿ç”¨ã€‚ ä½†æ˜¯éšåå°†å¼€å§‹åœ¨å•ç‹¬çš„æµä¸­è®¡ç®—æ•°å­—ï¼Œä»è¯¥æµä¸­å¾ˆéš¾è®¿é—®TextViewã€‚ <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"25dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/button_drive_control"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/button_control_circle"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:minWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"70dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/view_result_touch"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"90dp"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  button_control_circle.xmlæ–‡ä»¶ï¼ˆæ ·å¼ï¼‰ï¼Œå¿…é¡»å°†å…¶æ”¾ç½®åœ¨drawableæ–‡ä»¶å¤¹ä¸­ï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shape</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:shape</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rectangle"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">solid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#00F"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">corners</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:bottomRightRadius</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:bottomLeftRadius</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:topRightRadius</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:topLeftRadius</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100dp"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shape</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> æ‚¨è¿˜éœ€è¦åˆ›å»ºitem_device.xmlæ–‡ä»¶ï¼Œæ¯ä¸ªåˆ—è¡¨é¡¹éƒ½éœ€è¦å®ƒï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/item_device_textView"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h3> æ¸…å• </h3><br> ä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘å°†æä¾›å®Œæ•´çš„æ¸…å•ä»£ç ã€‚ æ‚¨éœ€è¦é€šè¿‡uses-permissionè·å¾—å¯¹è“ç‰™çš„å®Œå…¨è®¿é—®æƒé™ï¼Œå¹¶ä¸”ä¸è¦å¿˜è®°é€šè¿‡æ´»åŠ¨æ ‡ç­¾æŒ‡ç¤ºç¬¬äºŒä¸ªæ´»åŠ¨ã€‚ <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.example.bluetoothapp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BLUETOOTH"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BLUETOOTH_ADMIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:roundIcon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher_round"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:supportsRtl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/AppTheme"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.arproject.bluetoothworkapp.MainActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/Theme.AppCompat.NoActionBar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"landscape"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.arproject.bluetoothworkapp.ActivityControl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/Theme.AppCompat.NoActionBar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"landscape"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h3> ä¸»è¦æ´»åŠ¨ï¼Œé…å¯¹Arduinoå’ŒAndroid </h3><br> æˆ‘ä»¬ä»AppCompatActivityç»§æ‰¿è¯¥ç±»å¹¶å£°æ˜å˜é‡ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BluetoothAdapter bluetoothAdapter; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ListView listView; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ArrayList&lt;String&gt; pairedDeviceArrayList; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ArrayAdapter&lt;String&gt; pairedDeviceAdapter; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> BluetoothSocket clientSocket; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button buttonStartControl; }</code> </pre><br> æˆ‘å°†é€è¡Œæè¿°onCreateï¼ˆï¼‰æ–¹æ³•ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); <span class="hljs-comment"><span class="hljs-comment">//  //    setContentView(R.layout.activity_main); //    Button buttonStartFind = (Button) findViewById(R.id.button_start_find); // layout,       listView = (ListView) findViewById(R.id.list_device); //    buttonStartFind.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { //   ( ) if(permissionGranted()) { //    bluetoothAdapter = BluetoothAdapter.getDefaultAdapter(); if(bluetoothEnabled()) { //   ( ) findArduino(); //   ( ) } } } }); //      buttonStartControl = (Button) findViewById(R.id.button_start_control); buttonStartControl.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { //     Intent intent = new Intent(); //    intent.setClass(getApplicationContext(), ActivityControl.class); //  ,    startActivity(intent); } }); }</span></span></code> </pre><br> ä¸‹é¢çš„åŠŸèƒ½æ£€æŸ¥æ˜¯å¦è·å¾—äº†ä½¿ç”¨è“ç‰™çš„è®¸å¯ï¼ˆåœ¨æ²¡æœ‰ç”¨æˆ·è®¸å¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ— æ³•ä¼ è¾“æ•°æ®ï¼‰ä»¥åŠæ˜¯å¦æ‰“å¼€äº†è“ç‰™ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">permissionGranted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   ,  true if (ContextCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.BLUETOOTH) == PermissionChecker.PERMISSION_GRANTED &amp;&amp; ContextCompat.checkSelfPermission(getApplicationContext(), Manifest.permission.BLUETOOTH_ADMIN) == PermissionChecker.PERMISSION_GRANTED) { return true; } else { ActivityCompat.requestPermissions(this, new String[] {Manifest.permission.BLUETOOTH, Manifest.permission.BLUETOOTH_ADMIN}, 0); return false; } } private boolean bluetoothEnabled() { //  ,  true,  ,      if(bluetoothAdapter.isEnabled()) { return true; } else { Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(enableBtIntent, 0); return false; } }</span></span></code> </pre><br> å¦‚æœæ‰€æœ‰æ£€æŸ¥å‡é€šè¿‡ï¼Œåˆ™è®¾å¤‡æœç´¢å¼€å§‹ã€‚ å¦‚æœä¸æ»¡è¶³å…¶ä¸­ä¸€ä¸ªæ¡ä»¶ï¼Œåˆ™å°†æ˜¾ç¤ºä¸€æ¡é€šçŸ¥ï¼Œè¯´â€œå…è®¸\å¯ç”¨ï¼Ÿâ€ï¼Œå¹¶ä¸”å°†é‡å¤æ­¤æ“ä½œï¼Œç›´åˆ°é€šè¿‡æ£€æŸ¥ä¸ºæ­¢ã€‚ <br><br> è®¾å¤‡æœç´¢åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šå‡†å¤‡åˆ—è¡¨ï¼Œæ·»åŠ åˆ°æ‰¾åˆ°çš„è®¾å¤‡åˆ—è¡¨ä¸­ï¼Œä¸æ‰€é€‰è®¾å¤‡å»ºç«‹è¿æ¥ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findArduino</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    Set&lt;BluetoothDevice&gt; pairedDevice = bluetoothAdapter.getBondedDevices(); if (pairedDevice.size() &gt; 0) { //     pairedDeviceArrayList = new ArrayList&lt;&gt;(); //  for(BluetoothDevice device: pairedDevice) { //      //: " /" pairedDeviceArrayList.add(device.getAddress() + "/" + device.getName()); } } //  ,    item_device.xml pairedDeviceAdapter = new ArrayAdapter&lt;String&gt;(getApplicationContext(), R.layout.item_device, R.id.item_device_textView, pairedDeviceArrayList); listView.setAdapter(pairedDeviceAdapter); //      listView.setOnItemClickListener(new AdapterView.OnItemClickListener() { @Override public void onItemClick(AdapterView&lt;?&gt; adapterView, View view, int i, long l) { //    String itemMAC = listView.getItemAtPosition(i).toString().split("/", 2)[0]; //      BluetoothDevice connectDevice = bluetoothAdapter.getRemoteDevice(itemMAC); try { // socket - ,      Method m = connectDevice.getClass().getMethod( "createRfcommSocket", new Class[]{int.class}); clientSocket = (BluetoothSocket) m.invoke(connectDevice, 1); clientSocket.connect(); if(clientSocket.isConnected()) { //  ,   bluetoothAdapter.cancelDiscovery(); } } catch(Exception e) { e.getStackTrace(); } } }); }</span></span></code> </pre><br> å½“æ‰¾åˆ°æŒ‚åœ¨Arduinoä¸Šçš„è“ç‰™æ¨¡å—æ—¶ï¼ˆç¨åä¼šè¯¦ç»†ä»‹ç»ï¼‰ï¼Œå®ƒå°†å‡ºç°åœ¨åˆ—è¡¨ä¸­ã€‚ é€šè¿‡å•å‡»å®ƒï¼Œæ‚¨å°†å¼€å§‹åˆ›å»ºå¥—æ¥å­—ï¼ˆå•å‡»åå¯èƒ½éœ€è¦ç­‰å¾…3-5ç§’æˆ–å†æ¬¡å•å‡»ï¼‰ã€‚ æ‚¨ä¼šç†è§£ï¼Œè¿æ¥æ˜¯é€šè¿‡è“ç‰™æ¨¡å—ä¸Šçš„LEDå»ºç«‹çš„ï¼šæ²¡æœ‰è¿æ¥ï¼Œå®ƒä»¬ä¼šå¿«é€Ÿé—ªçƒï¼Œå¦‚æœæœ‰è¿æ¥ï¼Œåˆ™é¢‘ç‡ä¼šæ˜æ˜¾é™ä½ã€‚ <br><br><img src="https://habrastorage.org/webt/hg/ok/nf/hgoknf_kwj_yobhcauvx_9lwf1o.png"><br><h3> ç®¡ç†å’Œå‘é€å‘½ä»¤ </h3><br> å»ºç«‹è¿æ¥åï¼Œæ‚¨å¯ä»¥ç»§ç»­æ‰§è¡Œç¬¬äºŒä¸ªæ´»åŠ¨-ActivityControlã€‚ å±å¹•ä¸Šåªæœ‰ä¸€ä¸ªè“è‰²åœ†åœˆ-æ¸¸æˆæ†ã€‚ å®ƒæ˜¯ç”±é€šå¸¸çš„Buttonåˆ¶æˆçš„ï¼Œæ ‡è®°åœ¨ä¸Šé¢ç»™å‡ºã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActivityControl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//,   private Button buttonDriveControl; private float BDCheight, BDCwidth; private float centerBDCheight, centerBDCwidth; private String angle = "90"; //0, 30, 60, 90, 120, 150, 180 private ConnectedThread threadCommand; private long lastTimeSendCommand = System.currentTimeMillis(); }</span></span></code> </pre><br> åœ¨onCreateï¼ˆï¼‰æ–¹æ³•ä¸­ï¼Œæ‰€æœ‰ä¸»è¦æ“ä½œéƒ½å°†å‘ç”Ÿï¼š <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//        performClick() //    @SuppressLint("ClickableViewAccessibility") @Override protected void onCreate(Bundle savedInstanceState) { //  super.onCreate(savedInstanceState); // ,    setContentView(R.layout.activity_control); //  buttonDriveControl = (Button) findViewById(R.id.button_drive_control); //    final ViewTreeObserver vto = buttonDriveControl.getViewTreeObserver(); vto.addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() { @Override public void onGlobalLayout() { //      (!) BDCheight = buttonDriveControl.getHeight(); BDCwidth = buttonDriveControl.getWidth(); //    (!) centerBDCheight = BDCheight/2; centerBDCwidth = BDCwidth/2; // GlobalListener,     buttonDriveControl.getViewTreeObserver().removeOnGlobalLayoutListener(this); } }); // ,     //    buttonDriveControl.setOnTouchListener(new ControlDriveInputListener()); //  ,      //    ,     //    threadCommand = new ConnectedThread(MainActivity.clientSocket); threadCommand.run(); }</span></span></code> </pre><br> æ³¨æ„ï¼ˆï¼ï¼‰-æˆ‘ä»¬å°†æ‰¾å‡ºæŒ‰é’®å ç”¨äº†å¤šå°‘åƒç´ ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è·å¾—äº†é€‚åº”æ€§ï¼šæŒ‰é’®çš„å¤§å°å°†å–å†³äºå±å¹•åˆ†è¾¨ç‡ï¼Œä½†æ˜¯å…¶ä½™ä»£ç å°†å¾ˆå®¹æ˜“é€‚åº”æ­¤æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰é¢„å…ˆç¡®å®šå¤§å°ã€‚ ç¨åï¼Œæˆ‘ä»¬å°†æ•™åº”ç”¨ç¨‹åºæ‰¾å‡ºè§¦æ‘¸çš„ä½ç½®ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºarduinkiå¯ä»¥ç†è§£çš„å€¼ï¼ˆä»0åˆ°255ï¼‰ï¼ˆæ¯•ç«Ÿï¼Œè§¦æ‘¸å¯ä»¥è·ä¸­å¿ƒ456åƒç´ ï¼Œè€ŒMKä¸é€‚ç”¨äºè¯¥æ•°å­—ï¼‰ã€‚ <br><br> ä»¥ä¸‹æ˜¯ControlDriveInputListenerï¼ˆï¼‰çš„ä»£ç ï¼Œè¯¥ç±»ä½äºonCreateï¼ˆï¼‰æ–¹æ³•ä¹‹åçš„æ´»åŠ¨æœ¬èº«çš„ç±»ä¸­ã€‚ åœ¨ActivityControlæ–‡ä»¶ä¸­ï¼ŒControlDriveInputListenerç±»æˆä¸ºå­çº§ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è®¿é—®ä¸»ç±»çš„æ‰€æœ‰å˜é‡ã€‚ <br><br> ä¸è¦å…³æ³¨å•å‡»æ—¶è°ƒç”¨çš„åŠŸèƒ½ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹æ¥è§¦çš„è¿‡ç¨‹æ„Ÿå…´è¶£ï¼šè¯¥äººåœ¨ä»€ä¹ˆæ—¶å€™æ”¾ä¸‹æ‰‹æŒ‡ï¼Œä»¥åŠä»ä¸­è·å¾—ä»€ä¹ˆæ•°æ®ã€‚ <br><br> è¯·æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨java.util.Timerç±»ï¼šå®ƒå…è®¸æ‚¨åˆ›å»ºä¸€ä¸ªå¯èƒ½æœ‰å»¶è¿Ÿçš„æ–°çº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨æ¯ç¬¬nç§’åå°†é‡å¤æ— æ•°æ¬¡ã€‚ åº”è¯¥åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨å®ƒï¼šè¯¥äººæ”¾äº†ä¸€æ ¹æ‰‹æŒ‡ï¼ŒACTION_DOWNæ–¹æ³•èµ·ä½œç”¨ï¼Œä¿¡æ¯åˆ°è¾¾äº†arduinoï¼Œæ­¤åè¯¥äººå†³å®šä¸ç§»åŠ¨æ‰‹æŒ‡ï¼Œå› ä¸ºé€Ÿåº¦é€‚åˆä»–ã€‚ ç¬¬äºŒæ¬¡ï¼ŒACTION_DOWNæ–¹æ³•å°†ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºé¦–å…ˆæ‚¨éœ€è¦è°ƒç”¨ACTION_UPï¼ˆå°†æ‰‹æŒ‡ä»å±å¹•ä¸Šç§»å¼€ï¼‰ã€‚ <br><br> å¥½äº†ï¼Œæˆ‘ä»¬å¯åŠ¨Timerï¼ˆï¼‰ç±»å¾ªç¯ï¼Œå¹¶å¼€å§‹æ¯10æ¯«ç§’å‘é€ç›¸åŒçš„æ•°æ®ã€‚ å½“æ‰‹æŒ‡ç§»å¼€ï¼ˆACTION_MOVEå°†èµ·ä½œç”¨ï¼‰æˆ–æŠ¬èµ·æ‰‹æŒ‡ï¼ˆACTION_UPï¼‰æ—¶ï¼Œå¿…é¡»ç»ˆæ­¢è®¡æ—¶å™¨å‘¨æœŸï¼Œä»¥å…æ—§æŒ‰é”®çš„æ•°æ®å†æ¬¡å¼€å§‹å‘é€ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControlDriveInputListener</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnTouchListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Timer timer; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view, MotionEvent motionEvent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     //      (!) final float x = motionEvent.getX(); final float y = motionEvent.getY(); //,     switch(motionEvent.getAction()) { //  //  ,      case MotionEvent.ACTION_DOWN: //  timer = new Timer(); //  // :    0, //  10  timer.schedule(new TimerTask() { @Override public void run() { //   calculateAndSendCommand(x, y); } }, 0, 10); break; //    (  ACTION_DOWN) case MotionEvent.ACTION_MOVE: // (!) //     Timer(),   if(timer != null) { timer.cancel(); timer = null; } //   timer = new Timer(); //     ,    ACTION_UP timer.schedule(new TimerTask() { @Override public void run() { calculateAndSendCommand(x, y); } }, 0, 10); break; //     case MotionEvent.ACTION_UP: //  if(timer != null) { timer.cancel(); timer = null; } break; } return false; } }</span></span></code> </pre><br> å†æ¬¡æ³¨æ„ï¼šxå’Œyè®¡æ•°onTouchï¼ˆï¼‰æ–¹æ³•ä»è§†å›¾çš„å·¦ä¸Šè§’å¼€å§‹ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç‚¹ï¼ˆ0; 0ï¼‰ä½äºButtonçš„æ­¤å¤„ï¼š <br><br><img src="https://habrastorage.org/webt/7m/yt/on/7mytonhvh6albac02enghpbmce0.png"><br><br> ç°åœ¨ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨æŒ‰é’®ä¸Šè·å¾—æ‰‹æŒ‡çš„å½“å‰ä½ç½®ï¼Œæˆ‘ä»¬å°†å¼„æ¸…æ¥šå¦‚ä½•å°†åƒç´ ï¼ˆå› ä¸ºxå’Œyåªæ˜¯ä»¥åƒç´ ä¸ºå•ä½çš„è·ç¦»ï¼‰è½¬æ¢ä¸ºå·¥ä½œå€¼ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨calculateAndSendCommandï¼ˆxï¼Œyï¼‰æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¿…é¡»æ”¾åœ¨ControlDriveInputListenerç±»ä¸­ã€‚ æ‚¨è¿˜éœ€è¦ä¸€äº›è¾…åŠ©æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨calculateAndSendCommandï¼ˆxï¼Œyï¼‰ä¹‹åå°†å®ƒä»¬å†™åœ¨åŒä¸€ç±»ä¸­ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateAndSendCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    //   // - 1, 2, 3, 4 // ,   ,      // ,     ,     int quarter = identifyQuarter(x, y); //       // y,        int speed = speedCalculation(centerBDCheight - y); //   //   ,    7   String angle = angleCalculation(x); //     ,     //      ,      /*String resultDown = "x: "+ Float.toString(x) + " y: " + Float.toString(y) + " qr: " + Integer.toString(quarter) + "\n" + "height: " + centerBDCheight + " width: " + centerBDCwidth + "\n" + "speed: " + Integer.toString(speed) + " angle: " + angle; */ //viewResultTouch.setText(resultDown); //  ,    //      (  ),   100  if((System.currentTimeMillis() - lastTimeSendCommand) &gt; 100) { //   threadCommand.sendCommand(Integer.toString(speed), angle); //     lastTimeSendCommand = System.currentTimeMillis(); } } private int identifyQuarter(float x, float y) { //,      //  if(x &gt; centerBDCwidth &amp;&amp; y &gt; centerBDCheight) { return 4; } else if (x &lt; centerBDCwidth &amp;&amp; y &gt;centerBDCheight) { return 3; } else if (x &lt; centerBDCwidth &amp;&amp; y &lt; centerBDCheight) { return 2; } else if (x &gt; centerBDCwidth &amp;&amp; y &lt; centerBDCheight) { return 1; } return 0; } private int speedCalculation(float deviation) { //  //      float coefficient = 255/(BDCheight/2); //    //   int speed = Math.round(deviation * coefficient); //    70,    // ,    ,    if(speed &gt; 0 &amp;&amp; speed &lt; 70) speed = 0; if(speed &lt; 0 &amp;&amp; speed &gt; - 70) speed = 0; //     120 // ,     if(speed &lt; 120 &amp;&amp; speed &gt; 70) speed = 120; if(speed &gt; -120 &amp;&amp; speed &lt; -70) speed = -120; //     , ACTION_MOVE   //    ,     //      if(speed &gt; 255 ) speed = 255; if(speed &lt; - 255) speed = -255; //:  &gt; 0 -  , &lt; 0 -  return speed; } private String angleCalculation(float x) { //    7  //0 -  , 180 -  //90 -    if(x &lt; BDCwidth/6) { angle = "0"; } else if (x &gt; BDCwidth/6 &amp;&amp; x &lt; BDCwidth/3) { angle = "30"; } else if (x &gt; BDCwidth/3 &amp;&amp; x &lt; BDCwidth/2) { angle = "60"; } else if (x &gt; BDCwidth/2 &amp;&amp; x &lt; BDCwidth/3*2) { angle = "120"; } else if (x &gt; BDCwidth/3*2 &amp;&amp; x &lt; BDCwidth/6*5) { angle = "150"; } else if (x &gt; BDCwidth/6*5 &amp;&amp; x &lt; BDCwidth) { angle = "180"; } else { angle = "90"; } return angle; }</span></span></code> </pre><br> è®¡ç®—å¹¶ä¼ è¾“æ•°æ®åï¼Œç¬¬äºŒä¸ªæµè¿›å…¥æ¸¸æˆã€‚ ä»–è´Ÿè´£å‘é€ä¿¡æ¯ã€‚ æ‚¨ä¸èƒ½æ²¡æœ‰å®ƒï¼Œå¦åˆ™ä¼ è¾“æ•°æ®çš„å¥—æ¥å­—å°†å‡æ…¢è§¦æ‘¸çš„æ•è·ï¼Œå°†åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ä¸”æ•´ä¸ªç«¯ç‚¹å°†å˜çŸ­ã€‚ <br><br>  ConnectedThreadç±»ä¹Ÿä½äºActivityControlç±»ä¸­ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConnectedThread</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Thread</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> BluetoothSocket socket; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> OutputStream outputStream; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConnectedThread</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BluetoothSocket btSocket)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  this.socket = btSocket; //  -       OutputStream os = null; try { os = socket.getOutputStream(); } catch(Exception e) {} outputStream = os; } public void run() { } public void sendCommand(String speed, String angle) { //    ,   byte[] speedArray = speed.getBytes(); byte[] angleArray = angle.getBytes(); //    //  ,  ,       String a = "#"; String b = "@"; String c = "*"; try { outputStream.write(b.getBytes()); outputStream.write(speedArray); outputStream.write(a.getBytes()); outputStream.write(c.getBytes()); outputStream.write(angleArray); outputStream.write(a.getBytes()); } catch(Exception e) {} } }</span></span></code> </pre><br><h3> æ€»ç»“Androidåº”ç”¨ç¨‹åº </h3><br> ç®€è¦æ€»ç»“ä»¥ä¸Šæ‰€æœ‰ç¹ççš„å·¥ä½œã€‚ <br><br><ol><li> åœ¨ActivityMainä¸­ï¼Œæˆ‘ä»¬é…ç½®è“ç‰™ï¼Œå»ºç«‹è¿æ¥ã€‚ </li><li> åœ¨ActivityControlä¸­ï¼Œæˆ‘ä»¬é™„åŠ æŒ‰é’®å¹¶è·å–æœ‰å…³å®ƒçš„æ•°æ®ã€‚ </li><li> æˆ‘ä»¬æŒ‚åœ¨OnTouchListeneræŒ‰é’®ä¸Šï¼Œå®ƒå¯ä»¥æ•æ‰è§¦æ‘¸ï¼Œç§»åŠ¨å’ŒæŠ¬èµ·æ‰‹æŒ‡ã€‚ </li><li> å°†è·å¾—çš„æ•°æ®ï¼ˆå…·æœ‰xå’Œyåæ ‡çš„ç‚¹ï¼‰è½¬æ¢ä¸ºæ—‹è½¬è§’åº¦å’Œé€Ÿåº¦ </li><li> æˆ‘ä»¬å‘é€æ•°æ®ï¼Œå¹¶ç”¨ç‰¹æ®Šå­—ç¬¦åˆ†éš”å®ƒä»¬ </li></ol><br> å½“æ‚¨æŸ¥çœ‹æ•´ä¸ªä»£ç <a href="">-github.com/IDolgopolov/BluetoothWorkAPP.git</a>æ—¶ï¼Œæœ€ç»ˆçš„ç†è§£å°†å¸¦ç»™æ‚¨ã€‚ æ²¡æœ‰æ³¨é‡Šä»£ç ï¼Œå› æ­¤çœ‹èµ·æ¥æ›´æ•´æ´ï¼Œæ›´å°ï¼Œæ›´ç®€å•ã€‚ <br><h2> ç´ æArduino </h2><br>  Androidåº”ç”¨ç¨‹åºæ˜¯ç»è¿‡åæ±‡ç¼–ï¼Œç¼–å†™ï¼Œç†è§£çš„ï¼Œåœ¨è¿™é‡Œä¼šæ›´åŠ å®¹æ˜“ã€‚ æˆ‘å°†å°è¯•åˆ†é˜¶æ®µè€ƒè™‘æ‰€æœ‰å†…å®¹ï¼Œç„¶åæä¾›æŒ‡å‘å®Œæ•´æ–‡ä»¶çš„é“¾æ¥ã€‚ <br><h3> å˜æ•° </h3><br> é¦–å…ˆï¼Œè€ƒè™‘æ‰€éœ€çš„å¸¸é‡å’Œå˜é‡ã€‚ <br><br><pre> <code class="hljs vhdl">#include &lt;SoftwareSerial.h&gt; //  \  //          SoftwareSerial BTSerial(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); //    int speedRight = <span class="hljs-number"><span class="hljs-number">6</span></span>; int dirLeft = <span class="hljs-number"><span class="hljs-number">3</span></span>; int speedLeft = <span class="hljs-number"><span class="hljs-number">11</span></span>; int dirRight = <span class="hljs-number"><span class="hljs-number">7</span></span>; // ,   int angleDirection = <span class="hljs-number"><span class="hljs-number">4</span></span>; int angleSpeed = <span class="hljs-number"><span class="hljs-number">5</span></span>; //,     ,   //      int pinAngleStop = <span class="hljs-number"><span class="hljs-number">12</span></span>; //    <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> val; //  int speedTurn = <span class="hljs-number"><span class="hljs-number">180</span></span>; //,    //       int pinRed = A0; int pinWhite = A1; int pinBlack = A2; //   long lastTakeInformation; //, ,     <span class="hljs-built_in"><span class="hljs-built_in">boolean</span></span> readAngle = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">boolean</span></span> readSpeed = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre><br><h3> è®¾ç½®ï¼ˆï¼‰æ–¹æ³• </h3><br> åœ¨setupï¼ˆï¼‰æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®å¼•è„šçš„å‚æ•°ï¼šå®ƒä»¬å°†åœ¨è¾“å…¥æˆ–è¾“å‡ºä¸Šå·¥ä½œã€‚ æˆ‘ä»¬è¿˜è®¾ç½®äº†ä¸arduinoï¼Œè“ç‰™ä¸arduinoçš„é€šä¿¡é€Ÿåº¦ã€‚ <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> setup() { pinMode(dirLeft, OUTPUT); pinMode(speedLeft, OUTPUT); pinMode(dirRight, OUTPUT); pinMode(speedRight, OUTPUT); pinMode(pinRed, <span class="hljs-keyword"><span class="hljs-keyword">INPUT</span></span>); pinMode(pinBlack, <span class="hljs-keyword"><span class="hljs-keyword">INPUT</span></span>); pinMode(pinWhite, <span class="hljs-keyword"><span class="hljs-keyword">INPUT</span></span>); pinMode(pinAngleStop, OUTPUT); pinMode(angleDirection, OUTPUT); pinMode(angleSpeed, OUTPUT); //      HC<span class="hljs-number"><span class="hljs-number">-05</span></span> //     ,   BTSerial.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">38400</span></span>); //   <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); }</code> </pre><br><h3>  Loopï¼ˆï¼‰æ–¹æ³•å’Œé™„åŠ åŠŸèƒ½ </h3><br> åœ¨ä¸æ–­é‡å¤çš„loopï¼ˆï¼‰æ–¹æ³•ä¸­ï¼Œè¯»å–æ•°æ®ã€‚ é¦–å…ˆï¼Œè€ƒè™‘ä¸»è¦ç®—æ³•ï¼Œç„¶åè€ƒè™‘å…¶ä¸­æ¶‰åŠçš„åŠŸèƒ½ã€‚ <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(BTSerial.available() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { //    <span class="hljs-type"><span class="hljs-type">char</span></span> a = BTSerial.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a == <span class="hljs-string"><span class="hljs-string">'@'</span></span>) { //   @ (   ) //  val val = ""; //,     readSpeed = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (readSpeed) { //         //   val <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a == <span class="hljs-string"><span class="hljs-string">'#'</span></span>) { //   ,     //      <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println(val); //,      readSpeed = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; //      go(val.toInt()); // val val = ""; //  ,     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } val+=a; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a == <span class="hljs-string"><span class="hljs-string">'*'</span></span>) { //    readAngle = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (readAngle) { // ,     //  ,    val <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a == <span class="hljs-string"><span class="hljs-string">'#'</span></span>) { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println(val); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("-----"); readAngle = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; //     turn(val.toInt()); val= ""; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } val+=a; } //     lastTakeInformation = millis(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //   ,      <span class="hljs-number"><span class="hljs-number">150</span></span>  //  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(millis() - lastTakeInformation &gt; <span class="hljs-number"><span class="hljs-number">150</span></span>) { lastTakeInformation = <span class="hljs-number"><span class="hljs-number">0</span></span>; analogWrite(angleSpeed, <span class="hljs-number"><span class="hljs-number">0</span></span>); analogWrite(speedRight, <span class="hljs-number"><span class="hljs-number">0</span></span>); analogWrite(speedLeft, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯ï¼šä»ç”µè¯ä¸­æˆ‘ä»¬ä»¥â€œ @ speedï¼ƒangleï¼ƒâ€çš„æ ·å¼å‘é€å­—èŠ‚ï¼ˆä¾‹å¦‚ï¼Œå…¸å‹å‘½ä»¤â€œ @ 200ï¼ƒ60ï¼ƒâ€ã€‚æ­¤å‘¨æœŸæ¯100æ¯«ç§’é‡å¤ä¸€æ¬¡ï¼Œå› ä¸ºåœ¨androidä¸Šæˆ‘ä»¬è®¾ç½®äº†å‘é€å‘½ä»¤çš„æ—¶é—´é—´éš”ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºå®ƒä»¬å¼€å§‹æ’é˜Ÿï¼Œå¦‚æœæ›´é•¿ï¼Œè½®å­å¼€å§‹æŠ–åŠ¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡delayï¼ˆï¼‰å‘½ä»¤çš„æ‰€æœ‰å»¶è¿Ÿï¼ˆæ‚¨å°†åœ¨ç¨åçœ‹åˆ°ï¼‰ä¸æ˜¯é€šè¿‡ç‰©ç†å’Œæ•°å­¦è®¡ç®—è€Œæ˜¯æ ¹æ®ç»éªŒé€‰æ‹©çš„ã€‚ zadrezhamï¼Œæœºå™¨è¿è½¬å¹³ç¨³ï¼Œæ‰€æœ‰å›¢é˜Ÿéƒ½æœ‰æ—¶é—´è¿›è¡Œé”»ç‚¼ï¼ˆç”µæµæœ‰æ—¶é—´æ¥è§£å†³ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ªç¯ä¸­ä½¿ç”¨äº†ä¸¤ä¸ªè¾…åŠ©åŠŸèƒ½ï¼Œå®ƒä»¬è·å–æ¥æ”¶åˆ°çš„æ•°æ®å¹¶ä½¿æœºå™¨è¿è½¬å¹¶æ—‹è½¬ã€‚</font></font><br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> go(<span class="hljs-type"><span class="hljs-type">int</span></span> mySpeed) { //   <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mySpeed &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { //  digitalWrite(dirRight, HIGH); analogWrite(speedRight, mySpeed); digitalWrite(dirLeft, HIGH); analogWrite(speedLeft, mySpeed); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //   <span class="hljs-number"><span class="hljs-number">0</span></span>,   digitalWrite(dirRight, LOW); analogWrite(speedRight, abs(mySpeed) + <span class="hljs-number"><span class="hljs-number">30</span></span>); digitalWrite(dirLeft, LOW); analogWrite(speedLeft, abs(mySpeed) + <span class="hljs-number"><span class="hljs-number">30</span></span>); } delay(<span class="hljs-number"><span class="hljs-number">10</span></span>); } <span class="hljs-type"><span class="hljs-type">void</span></span> turn(<span class="hljs-type"><span class="hljs-type">int</span></span> angle) { //      digitalWrite(pinAngleStop, HIGH); // ,     delay(<span class="hljs-number"><span class="hljs-number">5</span></span>); //  <span class="hljs-number"><span class="hljs-number">150</span></span>  ,   // <span class="hljs-number"><span class="hljs-number">30</span></span>  ,   //  <span class="hljs-number"><span class="hljs-number">31</span></span>  <span class="hljs-number"><span class="hljs-number">149</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(angle &gt; <span class="hljs-number"><span class="hljs-number">149</span></span>) { //  ,      //   ,    //    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( digitalRead(pinWhite) == HIGH &amp;&amp; digitalRead(pinBlack) == LOW &amp;&amp; digitalRead(pinRed) == LOW) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } //      //  digitalWrite(angleDirection, HIGH); analogWrite(angleSpeed, speedTurn); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (angle &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(pinRed) == HIGH &amp;&amp; digitalRead(pinBlack) == HIGH &amp;&amp; digitalRead(pinWhite) == HIGH) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } digitalWrite(angleDirection, LOW); analogWrite(angleSpeed, speedTurn); } //  digitalWrite(pinAngleStop, LOW); delay(<span class="hljs-number"><span class="hljs-number">5</span></span>); }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“androidå‘é€æ•°æ®æ—¶ï¼Œç”¨æˆ·å°†å…¶å¤¹æˆ60ã€90ã€120çš„è§’åº¦æ˜¯ä¸å€¼å¾—çš„ï¼Œè¯·æ‰“å¼€ï¼Œå¦åˆ™ï¼Œæ‚¨å°†æ— æ³•ç›´è¡Œã€‚</font><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œå¦‚æœè§’åº¦å¤ªå°ï¼Œä¹Ÿè®¸æ‚¨ä¸åº”è¯¥ç«‹å³ä»androidå‘é€è½¬å¼¯å‘½ä»¤ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºè¿™æœ‰ç‚¹ç¬¨æ‹™ã€‚</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è‰ç»˜ç»“æœ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‰å›¾åªæœ‰ä¸‰ä¸ªé‡è¦æ­¥éª¤ï¼šè¯»å–å‘½ä»¤ï¼Œå¤„ç†æ—‹è½¬æé™ä»¥åŠå‘ç”µæœºä¾›ç”µã€‚</font><font style="vertical-align: inherit;">ä¸€åˆ‡å¬èµ·æ¥å¾ˆç®€å•ï¼Œå°½ç®¡åˆ›å»ºæ—¶é—´é•¿ä¸”é’ï¼Œä½†æ‰§è¡Œèµ·æ¥å´æ¯”ç®€å•å®¹æ˜“ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‰å›¾çš„å®Œæ•´ç‰ˆæœ¬</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æœ€å </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æœˆå·¥ä½œçš„å®Œæ•´æ¸…å•å·²ç»“æŸã€‚</font><font style="vertical-align: inherit;">ç‰©ç†éƒ¨åˆ†è¢«æ‹†è§£ï¼Œè½¯ä»¶æ›´æ˜¯å¦‚æ­¤ã€‚</font><font style="vertical-align: inherit;">åŸç†ä¿æŒä¸å˜-å¯¹äºéš¾ä»¥ç†è§£çš„ç°è±¡ï¼Œæˆ‘ä»¬å°†ä¸€èµ·ç†è§£ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€éƒ¨åˆ†ä¸‹é¢çš„è¯„è®ºå¾ˆæœ‰è¶£ï¼Œä»–ä»¬å‘å¤§å®¶æä¾›äº†è®¸å¤šæœ‰ç”¨çš„æŠ€å·§ï¼Œ</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤šäº</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº†æ‰€æœ‰äººã€‚</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç»“æœè§†é¢‘ </font></font></h3><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tRlm48wx9-Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424813/">https://habr.com/ru/post/zh-CN424813/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424801/index.html">Zeppelin OS-è¿ˆå‘å®‰å…¨æ™ºèƒ½åˆçº¦çš„åˆä¸€æ­¥</a></li>
<li><a href="../zh-CN424803/index.html">å°æ¹¾é»‘å®¢åŸæœ¬æ‰“ç®—åœ¨ç½‘ä¸Šé»‘å®¢é©¬å…‹Â·æ‰å…‹ä¼¯æ ¼ï¼ˆMark Zuckerbergï¼‰çš„Facebooké¡µé¢ï¼Œä½†åæ¥æ”¾å¼ƒäº†ä»–çš„å¨èƒ</a></li>
<li><a href="../zh-CN424805/index.html">æˆ‘å¦‚ä½•åœ¨GitHubï¼ŒDockerå’ŒTravisCIçš„LaTeXä¸­å†™æ–‡å‡­</a></li>
<li><a href="../zh-CN424807/index.html">DD-WRTå’ŒKeenetic Giga 2ä¹‹é—´çš„EOIPï¼Œç”¨äºå°†ä¸¤å¥—å…¬å¯“ç»„åˆæˆä¸€ä¸ªç½‘ç»œæˆ–å°†ä¸€ä¸ªHDDç»„åˆæˆä¸¤å¥—å…¬å¯“</a></li>
<li><a href="../zh-CN424809/index.html">è„±æ°§æ ¸ç³–æ ¸é…¸ ç”¨äºå­˜å‚¨å’Œå¤„ç†ä¿¡æ¯çš„æœºåˆ¶ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN424815/index.html">Facebooké­é»‘å®¢å…¥ä¾µï¼šç”±äºä»£ç é”™è¯¯ï¼Œå¤šè¾¾9000ä¸‡ç”¨æˆ·å¸æˆ·é­åˆ°æ”»å‡»ï¼Œè¯¥å…¬å¸é“æ­‰</a></li>
<li><a href="../zh-CN424817/index.html">æ•°å­—äº§å“è®¾è®¡ã€‚ ç›®çš„ï¼Œè§’è‰²ï¼Œæ–¹æ³•</a></li>
<li><a href="../zh-CN424819/index.html">æ•°æ®éªŒè¯-Javaå’ŒSpringéªŒè¯</a></li>
<li><a href="../zh-CN424821/index.html">å…³äºæ¶é­”å’Œéšå½¢ä¼ é€ï¼šä¸¤ç§ä½¿é‡å­æœªæ¥æ›´åŠ æ¥è¿‘çš„æŠ€æœ¯</a></li>
<li><a href="../zh-CN424823/index.html">ä½çƒ­é‡è¥å…»å¦‚ä½•å½±å“è¡°è€</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>