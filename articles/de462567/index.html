<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèΩ üçó üò® Sodinokibi Ransomware: Eine detaillierte Studie üèÄ üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® üçú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√úber die Sodinokibi-Ransomware wurde k√ºrzlich in den Nachrichten gesprochen, aber nur wenige befassen sich mit den Details dieser Malware. Heute werde...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sodinokibi Ransomware: Eine detaillierte Studie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/462567/">  √úber die Sodinokibi-Ransomware wurde k√ºrzlich in den Nachrichten gesprochen, aber nur wenige befassen sich mit den Details dieser Malware.  Heute werden wir versuchen, Sodinokibi n√§her kennenzulernen und die Prinzipien der Ransomware zu ber√ºcksichtigen, um Priorit√§tsvektoren zum Schutz von Informationssystemen vor einer neuen Bedrohung zu identifizieren. <br><br><img src="https://habrastorage.org/webt/ow/o7/r6/owo7r6oqzz6yfcvxv_g0b7dpzs0.png"><br><a name="habracut"></a><br>  Textautoren: Ravikant Tiwari und Alexander Koshelev <br><br><h3>  Was wissen wir √ºber Sodinokibi? </h3><br>  Sodinokibi wird h√∂chstwahrscheinlich von denselben Angreifern verbreitet, die f√ºr Angriffe von Ransomware aus der GandCrab-Familie bekannt waren, die sich nach Berichten in Untergrundforen nicht mehr entwickeln werden. <br><br>  Sodinokibi verwendet die Oracle WebLogic-Sicherheitsanf√§lligkeit (CVE-2019-2725), um Zugriff auf den Computer des Opfers zu erhalten.  Im System versucht die Malware, sich selbst mit erweiterten Rechten auszuf√ºhren, um uneingeschr√§nkt auf alle Dateien und Ressourcen des PCs zugreifen zu k√∂nnen ... <br>  Sodinokibi versucht, Computer im Iran, in Russland und anderen L√§ndern der ehemaligen UdSSR nicht zu infizieren. <br><br>  Das Ransomware-Programm verwendet AES- und Salsa20-Algorithmen zum Verschl√ºsseln von Benutzerdateien.  AES wird zum Verschl√ºsseln von Sitzungsschl√ºsseln sowie von Daten verwendet, die an den Verwaltungsserver gesendet werden. <br><br>  Benutzerdateien werden mit Salsa20 verschl√ºsselt. <br><br>  Zum Generieren und Verteilen von Schl√ºsseln verwendet Sodinokibi den Diffie-Hellman-Algorithmus f√ºr elliptische Kurven. <br><br>  Auf dem Computer l√∂scht der Virus sofort alle Dateien aus dem Sicherungsordner. <br><br>  Derzeit fordert Ransomware 0,32806964 BTC (2.500 US-Dollar) an, um den Zugriff auf verschl√ºsselte Dateien wiederherzustellen.  Wenn das L√∂segeld nicht innerhalb von 4 Tagen gezahlt wird, versprechen die Erpresser au√üerdem, den Betrag zu verdoppeln ... <br><br><h3>  Wie funktioniert Sodinokibi? </h3><br>  Wir haben eine Instanz von Sodinokibi in unserem Labor untersucht.  Die Ransomware wurde von einem benutzerdefinierten Packer gepackt.  Dar√ºber hinaus gab es auch nach erfolgreichem Auspacken keine lesbaren Zeilen im Code.  Dar√ºber hinaus importiert die Software keine Systembibliotheken oder APIs.  Daher ist es f√ºr statische Antivirenprogramme, die Signaturen verwenden, die auf lesbaren Zeichenfolgen und Tabellen importierter APIs basieren, sehr schwierig, diese zu erkennen. <br><br>  API-Namen und andere Parameter wurden entschl√ºsselt, w√§hrend die Software mit dem RC4-Algorithmus ausgef√ºhrt wurde.  Um die Erkennung von Virenschutzprogrammen noch schwieriger zu machen, f√ºhrt diese Ransomware Operationen an Strings mit einem DJB-Hash anstelle der Strings selbst aus ... <br><br><h3>  Initialisierung </h3><br>  Sodinokibi erstellt zun√§chst eine dynamische Importtabelle.  Zun√§chst ist das Programm davon √ºberzeugt, dass es die einzige Kopie im System ist, die Mutexe √ºberpr√ºft.  Nach der √úberpr√ºfung wird die JSON-Konfiguration mit RC4 entschl√ºsselt, das in der Programmdatei gespeichert ist, und der boolesche Wert des Schl√ºssels "exp" √ºberpr√ºft.  Wenn sein Wert "true" ist, versucht Sodinokibi einen Exploit zu starten.  In unserem Beispiel wurde die Funktion zum Ausnutzen von Sicherheitsl√ºcken ausgef√ºhrt <br><br><img src="https://habrastorage.org/webt/zg/jl/1-/zgjl1-mazfcbijmbdjy-xzgwffw.png"><br><br><img src="https://habrastorage.org/webt/a3/mf/2d/a3mf2do1b2kblyq6nbu3us-vopi.png"><br>  <i><font color="#999999">Entschl√ºsselte JSON-Konfiguration</font></i> <br><br>  Der Code, der den Exploit ausf√ºhrt, √ºberpr√ºft, ob das Update vom 11. September 2018 (KB4457138) auf dem Computer installiert wurde.  Dieser Patch behebt viele der folgenden Sicherheitsl√ºcken.  Wenn es sich nicht auf dem Computer befindet, startet Ransomware je nach Plattform, auf der die Malware ausgef√ºhrt wird, den 32- oder 64-Bit-Shellcode.  Wir glauben, dass die Ransomware versucht, die Berechtigungen eines Administrators mithilfe von CVE-2018-8440 zu erh√∂hen. <br><br><img src="https://habrastorage.org/webt/ge/cd/uk/gecduk1m7ga29wiioqmee4k-sjk.png"><br>  <i><font color="#999999">Snippet 1</font></i> <br><br>  Die Liste der Schwachstellen, die durch das Patchen von KB4457138 behoben wurden: <br><br>  Der Patch KB4457138 behebt die Sicherheitsl√ºcken: <br><br><ul><li>  CVE-2018-8457, CVE-2018-8335, CVE-2018-8424, CVE-2018-8455, CVE-2018-8468, CVE-2018-8447, CVE-2018-8475, CVE-2018-8271, CVE- 2018-8440, CVE-2018-8464, CVE-2018-8469, CVE-2018-8421, CVE-2018-8442, CVE-2018-8367, CVE-2018-8443, CVE-2018-8465, CVE-2018- 8419, CVE-2018-8466, CVE-2018-8410, CVE-2018-8467, CVE-2018-8462, CVE-2018-8452, CVE-2018-8446, CVE-2018-8449, CVE-2018-8420, CVE-2018-8433, CVE-2018-8438, CVE-2018-8435, CVE-2018-8456, CVE-2018-8354, CVE-2018-8434, CVE-2018-8470, CVE-2018-8332, CVE- 2018-0965, CVE-2018-8315, CVE-2018-8439, CVE-2018-8392, CVE-2018-8425, CVE-2018-8393. </li></ul><br><br>  Wenn im System keine Sicherheitsanf√§lligkeit erkannt wird und der Prozess weiterhin als normaler Benutzer ausgef√ºhrt wird, wird der Befehl RUNAS verwendet, um eine andere Instanz zu starten, jedoch mit Administratorrechten, und die aktuelle Instanz, die mit eingeschr√§nkten Berechtigungen arbeitet, wird abgeschlossen.  Der vollst√§ndige Pseudocode ist im folgenden Screenshot dargestellt. <br><br><img src="https://habrastorage.org/webt/ge/cd/uk/gecduk1m7ga29wiioqmee4k-sjk.png"><br><br>  Nachdem Sodinokibi erfolgreich im Administratormodus gestartet wurde, f√ºhrt die Software eine zus√§tzliche vorl√§ufige √úberpr√ºfung durch, kl√§rt den Wert des "bro" -Schl√ºssels in der JSON-Konfiguration und ermittelt das Standortland.  Es wird nicht versucht, Computer aus den folgenden L√§ndern zu infizieren, wenn solche Standortparameter in den Computereinstellungen festgelegt wurden. <br><br><img src="https://habrastorage.org/webt/i5/yv/2m/i5yv2m2hqz8lpaztizkchsrek-4.png"><br>  <i><font color="#999999">Sprach-IDs verfeinern</font></i> <br><br>  Liste der Ausnahmel√§nder <br><br><ul><li>  Rum√§nien, Russland, Ukraine, Wei√ürussland, Estland, Lettland, Litauen, Tadschikistan, Iran, Armenien, Aserbaidschan, Georgien, Kasachstan, Kirgisistan, Turkmenistan, Usbekistan, Tatarstan </li></ul> <br>  * Anmerkung des Herausgebers: Aus einem unbekannten Grund heben die Autoren speziell das tatarische Gebietsschema in Russland hervor <br><br>  Nach dem Bestehen des Tests beendet die Malware den Prozess mysql.exe (falls er gestartet wurde), um Zugriff auf die MySQL-Dateien zu erhalten und diese zu verschl√ºsseln.  Danach entfernt die Ransomware Schattenkopien von Windows mit vssadmin und deaktiviert das Windows-Wiederherstellungssystem mit bcdedit: <br><br> <code>vssadmin.exe Delete Shadows /All /Quiet &amp; bcedit /set {default} <br> recoveryenabled No &amp; bcedit /set {default} bootstatuspolice ignorealfailures</code> <br> <br>  Vor dem Verschl√ºsseln von Benutzerdateien durchsucht Sodinokibi alle Dateisysteme, einschlie√ülich Netzwerkordner, nach Verzeichnissen mit dem Namen "Backup" und l√∂scht diese dauerhaft.  Es ist interessant, dass die Malware vor dem L√∂schen des Verzeichnisses selbst den Inhalt aller dieser Ordner durch einen zuf√§lligen Satz von Bytes ersetzt, um eine Wiederherstellung im Prinzip unm√∂glich zu machen.  Gl√ºcklicherweise k√∂nnen Acronis Backup-Dateien nicht so einfach gel√∂scht werden, da sie auf Kernelebene gesch√ºtzt sind, insbesondere um zu verhindern, dass Ransomware solche Aktionen ausf√ºhrt. <br><br><h3>  Schl√ºsselgenerierung </h3><br>  Sodinokibi verwendet das Diffie-Hellman-Protokoll zur Erzeugung und zum Austausch elliptischer Kurven (ECDH).  Die generierten Sitzungsschl√ºssel werden in symmetrischen Verschl√ºsselungsalgorithmen verwendet, und verschiedene Datentypen werden mit verschiedenen Methoden verschl√ºsselt - AES und Salsa20. <br><br>  AES wird verwendet, um einen privaten Schl√ºssel aus einem Paar privater und √∂ffentlicher Schl√ºssel zu verschl√ºsseln, die lokal auf dem Benutzercomputer generiert werden.  Es verschl√ºsselt auch Daten w√§hrend der √úbertragung √ºber das Netzwerk.  Salsa20 wird zum Verschl√ºsseln von Benutzerdateien verwendet. <br><br>  Sodinokibi enth√§lt zwei verschiedene √∂ffentliche Schl√ºssel, von denen einer Teil der JSON-Konfiguration ist und der zweite in die Bin√§rdatei eingebettet ist.  Diese √∂ffentlichen Schl√ºssel werden verwendet, um den auf dem Computer erstellten privaten Schl√ºssel zu verschl√ºsseln.  Die spezifischen Schritte der Schl√ºsselgenerierung und -verschl√ºsselung sind wie folgt: <br><br>  <b>Schritt 1.</b> Generieren eines Sitzungspaars aus einem privaten (geheimen, zuf√§lligen) und √∂ffentlichen Schl√ºssel auf dem lokalen Computer. <br><br><img src="https://habrastorage.org/webt/ss/o7/s_/sso7s_-kmgvl8z8tqqecaufm7va.png"><br>  <i><font color="#999999">Lokale Generierung von privaten und √∂ffentlichen Schl√ºsseln</font></i> <br><br>  Die Verschl√ºsselung des privaten Schl√ºssels aus Schritt 1 erfolgt mit dem √∂ffentlichen Schl√ºssel aus der JSON-Konfiguration <br><br>  <b>Schritt 2.</b> Generieren Sie ein weiteres Paar privater und √∂ffentlicher Schl√ºssel. <br><br>  <b>Schritt 3.</b> Unter Verwendung des privaten Schl√ºssels aus Schritt 2 und des √∂ffentlichen Schl√ºssels (pk-Schl√ºsselwert) wird ein √∂ffentlicher Schl√ºssel aus JSON generiert, und nach dem Hashing wird ein symmetrischer Schl√ºssel erhalten. <br><br><img src="https://habrastorage.org/webt/lo/sp/af/lospafrq5cwhv1ucx8rq3cc6nem.png"><br>  <i><font color="#999999">Generieren Sie einen symmetrischen Schl√ºssel mit einem gemeinsam genutzten Schl√ºssel</font></i> <br><br>  <b>Schritt 4.</b> Erzeugung einer 16-Bit-IV (Initialisierungsvektor). <br><br>  <b>Schritt 5.</b> Verschl√ºsseln Sie den in Schritt 1 generierten privaten Schl√ºssel mit AES mit dem Schl√ºssel und IV, die in den Schritten 3 und 4 erhalten wurden. <br><br>  <b>Schritt 6.</b> Berechnung von CRC32 f√ºr den verschl√ºsselten privaten Schl√ºssel, wie in Schritt 5 festgestellt. <br><br>  <b>Schritt 7.</b> Hinzuf√ºgen von IV und CRC32 am Ende des Puffers mit dem verschl√ºsselten privaten Schl√ºssel aus Schritt 5. <br><br>  <b>Schritt 8.</b> Speichern Sie den Puffer in der zugeh√∂rigen Datei mit dem Offset (markiert mit ‚Äûsk_key‚Äú). <br><br><img src="https://habrastorage.org/webt/au/tu/tp/aututpoxj74jy0shog3h30cms4m.png"><br>  <i><font color="#999999">Verschl√ºsseln Sie den privaten Schl√ºssel aus Schritt 1 mit den √∂ffentlichen Schl√ºsseln des Angreifers</font></i> <i><font color="#999999"><br><br></font></i>  <i><font color="#999999">Verschl√ºsseln Sie den privaten Schl√ºssel aus Schritt 1 mit dem in der Bin√§rdatei enthaltenen √∂ffentlichen Schl√ºssel.</font></i> <br><br>  <b>Schritt 9.</b> Wiederholen Sie die Schritte 2 bis 7 mit einem anderen √∂ffentlichen Schl√ºssel, der in Schritt 3 in die Bin√§rdatei eingebettet wurde. <br><br>  <b>Schritt 10.</b> Speichern des Puffers in einer zugeordneten Datei mit einem Offset im Speicher (Markierung ‚Äû0_key‚Äú) <br>  sk_key, 0_key und pk_key werden abh√§ngig von den vom Programm empfangenen Zugriffsrechten entsprechend in die Registrierung geschrieben ... <br><br>  HKLM \ SOFTWARE \ recfg \ sk_key oder HKCU \ SOFTWARE \ recfg \ sk_key <br>  HKLM \ SOFTWARE \ recfg \ 0_key oder HKCU \ SOFTWARE \ recfg \ 0_key <br>  HKLM \ SOFTWARE \ recfg \ pk_key oder HKCU \ SOFTWARE \ recfg \ pk_key <br><br><img src="https://habrastorage.org/webt/ey/la/os/eylaoslusems6caly5ma0gwgez8.png">  <i><font color="#999999">Verschl√ºsselter geheimer Schl√ºssel in der Registrierung</font></i> <i><font color="#999999"><br></font></i>  <i><font color="#999999">Schl√ºsselgenerierung f√ºr einzelne Dateien mit Salsa20</font></i> <br><br>  <b>Schritt 11.</b> Generieren Sie ein neues Paar aus dem √∂ffentlichen und dem privaten Schl√ºssel. <br><br>  <b>Schritt 12.</b> Generieren Sie einen gemeinsam genutzten Schl√ºssel mit dem in Schritt 2 erstellten √∂ffentlichen Sitzungsschl√ºssel und dem Hash, um den n√§chsten symmetrischen Schl√ºssel zu erhalten, der zum Generieren der Schl√ºssel in Salsa20 erforderlich ist. <br><br>  <b>Schritt 13.</b> Installieren eines 256-Bit-Schl√ºssels (32 Byte) in Salsa20 <br><br>  <b>Schritt 14.</b> Generieren Sie eine 8-Bit-IV f√ºr Salsa20-Schl√ºssel <br><br>  <b>Schritt 15.</b> Salsa20-Schl√ºsselgenerierung <br><br>  <b>Schritt 16.</b> Verwenden von Salsa20 key_state zum Verschl√ºsseln von Benutzerdateien mit Salsa20. <br><br><img src="https://habrastorage.org/webt/ej/xs/yq/ejxsyqwuteyfomfybfsrsdyolvc.png"><br>  <i><font color="#999999">Salsa20-Schl√ºsselgenerierung f√ºr jede Datei</font></i> <i><font color="#999999"><br></font></i>  <i><font color="#999999">Wiederholen Sie die Schritte 11 bis 16 f√ºr jede verschl√ºsselte Datei.</font></i> <br><br><h3>  Illustration der Ver- und Entschl√ºsselung </h3><br>  Um besser zu verstehen, wie die Schl√ºssel zwischen den Computern des Angreifers und des Opfers generiert und √ºbertragen werden, m√ºssen Sie verstehen, wie der Diffie Hellman-Algorithmus funktioniert - dies ist leicht zu veranschaulichen. <br><br><h3>  Verschl√ºsselungsprozess </h3><br><img src="https://habrastorage.org/webt/h4/wy/v1/h4wyv1ghwh-gvjedkpk8r5efoa4.png"><br>  <i><font color="#999999">Diffie-Hellman Elliptic Curve Key Exchange (ECDH)</font></i> <br><br><img src="https://habrastorage.org/webt/_w/jh/j-/_wjhj-xhi3xqpklm437g5eicadu.png"><br>  <i><font color="#999999">Eine detaillierte Beschreibung des Verschl√ºsselungsprozesses in Sodinokibi</font></i> <br><br>  Zum Entschl√ºsseln der Daten werden die privaten Schl√ºssel des Angreifers ben√∂tigt.  Sie werden jedoch nirgendwo ver√∂ffentlicht, und daher ist es unm√∂glich, Dateien wiederherzustellen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/155/103/aed/155103aedec3a0a2df481b585b12e0e5.png" alt="Bild"><br>  <i><font color="#999999">Entschl√ºsselungsprozess (das Geheimnis des Angreifers ist sein privater Schl√ºssel)</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/533/3be/cc1/5333becc1ca07074b35d708cc402796f.png" alt="Bild"><br>  <i><font color="#999999">Der vereinfachte Prozess zum Entschl√ºsseln von Benutzerdateien ist unten dargestellt.</font></i> <br><br><h3>  Dateiverschl√ºsselung auf lokalen Festplatten und Netzwerkordnern </h3><br>  Zum Verschl√ºsseln von Benutzerdateien verwendet Sodinokibi E / A-Abschlussports und startet mehrere Verschl√ºsselungsstr√∂me, jedoch nicht mehr als die doppelte Anzahl von Prozessorkernen auf dem Computer, wobei diese Streams einem speziell erstellten E / A-Port zugeordnet werden.  Diese Threads verwenden die GetQueuedCompletionStatus Win-API-Funktion, um auf das Eintreffen eines Pakets am E / A-Port zu warten, bevor die Dateiverschl√ºsselung gestartet wird. <br><br>  Sobald Streams erstellt werden und auf das Eintreffen von E / A-Paketen warten, beginnt Sodinokibi, Benutzerdateien auf allen lokalen Laufwerken und in allen Netzwerkordnern mit Ausnahme von CD-ROM und RAMDISK zu sortieren und sie den entsprechenden E / A-Abschlussports zuzuweisen.  F√ºr alle Dateien, die nicht unter die Liste der Ausnahmen in den Namen von Ordnern, Dateien und Erweiterungen fallen, wird die Funktion AddFileToIoCompletionPort aufgerufen und anschlie√üend PostQueuedCompletionStatus. Dadurch wird die Ausf√ºhrung an den Verschl√ºsselungsdatenstrom √ºbergeben, der auf Informationen √ºber den E / A-Abschlussport wartet, um die Dateiverschl√ºsselung zu starten. <br><br>  Die AddFileToIoCompletionPort-Funktion generiert au√üerdem einen eindeutigen Salsa20-Schl√ºssel f√ºr jede zu verschl√ºsselnde Datei und √ºbergibt den Salsa20-Schl√ºssel zusammen mit anderen Metadaten, die nach der Verschl√ºsselung mit dem Parameter lpOverlapped der PostQueuedCompletionStatus Win-API-Funktion aufgezeichnet werden m√ºssen, an den Verschl√ºsselungsdatenstrom. <br><br>  Nach der Verarbeitung der Dateien in jedem Verzeichnis wird mit Ausnahme der Ausnahme eine Datei mit einer L√∂segeldforderung erstellt.  Wenn die zu verschl√ºsselnden Dateien leer sind, gehen die Threads in eine Schleife und warten, bis die Gesamtzahl der verschl√ºsselten und umbenannten Dateien die Gesamtzahl der an den E / A-Abschlussport √ºbertragenen Dateien erreicht. <br><br>  Schlie√ülich setzt das System ein Flag, das angibt, dass keine weiteren Dateien zu verschl√ºsseln sind, und sendet mehrere E / A-Pakete, die den Abschluss des Prozesses signalisieren.  Dadurch wird die Einstellung zus√§tzlicher Verschl√ºsselungsstr√∂me erreicht, die auf Daten gewartet haben. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ba/7a2/e30/3ba7a2e309a6402db2e6dd37adf44acc.png" alt="Bild"><br><br>  Liste der Ausnahmeordner <br><br><ul><li>  "$ windows. ~ bt" </li><li>  "Intel" </li><li>  "Programmdateien (x86)" </li><li>  "Programmdateien" </li><li>  "Msocache" </li><li>  "$ recycle.bin" </li><li>  "$ windows. ~ ws" </li><li>  "Tor Browser" </li><li>  "Boot" </li><li>  "Systemvolumeninformationen" </li><li>  "Perflogs" </li><li>  Google </li><li>  "Anwendungsdaten" </li><li>  "Windows" </li><li>  "Programmdaten" </li><li>  "Windows.old" </li><li>  "Appdata" </li><li>  "Mozilla" </li><li>  Dateiausnahmen </li><li>  "Bootfont.bin" </li><li>  "Boot.ini" </li><li>  "Ntuser.dat" </li><li>  "Desktop.ini" </li><li>  "Iconcache.db" </li><li>  Ntldr </li><li>  "Ntuser.dat.log" </li><li>  "Thumbs.db" </li><li>  "Bootsect.bak" </li><li>  "Ntuser.ini" </li><li>  "Autorun.inf" </li><li>  Erweiterungsausnahmen </li><li>  "Themepack" </li><li>  Ldf </li><li>  Scr </li><li>  Icl </li><li>  386 </li><li>  "Cmd" </li><li>  "Ani" </li><li>  "Adv" </li><li>  "Thema" </li><li>  "Msi" </li><li>  "Rtp" </li><li>  "Diagcfg" </li><li>  "Msstyles" </li><li>  "Bin" </li><li>  Hlp </li><li>  Shs </li><li>  Drv </li><li>  "Wpx" </li><li>  "Deskthemepack" </li><li>  "Fledermaus" </li><li>  "Rom" </li><li>  "Msc" </li><li>  "Lnk" </li><li>  Kabine </li><li>  "Spl" </li><li>  "Ps1" </li><li>  "Msu" </li><li>  Ics </li><li>  "Schl√ºssel" </li><li>  "Msp" </li><li>  "Com" </li><li>  Sys </li><li>  "Diagpkg" </li><li>  "Nls" </li><li>  "Diagcab" </li><li>  Ico </li><li>  "Lock" </li><li>  "Ocx" </li><li>  "Mpa" </li><li>  "Cur" </li><li>  Cpl </li><li>  "Mod" </li><li>  Hta </li><li>  "Exe" </li><li>  "Icns" </li><li>  "Prf" </li><li>  "Dll" </li><li>  "Nomedia" </li><li>  Idx </li></ul><br>  Der Verschl√ºsselungsdatenstrom setzt voraus, dass der Inhalt der Datei gelesen, verschl√ºsselt, in dieselbe Datei zur√ºckgeschrieben und Metadaten, einschlie√ülich des privaten Schl√ºssels der verschl√ºsselten Sitzung, mit dem √∂ffentlichen Teil von ECDH f√ºr jede Datei und dem zum Verschl√ºsseln der Datei verwendeten Salsa20-Initialisierungsvektor hinzugef√ºgt werden. <br><br>  Danach benennt der Stream die Datei um und f√ºgt dem Namen einen zuf√§llig generierten Namen hinzu.  Dateien werden mit dem Salsa20-Algorithmus mithilfe der EncryptAndWrite-Funktion verschl√ºsselt. <br><br>  Das folgende Beispiel zeigt den Aufruf der Funktion EncryptingThreadRoutine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/585/d44/fab/585d44fab868f9461a5963dc1f6a9f72.png" alt="Bild"><br>  <i><font color="#999999">Dateistruktur nach der Verschl√ºsselung</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ce/0a1/c4a/1ce0a1c4acd810503e66c32de66c0a93.png" alt="Bild"><br>  <i><font color="#999999">Verschl√ºsselte Dateistruktur</font></i> <br><br><h3>  Netzwerkaktivit√§t </h3><br>  Nach Abschluss des Verschl√ºsselungsprozesses bereitet die Ransomware die Daten f√ºr das Senden an den Verwaltungsserver vor.  Die Daten enthalten verschiedene Felder aus der JSON-Konfiguration, Systeminformationen und Verschl√ºsselungsschl√ºssel.  Vorbereitete Daten werden auch unter dem Schl√ºssel "[HKLM | HKCU] \ SOFTWARE \ recfg \ stat" in die Registrierung geschrieben, bevor sie von AES verschl√ºsselt und an den Server des Angreifers gesendet werden ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/177/c79/75b/177c7975bd8ed873554686cd35085dee.png" alt="Bild"><br><br>  Netzwerkdaten <br><br><img src="https://habrastorage.org/webt/_e/7-/nt/_e7-ntfpxprjff32wylpvkqbwou.jpeg"><br><br>  Der Domainname besteht aus: sochi-okna23 [.] Ru + Teil von Adresse 1 <br><br><ul><li>  "Wp-Inhalt" </li><li>  "Statisch" </li><li>  "Inhalt" </li><li>  "Einschlie√üen" </li><li>  "Uploads" </li><li>  "Nachrichten" </li><li>  "Daten" </li><li>  "Admin" </li></ul><br>  und Teil der Adresse 2 <br><br><ul><li>  "Bilder" </li><li>  "Bilder" </li><li>  "Bild" </li><li>  "Temp" </li><li>  "Tmp" </li><li>  "Grafik" </li><li>  "Verm√∂genswerte" </li><li>  Bilder </li><li>  "Spiel" </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/114/8c0/080/1148c0080da59e15820170215234c139.png" alt="Bild"><br>  <i><font color="#999999">URL-Generierung</font></i> <br><br><h3>  L√∂segeldforderung </h3><br>  Sodinokibi verf√ºgt √ºber eine Vorlage zum Erstellen einer R√ºckkaufanfrage, die Platz f√ºr Benutzerdaten l√§sst.  Sie ersetzen automatisch den Namen, die Benutzer-ID (UID - Beschreibung oben) und den Schl√ºssel.  Die L√∂segeldanforderung wird in jedem Verzeichnis abgelegt, ohne Ausnahmen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/386/32b/bd6/38632bbd6f4f0aee82221e912141f581.png" alt="Bild"><br><br><h3>  Entschl√ºsselung </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/125/d73/54d/125d7354d290e43946bfdb96a5694c79.png" alt="Bild"><br><br>  Es gibt keine kostenlose M√∂glichkeit, die Daten f√ºr diese Ransomware zu entschl√ºsseln. Die einzige M√∂glichkeit, die Daten wiederherzustellen, besteht darin, den vom Angreifer bereitgestellten Entschl√ºsselungsdienst zu verwenden.  Folgen Sie den Anweisungen in der L√∂segeldanforderung ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/707/55b/adf/70755badfcf4a2f59b23e72cffc4cbec.png" alt="Bild"><br><br><h3>  Fazit </h3><br>  Wir empfehlen Ihnen, einen erweiterten Anti-Ransomware-Schutz zu verwenden und Ihre Antivirensysteme auf dem neuesten Stand zu halten.  Alle Acronis-Produkte enthalten einen verbesserten Ransomware-Schutz und k√∂nnen Sie vor einem solchen Angriff sch√ºtzen, wodurch das Risiko eines Datenverlusts minimiert wird. <br><br>  Der Cyber-Schutz ist in der pers√∂nlichen L√∂sung von Acronis True Image 2019 sowie in den Gesch√§ftssystemen von Acronis Backup enthalten, die von einem auf k√ºnstlicher Intelligenz basierenden Anti-Malware-Modul namens Acronis Active Protection begleitet werden.  Dank dessen k√∂nnen beide Systeme Benutzer vor Sodinokibi sch√ºtzen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462567/">https://habr.com/ru/post/de462567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462551/index.html">Beliebte Entwicklerfragen zum Testen</a></li>
<li><a href="../de462553/index.html">Ein bisschen √ºber einfach. Testdesign. Teil 1</a></li>
<li><a href="../de462555/index.html">Diskussion: Was ist, wenn Sie ohne Cookies arbeiten? Wir sagen Ihnen, welche Alternativen es gibt</a></li>
<li><a href="../de462563/index.html">Webinar ‚ÄûWie man Compliance √ºberlebt?‚Äú Der beste Ansatz zur Erf√ºllung regulatorischer Anforderungen ‚Äú</a></li>
<li><a href="../de462565/index.html">So bereiten Sie Daten f√ºr SAP Process Mining von Celonis vor</a></li>
<li><a href="../de462569/index.html">Das Transportsystem bei uns und mit ihnen oder ‚ÄûBushaltestellen gegen Aggregatoren 2‚Äú</a></li>
<li><a href="../de462571/index.html">Die Abenteuer der schwer fassbaren Malvari: Vielseitige Verteidigung (letzte Gedanken)</a></li>
<li><a href="../de462573/index.html">Projektwettbewerbe: Was, warum und warum?</a></li>
<li><a href="../de462575/index.html">Sicherheitswoche 32: L√ºcke in iMessage, Datenschutz bei der Spracheingabe</a></li>
<li><a href="../de462577/index.html">Meine Nim-Entwicklungserfahrung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>