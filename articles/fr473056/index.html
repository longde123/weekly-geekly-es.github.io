<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåõ ü§∞üèª ‚èÆÔ∏è Comment Alice reconna√Æt les pays √† partir de photographies. Recherche Yandex üöÖ üö∞ üë∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Je m'appelle Evgeny Kashin et je travaille au laboratoire d'intelligence artificielle Yandex. Nous avons r√©cemment lanc√© un jeu dans lequel les ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment Alice reconna√Æt les pays √† partir de photographies. Recherche Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/473056/"> Salut  Je m'appelle Evgeny Kashin et je travaille au laboratoire d'intelligence artificielle Yandex.  Nous avons r√©cemment lanc√© un jeu dans lequel les utilisateurs rivalisent avec Alice dans les pays √† deviner √† partir de photographies. <br><br>  La fa√ßon dont les gens agissent est compr√©hensible: ils reconnaissent les endroits qu'ils ont vus en voyage ou au cin√©ma, s'appuient sur l'√©rudition et le bon sens.  Le r√©seau neuronal n'a rien de tout cela.  Nous nous sommes demand√©s quels d√©tails sur les photos lui ont donn√© la r√©ponse.  Nous avons men√© une √©tude dont nous partagerons aujourd'hui les r√©sultats avec Habr. <br><br>  Ce poste sera int√©ressant √† la fois pour les sp√©cialistes du domaine de la vision par ordinateur, et pour tous ceux qui souhaitent regarder √† l'int√©rieur de "l'intelligence artificielle" et comprendre la logique de son travail. <br><br><img src="https://habrastorage.org/webt/yr/_o/ww/yr_oww7tnonz-ow4eos1dil0eom.png"><br><a name="habracut"></a><br>  Quelques mots sur le jeu " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Devinez le pays par photo</a> ".  En bref, nous avons pris des photos de Yandex.Maps et les avons divis√©es en deux groupes.  Le premier groupe a √©t√© montr√© par des r√©seaux de neurones, indiquant o√π chaque photo a √©t√© prise.  Apr√®s avoir examin√© des milliers de photographies, le r√©seau de neurones s'est fait une id√©e de chaque pays - c'est-√†-dire qu'il a identifi√© ind√©pendamment des combinaisons de signes permettant de le reconna√Ætre.  Nous utilisons le deuxi√®me groupe d'images du jeu, Alice ne les a pas vues et ne s'en souvient pas pendant le jeu.  Alice joue bien, mais les gens ont un avantage: nous n'avons pas form√© le r√©seau neuronal √† reconna√Ætre les num√©ros de machine, les textes des signes et des signes, les drapeaux des √©tats. <br><br><img src="https://habrastorage.org/webt/wl/ch/1k/wlch1kqg7uzoapthamc-pwtvatc.jpeg"><br><br>  Pour le jeu, nous avons form√© le mod√®le pour pr√©dire le pays √† partir d'une photo.  Nous avons pris un mod√®le de vision par ordinateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SE-ResNeXt-101</a> , pr√©- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">form√©</a> sur de nombreuses t√¢ches.  Les signes obtenus √† partir de l'image utilisant ce r√©seau de neurones convolutifs sont assez universels, donc pour le classificateur de pays, il n'a fallu ajouter que quelques couches suppl√©mentaires (ce que l'on appelle la t√™te).  Les donn√©es Yandex.Mart ont √©t√© utilis√©es pour la formation: environ 2,5 millions de photos.  De nombreuses photos ne correspondaient pas au jeu selon le crit√®re de la beaut√© et ont √©t√© filtr√©es.  La beaut√© est comprise comme une combinaison de facteurs: la qualit√© de la photo, la pr√©sence de personnes, le texte, la for√™t, la mer.  Des images similaires ont √©t√© retir√©es du m√™me endroit afin que le mod√®le ne se souvienne pas de vues sp√©cifiques.  Apr√®s tout le filtrage, il restait environ 1 million de photos.  Apr√®s avoir form√© le mod√®le sur ces donn√©es, nous avons obtenu un classificateur assez pr√©cis, qui d√©termine le pays uniquement par photo, sans utiliser d'informations suppl√©mentaires. <br><br>  √âtant donn√© que la classification est effectu√©e √† l'aide d'un r√©seau de neurones, nous ne pouvons pas facilement obtenir une interpr√©tation des pr√©dictions, contrairement aux mod√®les lin√©aires plus simples ou aux arbres de d√©cision.  Mais nous voulions savoir comment un r√©seau de neurones d√©termine √† partir d'une photographie r√©guli√®re d'une rue ou d'une maison de quel pays il s'agit.  Et les cas les plus int√©ressants sont sans attraits dans le cadre. <br><br>  Pour ce faire, nous avons form√© le r√©seau neuronal √† partir de z√©ro, en ne lui fournissant pas des images enti√®res, mais seulement de petits morceaux de culture (de sorte que le mod√®le ne se souvienne pas de lieux sp√©cifiques ou de gros objets). <br><br>  Ainsi, la t√¢che pour le mod√®le est devenue sensiblement plus difficile (essayez de deviner le pays par un morceau de ciel), la pr√©cision de reconnaissance a consid√©rablement diminu√©.  Mais d'un autre c√¥t√©, le r√©seau neuronal a d√ª pr√™ter plus d'attention aux petits d√©tails: ma√ßonnerie inhabituelle, motifs sp√©cifiques, type de toit, plantes.  La taille du recadrage appliqu√© au mod√®le a chang√© et diff√©rents mod√®les ont √©t√© obtenus qui regardaient la photo √† diff√©rents niveaux d'abstraction: plus le recadrage √©tait petit, plus la t√¢che √©tait difficile et plus le mod√®le √©tait attentif aux d√©tails. <br><br><img src="https://habrastorage.org/webt/-l/mq/og/-lmqognmqibnu46jxgyptkcojpk.jpeg"><br><br>  Des algorithmes pour interpr√©ter les pr√©dictions peuvent √™tre appliqu√©s √† des mod√®les qui ont √©t√© form√©s sur des tailles de cultures de diff√©rentes tailles.  Je voudrais interpr√©ter les pr√©dictions dans les photographies sources.  La plupart des r√©seaux de convolution modernes utilisent le <a href="">Global Average Pooling</a> (GAP) avant la derni√®re couche - cela permet de former le r√©seau sur une taille et de l'appliquer sur une autre.  Cela est d√ª au fait qu'avant la derni√®re couche, les entit√©s spatiales, r√©parties en largeur et en hauteur, sont moyenn√©es en un num√©ro pour chaque canal (carte des entit√©s).  Par cons√©quent, des mod√®les form√©s sur le recadrage (par exemple, 160 √ó 160 pixels) peuvent √™tre utilis√©s sur les grandes images originales (800 √ó 800). <br><br>  En fait, la couche GAP est n√©cessaire non seulement pour utiliser le mod√®le √† diff√©rentes r√©solutions ou pour la r√©gularisation.  Il aide √©galement le r√©seau neuronal √† stocker des informations sur la position des objets jusqu'√† la toute derni√®re couche (juste ce dont nous avons besoin). <br><br>  La premi√®re m√©thode que nous avons essay√©e est la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cartographie d'activation de classe</a> (CAM). <br><br><img src="https://habrastorage.org/webt/5e/_j/_x/5e_j_xaziz1xmlvkerszzc2xjxm.jpeg"><br><br>  Lorsque l'image est envoy√©e √† l'entr√©e du r√©seau neuronal, puis sur l'avant-derni√®re couche, une ¬´image¬ª r√©duite (en fait le tenseur d'activation) est obtenue avec les signes les plus importants pour chaque classe pr√©dite.  En utilisant la m√©thode CAM, vous pouvez modifier les derni√®res couches afin que la sortie soit la probabilit√© de chaque classe dans chaque r√©gion.  Par exemple, si vous voulez pr√©dire 60 classes (pays), pour une image d'entr√©e de 800 √ó 800, l'image finale sera compos√©e de 60 cartes d'activation de taille 25 √ó 25. Ceci est bien illustr√© dans la publication <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">originale</a> . <br><br>  Le diagramme ci-dessus montre le mod√®le habituel avec GAP: les entit√©s spatiales sont compress√©es en un num√©ro pour chaque canal (carte des entit√©s), apr√®s quoi il y a une couche enti√®rement connect√©e qui pr√©dit les classes qui trouvent les poids optimaux pour chaque canal.  Ce qui suit montre comment modifier l'architecture pour obtenir la m√©thode CAM: la couche GAP est supprim√©e et les poids de la derni√®re couche enti√®rement connect√©e obtenue lors de la formation avec GAP (ci-dessus dans le diagramme) sont utilis√©s pour chaque canal √† chaque point.  Pour chaque image, N cartes d'activation sont obtenues pour toutes les classes pr√©dites.  Pour chaque pays, plus la zone de la ¬´carte¬ª est lumineuse, plus la contribution de cette section de l'image √† la d√©cision de choisir un pays est importante.  Ce qui est int√©ressant: si apr√®s cette op√©ration, nous faisons la moyenne de chaque carte d'activation (en gros, appliquons GAP), alors nous obtenons juste la pr√©diction initiale pour chaque classe. <br><br><img src="https://habrastorage.org/webt/i5/21/-i/i521-iavyhhn6bxnf_xpbfwjkvy.png"><br><br>  Dans l'image, vous voyez une carte d'activation pour la classe la plus probable (selon le mod√®le).  Il a √©t√© obtenu en √©tirant la carte d'activation de 25 √ó 25 √† la taille de l'image originale 800 √ó 800. <br><br><div class="spoiler">  <b class="spoiler_title">Autres exemples</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gy/7l/aq/gy7laq5f399atjwit-doxjarj_8.png"><br><img src="https://habrastorage.org/webt/s4/t1/hq/s4t1hqhmregz0f8xjgpsg6n721m.png"><br><img src="https://habrastorage.org/webt/_6/hz/h1/_6hzh1z6clmb7grbi5eesyo3_4k.png"><br><img src="https://habrastorage.org/webt/v0/zd/fd/v0zdfdpxpluft88d08hgmda2v7e.png"><br><img src="https://habrastorage.org/webt/sy/sf/on/sysfonqdv39cdp63ptmxv0w1_f4.png"><br><img src="https://habrastorage.org/webt/v-/o2/b3/v-o2b39ub3svzr504y0h57wos94.png"><br><img src="https://habrastorage.org/webt/on/09/cg/on09cgziwxi6ppgdxbtheoxehd4.png"><br><img src="https://habrastorage.org/webt/ti/8g/ki/ti8gkignbirkrsctvruho9-tl3g.png"><br></div></div><br>  Apr√®s avoir re√ßu une telle carte pour chaque image, nous pouvons agr√©ger le recadrage le plus important pour les pays √† partir d'images diff√©rentes.  Cela vous permet de regarder la collection de cultures, d√©crivant le pays de la meilleure fa√ßon. <br><br>  La seconde m√©thode, avec laquelle nous avons d√©cid√© de comparer la premi√®re, est une simple recherche exhaustive.  Que se passe-t-il si nous prenons un mod√®le form√© sur de petites cultures (par exemple, 160 √ó 160 pixels) et pr√©disons chaque pi√®ce sur une grande image 800 √ó 800 avec?  En passant une fen√™tre coulissante recouvrant chaque zone de l'image, nous obtenons une autre version de la carte d'activation, montrant la probabilit√© que chaque morceau de l'image appartient √† la classe du pays pr√©dit. <br><br><img src="https://habrastorage.org/webt/vr/d0/ig/vrd0igxkijgsltioftiqregvjhw.png"><br><br>  L'image est d√©coup√©e en petits r√©cipients avec un chevauchement de 160 √ó 160. Pour chaque recadrage, le r√©seau neuronal fait des pr√©dictions, le nombre au dessus du recadrage est la probabilit√© d'appartenir √† la classe que le mod√®le a finalement pr√©dit. <br><br><div class="spoiler">  <b class="spoiler_title">Plus d'exemples</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/aj/zw/nd/ajzwndf0duu_djxkacgbx5fffbg.png"><br><img src="https://habrastorage.org/webt/_j/vk/ma/_jvkma67rsgmxjcgh_ht4t26u0e.png"><br><img src="https://habrastorage.org/webt/q5/uf/kj/q5ufkjpvlcut51tjvonfvz8oc-a.png"><br><img src="https://habrastorage.org/webt/be/al/av/bealavhehhhen23lv_gc-3nz3vi.png"><br></div></div><br>  Comme dans la premi√®re m√©thode, nous pouvons √† nouveau choisir les pi√®ces les plus probables pour chaque pays.  Mais les images obtenues par les deux m√©thodes pour le pays peuvent √™tre uniformes (par exemple, un b√¢timent sous diff√©rents angles ou une version de la texture).  Par cons√©quent, la meilleure r√©colte pour le pays est en outre regroup√©e - alors la plupart des images similaires seront rassembl√©es en un seul cluster.  Apr√®s cela, il suffira de prendre une photo de chaque cluster avec la probabilit√© maximale - pour chaque pays, il y aura autant d'images que de clusters sp√©cifi√©s.  Nous avons effectu√© un regroupement bas√© sur les caract√©ristiques obtenues √† partir de la derni√®re couche de classificateur.  Le regroupement agglom√©ratif dans notre cas s'est av√©r√© √™tre le meilleur. <br><br><img src="https://habrastorage.org/webt/01/bl/dt/01bldtbu2pk2tlegwiahkrfbyls.png"><br><br><div class="spoiler">  <b class="spoiler_title">La Chine</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/0j/3t/e1/0j3te1fos-feivrx72damea3rdu.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Italie</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tp/xa/hy/tpxahykascxpynkfngesl3mojsc.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Allemagne</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q4/na/3e/q4na3ea9i6t_cm2kchkvst9yass.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Mexique</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jv/zc/hg/jvzchgdvxyigsmgujk8ydmqo4v4.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Les USA</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hy/t2/pb/hyt2pbota0isw955unsxnpn8wym.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">La Turquie</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/47/nk/mk/47nkmkhl0didrcmsimstecwo1ye.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Australie</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/z3/kg/br/z3kgbr5eqy6rfxbf23f-rcwljyo.png"><br></div></div><br>  Apr√®s avoir re√ßu un pipeline assez similaire pour les deux m√©thodes, vous pouvez parcourir les param√®tres des algorithmes pour trouver la combinaison optimale.  Par exemple, nous avons s√©lectionn√© la taille du recadrage et opt√© pour deux options: 160 et 256 pixels.  Les cultures inf√©rieures √† 160 ont donn√© des signes trop petits, selon lesquels une personne ne comprend souvent pas ce qui est repr√©sent√©.  Et recadrer plus de 256 contenait parfois plusieurs objets √† la fois.  Diff√©rents param√®tres doivent √™tre s√©lectionn√©s au stade du clustering: le choix de l'algorithme principal, ainsi que les caract√©ristiques par lesquelles le clustering est effectu√©.  Pour de nombreuses combinaisons de param√®tres, il √©tait imm√©diatement clair qu'ils donnaient une r√©colte insuffisamment ¬´int√©ressante¬ª.  Mais pour s√©lectionner l'algorithme final, nous avons men√© des exp√©riences c√¥te √† c√¥te sur Tolok pour comprendre quelle option, selon les gens, d√©crit le pays sp√©cifique de mani√®re ¬´plus appropri√©e¬ª. <br><br>  Il s'est av√©r√© peu intuitif qu'une m√©thode plus simple de recherche de recadrage dans l'image (recherche normale) trouve des objets plus ¬´int√©ressants¬ª.  Cela peut √™tre d√ª au fait que dans la deuxi√®me m√©thode (√©num√©ration), le r√©seau neuronal ne voit pas la partie voisine de l'image, et dans la m√©thode CAM, l'environnement du point affecte le r√©sultat.  En cons√©quence, nous avons re√ßu une visualisation des caract√©ristiques de chaque pays en mode automatique. <br><br>  Alors maintenant, nous savons quelles parties du cadre sont d'une importance d√©cisive pour le r√©seau neuronal, et nous pouvons voir ce qui est tomb√© dessus.  Par exemple, les Pays-Bas reconnaissent un r√©seau de neurones par la combinaison de murs de briques sombres et de contours de fen√™tres blanches, les √âmirats arabes unis - par des gratte-ciel sp√©cifiques sur le fond des palmiers et l'Iran - par les arcs et les ornements caract√©ristiques des fa√ßades. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr473056/">https://habr.com/ru/post/fr473056/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr473042/index.html">Avantages et inconv√©nients de Django</a></li>
<li><a href="../fr473044/index.html">Comment cr√©er des captures d'√©cran efficaces pour une application dans l'App Store</a></li>
<li><a href="../fr473046/index.html">Vagues, vent et volont√©: comment la tablette robuste de Dell aide les Russes √† remporter des r√©gates internationales</a></li>
<li><a href="../fr473050/index.html">AMD oblige Intel √† r√©duire les prix non seulement sur les nouveaux, mais aussi sur les anciens mod√®les de CPU. C'est le d√©but d'une autre guerre des prix</a></li>
<li><a href="../fr473054/index.html">Finale WorldSkills, d√©veloppement de solutions informatiques pour les entreprises - ce que c'est, comment c'√©tait et pourquoi les programmeurs 1C y ont gagn√©</a></li>
<li><a href="../fr473058/index.html">Sergey Sinitsyn: ¬´OSM, c'est plus que dessiner des maisons ou des pistes. Ce sont plus d'histoires! "</a></li>
<li><a href="../fr473060/index.html">Relations informelles en √©quipe: pourquoi et comment les g√©rer</a></li>
<li><a href="../fr473062/index.html">User.js subjectif pour Mozilla Firefox et pas seulement</a></li>
<li><a href="../fr473064/index.html">Larmes de Batavie, voitures et Gorilla Glass: √† propos de certains types de verre renforc√©</a></li>
<li><a href="../fr473070/index.html">Redux - Pas n√©cessaire! Remplacer par useContext et useReducer dans React?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>