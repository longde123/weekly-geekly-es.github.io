<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👥 ⛄️ ↘️ Operation TaskMasters: Bagaimana Kami Mengekspos Organisasi Penyerang Kelompok Cyber ​​di Rusia dan CIS 👨🏿‍🍳 🕉️ 🤛🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gambar: Unsplash 

 Pada musim gugur 2018, para ahli Pusat Keamanan PT. Ahli mengungkap aktivitas kelompok kriminal yang kegiatannya bertujuan mencuri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Operation TaskMasters: Bagaimana Kami Mengekspos Organisasi Penyerang Kelompok Cyber ​​di Rusia dan CIS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/451566/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/lz/hs/uj/lzhsujgy5_y3llxp6xwz38yycfe.png"></a> <br><br>  <i>Gambar: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Unsplash</a></i> <br><br>  Pada musim gugur 2018, para ahli Pusat Keamanan PT. Ahli mengungkap aktivitas kelompok kriminal yang kegiatannya bertujuan mencuri dokumen dan spionase rahasia.  Hari ini kita akan berbicara tentang kemajuan penyelidikan, serta menjelaskan metode dan alat utama yang digunakan kelompok. <br><br>  <i>Catatan</i> : Tautan ini menyediakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan</a> investigasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lengkap</a> .  Ini juga memberikan indikator kompromi yang dapat digunakan untuk mengidentifikasi tanda-tanda serangan. <a name="habracut"></a><br><br><h2>  Siapa kelompok yang menyerang, dan kapan ditemukan </h2><br>  Pengelompokan ini diidentifikasi oleh para ahli dari PT Expert Security Center pada tahun 2018.  Para penjahat menggunakan metode pengamanan yang tidak biasa dalam infrastruktur, berdasarkan pada penciptaan tugas (tugas) tertentu dalam penjadwal tugas - itulah sebabnya PT ESC memanggil kelompok TaskMasters. <br><br>  Penjadwal Tugas memungkinkan Anda untuk menjalankan perintah OS dan menjalankan perangkat lunak pada titik waktu tertentu yang ditentukan dalam tugas.  Selain itu, penjadwal AtNow yang digunakan oleh pengelompokan ini memungkinkan Anda untuk melakukan tugas tidak hanya secara lokal, tetapi juga pada komputer jarak jauh di jaringan, dan untuk melakukan ini terlepas dari pengaturan waktu dari node ini.  Selain itu, utilitas ini tidak memerlukan instalasi.  Fitur-fitur ini menyederhanakan otomatisasi serangan. <br><br>  Peretas meretas perusahaan dari berbagai negara, dengan sejumlah besar korban di Rusia dan CIS.  Sebagian besar perusahaan yang diserang dapat dikaitkan dengan industri.  Secara total, kami menyadari kompromi lebih dari 30 organisasi di berbagai industri, termasuk sektor energi dan minyak dan gas serta badan pemerintah. <br><br>  Tujuan utama grup ini adalah mencuri informasi rahasia.  Penyerang berusaha mendapatkan pijakan dalam sistem informasi perusahaan untuk waktu yang lama dan mendapatkan akses ke server perusahaan utama, workstation manajemen puncak, dan sistem bisnis penting. <br><br>  Jejak paling awal dari keberadaan kelompok dalam infrastruktur tanggal kembali ke 2010, dan pada saat itu para penjahat sudah sepenuhnya mengendalikan beberapa server dan workstation, yang berarti bahwa penetrasi terjadi jauh lebih awal. <br><br><h2>  Jejak Asia </h2><br>  Dalam kode pada GitHub dari shell web ASPXSpy2014, yang digunakan selama serangan, ada tautan ke pengembang Cina.  Namun, versi yang kami temukan mengandung tautan ke google.ru. <br><br><img src="https://habrastorage.org/webt/ag/oh/va/agohvad709ucmllwefycordfjhw.png"><br><br>  <i>ASPXSpy: versi publik dan serangan</i> <br><br>  Dalam permintaan untuk kerang web, alamat IP milik penyedia hosting dan percetakan di Eropa Timur diidentifikasi.  Tetapi dalam peristiwa log server proxy dari salah satu organisasi yang diserang, saat para penyerang beralih ke alamat IP Cina penduduk 115.171.23.103 dicerminkan, yang kemungkinan besar terjadi karena pemutusan VPN perangkat lunak pada saat serangan. <br><br>  Selama serangan, para penyerang menggunakan salinan pengarsipan WinRAR, yang diaktifkan dengan kunci yang didistribusikan secara luas di forum-forum yang penggunanya berkomunikasi dalam bahasa Mandarin. <br><br><img src="https://habrastorage.org/webt/5d/tg/eh/5dtgeh4xjibopstd7zh6altqxas.png"><br><br>  <i>Versi lisensi WinRAR dalam sumber daya perangkat lunak</i> <br><br><img src="https://habrastorage.org/webt/dc/qs/as/dcqsas2b1wfkqble9g_pntsvbcc.png"><br><br>  <i>Kunci lisensi WinRAR diterbitkan di forum Cina</i> <br><br>  Untuk salah satu tugas, domain Brengkolang.com digunakan, terdaftar melalui pendaftar Cina.  Juga, banyak utilitas berisi pesan kesalahan dan informasi debug lainnya yang ditulis dalam bahasa Inggris dengan kesalahan, yang mungkin menunjukkan bahwa itu bukan asli pengembang. <br><br><h2>  Bagaimana penyerang bertindak </h2><br>  Vektor serangan keseluruhan cukup dapat diprediksi.  Setelah menembus jaringan lokal, penyerang memeriksa infrastruktur, mengeksploitasi kerentanan sistem (misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CVE-2017-0176</a> ), kemudian mengunduh ke node yang dikompromikan dan membongkar satu set utilitas.  Dengan menggunakan set ini, mereka mencari, menyalin, dan mengarsipkan file yang menarik bagi mereka, dan kemudian mengirimkannya ke server manajemen. <br><br>  Untuk menavigasi jaringan, penjahat mengeksekusi perintah sistem pada node jarak jauh menggunakan utilitas AtNow, yang memungkinkan Anda untuk menjalankan perangkat lunak dan menjalankan perintah setelah interval waktu yang ditentukan telah berlalu.  Untuk mengelola node menggunakan backdoors kecil, yang melaluinya mereka terhubung ke server manajemen.  Pada saat yang sama, ada saluran cadangan dalam bentuk web shell yang diunggah ke sumber daya eksternal, misalnya, ke server Exchange. <br><br><img src="https://habrastorage.org/webt/_t/4n/wv/_t4nwviraqyi6_wd43biwwuovt8.png"><br><br>  <i>Pola serangan</i> <br><br>  Grup menggunakan infrastruktur DNS Dinamis untuk domainnya.  Penyerang menggunakan seperangkat besar utilitas dan alat untuk melakukan serangan cyber dan secara aktif menggunakan skema serangan rantai pasokan. <br><br>  Untuk memindai jaringan dan sistem kompromi, penyerang menggunakan perangkat lunak gratis (termasuk NBTScan, PWDump, Mimikatz).  Selain alat pihak ketiga, program yang dikembangkan sendiri juga digunakan. <br><br>  Perangkat lunak utama dari grup TaskMasters, dengan mana mereka mengendalikan node yang terinfeksi, terdiri dari dua komponen: <br><br><ul><li>  RemShell Downloader - loader, </li><li>  RemShell - perangkat lunak dengan serangkaian fungsi dasar. </li></ul><br>  Mari kita bahas lebih detail masing-masing komponen. <br><br><h2>  Pengunduh RemShell </h2><br>  Komponen malware ini dirancang untuk mengirimkan muatan utama ke sistem yang diserang.  Skema operasi umum dari boot loader ditunjukkan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/wc/gq/q_/wcgqq_svfh88x9m3gxtf1qamhys.png"><br><br>  <i>Alur Kerja Loader RemShell</i> <br><br>  Loader mengakses halaman HTML di alamat yang sebelumnya ditentukan dalam kode dan membaca nilai atribut Attribute dari tag HTML: <br><br><img src="https://habrastorage.org/webt/of/ug/6c/ofug6cpcp-u6byrh-7ghxx7tf-a.png"><br><br>  <i>Contoh file HTML</i> <br><br>  Kemudian nilai baca didekripsi, dan tergantung pada apa yang ada di sana, bootloader akan masuk ke mode siaga (perintah Sleep) atau menyimpan file PE ke disk dan meluncurkannya.  File PE yang diunduh hanyalah payload - trojan RemShell utama. <br><br><h2>  Trojan RemShell </h2><br>  RemShell, malware utama yang digunakan oleh penyerang untuk mengontrol node yang terinfeksi, memberi para penyerang opsi-opsi berikut: <br><br><ol><li>  Terminal untuk kontrol host jarak jauh (cmd shell). </li><li>  Mengunggah file ke host jarak jauh. </li><li>  Unduh file dari host jarak jauh ke server manajemen. </li></ol><br>  Trojan menggunakan dua server manajemen.  Yang pertama bertindak sebagai perantara atau proxy, yang, atas permintaan malware, memberikan alamat server manajemen utama.  Juga, sebuah perintah dapat diterima dari server manajemen pertama untuk mentransfer malware ke server proxy manajemen lainnya. <br><br><img src="https://habrastorage.org/webt/7r/pg/ll/7rpgll7b5bjlvyyljapucz_hsec.png"><br><br>  <i>Bermigrasi dari server manajemen pertama ke primer</i> <br><br>  Kami menemukan berbagai variasi malware ini.  Dalam beberapa, misalnya, tidak ada perintah untuk mengunduh file dari node ke server manajemen - dalam kasus seperti itu, penyerang menggunakan utilitas berpemilik untuk mengunggah file.  Di yang lain, perintah telah ditambahkan yang memungkinkan Anda untuk mendapatkan daftar proses yang berjalan pada sistem dan menyelesaikan proses dengan PID (pengidentifikasi proses). <br>  Data konfigurasi, seperti alamat server proxy pengontrol, port, agen-pengguna, dienkripsi menggunakan RC4 dan diset oleh konstanta dalam kode malware. <br><br>  Data yang dikirim antara server manajemen dan malware dienkripsi menggunakan algoritma RC4 dan disandikan dengan Base64.  Kunci untuk RC4 dihasilkan menggunakan string konstan dengan menghitung hash MD5.  Hasil menjalankan perintah yang diterima dari server manajemen dikirim sebagai permintaan HTTP ke URL dengan awalan tertentu 1111. <br><br>  Malware ini juga mencakup mekanisme Detak Jantung, yang secara acak “mengetuk” dengan permintaan HTTP yang berisi hasil dari perintah hostname ke URL yang diberikan dengan awalan spesifik 0000. <br><br><img src="https://habrastorage.org/webt/ng/-j/f_/ng-jf_ivno95yki2nb0wced6ygo.png"><br><br>  <i>Detak jantung</i> <br><br><h2>  Server manajemen </h2><br>  Bagian server untuk mengelola malware pada node yang terinfeksi diwakili oleh file ELF konsol.  Antarmuka manajemen server dibuat dalam bentuk shell dan mendukung perintah yang disajikan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/dm/zc/oy/dmzcoy-l6yk0yizsuueiksglsta.png"><br><br>  Server mencatat secara rinci semua perintah yang dikirim ke host jarak jauh.  File-file log ini disimpan pada disk dalam bentuk terenkripsi.  Untuk mengenkripsi file log, algoritma RC4 digunakan. <br><br>  Kami dapat menganalisis beberapa contoh sisi server dari malware.  Dalam satu kasus, kami menemukan disebutkan pengembang AiMi, yang kami temukan referensi di alat lain dari pengelompokan TaskMasters. <br><br><img src="https://habrastorage.org/webt/pv/ie/sv/pviesv3b2-pss7d6tyedpcrk1yg.png"><br><br>  <i>Menyebutkan pengembang dalam informasi yang ditampilkan oleh skrip</i> <br><br><h2>  Web Shell 404-input-shell </h2><br>  Jendela otorisasi untuk mengakses fungsionalitas shell web disamarkan sebagai halaman kesalahan standar 404 dari server web IIS.  Untuk mengakses baris perintah dan menjalankan perintah, Anda harus memasukkan kata sandi.  Kolom kata sandi disembunyikan dan ditampilkan jika Anda mengklik tautan Balik. <br><br><img src="https://habrastorage.org/webt/q_/wv/x1/q_wvx1r71d3xebktyd7fpwl-th0.png"><br><br><pre><code class="bash hljs">Click the &lt;a href=<span class="hljs-string"><span class="hljs-string">"#"</span></span> ondblclick=<span class="hljs-string"><span class="hljs-string">"history_back()"</span></span>&gt;Back&lt;/a&gt; button to try another link.&lt;/li&gt;</code> </pre> <br>  Untuk otorisasi, para penyerang menggunakan kata sandi 0p; / 9ol.  - mereka menggunakan kata sandi yang sama untuk mengenkripsi arsip.  Kode shell web berisi hash MD5 dari kata sandi ini. <br><br><img src="https://habrastorage.org/webt/jg/ia/vg/jgiavgy650zj9gonqkmegfuekk8.png"><br><br>  Secara total, sebagai bagian dari penyelidikan, kami menemukan tiga modifikasi dari shell web ini.  Mereka berbeda dalam fungsionalitas: salah satunya hanya digunakan untuk mengunduh file dari server, yang lain untuk mengunggah file ke server, yang ketiga untuk menjalankan perintah OS. <br><br><h2>  Kesimpulan </h2><br>  Studi kami menunjukkan bahwa penjahat cyber tidak hanya dapat mengejar tujuan finansial sesaat.  Semakin lama, mereka berusaha untuk mendapatkan akses ke data dan mengambil kendali arus informasi organisasi. <br><br>  Para korban spionase dunia maya dapat menjadi perusahaan di berbagai sektor ekonomi.  Untuk memahami cara mempertahankan serangan seperti itu, perlu untuk menggunakan alat khusus.  Juga pada tahap investigasi, penting untuk mempelajari secara rinci taktik yang digunakan oleh penyerang.  Sangat sulit bagi organisasi untuk menyelesaikan masalah ini sendiri, karena ini tidak hanya membutuhkan alat canggih, tetapi juga spesialis keamanan informasi yang sangat berkualitas.  Implementasi rekomendasi yang diterima dari profesional keamanan akan meningkatkan tingkat keamanan infrastruktur dan mempersulit peretasannya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id451566/">https://habr.com/ru/post/id451566/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id451552/index.html">Kami membangun saluran penjualan jaringan gadget DO-RA</a></li>
<li><a href="../id451556/index.html">Flutter: pelokalan aplikasi menggunakan Android Studio</a></li>
<li><a href="../id451558/index.html">Suatu hari dalam kehidupan otomatisasi QA</a></li>
<li><a href="../id451560/index.html">Pelanggan yang terhormat, itu sebabnya perubahan ini butuh waktu lama.</a></li>
<li><a href="../id451562/index.html">Bagaimana cara melarikan diri dari sekte?</a></li>
<li><a href="../id451570/index.html">Pindah ke Prancis untuk bekerja: gaji, visa, dan resume</a></li>
<li><a href="../id451572/index.html">Tren Teknologi Pengembangan Web 2019</a></li>
<li><a href="../id451574/index.html">Kembangkan utilitas di GraalVM</a></li>
<li><a href="../id451576/index.html">Buku "Kode kami. Kerajinan, profesi, seni "</a></li>
<li><a href="../id451580/index.html">MODX Digest # 5 (22 April - 13 Mei 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>