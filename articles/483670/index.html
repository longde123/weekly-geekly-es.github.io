<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>   Todo lo que quer铆as saber sobre la direcci贸n MAC   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo el mundo sabe que estos son seis bytes, que generalmente se muestran en formato hexadecimal, asignados a una tarjeta de red en la f谩brica y, a pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Todo lo que quer铆as saber sobre la direcci贸n MAC</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483670/"><p><img src="https://habrastorage.org/webt/so/w5/21/sow5218j24fiojm2deevv3xnko8.jpeg" align="right">  Todo el mundo sabe que estos son seis bytes, que generalmente se muestran en formato hexadecimal, asignados a una tarjeta de red en la f谩brica y, a primera vista, son aleatorios.  Algunas personas saben que los primeros tres bytes de la direcci贸n son el identificador del fabricante, y los tres bytes restantes se les asignan.  Tambi茅n se sabe que puede establecer <em>una</em> direcci贸n <em>arbitraria</em> .  Muchos han escuchado sobre las "direcciones aleatorias" en Wi-Fi. </p><br><p>  Averig眉emos qu茅 es. </p><br><p> Direcci贸n MAC (direcci贸n de control de acceso a medios): un identificador 煤nico asignado a un adaptador de red; se utiliza en redes con est谩ndares IEEE 802, principalmente Ethernet, Wi-Fi y Bluetooth.  Oficialmente, se llama un "identificador de tipo EUI-48".  Es obvio por el nombre que la direcci贸n tiene 48 bits de longitud, es decir  6 bytes  No existe un est谩ndar generalmente aceptado para escribir una direcci贸n (a diferencia de una direcci贸n IPv4, donde los octetos siempre est谩n separados por puntos). Generalmente se escribe como seis n煤meros hexadecimales, separados por dos puntos: 00: AB: CD: EF: 11: 22, aunque algunos fabricantes de equipos prefieren escribir como 00 -AB-CD-EF-11-22 e incluso 00ab.cdef.1122. </p><a name="habracut"></a><br><p>  Hist贸ricamente, las direcciones se cos铆an en la ROM del conjunto de chips de la tarjeta de red sin la posibilidad de su modificaci贸n sin un programador flash, pero en la actualidad la direcci贸n se puede cambiar mediante programaci贸n, desde el sistema operativo.  Puede configurar manualmente la direcci贸n MAC de la tarjeta de red en Linux y MacOS (siempre), Windows (casi siempre, si el controlador lo permite), Android (solo root);  con iOS (sin root) un truco similar es imposible. </p><br><h3>  Estructura de direcciones </h3><br><p>  La direcci贸n consta de una parte del identificador del fabricante, OUI y el identificador asignado por el fabricante.  El IEEE asigna el OUI (Identificador Organizacionalmente nico).  De hecho, su longitud puede ser no solo de 3 bytes (24 bits), sino tambi茅n de 28 o 36 bits, a partir de los cuales se forman los bloques del Bloque de direcciones MAC (MA) de tipo Grande (MA-L), Medio (MA-M) y Peque帽o. (MA-S) respectivamente.  El tama帽o del bloque emitido, en este caso, ser谩 de 24, 20, 12 bits o 16 millones, 1 mill贸n, 4 mil piezas de direcciones.  En este momento, se distribuyen unos 38 mil bloques, que se pueden ver con numerosas herramientas en l铆nea, por ejemplo, <a href="https://regauth.standards.ieee.org/standards-ra-web/pub/view.html" rel="nofollow">IEEE</a> o <a href="https://www.wireshark.org/tools/oui-lookup.html" rel="nofollow">Wireshark</a> . </p><br><h3>  Qui茅n posee las direcciones </h3><br><p>  El simple procesamiento de la <a href="https://code.wireshark.org/review/gitweb%3Fp%3Dwireshark.git%3Ba%3Dblob_plain%3Bf%3Dmanuf%3Bhb%3DHEAD" rel="nofollow">base de datos de carga</a> IEEE disponible p煤blicamente proporciona mucha informaci贸n.  Por ejemplo, algunas organizaciones han tomado muchos bloques OUI.  Aqu铆 est谩n nuestros h茅roes: </p><br><div class="scrollable-table"><table><thead><tr><th>  Vendedor </th><th>  El n煤mero de bloques / registros. </th><th>  El n煤mero de direcciones, millones </th></tr></thead><tbody><tr><td>  Cisco Systems Inc </td><td>  888 </td><td>  14208 </td></tr><tr><td>  Manzana </td><td>  772 </td><td>  12352 </td></tr><tr><td>  Samsung </td><td>  636 </td><td>  10144 </td></tr><tr><td>  Huawei Technologies Co. Ltd </td><td>  606 </td><td>  9696 </td></tr><tr><td>  Corporaci贸n Intel </td><td>  375 </td><td>  5776 </td></tr><tr><td>  ARRIS Group Inc. </td><td>  319 </td><td>  5104 </td></tr><tr><td>  Nokia Corporation </td><td>  241 </td><td>  3856 </td></tr><tr><td>  Privado </td><td>  232 </td><td>  2704 </td></tr><tr><td>  Texas Instruments </td><td>  212 </td><td>  3392 </td></tr><tr><td>  corporaci贸n zte </td><td>  198 </td><td>  3168 </td></tr><tr><td>  Autoridad de registro de IEEE </td><td>  194 </td><td>  3072 </td></tr><tr><td>  Hewlett Packard </td><td>  149 </td><td>  2384 </td></tr><tr><td>  Hon Hai Precision </td><td>  136 </td><td>  2176 </td></tr><tr><td>  TP-LINK </td><td>  134 </td><td>  2144 </td></tr><tr><td>  Dell Inc. </td><td>  123 </td><td>  1968 </td></tr><tr><td>  Juniper Networks </td><td>  110 </td><td>  1760 </td></tr><tr><td>  Sagemcom Broadband SAS </td><td>  97 </td><td>  1552 </td></tr><tr><td>  Fiberhome Telecommunication Technologies Co.  LTD </td><td>  97 </td><td>  1552 </td></tr><tr><td>  Xiaomi Communications Co Ltd </td><td>  88 </td><td>  1408 </td></tr><tr><td>  Guangdong Oppo Mobile Telecommunications Corp.Ltd </td><td>  82 </td><td>  1312 </td></tr></tbody></table></div><br><p>  Google tiene solo 40 de ellos, y esto no es sorprendente: ellos mismos no producen tantos dispositivos de red. </p><br><p>  Los bloques MA no se proporcionan de forma gratuita, se pueden comprar por dinero razonable (sin una tarifa mensual) por $ 3000, $ 1800 o $ 755, respectivamente.  Es interesante que por el dinero extra (por a帽o) puede comprar la "ocultaci贸n" de la informaci贸n p煤blica sobre el bloque asignado.  Hay 232 de ellos ahora, como se puede ver arriba. </p><br><h3 id="kogda-zakonchatsya-mas-adresa">  驴Cu谩ndo se agotar谩 la direcci贸n MAC? </h3><br><p>  Todos estamos cansados de la historia de diez a帽os de que "las direcciones IPv4 est谩n a punto de agotarse".  S铆, los nuevos bloques de IPv4 ya no son f谩ciles de obtener.  Tambi茅n se sabe que las direcciones IP se <a href="https://habr.com/ru/company/globalsign/blog/355006/">distribuyen de manera extremadamente desigual</a> ;  Sin embargo, hay bloques gigantescos y poco utilizados propiedad de grandes corporaciones y del gobierno de los Estados Unidos, sin mucha esperanza de su redistribuci贸n en favor de los necesitados.  La proliferaci贸n de NAT, CG-NAT e IPv6 ha hecho que el problema de la falta de direcciones p煤blicas sea menos grave. </p><br><p>  La direcci贸n MAC tiene 48 bits, de los cuales 46 son 煤tiles (驴por qu茅? Siga leyendo), lo que da 2 <sup>46</sup> o 10 <sup>14</sup> direcciones, que es 2 <sup>14</sup> veces el espacio de direcciones IPv4. <br>  En este momento, se distribuyen aproximadamente medio bill贸n de direcciones, o solo el 0.73% del volumen total.  El agotamiento de las direcciones MAC todav铆a est谩 muy, muy lejos. </p><br><h3 id="sluchaynost-bit">  Bit aleatorio </h3><br><p>  Se puede suponer que las OUI se distribuyen aleatoriamente, y el proveedor tambi茅n asigna aleatoriamente direcciones a dispositivos de red individuales.  Es asi?  Veamos la distribuci贸n de bits en las bases MAC de las direcciones que tengo a mi disposici贸n para dispositivos 802.11 recopilados por sistemas de autorizaci贸n de trabajo en redes inal谩mbricas <a href="https://www.netams.com/wnam/" rel="nofollow">WNAM</a> .  Las direcciones pertenecen a dispositivos reales que se han conectado a Wi-Fi durante varios a帽os en tres pa铆ses.  Adem谩s, hay una peque帽a base de dispositivos LAN con cable 802.3. </p><br><p>  Dividimos cada direcci贸n MAC (seis bytes) de cada una de las muestras en bits por bytes, y observamos la frecuencia de aparici贸n del bit "1" en cada una de las 48 posiciones.  Si el bit se establece de forma completamente arbitraria, la probabilidad de obtener "1" deber铆a ser del 50%. </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Muestra de Wi-Fi n. 掳 1 (RF) </th><th>  Muestra de Wi-Fi no 2 (Bielorrusia) </th><th>  Muestra de Wi-Fi no 3 (Uzbekist谩n) </th><th>  Muestra de LAN (RF) </th></tr></thead><tbody><tr><td>  El n煤mero de registros en la base de datos. </td><td>  5929000 </td><td>  1274000 </td><td>  366000 </td><td>  1000 </td></tr><tr><td>  N煤mero de bit: </td><td>  % bit "1" </td><td>  % bit "1" </td><td>  % bit "1" </td><td>  % bit "1" </td></tr><tr><td>  1 </td><td>  48,6% </td><td>  49,2% </td><td>  50,7% </td><td>  28,7% </td></tr><tr><td>  2 </td><td>  44,8% </td><td>  49,1% </td><td>  47,7% </td><td>  30,7% </td></tr><tr><td>  3 </td><td>  46,7% </td><td>  48,3% </td><td>  46,8% </td><td>  35,8% </td></tr><tr><td>  4 4 </td><td>  48,0% </td><td>  48,6% </td><td>  49,8% </td><td>  37,1% </td></tr><tr><td>  5 5 </td><td>  45,7% </td><td>  46,9% </td><td>  47,0% </td><td>  32,3% </td></tr><tr><td>  6 6 </td><td>  46,6% </td><td>  46,7% </td><td>  47,8% </td><td>  27,1% </td></tr><tr><td>  7 7 </td><td>  <strong>0.3%</strong> </td><td>  <strong>0.3%</strong> </td><td>  <strong>0.2%</strong> </td><td>  <strong>0.7%</strong> </td></tr><tr><td>  8 </td><td>  <strong>0.0%</strong> </td><td>  <strong>0.0%</strong> </td><td>  <strong>0.0%</strong> </td><td>  <strong>0.0%</strong> </td></tr><tr><td></td></tr><tr><td>  9 9 </td><td>  48,1% </td><td>  50,6% </td><td>  49,4% </td><td>  38,1% </td></tr><tr><td>  10 </td><td>  49,1% </td><td>  50,2% </td><td>  47,4% </td><td>  42,7% </td></tr><tr><td>  11 </td><td>  50,8% </td><td>  50,0% </td><td>  50,6% </td><td>  42,9% </td></tr><tr><td>  12 </td><td>  49,0% </td><td>  48,4% </td><td>  48,2% </td><td>  53,7% </td></tr><tr><td>  13 </td><td>  47,6% </td><td>  47,0% </td><td>  46,3% </td><td>  48,5% </td></tr><tr><td>  14 </td><td>  47,5% </td><td>  47,4% </td><td>  51,7% </td><td>  46,8% </td></tr><tr><td>  15 </td><td>  48,3% </td><td>  47,5% </td><td>  48,7% </td><td>  46,1% </td></tr><tr><td>  16 </td><td>  50,6% </td><td>  50,4% </td><td>  51,2% </td><td>  45,3% </td></tr><tr><td></td></tr><tr><td>  17 </td><td>  49,4% </td><td>  50,4% </td><td>  54,3% </td><td>  38,2% </td></tr><tr><td>  18 a帽os </td><td>  49,8% </td><td>  50,5% </td><td>  51,5% </td><td>  51,9% </td></tr><tr><td>  19 </td><td>  51,6% </td><td>  53,3% </td><td>  53,9% </td><td>  42,6% </td></tr><tr><td>  20 </td><td>  46,6% </td><td>  46,1% </td><td>  45,5% </td><td>  48,4% </td></tr><tr><td>  21 </td><td>  51,7% </td><td>  52,9% </td><td>  47,7% </td><td>  48,9% </td></tr><tr><td>  22 </td><td>  49,2% </td><td>  49,6% </td><td>  41,6% </td><td>  49,8% </td></tr><tr><td>  23 </td><td>  51,2% </td><td>  50,9% </td><td>  47,0% </td><td>  41,9% </td></tr><tr><td>  24 </td><td>  49,5% </td><td>  50,2% </td><td>  50,1% </td><td>  47,5% </td></tr><tr><td></td></tr><tr><td>  25 </td><td>  47,1% </td><td>  47,3% </td><td>  47,7% </td><td>  44,2% </td></tr><tr><td>  26 </td><td>  48,6% </td><td>  48,6% </td><td>  49,2% </td><td>  43,9% </td></tr><tr><td>  27 </td><td>  49,8% </td><td>  49,0% </td><td>  49,7% </td><td>  48,9% </td></tr><tr><td>  28 </td><td>  49,3% </td><td>  49,3% </td><td>  49,7% </td><td>  55,1% </td></tr><tr><td>  29 </td><td>  49,5% </td><td>  49,4% </td><td>  49,8% </td><td>  49,8% </td></tr><tr><td>  30 </td><td>  49,8% </td><td>  49,8% </td><td>  49,7% </td><td>  52,1% </td></tr><tr><td>  31 </td><td>  49,5% </td><td>  49,7% </td><td>  49,6% </td><td>  46,6% </td></tr><tr><td>  32 </td><td>  49,4% </td><td>  49,7% </td><td>  49,5% </td><td>  47,5% </td></tr><tr><td></td></tr><tr><td>  33 </td><td>  49,4% </td><td>  49,8% </td><td>  49,7% </td><td>  48,3% </td></tr><tr><td>  34 </td><td>  49,7% </td><td>  50,0% </td><td>  49,6% </td><td>  44,9% </td></tr><tr><td>  35 </td><td>  49,9% </td><td>  50,0% </td><td>  50,0% </td><td>  50,6% </td></tr><tr><td>  36 </td><td>  49,9% </td><td>  49,9% </td><td>  49,8% </td><td>  49,1% </td></tr><tr><td>  37 </td><td>  49,8% </td><td>  50,0% </td><td>  49,9% </td><td>  51,4% </td></tr><tr><td>  38 </td><td>  50,0% </td><td>  50,0% </td><td>  49,8% </td><td>  51,8% </td></tr><tr><td>  39 </td><td>  49,9% </td><td>  50,0% </td><td>  49,9% </td><td>  55,7% </td></tr><tr><td>  40 </td><td>  50,0% </td><td>  50,0% </td><td>  50,0% </td><td>  49,5% </td></tr><tr><td></td></tr><tr><td>  41 </td><td>  49,9% </td><td>  50,0% </td><td>  49,9% </td><td>  52,2% </td></tr><tr><td>  42 </td><td>  50,0% </td><td>  50,0% </td><td>  50,0% </td><td>  53,9% </td></tr><tr><td>  43 </td><td>  50,1% </td><td>  50,0% </td><td>  50,3% </td><td>  56,1% </td></tr><tr><td>  44 </td><td>  50,1% </td><td>  50,0% </td><td>  50,1% </td><td>  45,8% </td></tr><tr><td>  45 </td><td>  50,0% </td><td>  50,0% </td><td>  50,1% </td><td>  50,1% </td></tr><tr><td>  46 </td><td>  50,0% </td><td>  50,0% </td><td>  50,1% </td><td>  49,5% </td></tr><tr><td>  47 </td><td>  49,2% </td><td>  49,4% </td><td>  49,7% </td><td>  45,2% </td></tr><tr><td>  48 </td><td>  49,9% </td><td>  50,1% </td><td>  50,7% </td><td>  54,6% </td></tr></tbody></table></div><br><p>  驴De d贸nde viene esta injusticia en los bits 7 y 8?  Casi siempre hay ceros. </p><br><p>  De hecho, el est谩ndar define estos bits como especiales ( <a href="https://ru.wikipedia.org/wiki/MAC-%25D0%25B0%25D0%25B4%25D1%2580%25D0%25B5%25D1%2581" rel="nofollow">Wikipedia</a> ): <br><img src="https://habrastorage.org/webt/0-/oc/jk/0-ocjkovhfyalpqzrsjdecvg7na.png"></p><br><p>  El octavo bit (desde el principio) del primer byte de la direcci贸n MAC se llama bit de unidifusi贸n / multidifusi贸n y determina qu茅 tipo de trama (trama) se transmite con esta direcci贸n, normal (0) o difusi贸n (1) (multidifusi贸n o difusi贸n).  Para la interacci贸n normal del adaptador de red de unidifusi贸n, este bit se establece en "0" en todos los paquetes que se le env铆an. </p><br><p>  El s茅ptimo bit (desde el principio) del primer byte de la direcci贸n MAC se llama bit U / L (Universal / Local) y determina si la direcci贸n es globalmente 煤nica (0) o localmente 煤nica (1).  Por defecto, todas las direcciones "cosidas por el fabricante" son globalmente 煤nicas, por lo tanto, la gran cantidad de direcciones MAC recopiladas contiene el s茅ptimo bit establecido en "0".  En la tabla de identificadores OUI asignados, solo alrededor de 130 entradas tienen un bit U / L "1", y lo m谩s probable es que sean bloques de direcciones MAC para necesidades especiales. </p><br><p>  Desde el sexto hasta el primer bit del primer byte, los bits del segundo y tercer bytes en los identificadores OUI, y a煤n m谩s los bits en 4-6 bytes de la direcci贸n asignada por el fabricante, se distribuyen de manera m谩s o menos uniforme. </p><br><p>  Por lo tanto, en la direcci贸n MAC real del adaptador de red, los bits son pr谩cticamente equivalentes y no tienen un significado tecnol贸gico, con la excepci贸n de dos bits de servicio del byte alto. </p><br><h3 id="rasprostranennost">  Prevalencia </h3><br><p>  Me pregunto qu茅 fabricantes de equipos inal谩mbricos son los m谩s populares.  Combine la b煤squeda de OUI con los datos de muestra No. 1. </p><br><div class="scrollable-table"><table><thead><tr><th>  Vendedor </th><th>  El porcentaje de dispositivos,% </th></tr></thead><tbody><tr><td>  Manzana </td><td>  26,09 </td></tr><tr><td>  Samsung </td><td>  19,79 </td></tr><tr><td>  Huawei Technologies Co.  Ltd </td><td>  7,80 </td></tr><tr><td>  Xiaomi Communications Co Ltd </td><td>  6.83 </td></tr><tr><td>  Sony Mobile Communications Inc </td><td>  3.29 </td></tr><tr><td>  LG Electronics (Comunicaciones m贸viles) </td><td>  2,76 </td></tr><tr><td>  ASUSTek COMPUTER INC. </td><td>  2,58 </td></tr><tr><td>  TCT mobile ltd </td><td>  2,13 </td></tr><tr><td>  corporaci贸n zte </td><td>  2,00 </td></tr><tr><td>  no encontrado en la base de datos IEEE </td><td>  1,92 </td></tr><tr><td>  Tecnolog铆a de comunicaci贸n m贸vil de Lenovo Ltd. </td><td>  1,71 </td></tr><tr><td>  HTC Corporation </td><td>  1,68 </td></tr><tr><td>  Fabricaci贸n de Murata </td><td>  1,31 </td></tr><tr><td>  Inpro comm </td><td>  1,26 </td></tr><tr><td>  Microsoft Corporation </td><td>  1,11 </td></tr><tr><td>  Shenzhen TINNO Mobile Technology Corp. </td><td>  1,02 </td></tr><tr><td>  Motorola (Wuhan) Mobility Technologies Communication Co.  Ltd. </td><td>  0,93 </td></tr><tr><td>  Nokia Corporation </td><td>  0,88 </td></tr><tr><td>  Shanghai Wind Technologies Co.  Ltd </td><td>  0,74 </td></tr><tr><td>  Lenovo Mobile Communication (Wuhan) Company Limited </td><td>  0,71 </td></tr></tbody></table></div><br><p>  La pr谩ctica muestra que cuanto m谩s pr贸spero sea el contingente de suscriptores inal谩mbricos en este lugar, mayor ser谩 la proporci贸n de dispositivos Apple. </p><br><h3 id="unikalnost">  Singularidad </h3><br><p>  驴Son 煤nicas las direcciones MAC?  En teor铆a, s铆, ya que cada uno de los fabricantes de dispositivos (propietarios de la unidad MA) debe proporcionar una direcci贸n 煤nica para cada uno de sus adaptadores de red.  Sin embargo, algunos fabricantes de chips, a saber: </p><br><ul><li>  00: 0A: F5 Airgo Networks, Inc.  (ahora Qualcomm) </li><li>  00:08:22 InPro Comm (ahora MediaTek) </li></ul><br><p>  configura los 煤ltimos tres bytes de la direcci贸n MAC en un n煤mero aleatorio, aparentemente despu茅s de cada reinicio del dispositivo.  Hab铆a 82 mil de esas direcciones en mi muestra No. 1. </p><br><p>  Puede establecerse un extra帽o, no una direcci贸n 煤nica, por supuesto, configur谩ndolo a prop贸sito "como un vecino", defini茅ndolo como un rastreador, o eligiendo al azar.  Tambi茅n es posible establecer accidentalmente una direcci贸n no 煤nica realizando, por ejemplo, restaurando una configuraci贸n de respaldo de un enrutador como Mikrotik u OpenWrt. </p><br><p>  驴Qu茅 sucede si dos dispositivos con la misma direcci贸n MAC est谩n presentes en la red?  Todo depende de la l贸gica del equipo de red (enrutador con cable, controlador de red inal谩mbrica).  Lo m谩s probable es que ambos dispositivos no funcionen o funcionen de manera intermitente.  Desde el punto de vista de los est谩ndares IEEE, se propone resolver la protecci贸n contra la falsificaci贸n de direcciones MAC utilizando, por ejemplo, MACsec o 802.1X. </p><br><p>  驴Qu茅 pasa si te pones un MAC con el s茅ptimo u octavo bit establecido en "1", es decir  direcci贸n local o multidifusi贸n?  Lo m谩s probable es que su red no preste atenci贸n a esto, pero formalmente, dicha direcci贸n no se ajustar谩 al est谩ndar, y es mejor no hacerlo. </p><br><h3 id="kak-rabotaet-randomizaciya">  C贸mo funciona la aleatorizaci贸n </h3><br><p>  Sabemos que para evitar rastrear el movimiento de personas escaneando el aire y recolectando los sistemas operativos MAC de los tel茅fonos inteligentes, hemos estado utilizando la tecnolog铆a de aleatorizaci贸n durante varios a帽os.  Te贸ricamente, cuando escanea el aire en busca de redes conocidas, el tel茅fono inteligente env铆a un paquete (grupo de paquetes) del tipo de solicitud de sonda 802.11 con la direcci贸n MAC como fuente: </p><br><p><img src="https://habrastorage.org/webt/ys/xx/sp/ysxxspu7y2giwvvdflhwrgiar-m.gif"></p><br><p>  La aleatorizaci贸n incluida le permite especificar no "flasheado", sino alguna otra direcci贸n de origen del paquete, que cambia con cada ciclo de exploraci贸n, a tiempo o de alguna manera.  驴Esto funciona?  Echemos un vistazo a las estad铆sticas de las direcciones MAC recopiladas desde el aire con el llamado "Radar de Wi-Fi": </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Muestra entera </th><th>  Muestreo con solo 7m bit </th></tr></thead><tbody><tr><td>  El n煤mero de registros en la base de datos. </td><td>  3920000 </td><td>  305,000 </td></tr><tr><td>  N煤mero de bit: </td><td>  % bit "1" </td><td>  % bit "1" </td></tr><tr><td>  1 </td><td>  66,1% </td><td>  43,3% </td></tr><tr><td>  2 </td><td>  66,5% </td><td>  43,4% </td></tr><tr><td>  3 </td><td>  31,7% </td><td>  43,8% </td></tr><tr><td>  4 4 </td><td>  66,6% </td><td>  46,4% </td></tr><tr><td>  5 5 </td><td>  66,7% </td><td>  45,7% </td></tr><tr><td>  6 6 </td><td>  31,9% </td><td>  46,4% </td></tr><tr><td>  7 7 </td><td>  <strong>92,2%</strong> </td><td>  0.0% </td></tr><tr><td>  8 </td><td>  0.0% </td><td>  0.0% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  9 9 </td><td>  67,2% </td><td>  47,5% </td></tr><tr><td>  10 </td><td>  32,3% </td><td>  45,6% </td></tr><tr><td>  11 </td><td>  66,9% </td><td>  45,3% </td></tr><tr><td>  12 </td><td>  32,3% </td><td>  46,8% </td></tr><tr><td>  13 </td><td>  32,6% </td><td>  50,1% </td></tr><tr><td>  14 </td><td>  33,0% </td><td>  56,1% </td></tr><tr><td>  15 </td><td>  32,5% </td><td>  45,0% </td></tr><tr><td>  16 </td><td>  67,2% </td><td>  48,3% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  17 </td><td>  33,2% </td><td>  56,9% </td></tr><tr><td>  18 a帽os </td><td>  33,3% </td><td>  56,8% </td></tr><tr><td>  19 </td><td>  33,3% </td><td>  56,3% </td></tr><tr><td>  20 </td><td>  66,8% </td><td>  43,2% </td></tr><tr><td>  21 </td><td>  67,0% </td><td>  46,4% </td></tr><tr><td>  22 </td><td>  32,6% </td><td>  50,1% </td></tr><tr><td>  23 </td><td>  32,9% </td><td>  51,2% </td></tr><tr><td>  24 </td><td>  67,6% </td><td>  52,2% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  25 </td><td>  49,8% </td><td>  47,8% </td></tr><tr><td>  26 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  27 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  28 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  29 </td><td>  50,0% </td><td>  49,4% </td></tr><tr><td>  30 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  31 </td><td>  50,0% </td><td>  49,7% </td></tr><tr><td>  32 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  33 </td><td>  50,0% </td><td>  49,7% </td></tr><tr><td>  34 </td><td>  50,0% </td><td>  49,6% </td></tr><tr><td>  35 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  36 </td><td>  50,0% </td><td>  49,5% </td></tr><tr><td>  37 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td>  38 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  39 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td>  40 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  41 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  42 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  43 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  44 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  45 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  46 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  47 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  48 </td><td>  50,1% </td><td>  50,9% </td></tr></tbody></table></div><br><p>  La imagen es completamente diferente. </p><br><p>  El octavo bit del primer byte de la direcci贸n MAC todav铆a coincide con la naturaleza Unicast de la direcci贸n SRC en el paquete de solicitud de la sonda. </p><br><p>  El s茅ptimo bit en el 92.2% de los casos se establece en Local, es decir  con bastante certeza, podemos suponer que tantas direcciones recopiladas son aleatorias y menos del 8% son reales.  Adem谩s, la distribuci贸n de bits en la OUI para tales direcciones reales coincide aproximadamente con los datos de la tabla anterior. </p><br><p>  Seg煤n OUI, 驴a qu茅 fabricante pertenecen las direcciones aleatorias (es decir, con el s茅ptimo bit en "1")? </p><br><div class="scrollable-table"><table><thead><tr><th>  Fabricante por OUI </th><th>  Compartir entre todas las direcciones </th></tr></thead><tbody><tr><td>  no encontrado en la base de datos IEEE </td><td>  62,45% </td></tr><tr><td>  Google Inc. </td><td>  37,54% </td></tr><tr><td>  el resto </td><td>  0.01% </td></tr></tbody></table></div><br><p>  Adem谩s, todas las direcciones aleatorias asignadas a Google pertenecen a una OUI con el prefijo <strong>DA: A1: 19</strong> .  驴Qu茅 es este prefijo?  Veamos el <a href="" rel="nofollow">c贸digo fuente de Android</a> . </p><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MacAddress BASE_GOOGLE_MAC = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"da:a1:19:0:0:0"</span></span>);</code> </pre> <br><p>  El stock de Android utiliza un OUI registrado especial, uno de los pocos con el conjunto de s茅ptimo bit, en la b煤squeda de redes inal谩mbricas. </p><br><h3 id="vychislit-realnyy-mas-iz-randomnogo">  Calcular MAC real a partir de aleatorio </h3><br><p>  Miremos all铆: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> VALID_LONG_MASK = (<span class="hljs-number"><span class="hljs-number">1L</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> LOCALLY_ASSIGNED_MASK = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"2:0:0:0:0:0"</span></span>).mAddr; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> MULTICAST_MASK = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"1:0:0:0:0:0"</span></span>).mAddr; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> <span class="hljs-function"><span class="hljs-function">MacAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createRandomUnicastAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MacAddress base, Random r)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> addr; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (base == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { addr = r.nextLong() &amp; VALID_LONG_MASK; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { addr = (base.mAddr &amp; OUI_MASK) | (NIC_MASK &amp; r.nextLong()); } addr |= LOCALLY_ASSIGNED_MASK; addr &amp;= ~MULTICAST_MASK; MacAddress mac = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MacAddress(addr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mac.equals(DEFAULT_MAC_ADDRESS)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createRandomUnicastAddress(base, r); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mac; }</code> </pre><br><p>  La direcci贸n completa, o sus al menos tres bytes, es pura <em>Random.nextLong ()</em> .  "Recuperaci贸n patentada de MAS real" - un fraude.  Con un alto grado de certeza, se puede esperar que los fabricantes de tel茅fonos Android utilicen otras OUI no registradas.  No tenemos ninguna fuente de iOS, pero lo m谩s probable es que se use un algoritmo similar all铆. </p><br><p>  Lo anterior no cancela la operaci贸n de otros mecanismos de desanonimizaci贸n de suscriptores de Wi-Fi, en base al an谩lisis de otros campos del marco de solicitud de la sonda, o la correlaci贸n de la frecuencia relativa de solicitudes enviadas por el dispositivo.  Sin embargo, el seguimiento confiable de un suscriptor por medios externos es extremadamente problem谩tico.  Los datos recopilados son m谩s adecuados para analizar la carga promedio / pico por ubicaci贸n y tiempo, en funci贸n de grandes cantidades, sin referencia a dispositivos y personas espec铆ficos.  Los datos precisos son solo para aquellos que est谩n "dentro", los propios fabricantes de sistemas operativos m贸viles, las aplicaciones instaladas. </p><br><p>  驴Qu茅 podr铆a ser peligroso si otra persona descubre la direcci贸n MAC de su dispositivo?  Para redes cableadas e inal谩mbricas, se puede organizar un ataque de denegaci贸n de servicio.  Para un dispositivo inal谩mbrico, adem谩s, con cierta probabilidad es posible fijar el momento de aparici贸n en el lugar donde est谩 instalado el sensor.  Al suplantar la direcci贸n, puede intentar simular que es su dispositivo, lo que puede funcionar solo si no se aplican medidas de seguridad adicionales (autorizaci贸n y / o cifrado).  El 99.9% de las personas aqu铆 no tienen nada de qu茅 preocuparse. </p><br><p>  La direcci贸n MAC es m谩s compleja de lo que parece, pero m谩s simple de lo que podr铆a ser. </p></div></div><p>Source: <a href="https://habr.com/ru/post/483670/">https://habr.com/ru/post/483670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483660/index.html">Telegram-bot para gesti贸n de infraestructura</a></li>
<li><a href="../483662/index.html">Integraci贸n de Cisco Threat Response y Cisco Stealthwatch Enterprise</a></li>
<li><a href="../483664/index.html">API funcional de Keras en TensorFlow</a></li>
<li><a href="../483666/index.html">Sobre Volodia y el ozonizador</a></li>
<li><a href="../483668/index.html">El resumen de materiales frescos del mundo del front-end para la 煤ltima semana No. 397 (6 al 12 de enero de 2020)</a></li>
<li><a href="../483674/index.html">C贸mo funcionan las redes neuronales binarias y por qu茅 ser谩n populares en 2020</a></li>
<li><a href="../483676/index.html">Evaluaci贸n de la efectividad y el costo de implementar un sistema de an谩lisis de marketing de extremo a extremo</a></li>
<li><a href="../483678/index.html">Desarrollando programas Python extremadamente r谩pidos</a></li>
<li><a href="../483680/index.html">Errores de programaci贸n comunes para evitar</a></li>
<li><a href="../483682/index.html">Agrupaci贸n y rendimiento de JavaScript: mejores pr谩cticas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>