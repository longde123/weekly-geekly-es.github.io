<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐶 👂🏿 🧓🏽 Todo lo que querías saber sobre la dirección MAC 🥐 🥇 🙋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo el mundo sabe que estos son seis bytes, que generalmente se muestran en formato hexadecimal, asignados a una tarjeta de red en la fábrica y, a pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Todo lo que querías saber sobre la dirección MAC</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483670/"><p><img src="https://habrastorage.org/webt/so/w5/21/sow5218j24fiojm2deevv3xnko8.jpeg" align="right">  Todo el mundo sabe que estos son seis bytes, que generalmente se muestran en formato hexadecimal, asignados a una tarjeta de red en la fábrica y, a primera vista, son aleatorios.  Algunas personas saben que los primeros tres bytes de la dirección son el identificador del fabricante, y los tres bytes restantes se les asignan.  También se sabe que puede establecer <em>una</em> dirección <em>arbitraria</em> .  Muchos han escuchado sobre las "direcciones aleatorias" en Wi-Fi. </p><br><p>  Averigüemos qué es. </p><br><p> Dirección MAC (dirección de control de acceso a medios): un identificador único asignado a un adaptador de red; se utiliza en redes con estándares IEEE 802, principalmente Ethernet, Wi-Fi y Bluetooth.  Oficialmente, se llama un "identificador de tipo EUI-48".  Es obvio por el nombre que la dirección tiene 48 bits de longitud, es decir  6 bytes  No existe un estándar generalmente aceptado para escribir una dirección (a diferencia de una dirección IPv4, donde los octetos siempre están separados por puntos). Generalmente se escribe como seis números hexadecimales, separados por dos puntos: 00: AB: CD: EF: 11: 22, aunque algunos fabricantes de equipos prefieren escribir como 00 -AB-CD-EF-11-22 e incluso 00ab.cdef.1122. </p><a name="habracut"></a><br><p>  Históricamente, las direcciones se cosían en la ROM del conjunto de chips de la tarjeta de red sin la posibilidad de su modificación sin un programador flash, pero en la actualidad la dirección se puede cambiar mediante programación, desde el sistema operativo.  Puede configurar manualmente la dirección MAC de la tarjeta de red en Linux y MacOS (siempre), Windows (casi siempre, si el controlador lo permite), Android (solo root);  con iOS (sin root) un truco similar es imposible. </p><br><h3>  Estructura de direcciones </h3><br><p>  La dirección consta de una parte del identificador del fabricante, OUI y el identificador asignado por el fabricante.  El IEEE asigna el OUI (Identificador Organizacionalmente Único).  De hecho, su longitud puede ser no solo de 3 bytes (24 bits), sino también de 28 o 36 bits, a partir de los cuales se forman los bloques del Bloque de direcciones MAC (MA) de tipo Grande (MA-L), Medio (MA-M) y Pequeño. (MA-S) respectivamente.  El tamaño del bloque emitido, en este caso, será de 24, 20, 12 bits o 16 millones, 1 millón, 4 mil piezas de direcciones.  En este momento, se distribuyen unos 38 mil bloques, que se pueden ver con numerosas herramientas en línea, por ejemplo, <a href="https://regauth.standards.ieee.org/standards-ra-web/pub/view.html" rel="nofollow">IEEE</a> o <a href="https://www.wireshark.org/tools/oui-lookup.html" rel="nofollow">Wireshark</a> . </p><br><h3>  Quién posee las direcciones </h3><br><p>  El simple procesamiento de la <a href="https://code.wireshark.org/review/gitweb%3Fp%3Dwireshark.git%3Ba%3Dblob_plain%3Bf%3Dmanuf%3Bhb%3DHEAD" rel="nofollow">base de datos de carga</a> IEEE disponible públicamente proporciona mucha información.  Por ejemplo, algunas organizaciones han tomado muchos bloques OUI.  Aquí están nuestros héroes: </p><br><div class="scrollable-table"><table><thead><tr><th>  Vendedor </th><th>  El número de bloques / registros. </th><th>  El número de direcciones, millones </th></tr></thead><tbody><tr><td>  Cisco Systems Inc </td><td>  888 </td><td>  14208 </td></tr><tr><td>  Manzana </td><td>  772 </td><td>  12352 </td></tr><tr><td>  Samsung </td><td>  636 </td><td>  10144 </td></tr><tr><td>  Huawei Technologies Co. Ltd </td><td>  606 </td><td>  9696 </td></tr><tr><td>  Corporación Intel </td><td>  375 </td><td>  5776 </td></tr><tr><td>  ARRIS Group Inc. </td><td>  319 </td><td>  5104 </td></tr><tr><td>  Nokia Corporation </td><td>  241 </td><td>  3856 </td></tr><tr><td>  Privado </td><td>  232 </td><td>  2704 </td></tr><tr><td>  Texas Instruments </td><td>  212 </td><td>  3392 </td></tr><tr><td>  corporación zte </td><td>  198 </td><td>  3168 </td></tr><tr><td>  Autoridad de registro de IEEE </td><td>  194 </td><td>  3072 </td></tr><tr><td>  Hewlett Packard </td><td>  149 </td><td>  2384 </td></tr><tr><td>  Hon Hai Precision </td><td>  136 </td><td>  2176 </td></tr><tr><td>  TP-LINK </td><td>  134 </td><td>  2144 </td></tr><tr><td>  Dell Inc. </td><td>  123 </td><td>  1968 </td></tr><tr><td>  Juniper Networks </td><td>  110 </td><td>  1760 </td></tr><tr><td>  Sagemcom Broadband SAS </td><td>  97 </td><td>  1552 </td></tr><tr><td>  Fiberhome Telecommunication Technologies Co.  LTD </td><td>  97 </td><td>  1552 </td></tr><tr><td>  Xiaomi Communications Co Ltd </td><td>  88 </td><td>  1408 </td></tr><tr><td>  Guangdong Oppo Mobile Telecommunications Corp.Ltd </td><td>  82 </td><td>  1312 </td></tr></tbody></table></div><br><p>  Google tiene solo 40 de ellos, y esto no es sorprendente: ellos mismos no producen tantos dispositivos de red. </p><br><p>  Los bloques MA no se proporcionan de forma gratuita, se pueden comprar por dinero razonable (sin una tarifa mensual) por $ 3000, $ 1800 o $ 755, respectivamente.  Es interesante que por el dinero extra (por año) puede comprar la "ocultación" de la información pública sobre el bloque asignado.  Hay 232 de ellos ahora, como se puede ver arriba. </p><br><h3 id="kogda-zakonchatsya-mas-adresa">  ¿Cuándo se agotará la dirección MAC? </h3><br><p>  Todos estamos cansados ​​de la historia de diez años de que "las direcciones IPv4 están a punto de agotarse".  Sí, los nuevos bloques de IPv4 ya no son fáciles de obtener.  También se sabe que las direcciones IP se <a href="https://habr.com/ru/company/globalsign/blog/355006/">distribuyen de manera extremadamente desigual</a> ;  Sin embargo, hay bloques gigantescos y poco utilizados propiedad de grandes corporaciones y del gobierno de los Estados Unidos, sin mucha esperanza de su redistribución en favor de los necesitados.  La proliferación de NAT, CG-NAT e IPv6 ha hecho que el problema de la falta de direcciones públicas sea menos grave. </p><br><p>  La dirección MAC tiene 48 bits, de los cuales 46 son útiles (¿por qué? Siga leyendo), lo que da 2 <sup>46</sup> o 10 <sup>14</sup> direcciones, que es 2 <sup>14</sup> veces el espacio de direcciones IPv4. <br>  En este momento, se distribuyen aproximadamente medio billón de direcciones, o solo el 0.73% del volumen total.  El agotamiento de las direcciones MAC todavía está muy, muy lejos. </p><br><h3 id="sluchaynost-bit">  Bit aleatorio </h3><br><p>  Se puede suponer que las OUI se distribuyen aleatoriamente, y el proveedor también asigna aleatoriamente direcciones a dispositivos de red individuales.  Es asi?  Veamos la distribución de bits en las bases MAC de las direcciones que tengo a mi disposición para dispositivos 802.11 recopilados por sistemas de autorización de trabajo en redes inalámbricas <a href="https://www.netams.com/wnam/" rel="nofollow">WNAM</a> .  Las direcciones pertenecen a dispositivos reales que se han conectado a Wi-Fi durante varios años en tres países.  Además, hay una pequeña base de dispositivos LAN con cable 802.3. </p><br><p>  Dividimos cada dirección MAC (seis bytes) de cada una de las muestras en bits por bytes, y observamos la frecuencia de aparición del bit "1" en cada una de las 48 posiciones.  Si el bit se establece de forma completamente arbitraria, la probabilidad de obtener "1" debería ser del 50%. </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Muestra de Wi-Fi n. ° 1 (RF) </th><th>  Muestra de Wi-Fi no 2 (Bielorrusia) </th><th>  Muestra de Wi-Fi no 3 (Uzbekistán) </th><th>  Muestra de LAN (RF) </th></tr></thead><tbody><tr><td>  El número de registros en la base de datos. </td><td>  5929000 </td><td>  1274000 </td><td>  366000 </td><td>  1000 </td></tr><tr><td>  Número de bit: </td><td>  % bit "1" </td><td>  % bit "1" </td><td>  % bit "1" </td><td>  % bit "1" </td></tr><tr><td>  1 </td><td>  48,6% </td><td>  49,2% </td><td>  50,7% </td><td>  28,7% </td></tr><tr><td>  2 </td><td>  44,8% </td><td>  49,1% </td><td>  47,7% </td><td>  30,7% </td></tr><tr><td>  3 </td><td>  46,7% </td><td>  48,3% </td><td>  46,8% </td><td>  35,8% </td></tr><tr><td>  4 4 </td><td>  48,0% </td><td>  48,6% </td><td>  49,8% </td><td>  37,1% </td></tr><tr><td>  5 5 </td><td>  45,7% </td><td>  46,9% </td><td>  47,0% </td><td>  32,3% </td></tr><tr><td>  6 6 </td><td>  46,6% </td><td>  46,7% </td><td>  47,8% </td><td>  27,1% </td></tr><tr><td>  7 7 </td><td>  <strong>0.3%</strong> </td><td>  <strong>0.3%</strong> </td><td>  <strong>0.2%</strong> </td><td>  <strong>0.7%</strong> </td></tr><tr><td>  8 </td><td>  <strong>0.0%</strong> </td><td>  <strong>0.0%</strong> </td><td>  <strong>0.0%</strong> </td><td>  <strong>0.0%</strong> </td></tr><tr><td></td></tr><tr><td>  9 9 </td><td>  48,1% </td><td>  50,6% </td><td>  49,4% </td><td>  38,1% </td></tr><tr><td>  10 </td><td>  49,1% </td><td>  50,2% </td><td>  47,4% </td><td>  42,7% </td></tr><tr><td>  11 </td><td>  50,8% </td><td>  50,0% </td><td>  50,6% </td><td>  42,9% </td></tr><tr><td>  12 </td><td>  49,0% </td><td>  48,4% </td><td>  48,2% </td><td>  53,7% </td></tr><tr><td>  13 </td><td>  47,6% </td><td>  47,0% </td><td>  46,3% </td><td>  48,5% </td></tr><tr><td>  14 </td><td>  47,5% </td><td>  47,4% </td><td>  51,7% </td><td>  46,8% </td></tr><tr><td>  15 </td><td>  48,3% </td><td>  47,5% </td><td>  48,7% </td><td>  46,1% </td></tr><tr><td>  16 </td><td>  50,6% </td><td>  50,4% </td><td>  51,2% </td><td>  45,3% </td></tr><tr><td></td></tr><tr><td>  17 </td><td>  49,4% </td><td>  50,4% </td><td>  54,3% </td><td>  38,2% </td></tr><tr><td>  18 años </td><td>  49,8% </td><td>  50,5% </td><td>  51,5% </td><td>  51,9% </td></tr><tr><td>  19 </td><td>  51,6% </td><td>  53,3% </td><td>  53,9% </td><td>  42,6% </td></tr><tr><td>  20 </td><td>  46,6% </td><td>  46,1% </td><td>  45,5% </td><td>  48,4% </td></tr><tr><td>  21 </td><td>  51,7% </td><td>  52,9% </td><td>  47,7% </td><td>  48,9% </td></tr><tr><td>  22 </td><td>  49,2% </td><td>  49,6% </td><td>  41,6% </td><td>  49,8% </td></tr><tr><td>  23 </td><td>  51,2% </td><td>  50,9% </td><td>  47,0% </td><td>  41,9% </td></tr><tr><td>  24 </td><td>  49,5% </td><td>  50,2% </td><td>  50,1% </td><td>  47,5% </td></tr><tr><td></td></tr><tr><td>  25 </td><td>  47,1% </td><td>  47,3% </td><td>  47,7% </td><td>  44,2% </td></tr><tr><td>  26 </td><td>  48,6% </td><td>  48,6% </td><td>  49,2% </td><td>  43,9% </td></tr><tr><td>  27 </td><td>  49,8% </td><td>  49,0% </td><td>  49,7% </td><td>  48,9% </td></tr><tr><td>  28 </td><td>  49,3% </td><td>  49,3% </td><td>  49,7% </td><td>  55,1% </td></tr><tr><td>  29 </td><td>  49,5% </td><td>  49,4% </td><td>  49,8% </td><td>  49,8% </td></tr><tr><td>  30 </td><td>  49,8% </td><td>  49,8% </td><td>  49,7% </td><td>  52,1% </td></tr><tr><td>  31 </td><td>  49,5% </td><td>  49,7% </td><td>  49,6% </td><td>  46,6% </td></tr><tr><td>  32 </td><td>  49,4% </td><td>  49,7% </td><td>  49,5% </td><td>  47,5% </td></tr><tr><td></td></tr><tr><td>  33 </td><td>  49,4% </td><td>  49,8% </td><td>  49,7% </td><td>  48,3% </td></tr><tr><td>  34 </td><td>  49,7% </td><td>  50,0% </td><td>  49,6% </td><td>  44,9% </td></tr><tr><td>  35 </td><td>  49,9% </td><td>  50,0% </td><td>  50,0% </td><td>  50,6% </td></tr><tr><td>  36 </td><td>  49,9% </td><td>  49,9% </td><td>  49,8% </td><td>  49,1% </td></tr><tr><td>  37 </td><td>  49,8% </td><td>  50,0% </td><td>  49,9% </td><td>  51,4% </td></tr><tr><td>  38 </td><td>  50,0% </td><td>  50,0% </td><td>  49,8% </td><td>  51,8% </td></tr><tr><td>  39 </td><td>  49,9% </td><td>  50,0% </td><td>  49,9% </td><td>  55,7% </td></tr><tr><td>  40 </td><td>  50,0% </td><td>  50,0% </td><td>  50,0% </td><td>  49,5% </td></tr><tr><td></td></tr><tr><td>  41 </td><td>  49,9% </td><td>  50,0% </td><td>  49,9% </td><td>  52,2% </td></tr><tr><td>  42 </td><td>  50,0% </td><td>  50,0% </td><td>  50,0% </td><td>  53,9% </td></tr><tr><td>  43 </td><td>  50,1% </td><td>  50,0% </td><td>  50,3% </td><td>  56,1% </td></tr><tr><td>  44 </td><td>  50,1% </td><td>  50,0% </td><td>  50,1% </td><td>  45,8% </td></tr><tr><td>  45 </td><td>  50,0% </td><td>  50,0% </td><td>  50,1% </td><td>  50,1% </td></tr><tr><td>  46 </td><td>  50,0% </td><td>  50,0% </td><td>  50,1% </td><td>  49,5% </td></tr><tr><td>  47 </td><td>  49,2% </td><td>  49,4% </td><td>  49,7% </td><td>  45,2% </td></tr><tr><td>  48 </td><td>  49,9% </td><td>  50,1% </td><td>  50,7% </td><td>  54,6% </td></tr></tbody></table></div><br><p>  ¿De dónde viene esta injusticia en los bits 7 y 8?  Casi siempre hay ceros. </p><br><p>  De hecho, el estándar define estos bits como especiales ( <a href="https://ru.wikipedia.org/wiki/MAC-%25D0%25B0%25D0%25B4%25D1%2580%25D0%25B5%25D1%2581" rel="nofollow">Wikipedia</a> ): <br><img src="https://habrastorage.org/webt/0-/oc/jk/0-ocjkovhfyalpqzrsjdecvg7na.png"></p><br><p>  El octavo bit (desde el principio) del primer byte de la dirección MAC se llama bit de unidifusión / multidifusión y determina qué tipo de trama (trama) se transmite con esta dirección, normal (0) o difusión (1) (multidifusión o difusión).  Para la interacción normal del adaptador de red de unidifusión, este bit se establece en "0" en todos los paquetes que se le envían. </p><br><p>  El séptimo bit (desde el principio) del primer byte de la dirección MAC se llama bit U / L (Universal / Local) y determina si la dirección es globalmente única (0) o localmente única (1).  Por defecto, todas las direcciones "cosidas por el fabricante" son globalmente únicas, por lo tanto, la gran cantidad de direcciones MAC recopiladas contiene el séptimo bit establecido en "0".  En la tabla de identificadores OUI asignados, solo alrededor de 130 entradas tienen un bit U / L "1", y lo más probable es que sean bloques de direcciones MAC para necesidades especiales. </p><br><p>  Desde el sexto hasta el primer bit del primer byte, los bits del segundo y tercer bytes en los identificadores OUI, y aún más los bits en 4-6 bytes de la dirección asignada por el fabricante, se distribuyen de manera más o menos uniforme. </p><br><p>  Por lo tanto, en la dirección MAC real del adaptador de red, los bits son prácticamente equivalentes y no tienen un significado tecnológico, con la excepción de dos bits de servicio del byte alto. </p><br><h3 id="rasprostranennost">  Prevalencia </h3><br><p>  Me pregunto qué fabricantes de equipos inalámbricos son los más populares.  Combine la búsqueda de OUI con los datos de muestra No. 1. </p><br><div class="scrollable-table"><table><thead><tr><th>  Vendedor </th><th>  El porcentaje de dispositivos,% </th></tr></thead><tbody><tr><td>  Manzana </td><td>  26,09 </td></tr><tr><td>  Samsung </td><td>  19,79 </td></tr><tr><td>  Huawei Technologies Co.  Ltd </td><td>  7,80 </td></tr><tr><td>  Xiaomi Communications Co Ltd </td><td>  6.83 </td></tr><tr><td>  Sony Mobile Communications Inc </td><td>  3.29 </td></tr><tr><td>  LG Electronics (Comunicaciones móviles) </td><td>  2,76 </td></tr><tr><td>  ASUSTek COMPUTER INC. </td><td>  2,58 </td></tr><tr><td>  TCT mobile ltd </td><td>  2,13 </td></tr><tr><td>  corporación zte </td><td>  2,00 </td></tr><tr><td>  no encontrado en la base de datos IEEE </td><td>  1,92 </td></tr><tr><td>  Tecnología de comunicación móvil de Lenovo Ltd. </td><td>  1,71 </td></tr><tr><td>  HTC Corporation </td><td>  1,68 </td></tr><tr><td>  Fabricación de Murata </td><td>  1,31 </td></tr><tr><td>  Inpro comm </td><td>  1,26 </td></tr><tr><td>  Microsoft Corporation </td><td>  1,11 </td></tr><tr><td>  Shenzhen TINNO Mobile Technology Corp. </td><td>  1,02 </td></tr><tr><td>  Motorola (Wuhan) Mobility Technologies Communication Co.  Ltd. </td><td>  0,93 </td></tr><tr><td>  Nokia Corporation </td><td>  0,88 </td></tr><tr><td>  Shanghai Wind Technologies Co.  Ltd </td><td>  0,74 </td></tr><tr><td>  Lenovo Mobile Communication (Wuhan) Company Limited </td><td>  0,71 </td></tr></tbody></table></div><br><p>  La práctica muestra que cuanto más próspero sea el contingente de suscriptores inalámbricos en este lugar, mayor será la proporción de dispositivos Apple. </p><br><h3 id="unikalnost">  Singularidad </h3><br><p>  ¿Son únicas las direcciones MAC?  En teoría, sí, ya que cada uno de los fabricantes de dispositivos (propietarios de la unidad MA) debe proporcionar una dirección única para cada uno de sus adaptadores de red.  Sin embargo, algunos fabricantes de chips, a saber: </p><br><ul><li>  00: 0A: F5 Airgo Networks, Inc.  (ahora Qualcomm) </li><li>  00:08:22 InPro Comm (ahora MediaTek) </li></ul><br><p>  configura los últimos tres bytes de la dirección MAC en un número aleatorio, aparentemente después de cada reinicio del dispositivo.  Había 82 mil de esas direcciones en mi muestra No. 1. </p><br><p>  Puede establecerse un extraño, no una dirección única, por supuesto, configurándolo a propósito "como un vecino", definiéndolo como un rastreador, o eligiendo al azar.  También es posible establecer accidentalmente una dirección no única realizando, por ejemplo, restaurando una configuración de respaldo de un enrutador como Mikrotik u OpenWrt. </p><br><p>  ¿Qué sucede si dos dispositivos con la misma dirección MAC están presentes en la red?  Todo depende de la lógica del equipo de red (enrutador con cable, controlador de red inalámbrica).  Lo más probable es que ambos dispositivos no funcionen o funcionen de manera intermitente.  Desde el punto de vista de los estándares IEEE, se propone resolver la protección contra la falsificación de direcciones MAC utilizando, por ejemplo, MACsec o 802.1X. </p><br><p>  ¿Qué pasa si te pones un MAC con el séptimo u octavo bit establecido en "1", es decir  dirección local o multidifusión?  Lo más probable es que su red no preste atención a esto, pero formalmente, dicha dirección no se ajustará al estándar, y es mejor no hacerlo. </p><br><h3 id="kak-rabotaet-randomizaciya">  Cómo funciona la aleatorización </h3><br><p>  Sabemos que para evitar rastrear el movimiento de personas escaneando el aire y recolectando los sistemas operativos MAC de los teléfonos inteligentes, hemos estado utilizando la tecnología de aleatorización durante varios años.  Teóricamente, cuando escanea el aire en busca de redes conocidas, el teléfono inteligente envía un paquete (grupo de paquetes) del tipo de solicitud de sonda 802.11 con la dirección MAC como fuente: </p><br><p><img src="https://habrastorage.org/webt/ys/xx/sp/ysxxspu7y2giwvvdflhwrgiar-m.gif"></p><br><p>  La aleatorización incluida le permite especificar no "flasheado", sino alguna otra dirección de origen del paquete, que cambia con cada ciclo de exploración, a tiempo o de alguna manera.  ¿Esto funciona?  Echemos un vistazo a las estadísticas de las direcciones MAC recopiladas desde el aire con el llamado "Radar de Wi-Fi": </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Muestra entera </th><th>  Muestreo con solo 7m bit </th></tr></thead><tbody><tr><td>  El número de registros en la base de datos. </td><td>  3920000 </td><td>  305,000 </td></tr><tr><td>  Número de bit: </td><td>  % bit "1" </td><td>  % bit "1" </td></tr><tr><td>  1 </td><td>  66,1% </td><td>  43,3% </td></tr><tr><td>  2 </td><td>  66,5% </td><td>  43,4% </td></tr><tr><td>  3 </td><td>  31,7% </td><td>  43,8% </td></tr><tr><td>  4 4 </td><td>  66,6% </td><td>  46,4% </td></tr><tr><td>  5 5 </td><td>  66,7% </td><td>  45,7% </td></tr><tr><td>  6 6 </td><td>  31,9% </td><td>  46,4% </td></tr><tr><td>  7 7 </td><td>  <strong>92,2%</strong> </td><td>  0.0% </td></tr><tr><td>  8 </td><td>  0.0% </td><td>  0.0% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  9 9 </td><td>  67,2% </td><td>  47,5% </td></tr><tr><td>  10 </td><td>  32,3% </td><td>  45,6% </td></tr><tr><td>  11 </td><td>  66,9% </td><td>  45,3% </td></tr><tr><td>  12 </td><td>  32,3% </td><td>  46,8% </td></tr><tr><td>  13 </td><td>  32,6% </td><td>  50,1% </td></tr><tr><td>  14 </td><td>  33,0% </td><td>  56,1% </td></tr><tr><td>  15 </td><td>  32,5% </td><td>  45,0% </td></tr><tr><td>  16 </td><td>  67,2% </td><td>  48,3% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  17 </td><td>  33,2% </td><td>  56,9% </td></tr><tr><td>  18 años </td><td>  33,3% </td><td>  56,8% </td></tr><tr><td>  19 </td><td>  33,3% </td><td>  56,3% </td></tr><tr><td>  20 </td><td>  66,8% </td><td>  43,2% </td></tr><tr><td>  21 </td><td>  67,0% </td><td>  46,4% </td></tr><tr><td>  22 </td><td>  32,6% </td><td>  50,1% </td></tr><tr><td>  23 </td><td>  32,9% </td><td>  51,2% </td></tr><tr><td>  24 </td><td>  67,6% </td><td>  52,2% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  25 </td><td>  49,8% </td><td>  47,8% </td></tr><tr><td>  26 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  27 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  28 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  29 </td><td>  50,0% </td><td>  49,4% </td></tr><tr><td>  30 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  31 </td><td>  50,0% </td><td>  49,7% </td></tr><tr><td>  32 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  33 </td><td>  50,0% </td><td>  49,7% </td></tr><tr><td>  34 </td><td>  50,0% </td><td>  49,6% </td></tr><tr><td>  35 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  36 </td><td>  50,0% </td><td>  49,5% </td></tr><tr><td>  37 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td>  38 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  39 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td>  40 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  41 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  42 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  43 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  44 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  45 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  46 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  47 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  48 </td><td>  50,1% </td><td>  50,9% </td></tr></tbody></table></div><br><p>  La imagen es completamente diferente. </p><br><p>  El octavo bit del primer byte de la dirección MAC todavía coincide con la naturaleza Unicast de la dirección SRC en el paquete de solicitud de la sonda. </p><br><p>  El séptimo bit en el 92.2% de los casos se establece en Local, es decir  con bastante certeza, podemos suponer que tantas direcciones recopiladas son aleatorias y menos del 8% son reales.  Además, la distribución de bits en la OUI para tales direcciones reales coincide aproximadamente con los datos de la tabla anterior. </p><br><p>  Según OUI, ¿a qué fabricante pertenecen las direcciones aleatorias (es decir, con el séptimo bit en "1")? </p><br><div class="scrollable-table"><table><thead><tr><th>  Fabricante por OUI </th><th>  Compartir entre todas las direcciones </th></tr></thead><tbody><tr><td>  no encontrado en la base de datos IEEE </td><td>  62,45% </td></tr><tr><td>  Google Inc. </td><td>  37,54% </td></tr><tr><td>  el resto </td><td>  0.01% </td></tr></tbody></table></div><br><p>  Además, todas las direcciones aleatorias asignadas a Google pertenecen a una OUI con el prefijo <strong>DA: A1: 19</strong> .  ¿Qué es este prefijo?  Veamos el <a href="" rel="nofollow">código fuente de Android</a> . </p><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MacAddress BASE_GOOGLE_MAC = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"da:a1:19:0:0:0"</span></span>);</code> </pre> <br><p>  El stock de Android utiliza un OUI registrado especial, uno de los pocos con el conjunto de séptimo bit, en la búsqueda de redes inalámbricas. </p><br><h3 id="vychislit-realnyy-mas-iz-randomnogo">  Calcular MAC real a partir de aleatorio </h3><br><p>  Miremos allí: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> VALID_LONG_MASK = (<span class="hljs-number"><span class="hljs-number">1L</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> LOCALLY_ASSIGNED_MASK = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"2:0:0:0:0:0"</span></span>).mAddr; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> MULTICAST_MASK = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"1:0:0:0:0:0"</span></span>).mAddr; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> <span class="hljs-function"><span class="hljs-function">MacAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createRandomUnicastAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MacAddress base, Random r)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> addr; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (base == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { addr = r.nextLong() &amp; VALID_LONG_MASK; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { addr = (base.mAddr &amp; OUI_MASK) | (NIC_MASK &amp; r.nextLong()); } addr |= LOCALLY_ASSIGNED_MASK; addr &amp;= ~MULTICAST_MASK; MacAddress mac = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MacAddress(addr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mac.equals(DEFAULT_MAC_ADDRESS)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createRandomUnicastAddress(base, r); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mac; }</code> </pre><br><p>  La dirección completa, o sus al menos tres bytes, es pura <em>Random.nextLong ()</em> .  "Recuperación patentada de MAS real" - un fraude.  Con un alto grado de certeza, se puede esperar que los fabricantes de teléfonos Android utilicen otras OUI no registradas.  No tenemos ninguna fuente de iOS, pero lo más probable es que se use un algoritmo similar allí. </p><br><p>  Lo anterior no cancela la operación de otros mecanismos de desanonimización de suscriptores de Wi-Fi, en base al análisis de otros campos del marco de solicitud de la sonda, o la correlación de la frecuencia relativa de solicitudes enviadas por el dispositivo.  Sin embargo, el seguimiento confiable de un suscriptor por medios externos es extremadamente problemático.  Los datos recopilados son más adecuados para analizar la carga promedio / pico por ubicación y tiempo, en función de grandes cantidades, sin referencia a dispositivos y personas específicos.  Los datos precisos son solo para aquellos que están "dentro", los propios fabricantes de sistemas operativos móviles, las aplicaciones instaladas. </p><br><p>  ¿Qué podría ser peligroso si otra persona descubre la dirección MAC de su dispositivo?  Para redes cableadas e inalámbricas, se puede organizar un ataque de denegación de servicio.  Para un dispositivo inalámbrico, además, con cierta probabilidad es posible fijar el momento de aparición en el lugar donde está instalado el sensor.  Al suplantar la dirección, puede intentar simular que es su dispositivo, lo que puede funcionar solo si no se aplican medidas de seguridad adicionales (autorización y / o cifrado).  El 99.9% de las personas aquí no tienen nada de qué preocuparse. </p><br><p>  La dirección MAC es más compleja de lo que parece, pero más simple de lo que podría ser. </p></div></div><p>Source: <a href="https://habr.com/ru/post/483670/">https://habr.com/ru/post/483670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483660/index.html">Telegram-bot para gestión de infraestructura</a></li>
<li><a href="../483662/index.html">Integración de Cisco Threat Response y Cisco Stealthwatch Enterprise</a></li>
<li><a href="../483664/index.html">API funcional de Keras en TensorFlow</a></li>
<li><a href="../483666/index.html">Sobre Volodia y el ozonizador</a></li>
<li><a href="../483668/index.html">El resumen de materiales frescos del mundo del front-end para la última semana No. 397 (6 al 12 de enero de 2020)</a></li>
<li><a href="../483674/index.html">Cómo funcionan las redes neuronales binarias y por qué serán populares en 2020</a></li>
<li><a href="../483676/index.html">Evaluación de la efectividad y el costo de implementar un sistema de análisis de marketing de extremo a extremo</a></li>
<li><a href="../483678/index.html">Desarrollando programas Python extremadamente rápidos</a></li>
<li><a href="../483680/index.html">Errores de programación comunes para evitar</a></li>
<li><a href="../483682/index.html">Agrupación y rendimiento de JavaScript: mejores prácticas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>