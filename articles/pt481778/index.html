<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòπ üöß ‚õ™Ô∏è An√°lise de malware do Skeleton Key üë©üèº‚Äçü§ù‚Äçüë®üèø üè™ üë©üèº‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A tradu√ß√£o do artigo foi preparada especialmente para os alunos do curso de engenharia reversa . 



 Sum√°rio 
 Pesquisadores da CTU (Dell SecureWorks...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>An√°lise de malware do Skeleton Key</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/481778/">  <i>A tradu√ß√£o do artigo foi preparada especialmente para os alunos do curso de <a href="https://otus.pw/C71z/">engenharia reversa</a> .</i> <br><br><img src="https://habrastorage.org/webt/9z/ro/zu/9zrozu-bzodywtxpi3u8jgmsgog.png"><br><hr><br><h3>  Sum√°rio </h3><br>  Pesquisadores da CTU (Dell SecureWorks Counter Threat Unit) descobriram malware que ignora os sistemas de autentica√ß√£o do Active Directory (AD) que usam autentica√ß√£o de fator √∫nico (somente senha).  Os invasores podem usar a senha de sua escolha para autentica√ß√£o como qualquer usu√°rio.  Esse malware √© chamado de "Chave do esqueleto" (chave universal). <br><br>  Os pesquisadores da CTU descobriram o Skeleton Key em uma rede cliente que usava autentica√ß√£o de fator √∫nico para acessar webmail e VPNs, dando aos invasores acesso sem impedimentos a servi√ßos de acesso remoto.  A Chave de esqueleto √© implantada como um patch na mem√≥ria nos controladores de dom√≠nio AD da v√≠tima para permitir que um invasor se autentique como qualquer usu√°rio, enquanto usu√°rios leg√≠timos continuam a autentica√ß√£o normalmente.  O desvio de autentica√ß√£o do Skeleton Key tamb√©m permite que invasores de acesso f√≠sico efetuem login e desbloqueiem sistemas que autenticam usu√°rios em controladores de dom√≠nio do AD comprometidos. <a name="habracut"></a><br><br>  Os √∫nicos exemplos de chave de esqueleto conhecidos no momento da publica√ß√£o careciam de persist√™ncia - eles devem ser reimplantados quando o controlador de dom√≠nio reiniciar.  Os pesquisadores da CTU suspeitam que os invasores s√≥ podem identificar uma reinicializa√ß√£o com base em sua incapacidade de se autenticar com √™xito, pois nenhum outro malware foi detectado nos controladores de dom√≠nio.  Entre oito horas e oito dias ap√≥s o rein√≠cio, os atacantes usaram outro malware de acesso remoto j√° implantado na rede da v√≠tima para reimplementar a Chave do Esqueleto nos controladores de dom√≠nio. <br><br>  A implanta√ß√£o da chave de esqueleto requer credenciais de administrador de dom√≠nio.  Os pesquisadores da CTU observaram os atacantes implantarem a chave do esqueleto usando credenciais roubadas de servidores de miss√£o cr√≠tica, esta√ß√µes de trabalho de administrador e controladores de dom√≠nio de destino. <br><br><h3>  An√°lise </h3><br>  Inicialmente, os pesquisadores da CTU observaram uma amostra da Skeleton Key chamada ole64.dll em uma rede comprometida (consulte a Tabela 1). <br><br><div class="scrollable-table"><table><tbody><tr><td>  atributo </td><td>  significado ou descri√ß√£o </td></tr><tr><td>  nome do arquivo </td><td>  ole64.dll </td></tr><tr><td>  md5 </td><td>  bf45086e6334f647fda33576e2a05826 </td></tr><tr><td>  sha1 </td><td>  5083b17ccc50dd0557dfc544f84e2ab55d6acd92 </td></tr><tr><td>  tempo de compila√ß√£o </td><td>  2014-02-19 09:31:29 </td></tr><tr><td>  implantado </td><td>  conforme necess√°rio (geralmente baixado usando malware e exclu√≠do ap√≥s o uso) </td></tr><tr><td>  tamanho do arquivo </td><td>  49664 bytes </td></tr><tr><td>  sec√ß√µes </td><td>  .text, .rdata, .data, .pdata, .rsrc, .reloc </td></tr><tr><td>  exportar </td><td><p>  ii (instala o patch) </p><p>  uu (remove o patch) </p><p>  dllentrypoint (ponto de entrada da dll padr√£o) </p></td></tr></tbody></table></div><br>  <i>Tabela 1. Chave de esqueleto de amostra <code>ole64.dll</code> .</i> <br><br>  Enquanto estudavam <code>ole64.dll</code> , os pesquisadores da CTU descobriram uma vers√£o mais antiga do <code>msuta64.dll</code> em um "host intermedi√°rio" na rede da v√≠tima (consulte a Tabela 2).  Um host intermedi√°rio √© qualquer sistema anteriormente comprometido por malware malicioso de acesso remoto.  Esta op√ß√£o inclui operadores de depura√ß√£o adicionais que permitem ao desenvolvedor do Skeleton Key observar os endere√ßos de mem√≥ria envolvidos no processo de corre√ß√£o. <br><br><div class="scrollable-table"><table><tbody><tr><td>  atributo </td><td>  significado ou descri√ß√£o </td></tr><tr><td>  nome do arquivo </td><td>  msuta64.dll <br></td></tr><tr><td>  md5 </td><td>  66da7ed621149975f6e643b4f9886cfd </td></tr><tr><td>  sha1 </td><td>  ad61e8daeeba43e442514b177a1b41ad4b7c6727 <br></td></tr><tr><td>  tempo de compila√ß√£o </td><td>  2012-09-20 08:07:12 </td></tr><tr><td>  implantado </td><td>  2013-09-29 07:58:16 <br></td></tr><tr><td>  tamanho do arquivo </td><td>  50688 bytes </td></tr><tr><td>  sec√ß√µes </td><td>  .text, .rdata, .data, .pdata, .rsrc, .reloc <br></td></tr><tr><td>  exportar </td><td><p>  ii (instala o patch) </p><p>  uu (remove o patch) </p><p>  dllentrypoint (ponto de entrada da dll padr√£o) </p></td></tr></tbody></table></div><br>  <i>Tabela 2. Amostra de chave de esqueleto <code>msuta64.dll</code> .</i> <br><br>  Os invasores usaram o seguinte algoritmo para implantar a chave do esqueleto como um arquivo DLL de 64 bits: <br><br><ol><li>  Baixe o arquivo DLL da chave de esqueleto para o diret√≥rio de armazenamento tempor√°rio no host de armazenamento tempor√°rio na rede da v√≠tima.  Os pesquisadores da CTU observaram tr√™s nomes de arquivos associados ao arquivo DLL do Skeleton Key: ole64.dll, ole.dll e msuta64.dll.  Os sistemas Windows incluem o arquivo ole32.dll leg√≠timo, mas n√£o est√° relacionado a este malware. </li><li>  Tente acessar recursos administrativos em controladores de dom√≠nio usando uma lista de credenciais de administrador de dom√≠nio roubadas. </li><li>  Se as credenciais roubadas n√£o forem mais v√°lidas, use as ferramentas de roubo de senha para extrair as senhas do administrador do dom√≠nio em texto n√£o criptografado de um dos seguintes locais, o que implica familiaridade com o ambiente da v√≠tima: <br><br><ul><li>  mem√≥ria de outro servidor dispon√≠vel na rede v√≠tima </li><li>  trabalhos de administrador de dom√≠nio </li><li>  controladores de dom√≠nio de destino </li><li>  Use credenciais de administrador de dom√≠nio v√°lidas para copiar a DLL da chave de esqueleto em C: \ WINDOWS \ system32 \ nos controladores de dom√≠nio de destino. </li></ul></li><li>  Use o utilit√°rio <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx">PsExec</a> para executar remotamente o arquivo DLL da chave de esqueleto nos controladores de dom√≠nio de destino usando o comando rundll32.  A senha escolhida pelo invasor √© formatada como uma senha de hash NTLM e n√£o √© apresentada em texto n√£o criptografado.  Ap√≥s implantar a chave de esqueleto, o invasor pode se autenticar como qualquer usu√°rio usando o hash de senha <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> configurado <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> </li><li>  Exclua o arquivo DLL da chave de esqueleto de C: \ WINDOWS \ system32 \ nos controladores de dom√≠nio de destino. </li><li>  Exclua o arquivo DLL da chave de esqueleto do diret√≥rio intermedi√°rio no host de transi√ß√£o. </li><li>  Teste a implanta√ß√£o bem-sucedida da Chave do esqueleto usando os comandos "net use" com uma conta e senha do AD que correspondam ao hash NTLM configurado. </li></ol><br>  Os pesquisadores da CTU descobriram um padr√£o de senha incorporado que sugere que um grupo de atacantes implantou a Chave do Esqueleto em v√°rias organiza√ß√µes. <br><br>  O uso do PsExec pode ser detectado em um ambiente Windows, alertando sobre os eventos do Windows gerados pelo utilit√°rio.  Os seguintes identificadores de eventos, observados nos controladores de dom√≠nio de destino, registram a ferramenta PsExec que instala seu servi√ßo, inicia o servi√ßo e interrompe o servi√ßo.  Esses eventos s√£o gerados sempre que o PsExec √© usado, portanto, √© necess√°ria uma an√°lise adicional dos eventos para determinar se eles s√£o maliciosos ou leg√≠timos: <br><br><ul><li>  Eventos inesperados de instala√ß√£o do servi√ßo PSEXESVC (c√≥digo de evento 7045) nos controladores de dom√≠nio do AD: <br><br>  <i>Nome do Log</i> : Sistema <br>  <i>Fonte</i> : Service Control Manager <br>  <i>Resumo</i> : Um servi√ßo est√° instalado no sistema. <br>  <i>Nome do arquivo de servi√ßo</i> : <br> <code>%SystemRoot%\PSEXESVC.exe</code> </li> <li>  Eventos inesperados de in√≠cio / parada do servi√ßo PSEXESVC (c√≥digo de evento 7036) nos controladores de dom√≠nio do AD: <br><br>  <i>Nome do Log</i> : Sistema <br>  <i>Fonte</i> : Service Control Manager <br>  <i>Resumo</i> : <br><ul><li>  "O servi√ßo PSEXESVC est√° operacional." </li><li>  "O servi√ßo PSEXESVC passou para um estado parado." </li></ul></li></ul><br>  Como uma chave de esqueleto em um estado de execu√ß√£o, voc√™ precisa executar as seguintes tarefas: <br><br><ol><li>  Verifique se h√° uma das seguintes vers√µes compat√≠veis de 64 bits do Windows.  O malware n√£o √© compat√≠vel com vers√µes de 32 bits do Windows ou vers√µes do Windows Server iniciando no Windows Server 2012 (6.2). <br><br><ul><li>  6.1 (Windows 2008 R2) </li><li>  6.0 (Windows Server 2008) </li><li>  5.2 (Windows 2003 R2) </li></ul></li><li>  Use a fun√ß√£o SeDebugPrivilege para obter os direitos de administrador necess√°rios para gravar no processo de servi√ßo do subsistema de seguran√ßa local (LSASS).  Esse processo controla os recursos de seguran√ßa do dom√≠nio do AD, incluindo a autentica√ß√£o de conta de usu√°rio. </li><li>  Liste os processos dispon√≠veis para obter o identificador do processo LSASS. </li><li>  Obtenha endere√ßos para fun√ß√µes relacionadas √† autentica√ß√£o que ser√£o corrigidas: <br><br><ul><li>  CDLocateCSystem - localizado em <code>cryptdll.dll</code> </li><li>  SamIRetrieveMultiplePrimaryCredentials - localizado em <code>samsrv.dll</code> </li><li>  SamIRetrievePrimaryCredentials - localizado em <code>samsrv.dll</code> </li></ul></li><li>  Fa√ßa as configura√ß√µes do sistema operacional espec√≠fico usando a vari√°vel global definida durante a verifica√ß√£o de compatibilidade na etapa 1. </li><li>  Use a fun√ß√£o OpenProcess para obter o identificador do processo LSASS. </li><li>  Reserve e aloque o espa√ßo de mem√≥ria necess√°rio para editar e corrigir a mem√≥ria do processo LSASS. </li><li>  Corrigindo fun√ß√µes relacionadas com base no sistema operacional: <br><br><ul><li>  CDLocateCSystem (todas as vers√µes compat√≠veis do Windows) </li><li>  SamIRetrieveMultiplePrimaryCredentials (apenas Windows 2008 R2 (6.1)) </li><li>  SamIRetrievePrimaryCredentials (todas as vers√µes compat√≠veis do Windows, exceto o Windows 2008 R2 (6.1)) </li></ul></li></ol><br>  Para corrigir cada fun√ß√£o: <br><br><ol><li>  Chame a fun√ß√£o VirtualProtectEx para alterar a prote√ß√£o de mem√≥ria para permitir a grava√ß√£o nas aloca√ß√µes de mem√≥ria necess√°rias (PAGE_EXECUTE_READWRITE, 0x40).  Esta etapa permite atualizar o c√≥digo da fun√ß√£o na mem√≥ria. </li><li>  Chame a fun√ß√£o WriteProcessMemory para alterar o endere√ßo da fun√ß√£o de destino para que aponte para o c√≥digo corrigido.  Essa altera√ß√£o faz com que a chamada de fun√ß√£o use o patch. </li><li>  Restaure a prote√ß√£o de mem√≥ria original chamando o VirtualProtectEx com os sinalizadores de prote√ß√£o de mem√≥ria original.  Esta etapa √© necess√°ria para evitar aloca√ß√£o suspeita de mem√≥ria para grava√ß√£o e execu√ß√£o. </li></ol><br>  Ap√≥s o patch, um invasor pode usar a senha da chave de esqueleto configurada durante a implanta√ß√£o para efetuar login como qualquer usu√°rio do dom√≠nio.  Usu√°rios leg√≠timos ainda podem fazer login usando suas pr√≥prias senhas.  Esse desvio de autentica√ß√£o se aplica a todos os servi√ßos que usam autentica√ß√£o unidirecional do AD, como webmail e VPN, e tamb√©m permite que um invasor com acesso f√≠sico a um sistema comprometido desbloqueie um computador digitando uma senha incorporada no teclado. <br><br><h4>  <i>Poss√≠vel associa√ß√£o com problemas de replica√ß√£o de dom√≠nio</i> </h4><br>  C√≥digo malicioso O Skeleton Key n√£o transmite tr√°fego de rede, o que torna a descoberta baseada em rede ineficaz.  No entanto, esse malware est√° envolvido em problemas de replica√ß√£o de dom√≠nio que podem indicar infec√ß√£o.  Logo ap√≥s cada implanta√ß√£o do malware Skeleton Key detectada pelos pesquisadores da CTU, os controladores de dom√≠nio encontraram problemas de replica√ß√£o que n√£o podiam ser explicados ou resolvidos pelo Suporte da Microsoft e, finalmente, foi necess√°ria uma reinicializa√ß√£o para resolv√™-los.  Essas reinicializa√ß√µes removeram o desvio de autentica√ß√£o da chave de esqueleto porque o malware n√£o possui um mecanismo de persist√™ncia.  Na fig.  A Figura 1 mostra a linha do tempo dessas reinicializa√ß√µes, bem como o subsequente roubo de senhas por invasores, a expans√£o lateral e a implanta√ß√£o da Chave do esqueleto.  As realoca√ß√µes geralmente ocorreram algumas horas ou v√°rios dias ap√≥s a reinicializa√ß√£o. <br><br><img src="https://habrastorage.org/webt/qo/jp/fz/qojpfzr6gcqy84wv_hl9f4xjnk4.png"><br>  <i>Figura 1. Rela√ß√£o de implanta√ß√£o e reinicializa√ß√£o observada pelos pesquisadores da CTU, abril - julho de 2014 (Fonte: Dell SecureWorks)</i> <br><br><h3>  Contramedidas </h3><br>  O c√≥digo malicioso Skeleton Key ignora a autentica√ß√£o e n√£o gera tr√°fego de rede.  Como resultado, os sistemas de detec√ß√£o e preven√ß√£o de intrus√µes de rede (IDS / IPS) n√£o detectam essa amea√ßa.  No entanto, os pesquisadores da CTU anotaram as assinaturas YARA no <a href="https://www.secureworks.com/research/skeleton-key-malware-analysis">Ap√™ndice A</a> para descobrir a DLL da chave do esqueleto e o c√≥digo que ele insere na mem√≥ria do processo LSASS. <br><br><h3>  Indicadores de amea√ßas </h3><br>  Os indicadores de amea√ßa na Tabela 3 podem ser usados ‚Äã‚Äãpara detectar atividades relacionadas ao malware Skeleton Key. <br><br><div class="scrollable-table"><table><tbody><tr><td>  indicador </td><td>  tipo </td><td>  contexto </td></tr><tr><td>  66da7ed621149975f6e643b4f9886cfd </td><td>  hash md5 </td><td>  patch de chave de esqueleto msuta64.dll </td></tr><tr><td>  ad61e8daeeba43e442514b177a1b41ad4b7c6727 </td><td>  has1 sha1 </td><td>  patch de chave de esqueleto msuta64.dll </td></tr><tr><td>  bf45086e6334f647fda33576e2a05826 </td><td>  hash md5 </td><td>  patch chave de esqueleto ole64.dl </td></tr><tr><td>  5083b17ccc50dd0557dfc544f84e2ab55d6acd92 </td><td>  has1 sha1 </td><td>  patch chave de esqueleto ole64.dl </td></tr></tbody></table></div><br>  <i>Tabela 3. Indicadores para a chave do esqueleto.</i> <br><br><h3>  Conclus√£o </h3><br>  O CTU Research Group recomenda que as organiza√ß√µes implementem os seguintes recursos de seguran√ßa da Chave do Esqueleto: <br><br><ul><li>  A autentica√ß√£o multifator para todas as solu√ß√µes de acesso remoto, incluindo VPN e email remoto, n√£o permite que os agentes de amea√ßas ignorem a autentica√ß√£o ou fator √∫nico usando credenciais est√°ticas roubadas. </li><li>  Um log de auditoria de cria√ß√£o de processo em esta√ß√µes de trabalho e servidores, incluindo controladores de dom√≠nio AD, pode detectar implanta√ß√µes do Skeleton Key.  Em particular, as organiza√ß√µes devem procurar os seguintes artefatos: <br><br><ul><li>  Processos inesperados do PsExec.exe e uso do argumento da linha de comando PsExec "-accepteula" </li><li>  Processos inesperados do rundll32.exe </li><li>  Manipular argumentos semelhantes aos c√≥digos de hash NTLM (32 caracteres contendo n√∫meros de 0 a 9 e caracteres AF) </li></ul></li><li>  O monitoramento de eventos do Windows Service Manager nos controladores de dom√≠nio do AD pode detectar eventos inesperados de instala√ß√£o de servi√ßos (c√≥digo de evento 7045) e eventos de inicializa√ß√£o / parada (c√≥digo de evento 7036) para o servi√ßo PSEXESVC PsExec. </li></ul><br><h3>  Ap√™ndice A - Assinaturas YARA </h3><br>  As seguintes assinaturas YARA detectam a presen√ßa de uma chave de esqueleto no sistema, verificando um arquivo suspeito ou um despejo de mem√≥ria de controladores de dom√≠nio do Active Directory que supostamente cont√™m a chave de esqueleto. <br><br><pre> <code class="bash hljs">rule skeleton_key_patcher { strings: <span class="hljs-variable"><span class="hljs-variable">$target_process</span></span> = <span class="hljs-string"><span class="hljs-string">"lsass.exe"</span></span> wide <span class="hljs-variable"><span class="hljs-variable">$dll1</span></span> = <span class="hljs-string"><span class="hljs-string">"cryptdll.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$dll2</span></span> = <span class="hljs-string"><span class="hljs-string">"samsrv.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$name</span></span> = <span class="hljs-string"><span class="hljs-string">"HookDC.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched1</span></span> = <span class="hljs-string"><span class="hljs-string">"CDLocateCSystem"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched2</span></span> = <span class="hljs-string"><span class="hljs-string">"SamIRetrievePrimaryCredentials"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched3</span></span> = <span class="hljs-string"><span class="hljs-string">"SamIRetrieveMultiplePrimaryCredentials"</span></span> condition: all of them } rule skeleton_key_injected_code { strings: <span class="hljs-variable"><span class="hljs-variable">$injected</span></span> = { 33 C0 85 C9 0F 95 C0 48 8B 8C 24 40 01 00 00 48 33 CC E8 4D 02 00 00 48 81 C4 58 01 00 00 C3 } <span class="hljs-variable"><span class="hljs-variable">$patch_CDLocateCSystem</span></span> = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B FA 8B F1 E8 ?? ?? ?? ?? 48 8B D7 8B CE 48 8B D8 FF 50 10 44 8B D8 85 C0 0F 88 A5 00 00 00 48 85 FF 0F 84 9C 00 00 00 83 FE 17 0F 85 93 00 00 00 48 8B 07 48 85 C0 0F 84 84 00 00 00 48 83 BB 48 01 00 00 00 75 73 48 89 83 48 01 00 00 33 D2 } <span class="hljs-variable"><span class="hljs-variable">$patch_SamIRetrievePrimaryCredential</span></span> = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 49 8B F9 49 8B F0 48 8B DA 48 8B E9 48 85 D2 74 2A 48 8B 42 08 48 85 C0 74 21 66 83 3A 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 14 E8 ?? ?? ?? ?? 4C 8B CF 4C 8B C6 48 8B D3 48 8B CD FF 50 18 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 } <span class="hljs-variable"><span class="hljs-variable">$patch_SamIRetrieveMultiplePrimaryCredential</span></span> = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 41 8B F9 49 8B D8 8B F2 8B E9 4D 85 C0 74 2B 49 8B 40 08 48 85 C0 74 22 66 41 83 38 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 12 E8 ?? ?? ?? ?? 44 8B CF 4C 8B C3 8B D6 8B CD FF 50 20 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 } condition: any of them }</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt481778/">https://habr.com/ru/post/pt481778/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt481768/index.html">Lidamos com o WebKit em 1C, por exemplo, a integra√ß√£o do TinyMCE em um formul√°rio gerenciado no UT 11.4</a></li>
<li><a href="../pt481770/index.html">Tony Brucker, pioneiro em programa√ß√£o de computadores, morre aos 94 anos</a></li>
<li><a href="../pt481772/index.html">Experi√™ncia VonmoTrade. Parte 2: Pedidos. Tipos, recursos de processamento</a></li>
<li><a href="../pt481774/index.html">Dicas de seguran√ßa: Patch virtual</a></li>
<li><a href="../pt481776/index.html">Servi√ßos de jogos 5G e na nuvem - teste como funciona em Moscou</a></li>
<li><a href="../pt481780/index.html">O MyOffice possui mais de 200 novos recursos</a></li>
<li><a href="../pt481782/index.html">Sobre os problemas do tradutor Python e repensar o idioma</a></li>
<li><a href="../pt481784/index.html">Como Kafka se tornou realidade</a></li>
<li><a href="../pt481786/index.html">Google enterra extens√£o IMAP do PHP</a></li>
<li><a href="../pt481788/index.html">An√°lise de solu√ß√£o de problemas reais da ind√∫stria (salvando leit√µes e outros)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>