<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüè≠ üëçüèª üßïüèΩ Agregar acciones a la gram√°tica PEG üìö üßîüèº üèë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La gram√°tica es a√∫n mejor si puede agregar (algunas) sem√°nticas de acuerdo con las reglas. En particular, para el analizador Python que estoy desarrol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Agregar acciones a la gram√°tica PEG</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471988/"><p>  La gram√°tica es a√∫n mejor si puede agregar (algunas) sem√°nticas de acuerdo con las reglas.  En particular, para el analizador Python que estoy desarrollando, necesito devolver un nodo AST de cada alternativa, ya que quiero seguir con la implementaci√≥n AST actual en CPython. </p><br><div class="spoiler">  <b class="spoiler_title">Contenido de la serie Python PEG Parser</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Analizadores de clavijas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Implementaci√≥n del analizador PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Generador de analizador PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Visualizaci√≥n del analizador PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gram√°tica de PEG recursiva izquierda</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Agregar acciones a la gram√°tica PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Meta gram√°tica para el analizador PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Implementando las caracter√≠sticas restantes de PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PEG en Core Developer Sprint</a> </li></ul></div></div><br><p> Muchas gram√°ticas usan una convenci√≥n que le permite agregar acciones a las reglas, generalmente un bloque de c√≥digo dentro de {llaves ".  M√°s precisamente, est√°n vinculados a alternativas.  El c√≥digo en este bloque est√° escrito en el mismo lenguaje que el resto del compilador, por ejemplo, en C, complementado por alguna capacidad de referirse a elementos en la alternativa.  En el <code>pgen</code> Python original, no <code>pgen</code> esta funcionalidad, pero para un nuevo proyecto me gustar√≠a implementarla. </p><a name="habracut"></a><br><p>  As√≠ es como lo hacemos para el generador de analizador simplificado que estoy desarrollando como parte de esta serie de publicaciones. </p><br><p>  La sintaxis de las acciones suele ser esta: </p><br><pre> <code class="plaintext hljs">rule: item item item { action 1 } | item item { action 2 }</code> </pre> <br><p>  Dado que esto hace que la gram√°tica sea m√°s detallada, los generadores de analizadores generalmente permiten reglas de varias l√≠neas, por ejemplo: </p><br><pre> <code class="plaintext hljs">rule: item item item { action 1 } | item item { action 2}</code> </pre> <br><p>  Esto hace que el analizador sea un poco m√°s complicado, pero es importante para la legibilidad, por lo que apoyar√© dicho registro. </p><br><p>  La eterna pregunta es cu√°ndo ejecutar este bloque.  En Yacc / Bison, esto se hace inmediatamente despu√©s de que el analizador reconoce la regla, ya que no hay reversi√≥n en la lista de tokens.  Ejecutar cada acci√≥n exactamente una vez significa que puede haber efectos secundarios globales (como actualizar la tabla de s√≠mbolos u otra estructura de datos del compilador). </p><br><p>  En los analizadores PEG con su retorno ilimitado a la lista de tokens, tenemos varias opciones: </p><br><ul><li>  No ejecute ninguna acci√≥n hasta que todo haya sido analizado.  No considerar√© esto, porque quiero construir un AST justo durante el an√°lisis. </li><li>  Realice siempre que se reconozca su alternativa.  Se requiere que su c√≥digo sea idempotente (es decir, que tenga el mismo efecto sin importar cu√°ntas veces se haya ejecutado).  Esto significa que la acci√≥n puede ejecutarse, pero su resultado finalmente puede descartarse. </li><li>  Guarde en cach√© el resultado y realice la acci√≥n solo por primera vez, cuando su alternativa se reconozca en esta posici√≥n. </li></ul><br><p>  Eleg√≠ la tercera opci√≥n: en cualquier caso, almacenamos en cach√© el resultado del m√©todo utilizando el algoritmo packrat, por lo que tambi√©n podemos almacenar en cach√© los resultados. </p><br><p>  En cuanto al contenido en {curlies}, por tradici√≥n usa el c√≥digo C con un acuerdo basado en <code>$</code> para referirse a elementos en una alternativa reconocida (por ejemplo, <code>$1</code> para referirse al primer elemento) y la asignaci√≥n <code>$$</code> para indicar el resultado de la acci√≥n.  Suena muy anticuado (tengo recuerdos del uso de la asignaci√≥n de funciones en Algol-60 para indicar el valor de retorno), por lo que lo har√© m√°s Pythonic: dentro de los corchetes deber√° poner una expresi√≥n, cuyo resultado ser√° el resultado de la acci√≥n, y los enlaces a los elementos ser√°n nombres simples que dan el texto del elemento.  Como ejemplo, aqu√≠ hay una calculadora simple que puede sumar y restar n√∫meros: </p><br><pre> <code class="plaintext hljs">start: expr NEWLINE { expr } expr: expr '+' term { expr + term } | expr '-' term { expr - term } | term { term } term: NUMBER { float(number.string) }</code> </pre> <br><p>  Vamos a ejecutarlo en el ejemplo de <code>100 + 50 - 38 - 70</code> .  √âl calcular√° la respuesta, porque  √©l reconoce las partes calculando <code>((100 + 50) - 38) - 70</code> , que por supuesto es <code>42</code> . </p><br><p>  Un peque√±o detalle: en la acci√≥n para el <code>term</code> <code>number</code> variable contiene un objeto <code>TokenInfo</code> , por lo que debe usar su atributo <code>.string</code> para obtener el token en forma de cadena. </p><br><p>  ¬øQu√© hacemos cuando una alternativa tiene m√∫ltiples ocurrencias con el mismo nombre de regla?  El generador de analizador le da a cada aparici√≥n un nombre √∫nico, agregando <code>1</code> , <code>2</code> , etc.  Para sucesos posteriores dentro de la misma alternativa.  Por ejemplo: </p><br><pre> <code class="plaintext hljs">factor: atom '**' atom { atom ** atom1 } | atom { atom }</code> </pre> <br><p>  La implementaci√≥n completa es bastante aburrida, por lo que no me gustar√≠a detenerme en ella.  Te invito a que busques en mi repositorio y juegues con el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> : </p><br><pre> <code class="plaintext hljs">python3.8 -m story5.driver story5/calc.txt -g story5.calc.CalcParser</code> </pre> <br><p>  ¬°La visualizaci√≥n ahora le permite moverse hacia adelante y hacia atr√°s usando las teclas de flecha izquierda y derecha! </p><br><p>  Licencia para este art√≠culo y c√≥digo citado: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CC BY-NC-SA 4.0</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471988/">https://habr.com/ru/post/471988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471976/index.html">¬øC√≥mo consigue un especialista de TI un trabajo en el extranjero?</a></li>
<li><a href="../471978/index.html">No podemos confiar solo en los sistemas de inteligencia artificial basados ‚Äã‚Äãen el aprendizaje profundo</a></li>
<li><a href="../471980/index.html">Estafadores telef√≥nicos. Acto cuatro, final ...</a></li>
<li><a href="../471982/index.html">Discutiendo el futuro de PHP</a></li>
<li><a href="../471986/index.html">Gram√°tica de PEG recursiva izquierda</a></li>
<li><a href="../471990/index.html">Meta gram√°tica para el analizador PEG</a></li>
<li><a href="../471992/index.html">Implementando las caracter√≠sticas restantes de PEG</a></li>
<li><a href="../471994/index.html">Trabajar en PEG en Core Developer Sprint</a></li>
<li><a href="../471998/index.html">F # 10: listas</a></li>
<li><a href="../472000/index.html">"Es fundamental para la comunidad establecer est√°ndares": Marchin Moskala sobre Kotlin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>