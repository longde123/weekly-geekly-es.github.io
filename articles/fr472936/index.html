<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👧‍👧 😥 👦🏻 Opération TA505: regroupement de l'infrastructure réseau. 3e partie 👼 🎍 👧🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'analyse de l'infrastructure réseau joue un rôle important dans l'étude des campagnes malveillantes. Les informations sur les adresses IP corresponda...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Opération TA505: regroupement de l'infrastructure réseau. 3e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/472936/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/62a/aa0/0c2/62aaa00c24efe0e4797c29ebcff2e241.jpg" alt="image"></a> <br><br>  L'analyse de l'infrastructure réseau joue un rôle important dans l'étude des campagnes malveillantes.  Les informations sur les adresses IP correspondant à un nom de domaine à différents intervalles vous permettent d'identifier de nouveaux serveurs attaquants.  La résolution du problème opposé (une rétrospective des domaines résolus à une adresse IP donnée) donne de nouveaux domaines pour lesquels vous pouvez répéter la procédure de recherche, faisant tourner la chaîne de plus en plus loin.  Toutes les informations obtenues permettent de se faire une idée de la géographie des nœuds, de mettre en évidence les hébergeurs et registraires «favoris» et de noter les valeurs caractéristiques des champs que l'attaquant indique lors de son enregistrement du domaine suivant. <br><br>  À première vue, des méta-informations inutiles peuvent être utiles après quelques jours, semaines et même mois.  En effet, au cours de l'analyse des malwares, se pose tôt ou tard la question de l'attribution, de l'appartenance d'un instrument à un groupe criminel particulier: et ici tous les signes indirects viennent à l'aide, y compris les données sur les indicateurs de réseau. <br><br>  Dans cet article, nous examinerons les caractéristiques les plus caractéristiques de l'infrastructure du réseau TA505 et montrerons les intersections avec un autre groupe de pirates, Buhtrap. <a name="habracut"></a><br><br><h2>  Bureaux d'enregistrement de noms de domaine </h2><br>  Au total, nous avons analysé 372 domaines du groupe et identifié 22 organisations qui fournissent des services d'acquisition de noms de domaine.  Les ressources suivantes ont été d'un grand intérêt pour les attaquants: <br><br><ul><li>  WhoisGuard, Inc.  - 28 noms de domaine, </li><li>  Eranet International Limited - 26 noms de domaine. </li></ul><br>  L'organisation panaméenne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WhoisGuard</a> offre la possibilité de cacher leurs données d'enregistrement au public.  Ce n'est en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aucun</a> cas le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premier cas d'</a> utilisation des services de cette société pour anonymiser et compliquer les enquêtes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cf/c1b/bd9/8cfc1bbd9346e5e8b9b23f3008b525d7.jpg" alt="image"><br><br>  <i>Distribution des domaines TA505 enregistrés à l'aide du service WhoisGuard par les familles de malwares du groupe</i> <br><br>  En outre, nous avons constaté l'utilisation d'autres services similaires - PROTECTSERVICE, LTD, Whois Privacy Protection Foundation, Domains by Proxy, LLC - mais dans une moindre mesure. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Eranet International Limited</a> est l'un des plus grands bureaux d'enregistrement de Hong Kong.  Il convient de noter que lors de l'enregistrement de la plupart des domaines auprès de ce fournisseur, les attaquants ont utilisé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le DNS dynamique</a> - en conséquence, les adresses IP auxquelles le nom de domaine a été résolu ont changé très souvent, ce qui rend difficile la recherche de traces supplémentaires. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/ca5/b7c/e8aca5b7c0b10afc53b893afb74a92e3.jpg" alt="image"><br><br>  <i>La distribution des domaines TA505 enregistrés à l'aide du service Eranet International Limited par les familles de malwares du groupe</i> <br><br><h2>  Titulaires de noms de domaine </h2><br>  Lors de l'étude des informations WHOIS des noms de domaine dans certains cas, il a été possible d'obtenir des valeurs uniques pour certains champs. <br><br>  Informations WHOIS du nom de domaine du groupe TA505: <br><br><img src="https://habrastorage.org/webt/fl/lx/ar/fllxarhuijeyaveiyb_gzzqzgfm.png"><br><br>  Bien sûr, tous les domaines ne peuvent pas faire confiance aveuglément.  Cependant, les valeurs de certains d'entre eux peuvent fournir des informations intéressantes.  Par exemple, par e-mail à <b>ctouma2@gmail.com,</b> vous pouvez accéder à la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">liste des</a> autres domaines enregistrés avec la même valeur.  Une autre boîte aux lettres <b>0141.koppe.pan@gmail.com</b> mène à de nombreuses ressources différentes: un compte sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Steam</a> , le forum de hacker japonais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Qiita</a> avec un lien vers un domaine malveillant dans le profil, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la chaîne YouTube</a> , le compte Skype (en direct: 141.koppe. pan), etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c7/9ba/a39/8c79baa39e2887fcb36bf43ea842c1a2.jpg" alt="image"><br><br>  <i>Page d'enregistrement de domaine suspect sur le forum des pirates Qiita</i> <br><br>  Nous laisserons une analyse approfondie des données WHOIS au-delà de la portée de cet article.  Nous notons seulement que les attaquants ont souvent recours à des ressources légitimes piratées pour héberger des logiciels malveillants dans un premier temps.  Voici des exemples de tels domaines: <br><br><ul><li>  greenthumbsup [.] jp </li><li>  fakers.co [.] jp </li><li>  nanepashemet [.] com </li><li>  nagomi-753 [.] jp </li><li>  iluj [.] dans </li></ul><br><h2>  Systèmes autonomes (AS) </h2><br>  Par souci d'exhaustivité, nous donnons le dessus des systèmes autonomes (AS), qui possèdent les adresses IP des serveurs de gestion.  Bien sûr, un seul système autonome possède de nombreux hôtes: légitimes et non, y compris diverses familles de malwares d'origines très différentes.  Les statistiques ci-dessous doivent être comprises comme une caractéristique des préférences de l'attaquant.  Associé à d'autres faits, il peut être important pour l'attribution. <br><br>  Systèmes autonomes souvent utilisés par le groupe TA505: <br><br><img src="https://habrastorage.org/webt/qw/l6/5y/qwl65ykvpoanzfvn4siffg0uzem.png"><br><br><h2>  Intersection avec Buhtrap Group </h2><br>  Le 11 juillet 2019, nos collègues d'ESET ont publié <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article</a> sur une récente attaque du groupe Buhtrap utilisant une vulnérabilité zero-day dans le composant Windows Win32k.  L'un des modules décrits était le soi-disant module de saisie pour voler les mots de passe des utilisateurs des clients de messagerie, des navigateurs, etc. Après un certain temps, nous avons trouvé un module similaire au décrit (MD5: c6e9d7280f77977a6968722e8124f51c) avec le même serveur de gestion dans le corps (redmond.corp- microsoft [.] com). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1d/2a8/537/b1d2a8537215501e256a0af7a0614ecb.jpg" alt="image"><br><br>  <i>Gestion du serveur dans le module de saisie Buhtrap</i> <br><br>  Selon la ressource <a href="">PaSiveTotal</a> , cet hôte se résout à l'adresse IP 95 [.] 179.159.170 à partir du 6 juin 2019. <br><br>  Un peu plus tôt, le 2 juillet 2019, nos collègues de Proofpoint ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rendu compte</a> des nouveaux outils du groupe TA505, dont l'un s'appelle Andromut (également <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">connu</a> sous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le</a> nom de Gelup) et est le chargeur de démarrage FlawedAmmyy RAT.  L'une des variantes du chargeur de démarrage (MD5: 0cbeb424d96e5c268ec2525d603f64eb) que nous avons rencontrées utilise le domaine Net compatexchange-cloudapp [.] Comme serveur de gestion. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cb/414/26a/6cb41426af25ba135796772487c350ac.jpg" alt="image"><br><br>  <i>Serveur de gestion Gelup de TA505 après déchiffrement</i> <br><br>  Selon <a href="">la</a> ressource PaSiveTotal, cet hôte se résout à l'adresse IP 95 [.] 179.159.170 à partir du 8 juin 2019. <br><br>  Les deux domaines sont enregistrés auprès du même registraire (Tucows Domains Inc.) avec une différence de deux jours, se résolvant à la même adresse IP.  Compte tenu du fait que les deux groupes ont mené des attaques régulières en juin, nous concluons que Buhtrap et TA505 utilisent un hôte commun comme serveur de gestion. <br><br>  Nous ajoutons que le domaine compatexchange-cloudapp [.] Net a été utilisé non seulement dans le chargeur de démarrage ci-dessus, mais aussi dans les anciennes versions des composants Buhtrap. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/232/bf8/cd3/232bf8cd3aade1f7bc858671124e3536.jpg" alt="image"><br><br>  <i>La première intersection de TA505 et Buhtrap dans l'infrastructure</i> <br><br>  Après un certain temps, nous avons rencontré une autre intersection similaire: cette fois, les domaines d'un autre grabber de Buhtrap et du chargeur de fumée de TA505 se sont rencontrés de la même manière: domaine test-service012505 [.] Com Smoke Loader (MD5: 5fc6f24d43bc7ca45a81d159291955d1) et télémétrie sécurisée [. ] net grabber (MD5: 79d1a836423c7ee57b6127cf2930a9d9) des 17 et 16 juillet 2019, respectivement, sont résolus à l'adresse IP 194 [.] 4.56.252. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/19c/d1f/e23/19cd1fe236f22164d0b33d0af9a0e851.jpg" alt="image"><br><br>  <i>La deuxième intersection de TA505 et Buhtrap dans l'infrastructure</i> <br><br><h2>  Conclusions </h2><br>  Nous avons pris connaissance des caractéristiques de l'infrastructure réseau du groupe TA505.  Nous avons examiné les caractéristiques des bureaux d'enregistrement et des hébergeurs de noms de domaine pour les serveurs de gestion.  Nous avons noté les caractéristiques curieuses des informations client spécifiées lors de l'enregistrement du domaine;  cela peut servir de point de départ pour des recherches plus détaillées.  Nous avons examiné les intersections des infrastructures entre les groupes TA505 et Buhtrap.  La situation avec les serveurs partagés peut s'expliquer de différentes manières: les groupes peuvent partager des serveurs par accord;  les groupes peuvent avoir une seule entité de gestion coordonnant leurs actions;  les deux groupes peuvent louer des serveurs à des tiers (et ceux-ci, à leur tour, économisent sur les ressources).  Nous continuerons de surveiller l'activité des deux groupes et chercherons de nouvelles informations sur leurs connexions possibles et leurs activités conjointes. <br><br>  <b>Auteurs</b> : Alexey Vishnyakov et Maxim Anfinogenov, Positive Technologies <br><br><div class="spoiler">  <b class="spoiler_title">CIO</b> <div class="spoiler_text">  TA505 C2: <br>  0141koppepan [.] Com <br>  bigpresense [.] top <br>  elast [.] pw <br>  fakers.co [.] jp <br>  greenthumbsup [.] jp <br>  iluj [.] dans <br>  kentona [.] su <br>  koppepan [.] app <br>  makosoft [.] hu <br>  microsoftsyncservice [.] biz <br>  nagomi-753 [.] jp <br>  nanepashemet [.] com <br>  espace [.] newfolder2-service <br>  office365onlinehome [.] com <br>  solsin [.] top <br>  test-service012505 [.] com <br>  fenêtres-plusieurs-mise à jour [.] com <br>  windows-update-02-fr [.] com <br>  c6e9d7280f77977a6968722e8124f51c - Module de saisie Buhtrap <br>  redmond.corp-microsoft [.] com - Grabber C&amp;C <br>  0cbeb424d96e5c268ec2525d603f64eb - Téléchargeur Gelup de TA505 <br>  compatexchange-cloudapp [.] net - Gelup C&amp;C <br>  95.179.159 [.] 170 - TA505 et Buhtrap Shared Host <br>  79d1a836423c7ee57b6127cf2930a9d9 - Module de saisie Buhtrap <br>  net-telemetry [.] net - Grabber C&amp;C <br>  5fc6f24d43bc7ca45a81d159291955d1 - Téléchargeur Smoke Loader de TA505 <br>  test-service012505 [.] com - Chargeur de fumée C&amp;C <br>  194 [.] 4.56.252 - TA505 et Buhtrap Shared Host </div></div><br><h3>  Articles précédents de la série: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Opération TA505: comment nous avons analysé les nouveaux outils des créateurs du cheval de Troie Dridex, Locky ransomware et Neutrino botnet</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Opération TA505, deuxième partie: apprentissage de la porte dérobée ServHelper avec NetSupport RAT</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472936/">https://habr.com/ru/post/fr472936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472926/index.html">La loi de l'accélération des retours (partie 1)</a></li>
<li><a href="../fr472928/index.html">Service informatique GPU très chargé</a></li>
<li><a href="../fr472930/index.html">Les astrophysiciens de la Silicon Valley quantifient la mode</a></li>
<li><a href="../fr472932/index.html">Analyse statique IntelliJ IDEA vs esprit humain</a></li>
<li><a href="../fr472934/index.html">Qu'est-ce qu'un Zero Trust? Modèle de sécurité</a></li>
<li><a href="../fr472940/index.html">À propos des escrocs et des gens</a></li>
<li><a href="../fr472944/index.html">Data as a Service: qu'est-ce que c'est, les difficultés techniques et comment les contourner en utilisant des proxy résidents</a></li>
<li><a href="../fr472948/index.html">Fonctionnement de FaceID sur iPhone X: algorithme Python</a></li>
<li><a href="../fr472950/index.html">10 façons de protéger la propriété intellectuelle d'une startup informatique</a></li>
<li><a href="../fr472954/index.html">Diagramme de Gantt vs tableau Kanban</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>