<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåüèΩ ü§≥ ü§öüèº Eins zwei drei! Chatbot von Google Sheets am Beispiel eines PvP-Spiels f√ºr Alice üå∞ üëµüèæ üë©üèª‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alice faszinierte die Benutzer mit unerwartet hoher Sprachsynthese und Chat-Bot. Heute wird von ihr erwartet, dass sie √ºber n√ºtzliche F√§higkeiten und ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eins zwei drei! Chatbot von Google Sheets am Beispiel eines PvP-Spiels f√ºr Alice</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414213/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/je/rg/em/jergemafxw-e_63-gibe4edxyie.png"></div><br>  Alice faszinierte die Benutzer mit unerwartet hoher Sprachsynthese und Chat-Bot.  Heute wird von ihr erwartet, dass sie √ºber n√ºtzliche F√§higkeiten und interessante Spiele mit einem Backend verf√ºgt, das den Kontext des Benutzers ber√ºcksichtigt und eine Vielzahl von Szenarien implementiert.  In diesem Artikel wird die Erstellung einer F√§higkeit beschrieben, die auf Google Sheets basiert, einem Tool, das vielen bekannt ist und ein gro√ües Potenzial f√ºr kleine Chatbots bietet. <br><br>  Das Spielen mit einer realen Person kann interessanter sein als das Spielen mit einem virtuellen Charakter. Als Beispiel werden wir ein Multiplayer-Spiel f√ºr Alice entwickeln. <br><a name="habracut"></a><br><h2>  Eins!  Dialog </h2><br>  Das Spiel beginnt mit den Regeln.  Ich habe mir Folgendes ausgedacht: Jeder der beiden Spieler platziert zuerst einen Schatz und eine Falle hinter drei T√ºren und √∂ffnet dann eine der T√ºren des Gegners.  √ñffne den Schatz - nimm die M√ºnzen des Gegners, √∂ffne die Falle - gib ihm die M√ºnzen.  Die Anzahl der M√ºnzen von 1 bis 3 wird vom Spieler selbst festgelegt.  Hinter der verbleibenden T√ºr befindet sich eine B√ºchse der Pandora, in der Sie eine zuf√§llige Anzahl von M√ºnzen finden / verlieren k√∂nnen.  Sie k√∂nnen sowohl mit Alice als auch gegen andere Benutzer spielen. <br><br>  Alices Oberfl√§che wird in Form eines Dialogs gel√∂st, und alle Spielinteraktionen sollten durch Messaging implementiert werden.  Die Verarbeitung jeder Nachricht durch den Spielserver wird durch die folgenden Schritte dargestellt: <br><br><ol><li>  Benutzerkontext wiederherstellen; </li><li>  Abfrageinterpretation in einem wiederhergestellten Kontext; </li><li>  Bilden einer Antwortnachricht; </li><li>  Speichern eines ge√§nderten Benutzerkontexts. </li></ol><br><h3>  Stellen Sie den Benutzerkontext wieder her und speichern Sie ihn </h3><br>  Der Kontext des Benutzers umfasst seinen Status im Spiel, einschlie√ülich vorheriger Ergebnisse, einen Schritt innerhalb des Skripts und des aktuellen Gegners sowie den Benutzernamen und andere Informationen, die f√ºr die Spiellogik erforderlich sind. <br><br>  Bei jeder Anforderung √ºbergibt Alice <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gem√§√ü dem Protokoll</a> die Benutzer-ID.  Dies reicht aus, um den Kontext zu speichern und anschlie√üend wiederherzustellen. <br><br>  Nehmen Sie als Data Warehouse Google Sheets.  Die objektiven Vorteile dieser L√∂sung sind freie Nutzung, Sichtbarkeit und Benutzerfreundlichkeit.  Mit dem integrierten Skripteditor k√∂nnen Sie die Logik des Spiels in Apps Script (basierend auf JavaScript) unter Bezugnahme auf die API-Tabellen beschreiben und als Webanwendung ver√∂ffentlichen. <br><br>  Nachdem Sie die Tabelle mit den erforderlichen √úberschriften erstellt haben, k√∂nnen Sie zum Skripteditor wechseln: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jd/rh/bo/jdrhbosnzge_mq5ms5h0oqnsnqo.png"></div><br>  Die Logik des Spiels kann in einem Projekt in Apps Script beschrieben werden, das als Satz von gs-Dateien organisiert wird, und mit der Ver√∂ffentlichung fortfahren: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nk/w0/kn/nkw0kn0ghmmskohgbtk_nefgc3o.png"></div><br>  Bei der Ver√∂ffentlichung m√ºssen Sie die Verf√ºgbarkeit der Anwendung f√ºr anonyme Benutzer angeben: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g1/sw/fq/g1swfqcp998ufhh96b6lvqb64x0.png"></div><br>  Bei der Ausgabe erhalten Sie die URL der ver√∂ffentlichten Webanwendung.  Die Funktionen doGet () und doPost () im Skript verarbeiten Anforderungen der entsprechenden Typen, um Benutzerkontexte zu empfangen und zu speichern. <br><br>  Unten sehen Sie ein Diagramm der Arbeit mit den API-Tabellen zur Datenmanipulation: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  var sheet = SpreadsheetApp.openById("&lt;id &gt;").getSheetByName("&lt; &gt;"); //  var range = sheet.getRange(&lt; &gt;); //   var values = range.getValues(); //    range.setValues(&lt; &gt;);</span></span></code> </pre> <br><h3>  Interpretieren einer Anforderung in einem wiederhergestellten Kontext </h3><br>  Im allgemeinen Fall erfordert die korrekte Interpretation von Textabfragen die Verwendung intelligenter NLU-Algorithmen.  Und obwohl solche Algorithmen in einfachen Werkzeugen wie dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von Aimylogic beschriebenen verf√ºgbar sind</a> , habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ich mich</a> in diesem Fall entschieden, die Verarbeitung nat√ºrlicher Sprache zugunsten der Einfachheit aufzugeben. <br><br>  Im vorgeschlagenen Spiel ist die Interaktion des Spielers mit Alice auf ein Dutzend m√∂gliche Zust√§nde beschr√§nkt und kann auf eine kleine Anzahl von Absichten reduziert werden.  Der Einfachheit halber biete ich dem Spieler immer drei m√∂gliche Aktionen an: Senden Sie "Eins", "Zwei" oder "Drei".  Bei jeder anderen Anfrage bittet Alice um Kl√§rung der Aktion. <br><br>  Das Szenario in diesem Fall beruht auf dem folgenden Apps-Skriptcode: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     switch(user.state){ case "start": //       switch(utterance){ case ‚Äú1Ô∏è‚É£ ‚Äù: case ‚Äú2Ô∏è‚É£ ‚Äù: case ‚Äú3Ô∏è‚É£ ‚Äù: //     default: //     } break; //    default: //      }</span></span></code> </pre><br>  F√ºr den Benutzer wird die so aufgel√∂ste Interaktion als Auswahl einer von drei Optionen dargestellt, deren Bedeutung in der Antwort jeder Alice klar definiert ist.  Die Optionen selbst werden durch die Schaltfl√§chen "Eins", "Zwei", "Drei" dargestellt, die das Gameplay erheblich beschleunigen. <br><br><h3>  Generierung von Antwortnachrichten </h3><br>  Alices Antwort besteht aus mehreren Teilen, von denen jeder gebildet werden muss, einschlie√ülich: <br><br><ul><li>  Text, der auf dem Bildschirm angezeigt werden soll; </li><li>  Text zur Sprachsynthese; </li><li>  Satz von Hinweiskn√∂pfen. </li></ul><br>  K√ºrzlich habe ich das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konzept eines EASY-Dialogs</a> formuliert und die Prinzipien f√ºr das Entwerfen einer Konversationsschnittstelle beschrieben, auch f√ºr Alice.  Das Antwortformat von Alice erm√∂glicht die Implementierung dieser Prinzipien. <br><br>  Durch die Trennung von angezeigtem und gesprochenem Text k√∂nnen Sie die Antworten pr√§ziser und nat√ºrlicher gestalten.  Sie k√∂nnen Alice nicht zwingen, Langtext zu synthetisieren, mit dem der Benutzer bereits vertraut ist, und Emoji im Nachrichtentext und im Namen der Schaltfl√§chen verwenden. <br><br>  Hinweisschaltfl√§chen setzen das Prinzip der Initiative um: Alice zeigt immer m√∂gliche Ma√ünahmen an und schl√§gt sie vor, um den Dialog fortzusetzen.  Im Szenario des vorgeschlagenen Spiels h√§ngt die Liste der Schaltfl√§chen nicht vom Kontext ab und wird jeder Nachricht hinzugef√ºgt. <br><br>  Wir haben also eine Google-Tabelle mit Benutzerdaten, die √ºber die URL der Webanwendung gespeichert und abgerufen werden.  Die Anwendung ist in Apps Script geschrieben, interpretiert die Aktion des Benutzers entsprechend seinem Kontext und generiert Daten f√ºr die Antwortnachricht. <br><br>  Es bleibt eine Verbindung zu Alice ... <br><br><h2>  Zwei!  Integration </h2><br>  Mit Yandex.Dialogs k√∂nnen Entwickler ihre F√§higkeiten zu Alice hinzuf√ºgen.  Das Verbinden einer Fertigkeit besteht aus drei Hauptaspekten: <br><br><ul><li>  Aktivierung; </li><li>  Design; </li><li>  Web-Haken. </li></ul><br><h3>  Aktivierung und Design </h3><br>  F√ºr die Aktivierung ist es wichtig, einen Satz zu w√§hlen, den Alice gut erkennt und der den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">formalen Anforderungen von</a> Yandex entspricht.  Wenn der Aktivierungsname Nummern enth√§lt, √ºberpr√ºfen Sie die Aktivierung separat, wenn Sie √ºber Tastatur und Sprache eingeben. <br><br>  Das Skill-Design enth√§lt einen Namen, eine Beschreibung, ein Symbol, eine Kategorie usw. <br>  Es ist zu beachten, dass in der Liste der F√§higkeiten im Katalog nur das Symbol und die Aktivierungsphrase angezeigt werden und die Suche im Katalog haupts√§chlich gem√§√ü der Beschreibung durchgef√ºhrt wird. <br><br><h3>  Einen Web-Hook bekommen </h3><br>  Ein Web-Hook ist die Adresse, an die Alice Nachrichten an Ihre F√§higkeiten sendet und auf eine JSON-Antwort im beschriebenen Format wartet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/za/zy/4t/zazy4tve59hnchb4quwuokqv6ju.png"></div><br><br>  Die in Apps Script erstellte Webanwendung gibt standardm√§√üig eine Antwort in Form einer HTML-Seite zur√ºck. Mit dem ContentService kann jedoch auch die R√ºckgabe von JSON erzwungen werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ContentService.createTextOutput(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">JSON</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml">)) .setMimeType(ContentService.MimeType.JSON);</span></span></code> </pre> <br>  Bei Verwendung von ContentService leitet Google die Benutzeranforderung jedoch an eine tempor√§re URL weiter, f√ºr die Yandex.Dialogs nicht bereit ist.  Daher ist die Adresse der Webanwendung als Web-Hook nicht geeignet. <br><br>  Es gibt kostenlose Dienste, die einen f√ºr Alice geeigneten Web-Hook anbieten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wie z. B. Zenbot</a> .  In Zenbot k√∂nnen Sie f√ºr das vorgeschlagene Spiel ein kurzes Skript schreiben, das auf eine Google-Webanwendung zugreift und eine Antwort zusammen mit Schaltfl√§chen zur√ºckgibt.  Auf diese Weise kann das Spiel √ºbrigens nicht nur in Alice, sondern auch in andere Kan√§le integriert werden. <br><br>  Unten finden Sie ein Beispielskript, das das Spiel "Eins, Zwei, Drei!"  im Telegrammbot @RazDvaTriBot: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">context</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pattern</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Text"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">var</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Utterance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">get</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://script.google.com/macros/s/&lt;id -&gt;/exec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">var</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Result"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userId"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$req_telegram_chat"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utterance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Utterance"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"channel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"telegram"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">get</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">var</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Answer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'javascript: $Result.text'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Answer"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sample</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sample</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">context</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  F√ºr eine gr√∂√üere Flexibilit√§t bei der Verarbeitung von Anforderungen k√∂nnen Sie Ihren eigenen Server beispielsweise mit Google App Engine schreiben.  Dieses Tool kann auch kostenlos verwendet werden. <br><br>  Nach dem Erstellen eines Projekts in der Google App Engine k√∂nnen Sie √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud Shell-</a> Oberfl√§che Servercode auf eine Webseite schreiben und unter der gew√ºnschten URL des Formulars https: // &lt;Projekt-ID&gt; .appspot.com bereitstellen, die die Adresse des Web-Hooks ist. <br><br>  Der Serverbetrieb besteht aus folgenden Schritten: <br><br><ol><li>  Empfangen von Anforderungsdaten von Alice; </li><li>  Interaktion mit der Webanwendung des Spiels; </li><li>  Senden einer Antwort in Alices Format. </li></ol><br><h4>  Alice-Daten empfangen / senden </h4><br>  Von Alice ist es wichtig, die Kennungen der Sitzung, des Benutzers, der Nachricht sowie den Text der Anforderung zu erhalten.  Unten ist ein Beispiel in PHP: <br><br><pre> <code class="php hljs"> $data = json_decode(file_get_contents(<span class="hljs-string"><span class="hljs-string">"php://input"</span></span>)); $session_id = $data-&gt;session-&gt;session_id; $user_id = $data-&gt;session-&gt;user_id; $utterance = $data-&gt;request-&gt;original_utterance; $messageId = $data-&gt;session-&gt;message_id;</code> </pre><br>  Als Antwort werden Hinweisschaltfl√§chen und Texte zur Anzeige und Aussprache an das Spiel zur√ºckgegeben: <br><br><pre> <code class="php hljs"> $button1 = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'1Ô∏è‚É£ '</span></span>, <span class="hljs-string"><span class="hljs-string">'hide'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $button2 = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'2Ô∏è‚É£ '</span></span>, <span class="hljs-string"><span class="hljs-string">'hide'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $button3 = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'3Ô∏è‚É£ '</span></span>, <span class="hljs-string"><span class="hljs-string">'hide'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $yaButtons = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($button1, $button2, $button3); $yaResponse = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'text'</span></span> =&gt; $text, <span class="hljs-string"><span class="hljs-string">'tts'</span></span> =&gt; $tts, <span class="hljs-string"><span class="hljs-string">'buttons'</span></span> =&gt; $yaButtons, <span class="hljs-string"><span class="hljs-string">'end_session'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); $yaSession = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'session_id'</span></span> =&gt; $session_id, <span class="hljs-string"><span class="hljs-string">'message_id'</span></span> =&gt; $messageId, <span class="hljs-string"><span class="hljs-string">'user_id'</span></span> =&gt; $user_id); $yaResult = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'response'</span></span> =&gt; $yaResponse, <span class="hljs-string"><span class="hljs-string">'session'</span></span> =&gt; $yaSession, <span class="hljs-string"><span class="hljs-string">'version'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'1.0'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> json_encode($yaResult);</code> </pre><br><h2>  Drei!  Synchronisieren </h2><br>  Das Senden / Empfangen von Daten aus einer Webanwendung nimmt Zeit in Anspruch, und Alice ist bestrebt, dem Benutzer eine Antwort zu geben, sodass Synchronisierungsprobleme die Angelegenheit beeintr√§chtigen. <br><br>  F√ºr gro√üe Projekte eignen sich Google Sheets nat√ºrlich nicht als Backend f√ºr Alice 'F√§higkeiten: Die Antwortzeit erh√∂ht sich mit einer gro√üen Anzahl paralleler Anfragen.  Dennoch gibt es Empfehlungen zur Optimierung des Chatbots, die es erm√∂glichen, ein kleines Projekt in einem interaktiven Echtzeit-Dialogsystem realisierbar zu machen. <br><br>  Zeitlimit f√ºr das synchrone Protokoll von Alice - 1,5 Sekunden pro Antwort.  Wenn der Server w√§hrend dieser Zeit keine Zeit hat, eine Antwort zu geben, sieht der Benutzer eine traurige Nachricht im Sinne von "Entschuldigung, &lt;Dialogname&gt; antwortet nicht".  Das System bietet keine Hinweise darauf, was als n√§chstes zu tun ist. <br><br>  Um eine solche Situation zu vermeiden, k√∂nnen und sollten Sie den Service beschleunigen sowie Zeit√ºberschreitungen verfolgen und verarbeiten.  Die langwierigsten Operationen w√§hrend der Operation des Spielskripts sind das Lesen und Schreiben von Tabellendaten.  Daher muss zum einen die Anzahl dieser Operationen minimiert werden, und zum anderen ist es w√ºnschenswert, sie zu parallelisieren. <br><br>  Lesen Sie die Tabellendaten einmal genug.  Nach dem Ausf√ºhren der Logik ist das Skript bereit, dem Benutzer unmittelbar vor dem Ende der Aufzeichnung der Ergebnisse eine Antwort zu geben. <br><br>  Es sollte eine begrenzte Zeit einger√§umt werden, um eine Antwort zu erhalten - zum Beispiel 1100 ms: <br><br><pre> <code class="php hljs"> $request_params = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'userId'</span></span> =&gt; $user_id, <span class="hljs-string"><span class="hljs-string">'utterance'</span></span> =&gt; $utterance, <span class="hljs-string"><span class="hljs-string">'channel'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'alice'</span></span> ); $get_params = http_build_query($request_params); $ctx = stream_context_create(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>=&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'timeout'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1.1</span></span> ) )); $answer = file_get_contents(<span class="hljs-string"><span class="hljs-string">'https://script.google.com/macros/s/&lt;id -&gt;/exec?'</span></span>. $get_params, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, $ctx);</code> </pre><br>  Wenn die Antwort rechtzeitig von der GET-Anforderung empfangen wird, k√∂nnen wir sie an den Benutzer senden und das Speichern der Ergebnisse durch die POST-Anforderung im Hintergrund initiieren.  Andernfalls geben wir dem Benutzer einen Stub-Text mit Schaltfl√§chen, um fortzufahren, und ignorieren die Ergebnisse des Skripts, damit der Benutzer seine Anforderung im aktuellen Kontext wiederholen kann. <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($answer === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { $text = <span class="hljs-string"><span class="hljs-string">' ,   .'</span></span>; $tts = <span class="hljs-string"><span class="hljs-string">',   .'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $answer = json_decode($answer); $text = $answer-&gt;text; $tts = $answer-&gt;tts; <span class="hljs-comment"><span class="hljs-comment">//   $data2store = $answer-&gt;data; $postdata = json_encode(array( 'data' =&gt; $data2store )); $opts = array('http' =&gt; array( 'method' =&gt; 'POST', 'header' =&gt; 'Content-Type: application/json', 'content' =&gt; $postdata, 'timeout' =&gt; 0.1 ) ); $context = stream_context_create($opts); file_get_contents("https://script.google.com/macros/s/&lt;id -&gt;/exec", false, $context); }</span></span></code> </pre><br><img src="https://habrastorage.org/webt/a1/ez/od/a1ezodgm9tqdt2gudd7vfes9bn0.png" width="320" align="right"><br>  In einem Multiplayer-Spiel f√ºr Alice m√ºssen Synchronisationsaufgaben sowohl zwischen den Spielservern und Yandex als auch zwischen den Spielern gel√∂st werden.  Wenn ein Spieler gegen einen anderen Benutzer spielen m√∂chte, w√§hlt das Spiel selbst einen Gegner aus - aus denen, die k√ºrzlich spielen wollten.  Benutzer m√ºssen ihre Bereitschaft best√§tigen, miteinander zu spielen, damit das Spiel beginnen kann. <br><br>  Derzeit kann die Fertigkeit das Senden einer Nachricht an Alices Benutzer nicht initiieren.  Daher bietet das Spielskript die M√∂glichkeit, die Bereitschaft des Gegners und die f√ºr die Spielrunde vorgesehenen Minuten zu √ºberpr√ºfen.  Wenn der Gegner das Spiel verz√∂gert, wird der Benutzer aufgefordert, auf ihn zu warten: "Warten Sie etwas l√§nger auf den Gegner?"  Durch die Zustimmung zum Warten startet der Benutzer eine weitere Pr√ºfung.  Wenn die Minute des Spiels endet, endet das Spiel. <br><br><h2>  Fazit </h2><br>  Zu den Vorteilen von Google Sheets als Backend f√ºr einen Chat-Bot, au√üer kostenlos, geh√∂rt die Tatsache, dass es sich w√§hrend der Entwicklung um ein Debugging-Tool handelt und danach zu einer Konsole f√ºr Skill-Administratoren wird, die alle Vorteile der kollaborativen Bearbeitung von jedem Ger√§t aus bietet.  Durch Nachteile - Verz√∂gerungen beim gleichzeitigen Betrieb einer gro√üen Anzahl von Benutzern. <br><br clear="right">  Ich hoffe, dieser Artikel hilft Enthusiasten und Entwicklern, schnell n√ºtzliche F√§higkeiten f√ºr Alice oder andere Kan√§le zu entwickeln.  Das vorgeschlagene Spiel ist im Yandex.Dialog Skills Store mit dem Namen ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">One, Two, Three!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Multiplayer-Spiel</a> . ‚Äú <br><br>  Neben Allzweck-Tools gibt es spezielle L√∂sungen f√ºr die Entwicklung von Chat-Bots.  Ich lade die Leser ein, an einer kleinen Umfrage zu den Dienstleistungen teilzunehmen, die ich in diesem Bereich kenne.  Die Liste enthielt nicht alle vorhandenen Produkte - ich bin dankbar f√ºr Kommentare mit Namen und kurzen Bewertungen, wenn Sie andere Tools verwendet haben. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414213/">https://habr.com/ru/post/de414213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414201/index.html">G√∂ttlicher Code (GOTTES Code)</a></li>
<li><a href="../de414203/index.html">Betrug oder nicht Betrug? Wir √ºberpr√ºfen ICO mit f√ºnf Methoden</a></li>
<li><a href="../de414207/index.html">Das Problem des Innovators oder warum Sie sich an die Erfahrungen anderer wenden m√ºssen</a></li>
<li><a href="../de414209/index.html">IGNG - Inkrementeller neuronaler Gas-Inkremental-Algorithmus</a></li>
<li><a href="../de414211/index.html">Entwicklung eines TELNET-Servers auf Basis von W5500 und ATMEGA8</a></li>
<li><a href="../de414215/index.html">Benutzerdefinierte Bl√∂cke in Chips (Silicon IP): So funktioniert es</a></li>
<li><a href="../de414217/index.html">Lokale Vertex-Smartphones: zuerst in der Qualit√§t, zuerst in den Chips, zuerst im Design</a></li>
<li><a href="../de414219/index.html">Die Erfahrung mit der Nutzung von Solarenergie in der Region Moskau: f√ºr, gegen und wer sie braucht</a></li>
<li><a href="../de414221/index.html">Analysieren und Arbeiten mit Codable in Swift 4</a></li>
<li><a href="../de414223/index.html">C #: Abw√§rtskompatibilit√§t und √úberlastung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>