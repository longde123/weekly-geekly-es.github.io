<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕞 🤰 👂🏻 Características RTC M41T56 🤹🏽 ❄️ ☸️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M41T56 es un chip de reloj de tiempo real, que es un análogo del popular DS1307. Y aunque incluso el pinout del microcircuito es el mismo, tienen dife...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Características RTC M41T56</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457796/">  M41T56 es un chip de reloj de tiempo real, que es un análogo del popular DS1307.  Y aunque incluso el pinout del microcircuito es el mismo, tienen diferencias significativas, de las que trataré de hablar. <br><a name="habracut"></a><br><h2>  Breve descripción </h2><br>  No me detendré en el funcionamiento del bus IIC, solo observo que ambos chips tienen la dirección 0xd0.  Para trabajar con el tiempo, el microcircuito contiene siete registros de cuenta y un registro de control.  Los registros de cuenta contienen números en formato decimal binario, sin embargo, algunos bits tienen un significado especial. <br><br>  <b>Registros</b> <br>  xxx: el valor de bit no está definido. <br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  funcion </th><th rowspan="2">  indice </th><th colspan="8">  pedacitos </th><th rowspan="2">  valores posibles </th></tr><tr><th>  7 7 </th><th>  6 6 </th><th>  5 5 </th><th>  4 4 </th><th>  3 </th><th>  2 </th><th>  1 </th><th>  0 0 </th></tr><tr><td>  segundos </td><td>  0x00 </td><td>  ST </td><td colspan="3">  decenas de segundos </td><td colspan="4">  unidades de segundos </td><td>  0 - 59 </td></tr><tr><td>  minutos </td><td>  0x01 </td><td>  xxx </td><td colspan="3">  decenas de minutos </td><td colspan="4">  unidades de minutos </td><td>  0 - 59 </td></tr><tr><td>  el reloj </td><td>  0x02 </td><td>  Seb </td><td>  SB </td><td colspan="2">  docenas de horas </td><td colspan="4">  unidades de horas </td><td>  0 - 23 </td></tr><tr><td>  dia </td><td>  0x03 </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td colspan="3">  dia de la semana </td><td>  1 - 7 </td></tr><tr><td>  dia del mes </td><td>  0x04 </td><td>  xxx </td><td>  xxx </td><td colspan="2">  docenas de dias </td><td colspan="4">  unidades del día </td><td>  1 - (28 | 29 | 30 | 31) </td></tr><tr><td>  mes </td><td>  0x05 </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td colspan="1">  des </td><td colspan="4">  unidades del mes </td><td>  1 - 12 </td></tr><tr><td>  año </td><td>  0x06 </td><td colspan="4">  decenas de años </td><td colspan="4">  unidades del año </td><td>  0 - 99 </td></tr><tr><td>  registro de control </td><td>  0x07 </td><td>  Fuera </td><td>  FT </td><td>  S </td><td colspan="5">  cantidad de corrección </td><td>  - </td></tr></tbody></table></div><br>  <b>Pedacitos</b> <br>  x - después de encender, el estado del bit puede ser cualquiera. <br><div class="scrollable-table"><table><tbody><tr><th>  un poco </th><th>  después de reiniciar </th><th>  la descripcion </th></tr><tr><td>  ST </td><td>  x </td><td>  Al escribir 1 en este bit, el generador se detiene </td></tr><tr><td>  CEB </td><td> x </td><td rowspan="2">  Cuando se establece el bit CEB (Century Enable Bit), cuando se alcanza un nuevo siglo, el bit CB (Century Bit) cambiará el valor a lo opuesto. </td></tr><tr><td>  CB </td><td>  x </td></tr><tr><td>  Fuera </td><td>  1 </td><td rowspan="2">  Cuando los bits OUT (nivel de salida) y FT (prueba de frecuencia) son iguales a cero, el pin FT / OUT se presiona contra el suelo.  Con FT = 1, la salida FT / OUT es 512 Hz y el bit OUT no importa. </td></tr><tr><td>  FT </td><td>  0 0 </td></tr><tr><td>  S </td><td>  x </td><td>  Marca de calibración de carrera RTC. </td></tr></tbody></table></div><br>  Las diferencias comienzan en la asignación de los bits 7, 6 y 5 del registro del reloj.  En el M41T56, los bits 7 y 6 se usan para indicar la transición al nuevo siglo, y los bits 5 y 4 se usan para contar decenas de horas.  Además, el recuento de horas solo es posible en el modo 24, el modo AM / PM no está disponible.  En DS1307, el bit 7 no se usa, un cero en el bit 6 indica que se usa el modo de conteo 24, y en este caso, los bits 5 y 4 contienen decenas de horas.  Si el bit 6 es uno, entonces el bit 5 se convierte en el indicador AM / PM, y el bit 4 contiene decenas de horas. <br><br>  Hay diferencias significativas en el registro de control, que contiene el trazo de corrección de palabra. <br><br><h2>  Corrección del curso </h2><br>  M41T56 le permite compensar el error del resonador de cuarzo en el rango de -62 a +124 ppm, lo que proporciona una desviación de no más de ± 5 segundos por mes.  Para la compensación, los seis bits menos significativos del registro de control son responsables.  Los bits 4-0 contienen un número entero sin signo del valor de corrección, y el bit 5 establece la dirección de corrección.  Si el bit 5 contiene cero, la carrera se ralentiza en incrementos de 2.034 ppm, de lo contrario, RTC se acelera en incrementos de 4.068 ppm.  Esto es inconveniente, por lo que esbocé un par de funciones simples para convertir de ppm a palabra de corrección y viceversa. <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/*        . */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MASK_CALIBR ((1 &lt;&lt; 4) | (1 &lt;&lt; 3) | (1 &lt;&lt; 2) | (1 &lt;&lt; 1) | (1 &lt;&lt; 0)) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*        . */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MASK_CALIBR_SIGN (1 &lt;&lt; 5) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/** *    . * @param caliber    RTC. * @return    ppm. */</span></span></span><span class="hljs-meta"> int8_t caliber_to_ppm(uint8_t caliber) { int8_t result = caliber &amp; MASK_CALIBR; result = (uint8_t) result * 2; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ((caliber &amp; MASK_CALIBR_SIGN) != 0) { result = -result; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { result = (uint8_t) result * 2; } return result; } </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/** *   . * @param ppm    ppm. * @return    RTC. */</span></span></span><span class="hljs-meta"> uint8_t ppm_to_caliber(int8_t ppm) { uint8_t result; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (ppm &lt; 0) { result = (uint8_t) (-ppm + 1) / 2; result |= MASK_CALIBR_SIGN; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { result = (uint8_t) (ppm + 2) / 4; } return result; }</span></span></code> </pre> <br><h2>  Detección de fallas </h2><br>  Ni DS1307, pero M41T56 pueden detectar errores de generación, pero garantizan que cuando se enciende la alimentación, algunos bits estarán en un cierto estado.  M41T56 cuando está habilitado en el registro de control será 10xxxxxx.  Para rastrear bloqueos de programa, puede usar el siguiente algoritmo.  Si, cuando se enciende el microcontrolador, el registro de control RTC contiene 10xxxxxx, entonces hubo una falla de energía y se debe escribir un valor en el registro cuyos bits altos no son iguales a 10. Lo más simple es escribir la palabra de corrección con los bits 7 y 6 iguales a cero. <br><br><h2>  Literatura </h2><br><ul><li>  Hoja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informativa M41T56</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DS1307</a> Hoja de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">datos</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457796/">https://habr.com/ru/post/457796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457776/index.html">Las minas en rendimiento están esperando en las alas: parte 2</a></li>
<li><a href="../457784/index.html">Calibración personalizada de Eye-Tracker</a></li>
<li><a href="../457786/index.html">Anet A8 Plus actualizado. Grande y metal</a></li>
<li><a href="../457790/index.html">BuratinoPhone Mobile Phone</a></li>
<li><a href="../457794/index.html">La propiedad de simetría de la relación de cointegración.</a></li>
<li><a href="../457798/index.html">¿Qué están haciendo los fondos de código abierto? Hablando de los proyectos recientes de OpenStack y Linux Foundation</a></li>
<li><a href="../457800/index.html">Vulnerabilidad crítica de MacOS Mojave explotada activamente por ciberdelincuentes</a></li>
<li><a href="../457804/index.html">ListenIt: extensión de Google Chrome para crear automáticamente versiones de audio de artículos</a></li>
<li><a href="../457808/index.html">Cámara termográfica Seek Thermal Compact</a></li>
<li><a href="../457810/index.html">Enfoque de ingeniería para el desarrollo de software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>