<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👯 🤲🏼 👨🏻‍🚒 Vivado: mode Picasso 🎇 ⛓️ 📜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anotasi 


 Madness All Ages Submissive 


 Saat mendesain modul apa pun pada FPGA, gagasan tentang tidak cukup standar penggunaan lingkungan desain i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vivado: mode Picasso</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477974/"><h2 id="annotaciya">  Anotasi </h2><br><p>  <em>Madness All Ages Submissive</em> </p><br><p>  Saat mendesain modul apa pun pada FPGA, gagasan tentang tidak cukup standar penggunaan lingkungan desain itu sendiri dan alat-alat yang disediakannya untuk desain terkadang terlintas dalam pikiran.  Dalam artikel singkat ini, kita akan melihat bagaimana, dengan bantuan alat manajemen lingkungan yang diterapkan pada Tcl, kita dapat benar-benar menggambar foto, lukisan, potret dan memeics pada FPGA. </p><br><p>  "Rute desain" yang tidak biasa seperti itu diterapkan satu setengah tahun yang lalu, tetapi baru sekarang idenya datang untuk mengaturnya dalam bentuk catatan, di mana ada sedikit praktik dalam menggunakan skrip Tcl untuk mengelola lingkungan desain, dalam hal ini Vivado.  Namun, dengan modifikasi kecil, semuanya dapat dengan mudah disesuaikan dengan lingkungan pengembangan lainnya, misalnya Quartus II. </p><br><p><img src="https://habrastorage.org/webt/32/h7/xr/32h7xruuubk_cai37jn18jgf8ca.png"></p><a name="habracut"></a><br><h2 id="vvedenie">  Pendahuluan </h2><br><p>  Tentu saja, gagasan itu tidak muncul entah dari mana.  Penampilannya dipromosikan oleh pekerjaan saya saat itu di proyek pemrosesan gambar dan manajemen aliran video di FPGA.  Itu terjadi pada semua orang bahwa ketika duduk mencari solusi untuk suatu masalah, setiap bid'ah terlintas dalam pikiran mengapa itu tidak bekerja atau bekerja persis sebagaimana mestinya, tetapi tidak seperti yang kita harapkan. </p><br><p>  Ketika memecahkan masalah, saya harus menggunakan salah satu alat dari lingkungan Vivado, yaitu, mewarnai komponen dan modul yang sesuai dalam proyek setelah penempatan dan melacak dan mengintip ke dalam grafik waktu tanpa akhir. </p><br><p>  Akibatnya, saya melukis beberapa blok logis yang dapat dikonfigurasi dari CLB dalam berbagai warna, dan saya sadar - ini adalah piksel dari gambar, jadi saya dapat mencoba menggambar apa utas gambarnya, mencocokkan setiap piksel dengan CLB berwarna sendiri? ... yah, itu dimulai </p><br><h2 id="chem-nam-pomozhet-tcl">  Bagaimana Tcl akan membantu kami? </h2><br><p>  Misalkan kita memiliki gambar kecil berukuran 100x100 piksel.  Sekarang anggaplah untuk mewarnai CLB, kita perlu melakukan dua hal: pilih CLB dan pilih warnanya.  Dalam gambar 100x100, kami memiliki 10.000 piksel dan melakukan pewarnaan seperti itu secara manual cukup membosankan, terutama karena tindakannya sama dan berulang.  Jadi, mengecat setiap CLB secara manual bukanlah suatu pilihan dan Anda harus menggunakan Tcl dan skrip.  Tapi dari mana harus memulai? </p><br><p>  Hal pertama yang terlintas dalam pikiran adalah menemukan tim yang tepat yang bertanggung jawab untuk memberikan warna pada elemen yang dipilih.  Untungnya, ketika melakukan tindakan secara manual, Vivado menampilkan perintah Tcl yang sesuai untuk konsol, dan tampaknya masalah pencarian harus diselesaikan secepat mungkin.  Namun, itu tidak ada di sana.  Vivado mengabaikan keluaran perintah untuk menyorot elemen yang dipilih, dan satu-satunya pilihan untuk menemukan perintah, dan saya benar-benar yakin itu harus dilakukan, adalah dengan terjun cepat ke dalam panduan Tcl yang tersedia di Vivado, dan ini hampir 2000 halaman [1]. </p><br><p>  Jangan putus asa, kata kunci "highlight" dengan cepat menemukan perintah yang sesuai, yang disebut highlight_objects.  Perintah ini menyoroti objek yang ditentukan atau dipilih dalam warna tertentu, ditentukan menggunakan opsi.  Opsi untuk perintah highlight_objects adalah sebagai berikut: </p><br><p>  - <em>color_index</em> - (opsional) nilai yang valid dari argumen opsi harus berupa angka dari 1 hingga 20. Warna di mana objek yang dipilih akan dicat ditentukan oleh nomor seri dari palet warna yang telah ditentukan, yang dapat ditemukan dalam Warna → Sorot di bagian menu Alat → Pengaturan . <br>  - <em>rgb</em> - (opsional) mengatur warna objek yang dipilih dalam format RGB <br>  - <em>warna</em> - (opsional) menyoroti objek yang dipilih dalam salah satu warna berikut: merah, hijau, biru, magenta, kuning, cyan dan oranye </p><br><p>  Opsi yang tersisa dari perintah berhubungan dengan pengaturan sistem dari perintah itu sendiri dan tidak akan berguna bagi kita.  Namun, ketika menggunakan perintah highlight_objects, perlu diingat bahwa dua atau lebih opsi pewarnaan tidak dapat diterapkan pada saat yang sama. <br>  Jelas, opsi yang menetapkan warna sewenang-wenang dalam format RGB cocok untuk tugas kita - opsi <em>rgb</em> </p><br><p>  Sekarang tidak buruk untuk mendapatkan nilai piksel dari gambar, tetapi saya tidak dapat menemukan gambar yang akan disajikan dalam format bitmap.  Membuka setiap file dengan editor teks, tidak mungkin menemukan garis dengan nilai piksel.  Tentu saja, saya tidak menulis program untuk mengkonversi gambar ke format bitmap, tetapi hanya naik Internet untuk mencari solusi yang sudah jadi.  Tidak terlalu lama untuk mencari.  Ternyata, tugas mengubah gambar ke format bitmap (yaitu, ketika kita melihat nilai-nilai piksel dari gambar yang tidak terkompresi) cukup relevan (mungkin, tugas tersebut diberikan kepada siswa-programmer sebagai pekerjaan rumah untuk pekerjaan laboratorium).  Pencarian singkat menghasilkan github, dari mana program Image2Bitmap diunduh [2]. </p><br><p>  Program ini membutuhkan input gambar dan menghasilkan nilai piksel dalam bentuk array s dengan nilai piksel heksadesimal dalam format RGB565.  Format ini mengatakan bahwa kode warna untuk komponen merah menggunakan 5 bit, hijau 6 bit dan biru 5 bit.  Ini ternyata cukup untuk bekerja.  Sekarang semua yang diperlukan adalah memetakan nilai yang diperoleh langsung ke bagian yang dicat (slice). </p><br><h2 id="vybor-plis">  Temukan FPGA </h2><br><p>  Semakin besar FPGA, semakin banyak sumber daya logis di dalamnya, dan oleh karena itu "bidang kreativitas" itu sendiri lebih besar dan gambar akan lebih jelas.  Harus segera dicatat bahwa "dekorasi" adalah proses yang agak lama dan dapat memakan waktu yang cukup lama, tergantung pada ukuran gambar.  Untuk pengujian, ada baiknya memilih FPGA dengan sedikit sumber daya.  Misalnya, keluarga Spartan-7.  Setelah pengujian, Anda dapat mengubah FPGA menjadi lebih "gemuk", misalnya, dari keluarga Ultrascale +. </p><br><ol><li><p>  Kami memulai Vivado dan kami membuat proyek </p><br></li><li><p>  Kami memilih kristal xc7s6cpga196-2, di mana kami akan menggambar gambar uji <br><br><img src="https://habrastorage.org/webt/vk/zj/do/vkzjdo6hklo098bevkxuz7qvjhu.png"></p><br></li><li><p>  Untuk menampilkan gambar, kita perlu membuka gambar kristal itu sendiri, namun, ini bisa dilakukan setelah tahap sintesis atau rumit.  Di Vivado, untuk ini kita perlu membuat modul dummy dalam bahasa apa pun. <br><br><img src="https://habrastorage.org/webt/nb/ss/7k/nbss7kzptxr8ify9ot4ctpijx8u.png"></p><br></li><li><p>  Tambahkan skrip ke proyek Tcl. <br>  a.  Untuk melakukan ini, buat file dengan ekstensi ".tcl" di folder dengan proyek, misalnya, "fpga_painter.tcl" <br><br><img src="https://habrastorage.org/webt/x9/k8/is/x9k8ismf9abat7cjtkl6kqto-lg.png"></p><br><p>  b.  Buka Vivado, dan tambahkan file ini ke proyek. <br><br><img src="https://habrastorage.org/webt/zs/we/gd/zswegdciaq_qyj-8x56ar2wfzom.png"></p><br><p>  c.  Setelah memperbarui hierarki proyek, buat file tidak aktif. <br><br><img src="https://habrastorage.org/webt/ut/h6/-p/uth6-puy3u6amils-egmrxs8cqo.png"></p><br></li><li><p>  Setelah membuat modul, itu akan muncul di jendela hierarki proyek dan tombol Open Elaborate Design akan tersedia untuk kita.  Dorong itu. <br><br><img src="https://habrastorage.org/webt/g8/cy/mk/g8cymkxi_hdpdwm32k7mld50t_s.png"></p><br></li><li><p>  Setelah membuka Desain Rumit, buka Window → Device.  Tampilan bidang FPGA kami akan muncul. <br><br><img src="https://habrastorage.org/webt/sz/_n/cd/sz_ncdlckd-5rqbvicyshqmulxu.png"></p><br></li><li><p>  Persiapan selesai, kami mulai menulis naskah. </p><br></li></ol><br><h2 id="opredelenie-parametrov-i-procedur">  Definisi parameter dan prosedur </h2><br><h3 id="testovoe-izobrazhenie">  Gambar uji </h3><br><p>  Pertama, mari kita debug algoritma / kode seperti itu pada gambar kecil, katakan 5x3, dan kemudian jalankan "secara maksimal." </p><br><ol><li><p>  Buka Paint, batasi bidang gambar hingga 5x3 piksel (Anda dapat mengambil warna apa saja).  Simpan file sebagai "5x3.png" <br><br><img src="https://habrastorage.org/webt/nh/vg/l6/nhvgl6sub5ywa74hvrn-p5xq8hm.png"></p><br></li><li><p>  Buka program Image2Bitmap dan ubah gambar kami menjadi array RGB565. <br><br><img src="https://habrastorage.org/webt/aq/vb/u9/aqvbu9m6zhzrjakwux_1clytapk.png"></p><br></li><li><p>  Setelah konversi, program akan memberi kita array 15 piksel </p><br></li></ol><br><pre><code class="plaintext hljs">*uint16_t image = { 0xf800, 0x07e0, 0x001f, 0x8410, 0x8010, 0xfbe4, 0xff80, 0x2589, 0x051d, 0x3a59, 0xa254, 0xbbca, 0xfd79, 0xef36, 0x9edd, };*</code> </pre> <br><h3 id="podgotovka-dannyh">  Persiapan data </h3><br><p>  Sebelum melanjutkan dengan pemrosesan piksel, kami mengubah data yang dihasilkan oleh Image2Bitmap menjadi daftar sederhana di mana nilai piksel heksadesimal ditulis.  Kami akan menyalin data program dan menyimpannya ke file pic_array.dat, yang seharusnya berada di folder proyek. </p><br><p><img src="https://habrastorage.org/webt/1b/xm/dj/1bxmdjjzyzhrqxqchlngx8qmpiu.png"></p><br><p>  Saat memulai skrip yang dibuat, kita harus memproses file "pic_array.dat".  Perlu dicatat bahwa jumlah elemen dalam baris yang dikembalikan oleh Image2Bitmap tidak cocok dengan jumlah piksel pada garis gambar yang dikonversi, untuk alasan ini kami akan membuat daftar "piksel" yang terpisah. </p><br><p><img src="https://habrastorage.org/webt/rj/xl/pc/rjxlpcpleobp3ekmfwp4z_sofe0.png"></p><br><p>  Saat membaca file, Anda harus mengabaikan baris pertama "uint16_t image = {" dan yang terakhir "};".  Untuk melewati baris pertama saat membaca file, kita cukup menempatkan baris membaca sebelum siklus membaca seluruh file. </p><br><p><img src="https://habrastorage.org/webt/p0/j0/cl/p0j0clka4-dt-ggaskumsj5zkd8.png"></p><br><p>  Setelah membaca seluruh file, kita akan melihat bahwa baris terakhir file “};” telah menjadi elemen daftar, yang hanya dihapus. </p><br><p><img src="https://habrastorage.org/webt/zm/sc/ao/zmscaotma7373mbpnknpxh4xn5m.png"></p><br><p>  Ini melengkapi formasi daftar dengan nilai pixel heksadesimal.  Sekarang mari kita mulai memprosesnya. </p><br><h3 id="opredelenie-razmera-izobrazheniya">  Ukuran Gambar </h3><br><p>  Sekali lagi, lihat bidang FPGA dan gambar.  Bidang FPGA dibagi menjadi beberapa bagian (SLICE), yang memiliki koordinat horizontal "X" dan "Y" vertikal yang sesuai.  Misalnya, SLICE_X6Y36. </p><br><p><img src="https://habrastorage.org/webt/hm/iz/du/hmizdutpp0x-mieimj5ma07rgnk.png"></p><br><p>  Gambar, pada gilirannya, memiliki piksel, juga dengan koordinat horizontal dan vertikal.  Saat overlay gambar pada FPGA, kita harus menggabungkan pixel kiri atas dengan bagian kiri atas FPGA.  Dalam hal ini, kristal yang dipilih memiliki bagian atas dengan koordinat X0Y49. </p><br><p><img src="https://habrastorage.org/webt/0h/ip/b-/0hipb-wldjghc-p2xs5-uafdtxe.png"></p><br><p>  Ukuran gambar akan ditentukan oleh jumlah bagian dalam FPGA secara horizontal dan vertikal.  Untuk kristal yang dipilih, koordinat horizontal bagian bervariasi dari X0 hingga X131, dan koordinat vertikal dari Y49 ke Y0.  Maka secara teoritis kita dapat menggambar gambar ukuran 132x50 pada kristal yang dipilih. </p><br><h3 id="nachalnye-parametry">  Parameter awal </h3><br><p>  Untuk meringkas: parameter awal skrip kami adalah: </p><br><ol><li><p>  X mulai posisi bagian: nama variabel start_x <br><br><img src="https://habrastorage.org/webt/l8/qr/gh/l8qrghklltffibctylxjcczbwqk.png"></p><br></li><li><p>  Bagian posisi awal pada sumbu y: nama variabel start_y <br><br><img src="https://habrastorage.org/webt/yf/23/kf/yf23kfl9uxrt5zekli3n16zpzew.png"></p><br></li><li><p>  Lebar Gambar (untuk gambar uji 5): variabel w <br><br><img src="https://habrastorage.org/webt/cs/oi/un/csoiunryjazlcstfmab_g3ee9r0.png"></p><br></li><li><p>  Tinggi gambar (untuk gambar uji adalah 3): variabel h <br><br><img src="https://habrastorage.org/webt/oz/d2/09/ozd209wjyznbgt2uvcb7fvrhd2c.png"></p><br></li></ol><br><h3 id="korrektirovka-cveta-piksela">  Penyesuaian warna piksel </h3><br><p>  Image2Bitmap menyediakan array piksel dalam format RGB565 sebagai angka 16-bit yang ditulis dalam format heksadesimal.  Kita harus: </p><br><ol><li><p>  Konversi nilai piksel ke format biner.  Ini dapat dilakukan dengan menggunakan prosedur hex2bin, yang dapat ditemukan di [3] <br><br><img src="https://habrastorage.org/webt/fv/su/mt/fvsumtam5vrnkkm0uucn5vx4brc.png"></p><br></li><li><p>  Cocokkan bit dengan komponen warna yang sesuai: <br>  • Komponen merah R [15:11] <br><br><img src="https://habrastorage.org/webt/tj/mh/2k/tjmh2k-ihvuroxwduqm6_ugqmxi.png"></p><br><p>  • Komponen hijau G [10: 5] <br><br><img src="https://habrastorage.org/webt/y6/g0/yd/y6g0ydaosk3gkzzlylaenkh_oxm.png"></p><br><p>  • Komponen biru B [4: 0] <br><br><img src="https://habrastorage.org/webt/3i/97/vh/3i97vhrm4ivfevdr-xqwjzi9bzg.png"></p><br></li></ol><br><p>  <em>Penjelasan: urutan diubah karena fakta bahwa prosedur hex2bin mengembalikan string di mana penomoran elemen dimulai dengan 0, yaitu, bit ke-15 sesuai dengan elemen ke-0 dari string, dan bit ke-0 sesuai dengan elemen ke-15 dari string.</em> </p><br><ol><li><p>  Ubah nilai komponen warna dari biner ke desimal.  Ini dapat dilakukan dengan menggunakan prosedur bin2dec, yang dapat ditemukan [3]: <br><br><img src="https://habrastorage.org/webt/hc/1n/em/hc1nemkiw4byzq2yc-vka0gckmq.png"><br><br><img src="https://habrastorage.org/webt/hi/td/uy/hitduy-sypn4d7bv7kidwic2g2m.png"></p><br></li><li><p>  Konversi nilai piksel dari format RGB565 ke RGB888, untuk tampilan gambar yang lebih halus.  Ini dilakukan dengan menggunakan dua daftar, yang dapat ditemukan dalam [4].  Cara kerjanya: <br>  • Resolusi komponen warna R dan B adalah 5 bit.  Mengambil nilai desimal komponen, kami membandingkannya dengan posisi nomor yang tertulis dalam daftar t5, dan nilai komponen berubah dengan nilai dalam tabel <br><br><img src="https://habrastorage.org/webt/lk/vw/_a/lkvw_abrbpyeylfdoggm5pbpxns.png"><br><br><img src="https://habrastorage.org/webt/ao/mw/tv/aomwtv2q6hz9bg-_lmszmig7euq.png"><br><br><img src="https://habrastorage.org/webt/uy/qh/16/uyqh16vi-qkh9vpfrzcovq-zugs.png"></p><br><p>  • Demikian pula untuk komponen G dan tabel t6 <br><br><img src="https://habrastorage.org/webt/ti/is/lh/tiislhhogy2om7xxhvj_676dm5s.png"><br><br><img src="https://habrastorage.org/webt/pa/bh/3d/pabh3dqnk_3sk3sn6zt5big0t0e.png"></p><br></li></ol><br><h3 id="opredelenie-nalichiya-sekcii">  Ketersediaan Bagian </h3><br><p>  Di dalam beberapa FPGA ada sumber daya khusus atau rongga yang dapat mengganggu penomoran berurutan dari koordinat bagian.  Misalnya, pada gambar di bawah ini Anda dapat melihat bahwa penomoran bagian terganggu (kristal xc7s50) <br><br><img src="https://habrastorage.org/webt/uq/er/yq/uqeryqyfckyqezufafrp-vrxbgi.png"></p><br><p>  Untuk alasan ini, sebelum pewarnaan, pertama-tama kita periksa keberadaan bagian tersebut.  Jika ada, maka cat, jika tidak ada, kemudian pergi ke piksel berikutnya <br><br><img src="https://habrastorage.org/webt/zx/a8/lt/zxa8lt_n0pb6o7s3ztrfozkuu2k.png"></p><br><h3 id="okrashivanie-sekcii">  Bagian pewarnaan </h3><br><p>  Bagian warna ditentukan, bagian diperiksa.  Sekarang warna perlu ditugaskan ke bagian menggunakan perintah highlight_objects: <br><br><img src="https://habrastorage.org/webt/5i/fv/lp/5ifvlpcm5e70ur9sg7mufhmh4e0.png"></p><br><h3 id="vektor-dvuhmernyy-massiv">  Vektor → Array Dua Dimensi </h3><br><p>  Pada awalnya, kami mengonversi data gambar menjadi daftar piksel, yang menyimpan pemindaian progresif gambar.  Untuk mengatur gambar, kami memperkenalkan dua variabel, x dan y, yang akan sesuai dengan posisi piksel dalam gambar.  Dengan membaca secara berurutan elemen-elemen dari daftar piksel, kami akan membentuk gambar menggunakan dua untuk loop: satu dengan jumlah garis, yang kedua dengan posisi piksel dalam garis <br><br><img src="https://habrastorage.org/webt/fk/pu/wa/fkpuwau81hpppxfxkgvvzuvdtr0.png"><br><br><img src="https://habrastorage.org/webt/hf/bj/jh/hfbjjhugkpxwqd2zdtrn0seyzse.png"></p><br><h3 id="polnyy-listing-skripta">  Daftar skrip lengkap </h3><br><div class="spoiler">  <b class="spoiler_title">Daftar Fpga_painter.tcl</b> <div class="spoiler_text"><pre> <code class="vhdl hljs">#https://tcl.tk/ #http://www.tune-it.ru/web/il/home/-/blogs/-rgb888-&lt;-&gt;-rgb565----- #https://github.com/FoxExe/Image2Bitmap/releases/tag/<span class="hljs-number"><span class="hljs-number">0.5</span></span> #        set start_x <span class="hljs-number"><span class="hljs-number">0</span></span>; # set start_y <span class="hljs-number"><span class="hljs-number">49</span></span>; # set w <span class="hljs-number"><span class="hljs-number">5</span></span>; #  (   ) set h <span class="hljs-number"><span class="hljs-number">3</span></span>; #  ( ) proc hex2bin hex { set t [list <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0001</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0010</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0011</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0100</span></span> \ <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0101</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0110</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0111</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">1001</span></span> \ a <span class="hljs-number"><span class="hljs-number">1010</span></span> b <span class="hljs-number"><span class="hljs-number">1011</span></span> c <span class="hljs-number"><span class="hljs-number">1100</span></span> d <span class="hljs-number"><span class="hljs-number">1101</span></span> e <span class="hljs-number"><span class="hljs-number">1110</span></span> f <span class="hljs-number"><span class="hljs-number">1111</span></span> \ A <span class="hljs-number"><span class="hljs-number">1010</span></span> B <span class="hljs-number"><span class="hljs-number">1011</span></span> C <span class="hljs-number"><span class="hljs-number">1100</span></span> D <span class="hljs-number"><span class="hljs-number">1101</span></span> E <span class="hljs-number"><span class="hljs-number">1110</span></span> F <span class="hljs-number"><span class="hljs-number">1111</span></span>] regsub {^<span class="hljs-number"><span class="hljs-number">0</span></span>[xX]} $hex {} hex <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">map</span></span> -nocase $t $hex] } proc bin2dec bin { #returns <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> equivalent <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> $bin set res <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$bin == <span class="hljs-number"><span class="hljs-number">0</span></span>} { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } elseif {[<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> match -* $bin]} { set sign - set bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $bin[set bin {}] <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>] } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { set sign {} } foreach i [split $bin {}] { set res [expr {$res*<span class="hljs-number"><span class="hljs-number">2</span></span>+$i}] } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $sign$res } ############### #RGB565 -&gt; RGB888 using tables set t5 [list <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">41</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-number"><span class="hljs-number">58</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-number"><span class="hljs-number">74</span></span> <span class="hljs-number"><span class="hljs-number">82</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span> <span class="hljs-number"><span class="hljs-number">99</span></span> <span class="hljs-number"><span class="hljs-number">107</span></span> <span class="hljs-number"><span class="hljs-number">115</span></span> <span class="hljs-number"><span class="hljs-number">123</span></span> <span class="hljs-number"><span class="hljs-number">132</span></span>\ <span class="hljs-number"><span class="hljs-number">140</span></span> <span class="hljs-number"><span class="hljs-number">148</span></span> <span class="hljs-number"><span class="hljs-number">156</span></span> <span class="hljs-number"><span class="hljs-number">165</span></span> <span class="hljs-number"><span class="hljs-number">173</span></span> <span class="hljs-number"><span class="hljs-number">181</span></span> <span class="hljs-number"><span class="hljs-number">189</span></span> <span class="hljs-number"><span class="hljs-number">197</span></span> <span class="hljs-number"><span class="hljs-number">206</span></span> <span class="hljs-number"><span class="hljs-number">214</span></span> <span class="hljs-number"><span class="hljs-number">222</span></span> <span class="hljs-number"><span class="hljs-number">230</span></span> <span class="hljs-number"><span class="hljs-number">239</span></span> <span class="hljs-number"><span class="hljs-number">247</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span>] set t6 [list <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> <span class="hljs-number"><span class="hljs-number">45</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span> <span class="hljs-number"><span class="hljs-number">57</span></span> <span class="hljs-number"><span class="hljs-number">61</span></span> <span class="hljs-number"><span class="hljs-number">65</span></span> <span class="hljs-number"><span class="hljs-number">69</span></span>\ <span class="hljs-number"><span class="hljs-number">73</span></span> <span class="hljs-number"><span class="hljs-number">77</span></span> <span class="hljs-number"><span class="hljs-number">81</span></span> <span class="hljs-number"><span class="hljs-number">85</span></span> <span class="hljs-number"><span class="hljs-number">89</span></span> <span class="hljs-number"><span class="hljs-number">93</span></span> <span class="hljs-number"><span class="hljs-number">97</span></span> <span class="hljs-number"><span class="hljs-number">101</span></span> <span class="hljs-number"><span class="hljs-number">105</span></span> <span class="hljs-number"><span class="hljs-number">109</span></span> <span class="hljs-number"><span class="hljs-number">113</span></span> <span class="hljs-number"><span class="hljs-number">117</span></span> <span class="hljs-number"><span class="hljs-number">121</span></span> <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-number"><span class="hljs-number">130</span></span> <span class="hljs-number"><span class="hljs-number">134</span></span> <span class="hljs-number"><span class="hljs-number">138</span></span>\ <span class="hljs-number"><span class="hljs-number">142</span></span> <span class="hljs-number"><span class="hljs-number">146</span></span> <span class="hljs-number"><span class="hljs-number">150</span></span> <span class="hljs-number"><span class="hljs-number">154</span></span> <span class="hljs-number"><span class="hljs-number">158</span></span> <span class="hljs-number"><span class="hljs-number">162</span></span> <span class="hljs-number"><span class="hljs-number">166</span></span> <span class="hljs-number"><span class="hljs-number">170</span></span> <span class="hljs-number"><span class="hljs-number">174</span></span> <span class="hljs-number"><span class="hljs-number">178</span></span> <span class="hljs-number"><span class="hljs-number">182</span></span> <span class="hljs-number"><span class="hljs-number">186</span></span> <span class="hljs-number"><span class="hljs-number">190</span></span> <span class="hljs-number"><span class="hljs-number">194</span></span> <span class="hljs-number"><span class="hljs-number">198</span></span>\ <span class="hljs-number"><span class="hljs-number">202</span></span> <span class="hljs-number"><span class="hljs-number">206</span></span> <span class="hljs-number"><span class="hljs-number">210</span></span> <span class="hljs-number"><span class="hljs-number">215</span></span> <span class="hljs-number"><span class="hljs-number">219</span></span> <span class="hljs-number"><span class="hljs-number">223</span></span> <span class="hljs-number"><span class="hljs-number">227</span></span> <span class="hljs-number"><span class="hljs-number">231</span></span> <span class="hljs-number"><span class="hljs-number">235</span></span> <span class="hljs-number"><span class="hljs-number">239</span></span> <span class="hljs-number"><span class="hljs-number">243</span></span> <span class="hljs-number"><span class="hljs-number">247</span></span> <span class="hljs-number"><span class="hljs-number">251</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span>] ############### #  .         set script_path [get_property DIRECTORY [get_projects *]] cd $script_path #       set fId [<span class="hljs-keyword"><span class="hljs-keyword">open</span></span> {pic_array.dat} r] # ,       set pixels [list ] #    .    gets $fId <span class="hljs-literal"><span class="hljs-literal">line</span></span> #  .     . <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> {[gets $fId <span class="hljs-literal"><span class="hljs-literal">line</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>} { set pixels [concat $pixels $<span class="hljs-literal"><span class="hljs-literal">line</span></span>] } #   pixels   <span class="hljs-string"><span class="hljs-string">"};"</span></span>,    Image2Bitmap set pixels [lrange $pixels <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>] #    pixels set pix_num <span class="hljs-number"><span class="hljs-number">0</span></span>; #      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> {set y <span class="hljs-number"><span class="hljs-number">0</span></span>} { $y &lt; $h } {incr y} { #    ( ) set Y [expr {$start_y - $y}] #    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> {set x <span class="hljs-number"><span class="hljs-number">0</span></span>} { $x &lt; $w } {incr x } { set pix_val [lindex $pixels $pix_num]; incr pix_num #   binary  set pix_bin [hex2bin $pix_val] ; #     set R_bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $pix_bin <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>] #    set R_dec [ bin2dec $R_bin ] #       t5 set R [lindex $t5 $R_dec] #       set G_bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $pix_bin <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>] set G [lindex $t6 [ bin2dec $G_bin ]] set B_bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $pix_bin <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>] set B [lindex $t5 [ bin2dec $B_bin ] ] #    set X [expr {$start_x + $x}] #,      set cond [get_sites <span class="hljs-string"><span class="hljs-string">"SLICE_X${X}Y${Y}"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$cond ne <span class="hljs-string"><span class="hljs-string">""</span></span>} { #  highlight_objects [get_sites <span class="hljs-string"><span class="hljs-string">"SLICE_X${X}Y${Y}"</span></span>] -rgb <span class="hljs-string"><span class="hljs-string">"$R $G $B"</span></span> } puts <span class="hljs-string"><span class="hljs-string">"X = $XY = $Y; $R $G $B"</span></span> } } close $fId puts <span class="hljs-string"><span class="hljs-string">"Complete::Check FPGA field::Window-&gt;Device"</span></span></code> </pre> </div></div><br><h2 id="testirovanie">  Pengujian </h2><br><ol><li><p>  Untuk memulai pengujian, pastikan bidang FPGA tersedia untuk Anda, yaitu  salah satu tahap desain terbuka: diuraikan, disintesis, atau diimplementasikan.  Untuk menampilkan bidang FPGA, pilih Jendela → Perangkat <br><br><img src="https://habrastorage.org/webt/sz/_n/cd/sz_ncdlckd-5rqbvicyshqmulxu.png"></p><br></li><li><p>  Buka file pic_array.dat dan salin data dari Image2Bitmap ke dalam file.  Simpan file <br><br><img src="https://habrastorage.org/webt/gf/bo/qk/gfboqkmege_xbatauuqznugutls.png"></p><br></li><li><p>  Mari kita buka skripnya.  Atur koordinat piksel kiri atas 0 dan 49, ukuran gambar uji adalah 5 kali 3, dan jalankan skrip.  Untuk melakukan ini, klik kanan pada bidang skrip dan pilih Jalankan. <br><br><img src="https://habrastorage.org/webt/z6/ku/xk/z6kuxks3efxqgcg6w-ml18pwaic.png"></p><br></li><li><p>  Pergi ke konsol Tcl dan pastikan skrip telah dieksekusi. <br><br><img src="https://habrastorage.org/webt/km/of/qr/kmofqrtlejamixfiwexviemy4ay.png"></p><br></li><li><p>  Buka tab Perangkat dan pastikan sel-selnya diwarnai dengan warna yang sesuai. <br><br><img src="https://habrastorage.org/webt/xv/ba/nf/xvbanfmjcmx9lqxxofnq04wxwf0.png"></p><br></li><li><p>  Sekarang kita dapat mengambil gambar apa saja, mengonversinya ke ukuran yang diinginkan dan mengisi bidang FPGA.  Di bawah ini adalah beberapa contoh. </p><br></li></ol><br><p>  <em>PS: penetapan warna khusus menggantikan pengaturan warna default Vivado</em> <br><br><img src="https://habrastorage.org/webt/oz/hx/f4/ozhxf4slhbnycmhqmpfxbsb7fby.png"></p><br><h2 id="spisok-literatury">  Referensi </h2><br><ol><li>  UG835.  Panduan Referensi TclCommand Vivado Design Suite </li><li>  <a href="">https://github.com/FoxExe/Image2Bitmap/releases/tag/0.5</a> </li><li>  <a href="https://tcl.tk/">https://tcl.tk</a> </li><li>  <a href="http://www.tune-it.ru/web/il/home/-/blogs/%25D0%25BF%25D1%2580%25D0%25B5%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5-rgb888">http://www.tune-it.ru/web/il/home/-/blogs/conversion-rgb888</a> - &lt;-&gt; -rgb565-dan-protection-mushroom-from-fading </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id477974/">https://habr.com/ru/post/id477974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id477954/index.html">Bagaimana posting jawaban akan membuat internet lebih pintar</a></li>
<li><a href="../id477956/index.html">JavaScript dalam 3D: pengantar Three.js</a></li>
<li><a href="../id477958/index.html">10 tren teratas dari laporan Tren Kejahatan Berteknologi-Tinggi baru 2019/2020 Group-IB</a></li>
<li><a href="../id477964/index.html">Dua bulan dari ide hingga penjualan pertama: Pengalaman tim Genesis</a></li>
<li><a href="../id477966/index.html">HolyJS 2019 Moskow melalui mata peserta</a></li>
<li><a href="../id477976/index.html">Visualisasi dan analisis struktur komunitas menggunakan grafik</a></li>
<li><a href="../id478472/index.html">Linux Kernel Library: Kernel Linux dalam bentuk faktor lain atau sebagainya</a></li>
<li><a href="../id478474/index.html">Brother Pablo Escobar juga merilis smartphone yang fleksibel</a></li>
<li><a href="../id478480/index.html">Kecerdasan buatan, ITSM dan, secara umum, di mana LEAN?</a></li>
<li><a href="../id478482/index.html">Pengembang membuka bilah untuk pengembang dan menyelenggarakan pertemuan di sana tentang Angular, tata letak, PHP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>