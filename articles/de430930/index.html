<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚧 🐘 👩🏼‍🎓 Über 3D-Grafiken in einfachen Worten 🦁 🚶🏻 📘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Teil 1. Einführung 
 Hallo, mein Name ist Baldurk. Ich arbeite seit mehreren Jahren als Grafikprogrammierer. Obwohl ich kein Experte bin, scheint es, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Über 3D-Grafiken in einfachen Worten</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430930/"><h2>  Teil 1. Einführung </h2><br>  Hallo, mein Name ist Baldurk.  Ich arbeite seit mehreren Jahren als Grafikprogrammierer. Obwohl ich kein Experte bin, scheint es, dass ich bereits viel über alles verstehe, was mit der Arbeit mit Grafiken zu tun hat. <br><br>  Die Idee dieser Reihe von Posts schwebt seit langem irgendwo an der Peripherie meines Geistes und taucht wieder auf, nachdem ich einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">interessanten Artikel mit einer Analyse des neuesten Deus Ex</a> gelesen habe. <br><br>  Es scheint mir, dass die Grafik und insbesondere die Komplexität, die sie in modernen Spielen erreicht, ein interessantes Thema ist.  Sehr wenige Menschen sind neugierig, sich eingehend mit all seinen Details zu befassen, aber ich glaube, dass es Themen gibt, die alle interessieren.  Ich denke, dass die meisten Leute, die Spiele spielten, neugierig waren, wie diese oder jene Effekte erzielt wurden oder mit welcher Technologie sie es geschafft haben, in einem neuen Spiel so erstaunliche Grafiken zu erstellen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c8/3b9/2ad/4c83b92ad325af58966fc3742aa85a10.jpg"></div><br>  <em>Es sind viele Komponenten erforderlich, um selbst ein einfaches 3D-Spiel zu erstellen, ganz zu schweigen von einem Projekt wie Watch Dogs.</em> <br><br>  Ich habe nur eine allgemeine Vorstellung davon, was in diesem Artikel berücksichtigt werden muss, aber es hängt davon ab, welche Themen Interesse wecken.  Die Hauptidee ist jedoch, eine allgemeine Beschreibung dessen zu erstellen, was im modernen Spiel geschieht, ohne einen der Leser abzuschrecken - ich gehe davon aus, dass Sie keine Kenntnisse in Mathematik und Programmierung haben.  Wenn Sie den Unterschied zwischen der CPU und der Grafikkarte kennen und RAM von der Festplatte unterscheiden, reicht dies völlig aus, und ich werde den Rest erläutern. <br><a name="habracut"></a><br>  Dieser Artikel wird in Übereinstimmung mit dem Video- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Exemplar von Chip &amp; Ironicus "Let's Play of Watch Dogs" entwickelt</a> , um die Präsentation leicht zu strukturieren.  Das Spiel ist bekannt für seine Grafik (und die Meinungen darüber können völlig entgegengesetzt sein), und es gibt viele Aspekte, die mit separaten Beispielen betrachtet werden können.  Vielleicht werde ich über andere Spiele sprechen. <br><br>  Ich werde zunächst die Grundlagen erklären, die für jedes Spiel ziemlich gleich sind, aber ich werde auch einige der Techniken und visuellen Effekte von Wachhunden betrachten. <br><br>  Ich werde ein Tool namens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RenderDoc verwenden</a> , das ich in meiner Freizeit geschrieben habe.  Es wird zum Debuggen von Problemen mit Grafiken verwendet. Mit dem Tool können Sie einen Grafikrahmen in Teile zerlegen. Dank dieser Funktion können wir sehen, wie er zusammenkommt. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//OBaA9JD/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Diese Animation zeigt einen Teil eines Rahmens, der beim Rendern mit einer Grafikkarte schrittweise erstellt wird.</em> <br><br>  Die meisten Menschen wissen, dass Computergrafiken (und die Grafiken anderer Videos) aus einer Reihe von Standbildern bestehen, von denen jedes für einen bestimmten Bruchteil einer Sekunde angezeigt wird.  Im Kino werden traditionell 24 Bilder pro Sekunde (Bilder pro Sekunde, FPS) verwendet, im Fernsehen ist die Frequenz ungefähr gleich, etwa 24 bis 30 Bilder.  In Spielen kann FPS geändert werden, da in jedem Frame viel Arbeit geleistet wird.  Ein Frequenzabfall unter 30 ist unerwünscht, obwohl er ziemlich häufig auftritt.  Normalerweise liegt die Obergrenze für Konsolenspiele bei 60 FPS.  Entwickler versuchen, eine Häufigkeit von 30 oder 60 zu implementieren, die von den Zielen des Spiels abhängt.  Auf einem PC mit einem Display mit hoher Bildrate können Sie 90, 120 oder sogar mehr erreichen.  Der Grund für diese spezifischen Zahlen ist die vertikale Synchronisation (vsync), die wir unten diskutieren werden. <br><br>  Geistig können wir diese Aufgabe von der anderen Seite betrachten - anstatt zu sehen, wie <em>hoch die</em> FPS-Frequenz ist, schauen wir uns an, wie <em>wenig</em> Zeit für jeden Frame zugewiesen ist.  Wenn das Spiel mit einer Frequenz von 30 FPS funktionieren soll, haben wir nur 33 Millisekunden Zeit, um alle für den Frame erforderlichen Arbeiten abzuschließen.  Mit 60 FPS ist die Zeit halb so lang - ungefähr 17 Millisekunden.  Selbst für einen Computer ist dieser Zeitraum angesichts des Arbeitsaufwands nicht sehr lang.  Um Ihnen eine Vorstellung von den Mengen zu geben, bewegt sich das Geschoss nach groben Schätzungen etwa 1 Meter pro Millisekunde. <br><br>  Wir werden hauptsächlich über PCs sprechen, da diese Plattform offen ist, und ich kann nicht über Konsolen sprechen, ohne befürchten zu müssen, dass Geheimhaltungsvereinbarungen (NDAs) verletzt werden.  Wie auch immer, im Grunde werde ich darüber sprechen, was auf den Konsolen nicht sehr unterschiedlich ist, aber wenn sich noch etwas unterscheidet, dann werde ich dies betonen.  Bei mobilen Plattformen sind die meisten Unterschiede zwischen PC-Hardware / Konsolen und mobiler Hardware für das Thema meines Artikels nicht relevant. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8a/414/db8/d8a414db8e56c45fae566b8da11316e2.jpg"></div><br>  <em>Ehrlich gesagt habe ich dieses Bild hier eingefügt, damit Sie verstehen, dass der Artikel nicht nur Text enthält.</em> <br><br>  Es ist diese Aufgabe, die uns interessiert - wir werden uns keine Gedanken darüber machen, wie alle KI-Berechnungen durchgeführt werden oder wie physikalische Simulationen durchgeführt werden, um Objekte zu bewegen.  Die Grenzen der Disziplin „Grafikprogrammierung“ sind eher verschwommen, aber ich werde sagen, dass die Grafikprogrammierung beginnt, wenn wir alle Informationen haben, die zum Erstellen eines Frames erforderlich sind: Wir wissen, was passiert, alle Texturen und Modelle befinden sich im Speicher (nicht auf der Festplatte) ), die Animationen sind bereits animiert, die Physik wird gezählt und wir müssen nur einen fertigen Rahmen für die Anzeige auf dem Bildschirm zeichnen. <br><br>  Ich werde hinzufügen, dass ich ein 3D-Spiel mit einem ziemlich traditionellen Rendering wie Watch Dogs in Betracht ziehen werde - viele der Grundprinzipien gelten für 2D-Spiele, aber es ist etwas schwieriger, Konzepte auf diesen zu demonstrieren.  Ich werde auch (insbesondere Grafikprogrammierern) erklären, dass ich in erster Linie nach Verständnis strebe, daher werde ich vielleicht eher zweifelhafte Erklärungen verwenden, wenn sie es mir ermöglichen, mein Ziel zu erreichen. <br><br><h2>  Teil 2. Woraus der Rahmen besteht </h2><br>  Meistens werden wir uns nur einen Frame ansehen und über die Bausteine ​​sprechen, mit denen das Spiel einen fertigen Frame erstellt.  Auch in diesem Teil wird es einige neue schöne Bilder geben. <br><br>  Es gibt verschiedene Möglichkeiten, einen Rahmen aus Bausteinen zusammenzusetzen.  Das fertige Bild, das der Player sieht, wird nicht sofort gerendert.  Es wurde vor vielen Jahren sofort gezeichnet, aber moderne Grafik-Engines verwenden fast immer eine Art Vorverarbeitung.  Bevor das fertige Bild auf dem Bildschirm angezeigt wird, zeichnet die Grafik-Engine viele Zwischenbilder verschiedener Typen, die bei der Berechnung des endgültigen Bilds hilfreich sind. <br><br>  Diese Bilder hängen stark von der Art der Engine und den Techniken ab, die der Grafikprogrammierer anwenden muss.  Wenn er beispielsweise möchte, dass das Sonnenlicht die richtigen Schatten erzeugt, wird ein Bildtyp für die Schatten benötigt.  Möglicherweise benötigt er auch die richtigen Reflexionen auf dem vom Spieler angetriebenen Auto, und auch dafür benötigt er ein anderes Bild mit Reflexionen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/874/47d/95e/87447d95ee62161dc63df6e3dd2406f5.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3b/9ec/b69/a3b9ecb6984a5aae18fd57d8c2f4a9f2.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e6/bd2/ff7/1e6bd2ff7c49373dc337d20c0fe2a66a.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa4/5cb/65d/fa45cb65dfcb2042ecfd06ef6c463022.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3d9/4ed/937/3d94ed937c68dd821ab21c4a1a1cf4fb.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a57/360/2e8/a573602e8f7b69fa3868df93eebc776f.jpg"></div><br>  <em>Verschiedene Beispiele für Zwischenbilder, die bei der Konstruktion des Watch Dogs-Rahmens verwendet wurden.</em> <br><br>  In diesem Artikel werde ich nicht jedes der im Rahmen von Watch Dogs verwendeten Bilder betrachten, sondern nur die grundlegenden, damit Sie etwas lernen können.  Dies ist ein Bereich, in dem ständig Grafikforschung betrieben wird und neue Techniken entstehen.  Innovationen entstehen auch auf kleineren Ebenen, aber wenn das Marketing Sie über eine neue grafische Funktion informiert, bezieht es sich normalerweise auf solche Verbesserungen. <br><br><hr><br>  Jedes dieser Zwischenbilder besteht auch aus noch kleineren Fragmenten.  Jedes Objekt in der Szene oder eine Gruppe verwandter Objekte wird separat als <em>strukturiertes Modell erstellt</em> .  Bei der Entwicklung eines Spiels erstellen Künstler diese Modelle in einem 3D-Editor und erstellen alle erforderlichen Ressourcen für sie.  Dann werden diese Modelle mit dem Level-Editor in die Welt gesetzt und daraus wird nach und nach eine virtuelle Stadt aufgebaut. <br><br>  Wahrscheinlich weiß das fast jeder, und wenn Sie die Entwicklung von Echtzeit-3D-Grafiken in den letzten 20 Jahren beobachtet haben, wissen Sie, wie viel komplexer Modelle heute geworden sind.  In den ersten Phasen der Grafikbildung war das Textur-Mapping ein kostspieliger Prozess und wurde, wenn möglich, durch Malen von Objekten mit derselben Farbe entsorgt.  Texturen wurden nur für Elemente wie Augen oder Gesichter belassen, die wirklich Details benötigten. <br><br>  Das 3D-Modell besteht vollständig aus miteinander verbundenen Dreiecken, die die Form des Objekts bilden.  Jedes Dreieck hat drei Punkte, die als Eckpunkte bezeichnet werden. Da die Dreiecke miteinander verbunden sind, können die Eckpunkte von mehreren Dreiecken gemeinsam genutzt werden.  Wir werden später darauf zurückkommen, da die Eckpunkte und Dreiecke wichtig genug sind.  Beachten Sie auch, dass einige Objekte, z. B. Zeichen oder Bäume, vor dem Rendern animiert werden müssen.  Das Modell wird in statischer Standardform erstellt, und in jedem Frame werden Animationen angewendet.  Wir werden auch darauf zurückkommen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/357/03d/382/35703d382d727d1e395283a4fb3aae33.jpg"></div><br>  <em>Dies ist ein 3D-Modell von Aiden Pierces Kopf nach der Animation.</em>  <em>Dreiecke sind sichtbar, weil sie flach gezeichnet und nicht geglättet sind, wie dies normalerweise der Fall ist.</em> <br><br>  Um dem 3D-Modell mehr Details hinzuzufügen, werden Texturen überlagert.  Texturen sind normale flache Bilddateien, normalerweise quadratisch oder einfach, z. B. Rechtecke mit einem Verhältnis von 2: 1.  Texturen werden dem 3D-Modell mithilfe eines komplexeren Prozesses überlagert, auf den ich weiter unten näher eingehen werde. Konzeptionell ähnelt es jedoch dem Prozess des Verpackens eines Geschenks.  Anstelle eines einfachen sich wiederholenden Musters von Papierumschlägen entspricht das Bild genau der Größe des Umschlags.  Wenn Sie Papiermodelle für die Montage mit Klebstoff gesehen haben, ist das Prinzip dasselbe. <br><br>  Diese Analogie ist angemessener als Sie vielleicht denken, da diese Texturen normalerweise durch „Abrollen“ eines 3D-Modells in einen flachen Rohling erstellt werden, wie dies bei einem Papiermodell der Fall ist, wonach eine Textur darauf gezeichnet wird.  Diese Bereitstellung wird häufig automatisch durchgeführt, kann jedoch bei besonders komplexen Objekten manuell durchgeführt werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b9f/1f7/cf0/b9f1f7cf0d34680c8f313ad11691656f.jpg"></div><br>  <em>Dies ist die Textur, die dem oben gezeigten Aiden Pierce-Kopfmodell entspricht.</em>  <em>Es gibt Teile für Zähne und Zunge.</em>  <em>Beachten Sie, dass der Bereich über seiner Stirn nicht strukturiert ist, da er dauerhaft von Aiden Pearce ™ Legendary Baseball Cap bedeckt ist.</em> <br><br><blockquote><h4>  Hinweis </h4><br>  Beim Entfalten nehmen einige Teile des Objekts zu, die mehr Details erfordern, während andere abnehmen. </blockquote><br>  Sehr oft sprechen sie über verschiedene "Skins" von Modellen, insbesondere bei anpassbaren Charakteren.  Heutzutage bezieht sich das, was als "Haut" bezeichnet wird, normalerweise auf kleine Änderungen im Modell - einen neuen Gürtel oder einen anderen Hut -, aber anfangs entstand dieser Begriff, weil dasselbe Modell verwendet wurde, aber die Textur geändert wurde (oder "Haut" - wörtlich übersetzt als "Haut"), um einen Charakter zu erstellen, der anders aussieht.  Selbst heute können Sie mit Hilfe solcher Texturen eine große Variabilität von NPCs oder Objekten erstellen, was Zeit und Geld spart - Sie müssen nicht viele einzigartige 3D-Modelle erstellen.  Die verschiedenen Kleidungsstücke, die Aiden tragen kann, sind oft nur unterschiedliche Texturen desselben Modells. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//8ItIFRj/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Hier ist ein kurzer Ausschnitt der Kopfdrehung des 3D-Modells.</em>  <em>Überlagerte nur Textur und nichts mehr.</em> <br><br>  In dem Rahmen, den wir betrachten, werden im Haupt-Rendering-Teil ungefähr 1700 Objekte gerendert.  Einige von ihnen werden die gleichen Modelle sein - Objekte wie Blumen in Töpfen und Mülleimern werden niemals separat erstellt. Dies ist ein Modell oder mehrere Modelle, die an verschiedenen Orten platziert sind.  Die ungefähre Anzahl der Objekte, die zur Vervollständigung des Rahmens gezeichnet werden, liegt jedoch nahe bei <strong>4700.</strong> Dies gibt uns eine Vorstellung davon, wie viel zusätzliche Arbeit neben dem Rendern all dieser Modelle erforderlich ist. <br><br>  Schauen wir uns ein anderes Beispiel eines Objekts an - eine von Aiden getragene Baseballkappe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa2/1ce/636/aa21ce63666b4636b76ebe062f7536ca.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f7/4d3/b93/0f74d3b9305c6ed4572a5bc55d178a11.jpg"></div><br>  <em>Dies ist ein Modell mit Textur und strukturierter Baseballkappe.</em>  <em>Es ist ersichtlich, dass die Textur aus separaten Teilen besteht, die mit dem Modell verbunden sind.</em> <br><br><blockquote><h4>  Hinweis </h4><br>  Das Visier und der Hauptteil der Baseballkappe auf der Textur berühren sich nicht, da der Scan sehr kompliziert sein kann und bei Bedarf in mehreren verschiedenen Teilen durchgeführt werden kann.  Manchmal erfordert die Texturierung eines Modells mit komplexer Form ohne sichtbare Probleme und Nähte einiges an Geschick. </blockquote><br>  Die gleichen Prinzipien, die wir bei Aidens Kopf gesehen haben, gelten auch für die Kappe.  Wenn wir die spezifische Textur und die Zahlen ignorieren, die zum Auspacken erforderlich sind, ist das Prinzip immer dasselbe. <br><br>  Um zu zeigen, was während der Entwicklung schief gehen kann und wie Sie Spaß beim Programmieren von Grafiken haben können, können wir ein kleines Experiment durchführen.  Da die meisten Texturen eine quadratische Standardgröße haben und die Methode zum Umwickeln und Entfalten von Texturen auf dem Modell ebenfalls dieselbe ist, warum nicht ein wenig mit ihnen spielen?  Was passiert, wenn wir die Textur von Aidens Kopf auf ein Baseballmützenmodell anwenden? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/212/1b1/5c7/2121b15c7f8355575864f9333c9eeab0.jpg"></div><br>  <em>Bereits nicht sehr ähnlich der Aiden Pierce Legendary Baseball Cap.</em> <br><br>  Wo sich auf der Textur der Baseballkappe ein Logo befand, befanden sich Ohr und Zähne auf der Textur des Kopfes.  Wo ein Visier war, waren nur Haare auf der Textur des Kopfes.  Die Überlagerung ist genau gleich, es wird jedoch eine andere Textur verwendet.  Natürlich wird dieses Beispiel ein Fehler im Spiel sein, aber überlegen Sie, was getan werden kann, wenn Sie die Textur animieren oder flackern lassen. In Spielen werden diese Dinge für verschiedene Effekte verwendet, die Sie jetzt bemerken können.  Insbesondere das Spiel Saint's Row 4 verwendet ähnliche für Spezialeffekte der "Simulation". <br><br>  Es wird auch nützlich sein, über die Konsequenzen nachzudenken - Spiele kombinieren sehr sorgfältig Paare von Modellen und Texturen, dh die einzigartigsten Modelle müssen mit ihren eigenen einzigartigen Texturen übereinstimmen. <br><br>  Natürlich ist diese Regel nicht absolut - in einigen Fällen ist Textur aus Platzgründen ein sich wiederholendes Standardmuster, das für viele Objekte verwendet werden kann.  Verknüpfte Objektgruppen - z. B. Zeitungshändler - können dieselbe Textur für verschiedene Zeitungen verwenden, wobei jede Zeitung einen kleinen Teil der Textur einnimmt. <br><br>  Dies bedeutet jedoch, dass zum Erstellen des endgültigen Bildes alle Bausteine ​​vorhanden sein müssen, dh, dass viele erforderliche Modelle und Texturen erhalten werden können.  Im nächsten Teil werden wir darüber sprechen, warum es sehr schwierig ist, einige Aspekte wie die Reflexion richtig umzusetzen.  Ich werde auch darüber sprechen, wie Spiele kleine Tricks verwenden, um Zeit und Ressourcen zu sparen. <br><br><h2>  Teil 3. Was Sie nicht zeichnen müssen </h2><br>  Oft ist das Programmieren von Grafiken die Aufgabe, ein Dutzend verschiedener Einschränkungen auszugleichen, um den perfekten Kompromiss zu erzielen.  Im letzten Teil haben wir gesehen, dass jedes Mal, wenn eine Szene gezeichnet wird, sie aus vielen kleinen Bausteinen zusammengesetzt wird - Menschen, Autos, Verkehrszeichen, Gebäude.  Alles, was auf dem Bildschirm angezeigt wird, besteht aus einzelnen Komponenten, die gezeichnet werden müssen.  Es gibt einige subtile Ausgleichsoperationen, die wir hier diskutieren werden. <br><br>  Der Zentralprozessor und die Grafikkarte arbeiten beim Rendern des Rahmens zusammen.  Der Rest des Spiels wird in der CPU ausgeführt, sodass entschieden wird, welche Objekte im aktuellen Frame gezeichnet werden sollen, wohin die Kamera schaut und welche Animationen abgespielt werden.  Eine Grafikkarte ist ein „Arbeitstier“, das alle komplexen Arbeiten zum Rendern von Pixeln ausführt, weshalb es sich um ein separates Spezialgerät handelt. <br><br>  Es stellt sich heraus, dass sowohl die CPU als auch die Grafikkarte Einschränkungen hinsichtlich der Geschwindigkeit oder des Umfangs der Berechnungen aufweisen. Dies sind jedoch verschiedene Arten von Einschränkungen. <br><br>  Im Allgemeinen interessiert sich die CPU mehr für ihren eigenen Teil der Arbeit: Wie viele Objekte müssen wir insgesamt zeichnen?  Wie <i>unterschiedlich sind</i> diese Objekte - sind es 100 identische Lichter oder 100 Büsche / Pflanzen / Bäume?  Sind diese Objekte animiert, bewegen sie sich dynamisch und welche von ihnen sind statisch oder bewegungslos? <br><br>  Das erste, was wir tun, um die Last so weit wie möglich zu reduzieren, ist, nur das zu zeichnen, was auf dem Bildschirm sichtbar ist.  Dies scheint offensichtlich, aber die Implementierung erfordert sorgfältige Arbeit.  Vergessen Sie nicht, dass wir jeden Frame von Grund auf neu erstellen. Daher <i>müssen</i> wir <i>in jedem Frame</i> jedes Objekt betrachten und feststellen, ob es sichtbar ist oder nicht.  Dies bedeutet, dass in jedem Spiel überall eine schwarze Leere folgt, die dem Spieler folgt, und wenn er keine Objekte und Personen betrachtet, hören sie auf zu existieren. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//bmSqTLe/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>In dieser Animation drehen wir die Kamera und zeigen die Leere hinter dem Player.</em>  <em>Aufmerksame Zuschauer werden feststellen, dass es nicht ganz leer ist ...</em> <br><br>  In diesem Fall ist es schwierig, praktische Regeln zu entwickeln, aber im Allgemeinen können Sie ungefähr 1000 Objekte in der Szene zeichnen, ohne sich um den Platzmangel sorgen zu müssen.  Wenn Sie jedoch 5.000 Objekte rendern müssen, sollten Sie über Tricks nachdenken.  Vergessen Sie nicht, dass wir in den meisten Spielen, in denen der Spieler die Kamera steuern kann, nicht wissen können, in welchem ​​Winkel er aussehen wird. Sie müssen also Platz für Manöver sparen. <br><br>  Es stellt sich heraus, dass es viele Tricks gibt, mit denen Sie eine gültige Ressource fast vollständig nutzen können, und sie sind besonders wichtig in Spielen wie Watch Dogs.  Je näher Sie den Grenzen kommen und je mehr visuelle Qualität Sie mit der gleichen Anzahl von Objekten erzielen können, desto besser sieht das Spiel aus. <br><br>  Selbst wenn Sie sich ansehen, was in der Szene vor Ihnen liegt, bedeutet dies nicht, dass die gesamte Stadt gezeichnet werden muss.  Wenn sich links oder rechts ein riesiges Gebäude befindet, wird alles dahinter unsichtbar, sodass Sie es nicht zeichnen können.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In ähnlicher Weise werden einige Objekte in der Ferne sehr klein, sodass wir uns nicht darum kümmern müssen, winzige Pflanzen und Sträucher in der Ferne zu zeichnen. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//auvvQ67/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Animation zeigt, dass, wenn Sie die Straße weiter hinuntergehen als wir sehen, nichts in den Seitenstraßen ist, aber in großer Entfernung die Details kleiner werden. </font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tatsächlich gibt es in dieser Szene immer noch viele Objekte, die sich als unsichtbar herausstellen werden. </font><font style="vertical-align: inherit;">In diesem Bereich bleibt noch viel zu erforschen, und es müssen verschiedene ausgefeilte Techniken angewendet werden. </font><font style="vertical-align: inherit;">Sie müssen immer Kompromisse eingehen, aber wenn Sie ein wenig Zeit verbringen oder eine sehr clevere Methode finden können, um das Rendern von 100 Objekten fast ohne zusätzlichen Aufwand zu vermeiden, können wir die Szene noch komplexer oder dichter gestalten.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt auch ein anderes kleines Problem. In einigen Fällen müssen wir ein Gebäude zeichnen, das auf dem Bildschirm kaum sichtbar ist und weit darüber hinausgeht. Es verschwendet Ressourcen. Wir können diese Objekte immer in mehrere Teile unterteilen, dann kann jeder Teil gezeichnet oder übersprungen werden, dh es wird weniger Abfall entstehen. Jetzt aber haben wir die Gesamtzahl der Objekte erhöht gemacht , </font><font style="vertical-align: inherit;">wenn sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sind</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem Bildschirm, und das entgegengesetzte Problem geschaffen! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses Beispiel ist eines von Hunderten, aber es ist leicht zu erklären, welche Entscheidungen getroffen werden müssen und welche Experimente durchgeführt werden müssen, um den perfekten Gleichgewichtspunkt für jedes Spiel zu finden.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Da die Aktion unseres Schusses von Watch Dogs in der Stadt stattfindet, können wir ihn von oben betrachten, um ungefähr zu verstehen, was genau gezeichnet wird. </font><font style="vertical-align: inherit;">In diesem statischen Bild fällt besonders auf, dass Watch Dogs die Arbeit vierteljährlich erledigt.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//My8bi1m/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt entfernen wir den sichtbaren Bereich vor der Kamera (Entschuldigung für die Installation, um Zeit zu sparen).</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/719/960/135/7199601359a0d421147d9f632061bfaf.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein ungefährer Sichtbarkeitsbereich der Kamera wird dem Bild überlagert. </font><font style="vertical-align: inherit;">Die Breite dieses Dreiecks hängt vom Sichtfeld ab. Manchmal ist dies in Spielen eine benutzerdefinierte Option, manchmal ein konstanter Wert.</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ccf/5ff/d45/ccf5ffd455dccf7098393602c9944139.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ist eine Drahtgitteranzeige der Szene, das Sichtfeld der Kamera ist auf Weiß beschränkt.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige von Ihnen könnten sich bereits einen kleinen Trick vorstellen, mit dem Sie die Einschränkung des Renderns einer bestimmten Anzahl von Objekten umgehen können. Warum machen Sie die Objekte nicht zu einer sehr komplexen Kombination von allem auf kleinem Raum bis hin zu einzelnen Blättern? Dann ist das Zeichnen von 1000 Objekten mehr als genug. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier sind wir jedoch mit völlig anderen Einschränkungen konfrontiert: Grafikkarten haben eine begrenzte Leistung, und je komplexer das Objekt ist, desto länger dauert das Zeichnen. Das heißt, selbst ein Objekt kann, wenn es recht komplex ist, die Framerate des Spiels auf 20 FPS reduzieren. Aus diesem Grund habe ich gesagt, dass die Begrenzung der Anzahl der Objekte eher unscharf ist.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Zeit, die für ein Objekt aufgewendet wird, hängt von der Komplexität und Detailgenauigkeit der Modelle und Texturen sowie von der Raffinesse von Licht und Schatten ab. Dies ist auch der Grund, warum Spiele, die versuchen, komplexere oder komplexere Grafiken zu implementieren, in der Regel weniger komplexe und detaillierte Szenen verwenden. Durch das Balancieren werden die Maßstäbe in die eine oder andere Richtung verschoben, sodass Sie mehr Spielraum haben und das opfern können, was für das Spiel nicht so wichtig ist .</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45f/2d5/233/45f2d5233fe8bd806ab2fbf18baa038d.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist eine Art Heatmap, die zeigt, in welchen Teilen der Szene sich besonders komplexe Modelle befinden. Beachten Sie, wie viele Probleme Bäume und Vegetation verursachen können.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es gibt eine weitere Reihe von Techniken, die als „Level of Detail“ (LOD) bezeichnet werden und speziell zur Lösung solcher Probleme entwickelt wurden. Ähnlich wie wir die Anzahl der Objekte optimieren und alles Unnötige abschneiden können, können wir das Angebot an "Komplexität" erhöhen und unnötiges eliminieren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einer der Tricks ist eigentlich bekannt - dies verändert die Auflösung der Texturen. Dieses Thema überschneidet sich normalerweise mit vielen anderen, daher werde ich versuchen, es auf zugängliche Weise zu erklären.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texturen in Spielen sind normalerweise Rechtecke mit einer Größe, die der Potenz von zwei entspricht - 512, 1024, 2048, 4096. Es gibt viele Gründe dafür, aber einer der Vorteile davon ist, dass Sie eine Textur der Größe 1024 x 1024 nehmen und einfach eine kleinere Version davon mit einer Größe von 512 x 512 erstellen können . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aus den Gründen, die ich unten diskutieren werde, ist es immer notwendig, dass die Textur alle möglichen kleineren Versionen hat. Das heißt, eine Textur mit einer Größe von 1024 x 1024 hat kleinere Versionen von 512 x 512, 256 x 256, 128 x 128, 64 x 64, 32 x 32, 16 x 16, 8 x 8, 4 x 4, 2 x 2 und 1 x 1. Einer der Vorteile davon ist jedoch, dass wenn entfernte Objekte eine geringe Größe auf dem Bildschirm haben, das Anwenden einer 1024x1024-Textur auf sie bedeutet, Ressourcen zu verschwenden. Wir können sparen, indem wir kleinere Versionen derselben Textur verwenden.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In ähnlicher Weise können auch nahe Objekte als nicht sehr bedeutsam angesehen werden und kleinere Texturen für sie verwenden. </font></font><br><br><blockquote><h4>  Hinweis </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn sich ein Spieler einem Objekt nähert, wird normalerweise die größte Textur verwendet. Wie die meisten Leute in einem bestimmten Spiel gesehen haben, geschieht dies jedoch nicht immer und die Texturen sehen vor dem Laden zu verschwommen aus. </font><font style="vertical-align: inherit;">Dies geschieht normalerweise, weil Texturen nicht von einer DVD oder Festplatte direkt in den Speicher der Grafikkarte zum Rendern geladen werden können. </font><font style="vertical-align: inherit;">Meistens geschieht dies, wenn ein Spieler seine Position abrupt ändert, z. B. während des Respawns, beim Laden eines neuen Levels oder bei sehr schnellen Bewegungen. </font><font style="vertical-align: inherit;">In allen anderen Fällen werden Texturen normalerweise schrittweise geladen, während der Player um die Welt bewegt wird.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können diesen Vereinfachungsprozess auch auf die im Spiel verwendeten Modelle anwenden, obwohl dies viel schwieriger ist. Indem Sie vereinfachte Versionen komplexer Objekte erstellen, können Sie sicherstellen, dass diese in großer Entfernung nicht einen Teil eines begrenzten Komplexitätsangebots verschlingen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dank vereinfachter Objekte und zugeschnittener Modelle können Sie viel Geld sparen und müssen diesen Ansatz in jedem Spiel wie Watch Dogs anwenden. Gleichzeitig kann es eine enorme Verschwendung von Ressourcen sein. Es ist notwendig, eine sehr durchdachte und ausgewogene Entscheidung darüber zu treffen, wie viele vereinfachte Versionen von Modellen erforderlich sind. Wenn zu wenige vorhanden sind, können Sie nicht zu viel sparen, oder es treten spürbare Qualitätssprünge beim Ändern auf. Wenn es zu viele davon gibt, verschwenden Sie Speicher und verbringen die Arbeitsstunden, die zum Erstellen von Objekten erforderlich sind.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/801/f01/9ed/801f019ed8c365cfebbbeea2320bf3d7.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So sehen komplexe Objekte und Charaktere aus der Ferne aus, wenn sie nicht von ihren sehr detaillierten Versionen zu unterscheiden sind.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich hoffe, dass Sie jetzt eine Vorstellung von den Problemen haben, die Grafikprogrammierer, Künstler und Leveldesigner versuchen, Grafiken von höchster Qualität mit hoher Geschwindigkeit zu kombinieren. </font><font style="vertical-align: inherit;">Auf Konsolen ist diese Gleichung etwas einfacher zu lösen als auf dem PC, da die Ausrüstung konstant ist.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im vorherigen Teil habe ich gesagt, dass ich darüber sprechen werde, warum es sehr schwierig ist, Reflexionen und ähnliche Dinge richtig umzusetzen. Der Grund ist ganz einfach: Die Reserven an Produktivität und Ressourcen, über die ich ständig spreche, ändern sich nicht, je nachdem, ob Sie ein Spiegelbild haben oder nicht. Wenn Sie eine Reflexion erstellen möchten, die wieder die gesamte Szene anzeigen kann, müssen Sie alle Arbeiten wiederholen, über die ich gesprochen habe. Darüber hinaus hängen die Reflexionen sehr stark von dem Winkel ab, in dem wir sie betrachten. Um genaue Reflexionen für jedes reflektierende Objekt zu erhalten, müssen sie ihre eigenen sein!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies kann sehr schnell außer Kontrolle geraten, und normalerweise erlauben sich Spiele, in denen es Reflexionen gibt, bestimmte Freiheiten oder Annahmen. Spiele erzeugen in komplexen Umgebungen sehr selten Reflexionen. Das Maximum kann ein Spiegel im Badezimmer sein, in dem sich nicht so viele Objekte befinden, die Komplexität der Szene gering ist und Sie sich daher zusätzliche Kosten leisten können. Vielleicht werden die wahren Reflexionen im Spiel nur auf unebenen oder welligen Oberflächen des Wassers sein, so dass selbst eine sehr raue und wenig detaillierte Szene ausreicht, um überzeugende Reflexionen zu erzeugen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist normalerweise schwierig, reflektierende Oberflächen vollständig zu vermeiden, weshalb Spiele vorgerenderte Bilder der unmittelbaren Umgebung verwenden, was zu einem „einigermaßen guten“ Ergebnis führt. Aber sie werden nicht genau unter die Lupe genommen, und wenn Sie sich die Überlegungen genau ansehen, werden Sie feststellen, dass dies eine Nachahmung ist. Es gibt moderne Techniken, die unter bestimmten Bedingungen helfen, Reflexionen zu erzeugen, und vielleicht werde ich später darüber sprechen, aber solche vorgerenderten („vorgerenderten“) Bilder werden immer noch benötigt.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06c/9bd/b94/06c9bdb94b41c1a83b7d574cdf90f449.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses gerenderte Bild wird als "Würfelkarte" bezeichnet. Es ist nicht ganz genau in Bezug auf den Ort, an dem Aiden steht, aber es ist nah genug an ihm.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Watch Dogs rendert Reflexionen in Echtzeit. Ich habe dieses Problem nicht im Detail untersucht, aber ich glaube, dass sie immer wiedergegeben werden, wenn der Charakter auf der Straße ist, und hauptsächlich dazu verwendet werden, seine genauen Reflexionen über das Auto zu erhalten, in dem er sitzt, um das Image zu verbessern und ihm ein leichtes Gefühl für die Realität zu geben . Da sich der Spieler immer auf sein Auto und seine unmittelbare Umgebung konzentriert, ist die Tatsache einer falschen Reflexion anderer Autos kaum spürbar.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es stehen viele Näherungswerte zur Verfügung, um das Rendern dieser Reflexionen zu beschleunigen. Zum Beispiel werden in der Reflexion viel weniger Objekte gerendert als in der realen Szene - insgesamt etwa 350 - und viele von ihnen sind im Vergleich zu den Vollversionen sehr vereinfacht. Ich vermute, dass komplexe Objekte wie Menschen unabhängig von der Entfernung vollständig verworfen werden, aber ich habe diese Theorie nicht getestet. Außerdem gibt es auf diesen Objekten keine Schatten, und die Beleuchtung ist sehr einfach - nur die, die von Sonne und Himmel kommt. Reflexionen werden vom Boden aus wie bei einer „Fischaugen“ -Linse wiedergegeben, dh Reflexionen der Erde selbst sind unmöglich, und was sich daneben befindet, weist nur sehr geringe Details auf.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber trotz all dieser Vereinfachungen kommen Reflexionen nur mit dem fertig, was beabsichtigt war. </font><font style="vertical-align: inherit;">Wenn Sie unter den Schienen fahren, können Sie das richtige Spiegelbild mit Blick auf das Auto erhalten, was in der Praxis nicht funktionieren würde. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Entscheidung war absichtlich und nicht leicht zu treffen. </font><font style="vertical-align: inherit;">Aktien sind ein konstanter Wert. Wenn Sie also Raum für diese Überlegungen lassen, müssen Sie etwas anderes opfern.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab1/cda/fcd/ab1cdafcde2ca5c15111ca30f5b6bb5f.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ist eine sehr "fischige" Ansicht der Szene um Aiden mit einer Ansicht von unten, die für Reflexionen gemacht ist. </font><font style="vertical-align: inherit;">Sie können entlang der beiden Lichter und Schienen des Zuges navigieren.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt noch einen anderen Teil der Arbeit, den ich hier erwähnen möchte - Schatten. Später möchte ich darüber sprechen, wie Schatten funktionieren, da dies ein interessantes Thema ist. Jetzt ist es jedoch am wichtigsten, sich daran zu erinnern, dass Schatten Reflexionen sehr ähnlich sind. Jede Lichtquelle, die einen Schatten wirft, sollte ein Szenenbild aus ihrer Sicht rendern. Zu diesem Zeitpunkt , </font><font style="vertical-align: inherit;">um Wege zu erleichtern die Arbeit nicht so viel - richtig zu </font><font style="vertical-align: inherit;">berechnen Schatten jede Lichtquelle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist erforderlich , </font><font style="vertical-align: inherit;">um</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dieses Bild zu haben.</font></font><br><br><blockquote><h4>  Hinweis </h4><br>      ,    .           ,      «»  ,             .         ,  ,        . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die offensichtlichste und bedeutendste Quelle für schattenspendendes Licht ist die Sonne (oder der Mond, wenn das Ding nachts passiert). </font><font style="vertical-align: inherit;">Da die Sonne riesig ist, werden normalerweise 3-5 Bilder dafür gerendert und nicht eines, wie im Fall von Scheinwerfern oder einer Taschenlampe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leider ist dies einer der Fälle, in denen Wachhunde nicht als gutes Beispiel dienen können. </font><font style="vertical-align: inherit;">Die Berechnung der Schatten im Spiel ist ziemlich kompliziert und meines Erachtens speziell für den Fall des Schattenwerfens in der Stadt optimiert. </font><font style="vertical-align: inherit;">Daher sollte ich besser zu Far Cry 4 wechseln und die Berechnung der Schatten am Beispiel eines Frames aus diesem Spiel in Betracht ziehen.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21c/4a4/ae6/21c4a4ae665924ba44245b8e18249f8b.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ist eine Szene aus Far Cry 4, die ich als Beispiel verwende.</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ae/502/26c/7ae50226c3cc0c40c916c58f26ba27f3.jpg"></div><br>  <em>Hier ist ein Bild mit Informationen zu den Schatten dieser Szene - jede von ihnen erfordert eine völlig neue Darstellung der Szene.</em> <br><br>  Wenn wir der Lichtquelle Schattenwurf hinzufügen müssen, müssen wir die Szene daher noch einmal rendern.  Hier können Sie auch einige der Näherungen verwenden, die bei Reflexionen verwendet werden, nur dass sie viel kleiner sind.  Sie können kleine oder entfernte Objekte überspringen. Beachten Sie jedoch, dass diese Objekte keine Schatten werfen.  Sie können das Bild sehr klein rendern, aber dann sind die Schatten körnig und detailarm.  Normalerweise ist es nicht möglich, eine sehr vereinfachte Version des Objekts zu verwenden, da das Objekt dann anscheinend einen Schatten auf sich selbst wirft oder Lücken zwischen dem Objekt und seinem Schatten auftreten. <br><br>  Eine weitere Konsequenz, die sehr leicht zu übersehen ist, ist die Notwendigkeit, für jede Lichtquelle Schattierungsbilder zu erstellen.  In vielen Fällen ist es möglich, Lichtquellen durch Kombination zu vereinfachen - bei Wachhunden geschieht dies mit Autoscheinwerfern. <br><br>  Wenn beide Lichter eingeschaltet sind, wird nur eine Lichtquelle gezeichnet, die jedoch eine spezielle Form hat, wodurch sie wie zwei Strahlen aussieht.  Wenn die Scheinwerfer Schatten haben, ist dies nicht so einfach und wird viel deutlicher - wenn der Spieler vor dem Auto vorbeikommt, kommt das Licht von irgendwo zwischen den beiden Scheinwerfern.  Vielleicht müssen Sie dann die Scheinwerfer trennen, aber gleichzeitig fallen nicht nur zusätzliche Kosten für die Berechnung der Schatten an, sondern Sie müssen auch neue Beleuchtung zeichnen. <br><br><hr><br>  Die Hauptsache, die ich bei all dem hervorheben wollte, war der Kompromiss.  Wir können sicherlich all diese Annäherungen loswerden, aber wir müssen unsere Ressourcenreserven dafür ausgeben, dh etwas anderes opfern.  Jeder Spieleentwickler muss entscheiden, worauf es für ihn wichtig ist, sich im Spiel zu konzentrieren, und was den Spieler am meisten beeindruckt oder nervt. <br><br><h2>  Teil 4. Verschieben der Peaks </h2><br>  In diesem Teil werde ich mehr über die technischen Details der Animation von Objekten in der Szene sprechen. <br><br>  Grafikprogrammierer sprechen oft von der „Grafikpipeline“.  3D-Grafiken ähneln einem Fließband mit einer klar definierten Bewegung von einer Stufe zur anderen, funktionieren jedoch nicht jeweils nur mit einem Objekt. <br><br>  Alle modernen Grafikkarten haben ungefähr das gleiche Förderband. Sie verfügen über spezielle Geräte und Software, die direkt „in Silizium“ geflasht werden, um die Geschwindigkeit des Förderers zu maximieren.  Natürlich gibt es viele Unterschiede zwischen verschiedenen Herstellern und Familien von Grafikkarten, aber normalerweise müssen wir uns keine Gedanken darüber machen, <em>wie</em> sie auf dieser Ebene funktionieren. <br><br><blockquote><h4>  Hinweis </h4><br>  Wenn Sie daran interessiert sind, wie alles auf abstrakter Hardwareebene funktioniert, empfehle ich eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reihe von Artikeln von Fabian Giesen über die Grafikpipeline</a> .  Diese Artikelserie ist <em>viel</em> detaillierter und erfordert viel mehr Verständnis als mein Beitrag. </blockquote><br>  Ich werde viele Details überspringen, um interessante und wichtige Prinzipien zu erklären.  In diesem Teil werden wir uns den ersten Teil der Pipeline ansehen, der als <strong>Vertex Shader bezeichnet wird</strong> . <br><br>  Shader verbreiteten sich vor ungefähr 16 Jahren nach der Veröffentlichung von DirectX 9, in dem Vertex- und Pixel-Shader auftraten.  Um zu erklären, was Shader sind und sie mit dem zu vergleichen, was sie früher waren, werde ich über die Arbeit sprechen, die sie leisten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/357/03d/382/35703d382d727d1e395283a4fb3aae33.jpg"></div><br>  <em>Aidens Skelettkopf ist wieder bei uns.</em> <br><br>  Ich möchte Sie daran erinnern, dass wir in Teil 2 die Modelle untersucht haben, aus denen die Spielwelt erstellt wurde.  Diese Muster bestehen aus einzelnen Punkten, die als Eckpunkte bezeichnet werden und in Dreiecken verbunden sind.  Ich sagte, dass ich Ihnen später mehr darüber erzählen werde, und jetzt halte ich mein Versprechen. <br><br>  Da alles in der Spielwelt aus Eckpunkten besteht, muss alles, was mit diesen Modellen gemacht werden muss, mit Eckpunkten ausgeführt werden.  Wenn es um die Grafikkarte geht, sieht sie nur eine lange Liste von Eckpunkten.  Für sie gibt es keine laufenden Animationen, schwankenden Blätter von Bäumen oder andere abstrakte Konzepte. <br><br>  Schauen wir uns ein einfaches Beispiel dafür an, was wir tun müssen - Objekte in der Welt bewegen und positionieren.  Nehmen wir zunächst einen einfachen Fall, keinen Charakter. <br><br>  Beim Erstellen von Objekten in 3D-Editoren wie Maya und 3D Studio Max bauen Künstler immer in ihrer eigenen Welt.  Diese Objekte werden nicht sofort im Gefolge von Chicago erstellt, sondern ihre Umgebung sieht aus wie ein "leerer weißer Raum" aus der Matrix.  Jedes Objekt befindet sich im Zentrum der absoluten Leere. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd0/a55/a3c/bd0a55a3c96f5fefc237bdf22194e009.png"></div><br>  <em>Hier ist eine Ampel im Spiel irgendwo unter den Schienen, und sie befindet sich in ihrer eigenen Welt.</em> <br><br>  Beim Speichern auf der Festplatte hat das Modell keine Ahnung, wo es sich auf der Welt befindet und wann es heruntergeladen und auf die Grafikkarte übertragen wird.  Das heißt, wenn es darum geht, Objekte zu zeichnen, müssen wir sie aus unserer eigenen Welt in die Szene verschieben, die wir zeichnen.  Dies geschieht mit jedem gezeichneten Objekt, und selbst bewegungslose Objekte wie Gebäude und Brücken bewegen sich in jedem Bild von ihrer eigenen Welt zur Szene. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d65/21d/673/d6521d67344753566d0d2b4ff3b4fbf9.png"></div><br>  <em>Hier sehen wir mehrere Ampeln, die bereits in einer teilweise konstruierten Schlussszene platziert sind.</em> <br><br>  Wie ich oben erwähnt habe, können wir nur mit den Spitzen arbeiten.  Wir können nicht einfach zur Grafikkarte sagen: "Können Sie diese Ampel unter die Brücke stellen?  Und dann noch einen etwas weiter setzen?  Großartig! " <br><br>  Anstatt der Grafikkarte zu sagen, was sie mit dem Objekt selbst tun soll, müssen wir daher sagen, was mit all ihren Eckpunkten zu tun ist.  Es stellt sich heraus, dass in diesem Fall alles sehr einfach wird.  Wenn wir alle Scheitelpunkte auf genau dieselbe Weise ändern und sie relativ zueinander bewegungslos bleiben, ähnelt dies dem Verschieben eines Objekts als Ganzes.  Wir müssen nur herausfinden, was „Veränderung“ als Transformation bezeichnet. <br><br><blockquote><h4>  Hinweis </h4><br>  Die mathematischen Berechnungen all dessen sind nicht besonders kompliziert, gehen aber über den Rahmen des Artikels hinaus.  Wenn Sie bereits lineare Algebra studiert haben, wissen Sie wahrscheinlich alles, was Sie brauchen - im Grunde kommt es auf die Matrixmultiplikation von Vektoren an. </blockquote><br>  Vor dem Erscheinen von Scheitelpunkt-Shadern waren die möglichen Optionen zum Transformieren von Scheitelpunkten in der Grafikkarte sehr begrenzt.  Verfügbar waren sich bewegende und rotierende Objekte sowie einige andere Vorgänge, aber nichts besonders Redundantes oder Kompliziertes. <br><br>  Vertex-Shader sind kleine Computerprogramme, die auf einer Grafikkarte ausgeführt werden.  Sie nehmen einen Scheitelpunkt, führen <em>alle erforderlichen Aktionen</em> damit aus und geben einen Ausgabescheitelpunkt aus.  Sie können es nicht nur bewegen, sondern auch auf und ab springen lassen, sich vom nächsten Gipfel entfernen, je nach Wind schwingen, animiert sein und vieles mehr. <br><br>  Ich nahm einen der Vertex-Shader, die in Watch Dogs verwendet werden, und experimentierte ein wenig damit, um zu zeigen, was er tut.  Dies ist eine ziemlich mühsame Aufgabe, aber ich habe es geschafft, den für die Charaktere verwendeten Vertex-Shader zu finden und zu ändern.  Es gibt einen anderen Vertex-Shader, der für die Haut verwendet wird, beispielsweise für Gesichter und Hände, aber Sie werden das Prinzip schnell verstehen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//Wqyv7B8/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Ich habe eine sehr einfache Änderung vorgenommen, die dem Charaktermodell eine Biegung hinzufügt, aber alles andere wird wie gewohnt verwendet.</em> <br><br>  Die Animation oben zeigt, dass die Charaktere irgendwie seltsam verzerrt sind.  Dies bringt uns zurück zu dem Prinzip: "Wenn Sie jeden Scheitelpunkt verschieben, ähnelt dies dem Verschieben des gesamten Objekts."  Die am Vertex-Shader vorgenommene Änderung funktioniert jeweils nur für einen Vertex. Da jedoch alle mit derselben Verzerrung arbeiten, wird der Effekt auf das gesamte Objekt angewendet. <br><br>  Sie können auch Änderungen an dem Teil der Transformation vornehmen, der für das „einfache Verschieben an Ort und Stelle“ verantwortlich ist, sodass sie den Charakter nicht an der richtigen Stelle platziert, sondern über den Boden hebt.  Dies wird nicht mit Hilfe der Physik simuliert, daher hat es nichts mit Schwerkraft oder Kollisionen mit anderen Objekten zu tun - wenn wir wollen, können wir alle in die Luft fliegen lassen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//tktCaw4/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>In dieser Animation haben wir den Vertex-Shader dazu gebracht, das Objekt schrittweise anzuheben und abzusenken.</em> <br><br>  Das alles ist natürlich nicht sehr konstruktiv, aber es gibt uns eine allgemeine Vorstellung davon, wie Vertex-Shader funktionieren. Wenn wir jetzt die Blätter auf den Bäumen so animieren möchten, dass sie schwingen, würden wir ungefähr dasselbe tun.  Nur anstatt zu heben und zu senken, würden sie in Windrichtung schwingen.  Dann können wir die Stärke des Windes so ändern, dass die Bäume mehr oder weniger schwanken. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//5Sl1uhw/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Hier sehen wir, was passiert, wenn sich alles um das Siebenfache erhöht.</em> <br><br>  Ich vereinfache ein wenig, aber im Grunde besteht die Aufgabe der meisten Vertex-Shader darin, „Objekte an ihren Platz zu verschieben“.  Die Ausnahme bilden alle animierten Objekte - Menschen, Tiere sowie Objekte wie schwingende Seile, flatternde Kleidung usw. <br><br><hr><br>  Das Animieren von Menschen ist mit der Idee verbunden, ein Skelett und eine „Haut“ zu verwenden.  Ein Skelett ist eine einfache Beschreibung eines sich bewegenden Charakters.  In dieser Phase sind wir nicht besorgt über Schnallen, Hüte oder Jeans, die nicht animiert sind - nur wichtige Bewegungen, die für das menschliche Skelett am besten geeignet sind, sind für uns wichtig. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/bf2/ce7/f0fbf2ce7c1a0d3d287f8cc4b04b41f2.png"></div><br>  <em>Hier ist ein einfaches Skelett einer menschlichen Figur dargestellt.</em>  <em>Es wurde nicht von Watch Dogs übernommen, da das Skelett außerhalb des 3D-Editors schwer zu visualisieren ist.</em> <br><br>  <em>Bild lizenziert von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Attribution-ShareAlike CC BY-SA</a> © <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MakeHuman Team</a> 2001-2014</em> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//nXYWZOr/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Dies ist eine Snap-Pose oder T-Pose, die zeigt, wie ein Charakter ohne Verwendung von Animationen aussieht.</em> <br><br>  Animationen - Laufen, Gehen, Springen - gelten nur für dieses Skelett.  Dies macht den gesamten Prozess sehr einfach, da wir nur etwa hundert Knochen anstelle von Tausenden und Abertausenden von Eckpunkten berücksichtigen müssen. <br><br>  Nach dem Erstellen des Skeletts wird jeder Scheitelpunkt in dieser statischen Pose an einem oder mehreren Knochen befestigt, und diese Verbindung wird als "Enthäuten" bezeichnet.  Zum Zeitpunkt der Halbwertszeit 1, als diese Technologie eingesetzt wurde, war jeder Scheitelpunkt nur einem Knochen zugeordnet.  Heutzutage können sie sogar vier Knochen verbinden, während jedem Knochen ein Gewicht gegeben wird, von dem der Grad des Einflusses des Knochens auf die Spitze abhängt.  Dank dieser Funktion erhalten Sie eine flüssigere Animation, bei der sich die Knochen in verschiedenen Bereichen schneiden können, ohne dass beim Bewegen von Armen oder Beinen scharfe Winkel entstehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e5/af5/e31/7e5af5e314bf44d7f9098941be6eacbc.png"></div><br>  <em>Dies ist das oben gezeigte Skelett mit gedrehtem Oberschenkelknochen.</em>  <em>Die Farben zeigen das Gewicht des Hüftknochens relativ zu den Oberseiten des Modells.</em> <br><br>  <em>Bild lizenziert von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Attribution-ShareAlike CC BY-SA</a> © <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MakeHuman Team</a> 2001-2014</em> <br><br>  Diese Technologie hat ihre Grenzen, insbesondere an Stellen, an denen Kleidung und Haut in Scharnieren zusammengedrückt oder gedehnt werden, beispielsweise an Ellbogen und Schultern.  Dies ist eine unvollständige, aber sehr effektive Art zu animieren.  Die schwerwiegendste Einschränkung besteht darin, dass es sehr schwierig ist, auf diese Weise überzeugende Gesichtsanimationen zu erstellen.  Sie können viele „falsche“ Knochen auf Ihrem Gesicht erzeugen, zum Beispiel für die Augenbrauen und um den Mund herum, aber dies ist nur eine grobe Annäherung an Muskeln und Haut. <br><br>  Ein weiteres wichtiges Merkmal dieser Technik ist, dass der Scheitelpunkt- und Knochenvergleich sehr spezifisch ist und damit zusammenhängt, wie dieser Vergleich durchgeführt wird.  Es ist möglich, Animationen für mehrere verschiedene Modelle zu verwenden, aber jedes einzelne Modell, in dem Sie das Skelett verwenden möchten, muss mit Knochen verknüpft sein.  Der Grund ist, dass die Animationen die Eckpunkte von ihrer ursprünglichen Position relativ zu ihren Skeletten verschieben.  Wenn sich die Eckpunkte nicht an den erwarteten Positionen befinden, treten Probleme auf. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//JdJEwEW/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Wenn das Modell nicht mit dem von ihr verwendeten Skelett übereinstimmt, sind die Animationen <u>völlig</u> falsch.</em> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//Wt5PSQY/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Wenn wir den Charakter doppelt so breit machen, erhalten wir einen ähnlichen Effekt wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Drakes "überfressende Donuts"</a> , aber es fällt auf, dass die Animationen, die näher an den Pinseln liegen, falsch werden, da sie hier am weitesten von ihren ursprünglichen Positionen entfernt sind.</em> <br><br>  Die erste Animation mag Ihnen seltsam erscheinen - solche Pannenanimationen treten in Spielen sehr häufig auf.  Normalerweise werden sie dadurch verursacht, dass falsche Animationen auf das Skelett angewendet werden oder das Modell das falsche Skelett verwendet.  Wie bei Texturen und Modellen müssen Skelett, Haut und Modell sehr sorgfältig verglichen werden, da sich die Ergebnisse sonst schnell als traurig herausstellen. <br><br>  Ich hoffe, Sie haben eine Vorstellung vom Zweck von Vertex-Shadern und verstehen, wie Animationen verwendet werden, um ein statisches Modell in einen lebenden Charakter zu verwandeln. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430930/">https://habr.com/ru/post/de430930/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430918/index.html">Über Flutter, kurz: Grundlagen</a></li>
<li><a href="../de430922/index.html">Berechnungsbeispiel für Schalttafel</a></li>
<li><a href="../de430924/index.html">Ada Programmierung</a></li>
<li><a href="../de430926/index.html">Die Zeit ist fragmentiert; ein bisschen über die Ähnlichkeit verteilter Systeme und ein schwaches Speichermodell</a></li>
<li><a href="../de430928/index.html">Nur zum "Smart Home": Wie man eine "intelligente" Hintergrundbeleuchtung macht</a></li>
<li><a href="../de430932/index.html">Hacker haben einer russischen Bank mehr als 21 Millionen Rubel gestohlen</a></li>
<li><a href="../de430934/index.html">Asterisk Dialplan-Erweiterungsmaskengenerator</a></li>
<li><a href="../de430936/index.html">DEFCON 21. DNS-Konferenzen können gesundheitsschädlich sein. Teil 2</a></li>
<li><a href="../de430938/index.html">So erhalten Sie die ersten Aufträge im Design, wenn kein Portfolio und keine Erfahrung vorhanden sind</a></li>
<li><a href="../de430940/index.html">SDK für Sie, SDK für mich, SDK für alle! Wie erstelle ich ein SDK und warum wird es benötigt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>