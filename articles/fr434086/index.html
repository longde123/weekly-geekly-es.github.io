<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÖøÔ∏è üôáüèæ üëÉüèæ D√©ploiement int√©gr√© Windows et Linux ‚úñÔ∏è üë®üèº‚Äçüíª ‚õΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article d√©crit comment d√©ployer rapidement un syst√®me embarqu√© bas√© sur Windows 10 et Debian Linux. Des exemples de construction d'une interface s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©ploiement int√©gr√© Windows et Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434086/">  Cet article d√©crit comment d√©ployer rapidement un syst√®me embarqu√© bas√© sur Windows 10 et Debian Linux.  Des exemples de construction d'une interface s√©curis√©e sont donn√©s. <br><a name="habracut"></a><br><h1>  Pr√©sentation </h1><br><p>  Dans le processus de d√©veloppement de dispositifs dot√©s d'une interface homme-machine graphique, la t√¢che se pose t√¥t ou tard non seulement de cr√©er l'interface elle-m√™me, mais aussi de choisir la plateforme sur laquelle elle doit fonctionner.  Une telle plate-forme peut √™tre soit un ordinateur √† carte unique avec un syst√®me d'exploitation, soit un microcontr√¥leur avec un √©cran et un ensemble de biblioth√®ques pertinentes, ou une autre solution originale. </p><br><p>  Il arrive souvent qu'au niveau sup√©rieur du syst√®me de contr√¥le sur lequel l'interface s'ex√©cute, des t√¢ches de communication avec le monde ext√©rieur et l'interaction avec un large √©ventail de p√©riph√©riques sont √©galement effectu√©es.  De plus, l'interface elle-m√™me peut √™tre assez exigeante en ressources graphiques.  Compte tenu de cela, et afin d'√©conomiser les co√ªts de main-d'≈ìuvre, il est possible de prendre un ordinateur monocarte comme base et d'y installer un syst√®me d'exploitation pr√™t √† l'emploi.  Dans ce cas, le d√©veloppement logiciel peut √™tre grandement simplifi√© en utilisant des cadres modernes avec une bonne documentation et un ensemble d'exemples. </p><br><h2>  Exigences d'interface </h2><br><p>  Du point de vue de l'utilisateur, l'interface doit satisfaire aux exigences suivantes: </p><br><ul><li>  Lors du chargement en plein √©cran, une application doit appara√Ætre, c'est la m√™me interface, c'est le m√™me shell graphique; </li><li>  √Ä part cette application, rien de plus ne devrait √™tre disponible pour l'utilisateur; </li><li>  L'application doit fonctionner tout le temps, le syst√®me ne doit pas s'endormir, l'√©cran ne doit pas s'√©teindre; </li><li>  Tous les raccourcis clavier, aides, fonctions d'accessibilit√© et autres fonctions similaires doivent √™tre d√©sactiv√©s; </li><li>  En cas de d√©faillance de l'application - elle doit √™tre red√©marr√©e automatiquement par le syst√®me; </li><li>  Le syst√®me n'a pas d'exigences particuli√®res pour la vitesse ou les modes en temps r√©el, cependant, il est n√©cessaire que l'interface r√©ponde aux commandes de l'utilisateur sans retards notables; </li><li>  Le syst√®me doit √™tre r√©sistant aux red√©marrages durs r√©p√©t√©s, il ne devrait pas √™tre n√©cessaire d'ex√©cuter un script sp√©cial pour terminer le travail; </li><li>  Il devrait √™tre possible de cloner rapidement l'assemblage fini en une s√©rie d'appareils avec tous les r√©glages n√©cessaires effectu√©s en mode automatique. </li></ul><br><p>  En d'autres termes, une limitation compl√®te des actions de l'utilisateur, de la stabilit√© et de l'√©volutivit√©. </p><br><p>  Quant au syst√®me d'exploitation pour un ordinateur monocarte, nous consid√©rerons imm√©diatement deux options, l'une bas√©e sur Windows, l'autre bas√©e sur Linux, et nous les comparerons entre elles. </p><br><p>  Par exemple, cr√©ons une interface de kiosque √† √©cran tactile.  Et en tant qu'application, prenons l'un des exemples de formation Qt Quick et impl√©mentons-le avec quelques modifications.  Le framework Qt est disponible pour les deux syst√®mes d'exploitation. </p><br><p>  Afin de ne pas plonger dans les nuances de l'installation de Windows et Linux sur une plateforme ARM, le syst√®me peut √™tre facilement assembl√© sur la base d'un processeur compatible x86.  Dans ce cas, l'une des nombreuses cartes disponibles sur la plate-forme Intel Bay Trail a √©t√© utilis√©e pour des exp√©riences. </p><br><p>  Un package de tous les programmes et scripts est disponible sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> . </p><br><h1>  Chemin Windows </h1><br><p>  √Ä une certaine √©poque, Windows Embedded de Microsoft a √©t√© introduit pour cr√©er des syst√®mes embarqu√©s.  M√™me dans la premi√®re version de Windows Embedded XP, les d√©veloppeurs disposaient d'un ensemble d'outils pour assembler les plus tronqu√©s, mais √©quip√©s des pilotes d'images n√©cessaires.  Ces assemblages n√©cessitaient un minimum de RAM et fonctionnaient bien m√™me sur des processeurs faibles.  La technologie a √©t√© d√©velopp√©e dans la version de Windows Embedded Standard 7, o√π le processus de cr√©ation de vos propres assemblages a √©t√© √©voqu√©.  Windows Embedded utilisait l'id√©ologie d'un catalogue ouvert de modules, et n'importe qui pouvait √©quiper son syst√®me uniquement avec l'ensemble de composants n√©cessaire.  La derni√®re version dans laquelle cette approche √©tait disponible, bien que sous une forme tronqu√©e, est Windows Embedded Standard 8.1. </p><br><p>  Windows 10 IoT moderne est positionn√© comme une alternative √† Windows Embedded, mais est tr√®s diff√©rent de ses pr√©d√©cesseurs.  Un catalogue de composants ouvert n'est plus disponible.  La possibilit√© de collecter des images claires du concepteur et d'en faire ses propres disques d'installation a disparu.  Les options sp√©ciales d'un syst√®me int√©gr√©, comme un filtre d'enregistrement, la marque du chargeur de d√©marrage, un filtre de clavier, etc., sont d√©sormais configur√©es dans un syst√®me pr√©install√©.  De plus, la prise en charge de ces fonctions n'est disponible que dans le cadre de la version lourde de Windows 10 Enterprise. </p><br><p>  Cependant, malgr√© les exigences syst√®me √©lev√©es, en particulier en ce qui concerne la quantit√© de RAM, l'utilisation de versions m√™me lourdes dans les solutions int√©gr√©es ne pose pas de probl√®mes particuliers, principalement en raison de la disponibilit√© des composants mat√©riels.  En outre, n'oubliez pas que ces derni√®res ann√©es, il est devenu plus difficile d'acheter une licence pour les anciens produits de Microsoft. </p><br><h2>  Solution rapide </h2><br><p>  Au premier examen, il s'av√®re que m√™me dans Windows 10 ordinaire, il existe d√©j√† une fonction int√©gr√©e ¬´Acc√®s attribu√©¬ª (Fig. 1), qui ressemble √† une solution toute faite √† la t√¢che. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/t6/14/yr/t614yroc8ueu_rkh1t7srjo0cnu.png" alt="Acc√®s attribu√©"></div><p>  <i>Fig.</i>  <i>1. Fonction d'acc√®s assign√©e</i> </p><br><p>  Dans ce cas, un programme pouvant √™tre utilis√© comme interface doit √™tre initialement d√©velopp√© en tant qu'application de plateforme Windows universelle.  Ces <i>applications appx</i> sont install√©es, par exemple, sur un Windows Phone.  Une simple application plein √©cran, bien s√ªr, peut √™tre convertie en <i>appx</i> et sign√©e avec les certificats n√©cessaires, puis install√©e.  Il peut fonctionner comme une interface, mais sans protection appropri√©e.  Malheureusement, dans le mode normal "Acc√®s attribu√©", l'utilisateur a toujours un acc√®s ouvert √† certains param√®tres syst√®me et touches de raccourci.  Par cons√©quent, une interface qui r√©pond √† toutes les exigences ci-dessus ne peut pas √™tre obtenue en utilisant cette approche.  Le syst√®me doit √™tre configur√© manuellement, d'une mani√®re diff√©rente. </p><br><h2>  Bonne d√©cision </h2><br><h3>  1. Installation initiale </h3><br><p>  Donc, tout d'abord, nous avons besoin de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distribution LTSB Windows 10 Enterprise</a> .  Vous pouvez prendre l'image Microsoft d'origine, vous pouvez en utiliser une l√©g√®re ou cr√©er la v√¥tre √† l'aide d'outils tiers.  Pour la carte exp√©rimentale, l'un des assemblages pr√™ts √† l'emploi a √©t√© s√©lectionn√© (version l√©g√®re 32 bits). </p><br><p>  Nous installons le syst√®me √† partir du kit de distribution sur la carte cible.  Lors de l'installation, nous divisons le disque en deux sections, C: - pour le syst√®me, D: - pour l'application principale, les utilitaires et les journaux.  Une telle ventilation est utile √† l'avenir pour le filtre d'enregistrement.  Apr√®s l'installation, nous attendons que le menu des param√®tres apparaisse, ou nous ne continuons pas le menu avec les param√®tres r√©seau. </p><br><p>  Nous red√©marrons en mode service via Ctrl + Maj + F3. </p><br><p>  S'il n'y a pas eu d'erreurs pendant le processus d'installation, apr√®s le red√©marrage, le syst√®me lui-m√™me ira dans le compte de service de l'administrateur et la fen√™tre <i>SysPrep</i> appara√Ætra √† l'√©cran (Fig.2).  Il doit √™tre ferm√©, nous allons d√©marrer <i>SysPrep</i> diff√©remment, en utilisant un fichier de r√©ponses sp√©cial qui n'a pas encore √©t√© cr√©√©. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/kw/xn/3y/kwxn3yxs3totane-ogcok3z9bto.png" alt="Fen√™tre sysprep"></div><p>  <i>Fig.</i>  <i>2. Mode service.</i> </p><br><h3>  2. Configuration du syst√®me </h3><br><p>  Pour d'autres actions, vous aurez besoin des outils de <a href="">d√©ploiement du kit d'√©valuation et de d√©ploiement de Windows 10</a> . </p><br><p>  √Ä partir du disque sur lequel la distribution Windows est install√©e sur la carte, vous devez extraire le <i>fichier</i> image <i>install.wim</i> .  Il arrive que dans certains assemblages, ce fichier puisse √™tre stock√© sous forme compress√©e avec l'extension <i>esd</i> .  Dans ce cas, vous devez d'abord le d√©baller.  L'utilitaire <i>dism</i> est utilis√© pour cela. </p><br><p>  D√©couvrez le num√©ro de s√©rie de la version souhait√©e dans le conteneur (SourceIndex). </p><br><pre><code class="plaintext hljs">dism /Get-WimInfo /WimFile:install.esd</code> </pre> <br><p>  Ensuite, extrayez le fichier image (dans ce cas, le premier dans le conteneur). </p><br><pre> <code class="plaintext hljs">dism /export-image /SourceImageFile:install.esd /SourceIndex:1 /DestinationImageFile:install.wim /Compress:max /CheckIntegrity</code> </pre> <br><p>  Vous devez maintenant ouvrir l'image dans le Gestionnaire d'images syst√®me Windows (√† partir des outils de d√©ploiement) et g√©n√©rer un r√©pertoire. </p><br><p>  Il convient de noter que travailler avec des images dans Windows System Image Manager n'est possible que si la profondeur de bits de l'image correspond √† la profondeur de bits de l'h√¥te.  Autrement dit, il est impossible de modifier l'image de la version 32 bits dans un syst√®me 64 bits.  Ici, comme on dit, aucun commentaire. </p><br><p>  Une fois le r√©pertoire cr√©√©, modifiez le fichier de r√©ponses de l'utilitaire <i>SysPrep</i> .  Entrez les informations du propri√©taire, ajoutez les utilisateurs n√©cessaires et configurez la premi√®re connexion automatique (Fig. 3). </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/ch/fn/4f/chfn4fan0jtazdofcrskqz6dakc.png" alt="Fichier de r√©ponses"></div><p>  <i>Fig.</i>  <i>3. Cr√©ation d'un fichier de r√©ponses.</i> </p><br><p>  Cela n'a aucun sens de r√©pertorier tous les param√®tres; le contenu du fichier de r√©ponses peut √™tre trouv√© dans le r√©f√©rentiel.  L'essentiel est de ne pas oublier de d√©finir les param√®tres <i>CopyProfile</i> sur <i>true</i> , <i>SkipReam</i> sur <i>1</i> et d'activer la <i>connexion automatique</i> de l'administrateur.  Vous pouvez entrer votre cl√© de produit dans la section <i>4 specialize - Microsoft-Windows-Shell-Setup - ProductKey</i> . </p><br><h3>  3. Installation de programmes </h3><br><p>  Ensuite, vous avez besoin du <i>fichier</i> image <i>install.wim</i> r√©el, vous devez donc le placer √† c√¥t√© du fichier de r√©ponses <i>personnaliser.xml</i> , dans lequel apr√®s l'enregistrement, vous devez remplacer manuellement le chemin d'acc√®s √† l'image.  √Ä la fin du fichier, la ligne devrait ressembler √† ceci: </p><br><pre> <code class="plaintext hljs">&lt;cpi:offlineImage cpi:source="wim:d:/service/install.wim#Windows 10 Enterprise LTSB" xmlns:cpi="urn:schemas-microsoft-com:cpi" /&gt;</code> </pre> <br><p>  Pour obtenir l'interface de d√©monstration de KioskShell, vous devez cr√©er une version pour Windows √† partir des sources.  Les conseils d'assemblage se trouvent dans le r√©f√©rentiel. </p><br><p>  Nous copions les fichiers sur la carte et obtenons la structure de fichiers et de r√©pertoires suivante: </p><br><pre> <code class="plaintext hljs">C:\ ‚îî‚îÄ‚îÄ Design\ ‚îú‚îÄ‚îÄ backgroundDefault.jpg -      ( ) ‚îî‚îÄ‚îÄ oemlogo.bmp -  ,      D:\ ‚îú‚îÄ‚îÄ Logs\ -       ‚îú‚îÄ‚îÄ Service\ ‚îÇ ‚îú‚îÄ‚îÄ AfterSetup.bat -   ,     SysPrep ‚îÇ ‚îú‚îÄ‚îÄ FirstLogon.bat -        ‚îÇ ‚îú‚îÄ‚îÄ customize.xml -   ‚îÇ ‚îú‚îÄ‚îÄ install.wim -   ‚îÇ ‚îú‚îÄ‚îÄ CustomShellSetup.ps1 -  PowerShell     ‚îÇ ‚îú‚îÄ‚îÄ EnableRules.ps1 -  PowerShell     ‚îÇ ‚îú‚îÄ‚îÄ DisableAllRules.ps1 -      ( ) ‚îÇ ‚îî‚îÄ‚îÄ UserLogon.bat -      ( ) ‚îî‚îÄ‚îÄ Shell\ -     "KioskShell.exe"   </code> </pre> <br><h3>  4. Configuration manuelle du syst√®me </h3><br><p>  Lorsque le syst√®me est en mode service, vous pouvez red√©marrer autant de fois que vous le souhaitez, le syst√®me y reviendra automatiquement.  Avec un long temps d'inactivit√© avant de configurer l'alimentation, cependant, l'√©cran peut se verrouiller et ne reviendra pas, seul un red√©marrage vous aidera.  √âtant donn√© que chaque projet sp√©cifique peut avoir ses propres fonctionnalit√©s de configuration, il est pr√©f√©rable de le faire manuellement, mais vous pouvez √©galement utiliser des scripts d'automatisation. </p><br><p>  Nous installons les composants n√©cessaires du syst√®me int√©gr√© et d√©sactivons le contr√¥le des comptes d'utilisateurs (voir <i>AfterSetup.bat</i> depuis le r√©f√©rentiel) </p><br><p>  Installez tous les pilotes, configurez le mat√©riel (carte r√©seau IP, r√©solution et orientation de l'√©cran, ports des p√©riph√©riques externes, etc.), d√©sactivez les touches r√©manentes et toutes les fonctionnalit√©s sp√©ciales. </p><br><p>  Puisqu'√† l'avenir, j'aimerais pouvoir administrer √† distance, nous autoriserons l'acc√®s via RDP.  Le mot de passe administrateur expirera √† l'√©tape de configuration automatique. </p><br><p>  Ensuite, vous devez d√©sactiver les mises √† jour syst√®me dans l' <i>√©diteur de strat√©gie de groupe local</i> (dans la section <i>Configuration ordinateur - Mod√®les d'administration - Composants Windows - Windows Update</i> , vous devez d√©finir les <i>mises</i> √† <i>jour automatiques configur√©es</i> sur <i>D√©sactiv√©</i> ).  En outre, vous devez √©galement d√©sactiver l'analyse automatique de Windows Update (dans le planificateur de t√¢ches de la section <i>Microsoft - Windows - UpdateOrchestrator,</i> vous devez d√©sactiver toutes les t√¢ches), sinon une fen√™tre noire appara√Ætra √† chaque d√©marrage, et lorsque vous vous connecterez √† Internet, Windows peut soudainement commencer la mise √† jour. </p><br><p>  Ensuite, configurez les param√®tres d'alimentation.  Pour ce faire, vous devez d'abord rendre tous les param√®tres d'alimentation visibles dans la section <i>Param√®tres avanc√©s d'alimentation</i> (pour cela, dans le registre de chaque sous-cl√© dans <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Power \ PowerSettings \ 238C9FA8-0AAD-41ED-83F4-97BE242C8F20,</i> si vous avez le param√®tre <i>Attributes</i> , vous devez affecter valeur pour lui <i>2</i> ).  Maintenant que tous les param√®tres sont disponibles, d√©sactivez le mode veille, le mode absence, supprimez l'action sur le bouton d'alimentation (sauf si, bien s√ªr, vous en avez besoin autrement) et d√©sactivez le minuteur d'autorisation lorsqu'il est inactif.  Ensuite, nous supprimons le mode veille avec la connexion (dans la section <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Power</i> , vous devez d√©finir le param√®tre <i>CsEnabled</i> sur <i>0</i> ).  Si n√©cessaire, d√©sactivez le contr√¥le adaptatif de la luminosit√© de l'√©cran. </p><br><p>  Lorsque tous les param√®tres syst√®me sont termin√©s, nous avons la derni√®re possibilit√© d'apporter des modifications, car la deuxi√®me ex√©cution du script <i>AfterSetup.bat</i> d√©marrera le m√©canisme de configuration automatique √† l'aide de <i>SysPrep</i> , qui ne peut pas √™tre arr√™t√©.  Vous devez toujours vous rappeler d'activer le syst√®me (il est sugg√©r√© de vous familiariser avec les options d'activation pour les versions d'entreprise de Windows).  M√™me √† ce stade, vous pouvez faire une copie de sauvegarde de l'int√©gralit√© du disque et corriger l'√©tat pr√©liminaire de l'image en cas de modifications futures. </p><br><p>  √Ä la fin du travail, <i>SysPrep</i> ne red√©marrera pas, mais √©teindra l'ordinateur - √† ce stade, vous pouvez cr√©er une image d√©j√† op√©rationnelle, pr√™te pour le portage vers une s√©rie. </p><br><h3>  5. Configuration finale du syst√®me automatique </h3><br><p>  Apr√®s le premier chargement de l'image de travail (voir <i>FirstLogon.bat √†</i> partir du r√©f√©rentiel), l'interface s√©curis√©e sera configur√©e, la <i>connexion automatique</i> sera reconfigur√©e sur le compte <i>utilisateur</i> et les raccourcis clavier susceptibles de briser le syst√®me seront d√©sactiv√©s.  Ensuite, le filtre d'√©criture unifi√© sera configur√© et activ√©.  Dans ce cas, le filtre est configur√© pour prot√©ger toutes les partitions √† l'exception des dossiers <i>Service</i> et <i>Logs</i> et utilise un swap de 256 Mo.  Le syst√®me red√©marrera plusieurs fois et, si tout est fait correctement, au prochain d√©marrage, une interface s√©curis√©e appara√Ætra, lanc√©e au nom du compte <i>utilisateur</i> . </p><br><p>  Pour entretenir le syst√®me sur site, il est possible d'acc√©der √† l'√©cran de connexion et, par exemple, de se connecter au compte administrateur.  Dans Windows 10, une m√©thode standard est fournie pour cela, vous devez appuyer sur la touche ¬´Win¬ª 5 fois de suite. </p><br><h1>  Chemin Linux </h1><br><p>  Il n'y a pas de moyen standard unique de cr√©er des syst√®mes embarqu√©s avec une interface graphique bas√©e sur Linux.  Comme il n'y a pas de distribution commune unique, il s'agit tout de m√™me d'une famille de syst√®mes cr√©√©s selon des principes compl√®tement diff√©rents.  Le sujet le plus proche peut sembler √™tre le projet Yocto Linux.  Cependant, il est assez difficile de collecter des images remplies d'applications, de pilotes et de biblioth√®ques tierces.  Pour r√©soudre ce probl√®me, il est plus facile de prendre une distribution pr√™te √† l'emploi et bien prise en charge et de la configurer manuellement. </p><br><h2>  Solution simple </h2><br><h3>  1. Installation initiale </h3><br><p>  Donc, tout d'abord, nous avons besoin de la distribution elle-m√™me, par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Debian</a> .  Vous pouvez en prendre un autre, vous pouvez faire le v√¥tre.  L'essentiel est que la distribution ne dispose pas d'un syst√®me de mise √† jour automatique.  Pour la carte exp√©rimentale, Debian Linux 9 (version 64 bits, noyau 4.9) a √©t√© choisie. </p><br><p>  Nous installons le syst√®me de mani√®re traditionnelle.  Lors de l'installation, nous avons divis√© le disque en deux sections, sda1 - <i>/</i> pour le syst√®me, sda2 - <i>/ var / log</i> pour les <i>journaux</i> syst√®me et logiciels.  Une telle ventilation est utile √† l'avenir pour le filtre d'enregistrement.  Installez l' <i>interface graphique xfce</i> standard et le serveur <i>ssh</i> .  Nous ajoutons l' <i>administrateur</i> lors de l'installation de l'utilisateur et d√©finissons le mot de passe. </p><br><p>  Apr√®s l'installation, la premi√®re chose du compte <i>root</i> est d'ajouter l'utilisateur <i>administrateur</i> au groupe <i>sudo</i> . </p><br><pre> <code class="plaintext hljs">apt install sudo adduser administrator sudo</code> </pre> <br><p>  Nous entrons dans le syst√®me sous l' <i>administrateur</i> du nom d'utilisateur et ajoutons un nouvel utilisateur <i>utilisateur</i> . </p><br><pre> <code class="plaintext hljs">sudo useradd -m user</code> </pre> <br><p>  Pour plus de commodit√©, vous pouvez supprimer compl√®tement le mot de passe pour lui, car l'acc√®s √† ce compte sera toujours ferm√© partout. </p><br><pre> <code class="plaintext hljs">sudo passwd -d user</code> </pre> <br><h3>  2. Configuration du syst√®me </h3><br><p>  Nous installons les pilotes, les progiciels, les programmes suppl√©mentaires selon vos besoins. </p><br><p>  Pour activer l'administration √† distance √† l'avenir, si n√©cessaire, vous pouvez installer et configurer le serveur <i>vnc</i> .  Cependant, dans ce cas, cela n'a aucun sens, car toutes les t√¢ches administratives peuvent √™tre facilement effectu√©es via la console, et pour cela, seul l'acc√®s via <i>ssh est</i> suffisant. </p><br><p>  Linux a la possibilit√© d'utiliser diff√©rents gestionnaires de fen√™tres pour diff√©rents utilisateurs.  Pour que l'interface utilisateur fonctionne, installez un gestionnaire minimaliste avec la possibilit√© d'affiner.  Et pour la configuration, vous aurez besoin de quelques applications suppl√©mentaires. </p><br><pre> <code class="plaintext hljs">sudo apt install fluxbox arandr plymouth</code> </pre> <br><p>  En utilisant <i>arandr,</i> vous pouvez modifier la r√©solution et l'orientation de l'√©cran, si n√©cessaire, puis enregistrer la configuration sous forme de script (Fig. 4). </p><br><p><img src="https://habrastorage.org/webt/fm/qo/nw/fmqonwqu3j3rua5xd_nr9zbj4p4.png" alt="Param√®tres d'√©cran set_resolution.sh"></p><br><p>  Fig.  4. Param√®tres d'√©cran. </p><br><p>  Ensuite, vous devez vous connecter au syst√®me une fois sous le compte d'utilisateur, apr√®s avoir s√©lectionn√© <i>Fluxbox</i> install√© pr√©c√©demment comme gestionnaire de fen√™tres, puis vous d√©connecter √† nouveau.  Ceci est n√©cessaire pour que <i>Fluxbox cr√©e</i> au premier d√©marrage tous les fichiers de param√®tres et soit s√©lectionn√© comme gestionnaire standard pour le compte <i>utilisateur</i> (voir le fichier <i>.dmrc</i> dans le r√©pertoire personnel de l' <i>utilisateur</i> ). </p><br><p>  Vous devez maintenant configurer <i>fluxbox</i> pour r√©pondre aux exigences d'interface d√©crites ci-dessus.  Pour ce faire, d√©sactivez le panneau <i>session.screen0.toolbar.visible</i> dans <i>/home/user/.fluxbox/init</i> <i>: false</i> , commentez tous les raccourcis clavier √† l'exception des boutons de volume dans <i>/home/user/.fluxbox/keys</i> et dans <i>/ home / user /. fluxbox / startup</i> ajoute le lancement du script de configuration d'√©cran, d√©sactivant les fonctions d'√©conomie d'√©nergie du moniteur et l'ex√©cution automatique de l'application plein √©cran.  Le script red√©marrera l'application en cas d'√©chec inattendu. </p><br><pre> <code class="plaintext hljs">set_resolution.sh xset -dmps s off /home/user/autostart.sh &amp;</code> </pre><br><p>  Vous devez maintenant acc√©l√©rer le processus de d√©marrage du syst√®me et le cacher √† l'utilisateur.  Pour ce faire, d√©finissez <i>GRUB_TIMEOUT = 0</i> dans <i>/ etc / default / grub et</i> d√©finissez <i>quiet_boot = "1"</i> dans <i>/etc/grub.d/10_linux</i> .  Pour afficher l'animation lors du chargement dans les param√®tres du noyau <i>GRUB_CMDLINE_LINUX,</i> vous devez ajouter l'option <i>splash</i> , et si l'orientation de l'√©cran change, l' <i>option fbcon = rotation: 1</i> ou <i>fbcon = rotation: 3</i> , selon la direction.  Si n√©cessaire, vous pouvez modifier la r√©solution et l'orientation sur l'√©cran de connexion.  Pour cela, <i>display-setup-script = set_resolution.sh</i> doit √™tre sp√©cifi√© dans <i>/etc/lightdm/lightdm.conf</i> .  Et si vous devez masquer le curseur, ajoutez alors <i>xserver-command = X -core -nocursor</i> . </p><br><p>  Nous choisirons un style d'animation de chargement. </p><br><pre> <code class="plaintext hljs">sudo plymouth-set-default-theme -R text</code> </pre> <br><p>  Et enfin, corrigez tous les changements. </p><br><pre> <code class="plaintext hljs">sudo update-grub2</code> </pre> <br><h3>  3. Installation de programmes </h3><br><p>  Pour obtenir l'interface de d√©monstration de KioskShell, vous devez cr√©er une version Linux √† partir des sources.  Les conseils d'assemblage se trouvent dans le r√©f√©rentiel. </p><br><p>  Nous copions les fichiers sur la carte et obtenons la structure de fichiers et de r√©pertoires suivante: </p><br><pre> <code class="plaintext hljs">/ ‚îú‚îÄ‚îÄ usr/ -      "KioskShell"    ‚îú‚îÄ‚îÄ local/ ‚îÇ ‚îî‚îÄ‚îÄ bin/ ‚îÇ ‚îî‚îÄ‚îÄ set_resolution.sh ‚îî‚îÄ‚îÄ home/ ‚îú‚îÄ‚îÄ administrator/ ‚îÇ ‚îî‚îÄ‚îÄ relogin.sh -       ‚îî‚îÄ‚îÄ user/ ‚îî‚îÄ‚îÄ autostart.sh -    </code> </pre> <br><h3>  4. Configuration finale du syst√®me </h3><br><p>  √Ä ce stade, vous pouvez faire une copie de sauvegarde de l'int√©gralit√© du disque et corriger l'√©tat pr√©liminaire de l'image en cas de modifications futures. </p><br><p>  Configurez la connexion automatique sous le compte utilisateur, pour cela, d√©finissez <i>autologin-user = user</i> dans <i>/etc/lightdm/lightdm.conf</i> . </p><br><p>  D√©finissez maintenant la protection en √©criture. </p><br><pre> <code class="plaintext hljs">sudo apt install bilibop</code> </pre> <br><p>  Lors de l'installation, s√©lectionnez la <i>carte dynamique des faux appareils</i> . </p><br><p>  Modifiez le fichier de param√®tres <i>/etc/bilibop/bilibop.conf</i> .  Nous <i>activons</i> le module avec le param√®tre <i>BILIBOP_LOCKFS = "true"</i> et ajoutons une section avec des logs aux exceptions <i>BILIBOP_LOCKFS_WHITELIST = "/ var / log"</i> .  <i>Activons</i> la possibilit√© de d√©sactiver temporairement la protection si n√©cessaire <i>BILIBOP_LOCKFS_POLICY = "soft"</i> .  Et comme il n'y a pas de chiffrement dans le syst√®me, vous devez d√©finir <i>BILIBOP_LOCKFS_SWAP_POLICY = "soft"</i> . </p><br><p>  Nous red√©marrons le syst√®me et, si tout est fait correctement, une interface s√©curis√©e appara√Æt, lanc√©e au nom du compte utilisateur. </p><br><p>  La derni√®re √©tape peut √™tre facilement automatis√©e pour obtenir un syst√®me avec une configuration automatique au premier d√©marrage.  Cela cr√©era une distribution pour la mise √† l'√©chelle sur plusieurs appareils (ce m√©canisme est propos√© pour √™tre mis en ≈ìuvre ind√©pendamment). </p><br><p>  Pour r√©parer le syst√®me en place, il est possible d'acc√©der √† l'√©cran de connexion et de se connecter au compte administrateur.  Sous Linux, vous devez d'abord acc√©der √† la console via Ctrl + Alt + F1.  Apr√®s vous √™tre connect√© au compte administrateur, forcez l'utilisateur <i>utilisateur</i> √† se d√©connecter du syst√®me. </p><br><pre> <code class="plaintext hljs">sudo skill -KILL -u user</code> </pre> <br><p>  Revenez ensuite en mode graphique via Ctrl + Alt + F7 et reconnectez-vous en tant qu'administrateur. </p><br><h1>  Conclusions </h1><br><p>  Quel que soit le chemin choisi, le r√©sultat final est le m√™me r√©sultat.  Avec une configuration appropri√©e, l'interface utilisateur r√©pondra √† toutes les exigences d√©crites ci-dessus.  Seules les diff√©rences visuelles sont possibles, associ√©es, en r√®gle g√©n√©rale, aux fonctionnalit√©s de rendu des √©l√©ments graphiques en utilisant l'acc√©l√©ration mat√©rielle sur diff√©rentes plates-formes. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/rm/nk/1-/rmnk1-wetcbmnk4qnwng5ztxdri.png" alt="Application shell prot√©g√©"></div><p>  Fig.  5. L'interface est op√©rationnelle. </p><br><p></p><p>  √âtant donn√© que la base du syst√®me est un ordinateur √† carte unique, l'installation d'un √©cran tactile ou d'autres commandes ne posera aucun probl√®me.  Si vous disposez de l'application appropri√©e, sur cette base, vous pouvez cr√©er non seulement la console de contr√¥le ou le tableau de bord interactif de l'appareil, mais √©galement d'autres appareils, par exemple des terminaux d'informations ou de trading. </p><br><h2>  Probl√®me de choix </h2><br><p>  Il y a une opinion que Linux est tr√®s difficile √† configurer et √† maintenir, mais en m√™me temps, il est gratuit, et Windows est simple et pratique, mais cela co√ªte de l'argent.  C'est peut-√™tre vrai, mais seulement au niveau des m√©nages.  Lorsqu'il s'agit de cr√©er des syst√®mes embarqu√©s, d'autres circonstances doivent √™tre prises en compte.  Par exemple, affiner Windows, en particulier en termes de gestion de l'alimentation et d'autres √©l√©ments de bas niveau, ne semble plus simple et pratique.  De plus, n'oubliez pas que Windows 10 est assez gourmand en ressources.  Dans cet exemple, il √©tait possible de mesurer la consommation de m√©moire d'un syst√®me propre plusieurs fois, et elle √©tait d'environ 400 Mo en mode inactif.  √Ä titre de comparaison, Linux Debian avec tous ses modules compl√©mentaires occupait environ 200 Mo de m√©moire.  Bien s√ªr, si vous avez plusieurs gigaoctets de RAM, ce n'est pas un probl√®me, mais quand vous utilisez Windows et des applications clientes tr√®s charg√©es, vous devez prendre des ordinateurs √† carte unique plus puissants.  Linux est moins exigeant en ressources, mais vraiment difficile √† configurer et n√©cessite une approche soign√©e, en particulier lorsque vous travaillez avec le chargeur de d√©marrage.  De plus, lors du d√©veloppement et de l'impl√©mentation de certains √©l√©ments dans le syst√®me, il est parfois n√©cessaire d'assembler votre propre noyau avec des param√®tres sp√©ciaux.  Il est efficace, mais n√©cessite un niveau de comp√©tence appropri√©. </p><br><p>  Il est difficile de faire un choix sans ambigu√Øt√© dans le cadre de la cr√©ation d'une interface s√©curis√©e.  La complexit√© du d√©ploiement de syst√®mes est √† peu pr√®s la m√™me.  Le co√ªt d'acquisition de licences Windows pour une s√©rie d'instruments peut √™tre √©gal au co√ªt de maintenance des syst√®mes sous Linux.  Quel syst√®me choisir, vous d√©cidez. </p><br><p>  Diverses interfaces homme-machine bas√©es sur les exemples d√©crits ont √©t√© introduites par l'auteur dans des dispositifs √©lectroniques pour une grande vari√©t√© d'applications et ont prouv√© leur op√©rabilit√© dans le monde r√©el. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr434086/">https://habr.com/ru/post/fr434086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr434076/index.html">Pourquoi en Russie il n'y a pas de secret bancaire</a></li>
<li><a href="../fr434078/index.html">Il suffit de prendre et de faire: un nouveau podcast sur des projets √©ditoriaux et une carri√®re dans les m√©dias</a></li>
<li><a href="../fr434080/index.html">Comment arr√™ter d'√©crire le firmware des microcontr√¥leurs. Nous commen√ßons √† vivre ...</a></li>
<li><a href="../fr434082/index.html">Un r√©seau de neurones d√©velopp√© par des scientifiques russes a appris √† d√©terminer l'√¢ge √† partir de la vid√©o avec un haut degr√© de pr√©cision</a></li>
<li><a href="../fr434084/index.html">Une voiture du film "Men in Black" (1997) peut-elle franchir le plafond du tunnel?</a></li>
<li><a href="../fr434088/index.html">Comment aider les employ√©s distants √† √©viter la solitude et l'√©puisement professionnel</a></li>
<li><a href="../fr434090/index.html">Pr√©sentation d'un transistor √† vide: un appareil fabriqu√© √† partir de vide</a></li>
<li><a href="../fr434092/index.html">Les gens qui ont sauv√© 1968</a></li>
<li><a href="../fr434096/index.html">Heisenbug 2018 Moscou: une vue de la foule</a></li>
<li><a href="../fr434098/index.html">Post et pr√©-traitement CSS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>