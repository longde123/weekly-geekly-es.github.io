<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЩНЁЯП┐ ЁЯМ╣ ЁЯдЩЁЯП╝ ClickHouse рдореЗрдВ рдХреНрд╡реЗрд░реА рдкреНрд░рджрд░реНрд╢рди рд╡рд┐рд╢реНрд▓реЗрд╖рдгред рдпреИрдВрдбреЗрдХреНрд╕ рд░рд┐рдкреЛрд░реНрдЯ ЁЯзЩ ЁЯЧпя╕П ЁЯТЗЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрджрд┐ рдЖрдкрдХреА рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА рдкрд░реНрдпрд╛рдкреНрдд рддреЗрдЬрд╝реА рд╕реЗ рдирд╣реАрдВ рдЪрд▓ рд░рд╣реА рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛? рдЖрдкрдХреЛ рдХреИрд╕реЗ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛ рдХрд┐ рдХреЛрдИ рдХреНрд╡реЗрд░реА рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдмреЗрд╣рддрд░ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ClickHouse рдореЗрдВ рдХреНрд╡реЗрд░реА рдкреНрд░рджрд░реНрд╢рди рд╡рд┐рд╢реНрд▓реЗрд╖рдгред рдпреИрдВрдбреЗрдХреНрд╕ рд░рд┐рдкреЛрд░реНрдЯ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/459198/">  рдпрджрд┐ рдЖрдкрдХреА рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА рдкрд░реНрдпрд╛рдкреНрдд рддреЗрдЬрд╝реА рд╕реЗ рдирд╣реАрдВ рдЪрд▓ рд░рд╣реА рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛?  рдЖрдкрдХреЛ рдХреИрд╕реЗ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛ рдХрд┐ рдХреЛрдИ рдХреНрд╡реЗрд░реА рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдмреЗрд╣рддрд░ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдЗрд╕реЗ рддреНрд╡рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ?  рдореЙрд╕реНрдХреЛ рдореЗрдВ рдкрд┐рдЫрд▓реЗ рд╣рд╛рдИрд▓рд╛рдб ++ рд╕рдореНрдореЗрд▓рди рдореЗрдВ, рдореИрдВрдиреЗ рдХреНрд╡реЗрд░реА рдкреНрд░рджрд░реНрд╢рди рдХреЗ рдЖрддреНрдордирд┐рд░реАрдХреНрд╖рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА - рджреЛрдиреЛрдВ ClickHouse DBMS рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдУрдПрд╕ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬреЛ рд╕рднреА рдХреЛ рдкрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><img src="https://habrastorage.org/webt/mi/yo/wu/miyowuhgorpfpl9zih8cszids0y.jpeg"><br><br>  рдЬрдм рднреА рдореИрдВ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реВрдВ, рдореИрдВ рди рдХреЗрд╡рд▓ рдкрд░рд┐рдгрд╛рдо рд╕реЗ рдЪрд┐рдВрддрд┐рдд рд╣реВрдВ, рдмрд▓реНрдХрд┐ рдпрд╣ рднреА рдХрд╣рддрд╛ рд╣реВрдВ рдХрд┐ рдпрд╣ рдЕрдиреБрд░реЛрдз рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рдПрдХ рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдмрд╣реБрдд рд╣реИ рдпрд╛ рдереЛрдбрд╝рд╛ рд╣реИ?  рдореИрдВ рд╣рдореЗрд╢рд╛ рд╕реЛрдЪрддрд╛ рд╣реВрдВ: рдЖрдзрд╛ рд╕реЗрдХрдВрдб рдХреНрдпреЛрдВ рдирд╣реАрдВ?  рдлрд┐рд░ рдореИрдВ рдХреБрдЫ рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░рддрд╛ рд╣реВрдВ, рдЗрд╕реЗ рдЧрддрд┐ рджреЗрддрд╛ рд╣реВрдВ, рдФрд░ рдпрд╣ 10 рдПрдордПрд╕ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдореИрдВ рдЖрдорддреМрд░ рдкрд░ рд╕рдВрддреБрд╖реНрдЯ рд╣реВрдВред  рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдореИрдВ рдПрдХ рдирд╛рд░рд╛рдЬ рдЪреЗрд╣рд░реЗ рдХреА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдВ рдФрд░ рдкреВрдЫрддрд╛ рд╣реВрдВ: "5 рдПрдордПрд╕ рдХреНрдпреЛрдВ рдирд╣реАрдВ?"  рдореИрдВ рдпрд╣ рдХреИрд╕реЗ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реВрдВ рдХрд┐ рдЕрдиреБрд░реЛрдз рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдХреНрдпрд╛ рд╕рдордп рд╡реНрдпрддреАрдд рд╣реЛрддрд╛ рд╣реИ?  рдХреНрдпрд╛ рдЗрд╕реЗ рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ рддреНрд╡рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ? <br><br><a name="habracut"></a>  рдЖрдорддреМрд░ рдкрд░, рдЕрдиреБрд░реЛрдз рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдЧрддрд┐ рд╕рд░рд▓ рдЕрдВрдХрдЧрдгрд┐рдд рд╣реИред  рд╣рдордиреЗ рдХреЛрдб рд▓рд┐рдЦрд╛ рдерд╛ - рд╢рд╛рдпрдж рдЖрд╢рд╛рд╡рд╛рджреА рд░реВрдк рд╕реЗ - рдФрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреБрдЫ рдбрд┐рд╡рд╛рдЗрд╕ рд╣реИред  рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, L1 рдХреИрд╢ рд╕реЗ рдкрдврд╝рдиреЗ рдХреА рдЧрддрд┐ред  рдпрд╛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдкрдврд╝рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдПрд╕рдПрд╕рдбреА рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рд╣рдо рд╕рднреА рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ред  рд╣рдореЗрдВ рдЗрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рд▓реЗрдирд╛, рдЬреЛрдбрд╝рдирд╛, рдШрдЯрд╛рдирд╛, рдЧреБрдгрд╛ рдХрд░рдирд╛, рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдирд╛ рдФрд░ рдЙрддреНрддрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рд▓реЗрдХрд┐рди рдпрд╣ рдЖрджрд░реНрд╢ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣реИ, рдпрд╣ рд▓рдЧрднрдЧ рдХрднреА рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рд▓рдЧрднрдЧред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдХрднреА-рдХрднреА ClickHouse рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред <br><br>  рд╣рдорд╛рд░реЗ рд╕рд░реНрд╡рд░ рдореЗрдВ рдХреМрди рд╕реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдФрд░ рдХреМрди рд╕реЗ рд╕рдВрд╕рд╛рдзрди рд╣реИрдВ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рддреБрдЪреНрдЫ рддрдереНрдпреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред <br><br><img src="https://habrastorage.org/webt/6e/gz/us/6egzusxqlzhg81ledkch36wrld4.jpeg" width="700"><br><br>  рдкреНрд░реЛрд╕реЗрд╕рд░, рдореЗрдореЛрд░реА, рдбрд┐рд╕реНрдХ, рдиреЗрдЯрд╡рд░реНрдХред  рдореИрдВрдиреЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд┐рдпрд╛, рд╕рдмрд╕реЗ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдФрд░ рдЬрдЯрд┐рд▓ рдФрд░ рд╕рдореАрдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдФрд░ рд╕рдмрд╕реЗ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдФрд░ рдЬрдЯрд┐рд▓ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореИрдВ рдПрдХ рдЕрдиреБрд░реЛрдз рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реВрдВ рдФрд░ рджреЗрдЦрддрд╛ рд╣реВрдВ рдХрд┐ рдореЗрд░рд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕реАрдкреАрдпреВ рдкрд░ рдЖрд░рд╛рдо рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рдХрд╛ рдХреНрдпрд╛ рдорддрд▓рдм рд╣реИ?  рдореБрдЭреЗ рдХреНрдпрд╛ рдорд┐рд▓реЗрдЧрд╛ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдВрддрд░рд┐рдХ рд▓реВрдк рд╣реИрдВ, рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдЬрд┐рд╕реЗ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреЛрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛, рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛, рдФрд░ рдПрдХ рдмрд╛рд░ - рдореЗрд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рддреЗрдЬреА рд╕реЗ рдЪрд▓рддрд╛ рд╣реИред <br><br>  рдпрджрд┐ рдЖрдк рдмрд╣реБрдд рдЕрдзрд┐рдХ рд░реИрдо рдЦрд░реНрдЪ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рдм рдХреБрдЫ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред  рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдкрд░ рдкреБрдирд░реНрд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ, рдХреБрдЫ рдмрд┐рдЯреНрд╕ рдХреЛ рдирд┐рдЪреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, рдореИрдВ рдЕрдкрдиреЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реВрдВ, рдФрд░ рдпрд╣ рдХрдо рд░реИрдо рдЦрд░реНрдЪ рдХрд░рддрд╛ рд╣реИред  рд╕рдЪ рд╣реИ, рдпрд╣ рдЕрдХреНрд╕рд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреА рдЧрд┐рд░рд╛рд╡рдЯ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИред <br><br>  рдпрджрд┐ рд╕рдм рдХреБрдЫ рдбрд┐рд╕реНрдХ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдФрд░ рднреА рдореБрд╢реНрдХрд┐рд▓ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдореИрдВ рдбрд┐рд╕реНрдХ рдкрд░ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реВрдВ, рд▓реЗрдХрд┐рди рдореБрдЭреЗ рдмрд╛рдж рдореЗрдВ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред  рдЕрдЧрд░ рдореИрдВ рдПрдХ рдирдИ рд░рд┐рд▓реАрдЬрд╝ рдХрд░рддрд╛ рд╣реВрдВ, рддреЛ рд▓реЛрдЧреЛрдВ рдХреЛ рдХрд┐рд╕реА рддрд░рд╣ рдХрд╛ рдбреЗрдЯрд╛ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдбрд┐рд╕реНрдХ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╕реЛрдЪрдирд╛ рдмреЗрд╣рддрд░ рд╣реИред <br><br>  рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ ... рдореБрдЭреЗ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдкрд╕рдВрдж рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрдХреНрд╕рд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдЗрд╕рдореЗрдВ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдЕрдЧрд░ рдпрд╣ рдбреЗрдЯрд╛ рд╕реЗрдВрдЯрд░реЛрдВ рдХреЗ рдмреАрдЪ, рдорд╣рд╛рджреНрд╡реАрдкреЛрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИред  рд╡рд╣рд╛рдБ рдХреБрдЫ рдзреАрдорд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдпрд╣ рдЖрдкрдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рднреА рдирд╣реАрдВ рд╣реИ, рдЖрдкрдХрд╛ рд╕рд░реНрд╡рд░ рднреА рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЖрдк рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдХреЗрд╡рд▓ рдПрдХ рдЪреАрдЬ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╕реЛрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбреЗрдЯрд╛ рдХреИрд╕реЗ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдмрд╛рддрдЪреАрдд рдХреЛ рдХреИрд╕реЗ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛рдПред <br><br>  рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рднреА рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдмрд╕ рдХреБрдЫ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдПрдХ рдмрд╣реБрдд рд╣реА рд▓рдЧрд╛рддрд╛рд░ рдорд╛рдорд▓рд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реА рдкреНрд░рдгрд╛рд▓реА рд╡рд┐рддрд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдФрд░ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдФрд░ рдкреНрд░рд╡рд╛рд╣ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХреБрдЫ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рд╕рдм рдареАрдХ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рди рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдПрдХ рджреВрд╕рд░реЗ рд╕реЗ рдЬреБрдбрд╝реЗ рд░рд╣рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/vq/mk/sa/vqmksaynboi4frop2kzfcvk9q4w.jpeg" width="700"><br><br>  рд╕рдмрд╕реЗ рд╕рд░рд▓ рдмрд╛рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ, рдХреБрдЫ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдореВрд▓реНрдп рдкрд░ рджреЗрдЦрдирд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдХреБрдЫ рд╢реАрд░реНрд╖ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рд╡рд╣ рд▓рд┐рдЦрддреЗ рд╣реИрдВ: рдкреНрд░реЛрд╕реЗрд╕рд░ 100% рд╣реИред  рдпрд╛ iostat рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рдФрд░ рд╡рд╣ рд▓рд┐рдЦрддреЗ рд╣реИрдВ: рдбрд┐рд╕реНрдХ 100% рд╣реИрдВред  рд╕рдЪ рд╣реИ, рдпрд╣ рдЕрдХреНрд╕рд░ рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдпрд╣ рджреЗрдЦреЗрдЧрд╛ рдХрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдо рдбрд┐рд╕реНрдХ рдкрд░ рдЯрд┐рдХреА рд╣реБрдИ рд╣реИред  рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ?  рдЖрдк рдмрд╕ рдЗрд╕реЗ рдиреЛрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрд░рд╛рдо рдХрд░рдиреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рддрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕рдм рдХреБрдЫ, рдХреБрдЫ рднреА рдЕрдиреБрдХреВрд▓рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛рдлреА рдЬрдЯрд┐рд▓ рд╣реИред  рдкреНрд░реЛрд╕реЗрд╕рд░ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдПрдХ рд╕рдореВрд╣ рд╣реИред  рдбрд┐рд╕реНрдХ рдореЗрдВ RAID рд╕рд░рдгреА рд╣реЛ рд╕рдХрддреА рд╣реИред  рдпрджрд┐ рдХреЛрдИ рдПрд╕рдПрд╕рдбреА рд╣реИ, рддреЛ рдЙрд╕рдХреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдкреНрд░реЛрд╕реЗрд╕рд░, рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рдЕрдВрджрд░ рд╣реИ, рдЬреЛ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╣реИред  рдФрд░ рдПрдХ рдорд╛рди - 50% рдпрд╛ 100% - рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИред  рдореВрд▓ рдирд┐рдпрдо: рдпрджрд┐ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреБрдЫ рд╕рдВрд╕рд╛рдзрди 100% рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рд╛рд░ рди рдорд╛рдиреЗрдВред  рдЕрдХреНрд╕рд░, рдЖрдк рдЕрднреА рднреА рдХреБрдЫ рд╕реБрдзрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрддред  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд░реАрд╕рд╛рдЗрдХреНрд▓рд┐рдВрдЧ 50% рд╣реИ, рд▓реЗрдХрд┐рди рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЖрдЗрдП рдЗрд╕ рдкрд░ рдХрд░реАрдм рд╕реЗ рдирдЬрд╝рд░ рдбрд╛рд▓рддреЗ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/pa/wj/uo/pawjuoieudajqc097ysekq30wnc.jpeg" width="700"><br><br>  рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рдФрд░ рд╕рдмрд╕реЗ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╕рдВрд╕рд╛рдзрди рдкреНрд░реЛрд╕реЗрд╕рд░ рд╣реИред  рдЖрдк рдКрдкрд░ рджреЗрдЦрддреЗ рд╣реИрдВ, рдпрд╣ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░реЛрд╕реЗрд╕рд░ 100% рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдпрд╣ 100% рдкреНрд░реЛрд╕реЗрд╕рд░ рдирд╣реАрдВ рд╣реИред  рд╢реАрд░реНрд╖ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╡рд╣рд╛рдВ рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИред  рд╡рд╣ рдУрдПрд╕ рдкреНрд▓рд╛рдирд░ рдХреЗ рдирдЬрд░рд┐рдП рд╕реЗ рджреЗрдЦрддреА рд╣реИред  рдпрд╣реА рд╣реИ, рдЕрдм рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдереНрд░реЗрдб рдЪрд▓ рд░рд╣рд╛ рд╣реИред  рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреБрдЫ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЕрдЧрд░ рд╕рдордп рдХреЗ рд╕рд╛рде рдФрд╕рдд рд╣реЛ рддреЛ 100% рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдЗрд╕реА рд╕рдордп, рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреБрдЫ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ рдкреНрд░рднрд╛рд╡реА рд╣реИред  рдпрд╣ рдкреНрд░рддрд┐ рдЪрдХреНрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рдПрдХ рдЕрд▓рдЧ рд╕рдВрдЦреНрдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдпрджрд┐ рдХреБрдЫ рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВ, рддреЛ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕реНрд╡рдпрдВ рдХрд┐рд╕реА рдЪреАрдЬ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореЗрдореЛрд░реА рд╕реЗ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдирд╛ред  рдЙрд╕реА рд╕рдордп, рдПрдХ рд╣реА рдЪреАрдЬрд╝ рдХреЛ рд╢реАрд░реНрд╖ - 100% рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╣рдо рдЕрдкрдиреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдФрд░ рдЬреЛ рд╡рд╣ рдЕрдВрджрд░ рдХрд░рддрд╛ рд╣реИ рд╡рд╣ рдЕрд╕реНрдкрд╖реНрдЯ рд╣реИред <br><br>  рдЕрдВрдд рдореЗрдВ, рд╕рд┐рд░реНрдл рдПрдХ рд░реЗрдХ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ рд╣реИред  рдпрд╣ рд╕рдЪ рд╣реИ, рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреА рдЖрд╡реГрддреНрддрд┐ рдХрдо рд╣реЛрддреА рд╣реИред  рдЗрд╕рдХреЗ рдХрдИ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ: рдЕрдзрд┐рдХ рдЧрд░реНрдореА, рдмрд┐рдЬрд▓реА рдХреА рдХрдореАред  рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ, рдбреЗрдЯрд╛ рд╕реЗрдВрдЯрд░ рдореЗрдВ рдмрд┐рдЬрд▓реА рдХреА рдХрдореА рд╣реЛрддреА рд╣реИ, рдпрд╛ рдКрд░реНрдЬрд╛ рдХреА рдмрдЪрдд рдХреЛ рдмрд╕ рдЪрд╛рд▓реВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдлрд┐рд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рд▓рдЧрд╛рддрд╛рд░ рдЙрдЪреНрдЪ рдЖрд╡реГрддреНрддрд┐ рд╕реЗ рдирд┐рдореНрдирддрд░ рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдкрдХрд╛ рд▓реЛрдб рдЕрд╕реНрдерд┐рд░ рд╣реИ, рддреЛ рдпрд╣ рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдФрд░ рдФрд╕рддрди рдХреЛрдб рдЕрдзрд┐рдХ рдзреАрд░реЗ-рдзреАрд░реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛ред  рд╡рд░реНрддрдорд╛рди рдкреНрд░реЛрд╕реЗрд╕рд░ рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдЯрд░реНрдмреЛрд╕реИрдЯ рджреЗрдЦреЗрдВред  Dmesg рдореЗрдВ overheating рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВред  рдЕрдЧрд░ рдРрд╕рд╛ рдХреБрдЫ рд╣реБрдЖ рд╣реИ, рддреЛ рдпрд╣ рдХрд╣реЗрдВрдЧреЗ: тАЬрдУрд╡рд░рд╣реАрдЯрд┐рдВрдЧред  рдЖрд╡реГрддреНрддрд┐ рдиреАрдЪреЗред тАЭ <br><br>  рдпрджрд┐ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рддрдиреЗ рдХреИрд╢ рдорд┐рд╕ рдХреЗ рдЕрдВрджрд░ рдереЗ, рддреЛ рдкреНрд░рддрд┐ рдЪрдХреНрд░ рдХрд┐рддрдиреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкрд░рдлреЗрдХреНрдЯ рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  рдХрд╛рд░реНрдпрдХреНрд░рдо рдХрд╛ рдХреБрдЫ рдирдореВрдирд╛ рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдкрд░рдлреИрдХреНрдЯ рд╕реНрдЯреЗрдЯ рдпрд╛ рдкрд░рдлреЗрдХреНрдЯ рд░рд┐рдкреЛрд░реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рджреЗрдЦрдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ред <br><br><img src="https://habrastorage.org/webt/hl/4v/up/hl4vupofzsuha-s7cyxtba-po0c.jpeg" width="600"><br><br>  рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрддред  рдорд╛рди рд▓реЗрдВ рдХрд┐ рдЖрдк рд╢реАрд░реНрд╖ рдкрд░ рджреЗрдЦрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░реЛрд╕реЗрд╕рд░ 50% рд╕реЗ рдХрдо рдкреБрдирд░реНрдирд╡реАрдиреАрдХрд░рдг рд╣реИред  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ 32 рд╡рд░реНрдЪреБрдЕрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛрд░ рдФрд░ 16 рднреМрддрд┐рдХ рдХреЛрд░ рд╣реИрдВред рдЗрдВрдЯреЗрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░, рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рд╛рдЗрдкрд░-рдереНрд░реЗрдбрд┐рдВрдЧ рдбрдмрд▓ рд╣реИред  рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЛрд░ рдмреЗрдХрд╛рд░ рд╣реИрдВред  рдпрд╣ рд╕рдм рднрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рд░реИрдЦрд┐рдХ рдмреАрдЬрдЧрдгрд┐рдд рд╕рдВрдЪрд╛рд▓рди рд╣реИрдВ рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЦрдирди рдмрд┐рдЯрдХреЙрдЗрди рдХреЗ рд▓рд┐рдП рд╣реИрд╢ рд╣реИред  рдлрд┐рд░ рдХреЛрдб рд╕реНрдкрд╖реНрдЯ рд╣реЛрдЧрд╛, рдкреНрд░рддрд┐ рдЪрдХреНрд░ рдХрдИ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдХреЛрдИ рдХреИрд╢ рдорд┐рд╕ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рд╢рд╛рдЦрд╛ рдЧрд▓рддрдлрд╣рдореА рднреА рд╣реЛрдЧреАред  рдФрд░ рд╣рд╛рдЗрдкрд░-рдереНрд░реЗрдбрд┐рдВрдЧ рдорджрдж рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдХреЛрд░ рдХреБрдЫ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рджреВрд╕рд░рд╛ рдПрдХ рд╕рд╛рде рджреВрд╕рд░реЗ рдзрд╛рдЧреЗ рд╕реЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдХреНрд▓рд┐рдХрд╣рд╛рдЙрд╕ рдореЗрдВ рджреЛрдиреЛрдВ рд╕реНрдерд┐рддрд┐рдпрд╛рдВ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рд╣рдо рдбреЗрдЯрд╛ рдПрдХрддреНрд░реАрдХрд░рдг (рдЧреНрд░реБрдк рдмрд╛рдп) рдХрд░рддреЗ рд╣реИрдВ рдпрд╛ рд╕реЗрдЯ (рдЗрди рд╕рдмрдХреНрд╡реЗрд░реА) рджреНрд╡рд╛рд░рд╛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╣реИрд╢ рддрд╛рд▓рд┐рдХрд╛ рд╣реЛрдЧреАред  рдпрджрд┐ рд╣реИрд╢ рдЯреЗрдмрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреИрд╢ рдореЗрдВ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдХреИрд╢ рдорд┐рд╕ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред  рдЗрд╕рд╕реЗ рд╢рд╛рдпрдж рд╣реА рдмрдЪрд╛ рдЬрд╛ рд╕рдХреЗред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рд╛рдЗрдкрд░-рдереНрд░реЗрдбрд┐рдВрдЧ рд╣рдорд╛рд░реА рдорджрдж рдХрд░реЗрдЧреАред <br><br>  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, ClickHouse рд╣рд╛рдЗрдкрд░-рдереНрд░реЗрдбрд┐рдВрдЧ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдХреЗрд╡рд▓ рднреМрддрд┐рдХ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХрд╛ рдЕрдиреБрд░реЛрдз рд╣рд╛рдЗрдкрд░-рдереНрд░реЗрдбрд┐рдВрдЧ рд╕реЗ рд▓рд╛рднрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдХреЗрд╡рд▓ рдереНрд░реЗрдбреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЛрдЧреБрдиреА рдХрд░реЗрдВ: SET рдЕрдзрд┐рдХрддрдо рдереНрд░реЗрдб = 32, рдФрд░ рдЖрдкрдХрд╛ рдЕрдиреБрд░реЛрдз рдЕрдзрд┐рдХ рддреЗрдЬрд╝ рд╣реЛрдЧрд╛ред <br><br>  рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЧреНрд░рд╛рдл рдХреЛ рджреЗрдЦреЗрдВ рдФрд░ рджреЗрдЦреЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 10%ред  рдФрд░ рдЖрдкрдХрд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рд╣реИред  рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рдпрд╣ рдПрдХ-рд╕реЗрдХрдВрдб рд╣реИ, рддрдм рднреА рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдФрд╕рдд рдореВрд▓реНрдп рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЖрдкрдХреЗ рдкрд╛рд╕ рд▓рдЧрд╛рддрд╛рд░ рдЕрдиреБрд░реЛрдз рдереЗ, рд╡реЗ рдЬрд▓реНрджреА рд╕реЗ 100 рд╕реЗрдХрдВрдб рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдХрдВрдб рдореЗрдВ, рдФрд░ рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╣реИред  рдХреНрдпреЛрдВрдХрд┐ ClickHouse рдЕрдиреБрд░реЛрдз рдХреЛ рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред  рд╡рд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдФрд░ рд▓рдЧрд╛рддрд╛рд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдФрд░ рдЕрдкрдиреЗ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рдЧрд░реНрдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/39/ka/ei/39kaeie-ngofbbynsnlq4mum_d0.jpeg" width="700"><br><br>  рдЖрдЗрдП, рдереЛрдбрд╝рд╛ рдЬрдЯрд┐рд▓ рд╡рд┐рдХрд▓реНрдк рджреЗрдЦреЗрдВред  рдЙрдкрд╢рдо рдореЗрдВ рдПрдХ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдХреНрд╡реЗрд░реА рд╣реИред  рдЙрдкрдХреБрдВрдЬреА рдХреЗ рдЕрдВрджрд░, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ 100 рдорд┐рд▓рд┐рдпрди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛рдПрдВ рд╣реИрдВред  рдФрд░ рд╣рдо рд╕рд┐рд░реНрдл рдЗрд╕ рдкрд░рд┐рдгрд╛рдо рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдРрд╕реА рддрд╕реНрд╡реАрд░ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВред  рд╡реИрд╕реЗ, рдЗрд╕ рдЕрджреНрднреБрдд рддрд╕реНрд╡реАрд░ рдХреЛ рдореИрдВ рдХрд┐рд╕ рдЯреВрд▓ рд╕реЗ рджреЗрдЦреВрдВрдЧрд╛?  рдмрд┐рд▓реНрдХреБрд▓ рд╕рдЪ - рдкреВрд░реНрдгред  рдореБрдЭреЗ рдмрд╣реБрдд рдЦреБрд╢реА рд╣реИ рдХрд┐ рдЖрдк рдпрд╣ рдЬрд╛рдирддреЗ рд╣реИрдВред <br><br>  рдореИрдВрдиреЗ рдкрд░рдлреЗрдХреНрдЯ рдЦреЛрд▓рд╛, рдпрд╣ рд╕реЛрдЪрдХрд░ рдХрд┐ рдЕрдм рдореИрдВ рд╕рдм рдХреБрдЫ рд╕рдордЭ рдЧрдпрд╛ рд╣реВрдБред  рдореИрдВ рдХреЛрдбрд╛рдВрддрд░рдХ рд╕реВрдЪреА рдЦреЛрд▓рддрд╛ рд╣реВрдВред  рд╡рд╣рд╛рдБ рдореИрдВрдиреЗ рд▓рд┐рдЦрд╛ рдХрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдирд┐рд░реНрджреЗрд╢ рдкрд░ рдХрд┐рддрдиреА рдмрд╛рд░ рд╣реБрдЖ рдерд╛, рдпрд╛рдиреА рдХрд┐рддрдиреА рдмрд╛рд░ рдирд┐рд░реНрджреЗрд╢ рд╕реВрдЪрдХ рдерд╛ред  рдпрд╣рд╛рдВ рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рддрд┐рд╢рдд рдореЗрдВ рд╣реИ, рдФрд░ рдпрд╣ рд▓рд┐рдЦрд╛ рд╣реИ рдХрд┐ рдкрд░реАрдХреНрд╖рдг% edx,% edx рдирд┐рд░реНрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рдХреЗ рд▓рдЧрднрдЧ 90%, рдпрд╛рдиреА рд╢реВрдиреНрдп рдХреЗ рд▓рд┐рдП рдЪрд╛рд░ рдмрд╛рдЗрдЯреНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ред <br><br>  рд╕рд╡рд╛рд▓ рдпрд╣ рд╣реИ: рдПрдХ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рдХреЗрд╡рд▓ рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде рдЪрд╛рд░ рдмрд╛рдЗрдЯреНрд╕ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдореЗрдВ рдЗрддрдирд╛ рд╕рдордп рдХреНрдпреЛрдВ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ?  (рджрд░реНрд╢рдХреЛрдВ рд╕реЗ рдЬрд╡рд╛рдм ...) рд╡рд┐рднрд╛рдЬрди рдХрд╛ рдХреЛрдИ рд╢реЗрд╖ рдирд╣реАрдВ рд╣реИред  рдереЛрдбрд╝рд╛ рдмрджрд▓рд╛рд╡ рд╣реЛрддрд╛ рд╣реИ, рдлрд┐рд░ crc32q рдирд┐рд░реНрджреЗрд╢ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдорд╛рдиреЛ рдЕрдиреБрджреЗрд╢ рд╕реВрдЪрдХ рдЙрд╕ рдкрд░ рдХрднреА рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдФрд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдкреАрдврд╝реА рдЗрд╕ рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рд╣реИред  рдПрдХ рдЕрд▓рдЧ рдлрд╝рдВрдХреНрд╢рди рдерд╛, рдФрд░ рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИ, рдпрд╣ рдзреАрдорд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдпрд╣рд╛рдВ рдХреБрдЫ рдФрд░ рдзреАрдорд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИред  рдЗрд╕ рдирд┐рд░реНрджреЗрд╢ рдкрд░ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдмрд╣реБрдд рд╕рдордп рд╡реНрдпрддреАрдд рд╣реЛрддрд╛ рд╣реИред  рдирд┐рд╖реНрдХреНрд░рд┐рдп рдкрд╛рд╢?  рдирд╣реАрдВред  рдореБрдЭреЗ рдЦрд╛рд▓реА рд▓реВрдк рдХреНрдпреЛрдВ рдбрд╛рд▓рдирд╛ рдЪрд╛рд╣рд┐рдП?  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдЧрд░ рдореИрдВрдиреЗ рдЖрдЗрдбрд▓ рд▓реВрдк рдбрд╛рд▓рд╛ рд╣реИ, рддреЛ рдпрд╣ рднреА рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред  рд╢реВрдиреНрдп рд╕реЗ рдХреЛрдИ рд╡рд┐рднрд╛рдЬрди рдирд╣реАрдВ рд╣реИ, рдмрд╕ рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рд╣реИред <br><br>  рдкреНрд░реЛрд╕реЗрд╕рд░ рдореЗрдВ рдПрдХ рдкрд╛рдЗрдк рд▓рд╛рдЗрди рд╣реИ, рдпрд╣ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдХрдИ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдФрд░ рдЬрдм рдирд┐рд░реНрджреЗрд╢ рд╕реВрдЪрдХ рдХреБрдЫ рдЬрдЧрд╣ рдкрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╡рд╣ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИред  рд╢рд╛рдпрдж рд╡рд╣ рдХреБрдЫ рдЕрдиреНрдп рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИред <br><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реИрд╢ рддрд╛рд▓рд┐рдХрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рд╕реЗрдЯ рдореЗрдВ рдХреБрдЫ рд╕рдВрдЦреНрдпрд╛ рд╣реЛрддреА рд╣реИред  рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕реНрдореГрддрд┐ рдореЗрдВ рдПрдХ рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВред  рдЬрдм рд╣рдо рдореЗрдореЛрд░реА рдореЗрдВ рд▓реБрдХрдЕрдк рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреИрд╢ рдорд┐рд╕ рд╣реЛрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣реИрд╢ рдЯреЗрдмрд▓ рдореЗрдВ 100 рдорд┐рд▓рд┐рдпрди рдирдВрдмрд░ рд╣реЛрддреЗ рд╣реИрдВ, рдпрд╣ рдХрд┐рд╕реА рднреА рдХреИрд╢ рдореЗрдВ рдлрд┐рдЯ рд╣реЛрдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╢реВрдиреНрдп рдЬрд╛рдВрдЪ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдбреЗрдЯрд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдореЗрдореЛрд░реА рд╕реЗ рд▓реЛрдб рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдФрд░ рд╣рдо рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рд╡реЗ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/w9/7b/ed/w97bediv43zlhfvat95k7qdar3k.jpeg" width="700"><br><br>  рдЕрдм рдЕрдЧрд▓рд╛ рд╕рдВрд╕рд╛рдзрди, рдереЛрдбрд╝рд╛ рдФрд░ рдЬрдЯрд┐рд▓ - рдбреНрд░рд╛рдЗрд╡ред  рдПрд╕рдПрд╕рдбреА рдХреЛ рдХрднреА-рдХрднреА рдбреНрд░рд╛рдЗрд╡ рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рд╣реА рдирд╣реАрдВ рд╣реИред  рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ SSD рдХреЛ рднреА рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рд╣рдо рдЦреЛрд▓рддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, iostat, рдпрд╣ 100% рдХрд╛ рдЙрдкрдпреЛрдЧ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред <br><br>  рд╕рдореНрдореЗрд▓рдиреЛрдВ рдореЗрдВ, рдЕрдХреНрд╕рд░ рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╕реНрдкреАрдХрд░ рдордВрдЪ рдкрд░ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкрд╛рдереЛрд╕ рдХреЗ рд╕рд╛рде рдХрд╣рддрд╛ рд╣реИ: тАЬрдбреЗрдЯрд╛рдмреЗрд╕ рд╣рдореЗрд╢рд╛ рдбрд┐рд╕реНрдХ рдХреЛ рдирд┐рд░рд╕реНрдд рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рд╣рдордиреЗ рдЗрди-рдореЗрдореЛрд░реА рдбреЗрдЯрд╛рдмреЗрд╕ рдмрдирд╛рдпрд╛ред  рд╡рд╣ рдзреАрдорд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред тАЭ  рдпрджрд┐ рдХреЛрдИ рд╡реНрдпрдХреНрддрд┐ рдЖрдкрд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдРрд╕рд╛ рдХрд╣рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред  рдХреБрдЫ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реЛрдВрдЧреА - рдЖрдк рдХрд╣рддреЗ рд╣реИрдВ, рдореИрдВрдиреЗ рдЗрд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ред  :) <br><br>  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдбрд┐рд╕реНрдХ рдкрд░ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧ 100 рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╣рдо рдбрд┐рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрд╢рд╛рд╡рд╛рджреА рддрд░реАрдХреЗ рд╕реЗ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрджрд╛рд╣рд░рдг рддрдм рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкрд╣реБрдВрдЪ рд╣реИред  рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рдкрд╣реБрдВрдЪ рдЕрдиреБрдХреНрд░рдорд┐рдХ рд╣реИ, рддреЛ рдЖрдк рдмрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдкрдврд╝рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрднреА рднреА рдЕрдзрд┐рдХ рдпрд╛ рдХрдо рдЗрд╖реНрдЯрддрдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ RAID рд╕рд░рдгреА, рдХрдИ рдЙрдкрдХрд░рдг рд╣реИрдВ - рдХрд╣рддреЗ рд╣реИрдВ, 8 рдбрд┐рд╕реНрдХред  рдФрд░ рдЖрдк рдмрд┐рдирд╛ рдЕрдиреБрдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдкрдврд╝реЗ рдЖрдЧреЗ рдкрдврд╝реЗ, 1 рдПрдордмреА рдХреЗ рдмрдлрд░ рд╕рд╛рдЗрдЬрд╝ рдХреЗ рд╕рд╛рде, рдФрд░ RAID рдореЗрдВ рдЖрдкрдХреЗ рд╕реНрдЯреНрд░рд╛рдЗрдк рдореЗрдВ рдЪрдВрдХ рд╕рд╛рдЗрдЬрд╝ рднреА 1 рдПрдордмреА рд╣реИред  рдлрд┐рд░ рдкреНрд░рддреНрдпреЗрдХ рд░реАрдбрд┐рдВрдЧ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рд╣реЛрдЧреАред  рдпрд╛, рдпрджрд┐ рджреЛ рдЙрдкрдХрд░рдгреЛрдВ рд╕реЗ рд╕рдВрд░реЗрдЦрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЖрдзрд╛ рдореЗрдЧрд╛рдмрд╛рдЗрдЯ рдХрд╣реАрдВ рдФрд░ рдЬрд╛рдПрдЧрд╛, рдПрдХ рдФрд░ рдЖрдзрд╛ рдореЗрдЧрд╛рдмрд╛рдЗрдЯ рдХрд╣реАрдВ, рдФрд░ рдЗрд╕реА рддрд░рд╣ - рдбрд┐рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрджрд▓реЗ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: рдПрдХ, рдлрд┐рд░ рджреВрд╕рд░рд╛, рдлрд┐рд░ рдПрдХ рддреАрд╕рд░рд╛ред <br><br>  рдЗрд╕реЗ рдЖрдЧреЗ рдкрдврд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред  рдпрд╛, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ O_DIRECT рд╣реИ, рддреЛ рдмрдлрд╝рд░ рдХрд╛ рдЖрдХрд╛рд░ рдмрдврд╝рд╛рдПрдБред  рдпрд╣реА рд╣реИ, рдирд┐рдпрдо рд╣реИ: 8 рдбрд┐рд╕реНрдХ, рдЪрдВрдХ рдЖрдХрд╛рд░ 1 рдПрдордмреА, рдмрдлрд░ рдЖрдХрд╛рд░ рдХреЛ рдХрдо рд╕реЗ рдХрдо 8 рдПрдордмреА рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред  рд▓реЗрдХрд┐рди рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЬрдм рд░реАрдбрд┐рдВрдЧ рд╕рдВрд░реЗрдЦрд┐рдд рд╣реЛред  рдФрд░ рдЕрдЧрд░ рд╕рдВрд░реЗрдЦрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдкрд╣рд▓реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдЯреБрдХрдбрд╝реЗ рд╣реЛрдВрдЧреЗ, рдФрд░ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдбрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреБрдЫ рдФрд░ рдЧреБрдгрд╛ рдХрд░реЗрдВред <br><br>  рдпрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЗ рдкрд╛рд╕ рд╣реИ RAID 10. рдЖрдк рдХрд┐рд╕ рдЧрддрд┐ рд╕реЗ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ RAID 10 - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 8 рдбрд┐рд╕реНрдХ рд╕реЗ?  рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдлрд╛рдпрджрд╛?  рдЪреМрдЧреБрдирд╛, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рджрд░реНрдкрдг рд╣реИ, рдпрд╛ рдЖрда рдЧреБрдирд╛?  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдЗрд╕ рдмрд╛рдд рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ RAID рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдзрд╛рд░рд┐рдпреЛрдВ рдореЗрдВ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рд╣реИред <br><br>  рдпрджрд┐ рдЖрдк рд▓рд┐рдирдХреНрд╕ рдкрд░ mdadm рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд▓реЗрдЦрди рдХреЗ рд▓рд┐рдП рдмреЗрд╣рддрд░ рд╣реЛрдиреЗ, рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд░ рд╣реЛрдиреЗ рдХреЗ рд╕рд╛рде, рд▓реЗрдЖрдЙрдЯ рдФрд░ рджреВрд░ рдХреЗ рд▓реЗрдЖрдЙрдЯ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдореИрдВ рд╣рдореЗрд╢рд╛ рджреВрд░ рд▓реЗрдЖрдЙрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдЖрдк рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рд╕рдордп рдореЗрдВ рдЗрддрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ - рднрд▓реЗ рд╣реА рдкрдврд╝рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд▓реЗрдЦрди рд╣реЛред  рдпрд╣ рдХреБрдЫ рдкреГрд╖реНрдарднреВрдорд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЬрдм рдЖрдк рдкрдврд╝рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ рдЬрд▓реНрдж рд╕реЗ рдЬрд▓реНрдж рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЗрд╕рд▓рд┐рдП рджреВрд░ рдХреЗ рд▓реЗрдЖрдЙрдЯ рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП RAID рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред <br><br>  рдЬреИрд╕рд╛ рдХрд┐ рднрд╛рдЧреНрдп рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рд▓рд┐рдирдХреНрд╕ рдореЗрдВ mdadm рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд▓реЗрдЖрдЙрдЯ рдХреЗ рдирд┐рдХрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдЧрд╛, рдФрд░ рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдЖрдзрд╛ рдкреНрд░рджрд░реНрд╢рди рдорд┐рд▓реЗрдЧрд╛ред  рдмрд╣реБрдд рд╕рд╛рд░реА рдРрд╕реА рд░реЗрдХ рд╣реИрдВред <br><br>  рдПрдХ рдФрд░ рднрдпрд╛рдирдХ рд░реЗрдХ рд╣реИ RAID 5 рдпрд╛ RAID 6. рд╕рдм рдХреБрдЫ рд╡рд╣рд╛рдБ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рд▓рд┐рдЦрддрд╛ рд╣реИред  RAID 5 рдореЗрдВ, рдмрд╣реБрд▓рддрд╛ "рдЙрдкрдХрд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╢реВрдиреНрдп рд╕реЗ рдПрдХ рд╣реИред"  рдпрд╣ рд░реИрдВрдбрдо рд░реАрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рднреА рдЕрдЪреНрдЫрд╛ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд░реИрдВрдбрдо рд░реАрдбреНрд╕ рдХреЗ рд╕рд╛рде рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдХрд┐рд╕реА рднреА рдПрдХ рд╕реНрдерд╛рди рдкрд░ рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдПрдВ, рдФрд░ рдЖрдкрдХреЛ рдЕрдиреНрдп рд╕рднреА рдбрд┐рд╕реНрдХ рд╕реЗ рдбреЗрдЯрд╛ рдкрдврд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рдЙрдиреНрд╣реЗрдВ рдкреЛрдХрд╕реЛрд░рд┐рдЯ рдХрд░реЗрдВ (рдПрдХреНрд╕ - рд▓рдЧрднрдЧред рдПрдбред) рдФрд░ рджреВрд╕рд░реА рдЬрдЧрд╣ рд▓рд┐рдЦреЗрдВред  рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╕реНрдЯреНрд░рд┐рдкреНрд╕ рдХреЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдХреИрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рднрдпрд╛рдирдХ рд░реЗрдХред  рд▓рд┐рдирдХреНрд╕ рдореЗрдВ, рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдРрд╕рд╛ рд╣реИ рдХрд┐ рдЖрдк RAID 5 рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдЖрдкрдХреЗ рд▓рд┐рдП рдзреАрдорд╛ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред  рдФрд░ рдЖрдк рд╕реЛрдЪреЗрдВрдЧреЗ рдХрд┐ RAID 5 рд╣рдореЗрд╢рд╛ рдзреАрдорд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдЧрд▓рдд рд╕реЗрдЯрдЕрдк рд╣реИред <br><br>  рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдгред  рдЖрдк рдПрдХ рдПрд╕рдПрд╕рдбреА рд╕реЗ рдкрдврд╝ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рдЖрдкрдиреЗ рдЦреБрдж рдХреЛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдПрд╕рдПрд╕рдбреА рдЦрд░реАрджрд╛ рд╣реИ, рдпрд╣ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 300 рд╣рдЬрд╛рд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкрдврд╝рддрд╛ рд╣реИред  рдФрд░ рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдЖрдк рдРрд╕рд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ  рдФрд░ рдЖрдк рд╕реЛрдЪрддреЗ рд╣реИрдВ - рд╣рд╛рдБ рд╡реЗ рд╕рднреА рдЕрдкрдиреЗ рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдореЗрдВ рдЭреВрда рдмреЛрд▓рддреЗ рд╣реИрдВ, рдРрд╕реА рдХреЛрдИ рдмрд╛рдд рдирд╣реАрдВ рд╣реИред  рд▓реЗрдХрд┐рди рдЗрди рд╕рднреА рд░реАрдбрд┐рдВрдЧ рдХреЛ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд╕рдорд╛рдирддрд╛ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ I / O рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ io_submit, io_getevents, io_setup, рдЖрджрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рд╡реИрд╕реЗ, рдбрд┐рд╕реНрдХ рдкрд░ рдбреЗрдЯрд╛, рдпрджрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдореИрдВ рдЕрднреНрдпрд╛рд╕ рд╕реЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреВрдВрдЧрд╛ред  рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдиреЗ рд╣рдорд╕реЗ рдХреНрд▓рд┐рдХрд╣рд╛рдЙрд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдорд░реНрдерди рдЪреИрдЯ</a> рдореЗрдВ рд╕рдВрдкрд░реНрдХ рдХрд┐рдпрд╛ рдФрд░ рдХрд╣рд╛: <br><br>  - ClickHouse рдбреЗрдЯрд╛ рдХреЛ рдХрдВрдкреНрд░реЗрд╕ рдХрд░рддрд╛ рд╣реИред  рдореИрдВ рджреЗрдЦрддрд╛ рд╣реВрдВ рдХрд┐ рдпрд╣ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ рдЯрд┐рдХреА рд╣реБрдИ рд╣реИред  рдореЗрд░реЗ рдкрд╛рд╕ рдмрд╣реБрдд рддреЗрдЬ NVMe SSDs рд╣реИрдВ, рдЙрдирдХреЗ рдкрд╛рд╕ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдХрдИ рдЧреАрдЧрд╛рдмрд╛рдЗрдЯ рдХреА рд░реАрдбрд┐рдВрдЧ рд╕реНрдкреАрдб рд╣реИред  рдХреНрдпрд╛ рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ ClickHouse рдореЗрдВ рд╕рдореНрдкреАрдбрди рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдП? <br>  "рдирд╣реАрдВ, рдХреЛрдИ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ," рдореИрдВ рдХрд╣рддрд╛ рд╣реВрдБред  - рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br>  - рдЗрд╕реЗ рдмрдВрдж рдХрд░ рджреЗрдВ, рдмрд╕ рдПрдХ рдФрд░ рд╕рдВрдкреАрдбрд╝рди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдЬреЛ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред <br>  - рдЖрд░рд╛рдо рд╕реЗред  рдЗрди рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рдХреЛрдб рдХреА рдЗрд╕ рдкрдВрдХреНрддрд┐ рдореЗрдВ рджрд░реНрдЬ рдХрд░реЗрдВред <br>  "рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ," рдЙрд╕рдиреЗ рдПрдХ рджрд┐рди рдмрд╛рдж рдЬрд╡рд╛рдм рджрд┐рдпрд╛ред  - рдореИрдВрдиреЗ рдХрд┐рдпрд╛ред <br>  - рдкреНрд░рджрд░реНрд╢рди рдХрд┐рддрдирд╛ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ? <br>  "рдкрд░реАрдХреНрд╖рдг рдореЗрдВ рдЕрд╕рдлрд▓," рдЙрдиреНрд╣реЛрдВрдиреЗ рдПрдХ рджрд┐рди рдмрд╛рдж рд▓рд┐рдЦрд╛ред  - рдмрд╣реБрдд рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рд╣реИред  рд╡реЗ рдЕрдм SSDs рдкрд░ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реИрдВред <br><br>  рдЖрдЗрдП рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдбрд┐рд╕реНрдХ рд╕реЗ рдХреНрдпрд╛ рдкрдврд╝рдирд╛ рдкрд╕рдВрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдо dstat рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рдкрдврд╝рдиреЗ рдХреА рдЧрддрд┐ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">Dstat рдФрд░ iostat рдХрд╛ рдкрд╣рд▓рд╛ рдЙрджрд╛рд╣рд░рдг</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tp/bv/hc/tpbvhccpx_oezqb-bl61xfhcrtq.gif"><br></div></div><br>  рдпрд╣рд╛рдВ рдкрдврд╝рд╛ рдЧрдпрд╛ рдХреЙрд▓рдо рд╣реИ - 300 рдПрдордмреА / рдПрд╕ред  рд╣рдо рдбрд┐рд╕реНрдХ рд╕реЗ рдкрдврд╝рддреЗ рд╣реИрдВред  рдпрд╣ рдмрд╣реБрдд рдпрд╛ рдереЛрдбрд╝рд╛ рд╣реИ - рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ред <br><br>  рдЕрдм рдореИрдВ рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП iostat рдЪрд▓рд╛рддрд╛ рд╣реВрдВред  рдпрд╣рд╛рдВ рдЖрдк рдбрд┐рд╡рд╛рдЗрд╕ рджреНрд╡рд╛рд░рд╛ рдмреНрд░реЗрдХрдбрд╛рдЙрди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдореЗрд░реЗ рдкрд╛рд╕ RAID, md2 рдФрд░ рдЖрда рд╣рд╛рд░реНрдб рдбреНрд░рд╛рдЗрд╡ рд╣реИрдВред  рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд░реАрд╕рд╛рдЗрдХреНрд▓рд┐рдВрдЧ рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рдпрд╣ 100% (50-60%) рддрдХ рднреА рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдореИрдВ рдкреНрд░рддреНрдпреЗрдХ рдбрд┐рд╕реНрдХ рд╕реЗ рдХреЗрд╡рд▓ 20-30 рдПрдордмреА / рдПрд╕ рдХреА рдЧрддрд┐ рд╕реЗ рдкрдврд╝рддрд╛ рд╣реВрдВред  рдФрд░ рдмрдЪрдкрди рд╕реЗ рд╣реА рдореБрдЭреЗ рдпрд╣ рдирд┐рдпрдо рдпрд╛рдж рдерд╛ рдХрд┐ рдЖрдк рд╣рд╛рд░реНрдб рдбреНрд░рд╛рдЗрд╡ рд╕реЗ 100 рдПрдордмреА / рдПрд╕ рд╕реЗ рдХрд╣реАрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред  рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ, рдпрд╣ рдЕрднреА рднреА рдмрд╣реБрдд рдХреБрдЫ рдирд╣реАрдВ рдмрджрд▓рд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рджреЛрд╕рдд рдФрд░ рдЗрд╕реНрддрдд рдХрд╛ рджреВрд╕рд░рд╛ рдЙрджрд╛рд╣рд░рдг</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yv/x-/wf/yvx-wf4ufaglo2ehwozvvh1mj48.gif"><br></div></div><br>  рдпрд╣рд╛рдБ рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рд╣реИред  рдкрдврд╝рдирд╛ рдЕрдзрд┐рдХ рдЗрд╖реНрдЯрддрдо рд╣реИред  рдореИрдВ dstat рдЪрд▓рд╛рддрд╛ рд╣реВрдВ, рдФрд░ рдореЗрд░реЗ рдкрд╛рд╕ рдЗрд╕ RAID 5 рдХреЛ рдЖрда рдбреНрд░рд╛рдЗрд╡ рдореЗрдВ рд╕реЗ 1 рдЬреАрдмреА / рдПрд╕ рдХреА рд░реАрдб рд╕реНрдкреАрдб рд╣реИред  рдЖрдИрдУрд╕реНрдЯреИрдЯ рдХреНрдпрд╛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ?  рд╣рд╛рдВ, рд▓рдЧрднрдЧ 1 рдЬреАрдмреА / рдПрд╕ред <br><br>  рдЕрдм рдбреНрд░рд╛рдЗрд╡ рдЕрдВрдд рдореЗрдВ 100% рднрд░реА рд╣реБрдИ рд╣реИрдВред  рд╕рдЪ рд╣реИ, рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ, рджреЛ 100% рд╣реИрдВ, рдФрд░ рдмрд╛рдХреА 95% рд╣реИрдВред  рд╢рд╛рдпрдж, рд╡реЗ рдЕрднреА рднреА рдереЛрдбрд╝рд╛ рдЕрд▓рдЧ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд╕рд╛рде рдореИрдВрдиреЗ 150 рдПрдордмреА / рдПрд╕ рдкрдврд╝рд╛, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдХреВрд▓рд░ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЕрдВрддрд░ рдХреНрдпрд╛ рд╣реИ?  рдкрд╣рд▓реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореИрдВ рдЕрдкрд░реНрдпрд╛рдкреНрдд рдмрдлрд░ рдХреЗ рд╕рд╛рде рдЕрдкрд░реНрдпрд╛рдкреНрдд рдЯреБрдХрдбрд╝реЛрдВ рдореЗрдВ рдкрдврд╝рддрд╛ рд╣реВрдВред  рдпрд╣ рд╕рд░рд▓ рд╣реИ, рдореИрдВ рдЖрдкрдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд╕рддреНрдп рдмрддрд╛рддрд╛ рд╣реВрдВред <br><br>  рд╡реИрд╕реЗ, рдЕрдЧрд░ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдХреЛ рдЕрднреА рднреА рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЕрд░реНрдерд╛рдд, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣рд╛рдИрд▓реЛрдПрдб</a> ++ рд╕рд╛рдЗрдмреЗрд░рд┐рдпрд╛ рд╕рдореНрдореЗрд▓рди ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рд┐рдкреЛрд░реНрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ habrastaty</a> ) рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдХ рд░рд┐рдкреЛрд░реНрдЯ</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рдЧрднрдЧ</a> ред)ред  рдЖрдпреЛрдЬрдХреЛрдВ рдиреЗ рдиреЛрд╡реЛрд╕рд┐рдмрд┐рд░реНрд╕реНрдХ рдореЗрдВ рд╕рдмрд╕реЗ рдХрдЯреНрдЯрд░ рд░рд┐рдкреЛрд░реНрдЯ рдмрдирд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред <br><br><img src="https://habrastorage.org/webt/pu/6k/kp/pu6kkpnztqtp_elvxpta__ya8f0.jpeg" width="700"><br><br>  рдЕрдЧрд▓рд╛ рдЙрджрд╛рд╣рд░рдг рд╕реНрдореГрддрд┐ рд╣реИред  рд▓рдЧрд╛рддрд╛рд░ рд╕рд╛рдорд╛рдиреНрдп рд╕рддреНрдпред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд▓рд┐рдирдХреНрд╕ рдкрд░, рдХрднреА рдирд╣реАрдВ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдореБрдлреНрдд рджрд┐рдЦрд╛рддрд╛ рд╣реИред  рдЬреЛ рд▓реЛрдЧ рджреЗрдЦ рд░рд╣реЗ рд╣реИрдВ, рдЙрдиреНрд╣реЛрдВрдиреЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд╛рдЗрдЯ linuxatemyram.com рдмрдирд╛рдпрд╛ рд╣реИред  рдЕрдВрджрд░ рдЖрдУ, рдПрдХ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рд╣реЛрдЧрд╛ред  рдЖрдкрдХреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдореЗрдореЛрд░реА рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреНрдпрд╛ рдЕрдВрддрд░ рд╣реИ, рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдХрд┐рддрдирд╛ рдкрддрд╛ рд╕реНрдерд╛рди рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ?  рднреМрддрд┐рдХ рд╕реНрдореГрддрд┐ рдХрд╛ рдХрд┐рддрдирд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕реЗ рджреЗрдЦреЗрдВред <br><br>  рдФрд░ рдПрдХ рдФрд░ рд░реЗрдХ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдпрд╣ рднреА рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рд▓рдбрд╝рдирд╛ рд╣реИред  рдпрд╛рдж рд░рдЦреЗрдВ: рдпрд╣ рддрдереНрдп рдХрд┐ рдЖрд╡рдВрдЯрдирдХрд░реНрддрд╛ рдЕрдХреНрд╕рд░ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдореЗрдореЛрд░реА рджреЗрдирд╛ рдкрд╕рдВрдж рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд╕рд╛рдорд╛рдиреНрдп рд╣реИред  рдЙрдиреНрд╣реЛрдВрдиреЗ mmap рдмрдирд╛рдпрд╛, рд▓реЗрдХрд┐рди munmap рдЕрдм рдРрд╕рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдореЗрдореЛрд░реА рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдЖрдПрдЧреАред  рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕реЛрдЪрддрд╛ рд╣реИ - рдореБрдЭреЗ рдмреЗрд╣рддрд░ рдкрддрд╛ рд╣реИ рдХрд┐ рдореИрдВ рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реВрдВрдЧрд╛ред  рдореИрдВ рдЗрд╕реЗ рдЦреБрдж рдкрд░ рдЫреЛрдбрд╝ рджреВрдБрдЧрд╛ред  рдХреНрдпреЛрдВрдХрд┐ mmap рдФрд░ munmap рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдмрд╣реБрдд рдзреАрдореА рд╣реИрдВред  рдкрддрд╛ рд╕реНрдерд╛рди рдмрджрд▓рдирд╛, рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рдЯреАрдПрд▓рдмреА рдХреИрд╢ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдирд╛ - рдРрд╕рд╛ рдирд╣реАрдВ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдУрдПрд╕ рдореЗрдВ рдЕрднреА рднреА рдореИрдбрд╡рд┐рд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЗрдореЛрд░реА рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдореБрдХреНрдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред  рдкрддрд╛ рд╕реНрдерд╛рди рд░рд╣реЗрдЧрд╛, рд▓реЗрдХрд┐рди рднреМрддрд┐рдХ рд░реВрдк рд╕реЗ рдореЗрдореЛрд░реА рдЕрдирд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред <br><br>  рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рдЙрддреНрдкрд╛рджрди рд╕рд░реНрд╡рд░ рдкрд░ рд╕реНрд╡реИрдк рдХреЛ рдХрднреА рднреА рд╕рдХреНрд╖рдо рди рдХрд░реЗрдВред  рдЖрдк рд╕реЛрдЪрддреЗ рд╣реИрдВ - рдкрд░реНрдпрд╛рдкреНрдд рд╕реНрдореГрддрд┐ рдирд╣реАрдВ рд╣реИ, рдореИрдВ рд╕реНрд╡реИрдк рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реВрдВрдЧрд╛ред  рдЙрд╕рдХреЗ рдмрд╛рдж, рдЕрдиреБрд░реЛрдз рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрдЧрд╛ред  рдпрд╣ рдЕрдВрддрд╣реАрди рд╕рдордп рджрд░рд╛рд░ рдЬрд╛рдПрдЧрд╛ред <br><br><img src="https://habrastorage.org/webt/mb/0d/2n/mb0d2nmqxl5zq7hu5foyae9ir40.jpeg" width="650"><br><br>  рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдмрд╣реБрдд рд╡рд┐рд╢рд┐рд╖реНрдЯ рд░реЗрдХ рдХреЗ рд╕рд╛рдеред  рдпрджрд┐ рдЖрдк рд╣рд░ рдмрд╛рд░ рдПрдХ рдЯреАрд╕реАрдкреА рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ рд╕рд╣реА рд╡рд┐рдВрдбреЛ рдХрд╛ рдЖрдХрд╛рд░ рдЪрдпрдирд┐рдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреБрдЫ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЯреАрд╕реАрдкреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛ рд╕рдВрдЪрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреА рддреЗрдЬреА рд╕реЗ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ред  рд╡рд╣ рдЗрд╕ рдХреЗ рд▓рд┐рдП adaptsред <br><br>  рдпрд╛ рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ - рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рдЖрдкрдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдПрдХ рдмрдбрд╝реА рд╡рд┐рд▓рдВрдмрддрд╛ рдФрд░ рдПрдХ рдЕрдЪреНрдЫрд╛ рдкреИрдХреЗрдЯ рдиреБрдХрд╕рд╛рди рд╣реИред  рддрдм рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреАрд╕реАрдкреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд╣реА рд╣реИред  рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЧрд▓рдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЯреАрд╕реАрдкреА рдирд┐рд░рдВрддрд░рддрд╛ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИред  рджреВрд╕рд░реА рдУрд░, рдЖрдк рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдзрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдФрд░ рджреВрд╕рд░реЗ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред     TCP-     TCP   . ,   ,    ,  TCP    .    . <br><br>       100- ,   .     10   -,     ,   ,       .  .    . <br><br><img src="https://habrastorage.org/webt/xy/ch/_m/xych_mjdelh5uydffukjrxzbf-k.jpeg" width="800"><br><br>    ?      тАФ     .    ,     ,  ,  10  .    ,       . <br><br><img src="https://habrastorage.org/webt/mp/p_/bq/mpp_bqykipgfxtbiu6i8_a4xfpm.jpeg" width="400"><br><br>   : ┬л   -  ┬╗ тАФ          .      iotop,  ,           ,   iops. <br><br>         ,     .  . <br><br><div class="spoiler"> <b class="spoiler_title">: top  </b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8r/3l/wg/8r3lwg_u4l6bexuezkp-s3kdvno.gif"><br></div></div><br>   top  -,   ,  clickHouse-server  -  , -  .   ,   ,    Shift+H,      .    ,  ClickHouse  .   ParalInputsProc,   .  BackgrProcPool тАФ   merges     .   ,            . <br><br>    ?     ClickHouse,  ,     .    BackgroundProcessingPool.     15 . 16  1,  1 тАФ   .  16?  ,    Linux тАФ   ,  : ┬л16 .  ┬╗.  :) <br><br>        clickhouse-benchmark.        clickhouse-client.    ,    clickhouse-client,  .      -         .             . <br><br><div class="spoiler"> <b class="spoiler_title">: clickhouse-benchmark + perf top</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bu/ol/_g/buol_gwiuvuqmnn3xxxzpkafc6g.gif"><br></div></div><br>         .  clickhouse-benchmark,  ,      ,   ,     ,           .       peft top.   peft top,       .  ,    -     -,      uniq: UniquesHashSet.  .    ,   .      ,   . <br><br>  , ,    .        тАФ   -.    ,  , XOR  -  .   -.        -   -.      ,              -. <br><br>     , , crc32q.         ,        ,     -   ,       -   . <br><br>     ,        ClickHouse.            , ,   .       ClickHouse. <br><br><img src="https://habrastorage.org/webt/je/ki/1x/jeki1xaabpztoth-0ixuuq5abny.jpeg" width="700"><br><br>     .  ,    тАФ  ,   SHOW PROCESSLIST.   .    ,  SELECT * FROM system processes.       :  , ,   .     ClickHouse top. <br><br>     ClickHouse ?       background-. Background- тАФ    merges.   ,  merges ,    SELECT * FROM system.merges. <br><br><div class="spoiler"> <b class="spoiler_title"> c </b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pb/gd/b3/pbgdb3f6o8qyvh6ez81heoo82tu.gif"><br></div></div><br> ,   .  -.    .  тАФ  ClickHouse.       .      ,  ,  . ,       . - traf_testing.  ?   ,       ,       .   ClickHouse  . <br><br><img src="https://habrastorage.org/webt/ni/aj/ro/niajrokowxcc2bp1n2ookwy8ljy.jpeg" width="700"><br><br>  .    ,      . ,    ,  ,    ,     .   query_log.        тАФ      ,   -    ,  SELECT ,    -  .   query_log     ,    .   -     .    тАФ    ,    .     :       . <br><br> ,  ,      тАФ merge, inserts,   .      part_log.      ,      . <br><br><img src="https://habrastorage.org/webt/lt/vn/cp/ltvncpwym4jc0qpjpofzygrb9qs.jpeg" width="700"><br><br>   query_log   clickhouse-benchmark.   select  ,    ,      stdin  clickhouse-benchmark. <br><br>     query_log  -   ,       . <br><br><img src="https://habrastorage.org/webt/zh/pm/tt/zhpmttv4oacr3fqnvanjwhrdsdg.jpeg" width="450"><br><br>       ,  ,   .     .     SET send_logs_level = 'trace',       ,    . <br><br><div class="spoiler"> <b class="spoiler_title">:  </b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/3z/l0/g9/3zl0g92l6zqdt7gxtqogm-wt-ai.gif"><br></div></div><br> ,   .  ,     98%.   ,       .  рдпрд╣ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИред  SET send_logs_level = 'trace',  ,    .  - : merging aggregated data,   .       1% .       ,    . <br><br>        ,   ,      query_log. <br><br>  . SELECT * FROM system.query_log    .  . ,   ,     ,      query_log. .      тАФ  ,    ,   ,       . . <br><br><img src="https://habrastorage.org/webt/6h/em/o3/6hemo3c8u8d4qv2bwxlt-xa0x_w.jpeg" width="470"><br><br>   ClickHouse   .   тАФ           system.events, system.metrics  system.asynchronous_metrics. Events тАФ    , ,     . 100 .          тАФ 10 .  system.metrics тАФ     . ,     10 ,     10  . <br><br>  system.asynchronous_metrics     ,     .  .          тАФ   .  , system.asynchronous_metrics тАФ  ,     - . ,   . <br><br>       ,     .      SHOW PROCESSLIST       .  query_log,        . <br><br><img src="https://habrastorage.org/webt/0p/cp/1r/0pcp1rjgl8aj4w29tcnj73n5eay.jpeg" width="520"><br><br> ,   .  ,    . ,   .   ,    ,       .   ,     Linux,   .    Linux    .     ,     .  ,    .      . <br><br> , OSReadChars  OSReadBytes.   ?  ,       ,        ,     .   ,        .   ,       ,         ,   .  ,   -      ,      . <br><br><div class="spoiler"> <b class="spoiler_title">  page cache</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ft/zd/z3/ftzdz3ycxppmbghwuxu108y3rcs.gif"><br></div></div><br> ,   .    - .  ,  40    , 6,7 . . ,     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> </a> . , , . <br><br>      ,    1,3 ,  5  .  рдХреНрдпреЛрдВ? ,     тАФ      page cache.         ? <br><br><div class="spoiler"> <b class="spoiler_title"> c  </b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hr/cj/as/hrcjasfstnujjgo-fx9ene7t1g0.gif"><br></div></div><br>     .       . ,   ,        .   .     :     3,2 ,    тАФ 2,5 . , ,         ,   .  рдХреНрдпреЛрдВ? -, :  read ahead.        ,       тАФ  ? -,         тАФ 4  , , 512 KB.     .    ,     .   ,  - read ahead. <br><br><img src="https://habrastorage.org/webt/dj/nb/kj/djnbkjh9mdniw34_odlupzqigfa.jpeg" width="700"><br><br>      .      .     ,     . , , ReadBytes тАФ  ,     .  3 ,     3 .  ,   ,    . <br><br>    тАФ IOWait. 87 .    7 ,  IOWait тАФ 87. ?  тАФ    .     .   ,      ,     87 .       ,  - . <br><br>    тАФ CPUWait.     ,  ,       ,       .  -     тАФ ,   .      CPU.         CPU.      - ,    .        тАФ ,  ,   user space.    ,     - .  рдЕрдЪреНрдЫрд╛, рдареАрдХ рд╣реИред <br><br>  тАФ  ,    Linux.         - ,    .    , ,       . <br><br><div class="spoiler"> <b class="spoiler_title">: query_thread_log</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/fq/py/tf/fqpytfrrdsz4nxr8179r4pklzkm.gif"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рдЪреАрдЬрд╝ рд╣реИ: query_thread_logред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд╕рд╛рде, рдЖрдк рд╕рдордЭ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдзрд╛рдЧреЗ рдиреЗ рдХрд┐рд╕ рд╕рдордп рдмрд░реНрдмрд╛рдж рдХрд┐рдпрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ рдЕрдкрдиреЗ рдЕрдиреБрд░реЛрдз рдХреА рддрд▓рд╛рд╢ рдХрд░рддрд╛ рд╣реВрдВ, query_id рджреНрд╡рд╛рд░рд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реВрдВ рдФрд░ рдореАрдЯреНрд░рд┐рдХ "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд╛рди рдореЗрдВ рдмрд┐рддрд╛рдП рдЧрдП рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕рдордп рдХреА рдорд╛рддреНрд░рд╛" рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реВрдВред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рд╣рдорд╛рд░реА рдзрд╛рд░рд╛рдПрдБ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП, 16 рдзрд╛рдЧреЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЧрдП рдереЗред </font><font style="vertical-align: inherit;">рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЗ 800 рдПрдордПрд╕ рдЦрд░реНрдЪ рдХрд┐рдПред </font><font style="vertical-align: inherit;">рдФрд░ рдлрд┐рд░ рдХреБрд▓ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд░рд╛рдЬреНрдп рдХреЗ рд╡рд┐рд▓рдп рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ 16 рдзрд╛рдЧреЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЧрдП рдереЗ, рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдкрд░ 0.25 рдПрд╕ рдЦрд░реНрдЪ рдХрд┐рдП рдЧрдП рдереЗред </font><font style="vertical-align: inherit;">рдЕрдм рдореИрдВ рд╕рдордЭ рд╕рдХрддрд╛ рд╣реВрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреНрдпрд╛ рд╕рдордп рд▓рдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HighLoad ++ рдкрд░ рд╡реАрдбрд┐рдпреЛ рд░рд┐рдкреЛрд░реНрдЯ:</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ondHe_JUyW4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi459198/">https://habr.com/ru/post/hi459198/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi459182/index.html">GitLab: рд╕рдВрд╕реНрдХрд░рдг 12.1 рдХреА рд░рд┐рд▓реАрдЬрд╝ рдХреЗ рд╕рд╛рде рд╣рдо MySQL рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi459184/index.html">рдмреБрдирд┐рдпрд╛рджреА рдПрдХрддрд╛ рдХреМрд╢рд▓</a></li>
<li><a href="../hi459188/index.html">рдбреЗрдмрд┐рдпрди 10 рдмрд╕реНрдЯрд░ рдФрд░ рд▓рд┐рдирдХреНрд╕ 5.2 рдХрд╛ рд╡рд┐рдореЛрдЪрди рдХрд┐рдпрд╛</a></li>
<li><a href="../hi459194/index.html">рд╣рдордиреЗ UI рдХрд┐рдЯ рдереАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CSS рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЗ рд╕рд╛рде SCSS рдорд┐рддреНрд░ рдХреИрд╕реЗ рдмрдирд╛рдП</a></li>
<li><a href="../hi459196/index.html">рдореЛрдиреЛрд▓рд┐рде рд╕реЗ рд▓реЗрдХрд░ рдореЙрдбреНрдпреВрд▓рд░ рдЯреАрдореЗрдВ</a></li>
<li><a href="../hi459204/index.html">C ++ рдореЗрдВ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ 10 ++ рддрд░реАрдХреЗ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, IAR рдФрд░ Cortex M)</a></li>
<li><a href="../hi459206/index.html">рдиреЛрдб рдореЗрдВ рдПрдХ рдореЛрдиреЛрд▓рд┐рде рдореЗрдВ 9 рд╕рд╛рд▓</a></li>
<li><a href="../hi459208/index.html">рдкреНрд░реЛрд╕реНрдереЗрд╕рд┐рд╕ рдХреЗ рд╕рд╛рде рджреМрдбрд╝рдирд╛: рдорд╛рдВрд╕рдкреЗрд╢рд┐рдпреЛрдВ, рд╣рдбреНрдбрд┐рдпреЛрдВ рдФрд░ рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рдирд╡ рдЖрдВрджреЛрд▓рди рдХреЗ рдиреЗрдХреНрд╕реНрдЯрдЬреЗрди рд╕рд┐рдореБрд▓реЗрд╢рди</a></li>
<li><a href="../hi459212/index.html">C ++ рдореЗрдВ рд╕рдВрдкрддреНрддрд┐ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</a></li>
<li><a href="../hi459214/index.html">рдХрд╕рд╛рди рднрдВрдбрд╛рд░рдг рдореЗрдВ рджреЛрд╖ рд╕рд╣рд┐рд╖реНрдгреБрддрд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>