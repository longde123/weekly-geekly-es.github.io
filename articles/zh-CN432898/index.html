<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸🏿 🎋 💇🏽 StereoPi上的全景图 🧚🏼 🦀 👨🏻‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我们将继续尝试同时配备两个摄像头的Raspberry Pi。 让我提醒您，所有游戏都是围绕Raspberry Pi Compute Module 3 Lite（插入StereoPi婴儿床）进行的。 

 在过去的评论中，我们并行安装了摄像头并使用了立体声效果。 这里的方法正好相反：相机朝不同的方向看...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>StereoPi上的全景图</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432898/"><img src="https://habrastorage.org/webt/kc/wg/lv/kcwglvzlvc5sfcbzdm5yfm6lnfu.jpeg" alt="图片"><br><br> 我们将继续尝试同时配备两个摄像头的Raspberry Pi。 让我提醒您，所有游戏都是围绕Raspberry Pi Compute Module 3 Lite（插入StereoPi婴儿床）进行的。 <br><br> 在过去的评论中，我们并行安装了摄像头并使用了立体声效果。 这里的方法正好相反：相机朝不同的方向看，但配备了广角镜（200度）。 我们将胶合360度球形全景！ <br><a name="habracut"></a><br><h2> 介绍性 </h2><br> 分心：由于没有关于哈布雷的文章的共同作者，因此我将提及主要内容。 该实验是与我（铁和现场实验）以及<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Gol</a> （软件部分）共同进行的。 <br><br> 让我们从结尾开始：这是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">结果，实际上是全景图</a> 。 <br><br> 因此，这次尝试制作球形全景图。 徒劳无功，船上有两个摄像头。 当然，可以以多路复用模式将两个摄像机连接到普通树莓派（一个摄像机可以工作，另一个摄像机可以通过GPIO选择合适的摄像机）。 但是，随后将依次拍摄帧，如果有运动，则感觉不是很好。 的确，当从两个摄像机“同时”拍摄两个立体声摄像机时，也没有同步，愚蠢的是同时启动了两个raspistill。 但是，边界上的对象散布的可能性更大。 您也可以同时使用两台摄像机拍摄视频，然后将其缝制成球形视频全景图。 但是，然后我将以某种方式尝试一下，首先您需要处理照片全景。 <br><br><h2> 铁 </h2><br> 我们有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StereoPi</a> ，有两个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">带鱼</a>眼镜头（200度）的相机。 以下是摄像机： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RPi摄像机（M）WaveShare</a> <br><br> 我们有两台流行相机： <br><br><img src="https://habrastorage.org/webt/wm/zn/c6/wmznc6yll8-u0hxzfu9pfs4lpss.jpeg" alt="图片"><br><br> 我们从两个相机拍摄照片。 理想情况下-同时进行，但又有可能实现。  raspistill帮助我们。 我们得到这两张照片： <br><br><img src="https://habrastorage.org/webt/gj/ly/bh/gjlybhfu5wrpt3vxt0jsi-oinj4.jpeg" alt="图片"><br>  <a href="">全尺寸</a> <br><br><img src="https://habrastorage.org/webt/yg/9f/-x/yg9f-xbtdlvqu6n69slo2yv_wgk.jpeg" alt="图片"><br>  <a href="">全尺寸</a> <br><br><h2> 主食全景 </h2><br> 然后出现了问题-如何自动从这两个财政图片中制作出等距投影的图像，几乎所有全景观看者都会吃掉这两个图片。 我想直接在立体声上进行转换，而无需使用特殊的全景软件。 <br><br> 经过大量研究，发现了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">360相机</a>项目，并以此脚本为基础。 <br><br> 但是首先，我们仍然必须使用单独的全景程序来准备转换模板。 该程序称为Hugin，您可以在此处下载它<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://hugin.sourceforge.net/download/</a> <br><br>  1.因此，下载，安装，启动了。 <br>  2.在“接口”菜单中选择“简单”选项。 <br><br><img src="https://habrastorage.org/webt/no/jt/aw/nojtaweqaqdd2uhtwxiz6teypma.jpeg" alt="图片"><br><br>  3.单击按钮“下载图像...”，然后添加我们的两个文件（21.jpg和21-2.jpg）。 <br><br><img src="https://habrastorage.org/webt/zu/12/c7/zu12c7gypxdmexopttcdf1oxulg.jpeg" alt="图片"><br><br>  4.设置“镜头类型”-“圆形VyrvyGlaz”。 焦距为1.2mm，焦距倍数为7.6x。 在“投影”选项卡中，确保存在360x180和“等距”的视场。 默认情况下应该是这样。 <br><br><img src="https://habrastorage.org/webt/_g/wc/gn/_gwcgnb4_s89l_tvxsvnnfndinq.jpeg" alt="图片"><br><br>  5.单击按钮“ 2。 对齐...“。 搜索控制点将开始，应该在10-13点左右。 全景图已经开始看起来像全景图。 <br><br><img src="https://habrastorage.org/webt/eb/hf/8m/ebhf8mtccgv4klnjvmbuuchfiko.jpeg" alt="图片"><br><br>  6.现在最重要的是保存项目，因为我们需要用它来自动粘合用这两个鱼眼镜头拍摄的所有后续全景图。 文件-&gt;另存为-&gt;文件名stereopi-template.pto <br><br>  7.返回到“助手”选项卡（如果我们突然离开那里），然后单击“创建全景图...”。将打开另一个窗口，在此处选择高度1944，将计算宽度本身。  LDR格式（输出图片格式）设置为JPEG。 质量-默认情况下，无论您想要什么，质量都为90。我们还不涉及更正。 单击确定。 用结果设置文件名。 然后点击“保存”。 <br><br><img src="https://habrastorage.org/webt/dq/nu/ug/dqnuugzu3rnmuyrev21cnpzcp7q.jpeg" alt="图片"><br><br>  8.将打开更多窗口，其中一个窗口将显示过程日志。 <br><br><img src="https://habrastorage.org/webt/sb/hb/bg/sbhbbgmef-068ukos3jaknlmy-w.jpeg" alt="图片"><br><br>  9.结果，我们得到这样的东西： <br><br><img src="https://habrastorage.org/webt/sb/hb/bg/sbhbbgmef-068ukos3jaknlmy-w.jpeg" alt="图片"><br><br>  <a href="">全尺寸</a> <br><br> 这是我们球形全景图的必要等距投影！ <br><br><h2> 我们在船上进行缝制 </h2><br> 但这都是歌词！ <br><br> 我们不想每张照片都洗个澡，我们需要使这一过程自动化。 为此，我们将需要在第6步中保存的项目文件。我们获取项目文件（我将其<a href="">保存为stereopi-template.pto</a> ）并将其复制到立体声。 <br><br> 我们将那里的<a href="">stereopi-stich.sh</a>粘贴脚本复制到该脚本中，该脚本需要两个输入参数-需要粘贴到等距投影中的鱼照片文件的名称。 <br><br> 但是首先，您需要在立体声上安装所有必需的软件。 只需下载此脚本并在steropix上运行它即可。  <a href="">installer.sh</a> <br><br> 现在运行粘合脚本： <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ./stereopi-stich.sh 21.jpg 21-2.jpg Stiching files 21.jpg and 21-2.jpg Generating pto file... Reading /opt/Pano/test1/21-2.jpg... Reading /opt/Pano/test1/21.jpg... Assigned 1 lenses. Written output to /opt/Pano/test1/tmp/project.pto Written output to ./tmp/project.pto number of cmdline args: 1 ================================== Stitching panorama ================================== nona -z LZW -r ldr -m TIFF_m -o 21_21-2-pano -i 0 ./tmp/project.pto nona -z LZW -r ldr -m TIFF_m -o 21_21-2-pano -i 1 ./tmp/project.pto checkpto --generate-argfile= project.pto_21_21-2-pano.arg ./tmp/project.pto enblend --compression=90 -w -f2688x1344 -o 21_21-2-pano.jpg -- 21_21-2-pano0000.tif 21_21-2-pano0001.tif enblend: info: loading next image: 21_21-2-pano0000.tif 1/1 enblend: info: loading next image: 21_21-2-pano0001.tif 1/1 enblend: info: writing final output Bogus input colorspace exiftool -overwrite_original_in_place -TagsFromFile /opt/Pano/test1/21-2.jpg -WhitePoint -ColorSpace -@ /usr/share/hugin/data/hugin_exiftool_copy.arg -@ project.pto_21_21-2-pano.arg 21_21-2-pano.jpg 1 image files updated ================================== Remove temporary files ================================== rm project.pto_21_21-2-pano.arg 21_21-2-pano0000.tif 21_21-2-pano0001.tif</span></span></code> </pre> <br> 该过程大约需要50秒。 有必要寻找优化机会，但到目前为止还不错。 <br><br> 结果是一个文件 <br><br><img src="https://habrastorage.org/webt/hs/pr/7i/hspr7itivnfhaasliblr1zuhuiw.jpeg" alt="图片"><br><br>  <a href="">全尺寸</a> <br><br> 仅此而已！ 我们自动将两个渔业等距！ 使用相同的脚本，您可以粘贴所有后续图片，最主要的是我们相机的相互放置不会有太大变化，否则会粘在一起。 <br><br> 现在，您需要在网站上的某个位置播放它。 要在网站上查看我们的全景，您需要全景播放器。 <br><br> 恕我直言，最好的内置全景播放器-KRPano。 它可以拍摄照片和视频。 是的，已付款。 我已经在五年前为其购买了许可证，但是随后播放器是通过Flash制作的，而HTML5则不能。 现在他知道了，但是您必须再次购买许可证。 <br><br> 您可以下载<a href="">我的存档器</a> ，其中包含您需要的所有内容。 最繁琐的-小行星（选择查看模式-右键单击）。 <br><br><img src="https://habrastorage.org/webt/al/uc/8u/aluc8urvbvd9__ro_6syw1jfzxs.jpeg" alt="图片"><br><br> 我们希望我们的实验不仅会令您感兴趣，而且对您有所帮助。 感谢您的关注！ <br><br><h2> 有用的链接： </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">等角投影</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于渔业和等距投影的许多理论</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">查看全景的软件</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">大手册，用于自动涂胶</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BrianBock / 360相机</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN432898/">https://habr.com/ru/post/zh-CN432898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN432888/index.html">Heisenbug怎么样</a></li>
<li><a href="../zh-CN432890/index.html">Linux，微软和马克思主义</a></li>
<li><a href="../zh-CN432892/index.html">您的搜索返回：模糊搜索实现</a></li>
<li><a href="../zh-CN432894/index.html">12月19日，莫斯科-OpsFormations</a></li>
<li><a href="../zh-CN432896/index.html">AXIS P1425-LE Mk II与IDIS DC-T3233HRXL：比较CCTV摄像机</a></li>
<li><a href="../zh-CN432900/index.html">国际团队的工作特点。 日本</a></li>
<li><a href="../zh-CN432902/index.html">登月失败：关于其中一项任务的了解</a></li>
<li><a href="../zh-CN432904/index.html">IT 2018最佳雇主：My Circle年度评级</a></li>
<li><a href="../zh-CN432906/index.html">编辑CSV文件以免破坏数据</a></li>
<li><a href="../zh-CN432908/index.html">在俄罗斯，他们计划对互联网上的付款实行额外的控制</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>