<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>„ÄΩÔ∏è ‚ôâÔ∏è üå´Ô∏è Confer√™ncia DEFCON 27. Beneficiando-se de produtos de hackers para o macOS. Parte 2 üçî üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø ü§∞üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Confer√™ncia DEFCON 27. Beneficiando-se de produtos de hackers para o macOS. Parte 1 

 Depois de receber um arquivo com c√≥digo malicioso de um servido...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Confer√™ncia DEFCON 27. Beneficiando-se de produtos de hackers para o macOS. Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474590/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Confer√™ncia DEFCON 27. Beneficiando-se de produtos de hackers para o macOS.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> <br><br>  Depois de receber um arquivo com c√≥digo malicioso de um servidor C&amp;C de um hacker remoto, a explora√ß√£o prossegue para execut√°-lo.  Ele usa o mesmo m√©todo SDF quando o arquivo de malware √© descompactado usando o comando ditto interno e, em seguida, executado atrav√©s da API do NS.  Assim, o Windtall usa um gerenciador de inicializa√ß√£o interno padr√£o. <br><br><img src="https://habrastorage.org/webt/s5/ah/23/s5ah23zhuchevz5cvkvhqsnpqcs.jpeg"><br><br>  Al√©m disso, o backdoor √© equipado com l√≥gica de auto-liquida√ß√£o; portanto, toda vez que o malware √© iniciado, ele entra em contato com o servidor do hacker e pergunta se ele deve ser desinstalado.  Se o servidor C&amp;C responder com o c√≥digo "1", o programa se exclui, interrompendo a atividade de spyware. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/hb/b0/nv/hbb0nv9sjwt182m_llrlfnucgxm.jpeg"><br><br>  Esse √© um recurso muito √∫til que permite que um invasor desinfecte remotamente um alvo sem deixar vest√≠gios de sua interven√ß√£o.  Agora vou mostrar como refizemos esse v√≠rus para nossas pr√≥prias necessidades. <br><br><img src="https://habrastorage.org/webt/yr/zs/vb/yrzsvbpwib8b9jenyer3zks92ki.jpeg"><br><br>  Primeiro, vamos falar sobre a reprova√ß√£o de uma explora√ß√£o.  Criar uma p√°gina da web de hacker que baixa automaticamente um arquivo ZIP contendo um aplicativo malicioso √© bastante simples.  Como mencionei, o Safari descompactar√° automaticamente os arquivos ZIP por padr√£o. Portanto, se colocarmos um aplicativo mal-intencionado nesse arquivo que implementa alguns manipuladores de URL, o Mac OS o registrar√° automaticamente antes que o usu√°rio inicie o aplicativo. <br><br>  Uma p√°gina da Web maliciosa pode solicitar esse URL de usu√°rio j√° registrado, o que levar√° ao lan√ßamento do aplicativo.  Geralmente, uma janela de aviso aparece, mas o usu√°rio clica no bot√£o sem prestar aten√ß√£o. <br><br>  Ent√£o, voc√™ v√™ uma demonstra√ß√£o da explora√ß√£o reprojetada e uma janela de aviso de que ‚ÄúFinal_Presentation‚Äù √© um aplicativo baixado da Internet, perguntando se o usu√°rio tem certeza de que deseja abri-lo no computador? <br><br>  Clicar no bot√£o "Abrir" √© a segunda solicita√ß√£o que causa uma janela pop-up e, se o usu√°rio clicar no √≠cone do aplicativo exibido, veremos que o malware foi instalado automaticamente no sistema. <br><br><img src="https://habrastorage.org/webt/da/cz/w0/daczw0yu3d4vlyaa2ma79fx5tq8.jpeg"><br><br>  H√° uma falha l√≥gica na Apple em que voc√™ n√£o precisa corrigir o sistema operacional para infectar o sistema, e isso ainda funciona na vers√£o mais recente do macOS.  Agora que refizemos a explora√ß√£o, vamos falar sobre refazer o malware. <br><br><img src="https://habrastorage.org/webt/k8/q2/wh/k8q2whc8srob_t065-xvvldbgy4.jpeg"><br><br>  Nossa primeira etapa √© substituir o endere√ßo interno do servidor C&amp;C para que a explora√ß√£o entre em contato com o servidor e fa√ßa o download do malware convertido.  Infelizmente, o endere√ßo foi criptografado, mas isso n√£o nos incomodou.  Decidimos fazer com que o malware sempre carregasse a biblioteca din√¢mica.  Ent√£o, assim que nossa biblioteca fosse lan√ßada no espa√ßo de endere√ßo do processo malicioso, poder√≠amos, em princ√≠pio, modificar o malware para que ele intercepte os endere√ßos descriptografados do servidor C&amp;C durante a opera√ß√£o, mesmo antes de usar este servidor para conex√£o.  Vamos dar uma olhada mais de perto neste processo. <br><br>  Deixe-me lembr√°-lo novamente - nosso objetivo era re-criar um perfil de malware especificando nosso pr√≥prio servidor C&amp;C para que o malware se conectasse novamente √† nossa infraestrutura. <br><br><img src="https://habrastorage.org/webt/3h/qj/33/3hqj33qe_pjauk4ynkd_bgpy8q0.jpeg"><br><br>  Portanto, a biblioteca din√¢mica foi carregada no espa√ßo de endere√ßo do malware e substitu√≠mos o procedimento de descriptografia ou aplicamos o Swizzle.  Esse m√©todo de substitui√ß√£o de API eficiente e poderoso √© chamado Yoop. <br><br>  O slide mostra que substitu√≠mos a fun√ß√£o de descriptografia de forma que, sempre que o malware o chama, ele realmente chama nosso m√©todo de descriptografia em nossa biblioteca.  N√£o tenho id√©ia do que √© o algoritmo de descriptografia e como ele funciona e, francamente, n√£o me importo, mas ap√≥s a substitui√ß√£o, vejo o resultado dessa criptografia.  Portanto, se o m√©todo de criptografia original retornar para mim os endere√ßos descriptografados do servidor C&amp;C, eu posso simplesmente incorporar meu pr√≥prio servidor C&amp;C na l√≥gica do malware.  Isso nos permite substituir de forma transparente o servidor C&amp;C descriptografado pelo nosso servidor. <br><br>  Agora estou adicionando algumas mensagens de depura√ß√£o √† biblioteca para que, quando executamos o malware convertido, possamos ver como os endere√ßos do servidor C&amp;C est√£o sendo substitu√≠dos durante sua execu√ß√£o.  Na janela do terminal da linha de comando, voc√™ pode ver como nossa biblioteca, que segue o m√©todo de descriptografia original, detecta que essa resposta vem do servidor C&amp;C, cujo endere√ßo agora √© descriptografado. <br><br><img src="https://habrastorage.org/webt/jy/vq/pp/jyvqppeptj5tsynsrub5ao7qzb8.jpeg"><br><br>  Como n√£o queremos que nosso programa se refira √† l√≥gica do malware original, simplesmente descartamos essa fun√ß√£o e retornamos ao nosso pr√≥prio programa.  Obviamente, devemos sempre ter certeza de que o backdoor est√° acessando nosso servidor C&amp;C, e n√£o o servidor do grupo APT original. <br><br>  Precis√°vamos escrever nosso servidor C&amp;C, porque agora o malware se conectar√° a ele e precisamos fornecer uma "conversa" com o protocolo para perplexar corretamente o malware. <br><br><img src="https://habrastorage.org/webt/9a/dg/uj/9adgujslps8-egi02h548dxeplo.jpeg"><br><br>  A principal fun√ß√£o do backdoor do Windtall √© coletar e extrair arquivos do usu√°rio. Primeiro, precisamos adicionar essa fun√ß√£o ao nosso servidor C&amp;C.  Os arquivos s√£o recuperados por meio de uma solicita√ß√£o POST; portanto, acabamos de escrever algumas linhas de c√≥digo Python para permitir salvar os arquivos recuperados e enviados a partir do host infectado. <br><br>  Voc√™ v√™ na tela como nosso servidor C&amp;C recebe arquivos extra√≠dos do computador atacado. <br><br><img src="https://habrastorage.org/webt/5z/tu/ey/5ztueycxug4uq7-8_mvofucvowe.jpeg"><br><br>  √Ä esquerda, voc√™ pode ver como as solicita√ß√µes de rede s√£o recebidas e √† direita - como nosso servidor as grava no sistema de arquivos.  Isso significa que agora oferecemos suporte √† capacidade do malware de extrair arquivos de todos os tipos de um host infectado. <br><br>  Tamb√©m adaptamos nosso servidor C&amp;C para suportar os recursos de download e execu√ß√£o do Windtall.  Percebemos que, para esse malware, realiza 2 solicita√ß√µes. <br><br><img src="https://habrastorage.org/webt/ap/y3/6h/apy36hocalariebs3edovjvgfas.jpeg"><br><br>  A primeira solicita√ß√£o refere-se √† obten√ß√£o do nome do arquivo para download e a segunda solicita√ß√£o, devemos responder com bytes espec√≠ficos do arquivo que queremos baixar.  O malware salva tudo isso no arquivo especificado, descompacta e executa.  Repito mais uma vez - levamos apenas algumas linhas no Python, √© simples, pois usa muitas bibliotecas internas. <br><br>  Assim que fizemos isso, tivemos a oportunidade de "confundir" o implante.  Vamos ver isso em a√ß√£o.  Vemos como o malware se conecta ao nosso servidor C&amp;C, porque alteramos com √™xito o endere√ßo do servidor original e executamos a tarefa que lhe √© dada - ele baixa o aplicativo Calculadora. <br><br><img src="https://habrastorage.org/webt/gg/au/3d/ggau3dqd27ai3u5dk115bylndnw.jpeg"><br><br>  A capacidade de baixar e executar aplicativos remotamente significa que podemos instalar outras ferramentas ou outras amostras de malware no computador do usu√°rio.  Isso expande infinitamente o potencial de uso de software hacker redirecionado. <br><br>  Finalmente, vamos dar ao nosso servidor a capacidade de remover remotamente malware.  A fun√ß√£o de autodestrui√ß√£o √© muito √∫til se os caras do FBI invadirem sua porta.  Um clique na chave - e o pr√≥prio v√≠rus se remover√° de todos os sistemas infectados. <br><br><img src="https://habrastorage.org/webt/yp/ru/dy/yprudyqitu1zcbxqi3ahyfvsixs.jpeg"><br><br>  O spyware entra em contato periodicamente conosco com uma solicita√ß√£o, se √© necess√°rio excluir-se e, se necess√°rio, simplesmente respondemos com o c√≥digo "1", ap√≥s o qual √© completamente desinstalado do sistema. <br><br>  Outra demonstra√ß√£o mostrar√° isso em a√ß√£o.  Voc√™ pode ver que nosso malware tem seu pr√≥prio logotipo laranja imitando um documento do Power Point, mas, na realidade, √© um diret√≥rio oculto do sistema. <br><br><img src="https://habrastorage.org/webt/ar/pd/ak/arpdakjxkom1af3v9jxmttspha0.jpeg"><br><br>  Depois que mais uma vez enviou uma solicita√ß√£o de destrui√ß√£o ao servidor C&amp;C e respondemos em uma, o √≠cone laranja desapareceu do diret√≥rio do programa e o pr√≥prio aplicativo parou de "falar‚Äù conosco porque executava a autodestrui√ß√£o. <br><br><img src="https://habrastorage.org/webt/p5/6u/ln/p56ulnb7cf18kh9qd_hmudrhuse.jpeg"><br><br>  Ent√£o, mostramos como algumas amostras de malware para o macOS s√£o refiladas e agora vamos discutir como permanecer sem ser detectado.  Como estamos refazendo programas maliciosos conhecidos que a prote√ß√£o integrada do macOS e o software antiv√≠rus de terceiros detectam e bloqueiam, precisamos resolver de alguma forma esse problema. <br><br><h3>  Como n√£o ser detectado </h3><br>  Primeiro, vamos falar sobre os programas de detec√ß√£o e controle de v√≠rus incorporados ao macOS, como XProtect, ferramenta de remo√ß√£o de v√≠rus MRT e verifica√ß√£o de revoga√ß√£o de certificado. <br><br><img src="https://habrastorage.org/webt/ky/_a/di/ky_adibiddjzdqx6zhbhmlfxnb4.jpeg"><br><br>  √Ä primeira vista, isso parece problem√°tico, pois esses programas podem bloquear nosso spyware convertido em qualquer Mac.  Portanto, voc√™ precisa pensar em como ignorar a prote√ß√£o, porque se formos pegos pelo nosso malware cuidadosamente redesenhado e a Apple o bloquear, ser√° uma falha completa. <br><br>  Vamos dar uma olhada no XProtect primeiro.  Este √© um scanner antiv√≠rus simples, baseado em bancos de dados de assinatura de v√≠rus e incorporado nas vers√µes mais recentes do macOS. <br><br><img src="https://habrastorage.org/webt/io/_h/gy/io_hgyg0wdmy6rt34vr_gdlui1a.jpeg"><br><br>  Ele verifica os arquivos baixados pelo usu√°rio no computador antes de seu primeiro lan√ßamento, guiados pelas regras de detec√ß√£o de v√≠rus.  Na tela, vemos uma verifica√ß√£o da assinatura do v√≠rus OSX.KeRanger.A, cuja redefini√ß√£o do perfil foi examinada. <br><br>  Escrevemos um utilit√°rio simples chamado UXProtect, que permite examinar essas assinaturas por meio da interface do usu√°rio da interface do usu√°rio, bem como verificar arquivos a qualquer momento em busca de assinaturas de v√≠rus.  Como o XProtect usa apenas o mecanismo de detec√ß√£o de assinaturas, √© extremamente f√°cil se locomover.  Vamos dar uma olhada na assinatura do v√≠rus KeRanger. <br><br><img src="https://habrastorage.org/webt/sw/5h/mw/sw5hmwzwllc0p3bkn3pyd6r1dsy.jpeg"><br><br>  Vemos uma indica√ß√£o de um grupo de assinaturas de malware que voc√™ s√≥ precisa reordenar ou modificar qualquer uma dessas instru√ß√µes para ignorar.  Alterar alguns bytes de uma instru√ß√£o faz com que a assinatura n√£o corresponda mais aos par√¢metros de detec√ß√£o.  Por exemplo, alteramos o n√∫mero de bytes a serem lidos do buffer de 0x400 para 0x300.  Isso n√£o afetou a funcionalidade do v√≠rus, mas assim que alteramos o n√∫mero de bytes que o scanner verifica quanto √† correspond√™ncia com a assinatura, exclu√≠mos completamente a possibilidade de o XProtect reagir a essa amea√ßa. <br><br>  √â hora de outra demonstra√ß√£o, onde voc√™ ver√° dois exemplos do KeRanger.  Estamos novamente usando o cliente BitTorrent infectado.  √Ä esquerda na tela est√° a c√≥pia original do v√≠rus, e √† direita est√° sua vers√£o redirecionada, que, para obter a chave de criptografia, se comunica com o servidor C&amp;C.  Al√©m disso, √© modificado para burlar a prote√ß√£o do XProtect. <br><br><img src="https://habrastorage.org/webt/ag/mw/gs/agmwgscqk2ajoq1ef2shu2lm9yq.jpeg"><br><br>  Voc√™ v√™ que uma inst√¢ncia do v√≠rus original est√° bloqueada pelo sistema sem a possibilidade de iniciar, e a √∫nica opera√ß√£o permitida √© a exclus√£o. <br><br><img src="https://habrastorage.org/webt/kv/mb/y4/kvmby4yeqnevt_msi9viidiyhxg.jpeg"><br><br>  Se lan√ßarmos uma vers√£o redesenhada do KeRanger, o sistema simplesmente informa que ele foi baixado da Internet e pergunta se realmente queremos lan√ß√°-lo. <br><br><img src="https://habrastorage.org/webt/va/wn/4j/vawn4ja6artoxgxuure3xnzutt8.jpeg"><br><br>  Se clicarmos em "Abrir", o ransomware ser√° instalado silenciosamente no sistema e imediatamente come√ßar√° a criptografar todos os arquivos do usu√°rio. <br><br><img src="https://habrastorage.org/webt/oo/uj/ex/ooujexbhzffuj8wg6klvihde_gg.jpeg"><br><br>  A pr√≥xima maneira de proteger o seu Mac √© verificar as assinaturas de certificado.  A maioria dos bin√°rios assinados do macOS n√£o √© bloqueada pelo recurso de seguran√ßa GateKeeper, e √© por isso que os hackers fornecem assinaturas para os malwares mais modernos do Mac.  Por outro lado, uma vez que um v√≠rus assinado √© detectado, a Apple simplesmente revoga seu certificado de assinatura.  Isso significa que esse malware n√£o pode ser executado em nenhum Mac. <br><br>  Por exemplo, temos um bin√°rio do v√≠rus Windtall cujo certificado de assinatura foi revogado pela Apple.  Isso significa que, mesmo se o reprofilarmos e aplic√°-lo ao novo sistema, ainda n√£o conseguiremos iniciar.  Portanto, apenas tentamos ignorar o procedimento de revoga√ß√£o de certificado excluindo o pr√≥prio certificado de assinatura. <br><br><img src="https://habrastorage.org/webt/0f/9g/dy/0f9gdymdaskct9prhp2exlstml4.jpeg"><br><br>  Em seguida, usamos uma c√≥pia n√£o assinada do malware convertido ou fornecemos um certificado de assinatura legal diferente, o que √© bastante f√°cil de obter. <br><br>  Para remover o certificado, a pr√≥pria Apple fornece um utilit√°rio chamado Code Sign que cont√©m o sinalizador de remo√ß√£o de assinatura n√£o documentado ou "remover assinatura".  Se voc√™ executar esta opera√ß√£o com seu malware, a Apple simplesmente n√£o prestar√° aten√ß√£o ao certificado de assinatura revogado. <br><br>  Tamb√©m podemos assinar novamente nosso aplicativo usando o mesmo utilit√°rio usando o comando codesign -s ‚ÄúDeveloper ID Applikation:‚Äù.  Isso far√° com que o Windtall assinado novamente n√£o seja mais bloqueado pelo macOS. <br><br>  Por fim, passamos ao MRT, a ferramenta de remo√ß√£o de v√≠rus integrada dispon√≠vel nas vers√µes mais recentes do sistema operacional Mac.  √â semelhante ao XProtect, mas verifica o malware que j√° est√° instalado no sistema e o detecta automaticamente ap√≥s a detec√ß√£o.  Diferentemente do XProtect, suas assinaturas s√£o incorporadas em seu pr√≥prio arquivo bin√°rio.  A Apple costuma usar essa ferramenta para remover aplicativos leg√≠timos que considera inseguros para o seu computador.  Geralmente, esses aplicativos cont√™m vulnerabilidades conhecidas. <br><br><img src="https://habrastorage.org/webt/tq/za/iu/tqzaiuk9rktufxpfwcf8ozwwoae.jpeg"><br><br>  Como o MRT, como o XProtect, trabalha com assinaturas, tamb√©m pode ser contornado.  Usamos o despejo MRT, novamente, porque as assinaturas s√£o constru√≠das no pr√≥prio bin√°rio e pudemos visualiz√°-las todas, incluindo a assinatura do v√≠rus Fruitfly.  N√≥s nos perguntamos se o MRT poderia detectar nossa c√≥pia convertida desse malware? <br><br><img src="https://habrastorage.org/webt/eg/wa/te/egwatesmsl0ez1ccvzlhw_s0-2y.jpeg"><br><br>  Come√ßamos a pesquisar a assinatura interna do Fruitfly e descobrimos que sua detec√ß√£o √© baseada em duas coisas: o caminho para instalar o v√≠rus e o arquivo .plist baixado.  Isso significa que, se alterarmos o caminho ou o nome do malware, o MRT n√£o poder√° detect√°-lo.  Como eu disse, como resultado, contornar essa prote√ß√£o acabou sendo bastante simples. <br><br>  Descobrimos que n√£o √© dif√≠cil contornar o software antiv√≠rus de terceiros, pois voc√™ pode executar um v√≠rus convertido mesmo em um sistema em que o usu√°rio j√° instalou o antiv√≠rus. <br><br><img src="https://habrastorage.org/webt/bm/8o/k0/bm8ok05gky6s453v91lxix-mh2s.jpeg"><br><br>  Falou-se muito sobre esse assunto. N√£o quero entrar em detalhes, mas, em geral, os produtos antiv√≠rus tradicionais s√£o baseados na verifica√ß√£o de assinaturas, como o software antiv√≠rus da Apple, o que significa que eles podem ser contornados pelos mesmos m√©todos. <br><br>  Por exemplo, peguei o mesmo Fruitfly, lembrei-me de que tamb√©m era um script Perl e passei-o atrav√©s do utilit√°rio on-line gratuito Perl Obfuscator, que foi projetado para dificultar a leitura do script Perl e reduzir a probabilidade de sua detec√ß√£o a zero.  Naturalmente, funcionou.  Mas voc√™ pode seguir de uma maneira mais engenhosa, especialmente se voc√™ usa malware bin√°rio.  Voc√™ pode compact√°-lo em um arquivo morto, usar um criptografador ou at√© a execu√ß√£o na mem√≥ria, ou seja, download sem arquivos e execu√ß√£o de v√≠rus na RAM. <br><br>  Alguns anos atr√°s, essas tecnologias foram discutidas na confer√™ncia BlackHat e concluiu-se que, mesmo que um usu√°rio de Mac instalasse software antiv√≠rus de terceiros no sistema, ele ainda n√£o seria capaz de detectar malware reprogramado.  Isso √© uma m√° not√≠cia para os usu√°rios do macOS, pois sabemos que hackers experientes usam malware convertido.  Freq√ºentemente, toda a altera√ß√£o se resume a alterar alguns bytes de c√≥digo ou argumentos da linha de comando, e isso possibilita o controle de um computador para us√°-lo para seus pr√≥prios fins.  Al√©m disso, a maioria das ferramentas antiv√≠rus incorporadas ao macOS e o software antiv√≠rus de terceiros n√£o conseguem detectar amea√ßas convertidas. <br><br>  Como esse software redirecionado √© apenas um spyware bem conhecido, original e ligeiramente refeito, vou usar um "chap√©u branco" e dizer como voc√™ ainda pode encontr√°-los. <br><br><h3>  Detec√ß√£o de software de reconfigura√ß√£o </h3><br>  √â sabido que o software antiv√≠rus baseado em assinatura n√£o lida com malware convertido.  Portanto, devemos prestar aten√ß√£o ao comportamento incomum, anormal e malicioso de tal malware. <br><br>  Devemos tentar detect√°-lo, n√£o gra√ßas √† conhecida assinatura de v√≠rus, mas observando suas a√ß√µes no sistema.  Garantimos que, quando voc√™ refaz um spyware conhecido, suas fun√ß√µes e prop√≥sitos b√°sicos permanecem inalterados. <br><br>  Se refizermos o Trojan de ransomware ransomware, ele ainda criptografar√° seus arquivos, e o backdoor redesenhado continuar√° a coletar arquivos e envi√°-los ao servidor espi√£o. <br>  No slide acima, eu exibi as fun√ß√µes ou recursos do sistema, que devem ser monitorados e monitorados por suas atividades.  Isso inclui a ‚Äúpersist√™ncia‚Äù de aplicativos, atividade incomum de microfone ou c√¢mera, download ou transfer√™ncia de arquivos, captura de tela n√£o autorizada, sintomas de intercepta√ß√£o de teclado, cliques sint√©ticos e criptografia de arquivos.  Isso detectar√° at√© malware reutilizado. <br><br>  Vamos falar sobre perseveran√ßa.  Quando digo "perseveran√ßa", quero dizer que, assim que o spyware for instalado no computador, ele ser√° iniciado automaticamente todas as vezes ap√≥s a reinicializa√ß√£o do sistema.  Esse √© um recurso de qualquer malware para macOS ou Windows - esfor√ßar-se muito para atingir uma meta maliciosa. <br><br>  Podemos simplesmente controlar o sistema de arquivos observando o comportamento do aplicativo "persistente" e, se algo mudar, notifique o usu√°rio ou o administrador do sistema. <br><br>  Agora, quero demonstrar como voc√™ pode detectar a atividade do v√≠rus Windtall original ou remodelado, que se manifesta no acesso n√£o autorizado a um microfone ou webcam Mac. <br><br><img src="https://habrastorage.org/webt/9g/lg/rb/9glgrbybold1rwxqx_xhklasvn4.jpeg"><br><br>  Muitos malwares para Mac acessam uma webcam ou microfone para espionar um usu√°rio de um sistema infectado.  Para detectar essa atividade de v√≠rus, podemos registrar todas as vezes a c√¢mera e o microfone no sistema macOS para que o usu√°rio receba automaticamente uma notifica√ß√£o sobre esse evento.        ,    FruitFly,   ,  Zoom,           . <br><br>    .       ,         . <br><br><img src="https://habrastorage.org/webt/l8/1s/p3/l81sp3q6f1-3x6pjtwr6z0cehpk.jpeg"><br><br>        macOS ‚Äì      Event Taps.            ,      .        . <br><br>     FruitFly,      ,           ,        ‚Äì ¬´¬ª . <br><br><img src="https://habrastorage.org/webt/bi/ce/d4/biced48qutbyjlpsfiywsgwvk0m.jpeg"><br><br>     ,       macOS,    .          .       ,  macOS  ,      .     ,     . <br><br>        Objective-See,    -  macOS.       ,              .      ,     ,        . <br><br><img src="https://habrastorage.org/webt/fg/lz/ea/fglzeamo6vlyrjgnj1sa6hp5vvw.jpeg"><br><br>     ,     ‚Äì    ,     ,        ¬´  ¬ª. <br><br><img src="https://habrastorage.org/webt/bk/c6/po/bkc6poi2uugp2kmcff2q77h0v98.jpeg"><br><br> ,      Digita Security,        .      :           .               Apple,        ,             . <br><br>        ,     .    ,  ,         ,       ,    macOS. <br><br>   ,          . ,    Windtall,   ,  Safari ,     . <br><br><img src="https://habrastorage.org/webt/ek/iq/wo/ekiqwo4mwk-hqxnyijkrxd9n3l4.jpeg"><br><br>     ,      URL     ,     -    URL.            Windtall,       ,      . <br><br>    FruitFly        ,      ,     -   . ,  ,    ,   Apple,      -  . <br><br>  ,  FruitFly      ,            .      ,     .                template       . ,       . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assim, se v√°rios eventos suspeitos conectados entre si ocorrerem no sistema, devemos examin√°-los de perto. </font><font style="vertical-align: inherit;">Nos exemplos acima, demonstrei como a heur√≠stica comportamental pode detectar amea√ßas de seguran√ßa macOS complexas e reajustadas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de concluir, desejo anunciar a Mac Security Conference anual em fevereiro de 2020 no Hava√≠ e convid√°-lo a participar.</font></font><br><br><img src="https://habrastorage.org/webt/bv/ix/tg/bvixtgp1tqcst1xbg6jbdvrlq4k.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Um pouco de publicidade :) </h3><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando aos seus amigos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VPS na nuvem para desenvolvedores a partir de US $ 4,99</a> , um <b>desconto de 30% para os usu√°rios do Habr em um anal√≥gico exclusivo de servidores de n√≠vel b√°sico que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6) N√∫cleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como compartilhar um servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV a partir de US $ 199</a> na Holanda!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - a partir de US $ 99!</b></b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt474590/">https://habr.com/ru/post/pt474590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt474578/index.html">Por que o servi√ßo de marketing por e-mail realmente combate o spam e como ele funciona</a></li>
<li><a href="../pt474580/index.html">Tornando o Aplicativo Acess√≠vel Usando o Machado</a></li>
<li><a href="../pt474582/index.html">Bancos on-line (sem) perigosos: um estudo dos recursos da web de bancos na R√∫ssia e no mundo</a></li>
<li><a href="../pt474584/index.html">Instale o Kali Linux com uma interface gr√°fica em um servidor virtual</a></li>
<li><a href="../pt474588/index.html">As 9 melhores descobertas de c√≥digo aberto para outubro de 2019</a></li>
<li><a href="../pt474592/index.html">Como trabalhar fora do escrit√≥rio e n√£o enlouquecer</a></li>
<li><a href="../pt474594/index.html">Como dividir um neg√≥cio entre fundadores</a></li>
<li><a href="../pt474596/index.html">Aplicativo no TSD e comunica√ß√£o com 1C: Enterprise 8.3 atrav√©s do servi√ßo HTTP. Parte 5 (Menu, objeto complementar)</a></li>
<li><a href="../pt474598/index.html">Como obter uma entrevista com um engenheiro de controle de qualidade sem experi√™ncia profissional</a></li>
<li><a href="../pt474602/index.html">Resolva a equa√ß√£o de regress√£o linear simples</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>