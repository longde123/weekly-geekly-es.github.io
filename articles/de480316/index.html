<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ùå üïö üòë So reduzieren Sie den Verbrauch von WLAN-Modulen um das Zehnfache oder mehr ‚è´ üåî üë®üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag an alle !!! 

 Dieser Artikel befasst sich haupts√§chlich mit dem beliebten ESP8266-Modul (ESP8285). 

 K√ºrzlich wurde mir in einem der Foren...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So reduzieren Sie den Verbrauch von WLAN-Modulen um das Zehnfache oder mehr</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480316/"> Guten Tag an alle !!! <br><br>  Dieser Artikel befasst sich haupts√§chlich mit dem beliebten ESP8266-Modul (ESP8285). <br><br>  K√ºrzlich wurde mir in einem der Foren eine Frage zum ESP-NOW-Protokoll gestellt.  Aus diesem Grund habe ich mich dazu entschlossen, √ºber M√∂glichkeiten zur Reduzierung des Verbrauchs von Sensoren und Aktoren zu sprechen, die √ºber WLAN arbeiten, einschlie√ülich des ESP8266, insbesondere von Sonoff. <br><a name="habracut"></a><br>  Zun√§chst das Wesentliche des zu l√∂senden Problems. <br><br>  In der klassischen WLAN-L√∂sung m√ºssen Sie entweder einen speziellen Router oder ein Smartphone oder Ger√§t im Access Point-Modus verwenden. <br><br>  Der Vorgang zum Verbinden und √úbertragen von Daten ohne spezielle T√§nze mit einem Tamburin auf dem ESP8266 dauert 1 bis 4 Sekunden.  In diesem Fall betr√§gt die Stromaufnahme mindestens 70 mA. <br><br>  Bei Verwendung von Batteriestrom wie einem Temperatursensor wird der Tiefschlafmodus verwendet.  Das Ger√§t wacht regelm√§√üig auf, sendet Daten und schl√§ft ein. <br><br>  Aufgrund meiner Erfahrung kann ich sagen, dass die Aktivit√§tszeit von ESP8266 auf 0,1-0,13 Sekunden reduziert werden kann. <br><br>  Dar√ºber hinaus ist ein wesentlicher Teil dieser Zeit die Betriebszeit des Bootloaders: von 0,08 Sekunden bis 0,1 Sekunden, aber das WLAN ist zu diesem Zeitpunkt noch nicht eingeschaltet, und daher betr√§gt der Stromverbrauch im Durchschnitt 25 mA. <br><br>  Ich benutze dieses Intervall, um die Akkuladung zu √ºberpr√ºfen. <br>  Wenn f√ºr die Kommunikation nicht gen√ºgend Geb√ºhren anfallen, schicke ich das Ger√§t erneut in den Energiesparmodus. <br>  Diese Zeit nutze ich, um die Sensorwerte zu √ºberpr√ºfen und mit einem vorgegebenen Wertebereich zu vergleichen. <br><br>  Wenn Sie sich auf dem Flur befinden, schicken Sie das Ger√§t erneut in den Ruhezustand. <br>  Somit wird unn√∂tiges Senden von Daten erheblich reduziert. <br><br>  In der Regel ist es bei Projekten wie einem ‚ÄûSmart Home‚Äú, einem Mondschein oder einer Bieranlage, Wetterwetterstationen erforderlich, die Temperatur zu messen und die Relaisbirne, die Pumpe und den Motor ein- und auszuschalten. <br>  Um solche Ger√§te zu steuern und Temperatur- oder Druckdaten auf einem Smartphone oder einem anderen Ger√§t abzurufen, gen√ºgen einige Bytes. <br><cut></cut><br>  Gegen√ºber dem ESP8266 im Internet gibt es verschiedene M√∂glichkeiten, die Aktivit√§tszeit von Ger√§ten im Daten√ºbertragungsmodus √ºber WLAN zu reduzieren. <br><br>  <b>Option 1:</b> Verwenden Sie TCP / IP und eine feste IP-Adresse. <br>  Der erste f√ºr ESP8266 wurde von pvvx hergestellt. <br>  Nachteile: Die Verwendung von selbst erstelltem SDK. <br>  Aktivit√§tszeit von 0,54 sek. <br><br>  <b>Option 2:</b> Ich war lange Zeit der erste, der diese Methode verwendete, fand sie aber heute nicht mehr im Internet. <br>  Korrigieren der Verbindungsparameter in RAM RTC mithilfe des UDP-Protokolls und Deaktivieren von DHCP. <br>  Vorteil: Standard SDK ohne Kr√ºcken, Paketl√§nge bis zu 64K. <br>  Aktivit√§tszeit von 0,25 sek. <br><br>  <b>Option 3:</b> ESP-NOW-Protokoll. <br>  Nachteil: Die Schwierigkeit, von Amateuren verstanden zu werden, die Notwendigkeit, sich mit dem WLAN-Protokoll zu verbinden, um Daten mit einem Smartphone auszutauschen. <br>  Vorteil: Standard SDK, keine Kr√ºcken, Paketl√§nge bis zu 512 Bytes. <br>  Aktivit√§tszeit: von 0,13 Sekunden (Standard-Bootloader);  0.1 (spezieller Bootloader) <br><br>  <b>Option 4:</b> CNLohr-L√∂sung basierend auf hausgemachtem pvvx-SDK und Verwendung von Rohpaketen. <br>  Der Unterschied zur ESP-NOW-L√∂sung besteht darin, dass das √ºbertragene Paket kleiner ist, aber das WiFi-Protokoll verwendet wird. <br>  Nachteil: Es ist f√ºr Amateure sehr schwer zu meistern, es kann nicht in einer Arduino-Umgebung implementiert werden, es sind √Ñnderungen an der Software des Routers erforderlich. <br>  Aktivit√§tszeit: wie in Option 3. <br><br>  <b>Option 5: Eine</b> universelle Methode f√ºr WiFi-basierte private Netzwerke. <br>  Keine Kr√ºcken.  Es ist einfach auf Arduino zu implementieren, Software ist Standard. <br>  Es kann nicht nur f√ºr ESP verwendet werden. <br>  Es ist kein Router erforderlich. <br>  Nachteil: Paketl√§nge 4 Bytes <br>  Aktivit√§tszeit: wie in Option 3 und 4. <br><br>  Methode: <br>  Im lokalen Netzwerk verwenden wir spezielle MAC-Adressen. <br>  Das erste Byte der Adresse, z. B. 0x36. <br>  Das zweite Byte der Adresse gibt die Ger√§tenummer an. <br>  3,4,5,6 Bytes enthalten die √ºbertragenen Informationen. <br>  Damit die √ºbertragenen Informationen empfangen werden k√∂nnen, muss lediglich die Verbindung hergestellt werden. <br>  Die Zeit zum √úbertragen von Daten ist Null, da wir die Daten zum Zeitpunkt der Verbindung erhalten. <br><br>  Eine Ausf√ºhrungsform dieser Methode f√ºr Arduino kann hier <a href="https://github.com/HarringayMakerSpace/sonoff-adhoc" rel="nofollow">abgeschrieben werden</a> . <br><br>  Im obigen Beispiel ist nur eine Variante dieser Daten√ºbertragungsmethode implementiert. <br><br>  Es gibt keinen Tiefschlafmodus.  Daher ist eine Energieeinsparung nur aufgrund der Nullzeit f√ºr die Informations√ºbertragung m√∂glich.  Der Sender funktioniert nur im angeschlossenen Zustand und der Strom steigt f√ºr nur 2-4 ms auf 300 mA an. <br><br>  Um den vollen Speichereffekt f√ºr eine der Optionen zu erzielen, muss der Tiefschlafmodus auf eine Standardweise implementiert werden. <br><br>  In den Optionen 3 bis 5 dauert der Betrieb der WiFi-Einheit daher nicht l√§nger als 0,04 Sekunden. <br>  Zu diesem Zeitpunkt variierte der Stromverbrauch von 70 bis 300 mA. <br>  In der √ºbrigen Zeit betr√§gt die Stromaufnahme des ESP8266 nicht mehr als 20 mA. <br>  Anstatt f√ºr eine Sitzung mit 70 mA * s Energie zu verbrauchen, erhalten wir ungef√§hr 3 mA * s. <br>  Wer m√∂chte, kann die Einsparungen f√ºr bestimmte Ger√§te genauer berechnen. <br><br>  <b>Ich werde Option 2 n√§her erl√§utern</b> . <br>  Beim Beenden von Depp-Sleep gibt es drei M√∂glichkeiten, um eine Verbindung zu WiFi f√ºr Messaging herzustellen. <br><br>  1) Login und Passwort - neue Werte. <br>  Die Verbindungs- und √úbertragungszeit der UDP-Nachricht betr√§gt 4 Sekunden. <br><br>  2) Login, Passwort und IP werden in RTC gespeichert. <br>  Die Verbindungs- und √úbertragungszeit der UDP-Nachricht betr√§gt 1,2 Sekunden. <br><br>  3) Login, Passwort, IP, in RTC speichern und DHCP deaktivieren. <br>  Die Verbindungs- und √úbertragungszeit der UDP-Nachricht betr√§gt 0,25 Sekunden. <br><br>  Die Zeit wird unter Ber√ºcksichtigung der Betriebszeit des Bootloaders berechnet. <br>  Das sind 0,12 Sekunden in einem Standard-Boot. <br>  Wenn wir den Bootloader neu schreiben, kann die Zeit um weitere 0,04 bis 0,06 Sekunden verk√ºrzt werden. <br><br>  Wenn wir also Login, Passwort und IP in RTC speichern, erh√∂ht sich die Akkulaufzeit um das Dreifache als ohne Speichern.  Diese Speichermethode ist im Internet bekannt und wird von vielen benutzt. <br><br>  Wenn Sie jedoch DHCP deaktivieren, erh√∂ht sich die Akkulaufzeit um das 13-fache. <br>  Genau das mache ich, aber ich habe im Internet noch keine solche L√∂sung gesehen. <br><br>  Alles Erfolg beim Energiesparen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de480316/">https://habr.com/ru/post/de480316/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de480294/index.html">Hochgeschwindigkeits-Bildverarbeitung im vielseitigen LEGO Teilsortierger√§t</a></li>
<li><a href="../de480296/index.html">Reaktive Entwicklung des Telegrammbots</a></li>
<li><a href="../de480300/index.html">Im Jahr 2011 war die Frage, ob Nginx Igor Sysoev oder Rambler geh√∂rt</a></li>
<li><a href="../de480306/index.html">Warum die geschlossene T√ºr schlagen?</a></li>
<li><a href="../de480310/index.html">Habra-Detektiv: Das Geheimnis der Nachrichtenredakteure</a></li>
<li><a href="../de480318/index.html">Eine Auswahl an bevorstehenden kostenlosen Events f√ºr Entwickler in Moskau # 3 (16.-24. Dezember)</a></li>
<li><a href="../de480320/index.html">Zehn Jahre ONYX in Russland - wie sich Technologien, Leser und der Markt in dieser Zeit ver√§ndert haben</a></li>
<li><a href="../de480324/index.html">String-Typ-Implementierung in CPython</a></li>
<li><a href="../de480326/index.html">Die F5 Networks Corporation sendet ihren Kunden Briefe, in denen sie √ºber die aktuelle Situation mit NGINX informiert werden</a></li>
<li><a href="../de480328/index.html">Wie man Freunde macht PyTorch und C ++. TorchScript verwenden</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>