<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤨 🔑 🐤 Curso MIT "Seguridad de sistemas informáticos". Lección 16: "Ataques de canal lateral", Parte 3 📺 👨‍❤️‍👨 👨🏼‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnología de Massachusetts. Conferencia Curso # 6.858. "Seguridad de los sistemas informáticos". Nikolai Zeldovich, James Mickens. Año 2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Seguridad de sistemas informáticos". Lección 16: "Ataques de canal lateral", Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/429394/"><h3>  Instituto de Tecnología de Massachusetts.  Conferencia Curso # 6.858.  "Seguridad de los sistemas informáticos".  Nikolai Zeldovich, James Mickens.  Año 2014 </h3><br>  Computer Systems Security es un curso sobre el desarrollo e implementación de sistemas informáticos seguros.  Las conferencias cubren modelos de amenazas, ataques que comprometen la seguridad y técnicas de seguridad basadas en trabajos científicos recientes.  Los temas incluyen seguridad del sistema operativo (SO), características, gestión del flujo de información, seguridad del idioma, protocolos de red, seguridad de hardware y seguridad de aplicaciones web. <br><br>  Lección 1: "Introducción: modelos de amenaza" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 2: "Control de ataques de hackers" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 3: “Desbordamientos del búfer: exploits y protección” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 4: “Separación de privilegios” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 5: “¿De dónde vienen los sistemas de seguridad?” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> <br>  Lección 6: “Oportunidades” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 7: “Sandbox de cliente nativo” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 8: "Modelo de seguridad de red" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 9: "Seguridad de aplicaciones web" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 10: “Ejecución simbólica” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 11: "Ur / Lenguaje de programación web" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 12: Seguridad de red <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 13: "Protocolos de red" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 14: "SSL y HTTPS" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 15: "Software médico" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lección 16: "Ataques de canal lateral" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  <b>Público:</b> ¿Utiliza el método Karatsuba? <br><br>  <b>Profesor:</b> sí, este es un método de multiplicación inteligente que no requiere cuatro etapas de cálculo.  El método Karatsuba se enseña en el curso .601, o ¿cómo se designa hoy? <br><br>  <b>Audiencia:</b> 042. <br><br>  <b>Profesor:</b> 042, excelente.  Sí, este es un muy buen método.  Casi todas las bibliotecas criptográficas lo usan.  Para aquellos de ustedes que no son graduados de nuestro instituto, lo digo porque tenemos estudiantes graduados aquí, escribiré sobre el método Karatsuba en la pizarra.  Aquí necesita calcular tres valores: <br><br>  a <sub>1</sub> b <sub>1</sub> <br>  (a <sub>1</sub> - a <sub>0</sub> ) (b <sub>1</sub> - b <sub>0</sub> ) <br>  a <sub>0</sub> b <sub>0</sub> <br><br>  Por lo tanto, haces 3 multiplicaciones en lugar de cuatro, y resulta que puedes restaurar este valor a <sub>1</sub> b <sub>0</sub> + a <sub>0</sub> b <sub>1 a</sub> partir de estos tres resultados de multiplicación. <br><br><img src="https://habrastorage.org/webt/sg/_m/od/sg_modaezv2yehkmftzlhpybti0.jpeg"><br><br>  La forma especial de hacer esto es esto ... déjame ponerlo en una forma diferente. <br><br>  Entonces, tendremos: <br><br>  (2 <sup>64</sup> + 2 <sup>32</sup> ) (a <sub>1</sub> b <sub>1</sub> ) + <br>  (2 <sup>32</sup> ) (- (a <sub>1</sub> - a <sub>0</sub> ) (b <sub>1</sub> - b <sub>0</sub> ) <br>  (2 <sup>32</sup> + 1) (a <sub>0</sub> b <sub>0</sub> ) <br><br>  Esto no está muy claro, pero si calcula los detalles, en última instancia, convénzase usted mismo de que este valor en estas 3 líneas es equivalente a ab, pero al mismo tiempo reduce el cálculo en una multiplicación.  Y la forma en que aplicamos esto a multiplicaciones más voluminosas es que continúas bajando recursivamente.  Entonces, si tiene valores de 512 bits, puede dividirlos en una multiplicación de 256 bits.  Haces tres multiplicaciones de 256 bits, cada vez de forma recursiva utilizando el método Karatsuba.  Al final, sus cálculos se reducen al tamaño de la máquina y pueden procesarse mediante una sola instrucción de máquina. <br><br><img src="https://habrastorage.org/webt/gv/7s/ae/gv7saezq-q5xj52fvxnjxenikgo.jpeg"><br><br>  Entonces, ¿dónde está el ataque de tiempo?  ¿Cómo usan estos muchachos la multiplicación de Karatsuba?  Resulta que OpenSSL está preocupado por dos tipos de multiplicación que podría tener que hacer. <br>  El primero es la multiplicación de dos números grandes de aproximadamente el mismo tamaño.  Esto sucede muchas veces cuando realizamos una exponenciación modular, porque todos los valores que multiplicaremos tendrán un tamaño de aproximadamente 512 bits.  Por lo tanto, cuando multiplicamos c por y o cuadrado, multiplicamos dos cosas de aproximadamente el mismo tamaño.  En este caso, el método Karatsuba tiene mucho sentido, ya que reduce el tamaño de los números al cuadrado en aproximadamente 1,58 veces, lo que acelera enormemente el proceso de cálculo. <br>  El segundo tipo de multiplicación es cuando OpenSSL multiplica dos números cuyo tamaño difiere significativamente entre sí: uno es muy grande y el otro es muy pequeño.  En este caso, también podría usar el método Karatsuba, pero funcionará más lentamente que la multiplicación primitiva.  Suponga que multiplica un número de 512 bits por un número de 64 bits, tendrá que elevar cada bit del primer número a una potencia de 64, lo que resulta en una desaceleración del proceso 2n en lugar de una aceleración n / 1.58.  Por lo tanto, estos tipos que usan OpenSSL intentaron hacerlo de manera más inteligente, y fue aquí donde comenzaron los problemas. <br><br>  Decidieron que cambiarían dinámicamente entre el método efectivo de Karatsuba y el método de multiplicación de la escuela primaria.  Su heurística fue la siguiente.  Si los dos números que multiplica consisten en el mismo número de palabras de máquina, o al menos tienen el mismo número de bits que las unidades de 32 bits, entonces se utiliza el método Karatsuba.  Si dos números difieren mucho en tamaño entre sí, al cuadrado o directo simple, se realiza la multiplicación normal. <br><br>  En este caso, puede realizar un seguimiento de cómo se produce el cambio a otro método de multiplicación.  Dado que el momento del cambio no pasa sin dejar rastro, después se notará si ahora requiere mucho más tiempo para la multiplicación o mucho menos que antes.  Los investigadores aprovecharon esta circunstancia para organizar un ataque utilizando el método de sincronización. <br><br>  Creo que he terminado de contarte todos los trucos extraños que las personas usan cuando implementan RSA en la práctica.  Ahora intentemos juntarlos y usarlos en relación con todo el servidor web para descubrir cómo puede "pellizcar" los bits que nos interesan del paquete de red de entrada. <br><br>  Si recuerda de la conferencia sobre HTTPS, el servidor web tiene una clave secreta.  Utiliza esta clave secreta para demostrar que es el propietario correcto de todos los certificados a través de HTTPS o TLS.  Esto se debe al hecho de que los clientes envían algunos bits seleccionados al azar, estos bits se cifran con la clave pública del servidor y el servidor descifra este mensaje con el protocolo TLS.  Y si se marca el mensaje, estos bits aleatorios se utilizan para establecer una sesión de comunicación. <br><br>  Pero en nuestro caso, este mensaje no se verificará, porque se creará de una manera especial, y cuando resulte que los bits adicionales no coinciden, el servidor devolverá un error tan pronto como termine de descifrar nuestro mensaje. <br><br>  Esto es lo que vamos a hacer aquí.  El servidor, puede suponer que es Apache con SSL abierto, recibirá un mensaje del cliente que considera como texto cifrado o algún texto cifrado hipotético que el cliente creó.  Lo primero que hacemos con el texto cifrado c es descifrarlo usando la fórmula con → (c <sup>d</sup> mod n) = m. <br><br>  Si recuerda la primera optimización, aplicaremos el teorema del resto chino y dividiremos nuestro texto en dos partes: una para calcular por mod p, la otra por mod q, y luego combinar los resultados.  Primero, tome c y represente en dos cantidades: la primera se llama c <sub>0</sub> , será igual a mod q, y la segunda es c <sub>1</sub> , y será igual a c mod p.  Luego haremos lo mismo para calcular c para d mod p y c para d mod q. <br><br><img src="https://habrastorage.org/webt/re/sp/qo/respqor_rehsunlfqjtc9lbmeok.jpeg"><br><br>  A continuación, vamos a cambiar a la vista Montgomery porque esto hará que nuestras multiplicaciones sean muy rápidas.  Entonces, lo siguiente que SSL hará con su número es calcular c <sub>0</sub> ', que será igual a c <sub>0</sub> R mod q y hacer lo mismo a continuación para el valor c1, no escribiré esto porque se ve igual . <br><br>  Ahora que hemos cambiado a la forma de Montgomery, finalmente podemos realizar nuestras multiplicaciones, y aquí usaremos la técnica de "ventana deslizante".  Tan pronto como obtengamos c <sub>0</sub> ', hacemos este simple aumento de c <sub>0</sub> ' a la potencia de d en mod q.  Y aquí, dado que calculamos este valor para d, usaremos "ventanas deslizantes" para los bits del exponente d, y también usaremos el método Karatsuba o la multiplicación habitual, dependiendo del tamaño de nuestros operandos. <br><br><img src="https://habrastorage.org/webt/ah/oa/um/ahoaumcorgtkbkeuj6uxli1yv9i.jpeg"><br><br>  Entonces, si resulta que este valor c <sub>0</sub> 'y el resultado de cuadratura obtenido previamente son del mismo tamaño, usamos el método Karatsuba.  Si c <sub>0</sub> 'es muy pequeño, y el resultado previo de la multiplicación es grande, entonces cuadraremos y multiplicaremos de la manera usual.  Aquí usamos "ventanas deslizantes" y el método Karatsuba en lugar de la multiplicación normal. <br><br><img src="https://habrastorage.org/webt/pk/xc/wl/pkxcwlnkl3fndnsc-nx3rqk1auo.jpeg"><br><br>  También en esta etapa, aparecen reducciones adicionales.  Porque con cada multiplicación, las reducciones adicionales serán proporcionales a lo que elevamos a la potencia de mod q, es decir, el valor de (c <sub>0</sub> ') <sup>d</sup> .  Aquí, con una conexión simple de la fórmula, la probabilidad de reducciones adicionales será proporcional al valor c <sub>0</sub> 'mod q dividido por 2R.  Es en este lugar donde aparece un bit que afecta el tiempo. <br><br>  De hecho, hay dos efectos posibles: usar el método Karatsuba en lugar de la multiplicación normal y la aparición de abreviaturas adicionales que vas a hacer. <br><br>  En un segundo verás cómo se puede usar.  Ahora, cuando obtenga este resultado para mod q y obtenga un resultado similar para mod p, finalmente puede recombinar estas dos partes en la parte superior e inferior y usar CRT, el teorema del resto chino. <br><br>  Y lo que obtienes de la CRT como resultado ... lo siento, creo que primero debemos convertir esto desde el formulario de Montgomery.  Por lo tanto, antes de la recombinación, convertimos la parte superior a la expresión (c <sub>0</sub> ') <sup>d</sup> / R mod q y devolvemos nuestro valor cd mod q.  En la parte inferior, en consecuencia, obtenemos cd mod p. <br><br>  Ahora puede usar CRT para obtener el valor de c <sup>d</sup> mod n.  Perdón por la fuente pequeña, no tenía suficiente pizarra.  Aproximadamente lo mismo que obtenemos aquí abajo con <sub>1</sub> , y finalmente podemos obtener nuestro resultado, es decir, el mensaje m. <br><br><img src="https://habrastorage.org/webt/vw/md/4x/vwmd4xcq0kjbfpsvw29dyqtglnk.jpeg"><br><br>  Por lo tanto, el servidor toma un paquete entrante que recibe, lo ejecuta a través de toda esta tubería, ejecuta dos partes de esta tubería y termina con un mensaje descifrado m igual a cd mod m.  Luego revisará el relleno de esta publicación.  En el caso de nuestro ataque específico, creamos de tal manera que, de hecho, esta adición no coincidirá.  Elegimos el valor c para las heurísticas que no cifran el mensaje real con la adición de relleno correcta. <br><br>  Por lo tanto, el complemento no pasa la prueba, el servidor deberá registrar un error, enviar un mensaje de error al cliente y desconectarse.  Por lo tanto, vamos a medir el tiempo que le tomará al servidor pasar nuestro mensaje a través de esta tubería.  ¿Tiene alguna pregunta sobre el proceso de procesamiento de un mensaje por parte del servidor y la combinación de todas estas optimizaciones? <br><br>  <b>Público:</b> en mi opinión, hay un error con un índice de magnitud c. <br><br>  <b>Profesor:</b> sí, tienes razón, estoy agregando el índice 0, aquí debería estar c <sub>0</sub> <sup>d</sup> mod q. <br><br><img src="https://habrastorage.org/webt/zf/c8/eb/zfc8ebgspz9g347khmvzs1n-9hc.jpeg"><br><br>  <b>Público:</b> cuando divide por R mod q, ¿no hay suposiciones sobre cuánto q debe agregar para reducir aún más los bits bajos a ceros? <br><br>  <b>Profesor:</b> sí, tiene razón, en esta etapa final (c <sub>0</sub> ') <sup>d</sup> / R mod q puede haber reducciones adicionales.  Entonces deberíamos hacer esta división por R de la manera correcta, y probablemente deberíamos hacer lo mismo que hacer la reducción de Montgomery aquí, cuando dividimos por R, para convertir el valor nuevamente.  Dado que al comienzo de los cálculos no está claro exactamente cuánto q deberíamos agregar, usamos el método de selección, destruimos los ceros bajos, luego nuevamente hacemos mod q y, posiblemente, una reducción adicional.  Tiene toda la razón, en este caso es exactamente la misma división por R mod q que para cada paso de la multiplicación de Montgomery. <br><br>  Entonces, ¿cómo aprovechar esto?  ¿Cómo puede un atacante resolver la clave secreta de un servidor midiendo el tiempo que lleva completar las operaciones?  Estos tipos tienen un plan que se basa en adivinar un bit de clave privada a la vez.  Podemos suponer que la clave secreta es el exponente encriptado d, porque conoce e y sabe n, esta es la clave pública.  Lo único que no sabes es d. <br><br><img src="https://habrastorage.org/webt/qw/pv/cg/qwpvcgujkfsub1kworr1vy2bmea.jpeg"><br><br>  De hecho, en este ataque, no adivinan directamente el valor de d, ya que es bastante complicado.  En cambio, consideran qop, sin importar cuál de estas dos cantidades.  Una vez que adivine lo que importa, puede calcular n = pq.  Luego, si conoce los valores de p y q, puede calcular la función φ de la que hablamos anteriormente.  Esto le permitirá obtener el valor de d del valor de e.  Por lo tanto, esta factorización del valor de n es extremadamente importante; debe mantenerse en secreto para garantizar la seguridad de RSA. <br><br>  De hecho, estos tipos intentaron adivinar el valor q analizando los tiempos de esta tubería.  ¿Qué están haciendo para esto?  Seleccionan cuidadosamente el valor inicial del valor de c y miden el tiempo de su paso a través de la tubería del servidor. <br><br>  En particular, hay dos partes en este ataque, y debes tomar algunos pasos iniciales para adivinar los primeros bits.  Luego, tan pronto como tenga los primeros bits, puede adivinar el siguiente.  Por lo tanto, déjame no contarte en detalle cómo adivinan los primeros bits, porque de hecho es mucho más interesante considerar cómo adivinan el siguiente bit.  Si tenemos tiempo, volveremos a cómo se describe la suposición de varios bits iniciales en un artículo de conferencia. <br><br>  Entonces, suponga que tiene la suposición g sobre qué bits están en el valor de esta q.  Deje que este valor consista en tales bits: g = g <sub>0</sub> g <sub>1</sub> g <sub>2</sub> ... y así sucesivamente.  Más bien, ni siquiera es g, sino los bits reales de q, así que permítanme reescribirlo así: g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ...  Creemos que estos q son bits altos, y estamos tratando de adivinar los bits cada vez más bajos.  Supongamos que conocemos el valor de q hasta el bit qj, y luego siguen todos los ceros.  No tienes idea de cuáles son el resto de los bits. <br><br><img src="https://habrastorage.org/webt/8c/ca/df/8ccadfhe0orkn4jalptuhmm_c9a.jpeg"><br><br>  Estos tipos intentaron inyectar esta conjetura g en este lugar de nuestra tubería: (c0 ') d mod q.  Porque este es el lugar donde se usan dos tipos de optimización: el método Karatsub en lugar de la multiplicación habitual y un número diferente de abreviaturas adicionales dependiendo del valor de c <sub>0</sub> '.  En realidad, intentaron introducir dos conjeturas diferentes en este lugar de la tubería: la primera, que parece g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ... qj 000 ... 0000, y la segunda, que llamaron g <sub>high</sub> , que consiste en los mismos bits altos, pero en su lugar De todos los ceros al final hay una unidad que indica un bit alto, seguido de ceros nuevamente: <br><br>  g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ... qj 100 ... 0000. <br><br>  ¿Cómo ayuda esto a estos muchachos a entender lo que está sucediendo?  Hay dos formas de hacer esto.  Supongamos que nuestra suposición g es igual al valor c <sub>0</sub> '.  Podemos suponer que estos g y g <sub>altos</sub> corresponden al valor c <sub>0</sub> 'dado en el tablero izquierdo.  En realidad, es bastante simple hacer esto, porque c <sub>0</sub> 'es bastante fácil de calcular hacia atrás a partir del valor de entrada cifrado c <sub>0</sub> , simplemente lo multiplica por R. <br><br><img src="https://habrastorage.org/webt/u9/5k/yp/u95kypmv569-dhhozaeqfpcwgjo.jpeg"><br><br>  Por lo tanto, para adivinar el valor (c <sub>0</sub> ') <sup>d</sup> , solo necesitan adivinar, adivinar g, y primero dividirlo por R, es decir, dividir por 512 mod algo allí.  Luego lo volverán a presentar, el servidor lo multiplicará por R y continuará el proceso descrito en nuestro esquema de canalización. <br><br>  Entonces, supongamos que pudimos poner nuestro valor entero particular seleccionado en el lugar correcto.  Entonces, ¿cuál será el tiempo de cálculo c <sub>0</sub> 'a d mod q? <br><br><img src="https://habrastorage.org/webt/zy/b5/ud/zyb5udmf96e2cvwliab80lhusum.jpeg"><br><br>  Hay dos opciones posibles donde q encaja en esta imagen.  Puede ser que q esté entre estos dos valores de gyg <sub>alto</sub> , porque el siguiente bit de q es 0. Por lo tanto, este valor, el primer 0 después de qj, será menor que q, pero este valor, 1 después de q, será mayor que q.  Esto sucede si el siguiente bit de q es 0, o es posible que q esté por encima de estos dos valores si el siguiente bit de q es 1. <br><br><img src="https://habrastorage.org/webt/g5/uk/mn/g5ukmnfmvzp_rdlyhwtptj-8e4o.jpeg"><br><br>  Ahora podemos decir cuál será el tiempo de descifrado de estos dos valores si q se encuentra entre ellos, o si q se encuentra por encima de ambos. <br><br>  Veamos la situación donde q se encuentra arriba.  En este caso, todo es más o menos lo mismo.  Dado que ambos valores son menores que q, el valor de estas cosas en mod q será aproximadamente el mismo.  Son ligeramente diferentes debido a este bit extra, pero aún más o menos del mismo tamaño.  Y el número de reducciones adicionales, reducción adicional, probablemente tampoco diferirá mucho, porque es proporcional al valor de c0 'mod q.  Y para ambos valores <sub>altos</sub> g y g menores que q, todos son casi iguales.  Ninguno de ellos excederá q y no causará una gran cantidad de reducciones adicionales, porque para q mayor que ambas conjeturas, el número de cálculos por el método Karatsuba con respecto al número de cálculos ordinarios seguirá siendo el mismo.  En términos de esta relación, el servidor manejará g y g <sub>high por</sub> igual.  Por lo tanto, el servidor está a punto de crear aproximadamente la misma cantidad de abreviaturas adicionales para ambos valores.  Por lo tanto, si ve que el servidor está pasando el mismo tiempo respondiendo a estas suposiciones, entonces probablemente debería suponer que realmente hay 1 en el valor <sub>alto de</sub> g en este punto. <br><br><img src="https://habrastorage.org/webt/ui/d_/tg/uid_tglidwosbzxkquvonqfrzi0.jpeg"><br><br>  Por otro lado, si q se encuentra entre estos dos valores, entonces hay dos cosas posibles que pueden causar cambios de conmutación y sincronización.  Una de las cosas es que dado que g <sub>high es</sub> ligeramente mayor que q, el número de cortes adicionales será proporcional a c <sub>0</sub> 'mod q, que es muy pequeño, porque c <sub>0</sub> ' es q más algunos bits en esta secuencia adicional de 100 ... 00.  Por lo tanto, el número de reducciones adicionales será más notable y todo comenzará a suceder más rápido. <br>    ,   ,  , , ,  : «,         !».  ,    g  c <sub>0</sub> '     ,   q,   ,  g <sub>high</sub>  q,  g <sub>high</sub> mod q     .      ,       .         –    ,       ,   . <br><br>     c <sub>0</sub> ' mod q.  c <sub>0</sub>     g <sub>high</sub> ,   q,    ,        g  q.       ,     .     ,     ,          . ,    32-        ,        . <br><br>   ,     32- , ,     ,   .  ,         .         32 ,   ,    -  .   ,     ,  32, , ,     ,      . <br><br> ,  ,     ,            .    ,     q  1,         ,     q  0,   ,    g <sub>high</sub>  q   ,      ,   . <br><br>          . ,      .          ,    .   ,     ,  1-2 .        , ,   Ethernet. <br>      ,   .      .   ,        7    . ,   , -,         ,        ? <br><br> <b>:</b>     ? <br><br> <b>:</b> ,        ,           ,               ,     ,   .   ,       . <br><br>        ,    ,           7 ,        ,            7 .     7   g,   7   g + 1,  g + 2   7      g + 400.      g,     g, , 7   400,    ? <br><br><img src="https://habrastorage.org/webt/oo/at/9h/ooat9hm2htm-wjoamvqlpfv1vac.jpeg"><br><br> <b>:</b> ,    ,   ? <br><br> : ,     ,   ,        — (c <sub>0</sub> ') <sup>d</sup> .      . ,  ,   ,     mod p.    ,           ,     .  ,         g,  1, 2, 3,  ,    . <br><br>       ,     ,          –    100…00.  ,        mod p,    ,      mod p       .       « »,     ,        (c <sub>0</sub> ') <sup>d</sup> ,    .  ? <br><br> <b>:</b>   ,     ? <br><br> <b>:</b>      -   ,       q. ,        q,   ,     ,     . <br><br> <b>:</b>    c <sub>0</sub> '? <br><br> <b>:</b>     c <sub>0</sub> ',     c,     c <sub>0</sub> '      R  mod n. <br><br><img src="https://habrastorage.org/webt/br/j9/xp/brj9xpzlbunothk8hhovxqsxcz8.jpeg"><br><br>      ,  «»  ,     c <sub>0</sub> =  mod q,       c <sub>0</sub> = ((c <sub>0</sub> ' R <sup>-1</sup> ) mod n) mod q.      R,     R.           c <sub>0</sub> ',     (c <sub>0</sub> ') <sup>d</sup> mod q.  ,     ,   ,  ,       R.   ,  R = 2 <sup>512</sup> .  ,    . <br><br> <b>:</b>            mod p    ? <br><br> <b>:</b>     ,    ,      ?    ,     !   ,        . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3v5Von-oNUg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> . <br><br>  Gracias por quedarte con nosotros.  ¿Te gustan nuestros artículos?  ¿Quieres ver más materiales interesantes?  <b>Apóyenos</b> haciendo un pedido o recomendándolo a sus amigos, un <b>descuento del 30% para los usuarios de Habr en un análogo único de servidores de nivel de entrada que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 núcleos) 10GB DDR4 240GB SSD 1Gbps de $ 20 o cómo dividir el servidor?</a>  (las opciones están disponibles con RAID1 y RAID10, hasta 24 núcleos y hasta 40GB DDR4). <br><br> <b>VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps   </b>      ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> . <br><br>  <b>Dell R730xd 2 veces más barato?</b>  Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV desde $ 249</a> en los Países Bajos y los EE. UU.</b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cómo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es429394/">https://habr.com/ru/post/es429394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429384/index.html">Componentes de bicicletas eléctricas: motor</a></li>
<li><a href="../es429386/index.html">El proveedor de AT&T se convierte en el mayor titular de derechos de autor y comenzará a desconectar a los usuarios acusados ​​de piratería</a></li>
<li><a href="../es429388/index.html">Cómo hacer un rediseño de un sitio web y no crear problemas: 4 pasos importantes</a></li>
<li><a href="../es429390/index.html">Curso MIT "Seguridad de sistemas informáticos". Lección 16: "Ataques de canal lateral", Parte 1</a></li>
<li><a href="../es429392/index.html">Curso MIT "Seguridad de sistemas informáticos". Lección 16: Ataques a través del canal lateral, Parte 2</a></li>
<li><a href="../es429396/index.html">Cómo probar una aplicación cuando interactúa con la API usando SoapUI</a></li>
<li><a href="../es429400/index.html">Seals vs red neuronal 2. O ejecuta SqueezeNet v.1.1 en Raspberry Zero en tiempo real (casi)</a></li>
<li><a href="../es429402/index.html">ML.NET 0.7 (Machine Learning .NET)</a></li>
<li><a href="../es429404/index.html">8 segundos y medio para priorizar la funcionalidad</a></li>
<li><a href="../es429406/index.html">"Monstruos en los juegos o cómo crear miedo"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>