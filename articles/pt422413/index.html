<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö£üèª üçÇ üë®üèº‚Äçüíª Aplica√ß√£o do Arm Mbed OS. Ajuste fino üë©üèΩ ‚¨ÜÔ∏è üë∑üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Depois de usar o Arm Mbed OS, foi poss√≠vel piscar o LED , era hora de testar e configurar outros servi√ßos importantes. O seguinte √© descrito: 


- Tec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aplica√ß√£o do Arm Mbed OS. Ajuste fino</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422413/"><p><img src="https://habrastorage.org/webt/db/tg/fq/dbtgfq4owssxgshqlazk5lwycxm.png" alt="LNDC1"></p><br><p>  Depois de usar o <strong>Arm Mbed OS,</strong> foi poss√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">piscar o LED</a> , era hora de testar e configurar outros servi√ßos importantes.  O seguinte √© descrito: </p><br><ul><li>  <strong>Tecnologia de</strong> configura√ß√£o <strong>Mbed</strong> </li><li>  Por que √© dif√≠cil mudar para <strong>C ++</strong> em <strong>RTOS</strong> regulares </li><li>  Como economizar mem√≥ria no <strong>RTOS</strong> </li><li>  Como as interrup√ß√µes s√£o organizadas no <strong>Mbed OS</strong> </li><li>  Do que √© conveniente depurar o <strong>Mbed OS</strong> </li><li>  Como se livrar de uma camada extra de abstra√ß√£o do <strong>SDK</strong> </li></ul><a name="habracut"></a><br><p>  <em>Continuamos familiarizados com a tecnologia de programa√ß√£o de microcontroladores da fam√≠lia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MKE18F</a> usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ARM Mbed OS</a></em> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Primeiro artigo</a> </li></ul><br><h2 id="tehnologiya-konfigurirovaniya-mbed">  Tecnologia de configura√ß√£o Mbed </h2><br><p>  Um componente importante do projeto Mbed √© um <strong>sistema autom√°tico de configura√ß√£o</strong> e montagem, <strong>online</strong> e <strong>offline</strong> , ou seja,  localmente no computador do usu√°rio.  Prop√µe-se configurar editando <strong>arquivos .json</strong> com nomes especiais.  Em seguida, os scripts no projeto <strong>Python</strong> convertem esses arquivos em arquivos de cabe√ßalho, arquivos de espa√ßo de trabalho do IDE selecionado pelo usu√°rio, arquivos de comando do vinculador e outros arquivos de suporte. </p><br><p>  Mas o problema do m√©todo descrito est√° na opacidade do ponto de vista dos textos de origem, pois √© muito dif√≠cil rastrear onde e o que o sistema de configura√ß√£o muda nas fontes.  Por outro lado, no nosso caso, n√£o h√° motivo para apoiar a capacidade do projeto de ser automaticamente transferido para diferentes IDEs. </p><br><p>  Portanto, decidiu-se abandonar essa abordagem.  Conforme declarado em um artigo anterior, ele foi simplesmente transformado em um projeto on-line para o <strong>IDE IAR</strong> , um monte n√£o estruturado de arquivos foi obtido no espa√ßo de trabalho do IDE, depois eles foram sistematizados e descartados.  Como resultado, voc√™ n√£o precisa mais fazer a configura√ß√£o por meio de arquivos <strong>.json</strong> e existem apenas tr√™s locais espec√≠ficos em que os par√¢metros que afetam a configura√ß√£o do <strong>Mbed est√£o localizados</strong> : </p><br><ul><li>  <strong>Op√ß√µes do compilador</strong> IDE </li><li>  <strong>Arquivo em lote do vinculador MKE18F512xxx16_flash.icf</strong> </li><li>  Arquivo de cabe√ßalho <strong>mbed_config.h</strong> </li></ul><br><p>  No arquivo <strong>mbed_config.h</strong> , <strong>voc√™</strong> pode contar cerca de 130 <strong>defini√ß√µes</strong> , o que √© muito irritante no come√ßo.  Felizmente, por√©m, a maioria deles se refere a pilhas de protocolos sem fio que atualmente n√£o s√£o usados ‚Äã‚Äãno projeto.  Por conveni√™ncia, as entradas foram classificadas para que as reais fossem colocadas no topo.  Inicialmente, as <strong>defini√ß√µes</strong> para diferentes m√≥dulos no arquivo <strong>mbed_config.h s√£o</strong> localizadas aleatoriamente, mas ap√≥s a classifica√ß√£o, fica assim: </p><br><div class="spoiler">  <b class="spoiler_title">Aberto</b> <div class="spoiler_text"><pre><code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#ifndef</span></span> __MBED_CONFIG_DATA__ <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> __MBED_CONFIG_DATA__ // <span class="hljs-type"><span class="hljs-type">Configuration</span></span> parameters <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_RTOS_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:rtos <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_ALL_STATS_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> //<span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">DEVICE_SLEEP</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>       <span class="hljs-type"><span class="hljs-type">SLEEP</span></span>      <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_APP_MAIN_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_APP_TIMER_THREAD_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_APP_IDLE_THREAD_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_DEFAULT_SERIAL_BAUD_RATE</span></span> <span class="hljs-number"><span class="hljs-number">3000000</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_ALL_THREADS_INFO</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_FILENAME_CAPTURE_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_HIST_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_HIST_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_FORCE_NON_COPYABLE_ERROR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_MAX_ERROR_FILENAME_LEN</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_POLL_USE_LOWPOWER_TIMER</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_BAUD_RATE</span></span> <span class="hljs-number"><span class="hljs-number">3000000</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_BUFFERED_SERIAL</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_CONVERT_NEWLINES</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_CONVERT_TTY_NEWLINES</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_FLUSH_AT_EXIT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_DRIVERS_UART_SERIAL_RXBUF_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:drivers <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_DRIVERS_UART_SERIAL_TXBUF_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:drivers <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_DISPATCH_FROM_APPLICATION</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_EVENTSIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_HIGHPRIO_EVENTSIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_HIGHPRIO_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_USE_LOWPOWER_TIMER_TICKER</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_CELLULAR_DEBUG_AT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:cellular <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_CELLULAR_RANDOM_MAX_START_DELAY</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:cellular <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_CELLULAR_USE_APN_LOOKUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:cellular <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_FILESYSTEM_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:filesystem <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_KINETIS_EMAC_RX_RING_LEN</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> // set by library:kinetis-emac <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_KINETIS_EMAC_TX_RING_LEN</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> // set by library:kinetis-emac <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_ADR_ON</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APP_PORT</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APPLICATION_EUI</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APPLICATION_KEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APPSKEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_AUTOMATIC_UPLINK_MESSAGE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_DEVICE_ADDRESS</span></span> <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_DEVICE_EUI</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_DUTY_CYCLE_ON</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_LBT_ON</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_NB_TRIALS</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_NWKSKEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_OVER_THE_AIR_ACTIVATION</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_PHY</span></span> <span class="hljs-type"><span class="hljs-type">EU868</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_PUBLIC_NETWORK</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_TX_MAX_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ADDR_TIMEOUT</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ADDR_TIMEOUT_MODE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_DEBUG_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_DEFAULT_THREAD_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ENABLE_PPP_TRACE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ETHERNET_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_IP_VER_PREF</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_IPV4_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_IPV6_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_MEM_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">36560</span></span> // set by library:lwip[<span class="hljs-type"><span class="hljs-type">Freescale</span></span>] <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_PPP_THREAD_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">768</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_SOCKET_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCP_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCP_SERVER_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCP_SOCKET_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCPIP_THREAD_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">1200</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_UDP_SOCKET_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_USE_MBED_TRACE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_CHANNEL</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_CHANNEL_MASK</span></span> <span class="hljs-number"><span class="hljs-number">0x7fff800</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_CHANNEL_PAGE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_DEVICE_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">NET_6LOWPAN_ROUTER</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_PANID_FILTER</span></span> <span class="hljs-number"><span class="hljs-number">0xffff</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_PSK_KEY</span></span> {<span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0xa8</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_PSK_KEY_ID</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_SEC_LEVEL</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_SECURITY_MODE</span></span> <span class="hljs-type"><span class="hljs-type">NONE</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_HEAP_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">32500</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_CHANNEL</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_CHANNEL_MASK</span></span> <span class="hljs-number"><span class="hljs-number">0x7fff800</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_CHANNEL_PAGE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_COMMISSIONING_DATASET_TIMESTAMP</span></span> <span class="hljs-number"><span class="hljs-number">0x10000</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_EXTENDED_PANID</span></span> {<span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0xb5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xb2</span></span>,<span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span> } // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_ML_PREFIX</span></span> {<span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_NETWORK_NAME</span></span> <span class="hljs-comment"><span class="hljs-comment">"Thread Network"</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_PANID</span></span> <span class="hljs-number"><span class="hljs-number">0x0700</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_PSKC</span></span> {<span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0x9e</span></span>, <span class="hljs-number"><span class="hljs-number">0x57</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_DEVICE_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">MESH_DEVICE_TYPE_THREAD_ROUTER</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_MASTER_KEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x66</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0xcc</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0xee</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_PSKD</span></span> <span class="hljs-comment"><span class="hljs-comment">"ABCDEFGH"</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_SECURITY_POLICY</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_USE_STATIC_LINK_CONFIG</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_USE_MALLOC_FOR_HEAP</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_CONFIGURATION</span></span> nanostack_full // set by library:nanostack <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_CRITICAL_SECTION_USABLE_FROM_INTERRUPT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_EVENT_LOOP_DISPATCH_FROM_APPLICATION</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_EVENT_LOOP_THREAD_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">6144</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_EVENT_LOOP_USE_MBED_EVENTS</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_NVM_CFSTORE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DEFAULT_MESH_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">THREAD</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DEFAULT_STACK</span></span> <span class="hljs-type"><span class="hljs-type">LWIP</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DEFAULT_WIFI_SECURITY</span></span> <span class="hljs-type"><span class="hljs-type">NONE</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_CACHE_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_RESPONSE_WAIT_TIME</span></span> <span class="hljs-number"><span class="hljs-number">5000</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_RETRIES</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_TOTAL_ATTEMPTS</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_APN_LOOKUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_AT_PARSER_BUFFER_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_AT_PARSER_TIMEOUT</span></span> <span class="hljs-number"><span class="hljs-number">8000</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_BAUD_RATE</span></span> <span class="hljs-number"><span class="hljs-number">115200</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_TARGET_NETWORK_DEFAULT_INTERFACE_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">ETHERNET</span></span> // set by target:<span class="hljs-type"><span class="hljs-type">K66F</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_BLOCK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_ENABLE_INFO</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_INTRINSICS</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_LOOKAHEAD</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_PROG_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_READ_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NSAPI_PPP_AVAILABLE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NSAPI_PPP_IPV4_AVAILABLE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NSAPI_PPP_IPV6_AVAILABLE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NVSTORE_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:nvstore <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NVSTORE_MAX_KEYS</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> // set by library:nvstore // <span class="hljs-type"><span class="hljs-type">Macros</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> _RTE_ // defined by library:rtos <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NS_USE_EXTERNAL_MBED_TLS</span></span> // defined by library:nanostack <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">UNITY_INCLUDE_CONFIG_H</span></span> // defined by library:utest <span class="hljs-symbol"><span class="hljs-symbol">#endif</span></span></code> </pre> </div></div><br><h2 id="osobennosti-perehoda-na-c-v-primenenii-k-rtos">  Recursos da transi√ß√£o para o C ++ aplicados ao RTOS </h2><br><p>  <strong>A API de</strong> n√≠vel superior no <strong>Mbed</strong> √© escrita em <strong>C ++</strong> , portanto, esse idioma deve ser usado no c√≥digo do aplicativo.  Mas h√° nuances que voc√™ precisa conhecer. <br>  O uso do <strong>C ++</strong> para <strong>RTOS</strong> em pequenos sistemas embarcados ainda √© relativamente raro.  O problema aqui √© que os projetos <strong>RTOS de</strong> sucesso se esfor√ßam para ser multiplataforma, enquanto o <strong>C ++</strong> exige muito do gerenciamento de recursos da plataforma em compara√ß√£o com o <strong>C.</strong>  O motivo √© o desejo de ocultar do usu√°rio os detalhes do gerenciamento de recursos de baixo n√≠vel.  √â principalmente sobre recursos de mem√≥ria.  Construtores, destruidores, threads, exce√ß√µes com destrui√ß√£o autom√°tica, modelos de objetos de estrutura de dados etc. usam opera√ß√µes impl√≠citas com mem√≥ria din√¢mica.  Mas o recurso de <strong>RAM</strong> em pequenos sistemas √© muito limitado.  A RAM √© o recurso mais escasso nesses sistemas e especialmente no <strong>RTOS</strong> .  No <strong>RTOS,</strong> cada tarefa recebe uma pilha, o desenvolvedor n√£o pode prever seu tamanho exato com anteced√™ncia e, portanto, escolhe com uma margem.  Assim, a presen√ßa de <strong>RTOS</strong> com uma d√∫zia de tarefas exige imediatamente um tamanho de <strong>RAM</strong> de 10 a 30 kB.  √â necess√°ria muita mem√≥ria para v√°rios analisadores e protocolos (HTTP, HTML ...) e sistemas de arquivos.  Se uma tela for usada, os requisitos para <strong>RAM</strong> livre aumentam ainda mais. </p><br><p>  Bibliotecas de ambientes de desenvolvimento como o <strong>IAR</strong> est√£o equipadas com bons gerenciadores de mem√≥ria din√¢mica, mas s√£o projetadas para um ambiente de tempo de execu√ß√£o de thread √∫nico.  Que eles come√ßaram a trabalhar no <strong>RTOS</strong> , √© necess√°rio escrever um c√≥digo adicional.  Esse processo √© chamado de <strong>redirecionamento</strong> . <br>  No <strong>RTOS</strong> escrito em <strong>C, o</strong> redirecionamento geralmente n√£o √© realizado.  Como n√£o h√° opera√ß√µes impl√≠citas com mem√≥ria din√¢mica no n√≠vel do idioma, todas as opera√ß√µes s√£o executadas explicitamente chamando suas pr√≥prias vers√µes de thread-safe das fun√ß√µes <strong>malloc</strong> e <strong>free</strong> .  O programador tem controle total sobre as opera√ß√µes com mem√≥ria din√¢mica e pode aplicar facilmente todas as medidas poss√≠veis para salv√°-lo. </p><br><p>  No caso do <strong>C ++,</strong> se quisermos usar todos os recursos dessa linguagem, teremos que fazer um <strong>redirecionamento</strong> .  Mas o <strong>redirecionamento</strong> em cada ambiente de desenvolvimento √© um processo puramente individual.  Isso dificulta a vida dos desenvolvedores de <strong>RTOS</strong> . </p><br><p>  A figura abaixo √© um exemplo de uma estrutura de chamada com redirecionamento.  As <em>fun√ß√µes __write</em> , <em>__lseek</em> , <em>__read</em> podem n√£o ser implementadas pelo usu√°rio, mas a funcionalidade delas permanece a crit√©rio do <strong>IDE</strong> .  E certamente <strong>printf</strong> e <strong>scanf</strong> n√£o ser√£o multithread. </p><br><img src="https://habrastorage.org/webt/xq/fa/8e/xqfa8eksi4rb4ytbicaehymj0py.png"><br><p>  <strong>O Mbed √©</strong> um dos poucos, sen√£o o √∫nico <strong>RTOS,</strong> que fornece aos c√≥digos-fonte redirecionamentos j√° feitos para uma tr√≠ade de ferramentas de desenvolvimento conhecidas: <strong>GCC</strong> , <strong>IAR</strong> , <strong>Keil</strong> <br>  Apesar de tudo isso, voc√™ pode encontrar artigos sobre como transportar <strong>RTOS</strong> para <strong>C ++</strong> sem executar redirecionamento, por exemplo, resolvendo o problema simplesmente substituindo algumas fun√ß√µes padr√£o comuns pelas suas.  Isso pode funcionar, mas o programador precisa estar ciente de v√°rias restri√ß√µes impl√≠citas e n√£o documentadas ao usar constru√ß√µes <strong>C ++</strong> no <strong>IAR</strong> (apenas construtores est√°ticos, verifique todos os modelos quanto a <strong>novas</strong> , descartar exce√ß√µes etc.).  J√° ser√° dif√≠cil chamar <strong>C ++</strong> .  <strong>O Mbed,</strong> como um sistema f√°cil de usar, remove muitas dessas limita√ß√µes, abordando o <strong>Arduino</strong> com simplicidade. </p><br><p>  Al√©m de todas as vers√µes recentes do IAR, h√° dificuldades em mudar para C11 e C ++ 14, descritas aqui - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://www.iar.com/support/resources/articles/exploring-c11-and-c14/</a> </p><br><h2 id="kak-organizuyutsya-preryvaniya-v-mbed">  Como as interrup√ß√µes s√£o organizadas no Mbed </h2><br><p>  Curiosamente, n√£o ser√° poss√≠vel encontrar uma classe ou fun√ß√£o ou algo adequado para organizar o servi√ßo de interrup√ß√£o na API Mbed.  Voc√™ pode encontrar apenas a classe <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">InterruptIn</a></strong> , destinada apenas a portas externas. </p><br><p>  As respostas para essas perguntas devem ser buscadas no <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CMSIS-RTOS</a></strong> , nomeadamente na <em>camada de acesso perif√©rico principal</em> do <em>CMSIS Cortex-M4</em> .  As macros s√£o definidas l√°: </p><br><ul><li>  <strong><em>NVIC_SetVector</em></strong> - define a rotina de servi√ßo de interrup√ß√£o (ISR) para um determinado vetor </li><li>  <strong><em>NVIC_SetPriority</em></strong> - Define a prioridade para o vetor de interrup√ß√£o especificado. </li><li>  <strong><em>NVIC_EnableIRQ</em></strong> - permite interromper chamadas em um determinado vetor </li></ul><br><p>  Veja como a organiza√ß√£o de interrup√ß√µes do timer <strong>SysTick</strong> √© inicializada: </p><br><pre> <code class="hljs lisp"> NVIC_SetVector(<span class="hljs-name"><span class="hljs-name">mbed_get_m0_tick_irqn</span></span>(), (<span class="hljs-name"><span class="hljs-name">uint32_t</span></span>)SysTick_Handler)<span class="hljs-comment"><span class="hljs-comment">; //   mbed_get_m0_tick_irqn       SysTick. //        SysTick_IRQn    MKE18F16.h //  SysTick_Handler   . NVIC_SetPriority(mbed_get_m0_tick_irqn(), 0xFF); // 0xFF    .      .   NVIC    MKE18F16   16  . ..   4-  . NVIC_EnableIRQ(mbed_get_m0_tick_irqn()); //    .</span></span></code> </pre> <br><p>  As prioridades de tarefas do Mbed e as prioridades de interrup√ß√£o n√£o devem ser confundidas. </p><br><p>  Se a prioridade n√£o for atribu√≠da, por padr√£o, ela ser√° configurada para o m√°ximo. <br>  Dos manipuladores de interrup√ß√£o designados dessa maneira, voc√™ pode chamar qualquer servi√ßo <strong>RTOS</strong> que n√£o cause expectativas.  I.e.  transmitir sinalizadores, sem√°foros, mensagens, caixas de correio, etc.  Os servi√ßos s√£o chamados, no entanto, n√£o do pr√≥prio <strong>ISR</strong> , mas chamando interrup√ß√µes de software, definindo o bit <strong>PENDSVSET</strong> no <strong>ICSR (</strong> <em>Interrupt Control and State Register</em> ) do <em>bloco de controle</em> do <em>sistema</em> ( <strong>SCB</strong> ) do kernel <strong>Cortex-M</strong> .  I.e.  ap√≥s a conclus√£o do manipulador de interrup√ß√£o atual, se n√£o houver outras interrup√ß√µes priorit√°rias, o manipulador do sistema ser√° chamado pelo vetor <strong>PendSV</strong> onde o servi√ßo ser√° executado. </p><br><h2 id="kak-v-mbed-proishodit-rabota-s-dinamicheskoy-pamyatyu">  Como o Mbed funciona com mem√≥ria din√¢mica? </h2><br><p>  <strong>A mem√≥ria din√¢mica,</strong> ou ent√£o <strong>heap</strong> ou <strong>heap,</strong> √© um componente necess√°rio ao programar em <strong>C ++</strong> .  Em nosso projeto <strong>Mbed</strong> no <strong>IAR</strong> , o tamanho dessa √°rea de mem√≥ria √© determinado no arquivo de configura√ß√µes do vinculador <strong>MKE18F512xxx16_flash.icf</strong> , gravando na vari√°vel <strong>__size_heap__</strong> .  Definimos o tamanho para que ocupe toda a mem√≥ria livre restante.  Sabemos <strong>quanta</strong> mem√≥ria livre resta do arquivo <strong>.map</strong> ap√≥s a compila√ß√£o, ou seja,  <strong>heap de</strong> dimensionamento √© um processo iterativo. </p><br><h3 id="vyzov-staticheskih-konstruktorov-obektov-c">  Chamando construtores est√°ticos de objetos C ++ </h3><br><p>  Uma quest√£o importante ao usar <strong>C ++</strong> √© onde e como os construtores de objetos globais s√£o chamados.  Mesmo no <strong>RTOS</strong> alegando seriedade, por exemplo, <strong>MAX</strong> , isso √© ignorado, ou seja,  deixado ao acaso.  L√°, os designers est√£o envolvidos em uma biblioteca de ambiente de desenvolvimento padr√£o de thread √∫nico com o mecanismo de aloca√ß√£o de mem√≥ria comum de thread √∫nico.  Por√©m, ap√≥s o in√≠cio, o <strong>RTOS</strong> comum cria seu pr√≥prio mecanismo para gerenciar a mem√≥ria din√¢mica, e a mem√≥ria ocupada por objetos globais permanece esquecida.  Este √© um buraco nos nossos esfor√ßos para economizar mem√≥ria e controlar tudo. </p><br><p>  <strong>Mbed</strong> abordou esse assunto com muito mais seriedade.  Para cada ambiente de desenvolvimento, existe uma abordagem pr√≥pria.  No <strong>IAR,</strong> isso √© feito assim: </p><br><ul><li>  o fluxo de inicializa√ß√£o √© interceptado pelo c√≥digo do usu√°rio antes mesmo que os designers chamam </li><li>  m√©todos de bloqueio de fluxos da <strong>API do RTOS s√£o</strong> substitu√≠dos na biblioteca padr√£o </li><li>  fun√ß√µes padr√£o <strong>new</strong> , <strong>delete</strong> , <strong>malloc</strong> , <strong>free</strong> ... s√£o redirecionadas para chamadas para a <strong>API de</strong> mem√≥ria din√¢mica <strong>RTOS</strong> . </li></ul><br><p>  <strong>Mbed</strong> usa adaptadores de biblioteca <strong>IAR</strong> para opera√ß√£o multithread <br>  Voc√™ pode ler sobre a adapta√ß√£o do IAR para multithreading aqui - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://supp.iar.com/FilesPublic/UPDINFO/005691/arm/doc/infocenter/DLIBThreadSupport.html</a> <br>  <strong>O Mbed</strong> adaptou os <em>bloqueios do</em> sistema e <em>os fluxos de arquivos da</em> biblioteca <strong>IAR</strong> .  Eles s√£o implementados no arquivo <em>mbed_boot.c</em> e usam <strong>mutexes do SO</strong> . </p><br><p>  A fun√ß√£o <strong>__iar_program_start</strong> execut√°vel nas primeiras linhas do arquivo <strong>startup_MKE18F16.s</strong> inicializa a pilha do SO e a mem√≥ria din√¢mica chamando <em>mbed_set_stack_heap</em> </p><br><h2 id="naznachenie-razmerov-stekov-zadach">  Dimensionando pilhas de tarefas </h2><br><p>  Aparar pilhas de tarefas no m√≠nimo √© a op√ß√£o mais atraente para economizar <strong>RAM</strong> . <br>  Para tarefas que exigem menos pilha, diferentes t√©cnicas s√£o usadas.  Por exemplo, as fun√ß√µes da biblioteca afetam fortemente a pilha para sa√≠da e formata√ß√£o de linhas <strong>printf</strong> , <strong>sprintf</strong> , <strong>scanf</strong> etc.  Eles t√™m a capacidade de alocar grandes √°reas tempor√°rias para armazenamento de dados na pilha.  Se nos recusarmos a usar essas fun√ß√µes na tarefa, podemos reduzir a pilha de tarefas em algumas centenas de bytes. </p><br><p>  O SO Mbed na inicializa√ß√£o cria imediatamente tr√™s tarefas com nomes: <strong>"main_thread"</strong> , <strong>"timer_thread"</strong> , <strong>"idle_thread"</strong> .  O tamanho da pilha padr√£o para eles foi determinado por macros no arquivo de cabe√ßalho <strong>mbed_rtx_conf.h</strong> .  <strong>Movemos</strong> as declara√ß√µes dessas pilhas para o <strong>arquivo de</strong> configura√ß√£o <strong>mbed_config.h</strong> e reduzimos o tamanho das pilhas.  Agora as defini√ß√µes s√£o assim: </p><br><ul><li>  A pilha de tarefas <strong>"main_thread"</strong> √© definida pela macro <strong>MBED_CONF_APP_MAIN_STACK_SIZE</strong> = 1024 bytes </li><li>  A pilha de tarefas <strong>timer_thread</strong> √© definida pela macro <strong>MBED_CONF_APP_TIMER_THREAD_STACK_SIZE</strong> = 512 bytes </li><li>  A pilha de tarefas <strong>idle_thread</strong> √© definida pela macro <strong>MBED_CONF_APP_IDLE_THREAD_STACK_SIZE</strong> = 512 bytes </li></ul><br><h2 id="sredstva-kontrolya-za-ispolzovaniem-resursov-pamyati-v-mbed">  Controles de uso de mem√≥ria Mbed </h2><br><p>  A mem√≥ria din√¢mica e a pilha s√£o recursos que requerem aten√ß√£o constante.  Para ver quanta mem√≥ria din√¢mica √© usada e qual a intensidade de solicita√ß√µes, quanta pilha resta para cada tarefa e qual foi o pico de carregamento da pilha no Mbed, existem contadores especiais.  Por padr√£o, eles s√£o desabilitados pela diretiva de compila√ß√£o condicional; para habilit√°-los, voc√™ deve declarar <strong>MBED_ALL_STATS_ENABLED</strong> .  Quando a defini√ß√£o √© declarada, voc√™ precisa escrever seu pr√≥prio procedimento para exibir informa√ß√µes ao usu√°rio.  Escrevemos um procedimento especial para gerar estat√≠sticas no emulador de terminal VT100, que ser√° discutido mais adiante. </p><br><p>  Al√©m das ferramentas fornecidas pelo sistema operacional, o ambiente de desenvolvimento do IAR nas vers√µes recentes adiciona um novo <strong>can√°rio empilhado por recursos</strong> .  Leia sobre eles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Os problemas gerais de prote√ß√£o de pilha contra estouros s√£o discutidos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </p><br><h2 id="sredstva-otladki-i-analiza-koda-mbed">  Ferramentas de depura√ß√£o e an√°lise de c√≥digo Mbed </h2><br><p>  Um estudo verdadeiramente aprofundado do trabalho do <strong>Mbed</strong> na nova plataforma √© poss√≠vel apenas usando o depurador <strong>JTAG / SWD</strong> . </p><br><img width="300" align="left" src="https://habrastorage.org/webt/64/xh/my/64xhmylaiz-_eejrufyuqmo_2n8.png"><br><p>  <strong>As fontes Mbed</strong> est√£o cheias de macros multin√≠veis e instru√ß√µes de compila√ß√£o condicional.  Apenas olhando a fonte, voc√™ n√£o pode dizer quais fun√ß√µes funcionam e quais n√£o, onde o programa √© executado e onde n√£o.  A √∫nica sa√≠da √© conectar o depurador e passo a passo para analisar o caminho de execu√ß√£o do programa.  J√° na fase de portabilidade, √© quase imposs√≠vel fazer isso sem a depura√ß√£o passo a passo. </p><br><p>  Eu recomendaria <strong>as</strong> vers√µes dos depuradores <strong>Segger</strong> do <strong>J-Link Pro</strong> e <strong>J-Link Ultra</strong> .  Eles se distinguem pela alta largura de banda, v√°rias vezes maior que a dos modelos baratos comuns.  Para sistemas de depura√ß√£o com tempo real dif√≠cil, isso √© importante.  Ao rastrear eventos r√°pidos, esses depuradores s√£o menos propensos a estouros e exigem menos itera√ß√µes de depura√ß√£o.  Al√©m da depura√ß√£o passo a passo, eles podem registrar interrup√ß√µes, manter estat√≠sticas de interrup√ß√µes, incluindo suas dura√ß√µes de execu√ß√£o, suportar tecnologias de depura√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>RTT</strong></a> e <strong>ITM</strong> , capturar exce√ß√µes de hardware e outras fun√ß√µes. </p><br><p>  Abaixo est√° uma vista da janela do depurador IAR ao trabalhar com o adaptador J-Link. </p><br><p><img src="https://habrastorage.org/webt/n2/of/it/n2ofit9jpectc6sncr6c3sl1gzo.png"></p><br><p>  N√£o vale a pena economizar, 90% do tempo de desenvolvimento √© gasto na depura√ß√£o.  Embora os rastreadores Segger <strong>J-Trace</strong> mais caros n√£o ofere√ßam mais uma grande vantagem, uma vez que a s√©rie <strong>MKE18F</strong> n√£o possui uma interface de rastreamento especial. </p><br><p>  <strong>A segunda</strong> ferramenta de depura√ß√£o, √© claro, √© a E / S via <strong>UART</strong> .  O Mbed possui pelo menos quatro tecnologias diferentes para acessar um canal de dados serial via <strong>UART</strong> , </p><br><p>  Isto √©: </p><br><ul><li>  redirecionamento atrav√©s da classe <strong>DirectSerial</strong> das fun√ß√µes de E / S <strong>C / C ++</strong> padr√£o </li><li>  classe <strong>RawSerial</strong> </li><li>  <strong>s√©rie serial</strong> </li><li>  classe <strong>UARTSerial</strong> </li></ul><br><p>  Bastante uma variedade incomum.  Todos os quatro podem ser usados ‚Äã‚Äãsimultaneamente para a sa√≠da na mesma porta.  Alguns deles s√£o mais funcionais, outros s√£o menos, alguns s√£o documentados e outros n√£o.  No futuro, em nosso projeto, usaremos <strong>RawSerial</strong> , como a classe que menos <strong>consome</strong> recursos. </p><br><h2 id="skolko-my-teryaem-taymerov-portirovav-mbed">  Quantos temporizadores perdemos portando o Mbed </h2><br><p>  Para piscar o LED, <strong>foi</strong> usada a fun√ß√£o de <strong>espera</strong> da <strong>API do</strong> Mbed OS.  O √∫ltimo artigo falou sobre os problemas de port√°-lo.  Mas isso n√£o √© tudo, exceto o Mbed mant√©m um contador de seu trabalho (ele pode ser lido pela fun√ß√£o <strong>mbed_stats_cpu_get</strong> ) e existe uma <strong>API de timer</strong> .  Esses servi√ßos usam as fun√ß√µes de baixo n√≠vel do arquivo <strong>lp_ticker.c</strong> .  Neste arquivo, o timer <strong>LPTMR do</strong> kit perif√©rico <strong>Kinetis</strong> √© usado para organizar a <strong>contagem de</strong> tempo.  Durante o processo de portabilidade, esse arquivo foi editado para corresponder aos m√©todos de rel√≥gio usados ‚Äã‚Äãno microcontrolador <strong>MKE18F512VLL16</strong> . </p><br><p>  Assim, a <strong>porta Mbed</strong> captura completamente dois m√≥dulos de contador - <strong>PIT</strong> e <strong>LPTMR</strong> e o <strong>temporizador de</strong> n√∫cleo <strong>SysTick</strong> .  Isso deve ser lembrado ao planejar recursos para uma tarefa aplicada. </p><br><h2 id="osobennosti-nachalnoy-zagruzki-mke18f">  Recursos de inicializa√ß√£o do MKE18F </h2><br><p>  A fam√≠lia de <strong>chips MKE18F</strong> possui uma <strong>ROM</strong> incorporada com um gerenciador de inicializa√ß√£o atrav√©s de interfaces seriais: <strong>UART, CAN, SPI, I2C</strong> .  Mas est√° planejado usar nosso gerenciador de inicializa√ß√£o seguro em nossa placa, portanto, o trabalho de um gerenciador de inicializa√ß√£o comum √© indesej√°vel. <br>  Nesse caso, os chips <strong>Kinetis precisam</strong> prestar aten√ß√£o ao conte√∫do da <strong>√°rea</strong> do <strong>Program Flash</strong> em <strong>0x040D</strong> .  √â armazenada uma constante que determina a ordem de inicializa√ß√£o.  No nosso caso, a constante <strong>0x7B</strong> deve ser escrita <strong>l√°</strong> , indicando o in√≠cio da mem√≥ria <strong>Flash</strong> e n√£o da <strong>ROM</strong> e desativando a fun√ß√£o <strong>NMI</strong> na sa√≠da externa.  Com um valor diferente para essa constante, o programa pode congelar no carregador de inicializa√ß√£o interno chamado acidentalmente da ROM. </p><br><p>  Tamb√©m √© importante lembrar que gravar na mem√≥ria Flash do controlador √© poss√≠vel apenas a uma frequ√™ncia central de <strong>120 MHz</strong> e n√£o superior, ou seja,  No modo <strong>HRUN</strong> , a grava√ß√£o em <strong>Flash</strong> n√£o √© poss√≠vel. </p><br><h2 id="aktiviziruem-watchdog">  Ativar Watchdog </h2><br><p>  A placa do nosso controlador √© projetada para uso industrial, o que significa que voc√™ n√£o pode ficar sem o <strong>Watchdog</strong> . </p><br><p>  Inicialmente, a macro <strong>DISABLE_WDOG</strong> no arquivo <strong>system_MKE18F16.h</strong> foi definida para desativar o <strong>watchdog</strong> .  Para corrigir a situa√ß√£o, essa macro foi apagada e sua pr√≥pria inicializa√ß√£o do <strong>WDOG foi</strong> implementada. </p><br><p>  A inicializa√ß√£o do <strong>Watchdog √©</strong> feita na fun√ß√£o <strong>SystemInit</strong> .  O contador de <strong>watchdog</strong> √© atualizado na tarefa <strong>IDLE</strong> . </p><br><p>  Essa abordagem exige que tarefas de prioridade mais alta n√£o capturem exclusivamente o processador por mais de <strong>100 ms</strong> .  Mas isso pode acontecer facilmente, por exemplo, ao enviar grandes despejos de dados para o terminal.  Portanto, em todos os lugares, quebramos procedimentos demorados em tarefas com prioridade maior que <strong>IDLE</strong> em pequenos fragmentos intercalados com pausas usando a fun√ß√£o de <strong>espera</strong> . </p><br><h2 id="vopros-drayverov-iz-postavki-sdk">  Problema de drivers na entrega do SDK </h2><br><p>  <strong>Os</strong> drivers <strong>SDK</strong> s√£o prefixados com <strong>fsl</strong> localizado no diret√≥rio <strong>NXP_MKE18F_drivers</strong> e s√£o um tipo de camada de abstra√ß√£o perif√©rica.  Eles devem facilitar a programa√ß√£o de perif√©ricos dif√≠ceis de aprender, mas infelizmente s√£o minimamente documentados.  Em vez disso, sua documenta√ß√£o √© limitada a coment√°rios nos cabe√ßalhos das fun√ß√µes.  H√° perplexidade para quem eles s√£o escritos e como eles podem nos libertar do estudo de manuais na periferia do microcontrolador.  Minha resposta n√£o √© poss√≠vel.  Os drivers facilitam a transfer√™ncia de programas para diferentes microcontroladores dentro da mesma fam√≠lia.  Mas, para aplic√°-los efetivamente, voc√™ precisa lidar muito bem com a documenta√ß√£o perif√©rica.  Assim, os drivers do <strong>SDK</strong> resolvem um problema bastante particular dos desenvolvedores dos pr√≥prios drivers, longe das necessidades dos usu√°rios que est√£o come√ßando a aprender o <strong>Kinetis</strong> . </p><br><p>  Os drivers tamb√©m s√£o projetados para funcionar com todos os chips da fam√≠lia, ou seja,  seja universal e, portanto, saturado com macros condicionais e verifique se, para cada chip em particular, n√£o possui nenhuma fun√ß√£o √∫til. </p><br><p>  Os drivers ainda podem ajudar de alguma maneira a entender melhor como lidar com perif√©ricos, mas depois de entender o driver, voc√™ pode ignor√°-lo com seguran√ßa. <br>  Nesse sentido, n√£o deve surpreender que, neste projeto, o acesso aos perif√©ricos n√£o afetados pela porta Mbed passe diretamente pelo driver. </p><br><p>  No entanto, pode haver preocupa√ß√µes sobre as depend√™ncias de um perif√©rico espec√≠fico na disponibilidade de drivers SDK.  Aqui voc√™ tem que examinar o c√≥digo fonte dos drivers.  O principal perigo das depend√™ncias vem da separa√ß√£o de fun√ß√µes dos drivers <strong>DMA</strong> .  Para evitar isso, voc√™ precisa rastrear e proibir os servi√ßos Mbed regulares de usar o <strong>DMA</strong> ao trabalhar com perif√©ricos.  Se o <strong>DMA</strong> permanecer intocado pelos drivers do <strong>SDK</strong> , quase tudo o que n√£o se aplica aos 2 m√≥dulos de timer mencionados ( <strong>PIT</strong> e <strong>LPTMR</strong> ) e o UART de depura√ß√£o podem ser descartados ou ignorados no diret√≥rio <strong>NXP_MKE18F_drivers</strong> . </p><br><p>  Um perigo menor, mas tamb√©m significativo, pode advir da prioriza√ß√£o dos perif√©ricos envolvidos pelos drivers do SDK.  Por exemplo, voc√™ precisa saber qual prioridade √© atribu√≠da √†s interrup√ß√µes do SysTick, depurar UARTs e temporizadores.  Em uma situa√ß√£o em que sua prioridade √© igual ou superior √† prioridade da periferia usada no gerenciamento em tempo real, isso pode levar √† degrada√ß√£o da qualidade do gerenciamento. </p><br><p>  Lembre-se de que a porta <strong>Mbed</strong> do <strong>MKE18F</strong> inicia o UART e o timer √© interrompido sem prioriza√ß√£o, ou seja,  eles obt√™m o n√≠vel m√°ximo por padr√£o. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt422413/">https://habr.com/ru/post/pt422413/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt422401/index.html">Outra estrutura de plug-in C ++</a></li>
<li><a href="../pt422403/index.html">20 de setembro de Moscou - uma reuni√£o para analistas</a></li>
<li><a href="../pt422407/index.html">Localizar e classificar textos relacionados</a></li>
<li><a href="../pt422409/index.html">Python: metaprograma√ß√£o em produ√ß√£o. Parte um</a></li>
<li><a href="../pt422411/index.html">Novos pap√©is nas empresas na era da servitiza√ß√£o</a></li>
<li><a href="../pt422415/index.html">Python: metaprograma√ß√£o em produ√ß√£o. Parte dois</a></li>
<li><a href="../pt422417/index.html">Slavik e GMT + 3 ou benef√≠cio para pessoas</a></li>
<li><a href="../pt422419/index.html">N√£o sem p√¢nico no Go</a></li>
<li><a href="../pt422421/index.html">Microsoft vai melhorar radicalmente o Skype</a></li>
<li><a href="../pt422423/index.html">Python e DataScience: Explorando o poder da biblioteca universal Numpy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>