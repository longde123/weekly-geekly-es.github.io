<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìª ü§öüèø üßôüèæ Le√ßon ouverte "Ing√©nierie des fonctionnalit√©s sur l'exemple du jeu de donn√©es Titanic classique" üçÄ ü•£ üíáüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour encore! 

 En d√©cembre, nous commencerons la formation du prochain groupe Data Scientist , il y aura donc de plus en plus de le√ßons ouvertes e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le√ßon ouverte "Ing√©nierie des fonctionnalit√©s sur l'exemple du jeu de donn√©es Titanic classique"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/433084/">  Bonjour encore! <br><br>  En d√©cembre, nous commencerons la formation du prochain <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">groupe Data Scientist</a> , il y aura donc de plus en plus de le√ßons ouvertes et d'autres activit√©s.  Par exemple, l'autre jour, un webinaire s'est tenu sous le nom long de ¬´Feature Engineering sur l'exemple du jeu de donn√©es Titanic classique¬ª.  Il a √©t√© men√© par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alexander Sizov</a> , un d√©veloppeur exp√©riment√©, Ph.D., un expert en Machine / Deep learning, et un participant √† divers projets commerciaux internationaux li√©s √† l'intelligence artificielle et l'analyse des donn√©es. <br><br>  Une le√ßon ouverte a dur√© environ une heure et demie.  Au cours du webinaire, l'enseignant a parl√© de la s√©lection des fonctionnalit√©s, de la transformation des donn√©es source (codage, mise √† l'√©chelle), de la d√©finition des param√®tres, de la formation du mod√®le et bien plus encore.  Pendant la le√ßon, on a montr√© aux participants un cahier Jupyter.  Pour le travail, nous avons utilis√© des donn√©es ouvertes de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plate-</a> forme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kaggle</a> (un ensemble de donn√©es classique sur le Titanic, dont beaucoup commencent √† se familiariser avec la science des donn√©es).  Ci-dessous, nous proposons une vid√©o et une transcription de l'√©v√©nement pass√©, et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> vous pouvez r√©cup√©rer la pr√©sentation et les codes dans un ordinateur portable Jupiter. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tOAAwpK2O80" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  <b>S√©lection des fonctionnalit√©s</b> <b><br></b> <br>  Le th√®me a √©t√© choisi, bien que classique, mais toujours un peu sombre.  En particulier, il √©tait n√©cessaire de r√©soudre le probl√®me de classification binaire et de pr√©dire √† partir des donn√©es disponibles si le passager survivra ou non.  Les donn√©es elles-m√™mes ont √©t√© divis√©es en deux √©chantillons de formation et de test.  La variable cl√© est Survie (surv√©cu / non surv√©cu; 0 = non, 1 = oui). <br><br>  Entrer les donn√©es d'entra√Ænement: <br><br><ol><li>  classe de billets </li><li>  l'√¢ge et le sexe du passager; </li><li>  √©tat matrimonial (s'il y a des parents √† bord); </li><li>  prix du billet; </li><li>  num√©ro de cabine; </li><li>  port d'embarquement. </li></ol><br>  Comme vous pouvez le voir, les types de variables sont diff√©rents: num√©rique, texte.  √Ä partir de ce kal√©idoscope, il √©tait n√©cessaire de former un ensemble de donn√©es pour la prochaine formation de mod√®le. <br><br>  Nous r√©sumons: <br><br><ul><li>  train.csv - ensemble de formation - ensemble de donn√©es de formation.  La r√©ponse est connue en eux - survie - un signe binaire 0 (n'a pas surv√©cu) / 1 (a surv√©cu); </li><li>  test.csv - test set - test data set.  La r√©ponse est inconnue.  Il s'agit d'un exemple √† envoyer √† la plateforme kaggle pour calculer la m√©trique de qualit√© du mod√®le; </li><li>  gender_submission.csv est un exemple du format des donn√©es √† envoyer √† kaggle. </li></ul><br>  Algorithme de travail <br><br><ol><li>  Le travail s'est d√©roul√© par √©tapes: </li><li>  Analyse des donn√©es de train.csv. </li><li>  Gestion des valeurs manquantes. </li><li>  Mise √† l'√©chelle. </li><li>  Codage des caract√©ristiques cat√©gorielles. </li><li>  Construire un mod√®le et s√©lectionner des param√®tres, choisir le meilleur mod√®le sur les donn√©es converties de train.csv. </li><li>  Fixation et mod√®le de la m√©thode de transformation. </li><li> Application des m√™mes conversions √† test.csv √† l'aide d'un pipeline. </li><li>  Application du mod√®le sur test.csv. </li><li>  Enregistrement du fichier de r√©sultats de l'application dans le m√™me format que dans gender_submission.csv. </li><li>  Envoi des r√©sultats √† la plateforme kaggle. </li></ol><br>  <b>La partie pratique du webinaire</b> <br><br>  La premi√®re chose √† faire √©tait de lire l'ensemble de donn√©es et d'afficher nos donn√©es √† l'√©cran: <br><br><img src="https://habrastorage.org/webt/eu/7p/vm/eu7pvmx66rypokyjafuw8kmyn3k.png"><br><br>  Pour l'analyse des donn√©es, une biblioth√®que de profilage peu connue mais plut√¥t utile a √©t√© utilis√©e: <br> <code>pandas_profiling.ProfileReport(df_train)</code> <br> <br>  <b>En savoir plus sur le profilage</b> <br><br>  Cette biblioth√®que fait tout ce qui peut √™tre fait a priori sans conna√Ætre les d√©tails des donn√©es.  Par exemple, affichez des statistiques sur les donn√©es (combien de variables et de quel type elles sont, combien de lignes, valeurs manquantes, etc.).  De plus, des statistiques distinctes pour chaque variable sont fournies avec un minimum et un maximum, un graphique de distribution et d'autres param√®tres. <br><br>  Comme vous le savez, pour faire un bon mod√®le, vous devez vous plonger dans le processus que nous essayons de simuler et comprendre quels sont les attributs cl√©s.  De plus, loin de toujours dans nos donn√©es, il y a tout ce qui est n√©cessaire, et, plus pr√©cis√©ment, presque jamais en elles, il n'y a tout ce qui est n√©cessaire, d√©terminant et d√©terminant compl√®tement notre processus.  En r√®gle g√©n√©rale, nous devons toujours combiner quelque chose, peut-√™tre ajouter des entit√©s suppl√©mentaires qui ne sont pas repr√©sent√©es dans l'ensemble de donn√©es (par exemple, les pr√©visions m√©t√©orologiques).  C'est pour comprendre le processus que nous avons besoin d'une analyse des donn√©es, ce qui peut √™tre fait en utilisant la biblioth√®que de profilage. <br><br>  <b>Valeurs manquantes</b> <br><br>  L'√©tape suivante consiste √† r√©soudre le probl√®me des valeurs manquantes, car dans la plupart des cas, les donn√©es ne sont pas compl√®tement remplies. <br>  Les solutions suivantes sont disponibles pour ce probl√®me: <br><br><ul><li>  supprimer des lignes avec des valeurs manquantes (gardez √† l'esprit que vous pouvez perdre certaines valeurs importantes); </li><li>  supprimer un signe (pertinent s'il y a trop peu de donn√©es dessus); </li><li>  remplacer les valeurs manquantes par autre chose (m√©diane, moyenne ...). </li></ul><br>  Un exemple de conversion simple utilisant la m√©thode fillna, qui affecte les valeurs de la variable m√©diane uniquement aux cellules qui ne sont pas remplies: <br><br><img src="https://habrastorage.org/webt/sj/ir/yl/sjirylzgnphmwoba3e2jnnicflc.png"><br><br>  De plus, l'enseignant a montr√© des exemples d'utilisation d'Imputer et de pipeline. <br><br>  <b>Mise √† l'√©chelle des fonctionnalit√©s</b> <br><br>  Le fonctionnement du mod√®le et la d√©cision finale d√©pendent de l'√©chelle des caract√©ristiques.  Le fait est que ce n'est pas un fait qu'une entit√© √† plus grande √©chelle est plus importante qu'une entit√© √† plus petite √©chelle.  C'est pourquoi le mod√®le doit soumettre des fonctionnalit√©s dont l'√©chelle est identique, c'est-√†-dire ayant le m√™me poids pour le mod√®le. <br><br>  Il existe diff√©rentes techniques de mise √† l'√©chelle, cependant, le format de la le√ßon ouverte ne permet d'en consid√©rer que deux plus en d√©tail: <br><br><img src="https://habrastorage.org/webt/jj/jm/h_/jjjmh_mkrlg5n73lo9l5nabgl7q.png"><br><br>  <b>Combinaisons de fonctionnalit√©s</b> <br><br>  Les combinaisons de fonctionnalit√©s existantes √† l'aide d'op√©rations arithm√©tiques (somme, multiplication, division) vous permettent d'obtenir toute fonctionnalit√© qui rend le mod√®le plus efficace.  Ce n'est pas toujours r√©ussi, et nous ne savons pas quelle combinaison donnera l'effet souhait√©, mais la pratique montre qu'il est logique d'essayer.  Il est pratique d'appliquer des transformations d'entit√©s √† l'aide du pipeline. <br><br>  <b>Codage</b> <br><br>  Nous avons donc des donn√©es de diff√©rents types: num√©rique et texte.  Actuellement, la plupart des mod√®les sur le march√© ne peuvent pas fonctionner avec des donn√©es texte.  Par cons√©quent, tous les signes cat√©goriels (textuels) doivent √™tre convertis en une repr√©sentation num√©rique, pour laquelle un codage est utilis√©. <br><br>  <b>Encodage d'√©tiquette</b> .  Il s'agit d'un m√©canisme impl√©ment√© dans le cadre de nombreuses biblioth√®ques pouvant √™tre appel√© et appliqu√©: <br><br><img src="https://habrastorage.org/webt/tf/xd/kh/tfxdkh3eypfrqjuihl4w_60vfzq.png"><br><br>  Le codage d'√©tiquette attribue un identifiant unique √† chaque valeur unique.  Moins - nous introduisons l'ordre dans une certaine variable qui n'a pas √©t√© ordonn√©e, ce qui n'est pas bon. <br><br>  <b>OneHotEncoder.</b>  Les valeurs uniques de la variable de texte sont d√©velopp√©es sous la forme de colonnes qui sont ajout√©es aux donn√©es source, o√π chaque colonne est une variable binaire sous la forme de 0 et 1. Cette approche est exempte de d√©fauts de codage d'√©tiquette, mais a son inconv√©nient: s'il existe de nombreuses valeurs uniques, nous ajoutons trop de colonnes et dans certains cas, la m√©thode n'est tout simplement pas applicable (l'ensemble de donn√©es se d√©veloppe trop). <br><br>  <b>Formation mod√®le</b> <br><br>  Apr√®s avoir effectu√© les √©tapes ci-dessus, un pipeline final est compil√© avec un ensemble de toutes les op√©rations n√©cessaires.  Il suffit maintenant de prendre l'ensemble de donn√©es source et d'appliquer le pipeline r√©sultant √† ces donn√©es √† l'aide de l'op√©ration fit_transform: <br> <code>x_train = vec.fit_transform(df_train)</code> <br> <br>  Par cons√©quent, nous obtenons l'ensemble de donn√©es x_train, qui est pr√™t √† √™tre utilis√© dans le mod√®le.  La seule chose √† faire est de s√©parer la valeur de notre variable cible pour que nous puissions conduire la formation. <br><br>  S√©lectionnez ensuite le mod√®le.  Dans le cadre du webinaire, l'enseignant a propos√© une r√©gression logistique simple.  Le mod√®le a √©t√© form√© en utilisant l'op√©ration d'ajustement, r√©sultant en un mod√®le sous forme de r√©gression logistique avec certains param√®tres: <br><br><img src="https://habrastorage.org/webt/xs/tc/dc/xstcdche3jydmlahruszn6txahi.png"><br><br>  Cependant, en pratique, plusieurs mod√®les sont g√©n√©ralement utilis√©s et semblent √™tre les plus efficaces.  Et la solution finale est souvent une combinaison de ces mod√®les en utilisant des techniques d'empilement et d'autres approches de mod√®les d'ensemble (en utilisant plusieurs mod√®les au sein du m√™me mod√®le hybride). <br><br>  Apr√®s la formation, le mod√®le peut √™tre appliqu√© sur des donn√©es de test, √©valuant sa qualit√© dans le cadre d'une m√©trique.  Dans notre cas, la qualit√© dans l'exactitude_score √©tait de 0,8: <br><br><img src="https://habrastorage.org/webt/ka/ut/dj/kautdjopfjqa1dbgkii10wptcfs.png"><br><br>  Cela signifie que sur les donn√©es obtenues, la variable est correctement pr√©dite dans 80% des cas.  Apr√®s avoir re√ßu les r√©sultats de la formation, nous pouvons soit am√©liorer le mod√®le (si la pr√©cision n'est pas satisfaisante), soit proc√©der directement aux pr√©visions. <br><br>  C'√©tait le sujet principal de la le√ßon, mais l'enseignant a parl√© plus en d√©tail des caract√©ristiques du mod√®le dans diff√©rentes t√¢ches et a r√©pondu aux questions du public.  Donc, si vous ne voulez rien manquer, regardez le webinaire complet si vous √™tes int√©ress√© par ce sujet. <br><br>  Comme toujours, nous attendons vos commentaires et questions que vous pouvez laisser ici ou les poser √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alexandre</a> en allant le voir lors d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">journ√©e portes ouvertes.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433084/">https://habr.com/ru/post/fr433084/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433072/index.html">Comment pirater la protection contre la copie de la console Sega Dreamcast</a></li>
<li><a href="../fr433074/index.html">Passer √† Kotlin dans un projet Android: trucs et astuces</a></li>
<li><a href="../fr433076/index.html">Comment nous avons cr√©√© notre biblioth√®que Android Gallery pour afficher le contenu multim√©dia</a></li>
<li><a href="../fr433078/index.html">Nous √©crivons des robots de trading en utilisant le cadre graphique StockSharp. 2e partie</a></li>
<li><a href="../fr433082/index.html">Pomper les comptes d'autrui est devenu une infraction p√©nale en Cor√©e du Sud</a></li>
<li><a href="../fr433086/index.html">Tinkoff et tout, tout, tout: IoT, analyse et surveillance pour les banques</a></li>
<li><a href="../fr433088/index.html">Comment aimez-vous cela, Elon Musk: BMW et Porsche ont d√©velopp√© une recharge qui ajoute 100 km de voyage en 3 minutes</a></li>
<li><a href="../fr433090/index.html">Techniques d'indexation bitmap Oracle</a></li>
<li><a href="../fr433092/index.html">Mod√©lisation CG de niveau 80: personnages photor√©alistes r√©alistes dans Unreal</a></li>
<li><a href="../fr433094/index.html">Mod√©lisation num√©rique dans une grande entreprise industrielle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>