<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🚒 🧀 👨🏽‍⚖️ Windows 10 IoT Enterprise - Secrets de configuration pour les scripts intégrés 🐤 🌛 🤹🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Préface 
 Vous devez avoir vu des distributeurs automatiques de billets, des kiosques d'information, des panneaux publicitaires qui affichent une erre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Windows 10 IoT Enterprise - Secrets de configuration pour les scripts intégrés</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/quarta/blog/413359/"><h2>  Préface </h2><br>  Vous devez avoir vu des distributeurs automatiques de billets, des kiosques d'information, des panneaux publicitaires qui affichent une erreur ou une notification système.  Si vous n'avez pas vu de tels appareils publics «vivants», vous pouvez facilement trouver des photos similaires sur Internet si vous recherchez des images selon les mots «erreur de fenêtres ATM».  Et une fois que la notification du système est apparue en direct pendant les prévisions météorologiques, la photo peut être trouvée par les mots "Windows Live Notification".  Pour votre intérêt, vous pouvez toujours rechercher «le plus grand écran bleu». <br><br><h2>  Qu'est-ce que tout cela signifie? </h2><br>  - Aimez-vous les chats? <br>  - non <br>  - Vous ne savez tout simplement pas comment les cuisiner! <br><br>  Pour les appareils spécialisés, Microsoft suggère d'utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Windows 10 <b>IoT</b> Enterprise</a> , qui ne diffère de Windows 10 Enterprise qu'en l'absence d'applications universelles.  En conséquence, d'un point de vue technique, Win 10 IoT Enterprise est un système d'exploitation de bureau qui implique une interaction utilisateur.  Mais sur les appareils spécialisés, l'interaction utilisateur ne devrait pas être  parfois il n'y a même pas d'utilisateur au sens habituel du terme, notamment pour les panneaux publicitaires. <br><a name="habracut"></a><br>  Lors de la préparation d'un appareil spécialisé, certains experts techniques oublient la nuance ci-dessus ou oublient de désactiver toute catégorie de notifications.  Cet article est écrit pour vous rappeler certaines fonctionnalités de l'installation de Windows pour des solutions spécialisées.  Dans cet article, nous examinerons la préparation de solutions pour une tâche métier. <br><br>  Tous les paramètres seront décrits pour Win 10 IoT Enterprise 2016 LTSB, dont une version de démonstration peut être téléchargée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h2>  Quelle tâche commerciale résolvez-vous? </h2><br>  Une fois arrivé au point de retrait d'une boutique en ligne.  Dans ce magasin, les vendeurs n'ont émis que des marchandises ou leur ont donné un aperçu, et la commande devait être passée uniquement sur le site Web du magasin.  Pour pouvoir passer une commande directement au point de retrait, de nombreux PC ont été installés dans la salle de retrait.  Les PC eux-mêmes étaient cachés, il n'y avait qu'un moniteur et une souris, une base de magasin spécialisée a été ouverte sur l'écran, dans laquelle il était possible de trouver des marchandises et de passer une commande et un clavier à l'écran. <br><br>  Envisagez de préparer une solution similaire qui sera conçue pour naviguer sur le site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.quarta-embedded.ru</a> .  Conditions d'utilisation estimées - sans alimentation sans coupure et avec un minimum d'entretien. <br><br><h2>  Préparation de la solution </h2><br><h3>  Étape 1 - Préparer l'appareil </h3><br>  Comme l'appareil a été pris un PC ordinaire, avec un disque dur de 120 Go, RAM 4 Go.  Mode de démarrage du système d'exploitation - hérité. <br><br>  Parce que  notre appareil sera utilisé sans alimentation sans coupure, il est impératif de prévoir une coupure de courant imprévue.  C'est-à-dire  l'appareil doit s'allumer dès qu'une alimentation apparaît, pour cela vous devez configurer le BIOS de l'appareil en conséquence.  Les éléments nécessaires dans le BIOS peuvent être trouvés par les noms intuitifs, je l'ai "Avancé&gt; Options de mise sous tension&gt; Après une coupure de courant", réglez-le sur "On".  Mais si vous souhaitez que l'appareil reste éteint lorsqu'il est allumé lorsqu'il a été intentionnellement éteint, réglez-le sur «État précédent». <br><br><h3>  Étape 2 - Installez Win 10 IoT </h3><br>  L'installation de Win 10 IoT Enterprise n'est pas différente de l'installation de Win 10 Enterprise, donc je ne vois pas beaucoup d'intérêt à décrire l'installation.  J'installerai «Win 10 IoT Enterprise 2016 LTSB x32» sans connexion Internet pour que rien de plus «n'arrive» dans le système.  Au premier démarrage, j'ai créé l'utilisateur admin. <br><br><h3>  Étape 3 - enregistrer l'image système </h3><br>  Quoi, ne t'attendais pas à un tel virage?  Je viens d'installer le système et de sauvegarder immédiatement l'image.  Lors de la préparation d'une solution, il est conseillé de sauvegarder périodiquement l'image système au cas où quelque chose se passerait soudainement.  Ensuite, vous n'aurez pas besoin de faire la configuration du système en premier. <br><br>  Lorsque nous parlons de créer une image, nous abordons la question de la réplication, mais elle est si large qu'un article séparé et plus d'un peuvent lui être consacrés, donc dans cet article, je ne décrirai pas ce problème en détail. <br><br>  Pour créer une image technologique (intermédiaire), je scellerai le système avec la commande <br><br><pre><code class="hljs perl">%SYSTEMROOT%\System32\Sysprep\sysprep.exe /audit /generalize /<span class="hljs-keyword"><span class="hljs-keyword">shutdown</span></span> /quiet</code> </pre> <br>  et créez une image wim du volume système à l'aide de l'utilitaire DISM. <br><br>  Important - si vous procédez de la même façon, après avoir déployé une telle image, n'oubliez pas de copier le contenu du répertoire "Windows \ System32 \ Recovery" sur le premier volume du dossier "Recovery \ WindowsRE".  Et vous devez le faire avant de charger le système d'exploitation.  après le chargement de l'OS, le répertoire "Windows \ System32 \ Recovery" sera déjà vide.  Je l'ai implémenté comme suit: <br><br><pre> <code class="hljs tex">if exist W:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* ( xcopy W:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsRE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>/h /k /y attrib +s +h +i S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span> attrib +s +h +i S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* /s /d )</code> </pre><br>  Veuillez noter qu'après le scellage, le système se connectera automatiquement au compte administrateur intégré.  Et maintenant, sysprep démarre automatiquement.  Pour éviter que cette fenêtre ne me dérange, j'ai ajouté un script shell avec une seule commande au shell: startup <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">taskkill</span></span> /im sysprep.exe</code> </pre> <br>  Afin de ne pas oublier de supprimer le script, je vais immédiatement créer un script de scellage, dans lequel la commande de nettoyage de l'exécution automatique sera écrite. <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">del</span></span> "<span class="hljs-variable"><span class="hljs-variable">%systemdrive%</span></span>\Users\Administrator\AppData\Roaming\Microsoft\Windows\<span class="hljs-built_in"><span class="hljs-built_in">Start</span></span> Menu\Programs\Startup\*.*" /q</code> </pre><br>  Après tout, j'ai encore besoin de sceller le système en mode oobe. <br>  Tous les fichiers technologiques que je placerai dans le dossier C: \ Sysprep <br><br><h3>  Étape 4 - Installation du pilote </h3><br>  Curieusement, mais certains se plaignent qu'après l'installation de Win 10 «les pilotes ne se sont pas installés eux-mêmes».  Je m'empresse de vous déranger, rien ne se passe tout seul, les pilotes doivent être installés.  Le système est livré avec un certain ensemble de pilotes standard, mais il est peu probable qu'avec l'ensemble standard de pilotes, il soit possible d'utiliser toutes les capacités de l'équipement.  Il est préférable d'installer vous-même les pilotes les mieux adaptés à votre appareil.  Windows peut télécharger automatiquement les pilotes à partir d'un référentiel Microsoft spécial et les installer, mais il n'est pas nécessaire que tous les pilotes nécessaires soient là ou qu'ils soient des pilotes appropriés.  Le pilote que le système installe automatiquement peut provoquer une panne du système.  Que faire si vous vous trouvez dans une situation où vous devez empêcher une telle installation automatique du pilote?  Il y a 2 options: <br><br>  1. Désactiver le service de mise à jour <br>  net stop wuauserv - commande d'arrêt de service <br>  sc config wuauserv start = disabled - changez le mode de démarrage du service en "Disabled" <br>  Mais dans ce cas, le système ne recevra aucune mise à jour <br><br>  2. Désactivez l'installation d'un pilote spécifique dans les stratégies de groupe <br><br>  Pour ce faire, vous avez besoin de: <br><br>  Ouvrez l'éditeur de stratégie de groupe avec gpedit <br><br>  Accédez à la section "Configuration ordinateur \ Modèles d'administration \ Système \ Installation des périphériques \ Restriction sur l'installation des périphériques".  Version anglaise de la branche "Configuration ordinateur \ Modèles d'administration \ Système \ Installation de l'appareil \ Restrictions d'installation de l'appareil" <br>  Dans cette section, vous pouvez interdire l'installation d'un pilote pour une classe ou un ID d'équipement spécifique.  Pour empêcher l'installation d'autres pilotes, vous n'avez PAS besoin de cocher la case «Appliquer également aux périphériques correspondants déjà installés», sinon vous ne pourrez pas utiliser le périphérique. <br><br>  Parce que  J'ai une solution expérimentale et les pilotes n'ont pas vraiment d'importance, je n'installerai pas volontairement les pilotes.  Une fois connecté à Internet, le système a trouvé un pilote pour certains périphériques. <br><br><h3>  Étape 5 - Russification du système </h3><br>  Je pense que cette action est très simple et n'a pas besoin d'être décrite en détail.  Je dirai que pour l'affichage correct de l'alphabet cyrillique, j'ai spécifié la langue russe pour les programmes qui ne prennent pas en charge Unicode.  Il a indiqué l'emplacement, bien que dans mon cas ce ne soit pas nécessaire.  Et en cours de route, vous pouvez modifier le fuseau horaire  la valeur par défaut est UTC -8.  J'ai installé le pack de langue russe, lorsque j'ai installé le pack de langue via Internet, il m'a semblé long, donc je l'ai installé en utilisant le package précédemment téléchargé "Microsoft-Windows-Client-Language-Pack_x86_ru-ru.cab", installé avec la commande <br><br><pre> <code class="hljs perl">DISM /Online /Add-Package /PackagePath:<span class="hljs-string"><span class="hljs-string">"%~dp0Microsoft-Windows-Client-Language-Pack_x%PROCESSOR_ARCHITECTURE:~-2%_ru-ru.cab"</span></span></code> </pre><br>  Après l'installation, j'ai changé la langue principale du système en russe et activé l'option de copier les paramètres de langue pour l'écran d'accueil et les nouveaux comptes. <br>  C'est tout, la langue russe a été ajoutée, vous pouvez peut-être enregistrer l'image du système ... <br><br><h3>  Étape 6 - Paramètres d'alimentation </h3><br>  Notre appareil ne doit pas s'endormir et éteindre le moniteur, vous devez donc configurer l'alimentation en conséquence.  La puissance peut être configurée à l'aide du script: <br><br><pre> <code class="hljs powershell">powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-monitor</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-monitor</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-disk</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-disk</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-standby</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-standby</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-hibernate</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-hibernate</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> pause</code> </pre><br><h3>  Étape 7 - Désactiver le mode de démarrage d'urgence </h3><br>  Le point important est que si notre appareil a un arrêt incorrect 2-3 fois de suite, le système démarrera en mode de récupération, et cela ne devrait pas être autorisé.  Par conséquent, désactivez ce mode de démarrage.  Cela peut être fait en utilisant la commande <br><br><pre> <code class="hljs pgsql">bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>} bootstatuspolicy IgnoreAllFailures</code> </pre><br>  Veuillez noter que ce paramètre est enregistré dans le référentiel bcd, qui se trouve sur la partition de récupération.  Je n'enregistre pas la section de récupération lors de l'enregistrement de l'image système.Par conséquent, une fois le système déployé, ce paramètre sera dans son état d'origine car  il y aura un nouveau stockage bcd.  Afin de ne pas oublier ce paramètre, je vais l'ajouter au script de scellage en mode oobe. <br><br><h3>  Étape 8 - Désactivation des messages d'erreur et des notifications contextuelles </h3><br>  Pour que le système n'affiche pas de messages d'erreur, une demande d'envoi de rapports d'erreur, des messages sur des problèmes avec l'équipement, tout cela doit être désactivé.  Le service de stratégie de diagnostic peut être configuré dans des stratégies de groupe: <br><br>  Configuration ordinateur \ Modèles d'administration \ Système \ Diagnostics <br>  Diagnostics: définition du niveau d'exécution du script - Activez «Détection et diagnostics uniquement» <br><br>  Mais il m'est plus facile de tout configurer avec un seul fichier reg. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;    [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SYSTEM</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentControlSet</span></span>\<span class="hljs-type"><span class="hljs-type">Control</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>] ;<span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;   ;<span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;     . ,     <span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ;    . ,   dll ;     [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Error</span></span> <span class="hljs-type"><span class="hljs-type">Reporting</span></span>] ;<span class="hljs-string"><span class="hljs-string">"Disabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;   <span class="hljs-string"><span class="hljs-string">"Disabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;   ;       [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">WDI</span></span>] ;<span class="hljs-string"><span class="hljs-string">"ScenarioExecutionEnabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;      <span class="hljs-string"><span class="hljs-string">"ScenarioExecutionEnabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;      <span class="hljs-string"><span class="hljs-string">"EnabledScenarioExecutionLevel"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;    ;<span class="hljs-string"><span class="hljs-string">"EnabledScenarioExecutionLevel"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ;,    </code> </pre><br>  Les notifications contextuelles peuvent être configurées dans les stratégies de groupe "Configuration utilisateur \ Modèles d'administration \ Menu Démarrer et barre des tâches \ Notifications".  Mais il m'est plus facile d'activer le mode Ne pas déranger, il peut être activé dans l'interface graphique, dans le centre de notification et dans le registre.  Parce que  Ce paramètre s'applique à un utilisateur spécifique, vous devez ensuite l'exécuter sous l'utilisateur cible.  Par conséquent, nous créons un utilisateur sous lequel l'application à usage public sera exécutée.  Alors que cet utilisateur sera dans le groupe des administrateurs, pour faciliter la configuration.  Pour qu'il n'y ait aucun problème avec le nom du groupe russe / anglais, je vais obtenir le nom du groupe par SID. <br><br><pre> <code class="hljs pgsql">net <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> wmic useraccount <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> "Name='User'" <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> PasswordExpires=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f "tokens=2 delims==" %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic group where "SID='</span></span>S<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span><span class="hljs-number"><span class="hljs-number">-32</span></span><span class="hljs-number"><span class="hljs-number">-544</span></span><span class="hljs-string"><span class="hljs-string">'" get Name /value^|find "Name"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> GroupName=%%i net localgroup %GroupName% <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> pause</code> </pre><br>  Et activez le mode Ne pas déranger. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;  <span class="hljs-string"><span class="hljs-string">" "</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Notifications</span></span>\<span class="hljs-type"><span class="hljs-type">Settings</span></span>] <span class="hljs-string"><span class="hljs-string">"NOC_GLOBAL_SETTING_TOASTS_ENABLED"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"NOC_GLOBAL_SETTING_TOASTS_ENABLED"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; </code> </pre><br>  Afin de ne pas oublier d'exclure l'utilisateur du groupe des administrateurs, j'ajouterai la commande d'exclusion au script de scellage. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=2 delims=="</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ('wmic group <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-string"><span class="hljs-string">"SID='S-1-5-32-544'"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span> /value^|<span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-string"><span class="hljs-string">"Name"</span></span>') <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-type"><span class="hljs-type">GroupName</span></span>=%%i net localgroup %<span class="hljs-type"><span class="hljs-type">GroupName</span></span>% <span class="hljs-type"><span class="hljs-type">User</span></span> /delete</code> </pre><br><h3>  Étape 9 - Configurer les mises à jour du système </h3><br>  Cela ne fait pas de mal d'installer toutes les dernières mises à jour au moment de la préparation du système.  Vous pouvez configurer des mises à jour en fonction des spécificités de votre appareil.  Vous pouvez désactiver l'installation de toutes les mises à jour ou mises à jour du pilote, comme nous l'avons vu à l'étape 4. Ou vous pouvez désactiver l'installation des mises à jour système et quitter la mise à jour du pilote. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;  .      [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">WindowsUpdate</span></span>\<span class="hljs-type"><span class="hljs-type">AU</span></span>] <span class="hljs-string"><span class="hljs-string">"NoAutoUpdate"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"NoAutoUpdate"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ; </code> </pre><br>  Mais il est également possible que vous ayez besoin d'installer des mises à jour du système, mais certaines mises à jour spécifiques désactiveront le système.  Dans cette situation, vous pouvez empêcher l'installation d'une mise à jour spécifique.  Cela peut être fait en utilisant l'utilitaire wushowhide.diagcab, qui peut être trouvé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Dans les stratégies de groupe, vous pouvez trouver de nombreux paramètres détaillés pour l'installation des mises à jour.  "Configuration ordinateur \ Modèles d'administration \ Composants Windows \ Windows Update" <br><br>  Parce que  Je n'ai pas besoin de mises à jour, je les désactive complètement: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span> stop wuauserv sc config wuauserv <span class="hljs-built_in"><span class="hljs-built_in">start</span></span>=disabled <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span></code> </pre><br>  Ici, je vais à nouveau enregistrer l'image du système. <br><br><h3>  Étape 10 - Configurer le lancement de l'application </h3><br>  La navigation sur le site quarta-embedded.ru se fera dans IE, pour supprimer l'accès à la barre d'adresse et aux paramètres, vous pouvez activer le mode plein écran dans les stratégies de groupe.  "Configuration utilisateur&gt; Modèles d'administration&gt; Composants Windows&gt; Internet Explorer&gt; Activation du mode plein écran."  Et vous devez interdire la fermeture d'IE "Configuration utilisateur&gt; Modèles d'administration&gt; Composants Windows&gt; Internet Explorer&gt; Menu du navigateur&gt; Menu Fichier: désactiver la fermeture du navigateur et de l'Explorateur Windows". <br>  Pour lancer l'application au lieu du shell système, nous utiliserons un outil spécial de lancement d'application - ShellLauncher.  En l'utilisant, vous pouvez: <br><br>  1. Attribuer le lancement d'une application spécifique à un utilisateur ou un groupe d'utilisateurs spécifique <br><br>  2. Contrôlez le fonctionnement de l'application en cours d'exécution, lorsque vous fermez l'application en cours d'exécution, vous pouvez: <br><br><ul><li>  a.  Redémarrez l'application </li><li>  b.  Système de redémarrage </li><li>  c.  Éteignez le système </li><li>  d.  Ne rien faire </li></ul><br>  Vous devez d'abord ajouter ShellLauncher en tant que composant, cela peut être fait dans l'interface graphique "Panneau de configuration&gt; Programmes&gt; Activer ou désactiver les composants Windows", section "Verrouillage du périphérique".  Vous pouvez configurer le lancement de programmes dans la branche de registre "HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows Embedded \ Shell Launcher".  le lancement des programmes est configuré par les SID des utilisateurs, les SID peuvent être trouvés à l'aide de l'utilitaire whoami.  Pour activer ShellLauncher, il vous suffit de remplacer le lancement du shell standard dans le registre par le lancement de ShellLauncher.  Et une petite nuance, ShellLauncher n'affecte pas la taille et la position de la fenêtre du programme en cours d'exécution, et IE souhaite exécuter déployé en plein écran.  Par conséquent, nous configurons le mode de démarrage IE, toujours sous l'utilisateur utilisateur, en même temps, nous interdisons d'appeler le menu contextuel IE afin que l'utilisateur ne gâche rien. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Main</span></span>] <span class="hljs-string"><span class="hljs-string">"FullScreen"</span></span>=<span class="hljs-string"><span class="hljs-string">"yes"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Restrictions</span></span>] <span class="hljs-string"><span class="hljs-string">"NoBrowserContextMenu"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span></code> </pre><br>  Maintenant, nous configurons ShellLauncher, encore une fois, il est plus pratique pour moi de tout faire à l'aide de la console ... <br><br><pre> <code class="hljs bash">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off chcp 1251 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>  ShellLouncher   DISM /online /Enable-Feature /all /FeatureName:Client-EmbeddedShellLauncher <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>  SID  User <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=2 delims=="</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic useraccount where "Name='</span></span>User<span class="hljs-string"><span class="hljs-string">'" get SID /value^|find "SID"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> SID=%%i <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>   iexplore.exe   User reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\%SID%"</span></span> /v Shell /t REG_SZ /d <span class="hljs-string"><span class="hljs-string">"C:\Program Files\Internet Explorer\iexplore.exe www.quarta-embedded.ru"</span></span> /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>     IE reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\%SID%"</span></span> /v DefaultReturnCodeAction /t REG_DWORD /d 0 /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>       reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\S-1-5-32-544"</span></span> /v Shell /t REG_SZ /d <span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>         reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\S-1-5-32-544"</span></span> /v DefaultReturnCodeAction /t REG_DWORD /d 3 /f pause</code> </pre><br>  Et, à titre d'exemple, vous pouvez affecter un shell par défaut à exécuter lorsqu'aucune application n'est attribuée à l'utilisateur. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;     ,    cmd.exe [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Embedded</span></span>\<span class="hljs-type"><span class="hljs-type">Shell</span></span> <span class="hljs-type"><span class="hljs-type">Launcher</span></span>] <span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> ;        ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ; <span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000003</span></span> ;  </code> </pre><br>  Et allumez le Shell Launcher <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ; ShellLouncher    [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">NT</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Winlogon</span></span>] <span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"eShell.exe"</span></span> ; Shell Launcher ;<span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> ; Shell Launcher</code> </pre><br><h3>  Étape 11 - Configuration de l'affichage de démarrage du système </h3><br>  Dans les versions précédentes de Windows, vous pouviez définir vos propres logos qui apparaîtront au démarrage du système, il n'y a maintenant que deux options.  et hors  Vous pouvez désactiver le processus d'affichage de la charge dans le référentiel bcd, j'exécuterai ces commandes immédiatement et les ajouterai au script de scellage. <br><br><pre> <code class="hljs bash"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>    Windows  .     <span class="hljs-literal"><span class="hljs-literal">true</span></span>   <span class="hljs-literal"><span class="hljs-literal">false</span></span> bcdedit /<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {globalsettings} custom:16000067 <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>        Windows.     <span class="hljs-literal"><span class="hljs-literal">false</span></span> bcdedit /<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {globalsettings} nobootuxprogress <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br>  Vous pouvez également masquer le processus de connexion utilisateur. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Embedded</span></span>\<span class="hljs-type"><span class="hljs-type">EmbeddedLogon</span></span>] ;<span class="hljs-string"><span class="hljs-string">"HideAutoLogonUI"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  <span class="hljs-string"><span class="hljs-string">"HideAutoLogonUI"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; </code> </pre><br>  Maintenant, activez la connexion automatique de l'utilisateur Utilisateur, cela peut être fait en utilisant la commande netplwiz.  Nous redémarrons et voyons ce qui s'est passé, il n'y a pas d'affichage de la progression du chargement du système d'exploitation, il n'y a pas d'affichage de la connexion de l'utilisateur.  Seulement, juste avant d'entrer dans le système, l'icône Win et l'animation sous forme de boules apparaissent pendant quelques secondes, mais c'est parce que le système d'exploitation en mode audit, après avoir scellé en mode oobe, cela ne se produira pas.  IE a démarré automatiquement avec l'adresse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.quarta-embedded.ru</a> , un peu plus tard l'onglet microsoft.com est apparu, eh bien, rien, vous devrez ajouter une commande pour modifier les paramètres du registre dans le fichier de réponse de scellage <br><br><pre> <code class="hljs tex">reg add HKLM<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Software</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Internet</span></span></span></span> Explorer<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Main</span></span></span></span>" /v "DisableFirstRunCustomize" /t REG_DWORD /d 1</code> </pre><br>  Ici, je vais à nouveau faire une image du système. <br><br><h3>  Étape 12 - Installation et retrait de la clé Windows </h3><br>  Avant d'installer la clé, vous devez déconnecter le PC d'Internet afin que le système ne s'active pas.  Vous pouvez ajouter une clé et la retirer immédiatement afin que personne ne puisse la retirer.  Dans ce cas, le système peut toujours être activé. <br><br><pre> <code class="hljs powershell">slmgr /ipk XXXXX<span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span> slmgr /cpky</code> </pre><br><h3>  Étape 13 - Sceller le système </h3><br>  Pour que le système ne pose pas de questions au premier démarrage après le scellement en mode oobe, j'utilise un fichier de réponses qui a été préalablement préparé dans l'utilitaire Windows System Image Manager.  J'exécute le script pour sceller, en dessous du contenu du script et du fichier de réponses. <br><br>  Script pour sceller: <br><br><pre> <code class="hljs pgsql">del "%systemdrive%\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\*.*" /q <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f "tokens=2 delims==" %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic group where "SID='</span></span>S<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span><span class="hljs-number"><span class="hljs-number">-32</span></span><span class="hljs-number"><span class="hljs-number">-544</span></span><span class="hljs-string"><span class="hljs-string">'" get Name /value^|find "Name"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> GroupName=%%i net localgroup %GroupName% <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>} bootstatuspolicy IgnoreAllFailures bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {globalsettings} custom:<span class="hljs-number"><span class="hljs-number">16000067</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {globalsettings} nobootuxprogress <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> pushd "%~dp0" %SYSTEMROOT%\System32\Sysprep\sysprep.exe /oobe /generalize /shutdown /quiet /unattend:Unattend.xml</code> </pre><br>  Unattend.xml: <br><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unattend</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:unattend"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"specialize"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Deployment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronous</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Setup\OOBE /v SetupDisplayedProductKey /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Dont show key page<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Setup\OOBE /v UnattendCreatedUser /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Dont make account<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add "HKLM\Software\Microsoft\Internet Explorer\Main" /v "DisableFirstRunCustomize" /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Disable First Run Customize<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>cmd.exe /c rd %systemdrive%\Sysprep /s /q<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Del Folder<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronous</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Shell-Setup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AutoLogon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Enabled</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Enabled</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span>User<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AutoLogon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oobeSystem"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-International-Core"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputLocale</span></span></span><span class="hljs-tag">&gt;</span></span>en-US; ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SystemLocale</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SystemLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguage</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguageFallback</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguageFallback</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserLocale</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Shell-Setup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideEULAPage</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideEULAPage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideLocalAccountScreen</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideLocalAccountScreen</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOEMRegistrationScreen</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOEMRegistrationScreen</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOnlineAccountScreens</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOnlineAccountScreens</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideWirelessSetupInOOBE</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideWirelessSetupInOOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectYourPC</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectYourPC</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cpi:offlineImage</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpi:source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:cpi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:cpi"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unattend</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h2>  Résumé </h2><br>  Qu'est-il arrivé à la fin ... Le système s'est démarré sans aucune question, IE a démarré avec la bonne page.  Si vous tenez compte du fait qu'il n'y aura pas d'accès physique au PC et que seule la souris sera accessible à partir des moyens d'entrée, alors il semble que rien ne puisse être cassé.  Nous allons dans le compte administrateur et voyons que le dossier Sysprep est supprimé.  Le système est prêt ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413359/">https://habr.com/ru/post/fr413359/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413347/index.html">Analyse de l'atmosphère négative et comment y faire face</a></li>
<li><a href="../fr413349/index.html">Quelles mesures Google Analytics déclenchent de mauvaises décisions</a></li>
<li><a href="../fr413351/index.html">À propos des personnes, des monstres - et de la modélisation thématique</a></li>
<li><a href="../fr413353/index.html">Rocker - pilote rocksdb pour Erlang</a></li>
<li><a href="../fr413357/index.html">Premier coup d'œil au smartphone de jeu ASUS ROG Phone</a></li>
<li><a href="../fr413361/index.html">The Big Dump Theory: Recherche de documents scientifiques sur Internet</a></li>
<li><a href="../fr413363/index.html">L'artisan a vissé le téléobjectif Canon EF 70-200 mm à la caméra Game Boy</a></li>
<li><a href="../fr413367/index.html">Qu'est-ce qu'une bulle mondiale des hydrocarbures? Résultats de simulation du marché de l'énergie jusqu'à 2050 g</a></li>
<li><a href="../fr413371/index.html">Voiture électrique</a></li>
<li><a href="../fr413375/index.html">Est-il possible de se faire des amis Gitlab CI + Docker + Systemd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>