<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüç≥ üñï üôçüèæ Creaci√≥n del juego 35MM. Post Apocalipsis en Rusia üéã üë≤üèΩ ü•ì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buen d√≠a a todos, mi nombre es Sergey Noskov. Hoy me gustar√≠a hablar sobre la creaci√≥n de mi primer proyecto independiente completo llamado 35MM, lanz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Creaci√≥n del juego 35MM. Post Apocalipsis en Rusia</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448340/"><img src="https://habrastorage.org/webt/nd/lc/7g/ndlc7ge6rk_kvh7uq0ysdei1sqi.jpeg"><br><br>  Buen d√≠a a todos, mi nombre es Sergey Noskov.  Hoy me gustar√≠a hablar sobre la creaci√≥n de mi primer proyecto independiente completo llamado 35MM, lanzado en Steam en 2016.  La historia es, por supuesto, larga, y desde entonces se han publicado varios art√≠culos y entrevistas sobre el tema del proyecto, sin embargo, no hubo una descripci√≥n detallada del proceso de desarrollo.  Adem√°s, los aspectos t√©cnicos de la implementaci√≥n apenas se tocaron.  En realidad, hablaremos de esto. <br><br>  Comencemos con un poco de historia.  35MM es una aventura con una vista en primera persona en el escenario de un post-apocalipsis en Rusia.  La gente: un simulador de marcha.  El juego nos cuenta la historia del viaje de dos vagabundos por las tierras desiertas que dej√≥ la civilizaci√≥n.  La mayor parte de la poblaci√≥n muri√≥ despu√©s de una terrible enfermedad, y ahora la naturaleza recupera sus puntos de la humanidad.  Desafortunadamente, no recuerdo exactamente c√≥mo naci√≥ la idea de este proyecto, pero definitivamente recuerdo que en ese momento era un entusiasta fan√°tico del tema del acosador, los juegos de Metro y, en general, ese entorno atmosf√©rico.  Los paisajes de ciudades abandonadas, zonas industriales y pueblos siempre despertaron mi inquietud y deleite.  No s√© qu√© tipo de enfermedad es y c√≥mo explicar ese amor, pero somos muchos.  En general, tal pasi√≥n por este tema fue suficiente para comenzar a crear su propio mundo de juegos peque√±os. <br><a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/ro/01/jj/ro01jjdr6mpcdqso8mzkghc4dv4.jpeg"><br><br>  Como ya ten√≠a dos proyectos peque√±os (Light y Train), as√≠ como experiencia en el motor de Unity, comenc√© a desarrollar un nuevo juego en √©l.  Si no me equivoco, en ese momento la quinta versi√≥n del motor ya estaba disponible, pero hasta cierto punto soy conservador (no es mi mejor rasgo profesional), as√≠ que decid√≠ quedarme en la versi√≥n 4.7.  Para una comprensi√≥n general, hay muchas diferencias significativas entre las versiones 4 y 5 del motor, especialmente en t√©rminos de renderizado, iluminaci√≥n y materiales.  Unity 5 introdujo sombreadores f√≠sicamente precisos que pueden reflejar correctamente la luz y mostrar reflejos.  En palabras simples: el resplandor y los reflejos en los materiales con tales sombreadores se ven m√°s naturales y atractivos.  En la versi√≥n 4, los sombreadores b√°sicos eran mucho m√°s simples, sin embargo, escribir sus propios sombreadores podr√≠a mejorar significativamente la calidad de la imagen.  Hablaremos de esto un poco m√°s tarde.  Est√° claro que el desarrollo del juego incluye muchos aspectos, adem√°s de trabajar en el propio motor.  Para que el motor tenga algo que llenar, se requiere contenido: modelos, texturas, sonidos, guiones, etc.  Todo eso al final lo vemos en el monitor y lo escuchamos en las columnas.  Y, por supuesto, cada tipo de contenido requiere su propio software.  Para crear modelos 3D utilic√© 3D max, para trabajar con gr√°ficos 2D y crear texturas (Photoshop, para trabajar con sonido), Adobe Audition, escrib√≠ el c√≥digo en el programa Monodevelop que vino con Unity.  Te recomiendo especialmente que cierres los ojos o pases al siguiente cap√≠tulo: el juego est√° escrito en Javascript.  Solo shh, no se lo digas a nadie.  Solo s√© que para algunos esto es de mal gusto y nadie escribe en Javascript.  En general, se seleccionan las herramientas principales y el flujo de trabajo se aleja lentamente. <br><br><br><h4>  Como empez√≥ todo </h4><br>  En algunas entrevistas, ya mencion√© que generalmente no tengo un plan de desarrollo claro, sino solo el panorama general.  Por lo tanto, a menudo, la creaci√≥n de ubicaciones ocurre espont√°neamente y el dise√±o se piensa sobre la marcha.  Esto, por supuesto, es m√°s un menos que un plus, pero hay un lado positivo: es muy entretenido y nunca se sabe exactamente qu√© suceder√° despu√©s.  Resulta que el juego en cierta medida ya vive su propia vida en las etapas iniciales.  El desarrollo de 35MM comenz√≥ con la creaci√≥n de la primera ubicaci√≥n: una casa forestal abandonada y una parcela espaciosa con campos y bosques de con√≠feras. <br><br><img src="https://habrastorage.org/webt/kr/sb/cn/krsbcnewlw_cvsut4sthf26gl1a.jpeg"><br><br>  Para construir la superficie de la tierra se utiliz√≥ un terreno con 5-6 texturas de hierba y tierra.  El sombreador de terreno est√°ndar pinta la superficie con diferentes texturas usando la m√°scara RGBA, que creamos con un pincel en el motor, y el resultado a menudo se ve muy borroso, las transiciones entre las texturas son demasiado suaves y no parecen naturales.  Para refinar este punto, se cambi√≥ el sombreador de terreno y se agreg√≥ una m√°scara de compensaci√≥n.  La textura en blanco y negro "desplaz√≥" la m√°scara dibujada en el terreno y cre√≥ bordes rasgados y m√°s afilados, que visualmente complicaron ligeramente la apariencia de la superficie. <br><br><img src="https://habrastorage.org/webt/ya/xj/ec/yaxjecb49aydjyn16wrezqwgtte.jpeg"><br><br><img src="https://habrastorage.org/webt/_q/yq/_b/_qyq_bril__wzoxhezidghk7sdo.jpeg"><br><br>  La superficie de nuestra tierra se complement√≥ con varios tipos de hierba en forma de pleins dispersos al azar.  La unidad tambi√©n tiene un modo de cartelera (cuando las llanuras de hierba siempre miran al jugador), pero no es muy adecuada para jugar con una vista en primera persona, porque es demasiado notable c√≥mo la hierba "mira" nuestra c√°mara.  Siempre debe tener cuidado con el c√©sped y agregarlo dentro de l√≠mites razonables, ya que este placer arroja muchas llamadas y esto a su vez afecta el rendimiento.  Cuantos m√°s llamamientos, mayor ser√° la carga en el sistema inform√°tico.  Pero no olvide que no solo los desaf√≠os aumentan la carga.  Hay muchas formas de matar el rendimiento en el juego.  Adem√°s de la hierba en el suelo, para variar, se esparcieron mallas con ramas y piedras, as√≠ como una serie de calcoman√≠as con suciedad y rastros de ruedas de autom√≥viles. <br><br><img src="https://habrastorage.org/webt/8i/jp/u9/8ijpu9_rppnirhxukbnyfczgea0.jpeg"><br><br>  Despu√©s de crear la superficie, ve a la vegetaci√≥n, los √°rboles y los arbustos.  Prefer√≠ plantar la parte principal del bosque (√°rboles con√≠feros) usando las herramientas del terreno en s√≠, es decir, con un cepillo.  La ventaja de este m√©todo es que se realiza r√°pida y f√°cilmente, adem√°s, a una gran distancia, dicho bosque se transforma de mallas a vallas publicitarias, lo que afecta muy bien la optimizaci√≥n.  Sin embargo, cerca de la carga aumenta mucho, porque, seg√∫n tengo entendido, tales √°rboles no ruedan.  Tal vez me equivoque y alguien me corrija.  Butching es una herramienta muy importante para la optimizaci√≥n.  Hablando en t√©rminos generales, esta es una combinaci√≥n de mallas con un material en una malla com√∫n, lo que reduce significativamente el n√∫mero de llamadas de extracci√≥n, respectivamente, reduce la carga.  Otra desventaja de los asientos en el terreno es la misma posici√≥n de los √°rboles, es decir, todos se crean en el mismo √°ngulo y esta igualdad es sorprendente.  En este sentido, instal√© algunos pinos, abetos y √°rboles de hoja caduca manualmente en diferentes √°ngulos y con diferentes tama√±os, lo que agreg√≥ variedad al paisaje.  Los arbustos se arreglaron de la misma manera. <br><br><img src="https://habrastorage.org/webt/yy/z-/vg/yyz-vgfhvbn27w1bi6enj3vpfoc.jpeg"><br><br><img src="https://habrastorage.org/webt/e1/rc/ew/e1rcewfivsfb3ob6gmhk7rjv-x4.jpeg"><br><br>  Para completar, queda por tratar con el cielo.  Para esta tarea, se utiliz√≥ un material ordinario de skybox con seis texturas.  Hubo intentos de modificar el sombreador para que el cielo se viera din√°mico, pero el resultado no se justific√≥ y esta idea tuvo que ser abandonada.  Una alternativa era el uso de un sistema de part√≠culas con textura de nubes y carteles horizontales con interpolaciones de movimiento.  Por lo que recuerdo, se utiliz√≥ una opci√≥n similar en el juego Stalker, y de hecho hay muchos m√°s en otro lugar. <br><br><img src="https://habrastorage.org/webt/15/zs/co/15zsco7qze7gwo7mtz-qjagsxdm.jpeg"><br><br><h4>  Iluminaci√≥n </h4><br>  En la cuarta versi√≥n del motor Unity, hab√≠a un modo muy conveniente para hornear mapas de luz: doble mapa de luz.  Hay una opci√≥n similar en las versiones actuales, pero a√∫n no la he estudiado en detalle.  El modo dual nos permiti√≥ dibujar sombras y brillos en tiempo real a corta distancia, pero a medida que nos alej√°bamos de la c√°mara, todo esto se convirti√≥ sin problemas en mapas de luz horneados, lo que facilit√≥ enormemente la tarea de nuestro hardware.  En general, utilic√© este m√©todo en todas las ubicaciones del juego.  Como resultado, para cada ubicaci√≥n intermedia, se horne√≥ un conjunto de aproximadamente 5-10 mapas de luz para el plano cercano, y una cantidad similar para el distante (en el fondo, tambi√©n se usaron mapas de luz, pero solo con el ambiente al horno). <br><br><img src="https://habrastorage.org/webt/rf/x1/mt/rfx1mtclxshah0ofoykqhftdj9a.jpeg"><br><br><img src="https://habrastorage.org/webt/fa/dt/vf/fadtvfm-928kih6ouhi3_axjpz8.jpeg"><br><br>  En general, en muchas √°reas intent√© usar luz completamente horneada, con la excepci√≥n de la luz del sol.  Se colocaron luces puntuales en lugares para enfatizar los acentos y m√°s luz.  Esto se hizo principalmente en habitaciones donde penetraba poca luz externa.  En varios lugares, por supuesto, tambi√©n se utilizaron l√°mparas de √©poca oxidada con sombras: luz de un fuego, una l√°mpara de mesa, una l√°mpara de techo o pared.  Por cierto, cuando trabaj√© con iluminaci√≥n, tuve que lidiar con un gran problema relacionado con las l√°mparas Point y las sombras en tiempo real.  En algunas √°reas, la mirada de la c√°mara en una fuente puntual de luz con sombras dio frisos y frenos inquietantes.  No est√° del todo claro por qu√© la carga era tan alta, pero el generador de perfiles en ese momento mostr√≥ llamadas fuera de escala durante una fracci√≥n de segundo.  Para corregir la situaci√≥n, ayud√≥ el uso de dos luminarias Spot dirigidas en direcciones opuestas entre s√≠.  Esta opci√≥n result√≥ ser menos pesada. <br><br><img src="https://habrastorage.org/webt/cn/0n/dm/cn0ndmoy7smmzdn1aaib9f3te3s.jpeg"><br><br><h4>  Modelos </h4><br>  La mayor√≠a de los modelos 3D para el juego fueron creados de forma independiente.  Algo se hizo con mucho cuidado, horneando mapas normales y otras sutilezas, y algo se cre√≥ a toda prisa para ahorrar tiempo.  La mayor√≠a de los objetos se crearon en grupos y utilizaron una sola textura de atlas.  Es decir, en una textura hab√≠a secciones, por ejemplo, para un bloque de hormig√≥n, una se√±al de tr√°fico, escombros de ladrillo, una escotilla de alcantarilla, etc.  Esto permiti√≥ utilizar un material para todos estos objetos y, en consecuencia, permiti√≥ que los objetos vibraran.  Como recordamos, esto es bastante bueno.  Algunos modelos los descargu√© fielmente de Internet, de bibliotecas gratuitas.  B√°sicamente, estos son peque√±os accesorios para llenar las habitaciones, sin embargo, trat√© de modificar un poco todos estos modelos para que la similitud no fuera muy evidente.  A menudo not√© activos id√©nticos en los juegos independientes, lo que influy√≥ en mi percepci√≥n, no de la mejor manera.  Lo m√°s problem√°tico en t√©rminos de creaci√≥n fue el transporte.  El modelado de veh√≠culos con ruedas desde cero lleva mucho tiempo y lleva mucho tiempo.  Por lo tanto, compr√© varias copias de los autos en la tienda de activos. <br><br><img src="https://habrastorage.org/webt/_f/s1/c5/_fs1c5qh9mrgi2u8wiysjevdrdw.jpeg"><br><br><img src="https://habrastorage.org/webt/ey/yk/51/eyyk510atgkm5d0wrzlpdetox9k.jpeg"><br><br><img src="https://habrastorage.org/webt/kc/g9/62/kcg962k7ikvrkueqcmeijk73kzi.jpeg"><br><br>  Una "canci√≥n" separada fue la creaci√≥n de personajes.  Esto sigue siendo un experimento.  Para aquellos que no tienen una buena idea de cu√°nto trabajo se necesita para que aparezca un personaje que pueda existir de alguna manera en el juego, explicar√©.  Se crea un modelo de alta poli con todos los detalles, botones en las mangas, arrugas en la cara, etc.  Se crea un modelo low-poly del mismo personaje con un escaneo de textura (en mi juego, el n√∫mero de pol√≠gonos por personaje era en promedio de aproximadamente 5-8 mil).  Adem√°s, un mapa normal, un mapa ambiental (sombreado suave) se elimina del modelo de alta poli para el de baja poli por manipulaciones astutas o sin complicaciones.  Por lo general, desde ambiente hago un mapa difuso en Photoshop.  En el mapa difuso en el canal alfa, cree un mapa especular para crear brillo. <br><br><img src="https://habrastorage.org/webt/xo/en/kn/xoenknestj0mo76ow0xco-yvyu4.jpeg"><br><br><img src="https://habrastorage.org/webt/9s/v1/sr/9sv1sre0wuc7oryy9ug-u8ynqpo.jpeg"><br><br>  Para 2019, por supuesto, ya es demasiado primitivo, pero durante 16 a√±os y para el proyecto independiente fue bastante adecuado. <br><br>  Adem√°s, nuestro persa necesita ser coqueteado, para colocar huesos en √©l, debido a lo cual puede mover sus extremidades, mover su mand√≠bula, doblar y doblar sus dedos, etc.  Bueno, al final, todo debe ser animado.  Por lo general, se crea un conjunto de animaciones con diferentes estados para el personaje: caminar, correr, pararse o sentarse.  Pero tambi√©n se requieren fragmentos √∫nicos, por ejemplo, en mi caso, para el compa√±ero de nuestro h√©roe Petrovich, se requiri√≥ una gran cantidad de variaciones de acciones: abrir puertas, examinar un mapa, pelear con bandidos, lanzar una bomba de luz al nivel de Bor, etc.  Todo esto ten√≠a que ser animado a mano, lo que, por supuesto, es muy sorprendente en su torpeza.  En general, la animaci√≥n manual de los movimientos humanos es una tarea muy dif√≠cil y es extremadamente dif√≠cil lograr un resultado plausible.  Por lo tanto, motion cap es la soluci√≥n m√°s adecuada para esta tarea.  Hasta donde s√©, ahora esta opci√≥n es m√°s barata y m√°s r√°pida que el trabajo del animador, aunque los datos recibidos deben procesarse y "limpiarse" manualmente. <br><br><img src="https://habrastorage.org/webt/gv/b8/ir/gvb8irricyi1lcirwgwisjcjfkq.jpeg"><br><br><h4>  Sombreadores </h4><br>  Aclarar√© de inmediato que entend√≠ la escritura de sombreadores en ese momento de manera muy superficial.  Mi entrenamiento fue principalmente en el an√°lisis de ejemplos listos y su refinamiento.  Tom√© varias opciones de la red, cambi√© los par√°metros, agregu√© nuevos o elimin√© los viejos y verifiqu√© c√≥mo esto afecta el resultado.  Result√≥ que esta es una actividad extremadamente emocionante.  De particular inter√©s para m√≠ fue el manejo de diferentes canales de textura como una m√°scara.  En algunos casos, intent√© ajustar la cantidad m√°xima de informaci√≥n en una textura y usarla.  Al comienzo del art√≠culo, mencion√© las diferencias entre la cuarta y las versiones posteriores de Unity, y espec√≠ficamente, la presencia de sombreado f√≠sicamente correcto en las √∫ltimas.  Trat√© de eliminar esta deficiencia por mi cuenta, y el efecto fresnel se agreg√≥ al sombreador est√°ndar con un mapa especular, cubmap y normal.  Esta es una caracter√≠stica de los materiales reflectantes, en la que las superficies en un √°ngulo relativo a nuestra vista reflejan el entorno (o cubmap en este caso) con m√°s fuerza y, por lo general, se ven m√°s claras y m√°s contrastantes.  Esto es muy notable en una bola brillante, cuyos bordes parecen m√°s brillantes que el centro.  Pude repetir este efecto, as√≠ como agregar la capacidad de pintar el cubmap en el material, que generalmente podemos ver en superficies reflectantes pero rugosas.  Este sombreador me satisfizo por completo y se aplic√≥ a la mayor√≠a de los materiales del juego. <br><br><img src="https://habrastorage.org/webt/kz/ka/kj/kzkakjqxlpr1izaz4ffc3h7kdac.jpeg"><br><br><img src="https://habrastorage.org/webt/qp/go/0m/qpgo0m9kwezqi0nraikd-lbxuro.jpeg"><br><br>  La segunda experiencia interesante fue la creaci√≥n de un sombreador para la piel de los personajes.  La base fue un c√≥digo encontrado en Internet que le permite utilizar una textura de degradado, que es responsable de la intensidad y el color de la iluminaci√≥n que afecta al modelo.  Una textura similar con un tinte rojizo en el medio hizo posible imitar la piel humana, que, por as√≠ decirlo, es un poco transl√∫cida, es decir, tiene su propio grosor, en el que la luz se dispersa suavemente.  El efecto no es perfecto, pero se ve mejor que el pl√°stico est√°ndar Bumped Specular. <br><br><img src="https://habrastorage.org/webt/bd/x9/vq/bdx9vqxqwtq9mpfixc38u3bl0bi.jpeg"><br><br>  Adem√°s de los sombreadores anteriores, se crearon muchas opciones secundarias con efectos individuales en el proceso.  Por ejemplo, un sombreador de charcos con un mapa de cubos y una deformaci√≥n de mapa difusa.  Dado que es demasiado costoso aplicar reflejos reales a los charcos, y no quer√≠a usar un renderizado en la textura (esto es cuando el marco se guarda en la textura y se usa en el material, durante el cual, por ejemplo, se pueden hacer distorsiones del aire caliente), decid√≠ hacer distorsiones simples de la textura de la tierra, estirado sobre un charco.  El efecto fue bastante agradable y no tens√≥ el hierro en absoluto.  Por cierto, se utiliz√≥ un sombreador con un renderizado de textura para distorsionar el aire de las l√°mparas de queroseno y una hoguera.  Parece haber sido distorsi√≥n por calor del activo detonador.  Adem√°s, para simular rayos de luz volum√©tricos, se cre√≥ un sombreador de v√©rtices con el efecto de Part√≠cula suave y el efecto de luz de borde (cuando miramos los pol√≠gonos en √°ngulo, la malla pasa a alfa).  Esta es una forma cl√°sica y ya barbuda de implementaci√≥n.  Ahora, para la nueva Unidad hay una opci√≥n genial que funciona en funci√≥n del post-efecto y le permite dibujar rayos de luz reales incluso con las sombras. <br><br>  Otro aspecto digno de menci√≥n es el conjunto de sombreadores que se hicieron para simular superficies mojadas.  El juego tiene un episodio en el que en alg√∫n momento comienza una fuerte lluvia y algunos de los materiales adquieren suavemente un brillo caracter√≠stico.  El efecto principal se aplic√≥ al terreno, en el cual, como en el caso de los charcos, la textura difusa comenz√≥ a distorsionarse.  Las filtraciones de agua tambi√©n aparecieron en las ventanas de las casas.  Bueno, el chip m√°s "h√∫medo" fueron las gotas que cayeron sobre la lente.  Aqu√≠, de hecho, estaba atormentado por las dudas, porque el h√©roe no ten√≠a gafas ni casco, y no estaba claro c√≥mo las gotas se mostraban tan obsesivamente en la pantalla.  Sin embargo, visualmente me gust√≥ tanto el efecto que no pude rechazarlo. <br><br><img src="https://habrastorage.org/webt/ei/-x/u2/ei-xu2rezxy8cw3icshvbrbqev0.jpeg"><br><br>  As√≠ que pasamos sin problemas a los post-efectos.  Hablando de gotas en la pantalla, todo es simple: unas pocas gotas de la textura se multiplican y bajan a diferentes velocidades.  Paralelamente, las ondas (texturas de gradiente) se mueven hacia abajo, que se multiplican, cada una por su propio grupo de gotas.  Luego todo se resume, se muestra ligeramente en la "difusi√≥n", por as√≠ decirlo, pero se utiliza principalmente como una m√°scara para cambiar las coordenadas.  Como resultado, nuestra imagen est√° distorsionada por la refracci√≥n de las gotas de agua.  El conjunto principal de efectos posteriores que siempre fueron opcionales en la c√°mara (si el jugador los encendi√≥ o apag√≥) es antialiasing, SSAO, Bloom, Aberration, Vignette, Sun Shafts.  Todos estos son efectos Unity est√°ndar, pero SSAO se ha modificado para que la representaci√≥n de las sombras a distancia se reduzca a cero, porque en la distancia en la niebla los puntos oscuros de las sombras parec√≠an extra√±os.  El efecto de aberraci√≥n tambi√©n se modific√≥ (esta es la distorsi√≥n de color de la imagen cuando se usan lentes, algo as√≠ como contornos de color en los bordes de los objetos). El efecto est√°ndar de Unity pint√≥ los bordes de color verde burdeos de los objetos (una soluci√≥n bastante extra√±a en mi opini√≥n).  De hecho, la mayor√≠a de las veces los colores est√°n m√°s cerca del amarillo-rojo-azul, que me di cuenta.  Otro efecto permanente fue la correcci√≥n de color propia.  El efecto de Unidad est√°ndar me pareci√≥ demasiado intensivo en recursos, por lo que se realiz√≥ uno propio y simplificado.  B√°sicamente, cre√≥ el efecto de la asignaci√≥n de tonos y cambi√≥ ligeramente el esquema de color a uno m√°s fr√≠o.  Elegir una paleta de colores para una imagen siempre es una tarea dif√≠cil, que es dif√≠cil de determinar.  Sucede que le pueden gustar opciones completamente opuestas y tomar una decisi√≥n es extremadamente dif√≠cil.  En este proyecto, me decid√≠ por colores apagados y fr√≠os.  Para muchos, parec√≠a demasiado desvanecida, pero me parece que transmite con mucha precisi√≥n el estado de √°nimo que intent√© reflejar en mi juego, el estado de tristeza, des√°nimo y soledad. <br><br><img src="https://habrastorage.org/webt/qv/er/iv/qverivmj5x-rorvqc0vgmmsrtpo.jpeg"><br><br><img src="https://habrastorage.org/webt/4i/uz/2k/4iuz2kxafowra3gr_cckxkngpzq.jpeg"><br><br><h4>  ¬øQu√© hay del c√≥digo? </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En repetidas ocasiones mencion√© en una entrevista que siempre estaba lejos del tema de la programaci√≥n y me enfoqu√© m√°s en el componente visual. Comenc√© a escribir el primer c√≥digo completo mientras trabajaba en el juego "Train", as√≠ que para el momento en que desarroll√© 35MM ya ten√≠a algunas habilidades. En general, el g√©nero de b√∫squeda me pareci√≥ muy adecuado para comprender la programaci√≥n en mi nivel inicial. La mayor√≠a de las acciones en el juego se basan en disparadores. Un objeto ingresa al disparador (un cubo con un colisionador) y algo comienza a suceder, por ejemplo, comienza una escena de corte. En el gui√≥n, como en el gui√≥n de la representaci√≥n teatral, se describe l√≠nea por l√≠nea cu√°ndo y qu√© sucede: ahora la c√°mara del jugador se apaga, la c√°mara de la escena de corte se enciende, el personaje aparece en el cuadro, comienza la animaci√≥n de la conversaci√≥n, etc. Creo que hay herramientas que facilitan todo este proceso (creoporque no fue profundo), pero esta opci√≥n todav√≠a me parece la m√°s comprensible, porque t√∫ mismo controlas todos los eventos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El movimiento de nuestro compa√±ero en el juego se implement√≥ mediante disparadores, que eran puntos de control de su ruta. Si presiona el gatillo, podr√≠a activarse una nueva animaci√≥n o el personaje podr√≠a decir algo. </font></font><br><br><img src="https://habrastorage.org/webt/ts/r9/rz/tsr9rz9e2jumsgryopdvzs_og4m.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este m√©todo se utiliz√≥ en todos los niveles, excepto el √∫ltimo. En la ubicaci√≥n final de la ciudad, si llegamos a ella con un compa√±ero, ya no nos guiar√° por la ruta, sino que correr√° detr√°s de nosotros. All√≠, ya se ha utilizado un controlador basado en NavMesh (un sistema que permite que un objeto busque una ruta a un objetivo y se mueva hacia √©l).</font></font><br><br><img src="https://habrastorage.org/webt/cx/my/4i/cxmy4ix45uvqvn4auqkvlk0ykby.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las cosas fueron m√°s dif√≠ciles con el oso en la segunda ubicaci√≥n del juego. Se us√≥ un controlador que funciona solo con un cuerpo r√≠gido (cuerpo f√≠sico), por lo que la bestia era est√∫pida y a menudo se estrellaba contra √°rboles y otros objetos. El material f√≠sico con cero fricci√≥n nos permiti√≥ evitar serios atascos y, como resultado, el oso resbal√≥ y continu√≥ persigui√©ndonos. Aqu√≠, y en general en las √°reas donde puedes morir, me encontr√© con el problema m√°s grave para m√≠: el lanzamiento de la muerte y el reinicio. En el momento de la muerte, era necesario tener en cuenta todos los estados actuales del personaje: si la linterna est√° encendida, si la tarjeta est√° abierta, si el cuchillo est√° activado, etc. Tambi√©n se requer√≠a preservar los valores de salud y todos los recursos y luego, todo lo que se activ√≥, se requer√≠a desactivar y comenzar la animaci√≥n de la ca√≠da de la c√°mara. Despu√©s de oscurecer la pantalla, fue necesario devolver todo y leer los valores almacenados.De hecho, no hay grandes dificultades con el enfoque adecuado, pero en mi caso aparecieron muchos errores: o el cuchillo permaneci√≥ en mis manos ante mis ojos cuando el oso atac√≥, luego la tarjeta no desapareci√≥, todo eso. Adem√°s, nunca se sabe c√≥mo un jugador puede conducirse en este momento, d√≥nde correr√° y en qu√© condiciones puede conducir un oso, que puede quedar atrapado en alg√∫n lugar o, por ejemplo, atacarnos a trav√©s del muro. En general, hay muchos matices que no podr√° prever de inmediato.atacarnos a trav√©s del muro. En general, hay muchos matices que no podr√° prever de inmediato.atacarnos a trav√©s del muro. En general, hay muchos matices que no podr√° prever de inmediato.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interacci√≥n de nuestro personaje con los objetos se realiz√≥ utilizando el rayo Raycast. Todos los objetos interactivos fueron etiquetados con la etiqueta Asunto, y cuando el rayo los golpea, activa la luz de fondo (la malla es un indicador con bordes resaltados) e incluye un gui√≥n que ya es responsable de la acci√≥n que podemos tomar con este objeto, por ejemplo, recoger un objeto, leer una nota o abre la puerta.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para la interacci√≥n, inicialmente hab√≠a planes para hacer manos completas que alcanzaran los objetos, esto crear√≠a un efecto m√°s obvio de presencia. Pero esta opci√≥n representaba para m√≠ la gran dificultad de implementaci√≥n y la posibilidad de tener un "paquete" completo de errores en el futuro, por lo que solo hab√≠a manos que llevaban elementos ya seleccionados. Hay un prefabricado con peque√±os mangos delante de la c√°mara, en el que todos los objetos ya est√°n presentes (c√°mara, cuchillo, hacha, etc.). Cuando selecciona un objeto durante el juego, el deseado se enciende y los innecesarios se apagan.</font></font><br><br><img src="https://habrastorage.org/webt/kp/my/wh/kpmywhdleoxjlpvbey5nxq6iexa.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un punto interesante estaba relacionado con la animaci√≥n de los personajes hablando. </font><font style="vertical-align: inherit;">La t√©cnica es primitiva, pero lo pens√© yo misma, orgullosa, s√≠. </font><font style="vertical-align: inherit;">Al principio, pens√© que al comunicar los personajes, tendr√≠a que comenzar la animaci√≥n de la apertura de la mand√≠bula en un orden aleatorio con cada frase. </font><font style="vertical-align: inherit;">Pero luego se me ocurri√≥ que un gui√≥n pod√≠a leer el nivel de volumen de la banda sonora en el momento de la reproducci√≥n y transferir este nivel a un valor flotante, que ya es responsable de la posici√≥n de la mand√≠bula del h√©roe. </font><font style="vertical-align: inherit;">Finalmente, la mand√≠bula se abri√≥ autom√°ticamente al pronunciar palabras al ritmo del archivo de sonido. </font><font style="vertical-align: inherit;">Esto simplific√≥ enormemente la tarea, aunque parec√≠a demasiado "m√°quina".</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Optimizaci√≥n </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La optimizaci√≥n es una parte muy importante del desarrollo, de la que depende la facilidad con la que el juego funcionar√° en diferentes hardware. Me referir√© a la optimizaci√≥n del componente visual del proyecto. Hay varios m√©todos √∫tiles para esto: grupos de logias, el sacrificio est√° ocluido, recortando objetos a distancia. El grupo LOD debe usarse en el caso de objetos "pesados" de alta poli. Para hacer esto, cree varias mallas con un n√∫mero diferente de pol√≠gonos. Cuanto m√°s lejos est√© la c√°mara del sujeto, m√°s simplificado se dibuja el modelo en el marco. Por ejemplo, para 35MM, las caba√±as se usaron en modelos de autom√≥viles, personajes y algunos √°rboles. Por lo general, se hicieron 2-3 cargas, entre las cuales cada malla posterior ten√≠a casi 2 veces menos pol√≠gonos. Para mayor claridad: el modelo original del autom√≥vil consta de 15 mil pol√≠gonos, el primer LOD ya tiene alrededor de 9 toneladas.(el n√∫mero de nervaduras disminuye, las piezas peque√±as, como las bisagras, las piezas interiores se retiran), el segundo LOD ya alcanza las 5 toneladas (se quitan las manijas de las puertas, los espejos dentro de la cabina, la geometr√≠a se vuelve a√∫n m√°s f√°cil). M√°s en la misma l√≠nea. Para los lods, por cierto, se utiliz√≥ un truco interesante. Cuando horneamos mapas de luz para un objeto con lods, tenemos que hornear para ambos objetos. Para reducir el tiempo de cocci√≥n y guardar la memoria del sistema, utilic√© un script que transfiri√≥ autom√°ticamente el mapa de luz asignado con todas las coordenadas desde el objeto primario (cero LOD) a todos los dem√°s alojamientos.Se utiliz√≥ un truco interesante. Cuando horneamos mapas de luz para un objeto con lods, tenemos que hornear para ambos objetos. Para reducir el tiempo de cocci√≥n y guardar la memoria del sistema, utilic√© un script que transfiri√≥ autom√°ticamente el mapa de luz asignado con todas las coordenadas desde el objeto primario (cero LOD) a todos los dem√°s alojamientos.Se utiliz√≥ un truco interesante. Cuando horneamos mapas de luz para un objeto con lods, tenemos que hornear para ambos objetos. Para reducir el tiempo de cocci√≥n y guardar la memoria del sistema, utilic√© un script que transfiri√≥ autom√°ticamente el mapa de luz asignado con todas las coordenadas desde el objeto principal (cero LOD) a todos los dem√°s alojamientos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El segundo m√©todo de optimizaci√≥n es la eliminaci√≥n de oclusiones. Este es un mecanismo en el que se corta todo lo que no est√° en el campo de visi√≥n de la c√°mara o est√° cerrado por otro objeto. Por ejemplo, cuando entramos en la habitaci√≥n, detr√°s de la pared ya no vemos muchos objetos en la calle y, por lo tanto, no hay necesidad de gastar recursos para representarlos.</font></font><br><br><img src="https://habrastorage.org/webt/j1/_y/tk/j1_ytkv-3hkd3m8m-xbewf8thzw.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otra forma √∫til de simplificar el renderizado es recortando objetos a distancia. </font><font style="vertical-align: inherit;">Esta es la primera opci√≥n que conoc√≠ desde el momento del proyecto "Light". </font><font style="vertical-align: inherit;">Se cuelga un gui√≥n en la c√°mara que ajusta su distancia de representaci√≥n para cada capa. </font><font style="vertical-align: inherit;">En mi caso, se crearon especialmente tres categor√≠as de capas, con objetos peque√±os (art√≠culos para el hogar, martillos, ladrillos y escombros peque√±os), con tama√±os medianos y ligeramente m√°s altos que el promedio (teteras, arbustos, macetas, farolas peque√±as, etc.). </font><font style="vertical-align: inherit;">A tres categor√≠as se les asignaron distancias: 40, 80 y 120 metros. </font><font style="vertical-align: inherit;">Una vez m√°s all√° de la distancia especificada, la c√°mara dej√≥ de representar el objeto correspondiente. </font><font style="vertical-align: inherit;">La opci√≥n es muy conveniente y efectiva, ya que los peque√±os accesorios ya no se pueden ver desde lejos y, por lo tanto, no tiene sentido hacerlo.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sonido </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mayor√≠a de los sonidos del juego fueron tomados de bibliotecas gratuitas de Internet. Por lo general, descargu√© las opciones necesarias y luego las combin√© y mezcl√© en Adobe Audition. En general, no hay mucho que decir sobre esta parte del trabajo, porque es un proceso bastante rutinario y aburrido y no es particularmente atractivo para m√≠. Por cierto, el trabajo de introducir sonidos, puntuar escenas cortadas, ajustar archivos de sonido para que suene el sonido deseado en el momento adecuado, todo esto probablemente tom√≥ un cuarto del tiempo total trabajando en el juego. El √∫nico momento agradable fue la introducci√≥n de la m√∫sica, en la que trabaj√≥ el genial y extremadamente talentoso compositor Dmitry Nikolaev. Estoy muy satisfecho con lo que hizo, porque en general, no sab√≠a exactamente lo que quer√≠a escuchar. Pero Dmitry sinti√≥ muy bien el estado de √°nimo.que se estableci√≥ en el proyecto y se implement√≥ en forma de ambiente atmosf√©rico. Result√≥ algo fant√°stico, misterioso y mel√≥dico.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otro paso interesante fue trabajar con personajes de voz. A pesar de las cr√≠ticas externas, todav√≠a estoy satisfecho con el resultado y creo que los actores hicieron su trabajo muy bien. Por cierto, los personajes principales expresados ‚Äã‚Äãpor Vsevolod Petrykin y Alexander Bragi, por lo que muchas gracias a ellos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En general, no hubo problemas serios con el sonido, aunque, despu√©s del lanzamiento, se descubri√≥ un error raro que todav√≠a no pod√≠a superar, porque todav√≠a no entend√≠a su naturaleza. </font><font style="vertical-align: inherit;">A veces, parte de los sonidos dejaron de sonar o sonaron con un fuerte efecto de eco. </font><font style="vertical-align: inherit;">Al hablar con un h√©roe, una voz podr√≠a desaparecer repentinamente y, de la misma manera, recuperarse repentinamente. </font><font style="vertical-align: inherit;">Hubo conjeturas asociadas con una gran carga y una gran cantidad de sonidos que se reproducen simult√°neamente. </font><font style="vertical-align: inherit;">Tambi√©n hubo suposiciones sobre la conexi√≥n del error con las zonas de reverberaci√≥n, pero esto no es exacto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eso es probablemente todo. </font><font style="vertical-align: inherit;">Ha pasado mucho tiempo desde el desarrollo, se han olvidado algunas cosas y otras se han vuelto completamente irrelevantes, pero espero que el art√≠culo sea √∫til para alguien y pueda proporcionar respuestas a algunas preguntas. </font><font style="vertical-align: inherit;">¬°Gracias a todos y buena suerte!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448340/">https://habr.com/ru/post/448340/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448330/index.html">N√∫meros aleatorios y redes descentralizadas: una aplicaci√≥n pr√°ctica</a></li>
<li><a href="../448332/index.html">Iniciadores de TI: demuestre su fortaleza en un arrecife</a></li>
<li><a href="../448334/index.html">Cuando la productividad de alguien despierta inter√©s</a></li>
<li><a href="../448336/index.html">Seminario "Nubes h√≠bridas: pros y contras: qu√© prepararse para los negocios y las TI" - 25 de abril, Mosc√∫</a></li>
<li><a href="../448338/index.html">Desglosando los fundamentos de C #: asignaci√≥n de memoria para un tipo de referencia en la pila</a></li>
<li><a href="../448342/index.html">MyDrops: TWS de bajo costo con buen sonido y Bluetooth confiable</a></li>
<li><a href="../448346/index.html">De GNU a Doom: se anuncia TechTrain 2019</a></li>
<li><a href="../448350/index.html">Implementaci√≥n del diccionario en Python</a></li>
<li><a href="../448352/index.html">Boring Company cavar√° un t√∫nel en Las Vegas</a></li>
<li><a href="../448354/index.html">GraphQL Voyager como herramienta para encontrar vulnerabilidades</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>