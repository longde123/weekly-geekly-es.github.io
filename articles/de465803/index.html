<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤰🏾 🤞🏽 🌏 Maven-Weg, um Go-Projekte zu bauen 💨 🤣 💏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Zunächst ein kleiner Hintergrund. Anfang der 2010er Jahre habe ich ein kleines Konverter-Dienstprogramm für BIN-Dateien des BK-0010- Emulators in WAV-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maven-Weg, um Go-Projekte zu bauen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465803/"><p>  Zunächst ein kleiner Hintergrund.  Anfang der 2010er Jahre habe ich ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kleines Konverter-Dienstprogramm</a> für BIN-Dateien des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BK-0010-</a> Emulators in WAV-Dateien erstellt.  Das Dienstprogramm wurde in Python mit dem Ziel maximaler Portabilität geschrieben, es funktionierte ohne Probleme und ich vergaß es für eine Weile.  Aber im Jahr 2016 erschien der Benutzer, der keine Ahnung von Python und wie man es installiert.  Er wollte einen einfachen ausführbaren Monolithen, der "einfach funktioniert".  Seine Anfrage erschien mir logisch und ich beschloss, das Dienstprogramm als eine Reihe von ausführbaren Binärdateien für die Hauptplattformen zu überarbeiten. </p><br><p><img src="https://habrastorage.org/webt/dm/hq/kd/dmhqkdcz2pv6rlqs3af4f2_5jv4.png" alt="Bild"></p><br><p>  Python und Java gaben keine solche Gelegenheit (es sei denn, es bestand natürlich der Wunsch, das Dienstprogramm um viele zehn Megabyte zu erhöhen).  Möglicherweise könnte die Lösung in C / C ++ erfolgen, aber bei einer derart gezielten Abdeckung der Plattformen würden Schwierigkeiten bei der Cross-Kompilierung über die für die Aufgabe vorgesehene Zeit hinausgehen (und ich musste Cross-Assembly für Windows, Linux und MacOS in 64- und 32-Bit unterstützen Optionen).  Also machte ich auf die Sprache Go aufmerksam, die immer beliebter wird, die zu diesem Zeitpunkt bereits ziemlich ausgereift war und die einzige, die <strong>ohne alle Tänze mit einem Tamburin die erforderliche Cross-Compilation sofort bereitstellt (!)</strong> . </p><a name="habracut"></a><br><p>  Eine Unannehmlichkeit, die mich an Go sehr ärgerte (insbesondere als Java-Entwickler), war die schlechte Nachdenklichkeit bei der Organisation der Struktur von Go-Projekten und die Notwendigkeit, die Umgebung ständig anzupassen.  Vielleicht hatten die Go-Entwickler ursprünglich eine bestimmte Verwendung geplant, oder es gab einen Schwerpunkt auf Containern, aber ich habe mich an den „leckeren“ gewöhnt, und da mein Hauptwerkzeug in Java <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maven ist</a> , habe ich beschlossen, ein Plug-In zu erstellen, das Dienstprogramme und GoSDK-Befehle mit der automatischen Generierung der erforderlichen aufruft Umgebungsvariablen. </p><br><p> Es war nicht interessant, ein einfaches Plugin zu erstellen, das das Dienstprogramm go aufruft, und ich entschied mich für den Schritt - Installation von GoSDK auf der Hostplattform.  Unmittelbar nach dem Start wird das Vorhandensein von GoSDK in seinem Konfigurationsverzeichnis überprüft (ich habe den Standardpfad <code>~/.mvnGoLang</code> ), und <code>~/.mvnGoLang</code> die erforderliche Version fehlt, wird das GoSDK-Archiv automatisch von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Site</a> heruntergeladen und entpackt.  Auf diese Weise konnten wir tragbare Go-Projekte erstellen, ohne uns Gedanken darüber machen zu müssen, ob das Tool der erforderlichen Version vorinstalliert und konfiguriert ist.  Natürlich habe ich bei vielen Einstellungen die Möglichkeit vorausgesehen, eine vorinstallierte Version zu verwenden, und Einstellungen für alle Schritte des Prozesses hinzugefügt, da für viele Probleme wie das Deaktivieren der Überprüfung von SSL-Zertifikaten oder das allgemeine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausführen von</a> HTTP-Anforderungen außerhalb (z. B. für das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Keycloak-</a> Projekt) von entscheidender Bedeutung sind. </p><br><p>  Im nächsten Schritt habe ich alle zu diesem Zeitpunkt bereitgestellten go-Dienstprogrammbefehle in die Maven-Ziele (Ziele) eingewickelt.  Da die Möglichkeit bestand, dass mit der neuen Version von GoSDK ein weiterer neuer Befehl angezeigt wurde, wurde eine <code>custom</code> Aufgabe hinzugefügt, mit der der Benutzer den gewünschten Befehl selbst bestimmen kann.  Standardmäßig werden Aufgaben im Rahmen von Maven-Phasen (Phasen) in der folgenden Reihenfolge ausgeführt: </p><br><ul><li>  Als <code>default-clean</code> in Phase <em>Clean reinigen</em> </li><li>  <strong>Fix</strong> als <code>default-fix</code> in der <em>Validierungsphase</em> </li><li>  <strong>Get</strong> als <code>default-get</code> in der <em>Initialisierungsphase</em> </li><li>  <strong>Generieren</strong> als <code>default-generate</code> in der Phase " <em>Generieren von Quellen"</em> </li><li>  <strong>fmt</strong> als <code>default-fmt</code> in der <em>Prozessquellenphase</em> </li><li>  <strong>Test</strong> als <code>default-test</code> in der <em>Testphase</em> </li><li>  <strong>Build</strong> als <code>default-build</code> in der <em>Paketphase</em> </li><li>  Als <code>default-install</code> interne Task <strong>mvninstall</strong> in der <em>Installationsphase</em> <strong>ausgeführt</strong> </li><li>  <strong>Installation</strong> als <code>default-deploy</code> in der <em>Bereitstellungsphase</em> </li></ul><br><p>  Jeder der grundlegenden Schritte kann deaktiviert werden, indem die Aufgabe in eine nicht vorhandene Phase übersetzt wird: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>default-fix<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span>none<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In der internen Implementierung wurden die Aufgaben in "Arbeiten mit Abhängigkeiten" und "Keine Lösung von Abhängigkeiten erforderlich" unterteilt, nachdem die Unterstützung für den Modulmodus angezeigt wurde. Die meisten Aufgaben wurden auf "Arbeiten mit Abhängigkeiten" migriert. </p><br><p>  Bei der Struktur des Go-maven-Projekts habe ich versucht, näher an die für Go akzeptierte Standardordnerstruktur heranzukommen (d. H. <code>/src</code> und <code>/bin</code> im Stammverzeichnis des Projekts).  Da Maven jedoch für Java inhaftiert ist, war es nicht direkt möglich, seinen Ansatz zur Organisation der Projektstruktur zu „brechen“ und diesen Schritt für den Benutzer unsichtbar zu machen, sodass die Grundkonfiguration des Plugins selbst für viele mit Maven vertraute Personen etwas ungewöhnlich erscheint: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> ```${basedir}/src<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sourceDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-wrapper<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span>1.12.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><blockquote>  <strong>WARNUNG!</strong>  Aus irgendeinem Grund zeigt der HabR beim Formatieren von XML <code>&lt;sourceDirectory&gt;${basedir}/src&lt;/sourceDirectory&gt;</code> Abschnitt <code>&lt;sourceDirectory&gt;${basedir}/src&lt;/sourceDirectory&gt;</code> </blockquote><p>  Wie Sie sehen, müssen Sie den Quellordner <code>/src</code> und den Ordner mit dem Ergebnis <code>/bin</code> direkt bestimmen.  Dies ist einerseits ein Minus, andererseits die Möglichkeit, ihren Standort zu ändern. </p><br><p>  Die gesamte minimalistische pom.xml für ein Einzelmodulprojekt, a la Hello world, lautet wie folgt: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-helloworld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> ```${basedir}/src<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sourceDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-wrapper<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span>1.12.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Bitte beachten Sie, dass die Verpackung des Projekts als <strong>mvn-golang bezeichnet ist</strong> .  Diese Konfiguration reicht aus, um die ausführbare Datei zu erstellen und sie auf der Grundlage der Quelltexte im Ordner src in den resultierenden bin-Ordner zu legen.  Der Go-Build-Cache wird auch im <code>/bin</code> (standardmäßig als <code>/bin/.goBuildCache</code> ) und mit diesem temporären Ordner mit clean gelöscht. </p><br><p>  In der <em>Installationsphase</em> wird die interne <code>mvninstall</code> Task <code>mvninstall</code> , die einfach das gesamte Projekt in ein Zip-Archiv packt und es als generiertes Artefakt im Maven-Repository ablegt.  Anfangs habe ich diese Artefakte nur gespeichert, aber ab Version 2.3.2 wurde ein Mechanismus hinzugefügt, der sie als Standard-Maven-Abhängigkeiten unterstützt, und es wurde möglich, Projekte mit "gemeinsamem" Code über das Maven-Repository zu entwickeln.  Es ist klar, dass das Einfügen der generierten binären Ergebnisse als Artefakte in das Repository aufgrund plattformübergreifender Anforderungen eine schlechte Idee ist und daher der Inhalt des Ordners <code>/bin</code> nicht in das Artefakt gepackt wird. </p><br><p>  Das Verbinden eines anderen Projekts mit dem Packen von <code>mvn-golang</code> als Maven-Abhängigkeit sieht ungefähr so ​​aus: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-go-test-mix-terminal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In Version 2.3.3 wurde Unterstützung für die Arbeit mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Go-</a> Mechanismus von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Modulen</a> hinzugefügt, diese ist jedoch standardmäßig nicht aktiviert (aus Gründen der Abwärtskompatibilität) und wird mithilfe des Konfigurationsparameters aktiviert: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">moduleMode</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">moduleMode</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Als sich der Mechanismus der Go-Module noch im experimentellen Stadium befand, fügte ich Unterstützung für die Arbeit mit Abhängigkeitsversionen durch direkte Aufrufe von CVS-Dienstprogrammen hinzu. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Testbeispiel</a> wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellt</a> .  Aber jetzt denke ich, dass ein solcher Mechanismus nicht mehr von großem Interesse ist und es rentabler ist, Standardabhängigkeiten durch Module zu verwenden.  Darüber hinaus kann das Plugin zum Zeitpunkt der <code>go.mod</code> des Projekts <code>go.mod</code> Dateien vorverarbeiten und die Pfade zu lokalen Ordnern ersetzen, wenn im Rahmen eines Projekts mit mehreren Modulen gearbeitet wird. </p><br><p>  Da Maven die Möglichkeit der Standardisierung mithilfe von Archetypen vorsieht, habe ich zwei Archetypen erstellt: </p><br><ul><li>  <em>com.igormaznitsa: mvn-golang-hello: 2.3.3</em> für einen einfachen Archetyp mit einem Modul </li><li>  <em>com.igormaznitsa: mvn-golang-hello-multi: 2.3.3</em> für ein Projekt mit mehreren Modulen und gemeinsam genutztem Quellcode </li></ul><br><p>  Ein Beispiel für die Arbeit mit dem Archetyp eines Einzelmodulprojekts ist in der folgenden Animation zu sehen <br><img src="https://habrastorage.org/webt/xj/l4/as/xjl4ashjm59in1djzr0hvsjqqkg.gif" alt="Bild">  . </p><br><p>  Sie können auch einfach das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt "Hello World"</a> klonen und herumspielen: </p><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/raydac/mvn-golang-example.git</code> </pre> <br><p><img src="https://habrastorage.org/webt/x6/d8/3f/x6d83f1hbq0ul2ewmrzgkdpg0eq.gif" alt="Bild"></p><br><p>  Oft stellt sich die vernünftige Frage: Warum ist das alles notwendig und welche Boni bringt der Einsatz von Maven beim Aufbau eines Go-Projekts?  Ich werde versuchen, es Punkt für Punkt zu beantworten: </p><br><ol><li>  Maven ist eine sehr ausgereifte, plattformübergreifende Projektbildungsumgebung, die von fast allen CI-Plattformen unterstützt wird, z. B. Jenkins. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mit Go2XUnit können</a> Sie Testergebnisse in das Format konvertieren, das von Berichts-Plugins angezeigt wird. </li><li>  Maven ist plattformübergreifend und wird von allen Betriebssystemen unterstützt, die in allen Repositorys enthalten sind.  Das Vorhandensein flexibel aktivierter Profile erleichtert die Anpassung des Prozesses für verschiedene Plattformen. </li><li>  Maven verfügt über eine <strong>RIESIGE Anzahl von Plugins</strong> , die es einfach machen, einen synergistischen Effekt zu erzielen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">indem beispielsweise Go und GWT kombiniert</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ANTLR</a> mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt verbunden</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Go basierend auf Protobuf-Deskriptoren generiert</a> und sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorverarbeitung hinzugefügt werden</a> .  All dies kann manuell über Batch-Dateien organisiert werden. Wenn es jedoch offiziell unterstützte Plugins gibt, ist es rentabler, diese zu verwenden. </li><li>  Das Projekt lässt sich leicht zwischen Maschinen und Plattformen portieren, und das Umschalten der GoSDK-Version erfolgt durch Ändern einer Zeile. </li><li>  Einfache Organisation von Projekten mit mehreren Modulen mit Trennung des Quellcodes durch das Maven-Repository. </li><li>  Das Tool ist Java-Entwicklern vertraut und vertraut, was ihre Anpassung beim Wechsel zur Entwicklung auf Golang oder bei der Entwicklung mehrsprachiger Go + Java-Lösungen erleichtert. </li><li>  In Umgebungen, die Maven unterstützen, besteht die Möglichkeit einer Pseudoentwicklung unter Go, auch wenn diese Plattform nicht unterstützt wird, z. B. in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NetBeans-IDE</a> . </li></ol><br><p>  Der größte Nachteil der Lösung ist meiner Meinung nach einer hier - eine begrenzte Anzahl von Entwicklern, die mit Maven in der Golang-Community vertraut sind.  Für diejenigen, die mit C / C ++ zu Golang gewechselt sind, ist es klar, dass es schwierig ist, etwas näheres und teureres zu finden, und niemand hat die "nativen" Go-Build-Systeme abgebrochen.  Mir ist aufgefallen, dass viele Entwickler aus irgendeinem Grund Plattformen nicht gerne mischen. </p><br><p>  Daher habe ich kurz eine Möglichkeit gezeigt, Maven bei der Entwicklung von Go-Projekten mit dem Plugin mvn-golang-wrapper zu verwenden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das Plugin-Projekt ist als OSS-Projekt konzipiert und auf GitHub veröffentlicht</a> .  Wenn jemand interessiert ist und es in seinen Projekten verwenden wird, zögern Sie nicht, Fragen zu stellen und "Fehler zu melden".  Ich habe versucht, eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reihe von Beispielen für verschiedene Anlässe</a> zu erstellen (bei denen das Plugin getestet wird), aber ich kann nicht alles abdecken. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Testbeispiele</a> im Plugin-Projekt verwenden die Dev-Version. Wenn Sie sie also nach dem Klonen des Projekts lokal erstellen möchten, müssen Sie zuerst die Dev-Version des Plugins mit dem Befehl im Projektstammverzeichnis erstellen: </p><br><pre> <code class="bash hljs">mvn install</code> </pre> <br><p>  <code>mvn-golang-examples</code> können Sie in jedes Teilprojekt von <code>mvn-golang-examples</code> und es mit erstellen </p><br><pre> <code class="bash hljs">mvn clean install</code> </pre> <br><p>  Sie können auch mit dem Erstellen aller Beispiele aus dem Stammverzeichnis des Projekts beginnen </p><br><pre> <code class="bash hljs">mvn clean install -Pexamples</code> </pre> <br><p>  Das Plugin unterstützt die Multithread-Assemblierung von Projekten und kann mithilfe des entsprechenden Arguments beschleunigt werden, z. B. in 6 Threads </p><br><pre> <code class="bash hljs">mvn clean install -Pexamples -T6</code> </pre> <br><p>  Während der Entwicklung hat das Projekt eine anständige Menge an "Schnickschnack" angesammelt, die ich in diesem kurzen Artikel nicht behandelt habe.  Informationen zu den Parametern mit kleinen Konfigurationsbeispielen finden Sie in der Mind Map dieses Plugins (die Quelldatei im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SciaReto-</a> Format finden Sie <a href="">hier</a> ): </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ro/yo/qr/royoqrdlvvlrwvjyiey5yigtnec.jpeg" alt="Bild"></a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465803/">https://habr.com/ru/post/de465803/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465791/index.html">Sicherheitslücken bei Einzelhändlern - drei Fälle, in denen OTP in der Anfrage abgerufen werden konnte</a></li>
<li><a href="../de465793/index.html">Frontend Weekly Digest (26. August - 1. September 2019)</a></li>
<li><a href="../de465795/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 378 (26. August - 1. September 2019)</a></li>
<li><a href="../de465797/index.html">Genetische Algorithmen (oder der Klient ist immer König - und oft ein Narr)</a></li>
<li><a href="../de465801/index.html">Food Design Digest, August 2019</a></li>
<li><a href="../de465805/index.html">Gigatron - ein hausgemachter Mikrocomputer ohne Prozessor</a></li>
<li><a href="../de465807/index.html">Die Geschichte, wie die beliebte JavaScript-Bibliothek begann, Anzeigen im Terminal anzuzeigen</a></li>
<li><a href="../de465809/index.html">Fallen Sie nicht in die Falle einer vorzeitigen Optimierung</a></li>
<li><a href="../de465811/index.html">14 Tipps zum Schreiben von sauberem React-Code. Teil 1</a></li>
<li><a href="../de465813/index.html">14 Tipps zum Schreiben von sauberem React-Code. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>