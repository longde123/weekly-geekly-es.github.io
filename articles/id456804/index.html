<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüíº üÜë üëÑ Ikuti uang: bagaimana grup RTM mulai menyembunyikan alamat server C & C di dompet crypto üÖ±Ô∏è üë®‚Äçüç≥ üåÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kelompok cybercriminal RTM telah mencuri uang dari pelanggan bank sejak 2015. Sebagian besar korbannya adalah perusahaan Rusia. Perangkat lunak berbah...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ikuti uang: bagaimana grup RTM mulai menyembunyikan alamat server C & C di dompet crypto</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bizone/blog/456804/"><p>  Kelompok cybercriminal RTM telah mencuri uang dari pelanggan bank sejak 2015. Sebagian besar korbannya adalah perusahaan Rusia.  Perangkat lunak berbahaya yang digunakan oleh penjahat dunia maya juga sering disebut sebagai RTM di komunitas keamanan informasi. </p><br><p>  Cukup banyak laporan teknis yang telah ditulis tentang program ini, yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menjelaskan secara</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rinci</a> mekanisme umum malware.  Dalam artikel ini, kami akan fokus pada metode untuk mendapatkan alamat server RTM pengelola (C&amp;C).  Dalam setiap iterasi program, penyerang mendekati tugas ini: mereka mendistribusikan alamat melalui blog, menggunakan sistem server DNS alternatif dan jaringan Tor.  Suatu hari, kami menemukan bahwa RTM mulai menyembunyikan IP dalam transaksi di dompet bitcoin. </p><a name="habracut"></a><br><h2 id="chto-takoe-rtm">  Apa itu RTM? </h2><br><p>  Pada intinya, RTM adalah trojan perbankan.  Tujuan utama dari program ini adalah untuk memungkinkan penyerang memanipulasi perintah pembayaran perusahaan korban untuk secara diam-diam mentransfer dana ke rekening penjahat cyber. </p><br><p>  Biasanya, RTM dikirim ke komputer korban melalui milis, lebih jarang melalui situs yang diretas (seperti publikasi berita) atau sumber daya palsu untuk akuntan.  Penjahat melampirkan file yang dapat dieksekusi yang dikemas ke surat.  Sebagai alat pengemasan, penyerang menggunakan pengembangan mereka sendiri dan arsip penggalian diri. <br><br><img src="https://habrastorage.org/webt/yx/om/zt/yxomztdq36c76jqytbtszywrmb4.png"><br>  <em>Contoh file executable .exe yang didistribusikan oleh grup RTM</em> <br><br>  File sampel pada gambar diatur dalam urutan distribusi.  Sebagian besar waktu, executable RTM dikemas dengan pengemas khusus dan disamarkan sebagai dokumen PDF.  Pada awal 2019, sampel pertama mulai muncul, yang merupakan arsip RAR yang mengekstraksi sendiri dan disamarkan sebagai file dalam format DOCX.  RTM saat ini didistribusikan sebagai arsip CAB yang mengekstraksi sendiri. <br><br> <a href=""><img src="https://habrastorage.org/webt/_j/74/zf/_j74zfs8mil30ygys31kqe6s2de.png"></a> <br>  <em>Representasi biner dari file "Pembayaran 11.06.exe"</em> <br><br>  Setelah memulai, file yang dapat dieksekusi menyalin DLL yang dikemas ke disk dan meluncurkannya menggunakan utilitas rundll32.exe.  Sebagai aturan, nama internal perpustakaan ini adalah core.dll.  Operasi selanjutnya terjadi di ruang alamat proses rundll32.exe. </p><br><p>  Ini core.dll yang menyediakan interaksi utama dengan server kontrol RTM, di mana program menerima perintah dan modul tambahan dari penyerang. </p><br><p>  Modul dikirimkan dalam bentuk terenkripsi dan dapat diluncurkan dengan berbagai cara.  Komponen-komponen ini memberikan kemampuan penyerang untuk mengontrol komputer dari jarak jauh, mengganti dokumen pembayaran dalam sistem 1C, dll. </p><br><h2 id="sposoby-nahozhdeniya-upravlyayuschego-servera">  Cara menemukan server manajemen </h2><br><h3 id="rss">  Umpan RSS </h3><br><p>  Dalam versi RTM pertama, umpan RSS digunakan untuk memperbarui alamat server kontrol.  Penyerang membuat blog di LiveJournal yang berisi alamat C&amp;C dalam bentuk terenkripsi.  Untuk mendapatkan alamat baru dari server kontrol, permintaan dikirim ke alamat hxxps: //.livejournal [.] Com / data / rss / dan respons diproses dalam format berikut (misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://f72bba81c921.livejournal.com/data/rss/</a> ) : <br><br> <a href=""><img src="https://habrastorage.org/webt/5u/m4/qo/5um4qobgrnukxcybwv8rw6qext0.png"></a> <br>  <em>Konten umpan RSS.</em>  <em>Bidang deskripsi berisi alamat terenkripsi dari server kontrol</em> <br><br> <a href=""><img src="https://habrastorage.org/webt/ct/j4/gf/ctj4gfv0ynnkkehxte5aoklhzbc.png"></a> <br>  <em>Baris yang didekripsi dengan alamat awal server pengelola dan alamat umpan RSS</em> </p><br><h3 id="bit">  .bit </h3><br><p>  Pada bulan Maret 2016, RTM mulai menggunakan domain di zona .bit sebagai alamat server kontrol.  Mereka didukung oleh pencatat DNS Namecoin alternatif berdasarkan teknologi blockchain.  Sistem ini terdesentralisasi, sehingga domain .bit sulit diblokir. </p><br><p>  Alamat IP server manajemen pada .bit RTM diperoleh dengan salah satu dari dua cara: </p><br><ul><li>  melalui API Browser Namecoin Block; </li><li>  melalui resolusi nama domain menggunakan server DNS khusus. </li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/ep/-s/dn/ep-sdnvmvh_kksp1y66mbzow6xm.png"></a> <br>  <em>Fungsi mendapatkan alamat IP dari server manajemen</em> <br><br>  Dalam fungsi mendapatkan alamat IP dari server kontrol melalui API browser Namecoin block, konten diproses di alamat hxxps: //namecoin.cyphrs [.] Com / api / name_show / d / stat-counter-7 (menggunakan stat-counter domain sebagai contoh -7 [.] Bit): <br><br> <a href=""><img src="https://habrastorage.org/webt/ru/4n/h6/ru4nh6y9tlovyvei-pkorkb1tgy.png"></a> <br>  <em>Fungsi mendapatkan alamat IP dari server kontrol melalui API browser blok Namecoin</em> <br><br>  Alamat IP server manajemen diperoleh dari badan respons.  Selain permintaan ke hxxps: //namecoin.cyphrs [.] Com / api / name_show / d /, penyerang juga menggunakan permintaan untuk hxxps: // namecha [.] Di / name / d /, memproses bidang "Nilai saat ini": <br><br> <a href=""><img src="https://habrastorage.org/webt/mx/8v/z4/mx8vz48xfaxt7bcswxfenlwjyzg.png"></a> <br>  <em>Konten halaman web di URL hxxps: // namecha [.] Di / name / d / stat-counter-7</em> <br><br>  Jika tidak mungkin mendapatkan alamat IP dengan cara ini, penyerang menyelesaikan nama domain dari server kontrol dengan fungsi DnsQuery_A menggunakan server DNS khusus (diambil, misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari sini</a> ). <br></p><p>  Menggunakan fungsi DnsQuery_A dalam kode pustaka core.dll terlihat seperti ini: <br><br> <a href=""><img src="https://habrastorage.org/webt/wj/6-/ai/wj6-aiarsn-jcqpa8sxjwgosjlk.png"></a> <br>  <em>Fungsi memperoleh alamat IP server manajemen melalui resolusi nama domain menggunakan server DNS khusus</em> <br><br>  Fungsi DnsQuery_A memiliki prototipe berikut: <br><br> <a href=""><img src="https://habrastorage.org/webt/iu/rr/9d/iurr9d6pt5cmdm0oz3vajjkfzzi.png"></a> <br>  <em>Prototipe fungsi DnsQuery_A dideklarasikan dalam file header WinDNS.h</em> <br><br>  Argumen ke-4 untuk fungsi DnsQuery_A adalah alamat dari struktur _IP4_ARRAY pada stack.  Ini berisi array alamat IP dari server DNS khusus: <br><br> <a href=""><img src="https://habrastorage.org/webt/jj/3q/ho/jj3qhorwwvf9bip77fm431ro4xg.png"></a> <br>  <em>Struktur _IP4_ARRAY pada stack</em> <br><br>  Jika fungsi DnsQuery_A berhasil dieksekusi, alamat IP server pengelola dapat diperoleh dengan membaca nilai berikut: pDnsRecord -&gt; Data.A.IpAddress. </p><br><p>  Itu dapat dilihat dari kode yang di-decompile dari salah satu instance yang menggunakan server DNS khusus 188.165 [.] 200.156 digunakan untuk menyelesaikan nama domain C&amp;C.  Dan jika terjadi kegagalan, daftar tiga server DNS digunakan: 91.217 [.] 137.37, 188.165 [.] 200.156, 217.12 [.] 210.54. </p><br><h3 id="tor">  Tor </h3><br><p>  Pada 15 Februari 2019, kami pertama kali menemukan sampel RTM yang server manajemennya terletak di jaringan Tor (hxxp: // 5aaw3unbkm5jqx7d [.] Bawang / indeks [.] Php). <br><br> <a href=""><img src="https://habrastorage.org/webt/e1/gy/cf/e1gycfr_b8cqznqlntjdr9n6myi.png"></a> <br>  <em>Alamat server manajemen Tor di antara string yang didekripsi</em> <br><br> <a href=""><img src="https://habrastorage.org/webt/jz/-z/ku/jz-zkujibvahyxxex-uhh7yc_4s.png"></a> <br>  <em>Bagian kode dibongkar di mana URL server kontrol diuraikan</em> <br><br>  Sampel semacam itu dikirim hingga 9 April 2019, setelah itu RTM kembali beralih menggunakan zona domain bit. </p><br><h3 id="bitkoyn">  Bitcoin </h3><br><p>  Pada 10 Juni 2019, kami menemukan sampel RTM yang menerima alamat IP server C&amp;C dari transaksi pada dompet kripto tertentu.  Setiap alamat IP disembunyikan dalam jumlah bitcoin yang terdaftar dalam dua transaksi. </p><br><p>  Untuk mendapatkan alamat IP, C&amp;C VPO membuat permintaan di hxxps: // chain [.] Jadi / api / v2 / get_tx_received / BTC /.  Responsnya berisi serangkaian transaksi ke akun crypto wallet.  Contoh ditunjukkan pada tangkapan layar: <br><br> <a href=""><img src="https://habrastorage.org/webt/6w/x3/tf/6wx3tf7-wsljmvslwhb5hhrmpde.png"></a> <br><br>  Pertimbangkan bagian kode di mana alamat IP server manajemen diperoleh: <br><br> <a href=""><img src="https://habrastorage.org/webt/nu/bt/p6/nubtp6f35wmgwqdqcvrp52_qhn8.png"></a> <br><br>  Fungsi FindValue mencari bagian pecahan dari jumlah transfer.  Pencarian dilakukan dari ujung buffer, dan dengan setiap panggilan fungsi berikutnya, data diproses, mulai dari indeks saat ini.  Yaitu, dengan panggilan beruntun ke fungsi FindValue, nilai 8483, 40030, 14728 dan seterusnya akan diperoleh.  Program ini menghasilkan dua alamat IP: setiap alamat disembunyikan dalam dua terjemahan berurutan. <br><br> <a href=""><img src="https://habrastorage.org/webt/kx/qd/vb/kxqdvbttrzbvjaoljqjttn7dg1s.png"></a> <br>  <em>Kode yang dibongkar untuk mendapatkan alamat IP dari transfer ke dompet crypto</em> <br><br>  Kode ini melakukan hal berikut: <br></p><pre><code class="python hljs">ip_address = str(value_1 &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span> + str(value_1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">0x8</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span> + str(value_0 &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span> + str(value_0 &gt;&gt; <span class="hljs-number"><span class="hljs-number">0x8</span></span>)</code> </pre> <br><p>  Yaitu, dengan mendaftarkan 0,00008483 BTC dan kemudian 0,00040030 BTC, para penyerang menyembunyikan alamat IP 94,156 [.] 35,33 untuk program mereka.  Demikian pula, dari dua transaksi sebelumnya, RTM memperoleh alamat IP kedua dari server manajemen. </p><br><p>  Dengan demikian, malware RTM sedang dikirim ke hari ini. </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Anda mungkin memperhatikan bahwa ketika mengatur transfer alamat server C&amp;C, RTM suka menggunakan pendekatan yang memungkinkan Anda mengubah IP secara dinamis tanpa mengubah kode sumber malware. </p><br><p>  Di satu sisi, ini membuat hidup lebih mudah bagi penyerang dan dapat menyebabkan analis tersesat.  Di sisi lain, ini memungkinkan spesialis untuk memprediksi alamat server kontrol sebelum surat berbahaya dilakukan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id456804/">https://habr.com/ru/post/id456804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id456782/index.html">Desain berorientasi model - bagaimana tidak mengulangi Chernobyl</a></li>
<li><a href="../id456790/index.html">Intisari berita PostgreSQL. Edisi No.16</a></li>
<li><a href="../id456792/index.html">Sebarkan Cluster Kubernetes di OpenStack dengan Kubespray</a></li>
<li><a href="../id456794/index.html">Arsitektur Web UI: Masa Lalu dari Kayu, Hadiah yang Aneh, dan Masa Depan yang Cerah</a></li>
<li><a href="../id456796/index.html">Svalbard - nama baru untuk proyek Have I Been Pwned sebelum dijual</a></li>
<li><a href="../id456806/index.html">Satu bot dari semua kekhawatiran</a></li>
<li><a href="../id456808/index.html">Cara Meningkatkan Kinerja Aplikasi Web Front-End: Lima Tips</a></li>
<li><a href="../id456810/index.html">Yang pertama. Kisah Bebas Tesla</a></li>
<li><a href="../id456812/index.html">Apa yang ada di ITMO University - festival IT, hackathons, konferensi, dan seminar terbuka</a></li>
<li><a href="../id456814/index.html">Pelajari Pemrograman Fungsional dalam Python dalam 10 Menit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>