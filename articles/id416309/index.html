<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌑 🕕 🤰🏽 Cara menggunakan file HDF5 dengan Python 🖖🏻 🤣 🎅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 

 Peluncuran kursus "Pengembang web dengan Python" semakin dekat, masing-masing, kami masih berbagi artikel menarik dan mengundang kam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara menggunakan file HDF5 dengan Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/416309/"> Halo semuanya! <br><br>  Peluncuran kursus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Pengembang web dengan Python" semakin</a> dekat, masing-masing, kami masih berbagi artikel menarik dan mengundang kami ke pelajaran terbuka kami, di mana Anda dapat menonton materi yang menarik, bertemu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">guru,</a> dan mengajukan pertanyaan kepada mereka. <br><br>  Ayo pergi! <br><br>  <i>HDF5 memungkinkan penyimpanan data dalam jumlah besar secara efisien</i> <br><br>  Ketika bekerja dengan volume data yang besar, baik eksperimental atau disimulasikan, menyimpannya dalam beberapa file teks tidak terlalu efisien.  Terkadang Anda perlu mengakses bagian data tertentu, dan Anda ingin melakukannya dengan cepat.  Dalam situasi ini, format HDF5 menyelesaikan kedua masalah berkat perpustakaan bawaan yang sangat dioptimalkan.  HDF5 banyak digunakan dalam lingkungan ilmiah dan memiliki implementasi yang sangat baik dalam Python yang dirancang untuk bekerja dengan NumPy. <br><br>  Format HDF5 mendukung file dalam ukuran apa pun, dan setiap file memiliki struktur internal yang memungkinkan Anda untuk mencari kumpulan data tertentu.  Ini dapat dianggap sebagai file terpisah dengan struktur hierarkisnya sendiri, serta seperangkat folder dan subfolder.  Secara default, data disimpan dalam format biner, dan perpustakaan kompatibel dengan berbagai jenis data.  Salah satu opsi paling penting untuk format HDF5 adalah ia memungkinkan Anda untuk melampirkan metadata ke setiap elemen struktur, membuatnya ideal untuk membuat file offline. <br><br><img src="https://habrastorage.org/webt/t9/ae/qu/t9aequcpmfwvbjckfxmnwcyevzo.png"><a name="habracut"></a><br>  Dalam Python, antarmuka dengan format HDF5 dapat dibangun menggunakan paket h5py.  Salah satu fitur paling menarik dari paket ini adalah bahwa data dibaca dari file hanya jika diperlukan.  Bayangkan Anda memiliki array yang sangat besar yang tidak sesuai dengan RAM yang tersedia.  Misalnya, Anda bisa membuat array di komputer dengan spesifikasi berbeda, tidak seperti yang Anda gunakan untuk analisis data.  Format HDF5 memungkinkan Anda memilih elemen array mana yang akan dibaca dengan sintaks yang setara dengan NumPy.  Kemudian Anda dapat bekerja dengan data yang disimpan di hard drive, dan bukan di RAM, tanpa perubahan signifikan pada kode yang ada. <br><br>  Pada artikel ini, kita akan melihat bagaimana Anda dapat menggunakan h5py untuk menyimpan dan mengambil data dari hard drive Anda.  Kami akan membahas berbagai cara menyimpan data dan cara mengoptimalkan proses membaca.  Semua contoh yang muncul dalam artikel ini juga tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori Github</a> kami. <br><br>  <b>Instalasi</b> <br><br>  Format HDF5 didukung oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Grup HDF</a> , dan didasarkan pada standar open source, yang berarti bahwa data Anda akan selalu tersedia, bahkan jika grup tersebut menghilang.  Dukungan python disediakan melalui paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">h5py</a> , yang dapat diinstal melalui pip.  Ingat bahwa Anda harus menggunakan lingkungan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">virtual</a> untuk pengujian: <br><br><pre><code class="bash hljs">pip install h5py</code> </pre> <br>  perintah ini juga akan menginstal NumPy jika tidak di lingkungan Anda. <br><br>  Jika Anda mencari alat grafis untuk memeriksa konten file HDF5 Anda, Anda dapat menginstal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HDF5 Viewer</a> .  Itu ditulis dalam Java, jadi itu harus bekerja di hampir semua komputer. <br><br>  <b>Penyimpanan dan pembacaan data dasar</b> <br><br>  Mari kita beralih ke menggunakan perpustakaan HDF5.  Kami akan membuat file baru dan menyimpan array NumPy acak ke dalamnya. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset = f.create_dataset(<span class="hljs-string"><span class="hljs-string">"default"</span></span>, data=arr)</code> </pre><br>  Beberapa baris pertama cukup sederhana: kita mengimpor paket h5py dan NumPy dan membuat array dengan nilai acak.  Kami membuka file random.hdf5 dengan izin tulis, yang berarti bahwa jika file dengan nama yang sama sudah ada, file itu akan ditimpa.  Jika Anda ingin menyimpan file dan masih bisa menulis ke sana, Anda dapat membukanya dengan atribut bukan w.  Kami membuat dataset yang disebut default dan mengatur data sebagai array acak yang dibuat sebelumnya.  Kumpulan data adalah pemelihara data kami, terutama blok bangunan format HDF5. <br><br>  <b>Sebuah catatan</b> <b><br></b> <br>  Jika Anda tidak terbiasa dengan pernyataan with, saya harus mencatat bahwa ini adalah cara yang mudah untuk membuka dan menutup file.  Bahkan jika kesalahan terjadi di dalam <code>with</code> , file akan ditutup.  Jika karena alasan tertentu Anda tidak menggunakannya, jangan pernah lupa menambahkan perintah <code>f.close()</code> di akhir.  Pernyataan <code>with</code> berfungsi dengan file apa pun, bukan hanya file HDF. <br><br>  Kita dapat membaca data dengan cara yang hampir sama dengan membaca file NumPy: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: data = f[<span class="hljs-string"><span class="hljs-string">'default'</span></span>] print(min(data)) print(max(data)) print(data[:<span class="hljs-number"><span class="hljs-number">15</span></span>])</code> </pre> <br>  Kami membuka file dengan atribut read r dan mengembalikan data dengan secara langsung mengakses set data yang disebut default.  Jika Anda membuka file dan tidak tahu set data mana yang tersedia, Anda bisa mendapatkannya: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f.keys(): print(key)</code> </pre> <br>  Setelah Anda membaca dataset yang Anda inginkan, Anda bisa menggunakannya seolah-olah Anda menggunakan array NumPy apa pun.  Misalnya, Anda dapat menemukan nilai maksimum dan minimum atau memilih 15 nilai pertama array.  Contoh-contoh sederhana ini, bagaimanapun, menyembunyikan banyak hal yang terjadi di bawah tenda, dan mereka perlu didiskusikan untuk memahami potensi penuh HDF5. <br><br>  Dalam contoh di atas, Anda bisa menggunakan data sebagai array.  Misalnya, Anda bisa merujuk ke elemen ketiga dengan memasukkan data [2], atau Anda bisa mendapatkan rentang nilai data [1: 3].  Harap dicatat: data bukan sebuah array, ini adalah kumpulan data.  Anda bisa melihatnya dengan mengetik <code>print(type(data))</code> .  Kumpulan data bekerja dengan cara yang sama sekali berbeda dari array, karena informasinya disimpan di hard drive, dan mereka tidak memuatnya ke dalam RAM jika kita tidak menggunakannya.  Kode berikut, misalnya, tidak akan berfungsi: <br><br><pre> <code class="python hljs">f = h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) data = f[<span class="hljs-string"><span class="hljs-string">'default'</span></span>] f.close() print(data[<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre><br>  Kesalahan yang muncul sedikit rumit, tetapi baris terakhir sangat berguna: <br><br><pre> <code class="bash hljs">ValueError: Not a dataset (not a dataset)</code> </pre> <br>  Kesalahan tersebut berarti bahwa kami mencoba mengakses dataset yang tidak lagi dapat kami akses.  Ini agak membingungkan, tetapi itu terjadi karena kami menutup file dan oleh karena itu kami tidak lagi diizinkan untuk mengakses nilai kedua dalam data.  Ketika kami menetapkan f ['default'] untuk data variabel, kami sebenarnya tidak membaca data dari file, sebaliknya kami membuat pointer ke tempat data berada di hard drive.  Di sisi lain, kode ini akan berfungsi: <br><br><pre> <code class="python hljs">f = h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) data = f[<span class="hljs-string"><span class="hljs-string">'default'</span></span>][:] f.close() print(data[<span class="hljs-number"><span class="hljs-number">10</span></span>])</code> </pre><br>  Harap dicatat bahwa satu-satunya perbedaan adalah bahwa kami menambahkan [:] setelah membaca dataset.  Banyak manual lain berkutat pada contoh-contoh seperti itu, bahkan tanpa menunjukkan potensi penuh format HDF5 dengan paket h5py.  Karena contoh yang telah kami periksa sejauh ini, Anda mungkin bertanya-tanya: mengapa menggunakan HDF5 jika menyimpan file NumPy memberi Anda fungsi yang sama?  Mari selami fitur-fitur format HDF5. <br><br>  <b>Pembacaan selektif dari file HDF5</b> <br><br>  Sejauh ini, kita telah melihat bahwa ketika kita membaca kumpulan data, kita belum membaca data dari disk, sebaliknya kita membuat tautan ke tempat tertentu pada hard disk.  Kita dapat melihat apa yang terjadi jika, misalnya, kita secara eksplisit membaca 10 elemen pertama dari kumpulan data: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: data_set = f[<span class="hljs-string"><span class="hljs-string">'default'</span></span>] data = data_set[:<span class="hljs-number"><span class="hljs-number">10</span></span>] print(data[<span class="hljs-number"><span class="hljs-number">1</span></span>]) print(data_set[<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre><br>  Kami membagi kode menjadi baris yang berbeda untuk membuatnya lebih eksplisit, tetapi Anda bisa lebih sintetis dalam proyek Anda.  Pada baris di atas, pertama-tama kita membaca file dan kemudian membaca dataset default.  Kami menetapkan 10 elemen pertama dari set data ke variabel data.  Setelah menutup file (saat berakhir), kita dapat mengakses nilai yang disimpan dalam data, tetapi data_set akan menimbulkan kesalahan.  Perhatikan bahwa kita hanya membaca dari disk ketika kita secara eksplisit mengakses 10 elemen pertama dari kumpulan data.  Jika Anda melihat tipe data dan tipe data, Anda akan melihat bahwa mereka sangat berbeda.  Yang pertama adalah array NumPy, dan yang kedua adalah h5py DataSet. <br><br>  Perilaku yang sama relevan dalam skenario yang lebih kompleks.  Mari kita buat file baru, kali ini dengan dua set data, dan mari kita pilih elemen salah satunya berdasarkan elemen yang lain.  Mari kita mulai dengan membuat file baru dan menyimpan data;  bagian ini adalah yang paling sederhana: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np arr1 = np.random.randn(<span class="hljs-number"><span class="hljs-number">10000</span></span>) arr2 = np.random.randn(<span class="hljs-number"><span class="hljs-number">10000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'complex_read.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: f.create_dataset(<span class="hljs-string"><span class="hljs-string">'array_1'</span></span>, data=arr1) f.create_dataset(<span class="hljs-string"><span class="hljs-string">'array_2'</span></span>, data=arr2)</code> </pre> <br>  Kami memiliki dua dataset yang disebut array_1 dan array_2, yang masing-masing berisi array NumPy acak.  Kami ingin membaca nilai array_2 yang sesuai dengan elemen di mana nilai array_1 positif.  Kita dapat mencoba melakukan sesuatu seperti ini: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'complex_read.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d1 = f[<span class="hljs-string"><span class="hljs-string">'array_1'</span></span>] d2 = f[<span class="hljs-string"><span class="hljs-string">'array_2'</span></span>] data = d2[d1&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre><br>  tapi itu tidak akan berhasil.  d1 adalah kumpulan data dan tidak dapat dibandingkan dengan integer.  Satu-satunya cara adalah dengan benar-benar membaca data dari disk, dan kemudian membandingkannya.  Karena itu, kami mendapatkan sesuatu seperti ini: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'complex_read.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d1 = f[<span class="hljs-string"><span class="hljs-string">'array_1'</span></span>] d2 = f[<span class="hljs-string"><span class="hljs-string">'array_2'</span></span>] data = d2[d1[:]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre> <br>  Kumpulan data pertama d1 sepenuhnya dimuat ke dalam memori saat kita melakukan d1 [:], tetapi dari kumpulan data kedua d2 kita hanya mengambil beberapa elemen.  Jika dataset d1 terlalu besar untuk dimuat ke dalam memori sepenuhnya, kita bisa bekerja di dalam satu loop. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'complex_read.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d1 = f[<span class="hljs-string"><span class="hljs-string">'array_1'</span></span>] d2 = f[<span class="hljs-string"><span class="hljs-string">'array_2'</span></span>] data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(d1)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> d1[i] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: data.append(d2[i]) print(<span class="hljs-string"><span class="hljs-string">'The length of data with a for loop: {}'</span></span>.format(len(data)))</code> </pre> <br>  Tentu saja, ada masalah dengan efisiensi membaca itemwise dan menambahkan item ke daftar, tetapi ini adalah contoh yang sangat baik dari salah satu keuntungan terbesar menggunakan HDF5 atas teks atau file NumPy.  Di dalam loop, kami hanya memuat satu elemen ke dalam memori.  Dalam contoh kami, setiap elemen hanyalah angka, tetapi bisa berupa apa saja: dari teks ke gambar atau video. <br><br>  Seperti biasa, tergantung pada aplikasi Anda, Anda harus memutuskan apakah Anda ingin membaca seluruh array ke dalam memori atau tidak.  Kadang-kadang Anda menjalankan simulasi pada komputer tertentu dengan jumlah memori yang besar, tetapi Anda tidak memiliki karakteristik yang sama pada laptop Anda, dan Anda dipaksa untuk membaca bagian data Anda.  Ingat bahwa membaca dari hard drive relatif lambat, terutama jika Anda menggunakan HDD, bukan disk SDD atau bahkan lebih lama jika Anda membaca dari drive jaringan. <br><br>  <b>Secara selektif menulis ke file HDF5</b> <br><br>  Dalam contoh di atas, kami menambahkan data ke dataset segera setelah itu dibuat.  Namun, untuk banyak aplikasi Anda perlu menyimpan data selama pembuatan.  HDF5 memungkinkan Anda menyimpan data dengan cara yang sama seperti saat Anda membacanya.  Mari kita lihat cara membuat dataset kosong dan menambahkan beberapa data ke dalamnya. <br><br><pre> <code class="python hljs">arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset = f.create_dataset(<span class="hljs-string"><span class="hljs-string">"default"</span></span>, (<span class="hljs-number"><span class="hljs-number">1000</span></span>,)) dset[<span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>] = arr[<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">60</span></span>]</code> </pre> <br>  Dua baris pertama sama dengan sebelumnya, kecuali untuk <code>create_dataset</code> .  Kami tidak menambahkan data saat membuatnya, kami hanya membuat set data kosong yang dapat menampung hingga 1000 elemen.  Dengan logika yang sama seperti sebelumnya, ketika kita membaca elemen-elemen tertentu dari kumpulan data, kita sebenarnya menulis ke disk hanya ketika kita memberikan nilai pada elemen-elemen tertentu dari variabel dset.  Dalam contoh di atas, kami hanya menetapkan nilai ke subset array, dengan indeks dari 10 hingga 19. <br><br>  <b><i>Peringatan</i></b> <br><br>  Tidak sepenuhnya benar apa yang Anda tulis ke disk saat Anda menetapkan nilai ke set data.  Momen yang tepat tergantung pada beberapa faktor, termasuk keadaan sistem operasi.  Jika program ditutup terlalu cepat, itu mungkin terjadi bahwa tidak semuanya akan direkam.  Sangat penting untuk selalu menggunakan metode <code>close()</code> , dan jika Anda menulis secara bertahap, Anda juga dapat menggunakan <code>flush()</code> untuk memaksa entri.  Menggunakan dengan mencegah banyak masalah penulisan. <br><br>  Jika Anda membaca file dan mencetak 20 nilai pertama dari kumpulan data, Anda akan melihat bahwa semuanya nol, kecuali indeks 10 hingga 19. Ada kesalahan umum yang dapat menyebabkan sakit kepala yang nyata.  Kode berikut tidak akan menyimpan apa pun ke disk: <br><br><pre> <code class="python hljs">arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'random.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset = f.create_dataset(<span class="hljs-string"><span class="hljs-string">"default"</span></span>, (<span class="hljs-number"><span class="hljs-number">1000</span></span>,)) dset = arr</code> </pre> <br>  Kesalahan ini selalu menyebabkan banyak masalah, karena Anda tidak akan mengerti bahwa Anda tidak menulis apa pun sampai Anda mencoba membaca hasilnya.  Masalahnya di sini adalah bahwa Anda tidak menentukan di mana Anda ingin menyimpan data, Anda hanya menimpa variabel dset dengan array NumPy.  Karena dataset dan array memiliki panjang yang sama, Anda harus menggunakan dset [:] = arr.  Kesalahan ini terjadi lebih sering daripada yang Anda pikirkan, dan karena secara teknis tidak salah, Anda tidak akan melihat kesalahan yang ditampilkan pada terminal, dan data Anda akan nol. <br><br>  Sampai sekarang, kami selalu bekerja dengan array satu dimensi, tetapi kami tidak terbatas pada mereka.  Sebagai contoh, misalkan kita ingin menggunakan array 2D, kita bisa melakukannya: <br><br><pre> <code class="python hljs">dset = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, (<span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>))</code> </pre> <br>  yang memungkinkan kita untuk menyimpan data dalam array 500x1024.  Untuk menggunakan dataset, kita dapat menggunakan sintaksis yang sama seperti sebelumnya, tetapi dengan mempertimbangkan dimensi kedua: <br><br><pre> <code class="python hljs">dset[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span> dset[<span class="hljs-number"><span class="hljs-number">200</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>:<span class="hljs-number"><span class="hljs-number">1024</span></span>] = <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre> <br>  <b>Tentukan tipe data untuk mengoptimalkan ruang</b> <br><br>  Sejauh ini, kami hanya memeriksa ujung gunung es dari apa yang ditawarkan HDF5.  Selain panjang data yang ingin Anda simpan, Anda dapat menentukan tipe data untuk mengoptimalkan ruang.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dokumentasi h5py</a> berisi daftar semua jenis yang didukung, di sini kami hanya menampilkan beberapa dari mereka.  Pada saat yang sama, kami akan bekerja dengan beberapa set data dalam satu file. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'several_datasets.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset_int_1 = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'integers'</span></span>, (<span class="hljs-number"><span class="hljs-number">10</span></span>, ), dtype=<span class="hljs-string"><span class="hljs-string">'i1'</span></span>) dset_int_8 = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'integers8'</span></span>, (<span class="hljs-number"><span class="hljs-number">10</span></span>, ), dtype=<span class="hljs-string"><span class="hljs-string">'i8'</span></span>) dset_complex = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'complex'</span></span>, (<span class="hljs-number"><span class="hljs-number">10</span></span>, ), dtype=<span class="hljs-string"><span class="hljs-string">'c16'</span></span>) dset_int_1[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">1200</span></span> dset_int_8[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">1200.1</span></span> dset_complex[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">4j</span></span></code> </pre><br>  Dalam contoh di atas, kami membuat tiga set data yang berbeda, masing-masing memiliki tipe yang berbeda.  Bilangan bulat 1 byte, bilangan bulat 8 byte, dan bilangan kompleks 16 byte.  Kami hanya menyimpan satu nomor, meskipun set data kami dapat berisi hingga 10 elemen.  Anda dapat membaca nilai dan melihat apa yang sebenarnya disimpan.  Perlu dicatat di sini bahwa bilangan bulat dari 1 byte harus dibulatkan menjadi 127 (bukan 1200), dan bilangan bulat 8 byte harus dibulatkan menjadi 1200 (bukannya 1200.1). <br><br>  Jika Anda pernah memprogram dalam bahasa seperti C atau Fortran, Anda mungkin tahu apa arti berbagai tipe data.  Namun, jika Anda selalu bekerja dengan Python, Anda mungkin tidak mengalami masalah tanpa secara eksplisit menyatakan jenis data yang Anda kerjakan.  Penting untuk diingat bahwa jumlah byte memberitahu Anda berapa banyak angka berbeda yang dapat Anda simpan.  Jika Anda menggunakan 1 byte, Anda memiliki 8 bit, dan karenanya Anda dapat menyimpan 2 ^ 8 angka yang berbeda.  Dalam contoh di atas, bilangan bulat keduanya positif, negatif, dan 0. Ketika Anda menggunakan bilangan bulat dari 1 byte, Anda dapat menyimpan nilai dari -128 hingga 127, totalnya adalah 2 ^ 8 angka yang mungkin.  Ini setara dengan menggunakan 8 byte, tetapi dengan berbagai angka. <br><br>  Jenis data yang dipilih akan memengaruhi ukurannya.  Pertama, mari kita lihat bagaimana ini bekerja dengan contoh sederhana.  Mari kita membuat tiga file, masing-masing dengan satu set data untuk 100.000 elemen, tetapi dengan tipe data yang berbeda.  Kami akan menyimpan data yang sama di dalamnya, dan kemudian membandingkan ukurannya.  Kami membuat larik acak untuk penugasan ke setiap set data untuk mengisi memori.  Ingat bahwa data akan dikonversi ke format yang ditentukan dalam kumpulan data. <br><br><pre> <code class="python hljs">arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">100000</span></span>) f = h5py.File(<span class="hljs-string"><span class="hljs-string">'integer_1.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100000</span></span>,), dtype=<span class="hljs-string"><span class="hljs-string">'i1'</span></span>) d[:] = arr f.close() f = h5py.File(<span class="hljs-string"><span class="hljs-string">'integer_8.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100000</span></span>,), dtype=<span class="hljs-string"><span class="hljs-string">'i8'</span></span>) d[:] = arr f.close() f = h5py.File(<span class="hljs-string"><span class="hljs-string">'float.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100000</span></span>,), dtype=<span class="hljs-string"><span class="hljs-string">'f16'</span></span>) d[:] = arr f.close()</code> </pre> <br>  Ketika Anda memeriksa ukuran setiap file, Anda akan mendapatkan sesuatu seperti: <br><br><table><tbody><tr><th>  File </th><th>  Ukuran (b) </th></tr><tr><td>  integer_1 </td><td>  102144 </td></tr><tr><td>  integer_9 </td><td>  802144 </td></tr><tr><td>  mengapung </td><td>  1602144 </td></tr></tbody></table><br>  Hubungan antara ukuran dan tipe data jelas.  Ketika Anda beralih dari integer dari 1 byte ke sebanyak 8 byte, ukuran file meningkat 8 kali, demikian pula, ketika Anda pergi ke 16 byte, dibutuhkan sekitar 16 kali lebih banyak ruang.  Tetapi ruang bukan satu-satunya faktor penting untuk dipertimbangkan, Anda juga harus mempertimbangkan waktu yang diperlukan untuk menulis data ke disk.  Semakin banyak Anda harus menulis, semakin lama waktu yang dibutuhkan.  Tergantung pada aplikasi Anda, mungkin penting untuk mengoptimalkan pembacaan dan penulisan data. <br><br>  Harap dicatat: jika Anda menggunakan tipe data yang salah, Anda juga dapat kehilangan informasi.  Misalnya, jika Anda memiliki bilangan bulat 8 byte, dan Anda menyimpannya sebagai bilangan bulat 1 byte, nilainya akan terpotong.  Saat bekerja di laboratorium, perangkat yang membuat berbagai jenis data sering tersedia.  Beberapa kartu DAQ memiliki 16 bit, beberapa kamera bekerja dengan 8 bit, tetapi beberapa di antaranya dapat bekerja dengan 24 bit. Penting untuk memperhatikan tipe data, tetapi ini juga sesuatu yang mungkin tidak dipertimbangkan oleh pengembang Python, karena Anda tidak perlu nyatakan tipe. <br><br>  Menarik juga untuk diingat bahwa array NumPy default akan mengapung dengan 8 byte (64 bit) per elemen.  Ini bisa menjadi masalah jika, misalnya, Anda menginisialisasi array dengan nol untuk menyimpan data, yang seharusnya hanya 2 byte.  Jenis array itu sendiri tidak akan berubah, dan jika Anda menyimpan data saat membuat kumpulan data (menambahkan data = my_array), maka format default akan menjadi "f8", yang merupakan array, tetapi bukan data nyata, <br><br>  Memikirkan tipe data bukanlah sesuatu yang terjadi secara teratur jika Anda bekerja dengan Python dalam aplikasi sederhana.  Namun, Anda harus menyadari bahwa tipe data ada dan apa dampaknya terhadap hasil Anda.  Anda mungkin memiliki hard drive besar dan Anda tidak terlalu peduli dengan penyimpanan file, tetapi ketika Anda peduli dengan kecepatan penyimpanan Anda, tidak ada cara lain selain mengoptimalkan setiap aspek kode Anda, termasuk tipe data. <br><br>  <b>Kompresi data</b> <br><br>  Saat menyimpan data, Anda dapat memilih kompresi menggunakan algoritma yang berbeda.  Paket h5py mendukung beberapa filter kompresi, seperti GZIP, LZF, dan SZIP.  Saat menggunakan salah satu filter kompresi, data akan diproses dalam perjalanan ke disk, dan setelah membacanya akan dibongkar.  Karenanya, tidak ada perubahan khusus dalam kode.  Kami dapat mengulangi percobaan yang sama, menyimpan berbagai jenis data, tetapi menggunakan filter kompresi.  Kode kami terlihat seperti ini: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">100000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'integer_1_compr.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100000</span></span>,), dtype=<span class="hljs-string"><span class="hljs-string">'i1'</span></span>, compression=<span class="hljs-string"><span class="hljs-string">"gzip"</span></span>, compression_opts=<span class="hljs-number"><span class="hljs-number">9</span></span>) d[:] = arr <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'integer_8_compr.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100000</span></span>,), dtype=<span class="hljs-string"><span class="hljs-string">'i8'</span></span>, compression=<span class="hljs-string"><span class="hljs-string">"gzip"</span></span>, compression_opts=<span class="hljs-number"><span class="hljs-number">9</span></span>) d[:] = arr <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'float_compr.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100000</span></span>,), dtype=<span class="hljs-string"><span class="hljs-string">'f16'</span></span>, compression=<span class="hljs-string"><span class="hljs-string">"gzip"</span></span>, compression_opts=<span class="hljs-number"><span class="hljs-number">9</span></span>) d[:] = arr</code> </pre> <br>  Kami memilih gzip karena didukung di semua platform.  Opsi compression_opts menentukan tingkat kompresi.  Semakin tinggi level, semakin sedikit ruang yang dibutuhkan data, tetapi semakin lama prosesor harus bekerja.  Level kompresi default adalah 4. Kita dapat melihat perbedaan dalam file kita berdasarkan pada level kompresi: <br><br><table><tbody><tr><th>  Jenis </th><th>  Tidak ada kompresi </th><th>  Kompresi 9 </th><th>  Kompresi 4 </th></tr><tr><td>  integer_1 </td><td>  102144 </td><td>  28016 </td><td>  30463 </td></tr><tr><td>  integer_8 </td><td>  802144 </td><td>  43329 </td><td>  57971 </td></tr><tr><td>  mengapung </td><td>  1602144 </td><td>  1469580 </td><td>  1469868 </td></tr></tbody></table><br>  Efek kompresi pada seluruh array data jauh lebih terlihat daripada pada dataset floating point.  Saya serahkan kepada Anda untuk mencari tahu mengapa kompresi bekerja dengan sangat baik dalam dua kasus pertama, tetapi tidak pada yang terakhir.  Sebagai petunjuk: Anda harus memeriksa data apa yang sebenarnya Anda simpan. <br><br>  Membaca data yang dikompresi tidak mengubah kode yang dijelaskan di atas.  Pustaka inti HDF5 akan menjaga ekstraksi data dari kumpulan data terkompresi menggunakan algoritma yang sesuai.  Karenanya, jika Anda menerapkan kompresi untuk menyimpan, Anda tidak perlu mengubah kode yang Anda gunakan untuk membaca. <br><br>  Kompresi data adalah alat tambahan yang harus Anda pertimbangkan bersama dengan semua aspek lain dari pemrosesan data.  Anda harus mempertimbangkan waktu prosesor tambahan dan rasio kompresi yang efektif untuk mengevaluasi manfaat kompresi data dalam aplikasi Anda sendiri.  Fakta bahwa transparan untuk kode hilir membuatnya sangat mudah untuk menguji dan menemukan solusi terbaik. <br><br>  <b>Ubah ukuran Kumpulan Data</b> <br><br>  Saat Anda mengerjakan percobaan, terkadang tidak mungkin untuk mengetahui seberapa besar data Anda.  Bayangkan Anda sedang merekam film, mungkin Anda akan menghentikannya setelah satu detik, mungkin setelah satu jam.  Untungnya, HDF5 memungkinkan Anda untuk mengubah ukuran dataset dengan cepat dengan sedikit biaya komputasi.  Panjang kumpulan data dapat dilampaui hingga ukuran maksimum.  Ukuran maksimum ini ditentukan saat membuat dataset menggunakan kata kunci maxshape: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'resize_dataset.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">100</span></span>, ), maxshape=(<span class="hljs-number"><span class="hljs-number">500</span></span>, )) d[:<span class="hljs-number"><span class="hljs-number">100</span></span>] = np.random.randn(<span class="hljs-number"><span class="hljs-number">100</span></span>) d.resize((<span class="hljs-number"><span class="hljs-number">200</span></span>,)) d[<span class="hljs-number"><span class="hljs-number">100</span></span>:<span class="hljs-number"><span class="hljs-number">200</span></span>] = np.random.randn(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'resize_dataset.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset = f[<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>] print(dset[<span class="hljs-number"><span class="hljs-number">99</span></span>]) print(dset[<span class="hljs-number"><span class="hljs-number">199</span></span>])</code> </pre><br>  Pertama, Anda membuat dataset untuk menyimpan 100 nilai dan mengatur ukuran maksimum menjadi 500 nilai.  Setelah Anda menyimpan kumpulan nilai pertama, Anda dapat memperluas kumpulan data untuk menyimpan 100 nilai berikutnya. Anda dapat mengulangi prosedur sampai Anda mendapatkan kumpulan data dengan 500 nilai.        ,   N-    .   ,     ,         . <br><br>           ,        ,    . ,    -  (   ,      ,     ): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'resize_dataset.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset = f[<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>] dset.resize((<span class="hljs-number"><span class="hljs-number">300</span></span>,)) dset[:<span class="hljs-number"><span class="hljs-number">200</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span> dset[<span class="hljs-number"><span class="hljs-number">200</span></span>:<span class="hljs-number"><span class="hljs-number">300</span></span>] = np.random.randn(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'resize_dataset.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: dset = f[<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>] print(dset[<span class="hljs-number"><span class="hljs-number">99</span></span>]) print(dset[<span class="hljs-number"><span class="hljs-number">199</span></span>]) print(dset[<span class="hljs-number"><span class="hljs-number">299</span></span>])</code> </pre> <br>       ,     ,    200           200  299.       ,   ,  . <br><br> ,    ,    ,     .    2D-,     ,   —   ,    2D-.       3-    HDF-,        .            ,    : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'movie_dataset.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d = f.create_dataset(<span class="hljs-string"><span class="hljs-string">'dataset'</span></span>, (<span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), maxshape=(<span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> )) d[:,:,<span class="hljs-number"><span class="hljs-number">0</span></span>] = first_frame d.resize((<span class="hljs-number"><span class="hljs-number">1024</span></span>,<span class="hljs-number"><span class="hljs-number">1024</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)) d[:,:,<span class="hljs-number"><span class="hljs-number">1</span></span>] = second_frame</code> </pre> <br>       1024x1024 ,        .  ,      ,          .     maxshape    None. <br><br> <b>   (Chunks)</b> <br><br>    ,     .   (chunk)          , ..     .    ,    ,     .     ,  : <br><br><pre> <code class="python hljs">dset = f.create_dataset(<span class="hljs-string"><span class="hljs-string">"chunked"</span></span>, (<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>), chunks=(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>))</code> </pre><br>   ,     dset [0: 100,0: 100]   .     dset [200: 300, 200: 300], dset [100: 200, 400: 500]  . .  h5py,        : <br><br>     (Chunking)    .        10 KiB  1 MiB,      .    ,        ,     . <br><br>       (auto-chunking),      .     ,      maxshape.     : <br><br><pre> <code class="python hljs">dset = f.create_dataset(<span class="hljs-string"><span class="hljs-string">"autochunk"</span></span>, (<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>), chunks=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br> <b>   (Groups)</b> <br><br>         .          HDF5,    ,     .        (groups),     ,   .     ,       : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: g = f.create_group(<span class="hljs-string"><span class="hljs-string">'Base_Group'</span></span>) gg = g.create_group(<span class="hljs-string"><span class="hljs-string">'Sub_Group'</span></span>) d = g.create_dataset(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, data=arr) dd = gg.create_dataset(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, data=arr)</code> </pre> <br>    Base_Group     ,  Sub_Group.         default      .    ,  ,   : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: d = f[<span class="hljs-string"><span class="hljs-string">'Base_Group/default'</span></span>] dd = f[<span class="hljs-string"><span class="hljs-string">'Base_Group/Sub_Group/default'</span></span>] print(d[<span class="hljs-number"><span class="hljs-number">1</span></span>]) print(dd[<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre><br>    ,            : Base_Group/default  Base_Group/Sub_Group/default.    , ,   ,    ,     .    —  keys(): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f.keys(): print(k)</code> </pre> <br> ,      ,       for-.      ,     .     visit(), : <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_all</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name)</span></span></span><span class="hljs-function">:</span></span> print(name) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: f.visit(get_all)</code> </pre> <br>  ,     <code>get_all</code> ,    , name.     visit,        <code>get_all.</code> visit     ,      ,   None,    . , ,       Sub_Group,    <code>get_all</code> : <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_all</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'Sub_Group'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> name: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: g = f.visit(get_all) print(g)</code> </pre><br>  visit    ,     ,    None,     ,   get_all.    Sub_Group,   get_all   ,    Sub_Group    .   ,  g  ,      ,   : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: g_name = f.visit(get_all) group = f[g_name]</code> </pre> <br>         .   —  ,  visititems,      : name  object.   : <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_objects</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name, obj)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'Sub_Group'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> name: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> obj <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: group = f.visititems(get_objects) data = group[<span class="hljs-string"><span class="hljs-string">'default'</span></span>] print(<span class="hljs-string"><span class="hljs-string">'First data element: {}'</span></span>.format(data[<span class="hljs-number"><span class="hljs-number">0</span></span>]))</code> </pre><br>     visititems   ,         ,  ,     .   ,    ,   .       . ,    ,         . <br><br> <b>   HDF5</b> <br><br>   ,     HDF5,    ,       .    ,  , ,   ,  ,     ,  ..    . ,     ,     200x300x250. ,  ,   ,    ,   — ,      . <br><br>     HDF5    -.          . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os arr = np.random.randn(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: g = f.create_group(<span class="hljs-string"><span class="hljs-string">'Base_Group'</span></span>) d = g.create_dataset(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, data=arr) g.attrs[<span class="hljs-string"><span class="hljs-string">'Date'</span></span>] = time.time() g.attrs[<span class="hljs-string"><span class="hljs-string">'User'</span></span>] = <span class="hljs-string"><span class="hljs-string">'Me'</span></span> d.attrs[<span class="hljs-string"><span class="hljs-string">'OS'</span></span>] = os.name <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> g.attrs.keys(): print(<span class="hljs-string"><span class="hljs-string">'{} =&gt; {}'</span></span>.format(k, g.attrs[k])) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> d.attrs.keys(): print(<span class="hljs-string"><span class="hljs-string">'{} =&gt; {}'</span></span>.format(j, d.attrs[j]))</code> </pre> <br>       ,  attrs   .  ,        ,     .      ,     .     ,   ,        ,    update: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: g = f.create_group(<span class="hljs-string"><span class="hljs-string">'Base_Group'</span></span>) d = g.create_dataset(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, data=arr) metadata = {<span class="hljs-string"><span class="hljs-string">'Date'</span></span>: time.time(), <span class="hljs-string"><span class="hljs-string">'User'</span></span>: <span class="hljs-string"><span class="hljs-string">'Me'</span></span>, <span class="hljs-string"><span class="hljs-string">'OS'</span></span>: os.name,} f.attrs.update(metadata) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f.attrs.keys(): print(<span class="hljs-string"><span class="hljs-string">'{} =&gt; {}'</span></span>.format(m, f.attrs[m]))</code> </pre><br> ,   ,  hdf5, . ,   .        hdf5,    .  Python     -.          JSON,        ,     ,  ,  pickle. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups_dict.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: g = f.create_group(<span class="hljs-string"><span class="hljs-string">'Base_Group'</span></span>) d = g.create_dataset(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, data=arr) metadata = {<span class="hljs-string"><span class="hljs-string">'Date'</span></span>: time.time(), <span class="hljs-string"><span class="hljs-string">'User'</span></span>: <span class="hljs-string"><span class="hljs-string">'Me'</span></span>, <span class="hljs-string"><span class="hljs-string">'OS'</span></span>: os.name,} m = g.create_dataset(<span class="hljs-string"><span class="hljs-string">'metadata'</span></span>, data=json.dumps(metadata))</code> </pre><br>   ,      .        ,   .    ,   json.dumps,      .    ,     HDF5.    ,              json.loads: <br><br>  Python <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> h5py.File(<span class="hljs-string"><span class="hljs-string">'groups_dict.hdf5'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: metadata = json.loads(f[<span class="hljs-string"><span class="hljs-string">'Base_Group/metadata'</span></span>][()]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> metadata: print(<span class="hljs-string"><span class="hljs-string">'{} =&gt; {}'</span></span>.format(k, metadata[k]))</code> </pre> <br>    json    ,    .     YAML, XML  ..    ,   ,   ,     attr  , ,     . <br><br> <b>   HDF5</b> <br><br>        ,            . ,     ,    ,      .      HDF  ,   ,  ,          ,   ,    .  ,  HDF        . <br><br>  HDF5        .        ,      ,    .         ,      . .      SQL,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HDFql</a> ,    SQL      HDF5. <br><br>            .      , , -   ,  ,    .        ,     .  ,    ,            . <br><br> HDF5 —  ,       .    ,  ,      ,    ,        . HDF5 —  ,         ,     . <br><br>  AKHIR <br><br>    ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> </a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id416309/">https://habr.com/ru/post/id416309/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id416299/index.html">Orang-orang telah melacak gletser di Islandia selama beberapa dekade; Sekarang tekniknya akan melakukannya</a></li>
<li><a href="../id416301/index.html">Navigasi dalam aplikasi Android menggunakan koordinator</a></li>
<li><a href="../id416303/index.html">Menciptakan pemicu pertama</a></li>
<li><a href="../id416305/index.html">Standardisasi adalah petualangan Internet of Things terpanjang</a></li>
<li><a href="../id416307/index.html">iOS 12: baru dalam notifikasi</a></li>
<li><a href="../id416313/index.html">Daftar Periksa Analisis Log Kejadian Keamanan</a></li>
<li><a href="../id416315/index.html">ASP.NET Razor: Memecahkan Beberapa Masalah Arsitektur untuk Model Tampilan</a></li>
<li><a href="../id416319/index.html">Latar belakang: daftar putih IMEI dan Rossvyaz</a></li>
<li><a href="../id416321/index.html">Bagaimana menjadi pembicara dalam konferensi IT internasional</a></li>
<li><a href="../id416323/index.html">Opsi akses acak ke pengaturan dan rekaman registrar mobil dari mana saja di Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>