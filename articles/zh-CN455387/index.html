<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙🏼 🧜🏾 🏻 了解弹性堆栈中的机器学习（又名Elasticsearch，又名ELK） 🔋 🧓🏼 ✂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="回想一下，Elastic Stack基于非关系型Elasticsearch数据库，Kibana Web界面和数据收集器（最著名的Logstash，各种Beats，APM等）。 使用机器学习算法进行数据分析是对整个列出的产品堆栈的不错补充之一。 在本文中，我们了解了这些算法是什么。 我们要猫。 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>了解弹性堆栈中的机器学习（又名Elasticsearch，又名ELK）</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/455387/"><img src="https://habrastorage.org/webt/4b/oc/7b/4boc7b0gi2q5fu6pjwtfqqjejsu.png"><br><br> 回想一下，Elastic Stack基于非关系型Elasticsearch数据库，Kibana Web界面和数据收集器（最著名的Logstash，各种Beats，APM等）。 使用机器学习算法进行数据分析是对整个列出的产品堆栈的不错补充之一。 在本文中，我们了解了这些算法是什么。 我们要猫。 <br><a name="habracut"></a><br> 机器学习是共享软件Elastic Stack的一项付费功能，并且是X-Pack的一部分。 要开始使用它，激活后就足以激活30天试用版。 试用期到期后，您可以请求扩展支持或购买订阅。 订阅成本不是根据数据量来计算的，而是根据所使用的节点数来计算的。 不，数据量当然会影响所需的节点数，但是相对于公司的预算，这种许可方式仍然更加人性化。 如果不需要高性能-您可以节省。 <br><br>  Elastic Stack中的ML用C ++编写，并且在运行Elasticsearch本身的JVM之外运行。 也就是说，该进程（顺便说一下，称为自动检测）消耗了JVM不会吞咽的所有内容。 在演示台上，这并不是很关键，但是在生产环境中，突出显示ML任务的单独节点很重要。 <br><br> 机器学习算法分为两类- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">教师</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">无教师</a> 。 在Elastic Stack中，该算法来自“没有老师”类别。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">该链接</a>使您可以查看机器学习算法的数学工具。 <br><br> 为了执行分析，机器学习算法使用存储在Elasticsearch索引中的数据。 您可以从Kibana界面和API创建分析任务。 如果您通过Kibana进行此操作，则无需了解某些事情。 例如，算法在流程中使用的其他索引。 <br><br><div class="spoiler">  <b class="spoiler_title">分析过程中使用的其他索引</b> <div class="spoiler_text">  .ml-state-有关统计模型的信息（分析设置）； <br>  .ml-anomalies- *-ML算法的工作结果； <br>  .ml-notifications-基于分析结果的通知设置。 <br><br><img src="https://habrastorage.org/webt/5a/_a/qo/5a_aqopt2bguee9tkwz4vny85mo.png"><br></div></div><br>  Elasticsearch数据库中的数据结构由存储在其中的索引和文档组成。 如果与关系数据库进行比较，则可以将索引与数据库模式进行比较，并将索引与表中的条目进行比较。 这种比较是有条件的，旨在简化那些仅了解Elasticsearch的人员对其他材料的理解。 <br><br>  API通过Web界面提供了相同的功能，因此，为使概念清晰和理解，我们将展示如何通过Kibana进行配置。 左侧菜单中有一个机器学习部分，您可以在其中创建新作业。 在Kibana界面中，如下图所示。 现在，我们将分析每种任务，并显示可以在此处构建的分析类型。 <br><br><img src="https://habrastorage.org/webt/3y/4g/f5/3y4gf5hczxc_dupysgikgsa9ata.png"><br><br> 单指标-分析一个指标，多指标-分析两个或多个指标。 在这两种情况下，每个指标都是在隔离的环境中进行分析的，即 该算法未考虑并行分析的度量标准的行为，就像在多度量标准的情况下那样。 要考虑各种指标的相关性来进行计算，可以应用总体分析。 而Advanced是对算法的微调，其中包含针对某些任务的其他选项。 <br><br><h2> 单一指标 </h2><br> 您可以在此处执行最简单的操作，即分析单个度量标准中的更改。 单击创建作业后，算法将查找异常。 <br><br><img src="https://habrastorage.org/webt/qo/qt/5q/qoqt5q7adtanmtvkj7rzufdhpce.png"><br><br> 在<i>聚合</i>字段中，您可以选择一种搜索异常的方法。 例如，对于<i>Min，</i>异常值将被认为低于典型值。 有<i>最大，高均值，低，均值，不同</i>等。 可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>找到所有功能的说明。 <br><br> 字段字段指示我们将通过其分析的文档中的数字字段。 <br><br> 在“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>桶跨度”</i></a>字段中，将在时间线上进行分析的间隔的粒度。 您可以信任自动化或手动选择。 下图显示了粒度太低的示例-您可以跳过异常。 使用此设置，您可以将算法的敏感性更改为异常。 <br><br><img src="https://habrastorage.org/webt/ab/td/4u/abtd4uyfg5bwhusjthw48vza34e.png"><br><br> 收集数据的持续时间是影响分析有效性的关键因素。 在分析中，该算法确定重复间隔，计算置信区间（基线）并识别异常-与度量标准行为的非典型偏差。 例如： <br><br> 具有较小数据范围的基准： <br><br><img src="https://habrastorage.org/webt/gg/0q/lr/gg0qlreunogl4_e8kfqt692jkx4.png"><br><br> 当算法需要学习时，基线看起来像这样： <br><br><img src="https://habrastorage.org/webt/gh/sy/fm/ghsyfmlcchzvs8pgdlneq5lqje8.png"><br><br> 在开始任务之后，算法确定与标准的异常偏差，并根据异常的可能性对它们进行排序（相应标签的颜色显示在方括号中）： <br><br> 警告（青色）：小于25 <br> 次要（黄色）：25-50 <br> 大（橙色）：50-75 <br> 严重（红色）：75-100 <br><br> 下图显示了发现异常的示例。 <br><br><img src="https://habrastorage.org/webt/jt/cj/sc/jtcjscwmq7c2efh2gjph8u_3uto.png"><br><br> 在这里您可以看到数字94，它表示发生异常的可能性。 显然，由于该值接近100，因此表示异常。 图表下方的栏显示该度量值出现的贬损概率为0.000063634％。 <br><br> 除了在Kibana中搜索异常外，您还可以运行预测。 这是通过基本方法并从具有异常的同一视图中完成的-右上角的“ <i>预测”</i>按钮。 <br><br><img src="https://habrastorage.org/webt/qx/bj/4s/qxbj4sm4iuteghkt3olp575at-4.png"><br><br> 预测基于最多提前8周进行。 即使您确实想要，也不能再通过设计。 <br><br><img src="https://habrastorage.org/webt/ee/ps/en/eepsen4-a-mhu9lbn_-y_unfajc.png"><br><br> 在某些情况下，例如在监视基础结构上的用户负载时，预测将非常有用。 <br><br><h2> 多指标 </h2><br> 我们继续进行弹性堆栈中的下一个ML功能-捆绑分析多个指标。 但这并不意味着将分析一个度量对另一度量的依赖性。 这与“单一指标”相同，一个屏幕上只有很多指标，可以轻松比较一个指标对另一个指标的影响。 我们将讨论“人口”部分中一种度量对另一种度量的依赖性分析。 <br><br> 单击具有多度量标准的正方形后，将显示一个设置窗口。 我们将更详细地介绍它们。 <br><br><img src="https://habrastorage.org/webt/t_/tp/kl/t_tpklo5pluosupeh-2chlhdbtc.png"><br><br> 首先，您需要选择用于分析和汇总数据的字段。 此处的聚合选项与“单指标”相同（ <i>最大值，高均值，低，均值，差异</i>和其他）。 此外，该数据可选地分为多个字段之一（字段<i>Split Data</i> ）。 在示例中，我们使用<i>OriginAirportID</i>字段进行了此操作。 请注意，右侧的指标图现在显示为多个图。 <br><br><img src="https://habrastorage.org/webt/ui/kk/lj/uikkljm3jja_dl_hatkli7uxw48.png"><br><br>  <i>关键字段（影响者）</i>字段直接影响发现的异常。 默认情况下，将始终至少有一个值，您可以添加其他值。 该算法将在分析中考虑这些字段的影响，并显示出最“有影响力”的值。 <br><br> 启动后，以下图片将出现在Kibana界面中。 <br><br><img src="https://habrastorage.org/webt/mp/bl/ma/mpblmaxtrq2zvntlquovckyf2yo.png"><br><br> 这就是所谓的 我们在<i>分割数据中</i>指定的<i>OriginAirportID</i>字段的每个值的异常热图。 与“单指标”一样，颜色表示异常偏差的级别。 在工作站上进行类似的分析很方便，例如，跟踪那些可疑的地方有很多授权等。 我们已经<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在EventLog Windows中</a>撰写了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关可疑事件的文章，</a>也可以在此处进行收集和分析。 <br><br> 热图下方是异常列表，每一个异常都可以转到“单一度量”视图进行详细分析。 <br><br><h2> 人口 </h2><br> 为了在不同指标之间的相关性之间搜索异常，Elastic Stack具有专门的人口分析。 借助它，您可以搜索服务器性能（与其他服务器相比）的异常值，例如，增加对目标系统的请求数量。 <br><br><img src="https://habrastorage.org/webt/ir/su/j6/irsuj6dtlozgat-jf0hknc2tyzs.png"><br><br> 在此图示中，“人口”字段指示分析的指标将与之相关的值。 这是进程的名称。 结果，我们将看到每个进程的处理器负载如何相互影响。 <br><br> 请注意，所分析数据的图形与“单指标”和“多指标”的情况不同。 这是在Kibana中通过设计完成的，目的是改善对分析数据值分布的感知。 <br><br><img src="https://habrastorage.org/webt/qo/zn/3v/qozn3vwfw6ytqwh5pzgutmvgk_o.png"><br><br> 该图显示<i>poipu</i>服务器上的<i>压力</i>过程（顺便说一下，由一个特殊的实用程序生成） <i>表现异常</i> ，从而影响了（或证明是影响者）此异常的发生。 <br><br><h2> 进阶 </h2><br> 精细分析。 使用Advanced Analysis，其他设置将显示在Kibana中。 单击“高级”图块上的“创建”菜单后，将出现一个选项卡式窗口。 故意跳过了“ <i>作业详细信息”</i>选项卡，那里的基本设置与分析设置没有直接关系。 <br><br><img src="https://habrastorage.org/webt/kr/pf/w6/krpfw6x4bdgpezxfs44p6dyjvhm.png"><br><br> 在<i>summary_count_field_name中，</i>可以选择从包含聚合值的文档中指定字段的名称。 在此示例中，每分钟的事件数。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>categorization_field_name</i></a>指示文档中字段值的名称，其中包含某种变量值。 通过在此字段上屏蔽，可以将分析的数据细分为子集。 请注意上图中的“ <i>添加检测器”</i>按钮。 以下是单击此按钮的结果。 <br><br><img src="https://habrastorage.org/webt/ch/kg/sg/chkgsgutp0bsp0fxb7_q293caku.png"><br><br> 这是用于为特定任务设置异常检测器的附加设置块。 我们计划在以下文章中分析特定的用例（尤其是安全性）。 例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">查看</a>其中一个分解案例。 它与对极少出现的值的搜索相关联， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">并由稀有函数实现</a> 。 <br><br> 在<i>功能</i>字段中，您可以选择一个特定的功能来搜索异常。 除了<i>罕见的功能外</i> ，还有一些有趣的功能<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>-time_of_day</i>和<i>time_of_week</i></a> 。 他们分别确定一天或一周内指标行为的异常情况。 其余的分析功能<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在文档中</a> 。 <br><br>  <i>field_name</i>指示将要分析的文档的字段。  <i>By_field_name</i>可用于分隔此处指定的文档字段的每个单独值的分析结果。 如果您填写<i>over_field_name，则会</i>获得总体分析，我们已在上面进行了分析。 如果在<i>partition_field_name中</i>指定一个值，则将在此文档字段中计算每个值的单独基准（例如，服务器的名称或服务器上的进程可以用作该值）。 在<i>exclude_frequent中，</i>您可以选择<i>all</i>或<i>none</i> ，这意味着排除（或包含）经常遇到的文档字段值。 <br><br> 在本文中，我们试图给出关于Elastic Stack中机器学习的可能性的最简洁的想法，但幕后仍有许多细节。 在评论中告诉我们您在Elastic Stack的帮助下成功解决了哪些情况以及使用了哪些任务。 要与我们联系，您可以使用Habré <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上的</a>个人消息或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">网站上的反馈表</a> 。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN455387/">https://habr.com/ru/post/zh-CN455387/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN455373/index.html">如何调整Spring的法则，使其对小型提供者有所帮助？ 取消它</a></li>
<li><a href="../zh-CN455375/index.html">用Pascal编写UDR</a></li>
<li><a href="../zh-CN455377/index.html">物联网架构</a></li>
<li><a href="../zh-CN455379/index.html">（静态）在C ++程序中选择最佳容器</a></li>
<li><a href="../zh-CN455381/index.html">3CX技术支持做出响应：在PBX服务器上捕获SIP通信</a></li>
<li><a href="../zh-CN455389/index.html">Haxe 4：新功能？</a></li>
<li><a href="../zh-CN455391/index.html">第1部分：非自然栖息地中的RISC-V / RocketChip</a></li>
<li><a href="../zh-CN455393/index.html">关于雷达中频谱估计的参数方法的使用-MUSIC方法。 文章的补充</a></li>
<li><a href="../zh-CN455397/index.html">我们如何在莫斯科办公室的华为上设计和实现新网络，第1部分</a></li>
<li><a href="../zh-CN455401/index.html">简单示例中的Cisco IOS的​​Tcl</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>