<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüî¨ üë©üèø‚Äçüî¨ ü§≤üèΩ No es una oficina estupida üç≠ ‚ÅâÔ∏è üèÇüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nunca me atrever√≠a a escribir un art√≠culo sobre la pr√≥xima implementaci√≥n de una casa inteligente con la conexi√≥n de sensores para fugas de agua en el...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>No es una oficina estupida</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/391399/"><img src="https://habrastorage.org/files/0dd/7a2/355/0dd7a23553144b86ab85d90d2b064823.jpg" align="left" width="255" height="189"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nunca me atrever√≠a a escribir un art√≠culo sobre la pr√≥xima implementaci√≥n de una casa inteligente con la conexi√≥n de sensores para fugas de agua en el ba√±o y sistemas de seguimiento para trucos de gatos en el apartamento. Gracias a Dios que el gato est√° bajo el control de un perro, el agua tampoco parece fluir. Pero a√∫n as√≠, estamos m√°s en el trabajo, en varias oficinas, donde no siempre es posible crear un ambiente de trabajo √≥ptimo. El art√≠culo est√° dedicado al sistema de monitoreo ambiental del espacio de trabajo en la oficina y a las actividades que llevamos a cabo despu√©s de un mes de su (sorprendentemente) trabajo estable. Por supuesto, enviamos todos los datos a las nubes, los miramos desde nuestros tel√©fonos inteligentes, no hay utilidad, pero no hay raz√≥n para alardear ante familiares y amigos, y la oficina se ha vuelto m√°s c√≥moda. Todo se implementa en ESP8266, pero ¬øc√≥mo?</font></font><br>
<br>
<a name="habracut"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øD√≥nde est√° el monitor? </font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No dir√© que trabajamos directamente en condiciones insoportables. </font><font style="vertical-align: inherit;">Las oficinas de la empresa son maravillosas, en habitaciones de tres personas, muchas flores. </font><font style="vertical-align: inherit;">El edificio en s√≠ est√° rodeado de bosque. </font><font style="vertical-align: inherit;">En general, se adjunta un panorama de la oficina donde se implementa el sistema de monitoreo. </font></font><br>
<img src="https://habrastorage.org/files/984/d35/3ac/984d353ace384c1eae1e75d112a56c4c.jpg"> <br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es el monitoreo? </font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nada original </font><font style="vertical-align: inherit;">Eliminamos la temperatura en la oficina, la humedad, la presi√≥n y el nivel de CO2. </font><font style="vertical-align: inherit;">Por supuesto, se ha agregado un sensor de luz al sistema. </font><font style="vertical-align: inherit;">El nivel de iluminaci√≥n de los lugares de trabajo est√° incluso sujeto a control y, en nuestro caso, deber√≠a estar en el nivel de 300-400 Lux. </font><font style="vertical-align: inherit;">Quiz√°s este es el par√°metro m√°s importante para un trabajo c√≥modo. </font><font style="vertical-align: inherit;">Y lo m√°s din√°mico durante el d√≠a.</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/3e1/150/cbc/3e1150cbc42247ad859b2faf45845c6b.jpg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obtenemos temperatura y humedad del sensor DHT22. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sensor.</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/e10/371/788/e10371788d6747288bed75aebce84343.jpg" width="301" height="247"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomamos presi√≥n del sensor BMP180. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sensor.</font></font><div style="text-align:center;"><img src="https://habrastorage.org/files/26e/126/3d0/26e1263d0df142ec90551d66818d3226.jpg" width="225" height="230"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El nivel de CO2 es monitoreado por el sensor √≥ptico MH-Z14. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sensor.</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/25c/952/171/25c952171b2449b7b1560bafcec9bfbe.jpg" width="260" height="250"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, el sensor TSL2561 en forma de placa de identificaci√≥n para la serie Arduino GROVE controla la calidad de la iluminaci√≥n. </font><font style="vertical-align: inherit;">Descripci√≥n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/293/d8a/b9c/293d8ab9c5fd451fa9c835ca64bd1b5a.jpg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y, por √∫ltimo, el controlador ESP8266 en forma de un pa√±uelo para la creaci√≥n r√°pida de prototipos de NodeMcu (con el nombre del firmware), que en mi caso se actualiza desde el IDE Arduino est√°ndar, lo dirige todo. </font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/ca4/d7c/47d/ca4d7c47d81a42f1b70252f2d1b0992f.jpg" width="320" height="220"></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recopilamos la versi√≥n en caja</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Entonces, todos los sensores est√°n colocados sobre la mesa, es hora de ensamblar el dispositivo. </font><font style="vertical-align: inherit;">Sin embargo, para empezar analizaremos algunas sutilezas. </font><font style="vertical-align: inherit;">Dibuj√≥ un diagrama esquem√°tico para mayor claridad.</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/005/e9a/9aa/005e9a9aa1664c72aad7be7822bd1f32.jpg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ todos los sensores est√°n alimentados por +3.3 V, que tomaremos de la placa NodeMcu, ya que ya hay tres de ellos en la placa. Pero el sensor de di√≥xido de carbono tendr√° que alimentarse por separado, requiere de 4 a 6 voltios de potencia, y el fabricante recomienda encarecidamente prestar especial atenci√≥n a esto. Como planeo alimentar el dispositivo desde una fuente de alimentaci√≥n separada a + 5V, no habr√° problemas. Suministramos energ√≠a al terminal 1 del sensor MH-Z14 (o 15, ya que est√°n duplicados). Cuando enciende el sensor durante un par de minutos, emite basura al puerto cuando transmite a trav√©s de la l√≠nea TX / RX, por lo que tomo la se√±al √∫til de este sensor de la salida PWM en la sexta pata. En general, me gust√≥ este sensor. Es bastante estable, tiene una salida digital y anal√≥gica, pero solo puede funcionar con microcontroladores con l√≥gica de tres voltios, as√≠ que ejec√∫telo, por ejemplo, en UNO sin</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bailar con panderetas</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordinaci√≥n de niveles l√≥gicos no funcionar√°. En nuestro caso, el ESP funciona con l√≥gica de tres voltios, como todos los dem√°s sensores. Al mismo tiempo, el ESP en s√≠ es especialmente exigente con la calidad de la energ√≠a, pero en la placa que utilic√© en este art√≠culo, se ensambla el esquema normal para estabilizar la potencia de entrada hasta +3,3 V, pero no recomendar√≠a alimentar la placa desde ninguna IP dudosa y no lo dar√≠a en absoluto Ser√≠a m√°s de 5 voltios. Tampoco depuraremos un circuito completamente ensamblado, alimentandolo solo desde un puerto USB. Dado que el sensor de di√≥xido de carbono tiene un gran consumo debido a la presencia de una bombilla incandescente (como fuente de IR, probablemente) en su dise√±o, esto puede empujar el puerto. ¬øLo necesitamos? Por lo tanto, completamos el firmware con la fuente de alimentaci√≥n de terceros incluida, o mediante USB, pero desconectando el sensor de di√≥xido de carbono.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No es sin un soldador ...</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como puede ver en el diagrama, uso dos sensores en la l√≠nea i2c. </font><font style="vertical-align: inherit;">Este es un sensor de presi√≥n y un sensor de luz. </font><font style="vertical-align: inherit;">Como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sabe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en un bus serie puede "colgar" hasta 127 todo tipo de sensores y dispositivos. </font><font style="vertical-align: inherit;">En la implementaci√≥n del protocolo, las l√≠neas SDA / SCL deben ajustarse a la potencia, pero solo una vez. </font><font style="vertical-align: inherit;">Y si colgamos sensores N, en cada uno de los cuales hay llaves, puede plantar una l√≠nea. </font><font style="vertical-align: inherit;">Probablemente, nada hubiera sucedido con los dos sensores, pero siempre soy consistente en el dise√±o. </font><font style="vertical-align: inherit;">No deber√≠a haber dientes, lo siento ... Por lo tanto, nos deshacemos de las resistencias pull-up en uno de los sensores. </font><font style="vertical-align: inherit;">Era m√°s conveniente arrancar las resistencias del sensor de presi√≥n. </font><font style="vertical-align: inherit;">La figura muestra.</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/606/4b0/ef3/6064b0ef37ef4f2dbcbcfba329f13b12.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de todos estos ejercicios, recogemos nuestra versi√≥n en caja. </font><font style="vertical-align: inherit;">En una caja de papel)</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/d60/a52/e23/d60a52e239a941a7b1c143d0d4c2568a.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo que es sorprendente: funcion√≥ de inmediato. </font><font style="vertical-align: inherit;">Esto no es bueno, pero a√∫n as√≠. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digestamos datos</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
, entonces, la ideolog√≠a es esta. </font><font style="vertical-align: inherit;">Recopilamos datos de los sensores y, por ejemplo, cada 10 minutos, los dejamos en el almacenamiento en la nube a trav√©s del Wi-Fi de la oficina. </font><font style="vertical-align: inherit;">Construimos hermosos gr√°ficos y analizamos los resultados de Thingspeak.com. </font><font style="vertical-align: inherit;">El servicio es gratuito, bastante estable y f√°cil de entender. </font><font style="vertical-align: inherit;">Mucho se ha </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escrito</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre √©l </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Registramos el canal, obtenemos la clave API y restablecemos los datos de cualquier sensor utilizando el m√©todo POST.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo del programa</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">//    ,     <font></font>
#include &lt;Wire.h&gt;<font></font>
#include &lt;ESP8266WiFi.h&gt; //     ,    <font></font>
float index_comfort=0; //   <font></font>
<font></font>
//+++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//   ,    <font></font>
//   <font></font>
#include "DHT.h"<font></font>
#define DHTTYPE DHT22  //   - Grove DHT22<font></font>
#define DHTPIN 14     //  14  ESP (   D5)  . <font></font>
<font></font>
//       <font></font>
float humidity_room = 0.0; //     <font></font>
//  humidity_room = dht.readHumidity();<font></font>
float temp_room = 0.0; //     <font></font>
//  temp_room = dht.readTemperature();<font></font>
<font></font>
//    .     <font></font>
//     <font></font>
DHT dht(DHTPIN, DHTTYPE);<font></font>
<font></font>
//++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//     <font></font>
#include &lt;Digital_Light_TSL2561.h&gt;<font></font>
//      <font></font>
float light_room=0.0;<font></font>
//  light_room=TSL2561.readVisibleLux();<font></font>
<font></font>
<font></font>
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//  C02  <font></font>
int CO2; //     <font></font>
int pin_CO2 = 13; //  13,   7 <font></font>
//  2<font></font>
<font></font>
<font></font>
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//    . <font></font>
#include &lt;Adafruit_BMP085.h&gt;<font></font>
Adafruit_BMP085 bmp;<font></font>
float pressure =0.0; //   <font></font>
//  pressure=bmp.readPressure(); <font></font>
//   !<font></font>
// 1013.25 millibar = 101325  = 760  ..   ? ...<font></font>
//      ,  <font></font>
<font></font>
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//        -<font></font>
//     thingspeak.com , , ..,  <font></font>
#define myPeriodic 300; //        <font></font>
const char* server = "184.106.153.149"; //   thingspeak.com<font></font>
<font></font>
String apiKey ="1K******************GM"; //   <font></font>
<font></font>
const char* MY_SSID = "P********x"; //  Wi-Fi  <font></font>
const char* MY_PWD = ""; //  ,    ,  ""<font></font>
<font></font>
int sent = 0; //   ()  .  ?  ,  ...<font></font>
<font></font>
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//    ,  <font></font>
<font></font>
void setup() {<font></font>
  Serial.begin(9600); //    <font></font>
 <font></font>
  Serial.println("Go! Go! Go!");<font></font>
  <font></font>
  Wire.begin(); <font></font>
 <font></font>
  dht.begin(); //    <font></font>
 <font></font>
  TSL2561.init(); //    <font></font>
 <font></font>
  pinMode(pin_CO2, INPUT); //    CO2  <font></font>
 <font></font>
  //   <font></font>
 if (!bmp.begin()) {<font></font>
 Serial.println("Promlem with sensor bmp180!");<font></font>
  while (1) {}<font></font>
  }<font></font>
  //  wi-Fi<font></font>
 connectWifi();<font></font>
}<font></font>
<font></font>
//++++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//       <font></font>
void connectWifi() <font></font>
{<font></font>
  Serial.print("Connecting to "+*MY_SSID);<font></font>
 WiFi.begin(MY_SSID, MY_PWD);<font></font>
 while (WiFi.status() != WL_CONNECTED) {<font></font>
  delay(1000);<font></font>
 Serial.print(".");<font></font>
  }<font></font>
  <font></font>
 Serial.println("");<font></font>
 Serial.println("Connected");<font></font>
 Serial.println(""); <font></font>
  Serial.print("SSID: ");<font></font>
  Serial.println(WiFi.SSID());<font></font>
<font></font>
  //   <font></font>
  IPAddress ip = WiFi.localIP();<font></font>
  Serial.print("IP Address: ");<font></font>
  Serial.println(ip);<font></font>
<font></font>
  //    <font></font>
  long rssi = WiFi.RSSI();<font></font>
  Serial.print("signal strength (RSSI):");<font></font>
  Serial.print(rssi);<font></font>
  Serial.println(" dBm"); <font></font>
}//end connect<font></font>
<font></font>
//++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
//    <font></font>
void send_info(float temp_in, float temp_out, float humidity_in, int CO2_in, float light_in, float pressure_all )<font></font>
{  <font></font>
  WiFiClient client;<font></font>
  <font></font>
   if (client.connect(server, 80)) { // use ip 184.106.153.149 or api.thingspeak.com<font></font>
   Serial.println("WiFi Client connected ");<font></font>
   <font></font>
   //        <font></font>
   String postStr = apiKey; //  <font></font>
   postStr += "&amp;field1=";<font></font>
   postStr += String(temp_in); //    <font></font>
<font></font>
   postStr += "&amp;field2=";<font></font>
   postStr += String(temp_out); //   <font></font>
<font></font>
   postStr += "&amp;field3=";<font></font>
   postStr += String(humidity_in); //    <font></font>
<font></font>
   postStr += "&amp;field4=";<font></font>
   postStr += String(CO2_in); // 2   <font></font>
<font></font>
   postStr += "&amp;field5=";<font></font>
   postStr += String(light_in); //    <font></font>
<font></font>
   postStr += "&amp;field6=";<font></font>
   postStr += String(pressure_all); //   <font></font>
   <font></font>
   postStr += "\r\n\r\n"; //    <font></font>
   <font></font>
   client.print("POST /update HTTP/1.1\n");<font></font>
   client.print("Host: api.thingspeak.com\n");<font></font>
   client.print("Connection: close\n");<font></font>
   client.print("X-THINGSPEAKAPIKEY: " + apiKey + "\n");<font></font>
   client.print("Content-Type: application/x-www-form-urlencoded\n");<font></font>
   client.print("Content-Length: ");<font></font>
   client.print(postStr.length());<font></font>
   client.print("\n\n");<font></font>
   client.print(postStr);<font></font>
   delay(1000);  <font></font>
   }//end if<font></font>
   sent++; //   <font></font>
  <font></font>
 client.stop();<font></font>
 Serial.println("transmition closed ");<font></font>
}//end send<font></font>
<font></font>
<font></font>
//+++++++++++++++++++++++++++++++++++++++++++++++++++++<font></font>
<font></font>
//    ,   ? <font></font>
<font></font>
void loop()<font></font>
{<font></font>
 delay(5000);<font></font>
 // <font></font>
 dht.begin();<font></font>
 humidity_room = dht.readHumidity();<font></font>
delay(500);<font></font>
<font></font>
//   <font></font>
 temp_room = dht.readTemperature();<font></font>
delay(500);<font></font>
<font></font>
//   <font></font>
light_room=TSL2561.readVisibleLux();<font></font>
delay(500);<font></font>
<font></font>
<font></font>
// CO2  <font></font>
 while(digitalRead(pin_CO2)==HIGH){;}<font></font>
float duration_h = pulseIn(pin_CO2,HIGH)/1000;<font></font>
 <font></font>
 CO2= int(5000*(duration_h-2)/(duration_h+(1004-duration_h)-4)); //   <font></font>
 delay(500);<font></font>
<font></font>
//  <font></font>
bmp.begin();<font></font>
pressure=bmp.readPressure(); <font></font>
pressure=int((pressure/101325)*760);<font></font>
delay(500);<font></font>
<font></font>
//    <font></font>
if (temp_room&lt;18) {<font></font>
  index_comfort=(2*light_room/300)+(400/CO2)+humidity_room/40;<font></font>
  }<font></font>
<font></font>
if (temp_room&gt;25) {<font></font>
  index_comfort=(2*light_room/300)+(400/CO2)+humidity_room/40;<font></font>
  }<font></font>
<font></font>
  index_comfort=1+(2*(light_room/300)+(400/CO2)+humidity_room/40);<font></font>
<font></font>
  if (index_comfort&gt;5){<font></font>
    index_comfort=5;<font></font>
    }<font></font>
  <font></font>
//    <font></font>
send_info(temp_room, index_comfort, humidity_room, CO2, light_room, pressure);<font></font>
  <font></font>
  //.      <font></font>
  int count = myPeriodic;<font></font>
  while(count--)<font></font>
  delay(1000);<font></font>
<font></font>
  // ,  .   ...<font></font>
  // , <font></font>
  //<font></font>
  //       i2c    ,   <font></font>
  // .     . <font></font>
  //     .  .    <font></font>
  //  ,   .    ,   . <font></font>
  //     ,  DHT22,    . <font></font>
  // --,     ... <font></font>
  // 15  2016 .    <font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si todo funciona correctamente, ser√° algo como esto)</font></font></b><div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/a16/19c/b2d/a1619cb2dc4342e48c4b02734610fc5b.jpg"></div><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que esto funcione, necesitar√° bibliotecas para trabajar con sensores seleccionados y una biblioteca para trabajar con ESP8266 a trav√©s de Wi-Fi. Tambi√©n necesita agregar una placa NodeMcu a la lista de placas Arduino IDE, y para verla, necesita un controlador USB-SERIAL CH340, que es f√°cil de encontrar y descargar en la red sin ning√∫n problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Biblioteca para ESP8266 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descargar</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Biblioteca para trabajar con un sensor de humedad. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descargue la</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Biblioteca para trabajar con el sensor de luz. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descargue la</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Biblioteca para trabajar con un sensor de presi√≥n. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descargar</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El sensor de CO2 no necesita bibliotecas. Las indicaciones se calculan por la duraci√≥n de la salida de pulso proveniente de PWM y se calculan por la f√≥rmula de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descripci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensor </font><font style="vertical-align: inherit;">Por cierto, el rango de medici√≥n no es de 2000 ppm, sino de 5000, que, por cierto, tambi√©n fue escrito por el usuario </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hellsy22</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reciente </font><font style="vertical-align: inherit;">sobre un sensor de di√≥xido de carbono similar. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusiones de la organizaci√≥n</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
1. Trabajos </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. El oficio es digno de mudarse de una caja de papel a un edificio decente.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui esta </font><font style="vertical-align: inherit;">Tambi√©n mostrar√° el nivel de comodidad en la oficina como un sem√°foro.</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/907/3a4/e47/9073a4e47fc247bfa7c88341594f2fbf.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. No hay mucha luz en la oficina por la noche, agregaron un par de luces de techo. Se puso mejor. 350 lx </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. La se√±ora de la limpieza realmente trabaja. Viene temprano en la ma√±ana, enciende la luz, la limpieza h√∫meda produce una oleada de humedad en la oficina durante media hora. No mucho, pero a√∫n as√≠ ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Despu√©s de dos horas de trabajo (tres personas respiran con dificultad) en la oficina, el nivel de CO2 sale de la escala. La ventilaci√≥n de cinco minutos corrige la situaci√≥n a la normalidad (500 ppm). Combina (si lo deseas) airear con gimnasia)))</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Muy seco. </font><font style="vertical-align: inherit;">La calefacci√≥n en invierno, por supuesto, es la raz√≥n directa. </font><font style="vertical-align: inherit;">No es posible alcanzar una humedad confortable del 40-50%. </font><font style="vertical-align: inherit;">Sin embargo, las flores en la oficina realmente dan m√°s del 10 por ciento de humedad en comparaci√≥n con una habitaci√≥n similar sin flores. </font><font style="vertical-align: inherit;">No te olvides de regarlos, por supuesto). </font><font style="vertical-align: inherit;">Por cierto, se necesitan de 10 a 12 litros de agua para regar las flores. </font><font style="vertical-align: inherit;">La oficina tiene 13 macetas. </font><font style="vertical-align: inherit;">Riegue dos veces por semana. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. La utilidad de esto en todo, francamente, no es suficiente. </font><font style="vertical-align: inherit;">Sin embargo, por ejemplo, para las clases escolares o una cl√≠nica, tales sistemas probablemente ser√≠an m√°s √∫tiles.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ct/sl/yg/ctslygn5rw0wym3aqglkzwvrcoe.jpeg"></div></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es391399/">https://habr.com/ru/post/es391399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es391385/index.html">Primer recorrido por la sede de Blue Origin</a></li>
<li><a href="../es391387/index.html">¬øPor qu√© el sistema solar es plano? [Voz en off Vert Dider]</a></li>
<li><a href="../es391389/index.html">Un hombre feliz que logr√≥ realizar todos sus sue√±os y planes. Almirante ingeniero y acad√©mico A.I. Berg y ki berg netika</a></li>
<li><a href="../es391393/index.html">Miel equivocada: el apicultor franc√©s aprendi√≥ a hacer miel de c√°√±amo</a></li>
<li><a href="../es391395/index.html">Regla de PCB. La l√≠nea de radioaficionados y crowdfunding en Vkontakte</a></li>
<li><a href="../es391401/index.html">HackerQuest v0.97: sala de misiones del nivel de dificultad "Pesadilla"</a></li>
<li><a href="../es391403/index.html">Ingenio inal√°mbrico. Descripci√≥n general del m√≥dulo Witty ESP-8266</a></li>
<li><a href="../es391407/index.html">World Drone Prix Supercup Super Cup: $ 1 Million Prize Pool</a></li>
<li><a href="../es391409/index.html">La sonda Dawn estudia Ceres durante un a√±o: descubrimientos interesantes y nuevos rompecabezas</a></li>
<li><a href="../es391413/index.html">Visualizaci√≥n de m√∫sica del siglo XXI: de la animaci√≥n a la caja de m√∫sica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>