<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥫 👩🏼‍🚒 🖋️ Erstellen einer REST-API mit Node.js und einer Oracle-Datenbank 😀 🙅🏿 ✍🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo habr Ich präsentiere Ihnen die Übersetzung des Artikels „Erstellen einer REST-API: Grundlagen des Webservers“ . 

 Teil 1. Erstellen einer REST-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen einer REST-API mit Node.js und einer Oracle-Datenbank</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473234/">  Hallo habr  Ich präsentiere Ihnen die Übersetzung des Artikels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Erstellen einer REST-API: Grundlagen des Webservers“</a> . <br><br><h4>  Teil 1. Erstellen einer REST-API: Grundlagen des Webservers </h4><br>  Der Webserver ist eine der wichtigsten Komponenten der REST-API.  In diesem Beitrag beginnen Sie Ihr REST-API-Projekt mit der Erstellung einiger anfänglicher Verzeichnisse und Dateien.  Anschließend erstellen Sie ein Webservermodul und schließen es an, damit der Webserver ordnungsgemäß gestartet und heruntergefahren wird. <br><br>  Der Code in diesem Projekt wird mithilfe einer gemeinsamen Verzeichnisstruktur organisiert, die bei Bedarf im Laufe der Zeit angepasst und erstellt werden kann. <br><br><pre><code class="javascript hljs">cd ~ mkdir hr_app cd hr_app/ touch index.js mkdir config touch config/web-server.js mkdir controllers mkdir db_apis mkdir services touch services/web-server.js</code> </pre> <br>  Die Datei index.js kann als "Hauptdatei" in der Anwendung betrachtet werden.  Es wird der Einstiegspunkt in die Anwendung sein.  Wir werden dieser Datei und den Dateien web-server.js in den Verzeichnissen config und services Code hinzufügen. <br><br>  Fügen Sie den folgenden Code in die Datei <b>Home&gt; hr_app&gt; config&gt; web-server.js ein</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">port</span></span>: process.env.HTTP_PORT || <span class="hljs-number"><span class="hljs-number">3000</span></span> };</code> </pre> <br>  In Node.js verfügt ein Prozessobjekt über eine env-Eigenschaft, die eine Benutzerumgebung enthält.  Ich benutze dies, um den Portwert auf den Wert der Umgebungsvariablen HTTP_PORT zu setzen.  Wenn diese Umgebungsvariable nicht definiert ist, ist der Standardwert 3000. <br><a name="habracut"></a><br>  Fügen Sie den folgenden Code in die <b>Datei Home&gt; hr_app&gt; services&gt; web-server.js ein</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> http = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webServerConfig = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../config/web-server.js'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> httpServer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); httpServer = http.createServer(app); app.get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { res.end(<span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span>); }); httpServer.listen(webServerConfig.port) .on(<span class="hljs-string"><span class="hljs-string">'listening'</span></span>, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Web server listening on localhost:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${webServerConfig.port}</span></span></span><span class="hljs-string">`</span></span>); resolve(); }) .on(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, err =&gt; { reject(err); }); }); } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports.initialize = initialize;</code> </pre> <br>  <b>Zeilen 1-3:</b> Mehrere Module erforderlich.  Das http-Modul ist in Node.js enthalten, das Express-Modul muss jedoch über npm installiert werden. <br><br>  <b>Zeilen 7-27: Eine</b> Funktion namens initialize wird deklariert.  Die Funktion gibt sofort ein Versprechen zurück, das zulässig oder abgelehnt wird, je nachdem, ob der Webserver erfolgreich gestartet wurde. <br><br>  <b>Zeilen 9-10:</b> Eine neue Express-Anwendung wird erstellt (die eigentlich nur eine Funktion ist) und dann zum Erstellen eines http-Servers über das http-Modul verwendet. <br><br>  <b>Zeilen 12-14: Mit der</b> get-Methode der Anwendung wird ein Handler für GET-Anforderungen hinzugefügt, die am Stammpfad (/) ankommen.  Die Rückruffunktion wird nach Erhalt einer solchen Anfrage aufgerufen und verwendet den Parameter "res" (res), um die Antwort "Hello World!" Zu senden.  Zum Kunden. <br><br>  <b>Zeilen 16-24: Die</b> Server-Überwachungsmethode wird verwendet, um eine Bindung an den angegebenen Port herzustellen und eingehende Anforderungen abzuhören. <br><br>  <b>Zeile 28:</b> Exportieren des Moduls, damit es extern verwendet werden kann <br><br>  Fügen Sie den folgenden Code in die Datei <b>Home&gt; hr_app&gt; index.js ein</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webServer = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./services/web-server.js'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Starting application'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Initializing web server module'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> webServer.initialize(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (err) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err); process.exit(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Non-zero failure code } } startup();</span></span></code> </pre> <br>  Wir verbinden das Webservermodul und dann bestimmt es die asynchrone Startfunktion und ruft sie auf.  Da die Initialisierungsfunktion des Webservers ein Versprechen zurückgibt, können Sie es mit async / await verwenden und in einen Try-Catch-Block einschließen.  Wenn die Initialisierungsfunktion erfolgreich ist, funktioniert der Webserver.  Andernfalls werden Ausnahmen abgefangen und verarbeitet.  Jetzt müssen Sie nur noch npm initialisieren und Express installieren - dann können Sie die Anwendung starten.  Führen Sie die folgenden Befehle in einem Terminal aus dem Verzeichnis hr_app aus. <br><br><pre> <code class="javascript hljs">npm init -y npm install express -s node .</code> </pre> <br>  Mit dem Befehl npm init wird die Datei package.json erstellt, die npm als Manifestdatei verwendet (das Flag -y akzeptiert Standardoptionen).  Der Befehl npm install wird zum Installieren von express verwendet (das Flag -s fügt der Abhängigkeitsliste in package.json express hinzu).  Npm speichert die von Ihnen installierten Module im Verzeichnis node_modules.  Er erstellt auch eine Datei mit dem Namen package.lock.json, um dem Entwicklungsteam einen identischen Baum bereitzustellen. <br><br>  Sehen Sie die Nachricht <b>Webserver auf localhost: 3000 abhören?</b>  Herzlichen Glückwunsch, Sie haben einen Express-Server erstellt, der auf basiert! <br><br>  Und hier ist er, eine andere "Hallo Welt".  Obwohl dies nicht besonders unterhaltsam ist, ist dies ein wichtiger erster Schritt für Ihre API. <br><br>  Wenn Sie bereit sind, können Sie den Server ausschalten, indem Sie zum Terminal zurückkehren und Strg + c drücken. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ca/f1a/d8f/2caf1ad8fd86f8d3512260fb1e68df2d.png" alt="Bild"><br><br><h4>  Kontrolliertes Herunterfahren </h4><br>  Während des Herunterfahrens durch Drücken von Strg + C haben Sie keine Kontrolle darüber, wie dies geschehen ist.  Um den Prozess des Herunterfahrens zu steuern, müssen Sie den Webserver explizit schließen und den Prozess Node.js. beenden <br><br>  Fügen Sie den folgenden Code in die <b>Datei Home&gt; hr_app&gt; services&gt; web-server.js ein</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** previous code above this line *** function close() { return new Promise((resolve, reject) =&gt; { httpServer.close((err) =&gt; { if (err) { reject(err); return; } resolve(); }); }); } module.exports.close = close;</span></span></code> </pre> <br>  Die Funktion zum Schließen gibt ein Versprechen zurück, das aufgelöst wird, wenn der Webserver erfolgreich geschlossen wird.  Die Methode httpServer.close stoppt den Aufbau neuer Verbindungen, erzwingt jedoch nicht das Schließen bereits geöffneter Verbindungen.  Je nachdem, wie viele Verbindungen geöffnet sind und was sie tun, müssen Sie möglicherweise etwas warten, bis der Rückruf funktioniert.  Obwohl Sie dies in diesem Modul nicht tun, können Sie benutzerdefinierten Code oder npm-Module wie http-shutdown verwenden, um das Schließen offener Verbindungen zu erzwingen. <br><br>  Fügen Sie den folgenden Code in die Datei <b>Home&gt; hr_app&gt; index.js ein</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** previous code above this line *** async function shutdown(e) { let err = e; console.log('Shutting down'); try { console.log('Closing web server module'); await webServer.close(); } catch (e) { console.log('Encountered error', e); err = err || e; } console.log('Exiting process'); if (err) { process.exit(1); // Non-zero failure code } else { process.exit(0); } } process.on('SIGTERM', () =&gt; { console.log('Received SIGTERM'); shutdown(); }); process.on('SIGINT', () =&gt; { console.log('Received SIGINT'); shutdown(); }); process.on('uncaughtException', err =&gt; { console.log('Uncaught exception'); console.error(err); shutdown(err); });</span></span></code> </pre> <br>  SIGINT- und SIGTERM-Ereignisse beziehen sich auf Signale, die an einen Prozess gesendet werden können, um ihn herunterzufahren, beispielsweise wenn Strg + c gedrückt wird.  Ein uncaughtException-Ereignis tritt auf, wenn ein JavaScript-Fehler ausgelöst, aber nicht abgefangen und mit der try-catch-Anweisung behandelt wird.  Versuchen Sie erneut, die Anwendung zu starten und zu schließen.  Sie werden feststellen, dass alles korrekt funktioniert, wenn im Terminal Meldungen zum Herunterfahren angezeigt werden. <br><br><h4>  Registrierung auf dem Server </h4><br>  Es gibt noch eine weitere Sache, die unser Webservermodul vervollständigt: die HTTP-Protokollierung.  Es gibt verschiedene Module, die Sie für diese Art der Anmeldung verwenden können, aber Morgan ist eines der einfachen.  Lassen Sie uns Morgan mit npm installieren. <br><br><pre> <code class="javascript hljs">npm install morgan -s</code> </pre> <br>  Fügen Sie dann die folgende Zeile zu services / web-server.js unter der Zeile hinzu, für die Express erforderlich ist (Zeile 2): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> morgan = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'morgan'</span></span>);</code> </pre> <br>  Jetzt können Sie die Morgan-Funktion als Middleware aktivieren, über die alle Anfragen mit app.use verarbeitet werden.  Fügen Sie diese Zeile hinzu, bevor Sie app.get aufrufen, in der die Meldung "Hallo Welt" angezeigt wird. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Combines logging info from request and response app.use(morgan('combined')); // *** app.get call below this line ***</span></span></code> </pre> <br>  Beachten Sie, dass app.use eine Pipeline von Middleware-Funktionen erstellt, die mit HTTP-Anforderungen und -Antworten interagieren können.  Die Middleware-Funktionen werden in der Reihenfolge ausgeführt, in der sie aktiviert sind.  Starten Sie die Anwendung neu und installieren Sie das Terminal, damit Sie es und den Browser gleichzeitig sehen können.  Jedes Mal, wenn Sie die Seite neu laden, sollte im Terminal ein neuer Protokolleintrag angezeigt werden.  Standardmäßig übergibt Morgan Protokollinformationen an STDOUT (das im Terminal angezeigt wird). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der folgende Artikel</a> behandelt die Grundlagen der Arbeit mit Datenbanken, einschließlich Verbindungspools, die Ihnen helfen, die REST-API für Node.js zu verstehen und zu erstellen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473234/">https://habr.com/ru/post/de473234/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473222/index.html">Benutzerdefinierte iptables-Regeln für Docker am Beispiel von zabbix</a></li>
<li><a href="../de473224/index.html">Hochschulbildung vs. Kompetenz. Separate Stellungnahme eines Richters des Verfassungsgerichts der Russischen Föderation zum Stand der Hochschulbildung</a></li>
<li><a href="../de473228/index.html">Perl direkt von 1987 setzen</a></li>
<li><a href="../de473230/index.html">Ist Satelliten-Internet ein neues Weltraumrennen?</a></li>
<li><a href="../de473232/index.html">Welches Versionskontrollsystem verwenden Sie (in der Praxis meistens)?</a></li>
<li><a href="../de473236/index.html">Arbeit in den Bereichen IT, Projektmanagement, PD-Regulierung und Entwicklung in der Cloud: Megadigest von 1cloud.ru</a></li>
<li><a href="../de473238/index.html">Wie Netflix funktioniert</a></li>
<li><a href="../de473242/index.html">Was ich für das Jahr mit dem Elektroroller verstanden habe (so kurz wie möglich)</a></li>
<li><a href="../de473246/index.html">Die mathematische Rechtfertigung für die Unangemessenheit, die Rolltreppe in der U-Bahn herunterzufahren</a></li>
<li><a href="../de473248/index.html">Arduino DIY Projekte: Dämonischer Karussell Roboter Schießstand</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>