<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌸 🤦🏻 🕴🏾 La batalla de los servidores WEB. Parte 2: escenario realista de HTTPS: 👄 😣 👃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hablamos sobre la técnica en la primera parte del artículo, en esto probamos HTTPS, pero en escenarios más realistas. Para las pruebas, se recibió el ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La batalla de los servidores WEB. Parte 2: escenario realista de HTTPS:</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ultravds/blog/482230/"><img src="https://habrastorage.org/getpro/habr/post_images/e98/b4f/df1/e98b4fdf1818cb6bfaf1d464ee87e3ac.png"><br><br>  Hablamos sobre la técnica en la <a href="https://habr.com/ru/company/ultravds/blog/478854/">primera parte del</a> artículo, en esto probamos HTTPS, pero en escenarios más realistas.  Para las pruebas, se recibió el certificado Let's Encrypt, se habilitó la compresión Brotli por 11. <br><br>  Esta vez intentaremos reproducir el escenario de implementación del servidor en VDS o como una máquina virtual en un host con un procesador típico.  Para hacer esto, establezca el límite en: <br><br><ul><li>  25% - Que en términos de frecuencia ~ 1350MHz </li><li>  35% -1890MHz </li><li>  41% - 2214MHz </li><li>  65% - 3510MHz </li></ul><br>  El número de conexiones únicas disminuyó de 500 a 1, 3, 5, 7 y 9, <br><a name="habracut"></a><br><h2>  Resultados: </h2><br><h3>  Retrasos: </h3><br>  TTFB se hizo especialmente como una prueba separada, porque HTTPD Tools crea un nuevo usuario para cada solicitud individual.  Esta prueba todavía está bastante divorciada de la realidad, porque el usuario hace clic en un par de páginas de todos modos, y en realidad TTFP desempeñará el papel principal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d16/3a9/a21/d163a9a21730a7837ec6adccb4758e4d.png"></div><br>  La primera, generalmente la primera solicitud, después del primer inicio de la máquina virtual, IIS procesa un promedio de 120 ms. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/586/dcb/0c9/586dcb0c9eeb8443c4cd52fd49a3d5c3.png"></div><br>  Todas las solicitudes posteriores muestran un TTFP de 1,5 ms.  Apache y Nginx están rezagados.  Personalmente, el autor considera que esta prueba es la más reveladora y elegiría un ganador solo en ella. <br>  El resultado no es sorprendente, ya que IIS almacena en caché contenido estático comprimido y no lo pellizca cada vez que se accede a él. <br><br><h3>  Tiempo dedicado a un cliente </h3><br>  Para evaluar el rendimiento, una prueba con 1 conexión única es suficiente. <br>  Por ejemplo, IIS completó las pruebas con una longitud de 5,000 usuarios en 40 segundos, que son 123 solicitudes por segundo. <br><br>  Los gráficos a continuación muestran el tiempo hasta la transferencia completa del contenido del sitio.  Este es el porcentaje de solicitudes completadas en un momento específico.  En nuestro caso, el 80% de todas las solicitudes se procesaron en 8 ms en IIS y en 4,5 ms en Apache y Nginx, y el 98% de todas las solicitudes en Apache y Nginx se ejecutaron dentro de un intervalo de 8 milisegundos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/305/e49/03c/305e4903cc0a2abf597b14132c8cdd85.png"></div><br>  El tiempo necesario para procesar 5000 solicitudes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f29/ef5/871/f29ef587182d7dd5e7df53af806855b0.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c52/60b/c4a/c5260bc4a393960d4116fb843ea7ffb1.png"></div><br>  El tiempo necesario para procesar 5000 solicitudes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/753/d66/f67/753d66f67f474f3c86c1fee8883b2a70.png"></div><br>  Si tiene una máquina virtual con una CPU de 3.5 GHz y 8 núcleos, elija lo que desee.  Todos los servidores web son muy similares en esta prueba.  A continuación, hablaremos sobre qué servidor web elegir para cada host. <br><br>  Cuando se trata de una situación un poco más real, todos los servidores web se enfrentan cara a cara. <br><br><h3>  Rendimiento: </h3><br>  Programa de retrasos en el número de conexiones simultáneas.  Más suave y más bajo es mejor.  El último 2% se eliminó de los gráficos porque los haría ilegibles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/504/0ba/06a5040ba38a1ce27336a473f875a6a9.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/030/ac4/25a/030ac425a43f2508d1c8ce2235be30a2.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ea/caf/960/6eacaf96036c0cb5032908b98977b1ef.png"></div><br>  Ahora considere la opción donde el servidor está alojado en un alojamiento compartido.  Tome 4 núcleos a 2.2 GHz y un núcleo a 1.8 GHz. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4b3/220/859/4b3220859223d1388b4c00b3eeb55194.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c1/d28/e1c/0c1d28e1cd67942fbc54a472bd28942a.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ee/bec/40e/1eebec40e354a86a11b9324449fa49cf.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2f3/a99/53b/2f3a9953b0c7812932669f0b83a95c1b.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f7/f98/f4f/6f7f98f4f4182b6560b653e4a0e8f6ac.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2e/ca6/632/f2eca66320f4b03d34772fe7cf3403d6.png"></div><br><h2>  Cómo escalar </h2><br>  Si alguna vez ha visto cómo se ven las características I - V de los triodos, pentodos, etc. de electrovacío, estos gráficos le resultarán familiares.  Eso es lo que estamos tratando de atrapar: la saciedad.  El límite es, cuando no arroja cuántos núcleos, el crecimiento de la productividad no se notará. <br><br>  Anteriormente, el desafío completo era procesar el 98% de las solicitudes con el menor retraso en todas las solicitudes, para mantener la curva lo más uniforme posible.  Ahora, utilizando la construcción de otra curva, encontramos el punto de funcionamiento óptimo para cada uno de los servidores. <br><br>  Para hacer esto, tome la métrica Solicitudes por segundo (RPR).  Frecuencia horizontal, vertical: el número de solicitudes procesadas por segundo, líneas: el número de núcleos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b49/5b4/1e2/b495b41e2ce0c33e84ed23b5ff3820d7.png"></div><br>  Se muestra una correlación de qué tan bien Nginx maneja las solicitudes una por una.  8 núcleos en tales pruebas se muestran mejor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0fc/73f/540/0fc73f5402df4d787ecffd3e838323d2.png"></div><br>  Este gráfico muestra claramente cuánto mejor (no mucho) Nginx se ejecuta en un solo núcleo.  Si tiene Nginx, debería considerar reducir el número de núcleos a uno si solo aloja estadísticas estáticas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/201/608/276/201608276469ea155f7d151bae839d7f.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45b/a4c/311/45ba4c311df1dc07220af9cc9c78a711.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ea/dd6/831/4eadd68312d67d4579c9596b62cd6cb1.png"></div><br>  IIS, aunque tiene el TTFB más bajo según DevTools en Chrome, logra perder tanto Nginx como Apache en una lucha seria contra la prueba de estrés de la Fundación Apache. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d95/f30/1a8/d95f301a854c9ebbd20aada507b7194c.png"></div><br>  Toda la curvatura de los gráficos se reproduce en tren. <br><br><h2>  Una especie de conclusión: </h2><br>  Sí, Apache funciona peor en los núcleos 1 y 8, y en 4 funciona un poco mejor. <br><br>  Sí, Nginx en 8 núcleos maneja mejores solicitudes una tras otra, en 1 y 4 núcleos, y funciona peor cuando hay muchas conexiones. <br><br>  Sí, IIS prefiere 4 núcleos para carga multiproceso y prefiere 8 núcleos para subproceso único.  Al final, IIS fue un poco más rápido que todos en 8 núcleos bajo alta carga, aunque todos los servidores se enjuagaron. <br><br>  Esto no es un error de medición, el error aquí no es más de + -1ms.  en retrasos y no más de + - 2-3 solicitudes por segundo para RPR. <br><br>  Los resultados, cuando 8 núcleos son peores, no son nada sorprendentes, muchos núcleos y SMT / Hyperthreading degradan severamente el rendimiento si tenemos el marco de tiempo para el que debemos completar toda la tubería. <br><br>  Ofrecemos una tarifa UltraLite <a href="https://ultravds.com/">Windows VDS</a> actualizada por 99 rublos con Windows Server 2019 Core instalado. <br> <a href="https://ultravds.com/"><img src="https://habrastorage.org/webt/ww/d4/ro/wwd4ro5_5a28hvdxyazf3enjxou.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482230/">https://habr.com/ru/post/482230/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482220/index.html">Localización de marcador de Aruco</a></li>
<li><a href="../482222/index.html">Aplicación web en Kotlin + Spring Boot + Vue.js (complemento)</a></li>
<li><a href="../482224/index.html">Cuando un diseñador necesita ser un pequeño programador</a></li>
<li><a href="../482226/index.html">Las 20 mejores aplicaciones que un proveedor de atención médica no puede perderse</a></li>
<li><a href="../482228/index.html">Escribimos una "calculadora" en C #. Parte I. Cálculo del valor, derivada, simplificación y otros gansos.</a></li>
<li><a href="../482232/index.html">StackOverflow es más que un simple depósito de respuestas a preguntas estúpidas</a></li>
<li><a href="../482234/index.html">Modelado digital a analógico y mixto en PADS Professional</a></li>
<li><a href="../482240/index.html">Desmontamos los primeros dispositivos TP-Link con Wi-Fi 6: enrutador Archer AX6000 y adaptador Archer TX3000E</a></li>
<li><a href="../482244/index.html">Resultados de la prueba de cámara oculta: iPhone, Pixel, Huawei, Samsung</a></li>
<li><a href="../482246/index.html">Respuestas correctas y anuncio del ganador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>