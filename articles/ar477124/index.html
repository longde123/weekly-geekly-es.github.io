<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ โ๏ธ ๐ค ุจูุชูููู ูู ููุตุ ๐ค๐ฝ ๐ฉ๐ผ ๐ฉ๐พโ๐คโ๐ฉ๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ุญุฏุซ ุฃููู ูุณุคูู ูุญุชุฑู ูู ุฃูุธูุฉ ูุดุจูุงุช ุงูููุจููุชุฑ (ุจุงุฎุชุตุงุฑ: ูุณุคูู ุงููุธุงู) ุ ูุญุฏุซ ูู ุฃู ุฃุฎุจุฑ ุงูุฃุณุชุงุฐ. ูุดุงุท ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุฃูุธูุฉ ุ ุจูุง ูู ุฐูู ุงูุฃูุธู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจูุชูููู ูู ููุตุ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477124/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> ููุฏ ุญุฏุซ ุฃููู ูุณุคูู ูุญุชุฑู ูู ุฃูุธูุฉ ูุดุจูุงุช ุงูููุจููุชุฑ (ุจุงุฎุชุตุงุฑ: ูุณุคูู ุงููุธุงู) ุ ูุญุฏุซ ูู ุฃู ุฃุฎุจุฑ ุงูุฃุณุชุงุฐ.  ูุดุงุท ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุฃูุธูุฉ ุ ุจูุง ูู ุฐูู ุงูุฃูุธูุฉ ุงูุชู ุชุชุทูุจ [ุจุณุจุจ] ุงูุชุฏุงุจูุฑ ุงูุฃูููุฉ ุงููุฐููุฑุฉ ุฃุนูุงู.  ูุงุชุถุญ ุฃูู ููุฐ ุจุนุถ ุงูููุช ุ ูุฌุฏุช <a href="https://www.lopp.net/bitcoin-information.html">Bitcoin</a> ูุซูุฑุฉ ููุงูุชูุงู ูููุณู ุ ููู ุฃุณุชุฎุฏููุง ููุท ุ ูููู ุฃูุถูุง ุฃุทููุช ุงูุนุฏูุฏ ูู ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ูู ุฃุฌู ูุนุฑูุฉ ููููุฉ ุงูุนูู ุจุดูู ูุณุชูู ูุน ุดุจูุฉ Bitcoin (ุฅููุง p2p ุจุนุฏ ูู ุดูุก) ูู ูุฌูุฉ ูุธุฑ ุงูุชุทููุฑ (ุฃูุง ุ ุจุงูุทุจุน ุ ูุซู ูุฐุง <code>dev</code> ุ ูุฐูู ุ ูุฑุช).  ููููู ูุง ุฃุชุญุฏุซ ุนู ุงูุชุทููุฑ ุ ูุฃูุง ุฃุชุญุฏุซ ุนู ุจูุฆุฉ ุขููุฉ ููุนุงูุฉ ููุชุทุจููุงุช. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  <em>ุชุชูุงูู</em> ุงูุชูููุงุช ุงููุงููุฉ ( <em>fintech</em> ) ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุฃูู ุงููุนูููุงุช ( <em>infosec</em> ) ููููู ุฃู ูุนูู ุงูุฃูู ุจุฏูู ุงูุซุงููุฉ ุ ูููู ููุณ ููุชุฑุฉ ุทูููุฉ.  ููุฐุง ุงูุณุจุจ ุฃุฑูุฏ ุฃู ุฃุดุงุฑู ุชุฌุฑุจุชู ููุฌููุนุฉ ุงูุฃุฏูุงุช ุงูุชู <em>ุฃุณุชุฎุฏููุง</em> ุ ูุงูุชู ุชุดูู ููุง ูู <em>fintech</em> ู <em>infosec</em> ุ ููู ุงูููุช ููุณู ุ ูููู ุงุณุชุฎุฏุงููุง ุฃูุถูุง ูุบุฑุถ ุฃูุณุน ุฃู ูุฎุชูู ุชูุงููุง.  ูู ูุฐู ุงูููุงูุฉ ุ ูู ุฃุฎุจุฑูู ูุซูุฑูุง ุนู Bitcoin ุ ูููู ุนู ูููุฐุฌ ุงูุจููุฉ ุงูุชุญุชูุฉ ูุชุทููุฑ ูุชุดุบูู ุงูุฎุฏูุงุช ุงููุงููุฉ (ูููุณ ููุท) - ุจูููุฉ ูุงุญุฏุฉ ุ ุชูู ุงูุฎุฏูุงุช ุงูุชู ุชูู "B".  ููุทุจู ูุฐุง ุนูู ููู ูู ุจูุฑุตุฉ ุจูุชูููู ูุนูู ุญุฏููุฉ ุญููุงูุงุช ุงูุดุฑูุงุช ุงููููุฐุฌูุฉ ูุฎุฏูุงุช ุดุฑูุฉ ุตุบูุฑุฉ ุฏูู ุฃู ุนููุฉ ุจูุชูููู ุจุฃู ุดูู ูู ุงูุฃุดูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุฑูุฏ ุฃู ุฃุดูุฑ ุฅูู ุฃููู ูุคูุฏ ููุจุงุฏุฆ <em>"ุงุฌุนูู ุบุจููุง ุจุณูุทูุง"</em> ู <em>"ุฃูู ูู ุฃูุซุฑ"</em> ุ ูุฐูู ุณูููู ููู ูู ุงูููุงูุฉ ูุงูููุงูุฉ ุงูููุตููุฉ ููู ุฎุตุงุฆุต ุญูู ูุฐู ุงููุจุงุฏุฆ. </p><br><p style=";text-align:right;direction:rtl">  <em>ุณููุงุฑูู ุฎูุงูู:</em> ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ูุซุงู ูุจุงุฏู ุงูุจูุชูููู.  ูุฑุฑูุง ุฃู ูุจุฏุฃ ูู ุชุจุงุฏู ุงูุฑูุจู ูุงูุฏููุงุฑ ูุงูููุฑู ููุงุจู ุนููุงุช ุงูุจูุชูููู ูุงูุนูุณ ุตุญูุญ ุ ููุฏููุง ุจุงููุนู ุญู ูุนุงู ุ ูููู ุจุงููุณุจุฉ ุฅูู ุงููููุฏ ุงูุฑูููุฉ ุงูุฃุฎุฑู ูุซู ุงููููู ูููุจ ูููู ุ ุฃู  ููุฏ ุฃุบูููุง ุฌููุน ุงููุณุงุฆู ุงููุงููููุฉ ุ ูููุงู ุชุทุจูู ุฌุงูุฒ ูุนูู ูุจูุงุจุฉ ููุฏูุน ููุฑูุจู ูุงูุฏููุงุฑ ูุงูููุฑู ูุฃูุธูุฉ ุงูุฏูุน ุงูุฃุฎุฑู.  ุฅูู ูุฑุชุจุท ุจุญุณุงุจุงุชูุง ุงููุตุฑููุฉ ููุฏูู ููุน ูู API ูุทูุจุงุชูุง ุงูููุงุฆูุฉ.  ูุฏููุง ุฃูุถูุง ุชุทุจูู ููุจ ูุนูู ููุจุงุฏู ูููุณุชุฎุฏููู ุ ูุซู ุญุณุงุจ ุงููููู ุฃู webmoney ุงููููุฐุฌู - ุงูุชุญ ุญุณุงุจูุง ูุฃุถู ุจุทุงูุฉ ููุง ุฅูู ุฐูู.  ูุชูุงุตู ูุน ุชุทุจูู ุงูุจูุงุจุฉ ุงูุฎุงุต ุจูุง ุ ุนูู ุงูุฑุบู ูู ุงุณุชุฎุฏุงู REST API ูู LAN.  ููุฐุง ูุฑุฑูุง ุชูุตูู ุนููุงุช ุงูุจูุชูููู ููู ููุณ ุงูููุช ุชุฑููุฉ ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุ ูุฃู  ูู ุงูุจุฏุงูุฉ ุชู ุชุณุฑูุน ูู ุดูุก ุนูู ุงูุตูุงุฏูู ุงูุงูุชุฑุงุถูุฉ ูู ุงูููุชุจ ุฃุณูู ุงูุทุงููุฉ ... ููุฏ ุจุฏุฃูุง ูู ุงุณุชุฎุฏุงู ุงููููุน ุ ูุจุฏุฃูุง ูุดุนุฑ ุจุงูููู ุจุดุฃู ุงูุฌููุฒูุฉ ูุงูุฃุฏุงุก. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ููุจุฏุฃ ุจุงุฎุชูุงุฑ ุงูุฎุงุฏู ุงูุฑุฆูุณู.  ูุฃู  ุงูุนูู ูู ูุซุงููุง ุตุบูุฑ ุ ููุญู ูุซู ุจุงููุถูู (OVH) ุ ูุณูุฎุชุงุฑ <a href="https://www.kimsufi.com/">ุฎูุงุฑ ููุฒุงููุฉ</a> ูุณุชุญูู ููู ุชุซุจูุช ุงููุธุงู ูู ุงูุตูุฑุฉ ุงูุฃุตููุฉ .iso ุ ูููู ูุง ููู ุ ูุณูููู ูุณู ุฃูู ุชูููููุฌูุง ุงููุนูููุงุช ุจุชุญููู ุงูุตูุฑุฉ ุงููุซุจุชุฉ ุจุงูุชุฃููุฏ.  ูุนูุฏูุง ููุจุฑ ุ ุณูุณุชุฃุฌุฑ ุนููููุง ุฎุฒุงูุฉ ููุงุจุณูุง ุชุญุช ุงูููู ูุงูููุชุงุญ ูุน ูุตูู ูุงุฏู ูุญุฏูุฏ ุ ุฃู ุฑุจูุง ุณูุจูู ุฏู ุณู ุฎุงุต ุจูุง.  ูู ุฃู ุญุงู ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ุนูุฏ ุงุณุชุฆุฌุงุฑ ุงูุญุฏูุฏ ูุชุซุจูุช ุงูุตูุฑ ุงูุฌุงูุฒุฉ ุ ููุงู ูุฑุตุฉ ูุฃู ูููู ูุฏู ูุธุงูู "ุญุตุงู ุทุฑูุงุฏุฉ ูู ุงููุถูู" ุ ููู ูู ูุนุธู ุงูุญุงูุงุช ุบูุฑ ูุตูู ูุชุชุจุนู ุ ูููู ูุชูุฏูู ุฃุฏูุงุช ุฅุฏุงุฑุฉ ุฃูุซุฑ ููุงุกูุฉ ุงูุฎุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุชุฑููุจ ุงูุฎุงุฏู</strong> </p><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ููุง.  ูุฎุชุงุฑ ุงูุญุฏูุฏ ุงูุฐู ููุงุณุจ ุงุญุชูุงุฌุงุชูุง.  ุซู ุญุฏุฏ ุตูุฑุฉ FreeBSD.  ุญุณููุง ุ ุฅูุง ุฃู ูููู ุจุงูุงุชุตุงู (ูู ุญุงูุฉ ูุถูู ุขุฎุฑ ูุฃุฌูุฒุชูุง ุงูุฎุงุตุฉ) ุนุจุฑ IPMI ุฃู ุจุงุณุชุฎุฏุงู ุดุงุดุฉ ูุฅุทุนุงู ุตูุฑุฉ .iso FreeBSD ููุชูุฒูู.  ููุชุฑููุจุงุช ุงูุฃูุฑูุณุชุฑุง ุ ูููููู ุงุณุชุฎุฏุงู <a href="https://github.com/ansible/ansible">Ansible</a> ู <a href="https://mfsbsd.vx.sk/">mfsbsd</a> .  ุงูุดูุก ุงููุญูุฏ ุ ูู ุญุงูุชูุง ูุน kimsufi ุ ุงุฎุชุฑูุง ุชุซุจูุชูุง <em>ูุฎุตุตูุง</em> ุจุญูุซ ูููู ูููุฑุตูู ูู ุงููุฑุขุฉ "ุงูุชูููุฏ" ู / "ุงูุฃูุณุงู ุงูุฑุฆูุณูุฉ" ุงูููุชูุญุฉ "ุ ุณูุชู ุชุดููุฑ ุจุงูู ูุณุงุญุฉ ุงููุฑุต ุ ูููู ุงููุฒูุฏ ุญูู ุฐูู ูุงุญููุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-m/ve/av/-mveavdklaybhokh5sznmisf7be.png"></p><br><p style=";text-align:right;direction:rtl">  ุชู ุชุซุจูุช ุงููุธุงู ุจุงูุทุฑููุฉ ุงูููุงุณูุฉ ุ ููู ุฃุชููู ุนูุฏ ูุฐุง ุงูุญุฏ ุ ูุฃูุง ููุท ูุงุญุธ ุฃูู ูุจู ุจุฏุก ุงูุชุดุบูู ุ ูุฌุจ ุงูุงูุชุจุงู ุฅูู ุฎูุงุฑุงุช <em>ุงูุชุตูุจ</em> ุงูุชู <code>bsdinstaller</code> ูู ููุงูุฉ ุงูุชุซุจูุช (ุฅุฐุง ููุช ุจุชุซุจูุช ุงููุธุงู ุจููุณู): </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pj/6w/no/pj6wnohhskxkw6vqigcucollot0.png"></p><br><p style=";text-align:right;direction:rtl">  ููุงู <a href="http://bsdadventures.com/harden-freebsd/">ูุงุฏุฉ ุฌูุฏุฉ</a> ุญูู ูุฐุง ุงูููุถูุน ุ ูุจุงุฎุชุตุงุฑ ุณุฃูุฑุฑูุง ููุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููููู ุชูููู ุงููุนููุงุช ุฃุนูุงู ุจููุณ ุงูุทุฑููุฉ ุนูู ูุธุงู ูุซุจุช ุจุงููุนู.  ููููุงู ุจุฐูู ุ ูู ุจุชุญุฑูุฑ ููู ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู ูุชูููู ูุนููุงุช kernel.  * <em>ูู ูุญุฑุฑ ูุซู ูุฐุง ูู BSD</em> </p><br><p style=";text-align:right;direction:rtl"> <code># ee /etc/rc.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">... #sec hard clear_tmp_enable="YES" syslogd_flags="-ss" sendmail_enable="NONE"</code> </pre><br><p style=";text-align:right;direction:rtl"> <code># ee /etc/sysctl.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">... #sec hard security.bsd.see_other_uids=0 security.bsd.see_other_gids=0 security.bsd.unprivileged_read_msgbuf=0 security.bsd.unprivileged_proc_debug=0 kern.randompid=$(jot -r 1 9999) security.bsd.stack_guard_page=1</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฌุฏุฑ ุฃูุถูุง ุงูุชุฃูุฏ ูู ุชุซุจูุช ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู ุงููุธุงู <a href="https://www.freebsd.org/doc/handbook/updating-upgrading-freebsdupdate.html">ูุฅููุงู ุฌููุน ุงูุชุญุฏูุซุงุช ูุงูุชุฑููุงุช</a> .  ูู ุญุงูุชูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุฒู ุงูุชุฑููุฉ ุฅูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ุ ูุฃู  ุตูุฑ ูุง ูุจู ุงูุชุซุจูุช ุณุชุฉ ุฃุดูุฑ ุฅูู ุณูุฉ ูุฑุงุก.  ุญุณููุง ุ ูุบูุฑ ูููุฐ SSH ุฅูู ูููุฐ ูุฎุชูู ุงูุชุฑุงุถููุง ุ ููุถูู ูุตุงุฏูุฉ ุงูููุชุงุญ ููุนุทูู ุจูููุฉ ูุฑูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุซู ูููู ุจุชูููู <code>aide</code> ุ ููุฑุงูุจุฉ ุญุงูุฉ ูููุงุช ุชูููู ุงููุธุงู.  ุฃูุซุฑ ููุถุบ ูููู ูุฑุงุกุฉ <a href="https://www.digitalocean.com/community/tutorials/how-to-install-aide-on-a-digitalocean-vps">ููุง</a> . </p><br><p style=";text-align:right;direction:rtl"> <code>pkg install aide</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุชุนุฏูู crontab ูุฏููุง </p><br><p style=";text-align:right;direction:rtl"> <code>crontab -e</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>06 01 * * 0-6 /root/chkaide.sh</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#! /bin/sh #chkaide.sh MYDATE=`date +%Y-%m-%d` MYFILENAME="Aide-"$MYDATE.txt /bin/echo "Aide check !! `date`" &gt; /tmp/$MYFILENAME /usr/local/bin/aide --check &gt; /tmp/myAide.txt /bin/cat /tmp/myAide.txt|/usr/bin/grep -v failed &gt;&gt; /tmp/$MYFILENAME /bin/echo "**************************************" &gt;&gt; /tmp/$MYFILENAME /usr/bin/tail -20 /tmp/myAide.txt &gt;&gt; /tmp/$MYFILENAME /bin/echo "****************DONE******************" &gt;&gt; /tmp/$MYFILENAME</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุจุชุดุบูู <a href="https://www.freebsd.org/doc/handbook/audit-config.html">ุชุฏููู ุงููุธุงู</a> </p><br><p style=";text-align:right;direction:rtl"> <code>sysrc auditd_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># service auditd start</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุชู ูุตู ููููุฉ ุฅุฏุงุฑุฉ ูุฐุง ุงูุนูู ุฌูุฏูุง ูู <a href="https://www.freebsd.org/doc/handbook/audit-administration.html">ุงูุฏููู</a> . </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููู ุจุฅุนุงุฏุฉ ุงูุชุดุบูู ูุงููุถู ูุฏููุง ูู ุงูุจุฑูุงูุฌ ุนูู ุงูุฎุงุฏู.  ูู ุฎุงุฏู ูู hypervisor ููุญุงููุงุช ุฃู ุงูุฃุฌูุฒุฉ ุงูุธุงูุฑูุฉ ุงููุงููุฉ.  ูุฐูู ุ ูู ุงูููู ุฃู ูุฏุนู ุงููุนุงูุฌ VT-x ู EPT ุฅุฐุง ููุง ูุฎุทุท ูุงุณุชุฎุฏุงู ุงููุญุงูุงุฉ ุงูุงูุชุฑุงุถูุฉ ุงููุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุตูุชู ุฅุฏุงุฑุฉ ููุญุงููุงุช ูุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ ุ ุฃุณุชุฎุฏู <a href="https://bsdstore.ru/">clevd</a> ูู <a href="https://github.com/olevole">olevole</a> ุ ุฃุชููู ูู ูุฒูุฏูุง ูู ุงูุตุญุฉ ูุงูููุงุฆุฏ ููุฐู ุงูุฃุฏุงุฉ ุงูุฑุงุฆุนุฉ! </p><br><p style=";text-align:right;direction:rtl">  <strong>ุญุงููุงุชุ</strong>  <strong>ูุฑุฉ ุฃุฎุฑู ุนุงูู ูููุงุก ุฃู ูุงุฐุงุ</strong> </p><br><p style=";text-align:right;direction:rtl">  ููู ูุง.  <a href="https://www.freebsd.org/doc/handbook/jails.html">FreeBSD Jails</a> ูู ุฃุฏุงุฉ ุญุงููุงุช ูุจูุฑุฉ ุ ูููู <code>cbsd</code> ุงููุฐููุฑุฉ <code>cbsd</code> ูุฐู ุงูุญุงููุงุช ุ ุงูุชู ูู ุงุณู ุงูุฎูุงูุง. </p><br><p style=";text-align:right;direction:rtl">  ุชุนุชุจุฑ ุงูุฎููุฉ ุญูุงู ูุนุงููุง ููุบุงูุฉ ูุจูุงุก ุงูุจููุฉ ุงูุชุญุชูุฉ ููุฌููุนุฉ ูุชููุนุฉ ูู ุงูุฃุบุฑุงุถ ุ ููุง ูุชุทูุจ ูู ุงูููุงูุฉ ุนุฒููุง ุชุงููุง ููุฎุฏูุงุช ุฃู ุงูุนูููุงุช ุงููุฑุฏูุฉ.  ูุฐุง ูู ุฃุณุงุณูุง ุงุณุชูุณุงุฎ ูููุธุงู ุงููุถูู ุ ูููู ูุง ูุชุทูุจ ูุญุงูุงุฉ ุงูุชุฑุงุถูุฉ ูุงููุฉ ููุฃุฌูุฒุฉ.  ููุง ูุชู ุฅููุงู ุงูููุงุฑุฏ ุงููุงุชุฌุฉ ุนู ุฐูู ุนูู "ูุธุงู ุงูุชุดุบูู ุงูุถูู" ุ ูููู ููุท ุนูู ุงูุนูู ุงูููุฌุฒ.  ุนูุฏ ุงุณุชุฎุฏุงู ุงูุฎูุงูุง ููุงุญุชูุงุฌุงุช ุงูุฏุงุฎููุฉ ุ ูุนุฏ ูุฐุง ุญููุง ููุงุณุจูุง ููุบุงูุฉ ููุงุณุชุฎุฏุงู ุงูุฃูุซู ููููุฑุฏ - ูููู ููุฌููุนุฉ ูู ุงูุฎูุงูุง ุงูููุฌูุฏุฉ ุนูู ุฎุงุฏู ุญุฏูุฏ ูุงุญุฏ ุฃู ุชุณุชุฎุฏู ูู ููุฑุฏ ุฎุงุฏูู ุจุดูู ูุฑุฏู ุฅุฐุง ูุฒู ุงูุฃูุฑ.  ุจุงููุธุฑ ุฅูู ุฃู ุงูุฎุฏูุงุช ุงููุฑุนูุฉ ุงููุฎุชููุฉ ุชุญุชุงุฌ ุนุงุฏุฉ ุฅูู ุฎุฏูุงุช ุฅุถุงููุฉ.  ุงูููุงุฑุฏ ูู ุฃููุงุช ูุฎุชููุฉ ุ ููููู ุงุณุชุฎุฑุงุฌ ุฃูุตู ูุฏุฑ ูู ุงูุฃุฏุงุก ูู ุฎุงุฏู ูุงุญุฏ ุ ุฅุฐุง ููุช ุชุฎุทุท ูุฎุฒู ุงูุฎูุงูุง ุจูู ุงูุฎูุงุฏู ุจุดูู ุตุญูุญ.  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูููู ููุฎูุงูุง ุฃูุถูุง ุชุนููู ุญุฏูุฏ ุนูู ุงูููุฑุฏ ุงููุณุชุฎุฏู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/95c/817/901/95c8179015447a58c383f4a4a81a510d.gif" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  <strong>ูุงุฐุง ุนู ุงููุญุงูุงุฉ ุงูุงูุชุฑุงุถูุฉ ุงููุงููุฉุ</strong> </p><br><p style=";text-align:right;direction:rtl">  ุญุณุจ ุนููู ุ ุชุฏุนู <code>cbsd</code> ุนูู ุฃุฌูุฒุฉ <code>bhyve</code> ู XEN Hypervisor.  ุฃูุง ูู ุชุณุชุฎุฏู ุงูุซุงููุฉ ุ ูููู ุงูุฃูู ูู ุจุฑูุงูุฌ <a href="https://www.freebsd.org/doc/handbook/virtualization-host-bhyve.html">ูุจุฑููุณุฑ</a> ุตุบูุฑ ูุณุจูุง <a href="https://www.freebsd.org/doc/handbook/virtualization-host-bhyve.html">ูู ูุฑู</a> .  <code>bhyve</code> ูู ูุซุงู ูุงุณุชุฎุฏุงู <code>bhyve</code> ูู ุงููุซุงู ุฃุฏูุงู. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุชุซุจูุช ูุชูููู ุจูุฆุฉ ุงููุถูู</strong> </p><br><p style=";text-align:right;direction:rtl">  ูุญู ูุณุชุฎุฏู FS <a href="https://www.freebsd.org/doc/handbook/zfs.html">ZFS</a> .  ูุฐู ุฃุฏุงุฉ ูููุฉ ููุบุงูุฉ ูุฅุฏุงุฑุฉ ูุณุงุญุฉ ุงูุฎุงุฏู.  ุจูุถู ZFS ุ ููููู ูุจุงุดุฑุฉ ุฅูุดุงุก ุตูุงุฆู ูู ุงูุชููููุงุช ุงููุฎุชููุฉ ูุจุงุดุฑุฉ ูู ุงูุฃูุฑุงุต ุ ูุชูุณูุน ูุณุงุญุฉ "ุงูุณุงุฎูุฉ" ุ ูุชุบููุฑ ุงูุฃูุฑุงุต ุงูููุชุฉ ุ ูุฅุฏุงุฑุฉ ุงูููุทุงุช ูุฃูุซุฑ ูู ุฐูู ุจูุซูุฑ ุงูุชู ูููู ูุตููุง ูู ุณูุณูุฉ ูู ุงูููุงูุงุช ุจุดูู ุญููู.  ุฏุนูุง ูุนูุฏ ุฅูู ุฎุงุฏููุง ูุฃูุฑุงุตู.  ูู ุจุฏุงูุฉ ุงูุชุซุจูุช ุนูู ุงูุฃูุฑุงุต ุ ุชุฑููุง ูุณุงุญุฉ ุฎุงููุฉ ููุฃูุณุงู ุงููุดูุฑุฉ.  ููุงุฐุง ูุฐุง  ูุฐุง ุญุชู ูุฑุชูุน ุงููุธุงู ุชููุงุฆููุง ููุณุชูุน ุฅูู SSH. </p><br><p style=";text-align:right;direction:rtl"> <code>gpart add -t freebsd-zfs /dev/ada0</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>/dev/ada0p4 added!</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฃุถู ูุณู ุงููุฑุต ุฅูู ุงููุณุงุญุฉ ุงููุชุจููุฉ </p><br><p style=";text-align:right;direction:rtl"> <code>geli init /dev/ada0p4</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฏูุน ูููุฉ ุงููุฑูุฑ ุงูุชุดููุฑ ูุฏููุง </p><br><p style=";text-align:right;direction:rtl"> <code>geli attach /dev/ada0p4</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุฑุฉ ุฃุฎุฑู ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ููุฏููุง ุงูุฌูุงุฒ /dev/ada0p4.eli - ูุฐู ูู ุงููุณุงุญุฉ ุงููุดูุฑุฉ ูุฏููุง.  ุซู ููุฑุฑ ููุณ ุงูุฃูุฑ ุจุงููุณุจุฉ ูู / dev / ada1 ูุงูุฃูุฑุงุต ุงูุฃุฎุฑู ูู ุงูุตููู.  ูุฅูุดุงุก <a href="https://www.freebsd.org/doc/handbook/zfs-zpool.html">ุชุฌูุน ZFS</a> ุฌุฏูุฏ. </p><br><p style=";text-align:right;direction:rtl">  <code>zpool create vms mirror /dev/ada0p4.eli /dev/ada1p4.eli /dev/ada3p4.eli</code> - ุญุณููุง ุ ุงูุขู ูุฏููุง ูุฌููุนุฉ ุงููุชุงู ุงูุฏููุง ุฌุงูุฒุฉ.  ุตููู ูุฑุต ููุง ูุณุฎ ูุชุทุงุจูุฉ ูู ุญุงูุฉ ูุดู ุฃุญุฏ ุงูุซูุงุซุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ุนูู "ุงูุชุฌูุน" ุงูุฌุฏูุฏ </p><br><p style=";text-align:right;direction:rtl"> <code>zfs create vms/jails</code> </p> <br><p style=";text-align:right;direction:rtl">  <code>pkg install cbsd</code> - ูู ุจุชุดุบูู ุงูุฃูุฑ ุ ููู ุจุชุซุจูุช ุงูุฅุฏุงุฑุฉ <code>pkg install cbsd</code> . </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุชุซุจูุช <code>cbsd</code> ุ ูุฌุจ ุชููุฆุชู: </p><br><p style=";text-align:right;direction:rtl"> <code># env workdir="/vms/jails" /usr/local/cbsd/sudoexec/initenv</code> </p> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ูุฌูุจ ุนูู ูุฌููุนุฉ ูู ุงูุฃุณุฆูุฉ ุ ูุนุธููุง ุฅุฌุงุจุงุช ุจุดูู ุงูุชุฑุงุถู. </p><br><p style=";text-align:right;direction:rtl">  * ุฅุฐุง ููุช ุชุณุชุฎุฏู ุงูุชุดููุฑ ุ ููู ุงูููู ุฃูุง ูุจุฏุฃ <code>cbsdd</code> ุงูุฎูู <code>cbsdd</code> ุชููุงุฆููุง ุญุชู ุชููู ุจูู ุชุดููุฑ ุงูุฃูุฑุงุต ูุฏูููุง ุฃู ุชููุงุฆููุง (ูู ูุซุงููุง ุ ูููู zabbix ุจูุฐุง) </p><br><p style=";text-align:right;direction:rtl">  ** ุฃูุถูุง ุ ุฃูุง ูุง ุฃุณุชุฎุฏู NAT ูู <code>cbsd</code> ุ ููููู <code>cbsd</code> ุจุชููููู ุจููุณู ูู <code>pf</code> </p><br><p style=";text-align:right;direction:rtl"> <code># sysrc pf_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># ee /etc/pf.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">IF_PUBLIC="em0" IP_PUBLIC="1.23.34.56" JAIL_IP_POOL="192.168.0.0/24" #WHITE_CL="{ 127.0.0.1 }" icmp_types="echoreq" set limit { states 20000, frags 20000, src-nodes 20000 } set skip on lo0 scrub in all #NAT for jails nat pass on $IF_PUBLIC from $JAIL_IP_POOL to any -&gt; $IP_PUBLIC ## Bitcoin network port forward IP_JAIL="192.168.0.1" PORT_JAIL="{8333}" rdr pass on $IF_PUBLIC proto tcp from any to $IP_PUBLIC port $PORT_JAIL -&gt; $IP_JAIL</code> </pre><br><p style=";text-align:right;direction:rtl"> <code># service pf start</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># pfctl -f /etc/pf.conf</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุนุฏ ุชูููู ุณูุงุณุงุช ุฌุฏุงุฑ ุงูุญูุงูุฉ ุฃูุถูุง ููุถูุนูุง ูููุตููุง ุ ูุฐูู ูู ุฃุนูู ูู ุชูููู ุณูุงุณุงุช BLOCK ALL ูุฅุนุฏุงุฏ ููุงุฆู ุจูุถุงุก ุ ููููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ูุฑุงุกุฉ <a href="https://www.freebsd.org/doc/handbook/firewalls-pf.html">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> ุฃู ุฃู ุนุฏุฏ ูุจูุฑ ูู ุงูููุงูุงุช ุงููุชููุฑุฉ ุนูู Google. </p><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ููุฏ ูููุง ุจุชุซุจูุช cbsd ุ ููุฏ ุญุงู ุงูููุช ูุฅูุดุงุก ุฃูู ูุฑุดุฉ ุนูู ูุฏููุง - ุดูุทุงู ุงูุจูุชูููู ูู ููุต! </p><br><p style=";text-align:right;direction:rtl"> <code>cbsd jconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jf/yn/l5/jfynl5o0yozaua314r4e65yxy0y.png"></p><br><p style=";text-align:right;direction:rtl">  ููุง ูุฑู ุงูุญูุงุฑ ุฅูุดุงุก ุงูุฎููุฉ.  ุจุนุฏ ุชุนููู ูู ุงูููู ุ ูู ุจุฅูุดุงุก! </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุฅูุดุงุก ุงูุฎููุฉ ุงูุฃููู ุ ูุฌุจ ุนููู ุงุฎุชูุงุฑ ูุง ุชุฑูุฏ ุงุณุชุฎุฏุงูู ูุฃุณุงุณ ููุฎูุงูุง.  ุญุฏุฏ ูุฌููุนุฉ ุงูุชูุฒูุน ูู ูุณุชูุฏุน FreeBSD ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>repo</code> .  ูุชู ูุฐุง ุงูุงุฎุชูุงุฑ ููุท ุนูุฏ ุฅูุดุงุก ุงูุฎููุฉ ุงูุฃููู ูู ุฅุตุฏุงุฑ ูุนูู (ููููู ุงุณุชุถุงูุฉ ุฎูุงูุง ูู ุฃู ุฅุตุฏุงุฑุงุช ุฃูุฏู ูู ุงูุฅุตุฏุงุฑ ุงููุถูู). </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุชุซุจูุช ูู ุดูุก - ูู ุจุชุดุบูู ุงูุฎููุฉ! </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart bitcoind</code> </p> <br><p style=";text-align:right;direction:rtl">  ููููุง ูุญุชุงุฌ ุฅูู ุชุซุจูุช ุงูุจุฑูุงูุฌ ูู ุงูููุต. </p><br><p style=";text-align:right;direction:rtl"> <code># jls</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> JID IP Address Hostname Path 1 192.168.0.1 bitcoind.space.com /zroot/jails/jails/bitcoind</code> </pre> <br><p style=";text-align:right;direction:rtl">  <code>jexec bitcoind</code> ูููุตูู ุงูู ูุญุฏุฉ ุงูุฎููุฉ </p><br><p style=";text-align:right;direction:rtl">  ูุจุงููุนู ุฏุงุฎู ุงูุฎููุฉ ุ ูููู ุจุชุซุจูุช ุงูุจุฑูุงูุฌ ุจุงุณุชุฎุฏุงู ุชุจุนูุงุชู (ูุจูู ูุธุงููุง ุงููุถูู ูุธูููุง) </p><br><p style=";text-align:right;direction:rtl"> <code>bitcoind:/@[15:25] # pkg install bitcoin-daemon bitcoin-utils</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>bitcoind:/@[15:30] # sysrc bitcoind_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>bitcoind:/@[15:30] # service bitcoind start</code> </p> <br><p style=";text-align:right;direction:rtl">  ููุฌุฏ ุจูุชูููู ูู ุงูุฎููุฉ ุ ููููุง ุจุญุงุฌุฉ ุฅูู ุฅุฎูุงุก ุงููููุฉ ุ ูุฃููุง ูุฑูุฏ ุงูุงุชุตุงู ุจุจุนุถ ุงูุฎูุงูุง ุนุจุฑ ุดุจูุฉ TOP.  ุจุดูู ุนุงู ุ ูุฏููุง ุฎุทุท ูุชุญููู ูุนุธู ุงูุฎูุงูุง ุจุงุณุชุฎุฏุงู ุจุฑุงูุฌ ูุดุจููุฉ ููุท ูู ุฎูุงู ูููู.  ุจูุถู <code>pf</code> ููููู ุชุนุทูู NAT ููุฌููุนุฉ ูุนููุฉ ูู ุนูุงููู IP ุนูู ุงูุดุจูุฉ ุงููุญููุฉ ุ ูุงูุณูุงุญ NAT ููุท ูุนูุฏุฉ TOR ุงูุฎุงุตุฉ ุจูุง.  ูุจุงูุชุงูู ุ ุญุชู ูู ุฏุฎูุช ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุฅูู ุงูุฎููุฉ ุ ูุนูู ุงูุฃุฑุฌุญ ูู ุชุชุตู ุจุงูุนุงูู ุงูุฎุงุฑุฌู ุ ูุฅุฐุง ุญุฏุซ ุฐูู ุ ููู ุชูุดู ุนู ุนููุงู IP ุงูุฎุงุต ุจุฎุงุฏููุง.  ูุฐูู ุ ูููู ุจุฅูุดุงุก ุฎููุฉ ุฃุฎุฑู ุ ูุฎุฏูุงุช "ุฅุนุงุฏุฉ ุงูุชูุฌูู" ูุฎุฏูุฉ ".onion" ูููููู ูููุตูู ุฅูู ุงูุฅูุชุฑูุช ุฅูู ุฎูุงูุง ูุฑุฏูุฉ. </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart tor</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec tor</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[15:38] # pkg install tor</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[15:38] # sysrc tor_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[15:38] # ee /usr/local/etc/tor/torrc</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุถุน ุงูุงุณุชูุงุน ุนูู ุงูุนููุงู ุงููุญูู (ูุชุงุญ ูุฌููุน ุงูุฎูุงูุง) </p><br><p style=";text-align:right;direction:rtl"> <code>SOCKSPort 192.168.0.2:9050</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุง ุงูุฐู ูุง ูุฒุงู ูู ุนุฏุงุฏ ุงูููููุฏูู ููุณุนุงุฏุฉ ุงููุงููุฉ.  ูุนู ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุฎุฏูุฉ ููููุนูุง ุ ุฑุจูุง ููุณุช ูุงุญุฏุฉ.  ูู ุจุชุดุบูู nginx ุ ูุงูุฐู ุณูููู ุจูุซุงุจุฉ ูููู ุนูุณู ูุงูุนูุงูุฉ ุจุชุฌุฏูุฏ ุดูุงุฏุงุช Let's Encrypt </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart nginx-rev</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec nginx-rev</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>nginx-rev:/@[15:47] # pkg install nginx py36-certbot</code> </p> <br><p style=";text-align:right;direction:rtl">  <em>ูุงูุขู ูุถุน 150 ููุบุงุจุงูุช ูู ุงูุชุจุนูุงุช ูู ููุต.</em>  <em>ูุงููุถูู ูุง ูุฒุงู ูุธููุงู.</em> </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุนูุฏ ุฅูู ุชููุฆุฉ nginx ูุงุญููุง ุ ูุญุชุงุฌ ุฅูู ุฌูุน ุฎููุชูู ุฃุฎุฑููู ูู ุฃุฌู ุจูุงุจุฉ ุงูุฏูุน ุงูุฎุงุตุฉ ุจูุง ุฅูู nodejs ูุงูุตุฏุฃ ูุชุทุจูู ููุจ ุ ูุงูุฐู ููุฌุฏ ูุณุจุจ ูุง ุนูู apache ู pkhp ุ ูููุงู ุญุงุฌุฉ ุฃูุถูุง ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช MySQL ููุฃุฎูุฑ. </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart paygw</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec paygw</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>paygw:/@[15:55] # pkg install git node npm</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>paygw:/@[15:55] # curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh</code> </p> <br><p style=";text-align:right;direction:rtl">  <em>... ู 380 ููุบุงุจุงูุช ุฃุฎุฑู ูู ุงูุญุฒู ูู ุนุฒูุฉ</em> </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูููู ุจุฒูุงุฏุฉ ุชุทุจูููุง ูู ุฎูุงู ุจูุงุจุฉ ูุชุดุบููู. </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart webapp</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec webapp</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>webapp:/@[16:02] # pkg install mariadb104-server apache24 php74 mod_php74 php74-pdo_mysql</code> </p> <br><p style=";text-align:right;direction:rtl">  <em>ุญุฒู 450 ููุบุงุจุงูุช.</em>  <em>ูู ุงูููุต.</em> </p><br><p style=";text-align:right;direction:rtl">  ูุญู ููุง ูููุฑ ูููุทูููุฑ ุฅููุงููุฉ ุงููุตูู ุฅูู ุงููุทูุฑ ุนุจุฑ SSH ูุจุงุดุฑุฉู ุฅูู ุงูุฎููุฉ ุ ูุณูููููู ุจูู ุดูุก ููุงู: </p><br><p style=";text-align:right;direction:rtl"> <code>webapp:/@[16:02] # ee /etc/ssh/sshd_config</code> </p> <br><p style=";text-align:right;direction:rtl">  <code>Port 2267</code> - ุชุบููุฑ ูููุฐ ุฎููุฉ SSH ุฅูู ุฃู ุชุนุณูู </p><br><p style=";text-align:right;direction:rtl"> <code>webapp:/@[16:02] # sysrc sshd_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>webapp:/@[16:02] # service sshd start</code> </p> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุงูุฎุฏูุฉ ููุฏ ุงูุชุดุบูู ุ ูุจูู ุฅุถุงูุฉ ูุงุนุฏุฉ ูู ุฌุฏุงุฑ ุงูุญูุงูุฉ <code>pf</code> </p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุฑู ูุง ูุฏููุง IP ูู ุงูุฎูุงูุง ูููู ูุจุฏู ูุฏููุง "lokalka" </p><br><p style=";text-align:right;direction:rtl"> <code># jls</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> JID IP Address Hostname Path 1 192.168.0.1 bitcoind.space.com /zroot/jails/jails/bitcoind 2 192.168.0.2 tor.space.com /zroot/jails/jails/tor 3 192.168.0.3 nginx-rev.space.com /zroot/jails/jails/nginx-rev 4 192.168.0.4 paygw.space.com /zroot/jails/jails/paygw 5 192.168.0.5 webapp.my.domain /zroot/jails/jails/webapp</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฅุถุงูุฉ ูุงุนุฏุฉ </p><br><p style=";text-align:right;direction:rtl"> <code># ee /etc/pf.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">## SSH for web-Devs IP_JAIL="192.168.0.5" PORT_JAIL="{ 2267 }" rdr pass on $IF_PUBLIC proto tcp from any to $IP_PUBLIC port $PORT_JAIL -&gt; $IP_JAIL</code> </pre><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ูุธุฑูุง ููุฌูุฏูุง ููุง ุ ุณูุถูู ููุณ ุงููุงุนุฏุฉ ุจุดุฃู ุงููููู ุงูุนูุณู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">## web-ports for nginx-rev IP_JAIL="192.168.0.3" PORT_JAIL="{ 80, 443 }" rdr pass on $IF_PUBLIC proto tcp from any to $IP_PUBLIC port $PORT_JAIL -&gt; $IP_JAIL</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code># pfctl -f /etc/pf.conf</code> </p> <br><p style=";text-align:right;direction:rtl">  <strong>ุญุณูุง ุ ุงูุขู ููููุง ุนู bitcoins</strong> </p><br><p style=";text-align:right;direction:rtl">  ูุง ูุฏููุง - ูุฏููุง ุชุทุจูู ููุจ ูููู ุงููุตูู ุฅููู ูู ุงูุฎุงุฑุฌ ุ ููุชูุงุตู ูุญูููุง ูู ุฎูุงู ุจูุงุจุฉ ุงูุฏูุน ุงูุฎุงุตุฉ ุจูุง.  ูุญุชุงุฌ ุงูุขู ุฅูู ุฅุนุฏุงุฏ ุจูุฆุฉ ุนูู ููุชูุงุนู ูุน ุดุจูุฉ <code>bitcoind</code> ููุณูุง - ุนูุฏุฉ <code>bitcoind</code> ูู ูุฌุฑุฏ ุดูุทุงู ูุฏุนู ูุณุฎุฉ ูุญููุฉ ูู ุณูุณูุฉ ุงูููุงุชูุญ ุงูุญุงููุฉ.  ูุญุชูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุฎูู ุนูู ูุธููุฉ RPC ูุงููุญูุธุฉ ุ ูููู ููุงู "ุฃุบููุฉ" ุฃูุซุฑ ููุงุกูุฉ ูุชุทููุฑ ุงูุชุทุจููุงุช.  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุฑุฑูุง ูุถุน <code>electrum</code> - ูุฐุง ูู ูุญูุธุฉ CLI.  ุณูู ูุณุชุฎุฏู <a href="https://electrum.org/">ูุฐู ุงููุญูุธุฉ</a> ูู "ุชุฎุฒูู ุจุงุฑุฏ" ูุนููุงุชูุง ุงูุขููุฉ - ุจุดูู ุนุงู ุ ุชูู ุงูุนููุงุช ุงูุชู ุณุชุญุชุงุฌ ุฅูู ุชุฎุฒูููุง "ุฎุงุฑุฌ" ุงููุธุงู ุงูุฐู ูููู ูููุณุชุฎุฏููู ุงููุตูู ุฅููู ูุจุนูุฏูุง ุนู ุงูุฌููุน.  ูุฏูู ุฃูุถุง ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ ุ ูุฐูู ูุญู ูุณุชุฎุฏู ููุณ ุงููุญูุธุฉ ุนูู ูููุนูุง <br>  ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงููุญูููุฉ.  ุจูููุง ุณูุณุชุฎุฏู ุงูุฅููุชุฑูู ูุน ุงูุฎูุงุฏู ุงูุนุงูุฉ ุ ููู ููุช ูุงุญู ูู ุฎููุฉ ุฃุฎุฑู ุ ุณูููู ุจุฑูุน <a href="https://github.com/kyuupichan/electrumx">ElectrumX</a> ุ ุจุญูุซ ูุง ูุนุชูุฏ ุนูู ุฃู ุดุฎุต ุนูู ุงูุฅุทูุงู. </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart electrum</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec electrum</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>electrum:/@[8:45] # pkg install py36-electrum</code> </p> <br><p style=";text-align:right;direction:rtl">  <em>700 ููุบุงุจุงูุช ุฃุฎุฑู ูู ุงูุจุฑุงูุฌ ูู ููุต ูุฏููุง</em> </p><br><p style=";text-align:right;direction:rtl"> <code>electrum:/@[8:53] # adduser</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Username: wallet Full name: Uid (Leave empty for default): Login group [wallet]: Login group is wallet. Invite wallet into other groups? []: Login class [default]: Shell (sh csh tcsh nologin) [sh]: tcsh Home directory [/home/wallet]: Home directory permissions (Leave empty for default): Use password-based authentication? [yes]: no Lock out the account after creation? [no]: Username : wallet Password : &lt;disabled&gt; Full Name : Uid : 1001 Class : Groups : wallet Home : /home/wallet Home Mode : Shell : /bin/tcsh Locked : no OK? (yes/no): yes adduser: INFO: Successfully added (wallet) to the user database. Add another user? (yes/no): no Goodbye! electrum:/@[8:53] # su wallet</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>electrum:/@[8:53] # su wallet</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>wallet@electrum:/ % electrum-3.6 create</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">{ "msg": "Please keep your seed in a safe place; if you lose it, you will not be able to restore your wallet.", "path": "/usr/home/wallet/.electrum/wallets/default_wallet", "seed": "jealous win pig material ribbon young punch visual okay cactus random bird" }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฃูุดุฃูุง ูุญูุธุฉ. </p><br><p style=";text-align:right;direction:rtl"> <code>wallet@electrum:/ % electrum-3.6 listaddresses</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[ "18WEhbjvMLGRMfwudzUrUd25U5C7uZYkzE", "14XHSejhxsZNDRtk4eFbqAX3L8rftzwQQU", "1KQXaN8RXiCN1ne9iYngUWAr6KJ6d4pPas", ... "1KeVcAwEYhk29qEyAfPwcBgF5mMMoy4qjw", "18VaUuSeBr6T2GwpSHYF3XyNgLyLCt1SWk" ]</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>wallet@electrum:/ % electrum-3.6 help</code> </p> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุขู ูุตุงุนุฏูุง ุ ุณูุชูููู ููุท ุนุฏุฏ ูุญุฏูุฏ ูู ุงูุฃุดุฎุงุต ูู ุงูุงุชุตุงู ุจูุญูุธุชูุง <em>ุนูู ุงูุณูุณูุฉ</em> .  ูู ุฃุฌู ุนุฏู ูุชุญ ุงููุตูู ูู ุงูุฎุงุฑุฌ ุฅูู ูุฐู ุงูุฎููุฉ ุ ุณุชุญุฏุซ ุงุชุตุงูุงุช SSH ูู ุฎูุงู TOR (ูุซู ูุฐุง ุงูุฅุตุฏุงุฑ ุงููุงูุฑูุฒู ูู VPN).  ูุจุฏุฃ ุชุดุบูู SSH ูู ุงูุฎููุฉ ุ ููู ูุง ุชููุณ pf.conf ุนูู ุงููุถูู. </p><br><p style=";text-align:right;direction:rtl"> <code>electrum:/@[9:00] # sysrc sshd_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>electrum:/@[9:00] # service sshd start</code> </p> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุขู ุจุฅููุงู ุชุดุบูู ุงููุตูู ุฅูู ุงูุฅูุชุฑูุช ุฅูู ุงูุฎููุฉ ุจุงุณุชุฎุฏุงู ุงููุญูุธุฉ.  ุณูููุญู ุนููุงู IP ูู ูุณุงุญุฉ ุดุจูุฉ ูุฑุนูุฉ ุฃุฎุฑู ูุง ุชุณุชูุฏ ุฅูู NAT.  ุฃููุงู ุ ูู ุจุชุบููุฑ <code>/etc/pf.conf</code> ุนูู ุงููุถูู </p><br><p style=";text-align:right;direction:rtl"> <code># ee /etc/pf.conf</code> </p> <br><p style=";text-align:right;direction:rtl">  <code>JAIL_IP_POOL="192.168.0.0/24"</code> ุชุบููุฑ ุฅูู <code>JAIL_IP_POOL="192.168.0.0/25"</code> ุ ูุจุงูุชุงูู ูุฅู ุฌููุน ุงูุนูุงููู 192.168.0.126-255 ูู ูููู ููุง ูุตูู ูุจุงุดุฑ ุฅูู ุงูุฅูุชุฑูุช.  ูููุงู ููุน ูู ุดุจูุฉ "ูุฌูุฉ ุงูููุงุก" ุงูุดุจูุฉ.  ููุจูู ุญูู NAT ููุง ูุงู </p><br><p style=";text-align:right;direction:rtl"> <code>nat pass on $IF_PUBLIC from $JAIL_IP_POOL to any -&gt; $IP_PUBLIC</code> </p> <br><p style=";text-align:right;direction:rtl">  ุงูุญูููุฉ ุงูุฒุงุฆุฏุฉ ููููุงุนุฏ </p><br><p style=";text-align:right;direction:rtl"> <code># pfctl -f /etc/pf.conf</code> </p> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฎุฐ ููุตูุง </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jconfig jname=electrum</code> </p> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/mj/zo/ui/mjzouia2v_lhuzln_o9inimlwca.png"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/_x/7-/c9/_x7-c9zdmlojjeqrpzfmv2j5fpc.png"></p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">jset mode=quiet jname=electrum ip4_addr="192.168.0.200" Remove old IP: /sbin/ifconfig em0 inet 192.168.0.6 -alias Setup new IP: /sbin/ifconfig em0 inet 192.168.0.200 alias ip4_addr: 192.168.0.200</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ููู ุงููุธุงู ููุณู ุณูุชููู ุนู ุงูุนูู ูู ุฃุฌููุง.  ููุน ุฐูู ุ ูููููุง ุชุญุฏูุฏ ูููู ุงููุธุงู.  ูููู ููุงู ุดูุก ูุงุญุฏ ุ ููู ุนูู TOR ุ ููุฌุฏ ุจุฑููุณู SOCKS5 ุ ููุฑุงุญุชู ุณูููู ูุฏููุง ูููู HTTP ุฃูุถูุง. </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart polipo</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec polipo</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>polipo:/@[9:28] # pkg install polipo</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>polipo:/@[9:28] # ee /usr/local/etc/polipo/config</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">socksParentProxy = "192.168.0.2:9050" socksProxyType = socks5</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>polipo:/@[9:42] # sysrc polipo_enable=YES</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>polipo:/@[9:43] # service polipo start</code> </p> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ููุฌุฏ ุงูุขู ูู ูุธุงููุง ููููุงู ุ ูููุงููุง ููุชุฌ ุนู ุทุฑูู TOR: socks5: //192.168.0.2: 9050 ู <a href="http://192.168.0.6:8123/">http://192.168.0.6:8123</a> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ููููู ุชุฎุตูุต ุจูุฆุฉ ูุญูุธุชูุง </p><br><p style=";text-align:right;direction:rtl"> <code># jexec electrum</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>electrum:/@[9:45] # su wallet</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>wallet@electrum:/ % ee ~/.cshrc</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#in the end of file proxy config setenv http_proxy http://192.168.0.6:8123 setenv https_proxy http://192.168.0.6:8123</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณูุง ุ ุงูุขู ุณูู ุชุนูู ูุฐููุฉ ูู ุชุญุช ูููู.  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุชุซุจูุช ุงูุญุฒู ุ ููู ุงูุฌุฏูุฑ ุงูุฅุถุงูุฉ ุฅูู <code>/usr/local/etc/pkg.conf</code> ูู ุชุญุช ุฌุฐุฑ ุงูุฎููุฉ </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">pkg_env: { http_proxy: "http://my_proxy_ip:8123", }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ููุฏ ุญุงู ุงูููุช ูุฅุถุงูุฉ ุฎุฏูุฉ TOR ุงููุฎููุฉ ูุนููุงู ูุฎุฏูุฉ SSH ุงูุฎุงุตุฉ ุจูุง ูู ุฎููุฉ ุงููุญูุธุฉ. </p><br><p style=";text-align:right;direction:rtl"> <code># jexec tor</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[9:59] # ee /usr/local/etc/tor/torrc</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">HiddenServiceDir /var/db/tor/electrum/ HiddenServicePort 22 192.168.0.200:22</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:01] # mkdir /var/db/tor/electrum</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:01] # chown -R _tor:_tor /var/db/tor/electrum</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:01] # chmod 700 /var/db/tor/electrum</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:03] # service tor restart</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:04] # cat /var/db/tor/electrum/hostname</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">mdjus4gmduhofwcso57b3zl3ufoitguh2knitjco5cmgrokpreuxumad.onion</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูู ุนููุงู ุงุชุตุงููุง.  ุฏุนููุง ุชุญูู ูู ุงูุฌูุงุฒ ุงููุญูู.  ููู ุนููู ุฃููุงู ุฅุถุงูุฉ ููุชุงุญ SSH: </p><br><p style=";text-align:right;direction:rtl"> <code>wallet@electrum:/ % mkdir ~/.ssh</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>wallet@electrum:/ % ee ~/.ssh/authorized_keys</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBAG9Fk2Lqi4GQ8EXZrsH3EgSrVIQPQaAlS38MmJLBabihv9KHIDGXH7r018hxqLNNGbaJWO/wrWk7sG4T0yLHAbdQAFsMYof9kjoyuG56z0XZ8qaD/X/AjrhLMsIoBbUNj0AzxjKNlPJL4NbHsFwbmxGulKS0PdAD5oLcTQi/VnNdU7iFw== user@local</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณูุง ุ ูู ุฌูุงุฒ ููููุณ ุงูุนููู </p><br><p style=";text-align:right;direction:rtl"> <code>user@local ~$ nano ~/.ssh/config</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#remote electrum wallet Host remotebtc User wallet Port 22 Hostname mdjus4gmduhofwcso57b3zl3ufoitguh2knitjco5cmgrokpreuxumad.onion ProxyCommand /bin/ncat --proxy localhost:9050 --proxy-type socks5 %h %p</code> </pre><br><p style=";text-align:right;direction:rtl">  Connect <em>(ููู ูุนูู ูุฐุง ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุจุฑูุงูุฌ ุฎูู TOR ูุญูู ูุณุชูุน ุฅูู 9050)</em> </p><br><p style=";text-align:right;direction:rtl"> <code>user@local ~$ ssh remotebtc</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">The authenticity of host 'mdjus4gmduhofwcso57b3zl3ufoitguh2knitjco5cmgrokpreuxumad.onion (&lt;no hostip for proxy command&gt;)' can't be established. ECDSA key fingerprint is SHA256:iW8FKjhVF4yyOZB1z4sBkzyvCM+evQ9cCL/EuWm0Du4. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'mdjus4gmduhofwcso57b3zl3ufoitguh2knitjco5cmgrokpreuxumad.onion' (ECDSA) to the list of known hosts. FreeBSD 12.1-RELEASE-p1 GENERIC To save disk space in your home directory, compress files you rarely use with "gzip filename". -- Dru &lt;genesis@istar.ca&gt; wallet@electrum:~ % logout</code> </pre><br><p style=";text-align:right;direction:rtl">  ุงููุฌุงุญ! </p><br><p style=";text-align:right;direction:rtl">  ููุนูู ูุน ุงููุฏููุนุงุช ุงูููุฑูุฉ ูุงูุตุบุฑู ุ ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุนูุฏุฉ <a href="https://www.lopp.net/lightning-information.html">ุดุจูุฉ Lightning Network</a> ุ ูู ุงููุงูุน ุ ุณุชููู ูุฐู ูู ุฃุฏุงุฉ ุงูุนูู ุงูุฑุฆูุณูุฉ ูุฏููุง ุจุงุณุชุฎุฏุงู bitcoin.  * ูุญุชูู <a href="https://github.com/ElementsProject/lightning">C-lightning</a> ุ ุงูุฐู <a href="https://github.com/fiatjaf/sparko">ุณูุณุชุฎุฏูู ูุฎูู</a> ุ ุนูู <a href="https://github.com/fiatjaf/sparko">ูููู Sparko ุฅุถุงูู</a> ุ ููู ุนุจุงุฑุฉ ุนู ูุงุฌูุฉ HTTP (REST) โโูุงููุฉ ููุณูุญ ุจุงูุนูู ูุน ูู ูู ุงููุนุงููุงุช ุฎุงุฑุฌ ุงูุณูุณูุฉ ูุงููุนุงููุงุช ุนูู ุงูุณูุณูุฉ.  ูุชุทูุจ <code>c-lightning</code> ุนูุฏุฉ <code>bitcoind</code> ููุนูู. </p><br><p style=";text-align:right;direction:rtl">  * <em>ููุงู ุชุทุจููุงุช ูุฎุชููุฉ ุนูู ุจุฑูุชูููู ุจุฑูุชูููู ุดุจูุฉ ุงูุจุฑู ุงููุฎุชููุฉ.</em>  <em>ูู ุชูู ุงูุชู ุงุฎุชุจุฑูุงูุง ุงูุจุฑู c (ููุชูุจ ูู C) ูุจุฏู ุฃู ุงูุฃูุซุฑ ุงุณุชูุฑุงุฑุง ูููุงุกุฉ ุงูููุงุฑุฏ</em> </p><br><p style=";text-align:right;direction:rtl"> <code># cbsd jsconstruct-tui</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># cbsd jstart cln</code> </p> <br><p style=";text-align:right;direction:rtl"> <code># jexec cln</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning:/@[10:23] # adduser</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Username: lightning ...</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>lightning:/@[10:24] # pkg install git</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning:/@[10:23] # su lightning</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>cd ~ &amp;&amp; git clone https://github.com/ElementsProject/lightning</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % exit</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning:/@[10:30] # cd /home/lightning/lightning/</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning:/home/lightning/lightning@[10:31] # pkg install autoconf automake gettext git gmp gmake libtool python python3 sqlite3 libsodium py36-mako bash bitcoin-utils</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning:/home/lightning/lightning@[10:34] # ./configure &amp;&amp; gmake &amp;&amp; gmake install</code> </p> <br><p style=";text-align:right;direction:rtl">  ุจูููุง ูุชู ุชุฌููุน ูู ูุง ุชุญุชุงุฌู ูุชุซุจูุชู ุ ูู ุจุฅูุดุงุก ูุณุชุฎุฏู RPC ูู <code>lightningd</code> ูู <code>bitcoind</code> </p><br><p style=";text-align:right;direction:rtl"> <code># jexec bitcoind</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>bitcoind:/@[10:36] # ee /usr/local/etc/bitcoin.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">rpcbind=192.168.0.1 rpcuser=test rpcpassword=test #allow only c-lightning rpcallowip=192.168.0.7/32</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>bitcoind:/@[10:39] # service bitcoind restart</code> </p> <br><p style=";text-align:right;direction:rtl">  <em>ุฅู ุงูุชุจุฏูู ุงูููุถูู ุงูุฎุงุต ุจู ุจูู ุงูุฎูุงูุง ููุณ ููุถูููุง ุฌุฏูุง ุฅุฐุง ูุงุญุธุช ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ <code>tmux</code> ุ ูุงูุชู ุชุชูุญ ูู ุฅูุดุงุก ุงูุนุฏูุฏ ูู ุงูุฌูุณุงุช ุงููุฑุนูุฉ ูููุทุงุฑูู ุฎูุงู ุฌูุณุฉ ูุงุญุฏุฉ.</em>  <em>ุงูุชูุงุธุฑูุฉ: <code>screen</code></em> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xu/cz/14/xucz14wosjbbeme4iis8ws4nxq8.png"></p><br><p style=";text-align:right;direction:rtl">  ุงูููุงุจ ุงูุฃููุงููุฉ ุ ูุง ูุฑูุฏ ุชุณููุท ุงูุถูุก ุนูู IP ุงูุญูููู ูุนูุฏุฉ ูุฏููุง ุ ููุญู ูุฑูุฏ ุฅุฌุฑุงุก ุฌููุน ุงููุนุงููุงุช ุงููุงููุฉ ูู ุฎูุงู TOP.  ูุฐูู ุ ุฃูุช ุจุญุงุฌุฉ ุฅูู ูุงุญุฏ ุขุฎุฑ. </p><br><p style=";text-align:right;direction:rtl"> <code># jexec tor</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[9:59] # ee /usr/local/etc/tor/torrc</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">HiddenServiceDir /var/db/tor/cln/ HiddenServicePort 9735 192.168.0.7:9735</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:01] # mkdir /var/db/tor/cln</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:01] # chown -R _tor:_tor /var/db/tor/cln</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:01] # chmod 700 /var/db/tor/cln</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:03] # service tor restart</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>tor:/@[10:04] # cat /var/db/tor/cln/hostname</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">en5wbkavnytti334jc5uzaudkansypfs6aguv6kech4hbzpcz2ove3yd.onion</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฅูุดุงุก ุงูุชูููู ู- ุงูุจุฑู </p><br><p style=";text-align:right;direction:rtl"> <code>lightning:/home/lightning/lightning@[10:31] # su lightning</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % mkdir .lightning</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % ee .lightning/config</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">alias=My-LN-Node bind-addr=192.168.0.7:9735 rgb=ff0000 announce-addr=en5wbkavnytti334jc5uzaudkansypfs6aguv6kech4hbzpcz2ove3yd.onion:9735 network=bitcoin log-level=info fee-base=0 fee-per-satoshi=1 proxy=192.168.0.2:9050 log-file=/home/lightning/.lightning/c-lightning.log min-capacity-sat=200000 # sparko plugin # https://github.com/fiatjaf/lightningd-gjson-rpc/tree/master/cmd/sparko sparko-host=192.168.0.7 sparko-port=9737 sparko-tls-path=sparko-tls #sparko-login=mywalletusername:mywalletpassword #sparko-keys=masterkey;secretread:+listchannels,+listnodes;secretwrite:+invoice,+listinvoices,+delinvoice,+decodepay,+waitpay,+waitinvoice sparko-keys=masterkey;secretread:+listchannels,+listnodes;ultrawrite:+invoice,+listinvoices,+delinvoice,+decodepay,+waitpay,+waitinvoice # for the example above the initialization logs (mixed with lightningd logs) should print something like</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % mkdir .lightning/plugins</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % cd .lightning/plugins/</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/plugins:% fetch https://github.com/fiatjaf/sparko/releases/download/v0.2.1/sparko_full_freebsd_amd64</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/plugins % mkdir ~/.lightning/sparko-tls</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/sparko-tls % cd ~/.lightning/sparko-tls</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/sparko-tls % openssl genrsa -out key.pem 2048</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/sparko-tls % openssl req -new -x509 -sha256 -key key.pem -out cert.pem -days 3650</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/plugins % chmod +x sparko_full_freebsd_amd64</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/plugins % mv sparko_full_freebsd_amd64 sparko</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~/.lightning/plugins % cd ~</code> </p> <br><p style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅูุดุงุก ููู ุชูููู ูู bitcoin-cli ุ ููู ุฃุฏุงุฉ ูุณุงุนุฏุฉ ุชุชุตู ุจู <code>bitcoind</code> </p><br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % mkdir .bitcoin</code> </p> <br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % ee .bitcoin/bitcoin.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">rpcconnect=192.168.0.1 rpcuser=test rpcpassword=test</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฑุงุฌุนุฉ </p><br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % bitcoin-cli echo "test"</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[ "test" ]</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุดุบูู <code>lightningd</code> </p><br><p style=";text-align:right;direction:rtl"> <code>lightning@lightning:~ % lightningd --daemon</code> </p> <br><p style=";text-align:right;direction:rtl">  ูููู ุงูุชุญูู ูู <code>lightning-cli</code> ููุณูุง ุจูุงุณุทุฉ ุฃุฏุงุฉ <code>lightning-cli</code> ุ ุนูู ุณุจูู ุงููุซุงู: </p><br><p style=";text-align:right;direction:rtl">  <code>lightning-cli newaddr</code> <em>ุงูุญุตูู ุนูู ุนููุงู ููุฏูุน ุงููุงุฑุฏ ุงูุฌุฏูุฏ</em> </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">{ "address": "bc1q2n2ffq3lplhme8jufcxahfrnfhruwjgx3c78pv", "bech32": "bc1q2n2ffq3lplhme8jufcxahfrnfhruwjgx3c78pv" }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <code>lightning-cli withdraw bc1jufcxahfrnfhruwjgx3cq2n2ffq3lplhme878pv all</code> <em>ุฅุฑุณุงููุง ุฅูู ุงูุนููุงู ุฌููุน ุฃููุงู ุงููุญูุธุฉ (ุฌููุน ุนูุงููู ุนูู ุณูุณูุฉ)</em> </p><br><p style=";text-align:right;direction:rtl">  ุฃูุถุง ุ ุฃูุงูุฑ ูุนูููุงุช ุฎุงุฑุฌ ุณูุณูุฉ ูู <code>lightning-cli invoice</code> <code>lightning-cli listinvoices</code> ุ <code>lightning-cli listinvoices</code> <code>lightning-cli pay</code> <code>lightning-cli listinvoices</code> ุ <code>lightning-cli listinvoices</code> <code>lightning-cli pay</code> ุงูุฎ </p><br><p style=";text-align:right;direction:rtl">  ุญุณูุง ุ ููุชูุงุตู ูุน ุงูุชุทุจูู ูุฏููุง REST Api </p><br><p style=";text-align:right;direction:rtl"> <code>curl -k https://192.168.0.7:9737/rpc -d '{"method": "pay", "params": ["lnbc..."]}' -H 'X-Access masterkey'</code> </p> <br><p style=";text-align:right;direction:rtl">  <strong>ูุชูุฎูุต</strong> </p><br><p style=";text-align:right;direction:rtl"> <code># jls</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> JID IP Address Hostname Path 1 192.168.0.1 bitcoind.space.com /zroot/jails/jails/bitcoind 2 192.168.0.2 tor.space.com /zroot/jails/jails/tor 3 192.168.0.3 nginx-rev.space.com /zroot/jails/jails/nginx-rev 4 192.168.0.4 paygw.space.com /zroot/jails/jails/paygw 5 192.168.0.5 webapp.my.domain /zroot/jails/jails/webapp 7 192.168.0.200 electrum.space.com /zroot/jails/jails/electrum 8 192.168.0.6 polipo.space.com /zroot/jails/jails/polipo 9 192.168.0.7 lightning.space.com /zroot/jails/jails/cln</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/nt/0k/ew/nt0kewrhuin48nj-lbfk1jpa4rc.png"></p><br><p style=";text-align:right;direction:rtl">     ,            . </p><br><p style=";text-align:right;direction:rtl"> <code># zfs list</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">NAME USED AVAIL REFER MOUNTPOINT zroot 279G 1.48T 88K /zroot zroot/ROOT 1.89G 1.48T 88K none zroot/ROOT/default 1.89G 17.6G 1.89G / zroot/home 88K 1.48T 88K /home zroot/jails 277G 1.48T 404M /zroot/jails zroot/jails/bitcoind 190G 1.48T 190G /zroot/jails/jails-data/bitcoind-data zroot/jails/cln 653M 1.48T 653M /zroot/jails/jails-data/cln-data zroot/jails/electrum 703M 1.48T 703M /zroot/jails/jails-data/electrum-data zroot/jails/nginx-rev 190M 1.48T 190M /zroot/jails/jails-data/nginx-rev-data zroot/jails/paygw 82.4G 1.48T 82.4G /zroot/jails/jails-data/paygw-data zroot/jails/polipo 57.6M 1.48T 57.6M /zroot/jails/jails-data/polipo-data zroot/jails/tor 81.5M 1.48T 81.5M /zroot/jails/jails-data/tor-data zroot/jails/webapp 360M 1.48T 360M /zroot/jails/jails-data/webapp-data</code> </pre> <br><p style=";text-align:right;direction:rtl">  , bitcoind   190  .          ?  ZFS   .   <code>cbsd jclone old=bitcoind new=bitcoind-clone host_hostname=clonedbtc.space.com</code>          .        ,               (   190 ) </p><br><p style=";text-align:right;direction:rtl">       ZFS,    . <a href="https://www.freebsd.org/doc/handbook/zfs-zfs.html">ZFS   </a>     ,     SSH.    ,   . </p><br><p style=";text-align:right;direction:rtl">        ,      <a href="https://zabbix.org/wiki/Main_Page">Zabbix</a> . </p><br><p style=";text-align:right;direction:rtl"> <strong> โ </strong> </p><br><p style=";text-align:right;direction:rtl">   ,        : </p><br><p style=";text-align:right;direction:rtl"> <em></em> โ   UNIX-     .           โ .          .           .                   .       -,             . </p><br><p style=";text-align:right;direction:rtl"> <em></em> โ        . -       , ECC , ZFS  " "        .            .   -     . </p><br><p style=";text-align:right;direction:rtl"> <em></em> โ   .           .           .                (     ).           ,         . </p><br><p style=";text-align:right;direction:rtl"> <em> </em> โ            ,  .          ,               . </p><br><p style=";text-align:right;direction:rtl">            ,     ,    ,         . </p><br><p style=";text-align:right;direction:rtl"> <strong>    ?</strong> </p><br><p style=";text-align:right;direction:rtl">     cbsd  <a href="https://www.bsdstore.ru/en/11.2.x/wf_bcreate_ssi.html"> </a> .   ,    <code>bhyve</code>     . </p><br><p style=";text-align:right;direction:rtl"> <code># cat /etc/rc.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">... kld_list="vmm if_tap if_bridge nmdm" ...</code> </pre> <br><p style=";text-align:right;direction:rtl"> <code># cat /boot/loader.conf</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">... vmm_load="YES" ...</code> </pre> <br><p style=";text-align:right;direction:rtl">        ,   - debian  ! </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ffd/cb6/219/ffdcb6219c701e2e114100d9601e9fea.gif"></p><br><p style=";text-align:right;direction:rtl"> <strong>  </strong> </p><br><p style=";text-align:right;direction:rtl">       .          โ <a href="https://sochain.com/address/BTC/bc1qu7lhf45xw83ddll5mnzte6ahju8ktkeu6qhttc">bc1qu7lhf45xw83ddll5mnzte6ahju8ktkeu6qhttc</a> .          ,      <a href="https://bitclouds.sh/">pet-project</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar477124/">https://habr.com/ru/post/ar477124/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar477110/index.html">ุงูุชุฎุทูุท ุงูุชุฑูููู</a></li>
<li><a href="../ar477114/index.html">MSH ุชูููุฐ ูุชุฑุฌู</a></li>
<li><a href="../ar477118/index.html">MIRO ุนุจุงุฑุฉ ุนู ููุตุฉ ุฑูุจูุช ุฏุงุฎููุฉ ููุชูุญุฉ. ุงูุฌุฒุก 5 - ูููู ุงูุจุฑูุงูุฌ: ARDUINO (AVR) ุ ูุญู ุชุณูู "ุชุญุช ุบุทุงุก ูุญุฑู ุงูุณูุงุฑุฉ"</a></li>
<li><a href="../ar477120/index.html">ุงุณุชูุฑุงุฑ ุฑุตุฏ ูุณุจุฉ ุงูุณูุฑ ูู ุงูุฏู ุจุฑูุฌูุงุช ูููุฏูุฒ</a></li>
<li><a href="../ar477122/index.html">ุฏูุงุบ ุงูุดุฑูุฉ. ุงูุฌุฒุก 3</a></li>
<li><a href="../ar477126/index.html">ุงููุดุฑู ูู 5 ุฏูุงุฆู. ุงููุงุฌูุฉ ุงูุฃูุงููุฉ - ุฑุฏ ูุนู ุงููุดุฑู ุ ุงููุงุฌูุฉ ุงูุฎูููุฉ - ูุงุฑูุฑุฉ ุงูุฑุงุญุฉ</a></li>
<li><a href="../ar477128/index.html">ูุจุฑุง ุงููุจุงุญุซ ูู ุนุทูุฉ ููุงูุฉ ุงูุฃุณุจูุน</a></li>
<li><a href="../ar477130/index.html">"ููุฌูู ุฃููุฌูู": ุงูุนูุงุณ (ูุตุฉ N.-F)</a></li>
<li><a href="../ar477132/index.html">ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูู ุงูุงุชุญุงุฏ ุงูุฑูุณู: ูู ูุญู ุฌููุนูุงุ ุฅูู ุฃูู ูุญู ุฐุงูุจููุ</a></li>
<li><a href="../ar477136/index.html">ููู ูุฎุฏุน FL.ru ุงููุณุชุฎุฏููู ุนู ุทุฑูู ุจูุน ุฎุฏูุฉ ูุงุญุฏุฉ ูุฑุชูู ุ ูุฎุฑู ุงูููุงุนุฏ ุงูุฎุงุตุฉ ุจูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>