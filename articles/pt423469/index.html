<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜô üë®üèø‚Äçü§ù‚Äçüë®üèª üå∞ N√∫meros de ponto flutuante do oeste selvagem mais r√°pidos üß¢ üÜô üë©üèº‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No processo de implementa√ß√£o de um "leitor", surgiu um problema com maior precis√£o nos c√°lculos. O algoritmo de c√°lculo trabalhou rapidamente em n√∫mer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>N√∫meros de ponto flutuante do oeste selvagem mais r√°pidos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423469/"> No processo de implementa√ß√£o de um "leitor", surgiu um problema com maior precis√£o nos c√°lculos.  O algoritmo de c√°lculo trabalhou rapidamente em n√∫meros de ponto flutuante padr√£o, mas quando as bibliotecas para c√°lculos precisos foram conectadas, tudo come√ßou a desacelerar descontroladamente.  Neste artigo, consideraremos algoritmos para expandir n√∫meros de ponto flutuante usando uma abordagem de m√∫ltiplos componentes, devido √† qual foi poss√≠vel obter acelera√ß√£o, j√° que a aritm√©tica de flutua√ß√£o √© implementada em um chip cp.  Essa abordagem ser√° √∫til para o c√°lculo mais preciso da derivada num√©rica, invers√£o de matriz, corte de pol√≠gono ou outros problemas geom√©tricos.  Portanto, √© poss√≠vel emular a flutua√ß√£o de 64 bits em placas de v√≠deo que n√£o as suportam. <br><br><img src="https://habrastorage.org/webt/54/1e/jo/541ejotttsu8hl3swtihly-liro.png" alt="benchmark double.js"><br><br><a name="habracut"></a><br><br><h3>  1. Introdu√ß√£o </h3><br>  Como Nikluas Wirth nos legou para manter os n√∫meros 0 e 1, n√≥s os armazenamos neles.  E √© que os seres humanos vivem no sistema decimal, e os n√∫meros aparentemente comuns 0.1 e 0.3 n√£o s√£o represent√°veis ‚Äã‚Äãno sistema bin√°rio por uma fra√ß√£o finita?  Sentimos um choque cultural quando fazemos c√°lculos sobre eles.  Obviamente, est√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sendo</a> feitas tentativas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">para</a> criar bibliotecas para processadores baseados no sistema decimal e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IEEE tem</a> at√© formatos padronizados. <br><br>  Mas, por enquanto, levamos em considera√ß√£o o armazenamento bin√°rio em todos os lugares e fazemos todos os c√°lculos de dinheiro com as bibliotecas para c√°lculos exatos, como bignumber, o que leva √† perda de desempenho.  Asiks consideram criptografia e, nos processadores, h√° muito pouco espa√ßo para essa sua aritm√©tica decimal, dizem os profissionais de marketing.  Portanto, uma abordagem multicomponente, quando um n√∫mero √© armazenado na forma de uma soma n√£o transformada de n√∫meros, √© um truque conveniente e uma esfera em desenvolvimento ativo no campo da inform√°tica te√≥rica.  Embora Decker ainda tenha aprendido a se multiplicar corretamente, sem perda de precis√£o, em 1971, as bibliotecas prontas para uso apareceram muito mais tarde (MPFR, QD) e n√£o em todos os idiomas, aparentemente porque nem todos os padr√µes IEEE s√£o compat√≠veis, mas provas rigorosas de erro de c√°lculo ainda mais tarde, por exemplo em 2017 para aritm√©tica de duas palavras. <br><br><h3>  Aritm√©tica de duas palavras </h3><br>  Qual √© o objetivo?  Em tempos de barba, quando n√£o havia padr√µes para n√∫meros flutuantes, para evitar problemas com a implementa√ß√£o do arredondamento, M√∏ller surgiu e Knuth mais tarde provou que existe um somat√≥rio sem erros.  Correndo dessa maneira <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quickTwoSum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> s = a + b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> z = s - a; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> e = b - z; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [s, e]; }</code> </pre> <br>  Nesse algoritmo, assumiu-se que se <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.913ex" height="2.66ex" viewBox="0 -832 3407.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-3E" x="1364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="2420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-62" x="2699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="3128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1"> | a | > | b | </script>  , sua soma exata pode ser representada como a soma de dois n√∫meros <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>+</mo><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.014ex" height="1.937ex" viewBox="0 -676.4 2158.9 834" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-2B" x="691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-65" x="1692" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> s + e </script>  e voc√™ pode armazen√°-los em pares para c√°lculos subsequentes, e a subtra√ß√£o √© reduzida √† adi√ß√£o com um n√∫mero negativo. <br><br><img src="https://habrastorage.org/webt/6o/5b/h3/6o5bh3at9xelrvk2yslo4qk0jl0.png" alt="arredondar para o banco mais pr√≥ximo vs"><br><br>  Posteriormente, Dekker mostrou que, se forem usados ‚Äã‚Äãn√∫meros de ponto flutuante, use o arredondamento para o n√∫mero par mais pr√≥ximo (v√≠nculos entre o mais pr√≥ximo e o mais par, o que geralmente √© um procedimento correto que n√£o leva a grandes erros no processo de c√°lculos longos e no padr√£o IEEE), existe um algoritmo de multiplica√ß√£o sem erros. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twoMult</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> A = split(a); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> B = split(b); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> r1 = a * b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t1 = -r1 + A[<span class="hljs-number"><span class="hljs-number">0</span></span>] * B[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t2 = t1 + A[<span class="hljs-number"><span class="hljs-number">0</span></span>] * B[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t3 = t2 + A[<span class="hljs-number"><span class="hljs-number">1</span></span>] * B[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [r1, t3 + A[<span class="hljs-number"><span class="hljs-number">1</span></span>] * B[<span class="hljs-number"><span class="hljs-number">1</span></span>]]; }</code> </pre><br>  onde split () √© o algoritmo do Sr. Weltkamp para dividir um n√∫mero <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> splitter = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.pow(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> t = splitter * a; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> d = a - t; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> xh = t + d; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> xl = a - xh; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [xh, xl]; }</code> </pre><br>  usando constante <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>s</mi></msup><mo>+</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.033ex" height="2.178ex" viewBox="0 -780.1 4750.5 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-3D" x="1038" y="0"></use><g transform="translate(2094,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-73" x="707" y="557"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-2B" x="3249" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-31" x="4249" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>s</mi></msup><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-3"> C = 2 ^ s + 1 </script>  que equivale a pouco mais da metade do comprimento da mantissa, o que n√£o leva ao excesso de n√∫meros no processo de multiplica√ß√£o e divide a mantissa em duas metades.  Por exemplo, com um comprimento de palavra de 64 bits, o comprimento da mantissa √© 53 e depois s = 27. <br><br><img src="https://habrastorage.org/webt/ut/k-/rl/utk-rlv912w0uw44uvm4cce4uts.gif" alt="b√≥ia dupla"><br><br>  Dessa maneira, Dekker forneceu o conjunto quase completo necess√°rio para a computa√ß√£o em aritm√©tica de duas palavras.  Desde l√°, tamb√©m foi indicado como multiplicar, dividir e quadrado dois n√∫meros de duas palavras. <br><br>  Seu algoritmo quickTwoSum para somar duas palavras duplas estava em toda parte "inline" e a verifica√ß√£o foi usada <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;gt;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.913ex" height="2.66ex" viewBox="0 -832 3407.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-3E" x="1364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="2420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMATHI-62" x="2699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/423469/&amp;usg=ALkJrhiG8Fk9f_b1AwcxugXI1sFmiAf83Q#MJMAIN-7C" x="3128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4"> | a | > | b | </script>  .  Nos processadores modernos, como descrito em [4], √© mais barato usar opera√ß√µes adicionais com n√∫meros do que ramificar o algoritmo.  Portanto, o algoritmo a seguir agora √© mais apropriado para adicionar dois n√∫meros de uma √∫nica palavra <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twoSum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> s = a + b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a1 = s - b; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b1 = s - a1; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> da = a - a1; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> db = b - b1; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [s, da + db]; }</code> </pre><br>  E, portanto, este √© o somat√≥rio e a multiplica√ß√£o de n√∫meros de duas palavras. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add22</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">X, Y</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> S = twoSum(X[<span class="hljs-number"><span class="hljs-number">0</span></span>], Y[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> E = twoSum(X[<span class="hljs-number"><span class="hljs-number">1</span></span>], Y[<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> c = S[<span class="hljs-number"><span class="hljs-number">1</span></span>] + E[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> V = quickTwoSum(S[<span class="hljs-number"><span class="hljs-number">0</span></span>], c); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> w = V[<span class="hljs-number"><span class="hljs-number">1</span></span>] + E[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quickTwoSum(V[<span class="hljs-number"><span class="hljs-number">0</span></span>], w); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul22</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">X, Y</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> S = twoMult(X[<span class="hljs-number"><span class="hljs-number">0</span></span>], Y[<span class="hljs-number"><span class="hljs-number">0</span></span>]); S[<span class="hljs-number"><span class="hljs-number">1</span></span>] += X[<span class="hljs-number"><span class="hljs-number">0</span></span>] * Y[<span class="hljs-number"><span class="hljs-number">1</span></span>] + X[<span class="hljs-number"><span class="hljs-number">1</span></span>] * Y[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quickTwoSum(S[<span class="hljs-number"><span class="hljs-number">0</span></span>], S[<span class="hljs-number"><span class="hljs-number">1</span></span>]); }</code> </pre><br>  De um modo geral, a lista mais completa e precisa de algoritmos para aritm√©tica de duas palavras, limites te√≥ricos de erros e implementa√ß√£o pr√°tica √© descrita no link [3] de 2017.  Portanto, se estiver interessado, eu recomendo ir direto para l√°.  Em geral, um algoritmo para palavras quadruplicadas √© apresentado em [6] e em [5] para uma extens√£o multicomponente de comprimento arbitr√°rio.  Somente l√°, ap√≥s cada opera√ß√£o, o processo de renormaliza√ß√£o √© usado, o que nem sempre √© ideal para tamanhos pequenos, e a precis√£o dos c√°lculos no QD n√£o √© estritamente definida.  Em geral, vale a pena pensar nos limites de aplicabilidade dessas abordagens, √© claro. <br><br><h3>  Hist√≥rias de terror javascript-a.  Compara√ß√£o de decimal.js vs bignumber.js vs big.js. </h3><br>  Aconteceu que quase todas as bibliotecas para c√°lculos exatos em js foram escritas por uma pessoa.  A ilus√£o da escolha √© criada, embora quase todas sejam iguais.  Al√©m disso, a documenta√ß√£o n√£o afirma explicitamente que, se voc√™ n√£o arredondar n√∫meros ap√≥s cada opera√ß√£o de multiplica√ß√£o / divis√£o, o tamanho do seu n√∫mero dobrar√° o tempo todo e a complexidade do algoritmo poder√° se tornar f√°cil em x3500.  Por exemplo, uma compara√ß√£o do tempo de c√°lculo pode ser assim se voc√™ n√£o arredondar os n√∫meros. <br><br><img src="https://habrastorage.org/webt/lj/6r/pk/lj6rpkl_lenvq7vabfyqqhdwh8y.png"><br><br>  Ou seja, voc√™ define a precis√£o para 32 casas decimais e ... Opa, voc√™ j√° tem 64 d√≠gitos, 128. Pensamos com muita precis√£o!  256, 512 ... Mas eu defino 32! .. 1024, 2048 ... Algo assim aparece no alto 3.500 vezes.  A documenta√ß√£o afirma que, se voc√™ tiver c√°lculos cient√≠ficos, provavelmente o decimal.js √© melhor para voc√™.  Embora, de fato, se voc√™ arredondar periodicamente, para c√°lculos cient√≠ficos, o Bignumber.js funcione um pouco mais r√°pido (veja a Fig. 1).  Quem precisa contar os cent√©simos de um centavo se eles n√£o podem ser trocados?  Existe algum caso em que preciso armazenar mais n√∫meros indicados e n√£o consigo sair com alguns caracteres extras?  Como leva o seno de um n√∫mero t√£o monstruoso, quando ningu√©m sabe a estrita precis√£o da converg√™ncia da s√©rie Taylor para n√∫meros arbitr√°rios?  Em geral, n√£o h√° suspeitas infundadas de que √© poss√≠vel aumentar a velocidade de c√°lculo l√°, usando algoritmos de multiplica√ß√£o de Schoenhage-Strassen e encontrando o seno com c√°lculos Cordic, por exemplo. <br><br><h3>  Double.js </h3><br>  <s>Gostaria de dizer, √© claro, que o Double.js conta com rapidez e precis√£o.</s>  <s>Mas isso n√£o √© inteiramente verdade, ou seja, √© 10 vezes mais r√°pido que considere, mas nem sempre √© preciso.</s>  <s>Por exemplo, 0,3-0,1 ele pode processar, passando para armazenamento duplo e vice-versa.</s>  <s>Mas o n√∫mero Pi pode ser resolvido com uma precis√£o dupla de quase 32 d√≠gitos e n√£o d√° certo.</s>  <s>Um erro √© gerado no dia 16, como se um estouro estivesse ocorrendo.</s>  <s>Em geral, exorto a comunidade js a trabalhar em conjunto para tentar resolver o problema de an√°lise, pois estou emperrado.</s>  <s>Tentei analisar digitalmente e dividir em dupla precis√£o, como em QD, dividir em lotes de 16 d√≠gitos e dividir em dupla precis√£o, dividir a mantissa usando Big.js como em uma das bibliotecas de Julia.</s>  <s>Agora pe√ßo um erro em .parseFloat (), j√° que os padr√µes IEEE com arredondamento para o n√∫mero inteiro mais pr√≥ximo s√£o suportados, mesmo com o ECMAScript 1. Embora, √© claro, voc√™ possa tentar ligar o buffer bin√°rio e assistir a cada 0 e 1. Em geral, se voc√™ puder resolver esse problema, ent√£o ser√° poss√≠vel fazer c√°lculos com precis√£o arbitr√°ria com acelera√ß√£o em x10-x20 a partir de bignumber.js.</s>  <s>No entanto, muitos Mandelbrot j√° oferecem qualidade e voc√™ pode us√°-lo para tarefas geom√©tricas.</s> <br><br>  Um ano depois, voltei para c√° e ainda corrigi um problema com a an√°lise.  O problema estava apenas com precis√£o insuficiente, quando multiplicado por 10 ^ (- n).  Todos os algoritmos foram revisados ‚Äã‚Äãdo zero e agora s√£o executados com uma precis√£o e velocidade assustadoras. <br><br><img src="https://habrastorage.org/webt/ax/gx/mb/axgxmb_wfffxczzejqaxa9mqdpy.png" alt="double.js vs n√∫mero"><br><br>  Aqui est√° um link para a <a href="">lib</a> , h√° uma refer√™ncia interativa e uma sandbox onde voc√™ pode brincar com ela. <br><br><h3>  Fontes utilizadas </h3><br><ol><li>  O. M√∏ller.  <i>Quase precis√£o dupla na aritm√©tica de ponto flutuante.</i>  1965. </li><li>  Theodorus Dekker.  <i>Uma t√©cnica de ponto flutuante para estender a precis√£o dispon√≠vel</i> , 1971. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Viewer</a> ] </li><li>  Mioara Joldes, Jean-Michel Muller, Valentina Popescu.  <i>Limites de erro rigorosos e rigorosos para blocos de constru√ß√£o b√°sicos da aritm√©tica de duas palavras</i> , 2017. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PDF</a> ] </li><li>  Muller, J.-M.  Brisebarre, N. de Dinechin, etc.  Manual de Aritm√©tica de Ponto Flutuante, Cap√≠tulo 14, 2010. </li><li>  Jonathan Shewchuk.  <i>Predicados geom√©tricos de ponto flutuante adapt√°vel robusto</i> , 1964. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PDF</a> ] </li><li>  Yozo Hida, Xiaoye Li e David Bailey.  <i>Biblioteca de Aritm√©tica Duplo-Duplo e Quad-Duplo</i> , 2000. [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PDF</a> ] </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt423469/">https://habr.com/ru/post/pt423469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt423459/index.html">Diferen√ßas entre Phoenix e Rails atrav√©s dos olhos de um convertido</a></li>
<li><a href="../pt423461/index.html">Outono suborbital</a></li>
<li><a href="../pt423463/index.html">Como escrevemos outro algoritmo de an√°lise RFM</a></li>
<li><a href="../pt423465/index.html">O que ler sobre o ITSM: livros, blogs e artigos mais recentes</a></li>
<li><a href="../pt423467/index.html">Desenvolvedores russos lan√ßar√£o um cat√°logo de compatibilidade de produtos</a></li>
<li><a href="../pt423475/index.html">Hackeando o c√≥digo do envelhecimento: uma nova ci√™ncia sobre o envelhecimento e o que significa permanecer jovem</a></li>
<li><a href="../pt423477/index.html">Seja um ninja de seguran√ßa: comece o seu caminho para as alturas do IB</a></li>
<li><a href="../pt423479/index.html">"Primeiro": se deve voar para Marte</a></li>
<li><a href="../pt423481/index.html">Preciso aumentar o cluster Kubernetes, mas sou apenas um programador de c√≥digo. Existe uma sa√≠da</a></li>
<li><a href="../pt423483/index.html">Encontrar o caminho certo para separar o conte√∫do do site usando o Webpack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>