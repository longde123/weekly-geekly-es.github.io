<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëßüèø üèòÔ∏è üè∫ Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 3 ü§≥üèª üßìüèæ ü§∞üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Encaderna√ß√£o (persist√™ncia) 
 Links para todas as partes: 
 Parte 1. Obtendo Acesso Inicial (Acesso Inicial) 
 Parte 2. Execu√ß√£o 
 Parte 3. Fixa√ß√£o (P...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425177/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Encaderna√ß√£o (persist√™ncia)</a> </h1><br>  <b>Links para todas as partes:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1. Obtendo Acesso Inicial (Acesso Inicial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Execu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3. Fixa√ß√£o (Persist√™ncia)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4. Escalonamento de Privil√©gios</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 5. Evas√£o de Defesa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 6. Obtendo credenciais (acesso a credenciais)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 7. Descoberta</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 8. Movimento Lateral</a> <br><br>  A principal tarefa de proteger o acesso √© garantir uma presen√ßa constante no sistema atacado, porque o acesso pode ser perdido devido a uma reinicializa√ß√£o do sistema atacado, perda de credenciais ou bloqueio de ferramentas de acesso remoto devido √† detec√ß√£o de um ataque. <br><a name="habracut"></a><br>  <i>O autor n√£o √© respons√°vel pelas poss√≠veis consequ√™ncias da aplica√ß√£o das informa√ß√µes contidas no artigo e tamb√©m se desculpa por poss√≠veis imprecis√µes feitas em algumas formula√ß√µes e termos.</i>  <i>As informa√ß√µes publicadas s√£o uma recontagem gratuita do conte√∫do do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br>  Os m√©todos para garantir a const√¢ncia no sistema podem ser divididos em 3 categorias: <br><ul><li>  Cria√ß√£o n√£o autorizada de contas ou roubo de credenciais existentes; </li><li>  Instala√ß√£o oculta e lan√ßamento de ferramentas de acesso remoto; </li><li>  Fazer altera√ß√µes na configura√ß√£o do sistema atacado com a ajuda da qual √© poss√≠vel executar v√°rios c√≥digos maliciosos.  O c√≥digo malicioso pode ser iniciado automaticamente sempre que o sistema inicializa ou todo usu√°rio efetua logon no sistema, inicia servi√ßos modificados ou mal-intencionados, inicia determinados programas pelo usu√°rio ou inicia o processo de atualiza√ß√£o do software do sistema ou de terceiros. </li></ul><br>  Al√©m disso, s√£o apresentadas as t√©cnicas de bloqueio de acesso oferecidas pela ATT &amp; CK. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modifica√ß√£o dos arquivos ~ / .bash_profile e ~ / .bashrc</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o: os</i> invasores podem incorporar c√≥digo nos arquivos ~ / .bash_profile e ~ / .bashrc ( <i>criados para criar um ambiente de usu√°rio no sistema operacional</i> ), que ser√£o executados quando o usu√°rio efetuar login ou iniciar um novo shell.  O arquivo ~ / .bash_profile √© executado quando o usu√°rio efetua login, ~ / .bashrc √© executado quando os shells s√£o abertos interativamente.  Quando um usu√°rio faz login (local ou remotamente, por exemplo, via SSH) com um nome de usu√°rio e senha, ~ / .bash_profile √© executado antes do retorno do convite do usu√°rio.  Depois disso, toda vez que um novo shell √© aberto, ~ / .bashrc √© executado. <br>  No macOS, o Terminal.app √© um pouco diferente, pois inicia o shell de login padr√£o cada vez que a janela do terminal √© aberta, invocando ~ / .bash_profile a cada vez. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Concedendo direitos para modificar os arquivos ~ / .bash_profile e ~ / .bashrc apenas para administradores autorizados. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modifica√ß√£o de arquivos execut√°veis ‚Äã‚Äãdos aplicativos "recursos de acessibilidade do Windows" (Recursos de acessibilidade)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador <br>  <i>Descri√ß√£o: os</i> aplicativos de acessibilidade (ampliador de tela, teclado na tela etc.) podem ser iniciados usando combina√ß√µes de teclas antes que um usu√°rio fa√ßa logon no sistema.  Um invasor pode substituir os arquivos de inicializa√ß√£o desses programas ou alterar a maneira como eles s√£o iniciados e abrir um console de comando ou obter um backdoor sem efetuar login. <br><ul><li>  <i>C: \ Windows \ System32 \ sethc.exe</i> - iniciado pressionando 5 vezes a tecla Shift; </li><li>  <i>C: \ Windows \ System32 \ utilman.exe</i> - iniciado pressionando a combina√ß√£o de Win + U. </li></ul><br>  No WinXP e vers√µes posteriores, sethc.exe e utilman.exe podem ser substitu√≠dos, por exemplo, por cmd.exe e, quando voc√™ pressiona a combina√ß√£o de teclas desejada, o cmd.exe √© iniciado antes de entrar no Windows com privil√©gios de sistema. <br>  No Vista e vers√µes posteriores, voc√™ precisa alterar a chave do registro que configura o cmd.exe ou outro programa como depurador, por exemplo, para o ultiman.exe.  Ap√≥s editar o registro e pressionar a combina√ß√£o de teclas desejada na tela de login ou ao conectar-se ao host via RDP, o cmd.exe com direitos do sistema ser√° executado. <br>  Existem tamb√©m programas do Windows que podem ser usados ‚Äã‚Äãpara implementar esta t√©cnica de ataque: <br><ul><li>  C: \ Windows \ System32 \ osk.exe; </li><li>  C: \ Windows \ System32 \ Magnify.exe; </li><li>  C: \ Windows \ System32 \ Narrator.exe; </li><li>  C: \ Windows \ System32 \ DisplaySwitch.exe; </li><li>  C: \ Windows \ System32 \ AtBroker.exe. </li></ul><br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> configure o in√≠cio da autentica√ß√£o de rede obrigat√≥ria para usu√°rios remotos antes de criar uma sess√£o RDP e exibir a tela de login ( <i>ativada por padr√£o no Windows Vista e posterior</i> ).  Use o Gateway de √Årea de Trabalho Remota para gerenciar conex√µes e configurar a seguran√ßa RDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modificando a chave de DLLs do AppCert</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o: as</i> DLLs especificadas no valor da chave AppCertDLLs s√£o carregadas em cada processo que chama as fun√ß√µes de API usadas com freq√º√™ncia: <i>CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, WinExec</i> .  O valor da chave AppCertDLLs pode ser abusado, fazendo com que uma DLL mal-intencionada carregue e execute determinados processos.  AppCertDLLs √© armazenado na seguinte chave do Registro: <br>  <i>Gerenciador de HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session</i> . <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> use todos os meios poss√≠veis para bloquear software potencialmente perigoso e fazer o download de DLLs desconhecidas, como AppLocker e DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modifica√ß√£o da chave AppInit DLLs</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o: as</i> DLLs especificadas no valor da chave AppInit_DLLs s√£o carregadas em cada processo que o user32.dll carrega.  Na pr√°tica, isso √© quase todo programa. <br>  AppInit_DLLs √© armazenado nas seguintes chaves do Registro: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Windows;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Windows.</i> </li></ul><br>  O valor da chave AppInit_DLLs pode ser abusado para exceder os privil√©gios carregando DLLs maliciosas e iniciando determinados processos.  A funcionalidade AppInit_DLLs est√° desativada no Windows 8 e posterior quando a Inicializa√ß√£o segura est√° ativada. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> considere usar uma vers√£o do sistema operacional n√£o anterior ao Windows 8 e habilitar a inicializa√ß√£o segura.  Use todos os meios para bloquear software potencialmente perigoso e baixar DLLs desconhecidas, como AppLocker e DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Abuso do Subsistema de Compatibilidade de Aplicativos (Aplica√ß√£o Shimming)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador <br>  <i>Descri√ß√£o: a</i> <i>infraestrutura / estrutura de compatibilidade de aplicativos do Microsoft Windows foi</i> criada para garantir a compatibilidade de programas com atualiza√ß√µes do Windows e altera√ß√µes no c√≥digo do SO.  O sistema de compatibilidade usa as chamadas shim ("gaxetas") - bibliotecas que atuam como um buffer entre o programa e o sistema operacional.  Usando o cache de cal√ßo, o sistema determina a necessidade de juntas de cal√ßo (armazenadas como um banco de dados .sdb).  V√°rios arquivos .sdb armazenam v√°rios procedimentos para interceptar o c√≥digo do aplicativo, process√°-lo e redirecion√°-lo ao sistema operacional.  A lista de todas as juntas de veda√ß√£o instaladas pelo instalador (sdbinst.exe) √© armazenada por padr√£o em: <br><ul><li>  <i>% WINDIR% \ AppPatch \ sysmain.sdb</i> ; </li><li>  <i>HKLM \ Software \ Microsoft \ Windows \ CurrentVersion \ AppCompatFlags \ InstalledSDB</i> . </li></ul><br>  Os bancos de dados de shim personalizados s√£o armazenados em: <br><ul><li>  <i>% WINDIR% \ AppPatch [64] \ Personalizado;</i> </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Custom</i> . </li></ul><br>  Para garantir a prote√ß√£o no modo de usu√°rio, a capacidade de alterar o kernel do sistema operacional usando juntas de veda√ß√£o √© exclu√≠da e s√£o necess√°rios direitos de administrador para instal√°-los.  No entanto, alguns shim pads podem ser usados ‚Äã‚Äãpara ignorar o Controle de Conta de Usu√°rio (UAC), inje√ß√£o de DLL, desativar a <a href="">Preven√ß√£o de Execu√ß√£o de Dados</a> e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Manuseio de Exce√ß√£o de Estrutura</a> , bem como interceptar endere√ßos de mem√≥ria.  Um invasor que usa gaxetas de cal√ßo pode aumentar os privil√©gios, instalar backdoors, desativar a prote√ß√£o do SO, como o Windows Defender. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> N√£o h√° muitas maneiras de impedir o desgaste do aplicativo.  Desabilitar a compatibilidade de aplicativos n√£o √© recomendado para evitar problemas com a estabilidade do sistema operacional.  A Microsoft lan√ßou o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">KB3045645</a> , que remover√° o sinalizador "elevar automaticamente" no arquivo sdbinst.exe para impedir o uso do sistema de cal√ßo para contornar o UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modificando componentes do pacote de autentica√ß√£o do Windows</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador <br>  <i>Descri√ß√£o: as</i> DLLs do Windows Authentification Pack s√£o carregadas pelo processo LSA (Autoridade de Seguran√ßa Local) na inicializa√ß√£o do sistema e fornecem suporte para v√°rios processos de login e v√°rios protocolos de seguran√ßa do SO.  Os invasores podem usar o mecanismo de execu√ß√£o autom√°tica do LSA colocando um link para um arquivo bin√°rio na seguinte chave do Registro: <br>  <i>Pacotes HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ Authentication: [bin√°rio de destino]</i> . <br>  O [Target binary] ser√° iniciado pelo sistema quando os <i>pacotes de autentica√ß√£o forem</i> baixados. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> No Windows 8.1, Windows Server 2012 R2 e LSAs posteriores, voc√™ pode faz√™-lo funcionar como um processo protegido (PPL) usando a chave do Registro: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL = DWORD: 00000001</i> , <br>  que exige que todas as DLLs carregadas pelos LSAs sejam assinadas com um certificado digital da Microsoft. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando trabalhos do BITS (trabalhos do BITS)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o:</i> <i>O Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano do Windows (BITS)</i> √© um mecanismo para transferir arquivos de forma ass√≠ncrona por meio do COM (Component Object Model) usando baixa largura de banda.  O BITS √© geralmente usado por atualizadores, mensageiros instant√¢neos e outros aplicativos que preferem trabalhar em segundo plano sem interromper a opera√ß√£o de outros aplicativos de rede.  As tarefas de transfer√™ncia de arquivos s√£o representadas como tarefas do BITS que cont√™m uma fila de uma ou mais opera√ß√µes de arquivo.  A interface para criar e gerenciar tarefas do BITS est√° dispon√≠vel nas ferramentas PowerShell e BITSAdmin.  Os invasores podem usar o BITS para baixar, iniciar e limpar depois de executar c√≥digo malicioso.  As tarefas do BITS s√£o armazenadas de forma aut√¥noma no banco de dados do BITS, enquanto o sistema n√£o cria novos arquivos ou entradas de registro, geralmente o BITS √© permitido pelo firewall.  Usando tarefas do BITS, voc√™ pode ganhar uma posi√ß√£o no sistema criando tarefas longas (por padr√£o, 90 dias) ou chamando um programa arbitr√°rio ap√≥s a conclus√£o de uma tarefa ou erro do BITS (inclusive ap√≥s a reinicializa√ß√£o do sistema operacional). <br><br>  <i>Recomenda√ß√µes de prote√ß√£o: O</i> BITS √© uma funcionalidade padr√£o do sistema operacional, cuja utiliza√ß√£o √© dif√≠cil de distinguir da atividade maliciosa; portanto, o vetor de prote√ß√£o deve ser direcionado para impedir o lan√ßamento de ferramentas maliciosas no in√≠cio da cadeia de ataques.  Desabilitar o BITS completamente pode interromper as atualiza√ß√µes leg√≠timas de software; no entanto, voc√™ pode restringir o acesso √† interface do BITS a usu√°rios e grupos de acesso espec√≠ficos e tamb√©m pode limitar o tempo de vida das tarefas do BITS, definidas alterando as seguintes chaves: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Policies \ Microsoft \ Windows \ BITS \ JobInactivityTimeout;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Pol√≠ticas \ Microsoft \ Windows \ BITS \ MaxDownloadTime</i> . </li></ul><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bootkits</a> </h3><br>  <i>Sistema:</i> Linux, Windows <br>  <i>Direitos:</i> administrador, sistema <br>  <i>Descri√ß√£o: O</i> Bootkit √© um tipo de malware que pode alterar os setores de inicializa√ß√£o de um disco r√≠gido, incluindo MBR (Master Boot Record) e VBR (Volume Boot Record).  Os invasores podem usar o Bootkit para encaixar nos sistemas abaixo do sistema operacional.  MBR - a se√ß√£o da ferrovia, carregada imediatamente ap√≥s a conclus√£o da inicializa√ß√£o do BIOS do hardware.  Um invasor com acesso para reescrever o MBR pode substituir o c√≥digo do carregador de inicializa√ß√£o por um malicioso.  VBR √© a parti√ß√£o do disco r√≠gido que recebe o controle do processo de inicializa√ß√£o do MBR.  Por analogia com a op√ß√£o de reescrever o MBR, um invasor pode executar c√≥digo malicioso no est√°gio de inicializa√ß√£o do sistema. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Usando as ferramentas de controle de integridade MBR e VBR.  Usando o Trusted Platform Module (TPM) e inicializa√ß√£o segura. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Extens√µes do navegador</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o:</i> como regra, os plug-ins t√™m todo o acesso e direitos que um navegador pode obter.  Plugins maliciosos podem ser instalados baixando aplicativos maliciosos disfar√ßados de programas leg√≠timos usando t√©cnicas de engenharia social, phishing ou um invasor que j√° comprometeu o sistema.  Plugins maliciosos podem abrir sites em segundo plano, roubar informa√ß√µes que um usu√°rio digita em um navegador, incluindo credenciais, para serem usadas como instaladores de ferramentas de administra√ß√£o remota (RAT) e corre√ß√µes no sistema. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> instale plug-ins somente de fontes confi√°veis.  Controle os plug-ins instalados usando a Diretiva de Grupo.  Impedir a instala√ß√£o de plugins por usu√°rios comuns.  Invent√°rio e monitoramento de plugins instalados. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modificando os par√¢metros de associa√ß√µes de arquivos (Change Default File Association)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, administrador, sistema <br>  <i>Descri√ß√£o: os</i> invasores podem modificar associa√ß√µes de arquivos para executar comandos arbitr√°rios.  A escolha de associa√ß√µes de arquivos com aplicativos √© armazenada no registro do Windows e pode ser editada por usu√°rios, administradores e programas que t√™m acesso ao registro.  Os aplicativos podem modificar associa√ß√µes para chamar programas arbitr√°rios.  Os par√¢metros das associa√ß√µes do sistema s√£o armazenados no registro: <i>HKEY_CLASSES_ROOT \. [Extension]</i> , por exemplo, <i>HKEY_CLASSES_ROOT \ .txt</i> .  Os v√°rios comandos est√£o listados como subse√ß√µes: <i>HKEY_CLASSES_ROOT \ [manipulador] \ shell \ [a√ß√£o] \ [comando]</i> , por exemplo: <br><ul><li>  HKEY_CLASSES_ROOT \ txtfile \ shell \ open \ [comando]; </li><li>  HKEY_CLASSES_ROOT \ txtfile \ shell \ print \ [comando]; </li><li>  HKEY_CLASSES_ROOT \ txtfile \ shell \ printto \ [comando]; </li></ul><br>  onde <i>[comando]</i> √© o comando que ser√° executado ao abrir o arquivo com a extens√£o especificada. <br><br>  Pr√°ticas <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">recomendadas</a></i> de <i>seguran√ßa:</i> Siga <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as recomenda√ß√µes da Microsoft</a></i> para associa√ß√µes de arquivos.  Use todos os meios poss√≠veis para bloquear software potencialmente perigoso, como AppLocker e DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firmware de componentes</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Sistema <br>  <i>Descri√ß√£o:</i> alguns cibercriminosos podem usar ferramentas sofisticadas para comprometer os componentes do computador e instalar um firmware mal-intencionado que executar√° c√≥digo mal-intencionado fora do sistema operacional ou mesmo do firmware do sistema principal (Bios).  A t√©cnica consiste em piscar componentes do computador que n√£o possuem um sistema interno de verifica√ß√£o de integridade, por exemplo, discos r√≠gidos.  Um dispositivo com firmware malicioso pode fornecer acesso constante ao sistema atacado, apesar das falhas e da substitui√ß√£o do disco r√≠gido.  A t√©cnica foi projetada para superar a prote√ß√£o do software e o controle de integridade. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intercepta√ß√£o de links e seq√ºestro de modelo de objeto de componente de links</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: O</i> <i>Microsoft Component Object Model (COM)</i> √© uma tecnologia para a cria√ß√£o de software com base nos componentes de intera√ß√£o de um objeto, cada um dos quais pode ser usado em muitos programas simultaneamente.  Os invasores podem usar o COM para injetar c√≥digo malicioso que pode ser executado em vez do leg√≠timo, capturando links e links COM.  Para interceptar um objeto COM, voc√™ precisa substituir o link para um componente leg√≠timo do sistema no registro do Windows.  Uma chamada adicional para este componente executar√° c√≥digo malicioso. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Medidas preventivas para evitar esse ataque n√£o s√£o recomendadas, pois os objetos COM fazem parte do sistema operacional e est√£o instalados no software do sistema.  O bloqueio de altera√ß√µes nos objetos COM pode afetar a estabilidade do sistema operacional e do software.  O vetor de prote√ß√£o √© recomendado para bloquear software malicioso e potencialmente perigoso. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criar contas</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Direitos:</i> Administrador <br>  <i>Descri√ß√£o:</i> invasores com acesso suficiente podem criar contas locais ou de dom√≠nio para consolida√ß√£o adicional no sistema.  Os comandos do usu√°rio da rede tamb√©m podem ser usados ‚Äã‚Äãpara criar contas. <br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> O uso da autentica√ß√£o multifator.  Defina configura√ß√µes de seguran√ßa em servidores importantes, configure controles de acesso, firewalls.  Proibir o uso de uma conta de administrador de dom√≠nio para executar opera√ß√µes di√°rias durante as quais um invasor pode obter informa√ß√µes da conta.  Os invasores que criaram contas no sistema podem obter apenas acesso limitado √† rede se os n√≠veis de acesso estiverem bloqueados corretamente.  As contas podem ser necess√°rias apenas para garantir o acesso a um sistema separado. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intercepta√ß√£o de pesquisa de DLL (seq√ºestro de ordem de pesquisa de DLL)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o: a</i> t√©cnica consiste em explorar vulnerabilidades no algoritmo para localizar pelos aplicativos os arquivos DLL que eles precisam para funcionar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MSA2269637</a> ).  Freq√ºentemente, o diret√≥rio de pesquisa DLL √© o diret√≥rio de trabalho do programa, portanto, os invasores podem substituir a DLL de origem por uma DLL maliciosa com o mesmo nome de arquivo. <br>  Ataques remotos em pesquisas de DLL podem ser executados quando o programa instala seu diret√≥rio atual em um diret√≥rio remoto, por exemplo, um compartilhamento de rede.  Al√©m disso, os invasores podem alterar diretamente o m√©todo de pesquisa e carregamento de DLLs, substituindo os arquivos .manifest ou .local, que descrevem os par√¢metros de pesquisa da DLL.  Se o programa atacado funcionar com um alto n√≠vel de privil√©gios, a DLL maliciosa carregada por ele tamb√©m ser√° executada com altos direitos.  Nesse caso, a t√©cnica pode ser usada para aumentar os privil√©gios do usu√°rio para o administrador ou sistema. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Impe√ßa o carregamento remoto da DLL (ativado por padr√£o no Windows Server 2012+ e dispon√≠vel com atualiza√ß√µes para XP + e Server 2003+).  Ativa o modo de pesquisa segura para DLLs, que restringe os diret√≥rios de pesquisa a diret√≥rios como <i>% SYSTEMROOT%</i> antes de executar uma pesquisa DLL no diret√≥rio atual do aplicativo. <br>  Habilitando o modo de pesquisa de DLL segura: <br>  <i>Configura√ß√£o do computador&gt; [Diretivas]&gt; Modelos administrativos&gt; MSS (herdado): MSS: (SafeDllSearchMode) Ative o modo de pesquisa de DLL segura.</i> <br>  Chave de registro correspondente: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br>  Considere auditar um sistema protegido para corrigir defici√™ncias de DLL usando ferramentas como o PowerUP no PowerSploit.  N√£o se esque√ßa de bloquear software malicioso e potencialmente perigoso, al√©m de seguir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as recomenda√ß√µes da Microsoft</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intercepta√ß√£o de pesquisa do Dylib (seq√ºestro do Dylib)</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: a</i> t√©cnica √© baseada em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vulnerabilidades nos algoritmos de pesquisa da biblioteca din√¢mica dylib no macOS e OS X.</a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A linha inferior √© determinar o dylib que o aplicativo atacado carrega e, em seguida, coloque a vers√£o mal-intencionada do dylib com o mesmo nome no diret√≥rio de trabalho do aplicativo. </font><font style="vertical-align: inherit;">Isso far√° com que o aplicativo carregue o dylib, localizado no diret√≥rio de trabalho do programa. </font><font style="vertical-align: inherit;">Nesse caso, o Dylib malicioso ser√° executado com os direitos de acesso do aplicativo atacado. </font><font style="vertical-align: inherit;">Dicas de seguran√ßa </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Impe√ßa que os usu√°rios gravem arquivos nos diret√≥rios de pesquisa do dylib. </font><font style="vertical-align: inherit;">Audite as vulnerabilidades usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dylib Hijacking Scanner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da Objective-See.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servi√ßos remotos externos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rights: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">: Os</font></i><font style="vertical-align: inherit;"> invasores podem usar os servi√ßos remotos externos da organiza√ß√£o, como VPN, Citrix e WinRM, para se protegerem dentro da rede atacada. O acesso aos servi√ßos pode ser realizado usando contas v√°lidas obtidas usando t√©cnicas para redirecionar usu√°rios a sites falsos (pharming) ou na fase de comprometimento da rede. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restringindo o acesso a servi√ßos remotos usando switches gerenciados centralmente, usando uma VPN. </font><font style="vertical-align: inherit;">Proibi√ß√£o de acesso remoto direto √† rede interna atrav√©s do uso de proxies, gateways e firewalls. </font><font style="vertical-align: inherit;">Desabilitar servi√ßos que podem ser usados ‚Äã‚Äãremotamente, como o WinRM. </font><font style="vertical-align: inherit;">O uso da autentica√ß√£o de dois fatores. </font><font style="vertical-align: inherit;">Monitorando a atividade do uso de servi√ßos remotos fora do hor√°rio comercial.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desvantagens das permiss√µes no n√≠vel do sistema de arquivos (Fraqueza nas permiss√µes do sistema de arquivos)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a ess√™ncia da t√©cnica √© substituir os arquivos execut√°veis ‚Äã‚Äãiniciados automaticamente por v√°rios processos (por exemplo, quando o SO √© inicializado ou em um determinado momento, se os direitos dos arquivos execut√°veis ‚Äã‚Äãestiverem configurados incorretamente). Ap√≥s a falsifica√ß√£o, o arquivo malicioso ser√° iniciado com os direitos do processo; portanto, se o processo tiver um n√≠vel de acesso mais alto, o invasor poder√° escalar os privil√©gios. Nessa t√©cnica, os invasores podem tentar manipular os arquivos bin√°rios do servi√ßo Windows.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outra variante do ataque est√° associada √†s defici√™ncias dos algoritmos no trabalho dos instaladores de extra√ß√£o autom√°tica. Durante o processo de instala√ß√£o, os instaladores geralmente descompactam v√°rios arquivos √∫teis, incluindo .dll e .exe, no diret√≥rio% TEMP%; no entanto, eles podem n√£o definir as permiss√µes apropriadas para restringir o acesso aos arquivos descompactados, o que permite que os invasores executem a falsifica√ß√£o de arquivos e, como resultado, aumente os privil√©gios ou ignore o controle da conta, alguns instaladores s√£o executados com privil√©gios estendidos. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restri√ß√£o de direitos de conta para que apenas administradores possam gerenciar os servi√ßos e interagir com os arquivos bin√°rios usados ‚Äã‚Äãpelos servi√ßos. </font><font style="vertical-align: inherit;">Desative as op√ß√µes de escala√ß√£o de privil√©gios do UAC para usu√°rios padr√£o. </font><font style="vertical-align: inherit;">As configura√ß√µes do UAC s√£o armazenadas na seguinte chave do Registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para rejeitar automaticamente solicita√ß√µes de escala√ß√£o de privil√©gios, voc√™ deve adicionar uma chave: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ConsentPromptBehaviorUser" = dword: 00000000.</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para controlar o trabalho dos instaladores, voc√™ deve adicionar uma chave: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"EnableInstallerDetection" = dword: 00000001</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que exigir√° uma senha para instalar os programas.</font></font></li></ul><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquivos e diret√≥rios ocultos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Descri√ß√£o do</font></i><font style="vertical-align: inherit;"> usu√°rio </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores podem usar a capacidade de ocultar arquivos e pastas para n√£o atrair a aten√ß√£o dos usu√°rios. No Windows, os usu√°rios podem ocultar arquivos usando o comando attrib. Basta especificar o atributo + h &lt;nome do arquivo&gt; para ocultar o arquivo ou "+ s" para marcar o arquivo como sistema. Adicionando o par√¢metro "/ S", o utilit√°rio attrib aplicar√° as altera√ß√µes recursivamente. No Linux / Mac, os usu√°rios podem ocultar arquivos e pastas simplesmente especificando um "." No in√≠cio do nome do arquivo. Depois disso, arquivos e pastas ser√£o ocultados do aplicativo Finder e, como o utilit√°rio "ls". No macOS, os arquivos podem ser sinalizados com UF_HIDDEN, o que desativar√° sua visibilidade no Finder.app, mas n√£o impedir√° que arquivos ocultos sejam vistos no Terminal.app. Muitos aplicativos criam arquivos e pastas ocultos para n√£o sobrecarregar a √°rea de trabalho do usu√°rio. Por exemploOs utilit√°rios SSH criam uma pasta .ssh oculta que armazena uma lista de hosts e chaves de usu√°rio conhecidos.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √â dif√≠cil impedir a possibilidade de usar essa t√©cnica, pois ocultar arquivos √© um recurso padr√£o do sistema operacional.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intercepta√ß√£o de chamadas de recursos da API do Windows (Hooking)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rights:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, System </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: As</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fun√ß√µes da API do Windows geralmente s√£o armazenadas em DLLs. </font><font style="vertical-align: inherit;">A t√©cnica de conectar √© redirecionar chamadas para fun√ß√µes da API:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Procedimentos de gancho - procedimentos integrados ao sistema operacional que executam c√≥digo quando v√°rios eventos s√£o chamados, por exemplo, pressionamentos de tecla ou movimenta√ß√£o do mouse; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifica√ß√µes na tabela de endere√ßos (IAT), que armazena ponteiros para fun√ß√µes da API. </font><font style="vertical-align: inherit;">Isso permitir√° que voc√™ ‚Äúengane‚Äù o aplicativo atacado, for√ßando-o a iniciar uma fun√ß√£o maliciosa;</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Altera√ß√£o direta da fun√ß√£o (emenda), durante a qual os primeiros 5 bytes da fun√ß√£o s√£o alterados, em vez da inser√ß√£o da transi√ß√£o para uma fun√ß√£o maliciosa ou outra determinada pelo invasor. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como as inje√ß√µes, os atacantes podem usar o gancho para executar c√≥digos maliciosos, mascarar sua execu√ß√£o, acessar a mem√≥ria do processo atacado e aumentar os privil√©gios. </font><font style="vertical-align: inherit;">Os invasores podem capturar chamadas de API que incluem par√¢metros que cont√™m dados de autentica√ß√£o. </font><font style="vertical-align: inherit;">A conex√£o √© geralmente usada pelos rootkits para ocultar atividades maliciosas no sistema. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A intercepta√ß√£o de eventos no sistema operacional faz parte da opera√ß√£o normal do sistema, portanto, qualquer restri√ß√£o dessa funcionalidade pode afetar adversamente a estabilidade de aplicativos leg√≠timos, como software antiv√≠rus. </font><font style="vertical-align: inherit;">Os esfor√ßos para impedir o uso de t√©cnicas de intercepta√ß√£o precisam se concentrar nos est√°gios iniciais da cadeia de ataque. </font><font style="vertical-align: inherit;">Voc√™ pode detectar atividades maliciosas de conex√£o monitorando chamadas para as fun√ß√µes SetWindowsHookEx e SetWinEventHook, usando detectores de rootkit e analisando o comportamento an√¥malo dos processos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hypervisor</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> O hipervisor pode ser comprometido por um invasor e ter rootkits ocultos nos sistemas convidados. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> impe√ßa o acesso malicioso a contas privilegiadas necess√°rias para instalar e configurar um hypervisor.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inje√ß√£o de IFEO (inje√ß√£o de op√ß√µes de execu√ß√£o de arquivo de imagem)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> O mecanismo IFEO (Image File Execution Options) permite executar um depurador de programa em vez de um programa especificado anteriormente pelo desenvolvedor no registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes de execu√ß√£o de arquivo HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Image / [execut√°vel]</font></font></i> </li><li> <i>HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\[executable]</i> ,,  <i>[executable]</i> ‚Äî     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como inje√ß√µes, o valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[execut√°vel]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode ser abusado ao executar c√≥digo arbitr√°rio para aumentar privil√©gios ou obter uma posi√ß√£o no sistema. Programas maliciosos podem usar o IFEO para ignorar a prote√ß√£o registrando depuradores que redirecionam e rejeitam v√°rios aplicativos de sistema e seguran√ßa. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o: A</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica descrita √© baseada no abuso de ferramentas regulares de desenvolvimento de SO, portanto, qualquer restri√ß√£o pode causar instabilidade de software leg√≠timo, por exemplo, aplicativos de seguran√ßa. Os esfor√ßos para impedir o uso de t√©cnicas de inje√ß√£o de IFEO precisam ser focados nos est√°gios iniciais da cadeia de ataque. Voc√™ pode detectar esse ataque monitorando processos com o processo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_only_this_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extens√µes e m√≥dulos carreg√°veis ‚Äã‚Äãdo kernel (m√≥dulos e extens√µes do kernel)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Raiz </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√≥dulos do kernel para download (LKM) s√£o programas especiais que podem ser carregados e descarregados a partir do kernel sem a necessidade de uma reinicializa√ß√£o completa do sistema. </font><font style="vertical-align: inherit;">Por exemplo, o LKM inclui drivers de dispositivo. </font><font style="vertical-align: inherit;">Os invasores podem carregar LKMs maliciosos usando v√°rios rootkits. </font><font style="vertical-align: inherit;">Normalmente, esses rootkits se quebram, arquivos, processos, atividade de rede, logs de auditoria falsos, fornecem backdoors. </font><font style="vertical-align: inherit;">Como o LKM no macOS, existem os KEXTs carregados e descarregados com os comandos kextload e kextunload. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use as ferramentas de detec√ß√£o de rootkit do Linux: rkhunter, chrootkit. </font><font style="vertical-align: inherit;">Limite o acesso √† conta raiz, necess√°ria para carregar m√≥dulos no kernel. </font><font style="vertical-align: inherit;">Use o controle de acesso for√ßado do SELinux.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifica√ß√£o do cabe√ßalho LC_LOAD_DYLIB Addition em arquivos Mach-O (LC_LOAD_DYLIB Addition)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Os arquivos Mach-O cont√™m v√°rios cabe√ßalhos usados ‚Äã‚Äãpara executar determinadas opera√ß√µes ao baixar um arquivo bin√°rio. </font><font style="vertical-align: inherit;">O cabe√ßalho LC_LOAD_DYLIB nos bin√°rios Mach-O informa ao SO quais bibliotecas dylib devem ser carregadas. </font><font style="vertical-align: inherit;">As altera√ß√µes nos cabe√ßalhos invalidar√£o a assinatura digital; no entanto, um invasor pode excluir o comando LC_CODE_SIGNATURE do arquivo bin√°rio e o sistema n√£o verificar√° se a assinatura est√° correta ao fazer o download. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Todos os bin√°rios devem ser assinados com os IDs de desenvolvedor Apple corretos, e as listas de permiss√µes de aplicativos s√£o compiladas de acordo com os hashes conhecidos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drivers da Autoridade de Seguran√ßa Local (Driver LSASS)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, sistema </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Local Security Authority (LSA) - um subsistema Windows que fornece autentica√ß√£o de usu√°rio. </font><font style="vertical-align: inherit;">O LSA inclui v√°rias DLLs interconectadas din√¢micas que s√£o executadas no processo LSASS.exe. </font><font style="vertical-align: inherit;">Os invasores podem atacar o LSASS.exe substituindo ou adicionando drivers LSA ileg√≠timos e executando c√≥digo arbitr√°rio. </font><font style="vertical-align: inherit;">A t√©cnica √© implementada no malware Pasam e Wingbird, que "lan√ßa" as DLLs modificadas usadas para carregar o LSASS. </font><font style="vertical-align: inherit;">Nesse caso, o c√≥digo malicioso √© executado antes que a DLL ileg√≠tima cause uma falha e a falha subsequente do servi√ßo LSASS. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No Windows 8.1 e Server 2012 R2, ative a prote√ß√£o LSA ativando a chave especificada: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL = dword: 00000001.</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa prote√ß√£o garante que os plug-ins e drivers carregados por LSA sejam assinados digitalmente pela Microsoft. </font><font style="vertical-align: inherit;">No Windows 10 e no Servidor 16, habilite o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Defender Credential Guard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para executar lsass.exe em um ambiente virtual isolado. </font><font style="vertical-align: inherit;">Para reduzir o risco de bibliotecas maliciosas serem carregadas no lsass.exe, ative o modo de pesquisa de DLL segura:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager \ SafeDllSearchMode.</font></font></i> </li></ul><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agentes de Lan√ßamento</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica consiste em abusar da funcionalidade de cria√ß√£o e inicializa√ß√£o por usu√°rios Launch Agents - servi√ßos de execu√ß√£o autom√°tica no n√≠vel do usu√°rio. </font><font style="vertical-align: inherit;">Quando cada usu√°rio efetua logon no sistema, o launchd carrega os par√¢metros dos Agentes de Inicializa√ß√£o dos arquivos * .plist. </font><font style="vertical-align: inherit;">Os arquivos Plist t√™m uma estrutura XML e cont√™m instru√ß√µes que informam ao launchd quais execut√°veis ‚Äã‚Äãe quando iniciar. </font><font style="vertical-align: inherit;">Os arquivos Plist podem ser encontrados nos seguintes diret√≥rios:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Sistema / Biblioteca / LaunchAgents; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Biblioteca / LauncAgents; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ P√°gina inicial / Biblioteca / LaunchAgents. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores tamb√©m podem mascarar os nomes de agentes de inicializa√ß√£o mal-intencionados usando os nomes de programas leg√≠timos. </font><font style="vertical-align: inherit;">Por exemplo, o Trojan Komplex cria um agente de inicializa√ß√£o: $ HOME / Library / LaunchAgents / com.apple.updates.plist. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usando a Diretiva de Grupo, configure a restri√ß√£o para usu√°rios que criam Agentes de Inicializa√ß√£o. </font><font style="vertical-align: inherit;">A cria√ß√£o de agentes de inicializa√ß√£o envolve o carregamento ou a cria√ß√£o de arquivos plist no disco, portanto concentre seus esfor√ßos de defesa nos est√°gios anteriores do ataque.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iniciar Daemons (Daemon de Lan√ßamento)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: A</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica consiste em alterar os par√¢metros dos servi√ßos no n√≠vel de inicializa√ß√£o do sistema - Inicie o Daemon, especificado nos arquivos plist, pelo invasor. </font><font style="vertical-align: inherit;">Quando o sistema √© inicializado, o processo Launchd carrega os par√¢metros de servi√ßos (daemons) dos arquivos plist localizados nos seguintes diret√≥rios:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Sistema / Biblioteca / LaunchDeamons; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Library / LaunchDeamons. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Launch Daemon pode ser criado com privil√©gios de administrador, mas executado na conta raiz, para que um invasor possa escalar privil√©gios. </font><font style="vertical-align: inherit;">As permiss√µes dos arquivos plist devem ser raiz: enquanto, no entanto, o script ou programa especificado nele pode ter permiss√µes menos estritas. </font><font style="vertical-align: inherit;">Portanto, um invasor pode modificar os arquivos execut√°veis ‚Äã‚Äãespecificados em plist e, assim, modificar os servi√ßos atuais do sistema para proteger o sistema ou aumentar os privil√©gios. </font><font style="vertical-align: inherit;">Dicas de </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite os privil√©gios do usu√°rio para que apenas administradores autorizados possam criar o Launch Daemon. </font><font style="vertical-align: inherit;">Considere monitorar como os arquivos plist s√£o criados no seu sistema usando aplicativos como o KnockKnock.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilit√°rio Launchctl</font></font></a> </h3> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Launchctl - um utilit√°rio para gerenciar o servi√ßo Launchd. Usando o Launchctl, voc√™ pode gerenciar os servi√ßos do sistema e do usu√°rio (LaunchDeamons e LaunchAgents), bem como executar comandos e programas. O Launchctl suporta subcomandos da linha de comando, interativos ou redirecionados da entrada padr√£o: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">launchctl submit -l [labelname] - / Path / to / thing / to / execute '' arg "'' arg" '' arg ".</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Iniciando e reiniciando os servi√ßos e daemons, os atacantes podem executar c√≥digo e at√© ignorar a lista de permiss√µes se o launchctl for um processo autorizado; no entanto, carregar, descarregar e recarregar servi√ßos e daemons podem exigir privil√©gios elevados.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitando os direitos do usu√°rio para criar Agentes de Inicializa√ß√£o e iniciar Deamons de Inicializa√ß√£o usando a Diretiva de Grupo. </font><font style="vertical-align: inherit;">Usando o aplicativo KnockKnock, voc√™ pode descobrir programas que usam o launchctl para gerenciar os Agentes de Inicializa√ß√£o e os Deamons de Inicializa√ß√£o.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programa√ß√£o local de trabalhos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, administrador, raiz </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem criar tarefas nos sistemas atacados para que programas n√£o autorizados sejam iniciados quando o sistema inicializar ou agendar. </font><font style="vertical-align: inherit;">Os sistemas Linux e Apple suportam v√°rios m√©todos para agendar o lan√ßamento de tarefas peri√≥dicas em segundo plano: cron, at, launchd. </font><font style="vertical-align: inherit;">Diferentemente do Agendador de tarefas do Windows, o agendamento de tarefas nos sistemas Linux n√£o pode ser feito remotamente, exceto pelo uso de sess√µes remotas como SSH. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Limitando os direitos do usu√°rio para criar tarefas agendadas, bloqueando os utilit√°rios do sistema e outro software que pode ser usado para agendar tarefas.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itens de login</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">: Os</font></i><font style="vertical-align: inherit;"> invasores para se protegerem no sistema podem configurar seu c√≥digo para iniciar automaticamente usando itens de login (configura√ß√µes do usu√°rio para inicializa√ß√£o do aplicativo a cada login). Os itens de logon criados usando o Service Management Framework n√£o s√£o exibidos nas configura√ß√µes do sistema e s√≥ podem ser exclu√≠dos pelo aplicativo em que foram criados. Os usu√°rios podem gerenciar apenas os itens de logon que s√£o exibidos nas configura√ß√µes do sistema. As configura√ß√µes para esses itens de logon s√£o armazenadas no arquivo plist no diret√≥rio do usu√°rio: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / Library / Preferences / com.apple.loginitems.plist.</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os aplicativos que fazem parte do item de logon podem exibir janelas vis√≠veis ao usu√°rio na inicializa√ß√£o, mas voc√™ pode ocult√°-los com a op√ß√£o "Ocultar". </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite os direitos do usu√°rio para criar um item de logon. </font><font style="vertical-align: inherit;">Vale notar que manter a tecla Shift pressionada durante o login impede que os aplicativos sejam iniciados automaticamente. </font><font style="vertical-align: inherit;">Controle as configura√ß√µes do item de login (Configura√ß√µes do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sistema ‚Üí Usu√°rios e grupos ‚Üí Elementos de login</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts de logon</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para consolidar no sistema, um invasor pode usar a capacidade de criar novos ou modificar scripts de logon existentes - scripts executados sempre que um usu√°rio ou grupo de usu√°rios espec√≠fico fizer logon no sistema. Se um invasor obtiver acesso a um script de logon em um controlador de dom√≠nio do Windows, ele poder√° modific√°-lo para executar o c√≥digo em todos os sistemas no dom√≠nio, a fim de "desviar" a rede. Dependendo das configura√ß√µes dos direitos de acesso aos arquivos de script de logon (geralmente esses scripts s√£o armazenados em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\\ [DC] \ NETLOGON \</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), o invasor pode precisar de credenciais locais ou administrativas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No Mac, scripts de logon ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gancho de logon / logout</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), ao contr√°rio do item de logon, iniciado no contexto do usu√°rio, pode ser executado como raiz. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Restringindo privil√©gios de administrador para criar scripts de logon. </font><font style="vertical-align: inherit;">Identifica√ß√£o e bloqueio de software potencialmente perigoso que pode ser usado para modificar os cen√°rios de login.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificar servi√ßos existentes</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Para iniciar repetidamente c√≥digo malicioso em um sistema, um invasor pode modificar a configura√ß√£o de servi√ßos existentes usando utilit√°rios ou ferramentas do sistema para interagir com a API do Windows. </font><font style="vertical-align: inherit;">Os invasores podem danificar ou matar intencionalmente um servi√ßo para invoca√ß√£o subsequente de um programa modificado ou comando de restaura√ß√£o de servi√ßo. </font><font style="vertical-align: inherit;">O uso de servi√ßos existentes √© uma das t√©cnicas de disfarce que dificulta a detec√ß√£o de atividades maliciosas. </font><font style="vertical-align: inherit;">As informa√ß√µes sobre a configura√ß√£o dos servi√ßos do Windows, incluindo o caminho para os programas e comandos para iniciar e restaurar o servi√ßo, s√£o armazenadas no registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode alterar a configura√ß√£o dos servi√ßos usando os utilit√°rios de console sc.exe e Reg. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Limitar os privil√©gios de usu√°rios e grupos para alterar as configura√ß√µes de servi√ßo, concedendo direitos apenas a administradores autorizados. </font><font style="vertical-align: inherit;">Bloqueando software potencialmente perigoso. </font><font style="vertical-align: inherit;">Para estudar as altera√ß√µes nos servi√ßos do sistema, a fim de identificar tentativas de proteger um invasor no sistema, voc√™ pode usar o utilit√°rio Sysinternals Autoruns.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLLs do Netsh Helper (DLL do Netsh Helper)</font></font></a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o: os</i> invasores podem executar c√≥digo usando o utilit√°rio do console Netsh interno, que permite o carregamento de DLLs de extens√£o para expandir a funcionalidade: <br>  <i>netsh&gt; adicionar auxiliar [caminho da DLL]</i> <br>  As informa√ß√µes sobre as bibliotecas registradas usadas pelo netsh s√£o armazenadas no registro: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ NetSh</i> <br>  Alguns clientes VPN corporativos e utilit√°rios de rede podem usar o netsh.exe, iniciando-o em nome do Sistema. Nessa situa√ß√£o, o invasor pode registrar ou modificar a DLL auxiliar que ser√° executada quando o cliente VPN usar o netsh.  As ferramentas para implementar esse tipo de ataque est√£o inclu√≠das no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CobaltStrike</a> (estrutura de teste de penetra√ß√£o). <br><br>  <i>Dicas de seguran√ßa:</i> bloqueie software potencialmente perigoso usando ferramentas como o AppLocker. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Novos Servi√ßos</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o:</i> nomeie o acesso ao sistema, os atacantes podem criar novos servi√ßos e configur√°-los para iniciar automaticamente.  O nome do servi√ßo pode ser mascarado usando nomes espec√≠ficos para o sistema operacional.  Os servi√ßos podem ser criados com privil√©gios de administrador, mas executados em nome do sistema.  Os servi√ßos podem ser criados a partir da linha de comando, usando ferramentas de acesso remoto com interoperabilidade com a API do Windows ou usando ferramentas de gerenciamento padr√£o do Windows e PowerShell. <br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> limite os direitos do usu√°rio para criar novos servi√ßos, para que apenas administradores autorizados possam fazer isso.  Aplique a AppLocker e a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Diretiva de restri√ß√£o de software</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inicializa√ß√£o autom√°tica em aplicativos de escrit√≥rio (Inicializa√ß√£o de aplicativos do Office)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o:</i> alguns mecanismos de trabalho do MS Office podem ser usados ‚Äã‚Äãpara executar c√≥digo ao executar aplicativos do Office e, como resultado, fornecer aos invasores sua const√¢ncia no sistema: <br>  ‚Ä¢ Incorporar macros VBA mal-intencionadas nos modelos b√°sicos do Office.  O Word usa o modelo Normal.dotm: <br>  <i>C: \ Usu√°rios \ [Nome de usu√°rio] \ AppData \ Roaming \ Microsoft \ Templates \ Normal.dotm</i> . <br>  N√£o h√° modelo padr√£o no Excel, no entanto, voc√™ pode adicion√°-lo manualmente e ele ser√° carregado automaticamente: <br>  <i>C: \ Usu√°rios \ [Nome de usu√°rio] \ AppData \ Roaming \ Microsoft \ Excel \ XLSTART \ Personal.xls</i> . <br>  A implementa√ß√£o do ataque s√≥ √© poss√≠vel se a op√ß√£o " <i>Executar todas as macros</i> " estiver ativada na Central de Confiabilidade do Office: <br>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Office \ [Vers√£o] \ [Aplicativo] \ Security \ VBAWarnings: 1;</i> <br>  ‚Ä¢ Colocar um link DLL na se√ß√£o de teste do Office do registro do Windows faz com que a DLL especificada seja executada sempre que o aplicativo do Office for iniciado: <br>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Office Teste \ Especial \ Perf \ [Padr√£o]: [Especifique o caminho para a DLL];</i> <br>  ‚Ä¢ Adicionando complementos ao aplicativo do Office com c√≥digo malicioso que ser√° executado quando o aplicativo atacado for iniciado. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i>Pr√°ticas recomendadas de seguran√ßa</i></a> <i>:</i> Siga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i>as pr√°ticas recomendadas da Microsoft ao definir configura√ß√µes de seguran√ßa de macro</i></a> .  Para impedir a opera√ß√£o do mecanismo de teste do Office, crie a se√ß√£o especificada no registro e defina permiss√µes somente leitura para impedir o acesso a ele sem direitos de administrador.  Se poss√≠vel, desative os suplementos do Office, se necess√°rio, e siga as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i>recomenda√ß√µes da Microsoft</i></a> ao organizar o trabalho. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intercepta√ß√£o de caminho</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, administrador, sistema <br>  <i>Descri√ß√£o: a</i> t√©cnica de interceptar um caminho √© colocar o arquivo execut√°vel em um diret√≥rio a partir do qual o aplicativo o iniciar√°, em vez do arquivo de destino.  Um invasor pode usar os seguintes m√©todos: <br><ul><li>  Caminhos inexistentes.  Os caminhos para os arquivos execut√°veis ‚Äã‚Äãdo servi√ßo s√£o armazenados nas chaves do Registro e podem ter um ou mais espa√ßos, por exemplo, <i>C: \ Arquivos de Programas \ service.exe</i> , se o invasor criar o arquivo <i>C: \ Program.exe</i> no sistema, o Windows o iniciar√° em vez de processar o caminho arquivo de destino de servi√ßo. </li><li>  Configura√ß√£o incorreta de vari√°veis ‚Äã‚Äãde ambiente.  Se na vari√°vel PATH o caminho <i>C: \ example</i> preceder <i>c: \ Windows \ System32</i> e o arquivo <i>C: \ example \ net.exe existir</i> , quando o comando net for chamado, <i>C: \ example \ net.exe</i> ser√° executado e n√£o <i>c: \ Windows \ System32 \ net.exe</i> . </li><li>  Intercepta√ß√£o da ordem de pesquisa (seq√ºestro da ordem de pesquisa).  Quando o caminho completo para o arquivo execut√°vel n√£o √© especificado, o Windows, em regra, procura o arquivo com o nome especificado no diret√≥rio atual e, em seguida, procura nos diret√≥rios do sistema.  Por exemplo, o arquivo "example.exe", quando executado, inicia o cmd.exe com argumentos para executar o comando net use.  O invasor pode colocar o arquivo net.exe no diret√≥rio de localiza√ß√£o example.exe e ser√° iniciado em vez do <i>utilit√°rio c: \ Windows \ System32 \ net.exe</i> .  Al√©m disso, se o invasor colocar o arquivo net.com no diret√≥rio com o arquivo net.exe, o Windows executar√° o net.com de acordo com a ordem de execu√ß√£o definida na vari√°vel de sistema PATHEXT. </li></ul><br>  <i>A intercepta√ß√£o de ordem de pesquisa de arquivo tamb√©m √© usada para executar DLLs usando a t√©cnica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DLL de seq√ºestro de pesquisa</a> .</i> <br><br>  <i>Recomenda√ß√µes de seguran√ßa: As</i> aspas indicam os caminhos especificados nos arquivos de configura√ß√£o, scripts, a vari√°vel PATH, configura√ß√µes de servi√ßo e atalhos.  Lembre-se da ordem de pesquisa dos arquivos execut√°veis ‚Äã‚Äãe use apenas caminhos completos.  Limpe as chaves de registro antigas que sobraram do software remoto, para que nenhuma chave seja deixada no registro e aponte para arquivos inexistentes.  Estabele√ßa a proibi√ß√£o de gravar pelos usu√°rios do sistema nos diret√≥rios raiz C: \ e Windows, limite as permiss√µes de grava√ß√£o nos diret√≥rios com arquivos execut√°veis. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modifica√ß√£o de arquivos Plist (Modifica√ß√£o Plist)</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o: os</i> invasores podem modificar arquivos plist especificando neles seu pr√≥prio c√≥digo para sua execu√ß√£o no contexto de outro usu√°rio.  Os arquivos de propriedades plist localizados em <i>/ Library / Preferences</i> s√£o executados com privil√©gios elevados, e os plist de <i>~ / Library / Preferences</i> s√£o executados com privil√©gios de usu√°rio. <br><br>  Dicas de seguran√ßa <i>:</i> impe√ßa que os arquivos plist sejam modificados, tornando-os somente leitura. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Porto batendo</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar os m√©todos de Port Knocking para ocultar portas abertas que eles usam para se conectar ao sistema. <br><br>  Dicas de <i>seguran√ßa: O</i> uso de firewalls com estado pode impedir que algumas op√ß√µes de Port Knocking sejam implementadas. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modifica√ß√£o de monitores de porta no gerenciador de impress√£o (monitores de porta)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o: um</i> invasor pode organizar a execu√ß√£o de uma DLL arbitr√°ria em nome do Sistema sempre que o Windows inicializar usando o abuso das configura√ß√µes do Gerenciador de Impress√£o (Spoolsv.exe).  Para interagir com os dispositivos de impress√£o, o Spoolsv.exe usa os chamados monitores de portas - s√£o bibliotecas DLL que usam comandos de baixo n√≠vel para serem enviados aos dispositivos de impress√£o via LAN, USB, LPT ou interface COM.  As DLLs acima s√£o armazenadas em <i>C: \ windows \ system32</i> e registradas no registro: <br>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Print \ Monitors</i> . <br>  O Port Monitor pode ser instalado usando a API AddMonitor ou diretamente, editando a chave do Registro acima. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> organize o bloqueio de software potencialmente perigoso e use as ferramentas de controle de inicializa√ß√£o de aplicativos. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rc.common</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> raiz <br>  <i>Descri√ß√£o: um</i> invasor pode adicionar c√≥digo ao arquivo <i>/etc/rc.common</i> que ser√° executado sempre que o sistema inicializar como root.  Rc.common √© um script que √© executado durante a inicializa√ß√£o do OC e √© o precursor dos Agentes de Lan√ßamento e Launh Deamons.  Essa √© uma tecnologia desatualizada para programas de inicializa√ß√£o autom√°tica, mas ainda √© suportada no macOS e no OS X. <br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> restrinja os privil√©gios do usu√°rio para editar o arquivo rc.common. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aplicativos reabertos</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o:</i> em sistemas que come√ßam com <i>OS X 10.7 (Lion)</i> , um invasor pode organizar a execu√ß√£o de um arquivo malicioso toda vez que o sistema operacional √© reiniciado.  A t√©cnica √© baseada no abuso da fun√ß√£o de reiniciar aplicativos ap√≥s a reinicializa√ß√£o do sistema.  Usando as ferramentas incorporadas √† GUI, o usu√°rio pode informar ao sistema quais aplicativos precisam ser reiniciados em caso de reinicializa√ß√£o do sistema operacional.  Essas configura√ß√µes s√£o armazenadas em arquivos plist: <br><ul><li>  <i>~ / Library / Preferences / com.apple.loginwindow.plist;</i> </li><li>  <i>~ / Library / Preferences / ByHost / com.apple.loginwindows. *. Plist.</i> </li></ul><br>  Um invasor pode modificar os arquivos acima para executar c√≥digos maliciosos toda vez que o sistema √© reiniciado. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> A fun√ß√£o de reinicializa√ß√£o do aplicativo pode ser desativada usando o comando do console: <i>padr√µes write -g ApplePersistence -bool no</i> . <br>  Al√©m disso, manter pressionada a tecla Shift durante a inicializa√ß√£o impede que os aplicativos sejam iniciados automaticamente. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Acesso redundante</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o: os</i> invasores podem usar simultaneamente v√°rias ferramentas de acesso remoto com diferentes protocolos de controle para diversificar os riscos de detec√ß√£o.  Portanto, se uma das ferramentas de acesso remoto for detectada e bloqueada, mas a parte defensora n√£o tiver identificado todas as ferramentas do invasor, o acesso remoto √† rede atacada ainda ser√° preservado.  Os invasores tamb√©m podem tentar acessar contas v√°lidas de servi√ßos corporativos remotos, como VPNs, para obter acesso alternativo ao sistema no caso de bloquear as ferramentas b√°sicas de acesso remoto.  O uso de um shell da web tamb√©m √© uma das maneiras de acessar remotamente uma rede atrav√©s de um servidor da web. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> monitore a presen√ßa e o bloqueio da inicializa√ß√£o de ferramentas conhecidas de acesso remoto em sua rede (AmmyAdmin, Radmin, RemotePC, VNC etc.), use ferramentas para controlar o lan√ßamento de aplicativos e bloquear software potencialmente perigoso.  A introdu√ß√£o de sistemas IDS e IPS que detectam malware espec√≠fico usando assinaturas reduzir√° a probabilidade de um ataque bem-sucedido, mas, com o tempo, os invasores modificar√£o suas ferramentas para alterar a assinatura e, como resultado, ignorar os sistemas IDS e IPS. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inicializa√ß√£o autom√°tica usando a tecla Run Keys e a pasta Startup (Registry Run Keys / Start Folder)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o: um</i> invasor pode adicionar "chaves de execu√ß√£o" ou um link √† pasta Inicializa√ß√£o no registro do Windows para iniciar um arquivo malicioso quando um usu√°rio faz logon no sistema.  O programa ser√° executado com os direitos do usu√°rio atual.  Os invasores podem mascarar as chaves de inicializa√ß√£o no registro para que pare√ßam parte de programas leg√≠timos. <br>  As chaves de execu√ß√£o s√£o armazenadas nas seguintes chaves do Registro: <br><ul><li>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run;</i> </li><li>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ RunOnce;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Run;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ RunOnce.</i> </li></ul><br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> identifica√ß√£o e bloqueio de software potencialmente perigoso, monitorando altera√ß√µes na pasta Inicializa√ß√£o e nos ramos do registro listados acima. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SIP e seq√ºestro de provedor de confian√ßa (SIP e Trust Provider)</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">subvertendo a confian√ßa no Windows</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o: os</i> invasores podem modificar os componentes da arquitetura para assinar e verificar a assinatura digital do c√≥digo do Windows para ignorar os meios de controlar o lan√ßamento de programas que permitem que apenas o c√≥digo assinado seja executado.  Para criar, assinar e verificar a assinatura de arquivos de v√°rios formatos no Windows, <i>s√£o utilizados o</i> chamado <i>SIP (Subject Interface Package)</i> - especifica√ß√µes de software exclusivas para cada tipo de arquivo, que permitem a intera√ß√£o entre as fun√ß√µes da API que iniciam a cria√ß√£o, c√°lculo e verifica√ß√£o de assinaturas e diretamente arquivos  A validade da assinatura √© confirmada pelo chamado <i>Trust Provider</i> - estes s√£o componentes de software do sistema operacional que executam v√°rios procedimentos relacionados ao c√°lculo e verifica√ß√£o de assinaturas digitais. <br>  M√©todos de ataque populares: <br><ul><li>  Modifica√ß√£o das <i>chaves</i> <i>DLL</i> e <i>FuncName</i> na se√ß√£o <i>CryptSIPDllGetSignedDataMsg</i> : <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ OID \ EncodingType 0 \ CryptSIPDllGetSignedDataMsg \ [SIP_GUID]</i> . <br>  √â executada para substituir a biblioteca DLL que fornece a fun√ß√£o <i>CryptSIPDllGetSignedDataMSG</i> , que retorna o certificado digital codificado do arquivo assinado.  Uma fun√ß√£o falsa sempre pode retornar um valor de assinatura v√°lido conhecido anteriormente (por exemplo, uma assinatura da Microsoft para arquivos de sistema execut√°veis) ao usar um SIP modificado.  O invasor pode tentar aplicar uma assinatura v√°lida para todos os arquivos; no entanto, provavelmente, isso resultar√° na invalida√ß√£o da assinatura, pois o hash retornado pela fun√ß√£o n√£o corresponder√° ao hash calculado no arquivo. </li><li>  Modifica√ß√£o das <i>chaves</i> <i>DLL</i> e <i>FuncName</i> na se√ß√£o: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ OID \ EncodingType 0 \ CryptSIPDllVerifyIndirectData / [SIP_GUID]</i> . <br>  √â executada para substituir a biblioteca DLL que fornece a fun√ß√£o <i>CryptSIPDllVerifyIndirectData</i> , que <i>verifica o</i> hash calculado no arquivo com o hash especificado na assinatura digital e retorna o resultado da verifica√ß√£o (Verdadeiro / Falso).  Assim, um invasor pode garantir a verifica√ß√£o bem-sucedida de qualquer arquivo usando o SIP modificado.  Os valores-chave acima podem redirecionar para uma fun√ß√£o adequada de uma biblioteca existente, eliminando assim a necessidade de criar um novo arquivo DLL no disco. </li><li>  Modifica√ß√£o das <i>chaves</i> <i>DLL</i> e <i>FuncName</i> na se√ß√£o: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ Providers \ Trust \ FinalPolicy / [Trust Provider GUID]</i> . <br>  O objetivo disso √© substituir a biblioteca DLL que fornece a fun√ß√£o FinalPolicy para um Trust Provider espec√≠fico, que decodifica, analisa a assinatura e toma uma decis√£o sobre confian√ßa.  Semelhante ao CryptSIPDllVerifyIndirectData, o valor das chaves acima pode redirecionar para uma DLL existente. </li></ul><br>  <i>√â importante observar que o ataque descrito ao mecanismo de confian√ßa do Windows pode ser implementado usando a t√©cnica de seq√ºestro de ordem de pesquisa DLL.</i> <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> verifique se os usu√°rios do sistema protegido n√£o podem modificar as chaves do Registro relacionadas aos componentes SIP e Trust Provider.  Considere remover SIPs desnecess√°rios e obsoletos.  Use todos os tipos de meios para bloquear o download de DLLs maliciosas, por exemplo, aquelas incorporadas ao Windows AppLocker e DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tarefa agendada</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o:</i> utilit√°rios como at, schtasks e Windows Task Scheduler podem ser usados ‚Äã‚Äãpara agendar programas e scripts para execu√ß√£o em uma data e hora espec√≠ficas.  Uma tarefa pode ser agendada em um sistema remoto, desde que o RPC seja usado para autentica√ß√£o e o compartilhamento de impressoras e arquivos esteja ativado.  O agendamento de tarefas em um sistema remoto requer privil√©gios de administrador.  Um invasor pode usar a execu√ß√£o remota de c√≥digo para obter privil√©gios do sistema ou iniciar um processo em uma conta espec√≠fica. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> limite de privil√©gios do usu√°rio.  O uso de ferramentas, como o m√≥dulo PowerUP no PowerSploit, que podem ser usadas para encontrar pontos fracos na resolu√ß√£o de tarefas agendadas.  Desabilitando a capacidade de iniciar tarefas em nome do Sistema, desabilitando a op√ß√£o " <i>Permitir que os operadores de servidor agendem tarefas</i> " na pol√≠tica de seguran√ßa e habilitando a configura√ß√£o " <i>Atribui√ß√£o de Direitos do Usu√°rio: Aumente a Prioridade de Agendamento</i> ". <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protetor de tela (protetor de tela)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar as configura√ß√µes de prote√ß√£o de tela para iniciar malware ap√≥s um determinado per√≠odo de inatividade do usu√°rio. <br>  O aplicativo Windows Screensaver (scrnsave.exe) est√° localizado em <i>C: \ Windows \ System32</i> , junto com outros protetores de tela inclu√≠dos no conjunto do SO base.  Um invasor pode manipular os par√¢metros da tela inicial na <i>chave</i> do Registro <i>HKEY_CURRENT_USER \ Control Panel \ Desktop</i> : <br><ul><li>  SCRNSAVE.EXE - especifique o caminho para o arquivo execut√°vel malicioso; </li><li>  ScreenSaveActivr - defina o valor como "1" para ativar a prote√ß√£o de tela; </li><li>  ScreenSaverISSecure - defina o valor como "0" para que o sistema n√£o exija uma senha para desbloquear a √°rea de trabalho do Windows ap√≥s desligar o protetor de tela; </li><li>  ScreenSaverTimeout - defina o per√≠odo de inatividade antes de iniciar o protetor de tela. </li></ul><br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Bloqueie a capacidade de executar arquivos * .scr em locais n√£o padr√£o.  Gerencie as configura√ß√µes do protetor de tela usando a Diretiva de Grupo, que pro√≠be altera√ß√µes locais nas configura√ß√µes do protetor de tela. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Provedor de suporte de seguran√ßa (SPP)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador <br>  <i>Descri√ß√£o: os</i> invasores podem configurar o c√≥digo malicioso a ser executado sempre que o sistema √© inicializado ou a fun√ß√£o da API AddSecurityPackage √© chamada adicionando um falso SSP √† configura√ß√£o da Autoridade de Seguran√ßa Local (LSA).  SSP - m√≥dulos de programa (DLL) que cont√™m um ou mais esquemas de autentica√ß√£o e criptografia carregados no processo LSASS na inicializa√ß√£o do sistema.  As DLLs do SPP t√™m acesso a senhas criptografadas e de texto sem formata√ß√£o armazenadas no Windows.  A configura√ß√£o do SPP √© armazenada em duas chaves do Registro: <br><ul><li>  <i>Pacotes HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ Security</i> ; </li><li>  <i>Pacotes HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ OSConfig \ Security</i> . </li></ul><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> No Windows 8.1, Windows Server R2 e vers√µes posteriores do sistema operacional, voc√™ deve ativar o modo protegido LSA (Process Protect Light - PPL), no qual todos os arquivos DLL do SPP devem ser assinados digitalmente pela Microsoft: <br>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL = dword: 00000001</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fraquezas nas permiss√µes de registro de servi√ßo Fraqueza</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, Sistema <br>  <i>Descri√ß√£o:</i> se as permiss√µes de usu√°rios e grupos permitirem alterar os valores das chaves no registro do Windows em que os par√¢metros do servi√ßo est√£o armazenados, os atacantes poder√£o modificar diretamente as chaves que armazenam os caminhos nos arquivos execut√°veis ‚Äã‚Äãpara iniciar os servi√ßos ou usar v√°rias ferramentas de gerenciamento de servi√ßos - sc.exe, PowerShell ou Reg.  Os invasores tamb√©m podem alterar os par√¢metros relacionados √† falha no servi√ßo, por exemplo, FailureCommand, indicando um comando que ser√° executado no caso de uma falha no servi√ßo ou dano intencional.  Os par√¢metros de servi√ßo s√£o armazenados nos servi√ßos <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \</i> . <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifique se os usu√°rios do sistema protegido n√£o podem alterar as chaves no registro que armazenam os par√¢metros dos componentes do sistema. </font><font style="vertical-align: inherit;">Use todos os meios poss√≠veis para bloquear software potencialmente perigoso, por exemplo, Windows AppLocker.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifica√ß√£o de atalho</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem criar novos atalhos e links simb√≥licos disfar√ßados de programas leg√≠timos ou modificar os caminhos nos atalhos existentes para que suas ferramentas sejam executadas em vez do aplicativo original. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite os direitos de usu√°rios e grupos, como Administradores, para criar links simb√≥licos usando o GPO: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o do computador&gt; [Diretivas]&gt; Configura√ß√µes do Windows&gt; Configura√ß√µes de seguran√ßa&gt; Diretivas locais&gt; Atribui√ß√£o de direitos do usu√°rio: Crie links simb√≥licos. </font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use ferramentas para bloquear software potencialmente perigoso e a Pol√≠tica de Restri√ß√£o de Software.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itens de inicializa√ß√£o</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rights:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Um</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasor pode usar o mecanismo de inicializa√ß√£o autom√°tica obsoleto, mas ainda trabalhando no macOS Sierra, para aplicativos usando StartupItems para configurar o lan√ßamento de seu c√≥digo com privil√©gios de root no momento da inicializa√ß√£o. </font><font style="vertical-align: inherit;">StartupItems √© um diret√≥rio em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um script de comando e o arquivo de propriedades StartupParameters.plist. </font><font style="vertical-align: inherit;">O script e o arquivo de propriedades devem estar no topo da hierarquia: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems / [MyStartupItem]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como o mecanismo StartupItems √© obsoleto, a proibi√ß√£o de gravar no </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diret√≥rio / Library / Startupitems /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permitir√° que voc√™ evite criar itens de inicializa√ß√£o.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware do sistema</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">: Os</font></i><font style="vertical-align: inherit;"> atacantes especialmente sofisticados podem modificar ou atualizar a BIOS, UIFI ou UFI, a fim de fornecer a capacidade de instalar atualiza√ß√µes maliciosas de firmware e corrigi-las no sistema. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> direcione o vetor de prote√ß√£o para impedir que o invasor acesse contas privilegiadas necess√°rias para implementar a t√©cnica descrita. </font><font style="vertical-align: inherit;">Considere a necessidade e aplicabilidade do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trusted Platform Module (TPM)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no sistema protegido </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Considere a necessidade de usar ferramentas externas para monitorar e analisar a seguran√ßa do firmware do sistema, por exemplo, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CHIPSEC Framework</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fornecedores de tempo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rights:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, System </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem registrar como um provedor de hor√°rio (Time Provider) uma DLL maliciosa que ser√° executada quando o sistema iniciar ou alterar a configura√ß√£o do Windows Time Server (W32Time). Os par√¢metros dos provedores de hor√°rio s√£o armazenados no registro: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services \ W32Time \ TimeProviders</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para registrar um provedor de hor√°rio, voc√™ precisar√° de direitos de administrador, mas ele ser√° executado no contexto da conta de servi√ßo local. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considere usar um GPO para definir altera√ß√µes de bloqueio nas configura√ß√µes do W32Time. </font><font style="vertical-align: inherit;">Use todos os tipos de meios para bloquear o download de DLLs maliciosas, por exemplo, aquelas incorporadas ao Windows AppLocker e DeviceGuard.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trap Team</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O comando trap √© usado para proteger o script contra interrup√ß√µes ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ctrl + c, ctrl + d, ctrl + z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc.). Se o script receber um sinal de interrup√ß√£o especificado nos argumentos do comando trap, ele processar√° o sinal de interrup√ß√£o sozinho, enquanto o shell n√£o processar√° esse sinal. Os atacantes podem usar trap para registrar o c√≥digo que ser√° executado quando o shell receber certos sinais de interrup√ß√£o. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â dif√≠cil impedir o uso dessa t√©cnica, porque o invasor usa os mecanismos padr√£o do sistema operacional. </font><font style="vertical-align: inherit;">O vetor de prote√ß√£o deve ter como objetivo impedir a√ß√µes maliciosas nos est√°gios anteriores do ataque, por exemplo, no est√°gio de entrega ou cria√ß√£o de um arquivo malicioso no sistema.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contas v√°lidas</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem roubar as credenciais de uma conta de usu√°rio ou servi√ßo espec√≠fica usando credenciais de acesso, capturar credenciais no processo de intelig√™ncia usando engenharia social. As credenciais comprometidas podem ser usadas para ignorar os sistemas de controle de acesso e obter acesso a sistemas remotos e servi√ßos externos, como VPN, OWA, √Årea de Trabalho Remota, ou para obter privil√©gios elevados em sistemas e √°reas espec√≠ficos da rede. Se o cen√°rio for bem-sucedido, os invasores podem recusar malware para dificultar a detec√ß√£o. Al√©m disso, os invasores podem criar contas usando nomes e senhas predefinidos para manter o acesso ao backup em caso de tentativas frustradas de usar outros meios.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aplique uma pol√≠tica de senha, siga as recomenda√ß√µes para projetar e administrar uma rede corporativa para limitar o uso de contas privilegiadas em todos os n√≠veis administrativos. </font><font style="vertical-align: inherit;">Verifica√ß√µes regulares de contas locais e de dom√≠nio e seus direitos, a fim de identificar aquelas que podem permitir que um invasor obtenha amplo acesso. </font><font style="vertical-align: inherit;">Monitorando a atividade da conta usando sistemas SIEM.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shell da Web</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O Shell da Web pode ser usado por um invasor como um gateway para acessar sua rede ou acesso redundante ao sistema atacado, como um mecanismo de backup para prote√ß√£o em caso de detec√ß√£o e bloqueio dos principais canais de acesso ao ambiente atacado. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifique se os servidores Web externos s√£o atualizados regularmente e se n√£o h√° vulnerabilidades conhecidas que permitam que os atacantes carreguem um arquivo ou script no servidor com a execu√ß√£o subsequente. </font><font style="vertical-align: inherit;">Verifique se as permiss√µes de contas e grupos com direitos de gerenciamento de servidor n√£o correspondem √†s contas de rede internas que podem ser usadas para efetuar login no servidor da Web, iniciar o shell da Web ou fixar no servidor da Web. </font><font style="vertical-align: inherit;">O Web Shell √© dif√≠cil de detectar porque </font><font style="vertical-align: inherit;">eles n√£o iniciam conex√µes e seu servidor pode ser pequeno e inofensivo, por exemplo, a vers√£o PHP do shell China Chopper Web se parece com uma linha: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[? php </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eval</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ($ _POST ['password']);]</font></font></i> <br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assinatura de Eventos da Instrumenta√ß√£o de Gerenciamento do Windows</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rights:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, System </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WMI Event Subscription √© uma funcionalidade que permite ao administrador configurar o recebimento de notifica√ß√µes de eventos, incluindo aquelas que ocorreram em sistemas remotos, seguidas pela execu√ß√£o autom√°tica de qualquer a√ß√£o (executando um script, aplicativo etc.) Os invasores, para obter uma posi√ß√£o no sistema, podem abusar da funcionalidade descrita acima, configurando uma assinatura para eventos como o rel√≥gio do sistema ou o tempo de opera√ß√£o do computador, seguido pela execu√ß√£o do c√≥digo quando esse evento ocorrer. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifique se apenas as contas de administrador t√™m direitos para se conectar remotamente √† WMI e se no sistema protegido n√£o h√° coincid√™ncia entre as contas de administrador do sistema e outras contas privilegiadas. </font><font style="vertical-align: inherit;">Desabilitar o WMI pode causar instabilidade no sistema, portanto, requer uma avalia√ß√£o preliminar das poss√≠veis consequ√™ncias negativas.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL do Assistente do Winlogon</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rights:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, System </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Ao modificar as configura√ß√µes do Registro para DLLs auxiliares usadas pelo Winlogon.exe, um invasor pode executar DLLs maliciosas repetidamente para corre√ß√£o no sistema. </font><font style="vertical-align: inherit;">Os par√¢metros do Winlogon s√£o armazenados nas se√ß√µes:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_CURRENT_USER \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Winlogon</font></font></i> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ o Winlogon</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V√°rias subse√ß√µes vulner√°veis ‚Äã‚Äãs√£o conhecidas: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon \ Notify</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - especifica DLLs que manipulam eventos do Windows</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon \ Userinit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - aponta para o arquivo userinit.exe, o programa de inicializa√ß√£o do usu√°rio que √© executado quando o usu√°rio faz logon no sistema;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon \ Shell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - aponta para o arquivo explorer.exe, o shell do sistema que √© executado quando um usu√°rio faz logon no sistema.</font></font></li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifique se apenas administradores autorizados podem alterar as configura√ß√µes do Winlogon. </font><font style="vertical-align: inherit;">Use todos os meios para bloquear o download de DLLs maliciosas e de programas potencialmente perigosos, por exemplo, aqueles incorporados ao Windows AppLocker e DeviceGuard.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt425177/">https://habr.com/ru/post/pt425177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt425167/index.html">Dialetos do ingl√™s: como entender o interlocutor sem quebrar o c√©rebro</a></li>
<li><a href="../pt425169/index.html">Pare um momento! Conhe√ßa Normcore Marketing</a></li>
<li><a href="../pt425171/index.html">Tecnologia s√≥lida: √© hora de reconstruir a web</a></li>
<li><a href="../pt425173/index.html">Anistia total. Putin apresentou um projeto de lei para descriminalizar parcialmente o artigo 282 sobre extremismo na Internet</a></li>
<li><a href="../pt425175/index.html">Um pouco sobre placas de som com sintetizadores OPL2 / 3 FM para PC ...</a></li>
<li><a href="../pt425179/index.html">As estrelas do YouTube come√ßam a esgotar-se no trabalho: "o apelo dos mais interessantes do trabalho desapareceu"</a></li>
<li><a href="../pt425181/index.html">Frankie Zapata para The Verge: "O combust√≠vel turbojato ajudar√° a derreter o ceticismo do concreto armado"</a></li>
<li><a href="../pt425187/index.html">PAC Intel com FPGA Stratix 10 SX - acelerador para grandes tarefas</a></li>
<li><a href="../pt425191/index.html">Fastware</a></li>
<li><a href="../pt425195/index.html">Listas em preto, branco e cinza protegem a seguran√ßa da empresa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>