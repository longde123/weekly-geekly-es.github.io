<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçæ üî∫ ‚õµÔ∏è Transf√©rer le service Web vers Yandex.Cloud avec AWS üîá üò∂ üë≤üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! Je m'appelle Vitaly Davydov, je suis le fondateur de Poteha Labs. 

 √Ä la fin de l'ann√©e derni√®re, Yandex a lanc√© un nouveau produit p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Transf√©rer le service Web vers Yandex.Cloud avec AWS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440054/"> Bonjour √† tous!  Je m'appelle Vitaly Davydov, je suis le fondateur de Poteha Labs. <br><br>  √Ä la fin de l'ann√©e derni√®re, Yandex a lanc√© un nouveau produit pour les d√©veloppeurs - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex.Cloud</a> , qui fournit la puissance de calcul et les services connexes pour le traitement et le stockage des donn√©es.  Dans cet article, je parlerai de la mani√®re dont nous avons √©valu√© le transfert de l'un de nos projets vers le Cloud, ses fonctionnalit√©s et ses tarifs. <br><br><img src="https://habrastorage.org/webt/jp/oy/k3/jpoyk3haeubxjlomuswoi0g25sm.png" alt="Pr√©sentation de Yandex.Clouds"><br><a name="habracut"></a><br>  Il existe deux fa√ßons de d√©ployer votre service Web ou votre application mobile.  Regardons un exemple de base de donn√©es (comme l'une des parties d'un service Web): <br><br><ul><li>  <b>Autog√©r√©</b> - louez une voiture et d√©ployez votre PostgreSQL dessus.  Son postgres a ses avantages et ses inconv√©nients: si les charges sont petites, une telle solution sera suffisante.  Mais plus les volumes sont importants, plus la maintenance est n√©cessaire et, √† un moment donn√©, vous aurez besoin d'un ing√©nieur DevOps distinct. </li><li>  <b>Enti√®rement g√©r√©</b> - choisissez un fournisseur de cloud et utilisez PostgreSQL en tant que service.  Dans ce cas, le fournisseur de cloud assume la prise en charge de l'ensemble de l'infrastructure et garantit que tout fonctionnera conform√©ment au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SLA</a> (accord sur le niveau de prestation de service, qui limite le <i>temps d'indisponibilit√© maximum, le temps d'indisponibilit√© total maximum pour une p√©riode</i> ).  Aucun probl√®me avec le support de l'infrastructure. </li></ul><br>  Ceux qui choisissent l'option cloud connaissent bien les trois principaux fournisseurs de services: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microsoft Azure</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Amazon Web Services (AWS)</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Google Cloud</a> .  Ils fournissent un nombre illimit√© de machines virtuelles et des dizaines de services pratiques, et parmi trois options, vous pouvez choisir la solution qui convient au prix.  Nous travaillons g√©n√©ralement avec AWS, qui pr√©sente r√©cemment plusieurs inconv√©nients lorsqu'il est utilis√© en Russie. <br><br>  La premi√®re caract√©ristique d'AWS en Russie est associ√©e aux verrous ILV actifs, dont de nombreux services ont souffert en 2018, des startups aux syst√®mes bancaires ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Viber, Skyeng et autres</a> ). <br><br>  De plus, √† partir de d√©but 2019, Amazon a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">commenc√© √† facturer la</a> TVA (20% du prix) aux entreprises russes pour l'utilisation de ses solutions cloud.  Ce n'est pas sp√©cifique √† Amazon: la TVA est d√©j√† per√ßue par Microsoft, Google et d'autres soci√©t√©s Internet √©trang√®res.Cependant, dans tous les cas, il s'agit d'une augmentation d√©sagr√©able des prix pour les soci√©t√©s pour l'ensemble de services habituel. <br><br>  En plus des soci√©t√©s internationales bien connues, il existe √©galement le march√© russe des syst√®mes cloud: la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plateforme Mail.Ru Cloud Solutions</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Selectel</a> et certains petits acteurs.  Alors que beaucoup ne proposent que la location de fer, ce qui n'est pas √©gal au cloud computing.  Un cloud complet fournit non seulement des voitures de location, mais √©galement un ensemble de services d'accompagnement pour simplifier l'infrastructure (par exemple, comme les bases de donn√©es g√©r√©es). <br><br><h3>  March√© russe </h3><br>  En Russie, les solutions cloud √† part enti√®re sont peu nombreuses (√† savoir deux): MCS de mail.ru et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cloud,</a> r√©cemment lanc√©. <br><br>  Yandex aborde la question de la fourniture de services afin de louer l'√©cosyst√®me de services.  Un cloud pr√™t √† l'emploi n'offre pas autant de services que dans AWS: ordinateurs, stockage de donn√©es, bases de donn√©es, √©quilibreur de charge (alpha), orchestration de conteneurs (alpha), pr√©voit d'ajouter une plate-forme sans serveur.  L'ensemble de services propos√© vous permet de concevoir et de faire √©voluer un grand nombre de solutions commerciales plus rapidement que sur votre propre infrastructure, et le nombre de services est √©galement en constante augmentation.  Le Cloud dispose de trois centres de donn√©es, vous pouvez donc cr√©er des syst√®mes r√©partis g√©ographiquement. <br><br>  Fin 2018, le Cloud a lanc√© publiquement et a ouvert pour la premi√®re fois une connexion au programme de partenariat (dont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nous sommes</a> devenus l'un des premiers partenaires), et √† partir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du 7 d√©cembre 2018,</a> il est devenu accessible √† tous.  Lorsque vous vous connectez maintenant, Cloud accorde aux utilisateurs une subvention pour connaissance - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4000 roubles pendant 2 mois</a> .  Gr√¢ce √† un acc√®s anticip√©, nous avons examin√© les opportunit√©s, les tarifs et effectu√© des calculs pour transf√©rer l'un de nos services d'AWS vers le Cloud. <br><br><h3>  L'architecture </h3><br>  Maintenant, notre service Web fonctionne en production sur AWS et se compose de deux composants: avant et arri√®re, nous allons donc envisager de transf√©rer vers le cloud composant par composant.  Nous migrons l'application avec la pile technologique suivante: <br><br>  - <b>Frontend</b> .  √âcrit dans React, le rendu se produit sur le client.  Les fichiers statiques (html, scripts et styles) sont stock√©s sur Simple Storage Service (S3). <img src="https://habrastorage.org/webt/0f/or/gq/0forgqeox8rhmdvmyto_vz-krw4.jpeg" alt="Architecture frontale AWS"><br><br>  - <b>Backend</b> .  Une application Django qui s'ex√©cute dans des conteneurs Docker sur des machines virtuelles Elastic Compute Cloud (EC2).  Les machines sont g√©r√©es par Elastic Container Service (ECS, un orchestrateur de conteneurs gratuit), pour les bases de donn√©es que nous utilisons PostgreSQL dans le Relational Database Service (RDS).  Pour l'√©quilibrage de charge - Elastic Load Balancer (ELB). <img src="https://habrastorage.org/webt/61/cm/a0/61cma02fgqcbpa1w1b94xdxerky.jpeg" alt="Architecture de backend AWS"><br>  Nous d√©ployons l'application via GitLab CI, en utilisant l'AWS CLI pour mettre √† jour le service sur ECS et la statique sur S3. <br><br>  A quoi ressemblera l'architecture de service sur Yandex.Cloud: <br><br>  - <b>Frontend</b> .  Au lieu de S3, Yandex Object Storage est utilis√©, √† partir duquel vous pouvez √©galement distribuer des statiques de site. <img src="https://habrastorage.org/webt/rg/rx/hg/rgrxhgth9iwtiucnq_8jr5cwr08.jpeg" alt="Architecture frontend sur Yandex.Cloud"><br><br>  - <b>Backend</b> .  Au lieu d'EC2, Yandex Compute Cloud est utilis√©, de structure similaire: il existe √©galement un stockage par blocs, qui existe s√©par√©ment des machines.  Le cloud n'a d√©sormais plus d'analogue ECS pr√™t √† l'emploi (mais dans la version alpha, il existe des groupes d'instances Yandex, sur la base desquels ils promettent de pr√©senter un service de conteneur g√©r√©).  Par cons√©quent, pour l'instant, au lieu d'ECS, vous devez utiliser Kubernetes ou Rancher, que vous devez d√©ployer vous-m√™me.  L'√©quilibreur de charge Yandex dans le cloud est √©galement en alpha, donc pour l'instant, vous pouvez utiliser nginx, lev√© sur une machine distincte, comme √©quilibreur.  Pour PostgreSQL, Cloud dispose du service g√©r√© Yandex pour PostgreSQL. <img src="https://habrastorage.org/webt/ji/sg/h-/jisgh-eaukttdx3nrpggc7yahhw.jpeg" alt="Architecture de backend sur Yandex.Cloud"><br><br><h3>  Estimation des co√ªts </h3><br>  Apr√®s avoir √©tudi√© l'architecture possible, nous avons fait un calcul estim√© du co√ªt du service sur le Cloud ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les tarifs officiels sont ici</a> ).  Dans le tableau ci-dessous, le co√ªt approximatif de chaque √©l√©ment pour notre service (les prix sont indiqu√©s hors TVA). <br><br><table><tbody><tr><th rowspan="2">  Quoi </th><th colspan="2">  Combien, frottez.  ($) / mois </th></tr><tr><th>  Aws </th><th>  Nuage Yandex </th></tr><tr><td>  √âquilibreur de charge <br>  (1 pc., 1 Go de RAM, 1vCPU 100%, 10 Go SSD) </td><td>  1 300 (20) </td><td>  630 (10) </td></tr><tr><td>  Instances d'application <br>  (2 pi√®ces, 4 Go de RAM, 1vCPU 100%, 20 Go SSD) </td><td>  7 400 (115) </td><td>  2.350 (36) </td></tr><tr><td>  Instance pour conteneur ORE <br>  (√âleveur) </td><td>  - </td><td>  630 (10) </td></tr><tr><td>  Bases de donn√©es <br>  (2 pi√®ces, 4 Go de RAM, 1vCPU 100%, 100 Go SSD) </td><td>  12 800 (198) </td><td>  630 (10) </td></tr><tr><td>  Stockage d'objets <br>  (10 Go, 1 000 000 PUT, 10 000 000 GET) </td><td>  585 (9) </td><td>  470 (7) </td></tr><tr><td>  IP publique <br>  (2 pcs. AWS, 4 pcs. Yandex. Cloud) </td><td>  470 (7) </td><td>  380 (6) </td></tr><tr><td>  Trafic sortant <br>  (500 Go) </td><td>  2 925 (45) </td><td>  635 (10) </td></tr><tr><td>  <b>Total</b> </td><td>  <b>25 480 frotter.</b>  <b>(392 $)</b> </td><td>  <b>9 695 rub.</b>  <b>(149 $)</b> </td></tr></tbody></table><br>  Pour nos param√®tres, le Cloud √©tait 2,6 fois moins cher que AWS.  Le financement de la transition vers le Cloud pour le service est d√©finitivement rentable ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">calculs</a> d√©taill√©s pour le Cloud, pour AWS vous pouvez utiliser la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">calculatrice en ligne</a> ). <br><br><h3>  Caract√©ristiques des services Yandex.Cloud </h3><br><ul><li>  Yandex Compute Cloud diff√®re d'EC2 en ce que sur EC2, vous pouvez augmenter la puissance d'une machine par RAM et CPU uniquement en m√™me temps, et dans le Cloud, ils sont ind√©pendants (pour chaque vCPU, vous pouvez choisir de 1 √† 8 Go de RAM), ce qui donne plus de flexibilit√©. </li><li>  Yandex Object Storage est compatible avec l'API S3.  Parmi les inconv√©nients, il n'est pas encore possible de configurer un certificat https sur votre domaine.  Le probl√®me est r√©solu √† l'aide du certificat Cloudflare, puis le trafic de l'utilisateur vers la couche API externe sera prot√©g√©.  Il s'agit d'une option simple et rapide.  Vous pouvez √©galement configurer le rendu c√¥t√© serveur, nous attendons donc que le Cloud ajoute cette fonctionnalit√©. </li><li>  Le Cloud ne dispose pas encore d'un service de collecte de journaux centralis√©e asynchrone (un analogue d'AWS CloudWatch), par cons√©quent, pour collecter et analyser les journaux, des solutions tierces doivent √™tre connect√©es. </li><li>  Contr√¥le d'acc√®s aux ressources: sur AWS, cela se fait via des r√¥les qui sont cr√©√©s dans le service de gestion des identit√©s et des acc√®s (IAM) et qui sont automatiquement affect√©s √† toutes les instances du cluster ECS.  Le Cloud poss√®de √©galement son propre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IAM</a> , mais les droits granulaires comme dans AWS ne sont pas encore disponibles dans celui-ci. </li><li>  Bien qu'il n'y ait pas de machines GPU pour l'informatique. </li></ul><br><h3>  Conclusion </h3><br>  En conclusion, nous mettons en √©vidence les raisons d'essayer Yandex Cloud: <br><br><ul><li>  Ensemble potentiellement important de services d'infrastructure; </li><li>  Une API compatible AWS est disponible pour certains services, ce qui simplifie consid√©rablement la transition; </li><li>  Les tarifs sont inf√©rieurs √† ceux de leurs homologues occidentaux, il n'y a aucun lien avec le taux de change du dollar; </li><li>  Protection contre les verrous soudains; </li><li>  Un centre de donn√©es en Russie, gr√¢ce auquel la loi sur la protection des donn√©es personnelles des utilisateurs est toujours mise en ≈ìuvre. </li></ul><br>  Pour 2019, Cloud pr√©voit de publier les services annonc√©s et d'en ajouter de nouveaux.  Nous pensons qu'avec un tel ensemble de fonctionnalit√©s et de tarifs, il pourra devenir un puissant concurrent d'Amazon sur le march√© russe. <br><br>  Merci de votre attention, je r√©pondrai aux questions dans les commentaires. <br><br>  <i>Merci √† Wife ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">pruzhinkina</a> ) et Kirill ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">kpotehin</a> ) pour leur aide dans la pr√©paration de la revue</i> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440054/">https://habr.com/ru/post/fr440054/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440044/index.html">Historique d√©taill√© de Qualcomm</a></li>
<li><a href="../fr440046/index.html">Le√ßon ouverte "Cr√©ation de clients REST au printemps"</a></li>
<li><a href="../fr440048/index.html">Statistiques pr√©f√©r√©es: 5 indicateurs que chaque √©quipe commerciale doit suivre</a></li>
<li><a href="../fr440050/index.html">Proxy DNS √† faire soi-m√™me sur Node.JS</a></li>
<li><a href="../fr440052/index.html">Analyse statique du BIOS / UEFI ou comment obtenir un graphique de d√©pendance</a></li>
<li><a href="../fr440058/index.html">Rapport sur les probl√®mes et la disponibilit√© d'Internet 2018-2019</a></li>
<li><a href="../fr440060/index.html">TensorFlow sur Apache Ignite</a></li>
<li><a href="../fr440062/index.html">Planifier avec plaisir. Comment nous mettons en place des processus sans managers</a></li>
<li><a href="../fr440064/index.html">Centres de donn√©es au choix: Londres, Moscou, Zurich, Saint-P√©tersbourg</a></li>
<li><a href="../fr440066/index.html">Extensions VSCode pour faciliter le d√©veloppement de JavaScript et Vue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>