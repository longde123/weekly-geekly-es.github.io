<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§–ğŸ¾ ğŸ‘²ğŸ½ ğŸ‘©â€ğŸ‘©â€ğŸ‘§ Buku Masakan Pengembang: Resep DDD (Bagian 5, Proses) ğŸ–‹ï¸ ğŸ ğŸ¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendahuluan 


 Dalam artikel sebelumnya, kami menjelaskan: ruang lingkup , fondasi metodologis , contoh arsitektur dan struktur . Dalam artikel ini, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Buku Masakan Pengembang: Resep DDD (Bagian 5, Proses)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454668/"><h1 id="vvedenie">  Pendahuluan </h1><br><p> Dalam artikel sebelumnya, kami menjelaskan: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ruang lingkup</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fondasi metodologis</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh arsitektur</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">struktur</a> .  Dalam artikel ini, saya ingin memberi tahu cara menggambarkan proses, tentang prinsip-prinsip persyaratan pengumpulan, bagaimana persyaratan bisnis berbeda dari yang fungsional, bagaimana cara beralih dari persyaratan ke kode.  Bicarakan tentang prinsip-prinsip menggunakan Case Use dan bagaimana mereka dapat membantu kami.  Jelajahi contoh opsi implementasi untuk pola desain Interactor dan Layer Layanan. </p><br><p><img src="https://habrastorage.org/webt/wo/je/ct/woject0sgeuwc_4xnnzugty-5jg.png" alt="seperti nenek moyangmu"></p><br><p>  Contoh-contoh yang diberikan dalam artikel diberikan menggunakan solusi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LunaPark</a> kami, ini akan membantu Anda dengan langkah-langkah pertama dalam pendekatan yang dijelaskan. </p><br><h1 id="otdelyaem-funkcionalnye-trebovaniya-ot-biznes-trebovaniy">  Pisahkan persyaratan fungsional dari persyaratan bisnis. </h1><br><p>  Berkali-kali, banyak ide bisnis yang tidak benar-benar berubah menjadi produk akhir yang diinginkan.  Hal ini sering disebabkan oleh ketidakmampuan untuk memahami perbedaan antara persyaratan bisnis dan persyaratan fungsional, yang pada akhirnya menyebabkan pengumpulan persyaratan yang tidak memadai, dokumentasi yang tidak perlu, penundaan proyek dan kegagalan proyek besar. </p><br><p>  Atau kadang-kadang kita dihadapkan pada situasi di mana, meskipun solusi akhir memenuhi kebutuhan pelanggan, tetapi entah bagaimana tujuan bisnis tidak tercapai. </p><br><p>  Oleh karena itu, sangat penting untuk memisahkan persyaratan bisnis dari persyaratan fungsional hingga Anda mulai mendefinisikannya.  Mari kita ambil contoh. </p><a name="habracut"></a><br><p>  Misalkan kita sedang menulis aplikasi untuk perusahaan pengiriman pizza, dan kami memutuskan untuk membuat sistem pelacakan kurir.  Persyaratan bisnis adalah sebagai berikut: </p><br><p>  <em>"Memperkenalkan sistem berbasis web dan sistem pelacakan karyawan berbasis karyawan yang menangkap kurir pada rute mereka dan meningkatkan efisiensi dengan memantau aktivitas kurir, ketidakhadiran mereka dari pekerjaan dan produktivitas tenaga kerja."</em> </p><br><p>  Di sini kita dapat membedakan sejumlah fitur karakteristik yang akan menunjukkan bahwa ini adalah persyaratan dari bisnis: </p><br><ul><li>  persyaratan bisnis selalu ditulis dari sudut pandang klien; </li><li>  Ini adalah persyaratan luas, tingkat tinggi, tetapi masih berorientasi sebagian; </li><li>  mereka bukan tujuan perusahaan, tetapi membantu perusahaan mencapai tujuan; </li><li>  jawab pertanyaan " <strong>mengapa</strong> " dan " <strong>apa</strong> ".  Apa yang ingin diterima perusahaan?  Dan mengapa dia membutuhkannya. </li></ul><br><p>  Persyaratan fungsional adalah <em>Tindakan</em> yang harus dilakukan sistem untuk melaksanakan persyaratan bisnis.  Dengan demikian, persyaratan fungsional terkait dengan solusi atau perangkat lunak yang dikembangkan.  Kami merumuskan persyaratan fungsional untuk contoh di atas: </p><br><ul><li>  sistem harus menampilkan garis bujur dan garis lintang karyawan melalui GPS / GLONASS; </li><li>  sistem harus menampilkan posisi karyawan di peta; </li><li>  sistem harus memungkinkan manajer untuk mengirim pemberitahuan kepada bawahannya. </li></ul><br><p>  Kami menyoroti fitur-fitur berikut: </p><br><ul><li>  persyaratan fungsional selalu ditulis dari sudut pandang sistem; </li><li>  mereka lebih spesifik dan terperinci; </li><li>  itu berkat pemenuhan persyaratan fungsional yang dikembangkan solusi efektif yang memenuhi kebutuhan bisnis dan tujuan klien; </li><li>  jawab pertanyaan " <strong>bagaimana</strong> ."  Bagaimana sistem memecahkan persyaratan bisnis. </li></ul><br><p>  Beberapa kata harus dikatakan tentang persyaratan non-fungsional (juga dikenal sebagai "persyaratan kualitas") yang memberlakukan pembatasan pada desain atau implementasi (misalnya, persyaratan untuk kinerja, keamanan, ketersediaan, keandalan).  Persyaratan seperti itu menjawab pertanyaan " <strong>apa yang</strong> harus" menjadi sistem. </p><br><p>  Pengembangan adalah terjemahan persyaratan bisnis menjadi fungsional.  Pemrograman terapan adalah implementasi persyaratan fungsional, dan sistem - non-fungsional. </p><br><h1 id="varianty-ispolzovaniya-use-cases">  Gunakan kasing </h1><br><p>  Menerapkan persyaratan fungsional seringkali merupakan yang paling kompleks dalam sistem komersial.  Dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">arsitektur murni,</a> persyaratan fungsional diimplementasikan melalui lapisan <em>Use Case</em> . </p><br><p>  Tapi sebagai permulaan, saya ingin beralih ke sumbernya.  Ivar Jacobson - penulis definisi <em>Use Case</em> , salah satu penulis UML, dan metodologi RUP, dalam artikelnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Use-Case 2.0 Hub Pengembangan Perangkat Lunak</a> mengidentifikasi 6 prinsip untuk menggunakan <em>kasus-kasus</em> Penggunaan: </p><br><ol><li>  membuatnya sederhana melalui mendongeng; </li><li>  punya rencana strategis, waspadai keseluruhan gambaran; </li><li>  fokus pada makna; </li><li>  berbaris sistem dalam lapisan; </li><li>  mengirimkan sistem langkah demi langkah; </li><li>  memenuhi kebutuhan tim. </li></ol><br><p>  Kami mempertimbangkan secara singkat masing-masing prinsip ini, mereka berguna bagi kami untuk pemahaman lebih lanjut.  Di bawah ini adalah terjemahan gratis saya, dengan singkatan dan sisipan, saya sangat menyarankan Anda membiasakan diri dengan yang asli. </p><br><h3 id="prostota-cherez-povestvovanie">  Kesederhanaan melalui bercerita </h3><br><p>  <em>Narasi adalah bagian dari budaya kita;</em>  <em>Ini adalah cara termudah dan paling efektif untuk mentransfer pengetahuan, informasi dari satu orang ke orang lain.</em>  <em>Ini adalah cara terbaik untuk mengkomunikasikan apa yang harus dilakukan sistem dan membantu tim fokus pada tujuan bersama.</em> </p><br><p>  <em>Kasus penggunaan mencerminkan tujuan sistem.</em>  <em>Untuk memahami Use Case, kami memberi tahu, menceritakan kisah tertentu.</em>  <em>Ceritanya menceritakan bagaimana mencapai tujuan dan bagaimana menyelesaikan masalah yang muncul di sepanjang jalan.</em>  <em>Gunakan kasing, seperti buku cerita, menyediakan cara untuk mengidentifikasi dan meliput semua cerita yang berbeda tetapi terkait dengan cara yang sederhana dan komprehensif.</em>  <em>Ini membuatnya mudah untuk mengumpulkan, mendistribusikan, dan memahami persyaratan sistem.</em> </p><br><p>  Prinsip ini berkorelasi dengan bahasa Ubiques dari pendekatan DDD. </p><br><h3 id="ponimanie-kartiny-v-celom">  Memahami keseluruhan gambar </h3><br><p>  <em>Terlepas dari sistem mana yang Anda kembangkan, besar, kecil, perangkat lunak, perangkat keras atau bisnis, memahami gambaran besar sangat penting.</em>  <em>Tanpa memahami sistem secara keseluruhan, Anda tidak dapat membuat keputusan yang tepat tentang apa yang akan dimasukkan ke dalam sistem, apa yang harus dikesampingkan, berapa biayanya, dan manfaat apa yang akan dihasilkannya.</em> </p><br><p>  Ivar Jacobson menyarankan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diagram use case</a> , yang sangat nyaman untuk mengumpulkan persyaratan.  Jika persyaratan dikompilasi dan dihapus, maka peta Konteks Eric Evans adalah pilihan terbaik.  Seringkali, pendekatan Scrum ditafsirkan sehingga orang tidak menghabiskan waktu untuk rencana strategis, mengingat perencanaan, lebih dari dua minggu kemudian, peninggalan masa lalu.  Propaganda Jeff Sutherland jatuh pada aliran air, dan orang-orang yang menyelesaikan kursus pelatihan dua minggu untuk Scrum Masters yang diizinkan untuk mengelola proyek melakukan pekerjaan mereka.  Tetapi akal sehat mengakui pentingnya perencanaan strategis.  Tidak perlu membuat rencana strategis yang terperinci, tetapi haruslah demikian. </p><br><h3 id="fokus-na-znachenii">  Fokus pada nilai </h3><br><p>  <em>Ketika mencoba memahami bagaimana sistem akan digunakan, selalu penting untuk fokus pada nilai yang akan diberikannya kepada penggunanya dan pihak-pihak lain yang berkepentingan.</em>  <em>Nilai terbentuk hanya ketika sistem digunakan.</em>  <em>Oleh karena itu, jauh lebih baik untuk fokus pada bagaimana sistem akan diterapkan daripada pada daftar panjang fitur atau kemampuan yang dapat ditawarkannya.</em> </p><br><p>  <em>Use case menyediakan fokus ini, membantu Anda berkonsentrasi pada bagaimana sistem akan digunakan oleh pengguna tertentu untuk mencapai tujuannya.</em>  <em>Use cases mencakup banyak cara untuk menggunakan sistem: yang berhasil mencapai tujuan mereka, dan yang memecahkan kesulitan yang muncul.</em> </p><br><p>  Selanjutnya, penulis memberikan skema yang luar biasa, yang harus diperhatikan: </p><br><p><img src="https://habrastorage.org/webt/5g/nk/ma/5gnkmae4chv6_azevvzhg2euglc.png"></p><br><p>  Diagram menunjukkan use case, "Penarikan tunai di ATM".  Cara termudah untuk mencapai tujuan dijelaskan dalam <em>Arah</em> Dasar (Aliran dasar).  Kasus-kasus lain digambarkan sebagai aliran alternatif.  Arahan ini membantu bercerita, menyusun sistem, dan membantu menulis tes. </p><br><h3 id="posloynoe-postroenie">  Layering </h3><br><p>  <em>Sebagian besar sistem membutuhkan banyak pekerjaan sebelum siap digunakan.</em>  <em>Mereka memiliki banyak persyaratan, yang sebagian besar tergantung pada persyaratan lain, mereka harus diimplementasikan sebelum persyaratan dipenuhi dan dievaluasi.</em> </p><br><p>  <em>Adalah kesalahan besar untuk membuat sistem seperti itu pada suatu waktu.</em>  <em>Sistem harus dibangun dari potongan-potongan, yang masing-masing memiliki nilai yang jelas bagi pengguna.</em> </p><br><p>  Ide-ide ini beresonansi dengan pendekatan gesit dan dengan ide-ide <em>Domain</em> . </p><br><h3 id="poshagovyy-vyvod-produkta-na-rynok">  Peluncuran produk langkah demi langkah </h3><br><p>  <em>Sebagian besar sistem perangkat lunak telah berkembang selama beberapa generasi.</em>  <em>Mereka tidak diproduksi pada suatu waktu;</em>  <em>mereka dibangun sebagai serangkaian rilis, yang masing-masing dibangun pada rilis sebelumnya.</em>  <em>Bahkan rilis itu sendiri sering tidak keluar sekaligus, tetapi berkembang melalui serangkaian versi perantara.</em>  <em>Setiap langkah menyediakan versi sistem yang jelas dan dapat digunakan.</em>  <em>Ini adalah cara semua sistem harus dibuat.</em> </p><br><h3 id="udovletvoryat-potrebnosti-komandy">  Memenuhi kebutuhan tim </h3><br><p>  <em>Sayangnya, tidak ada solusi universal untuk masalah pengembangan perangkat lunak;</em>  <em>tim yang berbeda dan situasi yang berbeda memerlukan gaya dan tingkat detail yang berbeda pula.</em>  <em>Apa pun metode dan teknik yang Anda pilih, Anda harus memastikan bahwa mereka cukup mudah beradaptasi untuk memenuhi kebutuhan tim saat ini.</em> </p><br><p>  Eric Evans dalam bukunya mendesak Anda untuk tidak menghabiskan banyak waktu menjelaskan semua proses melalui UML.  Cukup menggunakan skema visual apa pun.  Tim yang berbeda, proyek yang berbeda memerlukan tingkat detail yang berbeda, karena penulis UML sendiri membicarakan hal ini. </p><br><h1 id="realizaciya">  Implementasi </h1><br><p>  Dalam arsitektur murni, Robert Martin mendefinisikan <em>kasus Penggunaan</em> berikut: </p><br><blockquote>  Use case ini mengatur aliran data ke dan dari entitas, dan mengarahkan entitas tersebut untuk menggunakan Aturan Bisnis Kritis mereka untuk mencapai tujuan use case. </blockquote><p>  Mari kita coba menerjemahkan ide-ide ini ke dalam kode.  Mari kita ingat skema dari prinsip ketiga menggunakan <em>Kasus</em> Penggunaan dan menganggapnya sebagai dasar.  Pertimbangkan proses bisnis yang sangat rumit: "Memasak Pai Kubis". </p><br><p>  Mari kita coba mendekomposisinya: </p><br><ul><li>  periksa ketersediaan produk; </li><li>  ambil dari stok; </li><li>  remas adonan; </li><li>  biarkan adonan mengembang; </li><li>  menyiapkan isian; </li><li>  membuat kue; </li><li>  membuat kue pai. </li></ul><br><p>  Kami menerapkan seluruh urutan ini melalui <em>Interactor</em> , dan setiap langkah akan diimplementasikan melalui fungsi atau Objek Fungsional pada Lapisan Layanan. </p><br><h1 id="posledovatelnost-deystviy-interactor">  Sequence of Actions (Interactor) </h1><br><p><img src="https://habrastorage.org/webt/6b/vk/ra/6bvkra2chr3b8d43dmtxebpjaj4.png" alt="selangkah demi selangkah"></p><br><p>  Saya sangat merekomendasikan memulai pengembangan proses bisnis yang kompleks dengan <em>Sequence of Actions</em> .  Lebih tepatnya, tidak demikian, Anda harus menentukan <em>Domain Domain</em> tempat proses bisnis berada.  Perjelas semua persyaratan bisnis.  Identifikasi semua <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><em>Entitas</em></a> yang terlibat dalam proses.  Dokumentasikan persyaratan dan definisi masing-masing <em>Entitas</em> dalam basis pengetahuan. </p><br><p>  Lukis semuanya di atas kertas dalam beberapa langkah.  Terkadang Anda membutuhkan diagram urutan.  Penulisnya adalah orang yang sama yang menemukan Use Case - Ivar Jacobson.  Diagram itu ditemukan olehnya ketika ia mengembangkan sistem pemeliharaan jaringan telepon untuk Erickson, berdasarkan pada rangkaian relai.  Saya sangat suka diagram ini, dan istilah <em>Sequence</em> , menurut pendapat saya, lebih ekspresif daripada istilah <em>Interactor</em> .  Namun mengingat prevalensi yang lebih besar dari yang terakhir, kami akan menggunakan istilah yang akrab - <em>Interactor</em> . </p><br><p>  Sedikit petunjuk ketika Anda menggambarkan proses bisnis adalah bantuan yang baik untuk Anda, aturan utama manajemen dokumen dapat menjadi: "Sebagai hasil dari aktivitas bisnis apa pun, dokumen harus dibuat".  Sebagai contoh, kami sedang mengembangkan sistem diskon.  Memberikan diskon, kami, pada kenyataannya, dari sudut pandang bisnis, menyimpulkan kesepakatan antara perusahaan dan klien.  Semua persyaratan harus dijabarkan dalam kontrak ini.  Yaitu, di domain DiscountSystem, Anda akan memiliki Entites :: Contract.  Jangan ikat diskon dengan klien, tetapi buat Kontrak <em>Entitas</em> , yang menjelaskan aturan untuk ketentuannya. </p><br><p>  Mari kita kembali ke deskripsi proses bisnis kita, setelah menjadi transparan bagi semua orang yang terlibat dalam pengembangannya, dan semua pengetahuan Anda sudah diperbaiki.  Saya sarankan Anda mulai menulis kode dengan <em>Sequence of Actions</em> . </p><br><p>  Templat Desain <em>Urutan</em> bertanggung jawab untuk: </p><br><ul><li>  urutan <em>tindakan</em> ; </li><li>  koordinasi data yang dikirimkan antar <em>Tindakan</em> ; </li><li>  memproses kesalahan yang dilakukan oleh <em>Tindakan</em> selama eksekusi mereka; </li><li>  pengembalian hasil dari serangkaian <em>Tindakan yang</em> dilakukan; </li><li>  <strong>PENTING</strong> : tanggung jawab paling penting dari pola desain ini adalah penerapan logika bisnis. </li></ul><br><p>  Saya ingin memikirkan tanggung jawab terakhir lebih terinci jika kita memiliki semacam proses yang kompleks - kita harus menggambarkannya sedemikian rupa sehingga jelas apa yang terjadi tanpa masuk ke rincian teknis.  <strong>Anda harus mendeskripsikannya secara eksplisit sebagaimana kemampuan pemrograman Anda memungkinkan Anda</strong> .  Percayakan kelas ini kepada anggota tim Anda yang paling berpengalaman. </p><br><p>  Mari kita kembali ke pie: mari kita coba menggambarkan proses persiapannya melalui <em>Interactor</em> . </p><br><h2 id="realizaciya-1">  Implementasi </h2><br><p>  Saya memberikan contoh implementasi dengan solusi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LunaPark</a> kami, yang kami sajikan dalam artikel sebelumnya. </p><br><pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kitchen</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequences</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CookingPieWith</span></span></span><span class="hljs-class"></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abbage</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TEMPERATURE</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Temperature</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(180, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unit</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cel</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::CheckProductsAvailability</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ingredients</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dough</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::BeatDough</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Repository::Products</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beat_ingredients</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::Make</span></span></span><span class="hljs-class"></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abbageFiller</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Repository::Products</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler_ingredients</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::MakePie</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dough</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bake</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::BakePie</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">temp</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TEMPERATURE</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sleep</span></span></span><span class="hljs-class"> 5.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">min</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">until</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bake</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beat_ingredients</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler_ingredients</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ingredients_list</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beat_ingredients_list</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler_ingredients_list</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Seperti yang bisa kita lihat, <code>call!</code>  menjelaskan seluruh logika bisnis dari proses memanggang kue.  Dan lebih mudah digunakan untuk memahami logika aplikasi. </p><br><p>  Selain itu, kita dapat dengan mudah menggambarkan proses memanggang kue ikan, menggantikan <code>MakeabbageFiller</code> dengan <code>MakeFishFiller</code> .  Dengan demikian, kami sangat cepat mengubah proses bisnis, tanpa modifikasi kode yang signifikan.  Dan juga, kita dapat meninggalkan kedua <em>Urutan</em> pada saat yang sama, menskalakan kasus bisnis. </p><br><h3 id="dogovorennosti">  Pengaturan </h3><br><ul><li>  Metode <code>call!</code>  adalah metode yang diperlukan, itu menggambarkan urutan <em>Tindakan</em> . </li><li>  Setiap parameter inisialisasi dapat dijelaskan melalui setter atau <code>attr_acessor</code> : </li></ul><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... private attr_accessor :bar end Foo.call(bar: 42)</span></span></span></span></code> </pre> <br><ul><li>  Sisa metode harus bersifat pribadi. </li></ul><br><h2 id="primer-ispolzovaniya">  Contoh penggunaan </h2><br><pre> <code class="ruby hljs">beat_ingredients = [ Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:flour</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:gr</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:oil</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:gr</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:salt</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:milk</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:ml</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:egg</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:unit</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:yeast</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span> ] filler_ingredients = [ Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:cabbage</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:gr</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:salt</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:pepper</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span> ] cooking = CookingPieWithabbage.call( <span class="hljs-symbol"><span class="hljs-symbol">beat_ingredients:</span></span> beat_ingredients, <span class="hljs-symbol"><span class="hljs-symbol">filler_ingredients:</span></span> filler_ingredients ) <span class="hljs-comment"><span class="hljs-comment">#   : cooking.success? # =&gt; true cooking.fail # =&gt; false cooking.fail_message # =&gt; '' cooking.data # =&gt; Entity::Pie #   : cooking.success? # =&gt; false cooking.fail # =&gt; true cooking.fail_message # =&gt; 'The pie burned out' cooking.data # =&gt; nil</span></span></code> </pre> <br><p>  Proses diwakili melalui objek dan kami memiliki semua metode yang diperlukan untuk memanggilnya - apakah panggilan berhasil, apakah ada kesalahan terjadi selama panggilan, dan jika demikian, yang mana? </p><br><h2 id="obrabotka-oshibok">  Menangani kesalahan </h2><br><p>  Jika kita sekarang mengingat prinsip ketiga dari aplikasi Case Use, kami memperhatikan fakta bahwa selain jalur <em>Utama</em> , kami juga memiliki arahan <em>Alternatif</em> .  Ini adalah kesalahan yang harus kita tangani.  Pertimbangkan sebuah contoh: kami tentu tidak ingin acara seperti itu, tetapi kami tidak bisa melakukan apa-apa, kenyataan pahitnya adalah bahwa pai terbakar secara berkala. </p><br><p>  <em>Interactor</em> mencegat semua kesalahan yang diwarisi dari <code>LunaPark::Errors::Processing</code> class. </p><br><p>  Bagaimana cara melacak kue?  Untuk melakukan ini, tentukan kesalahan <code>Burned</code> dalam <em>Tindakan</em> <code>BakePie</code> . </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kitchen</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Errors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Burned</span></span></span><span class="hljs-class"> &lt; LunaPark::Errors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Processing</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Dan selama memanggang, pastikan pai kami belum habis: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kitchen</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BakePie</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... rescue Errors::Burned, 'The pie burned out' if pie.burned? # ... end end end end</span></span></span></span></code> </pre> <br><p>  Dalam hal ini, jebakan kesalahan akan berfungsi, dan kami akan dapat mengatasinya di <code></code> . <br>  Kesalahan yang tidak diwarisi dari <code>Processing</code> dianggap sebagai kesalahan sistem dan akan dicegat di tingkat server.  Kecuali ditentukan lain, pengguna akan menerima 500 ServerError. </p><br><h2 id="praktika-ispolzovaniya">  Penggunaan praktik </h2><br><h3 id="1-staraytes-opisyvat-vse-vyzovy-v-metode-call">  1. Cobalah untuk menggambarkan semua panggilan dalam metode panggilan! </h3><br><p>  Anda tidak boleh menerapkan setiap <em>Tindakan dalam</em> metode terpisah, ini membuat kode lebih membengkak.  Anda harus melihat seluruh kelas beberapa kali untuk memahami cara kerjanya.  Merusak resep untuk membuat kue: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CookingPieWith</span></span></span><span class="hljs-class"></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abbage</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">check_products_availability</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_cabbage_filler</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_pie</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bake</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">check_products_availability</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::CheckProductsAvailability</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ingredients</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end</span></span></span></span></code> </pre> <br><p>  Gunakan panggilan aksi langsung di kelas.  Dari sudut pandang ruby, pendekatan ini mungkin tampak tidak biasa, sehingga terlihat lebih mudah dibaca: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DrivingStart</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::CheckEngine</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::StartUpTheIgnition</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">car</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::ChangeGear</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">car</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gear_box</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drive</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::StepOnTheGas</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">car</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pedals</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class">] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><h3 id="2-po-vozmozhnosti-ispolzuyte-metod-klassa-call">  2. Jika memungkinkan, gunakan metode kelas panggilan </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># good - ,   ,  . #    . Sequence::RingingToPerson.call(params) # good -   ,      e, #    ,     , #    . ring = Sequence::RingingToPerson.new(person) unless ring.success? ring.call sleep 5.min end</span></span></code> </pre><br><h3 id="3-ne-sozdavayte-_funkcionalnye-obekty_-radi-tipizacii-koda-smotrite-po-situacii">  3. Jangan membuat <em>objek Fungsional</em> demi mengetik kode, lihat situasinya </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># bad -        ,  #     . module Services class BuildUser &lt; LunaPark::Callable def initialize(first_name:, last_name:, phone:) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@first</span></span></span><span class="hljs-comment">_name = first_name </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@last</span></span></span><span class="hljs-comment">_name = last_name </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@phone</span></span></span><span class="hljs-comment"> = phone end def call Entity::User.new( first_name: first_name, last_name: last_name, phone: phone ) end private attr_reader :first_name, :last_name, :phone end end module Sequences class RegisteringUser &lt; LunaPark::Interactors::Sequence attr_accessor :first_name, :last_name, :phone def call! user = Service::BuildUser.call(first_name: first_name, last_name: last_name, phone: phone) end end end # good -     ,  . #        , #       . module Sequences class RegisteringUser &lt; LunaPark::Interactors::Sequence attr_accessor :first_name, :last_name, :phone def call! user #... end private def user </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@user</span></span></span><span class="hljs-comment"> = Entity::User.new( first_name: first_name, last_name: last_name, phone: phone ) end end end</span></span></code> </pre> <br><h1 id="servisnyy-sloy-service-layer">  Lapisan Layanan </h1><br><p><img src="https://habrastorage.org/webt/1-/qv/ip/1-qvipbbxxz2i0cveslcf02b7c0.png" alt="lsd"></p><br><p>  Interactor, seperti yang kami katakan, menggambarkan logika bisnis di tingkat tertinggi.  <em>Lapisan layanan</em> sudah mengungkapkan detail penerapan persyaratan fungsional.  Jika kita berbicara tentang membuat pai, maka pada tingkat Interactor kita cukup mengatakan "uleni adonan", tanpa merinci tentang cara meremasnya.  Proses pengulungan dijelaskan pada <em>tingkat Layanan</em> .  Mari kita kembali ke sumber aslinya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">buku biru besar</a> : </p><br><p>  <em>Di domain yang diterapkan, ada operasi yang tidak dapat menemukan tempat alami di objek bertipe Entity atau Value Object.</em>  <em>Mereka secara inheren bukan objek, tetapi aktivitas.</em>  <em>Tetapi karena dasar dari paradigma pemodelan kami adalah pendekatan objek, kami akan mencoba mengubahnya menjadi objek.</em> </p><br><p>  <em>Pada titik ini mudah untuk membuat kesalahan umum: meninggalkan upaya untuk menempatkan operasi pada objek yang sesuai untuknya, dan dengan demikian sampai pada pemrograman prosedural.</em>  <em>Tetapi jika Anda secara paksa menempatkan operasi pada objek dengan definisi yang asing terhadapnya, ini akan membuat objek itu sendiri kehilangan kemurniannya, membuatnya lebih sulit untuk dipahami dan diperbaiki.</em>  <em>Jika Anda menerapkan banyak operasi kompleks dalam objek sederhana, itu bisa berubah menjadi apa yang tidak dapat dipahami, apa yang Anda lakukan tidak jelas apa.</em>  <em>Operasi tersebut sering melibatkan objek lain dari area subjek dan koordinasi di antara mereka dilakukan untuk melakukan tugas bersama.</em>  <em>Tanggung jawab tambahan menciptakan rantai ketergantungan antar objek, menggabungkan konsep yang dapat dipertimbangkan secara independen.</em> </p><br><p>  Saat memilih lokasi untuk implementasi fungsional, selalu gunakan akal sehat.  Tugas Anda adalah membuat model lebih ekspresif.  Mari kita lihat sebuah contoh, "Kita harus memotong kayu": </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wood</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chop</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end end</span></span></span></span></code> </pre> <br><p>  Metode ini akan menjadi kesalahan.  Kayu bakar tidak akan memotong sendiri, kita membutuhkan kapak: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Axe</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chop</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sacrifice</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end end</span></span></span></span></code> </pre> <br><p>  Jika kita menggunakan model bisnis yang disederhanakan, itu sudah cukup.  Tetapi jika proses perlu dimodelkan secara lebih rinci, kita akan membutuhkan seseorang yang akan memotong kayu bakar ini, dan mungkin beberapa batang kayu yang akan digunakan sebagai dudukan untuk proses tersebut. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chop_firewood</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wood</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">axe</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chock</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end end</span></span></span></span></code> </pre><br><p>  Seperti yang mungkin sudah Anda tebak, ini bukan ide yang baik.  Tidak semua dari kita terlibat dalam memotong kayu, ini bukan tugas langsung seseorang.  Kita sering melihat betapa kelebihan model di Ruby on Rails, yang mengandung logika serupa: mendapatkan diskon, menambahkan barang ke keranjang, menarik uang ke saldo.  Logika ini tidak berlaku untuk entitas, tetapi untuk proses di mana entitas ini terlibat. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChopFirewood</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end</span></span></span></span></code> </pre> <br><p>  Setelah kami menemukan logika apa yang kami simpan di <em>Layanan,</em> kami akan mencoba menerapkan salah satunya.  Paling sering, layanan diimplementasikan melalui metode atau objek fungsional. </p><br><h2 id="funkcionalnye-obekty">  Objek Fungsional </h2><br><p>  Objek fungsional memenuhi satu persyaratan fungsional.  Dalam bentuknya yang paling primitif, objek fungsional memiliki satu metode publik tunggal - <code>call</code> . </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Objek semacam itu memiliki beberapa keunggulan: mereka ringkas, sangat mudah untuk diuji.  Ada kekurangannya, objek seperti itu bisa berubah menjadi sejumlah besar.  Ada beberapa cara untuk mengelompokkan objek yang serupa; di bagian proyek kami, kami membaginya berdasarkan jenis: </p><br><ul><li>  <em>Obyek layanan</em> (Layanan) - suatu objek, menciptakan objek baru; </li><li>  <em>Command</em> (Command) - mengubah objek saat ini; </li><li>  <em>Guardian</em> (Guard) - mengembalikan kesalahan jika terjadi kesalahan. </li></ul><br><h2 id="servisnyy-obekt-service">  Obyek Layanan </h2><br><p>  Dalam implementasi kami, <em>Layanan</em> - mengimplementasikan persyaratan fungsional dan selalu mengembalikan nilai. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KorovaMilkBar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FindMilk</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GLASS_SIZE</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Unit</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> '200</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">g</span></span></span><span class="hljs-class">' </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class">:) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shelfs</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find</span></span></span><span class="hljs-class"> { |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shelf</span></span></span><span class="hljs-class">| </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shelf</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has?</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GLASS_SIZE</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">milk</span></span></span><span class="hljs-class">) } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FindMilk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">the_red_one</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># =&gt; #&lt;Glass: ... &gt;</span></span></span></span></code> </pre> <br><h2 id="komanda-command">  Perintah </h2><br><p>  Dalam implementasi kami, <em>Perintah</em> - melakukan satu <em>Tindakan</em> , memodifikasi objek, jika benar mengembalikan benar.  Sebenarnya, <em>Tim</em> tidak membuat objek, tetapi memodifikasi yang sudah ada. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KorovaMilkBar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Commands</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FillGlass</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">:) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> &lt;&lt; content </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Glass</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">empty</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">milk</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Milk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(200, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gr</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">empty?</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># =&gt; true FillGlass.call glass, with: milk # =&gt; true glass.empty? # =&gt; false</span></span></span></span></code> </pre> <br><h2 id="vahter-guard">  Wali (Penjaga) </h2><br><p>  <em>Penjaga</em> melakukan pemeriksaan logis dan jika gagal memberikan kesalahan pemrosesan.  Jenis objek ini tidak mempengaruhi <em>Arah Utama</em> dengan cara apa pun, tetapi mengalihkan kita ke <em>Arah Alternatif</em> jika terjadi kesalahan. </p><br><p>  Saat menyajikan susu, penting untuk memastikan susu segar: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KorovaMilkBar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Guards</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IsFresh</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">product</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">each</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">product</span></span></span><span class="hljs-class">| </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raise</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Errors::Rotten</span></span></span><span class="hljs-class">, "</span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#{product.title} is not fresh" if product.expiration_date &gt; Date.today end nil end private attr_reader :products end end end</span></span></span></span></code> </pre> <br><p>  Anda mungkin merasa nyaman untuk memisahkan objek fungsional berdasarkan jenis.  Anda dapat menambahkan milik Anda sendiri, misalnya, <em>Builder</em> - membuat objek berdasarkan parameter. </p><br><h3 id="dogovorennosti-1">  Pengaturan </h3><br><ul><li>  Metode <code>call</code> adalah satu-satunya metode publik wajib. </li><li>  Metode <code>initialize</code> adalah satu-satunya metode publik opsional. </li><li>  Sisa metode harus bersifat pribadi. </li><li>  Kesalahan logis harus diwarisi dari kelas <code>LunaPark::Errors::Processing</code> . </li></ul><br><h2 id="obrabotka-oshibok-1">  Menangani kesalahan </h2><br><p>  Ada 2 jenis kesalahan yang dapat terjadi selama operasi suatu <em>Tindakan</em> . </p><br><h5 id="oshibki-processa-vypolneniya">  Kesalahan Runtime </h5><br><p>  Kesalahan tersebut dapat terjadi sebagai akibat dari pelanggaran logika pemrosesan. </p><br><p>  Sebagai contoh: </p><br><ul><li>  saat membuat email pengguna dicadangkan; </li><li>  ketika Anda mencoba minum susu, itu sudah berakhir; </li><li>  microservice lain menolak tindakan (karena alasan logis, dan bukan karena layanan tidak tersedia). </li></ul><br><p>  Kemungkinan besar, pengguna ingin tahu tentang kesalahan ini.  Juga, ini mungkin kesalahannya <br>  yang bisa kita ramalkan. </p><br><p>  Kesalahan semacam itu harus diwarisi dari <code>LunaPark::Errors::Processing</code> </p><br><h5 id="sistemnyy-oshibki">  Kesalahan sistem </h5><br><p>  Kesalahan yang terjadi sebagai akibat dari sistem crash. </p><br><p>  Sebagai contoh: </p><br><ul><li>  database tidak berfungsi; </li><li>  sesuatu dibagi dengan nol. </li></ul><br><p>  Dalam semua kemungkinan, kami tidak dapat melihat kesalahan ini dan tidak bisa mengatakan apa pun kepada pengguna, kecuali bahwa semuanya sangat buruk, dan mengirimkan laporan kepada pengembang yang meminta tindakan.  Kesalahan semacam itu harus diwarisi dari <code>SystemError</code> </p><br><p>  Ada juga <strong>kesalahan validasi</strong> , yang akan kita diskusikan secara lebih rinci di artikel selanjutnya. </p><br><h2 id="praktika-ispolzovaniya-1">  Penggunaan praktik </h2><br><h3 id="1-ispolzuyte-peremennye-chtoby-povysit-chitaemost">  1. Gunakan variabel untuk meningkatkan keterbacaan </h3><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fishing</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># bad -   Serivices::Catch.call(fish, rod) # bad -  Serivices::Catch.call(fish: fish, rod: rod) # good -   Serivices::Catch.call(fish, with: rod) module Serivices class Catch def initialize(fish, with:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fish</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = fish </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@rod</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = with #      #   . end # ... private attr_reader :fish, :rod end end end</span></span></span></span></code> </pre> <br><h3 id="2-peredavayte-obekty-a-ne-parametry">  2. Lulus objek, bukan parameter </h3><br><p>  Cobalah untuk membuat penginisialisasi sederhana jika pemrosesan parameter tidak tujuannya. <br>  Lulus objek, bukan parameter. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># bad -        -.  #      ,   . class Foo def initialize(foo_params:, bar_params:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@foo</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = Values::Foo.new(*foo_params) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@bar</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = Values::Bar.new(*bar_params) end # ... end Services::Foo.call(foo: {a: 1, b: 2}, bar: 34) # good -   -. class Bar def initialize(foo:, bar:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@foo</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = foo </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@bar</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = bar # ... end end foo = Values::Foo.new(a: 1, b: 2) bar = Values::Bar.new(34) Services::Bar.call(foo: foo, bar: bar) # good -       - Builder. class BuildFoo def initialize(param_1:, param_2:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_1 = param_1 </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_1 = param_1 end def call Foo.new( param_1: param_1.foo, param_2: param_2.bar, param_3: some_magick ) end # ... end end</span></span></span></span></code> </pre> <br><h3 id="3-ispolzuyte-v-nazvanie-deystviya---glagol-deystviya-i-obekt-vozdeystviya">  3. Gunakan nama Tindakan - kata kerja dari tindakan dan objek pengaruh. </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># bad module Services class Milk; end class Work; end class FooBuild; end class PasswordGenerator; end end # good module Services class GetMilk; end class WorkOnTable; end class BuildFoo; end class GeneratePassword; end end</span></span></code> </pre> <br><h3 id="4-po-vozmozhnosti-ispolzuyte-metod-klassa-call">  4. Jika memungkinkan, gunakan metode kelas panggilan </h3><br><p>  Biasanya instance dari kelas <em>Actions</em> , jarang digunakan selain menulis untuk membuat panggilan. </p><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># good -    . Services::BuildFoo.call(params) # good -     Services::BuildFoo.(params) # good -   ,      , #    ,     ,   #  . ring = Services::RingToPhone.new(phone: neighbour) 10.times do ring.call end</span></span></code> </pre> <br><h3 id="5-obrabotka-oshibok-ne-yavlyaetsya-zadachey-servisa">  5. Penanganan kesalahan bukan tugas layanan </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># bad -    ,   . def call #... rescue SystemError =&gt; e return false end</span></span></code> </pre> <br><h2 id="moduli">  Modul </h2><br><p>  Hingga saat ini, kami menganggap implementasi <em>lapisan Layanan</em> sebagai seperangkat objek fungsional.  Tetapi kita dapat dengan mudah menempatkan metode pada layer ini: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sum</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Masalah lain yang menghadang kita adalah sejumlah besar fasilitas layanan.  Alih-alih "model lemak rel", yang kami dapatkan di tepi, kami mendapatkan "folder layanan lemak".  Ada beberapa cara untuk mengatur struktur untuk mengurangi skala tragedi.  Eric Evans memecahkan ini dengan menggabungkan sejumlah fungsi ke dalam satu kelas.  Bayangkan kita perlu memodelkan proses bisnis pengasuh, Arina Rodionovna, dia bisa memberi makan Pushkin dan menidurkannya: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NoonService</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arina_radionovna</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pushkin</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end def to_feed # ... end def to_sleep # ... end end</span></span></span></span></code> </pre> <br><p>  Pendekatan ini lebih tepat dari sudut pandang OOP.  Namun kami menyarankan untuk mengabaikannya, setidaknya pada tahap awal.  Pemrogram yang tidak terlalu berpengalaman mulai menulis banyak kode di kelas ini, yang pada akhirnya mengarah pada peningkatan konektivitas.  Sebagai gantinya, Anda dapat menggunakan modul, mewakili aktivitas sebagai beberapa abstraksi: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Noon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToFeed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end class &lt;&lt; self #    ,   #    def to_feed(arina_radionovna, pushkin) ToFeed.new(arina_radionovna, pushkin).call end #    ,    def to_sleep(arina_radionovna, pushkin) arina_radionovna.tell_story pushkin pushkin.state = :sleep end end end end</span></span></span></span></code> </pre> <br><p>  Ketika membaginya menjadi beberapa modul, kopling eksternal rendah (kopling rendah) harus diamati dengan kohesi internal yang tinggi (kohesi tinggi), tetapi kami menggunakan modul seperti Layanan atau Interaktor, ini juga bertentangan dengan gagasan arsitektur murni.  Ini adalah pilihan sadar yang memfasilitasi persepsi.  Dengan nama file, kami memahami pola desain mana yang diterapkan kelas ini atau itu, jika bagi seorang programmer berpengalaman ini jelas, maka untuk seorang pemula hal ini tidak selalu terjadi.  Setelah tim Anda siap, buang kelebihan ini. </p><br><p>  Mengutip kutipan kecil lain dari buku biru besar: </p><br><p>  <em>Pilih modul yang memberi tahu sejarah sistem dan berisi serangkaian konsep yang koheren.</em>  <em>Dari sinilah seringkali ketergantungan modul yang rendah satu sama lain muncul dengan sendirinya.</em>  <em>Tetapi jika ini tidak terjadi, cari cara untuk mengubah model sedemikian rupa untuk memisahkan konsep satu sama lain, atau mencari konsep yang hilang dalam model, yang dapat menjadi dasar untuk modul dan dengan demikian menyatukan unsur-unsur model bersama-sama dengan cara alami, bermakna.</em>  <em>Mencapai ketergantungan rendah modul satu sama lain dalam arti bahwa konsep dalam modul yang berbeda dapat dianalisis dan dirasakan secara independen satu sama lain.</em>  <em>Perbaiki model sampai batas-batas alami muncul di dalamnya sesuai dengan konsep tingkat tinggi dari area subjek, dan kode yang sesuai tidak dibagi sesuai.</em> </p><br><p>  <em>Berikan nama modul yang akan dimasukkan dalam BAHASA YANG TIDAK DIKENAL.</em>  <em>Baik MODUL itu sendiri maupun namanya harus mencerminkan pengetahuan dan pemahaman tentang bidang subjek.</em> </p><br><p>  Topik modulnya besar dan menarik, tetapi secara lengkap melampaui topik artikel ini.  Lain kali kami akan berbicara dengan Anda tentang <em>Gudang</em> dan <em>Adaptor</em> .  Kami membuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran telegram yang nyaman</a> tempat kami ingin berbagi materi tentang topik DDD.  Kami menyambut pertanyaan dan umpan balik Anda. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Sumber inspirasi</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://www.netsolutions.com/insights/business-and-functional-requirements-what-is-the-ddference-and-why-should-you-care/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http://magazine.russ.ru/nz/2007/54/gi3.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://www.microtool.de/en/knowledge-base/how-use-case-2-0-works/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://www.researchgate.net/publication/220059381_Use_cases_-_Yesterday_today_and_tomorrow</a> </li><li>  Desain Berorientasi Masalah, Eric J. Evans </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id454668/">https://habr.com/ru/post/id454668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id454652/index.html">Mesin jet pada printer 3D rumahan</a></li>
<li><a href="../id454658/index.html">Gadget Kecantikan - Bisnis Serius</a></li>
<li><a href="../id454662/index.html">Hati-hati pindah ke Belanda bersama istri dan hipoteknya. Bagian 1: Pencarian Pekerjaan</a></li>
<li><a href="../id454664/index.html">Mainkan Tetris in AR</a></li>
<li><a href="../id454666/index.html">Software Defined Radio - bagaimana cara kerjanya? Bagian 7</a></li>
<li><a href="../id454670/index.html">Serial "Chernobyl": menonton dan berpikir</a></li>
<li><a href="../id454672/index.html">Kunci untuk memulai: perangkat lunak dan perangkat keras terbaik untuk forensik komputer</a></li>
<li><a href="../id454674/index.html">Pemantauan orang miskin atau pemantauan server dari konsol</a></li>
<li><a href="../id454676/index.html">Jam tangan GPS di Arduino</a></li>
<li><a href="../id454678/index.html">Pemrograman GPU Idiomatik di Rust: Emu Library</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>