<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèæ ‚û∞ ‚öñÔ∏è Hinweise des IoT-Anbieters. Aktivierung und Sicherheit in LoraWAN üöö üë®üèø‚Äçüîß ü§ôüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo liebe Internet der Dinge Liebhaber. Fortsetzung Hinweise IoT-Anbieter. 
 Der erste Teil > || > Zweiter Teil > || > Dritter Teil > || > Der viert...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hinweise des IoT-Anbieters. Aktivierung und Sicherheit in LoraWAN</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413105/"><p>  Hallo liebe Internet der Dinge Liebhaber.  Fortsetzung Hinweise IoT-Anbieter. </p><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der erste Teil</a> &gt; ||  &gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zweiter Teil</a> &gt; ||  &gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dritter Teil</a> &gt; ||  &gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der vierte Teil</a> <br><br><p>  Heute ist es Zeit, bei LoRaWAN √ºber Sicherheit zu sprechen.  Es gibt viele Ger√ºchte und Legenden.  Wir werden versuchen herauszufinden, wie es funktioniert und welche Risiken bestehen. <br><br>  Um zum Thema Sicherheit √ºberzugehen, m√ºssen Sie eine kleine Einf√ºhrung machen und √ºber die anf√§ngliche Initialisierung des Funkmoduls im Netzwerk sprechen.  Dieser Vorgang in LoRaWAN wird als Aktivierung bezeichnet. </p><br><p>  Der K√ºrze halber werde ich nachfolgend die Begriffe auflisten, die wir ben√∂tigen.  Wenn Sie etwas verwirrt sind, k√∂nnen Sie hierher zur√ºckkehren und nachsehen.  Sie m√ºssen wahrscheinlich zur√ºckkommen, weil  Abk√ºrzungen vieler Begriffe sind sehr √§hnlich.  Au√üerdem werde ich in dieser Beschreibung Analogien geben, damit Sie ungef√§hr verstehen, womit dieser oder jener Begriff verglichen werden kann.  Es ist nicht immer m√∂glich, genaue Analogien auszuw√§hlen. Bitte beurteilen Sie diese Spalte nicht zu streng. </p><br><img src="https://habrastorage.org/webt/z4/v-/68/z4v-68a8ov1o-2rz2chxuprmpto.png"><br><a name="habracut"></a><p>  Die Aktivierung in LoRaWAN kann also √ºber Luft (OTAA) oder √ºber eine Voreinstellung (ABP) erfolgen. </p><br><h2>  OTAA (Over-the-Air-Aktivierung) </h2><br><p>  Bei Aktivierung durch Luft m√ºssen drei Parameter an unserem Funkmodul eingestellt werden.  Seine eindeutige Kennung (DevEUI), Serverkennung (AppEUI) und Serverschl√ºssel (AppKey). </p><br><p>  Auf der Serverseite m√ºssen auch die Funkmodul-ID, die Server-ID und der Schl√ºssel registriert werden.  Das hei√üt,  Der Server sollte zun√§chst das Ger√§t kennen, das versucht, sich ihm anzuschlie√üen.  Wenn wir die Kennungen und Serverschl√ºssel kennen, unser DevEUI jedoch nicht in seiner Datenbank registriert ist, schl√§gt die Verbindung fehl. </p><br><p>  Beim ersten Einschalten sendet das Funkger√§t das Paket join_request in der Luft mit einer der drei vordefinierten Verbindungsfrequenzen.  Mit diesem Paket fragt er, ob es in der N√§he ein Netzwerk gibt, das ihn ‚Äûerkennt‚Äú.  Das Folgende ist die Zusammensetzung des join_request-Pakets.  Wie Sie sehen k√∂nnen, enth√§lt es genau DevEUI und AppEUI sowie DevNonce. </p><br><img src="https://habrastorage.org/webt/6p/gh/kd/6pghkd5kbylskdzbcasmwylqdnq.png"><br><p>  DevNonce ist eine Zufallsvariable.  Der Server speichert es f√ºr einige Zeit im Speicher. Wenn join_request mit derselben DevNonce wie eine der vorherigen eingeht, ignoriert der Server diese Anforderung.  Dies dient zum Schutz vor einem wiederholten Angriff, wenn ein Angreifer eine Aktivierungsanforderung aufschreiben und dann von seinem Ger√§t aus wiederholen kann.  √úbrigens k√∂nnen nicht alle IoT-Standards Schutz vor diesem Angriff bieten. </p><br><p>  AppKey wird in dieser Nachricht nicht direkt verwendet, aber dadurch wird die MIC-Pr√ºfsumme am Ende des Frames ber√ºcksichtigt. <br>  Wir werden diesen Schl√ºssel in der Antwortnachricht vom join_accept-Server etwas weiter ben√∂tigen. </p><br><p>  Join_request wird unverschl√ºsselt √ºbertragen. </p><br><p>  Join_accept wird empfangen, wenn der Server AppEUI und DevEUI kennt, keine √úbereinstimmung im Feld DevNonce vorliegt und keine Probleme mit dem MIC vorliegen.  Andernfalls erfolgt keine Antwort. Wenn alle Pr√ºfungen bestanden wurden, generiert der Server eine join_accept-Antwortnachricht.  Die Zusammensetzung ist im Bild unten dargestellt. </p><br><img src="https://habrastorage.org/webt/w7/tv/j7/w7tvj7iwfjeynonywqmtqlrwmac.png"><br><p>  Tats√§chlich werden zwei Sitzungsschl√ºssel generiert - der Netzwerkserver (NwkSKey) und der Anwendungsserver (AppSKey).  Diese Schl√ºssel werden zusammen mit anderen Informationen von AppKey verschl√ºsselt und an das Funkmodul gesendet.  Dar√ºber hinaus erfolgt das gesamte Messaging mit doppelter Verschl√ºsselung mit Sitzungsschl√ºsseln (mit Ausnahme von Paketen mit MAC-Befehlen werden diese nicht mit dem Anwendungsserverschl√ºssel verschl√ºsselt).  NwkSKey nimmt nicht nur mit Daten (ohne Befehle) an der Paketverschl√ºsselung teil, sondern es wird eine Pr√ºfsumme ber√ºcksichtigt. <br>  NwkSkey und AppSKey sind f√ºr jedes einzelne Funkmodul einzigartig. </p><br><p>  F√ºr zus√§tzlichen Informationsschutz werden zwei Schl√ºssel verwendet.  Jedes Mal, wenn ein Paket vom Funkmodul in unserem System ankommt, wird es teilweise f√ºr den Netzwerkserver und teilweise f√ºr den Anwendungsserver verschl√ºsselt.  Das hei√üt,  Der Netzwerkserver kann nur die an ihn adressierten Nachrichten entschl√ºsseln (verschiedene Dienstnachrichten).  Der Anwendungsserver sieht nur die n√ºtzliche Komponente der Pakete (tats√§chlich die weitergeleiteten Daten).  Dies ist notwendig, da der Netzwerkserver mit einer Wahrscheinlichkeit von 99 Prozent beim Anbieter ist.  Der Anwendungsserver kann jedoch durchaus vom Client gehostet werden.  Die doppelte Verschl√ºsselung erschwert es dem Anbieter, den Inhalt des Pakets herauszufinden. </p><br><p>  Zus√§tzlich zu den beiden Schl√ºsseln gibt es noch eine weitere wichtige Funktion von join_accept in OTAA - die erweiterte Frequenzliste (CFList).  Ich m√∂chte Sie daran erinnern, dass ein Funkmodul zun√§chst nur drei Frequenzen kennt, bei denen es arbeiten kann.  Nach der Aktivierung werden zus√§tzliche Frequenzen f√ºr die Kommunikation registriert. <br><br>  Dies ist sehr praktisch, wenn nicht genau bekannt ist, in welchem ‚Äã‚ÄãNetzwerk das Ger√§t funktioniert.  Wir k√∂nnen uns darauf einigen, dass in allen Netzen immer 3 Frequenzen (+ RX2) zusammenfallen und die restlichen f√ºnf im Ermessen des Anbieters liegen. <br><br>  F√ºr die Zukunft kann CFList auch f√ºr das Clustering verwendet werden, um mit einer gro√üen Anzahl von Ger√§ten zu arbeiten <br><br>  Dies ist der Fall, wenn Sie das Netzwerk in Cluster aufteilen und innerhalb der Cluster eine Frequenzplanung durchgef√ºhrt wird.  Angenommen, unser Funkmodul kennt die drei Frequenzen F1, F2 und F3.  Es wird bei einer der Frequenzen aktiviert und wenn es sich in Cluster1 befindet, erh√§lt es eine zus√§tzliche Frequenztabelle in Form von F4-1, F5-1 und F6-1.  F√ºr Cluster 2 erh√§lt er v√∂llig andere F4-2, F5-2, F6-2.  Gleichzeitig k√∂nnen wir alle Funkmodule auf die gleiche Weise konfigurieren und denken nicht wirklich, welches in welchen Cluster fallen wird.  In benachbarten Clustern nimmt die Wahrscheinlichkeit von Kollisionen stark ab. </p><br><h2>  ABP (Aktivierung durch Personalisierung) </h2><br><p>  Ein vereinfachtes Verfahren, bei dem Sitzungsschl√ºssel sofort mit dem Funkmodul verbunden und zun√§chst auf der Serverseite registriert werden.  Das Funkmodul ist praktisch einsatzbereit und sofort einsatzbereit.  Nichts bequemeres, weil  Sicherheit ist in diesem Fall so lala.  Au√üerdem k√∂nnen Sie keine Frequenzen vom Server abrufen.  Ich habe noch nie F√§lle von wirklichem Gebrauch gesehen.  Wir werden es nicht ber√ºcksichtigen, und in allen folgenden Abschnitten geht es um OTAA. </p><br><h2>  Und was ist mit Sicherheit? </h2><br><p>  Im Wesentlichen haben wir also die Hauptverschl√ºsselungslast f√ºr die Sitzungsschl√ºssel des Netzwerkservers und des Anwendungsservers. <br><br>  Betrachten Sie sie etwas genauer. </p><br><p>  Die Hauptbeschwerde von Kritikern des LoRaWAN-Standards ist, dass wir bei Aktivierung des Ger√§ts im Netzwerk zwei Schl√ºssel haben, die dann monatelang unver√§ndert bleiben k√∂nnen.  Genauer gesagt k√∂nnen sie sich jahrelang nicht √§ndern, bis das Ger√§t wieder aktiviert wird.  Unter normalen Bedingungen haben wir das Funkmodul aktiviert und vergessen, daher ist eine Schl√ºssellebensdauer von drei bis vier Jahren eine sehr realistische Perspektive.  Eigentlich von der Installation bis zum Nulllassen der Batterie. <br>  Wie zuverl√§ssig sind unsere Schl√ºssel? </p><br><p>  Die Spezifikation besagt, dass sie dem mysteri√∂sen RFC4493 entsprechen. <br>  Was ist das?  Dies ist ein Verschl√ºsselungsalgorithmus, besser bekannt als AES-CMAC. <br><br>  Lassen Sie uns nicht in die Wildnis der Kryptographie kriechen und uns auf ein gemeinsames Verst√§ndnis des Bildes beschr√§nken.  Es ist in der folgenden Abbildung dargestellt. </p><br><img src="https://habrastorage.org/webt/kv/zs/7k/kvzs7k4joixbwltc1wkfxkpmotw.png"><br><p>  Das Prinzip von AES-CMAC ist ungef√§hr das folgende: Die verschl√ºsselte Nachricht ist in 128-Bit-Bl√∂cke unterteilt.  Jeder Block wird separat mit einem AES-Schl√ºssel verschl√ºsselt.  Dar√ºber hinaus wird beim Verschl√ºsseln des zweiten Blocks zus√§tzlich zum Schl√ºssel das Verschl√ºsselungsergebnis des ersten verwendet.  Und beim Verschl√ºsseln des dritten - das Ergebnis des zweiten und (indirekt) des ersten.  Eine solche Kette von Komplikationen. </p><br><p>  Wie zuverl√§ssig ist dieses Prinzip? </p><br><p>  Sehr zuverl√§ssig.  Der Algorithmus kam vor mehr als zehn Jahren heraus.  Seitdem wurde er von vielen verschiedenen Angriffen angegriffen, und schlie√ülich haben sie theoretisch bewiesen, dass er gehackt werden kann. Das Problem ist, dass eine gro√üe Stichprobe von Paketen, mehrere Tausend, ben√∂tigt wird, um ihn zu zerbrechen.  Dann besteht die M√∂glichkeit zu verstehen, was sich in den verschl√ºsselten Bl√∂cken befindet. </p><br><p>  Kann ein Angreifer mit den erforderlichen Kenntnissen dieses Beispiel erhalten, wenn es um das Abfangen von LoRaWAN-Paketen geht?  Lassen Sie uns sch√§tzen.  Lassen Sie die Pakete einmal pro Stunde gehen.  In einem Monat werden 720 Pakete vom Funkmodul gesendet.  Nicht genug. <br><br>  F√ºr eine echte Bedrohung brauchen wir einen sehr geduldigen Patienten, der monatelang Pakete schreibt.  Und es ist keine Tatsache, dass er den Algorithmus immer noch knacken und die wertvollen Schl√ºssel erhalten kann.  Vergessen Sie nicht, dass diese Geduld in Bezug auf jedes Funkmodul separat gezeigt werden muss.  Und denken Sie daran, dass das Versenden von Paketen einmal pro Stunde SEHR h√§ufig ist.  In der Praxis sind die Intervalle viel l√§nger - sechs Stunden oder sogar ein Tag. </p><br><p>  Aber auch diese gespenstische Gelegenheit ist jetzt nach der Ver√∂ffentlichung von Spezifikation 1.1 geschlossen, in der die Befehle zur erneuten Aktivierung und zum Beitritt zum Server implementiert sind.  Lassen Sie uns irgendwie √ºber diese Spezifikation sprechen.  Im Moment erinnere ich mich an meinen Gedanken aus dem vorherigen Artikel: Wenn der Standard offen ist und eine Community hat, sind alle seine L√∂cher sichtbar.  W√§hrend des Upgrades wissen die Entwickler genau, worauf sie zuerst achten m√ºssen. </p><br><p>  Infolgedessen stellen wir fest, dass die Sicherheitsbedrohung eher illusorisch ist.  Irgendwo in der tiefen Theorie kann gehackt werden, aber in der Praxis ist es praktisch nicht realistisch.  Multiplizieren Sie nun mit dem Wert der empfangenen Informationen.  Wird unser Angreifer monatelang Pakete schreiben, um den Z√§hler herauszufinden?  Unwahrscheinlich. <br><br>  LoRaWAN erf√ºllt dieses angemessene Preis-Leistungsverh√§ltnis.  Wir verstehen, dass der Schutz verbessert werden kann.  Dies ist jedoch die Rechenleistung des Endes. Dies ist eine zus√§tzliche Belastung der Batterie. Es ist m√∂glich, die Gr√∂√üe der Pakete zu erh√∂hen oder die Nutzlast zu verringern. <br><br>  F√ºr mich ist es mehr als eine Telemetrieaufgabe. </p><br><p>  In den Kommentaren werde ich mich freuen, sowohl meine Gegner als auch meine Unterst√ºtzer zu h√∂ren.  Denken Sie daran, dass das Thema Sicherheit immer eine Diskussion erfordert und sich niemals auf die Meinung einer Person st√ºtzen sollte. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413105/">https://habr.com/ru/post/de413105/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413095/index.html">Anwendung neuronaler Netzwerktechnologien: Softwareentwicklung</a></li>
<li><a href="../de413097/index.html">Basierend auf Software auf Unternehmensebene, millionenfach getestet: openSUSE Leap 15 ver√∂ffentlicht</a></li>
<li><a href="../de413099/index.html">Downclocking RAM auf MacBook</a></li>
<li><a href="../de413101/index.html">STM32F4 Debug Board im Raspberry Pi Formfaktor</a></li>
<li><a href="../de413103/index.html">3CX v15.5 Update 5 Beta und REST-Integration mit AmoCRM ver√∂ffentlicht</a></li>
<li><a href="../de413107/index.html">√úbersetzung des Svelto.ECS-Projekt-Wikis. ECS-Framework f√ºr Unity3D</a></li>
<li><a href="../de413109/index.html">So erstellen Sie eine SaaS-Produktintegrationsplattform: Poster Cloud Checkout Experience</a></li>
<li><a href="../de413111/index.html">STM32 + NetBeans =?</a></li>
<li><a href="../de413113/index.html">Klasse JavaScript Unterst√ºtzung der JavaScript-Serialisierung</a></li>
<li><a href="../de413117/index.html">So programmieren Sie sicher in Bash</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>