<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèø ü§¥üèæ üßõüèº Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 11 üë©‚Äçüëß‚Äçüë¶ ‚è∞ üëêüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comando y control 
 Enlaces a todas las partes: 
 Parte 1. Obtenci√≥n del acceso inicial (acceso inicial) 
 Parte 2. Ejecuci√≥n 
 Parte 3. Fijaci√≥n (per...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 11</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449654/"><h2>  Comando y control </h2><br>  <b>Enlaces a todas las partes:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1. Obtenci√≥n del acceso inicial (acceso inicial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2. Ejecuci√≥n</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3. Fijaci√≥n (persistencia)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 4. Escalada de privilegios</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 5. Evasi√≥n de defensa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 6. Obtenci√≥n de credenciales (acceso de credenciales)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 7. Descubrimiento</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 8. Movimiento lateral</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 9. Recolecci√≥n de datos (Colecci√≥n)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 10. Exfiltraci√≥n</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 11. Comando y Control</a> <br><br>  La secci√≥n "Comando y Control" ( <i>abreviatura - C2, C &amp; C</i> ) es la etapa final de la cadena de ataque introducida en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ATT &amp; CK Matrix for Enterprise</a> . <br><br>  El comando y control incluye t√©cnicas mediante las cuales el adversario se comunica con los sistemas conectados ay bajo el control de la red atacada.  Dependiendo de la configuraci√≥n de los sistemas y la topolog√≠a de la red de destino, hay muchas formas de organizar el canal secreto C2.  Las t√©cnicas m√°s comunes se describen en cat.  Las recomendaciones generales sobre la organizaci√≥n de medidas para prevenir y detectar C2 se destacan en un bloque separado y se colocan al final de la secci√≥n. <br><br><a name="habracut"></a><br>  <i>El autor no es responsable de las posibles consecuencias de aplicar la informaci√≥n contenida en el art√≠culo, y tambi√©n se disculpa por posibles imprecisiones hechas en algunas formulaciones y t√©rminos.</i>  <i>La informaci√≥n publicada es un recuento gratuito de los contenidos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MITER ATT &amp; CK</a> .</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Puertos comunes</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> para evitar los firewalls y mezclar el tr√°fico malicioso con la actividad normal de la red, un adversario puede comunicarse con el sistema atacado a trav√©s de los puertos est√°ndar com√∫nmente utilizados por las aplicaciones normales: <br> <code>TCP: 80 (HTTP) <br> TCP: 443 (HTTPS) <br> TCP: 25 (SMTP) <br> TCP/UDP: 53 (DNS)</code> <br> <br>  Ejemplos de puertos para organizar conexiones de red dentro de un enclave enemigo, por ejemplo, entre un servidor proxy y otros nodos) son: <br> <code>TCP/UDP: 135 (RPC) <br> TCP/UDP: 22 <br> TCP/UDP: 3389</code> <br> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comunicaci√≥n a trav√©s de medios extra√≠bles</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: Un</i> adversario puede organizar una infraestructura C2 entre nodos f√≠sicamente aislados utilizando medios de almacenamiento extra√≠bles para transferir comandos de un sistema a otro.  Ambos sistemas deben estar comprometidos.  Un sistema con una conexi√≥n a Internet es m√°s probable que se vea comprometido por el primero, y el segundo sistema se ve comprometido durante el movimiento lateral al replicar malware a trav√©s de medios extra√≠bles (ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 8</a> ).  Los comandos y archivos se transmitir√°n desde un sistema aislado a un sistema con conexi√≥n a Internet, al cual el adversario tiene acceso directo. <br><br>  <i>Recomendaciones de protecci√≥n:</i> deshabilite la ejecuci√≥n autom√°tica de dispositivos extra√≠bles.  Prohibir o restringir el uso de medios extra√≠bles a nivel de pol√≠tica organizacional.  Organice una auditor√≠a de los procesos que se realizan al conectar medios extra√≠bles. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conexi√≥n a trav√©s de un proxy (Proxy de conexi√≥n)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> un atacante puede utilizar un servidor proxy para redirigir el tr√°fico de red entre sistemas o como intermediario para las comunicaciones de red.  Muchas herramientas (como HTRAN, ZXProxy y ZXPortMap) le permiten redirigir el tr√°fico o reenviar puertos. <br><br>  El concepto de proxies tambi√©n puede abarcar fideicomisos en punto a punto (p2p), redes de malla o conexiones confiables entre redes.  Una red puede estar dentro de una organizaci√≥n o entre organizaciones con fideicomisos.  Un adversario puede usar los fideicomisos de red para controlar el canal C2, reducir la cantidad de conexiones de red salientes simult√°neas, proporcionar tolerancia a fallas o usar conexiones confiables para evitar sospechas. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comando personalizado y protocolo de control</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: un</i> atacante puede organizar un canal C2 utilizando su propio protocolo de red en lugar de encapsular comandos / datos en un protocolo de capa de aplicaci√≥n est√°ndar existente.  La implementaci√≥n del protocolo enemigo C2 puede imitar protocolos conocidos o protocolos de usuario (incluidos los sockets sin procesar) sobre los protocolos b√°sicos presentados en TCP / IP u otra pila de red est√°ndar. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protocolo criptogr√°fico personalizado</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> para ocultar el tr√°fico transmitido a trav√©s del canal C2, el adversario puede usar su propio protocolo criptogr√°fico o algoritmo de cifrado.  Un esquema simple, como el cifrado XOR de texto sin formato con una clave fija, dar√° texto cifrado (aunque muy d√©bil). <br><br>  Los esquemas de cifrado propietarios pueden variar en complejidad.  El an√°lisis y la ingenier√≠a inversa de muestras de malware se pueden utilizar para detectar con √©xito el algoritmo utilizado y la clave de cifrado.  Algunos atacantes pueden intentar implementar su propia versi√≥n de un algoritmo criptogr√°fico bien conocido en lugar de usar una biblioteca bien conocida, lo que puede conducir a errores involuntarios en la operaci√≥n del software enemigo. <br><br>  <i>Recomendaciones de protecci√≥n:</i> si el malware usa su propio cifrado con claves sim√©tricas, entonces es posible obtener un algoritmo y una clave de las muestras de software para usarlas para decodificar el tr√°fico de red e identificar firmas de malware. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Codificaci√≥n de datos</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: la</i> informaci√≥n transmitida por el canal C2 se codifica utilizando sistemas de codificaci√≥n de datos est√°ndar.  El uso de la codificaci√≥n de datos es para cumplir con las especificaciones de protocolo existentes e incluye el uso de ASCII, Unicode, Base64, MIME, UTF-8 u otras codificaciones de texto y caracteres binarios.  Algunos sistemas de codificaci√≥n, como gzip, tambi√©n pueden comprimir datos. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ofuscaci√≥n de datos</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: Los</i> datos en el canal C2 pueden ocultarse (pero no necesariamente utilizando cifrado) para dificultar la detecci√≥n y descifrado del contenido transmitido, as√≠ como hacer que el proceso de comunicaci√≥n sea menos notable y ocultar los comandos transmitidos.  Existen muchos m√©todos de ofuscaci√≥n, como agregar datos innecesarios al tr√°fico de protocolo, usar esteganograf√≠a, combinar tr√°fico leg√≠timo con tr√°fico C2 o usar un sistema de codificaci√≥n de datos no est√°ndar, por ejemplo, un Base64 modificado en el cuerpo de un mensaje de solicitud HTTP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ocultar la direcci√≥n final de una conexi√≥n</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">(Dominio frontal)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> La esencia de Domain Fronting es la capacidad de ocultar la direcci√≥n de destino real del paquete HTTP en las redes CDN (Content Delivery Netwoks). <br><br>  <i>Ejemplo: hay un dominio X y un dominio Y, que son clientes de los mismos CDN.</i>  <i>Es muy probable que un paquete con la direcci√≥n X del dominio en el encabezado TLS y la direcci√≥n Y del dominio en el encabezado HTTP se entregue a la direcci√≥n Y del dominio, incluso si se proh√≠be la comunicaci√≥n de red entre las direcciones de origen y destino.</i> <br><br>  Un paquete HTTP contiene dos conjuntos de encabezados: el primero, TLS, est√° en la parte abierta del paquete, el segundo, HTTP, se refiere a la parte cifrada del paquete.  Adem√°s, cada encabezado tiene su propio campo para especificar la direcci√≥n IP de destino.  La esencia del Dominio frontal es el uso deliberado de diferentes nombres de dominio en el campo "SNI" del encabezado TLS y el campo "Host" del encabezado HTTP.  Por lo tanto, la direcci√≥n de destino permitida se indica en el campo "SNI", y la direcci√≥n de destino de entrega se indica en el campo "Host".  Si ambas direcciones pertenecen a los mismos CDN, luego de recibir dicho paquete, el nodo de enrutamiento puede retransmitir la solicitud a la direcci√≥n de destino. <br><br>  Hay otra variaci√≥n de esta t√©cnica llamada fachada sin dominio.  En este caso, el campo "SNI" (encabezado TLS) se deja en blanco intencionalmente, lo que permite que el paquete alcance su objetivo incluso si el CDN comprueba la coincidencia de los campos "SNI" y "HOST" (si se ignoran los campos SNI vac√≠os). <br><br>  <i>Recomendaciones de protecci√≥n:</i> si es posible inspeccionar el tr√°fico HTTPS, se pueden capturar y analizar conexiones similares a Fronting de dominio.  Si se lleva a cabo una inspecci√≥n SSL o el tr√°fico no est√° encriptado, el campo "HOST" se puede verificar por coincidencia con el campo "SNI" o la presencia de la direcci√≥n especificada en las listas blancas o negras.  Para implementar Domain Fronting, un adversario probablemente necesitar√° implementar herramientas adicionales en un sistema comprometido, cuya instalaci√≥n se puede evitar instalando herramientas locales de protecci√≥n del host. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Canales de reserva</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> para garantizar la confiabilidad del canal de control y evitar exceder los valores umbral de los datos transmitidos, los atacantes pueden usar canales de respaldo o de comunicaci√≥n alternativos si el canal principal C2 est√° comprometido o no est√° disponible. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Canales de etapas m√∫ltiples</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: los</i> atacantes pueden crear canales C2 de etapas m√∫ltiples que se utilizan en diversas condiciones o para funciones espec√≠ficas.  El uso de varios pasos puede confundir y ofuscar el canal C2, lo que dificulta su detecci√≥n. <br><br>  Las RAT que se ejecutan en el host de destino inician una conexi√≥n con el servidor C2 de primer nivel.  El primer paso puede tener capacidades automatizadas para recopilar informaci√≥n b√°sica sobre el host, ejecutar herramientas de actualizaci√≥n y descargar archivos adicionales.  A continuaci√≥n, se puede iniciar una segunda herramienta RAT para redirigir el host al servidor de segundo nivel C2.  La segunda etapa de C2, muy probablemente, ser√° completamente funcional y permitir√° al enemigo interactuar con el sistema objetivo a trav√©s del caparaz√≥n inverso y las funciones adicionales de RAT. <br><br>  Los pasos C2, muy probablemente, se colocar√°n por separado sin cruzar su infraestructura.  El gestor de arranque tambi√©n puede tener retroalimentaci√≥n de primera etapa redundante o canales de reserva en caso de que el canal original de primera etapa sea detectado y bloqueado. <br><br>  <i>Recomendaciones de protecci√≥n: la</i> infraestructura C2 utilizada para organizar canales de m√∫ltiples etapas puede bloquearse si se conoce de antemano.  Si hay firmas √∫nicas en el tr√°fico C2, se pueden usar para identificar y bloquear el canal. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Proxy m√∫ltiple (Proxy de salto m√∫ltiple)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  Descripci√≥n: para ocultar la fuente del tr√°fico malicioso, un adversario puede usar una cadena de varios servidores proxy.  Como regla general, el defensor podr√° determinar solo el √∫ltimo proxy.  El uso de multiproxing hace que la identificaci√≥n de la fuente del tr√°fico malicioso sea m√°s dif√≠cil, lo que requiere que la parte defensora monitoree el tr√°fico malicioso a trav√©s de varios servidores proxy. <br><br>  <i>Recomendaciones de protecci√≥n: el</i> tr√°fico a redes an√≥nimas conocidas (como Tor) y las infraestructuras C2 pueden bloquearse mediante la organizaci√≥n de listas en blanco y negro.  Sin embargo, debe prestar atenci√≥n a que este m√©todo de bloqueo se puede eludir utilizando t√©cnicas similares a Fronting de dominio. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comunicaci√≥n multibanda</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> algunos oponentes pueden dividir el canal de datos C2 entre diferentes protocolos.  Los comandos entrantes se pueden transmitir a trav√©s de un protocolo y los datos salientes de una manera diferente, lo que le permite evitar ciertas restricciones de firewall.  La separaci√≥n tambi√©n puede ser accidental para evitar advertencias sobre el exceder los valores de umbral para cualquier mensaje individual. <br><br>  <i>Recomendaciones de protecci√≥n:</i> analice el contenido de los paquetes para encontrar conexiones que no coincidan con el comportamiento del protocolo esperado para el puerto utilizado.  Las alertas coincidentes entre m√∫ltiples canales de comunicaci√≥n tambi√©n pueden ayudar a detectar C2. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cifrado multicapa</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: un</i> adversario puede aplicar varios niveles de cifrado de tr√°fico C2.  Como regla general (pero no se excluyen otras opciones), se utiliza un t√∫nel adicional utilizando su propio esquema de cifrado como parte del cifrado HTTPS o SMTPS. <br><br>  <i>Consejos de seguridad: el</i> uso de protocolos de cifrado puede complicar el descubrimiento t√≠pico de C2 basado en an√°lisis de tr√°fico basado en firmas.  Si el malware usa un protocolo criptogr√°fico est√°ndar, la inspecci√≥n SSL / TLS se puede usar para detectar el tr√°fico C2 en algunos canales cifrados.  La verificaci√≥n SSL / TLS implica ciertos riesgos que deben considerarse antes de la implementaci√≥n para evitar posibles problemas de seguridad, como la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificaci√≥n incompleta del certificado</a> .  Despu√©s de la verificaci√≥n SSL / TLS, es posible que se requiera un an√°lisis criptogr√°fico adicional para el cifrado de segundo nivel. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Golpe de puerto</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: los</i> atacantes pueden usar los m√©todos de detecci√≥n de puertos para ocultar los puertos abiertos que usan para conectarse al sistema. <br><br>  Consejos de <i>seguridad: el</i> uso de firewalls con estado puede evitar que se implementen algunas opciones de Knock Port. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Herramientas de acceso remoto</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> para establecer un modo de comando y control interactivo, un atacante puede usar software leg√≠timo dise√±ado para ellos.  soporte de estaci√≥n de trabajo y software para acceso remoto, por ejemplo, TeamViewer, Go2Assist, LogMain, AmmyAdmin, etc., que generalmente utilizan los servicios de soporte t√©cnico y pueden incluirse en la lista blanca.  Las herramientas de acceso remoto, como VNC, Ammy y Teamview, son las m√°s utilizadas por los ingenieros de soporte t√©cnico y los ciberdelincuentes. <br><br>  Las herramientas de acceso remoto se pueden instalar despu√©s de que el sistema se haya visto comprometido para su uso como un canal C2 alternativo.  Tambi√©n se pueden usar como un componente de malware para establecer una conexi√≥n inversa con un servidor o sistema controlado por un adversario. <br><br>  Las herramientas de administraci√≥n, como TeamViewer, fueron utilizadas por varios grupos centrados en agencias gubernamentales en pa√≠ses de inter√©s para empresas estatales y criminales rusas. <br><br>  <i>Recomendaciones de protecci√≥n:</i> las herramientas de acceso remoto se pueden usar junto con las t√©cnicas de Dominio de dominio, por lo que es aconsejable evitar que el adversario instale herramientas RAT utilizando herramientas de seguridad de host. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Copia remota de archivos</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: los</i> archivos se pueden copiar de un sistema a otro para implementar herramientas enemigas u otros archivos.  Los archivos se pueden copiar desde un sistema externo controlado por un atacante, a trav√©s del canal C&amp;C o utilizando otras herramientas que utilizan protocolos alternativos, como FTP.  Los archivos tambi√©n se pueden copiar a Mac y Linux utilizando herramientas integradas como scp, rsync, sftp. <br><br>  Los enemigos tambi√©n pueden copiar archivos lateralmente entre sistemas internos de v√≠ctimas para soportar el movimiento de la red y la ejecuci√≥n remota de comandos.  Esto se puede hacer usando protocolos para compartir archivos conectando recursos de red a trav√©s de SMB o usando conexiones autenticadas a Windows Admin Shares o RDP. <br><br>  <i>Recomendaciones de protecci√≥n:</i> como medio de detecci√≥n, se <i>recomienda</i> monitorear la creaci√≥n y transferencia de archivos a trav√©s de la red a trav√©s del protocolo SMB.  Los procesos inusuales con conexiones de red externas que crean archivos dentro del sistema tambi√©n deber√≠an ser sospechosos.  El uso at√≠pico de utilidades como FTP tambi√©n puede ser sospechoso. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protocolo de capa de aplicaci√≥n est√°ndar</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> para evitar detectar y mezclar el tr√°fico C2 con el tr√°fico de red existente, los atacantes pueden utilizar protocolos est√°ndar de nivel de aplicaci√≥n como HTTP, HTTPS, SMTP o DNS.  Para las conexiones dentro del canal C2 (enclave), por ejemplo, entre el servidor proxy y el nodo maestro y otros nodos, generalmente se utilizan los protocolos RPC, SSH o RDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protocolo criptogr√°fico est√°ndar</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: los</i> opositores pueden usar algoritmos de cifrado bien conocidos para ocultar el tr√°fico C2.  A pesar del uso de un algoritmo robusto, si las claves secretas son encriptadas y generadas por malware y / o almacenadas en archivos de configuraci√≥n, entonces el tr√°fico C2 puede divulgarse mediante ingenier√≠a inversa. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protocolo est√°ndar de capa sin aplicaci√≥n</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: los</i> protocolos de capa sin aplicaci√≥n del modelo OSI se pueden utilizar para la comunicaci√≥n entre el host infectado y el servidor o para la interacci√≥n de los hosts infectados en la red.  En implementaciones bien conocidas, se utilizaron el protocolo de capa de red (ICMP), la capa de transporte (UDP), la capa de sesi√≥n (SOCKS) y protocolos como redireccionado / tunelizado, como Serial over LAN (SOL). <br><br>  Los ciberdelincuentes suelen utilizar ICMP para ocultar la comunicaci√≥n entre los hosts.  Dado que ICMP es parte de Internet Protocol Suite y debe ser implementado por todos los dispositivos compatibles con IP, no se monitorea con tanta frecuencia como otros protocolos, como TCP o UDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Puertos de lujo (puerto poco utilizado)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n: Los</i> adversarios pueden comunicarse a trav√©s de C2 a trav√©s de un puerto no est√°ndar para evitar servidores proxy y firewalls que no se configuraron correctamente. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Servicio web</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: los</i> atacantes pueden usar un servicio web externo leg√≠timo en ejecuci√≥n como medio para enviar comandos para controlar un sistema infectado.  Los servidores de administraci√≥n se denominan Comando y control (C&amp;C o C2).  Los sitios web populares y las redes sociales pueden actuar como un mecanismo para C2, y tambi√©n se pueden usar varios servicios p√∫blicos como Google o Twitter.  Todo esto ayuda a ocultar la actividad maliciosa en el flujo de tr√°fico general.  Los servicios web generalmente usan SSL / TLS, por lo que los adversarios obtienen una capa adicional de protecci√≥n. <br><br>  <i>Recomendaciones de protecci√≥n:</i> se pueden usar firewalls y proxies web para implementar pol√≠ticas para restringir las comunicaciones de red externas. <br><br><h3>  Recomendaciones generales sobre la organizaci√≥n de medidas para la prevenci√≥n y detecci√≥n de C2 </h3><br><br>  ‚Ä¢ Los sistemas IDS / DLP que utilizan an√°lisis de tr√°fico basados ‚Äã‚Äãen firmas se pueden usar para detectar y bloquear herramientas C2 espec√≠ficas conocidas y programas maliciosos, por lo que el adversario probablemente cambiar√° las herramientas utilizadas con el tiempo o configurar√° el protocolo de transferencia de datos para evitar la detecci√≥n por medios conocidos por √©l protecci√≥n <br><br>  ‚Ä¢ Utilice herramientas de protecci√≥n antivirus de punto final para bloquear herramientas y malware C2 espec√≠ficos conocidos; <br><br>  ‚Ä¢ Aseg√∫rese de que los hosts en la red interna sean accesibles solo a trav√©s de interfaces autorizadas; <br><br>  ‚Ä¢ Limite el tr√°fico saliente permitiendo solo los puertos necesarios en los firewalls y servidores proxy a trav√©s de las puertas de enlace de red apropiadas; <br><br>  ‚Ä¢ Bloquear dominios y direcciones IP de infraestructuras C2 conocidas.  Sin embargo, debe tenerse en cuenta que esta no es una soluci√≥n efectiva y a largo plazo, ya que<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">los oponentes a menudo pueden cambiar la infraestructura de C2; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Utilice las herramientas de la lista blanca de aplicaciones para dificultar la instalaci√≥n y ejecuci√≥n de software de terceros; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Usando firewalls, firewalls de aplicaciones y proxies, limite el tr√°fico saliente a sitios y servicios utilizados por herramientas de acceso remoto conocidas (TeamViewer, Go2Assist, LogMain, AmmyAdmin, etc.); </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Si el malware usa su propio cifrado con claves sim√©tricas, entonces, utilizando ingenier√≠a inversa de muestras de software, es posible obtener un algoritmo y una clave para decodificar el tr√°fico de red e identificar firmas de malware; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Monitorear llamadas a funciones API relacionadas con la inclusi√≥n o el uso de canales de comunicaci√≥n alternativos;</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analizar el tr√°fico de red para mensajes ICMP u otros protocolos que contienen datos anormales o que generalmente no son visibles en la red o fuera de ella; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analice los flujos de red para identificar flujos anormales, por ejemplo, cuando un cliente env√≠a significativamente m√°s datos de los que recibe de un servidor o cuando un proceso que generalmente no usa una red abre conexiones de red; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analice los flujos de red para identificar paquetes que no cumplan con el est√°ndar de protocolo para el puerto utilizado.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/449654/">https://habr.com/ru/post/449654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449644/index.html">Estudio de VW muestra que Golf-E es ecol√≥gico despu√©s de 100,000 km</a></li>
<li><a href="../449646/index.html">An√°lisis de wavelet. Los fundamentos</a></li>
<li><a href="../449648/index.html">Microbios ind√≠genas a la moda</a></li>
<li><a href="../449650/index.html">Del foro al video: el camino de un graf√≥mano</a></li>
<li><a href="../449652/index.html">Invitamos a los desarrolladores a participar en el hackathon en PHDays 9</a></li>
<li><a href="../449656/index.html">C√≥mo entretenerte con vk api</a></li>
<li><a href="../449658/index.html">El nuevo huevo de Pascua de Google: Thanos y el guante del infinito frente a los resultados de b√∫squeda de Google</a></li>
<li><a href="../449662/index.html">Bienvenido a hablar en PyCon Rusia 2019</a></li>
<li><a href="../449664/index.html">Configuraci√≥n de GitLab CI para cargar un proyecto java en maven central</a></li>
<li><a href="../449666/index.html">DevOpsForum 2019. Implementar DevOps no puede esperar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>