<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöµ ‚úäüèº üìá Outro dispositivo dom√©stico inteligente üå± üëßüèæ üë©üèº‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Entrada 
 Envolvendo-se em automa√ß√£o residencial nos √∫ltimos tr√™s anos, tento acompanhar todos os novos dispositivos nessa √°rea. Recentemente, a expos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Outro dispositivo dom√©stico inteligente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/410597/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/7e/rp/b87erppacywqripfkc5as0cvpxu.png"></div><br><h3>  Entrada </h3><br>  Envolvendo-se em automa√ß√£o residencial nos √∫ltimos tr√™s anos, tento acompanhar todos os novos dispositivos nessa √°rea.  Recentemente, a exposi√ß√£o chamou a aten√ß√£o de um novo dispositivo de produ√ß√£o dom√©stica.  Depois de pesquisar na Internet, n√£o encontrei nenhuma informa√ß√£o sobre eles.  Pensei estranhamente e decidi entrar em contato com o fabricante (n√£o vou indicar).  Depois de conversar, consegui uma amostra de teste por um m√™s.  Um m√™s depois, decidi compartilhar minhas impress√µes sobre este produto. <br><br><h3>  Descri√ß√£o do fabricante </h3><br>  Segundo o fabricante, o dispositivo em estudo √© uma plataforma que permite criar sistemas automatizados para monitorar e gerenciar instala√ß√µes de infraestrutura.  A plataforma permite o desenvolvimento de sistemas centralizados e distribu√≠dos, incluindo a conex√£o de dispositivos inteligentes, e os recursos funcionais do sistema s√£o determinados pelo software instalado. <br><br>  O fabricante declara as seguintes caracter√≠sticas do dispositivo: <br><a name="habracut"></a><table><tbody><tr><td>  CPU </td><td>  ‚Ä¢ CPU: Allwinner H5 Corte Cortex A53 de 64 bits e quatro n√∫cleos <br>  ‚Ä¢ RAM: 1 GB <br>  ‚Ä¢ Armazenamento: 8GB eMMC, cart√£o MicroSD </td></tr><tr><td>  Sistema operacional </td><td>  ‚Ä¢ Linux Debian ou Ubuntu </td></tr><tr><td>  Comunica√ß√µes </td><td>  ‚Ä¢ Rede: Ethernet de Gbps <br>  ‚Ä¢ WiFi: 802.11b / g / n <br>  ‚Ä¢ Bluetooth: modo dual 4.0 <br>  ‚Ä¢ R√°dio: 2,4 GHz <br>  ‚Ä¢ 2 x host USB <br>  ‚Ä¢ 1 x RS485 </td></tr><tr><td>  Portas de entrada / sa√≠da </td><td>  ‚Ä¢ 4 contatos "secos" 350 v / 120mA <br>  ‚Ä¢ 4 sa√≠das 12 v / 1A <br>  ‚Ä¢ 4 entradas 0 - 12 v </td></tr><tr><td>  Indica√ß√£o de status </td><td>  ‚Ä¢ display OLED <br>  ‚Ä¢ LED </td></tr><tr><td>  Nutri√ß√£o </td><td>  ‚Ä¢ DC 12 v </td></tr></tbody></table><br><h3>  Preparamos o cliente <br></h3><br>  O dispositivo vem em duas vers√µes: apenas bare metal e uma solu√ß√£o pronta com software.  Eu tenho a primeira op√ß√£o, mas ainda mais interessante - h√° onde brincar com a fantasia. <br><br>  A apar√™ncia do dispositivo √© bastante asc√©tica: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/7e/rp/b87erppacywqripfkc5as0cvpxu.png"></div><br>  A caixa do dispositivo permite a montagem em um gabinete em um trilho DIN e ocupa quatro m√≥dulos de largura. <br><br>  No painel frontal est√£o: <br><br><ul><li>  exibi√ß√£o </li><li>  quatro bot√µes; </li><li>  Indicador LED do status do dispositivo (‚Äúvermelho‚Äù - desativado, ‚Äúverde‚Äù - a energia √© fornecida, ‚Äúazul‚Äù - indica a atividade do processador); </li></ul><br>  Sob as tampas est√£o localizados: <br><br><ul><li>  Conectores de E / S (√† primeira vista, pareceu-me que seu n√∫mero pode ser insuficiente, mas comentarei um pouco mais esse momento); </li><li>  Interface RS485 </li><li>  conex√£o de energia. </li></ul><br>  Todos os conectores s√£o aparafusados, o que me deixou feliz porque n√£o gosto de apertar.  N√£o h√° conectores e controles no lado direito da caixa, o que geralmente pode ser √∫til para uma instala√ß√£o mais apertada do equipamento no gabinete. <br><br>  Todos os conectores s√£o montados no lado esquerdo: <br><br><ul><li>  antena WiFi remov√≠vel; </li><li>  2 USB; </li><li>  1 Eth </li><li>  tomada de √°udio. </li></ul><br>  A antena WiFi interfere na conex√£o de dispositivos USB e cabo de rede.  Ele deve ser abaixado ou trazido para a frente do gabinete com um cabo, a segunda op√ß√£o provavelmente est√° mais correta, melhorando assim o n√≠vel do sinal. <br><br>  Prosseguimos para a "abertura do paciente" (todo o estojo √© montado em travas, n√£o √© dif√≠cil desmont√°-lo) e vemos o que ele consiste no interior / Abra a tampa frontal e veja: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ka/j4/d4/kaj4d4omm3_z-78fnhmpqiv5ws4.png"></div><br><ul><li>  Tela OLED SSD1306 (128x64px): a tela √© certamente pequena, mas voc√™ pode obter informa√ß√µes m√≠nimas; </li><li>  Quatro bot√µes para controle local do dispositivo, a julgar pela designa√ß√£o, para controlar a sa√≠da de informa√ß√µes na tela; </li><li>  Bot√£o de gerenciamento de energia (como ATtiny13 descobriu posteriormente para gerenciamento de energia); </li><li>  LED RGB </li><li>  Sob a inscri√ß√£o est√° a antena do m√≥dulo de r√°dio. </li></ul><br>  Vamos mais al√©m - abrimos o gabinete e vemos que o dispositivo consiste em tr√™s placas: a placa principal, a placa processadora e a placa "superior", cuja parte frontal √© descrita acima, √© conectada por um cabo.  N√≥s os examinamos mais de perto: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/ty/hz/lttyhznbz7tcf5yn8dzppnqxjtc.png"></div><br><br><ul><li>  O m√≥dulo do processador √© um computador de placa √∫nica NanoPi NEO Plus2.  OBC n√£o muito badalado, mas muito interessante do ponto de vista t√©cnico.  Voc√™ pode ler sobre isso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gp/3p/x-/gp3px-m9pebjgkevd2dnqi-fsbm.png"></div><br>  Na placa principal est√° localizado: <br><br><ul><li>  Prote√ß√£o contra invers√£o de polaridade (pensamos em ‚Äúprote√ß√£o contra tolos‚Äù j√° n√£o √© ruim); </li><li>  O conversor DC-DC no XL4005E1 5A, feliz por n√£o terem ferrado o poderoso diodo Schottky (12A), mas a bobina √© enrolada com um fio fino - 3A ser√° puxado, mas eu n√£o o carregarei mais, os pol√≠gonos de refrigera√ß√£o do conversor s√£o feitos na parte traseira da placa, o que aumenta a confian√ßa no trabalho (o conversor da ATtiny13 √© controlado); </li><li>  O restante dos detalhes est√° inclu√≠do de acordo com esquemas padr√£o: o regulador de tens√£o AMS 1117 para 3,3 v, o extensor MCP23017, o SP3485 para organizar a interface RS485, o ADS1115 ADC de 16 bits, a presen√ßa do sensor de press√£o atmosf√©rica BMP180 agradavelmente surpreendido. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/iw/r_/qkiwr_vhzvpuc6l9aii7ovcb6u0.png"></div><br>  No verso da placa ‚Äúsuperior‚Äù est√£o instalados: <br><br><ul><li>  M√≥dulo RTC DS3231; </li><li>  Expansor de porta PCF8574 respons√°vel pelo processamento de cliques no bot√£o; </li><li>  M√≥dulo de r√°dio nRF24L01P com amplificador. </li></ul><br><h3>  Uso e Programa√ß√£o </h3><br>  Como eu j√° disse, fiquei nu e tive que verificar o funcionamento dos m√≥dulos e criar scripts sozinho.  Ele n√£o filosofou, o Armbian pegou a montagem do Linux e fez toda a programa√ß√£o em Python - r√°pido, barato e alegre!  Todos os microcircuitos s√£o bem conhecidos por uma grande variedade de entusiastas de r√°dio amador; encontrar uma descri√ß√£o e m√©todos b√°sicos de uso n√£o ser√° dif√≠cil. <br><br>  Depois de estudar o dispositivo, uma lista aproximada de tarefas foi formada: <br><br><ol><li>  Conecte os contatores 220v atrav√©s das sa√≠das dos contatos "secos".  (Obtenha linhas de energia control√°veis) </li><li>  Para duas sa√≠das de 12v / 1A e duas entradas, conecte os sensores de seguran√ßa e inc√™ndio padr√£o.  (Obtenha um sistema de seguran√ßa e inc√™ndio, sem acesso ao controle remoto, mas isso geralmente n√£o √© necess√°rio). </li><li>  Conecte-se a entradas e sa√≠das livres, sensores de vazamento e v√°lvulas de esfera com acionamento el√©trico de 12 v.  (Obtenha prote√ß√£o contra vazamentos). </li><li>  Levante o servidor WEB e escreva uma interface de gerenciamento (obtenha controle remoto). </li><li>  Verifique a conex√£o via r√°dio, WiFi e RS485 de dispositivos adicionais (verifique a possibilidade de construir uma rede distribu√≠da). </li><li>  Verifique o funcionamento do modem USB. </li><li>  Verifique a opera√ß√£o como um roteador. </li></ol><br><img src="https://habrastorage.org/webt/zc/za/cu/zczacu4t1wrx2kogetbvn3kx53u.png"><br><br>  Para testar, montei rapidamente um suporte e comecei a me divertir: <br><br>  O ATtiny13 j√° foi programado, eu n√£o o toquei, seja respons√°vel pela fonte de alimenta√ß√£o de acordo com o plano do fabricante. <br><br>  MCP23017, ADS1115, PCF8574, DS3231, BMP180 - tudo isso funciona de acordo com I2C, portanto, o entendimento da opera√ß√£o desse barramento determina imediatamente cerca de 80% do c√≥digo.  Tudo foi iniciado (conforme o esperado), desde que o endere√ßamento dos dispositivos j√° foi definido pelo fabricante. <br><br>  O nRF24L01P √© executado no barramento SPI, cujos exemplos tamb√©m s√£o suficientes.  Entrei em contato com um par de dispositivos no Arduino, tudo funciona como planejado. <br><br>  O RS485 foi testado no protocolo Modbus com um medidor de pot√™ncia Eastron SDM220.  As leituras s√£o feitas, sem surpresas. <br><br>  O plugue USB no modem Huawei E1550 determinou tudo, pegou o cliente VPN e entrou em contato com o servidor dom√©stico.  Instalou um servidor web e jogou com controle remoto. <br><br>  O m√≥dulo WiFi funciona no modo cliente e no modo de ponto de acesso.  Ele colocou o m√≥dulo no modo AP, instalou um servidor DHCP, configurou iptables e recebeu um roteador WiFi. <br><br>  A instala√ß√£o de um servidor Blynk local n√£o causou problemas.  Trabalho verificado com o ESP8266.  O controle do smartphone est√° funcionando, as leituras s√£o exibidas. <br><br>  Assim, todas as tarefas foram conclu√≠das, o dispositivo central da casa inteligente foi lan√ßado!  Pode parecer que tudo est√° programado, configurado com facilidade e simplicidade, ou sou um g√™nio. <br><br>  Garanto-lhe que n√£o √© assim!  Eu j√° encontrei a maioria dos microcircuitos e m√≥dulos, ent√£o pisei em um ancinho e minha testa doeu muito ÔÅä, mas os solavancos passaram, mas o conhecimento permaneceu! <br><br>  A energia do m√≥dulo do processador √© mais que suficiente para resolver minhas tarefas, durante o teste a carga m√©dia no processador n√£o excedeu 15%.  A presen√ßa de mem√≥ria eMMC e cart√µes MicroSD permitir√° a duplica√ß√£o de sistemas operacionais e software.  O consumo sem conectar dispositivos USB √© de cerca de 300 mA.  Com esse tipo de consumo, n√£o ser√° dif√≠cil organizar a fonte de alimenta√ß√£o ininterrupta a partir de uma bateria de horas para 5 trabalhos. <br><br>  A base do elemento selecionado para a constru√ß√£o de perif√©ricos √© bastante confi√°vel, o que garante confian√ßa na opera√ß√£o sem problemas do dispositivo no modo 24x7. <br><br>  A presen√ßa de um pequeno n√∫mero de entradas e sa√≠das no pr√≥prio dispositivo √© totalmente compensada pela presen√ßa de um barramento 485 e um m√≥dulo de r√°dio, ou seja, a constru√ß√£o de um sistema de controle distribu√≠do n√£o ser√° muito dif√≠cil, e o conjunto de entradas e sa√≠das que est√£o a bordo pode ser usado para controle local no gabinete de energia. <br><br><h3>  Conclus√µes </h3><br>  Este dispositivo, declarado pelo fabricante, integrar√° todos os dispositivos inteligentes?  Com um alongamento, voc√™ pode dizer que sim.  Mas, infelizmente, n√£o h√° m√≥dulo de r√°dio suficiente para suporte a 433 MHz, barramento CAN, ZigBee, mas a presen√ßa de RS485, m√≥dulo de r√°dio a 2,4 GHz e WiFi permitir√° conectar um n√∫mero suficiente de dispositivos e protocolos de comunica√ß√£o podem ser implementados em software. <br><br>  Repito, o dispositivo em quest√£o √© fabricado em duas vers√µes: uma solu√ß√£o totalmente pronta para construir um sistema de controle distribu√≠do e apenas hardware.  Na minha opini√£o, uma solu√ß√£o pronta s√≥ pode ser comprada se voc√™ n√£o quiser lidar com programa√ß√£o e pregui√ßa.  Em outros casos, √© muito mais interessante pegar a plataforma e program√°-la por si mesmo. <br><br>  Atualmente, o custo do dispositivo √© desconhecido para mim.  Na minha opini√£o, se o fabricante n√£o conduzir o pre√ßo de mais de 13 tr.  para a vers√£o "nua", ent√£o este dispositivo √© bastante interessante para comprar.  Depois de comprar todas as pe√ßas na China e coloc√°-las em uma √∫nica embalagem, √© improv√°vel que voc√™ fique mais barato. <br><br>  Um concorrente pode ser o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wiren Board 5</a> .  Ele ganha no n√∫mero de portas e poss√≠veis interfaces, mas perde na pot√™ncia do m√≥dulo do processador.  Isso n√£o afeta as tarefas padr√£o, mas instalar um servidor Blynk localmente ou criar um m√≥dulo de controle de voz pode ser problem√°tico.  Se algu√©m tentou fazer isso no WB5, por favor, comente nos coment√°rios. <br><br>  <b>PS:</b> Depois de terminar o artigo, tamb√©m encontrei o chip de criptografia ATSHA204 na placa.  Ele suporta o algoritmo criptogr√°fico SHA - 256 e √© √≥timo para tarefas de autentica√ß√£o sim√©trica.  Bem, isso √© absolutamente para os geeks! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt410597/">https://habr.com/ru/post/pt410597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt410585/index.html">Como se tornar um m√°gico (parte 1)</a></li>
<li><a href="../pt410587/index.html">Apple pretende comprar cobalto exclusivamente de empresas de minera√ß√£o</a></li>
<li><a href="../pt410589/index.html">Ecossistemas marinhos capazes de se adaptar ao aquecimento global</a></li>
<li><a href="../pt410591/index.html">A hist√≥ria emocional dos processadores para os primeiros computadores dos anos 70 ao in√≠cio dos anos 90</a></li>
<li><a href="../pt410593/index.html">Telegram realiza outra rodada da OIC</a></li>
<li><a href="../pt410599/index.html">Uma onda de roubos de equipamentos de fazendas de minera√ß√£o varreu a Isl√¢ndia</a></li>
<li><a href="../pt410601/index.html">O que √© rob√≥tica educacional hoje</a></li>
<li><a href="../pt410603/index.html">Manifesto de propriedade</a></li>
<li><a href="../pt410605/index.html">Astr√¥nomo amador testou uma nova c√¢mera e acidentalmente fotografou uma supernova</a></li>
<li><a href="../pt410607/index.html">A SpaceX continua trabalhando: os dois primeiros sat√©lites da rede global de Internet sem fio e a busca por carenagens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>