<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõµ üíÖüèº üö∑ Ponteiros em Python: qual √© o objetivo? üë≥üèø üôä üë®üèΩ‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Se voc√™ j√° trabalhou com linguagens de baixo n√≠vel como C ou C ++, provavelmente j√° ouviu falar sobre ponteiros. Eles permitem aumentar significativam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ponteiros em Python: qual √© o objetivo?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/454324/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/_i/vd/cj/_ivdcjv0itamifffxs0i1i-mqh4.jpeg"></div><br>  Se voc√™ j√° trabalhou com linguagens de baixo n√≠vel como C ou C ++, provavelmente j√° ouviu falar sobre ponteiros.  Eles permitem aumentar significativamente a efic√°cia de diferentes partes do c√≥digo.  Mas eles tamb√©m podem confundir iniciantes - e at√© desenvolvedores experientes - e levar a erros de gerenciamento de mem√≥ria.  Existem ponteiros no Python, posso de alguma forma imit√°-los? <br><br>  Ponteiros s√£o amplamente utilizados em C e C ++.  De fato, s√£o vari√°veis ‚Äã‚Äãque cont√™m os endere√ßos de mem√≥ria nos quais outras vari√°veis ‚Äã‚Äãest√£o localizadas.  Para atualizar os ponteiros, leia esta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">resenha</a> . <br><br>  Gra√ßas a este artigo, voc√™ entender√° melhor o modelo de objeto no Python e descobrir√° por que os ponteiros n√£o existem realmente nessa linguagem.  Caso voc√™ precise simular o comportamento dos ponteiros, aprender√° como imit√°-los sem o pesadelo que acompanha o gerenciamento de mem√≥ria. <br><a name="habracut"></a><br>  Com este artigo, voc√™: <br><br><ul><li>  Saiba por que o Python n√£o tem ponteiros. </li><li>  Aprenda a diferen√ßa entre vari√°veis ‚Äã‚ÄãC e nomes no Python. </li><li>  Aprenda a emular ponteiros em Python. </li><li> Use <code>ctypes</code> experimentar ponteiros reais. </li></ul><br>  <b>Nota</b> : Aqui, o termo ‚ÄúPython‚Äù √© aplicado √† implementa√ß√£o do Python em C, conhecida como CPython.  Todas as discuss√µes sobre o dispositivo de idioma s√£o v√°lidas para o CPython 3.7, mas podem n√£o corresponder √†s itera√ß√µes subsequentes. <br><br><h2>  Por que n√£o existem ponteiros no Python? </h2><br>  Eu n√£o sei  Os ponteiros podem existir nativamente no Python?  Provavelmente, mas aparentemente, os indicadores contradizem o conceito de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Zen de Python</a> , porque provocam mudan√ßas impl√≠citas em vez de expl√≠citas.  Os ponteiros geralmente s√£o bastante complexos, especialmente para iniciantes.  Al√©m disso, eles o levam a tomar decis√µes malsucedidas ou a fazer algo realmente perigoso, como ler de uma √°rea de mem√≥ria, onde voc√™ n√£o deveria ter lido. <br><br>  O Python tenta abstrair os detalhes da implementa√ß√£o do usu√°rio, como um endere√ßo de mem√≥ria.  Geralmente, nesse idioma, a √™nfase est√° na usabilidade, n√£o na velocidade.  Portanto, os ponteiros no Python n√£o fazem muito sentido.  Mas n√£o se preocupe, o idioma padr√£o fornece alguns dos benef√≠cios do uso de ponteiros. <br><br>  Para entender os ponteiros no Python, vamos examinar brevemente os recursos da implementa√ß√£o da linguagem.  Em particular, voc√™ precisa entender: <br><br><ol><li>  O que s√£o objetos mut√°veis ‚Äã‚Äãe imut√°veis. </li><li>  Como as vari√°veis ‚Äã‚Äã/ nomes s√£o organizados em Python. </li></ol><br>  Segure seus endere√ßos de mem√≥ria, vamos l√°! <br><br><h2>  Objetos em Python </h2><br>  Tudo em Python √© um objeto.  Por exemplo, abra o REPL e veja como <code>isinstance()</code> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>isinstance(<span class="hljs-number"><span class="hljs-number">1</span></span>, object) <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt;&gt; isinstance(list(), object) <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt;&gt; isinstance(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, object) <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> ... &gt;&gt;&gt; isinstance(foo, object) <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Este c√≥digo demonstra que tudo no Python √© realmente um objeto.  Cada objeto cont√©m pelo menos tr√™s tipos de dados: <br><br><ul><li>  Contador de refer√™ncia. <br></li><li>  Tipo <br></li><li>  Valor. <br></li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um contador de refer√™ncia √©</a> usado para gerenciar a mem√≥ria.  Detalhes sobre esse gerenciamento est√£o escritos em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gerenciamento de mem√≥ria em Python</a> .  O tipo √© usado no n√≠vel CPython para fornecer seguran√ßa de tipo durante o tempo de execu√ß√£o.  E value √© o valor real associado ao objeto. <br><br>  Mas nem todos os objetos s√£o iguais.  H√° uma diferen√ßa importante: os objetos s√£o mut√°veis ‚Äã‚Äãe imut√°veis.  Entender essa distin√ß√£o entre tipos de objetos o ajudar√° a entender melhor a primeira camada da cebola chamada "ponteiros em Python". <br><br><h2>  Objetos mut√°veis ‚Äã‚Äãe imut√°veis </h2><br>  Existem dois tipos de objetos no Python: <br><br><ol><li>  Objetos imut√°veis ‚Äã‚Äã(n√£o podem ser alterados); <br></li><li>  Objetos modific√°veis ‚Äã‚Äã(sujeitos a altera√ß√µes). <br></li></ol><br>  Reconhecer essa diferen√ßa √© a primeira chave para viajar pelo mundo dos ponteiros em Python.  Aqui est√° uma caracteriza√ß√£o da imutabilidade de alguns tipos populares: <br><br><div class="scrollable-table"><table><tbody><tr><th width="400">  Tipo <br></th><th width="400">  Imut√°vel? <br></th></tr><tr><td>  int <br></td><td>  Sim <br></td></tr><tr><td>  flutuar <br></td><td>  Sim <br></td></tr><tr><td>  bool <br></td><td>  Sim <br></td></tr><tr><td>  complexo <br></td><td>  Sim <br></td></tr><tr><td>  tupla <br></td><td>  Sim <br></td></tr><tr><td>  frozenset <br></td><td>  Sim <br></td></tr><tr><td>  str <br></td><td>  Sim <br></td></tr><tr><td>  lista <br></td><td>  N√£o <br></td></tr><tr><td>  definir <br></td><td>  N√£o <br></td></tr><tr><td>  ditar <br></td><td>  N√£o <br></td></tr></tbody></table></div><br>  Como voc√™ pode ver, muitos dos tipos primitivos comumente usados ‚Äã‚Äãs√£o imut√°veis.  Voc√™ pode verificar isso escrevendo algum c√≥digo Python.  Voc√™ precisar√° de duas ferramentas da biblioteca padr√£o: <br><br><ol><li>  <code>id()</code> retorna o endere√ßo de mem√≥ria do objeto; <br></li><li>  <code>is</code> retorna <code>True</code> se e somente se dois objetos tiverem o mesmo endere√ßo de mem√≥ria. <br></li></ol><br>  Voc√™ pode executar esse c√≥digo em um ambiente REPL: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = <span class="hljs-number"><span class="hljs-number">5</span></span> &gt;&gt;&gt; id(x) <span class="hljs-number"><span class="hljs-number">94529957049376</span></span></code> </pre> <br>  Aqui, definimos a vari√°vel <code>x</code> como <code>5</code> .  Se voc√™ tentar alterar o valor usando adi√ß√£o, voc√™ receber√° um novo objeto: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x += <span class="hljs-number"><span class="hljs-number">1</span></span> &gt;&gt;&gt; x <span class="hljs-number"><span class="hljs-number">6</span></span> &gt;&gt;&gt; id(x) <span class="hljs-number"><span class="hljs-number">94529957049408</span></span></code> </pre> <br>  Embora possa parecer que esse c√≥digo simplesmente mude o valor de <code>x</code> , na realidade voc√™ est√° recebendo um <b>novo</b> objeto como resposta. <br><br>  O tipo <code>str</code> tamb√©m √© imut√°vel: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>s = <span class="hljs-string"><span class="hljs-string">"real_python"</span></span> &gt;&gt;&gt; id(s) <span class="hljs-number"><span class="hljs-number">140637819584048</span></span> &gt;&gt;&gt; s += <span class="hljs-string"><span class="hljs-string">"_rocks"</span></span> &gt;&gt;&gt; s <span class="hljs-string"><span class="hljs-string">'real_python_rocks'</span></span> &gt;&gt;&gt; id(s) <span class="hljs-number"><span class="hljs-number">140637819609424</span></span></code> </pre> <br>  E, neste caso, <code>s</code> ap√≥s a opera√ß√£o <code>+=</code> obt√©m um endere√ßo de mem√≥ria <b>diferente</b> . <br><br>  <b>B√¥nus</b> : o operador <code>+=</code> traduz em v√°rias chamadas de m√©todo. <br><br>  Para alguns objetos, como uma lista, <code>+=</code> converte em <code>__iadd__()</code> (anexo local).  Ele ser√° alterado e retornar√° o mesmo ID.  No entanto, <code>str</code> e <code>int</code> n√£o possuem esses m√©todos e, como resultado, <code>__add__()</code> ser√° chamado em vez de <code>__iadd__()</code> . <br><br>  Veja a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o do modelo de dados</a> Python <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">para mais detalhes</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">.</a> <br><br>  Quando tentamos alterar diretamente o valor da string de <code>s</code> obtemos um erro: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>s[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">"R"</span></span></code> </pre> <br>  Rastreamento de retorno (as √∫ltimas chamadas s√£o exibidas por √∫ltimo): <br><br><pre> <code class="python hljs"> File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;mdule&gt; TypeError: <span class="hljs-string"><span class="hljs-string">'str'</span></span> object does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support item assignment</code> </pre> <br>  O c√≥digo acima trava e o Python relata que <code>str</code> n√£o suporta essa altera√ß√£o, o que corresponde √† defini√ß√£o de imutabilidade do tipo <code>str</code> . <br><br>  Compare com um objeto mut√°vel, por exemplo, com uma lista: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>my_list = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] &gt;&gt;&gt; id(my_list) <span class="hljs-number"><span class="hljs-number">140637819575368</span></span> &gt;&gt;&gt; my_list.append(<span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt;&gt; my_list [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>] &gt;&gt;&gt; id(my_list) <span class="hljs-number"><span class="hljs-number">140637819575368</span></span></code> </pre> <br>  Este c√≥digo demonstra a principal diferen√ßa entre os dois tipos de objetos.  Inicialmente, <code>my_list</code> tem um ID.  Mesmo depois de adicionar <code>4</code> √† lista, <code>my_list</code> ainda tem <b>o mesmo</b> ID.  O motivo √© que a <code>list</code> tipos √© mut√°vel. <br><br>  Aqui est√° outra demonstra√ß√£o da mutabilidade da lista usando a atribui√ß√£o: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>my_list[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt; my_list [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>] &gt;&gt;&gt; id(my_list) <span class="hljs-number"><span class="hljs-number">140637819575368</span></span></code> </pre> <br>  Nesse c√≥digo, alteramos <code>my_list</code> e o definimos como <code>0</code> como o primeiro elemento.  No entanto, a lista manteve o mesmo ID ap√≥s esta opera√ß√£o.  O pr√≥ximo passo no nosso caminho para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aprender Python</a> ser√° explorar seu ecossistema. <br><br><h2>  Lidamos com vari√°veis </h2><br>  Vari√°veis ‚Äã‚Äãem Python s√£o fundamentalmente diferentes das vari√°veis ‚Äã‚Äãem C e C ++.  Essencialmente, eles simplesmente n√£o existem no Python.  <b>Em vez de vari√°veis, existem nomes</b> . <br><br>  Pode parecer pedante, e na maioria das vezes √©.  Na maioria das vezes, voc√™ pode tomar nomes em Python como vari√°veis, mas precisa entender a diferen√ßa.  Isso √© especialmente importante quando voc√™ estuda um t√≥pico t√£o dif√≠cil como ponteiros. <br><br>  Para facilitar a compreens√£o, vamos ver como as vari√°veis ‚Äã‚Äãfuncionam em C, o que elas representam e depois comparar com o trabalho dos nomes no Python. <br><br><h3>  Vari√°veis ‚Äã‚Äãem C </h3><br>  Pegue o c√≥digo que define a vari√°vel <code>x</code> : <br><br><pre> <code class="python hljs">int x = <span class="hljs-number"><span class="hljs-number">2337</span></span>;</code> </pre> <br>  A execu√ß√£o desta linha curta passa por v√°rias etapas diferentes: <br><br><ol><li>  Alocando mem√≥ria suficiente para um n√∫mero. <br></li><li>  Atribui√ß√£o de <code>2337</code> para este local de mem√≥ria. <br></li><li>  O mapeamento que <code>x</code> indica esse valor. <br></li></ol><br>  Uma mem√≥ria simplificada pode ser assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f13/e62/d71/f13e62d71774b73aecff45931b6db57f.png"><br><br>  Aqui, a vari√°vel <code>x</code> tem um endere√ßo falso de <code>0x7f1</code> e um valor de <code>2337</code> .  Se voc√™ desejar alterar posteriormente o valor de <code>x</code> , fa√ßa o seguinte: <br><br><pre> <code class="python hljs">x = <span class="hljs-number"><span class="hljs-number">2338</span></span>;</code> </pre> <br>  Este c√≥digo define a vari√°vel <code>x</code> novo valor de <code>2338</code> , substituindo assim o valor <b>anterior</b> .  Isso significa que a vari√°vel <code>x</code> <b>mut√°vel</b> .  Esquema de mem√≥ria atualizado para o novo valor: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/347/491/19b/34749119bcba5c4009861aa4e7c40c45.png"><br><br>  Observe que a localiza√ß√£o de <code>x</code> n√£o mudou, apenas o valor em si.  Isso √© importante.  Isso nos diz que <code>x</code> √© <b>um lugar na mem√≥ria</b> , e n√£o apenas um nome. <br><br>  Voc√™ tamb√©m pode considerar esse problema como parte do conceito de propriedade.  Por um lado, <code>x</code> possui um lugar na mem√≥ria.  Primeiro, <code>x</code> √© uma caixa vazia que pode conter apenas um n√∫mero inteiro, na qual valores inteiros podem ser armazenados. <br><br>  Ao atribuir <code>x</code> algum valor, voc√™ o coloca em uma caixa que pertence a <code>x</code> .  Se voc√™ deseja introduzir uma nova vari√°vel <code>y</code> , voc√™ pode adicionar esta linha: <br><br><pre> <code class="python hljs">int y = x;</code> </pre> <br>  Esse c√≥digo cria uma nova caixa chamada <code>y</code> e copia o valor de <code>x</code> para ele.  Agora o circuito de mem√≥ria fica assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/caa/74d/ed3/caa74ded301b1f527e1b94516f1b1196.png"><br><br>  Observe o novo local <code>y</code> - <code>0x7f5</code> .  Embora o valor <code>x</code> sido copiado para <code>x</code> , a vari√°vel <code>y</code> possui um novo endere√ßo na mem√≥ria.  Portanto, voc√™ pode substituir o valor de <code>y</code> sem afetar <code>x</code> : <br><br><pre> <code class="python hljs">y = <span class="hljs-number"><span class="hljs-number">2339</span></span>;</code> </pre> <br>  Agora o circuito de mem√≥ria fica assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fcf/f8d/ed4/fcff8ded49647ad0053a45f0773cb4bb.png"><br><br>  Repito: voc√™ alterou o valor de <code>y</code> , mas n√£o o local.  Al√©m disso, voc√™ n√£o afetou a vari√°vel original <code>x</code> . <br><br>  Com nomes em Python, a situa√ß√£o √© completamente diferente. <br><br><h3>  Nomes em Python </h3><br>  N√£o h√° vari√°veis ‚Äã‚Äãno Python, nomes.  Voc√™ pode usar o termo "vari√°veis" a seu crit√©rio, no entanto, √© importante saber a diferen√ßa entre vari√°veis ‚Äã‚Äãe nomes. <br><br>  Vamos pegar o c√≥digo equivalente do exemplo C acima e escrever em Python: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = <span class="hljs-number"><span class="hljs-number">2337</span></span></code> </pre> <br>  Como em C, o c√≥digo passa por v√°rias etapas separadas durante a execu√ß√£o disso: <br><br><ol><li>  PyObject √© criado. <br></li><li>  O n√∫mero do PyObject recebe um c√≥digo de tipo. <br></li><li>  <code>2337</code> atribu√≠do um valor para PyObject. <br></li><li>  O nome <code>x</code> √© criado. </li><li>  <code>x</code> aponta para o novo PyObject. </li><li>  A contagem de refer√™ncia do PyObject √© incrementada em 1. <br></li></ol><br>  <b>Nota</b> : <a href="">PyObject</a> n√£o √© o mesmo que um objeto em Python, esta entidade √© espec√≠fica para CPython e representa a estrutura b√°sica de todos os objetos Python. <br><br>  PyObject √© definido como uma estrutura C, portanto, se voc√™ se pergunta por que n√£o pode chamar diretamente o tipo de c√≥digo ou o contador de refer√™ncia, o motivo √© que voc√™ n√£o tem acesso direto √†s estruturas.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Chamar</a> m√©todos como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sys.getrefcount ()</a> pode ajudar a obter algum tipo de material interno. <br><br>  Se falamos de mem√≥ria, pode ser assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d9/ad7/932/9d9ad79327405315461e3880fe3db256.png"><br><br>  Aqui, o circuito de mem√≥ria √© muito diferente do circuito em C mostrado acima.  Em vez de ter <code>x</code> um bloco de mem√≥ria que armazena o valor <code>2337</code> , um objeto Python rec√©m-criado possui a mem√≥ria em que <code>2337</code> mora.  O nome do Python <code>x</code> n√£o possui diretamente <b>nenhum</b> endere√ßo na mem√≥ria, assim como uma vari√°vel C possui uma c√©lula est√°tica. <br><br>  Se voc√™ deseja atribuir <code>x</code> novo valor, tente este c√≥digo: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = <span class="hljs-number"><span class="hljs-number">2338</span></span></code> </pre> <br>  O comportamento do sistema ser√° diferente do que acontece em C, mas n√£o ser√° muito diferente do v√≠nculo original no Python. <br><br>  Neste c√≥digo: <br><br><ul><li>  Um novo PyObject √© criado. <br></li><li>  O n√∫mero do PyObject recebe um c√≥digo de tipo. <br></li><li>  <code>2</code> atribu√≠do um valor para PyObject. <br></li><li>  <code>x</code> aponta para o novo PyObject. <br></li><li>  A contagem de refer√™ncia do novo PyObject √© incrementada em 1. <br></li><li>  A contagem de refer√™ncia do antigo PyObject √© reduzida em 1. <br></li></ul><br>  Agora o circuito de mem√≥ria fica assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/712/860/996/712860996aa37da34fdb69a466cdf5de.png"><br><br>  Esta ilustra√ß√£o demonstra que <code>x</code> aponta para uma refer√™ncia a um objeto e n√£o possui a √°rea de mem√≥ria como antes.  Voc√™ tamb√©m v√™ que o comando <code>x = 2338</code> n√£o √© uma atribui√ß√£o, mas uma liga√ß√£o do nome <code>x</code> ao link. <br><br>  Al√©m disso, o objeto anterior (contendo o valor <code>2337</code> ) agora est√° na mem√≥ria com uma contagem de refer√™ncia de 0 e ser√° removido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pelo coletor de lixo</a> . <br><br>  Voc√™ pode inserir um novo nome <code>y</code> , como no exemplo C: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>y = x</code> </pre> <br>  Um novo nome aparecer√° na mem√≥ria, mas n√£o necessariamente um novo objeto: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/958/adc/410/958adc41013bb5483f0526689a48a871.png"><br><br>  Agora voc√™ v√™ que um novo objeto Python <b>n√£o foi</b> criado, apenas um novo nome <b>foi</b> criado que aponta para o mesmo objeto.  Al√©m disso, o contador de refer√™ncia do objeto aumentou em 1. Voc√™ pode verificar a equival√™ncia da identidade dos objetos para confirmar sua identidade: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>y <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Este c√≥digo mostra que <code>y</code> s√£o um objeto.  Mas n√£o se engane: <code>y</code> ainda √© imut√°vel.  Por exemplo, voc√™ pode executar uma opera√ß√£o de adi√ß√£o com <code>y</code> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>y += <span class="hljs-number"><span class="hljs-number">1</span></span> &gt;&gt;&gt; y <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br>  Ap√≥s a adi√ß√£o ser chamada, voc√™ retornar√° um novo objeto Python.  Agora a mem√≥ria fica assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8bd/abc/3e7/8bdabc3e7576ab86b00ba9c2b43b57b4.png"><br><br>  Um novo objeto foi criado e <code>y</code> agora aponta para ele.  √â curioso que obter√≠amos exatamente o mesmo estado final se <code>2339</code> <code>y</code> diretamente a <code>2339</code> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>y = <span class="hljs-number"><span class="hljs-number">2339</span></span></code> </pre> <br>  Ap√≥s essa express√£o, obtemos um estado final de mem√≥ria, como na opera√ß√£o de adi√ß√£o.  Deixe-me lembr√°-lo de que no Python voc√™ n√£o atribui vari√°veis, mas vincula nomes aos links. <br><br><h3>  Sobre estagi√°rios em Python </h3><br>  Agora voc√™ entende como novos objetos s√£o criados no Python e como os nomes s√£o anexados a eles.  √â hora de falar sobre objetos internados. <br><br>  Temos este c√≥digo Python: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt;&gt;&gt; y = <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt;&gt;&gt; x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Como antes, <code>x</code> e <code>y</code> s√£o nomes apontando para o mesmo objeto Python.  Mas esse objeto que cont√©m o valor <code>1000</code> nem sempre pode ter o mesmo endere√ßo de mem√≥ria.  Por exemplo, se voc√™ somar dois n√∫meros e obter 1000, receber√° outro endere√ßo: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt;&gt;&gt; y = <span class="hljs-number"><span class="hljs-number">499</span></span> + <span class="hljs-number"><span class="hljs-number">501</span></span> &gt;&gt;&gt; x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br>  Desta vez, a cadeia <code>x is y</code> retorna <code>False</code> .  Se voc√™ est√° envergonhado, n√£o se preocupe.  Aqui est√° o que acontece quando esse c√≥digo √© executado: <br><br><ol><li>  Um objeto Python √© criado ( <code>1000</code> ). <br></li><li>  √â dado o nome <code>x</code> . <br></li><li>  Um objeto Python √© criado ( <code>499</code> ). <br></li><li>  Um objeto Python √© criado ( <code>501</code> ). <br></li><li>  Esses dois objetos se somam. <br></li><li>  Um novo objeto Python √© criado ( <code>1000</code> ). <br></li><li>  Ele recebe o nome <code>y</code> . <br></li></ol><br>  <b>Explica√ß√µes t√©cnicas</b> : As etapas descritas ocorrem apenas quando esse c√≥digo √© executado dentro do REPL.  Se voc√™ pegar o exemplo acima, cole-o no arquivo e execute-o, ent√£o a linha <code>x is y</code> retornar√° <code>True</code> . <br><br>  O motivo √© o racioc√≠nio r√°pido do compilador CPython, que tenta executar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">otimiza√ß√µes de olho m√°gico</a> que ajudam a salvar as etapas de execu√ß√£o de c√≥digo o m√°ximo poss√≠vel.  Detalhes podem ser encontrados no <a href="">c√≥digo-fonte do otimizador de peyphole CPython</a> . <br><br>  Mas isso n√£o √© um desperd√≠cio?  Bem, sim, mas voc√™ paga esse pre√ßo por todos os grandes benef√≠cios do Python.  Voc√™ n√£o precisa pensar em excluir esses objetos intermedi√°rios e nem precisa saber sobre a exist√™ncia deles!  A piada √© que essas opera√ß√µes s√£o executadas relativamente rapidamente e voc√™ n√£o saberia sobre elas at√© aquele momento. <br><br>  Os criadores do Python sabiamente perceberam essa sobrecarga e decidiram fazer v√°rias otimiza√ß√µes.  O resultado √© um comportamento que pode surpreender os iniciantes: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = <span class="hljs-number"><span class="hljs-number">20</span></span> &gt;&gt;&gt; y = <span class="hljs-number"><span class="hljs-number">19</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> &gt;&gt;&gt; x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Neste exemplo, o c√≥digo √© quase o mesmo que acima, exceto que obtemos <code>True</code> .  √â tudo sobre objetos internados.  O Python pr√©-cria um subconjunto espec√≠fico de objetos na mem√≥ria e os armazena no espa√ßo de nomes global para uso di√°rio. <br><br>  Quais objetos dependem da implementa√ß√£o do Python?  No CPython 3.7, os internos s√£o: <br><br><ol><li>  Inteiros que variam de <code>-5</code> a <code>256</code> . <br></li><li>  Sequ√™ncias contendo apenas letras ASCII, n√∫meros ou sublinhados. <br></li></ol><br>  Isso ocorre porque essas vari√°veis ‚Äã‚Äãs√£o frequentemente usadas em muitos programas.  Internando, o Python impede a aloca√ß√£o de mem√≥ria para objetos persistentes. <br><br>  Linhas com tamanho inferior a 20 caracteres e contendo letras, n√∫meros ou sublinhados ASCII ser√£o internadas porque devem ser usadas como identificadores: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>s1 = <span class="hljs-string"><span class="hljs-string">"realpython"</span></span> &gt;&gt;&gt; id(s1) <span class="hljs-number"><span class="hljs-number">140696485006960</span></span> &gt;&gt;&gt; s2 = <span class="hljs-string"><span class="hljs-string">"realpython"</span></span> &gt;&gt;&gt; id(s2) <span class="hljs-number"><span class="hljs-number">140696485006960</span></span> &gt;&gt;&gt; s1 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> s2 <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Aqui <code>s1</code> e <code>s2</code> apontam para o mesmo endere√ßo na mem√≥ria.  Se n√£o inserirmos uma letra, n√∫mero ou sublinhado ASCII, obteremos um resultado diferente: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>s1 = <span class="hljs-string"><span class="hljs-string">"Real Python!"</span></span> &gt;&gt;&gt; s2 = <span class="hljs-string"><span class="hljs-string">"Real Python!"</span></span> &gt;&gt;&gt; s1 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> s2 <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br>  Este exemplo usa um ponto de exclama√ß√£o, portanto, as seq√º√™ncias de caracteres n√£o s√£o internadas e s√£o objetos diferentes na mem√≥ria. <br><br>  <b>B√¥nus</b> : se voc√™ deseja que esses objetos se refiram ao mesmo objeto interno, voc√™ pode usar <code>sys.intern()</code> .  Uma maneira de usar esse recurso √© descrita na documenta√ß√£o: <br><br><blockquote>  A interna√ß√£o de strings √© √∫til para um ligeiro aumento no desempenho da pesquisa no dicion√°rio: se as chaves no dicion√°rio e a chave a serem pesquisadas forem internadas, a compara√ß√£o de chaves (ap√≥s o hash) pode ser feita comparando ponteiros em vez de strings.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fonte</a> ) </blockquote><br>  Os internos frequentemente confundem os programadores.  Lembre-se de que, se voc√™ come√ßar a duvidar, sempre poder√° usar <code>id()</code> e determinar a equival√™ncia dos objetos. <br><br><h2>  Emula√ß√£o de ponteiro Python </h2><br>  O fato de os ponteiros estarem ausentes nativamente no Python n√£o significa que voc√™ n√£o pode tirar proveito dos ponteiros.  Na verdade, existem v√°rias maneiras de emular ponteiros no Python.  Aqui n√≥s olhamos para dois deles: <br><br><ol><li>  Use como ponteiros para tipos mut√°veis. <br></li><li>  Usando objetos Python especialmente preparados. <br></li></ol><br><h3>  Use como ponteiros do tipo mut√°vel </h3><br>  Voc√™ j√° sabe o que s√£o tipos mut√°veis.  √â gra√ßas √† sua mutabilidade que podemos imitar o comportamento dos ponteiros.  Digamos que voc√™ precise replicar este c√≥digo: <br><br><pre> <code class="python hljs">void add_one(int *x) { *x += <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br>  Este c√≥digo leva um ponteiro para um n√∫mero ( <code>*x</code> ) e incrementa o valor em 1. Aqui est√° a fun√ß√£o principal para executar o c√≥digo: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#include &lt;stdi.h&gt; int main(void) { int y = 2337; printf("y = %d\n", y); add_one(&amp;y); printf("y = %d\n", y); return 0; }</span></span></code> </pre> <br>  No fragmento acima, atribu√≠mos <code>y</code> a <code>2337</code> , <code>2337</code> o valor atual, aumentamos em 1 e depois exibimos um novo valor.  O seguinte aparece na tela: <br><br><pre> <code class="python hljs">y = <span class="hljs-number"><span class="hljs-number">2337</span></span> y = <span class="hljs-number"><span class="hljs-number">2338</span></span></code> </pre> <br>  Uma maneira de replicar esse comportamento no Python √© usar um tipo mut√°vel.  Por exemplo, aplique uma lista e altere o primeiro elemento: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_one</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> ... x[<span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span> ... &gt;&gt;&gt; y = [<span class="hljs-number"><span class="hljs-number">2337</span></span>] &gt;&gt;&gt; add_one(y) &gt;&gt;&gt; y[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-number"><span class="hljs-number">2338</span></span></code> </pre> <br>  Aqui <code>add_one(x)</code> se refere ao primeiro elemento e aumenta seu valor em 1. O uso da lista significa que, como resultado, obtemos o valor alterado.  Ent√£o, existem indicadores em Python?  N√£o.  O comportamento descrito tornou-se poss√≠vel porque a lista √© do tipo mut√°vel.  Se voc√™ tentar usar uma tupla, voc√™ receber√° um erro: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>z = (<span class="hljs-number"><span class="hljs-number">2337</span></span>,) &gt;&gt;&gt; add_one(z)</code> </pre> <br>  Rastreamento de retorno (as chamadas mais recentes duram por √∫ltimo): <br><br><pre> <code class="python hljs"> File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> add_one TypeError: <span class="hljs-string"><span class="hljs-string">'tuple'</span></span> object does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support item assignment</code> </pre> <br>  Este c√≥digo demonstra a imutabilidade da tupla, portanto, n√£o suporta a atribui√ß√£o de elementos. <br><br>  <code>list</code> n√£o <code>list</code> o √∫nico tipo mut√°vel; ponteiros de pe√ßas tamb√©m s√£o emulados usando <code>dict</code> . <br><br>  Suponha que voc√™ tenha um aplicativo que rastreie a ocorr√™ncia de eventos interessantes.  Isso pode ser feito criando um dicion√°rio e usando um de seus elementos como um contador: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>counters = {<span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>} &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... counters[<span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span> ... &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... counters[<span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span> ... bar() ... &gt;&gt;&gt; foo() &gt;&gt;&gt; counters[<span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>] <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  Neste exemplo, o dicion√°rio usa contadores para rastrear o n√∫mero de chamadas de fun√ß√£o.  Ap√≥s chamar <code>foo()</code> contador aumentou 2, conforme o esperado.  E tudo gra√ßas √† <code>dict</code> . <br><br>  N√£o se esque√ßa, isso √© apenas uma <b>emula√ß√£o</b> do comportamento do ponteiro, n√£o tem nada a ver com ponteiros reais em C e C ++.  Podemos dizer que essas opera√ß√µes s√£o mais caras do que se fossem executadas em C ou C ++. <br><br><h3>  Usando objetos Python </h3><br>  <code>dict</code> √© uma √≥tima maneira de emular ponteiros em Python, mas √†s vezes √© entediante lembrar qual nome de chave voc√™ usou.  Especialmente se voc√™ usar o dicion√°rio em diferentes partes do aplicativo.  Uma classe Python personalizada pode ajudar aqui. <br><br>  Digamos que voc√™ precise acompanhar as m√©tricas em um aplicativo.  Uma √≥tima maneira de ignorar detalhes irritantes √© criar uma classe: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Metrics</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self._metrics = { <span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"cat_pictures_served"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, }</code> </pre> <br>  Este c√≥digo define a classe <code>Metrics</code> .  Ele ainda usa o dicion√°rio para armazenar dados atualizados que est√£o na <code>_metrics</code> membro <code>_metrics</code> .  Isso lhe dar√° a mutabilidade necess√°ria.  Agora voc√™ s√≥ precisa acessar esses valores.  Voc√™ pode fazer isso usando as propriedades: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Metrics</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># ... @property def func_calls(self): return self._metrics["func_calls"] @property def cat_pictures_served(self): return self._metrics["cat_pictures_served"]</span></span></code> </pre> <br>  Aqui usamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@property</a> .  Se voc√™ √© iniciante em decoradores, leia o artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Primer on Python Decorators</a> .  Nesse caso, o decorador <code>@property</code> permite acessar <code>func_calls</code> e <code>cat_pictures_served</code> , como se fossem atributos: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>metrics = Metrics() &gt;&gt;&gt; metrics.func_calls <span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt; metrics.cat_pictures_served <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  O fato de voc√™ poder se referir a esses nomes como atributos significa que voc√™ √© abstra√≠do do fato de que esses valores s√£o armazenados no dicion√°rio.  Al√©m disso, voc√™ torna os nomes dos atributos mais expl√≠citos.  Obviamente, voc√™ deve poder aumentar os valores: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Metrics</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># ... def inc_func_calls(self): self._metrics["func_calls"] += 1 def inc_cat_pics(self): self._metrics["cat_pictures_served"] += 1</span></span></code> </pre> <br>     : <br><br><ol><li> <code>inc_func_calls()</code> </li> <li> <code>inc_cat_pics()</code> </li> </ol><br>      <code>metrics</code> .     ,     ,   : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>metrics = Metrics() &gt;&gt;&gt; metrics.inc_func_calls() &gt;&gt;&gt; metrics.inc_func_calls() &gt;&gt;&gt; metrics.func_calls <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>     <code>func_calls</code>   <code>inc_func_calls()</code>         Python.    ,     -  <code>metrics</code> ,          . <br><br> <b></b> :   ,   <code>inc_func_calls()</code>  <code>inc_cat_pics()</code>   <code>@property.setter</code>        <code>int</code> ,     . <br><br>      <code>Metrics</code> : <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Metrics</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self._metrics = { <span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"cat_pictures_served"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, } @property <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func_calls</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._metrics[<span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>] @property <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cat_pictures_served</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._metrics[<span class="hljs-string"><span class="hljs-string">"cat_pictures_served"</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc_func_calls</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self._metrics[<span class="hljs-string"><span class="hljs-string">"func_calls"</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc_cat_pics</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self._metrics[<span class="hljs-string"><span class="hljs-string">"cat_pictures_served"</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><h2>     ctypes </h2><br>  , -    Python,   CPython?     ctypes    ,   C.      ctypes,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Extending Python With C Libraries and the ¬´ctypes¬ª Module</a> . <br><br>       ,     ,   .     - <code>add_one()</code> : <br><br><pre> <code class="python hljs">void add_one(int *x) { *x += <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br> ,      <code>x</code>  1.   ,      (shared) .  ,      <code>add.c</code> ,      gcc: <br><br><pre> <code class="python hljs">$ gcc -c -Wall -Werror -fpic add.c $ gcc -shared -o libadd1.so add.o</code> </pre> <br>      C   <code>add.o</code> .           <code>libadd1.so</code> . <br><br> <code>libadd1.so</code>      .    ctypes    Python: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ctypes &gt;&gt;&gt; add_lib = ctypes.CDLL(<span class="hljs-string"><span class="hljs-string">"./libadd1.so"</span></span>) &gt;&gt;&gt; add_lib.add_one &lt;_FuncPtr object at <span class="hljs-number"><span class="hljs-number">0x7f9f3b8852a0</span></span>&gt;</code> </pre> <br>  ctypes.CDLL  ,     <code>libadd1</code> .      <code>add_one()</code> ,      ,        Python-.     ,    .  Python  ,      . <br><br>         , ctypes       : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>add_one = add_lib.add_one &gt;&gt;&gt; add_one.argtypes = [ctypes.POINTER(ctypes.c_int)]</code> </pre> <br>     ,    C. ,        ,       : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>add_one(<span class="hljs-number"><span class="hljs-number">1</span></span>) Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; ctypes.ArgumentError: argument <span class="hljs-number"><span class="hljs-number">1</span></span>: &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TypeError</span></span></span><span class="hljs-class">'&gt;:</span></span> \ expected LP_c_int instance instead of int</code> </pre> <br> Python    ,  <code>add_one()</code>   ,     .  ,  ctypes      .       : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>x = ctypes.c_int() &gt;&gt;&gt; x c_int(<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>      <code>x</code>   <code>0</code> . ctypes    <code>byref()</code> ,      . <br><br> <b></b> :  <b> </b>     <b> </b> . <br><br>          ,       .         ,        . <br><br>   <code>add_one()</code>    : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>add_one(ctypes.byref(x)) <span class="hljs-number"><span class="hljs-number">998793640</span></span> &gt;&gt;&gt; x c_int(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  √ìtimo!     1. ,     Python  . <br><br><h2>  Conclus√£o </h2><br>        Python  .          ,              Python. <br><br>         Python: <br><br><ul><li>          . <br></li><li>   Python-   . <br></li><li>       ctypes. <br></li></ul><br>       Python       . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt454324/">https://habr.com/ru/post/pt454324/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt454314/index.html">10 princ√≠pios da programa√ß√£o orientada a objetos que todo desenvolvedor deve conhecer</a></li>
<li><a href="../pt454316/index.html">Seguindo os passos do ninja industrial: convidamos voc√™ a participar da competi√ß√£o on-line de seguran√ßa industrial</a></li>
<li><a href="../pt454318/index.html">Soando o passado. Um guia para historiadores sobre a convers√£o de dados em som</a></li>
<li><a href="../pt454320/index.html">Analistas do mercado de trabalho e cientistas de dados</a></li>
<li><a href="../pt454322/index.html">Alguns dizem que a tecnologia DANE para navegadores falhou</a></li>
<li><a href="../pt454326/index.html">Al√©m de Moore - quem mais formulou as leis de dimensionamento de sistemas de computador</a></li>
<li><a href="../pt454330/index.html">10 destaques do TechTrain 2018: IA para massas, interfaces e muito mais</a></li>
<li><a href="../pt454332/index.html">Como o bot do Telegram superou a procrastina√ß√£o de designers e ajudou a aumentar a receita das ag√™ncias digitais</a></li>
<li><a href="../pt454334/index.html">Moto. Weep AWS</a></li>
<li><a href="../pt454336/index.html">Cliente: - Quanto custa uma c√≥pia do Facebook?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>