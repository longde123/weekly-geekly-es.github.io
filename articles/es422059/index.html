<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüç≥ üë©üèø‚Äçü§ù‚Äçüë©üèæ „Ä∞Ô∏è Descargar datos en Excel. Civilizado ‚ò†Ô∏è üêè ü§≥üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hay tareas en la industria de TI que, en el contexto de los √©xitos en big data , aprendizaje autom√°tico , blockchain y otras tendencias de la moda, pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Descargar datos en Excel. Civilizado</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422059/"> Hay tareas en la industria de TI que, en el contexto de los √©xitos en <i>big data</i> , <i>aprendizaje autom√°tico</i> , <i>blockchain</i> y otras tendencias de la moda, parecen completamente poco atractivas, pero durante d√©cadas no han dejado de ser relevantes para todo un ej√©rcito de desarrolladores.  Se tratar√° de lo antiguo como la tarea mundial de crear y cargar documentos de Excel, que enfrentaron todos los que alguna vez han escrito solicitudes para negocios. <br><br><img src="https://habrastorage.org/webt/xt/rq/6o/xtrq6o6vsy-0gtbrnuudywnnohs.png"><br><br><a name="habracut"></a><br><br>  ¬øQu√© posibilidades de construir archivos Excel existen en principio? <br><br><ol><li>  VBA macros.  Hoy en d√≠a, por razones de seguridad, la idea de usar macros a menudo no es adecuada. </li><li>  Automatizaci√≥n de Excel con un programa externo a trav√©s de la API.  Requiere Excel en la misma m√°quina que el programa que genera informes de Excel.  En un momento en que los clientes eran gruesos y estaban escritos en forma de aplicaciones de escritorio de Windows, este m√©todo era adecuado (aunque no difer√≠a en velocidad y confiabilidad), en las realidades actuales, este es un caso dif√≠cil de lograr. </li><li>  Generar archivo XML-Excel directamente.  Como ya sabe, Excel admite el formato XML para guardar un documento, que potencialmente puede generarse / modificarse utilizando cualquier medio de trabajo con XML.  Este archivo se puede guardar con la extensi√≥n .xls, y aunque, estrictamente hablando, no es un archivo xls, Excel lo abre bien.  Este enfoque es bastante popular, pero las desventajas incluyen el hecho de que cualquier soluci√≥n basada en la edici√≥n directa del formato XML-Excel es un "hack" √∫nico que carece de generalidad. </li><li>  Finalmente, es posible generar archivos de Excel usando bibliotecas de c√≥digo abierto, de las cuales <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Apache POI</a> es especialmente conocido.  Los desarrolladores de Apache POI han realizado un trabajo tit√°nico en los formatos de documentos binarios de MS Office de ingenier√≠a inversa, y contin√∫an manteniendo y desarrollando esta biblioteca a lo largo de los a√±os.  El resultado de esta ingenier√≠a inversa, por ejemplo, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">utiliza</a> en Open Office para implementar la preservaci√≥n de documentos en formatos compatibles con MS Office. </li></ol><br>  En mi opini√≥n, es el √∫ltimo de los m√©todos que ahora se prefiere para generar documentos compatibles con MS Office.  Por un lado, no requiere la instalaci√≥n de ning√∫n software propietario en el servidor, y por otro lado, proporciona una API rica que le permite utilizar todas las funcionalidades de MS Office. <br><br>  Pero el uso directo de Apache POI tiene sus inconvenientes.  En primer lugar, esta es una biblioteca Java, y si su aplicaci√≥n est√° escrita en m√°s de uno de los lenguajes JVM, dif√≠cilmente podr√° usarla.  En segundo lugar, es una biblioteca de bajo nivel que funciona con conceptos como "celda", "columna", "fuente".  Por lo tanto, "frente" al procedimiento escrito para generar un documento se convierte r√°pidamente en un abundante "fideo" de c√≥digo dif√≠cil de leer, donde no hay separaci√≥n en un modelo de datos y presentaci√≥n, es dif√≠cil hacer cambios y, en general, dolor y verg√ºenza.  Y una excelente ocasi√≥n para delegar la tarea al programador m√°s inexperto: d√©jelo elegir. <br><br>  Pero podr√≠a ser completamente diferente.  El proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Xil√≥fono</a> bajo LGPL, construido sobre la base de Apache POI, se basa en una idea que tiene una historia estimada de 15 a√±os.  En los proyectos donde particip√©, se us√≥ en combinaci√≥n con una amplia variedad de plataformas e idiomas, y, debido a la variedad de formularios realizados con su ayuda en una amplia variedad de proyectos, probablemente ya haya miles.  Este es un proyecto de Java que puede funcionar como una utilidad de l√≠nea de comandos y como una biblioteca (si tiene c√≥digo en el lenguaje JVM, puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conectarlo</a> como una dependencia de Maven). <br><br>  Xil√≥fono implementa el principio de separar el modelo de datos de su presentaci√≥n.  En el procedimiento de carga, debe generar datos en formato XML (sin preocuparse por las celdas, las fuentes y las l√≠neas divisorias), y Xil√≥fono, utilizando una plantilla de Excel y un descriptor que describe c√≥mo rastrear su archivo XML con datos, generar√° el resultado, como se muestra en el diagrama: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cg/6i/3l/cg6i3loswycjyokw8_dujjzlb_m.png" width="400"></div><br>  La plantilla del documento (plantilla xls / xlsx) se ve as√≠: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2d/kg/gr/2dkggrfyq2b8se-dtfrtx6lwcje.png"></div><br>  Como regla general, el cliente proporciona la adquisici√≥n de dicha plantilla.  El cliente involucrado est√° feliz de participar en la creaci√≥n de la plantilla: comenzando por elegir la forma correcta del "Consultor" o inventando una desde cero, y terminando con el tama√±o de fuente y el ancho de las l√≠neas divisorias.  La ventaja de la plantilla es que es f√°cil realizar modificaciones menores, incluso cuando el informe est√° completamente desarrollado. <br><br>  Cuando se realiza el trabajo de "dise√±o", el desarrollador permanece <br><br><ol><li>  Cree un procedimiento para descargar los datos necesarios en formato XML. </li><li>  Cree un descriptor que describa el procedimiento para atravesar elementos de un archivo XML y copiar fragmentos de plantilla en el informe resultante </li><li>  Enlace celdas de plantilla a elementos de un archivo XML utilizando expresiones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">XPath</a> . </li></ol><br>  Con la carga a XML, todo est√° m√°s o menos claro: simplemente seleccione la representaci√≥n XML adecuada de los datos necesarios para completar el formulario.  ¬øQu√© es un descriptor? <br><br>  Si el formulario que estamos creando no tiene elementos duplicados con diferentes n√∫meros (como l√≠neas de factura, que son diferentes en diferentes facturas), el descriptor se ver√≠a as√≠: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"root"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A1:Z100"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Aqu√≠, ra√≠z es el nombre del elemento ra√≠z de nuestro archivo de datos XML, y el rango A1: Z100 es el rango rectangular de celdas de la plantilla que se copiar√° al resultado.  Adem√°s, como se puede ver en la ilustraci√≥n anterior, los campos comod√≠n cuyos valores se reemplazan con datos de un archivo XML tienen el formato <code>~{XPath-}</code> (tilde, corchete, expresi√≥n XPath relativa al elemento XML actual, cerrando el corchete). <br><br>  ¬øQu√© pasa si necesitamos elementos repetidos en el informe?  Naturalmente, se pueden representar como elementos de un archivo de datos XML, y un descriptor ayuda a ayudarlo a encontrarlo de la manera correcta.  La repetici√≥n de elementos en el informe puede tener una direcci√≥n vertical (cuando insertamos l√≠neas de factura, por ejemplo) y horizontal (cuando insertamos columnas del informe anal√≠tico).  Al mismo tiempo, podemos usar la anidaci√≥n de elementos XML para reflejar la anidaci√≥n arbitrariamente profunda de elementos de informe repetidos, como se muestra en el diagrama: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/up/tz/sf/uptzsfb1elgxvrd9od7ixm6v2uy.png" width="300"></div><br>  Los cuadrados rojos marcan las celdas que ser√°n la esquina superior izquierda del siguiente fragmento rectangular que el generador de informes est√° acoplando. <br><br>  Hay otra opci√≥n posible para repetir elementos: hojas en un libro de Excel.  La capacidad de organizar tal iteraci√≥n tambi√©n est√° disponible. <br><br>  Considere un ejemplo un poco m√°s complejo.  Supongamos que necesitamos obtener un informe resumido como el siguiente: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sh/hm/j5/shhmj5ii0ptbgqaplyyu6iigiak.png" width="400"></div><br>  Deje que el usuario seleccione el rango de a√±os para la descarga, por lo tanto, tanto las filas como las columnas se crean din√°micamente en este informe.  La representaci√≥n XML de los datos para dicho informe podr√≠a verse as√≠: <br><br><div class="spoiler">  <b class="spoiler_title">testdata.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">report</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">year</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2016"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">year</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2017"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">year</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"365"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"286"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"207"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 2"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"95"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"606"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"840"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"710"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"437"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">totals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1170"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1329"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1147"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">totals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">report</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Somos libres de elegir los nombres de las etiquetas a su gusto, la estructura tambi√©n puede ser arbitraria, pero teniendo en cuenta la facilidad de conversi√≥n al informe.  Por ejemplo, generalmente escribo los valores que se muestran en la hoja en atributos, porque simplifica las expresiones XPath (es conveniente cuando se parecen a <code>@</code> ). <br><br>  La plantilla para dicho informe se ver√° as√≠ (compare las expresiones XPath con los nombres de los atributos de las etiquetas correspondientes): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x1/h0/dy/x1h0dyu0c10ywyjxx8kwajxrsnu.png" width="300"></div><br>  Ahora viene la parte m√°s interesante: crear un identificador.  Dado que este es un informe casi completamente ensamblado din√°micamente, el descriptor es bastante complicado, en la pr√°ctica (cuando solo tenemos un "encabezado" del documento, sus l√≠neas y "pie de p√°gina") todo es generalmente mucho m√°s simple.  Aqu√≠ est√° el descriptor necesario en este caso: <br><br><div class="spoiler">  <b class="spoiler_title">descriptor.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"report"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">worksheet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sourcesheet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(before)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"column"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"B1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  :     ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    -   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(before)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"B2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"totals"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(before)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A3"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"B3"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Los elementos descriptores completos se describen en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> .  En resumen, los elementos b√°sicos de un descriptor significan lo siguiente: <br><br><ul><li>  <b>element</b> : transici√≥n al modo de lectura de un elemento de un archivo XML.  Puede ser el elemento ra√≠z del descriptor o estar dentro de la <code>iteration</code> .  El atributo de <code>name</code> se puede usar para establecer varios filtros para elementos, por ejemplo <ul><li>  <code>name="foo"</code> - elementos con la etiqueta name foo </li><li>  <code>name="*"</code> - todos los elementos </li><li>  <code>name="tagname[@attribute='value']"</code> : elementos con un nombre y un valor de atributo espec√≠ficos </li><li>  <code>name="(before)"</code> , <code>name="(after)"</code> - Elementos "virtuales" que preceden a la iteraci√≥n y cierran la iteraci√≥n. </li></ul></li><li>  <b>iteraci√≥n</b> : transici√≥n al modo de iteraci√≥n.  Solo puede estar dentro del <code>element</code> .  Se pueden configurar varios par√°metros, p. <ul><li>  <code>mode="horizontal"</code> - modo de salida <code>mode="horizontal"</code> (vertical por defecto) </li><li>  <code>index=0</code> - restringe la iteraci√≥n al primer elemento encontrado </li></ul></li><li>  <b>salida</b> - cambia al modo de salida.  Los atributos principales son los siguientes: <ul><li>  hoja de origen: la hoja de libro de plantilla de la que se toma el rango de salida.  Si no se especifica, se aplica la hoja actual (la √∫ltima utilizada). </li><li>  <code>range</code> : el rango de la plantilla que se copiar√° en el documento resultante, por ejemplo, ‚ÄúA1: M10‚Äù, ‚Äú5: 6‚Äù o ‚ÄúC: C‚Äù.  (El uso de rangos de fila de tipo ‚Äú5: 6‚Äù en el modo de salida horizontal y rangos de columna de tipo ‚ÄúC: C‚Äù en el modo de salida vertical provocar√° un error). </li><li>  <code>worksheet</code> : si se define, se crea una nueva hoja en el archivo de salida y la posici√≥n de salida se desplaza a la celda A1 de esta hoja.  El valor de este atributo, igual a una expresi√≥n constante o XPath, se sustituye en el nombre de la nueva hoja. </li></ul></li></ul><br>  En realidad, hay muchas m√°s opciones en el descriptor, consulte la documentaci√≥n. <br><br>  Bueno, ahora es el momento de descargar Xil√≥fono y comenzar a informar. <br>  Tome el archivo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bintray</a> o <a href="">Maven Central</a> (Nota: en el momento de leer este art√≠culo, son posibles versiones m√°s recientes).  En la carpeta / bin hay un script de shell, cuando lo ejecuta sin par√°metros, ver√° un mensaje sobre los par√°metros de la l√≠nea de comandos.  Para obtener el resultado, necesitamos "alimentar" al xil√≥fono todos los ingredientes previamente preparados: <br><br><pre> <code class="bash hljs">xylophone -data testdata.xml -template template.xlsx -descr descriptor.xml -out report.xlsx</code> </pre><br>  Abra el archivo report.xlsx y aseg√∫rese de obtener exactamente lo que necesitamos: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sh/hm/j5/shhmj5ii0ptbgqaplyyu6iigiak.png" width="400"></div><br>  Dado que la biblioteca ru.curs: xylophone <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">est√° disponible</a> en Maven Central bajo la licencia LGPL, se puede usar sin problemas en programas en cualquier lenguaje JVM.  Quiz√°s el ejemplo m√°s compacto y totalmente funcional se obtiene en Groovy, el c√≥digo no necesita comentarios: <br><br><pre> <code class="plaintext hljs">@Grab('ru.curs:xylophone:6.1.3') import ru.curs.xylophone.XML2Spreadsheet baseDir = '.' new File(baseDir, 'testdata.xml').withInputStream { input -&gt; new File(baseDir, 'report.xlsx').withOutputStream { output -&gt; XML2Spreadsheet.process(input, new File(baseDir, 'descriptor.xml'), new File(baseDir, 'template.xlsx'), false, output) } } println 'Done.'</code> </pre><br>  La clase <code>XML2Spreadsheet</code> tiene varias versiones sobrecargadas del m√©todo de <code>process</code> est√°tico, pero todas se reducen a la transferencia de los mismos "ingredientes" necesarios para preparar el informe. <br><br>  Una opci√≥n importante que a√∫n no he mencionado es la capacidad de elegir entre analizadores DOM y SAX en la etapa de analizar un archivo con datos XML.  Como sabe, el analizador DOM carga todo el archivo en la memoria, construye su representaci√≥n de objetos y hace posible omitir su contenido de forma arbitraria (incluido el regreso repetido al mismo elemento).  El analizador SAX nunca guarda todo el archivo de datos en la memoria, sino que lo procesa como un "flujo" de elementos, evitando que vuelva al elemento nuevamente. <br><br>  Usar el modo SAX en Xil√≥fono (a trav√©s de la <code>-sax</code> l√≠nea de comandos <code>-sax</code> o establecer el par√°metro <code>useSax</code> m√©todo <code>useSax</code> en <code>XML2Spreadsheet.process</code> ) puede ser cr√≠ticamente √∫til cuando necesita generar archivos muy grandes.  Debido a la velocidad y rentabilidad de los recursos del analizador SAX, la velocidad de generaci√≥n de archivos aumenta muchas veces.  Esto se da a costa de algunas peque√±as restricciones en el descriptor (descrito en la documentaci√≥n), pero en la mayor√≠a de los casos los informes satisfacen estas restricciones, por lo que recomendar√≠a usar el modo SAX siempre que sea posible. <br><br>  Espero que les haya gustado el m√©todo de carga en Excel a trav√©s del Xil√≥fono y que les ahorre mucho tiempo y nervios, como nos salv√≥. <br><br>  Y finalmente, enlaces de nuevo: <br><br><ul><li>  las fuentes est√°n aqu√≠: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github.com/CourseOrchestra/xylophone</a> </li><li>  la documentaci√≥n est√° aqu√≠: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">courseorchestra.github.io/xylophone</a> </li><li>  Todos los ejemplos de c√≥digo de este art√≠culo est√°n aqu√≠: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github.com/inponomarev/xylophone-example</a> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422059/">https://habr.com/ru/post/es422059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422047/index.html">El misterio del enigma en la "Uni√≥n"</a></li>
<li><a href="../es422049/index.html">Manejo de errores en Go 2</a></li>
<li><a href="../es422051/index.html">Probar la creaci√≥n de una biblioteca de componentes para Angular usando el nuevo comando para Angular / Cli - library</a></li>
<li><a href="../es422053/index.html">ESP8266 + FLProg: creaci√≥n de una interfaz de configuraci√≥n basada en web</a></li>
<li><a href="../es422057/index.html">Investigaci√≥n: Java es el lenguaje m√°s popular en la nube: qui√©n lo usa y por qu√©</a></li>
<li><a href="../es422061/index.html">Servidor compacto con recarga de c√≥digo configurada y registros de SQL por un equipo de Maven para un desarrollo productivo</a></li>
<li><a href="../es422069/index.html">PHP Digest No. 138 (20 de agosto - 2 de septiembre de 2018)</a></li>
<li><a href="../es422071/index.html">Suficiente para todos, o c√≥mo entregar Internet a los pa√≠ses en desarrollo.</a></li>
<li><a href="../es422073/index.html">La forma m√°s f√°cil de admitir la integraci√≥n de un cliente java con un servidor java</a></li>
<li><a href="../es422077/index.html">¬øEs relevante la inyecci√≥n de JavaScript?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>