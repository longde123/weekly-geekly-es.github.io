<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â›“ï¸ ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ¯ Hyperledger Fabricæ™ºèƒ½åˆçº¦å¼€å‘å’Œæµ‹è¯• ğŸ”— ğŸ“¼ ğŸ¥¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hyperledger Fabricï¼ˆHLFï¼‰æ˜¯ä¸€ä¸ªä½¿ç”¨åˆ†å¸ƒå¼åˆ†ç±»å¸æŠ€æœ¯ï¼ˆDLTï¼‰çš„å¼€æºå¹³å°ï¼Œæ—¨åœ¨å¼€å‘å¯åœ¨ç”±ç»„ç»‡å›¢ä½“ä½¿ç”¨è®¿é—®è§„åˆ™ï¼ˆå…è®¸ï¼‰åˆ›å»ºå’Œæ§åˆ¶çš„å•†ä¸šç½‘ç»œç¯å¢ƒä¸­å·¥ä½œçš„åº”ç”¨ç¨‹åºã€‚ 


 è¯¥å¹³å°ä»¥HLFæœ¯è¯­æ”¯æŒæ™ºèƒ½åˆçº¦-ä»¥é€šç”¨è¯­è¨€ï¼ˆä¾‹å¦‚Golangï¼ŒJavaScriptï¼ŒJavaï¼‰åˆ›å»ºçš„é“¾ä»£ç ï¼Œä¸ä»¥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hyperledger Fabricæ™ºèƒ½åˆçº¦å¼€å‘å’Œæµ‹è¯•</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426705/"><p>  Hyperledger Fabricï¼ˆHLFï¼‰æ˜¯ä¸€ä¸ªä½¿ç”¨åˆ†å¸ƒå¼åˆ†ç±»å¸æŠ€æœ¯ï¼ˆDLTï¼‰çš„å¼€æºå¹³å°ï¼Œæ—¨åœ¨å¼€å‘å¯åœ¨ç”±ç»„ç»‡å›¢ä½“ä½¿ç”¨è®¿é—®è§„åˆ™ï¼ˆå…è®¸ï¼‰åˆ›å»ºå’Œæ§åˆ¶çš„å•†ä¸šç½‘ç»œç¯å¢ƒä¸­å·¥ä½œçš„åº”ç”¨ç¨‹åºã€‚ </p><br><p> è¯¥å¹³å°ä»¥HLFæœ¯è¯­æ”¯æŒæ™ºèƒ½åˆçº¦-ä»¥é€šç”¨è¯­è¨€ï¼ˆä¾‹å¦‚Golangï¼ŒJavaScriptï¼ŒJavaï¼‰åˆ›å»ºçš„é“¾ä»£ç ï¼Œä¸ä»¥å¤ªåŠä¸åŒï¼Œä¾‹å¦‚ä»¥å¤ªåŠä½¿ç”¨ä»¥é¢å‘åˆåŒçš„æœ‰é™åŠŸèƒ½çš„Solidityè¯­è¨€ï¼ˆLLLï¼ŒViperç­‰ï¼‰ã€‚ </p><br><p><img src="https://habrastorage.org/webt/w4/em/ps/w4empss606_8k1h8tvkcmfim4c8.png"></p><br><p> ç”±äºéœ€è¦éƒ¨ç½²å¤§é‡çš„åŒºå—é“¾ç½‘ç»œç»„ä»¶ï¼Œå› æ­¤é“¾ä»£ç çš„å¼€å‘å’Œæµ‹è¯•å¯èƒ½æ˜¯ä¸€ä¸ªç›¸å½“æ¼«é•¿çš„è¿‡ç¨‹ï¼Œéœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´æ¥æµ‹è¯•æ›´æ”¹ã€‚ æœ¬æ–‡è®¨è®ºäº†ä¸€ç§ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CCKit</a>åº“å¿«é€Ÿå¼€å‘å’Œæµ‹è¯•HLF Golangæ™ºèƒ½åˆçº¦çš„æ–¹æ³•ã€‚ </p><a name="habracut"></a><br><h2 id="prilozhenie-na-baze-hlf"> åŸºäºHLFçš„åº”ç”¨ </h2><br><p> ä»å¼€å‘äººå‘˜çš„è§’åº¦æ¥çœ‹ï¼ŒåŒºå—é“¾åº”ç”¨ç¨‹åºåŒ…å«ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š </p><br><ul><li>  <strong>é“¾ä¸Š</strong> -åœ¨åŒºå—é“¾ç½‘ç»œçš„éš”ç¦»ç¯å¢ƒä¸­è¿è¡Œçš„æ™ºèƒ½åˆçº¦ï¼ˆç¨‹åºï¼‰ï¼Œç”¨äºç¡®å®šåˆ›å»ºè§„åˆ™å’Œäº¤æ˜“å±æ€§çš„ç»„æˆã€‚ åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œä¸»è¦åŠ¨ä½œæ˜¯ä»åŒºå—é“¾ç½‘ç»œçŠ¶æ€è¯»å–ï¼Œæ›´æ–°å’Œåˆ é™¤æ•°æ®ã€‚ åº”è¯¥å¼ºè°ƒçš„æ˜¯ï¼Œä»çŠ¶æ€ä¸­åˆ é™¤æ•°æ®ä¼šç•™ä¸‹è¯¥æ•°æ®å­˜åœ¨çš„ä¿¡æ¯ã€‚ </li><li>  <strong>è„±é“¾</strong>æ˜¯é€šè¿‡SDKä¸åŒºå—é“¾ç¯å¢ƒè¿›è¡Œäº¤äº’çš„åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ï¼ŒAPIï¼‰ã€‚ äº¤äº’è¢«ç†è§£ä¸ºè°ƒç”¨æ™ºèƒ½åˆçº¦åŠŸèƒ½å¹¶ç›‘è§†æ™ºèƒ½åˆçº¦äº‹ä»¶-å¤–éƒ¨äº‹ä»¶å¯ä»¥å¯¼è‡´æ™ºèƒ½åˆçº¦ä¸­çš„æ•°æ®æ›´æ”¹ï¼Œè€Œæ™ºèƒ½åˆçº¦ä¸­çš„äº‹ä»¶å¯ä»¥è§¦å‘å¤–éƒ¨ç³»ç»Ÿä¸­çš„æ“ä½œã€‚ </li></ul><br><p> é€šå¸¸é€šè¿‡â€œå®¶åº­â€åŒºå—é“¾ç½‘ç»œèŠ‚ç‚¹è¯»å–æ•°æ®ã€‚ ä¸ºäº†è®°å½•æ•°æ®ï¼Œåº”ç”¨ç¨‹åºå°†è¯·æ±‚å‘é€åˆ°å‚ä¸ç‰¹å®šæ™ºèƒ½åˆçº¦â€œæ‰¹å‡†ç­–ç•¥â€çš„ç»„ç»‡çš„èŠ‚ç‚¹ã€‚ </p><br><p> ä¸ºäº†å¼€å‘é“¾ä¸‹ä»£ç ï¼ˆAPIç­‰ï¼‰ï¼Œä½¿ç”¨äº†ä¸“ç”¨çš„SDKï¼Œè¯¥SDKå°è£…äº†ä¸åŒºå—é“¾èŠ‚ç‚¹çš„äº¤äº’ï¼Œæ”¶é›†å“åº”ç­‰ã€‚ å¯¹äºHLFï¼Œæœ‰ç”¨äºGoï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">1ï¼Œ2</a> ï¼‰ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Node.Js</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Javaçš„</a> SDKå®ç°ã€‚ </p><br><h2 id="komponenty-hyperledger-fabric">  Hyperledgeré¢æ–™ç»„ä»¶ </h2><br><h3 id="kanal"> é¢‘é“ </h3><br><p> é€šé“æ˜¯èŠ‚ç‚¹çš„å•ç‹¬å­ç½‘ï¼Œæ”¯æŒç‹¬ç«‹çš„åŒºå—é“¾ï¼ˆåˆ†ç±»å¸ï¼‰ä»¥åŠç”¨äºæ“ä½œæ™ºèƒ½åˆçº¦çš„åŒºå—é“¾çš„å½“å‰çŠ¶æ€ï¼ˆé”®å€¼ï¼‰ï¼ˆ <em>ä¸–ç•ŒçŠ¶æ€</em> ï¼‰ã€‚ ä¸»æœºå¯ä»¥è®¿é—®ä»»æ„æ•°é‡çš„é€šé“ã€‚ </p><br><h3 id="tranzakciya"> äº¤æ˜“é¢ </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Hyperledger Fabric</a>ä¸­çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº‹åŠ¡</a>æ˜¯å¯¹åŒºå—é“¾çŠ¶æ€çš„åŸå­æ›´æ–°ï¼Œå³æ‰§è¡Œchaincodeæ–¹æ³•çš„ç»“æœã€‚ äº‹åŠ¡åŒ…æ‹¬ä¸€ä¸ªè°ƒç”¨é“¾ç æ–¹æ³•çš„è¯·æ±‚ï¼Œè¯¥é“¾ä»£ç æ–¹æ³•å¸¦æœ‰ä¸€äº›ç”±è°ƒç”¨èŠ‚ç‚¹ç­¾åçš„å‚æ•°ï¼ˆäº‹åŠ¡æè®®ï¼‰ï¼Œä»¥åŠæ¥è‡ªåœ¨å…¶ä¸Šâ€œç¡®è®¤â€äº‹åŠ¡çš„èŠ‚ç‚¹çš„ä¸€ç»„å“åº”ï¼ˆäº‹åŠ¡æè®®å“åº”ï¼‰ï¼ˆè®¤å¯ï¼‰ã€‚ å“åº”åŒ…å«æœ‰å…³â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯»å†™é›†â€</a>å—é“¾çŠ¶æ€å˜åŒ–çš„é”®å€¼å¯¹çš„ä¿¡æ¯å’ŒæœåŠ¡ä¿¡æ¯ï¼ˆç¡®è®¤äº¤æ˜“çš„èŠ‚ç‚¹çš„ç­¾åå’Œè¯ä¹¦ï¼‰ã€‚ å› ä¸º å„ä¸ªé€šé“çš„å—é“¾åœ¨ç‰©ç†ä¸Šæ˜¯åˆ†å¼€çš„ï¼Œå› æ­¤åªèƒ½åœ¨ä¸€ä¸ªé€šé“çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œäº‹åŠ¡ã€‚ </p><br><p> è¯¸å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¯”ç‰¹å¸</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»¥å¤ªåŠä¹‹</a>ç±»çš„â€œç»å…¸â€ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŒºå—</a>é“¾å¹³å°ä½¿ç”¨ç”±æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œçš„è®¢è´­-æ‰§è¡Œäº¤æ˜“å‘¨æœŸï¼Œè¿™é™åˆ¶äº†åŒºå—é“¾ç½‘ç»œçš„å¯æ‰©å±•æ€§ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ad/-b/ud/ad-budtoazz80tcc2vcgmzyahve.png"></p><br><p>  Hyperledger Fabricä½¿ç”¨å…·æœ‰3ä¸ªä¸»è¦æ“ä½œçš„äº‹åŠ¡æ‰§è¡Œå’Œåˆ†å‘æ¶æ„ï¼š </p><br><ul><li><p> æ‰§è¡Œï¼ˆ <strong>æ‰§è¡Œ</strong> ï¼‰-é€šè¿‡åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªç½‘ç»œèŠ‚ç‚¹ä¸Šè¿è¡Œçš„æ™ºèƒ½åˆçº¦è¿›è¡Œåˆ›å»ºï¼Œäº¤æ˜“-åˆ†å¸ƒå¼æ³¨å†Œè¡¨çŠ¶æ€çš„åŸå­å˜åŒ–ï¼ˆ <em>è®¤å¯</em> ï¼‰ </p><br></li><li><p> æ’åº-ä¸“é—¨çš„è®¢è´­<em>è€…</em>æœåŠ¡ä½¿ç”¨å¯æ’å…¥å…±è¯†ç®—æ³•å°†äº¤æ˜“æ’åºå’Œåˆ†ç»„ä¸ºå—ã€‚ </p><br></li><li><p> éªŒè¯-ç”±ç½‘ç»œèŠ‚ç‚¹éªŒè¯æ¥è‡ª<em>è®¢è´­è€…</em>çš„äº¤æ˜“ï¼Œç„¶åå†å°†æ¥è‡ªå…¶çš„ä¿¡æ¯æ”¾å…¥å…¶åˆ†å¸ƒå¼æ³¨å†Œè¡¨ä¸­ </p><br></li></ul><br><p><img src="https://habrastorage.org/webt/xw/ss/xj/xwssxjcfyfmsydsfnyl4oey_coe.png"></p><br><p> è¿™ç§æ–¹æ³•å…è®¸æ‚¨åœ¨äº¤æ˜“æ‰§è¡Œé˜¶æ®µè¿›å…¥åŒºå—é“¾ç½‘ç»œä¹‹å‰æ‰§è¡Œå®ƒï¼Œå¹¶æ°´å¹³æ‰©å±•ç½‘ç»œèŠ‚ç‚¹çš„è¿è¡Œã€‚ </p><br><h3 id="cheynkod"> é“¾ç  </h3><br><p> é“¾ç ï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºæ™ºèƒ½åˆçº¦ï¼‰æ˜¯ç”¨Golangï¼ŒJavaScriptï¼ˆHLF 1.1+ï¼‰æˆ–Javaï¼ˆHLF 1.3+ï¼‰ç¼–å†™çš„ç¨‹åºï¼Œå®ƒå®šä¹‰ç”¨äºåˆ›å»ºæ›´æ”¹åŒºå—é“¾çŠ¶æ€çš„äº¤æ˜“çš„è§„åˆ™ã€‚ è¯¥ç¨‹åºåœ¨åŒºå—é“¾èŠ‚ç‚¹åˆ†å¸ƒå¼ç½‘ç»œçš„å‡ ä¸ªç‹¬ç«‹èŠ‚ç‚¹ä¸ŠåŒæ—¶æ‰§è¡Œï¼Œé€šè¿‡åè°ƒäº¤æ˜“â€œç¡®è®¤â€æ‰€éœ€çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šç¨‹åºæ‰§è¡Œçš„ç»“æœï¼Œä¸ºæ™ºèƒ½åˆçº¦çš„æ‰§è¡Œåˆ›å»ºäº†ä¸­ç«‹çš„ç¯å¢ƒã€‚ </p><br><p> è¯¥ä»£ç å¿…é¡»å®ç°ä¸€ä¸ªç”±æ–¹æ³•ç»„æˆçš„æ¥å£ï¼š </p><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Chaincode <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Init is called during Instantiate transaction Init(stub ChaincodeStubInterface) pb.Response // Invoke is called to update or query the ledger Invoke(stub ChaincodeStubInterface) pb.Response }</span></span></code> </pre> <br><ul><li> åœ¨å®ä¾‹åŒ–æˆ–å‡çº§ä»£ç æ—¶è°ƒç”¨<strong>Init</strong>æ–¹æ³•ã€‚ æ­¤æ–¹æ³•å¯¹ä»£ç çŠ¶æ€è¿›è¡Œå¿…è¦çš„åˆå§‹åŒ–ã€‚ åœ¨æ–¹æ³•ä»£ç ä¸­åŒºåˆ†è°ƒç”¨æ˜¯å®ä¾‹åŒ–è¿˜æ˜¯å‡çº§ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› æ­¤ï¼Œç”±äºé”™è¯¯ï¼Œæ‚¨ä¸ä¼šåˆå§‹åŒ–ï¼ˆé‡ç½®ï¼‰åœ¨ä»£ç æ“ä½œè¿‡ç¨‹ä¸­å·²ç»æ¥æ”¶åˆ°éé›¶çŠ¶æ€çš„æ•°æ®ã€‚ </li><li> è®¿é—®ä»£ç ä»£ç çš„ä»»ä½•åŠŸèƒ½æ—¶ï¼Œå°†<strong>è°ƒç”¨Invoke</strong>æ–¹æ³•ã€‚ æ­¤æ–¹æ³•é€‚ç”¨äºæ™ºèƒ½åˆçº¦çš„çŠ¶æ€ã€‚ </li></ul><br><p> é“¾ç å®‰è£…åœ¨åŒºå—é“¾ç½‘ç»œçš„å¯¹ç­‰ç‚¹ä¸Šã€‚ åœ¨ç³»ç»Ÿçº§åˆ«ï¼Œä»£ç çš„æ¯ä¸ªå®ä¾‹å¯¹åº”äºè¿æ¥åˆ°ç‰¹å®šç½‘ç»œèŠ‚ç‚¹çš„å•ç‹¬çš„docker-containerï¼Œè¯¥èŠ‚ç‚¹æ‰§è¡Œè°ƒåº¦è°ƒç”¨ä»¥æ‰§è¡Œä»£ç ã€‚ <br> ä¸ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ä¸åŒï¼Œå¯ä»¥æ›´æ–°é“¾æ¥é€»è¾‘ï¼Œä½†æ˜¯è¿™è¦æ±‚æ‰˜ç®¡ä»£ç çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å¿…é¡»å®‰è£…æ›´æ–°ç‰ˆæœ¬ã€‚ </p><br><p> å“åº”ä»å¤–éƒ¨é€šè¿‡SDKè°ƒç”¨chaincodeå‡½æ•°ï¼Œchaincodeä¼šæ›´æ”¹åŒºå—é“¾ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Read-Write Set</a> ï¼‰ä»¥åŠäº‹ä»¶çš„çŠ¶æ€ã€‚ é“¾ç æ˜¯æŒ‡ä¸€ä¸ªç‰¹å®šçš„é€šé“ï¼Œå¹¶ä¸”åªèƒ½åœ¨ä¸€ä¸ªé€šé“ä¸­æ›´æ”¹æ•°æ®ã€‚ åŒæ—¶ï¼Œå¦‚æœå®‰è£…äº†ä»£ç çš„ä¸»æœºä¹Ÿå¯ä»¥è®¿é—®å…¶ä»–é€šé“ï¼Œåˆ™ä»£ç çš„é€»è¾‘å¯ä»¥ä»è¿™äº›é€šé“è¯»å–æ•°æ®ã€‚ </p><br><p> ç”¨äºç®¡ç†åŒºå—é“¾ç½‘ç»œè¿è¡Œå„ä¸ªæ–¹é¢çš„ç‰¹æ®Šé“¾ä»£ç ç§°ä¸ºç³»ç»Ÿé“¾ä»£ç ã€‚ </p><br><h3 id="politika-odobreniya-endorsement-policy"> èƒŒä¹¦æ”¿ç­– </h3><br><p> æ‰¹å‡†ç­–ç•¥åœ¨ç‰¹å®šé“¾ç ç”Ÿæˆçš„äº¤æ˜“çº§åˆ«å®šä¹‰å…±è¯†è§„åˆ™ã€‚ è¯¥ç­–ç•¥è®¾ç½®ç¡®å®šå“ªäº›é€šé“èŠ‚ç‚¹åº”åˆ›å»ºäº‹åŠ¡çš„è§„åˆ™ã€‚ ä¸ºæ­¤ï¼Œæ‰¹å‡†ç­–ç•¥ä¸­æŒ‡å®šçš„æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»è¿è¡Œé“¾æ¥æ–¹æ³•ï¼ˆâ€œæ‰§è¡Œâ€æ­¥éª¤ï¼‰ï¼Œæ‰§è¡Œâ€œæ¨¡æ‹Ÿâ€ï¼Œä¹‹åï¼Œç­¾åçš„ç»“æœå°†ç”±å‘èµ·äº¤æ˜“çš„SDKæ”¶é›†å’ŒéªŒè¯ï¼ˆæ‰€æœ‰æ¨¡æ‹Ÿç»“æœå¿…é¡»ç›¸åŒï¼Œè¯¥ç­–ç•¥è¦æ±‚çš„æ‰€æœ‰èŠ‚ç‚¹çš„ç­¾åéƒ½å¿…é¡»å­˜åœ¨ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼ŒSDKå°†äº¤æ˜“å‘é€ç»™<em>è®¢è´­è€…</em> ï¼Œæ­¤åï¼Œæ‰€æœ‰æœ‰æƒè®¿é—®è¯¥é€šé“çš„èŠ‚ç‚¹éƒ½å°†é€šè¿‡<em>è®¢è´­è€…</em>æ¥æ”¶äº¤æ˜“ï¼Œå¹¶æ‰§è¡Œâ€œéªŒè¯â€æ­¥éª¤ã€‚ éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰é€šé“èŠ‚ç‚¹éƒ½å¿…é¡»å‚ä¸â€œæ‰§è¡Œâ€æ­¥éª¤ã€‚ </p><br><p> æ‰¹å‡†ç­–ç•¥æ˜¯åœ¨å®ä¾‹åŒ–æˆ–å‡çº§ä»£ç æ—¶ç¡®å®šçš„ã€‚ åœ¨1.3ç‰ˆä¸­ï¼Œä¸ä»…å¯ä»¥åœ¨é“¾ç çº§åˆ«è®¾ç½®ç­–ç•¥ï¼Œè€Œä¸”å¯ä»¥åœ¨å•ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸºäºçŠ¶æ€çš„è®¤å¯å¯†é’¥</a>çº§åˆ«è®¾ç½®ç­–ç•¥ã€‚ æ‰¹å‡†æ”¿ç­–ç¤ºä¾‹ï¼š </p><br><ul><li> èŠ‚ç‚¹Aï¼ŒBï¼ŒCï¼ŒD </li><li> å¤§å¤šæ•°é€šé“èŠ‚ç‚¹ </li><li> æ¥è‡ªAï¼ŒBï¼ŒCï¼ŒDï¼ŒEï¼ŒFçš„è‡³å°‘3ä¸ªèŠ‚ç‚¹ </li></ul><br><h3 id="sobytie"> å¤§äº‹è®° </h3><br><p> äº‹ä»¶æ˜¯ä¸€ä¸ªå‘½åæ•°æ®é›†ï¼Œå¯è®©æ‚¨å‘å¸ƒåŒºå—é“¾é“¾çŠ¶æ€çš„â€œæ›´æ–°æè¦â€ã€‚ äº‹ä»¶å±æ€§é›†å®šä¹‰äº†é“¾ç ã€‚ </p><br><h2 id="infrastruktura-seti"> ç½‘ç»œåŸºç¡€è®¾æ–½ </h2><br><h3 id="uzel-seti-peer"> ä¸»æŒäººï¼ˆå¯¹ç­‰ï¼‰ </h3><br><p> ä¸»æœºè¿æ¥åˆ°å…¶å…·æœ‰è®¿é—®æƒé™çš„ä»»æ„æ•°é‡çš„é€šé“ã€‚ ä¸»æœºç»´æŠ¤å…¶ç‰ˆæœ¬çš„åŒºå—é“¾å’ŒåŒºå—é“¾çš„çŠ¶æ€ï¼Œå¹¶æä¾›è¿è¡Œé“¾ä»£ç çš„ç¯å¢ƒã€‚ å¦‚æœä¸»æœºä¸æ˜¯æ‰¹å‡†ç­–ç•¥çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸å¿…ä½¿ç”¨é“¾ç è¿›è¡Œè®¾ç½®ã€‚ </p><br><p> åœ¨ä¸»æœºè½¯ä»¶çº§åˆ«ï¼Œå¯ä»¥å°†åŒºå—é“¾çš„å½“å‰çŠ¶æ€ï¼ˆä¸–ç•ŒçŠ¶æ€ï¼‰å­˜å‚¨åœ¨LevelDBæˆ–CouchDBä¸­ã€‚  CouchDBçš„ä¼˜ç‚¹æ˜¯å®ƒæ”¯æŒä½¿ç”¨MongoDBè¯­æ³•çš„ä¸°å¯ŒæŸ¥è¯¢ã€‚ </p><br><h3 id="orderer"> è®¢è´­è€… </h3><br><p> äº‹åŠ¡ç®¡ç†æœåŠ¡æ¥å—å·²ç­¾åçš„äº‹åŠ¡ä½œä¸ºè¾“å…¥ï¼Œå¹¶ç¡®ä¿äº‹åŠ¡ä»¥æ­£ç¡®çš„é¡ºåºåˆ†å¸ƒåœ¨ç½‘ç»œèŠ‚ç‚¹ä¸Šã€‚ </p><br><p> å®šè´­è€…ä¸è¿è¡Œæ™ºèƒ½åˆçº¦ï¼Œå¹¶ä¸”ä¸åŒ…å«åŒºå—é“¾å’ŒåŒºå—é“¾çŠ¶æ€ã€‚ ç›®å‰ï¼ˆ1.3ï¼‰ï¼Œæœ‰ä¸¤ç§<em>è®¢è´­è€…</em>å®ç°æ–¹å¼-ä¸€ä¸ªå¼€å‘<em>å•ç‹¬</em>ç‰ˆæœ¬å’Œä¸€ä¸ªåŸºäºKafkaçš„ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬æä¾›å´©æºƒå®¹é”™èƒ½åŠ›ã€‚ é¢„è®¡åœ¨2018å¹´åº•å°†å®ç°æ”¯æŒéƒ¨åˆ†å‚ä¸è€…çš„é”™è¯¯è¡Œä¸ºï¼ˆæ‹œå åº­å®¹é”™ï¼‰çš„<em>è®¢è´­è€…</em>çš„å®æ–½ã€‚ </p><br><h3 id="servis-identifikacii-membership-services"> èº«ä»½æœåŠ¡ </h3><br><p> åœ¨Hyperledger Fabricç½‘ç»œä¸­ï¼Œæ‰€æœ‰æˆå‘˜å‡å…·æœ‰å…¶ä»–æˆå‘˜å·²çŸ¥çš„èº«ä»½ï¼ˆèº«ä»½ï¼‰ã€‚ ä¸ºäº†è¿›è¡Œæ ‡è¯†ï¼Œä½¿ç”¨äº†å…¬é’¥åŸºç¡€ç»“æ„ï¼ˆPKIï¼‰ï¼Œé€šè¿‡è¯¥PKIï¼Œå¯ä»¥ä¸ºç»„ç»‡ï¼ŒåŸºç¡€ç»“æ„å…ƒç´ ï¼ˆèŠ‚ç‚¹ï¼Œè®¢è´­è€…ï¼‰ï¼Œåº”ç”¨ç¨‹åºå’Œæœ€ç»ˆç”¨æˆ·åˆ›å»ºX.509è¯ä¹¦ã€‚ ç»“æœï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œçº§åˆ«ï¼Œå•ä¸ªé€šé“ä¸Šæˆ–æ™ºèƒ½åˆçº¦çš„é€»è¾‘ä¸­çš„è®¿é—®è§„åˆ™æ¥æ§åˆ¶å¯¹è¯»å–å’Œä¿®æ”¹æ•°æ®çš„è®¿é—®ã€‚ åœ¨åŒä¸€ä¸ªåŒºå—é“¾ç½‘ç»œä¸­ï¼Œå„ç§ç±»å‹çš„å¤šç§è¯†åˆ«æœåŠ¡å¯ä»¥åŒæ—¶å·¥ä½œã€‚ </p><br><h1 id="realizaciya-cheynkoda"> ä»£ç çš„å®ç° </h1><br><p>  Chaincodeå¯ä»¥è¢«è§†ä¸ºå…·æœ‰å®ç°ç‰¹å®šä¸šåŠ¡é€»è¾‘çš„æ–¹æ³•çš„å¯¹è±¡ã€‚ ä¸ç»å…¸OOPä¸åŒï¼Œé“¾ç ä¸èƒ½å…·æœ‰å±æ€§å­—æ®µã€‚ ä¸ºäº†å¤„ç†çŠ¶æ€ï¼Œè¯¥çŠ¶æ€çš„å­˜å‚¨ç”±HLF <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŒºå—</a>é“¾å¹³å°æä¾›ï¼Œä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ChainchainStubInterface</a>å±‚ï¼Œè¯¥å±‚åœ¨<em>è°ƒç”¨</em> <em>Init</em>å’Œ<em>Invoke</em>æ–¹æ³•æ—¶ä¼ é€’ã€‚ å®ƒæä¾›äº†æ¥æ”¶å‡½æ•°è°ƒç”¨å‚æ•°å¹¶æ›´æ”¹å—é“¾çŠ¶æ€çš„åŠŸèƒ½ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ChaincodeStubInterface <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { <span class="hljs-comment"><span class="hljs-comment">// GetArgs returns the arguments intended for the chaincode Init and Invoke GetArgs() [][]byte // InvokeChaincode locally calls the specified chaincode InvokeChaincode(chaincodeName string, args [][]byte, channel string) pb.Response // GetState returns the value of the specified `key` from the ledger. GetState(key string) ([]byte, error) // PutState puts the specified `key` and `value` into the transaction's writeset as a data-write proposal. PutState(key string, value []byte) error // DelState records the specified `key` to be deleted in the writeset of the transaction proposal. DelState(key string) error // GetStateByRange returns a range iterator over a set of keys in the ledger. GetStateByRange(startKey, endKey string) (StateQueryIteratorInterface, error) // CreateCompositeKey combines the given `attributes` to form a composite key. CreateCompositeKey(objectType string, attributes []string) (string, error) // GetCreator returns `SignatureHeader.Creator` (eg an identity of the agent (or user) submitting the transaction. GetCreator() ([]byte, error) // and many more methods }</span></span></code> </pre> <br><p> åœ¨åŸºäºSolidityå¼€å‘çš„ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ä¸­ï¼Œæ¯ç§æ–¹æ³•éƒ½å…·æœ‰å…¬å…±åŠŸèƒ½ã€‚ åœ¨Hyperledger Fabricé“¾ä»£ç ä¸­ï¼Œä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ChaincodeStubInterface</a>å‡½æ•°çš„<em>Init</em>å’Œ<em>Invoke</em>æ–¹æ³•ã€‚  <em>ä½¿ç”¨GetArgsï¼ˆï¼‰ï¼Œ</em>å¯ä»¥ä»¥å­—èŠ‚æ•°ç»„çš„å½¢å¼è·å–å‡½æ•°è°ƒç”¨çš„å‚æ•°ï¼Œè€Œè°ƒç”¨<em>Invoke</em>æ—¶æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ åŒ…å«chaincodeå‡½æ•°çš„åç§°ã€‚ å› ä¸º ä»»ä½•chaincodeæ–¹æ³•çš„è°ƒç”¨éƒ½é€šè¿‡Invokeæ–¹æ³•ä¼ é€’ï¼›æˆ‘ä»¬å¯ä»¥è¯´è¿™æ˜¯å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼çš„å®ç°ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è€ƒè™‘ä¸º<a href="">ERC-20</a>ä»¤ç‰Œå®ç°æ ‡å‡†ä»¥å¤ªåŠæ¥å£ï¼Œåˆ™æ™ºèƒ½åˆçº¦åº”å®ç°ä»¥ä¸‹æ–¹æ³•ï¼š </p><br><ul><li>  totalSupplyï¼ˆï¼‰ </li><li>  balanceOfï¼ˆåœ°å€_æ‰€æœ‰è€…ï¼‰ </li><li> è½¬ç§»ï¼ˆåœ°å€_toï¼Œuint256 _valueï¼‰ </li></ul><br><p> å¯¹äºHLFå®ç°ï¼Œ <em>Invoke</em>å‡½æ•°<em>ä»£ç </em>å¿…é¡»èƒ½å¤Ÿå¤„ç†å…¶ä¸­<em>Invoke</em>è°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«æ‰€éœ€æ–¹æ³•åç§°çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œâ€œ totalSupplyâ€æˆ–â€œ balanceOfâ€ï¼‰ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>å¯ä»¥çœ‹åˆ°å®ç°ERC-20æ ‡å‡†çš„ç¤ºä¾‹ã€‚ </p><br><h2 id="primery-cheynkodov"> é“¾ç ç¤ºä¾‹ </h2><br><p> é™¤äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Hyperledger Fabric</a>æ–‡æ¡£å¤–ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿˜æœ‰</a>ä¸€äº›é“¾ä»£ç ç¤ºä¾‹ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŒºå—é“¾ä¿é™©åº”ç”¨ç¨‹åºï¼ˆ2018ï¼‰</a> </li><li>  <a href="">å¼¹ç </a> </li><li>  <a href="">æ±½è½¦ç§Ÿèµæ¼”ç¤ºï¼ˆ2017ï¼‰</a>ç¬¬ </li></ul><br><p> åœ¨è¿™äº›ç¤ºä¾‹ä¸­ï¼Œé“¾ä»£ç çš„å®ç°ç›¸å½“å†—é•¿ï¼Œå¹¶ä¸”åŒ…å«è®¸å¤šé‡å¤çš„é€»è¾‘ï¼Œç”¨äºé€‰æ‹©è¢«è°ƒç”¨çš„è·¯ç”±å‡½æ•°ï¼‰ï¼Œæ£€æŸ¥å‚æ•°æ•°é‡ï¼Œjsonç¼–ç»„/è§£ç»„ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t *SimpleChaincode)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(stub shim.ChaincodeStubInterface)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pb</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Response</span></span></span></span> { function, args := stub.GetFunctionAndParameters() fmt.Println(<span class="hljs-string"><span class="hljs-string">"invoke is running "</span></span> + function) <span class="hljs-comment"><span class="hljs-comment">// Handle different functions if function == "initMarble" { //create a new marble return t.initMarble(stub, args) } else if function == "transferMarble" { //change owner of a specific marble return t.transferMarble(stub, args) } else if function == "readMarble" { //read a marble return t.readMarble(stub, args) } else ...</span></span></code> </pre><br><p> å½“æ‚¨åªæ˜¯å¿˜è®°è§£ç»„è¾“å…¥æ•°æ®æ—¶ï¼Œè¿™æ ·çš„ä»£ç ç»„ç»‡ä¼šå¯¼è‡´ä»£ç çš„å¯è¯»æ€§ä¸‹é™å’Œå¯èƒ½çš„é”™è¯¯ï¼Œä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">this</a> ã€‚ å…³äºHLFå¼€å‘è®¡åˆ’çš„æ¼”è®²æåˆ°äº†é“¾ä»£ç å¼€å‘æ–¹æ³•çš„ä¿®è®¢ç‰ˆï¼Œç‰¹åˆ«æ˜¯Javaé“¾ä»£ç ä¸­çš„æ³¨é‡Šçš„å¼•å…¥ç­‰ï¼Œä½†æ˜¯ï¼Œè¯¥è®¡åˆ’ä¸ä»…åœ¨2019å¹´é¢„æœŸçš„ç‰ˆæœ¬ç›¸å…³ã€‚ å¼€å‘æ™ºèƒ½åˆçº¦çš„ç»éªŒå¾—å‡ºçš„ç»“è®ºæ˜¯ï¼Œå¦‚æœæ‚¨åœ¨å•ç‹¬çš„åº“ä¸­é€‰æ‹©åŸºæœ¬åŠŸèƒ½ï¼Œåˆ™å¼€å‘å’Œæµ‹è¯•é“¾ä»£ç å°†æ›´åŠ å®¹æ˜“ã€‚ </p><br><h1 id="cckit---biblioteka-dlya-razrabotki-i-testirovaniya-cheynkodov">  CCKit-ç”¨äºå¼€å‘å’Œæµ‹è¯•é“¾å¼ä»£ç çš„åº“ </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CCKit</a>åº“æ€»ç»“äº†å¼€å‘å’Œæµ‹è¯•é“¾ä»£ç çš„å®è·µã€‚ ä½œä¸ºå¼€å‘é“¾ç <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰©å±•çš„</a>ä¸€éƒ¨åˆ†ï¼Œä»¥Ethereumæ™ºèƒ½åˆçº¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰©å±•çš„</a> OpenZeppelinåº“ä¸ºä¾‹ã€‚  CCKitä½¿ç”¨ä»¥ä¸‹ä½“ç³»ç»“æ„è§£å†³æ–¹æ¡ˆï¼š </p><br><h2 id="marshrutizaciya-routing-obrascheniy-k-funkciyam-smart-kontrakta"> å°†å‘¼å«è·¯ç”±åˆ°æ™ºèƒ½åˆçº¦åŠŸèƒ½ </h2><br><p> è·¯ç”±æ˜¯æŒ‡åº”ç”¨ç¨‹åºå“åº”å®¢æˆ·ç«¯è¯·æ±‚çš„ç®—æ³•ã€‚ ä¾‹å¦‚ï¼Œå‡ ä¹æ‰€æœ‰çš„httpæ¡†æ¶éƒ½ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ è·¯ç”±å™¨ä½¿ç”¨æŸäº›è§„åˆ™æ¥ç»‘å®šè¯·æ±‚å’Œè¯·æ±‚å¤„ç†ç¨‹åºã€‚ å…³äºé“¾ç ï¼Œè¿™æ˜¯å°†é“¾ç åŠŸèƒ½çš„åç§°ä¸å¤„ç†ç¨‹åºåŠŸèƒ½ç›¸å…³è”ã€‚ </p><br><p> åœ¨æ™ºèƒ½åˆçº¦çš„æœ€æ–°ç¤ºä¾‹ä¸­ï¼Œä¾‹å¦‚åœ¨<a href="">Insurance Appä¸­</a> ï¼Œå®ƒä½¿ç”¨é“¾ç å‡½æ•°åç§°å’ŒGolangä»£ç å½¢å¼çš„å‡½æ•°ä¹‹é—´çš„æ˜ å°„ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bcFunctions = <span class="hljs-keyword"><span class="hljs-keyword">map</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(shim.ChaincodeStubInterface, []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pb</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Response</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Insurance Peer "contract_type_ls": listContractTypes, "contract_type_create": createContractType, ... "theft_claim_process": processTheftClaim, }</span></span></code> </pre> <br><p>  CCKitè·¯ç”±å™¨ä½¿ç”¨ç±»ä¼¼äºhttpè·¯ç”±å™¨çš„æ–¹æ³•ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†è¯·æ±‚ä¸Šä¸‹æ–‡ç”¨äºé“¾ç åŠŸèƒ½å’Œä¸­é—´ä»¶åŠŸèƒ½ </p><br><h2 id="kontekst-obrascheniya-k-funkcii-cheynkoda"> è°ƒç”¨ä»£ç çš„ä¸Šä¸‹æ–‡ </h2><br><p> ä¸é€šå¸¸å¯ä»¥è®¿é—®httpè¯·æ±‚å‚æ•°çš„httpè¯·æ±‚ä¸Šä¸‹æ–‡ç±»ä¼¼ï¼ŒCCKitè·¯ç”±å™¨ä½¿ç”¨å¯¹<a href="">æ™ºèƒ½åˆçº¦</a>å‡½æ•°çš„è°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œè¯¥å‡½æ•°æ˜¯<em>shim.ChaincodeStubInterface</em>ä¹‹ä¸Šçš„<em>æŠ½è±¡</em> ã€‚ ä¸Šä¸‹æ–‡å¯ä»¥æ˜¯é“¾æ¥å‡½æ•°å¤„ç†ç¨‹åºçš„å”¯ä¸€å‚æ•°;é€šè¿‡å®ƒï¼Œå¤„ç†ç¨‹åºå¯ä»¥æ¥æ”¶å‡½æ•°è°ƒç”¨çš„å‚æ•°ï¼Œä»¥åŠè®¿é—®è¾…åŠ©åŠŸèƒ½ä»¥ä½¿ç”¨æ™ºèƒ½åˆçº¦çš„çŠ¶æ€ï¼ˆStateï¼‰ï¼Œåˆ›å»ºç­”æ¡ˆï¼ˆResponseï¼‰ç­‰ã€‚ </p><br><pre> <code class="go hljs">Context <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Stub() shim.ChaincodeStubInterface Client() (cid.ClientIdentity, error) Response() Response Logger() *shim.ChaincodeLogger Path() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> State() State Time() (time.Time, error) Args() InterfaceMap Arg(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} ArgString(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ArgBytes(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) []<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> SetArg(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) Get(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} Set(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) SetEvent(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) error }</code> </pre> <br><p> å› ä¸º ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨æŸäº›é“¾å¼ä»£ç ä¸­ï¼Œå®ƒå¯ä»¥æ‰©å±•ã€‚ </p><br><h2 id="funkcii-promezhutochnoy-obrabotki-middleware"> ä¸­é—´ä»¶åŠŸèƒ½ </h2><br><p> åœ¨è°ƒç”¨ä»£ç ä»£ç æ–¹æ³•çš„å¤„ç†ç¨‹åºä¹‹å‰ï¼Œå°†è°ƒç”¨ä¸­é—´å¤„ç†åŠŸèƒ½ï¼ˆä¸­é—´ä»¶ï¼‰ï¼Œå¯ä»¥è®¿é—®å¯¹ä»£ç æ–¹æ³•å’Œä¸‹ä¸€ä¸ªä¸­é—´å‡½æ•°çš„è°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œæˆ–è€…ç›´æ¥è®¿é—®ä¸‹ä¸€ä¸ªï¼ˆä¸‹ä¸€ä¸ªï¼‰æ–¹æ³•çš„å¤„ç†ç¨‹åºã€‚ ä¸­é—´ä»¶å¯ç”¨äºï¼š </p><br><ul><li> è½¬æ¢è¾“å…¥æ•°æ®ï¼ˆåœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ <em>p.String</em>å’Œ<em>p.Struct</em>æ˜¯ä¸­é—´ä»¶ï¼‰ </li><li> ä½¿ç”¨è¯¥åŠŸèƒ½çš„é™åˆ¶ï¼ˆä¾‹å¦‚<em>owner.Only</em> ï¼‰ </li><li> è¯·æ±‚å¤„ç†å‘¨æœŸçš„å®Œæˆ </li><li> ä»å †æ ˆä¸­è°ƒç”¨ä¸‹ä¸€ä¸ªä¸­é—´å¤„ç†å‡½æ•° </li></ul><br><h2 id="konvertaciya-struktur-dannyh"> æ•°æ®ç»“æ„è½¬æ¢ </h2><br><p>  chaincodeæ¥å£å‡å®šå°†å­—èŠ‚æ•°ç»„çš„æ•°ç»„æä¾›ç»™è¾“å…¥ï¼Œå…¶æ¯ä¸ªå…ƒç´ éƒ½æ˜¯chaincodeå‡½æ•°çš„å±æ€§ã€‚ ä¸ºäº†é˜²æ­¢ä»é“¾æ¥å‡½æ•°çš„æ¯ä¸ªå¤„ç†ç¨‹åºä¸­çš„å‡½æ•°è°ƒç”¨å‚æ•°å°†å­—èŠ‚ç»„æ•°æ®æ‰‹åŠ¨ç¼–ç»„ä¸ºgolangæ•°æ®ç±»å‹ï¼ˆintï¼Œå­—ç¬¦ä¸²ï¼Œç»“æ„ï¼Œæ•°ç»„ï¼‰ï¼Œåœ¨CCKitè·¯ç”±å™¨ä¸­åˆ›å»ºè·¯ç”±è§„åˆ™æ—¶ä¼šè®¾ç½®é¢„æœŸçš„æ•°æ®ç±»å‹ï¼Œå¹¶è‡ªåŠ¨è½¬æ¢ç±»å‹ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ <em>carGet</em>å‡½æ•°éœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°ï¼Œè€Œ<em>carRegister</em>å‡½æ•°<em>éœ€è¦ä¸€ä¸ªCarPayload</em>ç»“æ„ã€‚ è¯¥å‚æ•°ä¹Ÿè¢«å‘½åï¼Œå®ƒå…è®¸å¤„ç†ç¨‹åºæŒ‰åç§°ä»ä¸Šä¸‹æ–‡ä¸­è·å–å…¶å€¼ã€‚ ä¸‹é¢å°†ç»™å‡ºå¤„ç†ç¨‹åºçš„ç¤ºä¾‹ã€‚  Protobufä¹Ÿå¯ä»¥ç”¨äºæè¿°é“¾æ¥æ•°æ®æ–¹æ¡ˆã€‚ </p><br><pre> <code class="go hljs">r.Group(<span class="hljs-string"><span class="hljs-string">`car`</span></span>). Query(<span class="hljs-string"><span class="hljs-string">`List`</span></span>, cars). <span class="hljs-comment"><span class="hljs-comment">// chain code method name is carList Query(`Get`, car, p.String(`id`)). // chain code method name is carGet, method has 1 string argument "id" Invoke(`Register`, carRegister, p.Struct(`car`, &amp;CarPayload{}), // 1 struct argument owner.Only) // allow access to method only for chaincode owner (authority)</span></span></code> </pre> <br><p> æ­¤å¤–ï¼Œåœ¨å°†æ•°æ®å†™å…¥æ™ºèƒ½åˆçº¦çš„çŠ¶æ€ä»¥åŠåˆ›å»ºäº‹ä»¶ï¼ˆgolangç±»å‹è¢«åºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„ï¼‰æ—¶ï¼Œå°†ä½¿ç”¨è‡ªåŠ¨è½¬æ¢ï¼ˆç¼–ç»„ï¼‰ã€‚ </p><br><h2 id="sredstva-otladki-i-loggirovaniya-cheynkodov"> è°ƒè¯•å’Œè®°å½•é“¾ä»£ç çš„å·¥å…· </h2><br><p> è¦è°ƒè¯•ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">debug</a>æ‰©å±•ï¼Œè¯¥æ‰©å±•å®ç°äº†æ™ºèƒ½åˆçº¦æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†å…è®¸æ‚¨æ£€æŸ¥æ™ºèƒ½åˆçº¦çŠ¶æ€ä¸‹æ˜¯å¦å­˜åœ¨é”®ï¼Œä»¥åŠç›´æ¥è¯»å–/æ›´æ”¹/åˆ é™¤é”®å€¼ã€‚ </p><br><p> ä¸ºäº†åœ¨å¯¹chaincodeå‡½æ•°çš„è°ƒç”¨çš„ä¸Šä¸‹æ–‡ä¸­è®°å½•æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨Logï¼ˆï¼‰æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›HLFä¸­ä½¿ç”¨çš„è®°å½•å™¨çš„å®ä¾‹ã€‚ </p><br><h2 id="metody-upravleniya-dostupa-k-metodam-smart-kontrakta"> æ™ºèƒ½åˆçº¦æ–¹æ³•è®¿é—®æ§åˆ¶æ–¹æ³• </h2><br><p> ä½œä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰€æœ‰è€…</a>æ‰©å±•çš„ä¸€éƒ¨åˆ†ï¼Œå®ç°äº†ç”¨äºå­˜å‚¨æœ‰å…³å®ä¾‹åŒ–é“¾ä»£ç çš„æ‰€æœ‰è€…å’Œæ™ºèƒ½åˆçº¦æ–¹æ³•çš„è®¿é—®ä¿®é¥°ç¬¦ï¼ˆä¸­é—´ä»¶ï¼‰çš„ä¿¡æ¯çš„åŸºæœ¬åŸè¯­ã€‚ </p><br><h2 id="sredstva-testirovaniya-smart-kontraktov"> æ™ºèƒ½åˆçº¦æµ‹è¯•å·¥å…· </h2><br><p> éƒ¨ç½²åŒºå—é“¾ç½‘ç»œï¼Œå®‰è£…å’Œåˆå§‹åŒ–é“¾ä»£ç æ˜¯ä¸€ä¸ªç›¸å½“å¤æ‚çš„è®¾ç½®ï¼Œè€Œä¸”è¿‡ç¨‹å¾ˆé•¿ã€‚ é€šè¿‡ä½¿ç”¨æ™ºèƒ½åˆçº¦çš„DEVæ¨¡å¼ï¼Œå¯ä»¥å‡å°‘é‡æ–°å®‰è£…/å‡çº§æ™ºèƒ½åˆçº¦ä»£ç çš„æ—¶é—´ï¼Œä½†æ˜¯ï¼Œæ›´æ–°ä»£ç çš„è¿‡ç¨‹ä»ç„¶å¾ˆæ…¢ã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">shim</a>è½¯ä»¶åŒ…åŒ…å«<a href="">MockStub</a>çš„å®ç°ï¼Œè¯¥å®ç°åŒ…è£…å¯¹ä»£ç çš„è°ƒç”¨ï¼Œä»¥æ¨¡æ‹Ÿå…¶åœ¨HLFåŒºå—é“¾ç¯å¢ƒä¸­çš„æ“ä½œã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨MockStub</a>å¯ä»¥ä½¿æ‚¨å‡ ä¹ç«‹å³è·å¾—æµ‹è¯•ç»“æœï¼Œå¹¶å¯ä»¥å‡å°‘å¼€å‘æ—¶é—´ã€‚ å¦‚æœæˆ‘ä»¬è€ƒè™‘HLFä¸­ä»£ç çš„ä¸€èˆ¬æ“ä½œæ–¹æ¡ˆï¼Œåˆ™MockStubæœ¬è´¨ä¸Šæ›¿ä»£äº†SDKï¼Œä»è€Œä½¿æ‚¨å¯ä»¥è°ƒç”¨ä»£ç çš„åŠŸèƒ½ï¼Œå¹¶æ¨¡æ‹Ÿåœ¨ä¸»æœºä¸Šå¯åŠ¨ä»£ç çš„ç¯å¢ƒã€‚ </p><br><p><img src="https://habrastorage.org/webt/3y/ed/z2/3yedz22nfldc41jmcnpjqyto3x0.png"></p><br><p>  HLFäº¤ä»˜ä¸­çš„MockStubåŒ…å«äº†<em>shim.ChaincodeStubInterface</em>æ¥å£çš„å‡ ä¹æ‰€æœ‰æ–¹æ³•çš„å®ç°ï¼Œä½†æ˜¯ï¼Œåœ¨å½“å‰ç‰ˆæœ¬ï¼ˆ1.3ï¼‰ä¸­ï¼Œå®ƒç¼ºå°‘æŸäº›é‡è¦æ–¹æ³•çš„å®ç°ï¼Œä¾‹å¦‚GetCreatorã€‚ å› ä¸º é“¾ä»£ç å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æ¥è·å¾—ç”¨äºè®¿é—®æ§åˆ¶çš„äº‹åŠ¡åˆ›å»ºè€…çš„è¯ä¹¦ï¼Œä¸ºäº†æœ€å¤§ç¨‹åº¦åœ°è¦†ç›–æµ‹è¯•ï¼Œå…·æœ‰æ­¤æ–¹æ³•çš„å­˜æ ¹çš„èƒ½åŠ›å¾ˆé‡è¦ã€‚ </p><br><p>  CCKitåº“åŒ…å«MockStubçš„æ‰©å±•ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…å«ç¼ºå°‘çš„æ–¹æ³•çš„å®ç°ä»¥åŠç”¨äºäº‹ä»¶é€šé“çš„æ–¹æ³•ç­‰ã€‚ </p><br><h2 id="primer-cheynkoda"> é“¾ç ç¤ºä¾‹ </h2><br><p> ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„é“¾ç æ¥å­˜å‚¨æœ‰å…³å·²æ³¨å†Œæ±½è½¦çš„ä¿¡æ¯ </p><br><h3 id="model-dannyh"> èµ„æ–™æ¨¡å‹ </h3><br><p> ä»£ç çš„çŠ¶æ€æ˜¯é”®å€¼å­˜å‚¨ï¼Œå…¶ä¸­é”®æ˜¯å­—ç¬¦ä¸²ï¼Œå€¼æ˜¯å­—èŠ‚æ•°ç»„ã€‚ åŸºæœ¬åšæ³•æ˜¯å°†ç»è¿‡åˆ†ç±»å¤„ç†çš„golangæ•°æ®ç»“æ„å®ä¾‹å­˜å‚¨ä¸ºå€¼ã€‚ å› æ­¤ï¼Œè¦ä½¿ç”¨é“¾ç ä¸­çš„æ•°æ®ï¼Œä»çŠ¶æ€è¯»å–åï¼Œéœ€è¦è§£ç»„å­—èŠ‚æ•°ç»„ã€‚ </p><br><p> ä¸ºäº†è®°å½•æœ‰å…³æ±½è½¦çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹å±æ€§é›†ï¼š </p><br><ul><li> æ ‡è¯†ç¬¦ï¼ˆè½¦å·ï¼‰ </li><li> æ±½è½¦æ¨¡å‹ </li><li> è½¦ä¸»ä¿¡æ¯ </li><li> æ•°æ®å˜æ›´æ—¶é—´ä¿¡æ¯ </li></ul><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Car struct for chaincode state type Car struct { Id string Title string Owner string UpdatedAt time.Time // set by chaincode method }</span></span></code> </pre> <br><p> è¦å°†æ•°æ®ä¼ è¾“åˆ°é“¾ç ï¼Œè¯·åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç»“æ„ï¼Œè¯¥ç»“æ„ä»…åŒ…å«æ¥è‡ªé“¾ç å¤–éƒ¨çš„å­—æ®µï¼š </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// CarPayload chaincode method argument type CarPayload struct { Id string Title string Owner string }</span></span></code> </pre> <br><h3 id="rabota-s-klyuchami"> ä½¿ç”¨æŒ‰é”® </h3><br><p> æ™ºèƒ½åˆçº¦çŠ¶æ€ä¸‹çš„è®°å½•é”®æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å®ƒè¿˜æ”¯æŒåˆ›å»ºå¤åˆé”®çš„åŠŸèƒ½ï¼Œå…¶ä¸­ç»„åˆé”®çš„å„ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨é›¶å­—èŠ‚ï¼ˆ <em>U + 0000</em> ï¼‰åˆ†éš”ã€‚ </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateCompositeKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(objectType </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, attributes []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span></code> </pre> <br><p> åœ¨<em>CCKitä¸­ï¼Œ</em>å¦‚æœä¼ è¾“çš„ç»“æ„æ”¯æŒ<em>Keyer</em>æ¥å£ï¼Œåˆ™ä½¿ç”¨æ™ºèƒ½åˆçº¦çŠ¶æ€<em>çš„</em>åŠŸèƒ½å¯ä»¥è‡ªåŠ¨åˆ›å»ºè®°å½•å¯†é’¥ã€‚ </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Keyer interface for entity containing logic of its key creation type Keyer interface { Key() ([]string, error) }</span></span></code> </pre> <br><p> è¦è®°å½•æ±½è½¦ï¼Œå¯†é’¥ç”ŸæˆåŠŸèƒ½å¦‚ä¸‹ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CarEntity = <span class="hljs-string"><span class="hljs-string">`CAR`</span></span> <span class="hljs-comment"><span class="hljs-comment">// Key for car entry in chaincode state func (c Car) Key() ([]string, error) { return []string{CarEntity, c.Id}, nil }</span></span></code> </pre> <br><h3 id="deklaraciya-funkciy-smart-kontrakta-marshrutizaciya"> æ™ºèƒ½åˆçº¦åŠŸèƒ½å£°æ˜ï¼ˆè·¯ç”±ï¼‰ </h3><br><p> åœ¨é“¾ç çš„æ„é€ æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰é“¾ç çš„åŠŸèƒ½åŠå…¶å‚æ•°ã€‚ æ±½è½¦ç™»è®°ä»£ç ä¸­å°†åŒ…å«3ä¸ªåŠŸèƒ½ </p><br><ul><li>  carListï¼Œè¿”å›ä¸€ä¸ªCarç»“æ„æ•°ç»„ </li><li>  carGetï¼Œæ¥å—æ±½è½¦æ ‡è¯†ç¬¦å¹¶è¿”å›æ±½è½¦ç»“æ„ </li><li>  carRegisterï¼Œæ¥å—CarPayloadç»“æ„çš„åºåˆ—åŒ–å®ä¾‹ï¼Œå¹¶è¿”å›æ³¨å†Œç»“æœã€‚ ä»…é“¾ä»£ç çš„æ‰€æœ‰è€…å¯ä»¥è®¿é—®æ­¤æ–¹æ³•ï¼Œé“¾ä»£ç çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰€æœ‰è€…</a>ä½¿ç”¨ä¸­é—´ä»¶ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰€æœ‰è€…</a>åŒ…ä¸­ä¿å­˜è¯¥ä»£ç  </li></ul><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">router</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Chaincode</span></span></span></span> { r := router.New(<span class="hljs-string"><span class="hljs-string">`cars`</span></span>) <span class="hljs-comment"><span class="hljs-comment">// also initialized logger with "cars" prefix r.Init(invokeInit) r.Group(`car`). Query(`List`, queryCars). // chain code method name is carList Query(`Get`, queryCar, p.String(`id`)). // chain code method name is carGet, method has 1 string argument "id" Invoke(`Register`, invokeCarRegister, p.Struct(`car`, &amp;CarPayload{}), // 1 struct argument owner.Only) // allow access to method only for chaincode owner (authority) return router.NewChaincode(r) }</span></span></code> </pre> <br><p> ä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨<a href="">Chaincode</a>ç»“æ„ï¼Œå…¶ä¸­å°†<em>Init</em>å’Œ<em>Invoke</em>æ–¹æ³•çš„å¤„ç†å§”æ‰˜ç»™è·¯ç”±å™¨ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> router <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/hyperledger/fabric/core/chaincode/shim"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/hyperledger/fabric/protos/peer"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// Chaincode default chaincode implementation with router type Chaincode struct { router *Group } // NewChaincode new default chaincode implementation func NewChaincode(r *Group) *Chaincode { return &amp;Chaincode{r} } //======== Base methods ==================================== // // Init initializes chain code - sets chaincode "owner" func (cc *Chaincode) Init(stub shim.ChaincodeStubInterface) peer.Response { // delegate handling to router return cc.router.HandleInit(stub) } // Invoke - entry point for chain code invocations func (cc *Chaincode) Invoke(stub shim.ChaincodeStubInterface) peer.Response { // delegate handling to router return cc.router.Handle(stub) }</span></span></code> </pre> <br><p> ä½¿ç”¨è·¯ç”±å™¨å’ŒåŸºæœ¬çš„Chaincodeç»“æ„å¯ä»¥é‡ç”¨å¤„ç†ç¨‹åºåŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼Œè¦åœ¨ä¸æ£€æŸ¥å¯¹<code>carRegister</code>å‡½æ•°çš„è®¿é—®æƒé™çš„æƒ…å†µä¸‹å®ç°é“¾<code>carRegister</code> ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ–°çš„<a href="">æ„é€ æ–¹æ³•å³å¯</a> </p><br><h3 id="realizaciya-funkciy-smart-kontrakta"> å®æ–½æ™ºèƒ½åˆçº¦çš„åŠŸèƒ½ </h3><br><p>  Golangå‡½æ•°<strong>-CCKit</strong>è·¯ç”±å™¨ä¸­çš„æ™ºèƒ½åˆçº¦å‡½æ•°å¤„ç†ç¨‹åºå¯ä»¥åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š </p><br><ul><li>  <em>StubHandlerFunc-</em>æ ‡å‡†å¤„ç†ç¨‹åºæ¥å£ï¼Œæ¥å—<em>shim.ChaincodeStubInterface</em> ï¼Œè¿”å›æ ‡å‡†å“åº”å¯¹ç­‰<em>ä½“ã€‚</em> </li><li>  <em>ContextHandlerFunc-</em>è·å–ä¸Šä¸‹æ–‡å¹¶è¿”å›å¯¹ç­‰<em>ä½“</em> </li><li>  <em>HandlerFunc-</em>è·å–ä¸Šä¸‹æ–‡ï¼Œè¿”å›æ¥å£å’Œé”™è¯¯ã€‚ å¯ä»¥è¿”å›å­—èŠ‚æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ ¹æ®åˆ›å»ºçš„å¯¹ç­‰æ–¹è‡ªåŠ¨å°†ä»»ä½•golangç±»å‹è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ã€‚ å“åº”çŠ¶æ€å°†ä¸º<em>shim.Ok</em>æˆ–<em>shim.Error</em> ï¼Œå…·ä½“å–å†³äºä¼ é€’çš„é”™è¯¯ã€‚ </li></ul><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// StubHandlerFunc acts as raw chaincode invoke method, accepts stub and returns peer.Response StubHandlerFunc func(shim.ChaincodeStubInterface) peer.Response // ContextHandlerFunc use stub context as input parameter ContextHandlerFunc func(Context) peer.Response // HandlerFunc returns result as interface and error, this is converted to peer.Response via response.Create HandlerFunc func(Context) (interface{}, error)</span></span></code> </pre> <br><p>   ,   ,           (   CarPayload) <br>    State ,                      (      ) </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// car get info chaincode method handler func car(c router.Context) (interface{}, error) { return c.State().Get( // get state entry Key(c.ArgString(`id`)), // by composite key using CarKeyPrefix and car.Id &amp;Car{}) // and unmarshal from []byte to Car struct } // cars car list chaincode method handler func cars(c router.Context) (interface{}, error) { return c.State().List( CarKeyPrefix, // get list of state entries of type CarKeyPrefix &amp;Car{}) // unmarshal from []byte and append to []Car slice } // carRegister car register chaincode method handler func carRegister(c router.Context) (interface{}, error) { // arg name defined in router method definition p := c.Arg(`car`).(CarPayload) t, _ := c.Time() // tx time car := &amp;Car{ // data for chaincode state Id: p.Id, Title: p.Title, Owner: p.Owner, UpdatedAt: t, } return car, // peer.Response payload will be json serialized car data c.State().Insert( //put json serialized data to state Key(car.Id), // create composite key using CarKeyPrefix and car.Id car) }</span></span></code> </pre> <br><h3 id="testy-smart-kontrakta">  - </h3><br><p>    -       â€”        ,     .      BDD â€“ Behavior Driven Development,          . </p><br><p>  , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">- Ethereum</a>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ganache-cli</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">truffle</a> .   golang -  Mockstub. </p><br><h3 id="primer-testa">   </h3><br><p>    ,     .     <a href=""></a> . </p><br><p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ginkgo</a> ,     Go,      <code>go test</code> .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gomega</a>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">expect</a> ,    ,     . </p><br><pre> <code class="go hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"testing"</span></span> . <span class="hljs-string"><span class="hljs-string">"github.com/onsi/ginkgo"</span></span> . <span class="hljs-string"><span class="hljs-string">"github.com/onsi/gomega"</span></span> examplecert <span class="hljs-string"><span class="hljs-string">"github.com/s7techlab/cckit/examples/cert"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/s7techlab/cckit/extensions/owner"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/s7techlab/cckit/identity"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/s7techlab/cckit/state"</span></span> testcc <span class="hljs-string"><span class="hljs-string">"github.com/s7techlab/cckit/testing"</span></span> expectcc <span class="hljs-string"><span class="hljs-string">"github.com/s7techlab/cckit/testing/expect"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestCars</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t *testing.T)</span></span></span></span> { RegisterFailHandler(Fail) RunSpecs(t, <span class="hljs-string"><span class="hljs-string">"Cars Suite"</span></span>) }</code> </pre> <br><p>      ,   <em>CarPayload</em> : </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Payloads = []*Car{{ Id: <span class="hljs-string"><span class="hljs-string">`A777MP77`</span></span>, Title: <span class="hljs-string"><span class="hljs-string">`VAZ`</span></span>, Owner: <span class="hljs-string"><span class="hljs-string">`victor`</span></span>, }, { Id: <span class="hljs-string"><span class="hljs-string">`O888OO77`</span></span>, Title: <span class="hljs-string"><span class="hljs-string">`YOMOBIL`</span></span>, Owner: <span class="hljs-string"><span class="hljs-string">`alexander`</span></span>, }, { Id: <span class="hljs-string"><span class="hljs-string">`O222OO177`</span></span>, Title: <span class="hljs-string"><span class="hljs-string">`Lambo`</span></span>, Owner: <span class="hljs-string"><span class="hljs-string">`hodl`</span></span>, }}</code> </pre> <br><p>     MockStub   Cars. </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//Create chaincode mock cc := testcc.NewMockStub(`cars`, New())</span></span></code> </pre> <br><p> å› ä¸º   cars      ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// load actor certificates actors, err := identity.ActorsFromPemFile(`SOME_MSP`, map[string]string{ `authority`: `s7techlab.pem`, `someone`: `victor-nosov.pem`}, examplecert.Content)</span></span></code> </pre> <br><p>   <em>BeforeSuite</em>    <em>Car</em>      <em>authority</em>     <em>Init</em>    .  ,    <em>Cars</em>   Init       <em>Init</em> ,    . </p><br><pre> <code class="go hljs">BeforeSuite(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// init chaincode expectcc.ResponseOk(cc.From(actors[`authority`]).Init()) // init chaincode from authority })</span></span></code> </pre> <br><p>          . ,          <em>CarRegister</em> ,              . </p><br><pre> <code class="go hljs">It(<span class="hljs-string"><span class="hljs-string">"Allow authority to add information about car"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//invoke chaincode method from authority actor expectcc.ResponseOk(cc.From(actors[`authority`]).Invoke(`carRegister`, Payloads[0])) }) It("Disallow non authority to add information about car", func() { //invoke chaincode method from non authority actor expectcc.ResponseError( cc.From(actors[`someone`]).Invoke(`carRegister`, Payloads[0]), owner.ErrOwnerOnly) // expect "only owner" error })</span></span></code> </pre> <br><p>             : </p><br><pre> <code class="go hljs">It(<span class="hljs-string"><span class="hljs-string">"Disallow authority to add duplicate information about car"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { expectcc.ResponseError( cc.From(actors[<span class="hljs-string"><span class="hljs-string">`authority`</span></span>]).Invoke(<span class="hljs-string"><span class="hljs-string">`carRegister`</span></span>, Payloads[<span class="hljs-number"><span class="hljs-number">0</span></span>]), state.ErrKeyAlreadyExists) <span class="hljs-comment"><span class="hljs-comment">//expect car id already exists })</span></span></code> </pre> <br><h1 id="zaklyuchenie"> ç»“è®º </h1><br><p> - HLF        Go, Java, JavaScript, ,    , -  (Solidity)     /   -.      /       . </p><br><p>    HLF  ,  ,      (     .).  Hypeledger Fabric        , ..     . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN426705/">https://habr.com/ru/post/zh-CN426705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN426695/index.html">çˆ±å¥½è€…çš„æœºå™¨è§†è§‰ç›¸æœºã€‚ å¦‚ä½•ä½¿ç”¨ç›¸æœºè¿›è¡Œç¦»çº¿å¯¼èˆªï¼Ÿ</a></li>
<li><a href="../zh-CN426697/index.html">åœ¨Androidä¸‹ä½¿ç”¨LibUsbè®¾å¤‡</a></li>
<li><a href="../zh-CN426699/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç®€å•ï¼Œå¿«é€Ÿï¼Œé«˜æ•ˆå’Œå¯æ‰©å±•ã€‚ å‰è¨€ä¸å¼•è¨€</a></li>
<li><a href="../zh-CN426701/index.html">Flutter-è·¨å¹³å°å¼€å‘çš„æ–°è§†è§’</a></li>
<li><a href="../zh-CN426703/index.html">æ˜æ–¯å…‹çš„DataVizDayæœ‰è¶£çš„æ˜¯</a></li>
<li><a href="../zh-CN426707/index.html">å®¡æ‰¹ç³»ç»Ÿã€‚ æˆ‘ä»¬å¦‚ä½•å‘æ˜è‡ªè¡Œè½¦</a></li>
<li><a href="../zh-CN426709/index.html">JavaScriptè®¡æ—¶å™¨ï¼šæ‰€æœ‰æ‚¨éœ€è¦çŸ¥é“çš„</a></li>
<li><a href="../zh-CN426713/index.html">è‹±ç‰¹å°”è‡³å¼ºW-3175Xï¼šå®¶åº­ç”¨28æ ¸</a></li>
<li><a href="../zh-CN426717/index.html">æ¬ºéª—çš„é”™è§‰ï¼šåŸºäºé€†å‘é¢„æµ‹çš„è§†è§‰å…‰å­¦é”™è§‰</a></li>
<li><a href="../zh-CN426719/index.html">SIBURä¸Šçš„æ•°æ®ç§‘å­¦é»‘å®¢é©¬æ‹‰æ¾ï¼šè¿‡å»çš„æ ·å­</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>