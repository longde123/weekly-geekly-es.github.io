<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›ŒğŸ¿ ğŸ• ğŸ† Conte des anciennes icÃ´nes. L'Ã©nigme de 18 couleurs. Couleurs transparentes et inverses ğŸ¥‰ ğŸ¤¾ğŸ¼ ğŸ›’</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Peu de gens se moquent maintenant des kilo-octets supplÃ©mentaires ou deux. Mais il y a de telles personnes, et cette note a Ã©tÃ© Ã©crite juste pour un t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conte des anciennes icÃ´nes. L'Ã©nigme de 18 couleurs. Couleurs transparentes et inverses</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422495/"> Peu de gens se moquent maintenant des kilo-octets supplÃ©mentaires ou deux.  Mais il y a de telles personnes, et cette note a Ã©tÃ© Ã©crite juste pour un tel <s>nerd d'une</s> personne.  ) <br><br>  Dans ces cas isolÃ©s oÃ¹ j'ai eu besoin d'enregistrer une icÃ´ne expressive (.ico) de l'application et en mÃªme temps j'ai dÃ» Ã©conomiser des octets, j'ai utilisÃ© le hack suivant: j'ai enregistrÃ© l'image en mode 16 couleurs - mais!  - pas dans la palette fixe habituelle, mais dans la palette adaptative. <br><br>  Qu'est-ce que Ã§a donne?  IcÃ´ne 48x48, transparence 1 bit, 256 couleurs = 3774 octets, elle est Ã©galement en 16 couleurs = 1662 octets.  Le gain est de 2 kilo-octets, avec une lÃ©gÃ¨re diminution de la qualitÃ© d'image. <br><br><img src="https://habrastorage.org/webt/7r/hi/ph/7rhiphjjh6lvnh-k1qtcfdhzpmm.png"><br><br>  Un exemple.  De gauche Ã  droite: <br><br><ul><li>  Original 256 couleurs </li><li>  une palette fixe de 16 couleurs standard (et ici j'ai ramassÃ© une trappe pendant quelques minutes pour que l'image ait au moins une apparence dÃ©cente) </li><li>  palette adaptative de 16 couleurs + hachures (tramage). </li></ul><br>  Comment Ã§a marche?  Curieusement, l'icÃ´ne 16 couleurs porte toujours une palette.  Autrement dit, 99,9% des anciennes icÃ´nes portent exactement la mÃªme table de couleurs de 64 octets (4 octets par couleur).  Et, oui - il s'avÃ¨re qu'il peut Ãªtre reprogrammÃ©. <br><a name="habracut"></a><br>  Malheureusement, je ne connais pas le programme, qui peut parfaitement fonctionner avec de telles icÃ´nes.  Par consÃ©quent, voici la recette pour "crÃ©er une icÃ´ne" infÃ©rieure: prenez IrfanView, tÃ©lÃ©chargez une image dedans: soit une 16 couleurs prÃ©-prÃ©parÃ©e, soit rÃ©duisez le nombre de couleurs directement dedans: menu - image - rÃ©duire la profondeur de couleur ... - 16 couleurs.  Maintenant: menu - enregistrer sous ... - sÃ©lectionnez le format .ico.  C'est tout?  Non, pas tous: Irfan View ne sait pas comment travailler avec la transparence, il devra Ãªtre restaurÃ© manuellement dans un autre programme.  Microangelo Studio peut charger et modifier de telles icÃ´nes (hÃ©las, il ne permet pas de crÃ©er une telle bibliothÃ¨que Ã  partir de zÃ©ro, tout comme la crÃ©ation de telles icÃ´nes Ã  partir de zÃ©ro).  Nous chargeons l'icÃ´ne dans Microangelo et ... peut-Ãªtre que nous recevrons immÃ©diatement une fenÃªtre d'avertissement sur la Â«palette incorrecteÂ» - ce que cela signifie dans la pratique sera dÃ©crit plus tard.  Ã€ l'aide des outils Â«remplissageÂ» et Â«crayonÂ», nous marquons les zones transparentes;  Ã©crire;  c'est fait! <br><br>  C'est ce que j'ai fait auparavant, il y a une dizaine d'annÃ©es.  Maintenant, aprÃ¨s avoir soigneusement regardÃ© la palette Microangelo, j'ai des questions.  Quelle est cette Ã©trange palette, 18 couleurs?  Comment pouvez-vous stocker 18 couleurs dans un fichier?  Le nombre n'est pas rond, messieurs, les programmeurs ne le font pas;  ce n'est tout simplement pas pratique pour eux.  )) On peut voir que dans la palette il y a 16 couleurs unies et deux couleurs de service: Â«transparentÂ» et Â«inverseÂ».  Quel genre d '"inverse"?  - si une telle couleur se produit, elle affiche le nÃ©gatif de ce qui se trouve en dessous;  il est utilisÃ© le plus souvent dans les curseurs;  et le curseur, par essence et dans la structure du fichier, est Ã©galement une icÃ´ne.  Mais comment sont stockÃ©es toutes ces couleurs?  Si les points d'image ordinaires sont regroupÃ©s en 4 bits (16 couleurs), la transparence ne peut Ãªtre stockÃ©e que dans un masque de bits distinct (1 bit pour chaque point d'image).  D'accord, oÃ¹ est donc stockÃ©e l'inversion?  Un autre masque, ou quoi?  Pas Ã©conomique, mais possible ... Comptons. <br><br>  IcÃ´ne 48x48, 16 couleurs, 1 image.  La taille du fichier est de 1662 octets.  Qu'y a-t-il dedans?  J'imagine Ã  peine les subtilitÃ©s, mais j'essaie de comprendre.  La partie principale, l'image elle-mÃªme: 48 * 48/2 = 1152 octets.  Palette: 16 * 4 = 64 octets.  Le masque de transparence est de 48 * 48/8 = 288 octets.  En-tÃªte .ico, officiellement = 6 octets.  Description du cadre (1 pc.) D'aprÃ¨s la documentation = 16 octets.  Total: 1152 + 64 + 288 + 6 + 16 = 1526. Il y a probablement autre chose, car la taille rÃ©elle du fichier est plus grande - mais cela n'a pas d'importance;  une autre chose est importante, le reste de l '"incohÃ©rence" est petit: 136 octets, et cela ne permet Ã©videmment pas de placer un autre masque de bits de 288 octets.  Donc ... la couleur inverse est en quelque sorte intÃ©grÃ©e Ã  l'image elle-mÃªme.  Peut-Ãªtre que maintenant vous pouvez deviner par vous-mÃªme comment ils l'ont fait? <br><br>  Et ils l'ont fait, apparemment, comme ceci: dans les fenÃªtres d'origine (il semble, en commenÃ§ant par Win 95OSR2 complÃ¨tement, et dans Win XP et les plus rÃ©cents dÃ©jÃ  partiellement), dans les icÃ´nes et les curseurs Ã  proprement parler - il n'y avait pas de vÃ©ritable couleur transparente.  Si le masque alpha montrait: le curseur / icÃ´ne actuel est "transparent" - la couleur sous le curseur / l'icÃ´ne a Ã©tÃ© prise et XOR ("exclusif" ou ""; peut-Ãªtre qu'il n'y avait qu'une soustraction) - attention!  - avec la couleur de point actuelle tirÃ©e de la palette d'icÃ´nes. <br><br>  Qu'est ce que c'est?  S'il s'agissait de la premiÃ¨re couleur (noir dans une palette fixe), XOR n'a rien fait avec l'arriÃ¨re-plan - la couleur est devenue transparente.  S'il s'agissait de la derniÃ¨re couleur (dans une palette fixe - blanc) - la couleur a complÃ¨tement changÃ©, transformÃ©e en nÃ©gatif.  C'est tout le secret de la faÃ§on dont Â«18 couleursÂ» ont Ã©tÃ© stockÃ©es ... C'est-Ã -dire, encore une fois: Â«transparentÂ» = masque alpha noir (+), Â«inverseÂ» = masque alpha blanc (+).  Et maintenant - parlons des pÃ©pins. <br><br>  L'avertissement mentionnÃ© ci-dessus par Microangelo dÃ©clare: "vous n'avez pas de couleurs blanches et noires Ã  part entiÃ¨re dans la palette, travailler avec la transparence sera incorrect!"  En effet, notre palette adaptative peut trÃ¨s bien se passer de noir ou de blanc.  Comment fonctionnera alors la transparence?  Oh, exactement comme nous nous y attendons: il faudra de la couleur dans la palette (par exemple, du vert), "XOR" avec le fond, et nous obtiendrons une belle couleur violette au lieu de la transparence.  )) Ou un autre exemple - le noir est accidentellement tombÃ© Ã  la place de la derniÃ¨re couleur de la palette: et Â«l'inversionÂ» s'est transformÃ©e en la transparence Ã  part entiÃ¨re habituelle. <br><br><img src="https://habrastorage.org/webt/ri/69/um/ri69um6yqmwzvzwbbtywqwimqpg.png"><br><br>  <i>Exemple: Ã  gauche est une palette standard, Ã  droite est reprogrammÃ©e.</i>  <i>A gauche, la transparence (P) et l'inversion (I) fonctionnent comme il se doit;</i>  <i>Ã  droite - Ã©videmment pas.</i> <br><br>  Cependant, nous ne pouvons observer tous ces charmes d'icÃ´nes que dans Windows d'origine.  Les systÃ¨mes d'exploitation modernes, tels que Win 10, ignorent les couleurs de la palette, et le masque de bits Â«transparenceÂ» fonctionne toujours comme la transparence dans sa forme la plus pure: il n'y a pas de XOR, et il n'y a pas non plus d'inversion.  Cependant, dans le mÃ©canisme d'affichage du curseur, il y a toujours compatibilitÃ© - un bon vieux circuit Ã©conomique Ã  part entiÃ¨re y fonctionne;  "Warm, lamp", et ... peu de gens comprennent et ont besoin. <br><br><img src="https://habrastorage.org/webt/o_/r9/lo/o_r9lonhiwt4dyhaecuvewmsapw.png"><br><br>  <i>Exemple: affichage diffÃ©rent des mÃªmes icÃ´nes sous Windows XP et Windows 7.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422495/">https://habr.com/ru/post/fr422495/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422483/index.html">MIS. Insertions et organes distants</a></li>
<li><a href="../fr422485/index.html">Comment Ã©conomiser de l'argent lors du dÃ©marrage d'une entreprise aux Ã‰tats-Unis: enregistrement d'entreprise, bureau, comptabilitÃ© et promotion</a></li>
<li><a href="../fr422487/index.html">Guide de dÃ©marrage rapide des variables CSS (cas d'utilisation, syntaxe et exemples)</a></li>
<li><a href="../fr422491/index.html">L'argent dÃ©cide. Â«Nous avons trois dÃ©veloppeurs, mais nous ne savons pas comment travaillerÂ»</a></li>
<li><a href="../fr422493/index.html">Kubernetes (k8s) + Helm + GitLab CI / CD. DÃ©ployer correctement</a></li>
<li><a href="../fr422497/index.html">L'ICANN a publiÃ© un guide dÃ©taillÃ© sur ce Ã  quoi s'attendre lors de la mise Ã  niveau du KSK dans la zone racine</a></li>
<li><a href="../fr422499/index.html">Encore une fois sur les composants web ...</a></li>
<li><a href="../fr422501/index.html">De nouveaux processus technologiques pour la production de micropuces sont de plus en plus repoussÃ©s - pourquoi?</a></li>
<li><a href="../fr422507/index.html">PHP 7.3. Quoi de neuf</a></li>
<li><a href="../fr422509/index.html">RÃ©sumÃ© du livre "Never Eat Alone"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>