<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>さ   Una breve historia sobre c贸mo la conveniencia a veces se dispara en la rodilla   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artem Azariev, Jefe del Centro de Competencia de Canales de Servicio Remoto de la Direcci贸n de Tecnolog铆as de la Informaci贸n del ICD 

 Hola Habr! 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Una breve historia sobre c贸mo la conveniencia a veces se dispara en la rodilla</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mkb/blog/471738/">  <b>Artem Azariev, Jefe del Centro de Competencia de Canales de Servicio Remoto de la Direcci贸n de Tecnolog铆as de la Informaci贸n del ICD</b> <br><br>  Hola Habr! <br><br>  Mi nombre es Artyom Azariev, soy el l铆der del equipo de Android del Banco de Cr茅dito de Mosc煤 y hoy quiero hablar sobre la seguridad de las aplicaciones desde el punto de vista de las bibliotecas de depuraci贸n.  Hace un par de a帽os trabaj茅 por cuenta propia, luego, durante 4 a帽os, particip茅 en un desarrollo completo para un sistema operativo m贸vil.  Dio la casualidad de que en los a帽os de mi trabajo independiente para mejorar mis propias calificaciones, toqu茅 el tema de la ingenier铆a inversa de las aplicaciones de Android, y gradualmente se convirti贸 en mi hobby. <br><a name="habracut"></a><br><h3>  Introduccion </h3><br>  No es ning煤n secreto que durante mucho tiempo Android Studio no present贸 ning煤n mecanismo para recibir adecuadamente los datos de la aplicaci贸n desde el dispositivo: el contenido de la base de datos, SharedPrefrences, solicitudes de red.  Todos sufrieron, incluidos gigantes como Facebook. <br><br>  Fueron ellos quienes dieron a la comunidad una biblioteca extremadamente 煤til para depurar Shetho (https://github.com/facebook/stetho) con una integraci贸n muy simple en el proyecto en solo un par de l铆neas.  No hablar茅 sobre la biblioteca en s铆; lo m谩s probable es que muchas personas ya lo sepan, pero a qui茅n le importa, lo leen por su cuenta. <br><br>  La integraci贸n de esta biblioteca es la siguiente: <br><br><img src="https://habrastorage.org/webt/k4/7l/wv/k47lwvu8oijudnpxoie9hratxnc.png"><br><br><img src="https://habrastorage.org/webt/w6/fg/gg/w6fggg1w8njm8hxdbz6mtzfnc1y.png"><br><br>  Al usar el navegador Chrome, tenemos acceso a los contenidos de las bases de datos y a la configuraci贸n almacenada en el dispositivo, y si conectamos el complemento para okhttp3, tambi茅n a los contenidos de las solicitudes de red. <br><br><img src="https://habrastorage.org/webt/_0/ml/8-/_0ml8-l9qjozwz0f7f31e6zw1s0.png"><br><br>  "Pero oye, 驴tambi茅n estar谩 en la versi贸n de lanzamiento?"  - se preguntar谩 el desarrollador atento.  Pasemos a la descripci贸n de la biblioteca: 驴qu茅 se nos aconseja sobre esto? <br><br>  El proyecto de muestra muestra que esta biblioteca solo debe inicializarse en la rama de depuraci贸n sobrecargando el manifiesto en una de las opciones de compilaci贸n. <br><br><img src="https://habrastorage.org/webt/uo/-b/yp/uo-byphfesmd0r28azi_48glotc.png"><br><br>  Ensamblamos el ensamblaje de lanzamiento con la minificaci贸n habilitada (bandera minifyEnabled).  Estamos revisando el navegador, no vemos ninguna aplicaci贸n disponible para depurar y silenciosamente nos vamos a dormir. <br><br>  <i>La minificaci贸n es un proceso destinado a reducir el tama帽o del c贸digo fuente mediante la eliminaci贸n de caracteres innecesarios sin cambiar su funcionalidad.</i>  <i>La herramienta Proguard utilizada en Android tambi茅n est谩 involucrada en la limpieza del proyecto del c贸digo no utilizado.</i> <br><br><h3>  Hackers </h3><br>  Cualquier ingenier铆a inversa de la aplicaci贸n comienza con el estudio de posibles marcadores y puertas traseras, que los desarrolladores dejaron amablemente por s铆 mismos. <br><br>  Primero, descompilamos la aplicaci贸n en Java tanto como sea posible y estudiamos el 谩rbol de paquetes. <br><br><img src="https://habrastorage.org/webt/jp/qb/az/jpqbazk07dlwt-sorqslmvgkpsk.png"><br><br>  Lo m谩s dulce que se puede encontrar en la aplicaci贸n atacada es el viejo Stetho.  La minificaci贸n configurada de forma predeterminada no la elimina, y en general toda la base de c贸digo de esta biblioteca simplemente se arrastra a una compilaci贸n de producci贸n. <br><br>  Vi muchas aplicaciones de compa帽铆as bastante buenas y grandes que han dejado tal biblioteca en versiones de producci贸n durante muchos a帽os. <br><br>  Alguien preguntar谩: 驴Y qu茅 es?  Esta apagado  Adem谩s, incluso si lo enciendes, intenta compilar esta aplicaci贸n m谩s tarde ". <br><br>  Es cierto que descompilar en Java casi nunca proporciona un c贸digo de trabajo del 100%.  Pero hay smali / backsmali. <br>  Smali / backsmali es un ensamblador / desensamblador para el formato dex utilizado por dalvik, una implementaci贸n de Java VM en Android. <br><br>  Al desmontar nuestra aplicaci贸n, veremos que nada est谩 realmente incluido. <br><br><img src="https://habrastorage.org/webt/jf/hg/3t/jfhg3thv5bfr4lwft73x3bsxje4.png"><br><br>  Pero, despu茅s de agregar un par de l铆neas y tener en el proyecto todo el c贸digo de la biblioteca, nosotros, sin esforzarnos particularmente, podemos volver a activarlo. <br><br><img src="https://habrastorage.org/webt/ta/8a/sl/ta8aslqtxfpexzjy7uydydovmt4.png"><br><br>  Para el complemento okhttp3, el soporte tambi茅n se habilita de la misma manera: agregando un Interceptor a OkhttpClient. <br><br>  Despu茅s de haber recogido la aplicaci贸n (y es f谩cil hacerlo desde smali), vemos que la depuraci贸n a trav茅s de stetho est谩 nuevamente disponible, y todos sus datos en el repositorio de configuraci贸n local, toda su API est谩 completamente frente a los ojos de hackers astutos. <br><br><h3>  Que hacer </h3><br>  Hay muchas opciones para excluir el paquete de la compilaci贸n final.  Personalmente, prefiero escribir un peque帽o contenedor para inicializar la biblioteca Stetho y descomponer sus diversas implementaciones de acuerdo con las opciones de ensamblaje. <br>  liberar <br><br><img src="https://habrastorage.org/webt/rj/-s/bj/rj-sbjt1o7yb1pnvvcea6-g-sj8.png"><br><br>  depurar <br><br><img src="https://habrastorage.org/webt/4e/lb/e2/4elbe2hs_hgq8loaf1igrrnfctm.png"><br><br>  Y tambi茅n indique que esta base de c贸digo solo es necesaria en la compilaci贸n de depuraci贸n. <br><br><img src="https://habrastorage.org/webt/qf/ge/1n/qfge1n64lykacrpe1hrmb3qcuko.png"><br><br><h3>  Puede exhalar </h3><br>  Me gustar铆a concluir expresando los principios b谩sicos que uso cuando trabajo en el contexto de la seguridad de las aplicaciones de Android: <br><br><ul><li>  Minimiza y, si es posible, ofusca todo lo que obtienes. <br><br>  En cualquier caso, esto complica el an谩lisis del c贸digo descompilado.  Un argumento adicional para crear canas en la cabeza del pirata inform谩tico ser谩 la bandera de reempaquetado de clases, que mover谩 las clases minimizadas a un solo paquete.  Habr谩 muchos de ellos. </li><li>  Explore sus propias aplicaciones. <br><br>  Al menos una inspecci贸n superficial del 谩rbol de sus paquetes puede decir mucho sobre la estructura utilizada en el proyecto, los marcos, las bibliotecas.  Lo que obviamente no pertenece all铆 debe ser eliminado sin piedad. </li><li>  Cualquier herramienta puede tarde o temprano dispararte en la rodilla. </li></ul><br>  Cuando agregue algo a su proyecto, incluso por buenas razones, piense en c贸mo hacerlo correctamente y cu谩nto lo necesita. <br><br>  Espero que mi experiencia te sea 煤til. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471738/">https://habr.com/ru/post/471738/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471722/index.html">C贸mo un chico de 17 a帽os port贸 un 茅xito arcade de los 80 a las computadoras</a></li>
<li><a href="../471724/index.html">Necesidades 谩giles y cerebrales: manejo del estr茅s</a></li>
<li><a href="../471726/index.html">M茅todo moderno para medir la respuesta al impulso y la distorsi贸n no lineal.</a></li>
<li><a href="../471728/index.html">Avalonia mis pros y contras</a></li>
<li><a href="../471736/index.html">Sensor Ethernet sin contacto</a></li>
<li><a href="../471740/index.html">Servicio de cach茅 inteligente basado en ZeroMQ y Tarantool</a></li>
<li><a href="../471742/index.html">Sberbank AI Journey. C贸mo ense帽amos a una red neuronal a tomar un examen</a></li>
<li><a href="../471744/index.html">Tarantool Data Grid: arquitectura y caracter铆sticas</a></li>
<li><a href="../471746/index.html">Gu铆a completa para configurar encabezados HTTP para seguridad</a></li>
<li><a href="../471748/index.html">Optimizaci贸n de farmacia: lo que hicimos con las matem谩ticas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>