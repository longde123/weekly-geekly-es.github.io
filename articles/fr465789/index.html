<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüé® üö∫ ‚ûó Formation Cisco 200-125 CCNA v3.0. Jour 29. PAT et NAT üë∏üèª üëåüèæ üëåüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous √©tudierons PAT (Port Address Translation), une technologie de traduction d'adresses IP √† l'aide de ports, et NAT (Network Address Tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Formation Cisco 200-125 CCNA v3.0. Jour 29. PAT et NAT</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/465789/"> Aujourd'hui, nous √©tudierons PAT (Port Address Translation), une technologie de traduction d'adresses IP √† l'aide de ports, et NAT (Network Address Translation), une technologie de traduction d'adresses IP de paquets de transit.  PAT est un cas particulier de NAT.  Nous couvrirons trois sujets: <br><br>  - adresses IP priv√©es ou internes (intranet, local) et adresses IP publiques ou externes; <br>  - NAT et PAT; <br>  - configurer NAT / PAT. <br><br>  Commen√ßons par les adresses IP priv√©es.  Nous savons qu'ils sont divis√©s en trois classes: A, B et C. <br><br><img src="https://habrastorage.org/webt/ob/rv/le/obrvlewzzejxlfwxxbi_90zkrwe.jpeg"><br><br>  Les adresses internes de classe A occupent la plage de dizaines de 10.0.0.0 √† 10.255.255.255, et les adresses externes occupent la plage de 1.0.0.0 √† 9. 255.255.255 et de 11.0.0.0 √† 126.255.255.255. <br><br>  Les adresses internes de classe B vont de 172.16.0.0 √† 172.31.255.255, et les adresses externes vont de 128.0.0.0 √† 172.15.255.255 et de 172.32.0.0 √† 191.255.255.255. <a name="habracut"></a><br><br>  Les adresses internes de classe C vont de 192.168.0.0 √† 192.168.255.255, et les adresses externes vont de 192.0.0 √† 192.167.255.255 et de 192.169.0.0 √† 223.255.255.255. <br><br><img src="https://habrastorage.org/webt/-e/_r/ba/-e_rba3erd3jnyymki4ebjwu9fs.jpeg"><br><br>  Les adresses de classe A sont les adresses / 8, la classe B - / 12 et la classe C - / 16.  Ainsi, les adresses IP externes et internes de diff√©rentes classes occupent des plages diff√©rentes. <br><br>  Nous avons discut√© √† plusieurs reprises de la diff√©rence entre les adresses IP priv√©es et publiques.  De mani√®re g√©n√©rale, si nous avons un routeur et un groupe d'adresses IP internes, lorsqu'ils tentent d'acc√©der √† Internet, le routeur les convertit en adresses IP externes.  Les adresses internes sont utilis√©es exclusivement sur les r√©seaux locaux et non sur Internet. <br><br>  Si j'utilise la ligne de commande pour afficher les param√®tres r√©seau de mon ordinateur, j'y verrai mon adresse IP LAN interne 192.168.1.103. <br><br><img src="https://habrastorage.org/webt/hq/tx/wf/hqtxwfez60be9ufwpywe72ldll4.jpeg"><br><br>  Pour conna√Ætre votre adresse IP publique, vous pouvez utiliser un service Internet tel que ¬´Quelle est mon IP¬ª?  Comme vous pouvez le voir, l'adresse externe de l'ordinateur 78.100.196.163 est diff√©rente de son adresse interne. <br><br><img src="https://habrastorage.org/webt/wm/1n/w0/wm1nw0n_syo74vtnmskictzyx8e.jpeg"><br><br>  Dans tous les cas, mon ordinateur est visible sur Internet pr√©cis√©ment par l'adresse IP externe.  Ainsi, l'adresse interne de mon ordinateur est 192.168.1.103, et l'externe est 78.100.196.163.  L'adresse interne est utilis√©e uniquement pour la communication locale, vous ne pouvez pas acc√©der √† Internet avec elle, pour cela, vous avez besoin d'une adresse IP publique.  Vous pouvez vous rappeler pourquoi la s√©paration a √©t√© faite en adresses priv√©es et publiques en consultant le didacticiel vid√©o Jour 3. <br><br>  Consid√©rez ce qu'est le NAT.  Il existe trois types de NAT: NAT statique, dynamique et surcharg√©, ou PAT. <br><br><img src="https://habrastorage.org/webt/sq/os/yh/sqosyhlr7iwvdpydrfys3xigo9m.jpeg"><br><br>  Il y a 4 termes dans Cisco qui d√©crivent le NAT.  Comme je l'ai dit, le NAT est un m√©canisme de conversion des adresses internes en adresses externes.  Si un appareil connect√© √† Internet re√ßoit un paquet d'un autre appareil du r√©seau local, il supprimera simplement ce paquet, car le format de l'adresse interne ne correspond pas au format des adresses utilis√©es sur Internet mondial.  Par cons√©quent, l'appareil doit recevoir une adresse IP publique pour acc√©der √† Internet. <br>  Ainsi, le premier terme est Inside Local, ce qui signifie l'adresse IP de l'h√¥te sur le LAN interne.  Autrement dit, il s'agit de l'adresse source principale de type 192.168.1.10.  Le deuxi√®me terme, Inside Global, est l'adresse IP de l'h√¥te local, sous laquelle elle est visible sur le r√©seau externe.  Dans notre cas, il s'agit de l'adresse IP du port externe du routeur 200.124.22.10. <br><br><img src="https://habrastorage.org/webt/b_/ia/sj/b_iasjqtn7zpepgxzpykgutrnxg.jpeg"><br><br>  Vous pouvez dire que Inside Local est une adresse IP priv√©e et Inside Global est une adresse IP publique.  N'oubliez pas que le terme Inside est utilis√© pour faire r√©f√©rence √† la source du trafic et Outside est utilis√© pour d√©signer le but du trafic.  Outside Local est l'adresse IP de l'h√¥te sur le r√©seau externe, sous laquelle elle est visible pour le r√©seau interne.  Autrement dit, il s'agit de l'adresse du destinataire visible depuis le r√©seau interne.  Un exemple d'une telle adresse est l'adresse IP 200.124.22.100 d'un appareil situ√© sur Internet. <br><br><img src="https://habrastorage.org/webt/ey/sm/o-/eysmo-pr4ikwlwag52qkmag4zeu.jpeg"><br><br>  Outside Global est l'adresse IP de l'h√¥te visible sur le r√©seau externe.  Dans la plupart des cas, les adresses Outside Local et Outside Global se ressemblent, car m√™me apr√®s la conversion, l'adresse IP de destination est la m√™me pour la source qu'avant la conversion. <br><br><img src="https://habrastorage.org/webt/bg/tn/xq/bgtnxq5blz5qdtgtnpqddu8rr08.jpeg"><br><br>  Consid√©rez ce qu'est un NAT statique.  Le NAT statique signifie la conversion un-√†-un des adresses IP internes en conversion externe ou un-√†-un.  Lorsque les appareils envoient du trafic vers Internet, leurs adresses internes Inside Local sont converties en adresses internes Inside Global. <br><br><img src="https://habrastorage.org/webt/oo/n6/ql/oon6qlova0vcwlg7bovpduisxho.jpeg"><br><br>  Il y a 3 appareils dans notre r√©seau local, et lorsqu'ils vont se connecter, chacun d'eux obtient sa propre adresse Inside Global.  Ces adresses sont attribu√©es statiquement aux sources de trafic.  Le principe un-√†-un signifie que si 100 appareils sont situ√©s sur le r√©seau local, ils re√ßoivent 100 adresses externes. <br><br>  NAT a sembl√© sauver Internet, ce qui s'est termin√© par des adresses IP publiques.  Gr√¢ce au NAT, de nombreuses entreprises, de nombreux r√©seaux peuvent avoir une adresse IP externe commune, dans laquelle les adresses des appareils locaux seront converties lors de l'acc√®s √† Internet.  Vous pouvez dire que dans ce cas de NAT statique, il n'y a pas d'√©conomie dans le nombre d'adresses, car une centaine d'ordinateurs locaux se voient attribuer une centaine d'adresses externes, et vous aurez absolument raison.  Cependant, le NAT statique pr√©sente encore plusieurs avantages. <br><br>  Par exemple, nous avons un serveur avec une adresse IP interne de 192.168.1.100.  Si un appareil d'Internet veut le contacter, il ne pourra pas le faire en utilisant l'adresse de destination interne, pour cela, il doit utiliser l'adresse externe du serveur 200.124.22.3.  Si le NAT statique est configur√© dans le routeur, tout le trafic adress√© √† 200.124.22.3 est automatiquement transf√©r√© √† 192.168.1.100.  Cela fournit un acc√®s externe aux p√©riph√©riques du r√©seau local, dans ce cas, au serveur Web de l'entreprise, ce qui peut √™tre n√©cessaire dans certains cas. <br><br>  Consid√©rez le NAT dynamique.  Il est tr√®s similaire √† statique, mais n'attribue pas d'adresses externes permanentes √† chaque p√©riph√©rique local.  Par exemple, nous avons 3 appareils locaux et seulement 2 adresses externes.  Si le deuxi√®me appareil veut se connecter, il se verra attribuer la premi√®re adresse IP gratuite.  Si apr√®s cela, le serveur Web veut se connecter, le routeur lui attribuera la deuxi√®me adresse externe disponible.  Si apr√®s cela, le premier appareil veut acc√©der au r√©seau externe, aucune adresse IP ne sera disponible pour lui et le routeur abandonnera son paquet. <br><br><img src="https://habrastorage.org/webt/id/uf/lt/iduflt-hi8gyfgpgkotj8sagyxs.jpeg"><br><br>  Nous pouvons avoir des centaines d'appareils avec des adresses IP internes, et chacun de ces appareils peut √™tre mis en ligne.  Mais comme nous n'avons pas d'attribution statique d'adresses externes, pas plus de 2 appareils sur cent ne pourront acc√©der √† Internet, car nous n'avons que deux adresses externes attribu√©es dynamiquement. <br><br>  Les appareils Cisco ont un temps de traduction d'adresse fixe de 24 heures par d√©faut.  Il peut √™tre chang√© en 1,2,3, 10 minutes, √† tout moment.  Pass√© ce d√©lai, les adresses externes sont lib√©r√©es et automatiquement renvoy√©es au pool d'adresses.  Si √† ce moment le premier appareil veut se connecter et qu'une adresse externe est disponible, il la recevra.  Le routeur contient une table NAT qui est mise √† jour dynamiquement et jusqu'√† l'expiration du temps de conversion, l'adresse attribu√©e est enregistr√©e par l'appareil.  Autrement dit, le NAT dynamique fonctionne selon le principe: "qui est venu en premier, ils ont servi". <br><br>  Consid√©rez ce qui constitue un NAT ou PAT surcharg√©.  Il s'agit du type de NAT le plus courant.  Votre r√©seau domestique peut avoir de nombreux appareils - un PC, un smartphone, un ordinateur portable, une tablette et tous sont connect√©s √† un routeur qui a une adresse IP externe.  Ainsi, PAT permet √† de nombreux appareils dot√©s d'adresses IP internes de se connecter simultan√©ment sous une adresse IP externe.  Cela est possible car chaque adresse IP interne priv√©e utilise un num√©ro de port sp√©cifique lors d'une session de communication. <br>  Supposons que nous ayons une adresse publique 200.124.22.1 et de nombreux p√©riph√©riques locaux.  Ainsi, lors de l'acc√®s √† Internet, tous ces h√¥tes recevront la m√™me adresse 200.124.22.1.  La seule chose qui les distinguera les uns des autres est le num√©ro de port. <br>  Si vous vous souvenez de la discussion sur la couche transport, vous savez que la couche transport contient des num√©ros de port et que le num√©ro de port source est un nombre al√©atoire. <br><br><img src="https://habrastorage.org/webt/bd/6v/rd/bd6vrdsnsfezgoads3mbzzphcco.jpeg"><br><br>  Supposons qu'il existe un h√¥te sur le r√©seau externe avec une adresse IP de 200.124.22.10, qui est connect√© √† Internet.  Si l'ordinateur 192.168.1.11 souhaite contacter l'ordinateur 200.124.22.10, il cr√©era un port source al√©atoire 51772. Dans ce cas, le port de destination de l'ordinateur sur le r√©seau externe sera 80. <br><br>  Lorsque le routeur re√ßoit un paquet d'ordinateur local envoy√© √† un r√©seau externe, il traduit son adresse locale locale locale en adresse globale globale 200.124.22.1 et attribue le port 23556 au port. Le paquet atteindra l'ordinateur 200.124.22.10 et devra renvoyer une r√©ponse conform√©ment √† la proc√©dure de prise de contact, la destination sera l'adresse 200.124.22.1 et le port 23556. <br><br>  Le routeur a une table de traduction NAT, donc, apr√®s avoir re√ßu un paquet d'un ordinateur externe, il d√©terminera l'adresse Inside Local correspondant √† l'adresse Inside Global comme 192.168.1.11: 51772 et lui transmettra le paquet.  Apr√®s cela, la connexion entre les deux ordinateurs peut √™tre consid√©r√©e comme √©tablie. <br>  Dans le m√™me temps, vous pouvez avoir des centaines d'appareils qui utilisent la m√™me adresse 200.124.22.1 pour la communication, mais des num√©ros de port diff√©rents, afin qu'ils puissent tous se connecter en ligne en m√™me temps.  C'est pourquoi PAT est une m√©thode de traduction si populaire. <br><br>  Examinons la configuration du NAT statique.  Pour tout r√©seau, tout d'abord, il est n√©cessaire de d√©terminer les interfaces d'entr√©e et de sortie.  Le diagramme montre un routeur par lequel le trafic est transf√©r√© du port G0 / 0 au port G0 / 1, c'est-√†-dire d'un r√©seau interne √† un r√©seau externe.  Ainsi, nous avons une interface d'entr√©e 192.168.1.1 et une interface de sortie 200.124.22.1. <br><br><img src="https://habrastorage.org/webt/rj/nc/o6/rjnco6mmewiiildmwtu0gn8ixs4.jpeg"><br><br>  Pour configurer NAT, nous allons √† l'interface G0 / 0 et d√©finissons les param√®tres ip 192.168.1.1 255.255.255.0 ip ip et indiquons que cette interface est l'entr√©e √† l'aide de la commande ip nat inside. <br><br><img src="https://habrastorage.org/webt/rf/dd/xt/rfddxtoq7k4bti2dprru9jriheq.jpeg"><br><br>  De m√™me, nous configurons NAT sur l'interface de sortie G0 / 1 en sp√©cifiant l'adresse IP 200.124.22.1, le masque de sous-r√©seau 255.255.255.0 et ip nat ext√©rieur.  N'oubliez pas que la traduction NAT dynamique se fait toujours de l'entr√©e vers l'interface de sortie, de l'int√©rieur vers l'ext√©rieur.  Naturellement, pour le NAT dynamique, la r√©ponse vient de l'interface d'entr√©e via l'interface de sortie, mais lorsque le trafic est initi√©, la direction d'entr√©e-sortie est d√©clench√©e.  Dans le cas d'un NAT statique, l'initiation du trafic peut se produire dans n'importe quelle direction - in-out ou out-in. <br><br>  Ensuite, nous devons cr√©er une table de NAT statique, o√π chaque adresse locale correspond √† une adresse globale distincte.  Dans notre cas, il y a 3 appareils, donc le tableau se composera de 3 entr√©es qui indiquent l'adresse IP locale int√©rieure de la source, qui se traduit par l'adresse globale int√©rieure: ip nat dans statique 192.168.1.10 200.124.22.1. <br>  Ainsi, en NAT statique, vous prescrivez manuellement une traduction pour chaque adresse d'h√¥te local.  Maintenant, je vais aller √† Packet Tracer et faire les r√©glages d√©crits ci-dessus. <br><br><img src="https://habrastorage.org/webt/mz/td/sh/mztdshpsmzcjt5zsb7xuifiacp8.jpeg"><br><br>  En haut, nous avons le serveur 192.168.1.100, en dessous se trouve l'ordinateur 192.168.1.10 et tout en bas se trouve l'ordinateur 192.168.1.11.  Le port G0 / 0 du routeur 0 a une adresse IP de 192.168.1.1 et le port G0 / 1 a 200.124.22.1.  Dans le "cloud" illustrant Internet, j'ai plac√© Router1, auquel une adresse IP de 200.124.22.10 a √©t√© attribu√©e. <br><br>  J'entre dans les param√®tres de Router1 et tape la commande debug ip icmp.  D√©sormais, d√®s que le ping atteint ce p√©riph√©rique, un message de d√©bogage appara√Æt dans la fen√™tre des param√®tres indiquant le type de package dont il s'agit. <br>  Configurons le routeur Router0.  Je passe en mode de param√®tres globaux et appelle l'interface G0 / 0.  Ensuite, j'entre la commande ip nat inside, puis je vais dans l'interface g0 / 1 et je saisis la commande ip nat outside.  Ainsi, j'ai assign√© les interfaces d'entr√©e et de sortie du routeur.  Maintenant, je dois configurer manuellement les adresses IP, c'est-√†-dire transf√©rer les lignes du tableau ci-dessus vers les param√®tres: <br><br>  IP nat √† l'int√©rieur de la source statique 192.168.1.10 200.124.22.1 <br>  IP nat √† l'int√©rieur de la source statique 192.168.1.11 200.124.22.2 <br>  IP nat √† l'int√©rieur de la source statique 192.168.1.100 200.124.22.3 <br><br><img src="https://habrastorage.org/webt/tb/px/-f/tbpx-flkjx4vwlsd6ee2rljrky0.jpeg"><br><br>  Maintenant, je vais envoyer une requ√™te ping √† Router1 √† partir de chacun de nos appareils et voir quelles adresses IP le ping qu'il recevra affichera.  Pour ce faire, je place la fen√™tre CLI ouverte du routeur R1 sur le c√¥t√© droit de l'√©cran pour voir les messages de d√©bogage.  Maintenant, je vais sur le terminal de ligne de commande PC0 et envoie une requ√™te ping √† l'adresse 200.124.22.10.  Apr√®s cela, un message appara√Æt dans la fen√™tre indiquant que le ping a √©t√© re√ßu de l'adresse IP 200.124.22.1.  Cela signifie que l'adresse IP de l'ordinateur local 192.168.1.10 a √©t√© convertie en adresse globale 200.124.22.1. <br><br><img src="https://habrastorage.org/webt/ax/ei/g6/axeig6imwtfp-bxxjjmz0uh6uum.jpeg"><br><br>  Je fais de m√™me avec le prochain ordinateur local et je vois que son adresse a √©t√© convertie en 200.124.22.2.  Ensuite, j'envoie une requ√™te ping depuis le serveur et je vois l'adresse 200.124.22.3. <br>  Ainsi, lorsque le trafic provenant du p√©riph√©rique LAN atteint le routeur sur lequel le NAT statique est configur√©, le routeur conform√©ment au tableau convertit l'adresse IP locale en adresse globale et envoie le trafic vers le r√©seau externe.  Pour v√©rifier la table NAT, j'entre la commande show ip nat translations. <br><br><img src="https://habrastorage.org/webt/5d/-9/rx/5d-9rxvls9gdzoz_aanqpbdxeqe.jpeg"><br><br>  Maintenant, nous pouvons voir toutes les transformations que le routeur effectue.  Dans la premi√®re colonne d'Inside Global se trouve l'adresse de l'appareil avant la diffusion, c'est-√†-dire l'adresse sous laquelle l'appareil est visible depuis le r√©seau externe, puis l'adresse Inside Local, c'est-√†-dire l'adresse de l'appareil sur le r√©seau local.  La troisi√®me colonne affiche Outside Local et la quatri√®me affiche l'adresse Outside Global, les deux √©tant les m√™mes car nous ne traduisons pas l'adresse IP de destination.  Comme vous pouvez le voir, apr√®s quelques secondes, la table s'est effac√©e car un court d√©lai de ping a √©t√© d√©fini dans Packet Tracer. <br><br>  Je peux envoyer une requ√™te ping au serveur √† partir du routeur R1 √† l'adresse 200.124.22.3, et si je reviens aux param√®tres du routeur, vous pouvez voir que le tableau √©tait √† nouveau rempli de quatre lignes de ping avec l'adresse de destination convertie 192.168.1.100. <br><br><img src="https://habrastorage.org/webt/xx/5i/nq/xx5inqtiknpu90hl-mqjrheahti.jpeg"><br><br>  Comme je l'ai dit, m√™me si le d√©lai de diffusion a fonctionn√©, lorsque le trafic est initi√© depuis une source externe, le m√©canisme NAT est automatiquement activ√©.  Cela se produit uniquement lors de l'utilisation de NAT statique. <br><br>  Voyons maintenant comment fonctionne le NAT dynamique.  Dans notre exemple, il y a 2 adresses publiques pour trois appareils sur le r√©seau local, cependant, il peut y avoir des dizaines et des centaines de ces h√¥tes priv√©s.  En m√™me temps, seuls 2 appareils peuvent √™tre connect√©s.  Consid√©rez quelle est, en outre, la diff√©rence entre NAT statique et dynamique. <br><br>  Comme dans le cas pr√©c√©dent, vous devez d'abord d√©terminer les interfaces d'entr√©e et de sortie du routeur.  Ensuite, nous cr√©ons une sorte de liste d'acc√®s, mais ce n'est pas l'ACL dont nous avons parl√© dans la le√ßon pr√©c√©dente.  Cette liste d'acc√®s est utilis√©e pour identifier le trafic que nous voulons convertir.  Ici appara√Æt le nouveau terme ¬´trafic int√©ressant¬ª, ou ¬´trafic int√©ressant¬ª.  C'est du trafic qui vous int√©resse pour une raison quelconque, et lorsque ce trafic correspond aux termes de la liste d'acc√®s, il tombe sous l'action de NAT et est converti.  Ce terme est applicable au trafic dans de nombreux cas, par exemple, dans le cas des VPN, ¬´int√©ressant¬ª est appel√© trafic qu'ils vont traverser un tunnel VPN. <br><br>  Nous devons cr√©er une ACL qui identifie le trafic int√©ressant, dans notre cas c'est le trafic de l'ensemble du r√©seau 192.168.1.0, avec lequel le masque inverse 0.0.0.255 est indiqu√©. <br><br><img src="https://habrastorage.org/webt/rq/ep/rp/rqeprpll-v1nzyru_dewaflnj9o.jpeg"><br><br>  Ensuite, nous devons cr√©er un pool NAT, pour lequel nous utilisons la commande ip nat pool &lt;nom du pool&gt; et sp√©cifions le pool d'adresses IP 200.124.22.1 200.124.22.2.  Cela signifie que nous ne fournissons que deux adresses IP externes.  Ensuite, la commande utilise le mot cl√© netmask et entre le masque de sous-r√©seau 255.255.255.252.  Le dernier octet du masque est (255 - le nombre d'adresses de pool est 1), donc si vous avez 254 adresses dans le pool, le masque de sous-r√©seau sera 255.255.255.0.  Ceci est un param√®tre tr√®s important, donc lors de la configuration du NAT dynamique, veillez √† entrer la valeur de masque de r√©seau correcte. <br><br>  Ensuite, nous utilisons une commande qui d√©marre le m√©canisme NAT: ip nat dans la liste sourse 1 pool NWKING, o√π NWKING est le nom du pool et la liste 1 signifie la liste d'acc√®s ACL num√©ro1.  N'oubliez pas - pour que cette commande fonctionne, vous devez d'abord cr√©er un pool d'adresses dynamiques et une liste d'acc√®s. <br><br>  Donc, dans nos conditions, le premier appareil qui veut acc√©der √† Internet peut le faire, le deuxi√®me aussi, mais le troisi√®me devra attendre jusqu'√† ce qu'une des adresses de pool soit lib√©r√©e.  La configuration du NAT dynamique comprend 4 √©tapes: d√©terminer l'interface d'entr√©e et de sortie, d√©terminer le trafic ¬´int√©ressant¬ª, cr√©er un pool NAT et le configurer. <br>  Nous allons maintenant passer √† Packet Tracer et essayer de configurer le NAT dynamique.  Tout d'abord, nous devons supprimer les param√®tres NAT statiques, pour lesquels nous entrons les commandes dans l'ordre: <br><br>  aucun Ip nat √† l'int√©rieur de la source statique 192.168.1.10 200.124.22.1 <br>  aucun Ip nat √† l'int√©rieur de la source statique 192.168.1.11 200.124.22.2 <br>  aucun Ip nat √† l'int√©rieur de la source statique 192.168.1.100 200.124.22.3. <br><br>  Ensuite, je cr√©e la liste d'acc√®s Liste 1 pour l'ensemble du r√©seau avec la commande access-list 1 permit 192.168.1.0 0.0.0.255 et je configure le pool NAT √† l'aide de la piscine ip nat NWKING 200.124.22.1 200.124.22.2 netmask 255.255.255.252.  Dans cette commande, j'ai sp√©cifi√© le nom du pool, les adresses qui y entrent et le masque de r√©seau. <br><br>  Ensuite, j'indique si ce NAT est interne ou externe, et la source d'o√π le NAT doit obtenir des informations, dans notre cas, c'est list, en utilisant la commande ip nat inside source list 1. Apr√®s cela, le syst√®me vous demandera si l'ensemble du pool ou une interface sp√©cifique est n√©cessaire .  Je choisis le pool car nous avons plus d'une adresse externe.  Si vous s√©lectionnez l'interface, vous devrez sp√©cifier un port avec une adresse IP sp√©cifique.  Dans la forme finale, la commande ressemblera √† ceci: ip nat √† l'int√©rieur de la liste source 1 pool NWKING.  Maintenant, ce pool se compose de deux adresses 200.124.22.1 200.124.22.2, mais vous pouvez les modifier librement ou ajouter de nouvelles adresses qui ne sont pas li√©es √† une interface sp√©cifique. <br><br>  Vous devez vous assurer que votre table de routage est mise √† jour afin que l'une de ces adresses IP du pool soit dirig√©e vers cet appareil, sinon vous ne recevrez pas de trafic de retour.  Pour nous assurer que les param√®tres fonctionnent, nous allons r√©p√©ter la proc√©dure de ping du routeur cloud, qui a √©t√© effectu√©e pour le NAT statique.  J'ouvrirai la fen√™tre du routeur du routeur 1 pour voir les messages du mode d√©bogage, et je le cinglerai depuis chacun des 3 appareils. <br><br><img src="https://habrastorage.org/webt/io/yt/lk/ioytlkva1_ucbg0-llm4r5ckiy0.jpeg"><br><br>  Nous voyons que toutes les adresses source d'o√π proviennent les paquets ping correspondent aux param√®tres.      PC0  ,        .     Router 1, ,        200.124.22.1  200.124.22.2.    ,   ,      .       PC0,   ,   ,         200.124.22.1. <br><br>     NAT     ?     Router0    clear ip nat translation *  ¬´¬ª   .          show ip nat translation,     . <br><br>    NAT   show ip nat statistics. <br><br><img src="https://habrastorage.org/webt/c8/o0/ne/c8o0neryfwlityjhd2zb_v5mc98.jpeg"><br><br>    ,       ,     NAT/PAT.  ,    0,       .      ,      hits  misses (          ),     . <br><br>         IP- ‚Äì  NAT,  PAT.   PAT     ,      NAT:      ,  ¬´¬ª ,   NAT   PAT.         ,     ,     ,    PAT         .     NAT  PAT      overload,     .      NAT    PAT. <br><br><img src="https://habrastorage.org/webt/rs/ho/mv/rshomvllaqmpjgqhp36eferkb9o.jpeg"><br><br>  ,        NWKING, , 200.124.22.1,               255.255.255.0.   ,    ip nat 1 pool NWKING 200.124.22.1 200.124.22.1 netmask 255.255.255.0  source interface    200.124.22.1  G0/1.               IP-. <br><br>        IP-,      .       ,            .  NAT   ,       ,        ,   NAT IP-   .      ,   IP-       . <br><br>      Packet Tracer.      NAT  no Ip nat inside source list 1 NWKING    NAT    no Ip nat pool NWKING 200.124.22.1 200.124.22.2 netmask 225.255.255.252. <br><br>      PAT  Ip nat pool NWKING 200.124.22.2 200.124.22.2 netmask 225.255.255.255.      IP-,     ,       200.124.22.1,     200.124.22.2.     ,      . <br><br>    PAT  Ip nat inside source list 1 pool NWKING overload.          PAT.    ,     ,    ,     PC0 Router1   200.124.22.10.       ,   ,   ,    ,  IP- 200.124.22.2.      ,   PC1   Server0. <br><br> ,       Router0.  ,    ,      ,       Router1  IP-  200.124.22.2. <br><br><img src="https://habrastorage.org/webt/fh/tf/gp/fhtfgp0x3n7fghja8yjs_qtp7ci.jpeg"><br><br>    show ip nat statistics,    PAT. <br><br><img src="https://habrastorage.org/webt/na/vq/l2/navql2ahsncx0c5utra8t5efxbi.jpeg"><br><br>  ,    ,   ,  12,      . <br><br>    -  ‚Äî   Ip nat inside source list 1 interface gigabit Ethernet g0/1 overload.        PC0, ,      200.124.22.1,     !    :      ,        ,     NAT-   IP-   .             . <br>      ,      .  Packet Tracer,            NAT  PAT.       ICND1 ‚Äî    CCNA,    , ,   . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/l5wuJFoeVDQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en le recommandant √† vos amis, une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√©s pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment diviser le serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV √† partir de 199 $</a> aux Pays-Bas!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - √† partir de 99 $!</b></b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465789/">https://habr.com/ru/post/fr465789/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465775/index.html">Serveur LTSP bas√© sur CentOS7</a></li>
<li><a href="../fr465779/index.html">Provisionnement automatique Yealink T19 + Carnet d'adresses dynamique</a></li>
<li><a href="../fr465781/index.html">Comment j'ai fait un disjoncteur Okhttp personnalis√© √† travers les coroutines de Kotlin</a></li>
<li><a href="../fr465783/index.html">Jeu russe dev, vide de sens et impitoyable</a></li>
<li><a href="../fr465787/index.html">Aime la ch√®vre</a></li>
<li><a href="../fr465791/index.html">Vuln√©rabilit√©s des d√©taillants - trois cas o√π OTP a pu √™tre obtenu dans la demande</a></li>
<li><a href="../fr465793/index.html">Frontend Weekly Digest (26 ao√ªt - 1er septembre 2019)</a></li>
<li><a href="../fr465795/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 378 (26 ao√ªt - 1er septembre 2019)</a></li>
<li><a href="../fr465797/index.html">Algorithmes g√©n√©tiques (ou le client est toujours roi - et souvent un idiot)</a></li>
<li><a href="../fr465801/index.html">Food Design Digest, ao√ªt 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>