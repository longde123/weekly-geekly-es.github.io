<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☝🏿 💼 👗 Importer vers J. Connect à partir du fichier de liste d'utilisateurs via l'API ☪️ 🔒 👐🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Face au problème de «ne pas trouver» le script réel pour la création de masse des employés. 

 Le problème est lié au passage de Yandex de PDD (Mail p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Importer vers J. Connect à partir du fichier de liste d'utilisateurs via l'API</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448036/">  <b>Face au problème de «ne pas trouver» le script réel pour la création de masse des employés.</b> <br><br>  Le problème est lié au passage de Yandex de PDD (Mail pour un domaine) à Yandex.Connect avec la nouvelle version de l'API. <br><br>  Les scripts que j'ai rencontrés ont été écrits uniquement pour la "vieille" version de l'API, et sont donc considérés comme <s>non fonctionnels</s> . <br><br>  Par conséquent, voici le petit grincement simple actuel pour aujourd'hui, pour la création en masse d '«employés» dans l'organisation. <br><a name="habracut"></a><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #     employees='./usrlist' #   usrlist: email_firstname_lastname_middlename # OAuth_Token #      # https://tech.yandex.ru/oauth/doc/dg/tasks/get-oauth-token-docpage/ TOKEN="bash!bash!bash!bash!bash!bash!bash!bash!" #       PASS="superstrongpasswordforyou" #      for i in $( cat $employees ); do value=($(echo $i | tr "_" " ")) #      email="${value[0]}" firstname="${value[1]}" lastname="${value[2]}" middlename="${value[3]}" #   curl -i -X POST -H 'Content-type: application/json' -d '{"department_id": 1, "password": "'$PASS'", "nickname": "'$email'", "name": {"first": "'$firstname'", "last": "'$lastname'", "middle": "'$middlename'"}}' -H "Authorization: OAuth $TOKEN" 'https://api.directory.yandex.net/v6/users/' | grep HTTP done</span></span></code> </pre> <br>  Si vous avez plusieurs départements dans votre organisation, alors dans la ligne: <br><br><pre> <code class="bash hljs">curl -i -X POST -H <span class="hljs-string"><span class="hljs-string">'Content-type: application/json'</span></span> -d <span class="hljs-string"><span class="hljs-string">'{"department_id": 1, "password": "'</span></span><span class="hljs-variable"><span class="hljs-variable">$PASS</span></span><span class="hljs-string"><span class="hljs-string">'", "nickname": "'</span></span><span class="hljs-variable"><span class="hljs-variable">$email</span></span><span class="hljs-string"><span class="hljs-string">'", "name": {"first": "'</span></span><span class="hljs-variable"><span class="hljs-variable">$firstname</span></span><span class="hljs-string"><span class="hljs-string">'", "last": "'</span></span><span class="hljs-variable"><span class="hljs-variable">$lastname</span></span><span class="hljs-string"><span class="hljs-string">'", "middle": "'</span></span><span class="hljs-variable"><span class="hljs-variable">$middlename</span></span><span class="hljs-string"><span class="hljs-string">'"}}'</span></span> -H <span class="hljs-string"><span class="hljs-string">"Authorization: OAuth </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$TOKEN</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">'https://api.directory.yandex.net/v6/users/'</span></span></code> </pre> <br>  Il y a un paramètre: <code>"department_id": 1</code> , nous sommes intéressés par le nombre, "1", c'est le département par défaut "Tous les employés".  Lors de la création d'un nouveau département (quel que soit son nom), ce sera «2», respectivement, avec les suivants. <br><cut><br>  <b>Maintenant, comment obtenir le débogage du jeton OAuth</b> <br><br>  Pour que les <s>applications de</s> script fonctionnent avec les services Yandex, qui utilisent le protocole d'autorisation OAuth 2.0, il existe un jeton de débogage, que nous utiliserons.  Après utilisation, le jeton de débogage peut être révoqué et l'application peut être supprimée. <br><br>  Nous allons à la page <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex OAuth</a> pour créer une nouvelle application (Au fait, nous avons besoin des droits d'administrateur!). <br><br>  J'ai sélectionné les autorisations suivantes pour l'application: <br><br><div class="spoiler">  <b class="spoiler_title">Capture d'écran</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q_/ge/4t/q_ge4tab9hfhd-uu58k-f8n2uk4.png"><br></div></div><br>  Ensuite, vous devez sélectionner la plate-forme et cliquer sur "Substitute URL for development": <br><br><div class="spoiler">  <b class="spoiler_title">Capture d'écran</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/nc/lx/lv/nclxlvmu68ulq90qalyald_5rjg.png"><br></div></div><br>  Après tout le <s>tourment,</s> vous pouvez retourner à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex OAuth</a> , et voir notre application, allez-y et nous sommes intéressés par la ligne «ID», prenez la valeur en chiffres, copiez-la sur cette ligne: <br><br><pre> <code class="bash hljs">https://oauth.yandex.ru/authorize?response_type=token&amp;client_id=&lt; &gt;</code> </pre> <br>  Ensuite, sur la page qui s'ouvre, cliquez sur le bouton Confirmer pour autoriser l'accès. <br>  <s>voila</s> , c'est votre OAuth_Token. <br><br>  Enfin: si vous êtes intéressé par des attributs utilisateurs supplémentaires tels que (date de naissance, son sexe, allias, téléphones), alors n'hésitez pas à lire la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Documentation</a> , il existe des informations assez accessibles pour l'utilisation de base de cette api. <br>  <s>: wq</s> </cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448036/">https://habr.com/ru/post/fr448036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448024/index.html">Les régulateurs européens s'opposent aux bannières de cookies</a></li>
<li><a href="../fr448026/index.html">Projet logiciel et OOP Evolution</a></li>
<li><a href="../fr448030/index.html">Affichage et optimisation de la sortie du terminal sur le Web</a></li>
<li><a href="../fr448032/index.html">Plus de robots: Walmart présente des milliers de machines pour fonctionner dans ses magasins</a></li>
<li><a href="../fr448034/index.html">Recherche de tâches dans JIRA (langage simple). Partie 1: Recherche rapide et basique</a></li>
<li><a href="../fr448038/index.html">Nouvelles fonctionnalités pour les auteurs d'extensions dans Visual Studio 2019 v.16.1</a></li>
<li><a href="../fr448040/index.html">Le condensé de matériaux intéressants pour le développeur mobile # 294 (du 8 au 14 avril)</a></li>
<li><a href="../fr448044/index.html">Quelques aspects de la surveillance de MS SQL Server. Recommandations pour définir des indicateurs de trace</a></li>
<li><a href="../fr448046/index.html">Radio Day: brevets Marconi et Popov</a></li>
<li><a href="../fr448048/index.html">Comprendre le lierre angulaire: DOM incrémentiel et DOM virtuel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>