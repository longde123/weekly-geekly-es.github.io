<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🎓 🏺 ⏸️ Konfigurationsfunktionen für ExtremeXOS-Switches 🚐 😯 👨🏻‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel zielt darauf ab, den Zeitaufwand für das Verständnis der Prinzipien der Arbeit mit ExtremeXOS (XOS) zu verringern. Als ich anfing, XOS ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Konfigurationsfunktionen für ExtremeXOS-Switches</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419965/"><p>  Dieser Artikel zielt darauf ab, den Zeitaufwand für das Verständnis der Prinzipien der Arbeit mit <strong>ExtremeXOS (XOS)</strong> zu verringern.  Als ich anfing, XOS kennenzulernen, fehlte mir wirklich ein solcher Artikel über Habré. </p><br><p>  Im Folgenden werde ich über die Konfiguration von Extremes und die Probleme sprechen, auf die ich gestoßen bin.  Ich hoffe, es hilft Netzwerkingenieuren, die gerade erst anfangen, mit XOS zu arbeiten.  Unabhängig vom Switch-Modell ist die CLI-Syntax genau gleich. <br><br></p><br><p><img src="https://habrastorage.org/webt/jy/kh/yn/jykhynsiykae3nk7qvyy-3chk-w.jpeg" alt="KDPV"><br>  <em>Extremer Schalterständer</em> </p><a name="habracut"></a><br><h2>  Zum Geschäft </h2><br><p>  Für die Hardwarevirtualisierung verwende ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eve-Ng</a> und ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Virtual ExtremeOS ( <u>XOS</u> )</a> -Image.  Sie können auch GNS3 verwenden. </p><br><p> Wie sieht die Switch-Konfiguration aus <abbr title="Extremes Betriebssystem">?</abbr> In <abbr title="Extremes Betriebssystem">XOS</abbr> muss der Betriebsmodus nicht gewechselt werden. Alle Befehle werden aus dem normalen Modus eingegeben und im Fall des Administratorkontos mit <strong>#</strong> gekennzeichnet.  und <strong>&gt;</strong> im Falle des Benutzers. <br>  Zunächst möchte ich die "Grundprinzipien" von Teams in EOS skizzieren.  Alles basiert auf drei Befehlen und ihren Antonyme: <strong>Erstellen</strong> , <strong>Konfigurieren</strong> , <strong>Aktivieren</strong> ( <strong>Löschen</strong> , <strong>Dekonfigurieren</strong> , <strong>Deaktivieren</strong> ).  Das heißt: Wir erstellen, konfigurieren, aktivieren.  Es sieht logisch aus. </p><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">create</span></span> vlan <span class="hljs-number"><span class="hljs-number">10</span></span> configure vlan <span class="hljs-number"><span class="hljs-number">10</span></span> ipaddress <span class="hljs-number"><span class="hljs-number">192.168.1.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><p>  Es versteht sich auch, dass die meisten Konfigurationen in einem <strong>VLAN</strong> konfiguriert sind.  Das heißt, in XOS ist fast alles an VLANs gebunden.  Sogar die Zuweisung von VLANs zu einem Port erfolgt in der VLAN-Konfiguration, dh der Port hängt am VLAN. <br>  Ich möchte besonders auf virtuelle Router ( <em>VR</em> ) achten, die standardmäßig im Switch enthalten sind.  Es gibt VR-Default, dem alle Ports gehören, und VR-mgmt, dem mgmt gehört.  Hafen  In XOS müssen Sie für alle Befehle, die Datenverkehr irgendwohin senden (Ping, SSH, Telnet, Download usw.), VR angeben. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ping</span></span> vr <span class="hljs-string"><span class="hljs-string">"VR-Default"</span></span> <span class="hljs-number"><span class="hljs-number">192.168.1.1</span></span></code> </pre> <br><h2>  XOS Switch Update </h2><br><p>  XOS hat unter dem Betriebssystem zwei Partitionen: primäre und sekundäre.  Funktionell unterscheiden sie sich in nichts, nur in Namen.  Sie können Updates nur im derzeit inaktiven Bereich installieren.  Sie können hierfür das inaktive Argument verwenden.  Nach dem Update ist ein Neustart erforderlich und der Switch startet von einer anderen (gerade aktualisierten) Partition.  Auf diese Weise können Sie bei Problemen schnell zurücksetzen, indem Sie beim Booten einfach eine andere Partition auswählen (die, auf der das alte Betriebssystem belassen wurde).  Ich stelle auch fest, dass alle Bilder mit Patches ein vollwertiges Bild darstellen, dh Sie müssen nicht die Hauptversion und dann einige Nebenbilder einfügen.  Beim Herunterladen wird tftp verwendet: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">download</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">image</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">summitX-21</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4-patch1-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xos</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vr</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">VR-Default</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">inactive</span></span></code> </pre> <br><p>  Um herauszufinden, welcher Abschnitt derzeit verwendet wird, verwenden Sie: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">show</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">system</span></span> … <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Selected</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">primary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Booted</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">secondary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Primary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span>: 22<span class="hljs-selector-class"><span class="hljs-selector-class">.3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Secondary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span>: 21<span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span></code> </pre> <br><h2>  Stapel stapeln </h2><br><p>  Um XOS-Switches zu stapeln, müssen Sie die Stapelunterstützung aktivieren und den Switch neu starten: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stacking-support reboot</code> </pre> <br><p>  Es ist sehr praktisch, dass Switches verschiedener Modelle zu einem Stapel kombiniert werden können, während der Switch mit der höchsten Leistung der Master ist.  Dies kann beispielsweise für einen Stapel von 10G-Switches mit 16 Ports für Server erforderlich sein, zu denen ein 1G-Switch mit 48 Ports hinzugefügt wird, der mgmt.interfaces enthält. <br>  Zum Stapeln müssen Switches dieselbe Betriebssystemversion haben.  Das Stapeln erfolgt über bestimmte Ethernet-Ports für jedes Modell anders, die in der Dokumentation zu finden sind.  Wenn Sie die Switches nach dem 1-in-2, 2-in-1-Port-Schema zusammenbauen, können Extreme-Switches mithilfe des vereinfachten Easy-Stack-Verfahrens gestapelt werden, bei dem die Mohnadressenadressen an die Steckplatznummer und andere Einstellungen gebunden werden.  In diesem Fall ist der erste der Schalter, an dem Sie das Aktivieren des Stapelns aktivieren. Dem Rest werden Nummern entlang der Kette zugewiesen.  Dies ist eine ziemlich bequeme Möglichkeit, viel Zeit zu sparen.  Nach dem Stapeln sehen die Ports wie SLOT: PORT (1: 1, 2:35) aus. </p><br><pre> <code class="hljs pgsql">X440G2<span class="hljs-number"><span class="hljs-number">-48</span></span>p<span class="hljs-number"><span class="hljs-number">-10</span></span>G4<span class="hljs-number"><span class="hljs-number">.1</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> stacking Stack Topology <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a Ring This node <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> an Active Topology Node MAC Address Slot Stack State <span class="hljs-keyword"><span class="hljs-keyword">Role</span></span> Flags <span class="hljs-comment"><span class="hljs-comment">------------------ ---- ----------- ------- --- *00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- * - Indicates this node Flags: (C) Candidate for this active topology, (A) Active Node (O) node may be in Other active topology X440G2-48p-10G4.2 # enable stacking You have not yet configured all required stacking parameters. Would you like to perform an easy setup for stacking operation? (y/N) Yes Executing "configure stacking easy-setup" command... For every node in the 5-node stack, this command will: - enable stacking - configure a stack MAC address - choose and configure a slot number (this node will be assigned to slot 1) - configure redundancy to minimal (slot 1 will be the master node) - configure the stacking protocol to enhanced Upon completion, the stack will automatically be rebooted into the new configuration. Warning: If stacking is already configured, this command will alter that configuration. Do you wish to proceed? (y/N) Yes Stacking configuration is complete. Rebooting...</span></span></code> </pre> <br><p>  Beim Aktualisieren des Stapels wird der Master aktualisiert, und dann schüttet er selbst die neue Version in die verbleibenden Slots.  <strong>Ein Neustart ist erforderlich</strong> . </p><br><h2>  Lizenzierung </h2><br><p>  Jeder Switch wird mit einer vorinstallierten Lizenz geliefert (Edge, Advanced Edge, Core usw.).  Jede Lizenz verfügt über eigene Funktionen, die auf dem Switch aktiviert werden können, z. B. die Anzahl der Ports, die in OSPF verwendet werden können.  Es gibt auch Lizenzen für einzelne Funktionen.  Weitere Details finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br>  Eine der häufigsten Lizenzen ist die Funktion: <em>Dual-10GB-Uplink-</em> Lizenz.  Diese Lizenz für den Edge-Switch-1G ermöglicht die Verwendung von 2x 10-GbE-Ports.  Zum Beispiel auf dem X440-G2-48p. <br>  Lizenzen sind in Ihrem persönlichen Konto auf der Extreme-Website verfügbar. Anschließend werden sie aktiviert (ohne Neustart) und vom Team überprüft. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> license XXXX-XXXX <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> licenses</code> </pre> <br><p>  Wenn im Switch-Stack unterschiedliche Lizenzen verwendet werden, wird die <u>kleinste</u> verwendet. </p><br><h2>  Anpassung </h2><br><p>  Ein kleiner Exkurs: Um die Ergebnisse der Befehle zu sehen, die niedriger sind, sowie andere Informationen, können Sie in den meisten Fällen show verwenden, create und configure ersetzen.  Zeigen Sie beispielsweise vlan an. <br>  Hinweis: Bei Verwendung von show-Ports erstellt XOS alle paar Sekunden eine aktualisierte Tabelle, mit der der Status der Schnittstellen in Echtzeit überwacht werden kann.  Um eine Ausgabe ohne Aktualisierung zu erhalten, müssen Sie "show ports no-refresh" verwenden. <br>  Das erste, was mir in den Sinn kommt, ist die Konfiguration dieses <em>Hostnamens</em> .  Es scheint ungefähr so ​​zu sein: </p><br><p><del>  Konfigurieren Sie den Hostnamen Ex_sw_1 </del></p><br><p>  Aber nicht alles ist so einfach, tatsächlich wird es so gemacht: </p><br><pre> <code class="hljs powershell">configure snmp sysName Ex<span class="hljs-literal"><span class="hljs-literal">-sw</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span></code> </pre> <br><p>  Erstellen Sie ein VLAN: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan My_Vlan_Five tag <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br><p>  Oder so, und genau so wird es in der Konfiguration angezeigt: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan My_Vlan10 configure vlan My_Vlan10 tag <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  In Anbetracht der praktischen Erfahrung und der Realität der Befehlsausgabe und der XOS-Einstellungen habe ich eine Regel für mich erstellt: Fügen Sie im vlan-Namen das Tag am Ende hinzu, um das Verständnis und die Konfiguration zu vereinfachen: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan <span class="hljs-keyword"><span class="hljs-keyword">users</span></span><span class="hljs-number"><span class="hljs-number">-10</span></span> tag <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  XOS verfügt per se nicht über Trunk- und Access-Ports.  Stattdessen werden Konzepte verwendet: Tagged und Untagged Traffic auf einer vlan-gebundenen Schnittstelle.  Es kann einen nicht getaggten und viele getaggten VLAN geben.  Die Ports sind in Zahlen nummeriert (oder Steckplatz: Port auf dem Stapel), alles ist sehr einfach. </p><br><pre> <code class="hljs cs">configure vlan My_Vlan<span class="hljs-number"><span class="hljs-number">-5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ports <span class="hljs-number"><span class="hljs-number">1</span></span> tagged configure vlan My_Vlan1 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ports <span class="hljs-number"><span class="hljs-number">1</span></span> untagged</code> </pre> <br><p>  Dementsprechend wird der gesamte Datenverkehr ohne ein Tag, das an die Schnittstelle <em>gelangt,</em> als " <em>My_Vlan1</em> " gekennzeichnet. <br>  Gleichzeitig kann vlan sowohl über &lt; <em>Name</em> &gt; als auch über &lt; <em>Tag</em> &gt; und in beliebiger Kombination (unter Verwendung von <em>vlan_list</em> , <em>dh</em> numerisch nach Tags) angegeben werden.  Ohne ein Attribut am Ende wird &lt;ohne <em>Tags</em> &gt; verwendet: </p><br><pre> <code class="hljs powershell">onfigure vlan <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-10</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span><span class="hljs-literal"><span class="hljs-literal">-20</span></span> add ports <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span>, <span class="hljs-number"><span class="hljs-number">48</span></span> tagged configure vlan web<span class="hljs-literal"><span class="hljs-literal">-110</span></span> add ports <span class="hljs-number"><span class="hljs-number">5</span></span> onfigure vlan <span class="hljs-number"><span class="hljs-number">20</span></span> add ports <span class="hljs-number"><span class="hljs-number">30</span></span><span class="hljs-literal"><span class="hljs-literal">-40</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span> untagged</code> </pre> <br><p>  Da die meisten Switches der SummitX-Serie <strong>L3-</strong> Switches sind, wird SVI folgendermaßen konfiguriert: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">configure</span></span> vlan <span class="hljs-number"><span class="hljs-number">125</span></span> ipaddress <span class="hljs-number"><span class="hljs-number">192.168.125.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><p>  Danach müssen Sie diesen Befehl anwenden, sonst bleibt vlan nicht routbar: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ipforwarding vlan <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ipforwarding vlan <span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-number"><span class="hljs-number">-50</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span></code> </pre> <br><p>  Um zu sehen, was vlan auf der Schnittstelle ist, können Sie den folgenden Befehl verwenden: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ports <span class="hljs-number"><span class="hljs-number">2</span></span> vlan</code> </pre> <br><p>  Zum Anzeigen und Speichern der Konfiguration werden die folgenden Befehle verwendet und es gibt primäre und sekundäre Konfigurationsdateien: </p><br><pre> <code class="hljs pgsql">save save secondary <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> <span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span></code> </pre> <br><h2>  Link-Aggregation </h2><br><p>  Einer der <u>unangenehmen</u> Momente, die ich getroffen habe, ist die Ansammlung von Kanälen.  (Port-Kanal).  Der allgemeine Punkt ist folgender: Sie weisen ihm einen Master-Port und bis zu sieben sekundäre Schnittstellen zu.  Außerdem werden alle Einstellungen nur an einem bestimmten Master-Port vorgenommen, es gibt keine logischen Schnittstellen der Form <em>po1</em> .  Der Nachteil ist, dass Sie, wenn Sie den Master-Port ändern möchten, alle Einstellungen manuell auf einen anderen Port übertragen müssen, da beim Löschen eines aggregierten Kanals die gesamte Konfiguration darauf <u>fliegt</u> .  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem Artikel</a> gibt es eine Lösung für diese Unannehmlichkeiten, die jedoch immer noch nicht perfekt funktioniert.  In XOS wird Aggregation als <strong>Freigabe bezeichnet</strong> . <br>  Um diesen Port zu aktivieren, müssen Sie einen Befehl des Formulars verwenden: </p><br><pre> <code class="hljs powershell">enable sharing [<span class="hljs-type"><span class="hljs-type">MASTER_PORT</span></span>] grouping [<span class="hljs-type"><span class="hljs-type">PORT_LIST</span></span>] [<span class="hljs-type"><span class="hljs-type">lacp</span></span>] enable sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-2</span></span> lacp</code> </pre> <br><p>  Bei einer Version unter 22.X muss der Ausgleichsalgorithmus hinzugefügt werden: </p><br><pre> <code class="hljs powershell">enable sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-2</span></span> algorithm address<span class="hljs-literal"><span class="hljs-literal">-based</span></span> L2 lacp</code> </pre> <br><h2>  OSI Layer 2-Schleifenschutz </h2><br><p>  Auf Summit-X-Switches in C-Dur Version 22.2 war das Schleifenschutzprotokoll der zweiten Ebene standardmäßig <strong><u>deaktiviert</u></strong> .  (STP und andere).  Zum Zeitpunkt des Schreibens ist die vom Hersteller empfohlene Software 21.1.5.2. </p><br><h3 id="elrp">  ELRP </h3><br><p>  In einem meiner Projekte habe ich das proprietäre <abbr title="Extreme Loop Recovery Protocol">ELRP-</abbr> Protokoll verwendet, mit dem Schleifen <abbr title="Extreme Loop Recovery Protocol">erkannt</abbr> und verhindert werden sollen.  Während der Tests zeigte er gute Ergebnisse (Port-Shutdown-Geschwindigkeit mit einer Schleife usw.).  Dieses Protokoll sendet eine Multicast- <abbr title="Protokolldateneinheit">PDU</abbr> , und wenn der Absender sie erneut empfängt, gibt es eine Schleife. <br>  Das Intervall ist für die Häufigkeit der PDU-Verteilung verantwortlich, in diesem Fall - 2 Sekunden.  Im Falle einer Schleife wird der Port für 180 Sekunden blockiert, wonach die PDU erneut gesendet wird.  Warnoptionen: Protokoll, Trap, Log-and-Trap.  Im Falle eines Traps wird der snmp-Trap entsprechend gesendet. <br>  Dieses Per-VLAN-Protokoll sowie die meisten Konfigurationen in XOS sind konfiguriert. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> elrp-client configure elrp-client periodic Buh<span class="hljs-number"><span class="hljs-number">-123</span></span> ports <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> <span class="hljs-type"><span class="hljs-type">interval</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port ingress duration <span class="hljs-number"><span class="hljs-number">180</span></span></code> </pre> <br><p>  Um zu verhindern, dass das ELRP-Protokoll Uplinks von Zugriffsschaltern oder kritischen Verbindungen blockiert, wird der Befehl zum Entfernen von Ports aus der Blockierung verwendet. </p><br><pre> <code class="hljs pgsql">configure elrp-client <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port <span class="hljs-keyword"><span class="hljs-keyword">exclude</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> configure elrp-client <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port <span class="hljs-keyword"><span class="hljs-keyword">exclude</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><h3 id="stp">  STP </h3><br><p>  STP ist etwas kniffliger konfiguriert, aber im Allgemeinen gibt es keine besonderen Probleme.  In XOS heißt dieses Protokoll "stpd", in allen Befehlen zur Konfiguration von STP wird es verwendet.  Sie können dies per VLAN mit verschiedenen STP-Domänen tun.  "Domain-ID" und "VLAN-ID" müssen übereinstimmen.  Ports in STP können entweder manuell oder mithilfe der automatischen VLAN-Bindung hinzugefügt werden.  Sobald ein Port zu vlan hinzugefügt wird, wird dieser Port automatisch zu STP hinzugefügt.  Das ist die Logik.  <abbr title="802.1d Standard">Moduseinstellung</abbr> : <abbr title="802.1d Standard">dot1d</abbr> STP, <abbr title="802.1w Standard">dot1w</abbr> - RSTP: </p><br><pre> <code class="hljs pgsql">configure stpd "s0" priority <span class="hljs-number"><span class="hljs-number">4096</span></span> configure stpd s0 mode dot1w <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stpd s0 <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stpd "s0" auto-bind "VLAN_0005"</code> </pre> <br><h2>  VRRP </h2><br><p>  VRRP ist eine Art von <abbr title="Redundanzprotokoll für den ersten Hop">FHRP</abbr> , ein Analogon von HSRP in Cisco.  Für jedes Netzwerk (vlan) muss ein vrid verwendet werden, das zwischen 1 und 255 liegen kann. Ich war mit der Möglichkeit zufrieden, den Datenverkehr vom Backup-vrrp-L3-Switch mithilfe der Fabric-Routing-Option weiterzuleiten.  Standardmäßig ist die Priorität 100. Welcher der Schalter eine höhere Priorität hat, wird zu „Master“. </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> configure vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-keyword"><span class="hljs-keyword">priority</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> configure vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> fabric-routing <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span></code> </pre> <br><h2>  MLAG </h2><br><p>  Was es ist und warum, wird hier sehr gut beschrieben: Es ist in der Tat ein Analogon von Cisco VPC.  <abbr title="Inter-Switch-Verbindung"><strong>ISC</strong></abbr> - Verbindung zwischen mlag-Pair-Schaltern. </p><br><p>  In meinem Fall wurde normalerweise das folgende Schema verwendet: <br><img src="https://habrastorage.org/webt/zc/bu/qf/zcbuqf-hljcoauy1g6tmdlgb0vq.jpeg"></p><br><p>  Es ist erforderlich, einen Nachbarn (Peer) zu erstellen, um einem bestimmten Nachbarn bestimmte Ports mit mlag zuweisen zu können, da Extreme die Verwendung mehrerer Nachbarn unterstützt.  Für ISC benötigen Sie ein VLAN, das nur für ISC verwendet wird und eine IP-Adresse hat.  Dementsprechend haben wir für X670-1 Peer X670-2 und mlag-Ports sind x440.  Für das Funktionieren ist es erforderlich, einen Aggregationskanal und auf x670 einen Port in Richtung x440 und einen aggregierten Kanal in Richtung X670-2 zu erstellen, an dem <strong>ALLE</strong> Vlans an mlag teilnehmen. <br>  Auf x670: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Enable</span></span> sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span> lacp <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> mlag peer "mlag1" configure mlag peer "mlag1" ipaddress <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> vr VR-<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> mlag port <span class="hljs-number"><span class="hljs-number">1</span></span> peer "mlag1" id <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  Auf x440-Stack: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sharing</span></span> 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">grouping</span></span> 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span>,2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lacp</span></span></code> </pre> <br><h2>  MLAG + VRRP </h2><br><p>  Beim Testen von Schalttafeln am Stand wurde ein Problem festgestellt, dass VRRP die Master-Rolle entfernt, bevor alle anderen Schnittstellen (ISC wird zuerst hochgefahren) und Protokolle aktiviert werden, was zu Netzwerkausfallzeiten in der Größenordnung von einer Minute führte. <br>  Dieses Problem wurde durch die folgenden Befehle gelöst, die jedoch nur mit „EXOS 21.1.3.7-patch1-4“ und „EXOS 22.3“ verfügbar sind: </p><br><pre> <code class="hljs powershell">configure mlag ports reload<span class="hljs-literal"><span class="hljs-literal">-delay</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> enable mlag port reload<span class="hljs-literal"><span class="hljs-literal">-delay</span></span></code> </pre> <br><h2>  Routing </h2><br><p>  Statische Routen sind wie folgt definiert, es sollte keine Probleme geben.  Sie können die Maske in jeder Version einstellen. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">configure</span></span> iproute add <span class="hljs-number"><span class="hljs-number">10.0.66.0</span></span> <span class="hljs-number"><span class="hljs-number">255.255.255.0</span></span> <span class="hljs-number"><span class="hljs-number">172.16.1.1</span></span> configure iproute add <span class="hljs-number"><span class="hljs-number">10.0.0.1</span></span>/<span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">10.255.255.255</span></span> configure iproute add default <span class="hljs-number"><span class="hljs-number">172.16.0.1</span></span></code> </pre> <br><h3 id="ospf">  OSPF </h3><br><p>  Für das Routing wurde in meiner Praxis OSPF mit einer einzelnen Zone verwendet.  Um die Funktionsfähigkeit sicherzustellen, müssen Sie eine Router-ID festlegen und außerdem jedes VLAN hinzufügen, das angekündigt werden muss (ähnlich wie in Cisco: Netzwerk). </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">routerid</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vlan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">routing-5</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">area</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vlan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Voip-32</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">area</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">passive</span></span></code> </pre> <br><h2>  Andere kleine Dinge </h2><br><h3 id="dhcp-relay">  DHCP-Relais </h3><br><p>  Wie folgt konfiguriert: </p><br><pre> <code class="hljs pgsql">configure bootprelay <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> vr VR-<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> bootprelay ipv4 vlan servers<span class="hljs-number"><span class="hljs-number">-500</span></span></code> </pre> <br><p>  Wenn Sie ein neues VLAN erstellen, müssen Sie es manuell mit VHCP Relay zur VLAN-Liste hinzufügen. </p><br><h3 id="ssh--acl-dlya-ssh">  SSH + ACL für SSH </h3><br><p>  Ssh ist wie folgt aktiviert: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ssh2</code> </pre> <br><p>  Um den Zugriff auf ssh zu beschränken, müssen Sie eine separate Richtliniendatei des Formulars NAME.pol erstellen und an SSH hängen. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vi</span></span> ssh.pol</code> </pre> <br><p>  Richtlinie: </p><br><pre> <code class="hljs mel">Entry AllowTheseSubnets { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> any { <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>-address <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> /<span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>-address <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.34</span></span> /<span class="hljs-number"><span class="hljs-number">32</span></span>; } Then { permit; } }</code> </pre> <br><p>  Der Befehl zum Anwenden der Richtlinie: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ssh2 <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-profile ssh.pol</code> </pre> <br><h3 id="description--display-string">  Beschreibung + Anzeigezeichenfolge </h3><br><p>  Zur Vereinfachung der Einrichtung und des anschließenden Betriebs können Sie den "Namen" und die "Beschreibung" der Schnittstelle festlegen. </p><br><pre> <code class="hljs kotlin">onfigure port <span class="hljs-number"><span class="hljs-number">1</span></span> description “<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> port number one”</code> </pre> <br><p>  Die Beschreibung der Schnittstelle wird nur in Befehlen des Formulars angezeigt: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ports description</code> </pre> <br><p>  Ein Schnittstellenname ersetzt fast überall seine Nummer in der Ausgabe von Befehlen.  Der Name darf kein Leerzeichen enthalten und ist auf eine Länge von 20 Zeichen begrenzt. </p><br><pre> <code class="hljs vhdl">onfigure <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> display-<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> UserPort EXOS-VM.<span class="hljs-number"><span class="hljs-number">8</span></span> # sh <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> vlan Untagged <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span> /Tagged VLAN Name(s) <span class="hljs-comment"><span class="hljs-comment">-------- -------- ------------------------------------------------------------ UserPort Untagged Default 2 Untagged Default 3 Untagged Default</span></span></code> </pre> <br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  <strong>Mit XOS</strong> können Sie auch viele Aktionen automatisieren und das System an Ihre Anforderungen anpassen, da Python und der integrierte Mechanismus zum Erstellen und Ausführen von Skripten mithilfe von <em>CLI-Scripting-</em> Befehlen nativ unterstützt werden. </p><br><p>  Ich bin offen für Vorschläge zur Verbesserung des Artikels und zur Korrektur von Ungenauigkeiten / Fehlern sowie für Fragen. </p><br><p>  <strong>UPD</strong> : LLDP für IP-Telefone wird mithilfe der Befehle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aus diesem Kommentar</a> konfiguriert. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de419965/">https://habr.com/ru/post/de419965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de419951/index.html">Erfahrung mit WebRTC. Yandex Vortrag</a></li>
<li><a href="../de419953/index.html">Ich schreibe ein Buch über das erste „unser“ Startup, das die Welt erobert hat: Hilfe</a></li>
<li><a href="../de419955/index.html">Funktionen des FIFO-UART-Puffers in ESP32</a></li>
<li><a href="../de419961/index.html">Die Zusammenfassung interessanter Materialien für den mobilen Entwickler # 265 (6. August - 12. August)</a></li>
<li><a href="../de419963/index.html">Wir stellen eine "intelligente" Steuerung für die Klimaanlage des ESP8266 her</a></li>
<li><a href="../de419969/index.html">Verschleierung in Ruby. Verstecke auch Klassen vor der obersten Ebene</a></li>
<li><a href="../de419971/index.html">Das Raketenlabor repariert, erweitert und beschleunigt</a></li>
<li><a href="../de419973/index.html">Digitale Veranstaltungen in Moskau vom 13. bis 19. August</a></li>
<li><a href="../de419975/index.html">Wie wir von Windows Corporate weggelaufen sind</a></li>
<li><a href="../de419977/index.html">Forscher: Nicht alle Autopiloten der Stufe 2 funktionieren gleich gut, aber Fortschritte sind offensichtlich</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>