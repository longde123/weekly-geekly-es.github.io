<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕒 👌🏼 🙌🏼 "Konsultan +": perubahan aliran materi. Font, gaya, perataan teks dengan python 👩🏾‍🏫 👨‍👩‍👧‍👧 ✌🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Konsultan +" - sistem referensi untuk pengacara, akuntan, dan sebagainya. Ini bekerja secara stabil seperti jam tangan. Dalam posting ini, disarankan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Konsultan +": perubahan aliran materi. Font, gaya, perataan teks dengan python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465229/">  "Konsultan +" - sistem referensi untuk pengacara, akuntan, dan sebagainya.  Ini bekerja secara stabil seperti jam tangan.  Dalam posting ini, disarankan agar Anda mengatur jam ini sedikit untuk kebutuhan Anda dalam hal output teks, yaitu: lihat bagaimana Anda dapat memproses informasi teks yang diberikan sistem dengan python.  Sepanjang jalan, bekerja dengan elemen teks yang dinyatakan dalam judul. <br><a name="habracut"></a><br><h3>  Naungan di pagar </h3><br>  Sebagai seorang pengacara yang telah bekerja dengan program bantuan "Konsultan +" untuk waktu yang lama, saya selalu kekurangan fungsi yang biasa dalam sistem ini.  Fungsi ini adalah sebagai berikut.  Saat ada perubahan yang muncul dalam tindakan pengaturan, karyawan K + memposting ikhtisar perubahan dalam bentuk dua kolom teks: <br><br><img src="https://habrastorage.org/webt/k5/ya/w9/k5yaw9jbfy9aefzvtfzb-dg90he.png"><br><br>  Kolom di sebelah kiri adalah seperti sebelumnya, kolom di sebelah kanan adalah norma yang sekarang berlaku.  Sekarang (beberapa tahun yang lalu), fungsionalitas telah diperbarui dan perubahan disorot <b>dalam huruf tebal</b> dan langsung terlihat.  Ini semua sangat nyaman.  Tetapi ada hal-hal yang tidak nyaman. <br><br>  Pertama, beberapa norma tidak diberikan, karena  volumenya terlalu besar untuk karyawan K + dan Anda harus pergi ke tautan sistem, dan kedua, Anda tidak bisa hanya mengambil dan menyalin dua kolom ini dengan menempelkannya ke excel atau tabel kata biasa. <br><br>  Mungkin ini dilakukan dengan sengaja agar pengguna bekerja lebih aktif dengan sistem, termasuk tidak mentransfer apa pun dari sana. <br><br>  Nah harus memperbaikinya. <br><br>  <b>Tugas</b> : untuk menyebarkan teks dalam dua kolom, di mana dimungkinkan dan di mana tidak - hanya menghapus norma dan memasukkan semua ini ke dalam lembar kerja Excel.  Pada saat yang sama, mari kita lihat bagaimana Anda dapat mengubah font, perataan dan hal-hal sepele lainnya dalam teks menggunakan python. <br><br>  Untuk contoh yang memberi makan program kami di masa depan, kami mengambil dari K + perubahan pada Hukum "Di JSC".  Undang-undang ini sering diubah, jadi akan ada pekerjaan yang harus dilakukan. <br><br>  Simpan perubahan ke file txt biasa (misalnya, edisi .txt).  Anda mendapatkan sesuatu seperti berikut: <br><br><img src="https://habrastorage.org/webt/0o/xw/-t/0oxw-tin_znk0m2atwnmuazx9na.jpeg"><br><br>  Jadi, jelas bahwa setiap perubahan dipisahkan dari yang lain dengan garis yang solid, yang setelah disimpan berupa banyak "???".  Ada juga perubahan pos yang harus diperhitungkan.  Semuanya terlihat sederhana kecuali untuk poin-poin tertentu. <br><br>  Jadi, temui perubahan yang memiliki bentuk berikut: <br><br><img src="https://habrastorage.org/webt/ph/qe/iy/phqeiyzh_jqmllcnr-a54xe8sq8.jpeg"><br><br>  Selain itu, masalah ini diperparah oleh fakta bahwa perubahan individu berbeda secara signifikan panjangnya. <br><br><h3>  Kami melanjutkan ke K +. </h3><br>  Buat file Consult.py baru dan tambahkan baris pertama ke dalamnya: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unicode_literals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> codecs <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl</code> </pre> <br>  Modul openpyxl sudah akrab, memungkinkan Anda untuk bekerja dengan Excel, tetapi dua lainnya baru.  Fungsinya untuk memproses karakter Rusia dengan benar, yang sering salah dibaca oleh program. <br><br>  Di muka, buat file excel kosong baru di luar program, beri nama misalnya revision2.xlsx.  Kami akan membuka file ini dengan program kami dan menulis data di sana.  Ini akan menjadi file terakhir kami. <br>  Jadi, program membuka file excel, memasukkannya: <br><br><pre> <code class="python hljs">wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'2.xlsx'</span></span>) sheet=wb.get_active_sheet() x=<span class="hljs-number"><span class="hljs-number">1</span></span> y=<span class="hljs-number"><span class="hljs-number">0</span></span> test=[] test2=[] test3=[]</code> </pre> <br>  Juga di atas kami membuat 3 daftar kosong di mana kami akan mengumpulkan data: test, test2, test3. <br><br>  Selanjutnya, dalam variabel 'a' kita akan meletakkan segala sesuatu yang dapat jatuh ke dalam bentuk nama perubahan.  Di y - akan ada garis pemisah.  Panjangnya sama: <br><br><pre> <code class="python hljs">a=(<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>) y=<span class="hljs-string"><span class="hljs-string">'?????????????????????????????????????????????????????????????????????????'</span></span></code> </pre> <br>  Sekarang bagian yang menyenangkan. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open (<span class="hljs-string"><span class="hljs-string">'.txt'</span></span>,encoding=<span class="hljs-string"><span class="hljs-string">'cp1251'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: lines = (line.strip() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lines: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line.startswith(<span class="hljs-string"><span class="hljs-string">''</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> col1=line[:<span class="hljs-number"><span class="hljs-number">35</span></span>] col2=line[<span class="hljs-number"><span class="hljs-number">39</span></span>:] col3=line[<span class="hljs-number"><span class="hljs-number">35</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line.startswith(a): sheet.cell(row=x, column=<span class="hljs-number"><span class="hljs-number">1</span></span>).value=line <span class="hljs-comment"><span class="hljs-comment">#   ,  .. sheet.cell(row=x, column=1).font=ft2 #sheet.cell(row=x, column=1).style='20 % - Accent3' x+=1 #  x+=2 elif line==None: continuewith open ('.txt',encoding='cp1251') as f: lines = (line.strip() for line in f) for line in lines: if line.startswith(''): continue col1=line[:35] col2=line[39:] col3=line[35:39] if line.startswith(a): sheet.cell(row=x, column=1).value=line #   ,  .. x+=1 #  x+=2 elif line==None: continue</span></span></code> </pre> <br>  Kami membuka file .txt yang dienkode cp1251.  Setiap baris dibersihkan dari spasi dari ujung dan awal dengan metode strip. <br><br>  Jika baris dimulai dengan kata "tua", kita lewati.  Mengapa kita perlu mempertahankan "lama" dan "baru", ini sudah jelas.  Selanjutnya, kami membagi baris: dari awal hingga 35 karakter dan dari 39 karakter hingga akhir.  Artinya, kita menghilangkan celah di tengah: <br><br><img src="https://habrastorage.org/webt/lr/7c/rv/lr7crvthi0odk7_1sgw9n2ukvne.jpeg"><br><br>  Kami menempatkan konten ruang di tengah baris di col3, karena  ini mungkin bukan spasi jika perubahan ditulis dalam satu baris berturut-turut: <br><br><img src="https://habrastorage.org/webt/do/zc/bm/dozcbmndg7-epalwt553lwaorpi.jpeg"><br><br>  Selanjutnya, jika baris dimulai dengan tajuk perubahan (kami menulis tajuk ini ke dalam variabel a), maka kami segera menulis baris ini untuk unggul tanpa pemisahan dan menambahkan baris - x + = 1 (atau x = x + 1). Baris kosong, yang kami temui, kami rindu. <br><br>  Pertimbangkan potongan kode berikut: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(col2)==<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">#   1-     2- if line.startswith(a): continue test2.append(col1) #test3.append(col1) if col3==' ' and col2!=None: test.append(line[:35]) test2.append(line[39:]) if col3!=' ' and line!=y and len(line)&gt;60: #print(test3) test3.append(line) if line==y: #   ,   if test!=None: sheet.cell(row=x, column=1).value=(' '.join(test).strip('\?')) sheet.cell(row=x, column=1).font=ft sheet.cell(row=x, column=1).alignment=al sheet.cell(row=x, column=2).value=(' '.join(test2).strip('\?')) sheet.cell(row=x, column=2).font=ft sheet.cell(row=x, column=2).alignment=al test=[] test2=[] x+=1 if len(test3)&gt;0: #print(len(test3)) sheet.cell(row=x, column=2).value=(' '.join(test3).strip('\?')) sheet.cell(row=x, column=2).font=ft sheet.cell(row=x, column=2).alignment=al test3=[] x+=1 else: continue</span></span></code> </pre> <br>  Jika panjang 2 bagian dari string adalah 0, yaitu, tidak ada, maka test2 mendapatkan bagian pertama dari string.  Jika ada spasi di garis, tetapi bagian kedua dari garis tidak ada, maka bagian pertama dan kedua dari garis, masing-masing, jatuh ke dalam uji dan uji2. <br><br>  Jika ada spasi di garis, dan garis tidak kosong dan panjangnya lebih dari 60 karakter, maka ditambahkan ke test3. <br><br>  Jika baris kosong, artinya, kami melalui seluruh perubahan, lalu kami menulis semua yang kami kumpulkan dalam sel excel, secara bersamaan memeriksa kekosongan dalam pengujian (sehingga tidak kosong) dan panjang test3. <br><br>  Akhirnya, simpan file excel: <br><br><pre> <code class="python hljs">wb.save(<span class="hljs-string"><span class="hljs-string">'2.xlsx'</span></span>)</code> </pre> <br><h3>  Gaya, font dan perataan teks dalam python </h3><br>  Tambahkan beberapa keindahan ke meja kami. <br><br>  Secara khusus, kami akan membuatnya sehingga saat mengeluarkan data, header perubahan disorot dalam huruf tebal, dan teks itu sendiri lebih kecil dan diformat agar mudah dibaca. <br>  Python memungkinkan Anda melakukan ini.  Untuk melakukan ini, kita perlu menambahkan dan mengubah kode di tempat-tempat di mana kita mencatat hasil dalam file excel: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openpyxl.styles <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Font, Color,NamedStyle, Alignment</code> </pre> <br><pre> <code class="python hljs">al= Alignment(horizontal=<span class="hljs-string"><span class="hljs-string">"justify"</span></span>, vertical=<span class="hljs-string"><span class="hljs-string">"top"</span></span>) ft = Font(name=<span class="hljs-string"><span class="hljs-string">'Calibri'</span></span>, size=<span class="hljs-number"><span class="hljs-number">9</span></span>) ft2 = Font(name=<span class="hljs-string"><span class="hljs-string">'Calibri'</span></span>, size=<span class="hljs-number"><span class="hljs-number">9</span></span>,bold=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line.startswith(a): sheet.cell(row=x, column=<span class="hljs-number"><span class="hljs-number">1</span></span>).value=line <span class="hljs-comment"><span class="hljs-comment">#   ,  .. sheet.cell(row=x, column=1).font=ft2</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line==y: <span class="hljs-comment"><span class="hljs-comment">#   ,   if test!=None: sheet.cell(row=x, column=1).value=(' '.join(test).strip('\?')) sheet.cell(row=x, column=1).font=ft sheet.cell(row=x, column=1).alignment=al sheet.cell(row=x, column=2).value=(' '.join(test2).strip('\?')) sheet.cell(row=x, column=2).font=ft sheet.cell(row=x, column=2).alignment=al</span></span></code> </pre> <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(test3)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">#print(len(test3)) sheet.cell(row=x, column=2).value=(' '.join(test3).strip('\?')) sheet.cell(row=x, column=2).font=ft sheet.cell(row=x, column=2).alignment=al</span></span></code> </pre> <br>  Faktanya, kami hanya menambahkan metode .font dan .ignignment yang berlaku. <br><br>  Seluruh program berbentuk: <br><br><div class="spoiler">  <b class="spoiler_title">Kode</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unicode_literals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> codecs <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openpyxl.styles <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Font, Color,NamedStyle, Alignment <span class="hljs-string"><span class="hljs-string">""" 1.  Consultant+   ,    .txt  ?????????????????????????????????????????????????????????????????????????   15  1  48     15)    15)     excel    .  word      - txt  : .txt  : 2.xlsx """</span></span> <span class="hljs-comment"><span class="hljs-comment">#file = open ( '2.txt', 'w',encoding='cp1251', newline = '\n') wb = openpyxl.load_workbook('2.xlsx') sheet=wb.get_active_sheet() x=1 y=0 test=[] test2=[] test3=[] a=('','','','','','','') y='?????????????????????????????????????????????????????????????????????????' #  #al= Alignment(horizontal="distributed", vertical="top") al= Alignment(horizontal="justify", vertical="top") ft = Font(name='Calibri', size=9) ft2 = Font(name='Calibri', size=9,bold=True) with open ('.txt',encoding='cp1251') as f: lines = (line.strip() for line in f) for line in lines: if line.startswith(''): continue col1=line[:35] col2=line[39:] col3=line[35:39] if line.startswith(a): sheet.cell(row=x, column=1).value=line #   ,  .. sheet.cell(row=x, column=1).font=ft2 #sheet.cell(row=x, column=1).style='20 % - Accent3' x+=1 #  x+=2 elif line==None: continue #print (line) #print (len(col2)) if len(col2)==0: #   1-     2- if line.startswith(a): continue test2.append(col1) #test3.append(col1) if col3==' ' and col2!=None: test.append(line[:35]) test2.append(line[39:]) if col3!=' ' and line!=y and len(line)&gt;60: #print(test3) test3.append(line) if line==y: #   ,   if test!=None: sheet.cell(row=x, column=1).value=(' '.join(test).strip('\?')) sheet.cell(row=x, column=1).font=ft sheet.cell(row=x, column=1).alignment=al sheet.cell(row=x, column=2).value=(' '.join(test2).strip('\?')) sheet.cell(row=x, column=2).font=ft sheet.cell(row=x, column=2).alignment=al test=[] test2=[] x+=1 if len(test3)&gt;0: #print(len(test3)) sheet.cell(row=x, column=2).value=(' '.join(test3).strip('\?')) sheet.cell(row=x, column=2).font=ft sheet.cell(row=x, column=2).alignment=al test3=[] x+=1 else: continue wb.save('2.xlsx')</span></span></code> </pre> <br></div></div><br>  Jadi, pada akhirnya, setelah memproses file oleh program, kami memiliki tabel yang cukup baik dengan perubahan dalam hukum: <br><br><img src="https://habrastorage.org/webt/oz/rf/hs/ozrfhsdae84_btpv9ma1ukceirk.jpeg"><br><br>  Program ini dapat diunduh dari tautan - di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Contoh file untuk diproses oleh program ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id465229/">https://habr.com/ru/post/id465229/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id465215/index.html">Apa yang harus dibaca pemimpin tim dan stasiun layanan: pilihan 50 buku dengan nilai dan banyak lagi</a></li>
<li><a href="../id465217/index.html">Acronis True Image 2020: Skema Replikasi Baru dan Perlindungan yang Ditingkatkan</a></li>
<li><a href="../id465221/index.html">Seperti apa register dalam 1C di hadapan OOP</a></li>
<li><a href="../id465223/index.html">Bagaimana memanfaatkan keamanan kertas secara praktis, atau mengapa kita perlu kepatuhan dengan 152-ФЗ dan PCI DSS dalam satu cloud</a></li>
<li><a href="../id465227/index.html">Augmented Reality dalam Retail Online</a></li>
<li><a href="../id465237/index.html">Polygonal Mesh ke B-Rep Konversi Padat: Detail Algoritma dan Sampel Kode C ++</a></li>
<li><a href="../id465239/index.html">Datang dan ambil buku dalam bahasa Inggris</a></li>
<li><a href="../id465241/index.html">Hari ketujuh saya dengan Haiku: daftar, pemindaian, jaringan</a></li>
<li><a href="../id465245/index.html">Lihat antarmuka "melalui mata desainer": tentang interaksi front-end dengan desainer</a></li>
<li><a href="../id465247/index.html">Sudut Memahami @Input, @Output, dan EventEmitter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>