<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍⚖️ 🧜🏻 🧡 Kami mengidentifikasi serangan virus enkripsi, mendapatkan akses ke pengontrol domain dan mencoba untuk melawan serangan ini. 🥀 💃 ⚛️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="WannaCry, NotPetya, BadRabbit, dan lainnya adalah virus ransomware yang mengguncang seluruh dunia sekitar satu atau dua tahun yang lalu. Saat ini ada ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami mengidentifikasi serangan virus enkripsi, mendapatkan akses ke pengontrol domain dan mencoba untuk melawan serangan ini.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/474574/"><img src="https://habrastorage.org/webt/ol/w0/dw/olw0dwca4jcb1xs3dod5nhtwfdo.gif"><br><br>  WannaCry, NotPetya, BadRabbit, dan lainnya adalah virus ransomware yang mengguncang seluruh dunia sekitar satu atau dua tahun yang lalu.  Saat ini ada lebih sedikit kebisingan tentang serangan jenis virus ini, tetapi cerita dengan serangan masih terjadi.  Pada artikel ini, saya akan menunjukkan salah satu alat untuk menghentikan serangan virus seperti itu: dengan cepat mendeteksi intrusi dan melokalisasi masalah.  Semua ini dengan bantuan analitik log dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">alat</a> perlindungan intrusi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Quest InTrust</a> .  Di bawah kucing adalah screenshot dan tautan ke repositori skrip berbahaya.  Ayo pergi! <br><a name="habracut"></a><br>  Quest InTrust adalah solusi terintegrasi yang mencakup pengumpulan berbagai jenis log, data syslog dan pengurai siap pakai untuk berbagai jenis peralatan.  Ada aturan yang telah ditetapkan untuk mengambil tindakan untuk mencegah serangan.  Sekarang kita akan melihat lebih dekat pada semua ini dengan contoh-contoh penguraian serangan virus enkripsi dan mendapatkan akses ke pengontrol domain <br><br><h1>  Serangan Ransomware </h1><br>  Prinsip serangan adalah membuat file atau folder terenkripsi baru dan menghapus yang asli.  Nah, maka permintaan tebusan dalam bitcoin atau dengan cara lain.  Definisi jenis serangan ini didasarkan pada deteksi penghapusan massal dan pembuatan file.  Apalagi jika ini terjadi setelah jam sekolah. <br><br><div class="spoiler">  <b class="spoiler_title">Beberapa repositori dengan contoh skrip enkripsi</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Powershell-Ransomware</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ansomware-encryptor-decryptor</a> <br></div></div><br>  Untuk mengumpulkan acara perubahan, kami menggunakan integrasi dengan solusi audit Quest Change Auditor (kami telah menulis tentang hal itu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di artikel sebelumnya</a> dan bahkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">membandingkannya dengan produk dari pesaing</a> ).  Untuk peristiwa dari sumber ini, InTrust telah menetapkan aturan untuk mendeteksi anomali.  Tentu saja, Anda dapat menambahkan logika pemrosesan peristiwa apa pun di sini.  Dalam contoh saya, ditentukan bahwa ketika membuat file dalam jumlah besar (lebih dari 5 buah dalam 1 menit), akun pengguna akan diblokir dan akses ke direktori bersama akan ditolak. <br><br><img src="https://habrastorage.org/webt/t3/s3/17/t3s317ynfhnygdue6ehjvy5gadi.png"><br><br>  Pengaturan kebijakan menunjukkan direktori di mana aturan berlaku dan daftar pemberitahuan.  Jika AD memiliki informasi tentang subordinasi karyawan, Anda dapat mengirim surat kepada atasannya.  Kasus yang berguna adalah identifikasi upaya untuk mengakses file yang, tampaknya, tidak diperlukan untuk pelaksanaan tugas oleh karyawan khusus ini.  Ini bisa sangat relevan sebelum pemecatan, ketika Anda ingin mengambil perkembangan siap pakai dengan Anda. <br><br><img src="https://habrastorage.org/webt/a5/xy/wy/a5xywya_veqwkqljbbrtzqsfyla.png"><br><br>  Setelah memeriksa semua pengaturan, mari beralih ke skrip-enkripsi yang sudah disiapkan sebelumnya.  Dan jalankan. <br><br><img src="https://habrastorage.org/webt/qd/f5/h-/qdf5h-zk24kdq47biltyggzgavg.png"><br><br>  Dalam pengaturan deteksi serangan, "lebih dari 5 file" ditunjukkan, seperti yang Anda lihat, setelah 7 file virus dihentikan (pengguna diblokir dan akses ke direktori dinonaktifkan).  Mudah turun.  Pada saat yang sama, karyawan yang bertanggung jawab menerima pemberitahuan. <br><br><h1>  Menyerang pengontrol domain </h1><br>  Di bawah ini adalah skenario serangan, yang memungkinkan Anda untuk mengakses akun administratif dan, sebagai hasilnya, pengontrol domain.  Deteksi eksekusi cmdlet <s>berbahaya</s> khusus (misalnya, membongkar akun domain) juga termasuk dalam daftar aturan Quest InTrust yang telah ditentukan (baris pertama dalam pemilihan pada gambar di bawah).  Selain itu, dalam contoh saya, pengguna dari "lembar putih" ditunjukkan yang aturannya tidak berlaku (baris kedua dalam pemilihan pada gambar di bawah). <br><br><img src="https://habrastorage.org/webt/bk/6j/eg/bk6jegg3lxxw_avksd2etqkhttg.png"><br><br>  Menggunakan skrip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">invoke-mimikatz</a> , pembuatan dump detail akun diaktifkan.  Pada saat yang sama, tidak ada file yang dibuat pada sistem file.  Pertama, periksa nama akun tempat Anda masuk.  Seperti yang Anda lihat, pengguna ini berasal dari "daftar putih", yang dapat dengan bebas mengeksekusi cmdlet apa pun. <br><br><img src="https://habrastorage.org/webt/mz/ge/wu/mzgewuwguxg1kc8vssgbddrgfxy.png"><br><br>  Kemudian kita menjalankan skrip yang sudah disiapkan.  Pada output, kami mendapatkan kesimpulan di mana kami menemukan detail pengguna pengujian kami. <br><br><img src="https://habrastorage.org/webt/b4/l6/oi/b4l6oioub43m6dnl1b2dhs9one0.png"><br><br>  Pada langkah berikutnya, kami mengetahui grup mana yang dimiliki oleh pengguna ini.  Grup administrator hadir. <br><br><img src="https://habrastorage.org/webt/-j/vy/92/-jvy928mvqdn7kjtgoquyhdvwqo.png"><br><br>  Sekarang kita belajar nama-nama pengontrol domain.  Dalam contoh saya, dia sendirian. <br><br><img src="https://habrastorage.org/webt/k2/v2/4z/k2v24z02-4bpvkudt703fpke5jc.png"><br><br>  Langkah selanjutnya dalam serangan potensial adalah masuk ke pengontrol domain.  Tetap memasukkan kata sandi yang sudah disorot. <br><br><img src="https://habrastorage.org/webt/ip/8u/d5/ip8ud53rjhhvejbjyf98u-4hbqo.png"><br><br>  Dan dapatkan akses ke eksekusi perintah apa saja pada pengontrol domain. <br><br><img src="https://habrastorage.org/webt/w7/uo/cu/w7uocu-xypu2qh9nd0ycdlxn2du.png"><br><br>  Sekarang mari kita coba melakukan algoritma tindakan yang sama, tetapi atas nama pengguna yang tidak ditambahkan ke "daftar putih" di InTrust.  Untuk kemurnian percobaan, kami memeriksa nama pengguna.  Kemudian kita menjalankan skrip invoke-mimikatz. <br><br><img src="https://habrastorage.org/webt/x-/8h/yp/x-8hypkn4uu8e4q8jhouok6rlvu.png"><br><br>  Di antara tindakan yang disebutkan dalam InTrust adalah penghentian sesi akses terminal dan memblokir pengguna.  Itulah yang terjadi. <br><br><img src="https://habrastorage.org/webt/fo/iu/sx/foiusxs7rjzlxzjomeows2ambus.png"><br><br>  Sekarang periksa akun ini lagi. <br><br><img src="https://habrastorage.org/webt/-h/fo/vj/-hfovjzipni1-kbpno0qlmmxxyc.png"><br><br>  Serangan dicegah, pengguna diblokir, dunia diselamatkan. <br><br>  Jika Anda memiliki kebijakan sendiri untuk memerangi berbagai jenis penyusup, Anda juga dapat menentukannya di InTrust.  Bersama dengan produk Quest lainnya ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Change Auditor</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Enterprise Reporter</a> ) berdasarkan InTrust, Anda dapat membangun sistem SIEM lengkap untuk mengidentifikasi dan mencegah konsekuensi serius dari serangan digital terhadap bisnis. <br><br>  InTrust dan produk Quest lainnya dapat dicoba di lingkungan Anda sebagai bagian dari proyek percontohan.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tinggalkan permintaan</a> untuk mencari tahu lebih lanjut. <br><br>  Artikel kami yang lain tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perangkat lunak</a> tag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gals</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id474574/">https://habr.com/ru/post/id474574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id474562/index.html">LEGO MINDSTORMS Education EV3 + MicroPython: kami memprogram konstruktor anak-anak dalam bahasa dewasa</a></li>
<li><a href="../id474564/index.html">Autosampler - Kehidupan Setelah Kehidupan</a></li>
<li><a href="../id474566/index.html">Kota ini membutuhkan pahlawan baru: ulasan tentang ransel tahan-bukti Bobby Hero</a></li>
<li><a href="../id474568/index.html">Susu dari gigi: perubahan profesi untuk sel</a></li>
<li><a href="../id474572/index.html">Apakah ini normal? Masalah norma dalam psikologi</a></li>
<li><a href="../id474576/index.html">Visi yang sehat Visi visi. Lihatlah keluar dari kegelapan</a></li>
<li><a href="../id474578/index.html">Mengapa layanan pemasaran email sebenarnya memerangi spam, dan bagaimana cara kerjanya</a></li>
<li><a href="../id474580/index.html">Membuat aplikasi dapat diakses menggunakan Pustaka Ketersediaan Pengujian kapak</a></li>
<li><a href="../id474582/index.html">(Tanpa) perbankan online berbahaya: studi tentang sumber daya web bank di Rusia dan dunia</a></li>
<li><a href="../id474584/index.html">Instal Kali Linux dengan antarmuka grafis pada server virtual</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>