<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ ๐ฉ๐ผโ๐ผ ูุฌูุณ ุงูุชูุณุน ูุญุงูุงุฉ ุงูุชูุช ุจู ๐ต๐ฟ ๐ค ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุชุฑุฉ ุทูููุฉ ุ ุฏุฎู ุงูููุจููุชุฑ ุงูุตุบูุฑ Raspberry Pi ุญูุงุฉ ุงูููููุณูู ููุณุคููู ุงููุธุงู ูุงููุจุฑูุฌูู ูุงููููุฏุณูู ุงูุฅููุชุฑููููู. ุบูุฑ ููููุฉ ููููุฉ ูุณุจููุง ููุฆุชูุง ุ ูุน ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุฌูุณ ุงูุชูุณุน ูุญุงูุงุฉ ุงูุชูุช ุจู</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401089/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุฑุฉ ุทูููุฉ ุ ุฏุฎู ุงูููุจููุชุฑ ุงูุตุบูุฑ Raspberry Pi ุญูุงุฉ ุงูููููุณูู ููุณุคููู ุงููุธุงู ูุงููุจุฑูุฌูู ูุงููููุฏุณูู ุงูุฅููุชุฑููููู. ุบูุฑ ููููุฉ ููููุฉ ูุณุจููุง ููุฆุชูุง ุ ูุน ููุงูุฐ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงููุฏูุฌุฉ ุ ูููููุง ุงูุชุนุงูู ูุน ุงูููุงู ุงููุฎุชููุฉ ูุชูุจูุฉ ุงุญุชูุงุฌุงุช ุงููุณุชุฎุฏู. ุจุนุฏ ุฃู ุงุดุชุฑูุช Raspberry Pi ุ ุฃุฑุฏุช ุดูุฆูุง ูุชุดุบูู ุงูุฃุฌูุฒุฉ ุงูุฎุงุฑุฌูุฉ ูููุงุณูุง ูุฅุฏุงุฑุชูุง. ูุชู ุจูุน ุนุฏุฏ ูุจูุฑ ูู ุจุทุงูุงุช ุงูุชูุณูุน ุญุงูููุง ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุซู ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููููู ุงุณุชุฎุฏุงู ุงูููุญ ูุน ุงูุฃุณูุงู ููููุงุฐุฌ ุงูุฃูููุฉ ุงูุณุฑูุนุฉ ุ ููููู ุฃูุถู ุฃู ุฃุตูุน ุงูุฃุฌูุฒุฉ ุจููุฑุฏู ุ ูููุงู ูุญุฏุฏุฉ. </font><font style="vertical-align: inherit;">ูุฃูู ูุฑุฉ ุ ูู ุฃุณุชุฎุฏู ูุดุทูุง ูู ุตููู ูุฌููุน ุงููุฎุฑุฌุงุช ุ ููููู ุงูุชุตุฑุช ุนูู ุงูุนุฏูุฏ ูู ููุงูุฐ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ู SPI ู I2C ู UART bus. </font><font style="vertical-align: inherit;">ููุฏ ููุช ุจุชูุตูู Raspberry Pi ุจุงูุฃุณูุงู ุงููุณุชูุฏูุฉ ูููููุฐุฌ ุงูุฃููู "mom-mom". </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/eef/18f/ae2/eef18fae242d47dab3f10bb6a4cfb21b.jpg" alt="ุงูุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐุง ุงูุตุฏุฏ ุ ุชู ุชุทููุฑ ุณูุณูุฉ ูู ุซูุงุซ ููุญุงุช ููููุงุฐุฌ ุงูุฃูููุฉ ุ ุญูู ูุงุญุฏุฉ ูููุง ุ ุฃุจุณุท ูุง ุณุฃูุงูุดู ูู ูุฐู ุงูููุงูุฉ.</font></font><a name="habracut"></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ุงุญุชุงุฌู:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนูู ูุน GPIO ูุน ูู ูู ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ุ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฏุงุฑุฉ ุงูุฃุญูุงู ุ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุตูู ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ูุงูู 1-Wire ุ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุณ ุงูุฌูุฏ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุงุนุฉ ุงูููุช ุงูุญูููู </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฑุงูุจุฉ ููุฑุงูุจุฉ ุฌูุงุฒ ุฎุงุฑุฌู ุนุจุฑ ูุงูู RS485 ุ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุตุฏุฑ ุทุงูุฉ ูููุตู ูุจุทุงูุฉ ุงูุชูุณุน ุ </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุง ูููุงุฆูุฉ ุฃุนูุงู ุ ุชู ุชุทููุฑ ุฏุงุฆุฑุฉ ููุฑุจุงุฆูุฉ: </font></font><br>
<img src="https://habrastorage.org/files/cc4/136/432/cc41364328f3449094dc0b05a940a987.jpg" alt="ุงูุตูุฑุฉ"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
โ </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุงุฆุฑุฉ ูู ูุญุฏุฉ ุชุฎุฒูู ุนุงููุฉ ุงูุฏูุฉ</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุชุณุชุฎุฏู ุงูุฏุงุฆุฑุฉ ูุตุฏุฑ ุทุงูุฉ ูุญูู ุจููู ุฎุฑุฌ. ูุนูู ุงูููู ุงูุฃูู ุนูู ููุธู ุฌูุฏ ุฎุทู ูุน ุฎุฑุฌ 5 ูููุช ุ ูุชุดุบูู ุฑูุงูุฉ ุณุงุฆู RS485 ูุงูุณุงุนุฉ ูู ุงูููุช ุงูุญูููู. ูุชู ุงุณุชุฎุฏุงู ุงูููุฉ ุงูุซุงููุฉ ูุชุดุบูู ุงููุฑุญูุงุช ุงูููุฑููุบูุงุทูุณูุฉ ูุงูุชุฌููุน ูุน ุชุฑุงูุฒุณุชูุฑุงุช ุฏุงุฑูููุฌุชูู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุชุดุบูู ูุณุชุดุนุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ DS18B20 + 3.3V ูู ููุญุฉ Raspberry Pi ุ ูุชุญุชูู ุงูููุญุฉ ุนูู ููุตู ูุชูุตูู ูุณุชุดุนุฑุงุช DS18B20 ุงูุฎุงุฑุฌูุฉ ุ ููุชู ุฃุฎุฐ ููุณ ุงูุฌูุฏ ู ADC ููุณุชููุงุช ูุทุงุจูุฉ ูุน ุณุงุนุฉ ุงูููุช ุงูุญูููู. ุชุณุชุฎุฏู ุงูุฏุงุฆุฑุฉ ุฃุฑุจุนุฉ ุฃุฒุฑุงุฑ S1-S4 ููุชุญูู ูู ุฃู ุฅุฌุฑุงุกุงุช ุชุนูู ุนูู ูุณุชูู ููุทู ููุฎูุถ. ููุชุญูู ูู ุงูุฃุญูุงู ุ ูุชู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุงูุชุฑุงูุฒุณุชูุฑ DD1 ULN2003 ูุน ุงูุซูุงุฆูุงุช ุงููุงููุฉ ุงููุฏูุฌุฉ. ุชุฑุชุจุท ุงููุฑุญูุงุช K1 ู K2 ุจุงูุฏุจุงุจูุณ 16 ู 15 ูู ูุฌููุนุฉ ุงูุชุฑุงูุฒุณุชูุฑ ุ ูุชุฑุชุจุท ูุคุดุฑุงุช LED ููุฅุดุงุฑุฉ ุจุงูุฏุจุงุจูุณ 14-12 ุ ูุงูุฏุจุงุจูุณ 11 ู 10 ูุตููุฉ ููุงุชุตุงู ุจุงูุฃุฌูุฒุฉ ุงูุฎุงุฑุฌูุฉ ููููุง ูููุฎุทุท ูุน ุฌุงูุน ูุดุชุฑู ุฃู ูุฑุญูุงุช ุฅุถุงููุฉ ุจุฌูุฏ ูุชุนุฑุฌ + 12 ูููุช.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุงุณ ุงูุฌูุฏ ุ ูุชู ุงุณุชุฎุฏุงู ููุงุชูู ูู 10 ุจุช ADC DD3 MCP3008 ูุน ูุงุฌูุฉ SPI ุ ูุน ูุฑุดุญ ุชูุฑูุฑ ุชูุฑูุฑ ููุฎูุถ. ุงูุนูุฏุฉ ุงูุชูุงุธุฑูุฉ ูุตููุนุฉ ุจุดูู ุฃุณุงุณู ุ ูุฃุบุฑุงุถ ุฃูุงุฏูููุฉ ุฃู ูุชุตุญูุญ ุณุฑูุน. ุฅุฐุง ุธูุฑ ุณุคุงู ุญูู ุงูููุงุณ ุงูููุนู ููุฅุดุงุฑุฉ ุงูุชูุงุธุฑูุฉ ุ ูุณูุชุนูู ุนููู ูุตู ุงูุฃุฑุถูุฉ ุงูุฑูููุฉ ูุงูุชูุงุธุฑูุฉ ุ ูุงุณุชุฎุฏุงู ูุตุฏุฑ ูุฑุฌุนู ุฎุงุฑุฌู ููุฌูุฏ. ุจุฏูุงู ูู ุฐูู ุ ูููู ุฅุฌุฑุงุก ุงูุฌุฒุก ุงูุชูุซููู ุนูู ุงููุญู ุงูุชุงูู: </font></font><br>
<br>
<img src="https://habrastorage.org/files/d8d/148/dee/d8d148deee074957a46ab433620aea05.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูููู ูู ุงูุถุฑูุฑู ููุท ุงุณุชุฎุฏุงู ูุญูู ูุณุชูู TTL โ LVTTL ูู ูุงูู SPI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุชุตููุน ุณุงุนุฉ ุงูููุช ุงูุญูููู DD4 ุนูู ุดุฑูุญุฉ DS1307 ุ ููุณุชุฎุฏู ูุฑูุงู ุงูููุงุฑุชุฒ Q1 ุจุชุฑุฏุฏ 32.768 ูููููุฑุชุฒ ูุชุณุฌูู ุงูููุช. ูุชู ุงุณุชุฎุฏุงู ุจุทุงุฑูุฉ ููุซููู 3 ูููุช ููุญููุฉ ูู ุงูููุญุฉ ูุชุดุบูู ุฑูุงูุฉ ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุนูู ูุฏุงุฑ ุงูุณุงุนุฉ. ูุชู ุชูุตูู ุงูุฏุงุฆุฑุฉ ุงููุตุบุฑุฉ ุนู ุทุฑูู ูุญูู ูุณุชูู 5V-3.3V ูุตููุน ุนูู ุชุฑุงูุฒุณุชูุฑุงุช MOS VT2 ู VT3 ุฅูู Raspberry Pi ุนุจุฑ ูุงูู I2C (ูุณุชุฎุฏู CAD ุงูุงุชุตุงู ุจุงูุฎุทูุท ุฏูู ุงุชุตุงู ุตุฑูุญ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุดุบู UART โ RS485 ุ ุชู ุงุณุชุฎุฏุงู ุดุฑูุญุฉ DD2 ST485. ุณูุญุช ุญููู ุงูุฏูุงุฆุฑ ุจุงุณุชุฎุฏุงู ุงูุชุฑุงูุฒุณุชูุฑ VT1 ุจุงูุชุฎูู ุนู ุฎุฑุฌ ูููุตู ููุชุญูู ูู ุฌูุงุฒ ุงูุฅุฑุณุงู ูุงูุงุณุชูุจุงู. ูุชุญูู ุฅูู ูุถุน ุงูุฅุฑุณุงู ููุท ุนูุฏูุง ูููู UART ุจุฅุฑุณุงู ุงูุจูุงูุงุช ุ ูุงูุจุงูู ูู ุงูููุช ูููู ST485 ูู ูุถุน ุงูุงุณุชูุจุงู. ุชุชู ุฅุฒุงูุฉ ุฃูุฑ ุงูุชุญูู ูู ุฌูุงุฒ ุงูุฅุฑุณุงู ูุงูุงุณุชูุจุงู ูู ุฌุงูุน ุงูุชุฑุงูุฒุณุชูุฑ VT1.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุชุญููู ุงููุงุฌูุงุช ุ ูุคุฏู ูุฐุง ุงููุฎุทุท ุฃูุถูุง ูุธููุฉ ูุทุงุจูุฉ ูุณุชููุงุช LVTTL ููุงุฌูุฉ UART Raspberry Pi ูุน ูุณุชููุงุช TTL ูุจุฑูุงูุฌ ุงูุชุดุบูู ST485. </font><font style="vertical-align: inherit;">ุชุณุญุจ ุงูุฅุดุงุฑุฉ ุงููุฃุฎูุฐุฉ ูู ุฌุงูุน ุงูุชุฑุงูุฒุณุชูุฑ VT1 ุงููุณุชูู ุนูุฏ ุฅุฏุฎุงู DI ุฅูู 5V ุ ููุญุฏ ุงูููุงูู R16 ู Zener diode VD8 ูู ุงููุณุชูู ูู ุงูุฅุฎุฑุงุฌ R0 ุฅูู 3.3V. </font><font style="vertical-align: inherit;">ูุง ุชูุชุจู ุฅูู ุงูููุงูู R11 ุ ููุฏ ุจูู ูู ุงูุฏุงุฆุฑุฉ ุฃุซูุงุก ุงูุชุตุญูุญ. </font><font style="vertical-align: inherit;">ุชู ุงุฎุชุจุงุฑ RS485 ูุน ุจุฑูุชูููู ModBus RTU ุนูุฏ 115200 ุจุงูุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูุงุกู ุนูู ุฐูู ุ ุชู ุชุทููุฑ ููุญุฉ ุงูุฏูุงุฆุฑ ุจุดูู ุฃูุจุฑ:</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ca/501/7a8/2ca5017a8cba4f22b49cb6c8ea588855.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุฌ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูููุญุฉ ุงูุฏูุงุฆุฑ ุงููุทุจูุนุฉ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/0d3/058/62d/0d305862d003420aa0dfaa41f5a57d78.png"><br>
<img src="https://habrastorage.org/files/cbc/3d6/3b3/cbc3d63b39b44d2aa22887874155660c.bmp"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุตูุฑุฉ ููุฌูุงุฒ ุงูููุงุฆู ูุงูุนูู ูุน ููุญุฉ ุงูุชูุณูุน:</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/e60/3b4/9d7/e603b49d769b4fc1888d7350b9dbe63f.jpg"><br>
<br>
<img src="https://habrastorage.org/files/2fb/710/6e3/2fb7106e3cec47ea9de5b947ebc091ed.jpg"><br>
<br>
<img src="https://habrastorage.org/files/132/e3e/4d0/132e3e4d025a47ebb5a982e69ed7c213.jpg"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุจุฏูู ููุฎุทุท ุงูุงุชุตุงู ูุน ุงูุฃุฌูุฒุฉ ุงูุฎุงุฑุฌูุฉ: </font></font><br>
<img src="https://habrastorage.org/files/4bb/b2f/c3c/4bbb2fc3c13849398f32165e87ce506f.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุญูู ูู ุนูุฏ ููุญุฉ ุงูุชูุณุนุฉ ุ ุงุณุชุฎุฏูุช ุฒูุฌูุง ูู ุงููุตูุต ุงูุจุฑูุฌูุฉ ูู ุงูุซุนุจุงู (ูุง ุฃุนุฑู ูุฐู ุงููุบุฉ ุ ูุชุจุช ุจุงูุชุฌุฑุจุฉ ูุงูุฎุทุฃ ุ ูุงููุธุฑ ูู ุฑููุฒ ุงููุชุฎุตุตูู) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุงุณ ุงูุฌูุฏ ูู ูููุงุณ ุงูุฌูุฏ ุงููุชุตู ุจูููุงุช ADC ุ ูุชุจุช ุจุณูุทุฉ ุงูุจุฑูุงูุฌ ุงููุตู:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุฏุฑ MCP3008 ุจูุซูู</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment"># Example program to read data from MCP3008 10 bit ADC</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spidev
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Open SPI bus</span></span><font></font>
spi = spidev.SpiDev()<font></font>
spi.open(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Function to read SPI data from MCP3008 chip</span></span>
<span class="hljs-comment"><span class="hljs-comment"># Channel must be an integer 0-7</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadChannel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(channel)</span></span></span><span class="hljs-function">:</span></span>
  adc = spi.xfer2([<span class="hljs-number"><span class="hljs-number">1</span></span>,(<span class="hljs-number"><span class="hljs-number">8</span></span>+channel)&lt;&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>])<font></font>
  data = ((adc[<span class="hljs-number"><span class="hljs-number">1</span></span>]&amp;<span class="hljs-number"><span class="hljs-number">3</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + adc[<span class="hljs-number"><span class="hljs-number">2</span></span>]
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Function to convert data to voltage level,</span></span>
<span class="hljs-comment"><span class="hljs-comment"># rounded to specified number of decimal places.</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertVolts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data,places)</span></span></span><span class="hljs-function">:</span></span>
  volts = (data * <span class="hljs-number"><span class="hljs-number">3.3</span></span>) / float(<span class="hljs-number"><span class="hljs-number">1023</span></span>)<font></font>
  volts = round(volts,places)<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> volts<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Define sensor channels</span></span>
first_channel = <span class="hljs-number"><span class="hljs-number">0</span></span>
second_channel  = <span class="hljs-number"><span class="hljs-number">1</span></span><font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Define delay between readings</span></span>
delay = <span class="hljs-number"><span class="hljs-number">5</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"------------------------------------------------------"</span></span><font></font>
 <font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Read the first channel data</span></span><font></font>
  first_level = ReadChannel(first_channel)<font></font>
  first_channel_volts = ConvertVolts(first_level,<span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Read the second channel data</span></span><font></font>
  second_level = ReadChannel(second_channel)<font></font>
  second_channel_volts = ConvertVolts(second_level,<span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  <font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Print out results</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"------------------------------------------------------"</span></span>
  print(<span class="hljs-string"><span class="hljs-string">"First ADC channel: {} ({}V)"</span></span>.format(first_level,first_channel_volts))<font></font>
  print(<span class="hljs-string"><span class="hljs-string">"Second ADC channel : {} ({}V)"</span></span>.format(second_level,second_channel_volts))<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Wait before repeating loop</span></span><font></font>
  time.sleep(delay)<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุงุณุชุฎุฏุงู ุงูุจุฑูุงูุฌ ุงููุตู ุงูุชุงูู ููุนูู ูุน ููุงุฒูู ุงูุญุฑุงุฑุฉ DS18B20:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS18B20 ูุตุฏุฑ ุจูุซูู</font></font></b><div class="spoiler_text">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a><br>
<pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Example program to read data from DS18B20</span></span>
<span class="hljs-comment"><span class="hljs-comment"># This code taken from</span></span>
<span class="hljs-comment"><span class="hljs-comment"># https://kropochev.com/?go=all/raspberry-pi-and-onewire-sensor/</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> glob
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time<font></font>
<font></font>
os.system(<span class="hljs-string"><span class="hljs-string">'modprobe w1-gpio'</span></span>)<font></font>
os.system(<span class="hljs-string"><span class="hljs-string">'modprobe w1-therm'</span></span>)<font></font>
<font></font>
base_dir = <span class="hljs-string"><span class="hljs-string">'/sys/bus/w1/devices/'</span></span>
device_folder = glob.glob(base_dir + <span class="hljs-string"><span class="hljs-string">'10*'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]<font></font>
device_file = device_folder + <span class="hljs-string"><span class="hljs-string">'/w1_slave'</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp_raw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    f = open(device_file, <span class="hljs-string"><span class="hljs-string">'r'</span></span>)<font></font>
    lines = f.readlines()<font></font>
    f.close()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lines<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span><font></font>
    lines = read_temp_raw()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> lines[<span class="hljs-number"><span class="hljs-number">0</span></span>].strip()[<span class="hljs-number"><span class="hljs-number">-3</span></span>:] != <span class="hljs-string"><span class="hljs-string">'YES'</span></span>:<font></font>
        time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)<font></font>
        lines = read_temp_raw()<font></font>
    equals_pos = lines[<span class="hljs-number"><span class="hljs-number">1</span></span>].find(<span class="hljs-string"><span class="hljs-string">'t='</span></span>)
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> equals_pos != <span class="hljs-number"><span class="hljs-number">-1</span></span>:<font></font>
        temp_string = lines[<span class="hljs-number"><span class="hljs-number">1</span></span>][equals_pos+<span class="hljs-number"><span class="hljs-number">2</span></span>:]<font></font>
        temp_c = float(temp_string) / <span class="hljs-number"><span class="hljs-number">1000.0</span></span>
        temp_f = temp_c * <span class="hljs-number"><span class="hljs-number">9.0</span></span> / <span class="hljs-number"><span class="hljs-number">5.0</span></span> + <span class="hljs-number"><span class="hljs-number">32.0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temp_c, temp_f<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:<font></font>
    print(read_temp())<font></font>
    time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ูุซูุช ุฃูุถูุง ุงูุฅุนุฏุงุฏุงุช ูู Raspbian:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููู ุงูุฃุฌูุฒุฉ</font></font></b><div class="spoiler_text"><blockquote> โ 1 Wire settings:<br>
 โ Raspbian wheezy<br>
<br>
Enter command in console:<br>
pi@raspberrypi~$ sudo modprobe w1-gpio<br>
pi@raspberrypi~$ sudo modprobe w1_therm<br>
<br>
Then check sensor in system:<br>
pi@raspberrypi ~ $ sudo ls /sys/bus/w1/devices/w1_bus_master1/<br>
<br>
You can see the tabel below entered comman and<br>
there you should find HEX like 28-000002da8328; <br>
This is DS18B20 address;<br>
<br>
Next read the data from DS18B20 sensor using command:<br>
pi@raspberrypi ~ $ cat /sys/bus/w1/devices/w1_bus_master1/28-000002da8328/w1_sla <br>
<br>
And you are going see temperature in console like:<br>
6f 01 4b 46 7f ff 01 10 67: crc=67 YES<br>
6f 01 4b 46 7f ff 01 10 67 t=22937<br>
<br>
t=22937 โ you should divide this number on 1000 and you will have temperature in Celsius;<br>
<br>
 โ Raspbian Jezzy<br>
<br>
Enter command:<br>
pi@raspberrypi~$ sudo nano /boot/config.txt<br>
<br>
On next step you should write in config file <br>
dtoverlay=w1-gpio,gpiopin=4 <br>
dtoverlay=w1-gpio-pullup<br>
<br>
Then you should reboot your raspberry Pi;<br>
<br>
 โ I2C Real Time Clock settings:<br>
 โ Update your system if it needed and install i2c-tools:<br>
pi@raspberrypi~$ sudo apt-get update<br>
pi@raspberrypi~$ sudo apt-get -y upgrade<br>
pi@raspberrypi~$ sudo apt-get i2c-tools:<br>
<br>
Enter command:<br>
pi@raspberrypi~$ sudo nano /etc/modules<br>
Add these lines:<br>
i2c-bcm2708<br>
i2c-dev<br>
rtc_ds1307<br>
 <br>
Comment one line in file:<br>
pi@raspberrypi~$ sudo nano /etc/modprobe.d/raspi-blacklist.conf<br>
Add # Symbol in beginning of line<br>
<br>
blacklist i2c-bcm2708<br>
________________________________________________________<br>
Reboot system;<br>
Enter command:<br>
pi@raspberrypi~$ sudo lsmod<br>
<br>
You will see lines like:<br>
rtc_ds1307 7715 0<br>
i2c_dev 5277 0 <br>
i2c_bcm2708 4719 0<br>
________________________________________________________<br>
<br>
Get DS1307 address:<br>
pi@raspberrypi~$ sudo i2cdetect -y 1<br>
<br>
You will see table in console:<br>
<br>
0 1 2 3 4 5 6 7 8 9 a b c d e f<br>
00: โ -- โ -- โ -- โ -- โ -- โ -- โ 10: โ -- โ -- โ -- โ -- โ -- โ -- โ -- โ --<br>
20: โ -- โ -- โ -- โ -- โ -- โ -- โ -- โ --<br>
30: โ -- โ -- โ -- โ -- โ -- โ UU โ -- โ --<br>
40: โ -- โ -- โ -- โ -- โ -- โ -- โ -- โ --<br>
50: โ -- โ -- โ -- โ -- โ -- โ -- โ -- โ --<br>
60: โ -- โ -- โ -- โ -- 68 โ -- โ -- โ -- โ 70: โ -- โ -- โ -- โ --<br>
 <br>
In address 0x3b some device without driver and 0x68 perhaps DS1307 clock address. <br>
<br>
Enter command:<br>
echo ds1307 0x68 &gt; /sys/class/i2c-adapter/i2c-1/new_device<br>
<br>
Read clock:<br>
pi@raspberrypi~$ sudo hwclock -r<br>
<br>
Set time:<br>
pi@raspberrypi~$ sudo hwclock -w<br>
Set system time from RTC:<br>
pi@raspberrypi~$ sudo hwclock -s<br>
<br>
Automatic RTC start;<br>
Add lines in /etc/rc.local file<br>
<br>
echo ds1307 0x68 &gt; /sys/class/i2c-adapter/i2c-1/new_device<br>
sudo hwclock -s<br>
Before last line in file looks like:<br>
<br>
exit 0<br>
 โ Uart settings:<br>
 โ Back up files:<br>
cp /boot/cmdline.txt /boot/cmdline.bak<br>
cp /etc/inittab /etc/inittab.bak<br>
<br>
Delete ยซconsole=ttyAMA0,115200ยป  ยซkgdboc=ttyAMA0,115200ยป lines from configuration file:<br>
pi@raspberrypi~$ nano /boot/cmdline.txt<br>
<br>
Comment last line looks like ยซT0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100: in /etc/inittab file: using # symbol:<br>
pi@raspberrypi~$ nano /etc/inittab<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ููุงู ุญุงุฌุฉ ูุงุณุฉ ุฅูู ููุญุฉ ุงูุฏูุงุฆุฑ ุงูููุฑุจูุฉ ุ ูุฐูู ููุช ุจููุณู ุจุงุณุชุฎุฏุงู ุชูููุฉ LUT ูุณุงุนุชูู ูู ููุช ุงููุฑุงุบ. </font><font style="vertical-align: inherit;">ูู ุฃุฌู ุชุณููู ุงูุนูู ูุชูููุฑ ุงูููุช ุ ุชู ุตูุน ููุญุฉ ุงูุฏุงุฆุฑุฉ ูู ุฌุงูุจ ูุงุญุฏ ูุน ูุตูุงุช ูู MGShV 0.5. </font><font style="vertical-align: inherit;">ุฏุงุฆุฑุฉ DipTrace ูุชุตููู PCB ุ ุฑููุฒ ูุตุฏุฑ ุงูุงุฎุชุจุงุฑ ุ ูุงุฆูุฉ ุงูููููุงุช ูุงูุจุฑูุงูุฌ ุงูุชุนูููู ูุน ุฃูุงูุฑ ููุชูููู ูู </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุณุชูุฏุน</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูููุฏูู ุฃุฏูุงู ุ ุชู ุงุณุชุฎุฏุงู ุฃูู ููุญุฉ ูุญุงูุงุฉ ุ ุชู ุชุฌููุนูุง ุนูู ููุญุฉ ุชูุตูู ุจุฃุฒุฑุงุฑ ููุตุงุจูุญ LED ูู 20 ุฏูููุฉ ุ ุธูุฑุช ุงูุฅุตุฏุงุฑุงุช ุงูุชุงููุฉ ุนูู ุฃุณุงุณูุง:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5uCV_gNWw2Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar401089/">https://habr.com/ru/post/ar401089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar401077/index.html">ุณุชุณุชุซูุฑ ุงูุตูู 168 ููููู ุฏููุงุฑ ูู ุงูุณุญุจ ุญุชู ูุณูุท ุงููุฒูุฏ ูู ุงูุฃูุทุงุฑ ูู ุดูุงู ุบุฑุจ ุงูุจูุงุฏ</a></li>
<li><a href="../ar401079/index.html">ูุงุถุญ: ุชุญูู ุขูู ุจุฅุถุงุกุฉ ุงูุญูุงู</a></li>
<li><a href="../ar401083/index.html">ุฅุนุงุฏุฉ ุงูุชุดุบูู: ูุงุฐุง ุณูุญุฏุซ ุฅุฐุง ุชู ุชูุณูุฑ ุงูุญุฏูุฏ ุงููุฏูู ุจุงูููุชุฑูุฌูู ูุงูููููููุ</a></li>
<li><a href="../ar401085/index.html">Lakhta Terra Incognita: ูุนุฑูุฉ ุงุณุชุฏุงูุฉ ูุงุทุญุฉ ุณุญุงุจ</a></li>
<li><a href="../ar401087/index.html">ููุธูุฉ ุงูุนูู ุงูุฏูููุฉ: ุฎุฏุงุน ุ ูุฃุฎุฐ ุงููุงู ูู ุงูุณูุงู ููุฒููุฉ ุนุฏู ุงููููู</a></li>
<li><a href="../ar401091/index.html">ุงููุฌุฑ 7 ููุชุฌุงุช ุฑูููุฉ ูุณุทุญ ุงูููุชุจ ูู ุนุงู 2017</a></li>
<li><a href="../ar401093/index.html">Sony Xperia Ear Xea10: ุฒุญู ูุณุงุนุฏ ุงูุตูุช ุฅูู ุงูุฃุฐููู</a></li>
<li><a href="../ar401095/index.html">ูุงุฐุง ูุฌุจ ุฃู ุฃุนุทูู ูุง ุนุฒูุฒูุ</a></li>
<li><a href="../ar401097/index.html">ุชุนุฑู ุนูู ุงูุทูู ุงูุฌุฏูุฏ</a></li>
<li><a href="../ar401101/index.html">ุจุฏุฃุช ุงููููุงุช ุงููุญุฐููุฉ ูู ุงูุนูุฏุฉ ุฅูู ูุฌูุฏุงุช Dropbox. ุชู ุฅุตูุงุญ ุงูุฎูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>