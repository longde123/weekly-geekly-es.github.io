<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüîß ü§¶üèΩ üßìüèΩ The Standoff: wie es war üèáüèΩ üå≤ üï≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gr√º√üe! Nachdem wir bei PHDays 9 gen√ºgend Interesse an den Ereignissen bei The Standoff in den Reihen der Verteidiger gesehen hatten, beschlossen wir, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>The Standoff: wie es war</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/454298/"><img src="https://habrastorage.org/webt/ef/tx/b3/eftxb30vyae7fr5w6xkios-nl9q.jpeg"><br><br>  Gr√º√üe!  Nachdem wir bei PHDays 9 gen√ºgend Interesse an den Ereignissen bei The Standoff in den Reihen der Verteidiger gesehen hatten, beschlossen wir, dar√ºber zu sprechen, wie die Vorbereitung und die ‚ÄûPattsituation‚Äú mit den Augen des Jet CSIRT als Teil des Jet Security Teams stattfanden. <br><a name="habracut"></a><br><h3>  Guo Standoff habe ich erstellt </h3><br>  So etwas berichteten die Kollegen, dass wir wieder an The Standoff teilnahmen, und wir waren uns nat√ºrlich einig. <br><br>  Es ist sofort erw√§hnenswert, dass sich f√ºr die Verteidiger in diesem Jahr das Format des Wettbewerbs etwas ge√§ndert hat.  Alle Teams erhielten sehr √§hnliche B√ºroinfrastrukturen, und dies erm√∂glichte es den Organisatoren, bei bestimmten Papageien eine Bewertung der Verteidiger einzugeben.  F√ºr das Jet Security Team war dies die erste "Konfrontation", bei der das B√ºro verteidigt wurde und nicht die industrielle Infrastruktur. <br><br>  Wir haben Zugang zur Infrastruktur, um uns auf den Cyberkampf Ende April vorzubereiten.  Nach der Pr√ºfung der Infrastruktur wurde eine ganze Reihe von M√§ngeln zusammengestellt, hier nur einige davon.  Absolut in der gesamten Infrastruktur gab es keine tats√§chlichen Patches.  Die Passw√∂rter aller Benutzer k√∂nnen √ºber Ntds.dit im Klartext abgerufen werden.  Dar√ºber hinaus hatten einige Benutzer Passw√∂rter aus der TOP-500-Liste oder Passw√∂rter mit einem leicht umkehrbaren Hash.  Die Systemh√§rtung war nahezu nichts oder gar nichts.  Einige Hosts in der DMZ hatten eine Schnittstelle im Server-Subnetz. <br><br>  Basierend auf den Ergebnissen des Audits haben wir bestimmte Sicherheitsma√ünahmen entwickelt, und die Organisatoren haben uns nach vorheriger Genehmigung gestattet, die erforderlichen Richtlinien anzuwenden und alle Sicherheitstools und Tools mitzubringen, die in einer virtuellen Umgebung bereitgestellt werden k√∂nnen.  Aufgrund der engen Fristen fielen zu Beginn einige Ideen zu Schutzma√ünahmen aus.  Die Haupteinstellungen und die Profilerstellung des SPI wurden in den Maiferien durchgef√ºhrt (Hallo an alle, die Bilder von den Picknicks geworfen haben, wir lieben Sie auch), und einige der Schutzausr√ºstungen mussten direkt vor dem Start direkt vor Ort abgestimmt werden.  Au√üerdem war es einigen Diensten verboten, Patches zu erstellen und stark neu zu konfigurieren.  Eines davon war beispielsweise Oracle Weblogic mit CVE-2019-2725, das PoC Anfang Mai 2019 ver√∂ffentlicht wurde. <br><br>  Nun, und eine Liste von dem, was wir mitgebracht haben: <br><br><ul><li>  Firewall (vom Veranstalter bereitgestellt wurde ersetzt); </li><li>  Antivirus-L√∂sung; </li><li>  WAF; </li><li>  EDR </li><li>  Ein paar T√§uschungsl√∂sungen; </li><li>  Ein Paar Schwachstellenscanner; </li><li>  ELK-Stack f√ºr zus√§tzliche Netflow-Analyse; </li><li>  SIEM. </li></ul><br>  Wir sollten auch dar√ºber sprechen, was zu SIEM gehen w√ºrde.  Als Ereignisquellen standen uns die Windows-Protokolle, Sysmon-, Auditd-Protokolle und, wie Sie sich vorstellen k√∂nnen, Ereignisse aus dem SZI selbst zur Verf√ºgung.  Wenn es bei den ersten beiden keine besonderen Probleme gab und wir uns schnell auf √Ñnderungen in der Sysmon-Richtlinie und -Konfiguration einigten, mussten wir uns mit den Organisatoren f√ºr die Auditd-Konfiguration auseinandersetzen. <br><br>  Parallel dazu haben wir die Hauptangriffsvektoren identifiziert und darauf basierend relevante Szenarien und Korrelationsregeln ausgew√§hlt und angepasst - insgesamt etwa 160 Korrelationsregeln.  Au√üerdem wurde eine Reihe bunter Dashboards f√ºr kritische Knoten, SZI und das, was besondere Aufmerksamkeit in der Gaming-Infrastruktur erfordert, zusammengestellt. <br><br><h3>  Die Pattsituation </h3><br>  F√ºr The Standoff haben wir uns entschlossen, das Konzept der Trennung von Vorf√§llen in externe und interne Vorf√§lle beizubehalten, da genau bekannt war, dass wir au√üerhalb aktiv versuchen w√ºrden, das Web zu scannen und zu betreiben.  Vorf√§lle im Zusammenhang mit dem Scannen und Versuchen, WAF zu umgehen, wurden separat √ºberwacht. Mit einer niedrigeren Priorit√§t konnten wir uns auf interne Vorf√§lle konzentrieren.  Dashboards f√ºr SPI wurden zwischen Verteidigern in Verantwortungsbereichen verteilt, und jedem Tool wurden mindestens 2 Personen zugewiesen - f√ºr die M√∂glichkeit der Rotation und Ruhe. <br><br>  Alles passierte wie erwartet.  Die Konfrontation begann gegen 10 Uhr morgens, und sobald der Start erfolgte, gab das SIEM-System eine Reihe von Vorf√§llen im Zusammenhang mit einem externen Scan und Versuchen von Angreifern aus, das Web auszunutzen.  In einigen F√§llen hat sogar die Gruppe nicht gespeichert.  Gleichzeitig begannen die Pr√ºfer der Organisatoren zu arbeiten und √ºberpr√ºften den Status verschiedener Dienste im B√ºro, was uns dazu zwang, die Profilerstellung in gewissem Ma√üe neu durchzuf√ºhren, um die damit verbundenen Fehlalarme auszuschlie√üen. <br><br>  In den ersten Stunden des Spiels gelang es dem Hack.ERS-Team, die Standardanmeldeinformationen des Administrators (admin / admin) auf dem CMS einer der Ressourcen zu finden und eine potenzielle LFI-Sicherheitsanf√§lligkeit zu erkennen.  Diese Versuche blieben nicht unbemerkt, unsere Verteidiger f√ºhrten eine operative Reaktion durch und die Angreifer konnten am Ende nicht weiter vorr√ºcken. <br><br>  Bis zum Ende des ersten Spieltages √§nderten sich die Methoden nicht, WAF schlug immer noch alle Versuche ab, etwas Interessantes auf die Websites des Unternehmens hochzuladen, und dieselben ‚Äûexternen Adressen‚Äú versuchten ohne Unterlass, unsere Ressourcen zu scannen. <br><br><img src="https://habrastorage.org/webt/k4/h2/je/k4h2jeeackujcdpdfydy2ci7i7s.png"><br><br>  Insgesamt wurden f√ºr das gesamte Ereignis 3000 Vorf√§lle im Zusammenhang mit Scanversuchen aufgezeichnet, ohne die Gruppierung von Ereignissen in Vorf√§llen zu ber√ºcksichtigen. <br><br><img src="https://habrastorage.org/webt/eo/c0/j-/eoc0j-v5ohyz-kbja5goxy9vzsi.png"><br><br>  Und ungef√§hr 2500 Vorf√§lle mit Versuchen, WAF zu umgehen, auch ohne die Gruppierung von Ereignissen in Vorf√§llen zu ber√ºcksichtigen. <br><br>  Gegen Abend nahm die Intensit√§t aller Aktivit√§ten ab - daf√ºr gab es mehrere Gr√ºnde.  Ein Teil der Verteidiger und Angreifer konnte dem Soundcheck und der Probe des Konzerts, das am n√§chsten Tag stattfinden sollte, nicht widerstehen.  Einige angreifende Teams beschlossen, eine Pause einzulegen und die Angriffe gegen Ende des Vormittags fortzusetzen, in der Hoffnung, dass die Verteidiger und die √úberwachung weniger √úberwachungsressourcen und etwas M√ºdigkeit haben w√ºrden. <br><br>  Am Morgen des zweiten Tages √§nderten die Angreifer ihre Taktik.  Informationen √ºber einen Teil seiner Mitarbeiter wurden auf einer der Websites des Unternehmens ver√∂ffentlicht.  Hacker nutzten diese Informationen und sammelten aktiv Benutzerkonten √ºber Exchange (Statistik der Versuche im Screenshot). <br><br><img src="https://habrastorage.org/webt/ud/pp/z0/udppz0drbdk_woprerkpwz3xgos.png"><br><br>  Wenig sp√§ter wurden unsichere Versuche unternommen, ein Passwort auf dem VPN-Gateway auszuw√§hlen. Konten, die sich nicht in unserer Infrastruktur befanden, nahmen am Brute teil.  Mit hoher Wahrscheinlichkeit versuchten die Angreifer, Konten aus der bereits gehackten Infrastruktur zu verwenden, in der Hoffnung, dass die Organisatoren sie √ºberall gleich lie√üen.  Infolgedessen hat uns die gesamte Situation mit brutaler Gewalt dazu veranlasst, eine Gruppe von Dashboards zu Trends in Bezug auf die Benutzerauthentifizierung zu erstellen.  Au√üerdem haben wir die √úberwachung von Vorf√§llen im Zusammenhang mit erfolgreicher Brute Force versch√§rft, aber gl√ºcklicherweise wurden solche F√§lle nicht festgestellt. <br><br>  Ungef√§hr eine Stunde vor dem Ende des Spiels erlebten die Trends einzelne erfolgreiche Versuche, mehrere Benutzer zu authentifizieren, einschlie√ülich derer in Exchange. Die Betriebsanalyse ergab, dass die Quellen direkt Benutzercomputer waren. Die meisten Ereignisse zeigten, dass sich die Organisatoren √ºber die VMware-Konsole angemeldet hatten Vcenter. <br><br>  Gleichzeitig haben wir einen internen Scan von einem Knoten aufgezeichnet, der erfolgreich eine Verbindung √ºber VPN hergestellt hat.  Nach einer operativen Analyse der Ereignisse im Zusammenhang mit dem Vorfall wurde klar, dass die Angreifer die Anmeldeinformationen mehrerer Benutzer gef√§hrden konnten. Aufgrund des Fehlens erfolgloser Authentifizierungsversuche ist es wahrscheinlich, dass die Benutzerdaten ‚Äûdurchgesickert‚Äú sind. <br><br>  Informationen wurden an die Verteidiger weitergegeben.  W√§hrend der gesamten Reaktionszeit auf den PCs gef√§hrdeter Benutzer wurde die Endpunktl√∂sung in einen vorbeugenden Schutzmodus versetzt, um die F√§higkeit zu verlangsamen, im System Fu√ü zu fassen.  Angriffssitzungen auf dem VPN-Gateway wurden gewaltsam abgebrochen und die Angreifer aus dem gesch√ºtzten Bereich geworfen.  In kompromittierten UZ wurden Passw√∂rter sofort ge√§ndert. <br><br>  In diesem Moment betraten die Jungs vom True0xA3-Team die B√ºhne und nutzten OSINT erfolgreich und berichteten √ºber den Kompromiss des Behealthy-B√ºros, das unter dem Schutz eines anderen Teams steht.  Angreifer konnten den Dom√§nenadministrator gef√§hrden.  Die Organisatoren wurden √ºber unseren Vorfall informiert und es wurden Beweise vorgelegt. <br><br>  Die letzte Stunde war aufgrund des pl√∂tzlichen OSINT besonders hei√ü, alle warteten auf weitere Vorbereitungen der Organisatoren.  Das √úberwachungsteam wiederum √ºberwachte alle verd√§chtigen Anomalien und Vorf√§lle, aber nach einem erfolglosen Versuch, in neue Hacking-Versuche einzudringen, folgte dies nicht.  Die letzten Minuten der Spielzeit vergingen, und das erfolgreiche Hacken des vom Jet Security Team gesch√ºtzten B√ºros fand nicht statt. <br><br>  Und eine kleine abschlie√üende Statistik f√ºr zwei Spieltage: <br><br><ul><li>  Durchschnittlich 1200 EPS und in der Spitze etwas weniger als 3000 EPS; </li><li>  √úber 7000 Vorf√§lle; </li><li>  √úber 120 Millionen Veranstaltungen. </li></ul><br><br><h3>  Faktoren, die uns geholfen haben zu gewinnen </h3><br><ul><li>  Kompetente Rollenverteilung.  Jeder hat das meiste, was er in allt√§glichen Projekten tut, eingerichtet und war damit besch√§ftigt.  Niemand musste Materialien aus der Kategorie "Firewall f√ºr Dummies" studieren. </li><li>  Operatives Profiling von Korrelationsregeln.  Alle Fehlalarme wurden verarbeitet und Korrekturen in Bezug auf die Funktionen der Spielinfrastruktur vorgenommen. </li><li>  Sofortige Antwort.  Aufgrund der Tatsache, dass jedem Typ von SZI und Systemen mehrere Personen zugeordnet waren, hatten wir keine Probleme damit, dass sich die verantwortliche Person ausruhte oder nur ein paar Minuten wegging.  Alle Informationen aus der √úberwachung wurden so schnell wie m√∂glich verarbeitet. </li><li>  Erfahrung im H√§rten und √úberwachen verschiedener Infrastrukturen. </li></ul><br>  PS Besonderer Dank geht an alle, die gekommen sind und Fragen gestellt haben, und wir entschuldigen uns bei denen, die dabei nichts sagen konnten - das Team wartete auf ‚Äûmisshandelte Kosaken‚Äú der Angreifer und konnte nicht alle Details preisgeben. <br><br>  <i>Dmitry Lifanov, Experte im Zentrum f√ºr √úberwachung und Reaktion auf Informationssicherheitsvorf√§lle Jet CSIRT</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de454298/">https://habr.com/ru/post/de454298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de454284/index.html">Entschuldigung, ich werde nicht zur Arbeit kommen, weil es Winter ist</a></li>
<li><a href="../de454290/index.html">Prinzip der Einzelverantwortung. Nicht so einfach wie es sich anh√∂rt</a></li>
<li><a href="../de454292/index.html">JS. Proxy. Fallstricke zu wissen</a></li>
<li><a href="../de454294/index.html">"Ohne unn√∂tige Experimente" oder wie wir einen Bankbeschleuniger auf den Markt gebracht haben</a></li>
<li><a href="../de454296/index.html">Wie eine Schule in Puerto Rico mit Minecraft Chemie zum Leben erweckt: Education Edition</a></li>
<li><a href="../de454300/index.html">Wie unterscheiden sich CTTs von herk√∂mmlichen Heatpipes und wie werden sie angewendet?</a></li>
<li><a href="../de454302/index.html">QVD-Dateien - was drin ist</a></li>
<li><a href="../de454304/index.html">DIY 3D-Drucker f√ºr Keramik zum Selbermachen</a></li>
<li><a href="../de454306/index.html">F√ºnf Fehler, die ich als Hauptentwickler gemacht habe</a></li>
<li><a href="../de454308/index.html">AMA mit Habr. V.9.0. Podcast, Konferenz und Konzepte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>