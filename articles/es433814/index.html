<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§±üèº üíî üë©üèø‚ÄçüöÄ C√≥mo escalar bases de datos en Yandex. Cloud sin tiempo de inactividad. Tres ejemplos de host ‚õπüèø üéÖüèø üñ®Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La publicaci√≥n fue preparada por Yandex. Miembros del equipo de Cloud: Ivan Vetkasov - arquitecto, Leonid Klyuyev - editor 


 Recientemente, hablamos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo escalar bases de datos en Yandex. Cloud sin tiempo de inactividad. Tres ejemplos de host</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/433814/"><h5>  <sub><sup><i>La publicaci√≥n fue preparada por Yandex. Miembros del equipo de Cloud: Ivan Vetkasov - arquitecto, Leonid Klyuyev - editor</i></sup></sub> </h5><br><p><img src="https://habrastorage.org/webt/2e/4l/kn/2e4lkn7th9ia7axxyt1gjbb32qg.png" align="right" width="400">  Recientemente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hablamos</a> sobre la arquitectura de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yandex.Cloud</a> .  Ahora pasemos de la teor√≠a a la pr√°ctica.  Existen varios servicios en la nube para el control automatizado de DBMS: Servicio administrado para ClickHouse, Servicio administrado para PostgreSQL y Servicio administrado para MongoDB.  Todos ellos est√°n basados ‚Äã‚Äãen la plataforma y le permiten centrarse en la tarea de almacenamiento de datos y no en la administraci√≥n de la infraestructura.  Pero a veces tambi√©n es importante controlar las m√°quinas virtuales del cl√∫ster.  Por ejemplo, puede surgir una tarea de escalado en respuesta a un aumento o disminuci√≥n de la carga.  Por lo general, este escenario es uno de los que lleva m√°s tiempo desde un punto de vista pr√°ctico.  Hoy le diremos c√≥mo Yandex.Cloud le permite automatizar tareas de escalado complejas y asegurarse de que la base de datos permanezca disponible en el proceso de redimensionamiento del cl√∫ster. </p><br><p><a name="habracut"></a></p><h4>  Declaraci√≥n del problema. </h4><br>  Al crear un cl√∫ster de cada servicio, el usuario puede determinar el n√∫mero de hosts del cl√∫ster y la zona de disponibilidad (AZ), que corresponde al centro de datos f√≠sico.  Ahora Yandex.Cloud utiliza tres centros de datos Yandex ubicados en la regi√≥n central de Rusia.  Por lo tanto, la configuraci√≥n recomendada es el cl√∫ster DBMS con tres hosts, como el m√°s coherente con los principios de construcci√≥n de una arquitectura de failover y resistente a desastres. <br><br>  Entonces, imagine una situaci√≥n en la que la carga en el cl√∫ster DBMS excedi√≥ las capacidades de la base de datos y es hora de agregar recursos inform√°ticos.  Esto se puede hacer tanto horizontalmente, agregando hosts al cl√∫ster como verticalmente, agregando recursos a cada m√°quina del cl√∫ster.  Considere la segunda opci√≥n, como la que consume m√°s tiempo y corre el riesgo de errores.  ¬øPor qu√© es esta opci√≥n laboriosa?  Porque en el caso general, el procedimiento para agregar recursos se ver√° m√°s o menos as√≠: cambie la funci√≥n del host;  si es necesario, detenga el DBMS;  apague la m√°quina virtual;  cambiar su configuraci√≥n;  comenzamos  cambiar los par√°metros de DBMS;  comenzamos un DBMS;  Estamos esperando la sincronizaci√≥n de los cambios de datos acumulados.  Y as√≠, para los tres anfitriones a su vez.  Muchos pasos: el riesgo de errores es alto.  Puede automatizar este proceso; solo antes de iniciar la soluci√≥n de automatizaci√≥n seleccionada debe probarse.  Por lo general, no hay suficiente tiempo para las pruebas, pero en Yandex.Cloud se ejecuta r√°pidamente y sin acciones innecesarias de su parte.  Empecemos <br><br><h4>  Pasos preliminares y proceso de prueba </h4><br><p>  Para la preparaci√≥n necesitaremos: </p><br><ul><li>  Acceso a la plataforma.  Ahora cualquiera puede configurar un per√≠odo de prueba en el sitio web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el sitio web Yandex.Cloud</a> . </li><li>  Red en la nube (en mi ejemplo lo llamar√© testvpc) y tres subredes ubicadas en diferentes AZ.  Los rangos de direcciones de subred en este caso no son importantes. </li><li> Basti√≥n de acogida.  A pesar de que Yandex.Cloud puede abrir el acceso externo al DBMS a trav√©s de una IP p√∫blica, publicar un DBMS en el dominio p√∫blico no es la decisi√≥n correcta.  Por lo tanto, agregamos un host de basti√≥n al esquema, desde el cual abriremos conexiones a los hosts.  Como tal host, puede usar una m√°quina con uso parcial (5 por ciento) del n√∫cleo.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Clickhouse-client</a> debe estar instalado en la m√°quina virtual.  Adem√°s, de acuerdo con las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instrucciones para conectarse</a> al servicio, debe descargar un certificado SSL. </li><li>  CLI  Trabajaremos con Yandex.Cloud no a trav√©s de la consola, sino a trav√©s de la utilidad de l√≠nea de comandos, que tambi√©n debe instalarse e iniciarse de acuerdo con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> . </li></ul><br><p>  El escenario de prueba ser√° simple: abra tres sesiones conectando el host del basti√≥n a cada host del cl√∫ster de la base de datos, ejecute una consulta SQL en un ciclo con un per√≠odo de, digamos, 1 segundo, despu√©s del cual enviaremos un comando para escalar el cl√∫ster y observar el comportamiento del sistema. </p><br><h4>  Momento de la verdad </h4><br><p>  Elija un DBMS para demostrar la escala.  En PostgreSQL, a los hosts se les asignan roles, pero el servicio a√∫n no tiene su conmutaci√≥n transparente al escalar; esta funcionalidad est√° en nuestros planes.  Dado que el resto de la mec√°nica de aumentar y disminuir el cl√∫ster es aproximadamente el mismo en el caso de los tres DBMS, por ejemplo, tome ClickHouse. </p><br><p> Creemos un objeto de experimento: un cl√∫ster que consta de tres hosts ubicados en diferentes subredes virtuales.  Para hacer esto, ingrese el comando <br>  <code>yc managed-clickhouse cluster create</code> con los argumentos necesarios.  El orden de los argumentos coincide con su listado en la salida de "yc --help".  La esencia del comando es simple: creamos un cl√∫ster ch-to-redimensionar en un entorno de producci√≥n con testvpc ubicado en la red virtual, establecemos un nombre y contrase√±a, 10 gigabytes de espacio en disco y la clase m√≠nima s1.nano.  Las siguientes caracter√≠sticas corresponden a esta clase: 1 CPU, 4 GB de RAM.  En el futuro, para escalar, pasaremos a la clase s1.micro, de modo que se duplique el n√∫mero de CPU y RAM.  Para averiguar qu√© otras clases de host puede asignar, simplemente ingrese el comando <br>  <code>yc managed-clickhouse resource-preset list</code> . </p><br><p>  Por lo tanto, el comando para crear el cl√∫ster debe ser el siguiente: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster create --name ch-to-resize --environment production --network-name testvpc --host zone-id=ru-central1-a,subnet-id=e9bfnjacigdo9p6j7j2s,assign-public-ip=false,type=clickhouse --host zone-id=ru-central1-b,subnet-id=e2l8iamol3b9mrtskb8q,assign-public-ip=false,type=clickhouse --host zone-id=ru-central1-c,subnet-id=b0c6qit7u9e8r0egedvj,assign-public-ip=false,type=clickhouse --user name=test,password=test123123 --database name=testdb --clickhouse-disk-size 10 --clickhouse-resource-preset s1.nano --clickhouse-disk-type network-nvme ‚Äìasync</code> </pre> <br><p>  En respuesta, obtenemos el ID del cl√∫ster y una lista de nombres de host de sus hosts: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster list +----------------------+--------------+-----------------------------+--------+---------+ | ID | NAME | CREATED AT | HEALTH | STATUS | +----------------------+--------------+-----------------------------+--------+---------+ | c9q7cr4ji2fe462qej8p | ch-to-resize | 2018-12-10T08:59:09.100272Z | ALIVE | RUNNING | +----------------------+--------------+-----------------------------+--------+---------+ yc managed-clickhouse host list --cluster-id c9q7cr4ji2fe462qej8p +-------------------------------------------+----------------------+---------+---------------+ | NAME | CLUSTER ID | HEALTH | ZONE ID | +-------------------------------------------+----------------------+---------+---------------+ | rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-a | | rc1a-sgxazra54xv6lhni.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-a | | rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-b | | rc1b-j1rtvsuz6t8x6ev2.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-b | | rc1c-emo0f2990povj7ie.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-c | | rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-c | +-------------------------------------------+----------------------+---------+---------------+</code> </pre> <br><p>  Vamos a abrir una conexi√≥n a cada host y ejecutar una consulta a la base de datos: </p><br><pre> <code class="plaintext hljs">clickhouse-client --host rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive\!') from system.clusters where replica_num = 1" clickhouse-client --host rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive!') from system.clusters where replica_num = 2" clickhouse-client --host rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive\!') from system.clusters where replica_num = 3"</code> </pre> <br><p>  Finalmente, env√≠e una solicitud para aumentar el cl√∫ster: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster update --id c9q7cr4ji2fe462qej8p --clickhouse-resource-preset s1.micro -‚Äìasync</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Explicaci√≥n de reducci√≥n de racimo</b> <div class="spoiler_text"><p>  Si queremos reducir, en lugar de aumentar la cantidad de recursos, necesitamos especificar una clase m√°s peque√±a, en referencia a la salida <br>  <code>yc managed-clickhouse resource-preset list</code> , por ejemplo, s1.nano.  Al mismo tiempo, la estructura del equipo en s√≠ sigue siendo la misma. </p></div></div><br><p>  Redirig√≠ el resultado de la consulta a un archivo.  Aqu√≠ hay una lista abreviada: </p><br><pre> <code class="plaintext hljs">rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net Mon Dec 10 12:47:35 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:36 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:37 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:38 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:39 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:40 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:47:51 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:02 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:11 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:12 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:13 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:14 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:15 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:16 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:17 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:18 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:48:19 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:48:20 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net: Mon Dec 10 12:50:58 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:59 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:00 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:01 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:12 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:23 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:34 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:35 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:36 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:37 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:38 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:39 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:40 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:41 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:42 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:43 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:44 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:45 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:46 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net: Mon Dec 10 12:49:15 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:16 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:17 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:18 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:19 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:30 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:41 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:52 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:56 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:57 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:58 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:59 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:00 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:01 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:03 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:04 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:05 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:06 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:07 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive!</code> </pre> <br><p>  La lista muestra los momentos en que cada host del cl√∫ster se apaga (cuando comienza el tiempo de espera de conexi√≥n), los momentos en que se enciende el host y ClickHouse comienza a cargarse (cuando comienza la conexi√≥n rechazada), y tambi√©n los momentos en que el host vuelve a funcionar.  Lo m√°s importante es la separaci√≥n de los per√≠odos de tiempo cuando los hosts no estaban disponibles.  Mientras se escalaba, al menos dos hosts estaban disponibles para la ejecuci√≥n de consultas.  Esto se puede ver en el gr√°fico: </p><br><p><img src="https://habrastorage.org/webt/xg/u4/un/xgu4unmb8rsxd5sa2qhkr8ozy4s.png" alt="imagen"></p><br><h4>  Conclusiones y mejores pr√°cticas. </h4><br><p>  A primera vista, el desarrollo de proyectos con bases de datos incluye una gran cantidad de trabajo de rutina.  Es necesario mantener la base de datos, es decir, crear copias de seguridad, establecer el proceso de actualizaci√≥n peri√≥dica del DBMS, etc. Los servicios de administraci√≥n en la nube aparecieron principalmente para eliminar estas funciones que requieren mucho tiempo.  Sin embargo, en un entorno de producci√≥n real, es √∫til que los sistemas no solo sean manejables desde el punto de vista del servicio, sino que tambi√©n sean flexibles, en respuesta a las cargas en aumento y en descenso.  Hablamos sobre c√≥mo aumentar el rendimiento de la base de datos en Yandex.Cloud, manteniendo la capacidad de trabajo del proyecto para los usuarios.  Si la base de datos est√° configurada correctamente, con el aumento del tr√°fico hay un aumento en la cantidad de recursos disponibles y con una recesi√≥n, una disminuci√≥n m√∫ltiple, que tambi√©n reduce sus costos. </p><br><hr><br><p>  <em>¬øSobre qu√© enfoques, herramientas o tecnolog√≠as basadas en la nube le gustar√≠a aprender?</em>  <em>Sugiera temas en los comentarios para las siguientes publicaciones de Yandex.Cloud.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433814/">https://habr.com/ru/post/es433814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433802/index.html">C√≥mo y por qu√© ganamos la pista de Big Data en el Hackathon Urban Tech Challenge</a></li>
<li><a href="../es433804/index.html">Redes de densidad de mezclas</a></li>
<li><a href="../es433806/index.html">Cuando el archivo en l√≠nea se olvida</a></li>
<li><a href="../es433808/index.html">5 errores m√°s comunes que cometen los programadores en la entrevista</a></li>
<li><a href="../es433810/index.html">Un enfoque orientado a problemas para proyectos en marketing en Internet</a></li>
<li><a href="../es433816/index.html">D√≥nde publicar la aplicaci√≥n m√≥vil</a></li>
<li><a href="../es433818/index.html">Compilar y ejecutar C # y Blazor dentro de un navegador</a></li>
<li><a href="../es433820/index.html">Propuesta de ECMAScript: Array.prototype. {Flat, flatMap}</a></li>
<li><a href="../es433822/index.html">Gu√≠a completa de CMake. Tercera parte: pruebas y empaques</a></li>
<li><a href="../es433824/index.html">Habro suicidio. ¬øPor qu√© los programadores de 1C salvar√°n el mundo?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>