<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€âš•ï¸ ğŸƒ ğŸ¥Ÿ BISA atau tidak BISA? Atau mengapa saya membutuhkan jaringan mikrokontroler? ğŸ‘§ğŸ¿ ğŸ“  ğŸ¡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya harus bertanya pada diri sendiri pertanyaan ini sekitar sepuluh tahun yang lalu atau lebih. Pekerjaan yang harus dilakukan adalah memberikan kehi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BISA atau tidak BISA? Atau mengapa saya membutuhkan jaringan mikrokontroler?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455620/"><p>  Saya harus bertanya pada diri sendiri pertanyaan ini sekitar sepuluh tahun yang lalu atau lebih.  Pekerjaan yang harus dilakukan adalah memberikan kehidupan kedua ke ruang kontrol.  Ini adalah hal semacam itu di seluruh dinding, terdiri dari bola lampu dan sakelar dengan sakelar.  Saya pikir saya tidak akan salah berasumsi bahwa perisai telah dilakukan sejak munculnya bohlam, karena sakelar pada saat itu mungkin sudah diketahui.  Dan keinginan untuk kecantikan, secara umum, datang kepada orang-orang dari zaman kuno yang jauh. </p><br><p>  Sekarang banyak yang lebih suka tampilan panel daripada perisai.  Tetapi apakah akan ada mayoritas penggemar layar tergantung pada banyak hal yang tidak kita ketahui.  Tapi sekarang ini bukan tentang itu. </p><br><p>  Siapa pun yang dapat berbicara tentang kabel listrik selama lima menit akan segera memberi tahu saya bahwa perisai terdiri dari panel datar tempat sakelar dan bohlam ditempatkan, serta sebuah kotak dengan banyak kabel.  Bagaimanapun, bola lampu tanpa kabel hanya cocok untuk mematahkannya dengan bodoh atau, jika Anda muncul secara kreatif dan menghidupkan imajinasi Anda, letakkan di tempat paling ingin tahu di mulut Anda dan segera cari tahu di mana ruang gawat darurat. </p><a name="habracut"></a><br><p>  Itu saja, sekelompok kabel meninggalkan kotak ke sakelar dan lampu, hanya umbi yang kecil.  Rupanya, cucu dari bola lampu terkenal Ilyich. </p><br><p>  Dan sekarang, saya ingat, melihat keluar jendela, dan ada abad ke-21.  Oleh karena itu, perlu untuk melakukan semuanya secara baru dan dengan cara yang berbeda.  Alih-alih lampu - LED ekonomis.  Alih-alih kabel - kabel.  Alih-alih satu laci - banyak, banyak laci kecil, pengontrol, oleh karena itu. </p><br><p>  Ternyata jika setiap pengontrol dapat melayani empat LED dan dua sakelar, maka ini akan terlihat optimal.  Maksudku, tidak terlalu menakutkan.  Dan jika bus listrik dan bus informasi melewati semua pengendali, hanya ada empat kabel, maka rahmat tertentu akan muncul.  Ternyata pengendali akan membutuhkan 104 buah.  Dengan cara yang ramah, di sini akan perlu untuk berpose dan memecahkan masalah salesman keliling.  Dan kemudian, mungkin, pengendali akan menghabiskan lebih sedikit.  Tapi itu tidak baik. </p><br><p>  Pada saat itu saya sudah tahu apa itu CAN dan tingkat rasa hormat saya kepada Bosch jauh lebih tinggi daripada koki restoran yang layak atau ibu rumah tangga yang rapi.  Dan produsen mobil BMW, saya yakin, bahkan pergi mengunjungi insinyur Bosch. </p><br><p>  Jaringan Area Pengendali, seperti yang akan dikatakan orang asing, menurut saya, sebagai solusi teknis, muncul dari keinginan untuk melakukan sesuatu, akhirnya, dengan baik.  Saya tidak akan bersembunyi, Anda tidak akan merasakan semua pesona hasil karya insinyur segera ketika Anda menguasai dua volume standar, tetapi jauh kemudian.  Saat Anda berbicara dengan saksi mata, wawancarai saksi.  Sekarang ada lebih banyak volume, tetapi mungkin Anda dapat segera mulai dari yang ketiga, karena sekarang disebut CAN_FD.  Namun, biarkan saya melanjutkan. </p><br><p>  Bahkan sebelum tabrakan dengan perisai, saya harus menghadapi keputusan rekayasa orang lain tentang penggunaan CAN, serta membuat kesalahan saya.  Kesalahan biasanya muncul di antara instruksi membaca dan mempelajari deskripsi.  Nah, itu baru kedua kalinya mereka terlihat seperti menyapu. </p><br><p>  Sekarang beberapa ribu kata untuk pembaca, yang toleran terhadap kutu buku dan tidak menganggap mereka musuh. </p><br><p>  BISA dapat diinstal di mana RS485 sebelumnya bekerja pada kabel twisted pair.  Twisted pair bukanlah kondisi yang sangat diperlukan, cukup mudah untuk membandingkan.  Menggunakan kabel twisted pair, via CAN, serta melalui RS485, Anda dapat mengirim pesan dari pengontrol kontrol ke slave dan menerima respons.  Kesamaannya mencolok, tetapi mari kita lebih fokus pada perbedaan.  Beberapa perbedaan mungkin membawa tanda minus bagi sebagian pembaca.  Tetapi saya akan menyarankan mereka untuk tidak marah, tetapi untuk mengingat hukum Lomonosov. </p><br><p>  Berkat organisasi protokol yang sinkron, resolusi tabrakan pada bus diimplementasikan dalam perangkat keras, on the fly, sehingga untuk berbicara.  Di bawah ini dicatat apa yang menyebabkan dan apa yang membuat insinyur gelisah. </p><br><p>  Anda dapat menerima pesan tanpa permintaan. <br>  Tidak perlu menunggu sampai jawabannya siap, Anda dapat bertanya kepada orang lain saat ini. <br>  Kontroler budak juga dapat bertanya dan mendapatkan jawaban. <br>  Karena operasi sinkron, panjang bus CAN berbanding terbalik dengan kecepatan transmisi atau sesuatu seperti itu. <br>  Kecepatan maksimum adalah 1 MBaud (10 - dalam perjalanan). <br>  Pengirim tahu bahwa pesan belum terdistorsi selama transmisi segera setelah bit terakhir.  Lebih tepatnya, semua orang di bus tahu ini. <br>  Jika pesan terdistorsi untuk satu, upaya itu tidak dihitung oleh semua. <br>  Jika pesan dikirim ke bus, pelanggan tidak akan menerimanya hanya dengan syarat pesan itu rusak. <br>  Jumlah pengontrol di bus tidak boleh melebihi 127. </p><br><p>  Panjang pesan dibatasi.  Mereka terdiri dari pengidentifikasi, indikator panjang dalam byte dan blok data, dengan byte persis seperti yang ditunjukkan.  Ada beberapa bit layanan lagi, tetapi mari kita tetap diam tentang mereka, karena layanan harus tidak mengganggu.  Pengidentifikasi mungkin berukuran 11 atau 29 bit.  Blok data dapat berisi dari 0 hingga 8 byte (64 - dalam perjalanan). </p><br><p>  Untuk spesifiknya, saya akan berikan beberapa angka.  Jika Anda ingin bekerja pada kecepatan 1Mbaud, maka panjang bus tidak boleh lebih dari 35 meter (beberapa lebih suka 40, yaitu, lebih panas).  Jika Anda perlu mengirimkan sesuatu pada jarak 8 km, maka kecepatannya tidak boleh lebih dari 5 kbaud.  Ngomong-ngomong, pembaca berhak bertanya mengapa kilobod, dan bukan kilobit?  Karena tidak semua baud menjadi bit.  Sesuatu seperti itu. </p><br><p>  Bagaimana saya bisa membuang semua bahan rahasia ini?  Mereka yang melihat permainan dadu dalam segala hal akan segera ingat bahwa ada hal yang luar biasa seperti CANopen dan banyak lagi kombinasi dan singkatan yang indah dan tidak ada yang dapat menemukan kembali roda.  Jadi saya sering ingin menjawab: â€œBukankah telur goreng dari dua telur, yang banyak dimasak untuk sarapan sendiri, terlihat seperti sepeda?  Mengapa tidak pergi ke layanan makanan dan mengambil telur dadar? "  Tapi saya lebih baik diam dan melanjutkan tanpa terganggu oleh teriakan dari penonton. </p><br><p>  Pada masa itu, ketika pengidentifikasi 29 bit belum ditemukan, hanya ada 11 bit.  Beberapa mulai menggunakannya untuk menjejalkan nama (nomor) dari tipe data yang diinginkan di sana.  Lainnya digunakan sebagai alamat pengontrol yang sedang diakses.  Keduanya masuk akal.  Misalnya, Anda mungkin bertanya ini: </p><br><ul><li>  Dan beri kami, sayangku, sebuah chateau tahun ketiga belas dalam satu liter kemasan kertas. </li></ul><br><p>  Atau lebih: </p><br><ul><li><p>  Bungkus saya, tolong, apa yang tersembunyi di rak bawah Anda di sebelah kanan. <br>  Omong-omong, di CAN desain ini juga dapat berfungsi: </p><br></li><li><p>  Berbohong pada semua orang!  Dan Anda dengan cepat memasukkan semuanya dari rak ke dalam tas saya. <br>  Namun desain ini sering tidak digunakan, karena setelah Anda harus menunggu sebentar. <br>  Tunggu hingga semua jawaban diurutkan satu per satu dan tersedia untuk pengontrol yang meminta.  Kami sudah meninggalkan film, jika itu. <br>  Dalam kasus saya, saya akan senang dengan varian pengenal sebagai alamat.  Dari 11 bit, 7 diperlukan, dan 4 lebih tersisa untuk membuat beberapa pesan lebih mendesak daripada yang lain, serta menandai beberapa pengendali sebagai yang utama. <br>  Beberapa ketidaknyamanan bermigrasi di sini dari RS485, yaitu, alamat harus ditetapkan secara manual pada setiap pengontrol.  Kemudian periksa dan instal ulang.  Dan mungkin kembali ke langkah sebelumnya dan ulangi. <br>  Untungnya, pada saat itu dua keadaan sudah ada. </p><br></li></ul><br><p>  Pertama, pengenal 29-bit telah muncul.  Dan yang kedua adalah banyak produsen mikrokontroler mulai mempertimbangkan kondisi bahwa setiap chip memiliki nomor unik dan agak panjang sebagai bentuk yang baik. </p><br><p>  Sekarang, dalam pengidentifikasi panjang, 24 bit dapat dialokasikan dengan aman untuk alamat unik.  Lima lainnya tetap, untuk memastikan bahwa kereta berbeda dalam urgensi, arah (di sana, belakang), kehadiran mobil restoran dan mobil dengan peningkatan kenyamanan. </p><br><p>  Jika Anda berhenti bermain-main dan menjadi serius, hubungi agen pengendali bawahan, dan bos lainnya, maka Anda dapat membuat tabel.  Dia akan ditampilkan nanti. </p><br><p>  Sedikit lagi tentang pengalamatan.  Jumlah chip yang unik, sebagai suatu peraturan, menghabiskan sejumlah bit lebih dari 24, misalnya, 96 dengan STM32FXXX.  Oleh karena itu, Anda harus mendapatkan 24 dari 96. Saya memilih operasi XOR.  Anda dapat memilih sesuatu yang lain, tetapi sedikit masalah akan tetap ada.  Ini adalah kecocokan alamat setelah pengurangan. </p><br><p>  Kemungkinan masalah ini sangat kecil, tetapi memang begitu.  Ini bisa dipecahkan, tetapi menambah pekerjaan untuk installer.  Di sini harus diingat bahwa pesan CAN mungkin tidak mengandung data sama sekali.  Ini berguna bagi kita saat memutuskan.  Ini terdiri dari tindakan berikut. </p><br><p>  Pengendali pengendali (bos) mengirimkan permintaan siaran yang harus ditanggapi oleh semua agen (ini adalah permintaan dengan alamat nol).  Membalas pesan dengan nol panjang data dan alamat yang cocok tidak akan merusak satu sama lain, tetapi akan mencapai bos dalam bentuk satu. </p><br><p>  Sekarang tinggal menghitung berapa banyak jawaban yang telah diterima dan berapa banyak seharusnya.  Jika kedua angka ini bertepatan, maka semuanya beres.  Jika ada lebih sedikit jawaban daripada pengontrol, maka ada kebetulan alamat dan ada pekerjaan untuk pengatur.  Dan jika ada lebih banyak jawaban daripada pengontrol, maka Anda perlu memikirkan disertasi, karena Anda berada di ambang penemuan. </p><br><p>  Jika perubahan panjang pesan dianggap sebagai beberapa variasi maknanya, maka Anda bisa mendapatkan fitur tambahan, yang akan saya ceritakan nanti jika ibu saya tidak menelepon untuk makan. </p><br><p>  Hal lain yang menarik adalah bahwa jika Anda menggunakan pengidentifikasi pendek dan panjang pada saat yang sama, Anda bisa mendapatkan, misalnya, mengatasi permintaan grup atau menyiarkan sebagian.  Tapi kita belum akan mendalaminya. </p><br><p>  Mari kita kembali ke pengkodean pengenal. </p><br><p>  Untuk keperluan pengalamatan, 24 bit dialokasikan dalam pengenal yang diperluas, dan enam dalam pengidentifikasi standar.  Alamat dengan nilai 0x000000 disiarkan untuk pengenal yang diperluas.  Untuk pengidentifikasi standar, alamat null (6 bit) juga dianggap disiarkan.  Lima bit terkemuka (tinggi) dalam pengidentifikasi panjang dan pendek disebut header, memengaruhi makna pesan dan dilambangkan dengan huruf NVADR: </p><br><p><img src="https://habrastorage.org/webt/5a/ir/yt/5airytjd4ojg3bn15xhoh9qo5jw.jpeg"></p><br><p>  Tentu saja, untuk panel kontrol, perlu untuk mengimplementasikan hanya sebagian dari skema ini.  Dalam proyek pertama dengan perisai (atau pada perisai, bagaimana?) Chip Cortex dari NXP digunakan, dan dalam proyek-proyek berikut (ada beberapa) M0 dari STMicroelectronics sudah digunakan. </p><br><p>  Beberapa kata tentang penggunaan pengidentifikasi pendek.  Keenam bit yang dialokasikan untuk mengatasi tidak mengatasi controller, tetapi grup.  Pada awalnya, grup ini memiliki nol untuk semua orang.  Selanjutnya, agen dikonfigurasikan, setelah itu beberapa atau semua dari mereka menjadi anggota kelompok mereka.  Sekarang permintaan ke grup, kami mendapat tanggapan dari agen yang telah kami kumpulkan di grup ini. </p><br><p>  Sekarang, sedikit tentang apa yang ditambahkan jika Anda menafsirkan pesan dengan panjang data yang berbeda secara berbeda.  Sebagai contoh, permintaan panjang nol sangat membantu ketika men-debug, seperti yang disebutkan di atas.  Permintaan dengan panjang 3 melayani ruang variabel 16384 byte. Permintaan dengan panjang 4 melakukan hal yang sama, tetapi ditujukan untuk agen gateway yang melayani bus CAN tingkat kedua.  Bus ini dapat terdiri dari satu atau dua agen, tetapi beberapa kilometer jauhnya. </p><br><p>  Kueri dengan panjang 5 dan 6, juga dimaksudkan untuk ruang variabel dua-byte berukuran 4194304. Dua bit tidak digunakan untuk pengalamatan.  Satu bit mengontrol baca-tulis.  Lainnya menandakan kesalahan. </p><br><p>  Selanjutnya, 7 dan 8 melayani kata empat byte.  Ada juga 4.194.304. </p><br><p>  Ruang-ruang ini umum untuk semua agen.  Masing-masing, tergantung pada tujuannya, hanya menggunakan segmen ruang variabel.  Pengontrol untuk mengukur suhu pada dua titik ditunjukkan pada foto.  Ini untuk debugging dan pengujian. </p><br><p><img src="https://habrastorage.org/webt/eq/tc/8z/eqtc8z-q-gmhha4cyzqqceqdtjc.jpeg"></p><br><p>  Kontroler dihubungkan dengan kabel datar untuk 6 core.  Ganda digunakan untuk makanan.  Chip dua puluh kaki adalah STM32F042. </p><br><p>  Di sisi sebaliknya adalah MAX3051, driver CAN dalam paket SOT23-8. <br>  Nah, panggilan ibu untuk makan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id455620/">https://habr.com/ru/post/id455620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id455610/index.html">Intel Core i7-2600K Legendaris: menguji Sandy Bridge pada 2019 (bagian 1)</a></li>
<li><a href="../id455612/index.html">Kami memikirkan karakter permainan dan dialog berdasarkan saran dari penulis dan pada contoh pendukung teori Bumi yang datar</a></li>
<li><a href="../id455614/index.html">FFI: menulis di Rust dalam program PHP</a></li>
<li><a href="../id455616/index.html">Mengapa pergi ke "Pemrograman Industri" di HSE St. Petersburg?</a></li>
<li><a href="../id455618/index.html">DevOps LEGO: bagaimana kami meletakkan pipa di atas kubus</a></li>
<li><a href="../id455622/index.html">Intel Core i7-2600K yang legendaris: menguji Sandy Bridge pada 2019 (bagian 2)</a></li>
<li><a href="../id455624/index.html">Korban hiper dan apa yang bisa dipelajari oleh perancang permainan dari mereka</a></li>
<li><a href="../id455626/index.html">Wallarm Offzone2019 HackQuest</a></li>
<li><a href="../id455630/index.html">Acara digital di Moskow dari 11 hingga 16 Juni</a></li>
<li><a href="../id455632/index.html">Perhatian! Bug berbahaya dalam implementasi C ++ std :: map :: merge dan std :: set :: merge di Visual Studio 2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>