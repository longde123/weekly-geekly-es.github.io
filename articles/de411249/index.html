<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚§µÔ∏è ü§öüèª üëΩ Wie ich meinen Yandex.Transport mit Fahrpl√§nen und Bussen gemacht habe üîç üñ®Ô∏è üöº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gepostet von Mikhail Aksenov, .NET-Entwickler, DataArt 



- Website des Vrnbus-Projekts (Voronezh Buses); 
- Telegrammbot: @vrnbusbot ; 
- Github- Pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich meinen Yandex.Transport mit Fahrpl√§nen und Bussen gemacht habe</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/411249/"><img src="https://habrastorage.org/webt/a0/8u/mi/a08umi6_8yn4eobkvs63zv_s9tq.jpeg"><br><br>  <i>Gepostet von Mikhail Aksenov, .NET-Entwickler, DataArt</i> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Website des Vrnbus-Projekts</a> (Voronezh Buses); </li><li>  Telegrammbot: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@vrnbusbot</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github-</a> Projekt: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vrntrans / vrnbus</a> . </li></ul><br><h2>  Wie alles begann </h2><br>  Im Herbst 2014 gab es gute Nachrichten, dass Yandex.Transport in Woronesch gestartet wurde, was die Bewegung von Bussen und Oberleitungsbussen zeigt.  Es war sehr cool, direkt an der Bushaltestelle einen Fahrplan zu √∂ffnen und herauszufinden, dass Ihr Bus in 5 Minuten funktioniert. <br><br>  Aber nach ein paar Monaten verlief alles nach einem v√∂llig vorhersehbaren Szenario.  Da der gesamte Transport in Woronesch vom Wagen zum Kleinbus in bar erfolgt, ist jeder Fahrer daran interessiert, so viele Passagiere wie m√∂glich zu transportieren.  Infolgedessen organisieren sie Rennen untereinander. <br><br>  Die Fahrer nutzten den neuen Service, um einander auf der Karte zu folgen und die Konkurrenten auf der Stra√üe zu √ºberholen und zu schneiden.  Einige begannen, ihre Einnahmen zu senken, sie begannen sich bei den Eigent√ºmern der Strecken zu beschweren, und sie gingen zu Leuten, die Ger√§te mit GLONASS und GPS verkauften und Daten √ºber die Bewegungen von Autos an Yandex schickten.  Auf Wunsch der Flottenbesitzer h√∂rten sie auf, Informationen zu senden, und die Busse verschwanden sofort von der Karte.  Jetzt gibt es ein bisschen mehr davon, aber das ist immer noch viel weniger als in der Realit√§t. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/hy/2p/d9/hy2pd9kotq6w2jrb__n5gm8nzx0.jpeg"><br><br>  F√ºr diejenigen, die zu faul sind, um weiterzulesen, schlage ich einen Videobericht zu diesem Thema vor: <iframe width="560" height="315" src="https://www.youtube.com/embed/1OtHwGqSL04" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Im √úbrigen werde ich das Projekt in Form eines Textes beschreiben. <br><br><h2>  Woher bekommen Sie die Daten? </h2><br>  Gleichzeitig gibt es in Woronesch einen Ort, an dem alle Daten gesammelt werden - das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zentrum f√ºr die Organisation des Stra√üenverkehrs</a> (DPC).  Sie haben eine gro√üe und umfangreiche Webanwendung auf ihrer Website mit nicht nachhaltigem JavaScript und anderen Artefakten, w√§hrend alles darin POST-Anforderungen enth√§lt und nichts zwischengespeichert wird.  √úber diese Website selbst k√∂nnen Sie ganz einfach einen Dienst einrichten, der Daten √ºber die Bewegung von Bussen sammelt. <br><br>  Es gab eine Option, mit der Sie auf der Karte st√∂bern und herausfinden k√∂nnen, wann der Bus kommt und was er sein wird.  Vorausgesetzt, Sie kommen ungef√§hr zum Stillstand (¬± 50 Meter).  Im Men√º konnten Sie eine Liste von Routen √∂ffnen und genau sehen, wohin die Busse fahren, aber es gab ein Problem - sie fuhren seltsam.  Entlang der Koltsovskaya, einer Stra√üe in der Mitte, in der Sie nicht besonders schnell fahren k√∂nnen, fuhr der Bus beispielsweise mit einer Geschwindigkeit von etwa 200 km / h vorw√§rts und r√ºckw√§rts. <br><br><br><h2>  Warum Python? </h2><br>  Ich habe Python gew√§hlt, weil es cool ist, die Batterien geb√ºndelt sind und so weiter. Und 3.6, weil es Formatierungen f√ºr String-Literale gibt, tippen, das ist alles.  Schauen wir uns an, was ich im Grunde genommen verwendet habe: <br><br><ul><li>  Viele beklagten sich dar√ºber, dass es sehr schwierig sei, den genauen Namen eines Stopps mit allen m√∂glichen Satzzeichen zu fahren.  Dann erkannte ich die M√∂glichkeit der Fuzzy-Suche und erstellte den ersten Unit-Test daf√ºr. </li><li>  Das gesamte System wird auf Heroku gehostet.  Es ist kostenlos, da ich keine Datenbank habe. Ich hoffe, dass ich mit der Datenbank des Rechenzentrums zurechtkomme.  Ich stimmte der Verwendung mit dem Center zu, als mir klar wurde, dass die Daten, die ich √ºber die Weboberfl√§che sammle, nicht ausreichen. </li><li>  Das Hosting erfolgt √ºber den Tornado-Webserver.  Ich denke, es ist jedem bekannt, der in Python auf Webanfragen gesto√üen ist. </li><li>  Ich brauchte das Pytz-Paket, weil sich der Heroku-Server in einer anderen Zeitzone befindet und die Daten ohne Angabe einer Zeitzone zu mir kommen.  Deshalb habe ich mich selbst um die Lokalisierung gek√ºmmert. </li><li>  Um den Bot zu erstellen, habe ich die empfohlene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-Telegramm-Bot-</a> Bibliothek verwendet.  Die Dokumentation hier ist v√∂llig ausreichend, und im Allgemeinen erf√ºllt die Bibliothek die Mindestanforderungen an tragf√§hige Produkte.  Anf√§nglich war das gesamte Projekt ein Telegramm-Bot, der als Antwort auf das Senden Ihres Standorts einen Busfahrplan sendete. </li><li>  Firebird, eine ehemalige Interbase, ist eine Open-Source-Datenbank, mit der viele von Ihnen gearbeitet haben.  Nat√ºrlich ist es nicht so cool wie das gleiche PostgreSQL, aber f√ºr eine sehr gro√üe Anzahl von Abfragen reicht es aus.  In unserem Fall wird nicht mehr ben√∂tigt. </li><li>  Cachetools ist ein sehr einfaches Modul, mit dem Sie Berechnungen zwischenspeichern k√∂nnen.  Hier geht es nat√ºrlich nicht um das Zwischenspeichern oder Zwischenspeichern von Webseiten, sondern um F√§lle, in denen Sie sich f√ºr lange Abfragen ein Memo merken m√ºssen.  Nehmen Sie es einfach, f√ºgen Sie den entsprechenden Dekorateur hinzu - und alles funktioniert.  Der Cache hat verschiedene Optionen, ich verwende die TTL-Version, die Daten f√ºr die angegebene Zeit speichert, da ich wei√ü, dass die Daten nicht √∂fter als in bestimmten Intervallen (in meinem Fall - 30 Sekunden) aktualisiert werden. </li></ul><br><br><h2>  Bot-Funktionalit√§t </h2><br><ul><li>  / Name der n√§chsten Bushaltestelle - voraussichtliche Ankunftszeit; </li><li>  / letzte durch Leerzeichen getrennte Routennummern - letzte Haltestellen; </li><li>  Standort senden - die erwartete Ankunftszeit f√ºr die n√§chsten drei Haltestellen; </li><li>  Freier Eintritt - Routennummern und Entfernung zu Bussen (beim Senden des Standorts). </li></ul><br><br>  Ich habe versucht, die Befehle vollst√§ndig genug zu beschreiben, damit die Leute nicht fragen, wie sie verwendet werden sollen.  Grunds√§tzlich gibt es zwei grundlegende Befehle: nextbus, wenn Sie den Namen der Haltestelle schreiben und den Standort senden. <br><br><h2>  Site-Funktionalit√§t </h2><br>  Ich habe die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Website</a> so minimalistisch wie m√∂glich gestaltet.  Von den Bibliotheken von Drittanbietern habe ich nur zwei verwendet, um das Abrufen und Versprechen zu unterst√ºtzen, da √§ltere Versionen der vorinstallierten Browser in Telefonen nicht ohne sie auskommen k√∂nnen.  Wenn Sie diese Methoden nicht unterst√ºtzen, erhalten Sie ziemlich viele R√ºckrufnudeln f√ºr die Anforderungen selbst.  Mit Fetch sieht alles eleganter aus. <br><br><img src="https://habrastorage.org/webt/vn/sd/gu/vnsdgutglxminl8j6wi07w4nkp0.jpeg"><br><br>  Eigentlich besteht die Funktion hier aus 4 Punkten: <br><br><ol><li>  <b>Ankunft</b>  Sie k√∂nnen nur die Haltestelle beobachten.  Wenn Sie auf die Schaltfl√§che klicken (es k√∂nnte sich √ºbrigens lohnen, mehr zu tun - ich werde dar√ºber nachdenken!), Senden Sie Ihren Standort, das System sucht nach den drei Haltestellen in Ihrer N√§he und zeigt Informationen dazu an.  Sie k√∂nnen den Namen der Haltestelle eingeben und Informationen dazu abrufen.  Da Sie kaum alle 20-30 Busse ben√∂tigen, die an der Bushaltestelle ankommen k√∂nnen, k√∂nnen Sie sie nach Route filtern. </li><li>  <b>Busse</b>  Die zweite Seite enth√§lt Informationen zu Bussen.  Dies ist auf eine andere Geschichte zur√ºckzuf√ºhren, die mich zu diesem Projekt gef√ºhrt hat.  Eines sch√∂nen Tages verga√ü ich den Hut im Bus, rief den Kontrollraum an und erkl√§rte, wo es passiert war.  Der Dispatcher schlug vor, dass ich meinen Bus in der Mitte nehme, wo er zur√ºckkehren und sich am Terminal umdrehen werde.  Ich erinnerte mich, dass ich ein Login und ein Passwort vom Center for Traffic Management-System habe, aber es stellte sich heraus, dass ich den Standort des ben√∂tigten Autos √ºber die Weboberfl√§che immer noch nicht verfolgen kann.  Ich gab den Hut zur√ºck, aber mit gro√üen Schwierigkeiten. <br>  Ich dachte, einen Bus zu finden k√∂nnte viel einfacher sein.  Ich habe die Routennummer geschrieben und das System zeigt Ihnen die Autos auf der Linie, ihren aktuellen Standort und die Zeit, zu der sie vorbeifuhren.  Und selbst wenn Sie die Routennummer kennen, aber die Busnummer kennen (dies passiert auch), k√∂nnen Sie sie trotzdem finden. </li><li>  <b>Karte.</b>  Karte auf der Website ohne Animation.  Hier k√∂nnen Sie Busse aus der Liste ausw√§hlen oder Nummern manuell eingeben, Sie k√∂nnen sie filtern.  Auf der Karte k√∂nnen bis zu 600 Busse angezeigt werden, obwohl es nach 20 schwierig wird, etwas in der Mitte zu finden, einfach weil die Routen alle hier konzentriert sind.  Daher ist es besser, die Suche auf strengere Parameter zu beschr√§nken. </li><li>  <b>√úber das Projekt.</b>  Jetzt hat das Projekt eine Website, es gibt einen Telegramm-Bot, Gruppen in sozialen Netzwerken. </li></ol><br><br>  ***. <br>  Gl√ºcklicherweise ist Python eine Sprache mit sofort einsatzbereiten Batterien.  F√ºr einfache Dinge m√ºssen Sie nicht einmal etwas herunterladen. Lesen Sie einfach die Dokumentation sorgf√§ltig durch. <br><br>  Nat√ºrlich k√∂nnen solche Dienstleistungen auch f√ºr andere St√§dte erbracht werden, in einigen funktionieren sie bereits.  Viel h√§ngt vom lokalen Rechenzentrum ab, an einigen Orten, zum Beispiel in St. Petersburg, gibt es sogar eine API f√ºr Entwickler.  Aber das Wichtigste sind die Stadtbewohner, die ihre Stadt zum Besseren ver√§ndern wollen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de411249/">https://habr.com/ru/post/de411249/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de411239/index.html">DIY-Kreativit√§t von Kindheit an: Liebe zu hausgemachten Produkten</a></li>
<li><a href="../de411241/index.html">"Kepler" entdeckte eine seltsame Supernova: schnell Feuer gefangen, schnell ausgegangen</a></li>
<li><a href="../de411243/index.html">Abfall - zum Ofen</a></li>
<li><a href="../de411245/index.html">Zeigen wir uns dem Universum: den Leuchtt√ºrmen, die nach unserer Zivilisation erhalten bleiben</a></li>
<li><a href="../de411247/index.html">Die ‚Äûkl√ºgsten‚Äú Kinder schauen sich VTech Kidizoom an. Wie die Dinge wirklich sind</a></li>
<li><a href="../de411251/index.html">Benutzer senden Chrome-Scandateien auf dem lokalen Laufwerk erneut</a></li>
<li><a href="../de411253/index.html">Die Verschmelzung von Neutronensternen setzte den Alternativen von Dunkler Materie und Dunkler Energie ein Ende</a></li>
<li><a href="../de411255/index.html">Dezentrale Apps f√ºr Millionen von Benutzern auf Ethereum</a></li>
<li><a href="../de411257/index.html">In den USA schaffen sie ein Lasersystem, das den Feind mit Ger√§uschen erschreckt</a></li>
<li><a href="../de411259/index.html">Wir verbinden einen Wasserz√§hler mit einem Smart Home</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>