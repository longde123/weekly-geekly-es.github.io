<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥ üë®üèΩ‚Äç‚öñÔ∏è üèÇüèª Cuando "Zo√´"! == "Zo√´", o por qu√© necesita normalizar cadenas Unicode ü§µüèæ üè∑Ô∏è üàµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬øHas o√≠do hablar de la normalizaci√≥n Unicode? No estas solo Pero todos necesitan saber sobre esto. La normalizaci√≥n puede ahorrarle muchos problemas. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cuando "Zo√´"! == "Zo√´", o por qu√© necesita normalizar cadenas Unicode</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/445274/">  ¬øHas o√≠do hablar de la normalizaci√≥n Unicode?  No estas solo  Pero todos necesitan saber sobre esto.  La normalizaci√≥n puede ahorrarle muchos problemas.  Tarde o temprano, algo similar al que se muestra en la siguiente figura sucede con cualquier desarrollador. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aed/667/54c/aed66754c254c8eb6c077d2a418f1db6.png"></div>  <i><font color="#999999">Zo√´ no es Zo√´</font></i> <br><a name="habracut"></a><br>  Y esto, por cierto, no es un ejemplo de otro JavaScript <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">extra√±o</a> .  El autor del material, cuya traducci√≥n publicamos hoy, dice que puede mostrar c√≥mo se manifiesta el mismo problema al usar casi todos los lenguajes de programaci√≥n existentes.  En particular, estamos hablando de Python, Go e incluso scripts de shell.  ¬øC√≥mo lidiar con eso? <br><br><h2>  <font color="#3AC1EF">Antecedentes</font> </h2><br>  Me encontr√© con el problema de Unicode hace muchos a√±os cuando escrib√≠ una aplicaci√≥n (en Objective-C) que importaba una lista de contactos de la libreta de direcciones del usuario y de sus redes sociales, despu√©s de lo cual elimin√© los duplicados.  En ciertas situaciones, result√≥ que algunas personas est√°n en la lista dos veces.  Esto sucedi√≥ debido al hecho de que sus nombres, seg√∫n el programa, no eran la misma cadena. <br><br>  Aunque en el ejemplo anterior las dos l√≠neas se ven exactamente iguales, la forma en que se presentan en el sistema, los bytes en los que se almacenan en el disco difieren.  En el primer nombre, <code>"Zo√´"</code> el car√°cter √´ (e con di√©resis) representa un √∫nico punto de c√≥digo Unicode.  En el segundo caso, estamos tratando con la descomposici√≥n, con el enfoque de representar caracteres usando varios caracteres.  Si, en su aplicaci√≥n, trabaja con cadenas Unicode, debe tener en cuenta el hecho de que los mismos caracteres se pueden representar de diferentes maneras. <br><br><h2>  <font color="#3AC1EF">C√≥mo llegamos a los emoji: en pocas palabras sobre la codificaci√≥n de caracteres</font> </h2><br>  Las computadoras funcionan con bytes, que son solo n√∫meros.  Para poder procesar textos en computadoras, las personas acordaron la correspondencia de caracteres y n√∫meros, y llegaron a acuerdos sobre c√≥mo deber√≠a verse la representaci√≥n visual de los caracteres. <br><br>  El primer acuerdo de este tipo estuvo representado por la codificaci√≥n ASCII (C√≥digo Est√°ndar Americano para el Intercambio de Informaci√≥n).  Esta codificaci√≥n utilizaba 7 bits y pod√≠a representar 128 caracteres, que inclu√≠an el alfabeto latino (letras may√∫sculas y min√∫sculas), n√∫meros y signos de puntuaci√≥n b√°sicos.  ASCII tambi√©n incluy√≥ muchos caracteres "no imprimibles", como un avance de l√≠nea, pesta√±as, retornos de carro y otros.  Por ejemplo, en ASCII, la letra latina M (m may√∫scula) est√° codificada como 77 (4D en notaci√≥n hexadecimal). <br><br>  El problema con ASCII es que, aunque 128 caracteres pueden ser suficientes para representar todos los caracteres que suelen usar las personas que usan textos en ingl√©s, este n√∫mero de caracteres no es suficiente para representar textos en otros idiomas y varios caracteres especiales como emojis. <br><br>  La soluci√≥n a este problema fue la adopci√≥n del est√°ndar Unicode, que apuntaba a la posibilidad de representar cada car√°cter utilizado en todos los textos modernos y antiguos, incluidos caracteres como emojis.  Por ejemplo, en el est√°ndar Unicode 12.0 m√°s reciente, hay m√°s de 137,000 caracteres. <br><br>  El est√°ndar Unicode se puede implementar utilizando una variedad de m√©todos de codificaci√≥n de caracteres.  Los m√°s comunes son UTF-8 y UTF-16.  Cabe se√±alar que en el espacio web el m√°s com√∫n es el est√°ndar para codificar textos UTF-8. <br><br>  El est√°ndar UTF-8 usa de 1 a 4 bytes para representar caracteres.  UTF-8 es un superconjunto de ASCII, por lo que sus primeros 128 caracteres coinciden con los caracteres representados en la tabla de c√≥digos ASCII.  El est√°ndar UTF-16, por otro lado, usa de 2 a 4 bytes para representar 1 car√°cter. <br><br>  ¬øPor qu√© hay ambos est√°ndares?  El hecho es que los textos en idiomas occidentales generalmente se codifican de manera m√°s eficiente utilizando el est√°ndar UTF-8 (ya que la mayor√≠a de los caracteres en dichos textos se pueden representar como c√≥digos de 1 byte).  Si hablamos de idiomas orientales, entonces podemos decir que los archivos que almacenan textos escritos en estos idiomas generalmente obtienen menos cuando se usa UTF-16. <br><br><h2>  <font color="#3AC1EF">Puntos de c√≥digo Unicode y codificaci√≥n de caracteres</font> </h2><br>  A cada car√°cter en el est√°ndar Unicode se le asigna un n√∫mero de identificaci√≥n llamado punto de c√≥digo.  Por ejemplo, un emoji de punto de c√≥digo <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png">  es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">U + 1F436</a> . <br><br>  Al codificar este icono, se puede representar como varias secuencias de bytes: <br><br><ul><li>  UTF-8: 4 bytes, <code>0xF0 0x9F 0x90 0xB6</code> </li><li>  UTF-16: 4 bytes, <code>0xD83D 0xDC36</code> </li></ul><br>  En el siguiente c√≥digo de JavaScript, los tres comandos imprimen el mismo car√°cter en la consola del navegador. <br><br> <code>//         <br> console.log(' <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> ') // =&gt; <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> <br> //     Unicode (ES2015+) <br> console.log('\u{1F436}') // =&gt; <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> <br> //        UTF-16 <br> //      ( 2  ) <br> console.log('\uD83D\uDC36') // =&gt; <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"></code> <br><br>  Los mecanismos internos de la mayor√≠a de los int√©rpretes de JavaScript (incluidos Node.js y los navegadores modernos) usan UTF-16.  Esto significa que el icono de perro que estamos considerando se almacena utilizando dos unidades de c√≥digo UTF-16 (16 bits cada una).  Por lo tanto, lo que el siguiente c√≥digo de salida no deber√≠a parecerle incomprensible: <br><br> <code>console.log(' <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> '.length) // =&gt; 2</code> <br> <br><h2>  <font color="#3AC1EF">Combinaci√≥n de personajes</font> </h2><br>  Ahora, de vuelta al punto de partida, es decir, hablemos sobre por qu√© los s√≠mbolos que se ven iguales para una persona tienen una representaci√≥n interna diferente. <br><br>  Algunos caracteres Unicode est√°n dise√±ados para modificar otros caracteres.  Se llaman personajes combinados.  Se aplican a los caracteres base. Por ejemplo: <br><br><ul><li> <code>n + Àú = √±</code> </li> <li> <code>u + ¬® = √º</code> </li> <li> <code>e + ¬¥ = √©</code> </li> </ul><br>  Como puede ver en el ejemplo anterior, los caracteres combinables le permiten agregar signos diacr√≠ticos a los caracteres base.  Pero las capacidades de transformaci√≥n de caracteres de Unicode no se limitan a esto.  Por ejemplo, algunas secuencias de caracteres se pueden representar como ligaduras (por lo que ae puede convertirse en √¶). <br><br>  El problema es que los caracteres especiales se pueden representar de varias maneras. <br><br>  Por ejemplo, la letra √© se puede representar de dos maneras: <br><br><ul><li>  Usando un √∫nico punto de c√≥digo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">U + 00E9</a> . </li><li>  Usando una combinaci√≥n de la letra e y el signo agudo, es decir, usando dos puntos de c√≥digo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">U + 0065</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">U + 0301</a> . </li></ul><br>  Los caracteres resultantes del uso de cualquiera de estas formas de representar la letra √© se ver√°n iguales, pero cuando se comparan, resulta que los caracteres son diferentes.  Las l√≠neas que los contienen tendr√°n diferentes longitudes.  Puede verificar esto ejecutando el siguiente c√≥digo en la consola del navegador. <br><br><pre> <code class="plaintext hljs">console.log('\u00e9') // =&gt; √© console.log('\u0065\u0301') // =&gt; √© console.log('\u00e9' == '\u0065\u0301') // =&gt; false console.log('\u00e9'.length) // =&gt; 1 console.log('\u0065\u0301'.length) // =&gt; 2</code> </pre> <br>  Esto puede conducir a errores inesperados.  Por ejemplo, se pueden expresar en el hecho de que el programa, por razones desconocidas, no puede encontrar algunas entradas en la base de datos, ya que el usuario, al ingresar la contrase√±a correcta, no puede iniciar sesi√≥n en el sistema. <br><br><h2>  <font color="#3AC1EF">Normalizaci√≥n de linea</font> </h2><br>  Los problemas anteriores tienen una soluci√≥n simple, que consiste en normalizar las cadenas, en llevarlas a la "representaci√≥n can√≥nica". <br><br>  Hay cuatro formas est√°ndar (algoritmos) de normalizaci√≥n: <br><br><ul><li>  NFC: Normalizaci√≥n Forma Composici√≥n can√≥nica. </li><li>  NFD: Normalizaci√≥n de la descomposici√≥n can√≥nica. </li><li>  NFKC: Composici√≥n de compatibilidad de formularios de normalizaci√≥n. </li><li>  NFKD: Descomposici√≥n de compatibilidad de formularios de normalizaci√≥n. </li></ul><br>  La forma de normalizaci√≥n m√°s utilizada es la NFC.  Cuando se usa este algoritmo, todos los caracteres se descomponen primero, despu√©s de lo cual todas las secuencias combinadas se vuelven a componer en el orden definido por el est√°ndar.  Para uso pr√°ctico, puede elegir cualquier forma.  Lo principal es aplicarlo consistentemente.  Como resultado, la recepci√≥n de los mismos datos en la entrada del programa siempre conducir√° al mismo resultado. <br><br>  En JavaScript, comenzando con el est√°ndar ES2015 (ES6), hay un m√©todo incorporado para normalizar cadenas: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">String.prototype.normalize ([formulario])</a> .  Puede usarlo en el entorno Node.js y en casi todos los navegadores modernos.  El argumento de <code>form</code> de este m√©todo es el identificador de cadena del formulario de normalizaci√≥n.  El valor predeterminado es el formulario NFC. <br><br>  Volvemos al ejemplo considerado anteriormente, aplicando la normalizaci√≥n esta vez: <br><br><pre> <code class="plaintext hljs">const str = '\u0065\u0301' console.log(str == '\u00e9') // =&gt; false const normalized = str.normalize('NFC') console.log(normalized == '\u00e9') // =&gt; true console.log(normalized.length) // =&gt; 1</code> </pre> <br><h2>  <font color="#3AC1EF">Resumen</font> </h2><br>  Si est√° desarrollando una aplicaci√≥n web y est√° utilizando lo que el usuario ingresa en ella, siempre normalice los datos de texto recibidos.  En JavaScript, puede usar el m√©todo de cadena est√°ndar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">normalize ()</a> para realizar la normalizaci√≥n. <br><br>  <b>Estimados lectores!</b>  ¬øHa encontrado problemas con las cadenas que se pueden resolver con la normalizaci√≥n? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/445274/">https://habr.com/ru/post/445274/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445264/index.html">Precarga, captaci√≥n previa y otras etiquetas</a></li>
<li><a href="../445266/index.html">GeekBrains junto con Rostelecom llevar√°n a cabo IoT Hackathon</a></li>
<li><a href="../445268/index.html">Detalles de GraphQL: qu√©, c√≥mo y por qu√©</a></li>
<li><a href="../445270/index.html">[marcador] Bash para principiantes: 21 comandos √∫tiles</a></li>
<li><a href="../445272/index.html">JavaScript es el mejor lenguaje de programaci√≥n para principiantes. Entonces, ¬øes o no?</a></li>
<li><a href="../445276/index.html">Gu√≠a completa de efectos de uso</a></li>
<li><a href="../445278/index.html">C√≥mo crear un juego si nunca eres un artista</a></li>
<li><a href="../445280/index.html">Rentabilidad de sitios y servicios.</a></li>
<li><a href="../445284/index.html">ClickHouse Product Analytics VKontakte</a></li>
<li><a href="../445286/index.html">Reposapi√©s para el cerebro: plataforma de registro distribuido Hedera Hashgraph</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>