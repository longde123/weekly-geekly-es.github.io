<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🚀 👨🏿‍🌾 🧖 Kerentanan UPnP lama dengan cara baru 👨🏾‍🚒 ✈️ 🤜🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Semua yang baru adalah yang sudah lama terlupakan (atau lebih baik, sudah sangat lama terlupakan). Tentu saja, memang benar untuk memantau kerentanan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kerentanan UPnP lama dengan cara baru</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425203/">  Semua yang baru adalah yang sudah lama terlupakan (atau lebih baik, sudah sangat lama terlupakan).  Tentu saja, memang benar untuk memantau kerentanan baru, tetapi Anda tidak boleh melupakan yang lama.  Apalagi saat pabrikan membiarkan dirinya “melupakan” mereka.  Seseorang harus ingat.  Kalau tidak, kita akan menginjak menyapu yang sama lagi dan lagi. <br><br>  Artikel ini akan fokus pada satu yang lama, tetapi ternyata, tidak pernah kehilangan relevansinya dengan hari ini, lubang UPnP. <br><br><img src="https://habrastorage.org/webt/n8/oe/yl/n8oeyllfk_t6lcecxmgt5jfakuw.jpeg"><br><br>  PS Saya tidak akan memanggil penyedia, ia tidak bersalah atas hal ini, tetapi di sisi lain ada pengawasan yang jelas terhadap kebijakan keamanan, yang, ditambah dengan arsitektur jaringan, memungkinkan untuk mengeksploitasi kerentanan ini.  Seperti biasa, bintang-bintang bertemu.  Penyedia menginstal router di jaringannya ke klien dengan chip yang diperlukan dan menghubungkannya dengan alamat ip eksternal.  Ya, sebagian besar port telah difilter, tetapi karena alasan tertentu tidak 52869. <br><br>  PPS Semua acara terjadi pada akhir 2018.  Pahlawan adalah fiksi, dan kebetulan dengan kepribadian nyata adalah acak. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Program pendidikan singkat:</b> <div class="spoiler_text">  Ada beberapa perpustakaan libupnp untuk pengembangan yang "digunakan pada ribuan perangkat dan disebut Intel SDK untuk perangkat UPnP atau Portable SDK untuk perangkat UPnP." <br><br>  Dalam bahasa inggris: <br><blockquote>  "SDK portabel untuk Perangkat UPnP (libupnp) menyediakan pengembang dengan API dan kode sumber terbuka untuk membangun titik kontrol, perangkat, dan jembatan yang sesuai dengan Arsitektur Arsitektur Perangkat Plug and Play Versi 1.0 dan mendukung beberapa sistem operasi seperti Linux , * BSD, Solaris, dan lainnya. " </blockquote><br></div></div><br>  Penyebutan kerentanan pertama kali dilakukan pada tahun 2014: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">tyk</a> <br>  Upaya untuk menghubungi pabrikan tidak membawa banyak kesuksesan dan kerentanan diterbitkan.  Satu-satunya rekomendasi tanggapan adalah: <br><blockquote>  "... membatasi interaksi dengan layanan ... Hanya klien dan server yang memiliki hubungan prosedural hukum ... yang dapat berkomunikasi dengannya." </blockquote>  Kelemahan ada dalam layanan SOAP miniigd.  Masalahnya adalah memproses permintaan NewInternalClient karena ketidakmampuan untuk menghapus data pengguna sebelum membuat panggilan sistem.  Seorang penyerang bisa menggunakan kerentanan ini untuk mengeksekusi kode dengan hak akses root. <br><br>  Yaitu  Pada semua router dengan UPnP versi 1.0, Anda dapat mengeksekusi kode jarak jauh sewenang-wenang. <br>  Tanpa otorisasi.  Dari akar.  Bagus kan? <br><br>  Siapa pun dapat menemukan plugin yang siap pakai untuk metasplit di github, yang kinerjanya diuji oleh kursi yang terbakar dari teknisi kami. <br>  Itu tidak terduga dan sama sekali tidak menyenangkan. <br><br><h3>  Kronologi singkat peristiwa hari itu: </h3><br>  <b>14:00</b> Dalam dukungan teknis, pelanggan mulai menerima panggilan ke Internet yang berfungsi buruk. <br><br><ul><li>  <u>Gejala di sisi klien:</u> "itu bekerja lambat, setelah reboot itu berfungsi dengan baik untuk sementara waktu, sekali lagi perlahan." </li><li>  <u>Gejala pada bagian peralatan:</u> lonjakan kecil dalam lalu lintas dan beban CPU dihapuskan ke beban yang dihasilkan klien. </li></ul><br>  Aplikasi tunggal terdaftar untuk memeriksa jalur untuk admin atau untuk keberangkatan penginstal.  Tidak ada template umum untuk tindakan.  Tidak ada yang jelas. <br><br>  <b>15:00</b> Jumlah aplikasi mulai melebihi suhu rata-rata di rumah sakit dan aplikasi tunggal mulai mengukir ke dalam aplikasi untuk lebih dengan jenis "Kecelakaan".  Aplikasi diajukan kepada administrator senior untuk memverifikasi segmen jaringan. <br><br>  <b>15:20</b> Admin menutup crash massal, karena  Tidak ada masalah di jaringan, semua permintaan pelanggan dari titik koneksi berbeda tunggal.  (Misalnya: switch penuh dengan pelanggan aktif, tetapi tidak berfungsi dengan baik untuk satu).  Pada saat ini, seruan jatuh dan semuanya tenang.  Seseorang memperhatikan (akhirnya) bahwa semua aplikasi untuk pekerjaan buruk dengan model router yang sama, semua orang bersama-sama berpura-pura semuanya baik-baik saja. <br><br>  <b>15:30</b> Sekali lagi masuknya aplikasi dari pelanggan, lagi pendaftaran kecelakaan massal dan transfer ke admin.  Pada saat ini, menjadi jelas bahwa ada sesuatu yang <b>benar</b> - <b>benar</b> salah dan sesuatu perlu dilakukan (yang bekerja dengan layanan klien akan memahami betapa sulitnya kadang-kadang dilakukan. Pelanggan <s>selalu</s> berbohong, dan kadang-kadang baris pertama terletak untuk meningkatkan tugas lebih lanjut) . <br><br>  <b>15:35</b> Insinyur yang bertugas menerima permintaan untuk masalah dengan layanan pelanggan.  Mendapat daftar semua klien, jenis koneksi dan model perangkat mereka.  Dan kemudian sihir kecil dimulai. <br><br><img src="https://habrastorage.org/webt/m9/hj/ba/m9hjbaxp9s7onm3ba8nykkcymwe.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">spoiler</b> <div class="spoiler_text">  Omong-omong, yang tidak berhasil dan kemudian penyihir utama dipecat (tetapi mereka mengatakan itu bukan untuk ini). <br></div></div><br>  <b>15:40</b> Insinyur menjalankan daftar klien melalui semua diagnostik yang ada, setiap router diperiksa sesuai dengan semua metrik standar dan ... tidak ada yang ditemukan.  Router seperti router.  Ya, CPU telah meningkat, tetapi indikatornya tidak kritis, tetapi menuangkan lalu lintas di suatu tempat, yang artinya berfungsi. <br><br>  Ya, layanan UPnP berputar di port 52869.  Ya, masih ada banyak port terbuka, terbuka berarti mereka diperlukan (logika besi), dan selalu berbalik dan tidak ada masalah (satu lagi argumen logika besi).  Ssh langsung ke model router ini tidak mungkin (terus terang itu mungkin, tetapi di dalam busybox yang sangat dilucuti dan kebijakan perusahaan, seperti berjalan di sekitar perangkat klien sangat tidak dianjurkan).  Semuanya berdiri lagi. <br><br>  <b>16:00</b> Baru sekarang kami mengetahui bahwa ada beberapa masalah.  Insinyur yang bertugas melapor kepada atasannya, dan atasan menelepon kami tentang dugaannya tentang pelabuhan 52869 dan meminta bantuan. <br><br>  <b>16:05</b> Lalu semuanya terjadi dengan sangat cepat.  Model router yang sama disertakan pada dudukan uji, alamat IP diambil dari klien yang bermasalah dan digantung pada yang uji.  Wireshark dihidupkan.  Ini untuk menangkap permintaan ke perangkat. <br><br>  Untuk menangkap permintaan dari router (pada saat itu skema umum tentang bagaimana interaksi masih belum diketahui) klien diisolasi di segmen uji dan semua lalu lintasnya dicerminkan ke mesin uji terdekat di mana wireshark lain dinaikkan. <br><br>  Kami menunggu lebih jauh, kami melihat layar. <br><br>  Hacks sudah terjebak dengan cara ini - cukup efisien dan karenanya memutuskan untuk tidak mengubah kebiasaan. <br><br>  <b>16:10</b> Sementara wireshark berkarat, di Google ada kerentanan CVE-2014-8361 tentang yang dilaporkan ke insinyur.  Insinyur, tanpa mendengarkan, membuat keputusan (dan, pada prinsipnya, logis) - filter pelabuhan ini di perbatasan.  Tidak lebih cepat dikatakan daripada dilakukan. <br><br><div class="spoiler">  <b class="spoiler_title">spoiler</b> <div class="spoiler_text">  Ini tidak berhasil. <br></div></div><br>  <b>16:25</b> Kita diberitahu bahwa <s>semua remake omong kosong Misha</s> tidak berhasil.  Dan kami sudah tahu itu tidak akan berhasil.  Pada saat itu, mereka telah mengetuk router uji, mengangkat kebalikannya pergi ke port <b>lain</b> dan mulai menggunakannya untuk DDOS-a hingga 1900 (!) Port menggunakan kerentanan lain.  <s>Tuhan, sungguh sampah yang bocor</s> <br><br><div class="spoiler">  <b class="spoiler_title">masih program pendidikan</b> <div class="spoiler_text">  Gunakan dalam serangan DDoS <br><br>  Pada 2014, mereka secara tak terduga menemukan bahwa SSDP digunakan dalam serangan DDoS seperti "serangan refleksi SSDP dengan amplifikasi".  Banyak perangkat, termasuk router rumah, memiliki kelemahan dalam perangkat lunak UPnP, yang memungkinkan penyerang mengirim respons dari port 1900 ke alamat arbitrer di Internet.  Dalam hal menggunakan botnet dari ribuan perangkat seperti itu, penyerang dapat membuat aliran besar paket yang cukup untuk menempati bandwidth dan menjenuhkan saluran data dari situs yang diserang, yang mengarah pada penolakan layanan untuk pengguna biasa. <br></div></div><br>  Hal yang paling menarik adalah bahwa aturan firewall pada perangkat telah diubah dan nmap sekarang tidak menampilkan port terbuka dari luar.  Hanya di tempat pembuangan lalu lintas yang memungkinkan untuk mendeteksi permintaan pada port-port ini.  Yaitu  seorang penyerang setelah peretasan memblokir akses ke yang lain.  Bukan pendekatan hi-tech, tapi tetap saja bravo. <br><br>  <b>16:30</b> Sebuah konferensi berkumpul dengan pertanyaan "siapa yang harus disalahkan dan apa yang harus dilakukan."  Port 1900 dan 52869 diblokir, sedang dilakukan upaya untuk memperbaiki sesuatu pada perangkat yang diretas.  Reboot - tidak membantu, gagasan reflashing segera ditolak.  Ya, ada fungsi seperti itu, memungkinkan untuk mengatur ulang perangkat lunak dari jarak jauh melalui TR069 dengan satu tombol di semua perangkat.  Tapi sejak itu  perangkat itu bukan kesegaran pertama, tetapi jumlah pelanggan besar - persentase tertentu dari perangkat bata akan menimbulkan masalah. <br><br>  <b>16:40 Untuk</b> meringkas: perangkat diretas, berpartisipasi dalam minimum dalam ddos ​​dan mengirimkan sesuatu di suatu tempat di saluran terenkripsi.  (Semua pada port yang <b>berbeda</b> ).  Masuk tidak mungkin, vendor menolak akses penuh melalui ssh ke perangkat dan melihat apa yang tidak mungkin untuk sampai ke sana.  Konsol dilindungi kata sandi. <br><br>  <b>Di suatu tempat lebih dekat ke 17:00,</b> diputuskan untuk menjahit perangkat sebagai cara tercepat.  Setelah flashing dan reboot, semuanya kembali normal. <br><br><h3>  Alih-alih total </h3><br>  Sayangnya, kami tidak dapat menyelesaikan masalah ini sepenuhnya. <br><br>  Dengan "memutuskan" yang saya maksudkan adalah mendapatkan informasi peretasan yang lengkap dan memperbarui kebijakan kami untuk menghadapi ini di masa depan.  Ya, tidak semua tugas diselesaikan dengan sukses dan seperti yang kita inginkan.  Ini normal.  Meskipun menghina. <br><br>  <i>Jika baik untuk mencari di shodan,</i> <i><br></i>  <i>Anda dapat menemukan sendiri sesuatu</i> <i><br></i>  <i>untuk eksperimen:</i> <i><br></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">satu</a> atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">lain</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">cara</a></i> <i><br></i>  <i>tapi aku tidak memberitahumu itu.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id425203/">https://habr.com/ru/post/id425203/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id425191/index.html">Fastware</a></li>
<li><a href="../id425195/index.html">Daftar Hitam, Putih, dan Abu-abu Melindungi Keamanan Perusahaan</a></li>
<li><a href="../id425197/index.html">Estimasi Biaya dari Proyek Implementasi IdM - Bagaimana Meramalkan Kejutan</a></li>
<li><a href="../id425199/index.html">Apa yang melindungi pembeli dari penipuan pembayaran tanpa kontak</a></li>
<li><a href="../id425201/index.html">"Saya telah berjuang melawan sindrom penipu selama tiga tahun" - 10 pertanyaan untuk seorang programmer, edisi 7</a></li>
<li><a href="../id425205/index.html">Soft Skills dalam manajemen proyek: konsep, tujuan dan tips untuk penggunaan bisnis yang sukses</a></li>
<li><a href="../id425207/index.html">Desain Pengujian: Top 10 Heisenbug 2018 Piter Papers</a></li>
<li><a href="../id425209/index.html">Sunrise Secara Manual # 2: Menurut hardcore untuk IDE, Cmake, dan kekecewaan saya pada hewan</a></li>
<li><a href="../id425211/index.html">286 dan jaringan</a></li>
<li><a href="../id425213/index.html">Paket untuk versi Vue.js berikutnya</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>