<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœ´ï¸ ğŸ¤ ğŸ”œ æ‚¨å¯ä»¥ä»54-FZä¸ªäººï¼Œæ‚¨çš„ç”¨æˆ·åæˆ–DIYè‡ªåŠ¨åŒ–æˆæœ¬æ ¸ç®—ä¸­è·å¾—ä»€ä¹ˆ ğŸ‘¨ğŸ¿â€ğŸŒ¾ âš«ï¸ ğŸ‘¨ğŸ¾â€ğŸ«</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è‡ª2017å¹´7æœˆ1æ—¥èµ·ï¼Œåœ¨ä¿„ç½—æ–¯è”é‚¦é¢†åœŸä¸Šå¿…é¡»å¼ºåˆ¶ä½¿ç”¨æ”¶é“¶æœºï¼ˆKKMï¼‰å°†å…¶æ‰€æœ‰äº¤æ˜“ç›´æ¥å‘é€è‡³è”é‚¦ç¨åŠ¡å±€ã€‚ æ‰€è°“åœ¨çº¿ç¥¨æˆ¿ã€‚ è¿™é¡¹åˆ›æ–°çš„ä»‹ç»å·²ç»åœ¨æ‰€æœ‰æ–¹é¢ï¼Œæˆ–è€…è‡³å°‘åœ¨æ‰€æœ‰ä¸¥è‚ƒçš„æ–¹é¢éƒ½è¿›è¡Œäº†è®¨è®ºã€‚ è”é‚¦æ³•å¾‹æ˜¯å¦å¯ä»¥æ²¡æœ‰å¤ªä¸¥è‚ƒçš„ä¸€é¢ï¼Œä»¥åŠå®ƒèµ‹äºˆæˆ‘ä»¬çš„åˆ›é€ åŠ›çš„ä½™åœ°-è¿™å·²ç»è¢«å‰Šå‡äº†ã€‚ 


 ç°åœ¨ï¼Œæ‰€æœ‰KKMéƒ½...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æ‚¨å¯ä»¥ä»54-FZä¸ªäººï¼Œæ‚¨çš„ç”¨æˆ·åæˆ–DIYè‡ªåŠ¨åŒ–æˆæœ¬æ ¸ç®—ä¸­è·å¾—ä»€ä¹ˆ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/445182/"> è‡ª2017å¹´7æœˆ1æ—¥èµ·ï¼Œåœ¨ä¿„ç½—æ–¯è”é‚¦é¢†åœŸä¸Šå¿…é¡»å¼ºåˆ¶ä½¿ç”¨æ”¶é“¶æœºï¼ˆKKMï¼‰å°†å…¶æ‰€æœ‰äº¤æ˜“ç›´æ¥å‘é€è‡³è”é‚¦ç¨åŠ¡å±€ã€‚ æ‰€è°“åœ¨çº¿ç¥¨æˆ¿ã€‚ è¿™é¡¹åˆ›æ–°çš„ä»‹ç»å·²ç»åœ¨æ‰€æœ‰æ–¹é¢ï¼Œæˆ–è€…è‡³å°‘åœ¨æ‰€æœ‰ä¸¥è‚ƒçš„æ–¹é¢éƒ½è¿›è¡Œäº†è®¨è®ºã€‚ è”é‚¦æ³•å¾‹æ˜¯å¦å¯ä»¥æ²¡æœ‰å¤ªä¸¥è‚ƒçš„ä¸€é¢ï¼Œä»¥åŠå®ƒèµ‹äºˆæˆ‘ä»¬çš„åˆ›é€ åŠ›çš„ä½™åœ°-è¿™å·²ç»è¢«å‰Šå‡äº†ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/57a/b38/106/57ab38106bec63bc587d8cb57b3eb920.png"></div><a name="habracut"></a><br> ç°åœ¨ï¼Œæ‰€æœ‰KKMéƒ½ä¼šå°†æˆ‘ä»¬çš„äº¤æ˜“é€šçŸ¥è”é‚¦ç¨åŠ¡å±€ï¼Œè”é‚¦ç¨åŠ¡å±€å·²ç»å‘å¸ƒäº†ä¸€ä¸ªç‰¹æ®Šçš„ç§»åŠ¨åº”ç”¨ç¨‹åºï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google Play</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">App Store</a> ï¼‰ï¼Œä»¥ç¡®ä¿æ¯ä¸ªåœ¨çº¿æ”¶é“¶å‘˜çš„è¯šå®ï¼Œå…è®¸ç”¨æˆ·æ£€æŸ¥æä¾›ç»™ä»–çš„ä»»ä½•æ”¯ç¥¨ï¼Œå¹¶å°†æ”¯ç¥¨å‘ŠçŸ¥ä¸»ç®¡å½“å±€ã€‚å¤±è´¥äº† <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5f/a8/rw/5fa8rwujagyazehlswcnqod16nu.jpeg"></div><br> å½“æˆ‘å¬è¯´æœ‰äººå¼€å§‹æ”¶é›†å¤§é‡ä¿¡æ¯æ—¶ï¼Œæˆ‘è®¤ä¸ºä¸æ½œåœ¨æ”¶ç›Šæ— å…³ï¼Œè€Œä¸å®æ–½æˆæœ¬æ— å…³ã€‚ ç”šè‡³æ²¡æœ‰é‚£ä¸ªå¤§å“¥åœ¨çœ‹ç€ã€‚ åœ¨æˆ‘çš„è„‘æµ·ä¸­ï¼Œç«‹å³ç»˜åˆ¶å‡ºå¯ä»¥è¿‡æ»¤å’Œè¿æ¥çš„æ ‡å¿—ï¼Œå¯ä»¥æ‰­æ›²çš„ç«‹æ–¹ä½“ï¼Œå¯ä»¥æ„å»ºçš„å›¾è¡¨ç­‰ã€‚ æˆ‘ä»¬å¯ä»¥ä»¥æŸç§æ–¹å¼åšæŒä»å–æ–¹åˆ°å·çš„æ•°æ®æµå—ï¼Ÿ æˆ‘ä»¬å¯ä»¥ã€‚  ï¼ˆä»¥å°å¼“çš„å½¢å¼ï¼ŒFTSåº”ç”¨ç¨‹åºè¿˜æä¾›äº†è·å¾—æ­¤æ”¯ç¥¨æœ¬èº«çš„ç”µå­ç‰ˆæœ¬çš„æœºä¼šã€‚ï¼‰ <br><br> å½“æˆ‘å‘ç°è¿™ä¸ªæœºä¼šæ—¶ï¼Œæˆ‘ç€ç«äº†ã€‚ ä»”ç»†æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„åŠŸèƒ½å¹¶ä¸ä¼šä»¤æˆ‘å¤±æœ›ï¼šä¸ä»…å¯ä»¥ä½¿ç”¨htmlæˆ–pngï¼Œè€Œä¸”å¯ä»¥ä½¿ç”¨jsonè·å¾—æ£€æŸ¥ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25c/04e/886/25c04e88687ccd7d5fe1d5c09f331f74.png"></div><br> äº‹å®æ˜¯ï¼Œæˆ‘è¯•å›¾ä¿æŒæ‰€æœ‰æ”¯å‡ºã€‚ æˆ‘å°è¯•å®šæœŸæ‰§è¡Œæ­¤æ“ä½œï¼Œä½†æ˜¯ï¼Œå½“ç„¶ï¼Œäº‹å®è¯æ˜ï¼Œæˆ‘è¿ç»­å‡ ä¸ªæ˜ŸæœŸéƒ½å¿˜è®°è¿™æ ·åšã€‚ å¹¶å¼€å§‹æ²‰æµ¸åœ¨è¿‡å»å¹¶å¡«å……ç™½è‰²æ–‘ç‚¹çš„Ericksonianå‚¬çœ ä¼šè®®ã€‚ <br><br> æ­£æ˜¯ä»è¿™ä¸€ç—›è‹¦çš„è¿‡ç¨‹ä¸­ï¼Œè”é‚¦ç¨åŠ¡å±€å°†å¸®åŠ©æˆ‘ä»¬æ‘†è„±å›°å¢ƒã€‚ <br><br> ä»ç†è®ºä¸Šè®²ï¼Œäº‹å®è¯æ˜ï¼Œæ‚¨ä¸å¿…åˆ†ææœˆåº•çš„å¤šå®¶é“¶è¡Œçš„é“¶è¡Œå¯¹å¸å•å’Œä¸€å †çº¸è´¨æ”¯ç¥¨ï¼ˆå°è¯•äº†è§£æ‰€æœ‰èµ„é‡‘å†æ¬¡åˆå¹¶çš„ä½ç½®ï¼Œè€Œæ˜¯å¯ä»¥åˆ†æé™„ä»¶ä¸­jsonæ¡†ä¸­çš„å­—æ¯å±±ã€‚ å‰æ™¯ä¹Ÿå¾ˆä¸€èˆ¬ï¼Œä½†ä¸ç¬¬ä¸€ä¸ªä¸åŒï¼Œå®ƒæ›´é€‚åˆè‡ªåŠ¨åŒ–ã€‚ <br><br> å› æ­¤ï¼Œè¿›è¡Œè´­ä¹°åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‚®ä»¶æ¥æ”¶JSONæ ¼å¼çš„æ”¯ç¥¨ã€‚ æ­¤å¤–ï¼Œä»ç†è®ºä¸Šè®²ï¼Œä¸ºæ­¤è´­ä¹°æ—¶ï¼Œæˆ‘ä»¬ç”šè‡³ä¸éœ€è¦è”é‚¦ç¨åŠ¡å±€çš„åº”ç”¨ç¨‹åºï¼šæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­é¢„å…ˆç”Ÿæˆå¸¦æœ‰é‚®ä»¶äºŒç»´ç çš„åç‰‡ï¼Œå¹¶åœ¨è´­ä¹°æ—¶å‡ºç¤ºç»™æ”¶é“¶å‘˜ã€‚ ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ä»¥ç”µå­æ”¯ç¥¨ä»£æ›¿çº¸è´¨æ”¯ç¥¨ï¼Œè¿™å°†ç«‹å³è½å…¥é‚®ä»¶ä¸­ã€‚ ä¸åœ¨çº¿è´­ç‰©ä¸€æ ·ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8e/410/6ca/a8e4106cac756a7467f38838b22ae337.png"></div><br> ä½†æ˜¯ï¼Œå³ä½¿æ˜¯è”é‚¦ç¨åŠ¡å±€ä¹Ÿç›´æ¥å†™äº†è¿™ä¸ªåŠŸèƒ½-â€œä¸è¦è‡ªæ¬ºæ¬ºäººâ€ã€‚ å¹¶éæ‰€æœ‰çš„KKMéƒ½æ”¯æŒå®ƒã€‚ å³ä½¿åœ¨KKMæ”¯æŒçš„æƒ…å†µä¸‹ï¼Œæ”¶é“¶å‘˜æœ¬èº«ä¹Ÿä¸æ˜¯å®Œå…¨æ”¯æŒå®ƒã€‚ æ‰€ä»¥ç°åœ¨è¿™æ˜¯ä¸ºäº†åšå¼ºçš„ç²¾ç¥ã€‚ <br><br> æ”¶åˆ°é‚®ä»¶ä¸­çš„æ”¯ç¥¨åï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹å®ƒè¿›è¡Œè‡ªåŠ¨åŒ–åˆ†æï¼Œå¹¶ä¸ºæˆ‘ä»¬æ–¹ä¾¿åœ°å°†å…¶å¸è½½ã€‚ <br><br> æ‚¨éœ€è¦é€‰æ‹©å°†æ‰€æœ‰è¿™äº›å†…å®¹å¸è½½çš„ä½ç½®ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥ä½¿ç”¨å®ƒã€‚ <br><br> æˆ‘ä¸çŸ¥é“æ‚¨çš„çŠ¶å†µï¼Œä½†æ˜¯ä¸ªäººä½¿ç”¨è¿™äº›é›‡å‘˜æˆ–è¿™äº›å›½æœ‰é›‡å‘˜ï¼Œå› æ­¤ï¼Œæˆ‘æ€»æ˜¯å°†ä»–ä»¬çš„æ•°æ®å¯¼å‡ºä»¥è¿›è¡Œåˆ†æï¼Œä»¥ä½¿ç”¨è‰¯å¥½çš„æ—§Excelã€‚ æ— è®ºå¼€å‘äººå‘˜é¢„å…ˆåœ¨äº§å“ä¸­åŒ…æ‹¬ä»€ä¹ˆå›¾å½¢å’Œå›¾è¡¨ï¼Œä»–ä»¬éƒ½å°†æ°¸è¿œæ— æ³•é¢„æµ‹æˆ‘æƒ³ä»æ•°æ®ä¸­æå–çš„ä¸€åˆ‡ã€‚ ä¸æœˆç›¸ï¼Œåˆ†ç»„ï¼Œé™¤ä»¥ä»Šå¤©çš„æ•°å­—ç›¸æ¯”ï¼Œè¦è€ƒè™‘å“ªäº›äº¤æ˜“ï¼Œå“ªäº›äº¤æ˜“è¦å¿½ç•¥... Excelå¯ä»¥å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œã€‚ <br><br> æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬å°†Excelæ”¾åœ¨OneDriveä¸­ï¼Œåˆ™å¯ä»¥é€šè¿‡Webå®Œç¾åœ°è®¿é—®å®ƒï¼ŒåŒ…æ‹¬ä»ç§»åŠ¨OSä¸­è®¿é—®å®ƒã€‚ è€Œä¸”ï¼Œä¸GoogleDriveä¸åŒï¼Œå…¬å¼å°†åœ¨æ­¤å¤„å®Œç¾è¿è¡Œï¼ŒåŒ…æ‹¬ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸ºæ¯æ¬¡è´­ä¹°çš„ç±»åˆ«å’Œå­ç±»åˆ«ç»„ç»‡çº§è”ä¸‹æ‹‰åˆ—è¡¨çš„å…¬å¼ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zr/vy/yv/zrvyyvzitqtnfihowwylrjrpzc4.gif"></div><br> å°äº‹æƒ…æ˜¯å¤„ç†è§£æå™¨ã€‚ æˆ‘ä»¬éœ€è¦ä¸€ç§ä»é‚®ç®±æ¥æ”¶å¸¦æœ‰é™„ä»¶çš„å­—æ¯ï¼Œè§£æjsoné™„ä»¶å¹¶å°†ç»“æœå†™å…¥OneDriveä¸­çš„Excelå¹³æ¿ç”µè„‘çš„æœºåˆ¶ã€‚ <br><br> åœ¨ç†æƒ³çš„ä¸–ç•Œä¸­ï¼Œæˆ‘è®¤ä¸ºæ­¤è§£æå™¨å°±åƒæ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IFTTTçš„</a>ä¸€ä¸ªæ­¥éª¤ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆä¾¿å¯ä»¥å®Œå…¨åœ¨ç½‘ç»œä¸Šè¿è¡Œï¼Œè€Œæ— éœ€ç”¨æˆ·æå‡ºä»»ä½•è¦æ±‚ï¼ˆå› ä¸ºæˆ‘ä»¬è°ˆè®ºçš„æ˜¯ç†æƒ³ä¸–ç•Œï¼Œå› æ­¤è”é‚¦ç¨åŠ¡å±€çš„â€œåç‰‡â€å¯ä»¥åœ¨å…¶ä¸­å®Œç¾è¿è¡Œï¼‰ã€‚ <br><br> ä½†æ˜¯ï¼Œç«‹å³äº†è§£è¡—ä¸Šçš„äººä»¬å¦‚ä½•ä¸ºIFTTTå†™ä¸‹è‡ªå·±çš„è„šæ­¥-å¹¶äº†è§£è¿™æ˜¯å¦å®Œå…¨å¯èƒ½ã€‚ æˆ‘å¤±è´¥äº†ã€‚ å¦‚æœæœ‰äººå¯ä»¥æå‡ºè§£é‡Šæ€§æŒ‡å—æˆ–æ›¿ä»£å¹³å°ï¼Œæˆ‘å°†éå¸¸æ„Ÿè°¢ã€‚ <br><br> ç”±äºç½‘ç»œè§£å†³æ–¹æ¡ˆæ•ˆæœä¸ä½³ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¡Œé¢ä¸Šå®ç°äº†è§£æå™¨çš„ä¸€ä¸ªé“¾æ¥ã€‚ åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NORBITï¼Œ</a>æˆ‘æ­£åœ¨å®æ–½Dynamics CRMï¼Œå› æ­¤Microsoftå †æ ˆå¯¹æˆ‘æ¥è¯´æ˜¯æœ€ç†Ÿæ‚‰çš„ã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬å·²ç»å¼€å§‹é€šè¿‡é€‰æ‹©Excelå’ŒOneDriveä½¿ç”¨å®ƒã€‚ æˆ‘ä»¬å®ç°äº†Outlookæ’ä»¶ï¼Œåœ¨å…¶ä¸­æ”¾ç½®äº†æ‰€éœ€çš„æ‰€æœ‰é€»è¾‘ã€‚ <br><br> åœ¨è¿™é‡Œï¼Œæˆ‘èµ°äº†é˜»åŠ›æœ€å°çš„é“è·¯ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘é‡‡ç”¨äº†ä»FTSæ¥æ”¶åˆ°çš„JSONå¹¶å°†å…¶æä¾›ç»™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">json2csharp.com</a> ã€‚ å¾—åˆ°äº†ååºåˆ—åŒ–çš„ç±»ç»“æ„ï¼š <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Item</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> name { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nds18 { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> price { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> quantity { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>? nds10 { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Receipt</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;Item&gt; items { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> retailPlaceAddress { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> userInn { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> requestNumber { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nds18 { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> fiscalDriveNumber { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> user { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fiscalDocumentNumber { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> taxationType { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ecashTotalSum { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> kktRegId { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime dateTime { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> operationType { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cashTotalSum { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> receiptCode { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nds10 { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> totalSum { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> shiftNumber { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; }    <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fiscalSign { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } }</code> </pre> <br> ç°åœ¨ï¼Œæ‚¨éœ€è¦æ”¶åˆ°ä¸€å°ä¿¡ï¼Œå¯¹ä¸Šé¢è·å¾—çš„ç±»çš„é™„ä»¶è¿›è¡Œååºåˆ—åŒ–ï¼Œç„¶åå°†å®ƒä»¬è½¬æ¢ä¸ºXLSXã€‚ <br><br> æˆ‘ä½¿ç”¨Newtonsoft.Jsonè¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ClosedXMLè¿›è¡ŒExcelç¼–å†™ã€‚ éšåï¼Œäº‹å®è¯æ˜ï¼Œå¯èƒ½ä¸å¿…è´¹å¿ƒç›´æ¥å†™XLSXï¼Œè€Œæ˜¯å®‰é™åœ°ä»¥CSVæ ¼å¼å†™-ç”±äºæŸäº›åŸå› ï¼Œåœ¨å¤„ç†å…·æœ‰æ•°æ®é€è§†è¡¨çš„æ–‡ä»¶æ—¶ï¼ŒClosedXMLå´©æºƒã€‚ å› æ­¤ï¼Œåˆ°ç›®å‰ä¸ºæ­¢çš„ç»Ÿè®¡ä¿¡æ¯å¿…é¡»åœ¨å•ç‹¬çš„å‰æ–‡ä»¶ä¸­å–å‡ºï¼Œå¹¶ä»æ’ä»¶ä¸­å¸è½½ä½œä¸ºæ•°æ®æºã€‚ <br><br> æ’ä»¶æœ¬èº«éå¸¸ç®€å•ã€‚ ä¸ºäº†ä¸å¤„ç†æ‰€æœ‰ä¼ å…¥çš„ä¿¡ä»¶ï¼Œæˆ‘æ‰“å¼€äº†ä¸€ä¸ªä¸“ç”¨äºæ£€æŸ¥çš„å•ç‹¬é‚®ç®±ï¼Œå¹¶æ£€æŸ¥è¯¥ä¿¡ä»¶æ˜¯å¦å·²é€è¾¾ä»–ã€‚ æ¥ä¸‹æ¥ï¼Œå½“ç„¶ï¼Œæ‚¨éœ€è¦å°†å…¶æ”¾å…¥æ‰€æœ‰æ–‡ä»¶å¤¹åœ°å€ä¹‹ç±»çš„å¯é…ç½®è®¾ç½®ä¸­ã€‚ <br><br><pre> <code class="cpp hljs">        <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Items_ItemAdd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object Item)</span></span></span><span class="hljs-function">       </span></span>{           Outlook.MailItem mail = (Outlook.MailItem)Item;           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Item != null)           {               <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mail.Attachments.Count == <span class="hljs-number"><span class="hljs-number">1</span></span> &amp; mail.To.Equals(<span class="hljs-string"><span class="hljs-string">"my@mail.address"</span></span>))               {                                     Outlook.Attachment attach = mail.Attachments[<span class="hljs-number"><span class="hljs-number">1</span></span>];                   <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> path = <span class="hljs-string"><span class="hljs-string">"C:\\_Data\\_tmp\\"</span></span> + attach.FileName;                   attach.SaveAsFile(path);                   <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> text = System.IO.File.ReadAllText(path);                   System.IO.File.Delete(path);                   List&lt;TableRow&gt; objectList = GetBillsData(text);                   WriteBillsToXLSX(objectList);               }           }       }       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteBillsToXLSX</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;TableRow&gt; objectList)</span></span></span><span class="hljs-function">       </span></span>{           var workbook = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XLWorkbook(tablePath);           var ws = workbook.Worksheet(<span class="hljs-string"><span class="hljs-string">"Products"</span></span>);           <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> startrow = ws.LastRowUsed().RowNumber();           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ws.CellsUsed().Count() != <span class="hljs-number"><span class="hljs-number">0</span></span>)               startrow = ws.CellsUsed().Last().Address.RowNumber;            foreach (var item in objectList)           {               startrow++;               ws.Cell(startrow, <span class="hljs-number"><span class="hljs-number">1</span></span>).Value = item.dateTime;               ws.Cell(startrow, <span class="hljs-number"><span class="hljs-number">2</span></span>).Value = item.sum;               ws.Cell(startrow, <span class="hljs-number"><span class="hljs-number">3</span></span>).Value = item.quantity;               ws.Cell(startrow, <span class="hljs-string"><span class="hljs-string">"J"</span></span>).Value = item.user;               ws.Cell(startrow, <span class="hljs-string"><span class="hljs-string">"S"</span></span>).Value = item.name;           }           workbook.SaveAs(tablePath);       }       <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;TableRow&gt; GetBillsData(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> bill)       {           Receipt doc = JsonConvert.DeserializeObject&lt;Receipt&gt;(bill);           List&lt;TableRow&gt; objectList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;TableRow&gt;();           foreach (var item in doc.items)           {               objectList.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TableRow(item, doc));           }           <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objectList;       }</code> </pre><br> ä»JSONåˆ°è¡¨è¡Œçš„æ‰€æœ‰æ•°æ®è½¬æ¢éƒ½å·²ç§»è‡³TableRowæ„é€ å‡½æ•°ã€‚ <br><br> ç°åœ¨ï¼Œå®Œæˆè´­ä¹°åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰«ææ”¯ç¥¨äº†ï¼Œæ‰€æœ‰æ”¯ç¥¨æœ¬èº«éƒ½å°†è½å…¥æˆ‘ä»¬ä½äºäº‘ä¸­çš„æ–‡ä»¶ä¸­ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æ­¤æ–‡ä»¶ï¼Œè€Œæ— éœ€ç¦»å¼€æ”¶é“¶å°ã€‚ åœ¨æ”¯æŒç°ä»£æµè§ˆå™¨çš„ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æŸ¥çœ‹ã€‚ <br><br> å‰©ä¸‹çš„åªæ˜¯æ”¾ä¸‹å·²åŠ è½½è¡Œçš„ç±»åˆ«å’Œå­ç±»åˆ«ï¼Œæ‚¨å¯ä»¥æ„å»ºä»»ä½•ä»¤æˆ‘ä»¬é«˜å…´çš„åˆ†æã€‚ ä»…éœ€è¦å‡ è¡Œä»£ç ï¼Œå¦‚æœæ–‡ä»¶ä¸­å·²æœ‰ä¸€è¡Œå…·æœ‰ç›¸åŒæè¿°ä¸”ä¹‹å‰å·²å¡«å†™äº†ç±»åˆ«ï¼Œåˆ™è¯¥æ’ä»¶å°†å­¦ä¹ å¦‚ä½•ä¸ºè¡Œæ·»åŠ ç±»åˆ«/å­ç±»åˆ«ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/530/003/259530003c77652d1d96263e71ca9552.png"></div><br> æœ¬è´¨ä¸Šå°±æ˜¯è¿™æ ·çš„æ•°æ®å¾ªç¯ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN445182/">https://habr.com/ru/post/zh-CN445182/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN445170/index.html">å…³äºJavaScriptçš„ä¸‰å¤§è°è¨€</a></li>
<li><a href="../zh-CN445172/index.html">å¸¦æœ‰Chromiumçš„è¾¹ç¼˜æµè§ˆå™¨å‡ºç°åœ¨æ–‡ä»¶æ‰˜ç®¡æœåŠ¡ä¸Š</a></li>
<li><a href="../zh-CN445176/index.html">ç™Œç—‡ï¼Œè‡ªé—­ç—‡å’Œç³–å°¿ç—…ï¼šäººå·¥æ™ºèƒ½å°†åœ¨2019å¹´å¸®åŠ©æ²»ç–—ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN445178/index.html">ä½¿ç”¨UmVirt LFS Packagesç½‘ç«™ç®€åŒ–ä»æºä»£ç æ„å»ºLinux</a></li>
<li><a href="../zh-CN445180/index.html">åŠ å…¥Google Playç½‘ç»œç ”è®¨ä¼š3æœˆ29æ—¥</a></li>
<li><a href="../zh-CN445184/index.html">æ–°çš„ç½‘ç»œå®‰å…¨å¨èƒï¼šæ¯”æ‚¨æƒ³è±¡çš„è¦å¤§å¾—å¤š</a></li>
<li><a href="../zh-CN445186/index.html">åœ¨RPGä¸­åˆ›å»ºæˆ˜æ–—ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN445188/index.html">ä»€ä¹ˆæ˜¯æ¸¸æˆç¥ç»æ¥å£ï¼Ÿ</a></li>
<li><a href="../zh-CN445190/index.html">å…‘ç°/ä¸å…‘ç°ï¼šæˆ‘ä»¬åœ¨é¸­å˜´å…½çš„æœºå™¨å­¦ä¹ é£è¡Œå‘˜</a></li>
<li><a href="../zh-CN445192/index.html">4Kï¼šå‘å±•è¿˜æ˜¯è¥é”€ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>