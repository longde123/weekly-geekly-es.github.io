<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤚 😤 🤰🏿 Identifizierung realer IP-Adressen von Benutzern des Tor-Netzwerks durch einen verzerrten Cache 👅 👕 🐼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel beschreibt ein Beispiel für die praktische Anwendung des Angriffs "Cache-Verzerrung durch 301-Umleitung", der vom Ausgabeknoten des Tor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Identifizierung realer IP-Adressen von Benutzern des Tor-Netzwerks durch einen verzerrten Cache</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vds/blog/456896/"><img src="https://habrastorage.org/getpro/habr/post_images/e0e/20c/130/e0e20c13066a38bd4c0c81d1d60de6db.jpg" alt="Bild"><br><br>  Dieser Artikel beschreibt ein Beispiel für die praktische Anwendung des Angriffs "Cache-Verzerrung durch 301-Umleitung", der vom Ausgabeknoten des Tor-Netzwerks mit bösartigem Code verwendet werden kann, um die tatsächlichen IP-Adressen ausgewählter Benutzer zu identifizieren. <br><a name="habracut"></a><br><h4>  Angriffsszenario </h4><br>  Das Angriffsszenario ist wie folgt: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://player.vimeo.com/video/337756409" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><ul><li>  Kunde: Chrome Canary (76.0.3796.0) </li><li>  Echte Client-IP: 5.60.164.177 </li><li>  Kundenverfolgungsparameter: 6b48c94a-cf58-452c-bc50-96bace981b27 </li><li>  IP-Adresse des Ausgangsknotens des Tor-Netzwerks: 51.38.150.126 </li><li>  Transparenter Reverse Proxy: tor.modlishka.io (Modlishka - aktualisierter Code wird veröffentlicht.) </li></ul><br>  Hinweis: In diesem Szenario wurde der Chrome-Browser über das SOCKS5-Netzwerkprotokoll für die Verwendung des Tor-Netzwerks konfiguriert.  Der Tor-Kanal wurde auf einen bestimmten Testausgangsknoten abgestimmt: '51 .38.150.126 '.  Es ist auch eine Validierung des Konzepts und viele Einstellungen können in Zukunft optimiert werden ... <br><br>  Bei einem böswilligen Ausgabeknoten des Tor-Netzwerks wird der gesamte Datenverkehr über den Modlishka-Proxyserver umgeleitet: <br><br><pre><code class="bash hljs">iptables -A OUTPUT -p tcp -m tcp --dport 80 -j DNAT --to-destination ip_address:80 iptables -A FORWARD -j ACCEPT</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://player.vimeo.com/video/339586722" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  Beschreibung des Angriffsszenarios </h4><br>  Annahmen: <br><br><ul><li>  Eine Browseranwendung (in diesem Fall ein Standardbrowser), die die Netzwerkverbindung „Tor“ verwendet und schließlich die Verbindung über einen böswilligen Ausgabeknoten herstellt. </li><li>  Der böswillige Ausgabeknoten des Tor-Netzwerks, der den Cache des gesamten HTTP-Verkehrs abfängt und verzerrt (Antwortcode HTTP 301), der kein TLS (Transport Layer Security Cryptographic Protocol) hat. </li></ul><br><img src="https://habrastorage.org/webt/4b/kl/6d/4bkl6damygrn1rnfce9fxujbeny.png"><br><br>  Schauen wir uns die folgenden Schritte eines Angriffsszenarios an: <br><br><ol><li>  Der Benutzer stellt über das Tor-Netzwerk eine Verbindung zum Internet her, indem er den Browser für die Verwendung des SOCKS5-Netzwerkprotokolls des Tor-Systems konfiguriert oder so konfiguriert, dass der gesamte Betriebssystemverkehr über das Tor-Netzwerk umgeleitet wird. </li><li>  Der Benutzer startet seine normale Internetzugangssitzung mit seinem bevorzugten Browser, in dem normalerweise viel HTTP-Verkehr ohne das TLS-Sicherheitsprotokoll über den Tunnel des Tor-Netzwerks gesendet wird. </li><li>  Der böswillige Ausgabeknoten des Tor-Netzwerks fängt Anforderungen ab und leitet sie jeweils mit dem HTTP 301-Antwortcode weiter.  Diese Weiterleitungen werden vom Browser ständig zwischengespeichert und an die Tracking-URL mit der zugewiesenen Tor-Client-ID gesendet.  Die Tracking-URL kann folgendermaßen erstellt werden: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">user-identifier.evil.tld</a> , wobei 'evil.tld' alle Informationen über die Quell-IP-Adresse sammelt und Benutzer zu den ursprünglich angeforderten Hosts umleitet ... oder alternativ zur transparenten Rückseite Ein Proxyserver, der versucht, den gesamten nachfolgenden Strom des HTTP-Clientverkehrs abzufangen.  Da es außerdem möglich ist, den Cache für die meisten der beliebtesten Domänen (wie in einem vorherigen Artikel beschrieben) automatisch zu verzerren, z.  Top 100 Websites Laut Statistik des Unternehmens «Alexa» maximiert der Angreifer seine Chancen, echte IP-Adressen zu identifizieren. </li><li>  Nach dem Beenden der Tor-Netzwerksitzung wechselt der Benutzer zu seinem regulären Netzwerk. </li><li>  Sobald der Benutzer die Adresse einer der zuvor verzerrten Domänen in die Adressleiste eingibt (z. B. "google.com"), verwendet der Browser den Cache für die interne Umleitung zur Tracking-URL mit der Kontextkennung des Ausgabeknotens. </li><li>  Der Ausgabehost kann die zuvor abgefangene HTTP-Anforderung mit der tatsächlichen IP-Adresse des Benutzers abgleichen, indem er Informationen verwendet, die von einem externen Host empfangen wurden, der die Tracking-URL mit der Benutzer-ID verwendet hat.  Der Host von evil.tld verfügt über Informationen zu allen IP-Adressen, die für den Zugriff auf die Tracking-URL verwendet wurden. </li></ol><br>  Mit dieser Methode können Sie natürlich ausgewählte HTTP-Anforderungen mithilfe des Ausgabeknotens des Tor-Netzwerks effizient mit Client-IP-Adressen abgleichen.  Dies liegt daran, dass die zuvor generierte Tracking-URL vom Client über den Netzwerktunnel „Tor“ und erneut angefordert wird, sobald die Verbindung über die Standardverbindung des Internetproviders hergestellt wird.  Es liegt alles am verstümmelten Code im Cache. <br><br>  Ein anderer Ansatz könnte auf der Einführung eines modifizierten JavaScript-Codes mit eingebetteten URLs zur Verfolgung der entsprechenden Antworten ohne TLS-Sicherheitsprotokoll und der Änderung der erforderlichen Steuerungs-Cache-Header (z. B. 'Cache-Steuerung: max-age = 31536000') basieren. .  Dieser Ansatz ist jedoch nicht sehr effektiv. <br><br>  Das Verfolgen von Benutzern über die Standard-Cookies verschiedener Webanwendungen ist ebenfalls möglich, es ist jedoch sehr schwierig, den Client zu zwingen, die vom Angreifer kontrollierte Domäne zweimal zu besuchen: zuerst beim Herstellen einer Verbindung über den Ausgabeknoten des Tor-Netzwerks und dann erneut nach dem Umschalten auf die Standard-Internetverbindung Anbieter. <br><br><h4>  Schlussfolgerungen </h4><br>  Tatsache ist, dass ein Angreifer bestimmte Änderungen im Browser-Cache vornehmen kann, indem er fehlerhaften Code über böswillige Ausgabeknoten einfügt und die tatsächlichen IP-Adressen von Tor-Benutzern erkennt, die HTTP-Verkehr ohne das TLS-Sicherheitsprotokoll senden. <br><br>  Darüber hinaus erhöht die Verzerrung einer signifikanten Anzahl beliebter Domänennamen die Wahrscheinlichkeit, eine umgekehrte Antwort auf eine HTTP-Anfrage (mit einer zugewiesenen Benutzer-ID) zu erhalten, die die tatsächliche IP-Adresse des Benutzers bestimmt.  Sie können versuchen, die Domain von einigen Browser-Clients abzufangen, und hoffen, dass ein Tippfehler im Domainnamen vom Benutzer nicht bemerkt oder nicht angezeigt wird (z. B. die mobile WebViews-Anwendung). <br><br>  Möglichkeiten zur Risikominderung: <br><br><ul><li>  Stellen Sie beim Herstellen einer Verbindung zum Internet über das Tor-Netzwerk sicher, dass der gesamte Datenverkehr, der das TLS-Sicherheitsprotokoll nicht verwendet, deaktiviert ist.  Ein Beispiel für Browser-Plugins, die verwendet werden können: für Firefox- und Chrome-Browser. </li><li>  Verwenden Sie außerdem immer den "privaten" Browsermodus, wenn Sie über das Tor-Netzwerk eine Verbindung zum Internet herstellen. </li><li>  Leiten Sie den Datenverkehr nicht über das Tor-Netzwerk auf Ihr gesamtes Betriebssystem um, bis Sie sicher sind, dass der gesamte ausgehende Datenverkehr das TLS-Sicherheitsprotokoll verwendet ... </li><li>  Verwenden Sie nach Möglichkeit die neueste Version des Tor-Browsers, um im Internet zu surfen. </li></ul><br><hr><br>  Die neuesten Dual-Prozessor-Konfigurationen dedizierter Server mit Intel Scalable-Prozessoren für 2019 sind auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>DEDIC.SH</b></a> verfügbar: <br><br><ul><li>  2x Xeon Silver 4214 - insgesamt 24 Kerne </li><li>  2x Xeon Gold 5218 - insgesamt 32 Kerne </li><li>  2x Xeon Gold 6240 - Konfiguration mit 36 ​​Kernen. </li></ul><br>  Die Kosten für einen Server mit zwei Xeon Silver 4214 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>ab 15210 Rubel / Monat</b></a> <br>  Wir sind auch bereit, <b>jede Konfiguration</b> für Sie zu sammeln - <b><a href="">schreiben Sie uns</a></b> ! <br><br>  Wenn keine großen Leistungen eines dedizierten Servers erforderlich sind - <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VDS ab 150 Rubel / Monat</a></b> ist das, was Sie brauchen! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456896/">https://habr.com/ru/post/de456896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456886/index.html">ASO-Checkliste: Wie man nichts verpasst</a></li>
<li><a href="../de456888/index.html">Wie Satelliten in der Erdatmosphäre schmelzen</a></li>
<li><a href="../de456890/index.html">IR-Fernbedienung auf stm32</a></li>
<li><a href="../de456892/index.html">So suchen Sie nach Schwachstellen in Webanwendungen: Vergleichen Sie acht gängige Scanner</a></li>
<li><a href="../de456894/index.html">Docker und Authentifizierung über Nginx</a></li>
<li><a href="../de456898/index.html">Schnelle ganzzahlige Multiplikation mit Tabellen</a></li>
<li><a href="../de456902/index.html">Sichere Push-Benachrichtigungen: von der Theorie zur Praxis</a></li>
<li><a href="../de456904/index.html">Lasttest eines Webprojekts - kein Geld</a></li>
<li><a href="../de456908/index.html">Wie Telegramm Sie zu Rostelecom zusammenführt</a></li>
<li><a href="../de456910/index.html">Internetprojekt security.txt - Kennenlernen einer anderen bekannten Datei</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>