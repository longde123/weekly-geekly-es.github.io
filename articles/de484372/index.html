<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîå üë©üèø‚Äç‚úàÔ∏è üòø Smart House mit Xiaomi am Beispiel einer Sauna üë®üèª‚Äç‚öïÔ∏è üåπ üö±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt im Internet eine ganze Reihe von Rezensionen und Videos √ºber den Bau von Smart Houses. Es gibt die Meinung, dass all dies ziemlich teuer und p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart House mit Xiaomi am Beispiel einer Sauna</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484372/">  Es gibt im Internet eine ganze Reihe von Rezensionen und Videos √ºber den Bau von Smart Houses.  Es gibt die Meinung, dass all dies ziemlich teuer und problematisch in der Organisation ist, das hei√üt im Allgemeinen das Schicksal von Geeks.  Aber der Fortschritt steht nicht still.  Ger√§te werden billiger und funktionsf√§higer, Design und Installation sind recht einfach.  Die Reviews konzentrieren sich jedoch haupts√§chlich auf 1-2 Anwendungsbeispiele, decken praktisch keine Nuancen ab und erstellen kein vollst√§ndiges Bild.  In diesem Artikel m√∂chte ich daher einen √úberblick √ºber das abgeschlossene Projekt geben und die Anwendungsf√§lle und Fallstricke aufzeigen, die beim Bau eines Smart Homes mit Xiaomi-Ger√§ten am Beispiel einer Sauna auftreten.  Die beschriebenen Ideen mit kleinen Abweichungen k√∂nnen auch auf die Automatisierung der Wohnung angewendet werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="Bild"></div><br><h2>  Hintergrund oder warum all dies notwendig ist </h2><br>  F√ºr den Anfang ein wenig Hintergrundwissen, damit der Kontext verstanden werden kann.  Im Fr√ºhherbst 2018 wurde die Sauna fertiggestellt und in Betrieb genommen.  Die Sauna ist eine eigenst√§ndige Kapitalstruktur mit ganzj√§hriger Heizung und Wasserversorgung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="Bild"></div><a name="habracut"></a><br>  Aus verst√§ndlichen Gr√ºnden lebt niemand dauerhaft im Badehaus und kontrolliert nicht den Zustand der R√§umlichkeiten.  So oft ich m√∂chte, ist der Besuch des Badehauses auch nicht sehr h√§ufig.  Dementsprechend waren von Anfang an √úberlegungen angestellt, ein "intelligentes" Bad zu schaffen.  Zun√§chst aus Sicherheitsgr√ºnden (Brand, √úberschwemmung, Zugangskontrolle).  Zum Beispiel ist das Ausschalten der Heizung bei -35 Grad drau√üen (ich wohne in Nowosibirsk) eine sehr gef√§hrliche Situation.  Im Gegensatz zum Haupthaus habe ich das Projekt der Badautomatisierung jedoch nicht von Anfang an √ºberlegt und keine zus√§tzliche Verkabelung an den richtigen Stellen vorgenommen.  Auf der anderen Seite wurde das Bad √ºber das Internet durchgef√ºhrt, und das Erscheinungsbild der beiden anderen Geb√§ude ist eine Video√ºberwachung (Sie k√∂nnen beurteilen, was visuell geschieht). <br><br>  Zur√ºck von einer Gesch√§ftsreise im November 2019, ging ich abends ins Badehaus, √∂ffnete die Haust√ºr und war schockiert von dem, was ich sah.  Die WiFi-Punkt-LEDs blinkten aus der Dunkelheit und ein Wasserstrahl lief mir √ºber die F√º√üe.  Es gab also √úberschwemmungen und die Stromversorgung wurde nicht unterbrochen.  Das Wasser im Badehaus wird mithilfe eines eigenen Brunnens, einer Tauchpumpe und eines Automatisierungssystems, das den Prozess steuert, organisiert.  Wie sich sp√§ter herausstellte, wurde eine der Armaturen in der Toilettenkreuzung abgerissen und alle R√§ume wurden √ºberflutet.  Ich habe nie herausgefunden, warum die Automatisierung mitf√ºhlend war und immer noch abgeschaltet war, aber sie schaffte es, 15 cm Wasser pro Quadratmeter 30 zu pumpen. Es war -14 Grad au√üerhalb dieses Tages.  Der warme Boden hielt die Raumtemperatur auf dem richtigen Niveau, aber es herrschte 100% Luftfeuchtigkeit.  Sie konnten sich nicht in die Organisation eines intelligenten Hauses einschleichen - Sie m√ºssen damit beginnen. <br><br><h2>  Ger√§teauswahl </h2><br>  W√§hrend des Baus des Haupthauses habe ich Erfahrungen mit Eldes-Ger√§ten gesammelt (die entsprechende Verkabelung wurde erstellt).  Ein Teil der Automatisierung erfolgt auf <a href="https://www.raspberrypi.org/">Raspberry PI</a> .  Ein weiterer Teil wird auf <a href="https://www.aqara.com/us/home.html">Xiaomi Aqara-Ger√§ten erstellt</a> .  Die Variante mit Raspberry PI hat mir am besten gefallen und ich habe sie anfangs f√ºr das Bad in Betracht gezogen.  Leider erfordert die Organisation viel mehr Aufwand.  Es ist schlie√ülich kein Plug-and-Play-Ger√§t - von √úbungen mit Eisen bis zum Schreiben von Software f√ºr Ihre eigenen Bed√ºrfnisse.  Aus bestimmten Gr√ºnden war MajorDoMo damit nicht zufrieden.  Das √úberqueren von Himbeer-PI, ZigBee-Adapter (um drahtlose Xiaomi-Sensoren zu verwenden) und Apple HomeKit erforderte das Erlernen (und die Apple HomeKit-Benutzeroberfl√§che ist im Moment nicht sehr zufrieden).  Es gab nicht viel Zeit (ich wollte nicht, dass sich die Situation wiederholt) und es gab keine Verkabelung f√ºr jeden erforderlichen Punkt, sodass ich mich entschied, alles auf Xiaomi-Ger√§ten zu tun. <br><br>  Das Hauptger√§t in dieser Situation ist der Hub.  Bei Xiaomi gibt es zwei Versionen des Hubs: Xiaomi Mi Smart Home Gateway 2 und Xiaomi Aqara Gateway.  Letzteres ist etwa doppelt so teuer, eher f√ºr den lokalen Markt geeignet und in der Lage, Ger√§te in Apple HomeKit zu integrieren.  Wenn Sie jedoch die Aqara Home-Anwendung installieren und die Region "Russland" ausw√§hlen, sind zum Zeitpunkt des Schreibens dieser Zeilen nur 13 verschiedene Ger√§te (Schalter, Steckdosen, Sensoren) verf√ºgbar.  Wenn Sie die Anwendung Xiaomi Home installieren, w√§hlen Sie die Region "China Mainland" aus, dann stehen Hunderte von Ger√§ten f√ºr die Verbindung zur Verf√ºgung.  Wenn Sie jedoch die Region "China Mainland" ausw√§hlen, k√∂nnen Sie die europ√§ische Steckdose nicht anschlie√üen und umgekehrt.  Die Auswahl der Region "China Mainland" in der Anwendung "Aqara Home" gibt nicht die Vollst√§ndigkeit der Ger√§te wieder, die in Xiaomi Home mit derselben Region vorhanden sind.  Aus Angst vor Inkompatibilit√§ten entschied ich mich, am Xiaomi Mi Smart Home Gateway 2-Hub anzuhalten.  Der Hub selbst ist √ºbrigens eine Lampe - dies kann bei der Installation ber√ºcksichtigt werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="Bild"></div><br>  Eine andere interessante Frage ist, wie lange dies noch funktionieren wird.  Es geht nicht einmal um Sensoren und Batterien, sondern um die Synchronisierung und Speicherung von Daten in der Cloud.  Im Moment ist das Konto kostenlos.  Alle Informationen werden auf Xiaomi-Servern gespeichert.  Wenn die Jungs morgen beschlie√üen, dass Benutzer aus Russland keine Daten in der Region "China Mainland" oder Roskomnadzor speichern sollen, werden aus irgendeinem Grund ihre Server verbannt, das ganze Smart House l√§uft Gefahr, sich in einen K√ºrbis zu verwandeln.  Ich habe selbst entschieden, dass in diesem Fall die Sensoren erhalten bleiben und der Hub durch den Raspberri PI + ZigBee Adapter ersetzt wird. <br><br><h2>  Leckagen √ºberwachen und verhindern </h2><br>  Das erste und wichtigste Automatisierungsszenario war eine nat√ºrliche Fortsetzung des Problems: Wenn ein Leck auftritt, muss die Wasserversorgung, dh die Pumpe, ausgeschaltet und ein Problemalarm an das Telefon gesendet werden.  Es gab zwei potenziell gef√§hrliche Leckstellen. <br><br>  F√ºr dieses Szenario waren neben dem Hub zwei Lecksucher und eine intelligente Wandsteckdose erforderlich.  Lecksensoren sind autonom und werden mit Batterien betrieben.  Der Hersteller gibt an, dass eine Batterie f√ºr 2 Jahre ausreicht. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="Bild"></div><br>  Die Installation einer intelligenten Steckdose war etwas kompliziert, da Sie unter den chinesischen Steckdosen quadratische Steckdosen ben√∂tigen, die nicht in unseren regul√§ren Gesch√§ften erh√§ltlich sind (aber Sie k√∂nnen sie auf Bestellung mitbringen). <br><br>  Quadratische L√∂cher zu bohren ist immer noch ein Vergn√ºgen.  Au√üerdem brauchen Sie auf eine gute Weise einen Adapter, obwohl es auch eine Steckdose f√ºr den europ√§ischen Stecker gibt.  Die Aqara-Version f√ºr den lokalen Markt verf√ºgt derzeit nicht √ºber eine Wandsteckdose, die uns an die Region "China Mainland" bindet.  Alternativ k√∂nnen Sie eine normale Wandsteckdose installieren und eine intelligente Xiaomi-Steckdose anschlie√üen. Hierf√ºr sind jedoch zwei zus√§tzliche Adapter erforderlich.  Eine andere Alternative war eine Staffel.  Aber ich blieb an einer Wandsteckdose stehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="Bild"></div><br>  In der Xiaomi Home App wurden ein Sockel und ein Sensor hinzugef√ºgt.  Als n√§chstes wird ein Szenario f√ºr den Fall eines Lecks f√ºr zwei Aktionen geschrieben: Ausschalten des Sockets und Senden einer Warnung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="Bild"></div><br>  Der erste Lecksensor wurde neben der Pumpe (und tats√§chlich neben der Nabe) installiert.  F√ºr den Test wurde Wasser in eine kleine Platte gegossen und der Sensor hineingesenkt.  Ich habe die gesamte Aktion direkt an dem Ort durchgef√ºhrt, an dem der Sensor installiert war, um die Situation so realit√§tsnah wie m√∂glich zu gestalten.  Der Test war erfolgreich: Die Steckdose wurde getrennt, der Alarm ert√∂nte am Telefon, und der Hub-Notfallmodus blinkte. <br><br>  Der zweite Lecksucher sollte in der Toilette in der N√§he der Rohrverbindung installiert werden.  Aber mit seiner Installation gab es Nuancen - die Nabe sah den Sensor nicht, obwohl der Abstand klein war.  Der Fehler war die Konfiguration der R√§umlichkeiten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="Bild"></div><br>  Zwischen dem Aufstellungsort der Nabe (Ruheraum) und dem Aufstellungsort des zweiten Leckagesensors (Toilette) befand sich ein Dampfbad.  In den besten Traditionen wurde das Dampfbad in einen Folienkreis eingen√§ht, was Probleme mit der Signal√ºbertragung verursachte. <br><br>  Der Hersteller behauptet, dass die Ger√§te ein Mesh-Netzwerk bilden k√∂nnen, dh ein Ger√§t kann Daten √ºber ein anderes Ger√§t an den Hub √ºbertragen.  Ich habe irgendwo die Information gesehen, dass nur Ger√§te, die mit dem Netzwerk verbunden sind (und nicht mit Batterie betrieben werden), als solche Sender im Mesh-Netzwerk fungieren k√∂nnen.  Es hat mir jedoch gereicht, einen Temperatursensor in der Ecke des Waschraums anzubringen, damit das Signal vom Lecksensor nicht mehr verloren geht.  M√∂glicherweise ist dies ein Zufall, da unter der Decke im Waschraum ein Relais zur Steuerung der Stra√üenbeleuchtung installiert wurde (m√∂glicherweise fungiert es als Sender im Maschennetz).  Das Problem mit dem Signalverlust vom Lecksucher in der Toilette wurde jedoch behoben.  Zus√§tzlich kann die Verbindung des Instruments zum Hub √ºberpr√ºft werden, indem der Sensor zentral gedr√ºckt wird.  Wenn alles in Ordnung ist, h√∂ren Sie die Informationen vom Hub in reinem Chinesisch (im Fall des Aqara-Hubs erfolgt die Kommunikation in angenehmem Englisch). <br><br>  Eine √úberpr√ºfung, ob die Stromversorgung √ºber das Ger√§t unterbrochen und dann eingeschaltet wurde, zeigt, dass die Smart-Steckdose ausgeht.  Es gibt eine geeignete Einstellung, die beim Einschalten des Ger√§ts aktiviert wird: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="Bild"></div><br>  Ein zus√§tzliches Zeichen f√ºr eine √úberschwemmung war eine Erh√∂hung der Luftfeuchtigkeit auf 100%.  Weitere Informationen zum Steuern dieses Zeichens finden Sie im n√§chsten Abschnitt. <br><br><h2>  Rauch- und Temperaturkontrolle </h2><br>  Eine Sauna ist ein feuergef√§hrlicher Raum. Das n√§chste Szenario bestand darin, die Feuerzeichen zu bestimmen.  F√ºr dieses Szenario waren zwei Temperatur- (und Feuchtigkeits-) und Rauchmelder erforderlich. <br><br>  Der Rauchmelder wurde an der Flurdecke im Waschraum montiert (tats√§chlich in der N√§he des Ofens und des Dampfraumausgangs).  Au√üerdem wurde der Xiaomi Home-Anwendung ein Ger√§t hinzugef√ºgt und ein Skript f√ºr den Fall der Raucherkennung erstellt, gefolgt von einer Benachrichtigung des Telefons.  Der Test wurde mit einem Kaminstreichholz durchgef√ºhrt.  Der Sensor hat den Test erfolgreich bestanden.  Der Hub hat den Alarm eingefroren und ein akustischer Alarm war aktiv.  Der Sensor selbst war auch sehr unangenehm und piepste laut und warnte vor einem Problem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="Bild"></div><br>  Ein weiteres Anzeichen f√ºr ein Feuer ist ein Temperaturanstieg.  Zwei Sensoren wurden installiert, um die Temperatur zu √ºberwachen: einer im Pausenraum und der andere im Waschraum.  Als n√§chstes wurde in der Anwendung ein Szenario "Bei Temperatur √ºber dem Sollwert" mit einer entsprechenden Benachrichtigung auf dem Telefon eingerichtet.  Im Moment habe ich die Ausl√∂seschwelle f√ºr die Toilette auf 30 Grad eingestellt (im Sommer muss sie wahrscheinlich neu konfiguriert werden). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="Bild"></div><br>  Au√üerdem wurde das Szenario "Bei Temperatur unter einer Voreinstellung" mit einer Ausl√∂seschwelle von 18 Grad und einer Warnung am Telefon konfiguriert.  Wenn aus irgendeinem Grund die Heizung nicht mehr funktioniert, m√∂chte ich so schnell wie m√∂glich dar√ºber informiert werden.  In √§hnlicher Weise wurden f√ºr beide Sensoren Szenarien f√ºr den Fall eines Feuchtigkeitsanstiegs mit einer Ausl√∂seschwelle von 70%, einer Warnung am Telefon und dem Abschalten der Wasserpumpe erstellt. <br><br>  Ausgehend von den tollen Vorteilen f√ºr Temperatur- und Feuchtigkeitssensoren stehen in der Anwendung historische Grafiken zur Verf√ºgung.  Sie k√∂nnen beispielsweise bestimmen, zu welchem ‚Äã‚ÄãZeitpunkt das Bad f√ºr den vorgesehenen Zweck verwendet wurde (Temperaturspitzen in der folgenden Grafik) oder vergleichen, ob die aktuelle Temperatur abnormal ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="Bild"></div><br><h2>  L√ºftungssteuerung </h2><br>  Das Dampfbad hat eine Dunstabzugshaube.  Nach Abschluss der Prozeduren ist es w√ºnschenswert, den Raum zu l√ºften.  Die Beatmung wird √ºber einen Schl√ºsselschalter eingeschaltet und die Beatmung selbst dauert mindestens 30 Minuten.  Oft endet die Sauna jedoch in der ersten oder zweiten Stunde der Nacht.  Es ist nicht immer m√∂glich, alles im Voraus zu erledigen und nach weiteren 30 Minuten auf die Bel√ºftung des Dampfbades zu warten - das Vergn√ºgen ist unterdurchschnittlich, weil Sie schon schlafen m√∂chten. <br><br>  F√ºr dieses Szenario ben√∂tigten wir einen Schl√ºsselschalter von Xiaomi mit Nullleitungs- und Wandmontage.  Der Preis der Frage betr√§gt ca. 1900 p.  Switches sind in der Version von Aqara f√ºr den lokalen Markt erh√§ltlich. <br><br>  In meinem Fall k√∂nnen Sie einen normalen Schalter nicht einfach durch einen intelligenten ersetzen - eine Stromleitung ist erforderlich.  Dementsprechend war es notwendig, eine Nulllinie zur Einbau√∂ffnung f√ºr den Schalter zu ziehen, dies war eine gute Gelegenheit.  Bei einem Leistungsschalter ohne Nullleitung w√§re die Installation einfacher gewesen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="Bild"></div><br>  Nach der Installation wurde der Smart Switch der Anwendung als Ger√§t hinzugef√ºgt und die Leistung getestet.  Die Schaltereinstellungen haben einen Timer und Sie k√∂nnen die Ausschaltzeit einstellen.  Das hei√üt, der Ausschalt-Timer ist jetzt auf eine zus√§tzliche 30-min√ºtige Bel√ºftung eingestellt, bevor Sie die Sauna verlassen, und Sie k√∂nnen in Ruhe ins Bett gehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="Bild"></div><br>  Eine andere Option ist m√∂glich, um den Prozess zu automatisieren.  Nach Abschluss des Badevorgangs √∂ffnet sich die T√ºr zum Dampfbad zus√§tzlich zur Bel√ºftung vollst√§ndig.  Dies f√ºhrt zu einem Temperaturanstieg im Waschraum, in dem ein Temperatursensor installiert ist.  Auf der Grundlage dieser Sensorwerte k√∂nnen Ein / Aus-L√ºftungsszenarien erstellt werden.  Aber ich habe diese Option noch nicht ausgef√ºhrt.  Au√üerdem k√∂nnten Sie mit dem Sensor zum √ñffnen der T√ºr zum Dampfbad experimentieren.  Aber ich f√ºrchte, es wird schnell absterben oder abfallen, weil die T√ºr aus Glas ist und das Dampfbad 120 Grad haben kann. <br><br><h2>  Kontrolle der Stra√üenbeleuchtung </h2><br>  Eine weitere Aufgabe, die wir automatisieren wollten, war die Steuerung der Stra√üenbeleuchtung auf der Veranda.  Eines der typischen Szenarien ist das Einschalten des Lichts auf der Veranda, wenn Sie nicht weit vom Geb√§ude entfernt sind und es drau√üen dunkel ist.  Die Sauna ist abgeschlossen, der Schalter f√ºr die Stra√üenbeleuchtung befindet sich im Raum.  Sie mussten dem Schl√ºssel folgen, um die T√ºr zu √∂ffnen und das Licht einzuschalten.  Das Ausschalten der Lichter erforderte eine √§hnliche Prozedur.  Ein weiteres Szenario, das regelm√§√üig auftrat, war das Ein- und Ausschalten der Lichter auf der Veranda, wenn Sie sich im Haupthaus befanden.  Ich verga√ü oft, das Licht auf der Veranda auszuschalten, als ich die Sauna verlie√ü und feststellte, dass ich bereits im Haus war: Entweder durch das Fenster schauen oder durch einen Blick auf die √úberwachungskameras.  In diesem Moment z√∂gerte ich normalerweise, irgendwohin zu gehen, sodass die Lichter die ganze Nacht brannten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="Bild"></div><br>  Zur Umsetzung dieser Idee wurde ein zweikanaliges Relais angeschafft.  Der Preis der Frage betr√§gt ca. 2000 p.  In der Version von Aqara gibt es derzeit keine Relais f√ºr den lokalen Markt.  Sie kann jedoch durch einen Schl√ºsselschalter ersetzt werden (der Einbau in den Verteilerkasten ist nat√ºrlich schwieriger). <br><br>  Urspr√ºnglich sollte ich das Relais hinter dem Schl√ºsselschalter montieren, aber es war sehr schwierig, die Stromleitung zu erreichen (das Relais ben√∂tigt wieder Strom).  Der ideale Ort ist der Verteilerkasten, an dem die Stromleitung, die Leitung vom Leistungsschalter und die Leitung von den Stra√üenlaternen zusammenlaufen.  Es befand sich unter einer Zwischendecke und musste einige der Schienen abbauen.  Es war w√ºnschenswert, √ºber diesen Punkt im Voraus nachzudenken.  Die Installation war jedoch erfolgreich.  Der Schaltplan ist wesentlich komplizierter als f√ºr Steckdosen und Schalter (in meinem Fall vier 3-adrige Kabel und 8 Klemmen am Relais selbst).  Um es nicht im Kopf zu behalten und nichts durcheinander zu bringen, habe ich den Schaltplan vor der Montage auf Papier gemalt.  Als n√§chstes habe ich eine Probemontage durchgef√ºhrt, um alles zu √ºberpr√ºfen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="Bild"></div><br>  Das Ger√§t wurde in die Anwendung eingesteckt und die Testphase gestartet.  Die Stra√üenbeleuchtung musste sowohl mit dem vorherigen Schl√ºsselschalter als auch mit der Anwendung ein- und ausgeschaltet werden.  Es gibt zwei Stra√üenlaternen, eine links und eine rechts.  Das Relais hat zwei Kan√§le, aber es machte keinen Sinn, sie separat einzuschalten.  Andererseits wollten Sie sie auch nicht abwechselnd mit zwei Klicks in der Anwendung aktivieren.  Die Steuerung erfolgte also auf einem Kanal des Relais.  Durch einen seltsamen Zufall funktionierte diese Option nicht normal - es gab ein Feststecken in der einen oder anderen Position.  F√ºr Experimente blieb keine Zeit, denn der helle Tag war vorbei und wir wollten das Auto hinten an der Decke montieren.  Also habe ich einfach die Laternen parallel zu beiden Kan√§len eingehakt und alles hat wie gew√ºnscht funktioniert.  Damit der physische Switch und der Software-Switch als Gateway-Switch funktionieren, wurde die Option Interlock in den Relais-Einstellungen aktiviert. <br><br>  Es w√§re auch m√∂glich, das Ein- und Ausschalten von Lichtern per Timer zu organisieren.  Dieses Szenario war aber noch nicht interessant. <br><br><h2>  Raumzugangskontrolle </h2><br>  Ein weiterer merkw√ºrdiger Moment war die Kontrolle √ºber das √ñffnen der Stra√üent√ºr.  Zuallererst, um festzustellen und zu benachrichtigen, dass jemand genau diese T√ºr vergessen hat, die normalerweise zugeschlagen wurde oder sie √ºberhaupt offen gelassen hat. <br><br>  F√ºr dieses Szenario war ein Fenster- / T√ºr√∂ffnungssensor erforderlich.  Der Preis der Frage betr√§gt ca. 1000 p.  Es gibt Sensoren in der Aqara-Version f√ºr den lokalen Markt (sie haben weniger abgerundete Kanten). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="Bild"></div><br>  Die Installation ist sehr einfach - die Sensoren werden auf doppelseitigem Klebeband montiert.  Vor der Montage ist es besser, den Sensor in der Anwendung anzuschlie√üen, um zu sehen, in welcher Entfernung der Sensor ausgel√∂st wird.  Die Anweisungen sagen bis zu 20 mm Abstand aus, aber das ist nicht das Geringste - der Sensor und der Reaktionsmagnet m√ºssen fast eng beieinander montiert werden.  Im Haupthaus hat das Garagentor einen √§hnlichen Sensor.  Zwischen der F√ºhrungsschiene und der T√ºr befindet sich eine 1 cm breite Dichtung.  In dieser Entfernung zeigte der Sensor eine "offene" Position und der Ansprechmagnet musste erh√∂ht werden. <br><br>  Sobald der App ein neues Ger√§t hinzugef√ºgt wurde, k√∂nnen Sie mit der Automatisierung fortfahren.  Konfigurieren Sie das Szenario "Wenn die T√ºr l√§nger als 1 Minute ge√∂ffnet ist" mit einem Alarm am Telefon.  In der englischen Lokalisierung k√∂nnen Sie den Teil der Phrase ungef√§hr 1 Minute nicht sehen, aber die Schwelle f√ºr das Ausl√∂sen ist diese.  In der Variante des Aqara-Sensors und der Aqara Home-Anwendung k√∂nnen Sie andere Ausl√∂seintervalle konfigurieren.  In der Xiaomi Home-Anwendung ist dies leider noch nicht m√∂glich.  Die Praxis hat jedoch gezeigt, dass das Intervall von 1 Minute mehr als ausreichend ist - es gibt keine Fehlalarme, alle Alarme waren auf dem Fall.  Sie k√∂nnen die Protokolle auch nach Sensoren anzeigen.  Auch dieser Sensor ist keine Ausnahme.  Sie k√∂nnen beispielsweise anhand des Protokolls bestimmen, wann das Bad kam (erstmaliges √ñffnen der T√ºr an einem bestimmten Tag) und wann es ging (letztes Schlie√üen der T√ºr), um so die Gesamtzeit zu sch√§tzen, die im Raum verbracht wurde. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="Bild"></div><br><h2>  Eindr√ºcke von der Verwendung </h2><br>  Die allgemeinen Erfahrungen mit der Ausbeutung sind rein positiv.  Nat√ºrlich gibt es einige kleine Nuancen, aber das Hauptziel der Automatisierung wird erreicht.  Zuallererst ist es eine psychologische Beruhigung, die durch Testergebnisse best√§tigt wird.  Ebenfalls wichtig und komfortabel - Fernsteuerung der Stra√üenbeleuchtung, Dunstabzugshaube erhalten wurde, gibt es ein zus√§tzliches Nachtlicht.  Nach dem Urlaub kann man sich erinnern und das Wasser aus der Ferne abschalten. <br><br>  Die Kosten aller oben genannten Ger√§te in ungef√§hrer Form (ohne Bezugnahme auf ein bestimmtes Gesch√§ft) sind nachstehend aufgef√ºhrt.  Bei der Bestellung mit AliExpress unterscheiden sich die Preise in eine kleinere Richtung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="Bild"></div><br>  Bei der Auswahl eines Ger√§tesatzes m√ºssen Sie die Kompatibilit√§t ber√ºcksichtigen (f√ºr welche Region das Ger√§t hergestellt wurde und zu welcher Familie es geh√∂rt).  Es ist nicht m√∂glich, innerhalb der Anwendung ein Szenario zu erstellen, das beispielsweise eine Steckdose f√ºr eine europ√§ische Region gem√§√ü einem Rauchalarmereignis (f√ºr die Region China Mainland) steuert.  Wenn Sie keinen exotischen Rauchsensortyp ben√∂tigen, schauen Sie sich besser die Aqara-Ger√§te f√ºr den lokalen Markt an.  Immerhin kann das Relais beispielsweise durch einen Zweitastenschalter ersetzt werden.  Einige Gesch√§fte, die Xiaomi-Ger√§te verkaufen, scheinen diese in Grau zu importieren (diese Ger√§te sind f√ºr die chinesische Region bestimmt).  Aber zum Beispiel, Svyaznoy, gibt es Ger√§te f√ºr unseren Markt.  Neben der Kompatibilit√§t der gleichen Steckdosen werden auch Anweisungen in Englisch und Russisch angeboten.  Unten sehen Sie Fotos von zwei identischen Sensoren, jedoch f√ºr verschiedene Regionen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="Bild"></div><br>  Die Reaktionsf√§higkeit der Steuerung durch eine Anwendung ist nicht immer gut.  Manchmal kann es beispielsweise vorkommen, dass Sie den Fehler "Anfrage fehlgeschlagen" erhalten, anstatt das Licht nacheinander einzuschalten.  Eine experimentell entdeckte Behandlung - das Entladen der Anwendung aus dem Speicher und der Neustart - l√∂st dieses Problem schneller, als beim n√§chsten Versuch auf eine Antwort zu warten.  Manchmal treten auch Verz√∂gerungen auf (bis zu 20-30 Sekunden), wenn der Status eines bestimmten Sensors aktualisiert wird.  In diesen Momenten ist es besser, die Ein / Aus-Tasten nicht erneut zu dr√ºcken, sondern einfach auf die Statusaktualisierung zu warten.  In einigen Situationen wird beim Starten der Anwendung m√∂glicherweise eine leere Liste anstelle der Ger√§teliste angezeigt.  Es besteht kein Grund zur Panik - es erscheint normalerweise innerhalb der n√§chsten Sekunden.  Benachrichtigungen an das Telefon werden nicht lokalisiert und speichern die korrekte Benennung der Ereignisse.  Dar√ºber hinaus nutzen die Autoren der Anwendung regelm√§√üig den Push-Alert-Kanal f√ºr Werbezwecke (erneut auf Chinesisch).  Nat√ºrlich gef√§llt es mir nicht, aber ich habe nicht viel Auswahl. <br><br>  Ich hoffe, dieser Artikel hat dazu beigetragen, einen guten √úberblick √ºber die Funktionen einer Reihe von Xiaomi-Ger√§ten zum Erstellen eines Smart Homes und √ºber Szenarien f√ºr deren praktische Anwendung zu erhalten.  Wenn Sie noch Fragen, Korrekturen und Erg√§nzungen haben, werde ich diese gerne in Kommentaren besprechen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de484372/">https://habr.com/ru/post/de484372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de484344/index.html">Drei Ebenen der automatischen Skalierung in Kubernetes: wie man sie effektiv nutzt</a></li>
<li><a href="../de484356/index.html">Ein interessantes Projekt in einem freundlichen Team, oder wie viel kostet der richtige Mitarbeiter?</a></li>
<li><a href="../de484358/index.html">Portfoliomanagement in R</a></li>
<li><a href="../de484364/index.html">Mit 26 Jahren leitet Yana Harlan die Entwicklung einer Raumfahrtmaschine. N√§chstes Jahr planen sie den Start.</a></li>
<li><a href="../de484370/index.html">Slurm SRE - lernen, die Zufriedenheit der Benutzer zu gew√§hrleisten</a></li>
<li><a href="../de484374/index.html">Reise in die Mitte ... Hafenarbeiter Bild. Oder wie man ein Bild aus der Registrierung ohne Andockfenster herunterl√§dt</a></li>
<li><a href="../de484376/index.html">Samsung Moskauer Zentrum f√ºr K√ºnstliche Intelligenz in Mitarbeitergeschichten</a></li>
<li><a href="../de484378/index.html">SwayWM - UnixPorn Yourself</a></li>
<li><a href="../de484380/index.html">Umzug - das letzte Jahrhundert! Alternativen zu std :: move in ‚ÄûC ++ der Zukunft‚Äú</a></li>
<li><a href="../de484382/index.html">Bellman-Ford-Algorithmus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>