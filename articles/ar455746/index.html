<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ๐พ ๐ฉ๐พโ๐คโ๐ฉ๐ป ๐ Celesta 7.x: ORM ุ ุงูุชุฑุญูู ูุงูุงุฎุชุจุงุฑ "ูู ุญุฒูุฉ ูุงุญุฏุฉ" ๐ โ๐ฝ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฑุจูุง ููุช ุชุนุฑู ุจุงููุนู ุดูุฆุง ุนู ููุชุจุฉ ุณูููุณุชุง ููุชูุญุฉ ุงููุตุฏุฑ. ุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ููุฐุง ูุง ููู ุ ุงูุขู ุณูุฎุจุฑู ุจูู ุดูุก. ุจุนุฏ ูุฑูุฑ ุนุงู ุขุฎุฑ ุ ุชู ุฅุตุฏุงุฑ ุงูุฅุตุฏ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Celesta 7.x: ORM ุ ุงูุชุฑุญูู ูุงูุงุฎุชุจุงุฑ "ูู ุญุฒูุฉ ูุงุญุฏุฉ"</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455746/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุฑุจูุง ููุช ุชุนุฑู ุจุงููุนู ุดูุฆุง ุนู ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณูููุณุชุง</a> ููุชูุญุฉ ุงููุตุฏุฑ.  ุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ููุฐุง ูุง ููู ุ ุงูุขู ุณูุฎุจุฑู ุจูู ุดูุก.  ุจุนุฏ ูุฑูุฑ ุนุงู ุขุฎุฑ ุ ุชู ุฅุตุฏุงุฑ ุงูุฅุตุฏุงุฑ 7.x ูุชุบููุฑ ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุ ููุฏ ุญุงู ุงูููุช ูุชูุฎูุต ุงูุชุบููุฑุงุช ุ ููู ุงูููุช ููุณู ูุชุฐููุฑ ูุงููุฉ Celesta ุจุดูู ุนุงู. </p><br><div style="text-align:center;;text-align:right;direction:rtl"><img width="350" src="https://habrastorage.org/webt/jj/7z/jt/jj7zjthmrh2dhdo4v0ueefqj6uq.png"></div><a name="habracut"></a><br><p style=";text-align:right;direction:rtl"> ุฅุฐุง ูู ุชูู ูุฏ ุณูุนุช ุฃู ุดูุก ุนู Celesta ุจุนุฏ ุ ูุนูุฏ ูุฑุงุกุฉ ูุฐุง ุงูููุงู ุงูุฐู ุชุฑูุฏ ุฃู ุชุนุฑูู ุนู ุงูููุงู ุงูุชุฌุงุฑูุฉ ุงูุชู ูููู ุชุทุจูููุง ุฃูุซุฑ ูุงุนููุฉ ุ ูููููู ุฃู ุฃูุตู ุจุงูุฌุฒุก ุงูุฃูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุดูุฑ ุงููุฏูู</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุทุน ุงูููุฏูู</a> ูุฐุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏุฉ ูุตู ุณุงุนุฉ</a> (ุจุงุณุชุซูุงุก ุงููููุงุช ุญูู ุงุณุชุฎุฏุงู ูุบุฉ Python).  ููู ุงูุฃูุถู ูู ุฐูู ุ ุงูุฑุฃ ูุฐุง ุงูููุงู ุฃููุงู.  ุณุฃุจุฏุฃ ุจุงูุชุบููุฑุงุช ุงูุชู ุญุฏุซุช ูู ุงูุฅุตุฏุงุฑ 7 ุ ุซู ุณุฃุชุนุฑู ุนูู ูุซุงู ุชููู ูุงูู ูุงุณุชุฎุฏุงู ุงูุฅุตุฏุงุฑ ุงูุญุฏูุซ ูู Celesta ููุชุงุจุฉ ุฎุฏูุฉ ุฎูููุฉ ุตุบูุฑุฉ ูุชุทุจูู Java ุจุงุณุชุฎุฏุงู Spring Boot. </p><br><h2 id="chto-izmenilos-v-versii-7x" style=";text-align:right;direction:rtl">  ูุง ุงูุฐู ุชุบูุฑ ูู ุงูุฅุตุฏุงุฑ 7.xุ </h2><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฑูุถูุง ุงุณุชุฎุฏุงู Jython ููุบุฉ ูุถูููุฉ ูู Celesta.  ุฅุฐุง ุจุฏุฃูุง ูู ููุช ุณุงุจู ุงูุญุฏูุซ ุนู Celesta ูุน ุญูููุฉ ุฃู ููุทู ุงูุนูู ููุชูุจ ูู Python ุ ุงูุขู ... ูููู ูุฃู ูุบุฉ Java ุฃู ุชููู ูุบุฉ ููุทู ุงูุนูู: Java ุ Groovy ุ JRuby ุฃู Jython ููุณูุง.  ุงูุขู ูุง ูุณุชุฎุฏู Celesta ุฑูุฒ ููุทู ุงูุฃุนูุงู ุ ูููู ุฑูุฒ ููุทู ุงูุนูู ูุณุชุฎุฏู Celesta ููุฆุงุช ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู ุจุงุนุชุจุงุฑูุง ููุชุจุฉ Java ุงูุฃูุซุฑ ุดููุนูุง.  ูุนู ุ ุชู ุงูุชูุงู ุงูุชูุงูู ุงูุณุงุจู ุจุณุจุจ ูุฐุง ุ ูููู ูุฐุง ูู ุงูุซูู ุงูุฐู ููุง ูุณุชุนุฏูู ูุฏูุนู.  ูุณูุก ุงูุญุธ ุ ููุฏ ุฑูุงููุง ุนูู ุฌูุซูู.  ุนูุฏูุง ุจุฏุฃูุง ุงุณุชุฎุฏุงู Jython ูุจู ุจุถุน ุณููุงุช ุ ูุงู ูุดุฑูุนูุง ุญููููุง ูุงุนุฏูุง ุ ูููู ุนูู ูุฑ ุงูุณููู ุชุจุงุทุฃ ุชุทููุฑู ุ ุชุฑุงููุช ุงููุชุฑุงููุฉ ูู ููุงุตูุงุช ุงููุบุฉ ุ ููู ูุชู ุญู ูุดุงูู ุงูุชูุงูู ููุนุธู ููุชุจุงุช ุงูุจุฑุงูุฌ.  ุงููุดุฉ ุงูุฃุฎูุฑุฉ ูุงูุช ุงูุฃุฎุทุงุก ุงูุฌุฏูุฏุฉ ูู ุฃุญุฏุซ ุฅุตุฏุงุฑุงุช ุงููุบุงุช ุ ูุงูุชู ุชุฌูู ุนูุฏ ุงูุนูู ุนูู ุญูู ุงูุฅูุชุงุฌ.  ูุญู ุฃููุณูุง ูุง ูููู ุงูููุงุฑุฏ ุงููุงุฒูุฉ ูุฏุนู ูุดุฑูุน ุฌูุซูู ุ ููุฑุฑูุง ุงูุงููุตุงู ุนูู.  ูู ูุนุฏ ุณูููุณุชุง ูุนุชูุฏ ุนูู ุฌูุซูู. </li><li style=";text-align:right;direction:rtl">  ูุชู ุงูุขู ุฅูุดุงุก ูุฆุงุช ุงููุตูู ุฅูู ุงูุจูุงูุงุช ูู ูุบุฉ Java (ูููุณ ุจูุซูู ุ ููุง ูุงู ูู ูุจู) ุจุงุณุชุฎุฏุงู ุงูููููู ุงูุฅุถุงูู Maven.  ููุธุฑูุง ูุฃููุง ุงูุชูููุง ูู ุงููุชุงุจุฉ ุงูุฏููุงููููุฉ ุฅูู ุงููุชุงุจุฉ ุงูุซุงุจุชุฉ ุจุณุจุจ ูุฐุง ุ ููุฏ ูุงูุช ููุงู ูุฑุต ุฃูุซุฑ ูุฅุนุงุฏุฉ ุจูุงุก ุงููุณุงูู ูุฃุตุจุญ ูู ุงูุณูู ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุตุญูุญุฉ ุงูุฐุงุชูุฉ. </li><li style=";text-align:right;direction:rtl">  ุธูุฑุช ุงูุฅุถุงูุฉ ูู JUnit5 ุ ูุฐุง ุฃุตุจุญ ูู ุงูููุงุณุจ ููุบุงูุฉ ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ุงูููุทู ุงูุชู ุชุนูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู JUnit5 (ูุงูุชู ุณูุชู ููุงูุดุชูุง ูุงุญููุง). </li><li style=";text-align:right;direction:rtl">  ููุฏ ุธูุฑ ูุดุฑูุน ูููุตู ุ ููู ูุตู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุจูุน-ุจุฏุงูุฉ ุงูุญุฐุงุก-celesta</a> ุ ูุงูุฐู ุ ููุง ููุญู ุงูุงุณู ุ ูู ุจุฏุงูุฉ Celesta ูู Spring Boot.  ุชุนูุถ ุงููุฏุฑุฉ ุนูู ุญุฒู ุชุทุจููุงุช Celesta ูู ุฎุฏูุงุช Spring Boot ุงููุงุจูุฉ ูููุดุฑ ุจุณูููุฉ ุนู ููุฏุงู ุงููุฏุฑุฉ ุนูู ุชุญุฏูุซ ุงูุชุทุจูู ุนูู ุงูุฎุงุฏู ุนู ุทุฑูู ุชุบููุฑ ุงููุฌูุฏ ุจุจุณุงุทุฉ ุจุงุณุชุฎุฏุงู ุงูุจุฑุงูุฌ ุงููุตูุฉ Python. </li><li style=";text-align:right;direction:rtl">  ูููุง ุจููู ุฌููุน ุงููุซุงุฆู ูู ูููู ุฅูู ุชูุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">AsciiDoctor</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุถุนูุงูุง</a> ูู ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ุฌูุจุง ุฅูู ุฌูุจ ูุน ุงูููุฏ ุ ูุงูุขู ูุฏููุง ูุซุงุฆู ุญุฏูุซุฉ ููู ุฅุตุฏุงุฑ ูู ุฅุตุฏุงุฑุงุช Celesta.  ููุญุตูู ุนูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ุ ุชุชููุฑ ุงููุซุงุฆู ุนุจุฑ ุงูุฅูุชุฑูุช ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://courseorchestra.github.io/celesta/</a> </li><li style=";text-align:right;direction:rtl">  ููุฏ ุณุฆููุง ูุซูุฑูุง ูุง ุฅุฐุง ูุงู ูู ุงููููู ุงุณุชุฎุฏุงู ุชุฑุญูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DDL idempotent</a> ุจุดูู ูููุตู ุนู Celesta.  ุงูุขู ููุงู ูุซู ูุฐู ุงููุฑุตุฉ ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">2bass</a> . </li></ol><br><h2 id="chto-takoe-selesta-i-chto-ona-umeet" style=";text-align:right;direction:rtl">  ูุง ูู ุณูููุณุชุง ููุงุฐุง ูููููุง ุฃู ุชูุนูุ </h2><br><p style=";text-align:right;direction:rtl">  ุจุงุฎุชุตุงุฑ ุ ุณูููุณุชุง ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุทุจูุฉ ูุณูุทุฉ ุจูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ ูุฑูุฒ ููุทู ุงูุฃุนูุงู ุ ุงุณุชูุงุฏูุง ุฅูู ููุฌ ุชุตููู <em>ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฃููู</em> ุ </li><li style=";text-align:right;direction:rtl">  ุขููุฉ ุชุฑุญูู ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  ุฅุทุงุฑ ูุงุฎุชุจุงุฑ ุฑูุฒ ูุนูู ูุน ุงูุจูุงูุงุช. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุญู ูุฏุนู ุฃุฑุจุนุฉ ุฃููุงุน ูู ููุงุนุฏ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ: PostgreSQL ุ MS SQL Server ุ Oracle ู H2. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุงูุญ ุงูุฑุฆูุณูุฉ ุณูููุณุชุง: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุจุฏุฃ ูุดุงุจู ุฌุฏูุง ูููุจุฏุฃ ุงูุฃุณุงุณู ูู Java: "ุงููุชุงุจุฉ ูุฑุฉ ูุงุญุฏุฉ ุ ูู ุจุชุดุบูู ูู RDBMS ุงููุฏุนููุฉ."  ููุฏ ููุทู ุงูุนูู ูุง ูุนุฑู ููุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุชุดุบูููุง ุนูููุง.  ููููู ูุชุงุจุฉ ุฑูุฒ ููุทู ุงูุนูู ูุชุดุบููู ูู MS SQL Server ุ ุซู ุงูุชุจุฏูู ุฅูู PostgreSQL ุ ูุณูู ูุญุฏุซ ูุฐุง ุฏูู ุชุนููุฏุงุช (ุฌูุฏูุง ุ ุชูุฑูุจูุง :) </li><li style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุงูููููุฉ ุงูุชููุงุฆูุฉ ุนูู ูุงุนุฏุฉ ุจูุงูุงุช ุญูุฉ.  ุชุญุฏุซ ูุนุธู ุฏูุฑุฉ ุญูุงุฉ ูุดุงุฑูุน Celesta ุนูุฏูุง ุชููู ูุงุนุฏุฉ ุจูุงูุงุช ุงูุนูู ููุฌูุฏุฉ ุจุงููุนู ูุชูุชูุฆ ุจุงูุจูุงูุงุช ุงูุชู ูุฌุจ ุญูุธูุง ุ ูููู ูู ุงูุถุฑูุฑู ุฃูุถูุง ุชุบููุฑ ุจููุชูุง ุจุงุณุชูุฑุงุฑ.  ุชุชูุซู ุฅุญุฏู ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ ูุณูููุณุชุง ูู ุงููุฏุฑุฉ ุนูู "ููุงุฆูุฉ" ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชููุงุฆููุง ููููุฐุฌ ุงูุจูุงูุงุช ุงูุฎุงุต ุจู. </li><li style=";text-align:right;direction:rtl">  ุงูุงุฎุชุจุงุฑ.  ูุชู ุฅููุงุก ุงููุซูุฑ ูู ุงูุงูุชูุงู ูุถูุงู ุฃู ุฑูุฒ Celesta ูุงุจู ููุงุฎุชุจุงุฑ ุ ุญุชู ูุชููู ูู ุงุฎุชุจุงุฑ ุงูุฃุณุงููุจ ุงูุชู ุชุนุฏู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชููุงุฆููุง ุ ูุฐูู ุจุณูููุฉ ูุณุฑุนุฉ ูุฃููู ุ ุฏูู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุฎุงุฑุฌูุฉ ูุซู DbUnit ูุงูุญุงููุงุช. </li></ol><br><h2 id="dlya-chego-nuzhna-nezavisimost-ot-tipa-subd" style=";text-align:right;direction:rtl">  ููุงุฐุง ุชุญุชุงุฌ ุงูุงุณุชููุงู ุนู ููุน DBMSุ </h2><br><p style=";text-align:right;direction:rtl">  ูู ุชูู ุงุณุชููุงููุฉ ููุฏ ููุทู ุงูุนูู ุนู ููุน ููุงุนุฏ ุงูุจูุงูุงุช DBMS ูู ุงูููุทุฉ ุงูุฃููู ุงูุชู ูุถุนูุงูุง: ุงูุดูุฑุฉ ุงูููุชูุจุฉ ูู ุฃุฌู Celesta ูุง ุชุนุฑู ุนูู ุงูุฅุทูุงู ููุงุนุฏ ุจูุงูุงุช ููุงุนุฏ ุงูุจูุงูุงุช ุงูุชู ุชุนูู ุนูููุง.  ููุงุฐุงุ </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูุธุฑูุง ูุญูููุฉ ุฃู ุงุฎุชูุงุฑ ููุน DBMS ููุณ ูุดููุฉ ุชูููููุฌูุฉ ุ ููููู ูุดููุฉ ุณูุงุณูุฉ.  ุนูุฏ ุงููุฏูู ุฅูู ุนููู ุชุฌุงุฑู ุฌุฏูุฏ ุ ุบุงูุจูุง ูุง ูุฌุฏ ุฃูู ูุฏูู ุจุงููุนู ููุน ููุถู ูู ููุงุนุฏ ุจูุงูุงุช ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช (DBMS) ูุชู ููู ุงุณุชุซูุงุฑ ุงูุฃููุงู ุ ููุฑูุฏ ุงูุนููู ุฑุคูุฉ ุญููู ุฃุฎุฑู ุนูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุญุงููุฉ.  ุงููุดูุฏ ุงูุชูููููุฌู ุขุฎุฐ ูู ุงูุชุบูุฑ: ุชู ุงูุนุซูุฑ ุนูู PostgreSQL ุจุดูู ูุชุฒุงูุฏ ูู ุงูููุงูุงุช ุงูุญููููุฉ ูุงูุดุฑูุงุช ุงูุฎุงุตุฉ ุ ุนูู ุงูุฑุบู ูู ุฃู MS SQL Server ุณุงุฏ ูู ููุงุฑุณุชูุง ููุฐ ุจุถุน ุณููุงุช.  ูุฏุนู ูุธุงู Celesta ููุงุนุฏ ุงูุจูุงูุงุช ุงูุฃูุซุฑ ุดููุนูุง ุ ููุญู ูุณูุง ููููู ุจุดุฃู ูุฐู ุงูุชุบููุฑุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุซุงููุงู ุ ุฃูุฏ ููู ุงูููุฏ ุงูุฐู ุชู ุฅูุดุงุคู ุจุงููุนู ูุญู ุงููุดููุงุช ุงูููุงุณูุฉ ูู ูุดุฑูุน ุฅูู ุขุฎุฑ ุ ูุฅูุดุงุก ููุชุจุฉ ูุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู.  ุชุนุชุจุฑ ุฃุดูุงุก ูุซู ุงูุฏูุงุฆู ุงููุฑููุฉ ุฃู ูุญุฏุงุช ุชูุฒูุน ุฅุฎุทุงุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุงุณูุฉ ุจุทุจูุนุชูุง ุ ูููุงุฐุง ูุญุชุงุฌ ุฅูู ุฏุนู ุฅุตุฏุงุฑุงุช ูุชุนุฏุฏุฉ ููุนููุงุก ุงูุฐูู ูุฏููู ุนูุงูุงุช ูุฎุชููุฉุ </p><br><p style=";text-align:right;direction:rtl">  ุซุงูุซูุง ุ ุฃุฎูุฑูุง ูููุณ ุขุฎุฑูุง ุ ุงููุฏุฑุฉ ุนูู ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ ุฏูู ุงุณุชุฎุฏุงู DbUnit ูุงูุญุงููุงุช ุจุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุจูุงูุงุช H2 ูู ุงูุฐุงูุฑุฉ.  ูู ูุฐุง ุงููุถุน ุ ุชุจุฏุฃ ูุงุนุฏุฉ H2 ุนูู ุงูููุฑ.  ููุดุฆ Celesta ุจุณุฑุนุฉ ูุจูุฑุฉ ูุฎุทุท ุจูุงูุงุช ููู ุ ูุจุนุฏ ุฐูู ููููู ุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑุงุช ุงููุงุฒูุฉ ู "ูุณูุงู" ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ูุธุฑูุง ูุฃู ููุฏ ููุทู ุงูุนูู ูุง ูุนุฑู ุญููุง ุฃู ุฃุณุงุณ ูุชู ุชูููุฐู ุ ูุชุจุนูุง ูุฐูู ุ ุฅุฐุง ูุงู ูุนูู ุจุฏูู ุฃุฎุทุงุก ุนูู H2 ุ ููู ุฏูู ุฃุฎุทุงุก ุ ุณูุนูู ุนูู PostgreSQL.  ุจุงูุทุจุน ุ ุชุชูุซู ูููุฉ ูุทูุฑู ูุธุงู Celesta ููุณู ูู ุฅุฌุฑุงุก ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ุจุงุณุชุฎุฏุงู ููุงุนุฏ ุจูุงูุงุช ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช (DBMS) ุงูุญููููุฉ ููุชุฃูุฏ ูู ุฃู ููุตุชูุง ุชุคุฏู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ุงูุฎุงุตุฉ ุจูุง ุนูู ูุฏู ุงููุณุงูุงุฉ ูู ุงูุนูุงูุงุช ุงููุฎุชููุฉ.  ููุญู ููุนู ุฐูู.  ููู ูุทูุฑ ููุทู ุงูุฃุนูุงู ูู ูุนุฏ ูุทููุจูุง. </p><br><h2 id="celestasql" style=";text-align:right;direction:rtl">  CelestaSQL </h2><br><p style=";text-align:right;direction:rtl">  ููู ูุชุญูู ุงูุชุดุงุจู ุจูู ุงููุงุนุฏุชููุ  ุจุงูุทุจุน ุ ุนูู ุญุณุงุจ ุงูุนูู ูุน ุงูุจูุงูุงุช ููุท ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฎุงุตุฉ ุงูุชู ุชุนุฒู ุงูููุทู ุนู ุฃู ุชูุงุตูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ููุดุฆ Celesta ูุฆุงุช Java ูููุตูู ุฅูู ุงูุจูุงูุงุช ุ ูู ูุงุญูุฉ ุ ูุฑูุฒ SQL ูุจุนุถ ุงููุงุฆูุงุช ุงููุณุงุนุฏุฉ ุฏุงุฎู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูู ูุงุญูุฉ ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูุง ูููุฑ Celesta ุชุนููููุง ูุนูุงูุฉ ุงููุงุฆูุงุช ูู ุฃููู ุตูุฑู ุ ูุฃูู ุนูุฏ ุชุตููู ูููุฐุฌ ุจูุงูุงุช ุ ูุง ูุฃุชู ูู ูุฆุงุช ุ ูููู ูู ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุฃู ุฃููุง ุฃููุงู ูุตูู ูููุฐุฌ ER ููุฌุฏุงูู ุ ูุจุนุฏ ุฐูู ุ ุจูุงุกู ุนูู ูุฐุง ุงููููุฐุฌ ุ ูููู ุณูููุณุชุง ููุณู ุจุฅูุดุงุก ูุตูู ุงููุคุดุฑ ูููุตูู ุฅูู ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุชุญููู ููุณ ุงูุนูู ุนูู ุฌููุน ูุธู ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช ุงููุฏุนููุฉ ููุท ูููุธุงุฆู ุงูุชู ูุชู ุชูููุฐูุง ุนูู ูุฏู ุงููุณุงูุงุฉ ุชูุฑูุจูุง ูู ูู ูููุง.  ุฅุฐุง ุตููุฑูุง ุจุดูู ูุดุฑูุท ูุฌููุนุฉ ุงููุฏุฑุงุช ุงููุธูููุฉ ููู ูุงุนุฏุฉ ูุฏุนููุฉ ูู ูุจููุง ูู ุดูู "ุฏูุงุฆุฑ ุฃูููุฑ" ุ ูุณูุญุตู ุนูู ุงูุตูุฑุฉ ุงูุชุงููุฉ: </p><br><div style="text-align:center;;text-align:right;direction:rtl"><img width="300" src="https://habrastorage.org/getpro/habr/post_images/7d9/2ad/1e1/7d92ad1e1a3bc0bb83b5c4bcc511ec66.png"></div><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุฑูุง ุงุณุชููุงููุฉ ุชุงูุฉ ุนู ููุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุฅู ุงููุธููุฉ ุงูุชู ููุชุญูุง ููุจุฑูุฌู ููุทู ุงูุฃุนูุงู ูุฌุจ ุฃู ุชููู ุฏุงุฎู ุชูุงุทุน ุฌููุน ุงูููุงุนุฏ.  ูููููุฉ ุงูุฃููู ุ ูุจุฏู ุฃู ูุฐุง ููุฏ ูุจูุฑ.  ูุนู: ุจุนุถ ุงูููุฒุงุช ุงููุญุฏุฏุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุง ูููููุง ุงุณุชุฎุฏุงู SQL Server.  ูููู ุจุฏูู ุงุณุชุซูุงุก ุ ุชุฏุนู ููุงุนุฏ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ ุงูุฌุฏุงูู ูุงูููุงุชูุญ ุงูุฎุงุฑุฌูุฉ ูุทุฑู ุงูุนุฑุถ ูุงูุชุณูุณูุงุช ูุงุณุชุนูุงูุงุช SQL ูุน JOIN ู GROUP BY.  ูููุง ูุฐูู ุ ูููููุง ุฅุนุทุงุก ูุฐู ุงููุฑุต ูููุทูุฑูู.  ูุญู ูููุฑ ูููุทูุฑูู "SQL depersonalized SQL" ุ ูุงูุชู ูุณูููุง "CelestaSQL" ุ ููู ูุฐู ุงูุนูููุฉ ูููู ุจุฅูุดุงุก ุงุณุชุนูุงูุงุช SQL ููุฌุงุช ููุงุนุฏ ุงูุจูุงูุงุช ุงูููุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุชุชุถูู ูุบุฉ CelestaSQL DDL ูุชุนุฑูู ูุงุฆูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุณุชุนูุงูุงุช SELECT ูุทุฑู ุงูุนุฑุถ ูุงููุฑุดุญุงุช ุ ูููููุง ูุง ุชุญุชูู ุนูู ุฃูุงูุฑ DML: ุชูุณุชุฎุฏู ุงููุคุดุฑุงุช ูุชุนุฏูู ุงูุจูุงูุงุช ุ ุงูุชู ูุง ุชุฒุงู ุจุญุงุฌุฉ ุฅูู ููุงูุดุชูุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุงุนุฏุฉ ุจูุงูุงุช ูุฏููุง ูุฌููุนุฉ ูู ุฃููุงุน ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง.  ูุฏู CelestaSQL ุฃูุถูุง ูุฌููุนุฉ ุงูุฃููุงุน ุงูุฎุงุตุฉ ุจูุง.  ูู ููุช ูุชุงุจุฉ ูุฐุง ุงูุชูุฑูุฑ ุ ูุงู ููุงู ุชุณุนุฉ ูููุง ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฐุง ุงูุฌุฏูู</a> ููุงุฑููุง ุจุฃููุงุน ุญููููุฉ ูู ููุงุนุฏ ุจูุงูุงุช ูุฎุชููุฉ ูุฃููุงุน ุจูุงูุงุช Java. </p><br><p style=";text-align:right;direction:rtl">  ูุฏ ูุจุฏู ุฃู ุชุณุนุฉ ุฃููุงุน ูุง ุชููู (ููุงุฑูุฉ ุจูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฏุนูู</a> PostgreSQL ุ ุนูู ุณุจูู ุงููุซุงู) ุ ูููู ูู ุงููุงูุน ูุฐู ุงูุฃููุงุน ุชููู ูุชุฎุฒูู ุงููุนูููุงุช ุงููุงููุฉ ูุงูุชุฌุงุฑูุฉ ูุงูููุฌุณุชูุฉ: ุงูุฃูุชุงุฑ ูุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ูุงููุณุฑูุฉ ูุงูุชูุงุฑูุฎ ูุงูููู ุงูููุทููุฉ ูุงูููุท ุฏุงุฆููุง ูุงููุฉ ูุชูุซูู ูุฐู ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุชู ูุตู ูุบุฉ CelestaSQL ููุณูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ูุน ุนุฏุฏ ูุจูุฑ ูู ูุฎุทุทุงุช ุจูุงุก ุงูุฌููุฉ. </p><br><h2 id="modifikaciya-struktury-bazy-dannyh-idempotentnyy-ddl" style=";text-align:right;direction:rtl">  ุชุนุฏูู ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  Idempotent DDL </h2><br><p style=";text-align:right;direction:rtl">  ุงูููุฒุฉ ุงูุฑุฆูุณูุฉ ุงูุฃุฎุฑู ูุณูููุณุชุง ูู ููุงุฑุจุชูุง ูุชุฑุญูู ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุนุงููุฉ ูุน ุชุทูุฑ ุงููุดุฑูุน.  ููููุงู ุจุฐูู ุ ูุชู ุงุณุชุฎุฏุงู ุงูููุฌ ุงููุถูู ูู ุณูููุณุชุง ุจุงุณุชุฎุฏุงู DDL idempotent. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฎุชุตุงุฑ ุ ุนูุฏูุง ููุชุจ ูู CelestaSQL ุงููุต ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> OrderLine( order_id <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, line_no <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, item_id <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, item_name <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>), qty <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">cost</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REAL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> Idx_OrderLine PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (order_id, line_no) );</code> </pre> <br><p style=";text-align:right;direction:rtl">  - ูุง ููุณุฑ Celesta ูุฐุง ุงููุต ุนูู ุฃูู "ุฅูุดุงุก ุฌุฏูู ุ ูููู ุฅุฐุง ูุงู ููุงู ุจุงููุนู ุฌุฏูู ุ ูุนููู ุฅุนุทุงุก ุฎุทุฃ" ุ ูููู "ุฅุญุถุงุฑ ุงูุฌุฏูู ุฅูู ุงููููู ุงููุทููุจ".  ูุฐุง ูู: "ุฅุฐุง ูู ููู ููุงู ุฌุฏูู ุ ูู ุจุฅูุดุงุฆู ุ ูุฅุฐุง ูุงู ููุงู ุฌุฏูู ุ ุฑุงุฌุน ุงูุญููู ุงูููุฌูุฏุฉ ููู ุ ููุง ุฃููุงุน ุงูููุงุฑุณ ุ ูุงูููุงุชูุญ ุงูุฎุงุฑุฌูุฉ ุ ูุงูููู ุงูุงูุชุฑุงุถูุฉ ุ ููุง ุฅูู ุฐูู ุ ููุง ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุชุบููุฑ ุดูุก ูุง ูู ูุฐุง ุงูุฌุฏูู ูุฅุญุถุงุฑู ุฅูู ุงูููุน ุงูุตุญูุญ ". </p><br><p style=";text-align:right;direction:rtl">  ูุน ูุฐุง ุงูููุฌ ุ ูููู ุจุชุทุจูู ุงููุฏุฑุฉ ุนูู refactor ูุงููุตูุต ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ูุชุญุฏูุฏ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฑู ูู ุงูุจุฑูุงูุฌ ุงููุตู "ุงูุตูุฑุฉ ุงููุฑุบูุจุฉ" ุงูุญุงููุฉ ูููููู ุ </li><li style=";text-align:right;direction:rtl">  ูุงุฐุง ุ ูู ูุจู ูููุงุฐุง ุชุบูุฑ ูู ุงููููู ูุน ูุฑูุฑ ุงูููุช ุ ูููููุง ุฃู ููุธุฑ ูู ุฎูุงู ูุธุงู ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู ุฃูุงูุฑ ALTER ุ ูููู Celesta ุชููุงุฆููุง ุจุฅูุดุงุก ูุชูููุฐูุง "ุชุญุช ุงูุบุทุงุก" ุญุณุจ ุงูุถุฑูุฑุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุงูุทุจุน ุ ูุฐุง ุงูููุฌ ูู ุญุฏูุฏู.  ูุจุฐู Celesta ูุตุงุฑู ุฌูุฏู ูุถูุงู ุฃู ุชููู ุนูููุฉ ุงูุชุฑุญูู ุงูุชููุงุฆู ุบูุฑ ูุคููุฉ ูุณูุณุฉ ุ ูููู ูุฐุง ุบูุฑ ูููู ูู ุฌููุน ุงูุญุงูุงุช.  ุชู ุชูุถูุญ ุฏูุงูุน ูุฐุง ุงูููุฌ ูุฅููุงููุงุชู ููููุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ูุฐุง ุงูููุดูุฑ</a> (ุฅุตุฏุงุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</a> ูุชุงุญ ุฃูุถูุง). </p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุชุณุฑูุน ุนูููุฉ ูุญุต / ุชุญุฏูุซ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุทุจู Celesta ุชุฎุฒูู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูู DDL ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุญุชู ูุชู ุชุบููุฑ ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ุ ูุง ุชุจุฏุฃ ุนูููุฉ ุงูุชุญูู ูู ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุญุฏูุซูุง).  ูู ุฃุฌู ูุชุงุจุนุฉ ุนูููุฉ ุงูุชุญุฏูุซ ุฏูู ุญุฏูุซ ูุดุงูู ุชุชุนูู ุจุชุฑุชูุจ ุชุบููุฑ ุงููุงุฆูุงุช ุงูุชู ุชุนุชูุฏ ุนูู ุจุนุถูุง ุงูุจุนุถ ุ ูุชู ุชุทุจูู ุงูุชุตููู ุงูุทูุจูููุฌู ููุชุจุนูุงุช ุจูู ุงููุฎุทุทุงุช ุจูุงุณุทุฉ ุงูููุงุชูุญ ุงูุฎุงุฑุฌูุฉ.  ูุชู ูุตู ุนูููุฉ ุงูุชุฑุญูู ุงูุชููุงุฆู ุจูุฒูุฏ ูู ุงูุชูุงุตูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> . </p><br><h2 id="sozdanie-proekta-celesta-i-modeli-dannyh" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุดุฑูุน ูุจูุงูุงุช ุณูููุณุชุง </h2><br><p style=";text-align:right;direction:rtl">  ุงููุดุฑูุน ุงูุชุฌุฑูุจู ุ ุงูุฐู ุณููุธุฑ ููู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุงุญ ุนูู ุฌูุซุจ</a> .  ุฏุนููุง ูุฑู ููู ููููู ุงุณุชุฎุฏุงู Celesta ุนูุฏ ูุชุงุจุฉ ุชุทุจูู Spring Boot.  ุฅููู ุชุจุนูุงุช Maven ุงูุชู ุชุญุชุงุฌูุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>org.springframework.boot:spring-boot-starter-web</code> ู <code>ru.curs:spring-boot-starter-celesta</code> (ููุฒูุฏ ูู ุงูุชูุงุตูู ุ <code>ru.curs:spring-boot-starter-celesta</code> ุงููุซุงุฆู). </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ูุง ุชุณุชุฎุฏู Spring Boot ุ ูููููู ุชูุตูู <code>ru.curs:celesta-system-services</code> ุชุจุนูุฉ <code>ru.curs:celesta-system-services</code> ูุจุงุดุฑุฉ. </li><li style=";text-align:right;direction:rtl">  <code>ru.curs:celesta-maven-plugin</code> ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุฆุงุช ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุงุณุชูุงุฏูุง ุฅูู ุงูุจุฑุงูุฌ ุงููุตูุฉ Celesta-SQL ุ ููุงู ุญุงุฌุฉ ุฅูู <code>ru.curs:celesta-maven-plugin</code> - ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ ููุซุงู ุชุฌุฑูุจู ุฃู ูุซุงุฆู ุชูุถุญ ููููุฉ ุชูุตููู. </li><li style=";text-align:right;direction:rtl">  ููุงุณุชูุงุฏุฉ ูู ุงููุฏุฑุฉ ุนูู ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ูุญุฏุฉ JUnit5 ููุฃุณุงููุจ ุงูุชู ุชุนุฏู ุงูุจูุงูุงุช ุ ูุฌุจ ุนููู ุชูุตูู <code>ru.curs:celesta-unit</code> ูู ูุทุงู ุงูุงุฎุชุจุงุฑ. </li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฅูุดุงุก ูููุฐุฌ ุจูุงูุงุช ูุชุฌููุน ูุฆุงุช ุงููุตูู ุฅูู ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูููุชุฑุถ ุฃููุง ูููู ุจุชูููุฐ ูุดุฑูุน ูุดุฑูุฉ ุชุฌุงุฑุฉ ุฅููุชุฑูููุฉ ุงูุฏูุฌุช ูุคุฎุฑูุง ูุน ุดุฑูุฉ ุฃุฎุฑู.  ูู ูุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู.  ุฅููู ูุฌูุนูู ุงูุทูุจุงุช ุ ููู ุญุชู ูุฏูุฌูุง ููุงุนุฏ ุจูุงูุงุชูู ุ ูุฅููู ูุญุชุงุฌูู ุฅูู ููุทุฉ ุฏุฎูู ูุงุญุฏุฉ ูู ุฃุฌู ุฌูุน ุงูุทูุจุงุช ูู ุงูุฎุงุฑุฌ. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ุชุทุจูู "ููุทุฉ ุงูุฏุฎูู" ุชูููุฏููุง: ุฎุฏูุฉ HTTP ูุน ุนูููุงุช CRUD ุงูุชู ุชุฎุฒู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุจูุงูุงุช ุนูุงุฆููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุญูููุฉ ุฃู Celesta ูุทุจู ููุฌ ุชุตููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฃููู ุ ูุญุชุงุฌ ุฃููุงู ุฅูู ุฅูุดุงุก ูููู ุฌุฏูู ูุฎุฒู ุงูุทูุจุงุช.  ุงูุทูุจ ุ ููุง ุชุนูููู ุ ูู ููุงู ูุฑูุจ: ูุชููู ูู ุฑุฃุณ ุญูุซ ูุชู ุชุฎุฒูู ูุนูููุงุช ุญูู ุงูุนููู ูุชุงุฑูุฎ ุงูุทูุจ ูุงูุณูุงุช ุงูุฃุฎุฑู ูููุธุงู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุนุฏูุฏ ูู ุงูุฃุณุทุฑ (ุนูุงุตุฑ ุณูุนุฉ). </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ููุญุตูู ุนูู ุงููุธููุฉ: ุฅูุดุงุก </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>src/main/celestasql</code> - ุจุดูู ุงูุชุฑุงุถู ุ ูุฐุง ูู ุงููุณุงุฑ ุฅูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ููุดุฑูุน CelestaSQL </li><li style=";text-align:right;direction:rtl">  ุฃูู ูุญุชูู ุนูู ูุฌูุฏุงุช ูุฑุนูุฉ ุชูุฑุฑ ุจููุฉ ูุฌูุฏ ุญุฒู java ( <code>ru/curs/demo</code> ูู ุญุงูุชูุง). </li><li style=";text-align:right;direction:rtl">  ูู ูุฌูุฏ ุงูุญุฒูุฉ ุ ูู ุจุฅูุดุงุก ููู <code>.sql</code> ุจุงููุญุชููุงุช ุงูุชุงููุฉ: </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SCHEMA</span></span> demo <span class="hljs-keyword"><span class="hljs-keyword">VERSION</span></span> <span class="hljs-string"><span class="hljs-string">'1.0'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> OrderHeader( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> DATETIME, customer_id <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>), <span class="hljs-comment"><span class="hljs-comment">/**  */</span></span> customer_name <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>), manager_id <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> Pk_OrderHeader PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) ); <span class="hljs-comment"><span class="hljs-comment">/** */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> OrderLine( order_id <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, line_no <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, item_id <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, item_name <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>), qty <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">cost</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REAL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> Idx_OrderLine PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (order_id, line_no) ); <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> OrderLine <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> fk_OrderLine <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (order_id) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> OrderHeader(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VIEW</span></span> OrderedQty <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> item_id, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(qty) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> qty <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> OrderLine <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> item_id;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุตููุง ููุง ุฌุฏูููู ูุชุตููู ุจููุชุงุญ ุฎุงุฑุฌู ุ ูุทุฑููุฉ ุนุฑุถ ูุงุญุฏุฉ ุณุชุนูุฏ ูููุฉ ููุฎุต ููุจุถุงุฆุน ุงูููุฌูุฏุฉ ูู ุฌููุน ุงูุทูุจุงุช.  ููุง ุชุฑูู ุ ูุฐุง ูุง ูุฎุชูู ุนู SQL ุงูุนุงุฏู ุ ุจุงุณุชุซูุงุก ุงูุฃูุฑ <code>CREATE SCHEMA</code> ุ ุงูุฐู ุฃุนููุง ููู ุฅุตุฏุงุฑ ูุฎุทุท <code>demo</code> (ููุนุฑูุฉ ููููุฉ ุชุฃุซูุฑ ุฑูู ุงูุฅุตุฏุงุฑ ุนูู ุงูุชุฑุญูู ุงูุชููุงุฆู ุ ุฑุงุฌุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ).  ูููู ููุงู ุฃูุถุง ุงูููุฒุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุฃู ุชููู ุฌููุน ุฃุณูุงุก ุงูุฌุฏุงูู ูุงูุญููู ุงูุชู ูุณุชุฎุฏููุง ููุท ุจุญูุซ ูููู ุชุญููููุง ุฅูู ุฃุณูุงุก ุตุงูุญุฉ ูููุฆุงุช ูุงููุชุบูุฑุงุช ุจูุบุฉ Java.  ูุฐูู ุ ูุชู ุงุณุชุจุนุงุฏ ุงููุณุงูุงุช ูุงูุฃุญุฑู ุงูุฎุงุตุฉ.  ููููู ุฃูุถูุง ููุงุญุธุฉ ุฃู ุงูุชุนูููุงุช ุงูุชู ูุถุนูุงูุง ุนูู ุฃุณูุงุก ุงูุฌุฏุงูู ูุจุนุถ ุงูุญููู ุ ูู ูุจุฏุฃ ุจู / * ุ ูุงูุนุงุฏุฉ ุ ูููู ูุน / ** ุ ููู ุชุจุฏุฃ ุชุนูููุงุช JavaDoc - ููุฐุง ููุณ ูุตุงุฏูุฉ!  ุณูููู ุชุนููู ูุนุฑู ุนุจุฑ ููุงู ูุจุฏุฃ ุจู / ** ูุชุงุญูุง ูู ููุช ุงูุชุดุบูู ูู <code>.getCelestaDoc()</code> ููุฐุง ุงูููุงู.  ูููู ูุฐุง ูููุฏูุง ุนูุฏูุง ูุฑูุฏ ุชุฒููุฏ ุนูุงุตุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุนูููุงุช ุงูุชุนุฑูู ุงูุฅุถุงููุฉ: ุนูู ุณุจูู ุงููุซุงู ุ ุฃุณูุงุก ุงูุญููู ุงููุงุจูุฉ ูููุฑุงุกุฉ ุงูุจุดุฑูุฉ ุ ููุนูููุงุช ุญูู ููููุฉ ุชูุซูู ุงูุญููู ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ูุฎุฏู ุงูุจุฑูุงูุฌ ุงููุตู CelestaSQL ูููุชูู ุนูู ููุณ ุงููุฏุฑ ูู ุงูุฃูููุฉ: ุฃููุงู ุ ููุดุฑ / ุชุนุฏูู ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ ุ ูุซุงููุงู ุ ูุฅูุดุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุฆุงุช ุงููุตูู ุฅูู ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูููููุง ุงูุขู ุฅูุดุงุก ูุฆุงุช ูุตูู ุฅูู ุงูุจูุงูุงุช ุ ููุท ูู ุจุชุดุบูู <code>mvn generate-sources</code> ุ ุฃู ุฅุฐุง ููุช ุชุนูู ูู IDEA ุ ูุงููุฑ ููู ุงูุฒุฑ "ุฅูุดุงุก ูุตุงุฏุฑ ูุชุญุฏูุซ ุงููุฌูุฏุงุช" ูู ููุญุฉ ุชุญูู Maven.  ูู ุงูุญุงูุฉ ุงูุซุงููุฉ ุ ุชููู IDEA " <code>target/generated-sources/celesta</code> ุงููุฌูุฏ ุงูุฐู ุชู ุฅูุดุงุคู ูู <code>target/generated-sources/celesta</code> ูุฅุชุงุญุฉ ูุญุชููุงุชู ููุงุณุชูุฑุงุฏ ูู ุฃููุงุฏ ูุตุฏุฑ ุงููุดุฑูุน.  ุณุชุจุฏู ูุชูุฌุฉ ุฅูุดุงุก ุงูุดูุฑุฉ ููุง ููู - ูุฆุฉ ูุงุญุฏุฉ ููู ูุงุฆู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: </p><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/2x/3q/cs/2x3qcsydsu3y5vplbyh7oz15z-s.png"></div><br><p style=";text-align:right;direction:rtl">  ูุชู ุชุญุฏูุฏ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู ุ ูู ุญุงูุชูุง ุ ูู ููู <code>src/main/resources/application.yml</code> .  ุนูุฏ ุงุณุชุฎุฏุงู spring-boot-starter-celesta ุ ุณุชุฎุจุฑู IDEA ุจุฎูุงุฑุงุช ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชููุฑุฉ ูู ุฅููุงู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ููู ูุฑูุฏ ุนูุงุก RDBMS "ุงูุญูููู" ูุฃุบุฑุงุถ ุงูุนุฑุถ ุงูุชูุถูุญู ุ ููููููุง ุฃู ูุฌุนู Celesta ูุนูู ูุน ูุงุนุฏุฉ ุจูุงูุงุช H2 ุงููุถููุฉ ูู ูุถุน ุงูุฐุงูุฑุฉ ุจุงุณุชุฎุฏุงู ุงูุชูููู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">celesta: h2: inMemory: true</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชูุตูู ูุงุนุฏุฉ ุจูุงูุงุช "ุญููููุฉ" ุ ูู ุจุชุบููุฑ ุงูุชูููู ุฅูู ุดูุก ูู ูุฐุง ุงููุจูู </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">celesta: jdbc: url: jdbc:postgresql://127.0.0.1:5432/celesta username: &lt;your_username&gt; password: &lt;your_password&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl">  (ูู ูุฐู ุงูุญุงูุฉ ุ ุณุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅุถุงูุฉ ุจุฑูุงูุฌ ุชุดุบูู PostgreSQL JDBC ุฅูู ุชุทุจููู ูู ุฎูุงู ุชุจุนูุฉ Maven). </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ุชููู ุจุชุดุบูู ุชุทุจูู Celesta ูุน ุงุชุตุงู ุจุฎุงุฏู ูุงุนุฏุฉ ุจูุงูุงุช ุ ููููู ููุงุญุธุฉ ุฃู ุงูุฌุฏุงูู ุงููุงุฒูุฉ ูุทุฑู ุงูุนุฑุถ ูุงูููุงุฑุณ ุ ููุง ุฅูู ุฐูู ูุชู ุฅูุดุงุคูุง ููุงุนุฏุฉ ุจูุงูุงุช ูุงุฑุบุฉ ุ ูุจุงููุณุจุฉ ููุงุนุฏุฉ ุจูุงูุงุช ุบูุฑ ูุงุฑุบุฉ ุ ูุชู ุชุญุฏูุซูุง ุนูู ุงูููุงูู ุงููุญุฏุฏุฉ ูู DDL. </p><br><h2 id="sozdanie-metodov-rabotayuschih-s-dannymi" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุทุฑู ูุนุงูุฌุฉ ุงูุจูุงูุงุช </h2><br><p style=";text-align:right;direction:rtl">  ุจูุฌุฑุฏ ูุนุฑูุฉ ููููุฉ ุฅูุดุงุก ุจููุฉ ูุงุนุฏุฉ ุจูุงูุงุช ุ ููููู ุงูุจุฏุก ูู ูุชุงุจุฉ ููุทู ุงูุนูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุฃู ุชููู ูุงุฏุฑุฉ ุนูู ุชูููุฐ ูุชุทูุจุงุช ุชูุฒูุน ุญููู ุงููุตูู ูุฅุฌุฑุงุกุงุช ุงูุชุณุฌูู ุ ูุชู ุชูููุฐ ุฃู ุนูููุฉ ุนูู ุงูุจูุงูุงุช ูู Celesta ููุงุจุฉ ุนู ุงููุณุชุฎุฏู ุ ูุง ุชูุฌุฏ ุนูููุงุช "ูุฌูููุฉ".  ูุฐูู ุ ูุชู ุชูููุฐ ุฃู ููุฏ Celesta ูู <em>ุณูุงู ุงูููุงููุฉ</em> ุงูููุตููุฉ ูู ูุฆุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CallContext</a> . </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุจู ุจุฏุก ุนูููุฉ ูููููุง ุชุนุฏูู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ <code>CallContext</code> ุชูุดูุท <code>CallContext</code> . </li><li style=";text-align:right;direction:rtl">  ูู ููุช ุงูุชูุดูุท ุ ูุชู ุฃุฎุฐ ุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุชุฌูุน ุงูุงุชุตุงู ูุชุจุฏุฃ ุงููุนุงููุฉ. </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุงูุชูุงู ุงูุนูููุฉ <code>CallContext</code> ูููุฐ <code>CallContext</code> ุฅูุง <code>commit()</code> ุฅุฐุง ูุงูุช ุงูุนูููุฉ ูุงุฌุญุฉ ุ ุฃู <code>rollback()</code> ุญุงูุฉ ุญุฏูุซ ุงุณุชุซูุงุก ุบูุฑ ูุนุงูุฌ ุฃุซูุงุก ุงูุชูููุฐ ุ ูุชู ุฅุบูุงู <code>CallContext</code> ููุนุงุฏ ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅูู ุงูุชุฌูุน. </li></ul><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุงุณุชุฎุฏููุง spring-boot-starter-celesta ุ ูุณูุชู ุชูููุฐ ูุฐู ุงูุฅุฌุฑุงุกุงุช ุชููุงุฆููุง ูุฌููุน ุงูุทุฑู <code>@CelestaTransaction</code> ุจูุงุณุทุฉ <code>@CelestaTransaction</code> . </p><br><p style=";text-align:right;direction:rtl">  ูููุชุฑุถ ุฃููุง ูุฑุบุจ ูู ูุชุงุจุฉ ูุนุงูุฌ ูุญูุธ ุงููุณุชูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ูุฏ ูุจุฏู ุฑูุฒ ูุณุชูู ุงูุชุญูู ุงูุฎุงุต ุจู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/api"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DocumentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> DocumentService srv; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DocumentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DocumentService srv)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.srv = srv; } <span class="hljs-meta"><span class="hljs-meta">@PutMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/save"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody OrderDto order)</span></span></span><span class="hljs-function"> </span></span>{ CallContext ctx = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CallContext(<span class="hljs-string"><span class="hljs-string">"user1"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//new SystemCallContext(); srv.postOrder(ctx, order); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุงุนุฏุฉ ุนุงูุฉ ุ ุนูู ูุณุชูู ุทุฑููุฉ ุงูุชุญูู (ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ุชููู ุงููุตุงุฏูุฉ ูุฏ ูุฑุช ุจุงููุนู) ุ ูุฅููุง ูุนุฑู ูุนุฑู ุงููุณุชุฎุฏู ููููู ุงุณุชุฎุฏุงูู ุนูุฏ ุฅูุดุงุก <code>CallContext</code> .  ุฑุจุท ูุณุชุฎุฏู ุจุณูุงู ูุญุฏุฏ ุฃุฐููุงุช ุงููุตูู ุฅูู ุงูุฌุฏุงูู ุ ููููุฑ ุฃูุถูุง ุฅููุงููุฉ ุชุณุฌูู ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ููุงุจุฉ ุนูู.  ุตุญูุญ ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุฃุฌู ุชุดุบูู ุงูุดูุฑุฉ ุงูุชู ุชุชูุงุนู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุฌุจ ุงูุฅุดุงุฑุฉ ุฅูู ุญููู ุงููุณุชุฎุฏู "user1" ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌุฏุงูู ุงููุธุงู</a> .  ุฅุฐุง ููุช ูุง ุชุฑุบุจ ูู ุงุณุชุฎุฏุงู ูุธุงู ุชูุฒูุน ุงููุตูู ุฅูู Celesta ูููุญ ุณูุงู ุงูุฌูุณุฉ ุฌููุน ุงูุญููู ูุฃู ุฌุฏุงูู ุ ููููู ุฅูุดุงุก ูุงุฆู <code>SystemCallContext</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุฏ ุชุจุฏู ุทุฑููุฉ ุญูุธ ุงููุงุชูุฑุฉ ุนูู ูุณุชูู ุงูุฎุฏูุฉ ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DocumentService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@CelestaTransaction</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CallContext context, OrderDto doc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (OrderHeaderCursor header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderHeaderCursor(context); OrderLineCursor line = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderLineCursor(context)) { header.setId(doc.getId()); header.setDate(Date.from(doc.getDate().atStartOfDay(ZoneId.systemDefault()).toInstant())); header.setCustomer_id(doc.getCustomerId()); header.setCustomer_name(doc.getCustomerName()); header.insert(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lineNo = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (OrderLineDto docLine : doc.getLines()) { lineNo++; line.setLine_no(lineNo); line.setOrder_id(doc.getId()); line.setItem_id(docLine.getItemId()); line.setQty(docLine.getQty()); line.insert(); } } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุงูุชุนููู ุงูุชูุถูุญู <code>@CelestaTransaction</code> .  ุจูุถู ุฐูู ุ ุณูููู ุงููุงุฆู ุงููููู <code>DocumentService</code> ุจุชูููุฐ ุฌููุน ุฅุฌุฑุงุกุงุช ุงูุฎุฏูุฉ ูุฐู ุจุงุณุชุฎุฏุงู ูุนููุฉ <code>CallContext ctx</code> ุงูููุถุญุฉ ุฃุนูุงู.  ููุฐุง ูู ุ ูู ุจุฏุงูุฉ ุชูููุฐ ุงูุทุฑููุฉ ุ ุณูููู ุจุงููุนู ูุฑุชุจุทูุง ุจุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุณุชููู ุงููุนุงููุฉ ุฌุงูุฒุฉ ููุจุฏุก.  ูููููุง ุงูุชุฑููุฒ ุนูู ูุชุงุจุฉ ููุทู ุงูุนูู.  ูู ุญุงูุชูุง ุ ูุฑุงุกุฉ ูุงุฆู <code>OrderDto</code> ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ููููุงู ุจุฐูู ุ ูุญู ูุณุชุฎุฏู ูุง ูุณูู ุงููุคุดุฑุงุช - ุงูุทุจูุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู <code>celesta-maven-plugin</code> .  ููุฏ ุฑุฃููุง ุจุงููุนู ูุง ูู ุนููู.  ูุชู ุฅูุดุงุก ูุฆุฉ ูุงุญุฏุฉ ููู ูุงุฆู ูู ูุงุฆูุงุช ุงููุฎุทุท - ุฌุฏููุงู ูุทุฑููุฉ ุนุฑุถ ูุงุญุฏุฉ.  ูุงูุขู ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงููุฆุงุช ูููุตูู ุฅูู ูุงุฆูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููุทู ุฃุนูุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ูุคุดุฑ ุนูู ุฌุฏูู ุงูุทูุจุงุช ูุชุญุฏูุฏ ุงูุณุฌู ุงูุฃูู ุ ุชุญุชุงุฌ ุฅูู ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">OrderHeaderCursor header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderHeaderCursor(context); header.tryFirst();</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅูุดุงุก ูุงุฆู ุงูุฑุฃุณ ุ ูููููุง ุงููุตูู ุฅูู ุญููู ุฅุฏุฎุงู ุงูุฌุฏูู ูู ุฎูุงู getters ู setters: </p><br><div style="text-align:center;;text-align:right;direction:rtl"><img width="450" src="https://habrastorage.org/webt/_8/gl/9i/_8gl9ikjbprpjano2dbvj0reme8.png"></div><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุฅูุดุงุก ูุคุดุฑ ุ ูุฌุจ ุฃู ูุณุชุฎุฏู ุณูุงู ุงูุงุชุตุงู ุงููุดุท - ูุฐู ูู ุงูุทุฑููุฉ ุงููุญูุฏุฉ ูุฅูุดุงุก ูุคุดุฑ.  ูุญูู ุณูุงู ุงูุงุชุตุงู ูุนูููุงุช ุญูู ุงููุณุชุฎุฏู ุงูุญุงูู ูุญููู ุงููุตูู ุงูุฎุงุตุฉ ุจู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ูุงุฆู ุงููุคุดุฑ ุ ูููููุง ุงูููุงู ุจุฃุดูุงุก ูุฎุชููุฉ: ุงูุชุตููุฉ ูุชุตูุญ ุงูุณุฌูุงุช ูุฃูุถูุง ุฅุฏุฑุงุฌ ุงูุณุฌูุงุช ูุญุฐููุง ูุชุญุฏูุซูุง ุจุดูู ุทุจูุนู.  ูุชู ูุตู API ุงููุคุดุฑ ุจุงููุงูู ุจุงูุชูุตูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> . </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุชุทููุฑ ุฑูุฒ ูุซุงููุง ุนูู ุงููุญู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">OrderHeaderCursor header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderHeaderCursor(context); header.setRange(<span class="hljs-string"><span class="hljs-string">"manager_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"manager1"</span></span>); header.tryFirst(); header.setCounter(header.getCounter() + <span class="hljs-number"><span class="hljs-number">1</span></span>); header.update();</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงููุซุงู ุ ูููุง ุจุชุนููู ุนุงูู ุงูุชุตููุฉ ุญุณุจ ุงูุญูู manager_id ุ ุซู ูุฌุฏ ุงูุณุฌู ุงูุฃูู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ tryFirst. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">(ููุงุฐุง "ุฌุฑุจ")</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชุญุชูู ุฃุณุงููุจ <code>get</code> ุ <code>first</code> ุ <code>insert</code> ุ <code>update</code> ุนูู ุฎูุงุฑูู: ุจุฏูู ุจุงุฏุฆุฉ try (ููุท <code>get(...)</code> ุ ููุง ุฅูู ุฐูู) ููุน ุจุงุฏุฆุฉ try ( <code>tryGet(...)</code> ุ <code>tryFirst()</code> ุ ุฅูุฎ) .  ุงูุฃุณุงููุจ ุฏูู ุจุงุฏุฆุฉ ุงููุญุงููุฉ ุฑูู ุงุณุชุซูุงุก ุฅุฐุง ูุงูุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ุชุญุชูู ุนูู ุงูุจูุงูุงุช ุงูููุงุณุจุฉ ูุชูููุฐ ุงูุฅุฌุฑุงุก.  ุนูู ุณุจูู ุงููุซุงู ุ ุฃูููุง () ุณูู ูุฑูู ุงุณุชุซูุงุกูุง ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุณุฌูุงุช ูู ุนุงูู ุงูุชุตููุฉ ุนูู ุงููุคุดุฑ.  ูู ุงูููุช ููุณู ุ ูุง ุชุคุฏู ุงูุทุฑู ุงูุชู ุชุญุชูู ุนูู ุจุงุฏุฆุฉ ุงููุญุงููุฉ ุฅูู ุงุณุชุซูุงุก ุ ูููููุง ุชูุฑุฌุน ุจุฏูุงู ูู ุฐูู ูููุฉ ููุทููุฉ ุชุดูุฑ ุฅูู ูุฌุงุญ ุฃู ูุดู ุงูุนูููุฉ ุงูููุงุจูุฉ.  ุงูููุงุฑุณุฉ ุงูููุตู ุจูุง ูู ุงุณุชุฎุฏุงู ุงูุทุฑู ุฏูู ุจุงุฏุฆุฉ ุงููุญุงููุฉ ูููุง ุฃููู ุฐูู.  ุจูุฐู ุงูุทุฑููุฉ ุ ูุชู ุฅูุดุงุก ุฑูุฒ "ุงูุงุฎุชุจุงุฑ ุงูุฐุงุชู" ุ ููุง ูุดูุฑ ุฅูู ูุฌูุฏ ุฃุฎุทุงุก ูู ุงูููุช ุงูููุงุณุจ ูู ุจูุงูุงุช ุงูููุทู ู / ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p></div></div><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง <code>tryFirst</code> ุชุดุบูู <code>tryFirst</code> ุ ูุชู ุชุนุจุฆุฉ ูุชุบูุฑุงุช <code>tryFirst</code> ุจุจูุงูุงุช ุณุฌู ูุงุญุฏ ุ ูููููุง ูุฑุงุกุฉ ุงูููู ูุชุนููููุง ููู.  ูุนูุฏูุง ูุชู ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุงููุคุดุฑ ุจุงููุงูู ุ ูููู ุจุชูููุฐ <code>update()</code> ุ ููููู ุจุชุฎุฒูู ูุญุชููุงุช ุงููุคุดุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุง ุงููุดููุฉ ุงูุชู ูุฏ ุชุชุฃุซุฑ ูุฐู ุงูุดูุฑุฉุ  ุจุงูุทุจุน ุ ุธููุฑ ุญุงูุฉ ุงูุณุจุงู / ุชุญุฏูุซ ุงูููููุฏุฉ!  ูุฃูู ุจูู ุงููุญุธุฉ ุงูุชู ุชููููุง ูููุง ุงูุจูุงูุงุช ูู ุงูุณุทุฑ "tryFirst" ูุจูู ุงููุญุธุฉ ุงูุชู ูุญุงูู ูููุง ุชุญุฏูุซ ูุฐู ุงูุจูุงูุงุช ุนูุฏ ููุทุฉ "ุงูุชุญุฏูุซ" ุ ูููู ูุดุฎุต ุขุฎุฑ ุงุณุชูุงู ูุฐู ุงูุจูุงูุงุช ูุชุนุฏูููุง ูุชุญุฏูุซูุง ุจุงููุนู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุจุนุฏ ูุฑุงุกุฉ ุงูุจูุงูุงุช ุ ูููุน ุงููุคุดุฑ ุจุฃู ุดูู ูู ุงูุฃุดูุงู ุงุณุชุฎุฏุงููุง ูู ูุจู ุงููุณุชุฎุฏููู ุงูุขุฎุฑูู!  ููุญูุงูุฉ ูู ุงูุชุญุฏูุซุงุช ุงูููููุฏุฉ ุ ูุณุชุฎุฏู Celesta ูุจุฏุฃ ุงูููู ุงููุชูุงุฆู.  ูู ูู ุฌุฏูู ุ ูููู Celesta ุงูุชุฑุงุถููุง ุจุฅูุดุงุก ุญูู <code>recversion</code> ุ ูุนูู ูุณุชูู ON ูู UPDATE ูุคุฏู ุฅูู ุฒูุงุฏุฉ ุฑูู ุงูุฅุตุฏุงุฑ ูุงูุชุญูู ูู ุฃู ุงูุจูุงูุงุช ุงููุญุฏุซุฉ ููุง ููุณ ุฅุตุฏุงุฑ ุงูุฌุฏูู.  ูู ุญุงูุฉ ุญุฏูุซ ูุดููุฉ ุ ูููู ุงุณุชุซูุงุก.  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู ูุฐุง ุงูููุถูุน ูู ุงูููุงูุฉ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญูุงูุฉ ุถุฏ ุงูุชุญุฏูุซุงุช ุงูููููุฏุฉ</a> ". </p><br><p style=";text-align:right;direction:rtl">  ุฃุฐูุฑ ูุฑุฉ ุฃุฎุฑู ุฃู ุงููุนุงููุฉ ูุฑุชุจุทุฉ ุจูุงุฆู CallContext.  ุฅุฐุง ูุฌุญ ุงูุฅุฌุฑุงุก Celesta ุ ูุญุฏุซ ุงูุชุฒุงู.  ุฅุฐุง ุงูุชูุช ุทุฑููุฉ Celesta ูุน ุงุณุชุซูุงุก ุบูุฑ ูุนุงููุฌ ุ ูุฅู ุงูุงุณุชุนุงุฏุฉ ุชุญุฏุซ.  ูุจุงูุชุงูู ุ ุฅุฐุง ุญุฏุซ ุฎุทุฃ ูู ุจุนุถ ุงูุฅุฌุฑุงุกุงุช ุงููุนูุฏุฉ ุ ูุชู ุงูุชุฑุงุฌุน ุนู ุงููุนุงููุฉ ุจุงููุงูู ุงููุชุนููุฉ ุจุณูุงู ุงูุงุชุตุงู ุ ููุง ูู ุฃููุง ูู ูุจุฏุฃ ูู ูุนู ุฃู ุดูุก ูุน ุงูุจูุงูุงุช ุ ูุงูุจูุงูุงุช ุบูุฑ ูุนุทูุจุฉ.  ุฅุฐุง ุงุญุชุฌุช ูุณุจุจ ูุง ุฅูู ุงูุชุฒุงู ูู ููุชุตู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฌุฑุงุก ูุจูุฑ ุ ููููู ุชูููุฐ ุงูุชุฒุงู ุตุฑูุญ ูู ุฎูุงู ุงุณุชุฏุนุงุก <code>context.commit()</code> . </p><br><h2 id="testirovanie-metodov-rabotayuschih-s-dannymi" style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑ ุทุฑู ุงูุจูุงูุงุช </h2><br><p style=";text-align:right;direction:rtl">  ูููู ุจุฅูุดุงุก ุงุฎุชุจุงุฑ ูุญุฏุฉ ูุชุญูู ูู ุตุญุฉ ุทุฑููุฉ ุงูุฎุฏูุฉ ุงูุชู ุชุฎุฒู <code>OrderDto</code> ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงุณุชุฎุฏุงู JUnit5 ูููุญู JUnit5 ุงููุชุงุญ ูู <code>celesta-unit</code> ุ ูููู ุฐูู ุณููุงู ููุบุงูุฉ.  ูููู ุงูุงุฎุชุจุงุฑ ุนูู ุงููุญู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@CelestaTest</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DocumentServiceTest</span></span></span><span class="hljs-class"> </span></span>{ DocumentService srv = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DocumentService(); <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">documentIsPutToDb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CallContext context)</span></span></span><span class="hljs-function"> </span></span>{ OrderDto doc =... srv.postOrder(context, doc); <span class="hljs-comment"><span class="hljs-comment">//Check the fact that records are in the database OrderHeaderCursor header = new OrderHeaderCursor(context); header.tryFirst(); assertEquals(doc.getId(), header.getId()); OrderLineCursor line = new OrderLineCursor(context); line.setRange("order_id", doc.getId()); assertEquals(2, line.count()); } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจูุถู ุงูุดุฑุญ <code>@CelestaTest</code> ุ ููู ุงูุชุฏุงุฏ ูู JUnit5 ุ ูููููุง ุฅุนูุงู ูุนููุฉ <code>CallContext context</code> ูู ุทุฑู ุงูุงุฎุชุจุงุฑ.  ูุฐุง ุงูุณูุงู ููุนู ุจุงููุนู ููุฑุชุจุท ุจูุงุนุฏุฉ ุงูุจูุงูุงุช (ูู ุงูุฐุงูุฑุฉ H2) ุ ูุจุงูุชุงูู ูุญู ูุณูุง ุจุญุงุฌุฉ ุฅูู ุงูุชูุงู ูุฆุฉ ุงูุฎุฏูุฉ ูู ุงูุฎุงุฏู ุงููููู - ููุญู ููุดุฆูุง ุจุงุณุชุฎุฏุงู <code>new</code> ุ ูููุณ ุจุงุณุชุฎุฏุงู Spring.  ููุน ุฐูู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูู ุจุฅุฏุฎุงู ุงูุฎุฏูุฉ ูู ุงูุงุฎุชุจุงุฑ ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช Spring ุ ููุง ุชูุฌุฏ ุนูุงุฆู ุฃูุงู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุจุฅูุดุงุก ุงุฎุชุจุงุฑุงุช ูุญุฏุฉ ุนูู ุงูุชุฑุงุถ ุฃูู ุจุญููู ููุช ุชูููุฐูุง ุ ุณุชููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ ุชูุงููุง ุ ูููู ูุน ุงูุจููุฉ ุงูุชู ูุญุชุงุฌูุง ุ ูุจุนุฏ ุชูููุฐูุง ุ ูุง ูููููุง ุงูููู ุจุดุฃู ุญูููุฉ ุฃููุง ุชุฑููุง "ุงูุจูุงูุงุช ุงูููููุฉ" ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ูุชู ุฅุฌุฑุงุก ูุฐู ุงูุงุฎุชุจุงุฑุงุช ุจุณุฑุนุฉ ุนุงููุฉ ุฌุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุจุฅูุดุงุก ุฅุฌุฑุงุก ุซุงูู ููุฑุฌุน JSON ุจููู ูุฌูุนุฉ ุชูุถุญ ุนุฏุฏ ุงูููุชุฌุงุช ุงูุชู ุทูุจูุงูุง. </p><br><p style=";text-align:right;direction:rtl">  ููุชุจ ุงูุงุฎุชุจุงุฑ ุฃูุฑูู ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุจุนุฏ ุฐูู ูุชุญูู ูู ุงููููุฉ ุงูุฅุฌูุงููุฉ ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ุฃุณููุจ <code>getAggregateReport</code> ุงูุฌุฏูุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reportReturnsAggregatedQuantities</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CallContext context)</span></span></span><span class="hljs-function"> </span></span>{ srv.postOrder(context, . . .); srv.postOrder(context, . . .); Map&lt;String, Integer&gt; result = srv.getAggregateReport(context); assertEquals(<span class="hljs-number"><span class="hljs-number">5</span></span>, result.get(<span class="hljs-string"><span class="hljs-string">"A"</span></span>).intValue()); assertEquals(<span class="hljs-number"><span class="hljs-number">7</span></span>, result.get(<span class="hljs-string"><span class="hljs-string">"B"</span></span>).intValue()); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุทุจูู ุทุฑููุฉ <code>getAggregateReport</code> ุณูุณุชุฎุฏู ุทุฑููุฉ ุงูุนุฑุถ OrderedQty ุ ุงูุชู ุฃุฐูุฑูุง ุ ูู ููู CelestaSQL ูุจุฏู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> OrderedQty <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> item_id, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(qty) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> qty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> OrderLine <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> item_id;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุทูุจ ููุงุณู: ููุฎุต ุฎุทูุท ุงูุทูุจ ุญุณุจ ุงููููุฉ ูุชุฌููุนูุง ุญุณุจ ููุฏ ุงูููุชุฌ.  ุชู ุจุงููุนู ุฅูุดุงุก ูุคุดุฑ OrderedQtyCursor ููุนุฑุถ ุ ูุงูุฐู ูููููุง ุงุณุชุฎุฏุงูู.  ูุนูู ูุฐุง ุงููุคุดุฑ ูููุฑุฑู ููุฌูุน <code>Map&lt;String, Integer&gt;</code> ุงููุทููุจุฉ <code>Map&lt;String, Integer&gt;</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@CelestaTransaction</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Map&lt;String, Integer&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAggregateReport</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CallContext context)</span></span></span><span class="hljs-function"> </span></span>{ Map&lt;String, Integer&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (OrderedQtyCursor ordered_qty = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderedQtyCursor(context)) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (OrderedQtyCursor line : ordered_qty) { result.put(ordered_qty.getItem_id(), ordered_qty.getQty()); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><h2 id="materializovannye-predstavleniya-celesta" style=";text-align:right;direction:rtl">  ูุชุญูู ุณูููุณุชุง ุงููุดุงูุฏุงุช </h2><br><p style=";text-align:right;direction:rtl">  ููุงุฐุง ุชุณุชุฎุฏู ุทุฑููุฉ ุนุฑุถ ุณูุฆุฉ ููุญุตูู ุนูู ุงูุจูุงูุงุช ุงููุฌูุนุฉุ  ูุฐุง ุงูููุฌ ุนููู ููุบุงูุฉ ุ ููููู ูู ุงููุงูุน ูุถุน ููุจูุฉ ููููุชุฉ ูู ูุธุงููุง ุจุฃูููู: ุจุนุฏ ูู ุดูุก ุ ูุฅู ุทุฑููุฉ ุงูุนุฑุถ ุ ููู ุงุณุชุนูุงู SQL ุ ุชุนูู ุจุดูู ุฃุจุทุฃ ูุฃุจุทุฃ ูุน ุชุฑุงูู ุงูุจูุงูุงุช ูู ุงููุธุงู.  ุณูุชุนูู ุนููู ุชูุฎูุต ูุชุฌููุน ุงููุฒูุฏ ูุงููุฒูุฏ ูู ุงูุฎุทูุท.  ููููุฉ ุชุฌูุจ ูุฐุงุ </p><br><p style=";text-align:right;direction:rtl">  ูุญุงูู Celesta ุชูููุฐ ุฌููุน ุงูููุงู ุงูููุงุณูุฉ ุงูุชู ููุงุฌููุง ูุจุฑูุฌู ููุทู ุงูุฃุนูุงู ุจุงุณุชูุฑุงุฑ ุนูู ูุณุชูู ุงููุธุงู ุงูุฃุณุงุณู. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู MS SQL Server ุนูู ููููู ุทุฑู ุงูุนุฑุถ ุงูููููุณุฉ (ุงููููุฑุณุฉ) ุ ูุงูุชู ูุชู ุชุฎุฒูููุง ูุฌุฏุงูู ููุชู ุชุญุฏูุซูุง ุจุณุฑุนุฉ ูุน ุชุบูุฑ ุงูุจูุงูุงุช ูู ุงูุฌุฏุงูู ุงููุตุฏุฑ.  ุฅุฐุง ููุง ูุนูู ูู MS SQL Server "ูุธูู" ุ ูุจุงููุณุจุฉ ูุญุงูุชูุง ุ ูุฅู ุงุณุชุจุฏุงู ุทุฑููุฉ ุงูุนุฑุถ ุจุทุฑููุฉ ูููุฑุณุฉ ุณูููู ูู ูุง ูุญุชุงุฌู: ุงุณุชุฑุฏุงุฏ ุงูุชูุฑูุฑ ุงููุฌูุน ูู ูุชุจุงุทุฃ ูุน ุชุฑุงูู ุงูุจูุงูุงุช ุ ูุณูุชู ุชูููุฐ ุงูุนูู ุนูู ุชุญุฏูุซ ุงูุชูุฑูุฑ ุงูุชุฌููุนู ูู ุงูููุช ุงูุญุงูู ุฅุฏุฎุงู ุงูุจูุงูุงุช ูู ุฌุฏูู ุฎุทูุท ุงูุทูุจ ููู ูุฒูุฏ ุฃูุถูุง ูุน ุฒูุงุฏุฉ ุนุฏุฏ ุงูุตููู. </p><br><p style=";text-align:right;direction:rtl">  ููู ูู ุญุงู ุนูููุง ูุน PostgreSQL ูู ุฎูุงู Celesta ุ ูุงุฐุง ูููููุง ุฃู ููุนูุ  ุฃุนุฏ ุชุนุฑูู ุงูุนุฑุถ ุจุฅุถุงูุฉ ุงููููุฉ ุงูููููุณุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">materialized</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> OrderedQty <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> item_id, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(qty) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> qty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> OrderLine <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> item_id;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุจุฏุฃ ุงููุธุงู ููุฑู ูุง ุญุฏุซ ููุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุณููุงุญุธ ุฃู <code>OrderedQty</code> ูุฏ ุงุฎุชูุช ุ ููุฏ ุธูุฑ ุฌุฏูู <code>OrderedQty</code> .  ุนูุงูุฉ ุนูู ุฐูู ุ ุจูุง ุฃู ุฌุฏูู OrderLine ูููุก ุจุงูุจูุงูุงุช ุ ุณูุชู ุชุญุฏูุซ ุงููุนูููุงุช ุงูููุฌูุฏุฉ ูู ุฌุฏูู OrderedQty "ุจุทุฑููุฉ ุณุญุฑูุฉ" ุ ููุง ูู ูุงู OrderedQty ุณูููู ุทุฑููุฉ ุนุฑุถ. </p><br><p style=";text-align:right;direction:rtl">  ูุง ููุฌุฏ ุณุญุฑ ููุง ุฅุฐุง ูุธุฑูุง ุฅูู ุงููุดุบูุงุช ุงููุจููุฉ ุนูู ุฌุฏูู <code>OrderLine</code> .  ุจุนุฏ ุฃู ุชููู Celesta ูููุฉ ุฅูุดุงุก "ุนุฑุถ ููููุณ" ุ ูุงู ุจุชุญููู ุงูุงุณุชุนูุงู ูุฅูุดุงุก ูุดุบูุงุช ุนูู ุฌุฏูู <code>OrderLine</code> ุงูุฐู ูููู ุจุชุญุฏูุซ <code>OrderedQty</code> .  ุจุฅุฏุฎุงู ูููุฉ ุฃุณุงุณูุฉ ูุงุญุฏุฉ - <code>materialized</code> - ูู ููู CelestaSQL ุ ุญูููุง ูุดููุฉ ุชุฏููุฑ ุงูุฃุฏุงุก ุ ููู ููู ูู ุงูุถุฑูุฑู ุชุบููุฑ ุฑูุฒ ููุทู ุงูุนูู! </p><br><p style=";text-align:right;direction:rtl"> ,    ,   , . ยซยป  Celesta    ,    ,  JOIN-,    GROUP BY.     ,  , ,     ,      . .     . </p><br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><p style=";text-align:right;direction:rtl">       Celesta.     โ    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar455746/">https://habr.com/ru/post/ar455746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar455736/index.html">ุฅุฌูุงุน ูู ุงูุนููุงุช ุงููุดูุฑุฉ ูุน ุงูุชุนุฏูู ุงููุฎุชูุท ูุงููุชุนุฏุฏ</a></li>
<li><a href="../ar455738/index.html">ููู ุชุตูุน ูููุงุฑ ูู ุชุณููู ุจูุงูุงุชูุ</a></li>
<li><a href="../ar455740/index.html">ุงูุชุนูู ุงูุขูู ูู ุดุฑูุฉ ุงุณุชุซูุงุฑ: ูููู ุจุชุตููู ููุงููุงุช ุงูุฏุนู ุงูููู</a></li>
<li><a href="../ar455742/index.html">ุตูุน ุงูููุณููู: ุนูุฏูุง ุชุชููู ุงูุญููู ุงูุจุณูุทุฉ ุนูู ุงูุชุนูู ุงูุนููู</a></li>
<li><a href="../ar455744/index.html">ุงููุชุงูุฉ ูุธุงู ุฌูู ุงูููุงุธุฑ ุงูุทุจูุนูุฉ ูุน ุงููุงูุนูุฉ ุงูุจุตุฑูุฉ ุงููุญุณูุฉ [ุชุฑุฌูุฉ ุงูููุงู ูู ูุจู ุฌูููู ููู]</a></li>
<li><a href="../ar455754/index.html">ุงุฎุชุจุงุฑุงุช stratostat ุงูุงูุฌุฑุงู. ุฅุทูุงู ุฑูุบูุฒูู ูููุฑุง ูู ุงูุณุชุฑุงุชูุณููุฑ</a></li>
<li><a href="../ar455756/index.html">ูู [ุตุงูุญ] ุงู</a></li>
<li><a href="../ar455758/index.html">ูุฑุตูุฉ ุงูููู ูู ุตุงุฑูุฎ ุงูุจูุน ุจุงูุชุฌุฒุฆุฉ: ูู ูุฑุถูุฉ ุงูุจุญุซ ุฅูู ุชูููุงุช ุงูุงุฎุชุจุงุฑ</a></li>
<li><a href="../ar455760/index.html">ุณุญุฑ SwiftUI ุฃู ุญูู ููุดุฆู ุงููุธููุฉ</a></li>
<li><a href="../ar455762/index.html">ููุฏูุฉ ููุฌุฒุฉ ูุณูุงุณู ูุงุฑููู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>