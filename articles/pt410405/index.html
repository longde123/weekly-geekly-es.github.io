<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí™üèª üö∂ üë©üèΩ‚Äçüè´ Sistema de Aquisi√ß√£o de Dados na ESP. Parte I. CO2 üö£üèª üå∞ üéµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bom dia Neste artigo, quero falar sobre a implementa√ß√£o de dispositivos nos m√≥dulos ESP. O t√≥pico de dispositivos semelhantes j√° foi divulgado na Inte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistema de Aquisi√ß√£o de Dados na ESP. Parte I. CO2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/410405/"> Bom dia  Neste artigo, quero falar sobre a implementa√ß√£o de dispositivos nos m√≥dulos ESP.  O t√≥pico de dispositivos semelhantes j√° foi divulgado na Internet, mas n√£o deixa de ser relevante. <br><img src="https://habrastorage.org/webt/85/au/eq/85aueqa-qfotfuc69mmwk7pbmnq.jpeg"><a name="habracut"></a>  <b>Id√©ia</b> <br><br>  H√° muito tempo penso em implementar um determinado sistema de exibi√ß√£o e controle em um apartamento, mas n√£o consegui encontrar aplicativos para os sensores dispon√≠veis para venda, especificamente para mim.  A primeira coisa que confundiu foi a presen√ßa de um determinado servidor (um peda√ßo de ferro separado) que coleta dados, processa e os joga em algum lugar para visualiza√ß√£o.  Eu gostaria de ter um sistema escal√°vel de dispositivos independentes, de prefer√™ncia trabalhando com um aplicativo, de maneira ideal, se o aplicativo estiver pronto, o que parecia quase imposs√≠vel (olhando para o futuro, direi que existe um aplicativo assim e ele pode ser configurado de maneira bastante flex√≠vel para nossas tarefas).  E √© claro que eu queria fazer uma linha dos meus dispositivos. <br><br>  <b>Requisitos de sistema</b> <br><br><ol><li>  Falta de servidor de hardware ("Unidade central"). </li><li>  Sensores / controles independentes. </li><li>  Os sensores devem ser sem fio. </li><li>  Ao alterar a composi√ß√£o e os tipos de sensores, n√£o deve haver depend√™ncia (n√£o √© necess√°rio adicionar um novo dispositivo para "ver" algo nos outros). </li><li>  Se poss√≠vel, os sensores devem ser alimentados por bateria. </li><li>  Se necess√°rio, os sensores devem ser capazes de configurar, mas sem se aprofundar no c√≥digo (otimizado da Web). </li><li>  Notifica√ß√µes.  Este √© um requisito separado.  Estamos acostumados a usar telefones celulares e receber notifica√ß√µes instantaneamente. </li></ol><br>  Esta n√£o √© uma lista completa de "Lista de desejos", mas estas s√£o as principais. <br><br>  <b>Procure uma solu√ß√£o</b> <br><br>  A solu√ß√£o para criar o sistema veio um pouco mais tarde.  Primeiro, o primeiro dispositivo foi desenvolvido, sobre o qual vou escrever neste artigo. <br><br>  Pe√ßa de hardware.  ESP-12E e ESP32.  Todos os projetos descritos abaixo s√£o implementados no primeiro m√≥dulo.  O segundo m√≥dulo possui v√°rios projetos comerciais que n√£o ser√£o considerados neste artigo. <br><br>  Existem muitos artigos e f√≥runs na Internet sobre o ESP-12E, e n√£o vou repetir sobre todos os pr√≥s e contras.  Todos os "plugues" ocorreram principalmente devido √† falta de experi√™ncia no trabalho com o m√≥dulo e com o meio ambiente, em princ√≠pio. <br><br><img src="https://habrastorage.org/webt/j6/bb/aa/j6bbaaawco5ytnkte4mw5qtag2c.jpeg"><br>  <i>Figura 1. Foto do ESP-12E.</i> <br><br>  A parte do software.  O firmware do ESP foi escrito no IDE do Arduino.  O aplicativo Blynk est√° sendo executado na lateral do telefone / tablet.  Este √© um construtor muito conveniente para exibir dados.  O aplicativo possui um servidor na nuvem em que dispositivos (sensores) enviam dados, e Blynk os recebe e permite exibi-los (www.blynk.cc).  Da mesma forma, o feedback √© organizado com o dispositivo.  Importante, um √∫nico aplicativo pode coletar e exibir dados de v√°rios dispositivos. <br><br><img src="https://habrastorage.org/webt/jd/zf/yz/jdzfyzmdxnywx1kkcxedbn6ru8q.png"><br><br><img src="https://habrastorage.org/webt/iu/e5/mi/iue5mivk9phy0yb2jro75v3rtze.jpeg"><br>  <i>Figura 2. Capturas de tela do aplicativo.</i> <br><br>  Posteriormente, publicaremos um artigo sobre software e links para as fontes.  Eu fa√ßo o hardware.  A implementa√ß√£o do software √© realizada pelo meu colega. <br><br>  <b>O primeiro trio de sensores</b> <br><br>  1. Sensor de di√≥xido de carbono <b><i>OpenWindAir</i></b> . <br><br>  Constru√≠do com base no m√≥dulo Wi-Fi ESP-12E.  A medi√ß√£o √© realizada usando o sensor de CO2 MH-Z19.  √â amplamente conhecido e permite que voc√™ fa√ßa medi√ß√µes com rapidez e precis√£o.  Al√©m disso, o dispositivo possui um sensor embutido de temperatura e umidade AM2302.  Tamb√©m h√° suporte para um sensor externo para uso, por exemplo, com o sistema de monitoramento de pessoas.  O dispositivo √© alimentado por miniUSB a partir de uma fonte de alimenta√ß√£o de PC ou 5V.  LEDs e alarmes sonoros implementados (o √∫ltimo pode ser desligado do aplicativo ou usado pelo rel√≥gio - para n√£o acordar √† noite). <br><br>  2. <b><i>LifeOfFlowers</i></b> Sensor de umidade do solo para plantas. <br><br>  Constru√≠do com base no m√≥dulo Wi-Fi ESP-12E.  A medi√ß√£o da umidade do solo ocorre usando um eletrodo preso no solo (parte da placa do dispositivo).  O que √© importante - o eletrodo, como toda a placa, √© envernizado (aqui eu tive que planejar com as medi√ß√µes), o que impedir√° a deteriora√ß√£o do contato.  Al√©m da umidade do solo, o dispositivo mede a umidade e a temperatura ambiente (AM2302), a luz e a voltagem da bateria.  Sim, o LifeOfFlowers funciona de 1 a 3 anos com duas pilhas AAA (o tempo de atividade depende da taxa de atualiza√ß√£o). <br><br>  3. <b><i>Aviso</i></b> Sensor de vazamento de √°gua. <br><br>  Constru√≠do com base no m√≥dulo Wi-Fi ESP-12E.  A medi√ß√£o √© realizada usando os eletrodos inclu√≠dos no gabinete IP-65.  O dispositivo √© alimentado por duas pilhas AAA (ou AA), o tempo de opera√ß√£o tamb√©m √© de 1 ano.  As dimens√µes do dispositivo s√£o de apenas 55x55x30mm.  Para come√ßar, voc√™ precisa colocar o dispositivo em um local potencialmente perigoso e sinalizar√° a presen√ßa de √°gua no ch√£o.  O aplicativo tamb√©m exibe a tens√£o das baterias, para n√£o esquecer de substitu√≠-las no prazo. <br><br>  <b>OpenWindAir - implementa√ß√£o de hardware</b> <br><br>  Aqui voc√™ n√£o pode encontrar detalhes de circuitos aqui, tudo √© simples e nas planilhas de dados.  Se algu√©m precisar de um circuito, eu posso dar. <br><br>  A composi√ß√£o do dispositivo: <br><br>  ESP8266 ESP-12E - o pr√≥prio m√≥dulo, respons√°vel pela coleta, processamento e envio de dados.  Fonte de alimenta√ß√£o 3.3V. <br>  MH-Z19 - sensor de concentra√ß√£o de di√≥xido de carbono.  Funciona em UART, mede at√© 5000ppm e √© alimentado por 5V. <br>  AM2302 - medi√ß√£o de umidade e temperatura.  Como o sensor est√° localizado dentro do alojamento, √© necess√°rio inserir constantes de calibra√ß√£o e os dados de medi√ß√£o s√£o para refer√™ncia.  Para medi√ß√µes mais precisas, √© usado um sensor remoto. <br><br>  1-1462037-8 (IM03TS) - rel√©, para comuta√ß√£o de baixa corrente, colocado apenas no caso, para jogar.  Em princ√≠pio, isso √© uma coisa interessante, mas eles ainda n√£o apresentaram aplicativos (s√£o enviados para o mesmo conector externo que o sensor de umidade externo). <br><br>  CP2102-GM - USB-UART.  Sim, decidimos fazer belos registros para exibir informa√ß√µes em tempo real, ficou muito conveniente, voc√™ pode assistir os dados no terminal, assistir a ordem de download, depurar. <br><br>  LM1117MP-ADJ - LDO para 3.3V. <br><br>  H√° tamb√©m um sinal sonoro, um par de bot√µes e tr√™s LEDs.  Al√©m dos limites de concentra√ß√£o de CO2, os LEDs indicam o processo de carregamento do dispositivo, conex√£o com um ponto de acesso (ou trabalho offline) e o processo de atualiza√ß√£o. <br><br>  O dispositivo implementa a atualiza√ß√£o OTA.  Lan√ßamos o firmware em qualquer servidor (ap√≥s a prescri√ß√£o), pressionamos o bot√£o, ligamos e o processo do firmware √© iniciado.  Depois de piscar (ou reiniciar) por um tempo especificado, voc√™ pode acessar a interface da Web (o dispositivo aparece como um ponto de acesso) e dirigir nas configura√ß√µes de rede - depois disso tudo est√° pronto para funcionar. <br><br><img src="https://habrastorage.org/webt/tw/xr/qq/twxrqqcpb_t9szkzqan7ch4qu4w.jpeg"><br>  <i>Fig 3. Foto da placa com componentes.</i> <br><br>  Quero escrever um pouco sobre a forma e os recursos da placa de circuito impresso.  Durante o teste, verificou-se que durante a opera√ß√£o de longo prazo do Wi-Fi, o m√≥dulo aquece a placa.  Isso n√£o seria cr√≠tico se o sensor interno de temperatura e umidade estivesse dentro do gabinete.  Eu tive que espalhar o m√≥dulo ESP com o alimentador e os sensores em diferentes dire√ß√µes, e tamb√©m fazer um recorte na placa, onde, como o designer, uma parti√ß√£o especial ainda est√° inserida.  Assim, n√£o h√° mistura de ar dentro do gabinete e as medi√ß√µes de temperatura e umidade s√£o muito mais confi√°veis. <br><br><img src="https://habrastorage.org/webt/gs/nn/ze/gsnnze6gsm7vhckw58ug61l5lf0.jpeg"><br>  <i>Figura 4. Foto da parti√ß√£o no quadro.</i> <br><br>  <b>Habita√ß√£o</b> <br><br>  Havia muitas d√∫vidas - eu queria ter um corpo bonito de metal, aerodin√¢mico, com uma faixa fosca de indica√ß√£o, etc., mas, como sempre, o minimalismo veio em socorro.  O fator de forma do caso determinou a presen√ßa de LEDs de 5 mm da velha escola, que, como se viu, s√£o muito convenientes.  Devido ao fato de serem convexos - isso permite que voc√™ coloque o dispositivo, por exemplo, em uma prateleira e a indica√ß√£o ainda estar√° claramente vis√≠vel.  O gabinete em si foi cortado a laser em acr√≠lico de 2 mm. <br><br>  Fizemos v√°rias op√ß√µes, em cores diferentes e com uma combina√ß√£o de cores, al√©m de diferentes materiais.  Parece muito decente.  Eu at√© tentei faz√™-lo de PCB imediatamente com a ordem das placas de circuito impresso.  No momento, estamos pensando na op√ß√£o de fabricar o caso na produ√ß√£o, mas at√© agora isso est√° apenas nos planos.  Eu tamb√©m posso criar modelos. <br><br><img src="https://habrastorage.org/webt/tc/qd/cr/tcqdcro5aqh9f8jbiyhkhly3d_0.jpeg"><br>  <i>Fig 5. Foto do dispositivo.</i> <br><br>  <b>Planos</b> <br><br>  Em geral, h√° planos de fabricar mais dispositivos (al√©m desses tr√™s).  Por exemplo, o ESP32 possui Ethernet integrada (voc√™ s√≥ precisa de f√≠sica) e mais ADCs integrados, o que permitir√° que voc√™ fique sem um multiplexador, como √© o caso do LifeOfFlowers, mas mais sobre isso posteriormente. <br><br>  <b>Amea√ßa.</b>  O Blynk possui uma API de servidor que pode ser facilmente implantada (marcada) em um PC.  Assim, a liga√ß√£o ao servidor desaparece. <br><br>  <b>ZZY.</b>  Ter menos negativo renomeado o artigo.  Quando passarmos a gerenciar a casa usando dispositivos, vou corrigir o artigo. <br><br>  Obrigado pela aten√ß√£o! <br><br>  ZZZY: Como prometido, aqui est√° um link para um artigo sobre software <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">geektimes.ru/post/122601</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt410405/">https://habr.com/ru/post/pt410405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt410389/index.html">John Romero no editor de blocos, que criou mais de 30 jogos</a></li>
<li><a href="../pt410391/index.html">Os donos dos direitos dos antigos jogos multiplayer resistem √†s tentativas dos entusiastas de reviv√™-los</a></li>
<li><a href="../pt410393/index.html">Passagem de V√™nus no disco do Sol e determina√ß√£o da dist√¢ncia entre eles</a></li>
<li><a href="../pt410399/index.html">Astr√¥nomo amador checou uma nova c√¢mera e acidentalmente fotografou um flash de supernova</a></li>
<li><a href="../pt410403/index.html">Escreva no Giktayms, √© legal</a></li>
<li><a href="../pt410409/index.html">O carro el√©trico Mask voltar√° do espa√ßo para a Terra?</a></li>
<li><a href="../pt410411/index.html">Fabricantes de carros inteligentes querem monetizar dados de clientes</a></li>
<li><a href="../pt410413/index.html">47% dos pais est√£o preocupados que o filho tenha um apego doloroso a um smartphone</a></li>
<li><a href="../pt410415/index.html">Os 17 recursos iOS mais √≥bvios que voc√™ talvez n√£o conhe√ßa</a></li>
<li><a href="../pt410417/index.html">Esqueceu-se de alterar o azimute: Ariane 5 resultados de investiga√ß√£o de incidentes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>