<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📋 🌉 👎🏿 Generación de música clásica usando una red neuronal recurrente 🐦 ♣️ 😋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy en día, las redes neuronales entrenadas hacen cosas asombrosas, pero los experimentos en esta área continúan descubriendo algo nuevo. Por ejemplo,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Generación de música clásica usando una red neuronal recurrente</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/382711/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hoy en día, las redes neuronales entrenadas hacen cosas asombrosas, pero los experimentos en esta área continúan descubriendo algo nuevo. </font><font style="vertical-align: inherit;">Por ejemplo, el programador Daniel Johnson </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publicó los resultados de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sus experimentos sobre el uso de redes neuronales para generar música clásica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desafortunadamente, no puede incrustar un archivo de audio en GT, por lo que debe proporcionar un enlace directo para escuchar uno de los resultados: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_2.mp3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Cómo lo hizo?</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daniel Johnson dice que se centró en la propiedad de la invariancia. La mayoría de las redes neuronales existentes para la generación de música son invariantes en el tiempo, pero no invariables en las notas. Por lo tanto, la transposición de un solo paso conducirá a un resultado completamente diferente. Para la mayoría de las otras aplicaciones, este enfoque funciona bien, pero no en la música. Aquí me gustaría lograr la armonía de las armonías. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daniel encontró solo un tipo de redes neuronales populares donde hay invariancia en varias direcciones: estas son redes neuronales convolucionales para el reconocimiento de imágenes. </font></font><br>
<br>
<img src="https://habrastorage.org/files/16a/6ac/0d3/16a6ac0d3e1348db82d29d7ff8933ee8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El autor adaptó el modelo convolucional, agregando una red neuronal recurrente para cada píxel con su propia memoria y reemplazando los píxeles con notas. Por lo tanto, recibió un sistema que es invariable tanto en el tiempo como en las notas.</font></font><br>
<br>
<img src="https://habrastorage.org/files/fb2/14b/4a8/fb214b4a885b4b40beb6199f3499467b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero en una red de este tipo no existe un mecanismo para obtener acordes armoniosos: en la salida, cada nota es completamente independiente de las demás. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para lograr una combinación de notas, Johnson usó un modelo como RNN-RBM, donde una parte de la red neuronal es responsable del tiempo, y la otra parte es para acordes consonantes. Para sortear las limitaciones de RBM, se le ocurrió la introducción de dos ejes: para el tiempo y para las notas (y un pseudoeje para la dirección de los cálculos). </font></font><br>
<br>
<img src="https://habrastorage.org/files/f28/4f3/dca/f284f3dca681410c91fc2164f58d937a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Theano</font></a><font style="vertical-align: inherit;"> Library</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El autor generó una red neuronal según su modelo. La primera capa con el eje de tiempo tomó los siguientes parámetros en la entrada: posición, tono, valor de las notas circundantes, contexto anterior, ritmo. Luego, se activaron bloques autogenerados basados ​​en memoria a corto plazo (LSTM): en uno, las conexiones recurrentes se dirigen a lo largo del eje del tiempo, en el otro a lo largo del eje de las notas. Después del bloque LSTM final, hay una capa simple no recurrente para emitir el resultado final, tiene dos valores de salida: la probabilidad de tocar para una nota en particular y la probabilidad de articulación (es decir, la probabilidad de que la nota se combine con otra). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante el entrenamiento, utilizamos un conjunto de fragmentos musicales cortos seleccionados al azar de la colección MIDI </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Classical Piano Midi Page</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Luego jugamos un poco con los logaritmos para que el parámetro de entropía cruzada en la salida fuera al menos no demasiado bajo. </font><font style="vertical-align: inherit;">Para garantizar la especialización de las capas, utilizamos una técnica como el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abandono</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cuando en cada paso del entrenamiento, la mitad de los nodos ocultos fueron excluidos accidentalmente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El modelo práctico consistió en dos capas ocultas en el tiempo, cada una de 300 nodos, y dos capas a lo largo del eje de notas, para 100 y 50 nodos, respectivamente. </font><font style="vertical-align: inherit;">La capacitación se realizó en la máquina virtual g2.2xlarge en la nube de Amazon Web Services.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resultados</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_1.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_2.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_3.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_4.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_5.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_6.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_7.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_8.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_9.mp3</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://hexahedria.com/files/nnet_music_10.mp3</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El código fuente del programa se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publica en Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es382711/">https://habr.com/ru/post/es382711/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es382699/index.html">La Biblioteca Británica pide ayuda para descifrar el grabado en una espada del siglo XIII.</a></li>
<li><a href="../es382701/index.html">По фильму «Джон Уик» сделают шутер от первого лица для VR-очков</a></li>
<li><a href="../es382703/index.html">Japón relanza sus centrales nucleares después de dos años de inactividad</a></li>
<li><a href="../es382705/index.html">Consejos para nuevas empresas de hardware</a></li>
<li><a href="../es382707/index.html">IBM Watson ayuda a predecir enfermedades crónicas en pacientes con CVS Health</a></li>
<li><a href="../es382713/index.html">Roccat Kone Pure Optical 2015. Minimalismo negro</a></li>
<li><a href="../es382715/index.html">Rastros de un lago salado encontrado en Marte</a></li>
<li><a href="../es382719/index.html">VPaint: un editor de gráficos vectoriales experimentales</a></li>
<li><a href="../es382721/index.html">Perseidas: informe del Observatorio de Radioastronomía de Pushchino</a></li>
<li><a href="../es382723/index.html">Los supercondensadores de 2000 mAh ya están disponibles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>