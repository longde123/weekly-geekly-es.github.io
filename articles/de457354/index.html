<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíç üòÑ üëÇüèø Datenverschleierung f√ºr Leistungstests üèì üéÖüèø üö∂üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ClickHouse-Benutzer wissen, dass der Hauptvorteil in der hohen Geschwindigkeit der Verarbeitung von analytischen Abfragen liegt. Aber wie k√∂nnen wir s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Datenverschleierung f√ºr Leistungstests</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/457354/">  ClickHouse-Benutzer wissen, dass der Hauptvorteil in der hohen Geschwindigkeit der Verarbeitung von analytischen Abfragen liegt.  Aber wie k√∂nnen wir solche Aussagen machen?  Dies sollte durch vertrauensw√ºrdige Leistungstests unterst√ºtzt werden.  Wir werden heute dar√ºber sprechen. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ds/2m/sd/ds2msd5-4zeahpzlzptlqz8wgs8.png"></a> <br><br>  Wir haben 2013 mit der Durchf√ºhrung solcher Tests begonnen, lange bevor das Produkt in Open Source verf√ºgbar wurde.  Nach wie vor waren wir am meisten an der Geschwindigkeit des Yandex.Metrica-Datendienstes interessiert.  Wir haben bereits seit Januar 2009 Daten in ClickHouse gespeichert.  Ein Teil der Daten wurde seit 2012 in die Datenbank geschrieben, und ein Teil wurde aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OLAPServer und Metrage konvertiert</a> - Datenstrukturen, die zuvor in Yandex.Metrica verwendet wurden.  Daher haben wir f√ºr die Tests die erste verf√ºgbare Teilmenge von 1 Milliarde Seitenaufrufdaten verwendet.  Es gab noch keine Abfragen in Metric, und wir haben Abfragen erstellt, die f√ºr uns selbst am interessantesten sind (alle Arten von Filterung, Aggregation und Sortierung). <br><br>  ClickHouse wurde im Vergleich zu √§hnlichen Systemen wie Vertica und MonetDB getestet.  Um ehrlich zu sein, wurde es von einem Mitarbeiter durchgef√ºhrt, der zuvor kein ClickHouse-Entwickler gewesen war, und bestimmte F√§lle im Code wurden erst optimiert, als die Ergebnisse erhalten wurden.  Ebenso haben wir einen Datensatz f√ºr Funktionstests erhalten. <br><br>  Nachdem ClickHouse 2016 Open Source beigetreten war, gab es weitere Fragen zu den Tests. <br><br><a name="habracut"></a><h2>  Nachteile von Tests mit propriet√§ren Daten </h2><br>  Leistungstests: <br><br><ol><li> Sie sind von au√üen nicht reproduzierbar, da f√ºr ihren Start geschlossene Daten erforderlich sind, die nicht ver√∂ffentlicht werden k√∂nnen.  Aus dem gleichen Grund stehen einige Funktionstests externen Benutzern nicht zur Verf√ºgung. </li><li>  Nicht entwickeln.  Es besteht die Notwendigkeit einer signifikanten Erweiterung ihres Satzes, so dass es m√∂glich ist, √Ñnderungen der Geschwindigkeit einzelner Teile des Systems auf isolierte Weise zu √ºberpr√ºfen. </li><li>  Sie werden nicht ordnungsgem√§√ü f√ºr Poolanforderungen ausgef√ºhrt. Externe Entwickler k√∂nnen ihren Code nicht auf Leistungsregressionen √ºberpr√ºfen. </li></ol><br>  Sie k√∂nnen diese Probleme l√∂sen - alte Tests wegwerfen und neue basierend auf offenen Daten erstellen.  Unter den offenen Daten k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Daten zu Fl√ºgen in die USA</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Taxifahrten in New York</a> oder vorgefertigte Benchmarks TPC-H, TPC-DS und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Star Schema Benchmark verwenden</a> .  Die Unannehmlichkeit besteht darin, dass diese Daten weit von Yandex.Metrica-Daten entfernt sind und ich Testanforderungen speichern m√∂chte. <br><br><h2>  Es ist wichtig, echte Daten zu verwenden. </h2><br>  Sie m√ºssen die Leistung des Dienstes nur an realen Daten aus der Produktion testen.  Schauen wir uns einige Beispiele an. <br><br>  <strong>Beispiel 1</strong> <br><br>  Angenommen, Sie f√ºllen eine Datenbank mit gleichm√§√üig verteilten Pseudozufallszahlen.  In diesem Fall funktioniert die Datenkomprimierung nicht.  Die Datenkomprimierung ist jedoch eine wichtige Eigenschaft f√ºr analytische DBMS.  Die Auswahl des richtigen Komprimierungsalgorithmus und der richtigen Integration in das System ist eine nicht triviale Aufgabe, bei der es keine richtige L√∂sung gibt, da die Datenkomprimierung einen Kompromiss zwischen der Komprimierungs- und Dekomprimierungsgeschwindigkeit und dem potenziellen Komprimierungsverh√§ltnis erfordert.  Systeme, die nicht wissen, wie man Daten komprimiert, verlieren garantiert.  Wenn wir jedoch gleichm√§√üig verteilte Pseudozufallszahlen f√ºr Tests verwenden, wird dieser Faktor nicht ber√ºcksichtigt und alle anderen Ergebnisse werden verzerrt. <br><br>  Schlussfolgerung: Die Testdaten sollten ein realistisches Komprimierungsverh√§ltnis aufweisen. <br><br>  √úber die Optimierung von Datenkomprimierungsalgorithmen in ClickHouse habe ich in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Beitrag gesprochen</a> . <br><br>  <strong>Beispiel 2</strong> <br><br>  Lassen Sie uns an der Geschwindigkeit der SQL-Abfrage interessiert sein: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> RegionID, uniq(UserID) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> visitors     <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> test.hits     <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> RegionID     <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> visitors <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br>  Dies ist eine typische Anfrage f√ºr Yandex.Metrica.  Was ist wichtig f√ºr seine Geschwindigkeit? <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wie wird GROUP BY durchgef√ºhrt</a> ? </li><li>  Welche Datenstruktur wird zur Berechnung der Aggregatfunktion uniq verwendet? </li><li>  Wie viele verschiedene RegionIDs sind und wie viel RAM jeder Status der Uniq-Funktion ben√∂tigt. </li></ul><br>  Es ist aber auch sehr wichtig, dass die Datenmenge f√ºr verschiedene Regionen ungleich verteilt ist.  (Wahrscheinlich wird es nach einem Potenzgesetz verteilt. Ich habe ein Diagramm in der Log-Log-Skala erstellt, bin mir aber nicht sicher.) Und wenn ja, ist es f√ºr uns wichtig, dass die Zust√§nde des Uniq-Aggregats mit einer kleinen Anzahl von Werten wenig Speicher ben√∂tigen.  Wenn es viele verschiedene Aggregationsschl√ºssel gibt, wird die Anzahl in Byteeinheiten angegeben.  Wie erhalte ich die generierten Daten mit all diesen Eigenschaften?  Nat√ºrlich ist es besser, echte Daten zu verwenden. <br><br>  Viele DBMS implementieren die HyperLogLog-Datenstruktur f√ºr die ungef√§hre Berechnung von COUNT (DISTINCT), aber alle funktionieren relativ schlecht, da diese Datenstruktur eine feste Speichermenge verwendet.  Und ClickHouse verf√ºgt √ºber eine Funktion, die je nach Gr√∂√üe des Sets eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kombination aus drei verschiedenen Datenstrukturen verwendet</a> . <br><br>  Schlussfolgerung: Die Testdaten sollten die Eigenschaften der Werteverteilung in den Daten darstellen - Kardinalit√§t (Anzahl der Werte in den Spalten) und gegenseitige Kardinalit√§t mehrerer verschiedener Spalten. <br><br>  <strong>Beispiel 3</strong> <br><br>  Lassen Sie uns die Leistung nicht des analytischen ClickHouse-DBMS testen, sondern von etwas Einfacherem, beispielsweise Hash-Tabellen.  F√ºr Hash-Tabellen ist die Auswahl der richtigen Hash-Funktion sehr wichtig.  F√ºr std :: unordered_map ist dies etwas weniger wichtig, da es sich um eine kettenbasierte Hash-Tabelle handelt und eine Primzahl als Gr√∂√üe des Arrays verwendet wird.  In der Standardbibliotheksimplementierung in gcc und clang wird eine triviale Hash-Funktion als Standard-Hash-Funktion f√ºr numerische Typen verwendet.  Aber std :: unordered_map ist nicht die beste Wahl, wenn wir maximale Geschwindigkeit erreichen wollen.  Bei Verwendung von Hash-Tabellen mit offener Adressierung wird die richtige Auswahl der Hash-Funktion zu einem entscheidenden Faktor, und wir k√∂nnen die triviale Hash-Funktion nicht verwenden. <br><br>  Es ist einfach, Leistungstests f√ºr Hash-Tabellen f√ºr zuf√§llige Daten zu finden, ohne die verwendeten Hash-Funktionen zu ber√ºcksichtigen.  Es ist auch leicht, Hash-Funktionstests zu finden, wobei der Schwerpunkt auf der Rechengeschwindigkeit und einigen Qualit√§tskriterien liegt, jedoch isoliert von den verwendeten Datenstrukturen.  Tatsache ist jedoch, dass Hash-Tabellen und HyperLogLog unterschiedliche Qualit√§tskriterien f√ºr Hash-Funktionen erfordern. <br><br><img src="https://habrastorage.org/webt/bp/3h/32/bp3h320eztrirqzhm-lexeuhmbq.png"><br><br>  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen</a> hierzu finden Sie im Bericht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûWie Hash-Tabellen in ClickHouse angeordnet sind‚Äú</a> .  Es ist etwas veraltet, da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schweizer Tische</a> nicht ber√ºcksichtigt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> . <br><br><h2>  Herausforderung </h2><br>  Wir m√∂chten, dass die Daten f√ºr Leistungstests f√ºr die Struktur dieselben wie f√ºr Yandex.Metrica-Daten sind, f√ºr die alle f√ºr Benchmarks wichtigen Eigenschaften gespeichert sind, damit in diesen Daten jedoch keine Spuren von echten Website-Besuchern zur√ºckbleiben.  Das hei√üt, die Daten sollten anonymisiert und Folgendes gespeichert werden: <br><br><ul><li>  Kompressionsverh√§ltnisse </li><li>  Kardinalit√§t (Anzahl verschiedener Werte), </li><li>  gegenseitige Kardinalit√§ten mehrerer verschiedener Spalten, </li><li>  Eigenschaften probabilistischer Verteilungen, mit denen Daten modelliert werden k√∂nnen (wenn wir beispielsweise glauben, dass Regionen nach einem Potenzgesetz verteilt sind, sollte der Exponent - der Verteilungsparameter - f√ºr k√ºnstliche Daten ungef√§hr der gleiche sein wie f√ºr real). </li></ul><br>  Und was wird ben√∂tigt, damit die Daten ein √§hnliches Komprimierungsverh√§ltnis haben?  Wenn beispielsweise LZ4 verwendet wird, sollten die Teilzeichenfolgen in den Bin√§rdaten in ungef√§hr denselben Abst√§nden wiederholt werden und die Wiederholungen sollten ungef√§hr dieselbe L√§nge haben.  F√ºr ZSTD wird eine Byte-Entropie-√úbereinstimmung hinzugef√ºgt. <br><br>  Das maximale Ziel: ein Tool f√ºr externe Personen verf√ºgbar zu machen, mit dem jeder seinen Datensatz f√ºr die Ver√∂ffentlichung anonymisieren kann.  Damit wir die Leistung von Daten anderer Personen debuggen und testen, √§hnlich wie Daten aus der Produktion.  Und ich m√∂chte, dass es interessant ist, die generierten Daten zu sehen. <br><br>  Dies ist eine informelle Erkl√§rung des Problems.  Es w√ºrde jedoch niemand eine formelle Erkl√§rung abgeben. <br><br><h2>  Versuche zu l√∂sen </h2><br>  Die Bedeutung dieser Aufgabe sollte f√ºr uns nicht √ºbertrieben werden.  Tats√§chlich war es nie in den Pl√§nen und niemand w√ºrde es tun.  Ich gab einfach die Hoffnung nicht auf, dass sich etwas einfallen lassen w√ºrde, und pl√∂tzlich h√§tte ich gute Laune und viele Dinge, die auf sp√§ter verschoben werden k√∂nnten. <br><br><h2>  Explizite probabilistische Modelle </h2><br>  Die erste Idee besteht darin, eine Familie von Wahrscheinlichkeitsverteilungen auszuw√§hlen, die sie f√ºr jede Spalte der Tabelle modelliert.  W√§hlen Sie dann basierend auf den Statistiken der Daten die Modellanpassungsparameter aus und generieren Sie neue Daten unter Verwendung der ausgew√§hlten Verteilung.  Sie k√∂nnen einen Pseudozufallszahlengenerator mit einem vordefinierten Startwert verwenden, um ein reproduzierbares Ergebnis zu erhalten. <br><br>  F√ºr Textfelder k√∂nnen Sie Markov-Ketten verwenden - ein verst√§ndliches Modell, f√ºr das Sie eine effektive Implementierung durchf√ºhren k√∂nnen. <br><br>  Es stimmt, einige Tricks sind erforderlich: <br><br><ul><li>  Wir wollen die Kontinuit√§t von Zeitreihen erhalten - was bedeutet, dass f√ºr einige Datentypen nicht der Wert selbst modelliert werden muss, sondern der Unterschied zwischen den benachbarten. </li><li>  Um die bedingte Kardinalit√§t von Spalten zu simulieren (z. B. dass es normalerweise nur wenige IP-Adressen pro Besucher-ID gibt), m√ºssen Sie auch die Abh√§ngigkeiten zwischen den Spalten explizit aufschreiben (um beispielsweise eine IP-Adresse zu generieren, wird ein Hash aus der Besucher-ID verwendet, aber auch einige andere pseudozuf√§llige Daten werden hinzugef√ºgt). </li><li>  Es ist unklar, wie die Abh√§ngigkeit auszudr√ºcken ist, dass ein Besucher ungef√§hr zur gleichen Zeit h√§ufig URLs mit √ºbereinstimmenden Domains besucht. </li></ul><br>  All dies wird in Form eines Programms dargestellt, in dem alle Distributionen und Abh√§ngigkeiten fest codiert sind - das sogenannte ‚ÄûC ++ - Skript‚Äú.  Markov-Modelle werden jedoch immer noch aus der Summe der Statistiken berechnet, die mit Rauschen gegl√§ttet und aufgeraut werden.  Ich habe angefangen, dieses Skript zu schreiben, aber aus irgendeinem Grund wurde es pl√∂tzlich unertr√§glich langweilig, nachdem ich das Modell explizit f√ºr zehn Spalten geschrieben hatte.  Und in der Treffertabelle von Yandex.Metrica gab es 2012 mehr als 100 Spalten. <br><br><pre> <code class="cpp hljs">EventTime.day(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::discrete_distribution&lt;&gt;({    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, ...})(random)); EventTime.hour(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::discrete_distribution&lt;&gt;({    <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, ...})(random)); EventTime.minute(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;UInt8&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>)(random)); EventTime.second(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;UInt8&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>)(random)); UInt64 UserID = hash(<span class="hljs-number"><span class="hljs-number">4</span></span>, powerLaw(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); UserID = UserID / <span class="hljs-number"><span class="hljs-number">10000000000U</span></span>LL * <span class="hljs-number"><span class="hljs-number">10000000000U</span></span>LL    + <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span>&gt;(EventTime) + UserID % <span class="hljs-number"><span class="hljs-number">1000000</span></span>; random_with_seed.seed(powerLaw(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> get_random_with_seed = [&amp;]{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random_with_seed(); };</code> </pre><br>  Diese Herangehensweise an die Aufgabe war ein Fehlschlag.  Wenn ich mich flei√üiger an sie gewandt h√§tte, w√§re das Drehbuch sicher geschrieben worden. <br><br>  Vorteile: <br><br><ul><li>  ideologische Einfachheit. </li></ul><br>  Nachteile: <br><br><ul><li>  die Komplexit√§t der Implementierung, </li><li>  Die implementierte L√∂sung ist nur f√ºr einen Datentyp geeignet. </li></ul><br>  Und ich m√∂chte eine allgemeinere L√∂sung - damit sie nicht nur auf Yandex.Metrica-Daten angewendet werden kann, sondern auch andere Daten verschleiert. <br><br>  Hier sind jedoch Verbesserungen m√∂glich.  Sie k√∂nnen Modelle nicht manuell ausw√§hlen, sondern einen Katalog von Modellen implementieren und die besten unter ihnen ausw√§hlen (beste Anpassung + eine Art Regularisierung).  Oder Sie k√∂nnen Markov-Modelle f√ºr alle Arten von Feldern verwenden, nicht nur f√ºr Text.  Abh√§ngigkeiten zwischen Daten k√∂nnen auch automatisch verstanden werden.  Dazu m√ºssen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">relativen Entropien</a> (relative Informationsmenge) zwischen den Spalten oder einfacher die relativen Kardinalit√§ten (etwa ‚Äûwie viele verschiedene A-Werte im Durchschnitt f√ºr einen festen Wert von B‚Äú) f√ºr jedes Spaltenpaar berechnen.  Dadurch wird beispielsweise deutlich, dass URLDomain vollst√§ndig von der URL abh√§ngig ist und nicht umgekehrt. <br><br>  Aber ich habe diese Idee auch abgelehnt, weil es zu viele Optionen f√ºr das gibt, was ber√ºcksichtigt werden muss, und das Schreiben wird lange dauern. <br><br><h2>  Neuronale Netze </h2><br>  Ich habe bereits gesagt, wie wichtig diese Aufgabe f√ºr uns ist.  Niemand dachte daran, sich in die Umsetzung einzuschleichen.  Gl√ºcklicherweise arbeitete Kollege Ivan Puzyrevsky dann als Lehrer an der HSE und entwickelte gleichzeitig den YT-Kern.  Er fragte mich, ob ich interessante Aufgaben h√§tte, die den Studenten als Diplomthema angeboten werden k√∂nnten.  Ich bot ihm dieses an und er versicherte mir, dass es geeignet sei.  Also gab ich diese Aufgabe einem guten Menschen ‚Äûvon der Stra√üe‚Äú - Sharif Anvardinov (die NDA ist f√ºr die Arbeit mit Daten unterschrieben). <br><br>  Er erz√§hlte ihm von all seinen Ideen, aber vor allem erkl√§rte er, dass das Problem auf jede Weise gel√∂st werden kann.  Eine gute Option w√§re es, die Ans√§tze zu verwenden, die ich √ºberhaupt nicht verstehe: Erstellen Sie beispielsweise einen Textdatendump mit LSTM.  Es sah ermutigend aus, dank des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikels Die unvern√ºnftige Wirksamkeit wiederkehrender neuronaler Netze</a> , der mir dann aufgefallen ist. <br><br>  Das erste Merkmal der Aufgabe ist, dass Sie strukturierte Daten generieren m√ºssen, nicht nur Text.  Es war nicht offensichtlich, ob ein wiederkehrendes neuronales Netzwerk Daten mit der gew√ºnschten Struktur erzeugen k√∂nnte.  Es gibt zwei M√∂glichkeiten, dies zu l√∂sen.  Das erste besteht darin, separate Modelle zur Erzeugung der Struktur und f√ºr den ‚ÄûF√ºllstoff‚Äú zu verwenden: Das neuronale Netzwerk sollte nur Werte erzeugen.  Diese Option wurde jedoch auf sp√§ter verschoben, danach jedoch nie mehr.  Die zweite M√∂glichkeit besteht darin, einfach einen TSV-Speicherauszug als Text zu generieren.  Die Praxis hat gezeigt, dass im Text ein Teil der Zeilen nicht der Struktur entspricht, diese Zeilen jedoch beim Laden weggeworfen werden k√∂nnen. <br><br>  Das zweite Merkmal - ein wiederkehrendes neuronales Netzwerk erzeugt eine Folge von Daten, und die Abh√§ngigkeiten in den Daten k√∂nnen nur in der Reihenfolge dieser Folge folgen.  In unseren Daten ist die Reihenfolge der Spalten m√∂glicherweise in Bezug auf die Abh√§ngigkeiten zwischen ihnen umgekehrt.  Wir haben mit dieser Funktion nichts gemacht. <br><br>  Gegen Sommer erschien das erste funktionierende Python-Skript, das Daten generierte.  Auf den ersten Blick ist die Datenqualit√§t anst√§ndig: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f4/816/f70/6f4816f70912c3fb348f505d3073eded.jpg"><br><br>  Zwar wurden Schwierigkeiten aufgedeckt: <br><br><ol><li>  Die Gr√∂√üe des Modells betr√§gt etwa ein Gigabyte.  Und wir haben versucht, ein Modell f√ºr Daten zu erstellen, deren Gr√∂√üe in der Gr√∂√üenordnung von mehreren Gigabyte liegt (f√ºr den Anfang).  Die Tatsache, dass das resultierende Modell so gro√ü ist, wirft Bedenken auf: Pl√∂tzlich wird es m√∂glich sein, echte Daten daraus zu erhalten, auf denen es trainiert wurde.  H√∂chstwahrscheinlich nicht.  Aber ich verstehe maschinelles Lernen und neuronale Netze nicht und habe den Python-Code von dieser Person nicht gelesen. Wie kann ich also sicher sein?  Dann gab es Artikel dar√ºber, wie man neuronale Netze komprimiert, ohne an Qualit√§t zu verlieren, aber dies blieb ohne Implementierung.  Einerseits sieht dies nicht nach einem Problem aus - Sie k√∂nnen die Ver√∂ffentlichung des Modells ablehnen und nur die generierten Daten ver√∂ffentlichen.  Andererseits k√∂nnen im Fall einer Umschulung die erzeugten Daten einen Teil der Quelldaten enthalten. </li><li>  Auf einem einzelnen Computer mit einer CPU betr√§gt die Datengenerierungsrate ungef√§hr 100 Zeilen pro Sekunde.  Wir hatten die Aufgabe, mindestens eine Milliarde Zeilen zu generieren.  Die Berechnung ergab, dass dies vor der Verteidigung des Diploms nicht m√∂glich war.  Die Verwendung anderer Hardware ist nicht praktikabel, da ich das Ziel hatte, das Datengenerierungstool f√ºr eine breite Verwendung verf√ºgbar zu machen. </li></ol><br>  Sharif versuchte, die Datenqualit√§t durch Vergleichen von Statistiken zu untersuchen.  Zum Beispiel habe ich die H√§ufigkeit berechnet, mit der verschiedene Symbole in der Quelle und in den generierten Daten erscheinen.  Das Ergebnis war atemberaubend - die h√§ufigsten Zeichen sind √ê und √ë. <br><br>  Keine Sorge - er hat sein Diplom perfekt verteidigt, danach haben wir diese Arbeit sicher vergessen. <br><br><h2>  Komprimierte Datenmutation </h2><br>  Angenommen, die Problemstellung wird auf einen Punkt reduziert: Sie m√ºssen Daten generieren, f√ºr die die Komprimierungsverh√§ltnisse genau den Originaldaten entsprechen, w√§hrend die Daten mit genau derselben Geschwindigkeit dekomprimiert werden m√ºssen.  Wie kann man das machen?  Bytes komprimierter Daten m√ºssen direkt bearbeitet werden!  Dann √§ndert sich die Gr√∂√üe der komprimierten Daten nicht, aber die Daten selbst √§ndern sich.  Ja, und alles wird schnell funktionieren.  Als diese Idee auftauchte, wollte ich sie sofort umsetzen, obwohl sie ein anderes Problem als das urspr√ºngliche l√∂st.  Es passiert immer. <br><br>  Wie bearbeite ich eine komprimierte Datei direkt?  Angenommen, wir interessieren uns nur f√ºr LZ4.  Mit LZ4 komprimierte Daten bestehen aus zwei Arten von Anweisungen: <br><br><ol><li>  Literale: Kopieren Sie die n√§chsten N Bytes unver√§ndert. </li><li>  √úbereinstimmung (√úbereinstimmung, die minimale Wiederholungsl√§nge betr√§gt 4): Wiederholen Sie N Bytes, die sich in der Datei in einem Abstand von M befanden. </li></ol><br>  Ausgangsdaten: <br>  <code>Hello world Hello</code> . <br><br>  Komprimierte Daten (bedingt): <br>  <code>literals 12 "Hello world " match 5 12</code> . <br><br>  Lassen Sie in der komprimierten Datei die √úbereinstimmung unver√§ndert, und in Literalen √§ndern wir die Bytewerte.  Als Ergebnis erhalten wir nach der Dekomprimierung eine Datei, in der alle sich wiederholenden Sequenzen mit mindestens 4 L√§ngen ebenfalls wiederholt und in denselben Abst√§nden wiederholt werden, aber gleichzeitig aus einem anderen Satz von Bytes bestehen (bildlich gesprochen wurde kein einziges Byte aus der Originaldatei in der modifizierten Datei entnommen ) <br><br>  Aber wie kann man Bytes √§ndern?  Dies ist nicht offensichtlich, da Daten neben Spaltentypen auch eine eigene interne implizite Struktur haben, die wir beibehalten m√∂chten.  Beispielsweise wird Text h√§ufig in UTF-8-Codierung gespeichert - und wir m√∂chten auch in den generierten Daten g√ºltiges UTF-8.  Ich habe eine einfache Heuristik erstellt, um mehrere Bedingungen zu erf√ºllen: <br><br><ul><li>  Null-Bytes und ASCII-Steuerzeichen wurden unver√§ndert gespeichert. </li><li>  einige Interpunktion blieb bestehen, </li><li>  ASCII wurde in ASCII √ºbersetzt, und im √úbrigen wurde das h√∂chstwertige Bit gespeichert (oder Sie k√∂nnen explizit ein if-Set f√ºr verschiedene UTF-8-L√§ngen schreiben).  Unter einer Klasse von Bytes wird ein neuer Wert gleichm√§√üig zuf√§llig ausgew√§hlt; </li><li>  und auch um Fragmente von <code>https://</code> und √§hnlichem zu speichern, sonst sieht alles zu albern aus. </li></ul><br>  Die Besonderheit dieses Ansatzes besteht darin, dass die Anfangsdaten selbst als Modell f√ºr die Daten dienen, was bedeutet, dass das Modell nicht ver√∂ffentlicht werden kann.  Damit k√∂nnen Sie die Datenmenge nicht mehr als das Original generieren.  Zum Vergleich war es in fr√ºheren Ans√§tzen m√∂glich, ein Modell zu erstellen und auf seiner Basis eine unbegrenzte Datenmenge zu generieren. <br><br>  Beispiel f√ºr URL: <br><br> <code>http://ljc.she/kdoqdqwpgafe/klwlpm&amp;qw=962788775I0E7bs7OXeAyAx <br> http://ljc.she/kdoqdqwdffhant.am/wcpoyodjit/cbytjgeoocvdtclac <br> http://ljc.she/kdoqdqwpgafe/klwlpm&amp;qw=962788775I0E7bs7OXe <br> http://ljc.she/kdoqdqwdffhant.am/wcpoyodjit/cbytjgeoocvdtclac <br> http://ljc.she/kdoqdqwdbknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu_qxht <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu_qxht <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu-702130 <br></code> <br>  Das Ergebnis hat mich gefreut - es war interessant, die Daten zu betrachten.  Trotzdem stimmte etwas nicht.  Die URLs sind immer noch strukturiert, aber an einigen Stellen war es zu einfach, Yandex oder Avito zu erraten.  Es wurde eine Heuristik erstellt, die manchmal einige Bytes an einigen Stellen neu anordnet. <br><br>  Andere √úberlegungen machten sich Sorgen.  Beispielsweise k√∂nnen vertrauliche Informationen in einer Spalte vom Typ FixedString in bin√§rer Form dargestellt werden und bestehen aus irgendeinem Grund aus ASCII-Steuerzeichen und Interpunktion, die ich speichern wollte.  Und ich ber√ºcksichtige keine Datentypen. <br><br>  Ein weiteres Problem: Wenn Daten vom Typ "L√§nge, Wert" in einer Spalte gespeichert sind (so werden Spalten vom Typ String gespeichert), wie kann dann sichergestellt werden, dass die L√§nge nach der Mutation korrekt bleibt?  Als ich versuchte, das Problem zu beheben, wurde die Aufgabe sofort uninteressant. <br><br><h2>  Zuf√§llige Permutationen </h2><br>  Das Problem ist jedoch nicht gel√∂st.  Wir haben mehrere Experimente durchgef√ºhrt und es wurde nur noch schlimmer.  Es bleibt nur nichts zu tun und zuf√§llige Seiten im Internet zu lesen, da die Stimmung schon verdorben ist.  Gl√ºcklicherweise wurde auf einer dieser Seiten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Algorithmus zum</a> Rendern der Todesszene des Protagonisten im Spiel Wolfenstein 3D <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">analysiert</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5d/8a2/291/a5d8a229119786bc45f48fb74cfb956d.gif" width="640" height="480"><br><br>  Sch√∂ne Animation - der Bildschirm f√ºllt sich mit Blut.  Der Artikel erkl√§rt, dass dies tats√§chlich eine pseudozuf√§llige Permutation ist.  Zuf√§llige Permutation - eine zuf√§llig ausgew√§hlte Eins-zu-Eins-Transformation einer Menge.  Das hei√üt, die Anzeige der gesamten Menge, in der die Ergebnisse f√ºr verschiedene Argumente nicht wiederholt werden.  Mit anderen Worten, dies ist eine M√∂glichkeit, alle Elemente einer Menge in zuf√§lliger Reihenfolge zu durchlaufen.  Es ist ein solcher Prozess, der im Bild gezeigt wird - wir √ºbermalen jedes Pixel, das zuf√§llig aus allen ausgew√§hlt wurde, ohne Wiederholung.  Wenn wir bei jedem Schritt nur ein zuf√§lliges Pixel ausw√§hlen w√ºrden, w√ºrden wir lange brauchen, um das letzte zu √ºbermalen. <br><br>  Das Spiel verwendet einen sehr einfachen Algorithmus f√ºr die pseudozuf√§llige Permutation - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LFSR</a> (Linear Feedback Shift Register).  Wie Pseudozufallszahlengeneratoren k√∂nnen zuf√§llige Permutationen bzw. deren Familien, die durch den Schl√ºssel parametrisiert werden, kryptografisch stark sein - genau das ben√∂tigen wir, um die Daten zu konvertieren.  Obwohl es m√∂glicherweise nicht offensichtliche Details gibt.  Beispielsweise kann eine kryptografisch starke Verschl√ºsselung von N Bytes zu N Bytes mit einem voreingestellten Schl√ºssel und einem Initialisierungsvektor anscheinend als pseudozuf√§llige Permutation vieler N-Byte-Zeichenfolgen verwendet werden.  In der Tat ist eine solche Transformation eins zu eins und sieht zuf√§llig aus.  Wenn wir jedoch f√ºr alle unsere Daten dieselbe Transformation verwenden, kann das Ergebnis einer Analyse unterzogen werden, da der gleiche Initialisierungsvektor und die gleichen Schl√ºsselwerte mehrmals verwendet werden.  Dies √§hnelt dem Blockcode-Verschl√ºsselungsmodus des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">elektronischen Codebuchs</a> . <br><br>  Wie kann man eine pseudozuf√§llige Permutation erhalten?  Sie k√∂nnen einfache Eins-zu-Eins-Transformationen durchf√ºhren und daraus eine ziemlich komplexe Funktion zusammenstellen, die zuf√§llig aussieht.  Lassen Sie mich Ihnen ein Beispiel f√ºr einige meiner bevorzugten Eins-zu-Eins-Transformationen geben: <br><br><ul><li>  Multiplikation mit einer ungeraden Zahl (z. B. einer gro√üen Primzahl) in der Zweierkomplementarithmetik; </li><li>  xor-shift: <code>x ^= x &gt;&gt; N</code> , </li><li>  CRC-N, wobei N die Anzahl der Bits des Arguments ist. </li></ul><br>  So wird beispielsweise aus drei Multiplikationen und zwei Xor-Shift-Operationen der <a href="">Murmhash-</a> Finalizer <a href="">zusammengesetzt</a> .  Diese Operation ist eine pseudozuf√§llige Permutation.  Aber nur f√ºr den Fall, ich stelle fest, dass Hash-Funktionen, auch N Bits in N Bits, nicht gegenseitig eindeutig sein m√ºssen. <br><br>  Oder hier ist ein weiteres interessantes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel aus der Elementarzahlentheorie</a> von Jeff Preshing. <br><br>  Wie k√∂nnen wir pseudozuf√§llige Permutationen f√ºr unsere Aufgabe verwenden?  Sie k√∂nnen damit alle numerischen Felder konvertieren.  Dann ist es m√∂glich, alle Kardinalit√§ten und gegenseitigen Kardinalit√§ten aller Feldkombinationen beizubehalten.  Das hei√üt, COUNT (DISTINCT) gibt den gleichen Wert wie vor der Konvertierung und mit jedem GROUP BY zur√ºck. <br><br>  Es ist anzumerken, dass die Wahrung aller Kardinalit√§ten der Aussage √ºber das Problem der Datenanonymisierung leicht widerspricht. ,  ,         ,      10  ,        .           10   ‚Äî   ,    .    ,    ,     ,         ‚Äî ,    ,    .       . ,    ,         ,     Google,       ,  -          Google.       ‚Äî ,      ,          ( )     ( ).  ,        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . <br><br>           ,      . ,       10,        .   ? <br><br> ,       size classes         (  ).       size class        ,    .  0  1    .  2  3   1/2        1/2      .   1024..2047     1024! () .  Usw.        . <br><br>  ,     . ,      -.    ,      . <br><br>       ,     ,      ,             . <br><br>    ‚Äî             ,       .   .            .   Fabien Sanglard   c <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hackers News</a> ,      .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    Redis</a> ‚Äî  .    ,            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> . <br><br>     .   ‚Äî  ,        . ,   . <br><br><ol><li>      : <br> <code>arg: xxxxyyyy <br> <font color="#0fc000">arg_l</font> : xxxx <br> <font color="#0000ff">arg_r</font> : yyyy</code> </li> <li>      .      xor        : <br> <code>res: yyyyzzzz <br> <font color="#0000ff">res_l</font> = yyyy = <font color="#0000ff">arg_r</font> <br> <font color="#FF6600">res_r</font> = zzzz = <font color="#0fc000">arg_l</font> ^ F( <font color="#0000ff">arg_r</font> )</code> </li> </ol><br>   ,     F            4 ,      . <br><br>   :  ,       ,      ‚Äî      ,       ,     ! <br><br>         .  ,    ,      ,    .     : <br><br><ul><li>     ,  ,  Electronic Codebook mode of operation; </li><li>        (  )   ,     ,      . </li></ul><br>           . ,     LZ4     ,             ,        . <br><br><h2>   </h2><br>    ,  ,  ,         .   ‚Äî     .  , ,      ,    .                ( ,    ).          ? <br><br> -,         : ,  256^10     10 ,      ,          . -,      ,     . <br><br>        ,      . ,    ,       .    ,       .    ,   -   . <br><br>             ,       ‚Äî  ,     N   . N ‚Äî   . , N = 5,       ¬´¬ª   ¬´¬ª.       Order-N. <br><br> <code>P( <font color="#ff0000"></font> | ) = 0.9 <br> P( <font color="#ff0000"></font> | ) = 0.05 <br> P( <font color="#ff0000"></font> | ) = 0.01 <br> ...</code> <br> <br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> ( vesna.yandex.ru).      LSTM,           N,    ,  .          ‚Äî           ,    .  :      ,  ,      . <br><br>   Title: <br><br><blockquote>   ‚Äî . ‚Äî     ,   .   ,   ,      ‚Äî .@Mail.Ru ‚Äî   ‚Äî -    . ) ‚Äî AUTO.ria.ua        </blockquote><br> ,       ,          .       () ,           ‚Äî   .        0  N,         N    N ‚àí 1). <br><br>       . ,      123456   URL,          .                    .      -.       .      ,    . <br><br>   :         URL,        ,   -. : <code>https://www.yandex.ru/images/cats/?id=xxxxxx</code> .  ,      URL,      ,   . : <code>http://ftp.google.kz/cgi-bin/index.phtml?item=xxxxxx</code> .                  -     ,      8    . <br><br> <code>https://www.yandex.ru/ <font color="#0fc000">images/c</font> ats/?id=12345 <br> ^^^^^^^^ <br> <br> distribution: [aaaa][b][cc][dddd][e][ff][g <font color="#ff0000">g</font> ggg][h]... <br> hash(" <font color="#0fc000">images/c</font> ") % total_count:           ^ <br> <br></code> <code>http://ftp.google.kz/c <font color="#ff0000">g</font> ...</code> <br> <br>    ,  .     : <br><br><blockquote><pre> -        | . -    <font></font>
-  ‚Äî .:      Lore - dfghf ‚Äî . -   )  473682  -  <font></font>
- !   ¬ª  -  ‚Äî      <font></font>
- !   ¬ª , <font></font>
-  .  c      @Mail.Ru - <font></font>
-     ,  2010 |  . <font></font>
- !    : 820 0000 .,    -<font></font>
-   - DoramaTv.ru -   . -  ..    <font></font>
-  .  2013 ,       -&gt;  80 .<font></font>
-  -    (.    , ,  <font></font>
-   . 5, 69,  W* - ., ,      World of Tanks<font></font>
- ,     . 2     @Mail.Ru<font></font>
-      ,  .   <font></font>
</pre></blockquote><br><h2>  Ergebnis </h2><br>        ,     - ,        -   .          ,  .      clickhouse obfuscator,     :          (, CSV, JSONEachRow),        (   )    ( ,       ).         . <br><br>     clickhouse-client,         Linux.        ,   ClickHouse. ,         MySQL  PostgreSQL ,        . <br><br> <code>clickhouse obfuscator \ <br> --seed "$(head -c16 /dev/urandom | base64)" \ <br> --input-format TSV --output-format TSV \ <br> --structure 'CounterID UInt32, URLDomain String, \ <br> URL String, SearchPhrase String, Title String' \ <br> &lt; table.tsv &gt; result.tsv <br> <br> clickhouse obfuscator --help <br></code> <br>    ,        .     ,   ?      ,        ,    .        ,    ,      .   ,     (  <code>--help</code> )   . <br><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a> ,        . <br><br> <a href="">clickhouse-datasets.s3.yandex.net/hits/tsv/hits_v1.tsv.xz</a> <br> <a href="">clickhouse-datasets.s3.yandex.net/visits/tsv/visits_v1.tsv.xz</a> <br><br>                ClickHouse.          ,       ClickHouse  . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457354/">https://habr.com/ru/post/de457354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457340/index.html">10 PostCSS-Plugins, die Ihre Layoutzeit sparen</a></li>
<li><a href="../de457342/index.html">Zeichen von oben: Wie wir Kartographen vor unn√∂tiger Arbeit und roten Augen retteten</a></li>
<li><a href="../de457348/index.html">Bereitstellung auf PythonAnywhere von GitHub</a></li>
<li><a href="../de457350/index.html">Warum ben√∂tigt das Oszilloskop Kryptografieunterst√ºtzung?</a></li>
<li><a href="../de457352/index.html">Abschluss von Informationen auf dem Display des K√§ufers</a></li>
<li><a href="../de457362/index.html">Promotion von RUVDS: Bereiten Sie den Server im Sommer vor</a></li>
<li><a href="../de457366/index.html">Ein Fanatiker, ein St√ºck Eisen oder ein Zuschauer - was f√ºr ein Spieler bist du?</a></li>
<li><a href="../de457374/index.html">Reduzieren Sie die Erstellungszeit Ihrer Android-Projekte</a></li>
<li><a href="../de457378/index.html">Wie id Software Wolfenstein 3D basierend auf der Technologie von Commander Keen erstellt hat</a></li>
<li><a href="../de457380/index.html">Ultramodernes OpenGL. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>