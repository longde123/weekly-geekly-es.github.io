<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💍 😄 👂🏿 Datenverschleierung für Leistungstests 🏓 🎅🏿 🚶🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ClickHouse-Benutzer wissen, dass der Hauptvorteil in der hohen Geschwindigkeit der Verarbeitung von analytischen Abfragen liegt. Aber wie können wir s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Datenverschleierung für Leistungstests</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/457354/">  ClickHouse-Benutzer wissen, dass der Hauptvorteil in der hohen Geschwindigkeit der Verarbeitung von analytischen Abfragen liegt.  Aber wie können wir solche Aussagen machen?  Dies sollte durch vertrauenswürdige Leistungstests unterstützt werden.  Wir werden heute darüber sprechen. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ds/2m/sd/ds2msd5-4zeahpzlzptlqz8wgs8.png"></a> <br><br>  Wir haben 2013 mit der Durchführung solcher Tests begonnen, lange bevor das Produkt in Open Source verfügbar wurde.  Nach wie vor waren wir am meisten an der Geschwindigkeit des Yandex.Metrica-Datendienstes interessiert.  Wir haben bereits seit Januar 2009 Daten in ClickHouse gespeichert.  Ein Teil der Daten wurde seit 2012 in die Datenbank geschrieben, und ein Teil wurde aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OLAPServer und Metrage konvertiert</a> - Datenstrukturen, die zuvor in Yandex.Metrica verwendet wurden.  Daher haben wir für die Tests die erste verfügbare Teilmenge von 1 Milliarde Seitenaufrufdaten verwendet.  Es gab noch keine Abfragen in Metric, und wir haben Abfragen erstellt, die für uns selbst am interessantesten sind (alle Arten von Filterung, Aggregation und Sortierung). <br><br>  ClickHouse wurde im Vergleich zu ähnlichen Systemen wie Vertica und MonetDB getestet.  Um ehrlich zu sein, wurde es von einem Mitarbeiter durchgeführt, der zuvor kein ClickHouse-Entwickler gewesen war, und bestimmte Fälle im Code wurden erst optimiert, als die Ergebnisse erhalten wurden.  Ebenso haben wir einen Datensatz für Funktionstests erhalten. <br><br>  Nachdem ClickHouse 2016 Open Source beigetreten war, gab es weitere Fragen zu den Tests. <br><br><a name="habracut"></a><h2>  Nachteile von Tests mit proprietären Daten </h2><br>  Leistungstests: <br><br><ol><li> Sie sind von außen nicht reproduzierbar, da für ihren Start geschlossene Daten erforderlich sind, die nicht veröffentlicht werden können.  Aus dem gleichen Grund stehen einige Funktionstests externen Benutzern nicht zur Verfügung. </li><li>  Nicht entwickeln.  Es besteht die Notwendigkeit einer signifikanten Erweiterung ihres Satzes, so dass es möglich ist, Änderungen der Geschwindigkeit einzelner Teile des Systems auf isolierte Weise zu überprüfen. </li><li>  Sie werden nicht ordnungsgemäß für Poolanforderungen ausgeführt. Externe Entwickler können ihren Code nicht auf Leistungsregressionen überprüfen. </li></ol><br>  Sie können diese Probleme lösen - alte Tests wegwerfen und neue basierend auf offenen Daten erstellen.  Unter den offenen Daten können Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Daten zu Flügen in die USA</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Taxifahrten in New York</a> oder vorgefertigte Benchmarks TPC-H, TPC-DS und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Star Schema Benchmark verwenden</a> .  Die Unannehmlichkeit besteht darin, dass diese Daten weit von Yandex.Metrica-Daten entfernt sind und ich Testanforderungen speichern möchte. <br><br><h2>  Es ist wichtig, echte Daten zu verwenden. </h2><br>  Sie müssen die Leistung des Dienstes nur an realen Daten aus der Produktion testen.  Schauen wir uns einige Beispiele an. <br><br>  <strong>Beispiel 1</strong> <br><br>  Angenommen, Sie füllen eine Datenbank mit gleichmäßig verteilten Pseudozufallszahlen.  In diesem Fall funktioniert die Datenkomprimierung nicht.  Die Datenkomprimierung ist jedoch eine wichtige Eigenschaft für analytische DBMS.  Die Auswahl des richtigen Komprimierungsalgorithmus und der richtigen Integration in das System ist eine nicht triviale Aufgabe, bei der es keine richtige Lösung gibt, da die Datenkomprimierung einen Kompromiss zwischen der Komprimierungs- und Dekomprimierungsgeschwindigkeit und dem potenziellen Komprimierungsverhältnis erfordert.  Systeme, die nicht wissen, wie man Daten komprimiert, verlieren garantiert.  Wenn wir jedoch gleichmäßig verteilte Pseudozufallszahlen für Tests verwenden, wird dieser Faktor nicht berücksichtigt und alle anderen Ergebnisse werden verzerrt. <br><br>  Schlussfolgerung: Die Testdaten sollten ein realistisches Komprimierungsverhältnis aufweisen. <br><br>  Über die Optimierung von Datenkomprimierungsalgorithmen in ClickHouse habe ich in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">früheren Beitrag gesprochen</a> . <br><br>  <strong>Beispiel 2</strong> <br><br>  Lassen Sie uns an der Geschwindigkeit der SQL-Abfrage interessiert sein: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> RegionID, uniq(UserID) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> visitors     <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> test.hits     <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> RegionID     <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> visitors <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br>  Dies ist eine typische Anfrage für Yandex.Metrica.  Was ist wichtig für seine Geschwindigkeit? <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wie wird GROUP BY durchgeführt</a> ? </li><li>  Welche Datenstruktur wird zur Berechnung der Aggregatfunktion uniq verwendet? </li><li>  Wie viele verschiedene RegionIDs sind und wie viel RAM jeder Status der Uniq-Funktion benötigt. </li></ul><br>  Es ist aber auch sehr wichtig, dass die Datenmenge für verschiedene Regionen ungleich verteilt ist.  (Wahrscheinlich wird es nach einem Potenzgesetz verteilt. Ich habe ein Diagramm in der Log-Log-Skala erstellt, bin mir aber nicht sicher.) Und wenn ja, ist es für uns wichtig, dass die Zustände des Uniq-Aggregats mit einer kleinen Anzahl von Werten wenig Speicher benötigen.  Wenn es viele verschiedene Aggregationsschlüssel gibt, wird die Anzahl in Byteeinheiten angegeben.  Wie erhalte ich die generierten Daten mit all diesen Eigenschaften?  Natürlich ist es besser, echte Daten zu verwenden. <br><br>  Viele DBMS implementieren die HyperLogLog-Datenstruktur für die ungefähre Berechnung von COUNT (DISTINCT), aber alle funktionieren relativ schlecht, da diese Datenstruktur eine feste Speichermenge verwendet.  Und ClickHouse verfügt über eine Funktion, die je nach Größe des Sets eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kombination aus drei verschiedenen Datenstrukturen verwendet</a> . <br><br>  Schlussfolgerung: Die Testdaten sollten die Eigenschaften der Werteverteilung in den Daten darstellen - Kardinalität (Anzahl der Werte in den Spalten) und gegenseitige Kardinalität mehrerer verschiedener Spalten. <br><br>  <strong>Beispiel 3</strong> <br><br>  Lassen Sie uns die Leistung nicht des analytischen ClickHouse-DBMS testen, sondern von etwas Einfacherem, beispielsweise Hash-Tabellen.  Für Hash-Tabellen ist die Auswahl der richtigen Hash-Funktion sehr wichtig.  Für std :: unordered_map ist dies etwas weniger wichtig, da es sich um eine kettenbasierte Hash-Tabelle handelt und eine Primzahl als Größe des Arrays verwendet wird.  In der Standardbibliotheksimplementierung in gcc und clang wird eine triviale Hash-Funktion als Standard-Hash-Funktion für numerische Typen verwendet.  Aber std :: unordered_map ist nicht die beste Wahl, wenn wir maximale Geschwindigkeit erreichen wollen.  Bei Verwendung von Hash-Tabellen mit offener Adressierung wird die richtige Auswahl der Hash-Funktion zu einem entscheidenden Faktor, und wir können die triviale Hash-Funktion nicht verwenden. <br><br>  Es ist einfach, Leistungstests für Hash-Tabellen für zufällige Daten zu finden, ohne die verwendeten Hash-Funktionen zu berücksichtigen.  Es ist auch leicht, Hash-Funktionstests zu finden, wobei der Schwerpunkt auf der Rechengeschwindigkeit und einigen Qualitätskriterien liegt, jedoch isoliert von den verwendeten Datenstrukturen.  Tatsache ist jedoch, dass Hash-Tabellen und HyperLogLog unterschiedliche Qualitätskriterien für Hash-Funktionen erfordern. <br><br><img src="https://habrastorage.org/webt/bp/3h/32/bp3h320eztrirqzhm-lexeuhmbq.png"><br><br>  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen</a> hierzu finden Sie im Bericht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Wie Hash-Tabellen in ClickHouse angeordnet sind“</a> .  Es ist etwas veraltet, da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schweizer Tische</a> nicht berücksichtigt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> . <br><br><h2>  Herausforderung </h2><br>  Wir möchten, dass die Daten für Leistungstests für die Struktur dieselben wie für Yandex.Metrica-Daten sind, für die alle für Benchmarks wichtigen Eigenschaften gespeichert sind, damit in diesen Daten jedoch keine Spuren von echten Website-Besuchern zurückbleiben.  Das heißt, die Daten sollten anonymisiert und Folgendes gespeichert werden: <br><br><ul><li>  Kompressionsverhältnisse </li><li>  Kardinalität (Anzahl verschiedener Werte), </li><li>  gegenseitige Kardinalitäten mehrerer verschiedener Spalten, </li><li>  Eigenschaften probabilistischer Verteilungen, mit denen Daten modelliert werden können (wenn wir beispielsweise glauben, dass Regionen nach einem Potenzgesetz verteilt sind, sollte der Exponent - der Verteilungsparameter - für künstliche Daten ungefähr der gleiche sein wie für real). </li></ul><br>  Und was wird benötigt, damit die Daten ein ähnliches Komprimierungsverhältnis haben?  Wenn beispielsweise LZ4 verwendet wird, sollten die Teilzeichenfolgen in den Binärdaten in ungefähr denselben Abständen wiederholt werden und die Wiederholungen sollten ungefähr dieselbe Länge haben.  Für ZSTD wird eine Byte-Entropie-Übereinstimmung hinzugefügt. <br><br>  Das maximale Ziel: ein Tool für externe Personen verfügbar zu machen, mit dem jeder seinen Datensatz für die Veröffentlichung anonymisieren kann.  Damit wir die Leistung von Daten anderer Personen debuggen und testen, ähnlich wie Daten aus der Produktion.  Und ich möchte, dass es interessant ist, die generierten Daten zu sehen. <br><br>  Dies ist eine informelle Erklärung des Problems.  Es würde jedoch niemand eine formelle Erklärung abgeben. <br><br><h2>  Versuche zu lösen </h2><br>  Die Bedeutung dieser Aufgabe sollte für uns nicht übertrieben werden.  Tatsächlich war es nie in den Plänen und niemand würde es tun.  Ich gab einfach die Hoffnung nicht auf, dass sich etwas einfallen lassen würde, und plötzlich hätte ich gute Laune und viele Dinge, die auf später verschoben werden könnten. <br><br><h2>  Explizite probabilistische Modelle </h2><br>  Die erste Idee besteht darin, eine Familie von Wahrscheinlichkeitsverteilungen auszuwählen, die sie für jede Spalte der Tabelle modelliert.  Wählen Sie dann basierend auf den Statistiken der Daten die Modellanpassungsparameter aus und generieren Sie neue Daten unter Verwendung der ausgewählten Verteilung.  Sie können einen Pseudozufallszahlengenerator mit einem vordefinierten Startwert verwenden, um ein reproduzierbares Ergebnis zu erhalten. <br><br>  Für Textfelder können Sie Markov-Ketten verwenden - ein verständliches Modell, für das Sie eine effektive Implementierung durchführen können. <br><br>  Es stimmt, einige Tricks sind erforderlich: <br><br><ul><li>  Wir wollen die Kontinuität von Zeitreihen erhalten - was bedeutet, dass für einige Datentypen nicht der Wert selbst modelliert werden muss, sondern der Unterschied zwischen den benachbarten. </li><li>  Um die bedingte Kardinalität von Spalten zu simulieren (z. B. dass es normalerweise nur wenige IP-Adressen pro Besucher-ID gibt), müssen Sie auch die Abhängigkeiten zwischen den Spalten explizit aufschreiben (um beispielsweise eine IP-Adresse zu generieren, wird ein Hash aus der Besucher-ID verwendet, aber auch einige andere pseudozufällige Daten werden hinzugefügt). </li><li>  Es ist unklar, wie die Abhängigkeit auszudrücken ist, dass ein Besucher ungefähr zur gleichen Zeit häufig URLs mit übereinstimmenden Domains besucht. </li></ul><br>  All dies wird in Form eines Programms dargestellt, in dem alle Distributionen und Abhängigkeiten fest codiert sind - das sogenannte „C ++ - Skript“.  Markov-Modelle werden jedoch immer noch aus der Summe der Statistiken berechnet, die mit Rauschen geglättet und aufgeraut werden.  Ich habe angefangen, dieses Skript zu schreiben, aber aus irgendeinem Grund wurde es plötzlich unerträglich langweilig, nachdem ich das Modell explizit für zehn Spalten geschrieben hatte.  Und in der Treffertabelle von Yandex.Metrica gab es 2012 mehr als 100 Spalten. <br><br><pre> <code class="cpp hljs">EventTime.day(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::discrete_distribution&lt;&gt;({    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, ...})(random)); EventTime.hour(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::discrete_distribution&lt;&gt;({    <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, ...})(random)); EventTime.minute(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;UInt8&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>)(random)); EventTime.second(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;UInt8&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>)(random)); UInt64 UserID = hash(<span class="hljs-number"><span class="hljs-number">4</span></span>, powerLaw(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); UserID = UserID / <span class="hljs-number"><span class="hljs-number">10000000000U</span></span>LL * <span class="hljs-number"><span class="hljs-number">10000000000U</span></span>LL    + <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span>&gt;(EventTime) + UserID % <span class="hljs-number"><span class="hljs-number">1000000</span></span>; random_with_seed.seed(powerLaw(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> get_random_with_seed = [&amp;]{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random_with_seed(); };</code> </pre><br>  Diese Herangehensweise an die Aufgabe war ein Fehlschlag.  Wenn ich mich fleißiger an sie gewandt hätte, wäre das Drehbuch sicher geschrieben worden. <br><br>  Vorteile: <br><br><ul><li>  ideologische Einfachheit. </li></ul><br>  Nachteile: <br><br><ul><li>  die Komplexität der Implementierung, </li><li>  Die implementierte Lösung ist nur für einen Datentyp geeignet. </li></ul><br>  Und ich möchte eine allgemeinere Lösung - damit sie nicht nur auf Yandex.Metrica-Daten angewendet werden kann, sondern auch andere Daten verschleiert. <br><br>  Hier sind jedoch Verbesserungen möglich.  Sie können Modelle nicht manuell auswählen, sondern einen Katalog von Modellen implementieren und die besten unter ihnen auswählen (beste Anpassung + eine Art Regularisierung).  Oder Sie können Markov-Modelle für alle Arten von Feldern verwenden, nicht nur für Text.  Abhängigkeiten zwischen Daten können auch automatisch verstanden werden.  Dazu müssen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">relativen Entropien</a> (relative Informationsmenge) zwischen den Spalten oder einfacher die relativen Kardinalitäten (etwa „wie viele verschiedene A-Werte im Durchschnitt für einen festen Wert von B“) für jedes Spaltenpaar berechnen.  Dadurch wird beispielsweise deutlich, dass URLDomain vollständig von der URL abhängig ist und nicht umgekehrt. <br><br>  Aber ich habe diese Idee auch abgelehnt, weil es zu viele Optionen für das gibt, was berücksichtigt werden muss, und das Schreiben wird lange dauern. <br><br><h2>  Neuronale Netze </h2><br>  Ich habe bereits gesagt, wie wichtig diese Aufgabe für uns ist.  Niemand dachte daran, sich in die Umsetzung einzuschleichen.  Glücklicherweise arbeitete Kollege Ivan Puzyrevsky dann als Lehrer an der HSE und entwickelte gleichzeitig den YT-Kern.  Er fragte mich, ob ich interessante Aufgaben hätte, die den Studenten als Diplomthema angeboten werden könnten.  Ich bot ihm dieses an und er versicherte mir, dass es geeignet sei.  Also gab ich diese Aufgabe einem guten Menschen „von der Straße“ - Sharif Anvardinov (die NDA ist für die Arbeit mit Daten unterschrieben). <br><br>  Er erzählte ihm von all seinen Ideen, aber vor allem erklärte er, dass das Problem auf jede Weise gelöst werden kann.  Eine gute Option wäre es, die Ansätze zu verwenden, die ich überhaupt nicht verstehe: Erstellen Sie beispielsweise einen Textdatendump mit LSTM.  Es sah ermutigend aus, dank des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikels Die unvernünftige Wirksamkeit wiederkehrender neuronaler Netze</a> , der mir dann aufgefallen ist. <br><br>  Das erste Merkmal der Aufgabe ist, dass Sie strukturierte Daten generieren müssen, nicht nur Text.  Es war nicht offensichtlich, ob ein wiederkehrendes neuronales Netzwerk Daten mit der gewünschten Struktur erzeugen könnte.  Es gibt zwei Möglichkeiten, dies zu lösen.  Das erste besteht darin, separate Modelle zur Erzeugung der Struktur und für den „Füllstoff“ zu verwenden: Das neuronale Netzwerk sollte nur Werte erzeugen.  Diese Option wurde jedoch auf später verschoben, danach jedoch nie mehr.  Die zweite Möglichkeit besteht darin, einfach einen TSV-Speicherauszug als Text zu generieren.  Die Praxis hat gezeigt, dass im Text ein Teil der Zeilen nicht der Struktur entspricht, diese Zeilen jedoch beim Laden weggeworfen werden können. <br><br>  Das zweite Merkmal - ein wiederkehrendes neuronales Netzwerk erzeugt eine Folge von Daten, und die Abhängigkeiten in den Daten können nur in der Reihenfolge dieser Folge folgen.  In unseren Daten ist die Reihenfolge der Spalten möglicherweise in Bezug auf die Abhängigkeiten zwischen ihnen umgekehrt.  Wir haben mit dieser Funktion nichts gemacht. <br><br>  Gegen Sommer erschien das erste funktionierende Python-Skript, das Daten generierte.  Auf den ersten Blick ist die Datenqualität anständig: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f4/816/f70/6f4816f70912c3fb348f505d3073eded.jpg"><br><br>  Zwar wurden Schwierigkeiten aufgedeckt: <br><br><ol><li>  Die Größe des Modells beträgt etwa ein Gigabyte.  Und wir haben versucht, ein Modell für Daten zu erstellen, deren Größe in der Größenordnung von mehreren Gigabyte liegt (für den Anfang).  Die Tatsache, dass das resultierende Modell so groß ist, wirft Bedenken auf: Plötzlich wird es möglich sein, echte Daten daraus zu erhalten, auf denen es trainiert wurde.  Höchstwahrscheinlich nicht.  Aber ich verstehe maschinelles Lernen und neuronale Netze nicht und habe den Python-Code von dieser Person nicht gelesen. Wie kann ich also sicher sein?  Dann gab es Artikel darüber, wie man neuronale Netze komprimiert, ohne an Qualität zu verlieren, aber dies blieb ohne Implementierung.  Einerseits sieht dies nicht nach einem Problem aus - Sie können die Veröffentlichung des Modells ablehnen und nur die generierten Daten veröffentlichen.  Andererseits können im Fall einer Umschulung die erzeugten Daten einen Teil der Quelldaten enthalten. </li><li>  Auf einem einzelnen Computer mit einer CPU beträgt die Datengenerierungsrate ungefähr 100 Zeilen pro Sekunde.  Wir hatten die Aufgabe, mindestens eine Milliarde Zeilen zu generieren.  Die Berechnung ergab, dass dies vor der Verteidigung des Diploms nicht möglich war.  Die Verwendung anderer Hardware ist nicht praktikabel, da ich das Ziel hatte, das Datengenerierungstool für eine breite Verwendung verfügbar zu machen. </li></ol><br>  Sharif versuchte, die Datenqualität durch Vergleichen von Statistiken zu untersuchen.  Zum Beispiel habe ich die Häufigkeit berechnet, mit der verschiedene Symbole in der Quelle und in den generierten Daten erscheinen.  Das Ergebnis war atemberaubend - die häufigsten Zeichen sind Ð und Ñ. <br><br>  Keine Sorge - er hat sein Diplom perfekt verteidigt, danach haben wir diese Arbeit sicher vergessen. <br><br><h2>  Komprimierte Datenmutation </h2><br>  Angenommen, die Problemstellung wird auf einen Punkt reduziert: Sie müssen Daten generieren, für die die Komprimierungsverhältnisse genau den Originaldaten entsprechen, während die Daten mit genau derselben Geschwindigkeit dekomprimiert werden müssen.  Wie kann man das machen?  Bytes komprimierter Daten müssen direkt bearbeitet werden!  Dann ändert sich die Größe der komprimierten Daten nicht, aber die Daten selbst ändern sich.  Ja, und alles wird schnell funktionieren.  Als diese Idee auftauchte, wollte ich sie sofort umsetzen, obwohl sie ein anderes Problem als das ursprüngliche löst.  Es passiert immer. <br><br>  Wie bearbeite ich eine komprimierte Datei direkt?  Angenommen, wir interessieren uns nur für LZ4.  Mit LZ4 komprimierte Daten bestehen aus zwei Arten von Anweisungen: <br><br><ol><li>  Literale: Kopieren Sie die nächsten N Bytes unverändert. </li><li>  Übereinstimmung (Übereinstimmung, die minimale Wiederholungslänge beträgt 4): Wiederholen Sie N Bytes, die sich in der Datei in einem Abstand von M befanden. </li></ol><br>  Ausgangsdaten: <br>  <code>Hello world Hello</code> . <br><br>  Komprimierte Daten (bedingt): <br>  <code>literals 12 "Hello world " match 5 12</code> . <br><br>  Lassen Sie in der komprimierten Datei die Übereinstimmung unverändert, und in Literalen ändern wir die Bytewerte.  Als Ergebnis erhalten wir nach der Dekomprimierung eine Datei, in der alle sich wiederholenden Sequenzen mit mindestens 4 Längen ebenfalls wiederholt und in denselben Abständen wiederholt werden, aber gleichzeitig aus einem anderen Satz von Bytes bestehen (bildlich gesprochen wurde kein einziges Byte aus der Originaldatei in der modifizierten Datei entnommen ) <br><br>  Aber wie kann man Bytes ändern?  Dies ist nicht offensichtlich, da Daten neben Spaltentypen auch eine eigene interne implizite Struktur haben, die wir beibehalten möchten.  Beispielsweise wird Text häufig in UTF-8-Codierung gespeichert - und wir möchten auch in den generierten Daten gültiges UTF-8.  Ich habe eine einfache Heuristik erstellt, um mehrere Bedingungen zu erfüllen: <br><br><ul><li>  Null-Bytes und ASCII-Steuerzeichen wurden unverändert gespeichert. </li><li>  einige Interpunktion blieb bestehen, </li><li>  ASCII wurde in ASCII übersetzt, und im Übrigen wurde das höchstwertige Bit gespeichert (oder Sie können explizit ein if-Set für verschiedene UTF-8-Längen schreiben).  Unter einer Klasse von Bytes wird ein neuer Wert gleichmäßig zufällig ausgewählt; </li><li>  und auch um Fragmente von <code>https://</code> und ähnlichem zu speichern, sonst sieht alles zu albern aus. </li></ul><br>  Die Besonderheit dieses Ansatzes besteht darin, dass die Anfangsdaten selbst als Modell für die Daten dienen, was bedeutet, dass das Modell nicht veröffentlicht werden kann.  Damit können Sie die Datenmenge nicht mehr als das Original generieren.  Zum Vergleich war es in früheren Ansätzen möglich, ein Modell zu erstellen und auf seiner Basis eine unbegrenzte Datenmenge zu generieren. <br><br>  Beispiel für URL: <br><br> <code>http://ljc.she/kdoqdqwpgafe/klwlpm&amp;qw=962788775I0E7bs7OXeAyAx <br> http://ljc.she/kdoqdqwdffhant.am/wcpoyodjit/cbytjgeoocvdtclac <br> http://ljc.she/kdoqdqwpgafe/klwlpm&amp;qw=962788775I0E7bs7OXe <br> http://ljc.she/kdoqdqwdffhant.am/wcpoyodjit/cbytjgeoocvdtclac <br> http://ljc.she/kdoqdqwdbknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu_qxht <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu_qxht <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu-702130 <br></code> <br>  Das Ergebnis hat mich gefreut - es war interessant, die Daten zu betrachten.  Trotzdem stimmte etwas nicht.  Die URLs sind immer noch strukturiert, aber an einigen Stellen war es zu einfach, Yandex oder Avito zu erraten.  Es wurde eine Heuristik erstellt, die manchmal einige Bytes an einigen Stellen neu anordnet. <br><br>  Andere Überlegungen machten sich Sorgen.  Beispielsweise können vertrauliche Informationen in einer Spalte vom Typ FixedString in binärer Form dargestellt werden und bestehen aus irgendeinem Grund aus ASCII-Steuerzeichen und Interpunktion, die ich speichern wollte.  Und ich berücksichtige keine Datentypen. <br><br>  Ein weiteres Problem: Wenn Daten vom Typ "Länge, Wert" in einer Spalte gespeichert sind (so werden Spalten vom Typ String gespeichert), wie kann dann sichergestellt werden, dass die Länge nach der Mutation korrekt bleibt?  Als ich versuchte, das Problem zu beheben, wurde die Aufgabe sofort uninteressant. <br><br><h2>  Zufällige Permutationen </h2><br>  Das Problem ist jedoch nicht gelöst.  Wir haben mehrere Experimente durchgeführt und es wurde nur noch schlimmer.  Es bleibt nur nichts zu tun und zufällige Seiten im Internet zu lesen, da die Stimmung schon verdorben ist.  Glücklicherweise wurde auf einer dieser Seiten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Algorithmus zum</a> Rendern der Todesszene des Protagonisten im Spiel Wolfenstein 3D <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">analysiert</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5d/8a2/291/a5d8a229119786bc45f48fb74cfb956d.gif" width="640" height="480"><br><br>  Schöne Animation - der Bildschirm füllt sich mit Blut.  Der Artikel erklärt, dass dies tatsächlich eine pseudozufällige Permutation ist.  Zufällige Permutation - eine zufällig ausgewählte Eins-zu-Eins-Transformation einer Menge.  Das heißt, die Anzeige der gesamten Menge, in der die Ergebnisse für verschiedene Argumente nicht wiederholt werden.  Mit anderen Worten, dies ist eine Möglichkeit, alle Elemente einer Menge in zufälliger Reihenfolge zu durchlaufen.  Es ist ein solcher Prozess, der im Bild gezeigt wird - wir übermalen jedes Pixel, das zufällig aus allen ausgewählt wurde, ohne Wiederholung.  Wenn wir bei jedem Schritt nur ein zufälliges Pixel auswählen würden, würden wir lange brauchen, um das letzte zu übermalen. <br><br>  Das Spiel verwendet einen sehr einfachen Algorithmus für die pseudozufällige Permutation - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LFSR</a> (Linear Feedback Shift Register).  Wie Pseudozufallszahlengeneratoren können zufällige Permutationen bzw. deren Familien, die durch den Schlüssel parametrisiert werden, kryptografisch stark sein - genau das benötigen wir, um die Daten zu konvertieren.  Obwohl es möglicherweise nicht offensichtliche Details gibt.  Beispielsweise kann eine kryptografisch starke Verschlüsselung von N Bytes zu N Bytes mit einem voreingestellten Schlüssel und einem Initialisierungsvektor anscheinend als pseudozufällige Permutation vieler N-Byte-Zeichenfolgen verwendet werden.  In der Tat ist eine solche Transformation eins zu eins und sieht zufällig aus.  Wenn wir jedoch für alle unsere Daten dieselbe Transformation verwenden, kann das Ergebnis einer Analyse unterzogen werden, da der gleiche Initialisierungsvektor und die gleichen Schlüsselwerte mehrmals verwendet werden.  Dies ähnelt dem Blockcode-Verschlüsselungsmodus des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">elektronischen Codebuchs</a> . <br><br>  Wie kann man eine pseudozufällige Permutation erhalten?  Sie können einfache Eins-zu-Eins-Transformationen durchführen und daraus eine ziemlich komplexe Funktion zusammenstellen, die zufällig aussieht.  Lassen Sie mich Ihnen ein Beispiel für einige meiner bevorzugten Eins-zu-Eins-Transformationen geben: <br><br><ul><li>  Multiplikation mit einer ungeraden Zahl (z. B. einer großen Primzahl) in der Zweierkomplementarithmetik; </li><li>  xor-shift: <code>x ^= x &gt;&gt; N</code> , </li><li>  CRC-N, wobei N die Anzahl der Bits des Arguments ist. </li></ul><br>  So wird beispielsweise aus drei Multiplikationen und zwei Xor-Shift-Operationen der <a href="">Murmhash-</a> Finalizer <a href="">zusammengesetzt</a> .  Diese Operation ist eine pseudozufällige Permutation.  Aber nur für den Fall, ich stelle fest, dass Hash-Funktionen, auch N Bits in N Bits, nicht gegenseitig eindeutig sein müssen. <br><br>  Oder hier ist ein weiteres interessantes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel aus der Elementarzahlentheorie</a> von Jeff Preshing. <br><br>  Wie können wir pseudozufällige Permutationen für unsere Aufgabe verwenden?  Sie können damit alle numerischen Felder konvertieren.  Dann ist es möglich, alle Kardinalitäten und gegenseitigen Kardinalitäten aller Feldkombinationen beizubehalten.  Das heißt, COUNT (DISTINCT) gibt den gleichen Wert wie vor der Konvertierung und mit jedem GROUP BY zurück. <br><br>  Es ist anzumerken, dass die Wahrung aller Kardinalitäten der Aussage über das Problem der Datenanonymisierung leicht widerspricht. ,  ,         ,      10  ,        .           10   —   ,    .    ,    ,     ,         — ,    ,    .       . ,    ,         ,     Google,       ,  -          Google.       — ,      ,          ( )     ( ).  ,        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . <br><br>           ,      . ,       10,        .   ? <br><br> ,       size classes         (  ).       size class        ,    .  0  1    .  2  3   1/2        1/2      .   1024..2047     1024! () .  Usw.        . <br><br>  ,     . ,      -.    ,      . <br><br>       ,     ,      ,             . <br><br>    —             ,       .   .            .   Fabien Sanglard   c <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hackers News</a> ,      .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    Redis</a> —  .    ,            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> . <br><br>     .   —  ,        . ,   . <br><br><ol><li>      : <br> <code>arg: xxxxyyyy <br> <font color="#0fc000">arg_l</font> : xxxx <br> <font color="#0000ff">arg_r</font> : yyyy</code> </li> <li>      .      xor        : <br> <code>res: yyyyzzzz <br> <font color="#0000ff">res_l</font> = yyyy = <font color="#0000ff">arg_r</font> <br> <font color="#FF6600">res_r</font> = zzzz = <font color="#0fc000">arg_l</font> ^ F( <font color="#0000ff">arg_r</font> )</code> </li> </ol><br>   ,     F            4 ,      . <br><br>   :  ,       ,      —      ,       ,     ! <br><br>         .  ,    ,      ,    .     : <br><br><ul><li>     ,  ,  Electronic Codebook mode of operation; </li><li>        (  )   ,     ,      . </li></ul><br>           . ,     LZ4     ,             ,        . <br><br><h2>   </h2><br>    ,  ,  ,         .   —     .  , ,      ,    .                ( ,    ).          ? <br><br> -,         : ,  256^10     10 ,      ,          . -,      ,     . <br><br>        ,      . ,    ,       .    ,       .    ,   -   . <br><br>             ,       —  ,     N   . N —   . , N = 5,       «»   «».       Order-N. <br><br> <code>P( <font color="#ff0000"></font> | ) = 0.9 <br> P( <font color="#ff0000"></font> | ) = 0.05 <br> P( <font color="#ff0000"></font> | ) = 0.01 <br> ...</code> <br> <br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> ( vesna.yandex.ru).      LSTM,           N,    ,  .          —           ,    .  :      ,  ,      . <br><br>   Title: <br><br><blockquote>   — . —     ,   .   ,   ,      — .@Mail.Ru —   — -    . ) — AUTO.ria.ua        </blockquote><br> ,       ,          .       () ,           —   .        0  N,         N    N − 1). <br><br>       . ,      123456   URL,          .                    .      -.       .      ,    . <br><br>   :         URL,        ,   -. : <code>https://www.yandex.ru/images/cats/?id=xxxxxx</code> .  ,      URL,      ,   . : <code>http://ftp.google.kz/cgi-bin/index.phtml?item=xxxxxx</code> .                  -     ,      8    . <br><br> <code>https://www.yandex.ru/ <font color="#0fc000">images/c</font> ats/?id=12345 <br> ^^^^^^^^ <br> <br> distribution: [aaaa][b][cc][dddd][e][ff][g <font color="#ff0000">g</font> ggg][h]... <br> hash(" <font color="#0fc000">images/c</font> ") % total_count:           ^ <br> <br></code> <code>http://ftp.google.kz/c <font color="#ff0000">g</font> ...</code> <br> <br>    ,  .     : <br><br><blockquote><pre> -        | . -    <font></font>
-  — .:      Lore - dfghf — . -   )  473682  -  <font></font>
- !   »  -  —      <font></font>
- !   » , <font></font>
-  .  c      @Mail.Ru - <font></font>
-     ,  2010 |  . <font></font>
- !    : 820 0000 .,    -<font></font>
-   - DoramaTv.ru -   . -  ..    <font></font>
-  .  2013 ,       -&gt;  80 .<font></font>
-  -    (.    , ,  <font></font>
-   . 5, 69,  W* - ., ,      World of Tanks<font></font>
- ,     . 2     @Mail.Ru<font></font>
-      ,  .   <font></font>
</pre></blockquote><br><h2>  Ergebnis </h2><br>        ,     - ,        -   .          ,  .      clickhouse obfuscator,     :          (, CSV, JSONEachRow),        (   )    ( ,       ).         . <br><br>     clickhouse-client,         Linux.        ,   ClickHouse. ,         MySQL  PostgreSQL ,        . <br><br> <code>clickhouse obfuscator \ <br> --seed "$(head -c16 /dev/urandom | base64)" \ <br> --input-format TSV --output-format TSV \ <br> --structure 'CounterID UInt32, URLDomain String, \ <br> URL String, SearchPhrase String, Title String' \ <br> &lt; table.tsv &gt; result.tsv <br> <br> clickhouse obfuscator --help <br></code> <br>    ,        .     ,   ?      ,        ,    .        ,    ,      .   ,     (  <code>--help</code> )   . <br><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a> ,        . <br><br> <a href="">clickhouse-datasets.s3.yandex.net/hits/tsv/hits_v1.tsv.xz</a> <br> <a href="">clickhouse-datasets.s3.yandex.net/visits/tsv/visits_v1.tsv.xz</a> <br><br>                ClickHouse.          ,       ClickHouse  . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457354/">https://habr.com/ru/post/de457354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457340/index.html">10 PostCSS-Plugins, die Ihre Layoutzeit sparen</a></li>
<li><a href="../de457342/index.html">Zeichen von oben: Wie wir Kartographen vor unnötiger Arbeit und roten Augen retteten</a></li>
<li><a href="../de457348/index.html">Bereitstellung auf PythonAnywhere von GitHub</a></li>
<li><a href="../de457350/index.html">Warum benötigt das Oszilloskop Kryptografieunterstützung?</a></li>
<li><a href="../de457352/index.html">Abschluss von Informationen auf dem Display des Käufers</a></li>
<li><a href="../de457362/index.html">Promotion von RUVDS: Bereiten Sie den Server im Sommer vor</a></li>
<li><a href="../de457366/index.html">Ein Fanatiker, ein Stück Eisen oder ein Zuschauer - was für ein Spieler bist du?</a></li>
<li><a href="../de457374/index.html">Reduzieren Sie die Erstellungszeit Ihrer Android-Projekte</a></li>
<li><a href="../de457378/index.html">Wie id Software Wolfenstein 3D basierend auf der Technologie von Commander Keen erstellt hat</a></li>
<li><a href="../de457380/index.html">Ultramodernes OpenGL. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>