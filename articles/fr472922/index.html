<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî¨ üôáüèæ ‚úçüèΩ Le programmeur Defender plus fort que l'entropie üì• ‚ôøÔ∏è üßíüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬© Dragon Ball. Goku. 

 Le programmeur-d√©fenseur √† tout moment et n'importe o√π dans le code s'attend √† l'apparition de probl√®mes potentiels et √©crit l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le programmeur Defender plus fort que l'entropie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/funcorp/blog/472922/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/bu/kn/5n/bukn5ndtci4czpuwtbu3nsihkyi.jpeg"></div>  <i>¬© Dragon Ball.</i>  <i>Goku.</i> <br><br>  Le programmeur-d√©fenseur √† tout moment et n'importe o√π dans le code s'attend √† l'apparition de probl√®mes potentiels et √©crit le code de mani√®re √† s'en prot√©ger √† l'avance.  Et si vous ne pouvez pas vous d√©fendre contre un probl√®me, assurez-vous au moins que ses cons√©quences et son impact sur les utilisateurs sont minimes. <br><br>  Je me souviens de l'effet <i>FlashForward</i> des superproductions hollywoodiennes lorsque le protagoniste voit la catastrophe imminente et reste extr√™mement calme, car il sait √† l'avance que cela arrivera et a une protection contre elle.  L'id√©e derri√®re la programmation d√©fensive est de se prot√©ger des probl√®mes difficiles ou impossibles √† pr√©voir.  Un programmeur de s√©curit√© s'attend √† ce que des erreurs se produisent n'importe o√π dans le syst√®me et √† tout moment pour les √©viter avant qu'elles ne causent des dommages.  Cependant, le but n'est pas de cr√©er un syst√®me qui ne plante jamais, c'est quand m√™me impossible.  L'objectif est de cr√©er un syst√®me qui se <b>bloque gracieusement</b> en cas de probl√®me impr√©vu. <br><br>  Comprenons plus en d√©tail ce qui est inclus dans le concept de ¬´tomber gracieusement¬ª. <br><br><ul><li>  <b>Tombez vite.</b>  En cas d'erreur inattendue, toutes les op√©rations doivent √™tre termin√©es imm√©diatement, en particulier si les calculs ult√©rieurs sont difficiles ou peuvent entra√Æner une corruption des donn√©es. </li><li>  <b>Tombez bien.</b>  Si une erreur se produit, le programme doit lib√©rer toutes les ressources, supprimer les verrous, supprimer les fichiers temporaires et semi-enregistr√©s, fermer les connexions.  Attendez la fin des op√©rations critiques, dont l'interruption peut conduire √† des r√©sultats impr√©visibles.  Ou un moyen s√ªr de planter ces op√©rations. </li><li>  <b>Tomber clairement et magnifiquement.</b>  Si quelque chose est cass√©, le message d'erreur doit √™tre simple, concis et contenir des d√©tails importants du contexte du syst√®me o√π l'erreur s'est produite.  Cela aidera l'√©quipe responsable du syst√®me √† comprendre le probl√®me le plus rapidement possible et √† le r√©soudre. </li></ul><a name="habracut"></a><br>  Mais vous avez peut-√™tre une question. <br><br>  Pourquoi perdre du temps sur des probl√®mes qui pourraient survenir √† l'avenir?  <b>Maintenant</b> qu'ils ne sont pas l√†, le code fonctionne parfaitement.  De plus, les probl√®mes peuvent ne jamais se produire du tout.  Apr√®s tout, les professionnels ne font pas d'ing√©nierie pour le plaisir de l'ing√©nierie ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">YAGNI</a> - Vous n'en aurez pas besoin)! <br><br><h2>  L'essentiel est le pragmatisme </h2><br>  Andrew Hunt dans le livre "Programmer-pragmatist" donne la d√©finition suivante de la programmation d√©fensive - " <b>parano√Øa pragmatique</b> ". <br><br>  Prot√©gez votre code contre: <br><br><ul><li>  propres erreurs; </li><li>  les erreurs des autres; </li><li>  erreurs et d√©faillances dans d'autres syst√®mes avec lesquels votre est int√©gr√©; </li><li>  les erreurs de fer, les environnements et les plates-formes sur lesquels votre application fonctionne. </li></ul><br>  Discutons de plusieurs m√©thodes tactiques et strat√©giques de programmation d√©fensive, qui permettront de cr√©er un syst√®me fiable et pr√©visible r√©sistant aux d√©faillances arbitraires. <br><br>  Certains conseils peuvent sembler ¬´du capitaine¬ª, mais dans la pratique, de nombreux d√©veloppeurs ne les suivent m√™me pas.  Mais si vous respectez des pratiques et des approches simples, cela augmentera consid√©rablement la stabilit√© de votre syst√®me. <br><br><h2>  Ne fais confiance √† personne </h2><br>  Les donn√©es utilisateur ne sont pas fiables par d√©faut.  Les utilisateurs comprennent souvent mal ce qui nous semble √©vident (en tant que d√©veloppeurs de syst√®mes).  Attendez-vous √† une entr√©e incorrecte et v√©rifiez-la toujours. <br><br>  V√©rifiez √©galement la quantit√© d'entr√©e.  Il se peut que l'utilisateur en envoie trop.  Dans le m√™me temps, du point de vue de la logique m√©tier, c'est le bon sc√©nario.  Mais cela peut entra√Æner un traitement trop long.  Que peut-on faire avec √ßa?  Par exemple, ex√©cutez-le de mani√®re asynchrone, si la quantit√© de donn√©es d'entr√©e d√©passe un certain seuil et que les sp√©cificit√©s de l'entreprise vous permettent de traiter les donn√©es en arri√®re-plan. <br><br>  Les param√®tres d'application (par exemple, les fichiers de configuration) sont √©galement soumis √† l'apparition de donn√©es incorrectes.  Souvent, les param√®tres du programme sont stock√©s dans JSON, YAML, XML, INI et d'autres formats.  √âtant donn√© que tous ces fichiers sont des fichiers texte, il faut s'attendre √† ce que t√¥t ou tard quelqu'un y change quelque chose et que votre programme ne fonctionne plus correctement.  Il peut s'agir d'un utilisateur final ou d'une personne de votre √©quipe. <br><br>  Bases de donn√©es, fichiers, stockages centralis√©s de configurations, registre - tous ces endroits sont accessibles √† d'autres personnes, et t√¥t ou tard ils y changeront quelque chose ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la loi de Murphy</a> ). <br><br><h2>  Entr√©e poubelle ‚Üí entr√©e poubelle </h2><br>  Les entr√©es qui passent la validation et commencent √† √™tre trait√©es doivent √™tre propres si vous voulez que votre code fasse exactement ce que vous attendez de lui. <br><br>  Cependant, il est recommand√© d'effectuer des v√©rifications suppl√©mentaires de validation des donn√©es, y compris lorsqu'elles ont d√©j√† commenc√© √† √™tre trait√©es.  Dans les endroits critiques (facturation, autorisation, donn√©es personnelles et confidentielles, etc.), c'est presque une exigence obligatoire.  Ceci est n√©cessaire pour qu'en cas de bogues dans le code ou de probl√®mes avec le validateur de donn√©es d'entr√©e, arr√™tez le flux d'ex√©cution le plus rapidement possible.  Il est difficile de faire une validation de haute qualit√© en v√©rifiant tous les sc√©narios d'erreur possibles, vous pouvez donc utiliser des moyens plus simples pour valider que le programme s'ex√©cute toujours correctement - assertions et exceptions. <br><br>  La parano√Øaie saine est une caract√©ristique de tous les d√©veloppeurs professionnels.  Mais il est tr√®s important de rechercher l'√©quilibre optimal et de comprendre quand la solution est d√©j√† suffisamment bonne. <br><br><h2>  Configurations s√©par√©es autour des environnements </h2><br>  Une cause fr√©quente de probl√®mes est la s√©paration insuffisante des configurations entre les environnements ou l'absence d'une telle s√©paration. <br><br>  Cela peut entra√Æner de nombreux probl√®mes, par exemple: <br><br><ul><li>  l'environnement de test commence √† lire et / ou √† √©crire des donn√©es √† partir de la production, des bases de donn√©es, des files d'attente et d'autres ressources; </li><li>  l'environnement de test utilise des int√©grations et des services externes avec un compte de production; <br></li><li>  m√©langer les statistiques, les m√©triques, les erreurs de diff√©rents environnements; <br></li><li>  violation de la s√©curit√© (d√©veloppeurs, testeurs et autres membres de l'√©quipe ont acc√®s aux ressources de production); </li><li>  bogues difficiles √† √©tudier sur la production (par exemple, une partie des messages dans la file d'attente est perdue en raison de l'environnement de test commen√ßant √† le lire). </li></ul><br>  Ce ne sont que des exemples, une liste compl√®te des probl√®mes pouvant √™tre caus√©s par une s√©paration insuffisamment responsable des configurations est presque infinie et d√©pend des sp√©cificit√©s du projet. <br><br>  Une s√©paration responsable des donn√©es de configuration par environnement peut r√©duire consid√©rablement la probabilit√© de voir imm√©diatement toute une classe de probl√®mes associ√©s √†: <br><br><ul><li>  la s√©curit√© </li><li>  la fiabilit√©; </li><li>  support et d√©ploiement (les ing√©nieurs DevOps vous remercieront). </li></ul><br>  De plus, il est recommand√© de stocker les donn√©es secr√®tes (cl√©s, jetons, mots de passe) dans un endroit s√©par√© sp√©cialement con√ßu pour stocker et traiter les secrets.  Ces syst√®mes cryptent les donn√©es en toute s√©curit√©, disposent de moyens flexibles pour g√©rer les droits d'acc√®s et vous permettent √©galement de changer rapidement les cl√©s si elles ont √©t√© compromises.  Dans ce cas, vous n'avez pas besoin de modifier le code et de red√©ployer l'application.  Ceci est particuli√®rement important pour les syst√®mes qui fonctionnent avec des transactions financi√®res, des donn√©es confidentielles ou personnelles. <br><br><h2>  Rappelez-vous l'effet en cascade </h2><br>  L'effet en cascade est une cause courante de la chute de syst√®mes vastes et complexes.  La panne ou la d√©gradation de la fonctionnalit√© de l'une des parties du syst√®me se produit et, un par un, les autres sous-syst√®mes qui lui sont associ√©s commencent √† √©chouer.  En cascade jusqu'√† ce que l'ensemble du syst√®me devienne compl√®tement inaccessible. <br><br>  Quelques astuces de protection: <br><br><ul><li>  utiliser des temporisations progressives (exponentielles) avec un √©l√©ment al√©atoire; </li><li>  d√©finir des valeurs raisonnables pour le d√©lai de connexion et le d√©lai de socket; </li><li>  pr√©voir un repli √† l'avance en cas de d√©faillance des services individuels.  Il est pr√©f√©rable de d√©grader temporairement certaines fonctionnalit√©s, de d√©sactiver compl√®tement les services, mais ne risquez pas de casser tout le syst√®me.  Mais imaginez que dans ce cas, l'utilisateur voit un message compr√©hensible et non effrayant, et que l'√©quipe d'assistance et de d√©veloppement d√©couvre le probl√®me d√®s que possible. </li></ul><br><h2>  Signaler rapidement les probl√®mes </h2><br>  Tous les syst√®mes √©chouent.  Parfois, quelque chose d'√©trange se produit en eux que les cr√©ateurs attendent "une fois tous les 10 ans".  Les int√©grations et les API externes deviennent p√©riodiquement indisponibles ou r√©pondent incorrectement.  La solution de secours pour tous ces cas est souvent difficile, longue ou simplement impossible.  Anticipez cette situation √† l'avance et signalez-la le plus rapidement possible.  Connexion au niveau ERREUR ou au syst√®me de surveillance - pour acquis.  Ajouter une validation suppl√©mentaire √† Healthcheck est encore mieux.  Pour envoyer un message du code √† Slack, Telegram, PagerDuty ou √† un autre service qui informera instantan√©ment votre √©quipe du probl√®me est id√©al. <br><br>  Mais il est important de bien comprendre quand il est judicieux d'envoyer des messages directement.  Seulement si une erreur, une situation suspecte ou atypique est associ√©e √† des processus m√©tier et qu'il est important qu'une personne ou un groupe de personnes sp√©cifique dans une √©quipe re√ßoive une notification d√®s que possible et puisse r√©pondre. <br><br>  Tous les autres probl√®mes et √©carts techniques doivent √™tre trait√©s par des moyens standard - surveillance, alerte, journalisation. <br><br><h2>  Mettre en cache les donn√©es fr√©quemment utilis√©es et / ou r√©centes </h2><br>  Les programmes et les utilisateurs ont une chose en commun: ils ont tendance √† r√©utiliser des donn√©es souvent utilis√©es ou r√©cemment rencontr√©es.  Dans les syst√®mes tr√®s charg√©s, vous devez toujours vous en souvenir et mettre en cache les donn√©es dans les endroits les plus chauds du syst√®me. <br><br>  La strat√©gie de mise en cache d√©pend fortement des sp√©cificit√©s du projet et des donn√©es.  Si les donn√©es sont modifiables, il est n√©cessaire d'invalider le cache.  Par cons√©quent, r√©fl√©chissez √† l'avance √† la mani√®re dont vous allez proc√©der.  Et pensez √©galement aux risques qu'il peut y avoir si des donn√©es obsol√®tes apparaissent dans le cache, le cache est en panne, etc. <br><br><h2>  Remplacez les op√©rations co√ªteuses par des op√©rations bon march√© </h2><br>  Travailler avec des cha√Ænes est l'une des op√©rations les plus courantes de tout programme.  Et si cela n'est pas fait de mani√®re optimale, cela peut √™tre une op√©ration co√ªteuse.  Dans diff√©rents langages de programmation, les sp√©cificit√©s du travail avec des cha√Ænes peuvent varier, mais vous devez toujours vous en souvenir. <br><br>  Dans les grandes applications avec une grande base de code, on trouve souvent du code √©crit il y a plusieurs ann√©es qui fonctionne sans erreur, mais n'est pas optimal en termes de performances.  Souvent, un changement banal dans la structure de donn√©es d'un tableau / liste vers une table de hachage donne un s√©rieux coup de pouce (m√™me si ce n'est qu'√† un endroit local dans le code). <br><br>  Parfois, vous pouvez am√©liorer les performances en r√©√©crivant l'algorithme pour utiliser des op√©rations au niveau du bit.  Mais m√™me dans les rares cas o√π il est justifi√©, le code est tr√®s complexe.  Par cons√©quent, lorsque vous prenez une d√©cision, tenez compte de la lisibilit√© du code et du fait qu'il devra √™tre pris en charge.  Il en va de m√™me pour d'autres optimisations d√©licates: presque toujours, un tel code devient difficile √† lire et tr√®s difficile √† maintenir.  Si vous d√©cidez toujours des optimisations d√©licates, n'oubliez pas d'√©crire des commentaires d√©crivant <b>ce que</b> vous voulez que ce code fasse et <b>pourquoi</b> il est √©crit de cette fa√ßon. <br><br>  Dans le m√™me temps, l'optimisation doit √™tre trait√©e avec un pragmatisme sain: <br><br><ul><li>  si cela vous prend, en tant que d√©veloppeur, pendant quelques secondes ou minutes - il est logique de le faire imm√©diatement; </li><li>  si plus, il est raisonnable de le faire imm√©diatement uniquement lorsque vous √™tes s√ªr √† 100% de sa n√©cessit√©.  Dans tous les autres cas, il est logique de le reporter, d'√©crire en code TODO, de collecter plus d'informations, de consulter des coll√®gues, etc. </li></ul><br><blockquote>  L'optimisation pr√©matur√©e est la racine de tout mal (Donald Knuth) <br></blockquote><br><h2>  R√©√©crire dans une langue de niveau inf√©rieur </h2><br>  Il s'agit d'une mesure extr√™me.  Les langues de bas niveau sont presque toujours plus rapides que les langues de niveau sup√©rieur.  Mais cette solution a un prix - d√©velopper un tel programme est plus long et plus difficile.  Parfois, en r√©√©crivant des parties critiques du syst√®me dans un langage de bas niveau, vous pouvez augmenter consid√©rablement votre productivit√©.  Mais il y a des effets secondaires - g√©n√©ralement, ces solutions perdent en multiplateforme et leur support est plus cher.  Par cons√©quent, prenez une d√©cision avec soin. <br><br><h2>  Seul sur le terrain n'est pas un guerrier </h2><br>  Pour terminer, je voudrais noter une autre chose importante, peut-√™tre la plus importante.  Les mesures que nous avons envisag√©es dans les paragraphes pr√©c√©dents ne fonctionneront que si tous les membres de l'√©quipe y adh√®rent et que tout le monde comprend qui est responsable de quoi et ce qui doit √™tre fait en cas de situation critique.  Il est important qu'apr√®s avoir r√©solu le probl√®me, tenez une r√©union (post mortem) avec toutes les personnes int√©ress√©es et d√©couvrez pourquoi ce probl√®me est survenu et ce qui peut √™tre fait pour √©viter que ce probl√®me ne se reproduise √† l'avenir.  Dans de nombreux cas, des modifications techniques et de processus sont n√©cessaires.  Avec chaque nouveau Post Mortem, votre syst√®me deviendra plus fiable, l'√©quipe sera plus exp√©riment√©e et coh√©rente, et l'entropie dans l'univers sera l√©g√®rement moins;) <br><br>  <i>L'article utilise partiellement des documents de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Why Defensive Programming is the Best Way for Robust Coding</a> (Ravi Shankar Rajan).</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472922/">https://habr.com/ru/post/fr472922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472908/index.html">Dagaz: √©pisodes (partie 2)</a></li>
<li><a href="../fr472912/index.html">Base de donn√©es ClickHouse pour les humains ou technologie extraterrestre</a></li>
<li><a href="../fr472914/index.html">R√©f√©rentiel de fonctions Wolfram: plate-forme d'acc√®s ouvert pour les extensions linguistiques Wolfram</a></li>
<li><a href="../fr472916/index.html">Backend, machine learning et serverless sont les plus int√©ressants de la conf√©rence de juillet Habr</a></li>
<li><a href="../fr472918/index.html">ZX Spectrum en Russie et dans la CEI: comment la poursuite du online s'est transform√©e hors ligne</a></li>
<li><a href="../fr472926/index.html">La loi de l'acc√©l√©ration des retours (partie 1)</a></li>
<li><a href="../fr472928/index.html">Service informatique GPU tr√®s charg√©</a></li>
<li><a href="../fr472930/index.html">Les astrophysiciens de la Silicon Valley quantifient la mode</a></li>
<li><a href="../fr472932/index.html">Analyse statique IntelliJ IDEA vs esprit humain</a></li>
<li><a href="../fr472934/index.html">Qu'est-ce qu'un Zero Trust? Mod√®le de s√©curit√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>