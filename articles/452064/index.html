<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>佛  锔 Configuraci贸n y archivos de estado deseado de PowerShell: Parte 1. Configuraci贸n de DSC Pull Server para trabajar con la base de datos SQL 猬锔  </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La configuraci贸n de estado deseado (DSC) de PowerShell facilita la implementaci贸n y configuraci贸n del sistema operativo, las funciones del servidor y ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Configuraci贸n y archivos de estado deseado de PowerShell: Parte 1. Configuraci贸n de DSC Pull Server para trabajar con la base de datos SQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/452064/"><img src="https://habrastorage.org/webt/-4/vu/2i/-4vu2idi-kona7rk1zluhuqtrlk.png"><br><br>  La configuraci贸n de estado deseado (DSC) de PowerShell facilita la implementaci贸n y configuraci贸n del sistema operativo, las funciones del servidor y las aplicaciones cuando tiene cientos de servidores. <br><br>  Pero cuando se usa DSC localmente, es decir  no en MS Azure, hay un par de matices.  Son especialmente tangibles si la organizaci贸n es grande (de 300 estaciones de trabajo y servidores) y a煤n no ha abierto el mundo de los contenedores: <br><br><ul><li>  No hay informes completos sobre el estado de los sistemas.  Si la configuraci贸n necesaria no se aplic贸 en algunos servidores, sin estos informes no sabremos al respecto.  Es bastante dif铆cil obtener informaci贸n del servidor de informes incorporado, y para una gran cantidad de hosts tambi茅n es mucho tiempo. </li><li>  No hay escalabilidad y tolerancia a fallas.  Es imposible construir una granja de servidores web DSC de sondeo que tenga una sola base de datos tolerante a fallas y un repositorio com煤n de archivos de configuraci贸n mof, m贸dulos y claves de registro. </li></ul><br>  Hoy les dir茅 c贸mo resolver el primer problema y obtener los datos para informar.  Todo ser铆a m谩s simple si SQL pudiera usarse como una base de datos.  MS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">promete</a> soporte integrado solo en Windows Server 2019 o en el servidor de compilaci贸n de Windows 1803. Tampoco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">podr谩</a> recuperar datos utilizando el proveedor OleDB, ya que el servidor DSC usa un par谩metro con nombre que no es totalmente compatible con OleDbCommand. <br><br>  Encontr茅 esta manera: para aquellos que usan Windows Server 2012 y 2016, puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">configurar el</a> uso de la base de datos SQL como el back-end para el servidor DSC de sondeo.  Para hacer esto, cree un "proxy" en forma de un archivo .mdb con tablas vinculadas, que redirigir谩 los datos recibidos de los informes del cliente a la base de datos del servidor SQL. <br><a name="habracut"></a><br>  <i>Nota: Para Windows Server 2016, debe usar <a href="">AccessDatabaseEngine2016x86</a> , porque Microsoft.Jet.OLEDB.4.0 ya no es compatible.</i> <br><br>  No me detendr茅 en el proceso de implementaci贸n del servidor DSC de sondeo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu铆 se</a> describe muy bien.  Solo noto un par de puntos.  Si implementamos el DSC de sondeo en el mismo servidor web con WSUS o Kaspersky Security Center, en el script de creaci贸n de configuraci贸n es necesario cambiar los siguientes par谩metros: <br><br><ol><li><pre><code class="sql hljs">UseSecurityBestPractices     = $false</code> </pre> <br>  De lo contrario, TLS 1.0 estar谩 deshabilitado, no podr谩 conectarse a la base de datos SQL.  Kaspersky Security Center tampoco funcionar谩 (el problema debe resolverse en Kaspersky Security Center v11). </li><li><pre> <code class="sql hljs">Enable32BitAppOnWin64   = $true</code> </pre> <br>  Si no realiza este cambio, no puede iniciar el servidor DSC AppPool en IIS con WSUS. </li><li>  Al instalar un servidor DSC con WSUS, deshabilite el almacenamiento en cach茅 est谩tico y din谩mico para el sitio DSC. </li></ol><br>  Pasemos a configurar el servidor DSC para usar la base de datos SQL. <br><br><h3>  Crear una base de datos SQL </h3><br><ol><li>  Cree una base de datos SQL vac铆a llamada DSC. <br><br><img src="https://habrastorage.org/webt/24/je/ik/24jeikjjhurylsfpxfdz-hkdkoo.png"><br><br><img src="https://habrastorage.org/webt/-i/km/hz/-ikmhzvewzfmt8ygqaidws2erzm.png"></li><li>  Cree una cuenta para conectarse a esta base de datos.  Verifique previamente que la autenticaci贸n de las cuentas de Windows y SQL est茅 habilitada en el servidor SQL. <br><br><img src="https://habrastorage.org/webt/z-/qz/tx/z-qztxe410jqyjoj7rwna3t9-am.png"><br><br><img src="https://habrastorage.org/webt/uh/no/vm/uhnovmv8wsywdxi6ahxiinvkj4y.png"></li><li>  Vaya a la secci贸n Asignaci贸n de usuarios.  Seleccione una base de datos, en este caso, DSC.  Otorgamos los derechos del propietario de la base de datos. <br><br><img src="https://habrastorage.org/webt/cl/fg/vg/clfgvg0ya7csozw1ner_egxdxs8.png"></li><li>  Listo <br><br><img src="https://habrastorage.org/webt/9i/la/7n/9ila7nedgtygol496l7da239i1k.png"></li></ol><br><h3>  Crear un esquema para una base de datos DSC </h3><br>  Hay dos formas de crear un esquema para una base de datos DSC: <br><br><ul><li>  independientemente, a trav茅s de un script en TSQL <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ANSI_NULLS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> QUOTED_IDENTIFIER <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[Devices]( [TargetName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationID] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ServerCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [TargetCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeCompliant] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastComplianceTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastHeartbeatTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [Dirty] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusCode] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[RegistrationData]( [AgentId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationNames] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[StatusReport]( [JobId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Id</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [OperationType] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RefreshMode] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ReportFormatVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StartTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [EndTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Errors</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusData] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RebootRequested] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre> </li><li>  importe datos de dispositivos vac铆os.mdb como parte del m贸dulo PS PSDesiredStateConfiguration a trav茅s del Asistente de importaci贸n de datos SQL. <br><br>  Devices.mdb, con el que trabajaremos, se encuentra en C: \ Windows \ SysWOW64 \ WindowsPowerShell \ v1.0 \ Modules \ PSDesiredStateConfiguration \ PullServer. <br></li></ul><br><ol><li>  Para importar datos, ejecute el Asistente de importaci贸n y exportaci贸n de SQL Server. <br><br><img src="https://habrastorage.org/webt/im/3v/ww/im3vwwj9ib9wucm4xnl70jow1yy.png"></li><li>  Elegimos de d贸nde recopilaremos los datos; en nuestro caso, es una base de datos de Microsoft Access.  Haga clic en Siguiente <br><br><img src="https://habrastorage.org/webt/l5/rc/dq/l5rcdqtxvaajv5h5mbil72vv3k0.png"></li><li>  Seleccione el archivo desde donde importamos el esquema. <br><br><img src="https://habrastorage.org/webt/th/dt/xu/thdtxutqcvsrv0laifxjhsbse2w.png"></li><li>  Indicamos d贸nde importar: tenemos esta base de datos SQL. <br><br><img src="https://habrastorage.org/webt/dc/sc/p5/dcscp5f9n-cdmm0qfo0gv_-k0oy.png"></li><li>  Seleccionamos el servidor SQL (Nombre del servidor) y la base de datos a la que importaremos los datos (DataBase). <br><br><img src="https://habrastorage.org/webt/kr/sd/ds/krsddsbr4jpvi9dgvc3f_qcxwqy.png"></li><li>  Seleccionamos la opci贸n Copiar datos de una o m谩s tablas o vistas (copiar datos de tablas o vistas). <br><br><img src="https://habrastorage.org/webt/nu/aq/q8/nuaqq8akzpdz07fwf1gedrxcfns.png"></li><li>  Seleccionamos las tablas desde las cuales importaremos el esquema de la base de datos. <br><br><img src="https://habrastorage.org/webt/bf/7k/at/bf7kat56ltu-amw0nhvgbp2tkpw.png"></li><li>  Marque Ejecutar inmediatamente y haga clic en Finalizar. <br><br><img src="https://habrastorage.org/webt/7i/au/wo/7iauwo3j_x0qzfwqgfc1u8tyfks.png"></li><li>  Listo <br><br><img src="https://habrastorage.org/webt/oi/49/w0/oi49w0cedn8ilblfijwlhjsumfm.png"></li><li>  Como resultado, las tablas deber铆an aparecer en la base de datos DSC. <br><br><img src="https://habrastorage.org/webt/z3/ui/pp/z3uippubkjjk0r2fqolnoweezme.png"></li></ol><br><h3>  Configurar un archivo "proxy" .mdb </h3><br>  <b>Crear una conexi贸n ODBC al servidor SQL.</b>  Se supone que MS Access no est谩 instalado en el servidor con DSC, por lo tanto, la configuraci贸n de bases de datos.mdb se realiza en un host intermedio con MS Access instalado. <br><br>  Creemos una conexi贸n ODBC del sistema al servidor SQL (la profundidad de bits de la conexi贸n debe coincidir con la profundidad de bits de MS Access - 64 o 32).  Se puede crear usando: <br>  - Cmdlet Powershell: <br><br><pre> <code class="sql hljs">Add-OdbcDsn Name DSC DriverName 'SQL Server' Platform '&lt;64-bit or 32-bit&gt;' DsnType System SetPropertyValue @('Description=DSC Pull Server',"Server=&lt;Name of your SQL Server&gt;",'Trusted_Connection=yes','Database=DSC') PassThru</code> </pre> <br>  - o manualmente, utilizando el asistente de conexi贸n: <br><br><ol><li>  Herramientas administrativas abiertas.  Seleccionamos las fuentes de datos ODBC dependiendo de la versi贸n de MS Access instalada.  Vaya a la pesta帽a DSN del sistema y cree una conexi贸n de sistema (Agregar). <br><br><img src="https://habrastorage.org/webt/pt/k5/cu/ptk5cuuxfa2deeqiw_h6vb4vy_4.png"></li><li>  Indicamos que nos conectaremos al servidor SQL.  Haz clic en Finalizar. <br><br><img src="https://habrastorage.org/webt/ey/b_/dz/eyb_dz43l6-xzg3yupw4zgrasbi.png"></li><li>  Especifique el nombre y el servidor para conectarse.  Luego, se deber谩 crear una conexi贸n con los mismos par谩metros en el servidor DSC. <br><br><img src="https://habrastorage.org/webt/_d/py/lq/_dpylq1y7uycuiq08tkq-jp1eri.png"></li><li>  Indicamos que para conectarnos al servidor SQL usamos el inicio de sesi贸n creado previamente con el nombre DSC. <br><br><img src="https://habrastorage.org/webt/_2/bw/bs/_2bwbsadgrihkikrnnh2eq2tkbs.png"></li><li>  Especifique la base de datos en la configuraci贸n de conexi贸n DSC. <br><br><img src="https://habrastorage.org/webt/eg/ex/eg/egexegl50aplc4fr_f1jbfx3edq.png"></li><li>  Haz clic en Finalizar. <br><br><img src="https://habrastorage.org/webt/di/a8/_n/dia8_nwzir-nhafd9rezwstdwjq.png"></li><li>  Antes de completar la configuraci贸n, verificamos que la conexi贸n funciona (fuente de datos de prueba). <br><br><img src="https://habrastorage.org/webt/kt/ft/tm/ktfttmjcb_8gyb3s-o_xnwewyfy.png"></li><li>  Listo <br><br><img src="https://habrastorage.org/webt/4r/4z/aa/4r4zaalbv3rms8xsfjoijzvtige.png"></li></ol><br>  <b>Creaci贸n de la base de datos devices.mdb en MS Access.</b>  Iniciamos MS Access y creamos una base de datos vac铆a llamada devices.mdb. <br><br><img src="https://habrastorage.org/webt/tq/4n/ia/tq4niasnq5av17ozevpg365y_qy.png"><br><br><ol><li>  Vaya a la pesta帽a Datos externos, haga clic en la Base de datos ODBC.  En la ventana que aparece, seleccione Crear una tabla vinculada para la comunicaci贸n con la fuente de datos. <br><br><img src="https://habrastorage.org/webt/aq/ql/vq/aqqlvqqilfgqgdakivqfna9irvu.png"></li><li>  En la nueva ventana, seleccione la pesta帽a Origen de datos de la m谩quina y haga clic en Aceptar.  En la nueva ventana, ingrese las credenciales para conectarse al servidor SQL. <br><br><img src="https://habrastorage.org/webt/rr/8c/zl/rr8czlircqalebpljfw47h5eax4.png"></li><li>  Seleccionamos las tablas que deben vincularse.  Marcamos la casilla de verificaci贸n Guardar contrase帽a y hacemos clic en Aceptar.  La contrase帽a debe guardarse cada vez para las tres tablas. <br><br><img src="https://habrastorage.org/webt/dy/f9/w5/dyf9w58ztue8ugsagfiieghgqsc.png"></li><li>  En los 铆ndices, debe seleccionar lo siguiente: <br>  - TargetName para la tabla dbo_Devices; <br><br><img src="https://habrastorage.org/webt/e-/fl/s_/e-fls_elpbmiktv67egcweaxlvq.png"><br><br>  - NodeName o IPAddress para dbo_RegistrationData; <br><br><img src="https://habrastorage.org/webt/xo/ug/do/xougdoiodatj1tlmsalqpdfzauk.png"><br><br>  - NodeName o IPAddress para dbo_StatusReport. <br><br><img src="https://habrastorage.org/webt/w7/lj/us/w7ljush_8zrt8hupqoqvrtsgk4g.png"></li><li>  Cambie el nombre de las tablas en MS Access, a saber: elimine el prefijo dbo_ para que DSC pueda usarlas. <br><br><img src="https://habrastorage.org/webt/6w/o-/1q/6wo-1qvgkwua75cv1nd1rsmng1k.png"></li><li>  Listo <br><br><img src="https://habrastorage.org/webt/58/16/x8/5816x8uw93muoywridyx-dwjugw.png"></li><li>  Guarde el archivo y cierre MS Access.  Ahora copie los dispositivos.mdb resultantes en el servidor DSC (de forma predeterminada en C: \ Archivos de programa \ WindowsPowershell \ DSCService) y reempl谩celo con el existente (si lo hay). </li></ol><br><h3>  Configurar un servidor DSC para usar SQL </h3><br><ol><li>  Regresamos al servidor DSC.  Para conectarse al servidor SQL con nuestro archivo proxy, cree una nueva conexi贸n ODBC en el servidor DSC.  El nombre, la profundidad de bits y la configuraci贸n de conexi贸n deben ser los mismos que cuando se crea el archivo MDB.  Puede copiar los dispositivos vac铆os ya configurados.mdb desde aqu铆. <br></li><li>  Para usar devices.mdb, debe realizar cambios en el web.config del servidor DSC de sondeo (de forma predeterminada, C: \ inetpub \ PSDSCPullServer \ web.config): </li></ol><br><br>  - para Windows Server 2012 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br>  - para Windows Server 2016 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br><br>  Esto completa la configuraci贸n del servidor DSC. <br><br><h3>  Comprobaci贸n del estado del servidor DSC </h3><br><ol><li>  Compruebe que se pueda acceder al servidor DSC a trav茅s de un navegador web. <br><br><img src="https://habrastorage.org/webt/oi/oe/1z/oioe1zuj9x9gvl9eeek9sc38nz8.png"></li><li>  Ahora verifiquemos si el servidor DSC de sondeo funciona correctamente.  Para esto, el m贸dulo xPSDesiredStateConfiguration tiene un script pullserversetuptests.ps1.  Antes de ejecutar este script, debe instalar el m贸dulo Powershell llamado Pester.  Instalarlo Install-Module -Name Pester. </li><li>  Abra C: \ Archivos de programa \ WindowsPowerShell \ Modules \ xPSDesiredStateConfiguration \ &lt;versi贸n del m贸dulo&gt; \ DSCPullServerSetup \ PullServerDeploymentVerificationTest (en el ejemplo, versi贸n 8.0.0.0.0). <br><br><img src="https://habrastorage.org/webt/_5/db/gl/_5dbglhxbi5mgboeexxi_pw7oxk.png"></li><li>  Abra PullServerSetupTests.ps1 y verifique la ruta al web.config del servidor DSC.  Rojo resalt贸 la ruta a web.config, que verificar谩 el script.  Si es necesario, cambie esta ruta. <br><br><img src="https://habrastorage.org/webt/et/te/mn/ettemnvebjfc3kgviqzqsob_eas.png"></li><li>  Ejecute pullserversetuptests.ps1 <br>  Invoke-Pester. \ PullServerSetupTests.ps1 <br>  Todo funciona <br><br><img src="https://habrastorage.org/webt/qc/qp/m5/qcqpm5a4iwsl_-9d7n2uzll9zjg.png"></li><li>  En SQL Management Studio, vemos que los hosts administrados env铆an informes al servidor de informes DSC y los datos van a la base de datos DSC en el servidor SQL. <br><br><img src="https://habrastorage.org/webt/ba/oo/04/baoo048uqhsyxpsv4yaaftqmwvi.png"></li></ol><br>  Eso es todo.  En los siguientes art铆culos, planeo decir c贸mo construir informes sobre los datos recibidos y tocar preguntas sobre tolerancia a fallas y escalabilidad. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/452064/">https://habr.com/ru/post/452064/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452052/index.html">C贸mo redujimos a la mitad el costo de una lecci贸n introductoria al ver una soluci贸n de las aerol铆neas</a></li>
<li><a href="../452054/index.html">Por qu茅 WhatsApp nunca ser谩 seguro</a></li>
<li><a href="../452056/index.html">Golang DevDay: 31 de mayo, Novosibirsk + transmisi贸n</a></li>
<li><a href="../452060/index.html">La informaci贸n predice la esperanza</a></li>
<li><a href="../452062/index.html">驴C贸mo comienza tu ma帽ana?</a></li>
<li><a href="../452066/index.html">Excelsior JET suspende el desarrollo de su compilador AOT despu茅s de 18 a帽os de trabajo</a></li>
<li><a href="../452068/index.html">12. Check Point Getting Started R80.20. Registros e informes</a></li>
<li><a href="../452072/index.html">Implementamos CircularRevealAnimation en Flutter y simult谩neamente publicamos la biblioteca en pub.dev</a></li>
<li><a href="../452074/index.html">El primer juego sobre la unidad o lo que me llev贸 seis meses.</a></li>
<li><a href="../452076/index.html">Rompiendo el navegador UC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>