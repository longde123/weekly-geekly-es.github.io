<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëºüèæ üßëüèª ü§ú Faiblesses HTTPS. 2e partie üë®‚Äçüíª üçü üéè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tout syst√®me a ses propres forces et faiblesses. La premi√®re partie sur les faiblesses du HTTPS a provoqu√© une r√©action ambigu√´ selon laquelle ¬´ce ne ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Faiblesses HTTPS. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413163/">  Tout syst√®me a ses propres forces et faiblesses.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La premi√®re partie sur les faiblesses du HTTPS a</a> provoqu√© une r√©action ambigu√´ selon laquelle ¬´ce ne sont pas des faiblesses, il devait en √™tre ainsi¬ª.  La premi√®re partie disait: <br><br><ol><li>  √Ä propos de l'impossibilit√© de fournir une confidentialit√© et une confidentialit√© compl√®tes aux utilisateurs (vous pouvez toujours suivre et interdire les ressources qu'une personne visite) </li><li>  Le fait que les certificats sont transmis sur un canal ouvert et contiennent souvent plus d'informations que la ressource actuelle (par exemple, le certificat bing.com contient des informations sur 72 ressources suppl√©mentaires, y compris virgo, test, environnement b√™ta) </li></ol><br>  Je continuerai de l'appeler ¬´faiblesses¬ª du design.  Dans cet article, nous parlerons d'une autre faiblesse - la <b>centralisation</b> . <br><br>  HTTPS est bas√© sur les protocoles SSL et TLS (pour simplifier, nous appellerons simplement SSL - bien que SSL et TLS fonctionnent √† diff√©rents niveaux de la pile OSI).  Par cons√©quent, en parlant de faiblesses, nous garderons √† l'esprit la centralisation du protocole SSL. <br><br><h2>  Th√©orie </h2><br>  Commencez avec la th√©orie des protocoles de chiffrement.  Le probl√®me avec la cryptographie moderne n'est pas le cryptage lui-m√™me, mais ce qu'il faut faire avec les cl√©s: comment les stocker, les transf√©rer, les cr√©er et les d√©truire en toute s√©curit√©. <br><br>  La base de SSL est le <i>chiffrement asym√©trique</i> , qui est d√©termin√© par la pr√©sence de deux cl√©s - si l'une est chiffr√©e, alors seule la seconde peut d√©chiffrer, et vice versa. <br><br>  La fonction principale du chiffrement asym√©trique est l' <b>authentification</b> , pas le chiffrement du tout - c'est une op√©ration co√ªteuse en ressources et co√ªteuse pour cet algorithme.  Le chiffrement rapide et efficace est la pr√©rogative des algorithmes sym√©triques qui utilisent la m√™me cl√© pour le chiffrement et le d√©chiffrement. <a name="habracut"></a><br><br>  L'une des cl√©s reste toujours sur un c√¥t√© pour confirmer son identification, elle est dite <b>priv√©e</b> .  La cl√© publique est accessible √† tous. <br><br>  Imaginez qu'il y ait un village du futur dans lequel Boris et Anya vivent.  √Ä l'avenir, les cl√©s d'une taille diff√©rente sont d√©j√† plus strictes et les capacit√©s du cerveau sont disproportionn√©es par rapport au moderne, mais l'approche, supposons, reste la m√™me. <br><br>  Boris et Anya veulent l'intimit√© de leur correspondance amoureuse, donc l'essentiel pour eux est un √©change s√©curis√© d'informations. <br><br>  Dans le cas le plus simple, Boris envoie un message √† Anna: ¬´Parlons¬ª.  Anya g√©n√®re deux paires de cl√©s de chiffrement asym√©triques - Pr1 priv√© et P1 public.  "Allez," dit Anya, "Je suis Anya, voici ma cl√© publique, voici l'algorithme de chiffrement sym√©trique que je connais."  Boris g√©n√®re une cl√© sym√©trique S1, la chiffre avec la cl√© publique Ani P1 (S1).  Maintenant, m√™me Boris lui-m√™me ne pourra pas d√©crypter S1, car seule Anya peut d√©crypter le message avec sa cl√© priv√©e.  Au final, Boris et Ani ont une cl√© de session sym√©trique pour ¬´assurer¬ª une transmission fiable des lettres entre elles et emp√™cher les parents de lire leur correspondance. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b9/e67/314/6b9e67314d1d8ff276cdac79d259c73b.png" alt="image"><br><br>  En particulier, je n'ai pas fortement r√©duit cette messagerie, en fait, nous avons d√©crit SSL Handshake avec authentification unidirectionnelle [1].  Sur une base bidirectionnelle, Boris g√©n√®re sa propre paire de cl√©s et transf√®re la cl√© publique √† Anya. <br><br>  Une conclusion importante que nous pouvons d√©j√† tirer.  Des trois fonctions principales du protocole SSL (authentification, cryptage, int√©grit√©), la plus importante est l'authentification. <br><br>  Tout va bien jusqu'√† ce qu'un facteur apparaisse, offens√© par la vie, qui est avide de lire les lettres des autres, et en plus est √©galement intelligent.  Entre Boris et Anya, la question se pose de savoir comment garantir maintenant que le facteur ne pourra pas lire leurs messages.  La r√©ponse n'est pas possible.  Le facteur peut g√©n√©rer sa propre paire de cl√©s, exposer √† Boris sa cl√© ¬´pr√©tendument¬ª d'Ani, organiser deux cha√Ænes crypt√©es et lire les lettres calmement. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/12b/158/036/12b158036042161746d368ea8f61d5db.png" alt="image"><br><br>  Le dilemme ne peut √™tre r√©solu que par la pr√©sence d'un certain tiers qui peut garantir que la cl√© P1 appartient √† Ana.  Imaginez qu'un conseil de village apparaisse dans le village, qui tient un registre des cl√©s publiques pour les r√©sidents.  Anya peut prendre son passeport, sa cl√© publique P1, y aller et demander √† s'inscrire.  Boris, lorsqu'il re√ßoit P1 d'Ani, il peut se rendre au m√™me conseil de village et v√©rifier le registre.  Si la cl√© ne correspond pas, vous pouvez commencer √† p√©cher le facteur et le bl√¢mer pour tout s√©rieux, bien qu'il puisse aller dans le d√©ni.  Mais le probl√®me est toujours en cours de r√©solution. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/981/d56/043/981d560437ecc4670992bd5f367069d1.png" alt="image"><br><br>  Pas un camilpho, bien s√ªr, Boris se trimballait √† chaque fois avec le conseil du village.  Par cons√©quent, la m√™me authentification peut √™tre effectu√©e avec le conseil de village lui-m√™me.  Le conseil du village s'appelle d√©sormais autorit√© de certification (CA) et poss√®de sa propre paire de cl√©s, P10 et Pr10.  Quand Anya arrive avec un passeport et sa cl√© publique, CA √©met quelque chose comme une carte qui indique que c'est Anya, elle poss√®de la cl√© publique P1, quelques autres informations, jusqu'au num√©ro de passeport, et ajoute un autre champ pour elle signatures: prend toutes les informations de la carte, enl√®ve le hachage, et la chiffre avec sa cl√© priv√©e, et l'appelle une signature num√©rique.  Il serait possible de se passer d'un hachage, mais la signature √©tait alors trop grande.  Et l'AC appelle maintenant cette carte un certificat. <br><br>  Maintenant, pour √©changer des messages d'amour avec Anya, Anya lui donne non seulement son nom et sa cl√© publique, mais son certificat.  Boris n'aura besoin de se rendre qu'une seule fois au conseil du village et de lui demander sa cl√© publique.  Toute information que cette cl√© peut d√©crypter sera a priori consid√©r√©e comme crypt√©e par le conseil de village.  Le facteur ne sait pas quoi faire du tout, il est couvert par un vide existentiel, il ne lui reste qu'une chose - essayer de r√©cup√©rer la cl√© priv√©e du conseil de village pour que la vie redevienne normale. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/822/a8b/93d/822a8b93d97f8521ea56a51348686d39.png" alt="image"><br><br>  Mais la vie ne s'arr√™te pas.  Boris a une autre petite amie dans un village voisin, puis une autre.  Il doit ajouter les cl√©s des autres conseils de village √† ceux de confiance, commence √† tenir son registre avec les cl√©s publiques des autorit√©s de certification.  Elle gagne ensuite une √©chelle nationale et supranationale.  Il y a tellement d'organisations qui signent des certificats qu'elles commencent √† fusionner dans une hi√©rarchie.  L'Autorit√© de certification racine appara√Æt, qui ne signe pas les certificats de simples mortels, mais signe les certificats des centres interm√©diaires (Autorit√© de certification interm√©diaire) apr√®s les avoir v√©rifi√©s.  Il suffit maintenant √† Boris de ne stocker que les cl√©s publiques des certificats racine.  Et d'Ani, il re√ßoit non seulement un de ses certificats, mais aussi des certificats de centres interm√©diaires, afin de les v√©rifier davantage jusqu'au centre racinaire. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/99f/55f/30d/99f55f30dcb8fffcafb5f23a5c318596.png" alt="image"><br><br><h2>  Champ de probl√®me </h2><br>  Le syst√®me devient plus complexe et <i>centralis√©</i> , et √† partir de ce moment, le facteur a de nouveau une chance. <br><br>  D'une part, Boris dispose initialement d'une petite liste d'autorit√©s de certification racine (Windows prescrit environ 50 autorit√©s de certification racine lors de l'installation).  En revanche, il lui est difficile de suivre √† chaque fois toute la cha√Æne des centres de certification.  Tr√®s probablement, il ne v√©rifiera plus que le certificat d'Ani de son propre village indique pour une raison quelconque le centre de certification d'un autre pays.  Il fait confiance √† sa liste de centres racinaires √† 99,9%.  Un facteur peut emprunter le chemin le plus brutal, et en quelque sorte (ing√©nierie sociale, piratage avec p√©n√©tration) enregistrer sa fausse autorit√© de certification racine dans le registre de Boris. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/649/a3f/357/649a3f3579c7f587bd7bf5990be4608c.png" alt="image"><br><br>  <b>PS.</b>  Cette m√©thode d'ajout d'un faux certificat de centre racine est activement utilis√©e par les pentesters (comme moi) et les attaquants.  Pour effectuer des tests de p√©n√©tration et utiliser cette approche, mon outil pr√©f√©r√© est ZapProxy (gratuit et open source), qui g√©n√©rera un certificat de centre racine (il devra √™tre install√© manuellement), puis √† la vol√©e remplacer ce certificat par un certificat "similaire".  Cela vous permet non seulement de visualiser le trafic, mais aussi de l'arr√™ter, de le modifier et de l'envoyer plus loin.  Par cons√©quent, si la validation sur votre syst√®me n'est pas dupliqu√©e sur le serveur, vous avez certainement des probl√®mes. <br><br>  <b>PPS</b>  Le deuxi√®me probl√®me qui a √©t√© soulev√© dans cette affaire concerne Ani et l'indication d'un centre incompr√©hensible dans son certificat.  Anya a pay√© l'argent et aimerait que Boris la reconnaisse quand m√™me.  Ce probl√®me est r√©solu √† l'aide de SSL Pinning [3], lorsque l'application ne peut √™tre approuv√©e que dans un certain certificat et certaines autorit√©s de certification.  Ceci est particuli√®rement utile pour les applications √† haut risque.  Avec les navigateurs, c'est plus compliqu√©, pour les applications mobiles qui fonctionnent avec un ou deux services, c'est plus simple.  Par souci d'exp√©rience, j'ai mis un faux certificat sur mon Android, indiqu√© que le trafic devait passer par ZapProxy, qui se prolonge sur le r√©seau de ma machine, et regard√© combien d'applications utilisent ce m√©canisme.  Presque personne, j'ai pu regarder et jouer avec la substitution du trafic avec presque toutes les applications populaires. <br><br>  Revenons donc √† notre facteur.  Le gouvernement ne peut qu'appr√©cier son z√®le et lui donne le statut d'agent secret aux pouvoirs sup√©rieurs.  Bien que les cl√©s priv√©es des autorit√©s de certification racine soient stock√©es sous sept verrous, des disques auto-gravables, une protection √† plusieurs niveaux - m√™me l'autorit√© du facteur peut ne pas √™tre suffisante pour n√©gocier avec eux pour lui fournir leur cl√© priv√©e afin de g√©n√©rer √† la vol√©e de faux certificats valides (bien que tout soit possible).  Il a trouv√© un moyen plus facile.  Il se rend dans son propre conseil de village, qui se trouve dans la hi√©rarchie des centres de certification au niveau le plus bas, et presse ou soudoie le conseil de village pour qu'il signe son certificat comme certificat d'un centre de certification interm√©diaire.  Maintenant, il peut √©couter le trafic non seulement de Boris, mais en principe de n'importe quel sujet.  La personne ne remarquera probablement rien, le navigateur n'√©mettra aucun avertissement. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/958/fb1/abd/958fb1abd619e6f93d8ee7ad12162f0b.png" alt="image"><br><br>  Il s'agit d'un probl√®me connu, et l'humanit√© essaie √©galement de le combattre.  Si de tels faux certificats, des centres interm√©diaires et racine compromis sont trouv√©s, ces certificats doivent √™tre marqu√©s comme r√©voqu√©s et compromis (certificats r√©voqu√©s).  Cela signifie qu'en plus de stocker les certificats racine, Boris doit toujours les synchroniser avec la liste en ligne des certificats r√©voqu√©s - ce m√©canisme est impl√©ment√© via les protocoles CRL (liste de r√©vocation des certificats) et OCSP (Online Certificate Status Protocol) [4], qui, soit dit en passant, fonctionnent selon canal non prot√©g√©.  Lorsque nous avons commenc√© √† travailler activement sur le contr√¥le du trafic OUTPUT √† l'aide de Dhound [5], nous avons remarqu√© des demandes p√©riodiques sur le port 80.  Si vous interdisez de telles demandes au niveau du pare-feu, certaines fonctions cessent de fonctionner, par exemple l'envoi de courrier.  Le probl√®me des certificats r√©voqu√©s est qu'il y en a d√©j√† un grand nombre: en 2013, il y avait environ 3 millions de certificats r√©voqu√©s [6], 23 000 certificats Symantec r√©voqu√©s rien qu'en 2018 [7].  Chrome a d√©sactiv√© la fonction par d√©faut de v√©rification compl√®te des certificats r√©voqu√©s il y a quelques ann√©es [8] pour augmenter la vitesse de chargement des pages.  Il s'av√®re que si notre facteur est d√©couvert, le processus de pr√©vention suppl√©mentaire de ses actions sera long et pas toujours couronn√© de succ√®s. <br><br><h2>  Conclusions </h2><br>  Le syst√®me SSL moderne est partiellement <i>ferm√© et centralis√©</i> , ce qui est certainement l'une de ses faiblesses.  Tant qu'il en sera ainsi, il y aura toujours une tentation pour les ¬´personnes puissantes de ce monde¬ª d'en tirer leurs avantages, sans accorder la priorit√© √† la vie priv√©e.  Pourtant, leurs propres algorithmes de chiffrement seront cr√©√©s au niveau national, dans le but d'isoler d'autres pays de leurs propres citoyens, et de le faire nous-m√™mes.  La compromission de n≈ìuds cl√©s peut faire tomber l'ensemble du syst√®me dans son ensemble.  L'entropie et la complexit√© croissantes du syst√®me conduiront de plus en plus √† son √©tat instable et, finalement, √† la mort du syst√®me. <br><br>  Quelle sortie?  Le passage d'un syst√®me SSL ferm√© et centralis√© √† un syst√®me plus transparent et distribu√©, qui, de par sa nature, ne pourra offrir d'avantages √† aucune des parties.  Ce sera peut-√™tre une solution quelque peu similaire √† celle qui impl√©mente une blockchain ouverte. <br><br>  PS.  Le protocole SSL a des nuances plus complexes qui n'√©taient pas mentionn√©es dans l'article.  Mais le niveau d'information √©tait suffisant pour r√©v√©ler l'une de ses faiblesses.  Y a-t-il d'autres faiblesses?  Dans les articles suivants, nous examinerons. <br><br><div class="spoiler">  <b class="spoiler_title">Les r√©f√©rences</b> <div class="spoiler_text"><ol><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Prise de contact SSL</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ZapProxy</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SSL Pining</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">R√©vocation de certificats (CRL vs OCSP)</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dhound</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une √©valuation de l'efficacit√© des CRLSets de Chrome</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">23 000 certificats Symantec r√©voqu√©s suite √† une fuite de cl√©s priv√©es</a> ] </li><li>  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Activation des v√©rifications de r√©vocation de certificats dans Google Chrome</a> ] </li></ol></div></div><br>  Publi√© par Denis Koloshko, CISSP </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413163/">https://habr.com/ru/post/fr413163/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413151/index.html">La NSA a propos√© une norme de chiffrement pour les appareils IoT, mais l'ISO l'a rejet√©e</a></li>
<li><a href="../fr413155/index.html">Google Shell Style Guide (en russe)</a></li>
<li><a href="../fr413157/index.html">√Ä propos du stockage des mots de passe dans la base de donn√©es</a></li>
<li><a href="../fr413159/index.html">Interface sombre ou claire? Conseils pour choisir un jeu de couleurs pour votre interface</a></li>
<li><a href="../fr413161/index.html">Git poem</a></li>
<li><a href="../fr413165/index.html">Explication SRTP</a></li>
<li><a href="../fr413167/index.html">Comment int√©grer Zimbra √† un syst√®me DLP?</a></li>
<li><a href="../fr413169/index.html">Array et m√©thodes d'objets utiles en JavaScript</a></li>
<li><a href="../fr413171/index.html">Tokamak JET lance une nouvelle campagne sur le deut√©rium tritium</a></li>
<li><a href="../fr413173/index.html">Surveillance des erreurs JavaScript avec window.onerror</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>