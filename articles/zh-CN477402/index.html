<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈶 💃🏿 🥜 将Keras深度学习模型部署为Python Web应用程序 👩🏿‍✈️ 🤷 👉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文的翻译是专门为“ Python中的Web开发人员”课程的学生准备的。 



 创建一个很棒的机器学习项目是一回事，而当您需要其他人也能看到它时，则是另一回事。 当然，您可以将整个项目放在GitHub上，但是您的祖父母如何理解您的所作所为？ 不，我们需要将深度学习模型部署为Web应用程序，世界上...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>将Keras深度学习模型部署为Python Web应用程序</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/477402/">  <i>本文的翻译是专门为<a href="https://otus.pw/PcSx/">“ Python中的Web开发人员”</a>课程的学生准备的。</i> <br><br><img src="https://habrastorage.org/webt/vz/ii/2j/vzii2j88n5_-t9hihzrz276v7ho.png"><br><hr><br> 创建一个很棒的机器学习项目是一回事，而当您需要其他人也能看到它时，则是另一回事。 当然，您可以将整个项目放在GitHub上，但是您的祖父母如何理解您的所作所为？ 不，我们需要将深度学习模型部署为Web应用程序，世界上任何人都可以使用。 <br><br> 在本文中，我们将学习如何编写一个使用Keras训练的递归神经网络并允许用户创建新专利注释的Web应用程序。 该项目基于<a href="https://medium.com/p/ffd204f99470%3Fsource%3Duser_profile---------6------------------">“示例递归神经网络”一文中的工作</a> ，但是，不必知道现在如何构建RNN。 目前，我们将其视为黑匣子：我们设置了初始序列，并显示了全新的专利注释，可以在浏览器中查看！ <a name="habracut"></a><br><br> 通常，数据分析师会开发模型，然后前端将模型展示给全世界。 在这个项目中，我们将必须同时扮演两个角色，并投入到Web开发中（尽管几乎完全使用Python）。 <br><br> 该项目将需要组合几种工具： <br><br><ul><li>  <a href="http://flask.pocoo.org/">Flask</a> ：用Python创建一个基本的Web应用程序； </li><li>  <a href="http://keras.io/">Keras</a> ：部署<a href="http://keras.io/">预训练的递归</a>神经网络 </li><li>  <a href="http://jinja.pocoo.org/">Jinja</a>模板引擎中的模板； </li><li> 用于创建网页的<a href="https://www.w3schools.com/html/">HTML</a>和<a href="https://www.w3schools.com/html/html_css.asp">CSS</a> 。 </li></ul><br> 最终，我们获得了一个Web应用程序，该应用程序允许用户使用经过训练的循环神经网络创建全新的专利注释。 <br><br><img src="https://habrastorage.org/webt/l_/oc/2j/l_oc2jgyuokd3kvrsk2pn87bhis.gif"><br><br> 所有项目代码都可以在<a href="https://github.com/WillKoehrsen/recurrent-neural-networks">GitHub上获得</a> 。 <br><br><h3> 方法 </h3><br> 目标是尽快部署Web应用程序。 为此，我选择了Flask，它允许您使用Python编写应用程序。 我不喜欢弄乱样式（我想您已经看过），因此我复制并粘贴了来自第三方来源的几乎所有CSS。  Keras团队的这篇<a href="https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html">文章</a>对于学习基础知识很有用，并且<a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">这篇文章</a>也是有用的指南。 <br><blockquote>  <i>总的来说，这个项目符合我的设计原则：创建一个可以快速工作的原型（复制和粘贴所需的代码），然后重复同样的事情来改进产品。</i> </blockquote><h3>  Flask上的基本Web应用程序 </h3><br> 创建Python Web应用程序的最快方法是使用Flask（http://flask.pocoo.org/）。 要创建自己的应用程序，我们可以使用以下代码： <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Not Much Going On Here&lt;/h1&gt;"</span></span> app.run(host=<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>, port=<span class="hljs-number"><span class="hljs-number">50000</span></span>)</code> </pre> <br> 如果运行此代码，您将在localhost：50000看到自己的应用程序。 当然，我们还需要更多的东西，因此我们将使用更复杂的功能，该功能通常会执行相同的功能：它处理来自浏览器的请求，并以HTML形式提供某些内容。 <br><br><h3> 用户输入表格 </h3><br> 当用户转到应用程序的主页时，我们将向他们显示一个包含三个选项的表单： <br><br><ol><li> 输入RNN的源序列或随机生成。 </li><li> 选择RNN预测的“多样性”。 </li><li> 从RNN输出的单词数的选择。 </li></ol><br> 要在Python中创建表单，我们使用<a href="https://wtforms.readthedocs.io/">wtforms</a> 。 您将在下面看到创建代码： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wtforms <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> (Form, TextField, validators, SubmitField, DecimalField, IntegerField) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReusableForm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Form)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""User entry form for entering specifics for generation"""</span></span> <span class="hljs-comment"><span class="hljs-comment"># Starting seed seed = TextField("Enter a seed string or 'random':", validators=[ validators.InputRequired()]) # Diversity of predictions diversity = DecimalField('Enter diversity:', default=0.8, validators=[validators.InputRequired(), validators.NumberRange(min=0.5, max=5.0, message='Diversity must be between 0.5 and 5.')]) # Number of words words = IntegerField('Enter number of words to generate:', default=50, validators=[validators.InputRequired(), validators.NumberRange(min=10, max=100, message='Number of words must be between 10 and 100')]) # Submit button submit = SubmitField("Enter")</span></span></code> </pre> <br> 使用它，我们创建了如下所示的表单（带有<code>main.css</code>样式）： <br><br><img src="https://habrastorage.org/webt/ja/mc/2j/jamc2jeigbqz87z4flruuzuzp4e.png"><br><br> 需要检查代码以确保用户输入正确的信息。 例如，我们检查所有字段是否都已填写，并且多样性参数的值在0.5到5之间。必须满足这些条件才能上手。 <br><br><img src="https://habrastorage.org/webt/wz/wy/e2/wzwye2lrn8rrnfdp1lemj9hf4p4.png"><br>  <i>验证输入的数据时出错</i> <br><br> 我们使用<code>Flask</code>模板处理此表单。 <br><br><h3> 模式 </h3><br> 模板是具有已经准备好的“框架”的文件，只需以某种方式填充即可。 对于Flask Web应用程序，我们可以使用<a href="http://jinja.pocoo.org/">Jinja</a>模板库将Python代码转换为HTML文档。 例如，在我们的main函数中，我们会将表单的内容发送到名为<code>index.html</code>的模板。 <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> render_template <span class="hljs-comment"><span class="hljs-comment"># Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br> 当用户转到主页时，我们的应用程序将为<code>index.html</code>来自表单的输入。 模板是一个完整的HTML结构，其中我们使用<code>{{variable}}</code>语法引用Python变量。 <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>RNN Patent Writing<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span>Writing Novel Patent Abstracts with Recurrent Neural Networks<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {% for message in form.seed.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.diversity.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.words.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">post</span></span></span><span class="hljs-tag">&gt;</span></span> {{ form.seed.label }} {{ form.seed }} {{ form.diversity.label }} {{ form.diversity }} {{ form.words.label }} {{ form.words }} {{ form.submit }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 当表单出现错误（无法验证的输入）时，错误消息将闪烁。 此外，该表格将显示在上面的文件中。 <br><br> 当用户输入信息并单击<code>submit</code> （ <code>POST</code>请求）时，如果信息正确，我们将使用经过训练的RNN将输入数据重定向到相应的功能，以进行预测。 这意味着您需要修改<code>home()</code> 。 <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request <span class="hljs-comment"><span class="hljs-comment"># User defined utility functions from utils import generate_random_start, generate_from_seed # Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # On form entry and all conditions met if request.method == 'POST' and form.validate(): # Extract information seed = request.form['seed'] diversity = float(request.form['diversity']) words = int(request.form['words']) # Generate a random sequence if seed == 'random': return render_template('random.html', input=generate_random_start(model=model, graph=graph, new_words=words, diversity=diversity)) # Generate starting from a seed sequence else: return render_template('seeded.html', input=generate_from_seed(model=model, graph=graph, seed=seed, new_words=words, diversity=diversity)) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br> 现在，当用户按下<code>submit</code>且输入的信息正确时，根据输入，输入将被发送到<code>generate_random_start</code>或<code>generate_from_seed</code> 。 这些功能使用Keras训练的模型来创建具有用户和<code>diversity</code>参数<code>num_words</code>的新专利。 该函数的输出又被随机发送到<code>random.html</code>或<code>seeded.html</code>模板以显示为网页。 <br><br><h2> 使用Keras预训练模型创建预测 </h2><br> 参数parameter包含预训练的Keras模型，其加载如下： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_keras_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Load in the pre-trained model"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> model model = load_model(<span class="hljs-string"><span class="hljs-string">'../models/train-embeddings-rnn.h5'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Required for model to work global graph graph = tf.get_default_graph() load_keras_model()</span></span></code> </pre> <br>  （本质上，有一种变通方法看起来像<code>tf.get_default_graph()</code> ） <br> 我不会完全展示两个<code>util</code>函数（您将在<a href="https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/utils.py">此处</a>找到代码），因为您需要了解的是它们将已经训练好的Keras模型与参数一起存储并做出预测-专利注释。 <br><br> 这两个函数均在Python中返回带有格式化HTML的字符串。 此行发送到另一个模板，该模板将显示为网页。 例如， <code>generate_random_start</code>返回已发送给<code>random.html</code>格式化HTML： <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Random Starting Abstract <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>Home<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {{input|safe}} {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 在这里，我们再次使用<code>Jinja</code>模板引擎来显示格式化的HTML文件。 由于Python字符串已经被转换为HTML，因此我们需要显示<code>{{input|safe}}</code> （其中<code>input</code>是Python变量）来显示它。 然后，在<code>main.css</code>我们可以向该页面以及其他HTML页面添加样式。 <br><br><h3> 工作成果 </h3><br>  <code>generate_random_start</code>函数选择一个随机专利注释作为输入序列，并根据该注释进行预测。 然后显示输入序列，RNN生成的输出和实际输出： <br><br><img src="https://habrastorage.org/webt/z_/2y/6q/z_2y6q7q7xalfmwihsw3ohxwuza.png"><br>  <i>输出基于随机输入序列。</i> <br><br>  <code>generate_from_seed</code>函数接受用户输入的初始序列，并基于该序列构建预测。 输出如下： <br><br><img src="https://habrastorage.org/webt/vd/4t/xw/vd4txwgqdyresaxrd5a0midnosm.png"><br>  <i>基于用户输入序列的输出。</i> <br><br> 尽管结果并不总是形成逻辑序列，但是它们表明神经网络熟悉英语的基础知识。 她受过训练，可以根据前50个单词预测每个下一个单词，从而选择引人注目的注释。 根据<code>diversity</code>参数，输出可能是完全随机的或周期性的。 <br><br><h3> 应用启动 </h3><br> 要自己启动该应用程序，您需要做的就是下载存储库，转到部署所在的目录，然后输入<code>run_keras_server.py</code> 。 该应用程序将在<code>localhost:10000</code>可用。 <br><br> 根据家庭Wi-Fi的配置方式，您应该能够使用IP地址从网络上的任何计算机访问该应用程序。 <br><br><h3> 后续步骤 </h3><br> 在您的个人计算机上运行的Web应用程序非常适合与朋友和家人共享。 但是，我绝对不建议您向家庭网络中的所有人打开它。 稍后，我们将学习如何在<a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">AWS EC2</a>上部署应用程序并将其最终展示给全世界。 <br><br> 为了改善应用程序，可以更改样式（ <a href="">在main.css中</a> ），还可以选择添加其他参数，例如选择预训练的<a href="https://github.com/WillKoehrsen/recurrent-neural-networks/tree/master/models">网络</a>的能力。 个人项目的伟大之处在于，您可以根据需要进行开发。 如果要使用该应用程序，请下载<a href="https://github.com/WillKoehrsen/recurrent-neural-networks">存储库</a>并开始使用。 <br><br><img src="https://habrastorage.org/webt/hu/z9/up/huz9upmw2zstf5wdojoflzsrxey.gif"><br><br><h2> 结论 </h2><br> 在本文中，我们学习了如何将Keras预先训练的深度学习模型部署为Web应用程序。 这需要集成许多不同的技术，包括递归神经网络，Web应用程序，模板，HTML，CSS，当然还有<a href="https://www.python.org/">Python</a> 。 <br><br> 尽管这是一个基本的应用程序，但它表明您可以使用深度学习相对较少的精力来创建Web应用程序。 很少有人可以说他们能够以Web应用程序的形式部署深度学习模型，但是如果您按照本文中的说明进行操作，您将成为其中的一员！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN477402/">https://habr.com/ru/post/zh-CN477402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN477388/index.html">NILFS2-用于/ home的防弹文件系统</a></li>
<li><a href="../zh-CN477390/index.html">调试Kubernetes中的网络延迟</a></li>
<li><a href="../zh-CN477392/index.html">打开麦克风：后端。 我们邀请演讲者</a></li>
<li><a href="../zh-CN477396/index.html">如何报名课程并...结束</a></li>
<li><a href="../zh-CN477400/index.html">关于产品经理的职业：如何实现理想？</a></li>
<li><a href="../zh-CN477404/index.html">在C ++中频繁创建和删除对象的问题</a></li>
<li><a href="../zh-CN477406/index.html">技术支持与支持。 关于就业市场和薪资的出色研究。 两年后发生了什么变化？</a></li>
<li><a href="../zh-CN477408/index.html">JavaFX教程：高级布局</a></li>
<li><a href="../zh-CN477414/index.html">数据工程师-21世纪最性感的职业</a></li>
<li><a href="../zh-CN477416/index.html">什么时候有害哈希</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>