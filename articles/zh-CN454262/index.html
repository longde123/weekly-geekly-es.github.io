<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😷 ☄️ 🗾 为什么每个数据科学家都应该知道Dask 👩🏿 ✒️ 🤾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="大家好！ 

 也许今天的出版物标题带有问号看起来会更好-很难说。 无论如何，今天我们想为您提供简短的导览，向您介绍Dask库，该库旨在并行化Python中的任务。 我们希望将来能更彻底地回到这一主题。 


 照片摄于 

 毫无疑问，Dask是我遇到的最具革命性的数据处理工具。 如果您喜欢Pan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>为什么每个数据科学家都应该知道Dask</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/454262/">大家好！ <br><br> 也许今天的出版物标题带有问号看起来会更好-很难说。 无论如何，今天我们想为您提供简短的导览，向您介绍<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dask</a>库，该库旨在并行化Python中的任务。 我们希望将来能更彻底地回到这一主题。 <br><br><img src="https://habrastorage.org/webt/v1/sy/al/v1syalwkg-cp2dnxebftth8yhnu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>照片摄于</i></a> <br><a name="habracut"></a><br> 毫无疑问，Dask是我遇到的最具革命性的数据处理工具。 如果您喜欢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pandas和Numpy</a> ，但有时您无法处理RAM中无法容纳的数据，那么Dask正是您所需要的。  Dask支持Pandas数据框架和Numpy数据结构（数组）。  Dask可以在本地计算机上运行或扩展，然后在群集中运行。 本质上，您只需编写一次代码，然后选择使用最通用的Python语法在本地计算机上使用它还是将其部署在许多节点的群集中。 该功能本身很棒，但是我决定写这篇文章只是为了强调：每个数据科学家（至少使用Python）都应该使用Dask。 从我的角度来看，Dask的神奇之处在于，通过最小化代码，您可以使用例如笔记本电脑上已经具备的计算能力来并行化它。 使用并行数据处理，程序运行速度更快，您需要等待的时间更少，因此，还有更多的时间用于分析。 特别是，在本文中，我们将讨论<code>dask.delayed</code>对象及其如何适合数据科学任务流。 <br><br><h3> 介绍Dask </h3><br> 作为对Dask的介绍，这里有几个示例，旨在让您大致了解其语法。 在这种情况下，我想建议的最重要的结论是，您已经拥有的知识将足以起作用。 您不必学习像Hadoop或Spark这样的新大数据工具。 <br><br>  Dask提供了3个并行集合，您可以在其中存储超出RAM大小的数据，即数据框，数据包和数组。 在每种类型的集合中，您可以通过在RAM和硬盘驱动器之间进行分段来存储数据，以及在群集中的多个节点之间分布数据。 <br><br>  Dask数据框由切细的数据框（例如Pandas中的数据框）组成，因此您可以使用Pandas查询语法中的部分功能。 下面是一个示例代码，该示例代码下载2018年的所有csv文件，解析带有时间戳的字段，并启动Pandas请求： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.dataframe <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> dd df = dd.read_csv(<span class="hljs-string"><span class="hljs-string">'logs/2018-*.*.csv'</span></span>, parse_dates=[<span class="hljs-string"><span class="hljs-string">'timestamp'</span></span>]) df.groupby(df.timestamp.dt.hour).value.mean().compute()</code> </pre> <br>  <i>Dask数据框示例</i> <br><br> 在Dask Bag中，您可以存储和处理内存中不适合的Python对象的集合。  Dask Bag非常适合处理json格式的日志和文档集合。 在此代码示例中，将2018年的所有json文件加载到Dask Bag数据结构中，解析每个json记录，并使用lambda函数过滤用户数据： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.bag <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> db <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json records = db.read_text(<span class="hljs-string"><span class="hljs-string">'data/2018-*-*.json'</span></span>).map(json.loads) records.filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> d: d[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] == <span class="hljs-string"><span class="hljs-string">'Aneesha'</span></span>).pluck(<span class="hljs-string"><span class="hljs-string">'id'</span></span>).frequencies()</code> </pre> <br>  <i>达斯袋示例</i> <br><br>  Dask Arrays数据结构支持Numpy样式切片。 在以下示例中，一组HDF5数据被划分为尺寸为（5000，5000）的块： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py f = h5py.File(<span class="hljs-string"><span class="hljs-string">'myhdf5file.hdf5'</span></span>) dset = f[<span class="hljs-string"><span class="hljs-string">'/data/path'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.array <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> da x = da.from_array(dset, chunks=(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>))</code> </pre> <br>  <i>Dask数组示例</i> <br><br><h3>  Dask中的并行处理 </h3><br> 本节的另一个同样准确的标题是“顺序循环的死亡”。 我时不时地遇到一个共同的模式：遍历元素列表，然后对每个元素执行Python方法，但是要使用不同的输入参数。 常见的数据处理方案包括为每个客户计算功能汇总或为每个学生从日志中汇总事件。  Dask Delayed对象可让您并行处理许多元素，而不是将函数应用于顺序循环中的每个自变量。 使用Dask Delayed时，所有函数调用都排队，放入执行图，然后计划对其进行处理。 <br><br> 我总是很懒惰编写自己的线程引擎或使用asyncio，所以我什至不会向您展示类似的示例进行比较。 使用Dask，您既不能更改语法也不可以更改编程风格！ 您只需要注释或包装该方法，该方法将与<code>@dask.delayed</code>并行执行，并在执行循环代码后调用计算方法。 <br><br><img src="https://habrastorage.org/webt/e_/_t/k9/e__tk9l_qrxshram0hqh-golmie.png"><br><br><h3> 达斯克计算图示例 </h3><br> 在下面的示例中，这两种方法都用<code>@dask.delayed</code>注释。 三个数字存储在列表中，它们需要平方，然后求和。  Dask建立了一个计算图，该图提供了平方方法的并行执行，然后将此操作的结果传递给<code>sum_list</code>方法。 可以通过<code>calling .visualize()</code>来显示计算图。  <code>Calling .compute()</code>执行计算图。 从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">结论</a>可以明显看出，列表项不是按顺序处理的，而是并行处理的。 <br><br> 可以设置线程数（例如， <code>dask.set_options( pool=ThreadPool(10)</code> ），也可以轻松地将它们交换以使用笔记本电脑或PC上的进程（例如<code>dask.config.set( scheduler='processes'</code> ） 。 <br><br> 因此，我展示了使用Dask从数据科学领域向项目添加任务的并行处理是多么微不足道。 在撰写本文之前不久，我使用Dask将有关用户点击流（访问历史记录）的数据分为40分钟的会话，然后汇总每个用户的属性以进行进一步的聚类。 告诉我们你如何使用Dask！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN454262/">https://habr.com/ru/post/zh-CN454262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN454248/index.html">人工智能时代的农奴</a></li>
<li><a href="../zh-CN454252/index.html">即使是知名组织的Web资源也没有受到儿童错误的保护。</a></li>
<li><a href="../zh-CN454254/index.html">我们在powershell上编写Reverse socks5代理，第3部分</a></li>
<li><a href="../zh-CN454256/index.html">我们的IT有什么问题</a></li>
<li><a href="../zh-CN454260/index.html">儿童节错误代码</a></li>
<li><a href="../zh-CN454264/index.html">关于技术采访的4个明智的YouTube频道</a></li>
<li><a href="../zh-CN454266/index.html">戴尔与Alienware参加Computex 2019：谈论关键创新</a></li>
<li><a href="../zh-CN454272/index.html">关于RTOS的全部真相。 第27条。 系统时间</a></li>
<li><a href="../zh-CN454274/index.html">光线，相机...云：云如何改变电影业</a></li>
<li><a href="../zh-CN454278/index.html">俄罗斯市场的网络保险</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>