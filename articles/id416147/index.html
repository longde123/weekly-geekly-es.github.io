<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤜🏾 🧑🏾 ⛺️ Organisasi navigasi di iOS-aplikasi menggunakan Root Controller 🧒🏾 🏦 🛣️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebagian besar aplikasi seluler berisi lebih dari selusin layar, transisi kompleks, serta bagian-bagian aplikasi, dipisahkan oleh makna dan tujuan. Ol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Organisasi navigasi di iOS-aplikasi menggunakan Root Controller</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416147/"><img src="https://habrastorage.org/webt/uf/0h/3q/uf0h3qqyj6c6tnvj6fbf4089bye.jpeg"><br><br>  Sebagian besar aplikasi seluler berisi lebih dari selusin layar, transisi kompleks, serta bagian-bagian aplikasi, dipisahkan oleh makna dan tujuan.  Oleh karena itu, ada kebutuhan untuk mengatur struktur navigasi yang benar untuk aplikasi, yang akan fleksibel, nyaman, dapat diperluas, menyediakan akses yang nyaman ke berbagai bagian aplikasi, dan juga akan berhati-hati tentang sumber daya sistem. <br><br>  Pada artikel ini, kami akan merancang navigasi dalam aplikasi sedemikian rupa untuk menghindari kesalahan paling umum yang menyebabkan kebocoran memori, merusak arsitektur dan menghancurkan struktur navigasi. <br><a name="habracut"></a><br>  Sebagian besar aplikasi memiliki setidaknya dua bagian: otentikasi (pra-masuk) dan bagian pribadi (pasca-masuk).  Beberapa aplikasi mungkin memiliki struktur yang lebih kompleks, banyak profil dengan login tunggal, transisi kondisional setelah memulai aplikasi (tautan dalam), dll. <br><br>  Dalam praktiknya, dua pendekatan terutama digunakan untuk menavigasi aplikasi: <br><br><ol><li>  Satu tumpukan navigasi untuk pengontrol presentasi (sekarang) dan pengontrol navigasi (push), tanpa kemampuan untuk kembali.  Pendekatan ini menyebabkan semua ViewControllers sebelumnya tetap berada dalam memori. </li><li>  Menggunakan toggle window.rootViewController.  Dengan pendekatan ini, semua ViewControllers sebelumnya hancur dalam memori, tetapi ini tidak terlihat yang terbaik dari sudut pandang UI.  Juga, itu tidak memungkinkan Anda untuk bergerak maju dan mundur jika perlu. </li></ol><br>  Sekarang mari kita lihat bagaimana Anda dapat membuat struktur yang mudah dipelihara yang memungkinkan Anda untuk beralih secara mulus antara berbagai bagian aplikasi, tanpa kode spageti dan navigasi yang mudah. <br><br>  Mari kita bayangkan bahwa kita sedang menulis aplikasi yang terdiri dari: <br><br><ul><li>  Layar utama (Layar <b>splash</b> ): ini adalah layar pertama yang Anda lihat, segera setelah aplikasi dimulai, Anda dapat menambahkan, misalnya, animasi atau membuat permintaan API primer apa pun. </li><li>  <b>Bagian otentikasi</b> : login, registrasi, setel ulang kata sandi, konfirmasi email, dll.  Sesi kerja pengguna biasanya disimpan, jadi tidak perlu memasukkan login setiap kali aplikasi dimulai. </li><li>  <b>Bagian utama</b> : logika bisnis dari aplikasi utama </li></ul><br>  Semua bagian aplikasi ini terisolasi satu sama lain dan masing-masing ada di tumpukan navigasinya sendiri.  Karena itu, kita mungkin memerlukan transisi berikut: <br><br><ul><li>  <b>Layar splash -&gt; Layar otentikasi</b> , jika sesi saat ini dari pengguna aktif tidak ada. </li><li>  <b>Layar splash -&gt;</b> Layar <b>utama</b> , jika pengguna telah masuk ke aplikasi lebih awal dan ada sesi aktif. </li><li>  <b>Layar utama -&gt; layar Otentikasi</b> , jika pengguna keluar </li></ul><br><br>  <b>Pengaturan dasar</b> <br><br>  Ketika aplikasi dimulai, kita perlu menginisialisasi <i>RootViewController</i> , yang akan dimuat terlebih dahulu.  Ini dapat dilakukan dengan kode dan melalui Interface Builder.  Buat proyek baru di xCode dan semua ini sudah dilakukan secara default: <i>main.storyboard</i> sudah terikat ke <i>window.rootViewController</i> . <br><br>  Tetapi untuk fokus pada topik utama artikel, kami tidak akan menggunakan storyboard dalam proyek kami.  Oleh karena itu, hapus <i>main.storyboard</i> , dan kosongkan bidang "Antarmuka Utama" di bawah Target -&gt; Umum -&gt; Info penerapan: <br><br><img src="https://habrastorage.org/webt/kc/ku/cq/kckucqq5vpiklb5p7kyp7rwgqfu.png"><br><br>  Sekarang mari kita ubah metode <i>didFinishLaunchingWithOptions</i> di <i>AppDelegate</i> sehingga terlihat seperti ini: <br><br><pre><code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">]?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { window = <span class="hljs-type"><span class="hljs-type">UIWindow</span></span>(frame: <span class="hljs-type"><span class="hljs-type">UIScreen</span></span>.main.bounds) window?.rootViewController = <span class="hljs-type"><span class="hljs-type">RootViewController</span></span>() window?.makeKeyAndVisible() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br>  Sekarang aplikasi pertama akan meluncurkan <i>RootViewController</i> .  Ganti nama basis <i>ViewController</i> ke <i>RootViewController</i> : <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RootViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController { }</span></span></span></span></code> </pre> <br>  Ini akan menjadi pengontrol utama yang bertanggung jawab untuk semua transisi di antara berbagai bagian aplikasi.  Oleh karena itu, kita akan memerlukan tautan ke sana setiap kali kita ingin melakukan transisi.  Untuk melakukan ini, tambahkan ekstensi ke <i>AppDelegate</i> : <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shared: <span class="hljs-type"><span class="hljs-type">AppDelegate</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UIApplication</span></span>.shared.delegate <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">AppDelegate</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rootViewController: <span class="hljs-type"><span class="hljs-type">RootViewController</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> window!.rootViewController <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">RootViewController</span></span> } }</code> </pre> <br>  <i>Pengambilan paksa opsi dalam kasus ini dibenarkan, karena RootViewController tidak berubah, dan jika ini terjadi secara tidak sengaja, maka aplikasi crash adalah situasi normal.</i> <i><br></i> <br>  Jadi, sekarang kita memiliki tautan ke <i>RootViewController</i> dari mana saja di aplikasi: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rootViewController = <span class="hljs-type"><span class="hljs-type">AppDelegate</span></span>.shared.rootViewController</code> </pre> <br>  Sekarang mari kita buat beberapa kontroler lagi yang kita butuhkan: <i>SplashViewController, LoginViewController,</i> dan <i>MainViewController</i> . <br><br>  Splash Screen adalah layar pertama yang akan dilihat pengguna setelah memulai aplikasi.  Pada saat ini, semua permintaan API yang diperlukan biasanya dibuat, aktivitas sesi pengguna diperiksa, dll.  Untuk menampilkan tindakan latar belakang yang sedang berlangsung, gunakan <i>UIActivityIndicatorView</i> : <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SplashViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> activityIndicator = <span class="hljs-type"><span class="hljs-type">UIActivityIndicatorView</span></span>(activityIndicatorStyle: .whiteLarge) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() view.backgroundColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>.white view.addSubview(activityIndicator) activityIndicator.frame = view.bounds activityIndicator.backgroundColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>(white: <span class="hljs-number"><span class="hljs-number">0</span></span>, alpha: <span class="hljs-number"><span class="hljs-number">0.4</span></span>) makeServiceCall() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeServiceCall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { } }</code> </pre> <br>  Untuk mensimulasikan permintaan API, tambahkan metode <i>DispatchQueue.main.asyncAfter</i> dengan penundaan selama 3 detik: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeServiceCall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { activityIndicator.startAnimating() <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.asyncAfter(deadline: <span class="hljs-type"><span class="hljs-type">DispatchTime</span></span>.now() + .seconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.activityIndicator.stopAnimating() } }</code> </pre> <br>  Kami percaya bahwa sesi pengguna juga diatur dalam permintaan ini.  Dalam aplikasi kami, kami menggunakan <i>UserDefaults</i> untuk ini: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeServiceCall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { activityIndicator.startAnimating() <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.asyncAfter(deadline: <span class="hljs-type"><span class="hljs-type">DispatchTime</span></span>.now() + .seconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.activityIndicator.stopAnimating() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.bool(forKey: “<span class="hljs-type"><span class="hljs-type">LOGGED_IN</span></span>”) { <span class="hljs-comment"><span class="hljs-comment">// navigate to protected page } else { // navigate to login screen } } }</span></span></code> </pre><br>  <i>Anda pasti tidak akan menggunakan UserDefaults untuk menyimpan status sesi pengguna dalam versi rilis program.</i>  <i>Kami menggunakan pengaturan lokal dalam proyek kami untuk menyederhanakan pemahaman dan tidak melampaui topik utama artikel.</i> <br><br>  Buat <i>LoginViewController</i> .  Ini akan digunakan untuk mengautentikasi pengguna jika sesi pengguna saat ini tidak aktif.  Anda dapat menambahkan UI khusus Anda ke controller, tetapi saya akan menambahkan di sini hanya judul layar dan tombol login di Bilah Navigasi. <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() view.backgroundColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>.white title = <span class="hljs-string"><span class="hljs-string">"Login Screen"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> loginButton = <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span>(title: <span class="hljs-string"><span class="hljs-string">"Log In"</span></span>, style: .plain, target: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, action: #selector(login)) navigationItem.setLeftBarButton(loginButton, animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) } <span class="hljs-meta"><span class="hljs-meta">@objc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// store the user session (example only, not for the production) UserDefaults.standard.set(true, forKey: "LOGGED_IN") // navigate to the Main Screen } }</span></span></code> </pre> <br>  Dan akhirnya, buat pengontrol utama aplikasi <i>MainViewController</i> : <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MainViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.backgroundColor = UIColor.lightGray // <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> visually distinguish the protected part title = “Main Screen” let logoutButton = UIBarButtonItem(title: “<span class="hljs-keyword"><span class="hljs-keyword">Log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Out</span></span>”, style: .plain, target: self, action: #selector(logout)) navigationItem.setLeftBarButton(logoutButton, animated: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) } @objc private func logout() { // clear the <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> (example <span class="hljs-keyword"><span class="hljs-keyword">only</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the production) UserDefaults.standard.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, forKey: “LOGGED_IN”) // navigate <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the Main Screen } }</code> </pre> <br>  <b>Navigasi root</b> <br><br>  Sekarang kembali ke <i>RootViewController</i> . <br>  Seperti yang kami katakan sebelumnya, <i>RootViewController</i> adalah satu-satunya objek yang bertanggung jawab untuk transisi antara tumpukan pengontrol independen yang berbeda.  Untuk mengetahui keadaan aplikasi saat ini, kami akan membuat variabel untuk menyimpan <i>ViewController</i> saat ini: <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RootViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> current: <span class="hljs-type"><span class="hljs-type">UIViewController</span></span> }</code> </pre> <br>  Tambahkan initializer kelas dan buat <i>ViewController</i> pertama yang ingin kita muat saat aplikasi dimulai.  Dalam kasus kami, ini akan menjadi <i>SplashViewController</i> : <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RootViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> current: <span class="hljs-type"><span class="hljs-type">UIViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.current = <span class="hljs-type"><span class="hljs-type">SplashViewController</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(nibName: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, bundle: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) } }</code> </pre> <br>  Di <i>viewDidLoad,</i> tambahkan <i>viewController</i> saat ini ke <i>RootViewController</i> : <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RootViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ ... <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() addChildViewController(current) <span class="hljs-comment"><span class="hljs-comment">// 1 current.view.frame = view.bounds // 2 view.addSubview(current.view) // 3 current.didMove(toParentViewController: self) // 4 } }</span></span></code> </pre> <br>  Setelah kami menambahkan <i>childViewController</i> (1), kami menyesuaikan ukurannya dengan mengatur <i>current.view.frame</i> ke <i>view.bounds</i> (2). <br><br>  Jika kita melewati garis ini, <i>viewController</i> akan tetap ditempatkan dengan benar dalam banyak kasus, tetapi masalah dapat terjadi jika ukuran <i>bingkai</i> berubah. <br><br>  Tambahkan subview baru (3) dan panggil metode didMove (toParentViewController :).  Ini akan menyelesaikan operasi add controller.  Segera setelah <i>RootViewController melakukan boot</i> , segera setelah itu <i>SplashViewController</i> ditampilkan. <br><br>  Sekarang Anda dapat menambahkan beberapa metode untuk navigasi dalam aplikasi.  Kami akan menampilkan <i>LoginViewController</i> tanpa animasi apa pun, <i>MainViewController</i> akan menggunakan animasi dengan peredupan halus, dan transisi layar ketika memutuskan <i>koneksi</i> pengguna akan memiliki efek slide. <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RootViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController</span></span></span><span class="hljs-class"> { ... func showLoginScreen() { let new = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UINavigationController</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rootViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoginViewController</span></span></span><span class="hljs-class">()) // 1 addChildViewController(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">) // 2 new.view.frame = view.bounds // 3 view.addSubview(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">view</span></span></span><span class="hljs-class">) // 4 new.didMove(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">toParentViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">) // 5 current.willMove(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">toParentViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nil</span></span></span><span class="hljs-class">) // 6 current.view.removeFromSuperview()] // 7 current.removeFromParentViewController() // 8 current = new // 9 }</span></span></code> </pre><br>  Buat <i>LoginViewController</i> (1), tambahkan sebagai pengontrol anak (2), atur bingkai (3).  Tambahkan tampilan <i>LoginController</i> sebagai subview (4) dan panggil metode didMove (5).  Selanjutnya, siapkan pengontrol saat ini untuk dihapus menggunakan metode willMove (6).  Akhirnya, hapus tampilan saat ini dari superview (7), dan hapus controller saat ini dari <i>RootViewController</i> (8).  Ingatlah untuk memperbarui nilai controller saat ini (9). <br><br>  Sekarang mari kita buat metode <i>switchToMainScreen</i> : <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">switchToMainScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> mainViewController = <span class="hljs-type"><span class="hljs-type">MainViewController</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> mainScreen = <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>(rootViewController: mainViewController) ... }</code> </pre> <br>  Animasi transisi memerlukan metode yang berbeda: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animateFadeTransition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to new: UIViewController, completion: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)? = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { current.willMove(toParentViewController: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) addChildViewController(new) transition(from: current, to: new, duration: <span class="hljs-number"><span class="hljs-number">0.3</span></span>, options: [.transitionCrossDissolve, .curveEaseOut], animations: { }) { completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.current.removeFromParentViewController() new.didMove(toParentViewController: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.current = new completion?() <span class="hljs-comment"><span class="hljs-comment">//1 } }</span></span></code> </pre> <br>  Metode ini sangat mirip dengan <i>showLoginScreen</i> , tetapi semua langkah terakhir dilakukan setelah animasi selesai.  Untuk memberi tahu metode panggilan dari akhir transisi, di bagian paling akhir kita sebut closure (1). <br><br>  Sekarang versi final dari metode <i>switchToMainScreen</i> akan terlihat seperti ini: <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">switchToMainScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> mainViewController = <span class="hljs-type"><span class="hljs-type">MainViewController</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> mainScreen = <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>(rootViewController: mainViewController) animateFadeTransition(to: mainScreen) }</code> </pre> <br>  Dan akhirnya, mari kita buat metode terakhir yang akan bertanggung jawab untuk transisi dari <i>MainViewController</i> ke <i>LoginViewController</i> : <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">switchToLogout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> loginViewController = <span class="hljs-type"><span class="hljs-type">LoginViewController</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> logoutScreen = <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>(rootViewController: loginViewController) animateDismissTransition(to: logoutScreen) }</code> </pre> <br>  Metode <i>AnimateDismissTransition</i> menyediakan animasi slide: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animateDismissTransition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to new: UIViewController, completion: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)? = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { new.view.frame = <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: -view.bounds.width, y: <span class="hljs-number"><span class="hljs-number">0</span></span>, width: view.bounds.width, height: view.bounds.height) current.willMove(toParentViewController: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) addChildViewController(new) transition(from: current, to: new, duration: <span class="hljs-number"><span class="hljs-number">0.3</span></span>, options: [], animations: { new.view.frame = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.bounds }) { completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.current.removeFromParentViewController() new.didMove(toParentViewController: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.current = new completion?() } }</code> </pre><br>  Ini hanya dua contoh animasi, menggunakan pendekatan yang sama Anda dapat membuat animasi kompleks yang Anda butuhkan <br><br>  Untuk menyelesaikan konfigurasi, tambahkan pemanggilan metode dengan animasi dari <i>SplashViewController, LoginViewController,</i> dan <i>MainViewController</i> : <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SplashViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController</span></span></span><span class="hljs-class"> { ... private func makeServiceCall() { if </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserDefaults</span></span></span><span class="hljs-class">.standard.bool(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">forKey</span></span></span><span class="hljs-class">: “</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LOGGED_IN</span></span></span><span class="hljs-class">”) { // navigate to protected page </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppDelegate</span></span></span><span class="hljs-class">.shared.rootViewController.switchToMainScreen() } else { // navigate to login screen </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppDelegate</span></span></span><span class="hljs-class">.shared.rootViewController.switchToLogout() } } } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoginViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController</span></span></span><span class="hljs-class"> { ... @objc private func login() { ... </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppDelegate</span></span></span><span class="hljs-class">.shared.rootViewController.switchToMainScreen() } } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MainViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController</span></span></span><span class="hljs-class"> { ... @objc private func logout() { ... </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppDelegate</span></span></span><span class="hljs-class">.shared.rootViewController.switchToLogout() } }</span></span></code> </pre><br>  Kompilasi, jalankan aplikasi dan periksa operasinya dengan dua cara: <br><br>  - ketika pengguna sudah memiliki sesi aktif saat ini (masuk) <br>  - ketika tidak ada sesi aktif dan otentikasi diperlukan <br><br>  Dalam kedua kasus, Anda akan melihat transisi ke layar yang diinginkan, segera setelah memuat <i>SplashScreen</i> . <br><br><img src="https://habrastorage.org/webt/zq/n5/ss/zqn5ssn9toyzyjhas3wvljnfj9m.gif"><br><br>  Hasilnya, kami menciptakan model uji kecil aplikasi, dengan navigasi melalui modul utamanya.  Jika Anda perlu memperluas kemampuan aplikasi, menambahkan modul tambahan dan transisi di antara mereka, Anda selalu dapat dengan cepat dan mudah memperluas dan skala sistem navigasi ini. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id416147/">https://habr.com/ru/post/id416147/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id416133/index.html">Pusat Data di Luar Negeri: Equinix LD8</a></li>
<li><a href="../id416135/index.html">Aplikasi GUI lebih kecil dari 1 kb</a></li>
<li><a href="../id416137/index.html">Zabbix sebagai pemindai keamanan</a></li>
<li><a href="../id416139/index.html">Otentikasi kuat sebagai bagian dari strategi GDPR</a></li>
<li><a href="../id416143/index.html">Buku "Otopsi akan ditampilkan!" Analisis malware praktis »</a></li>
<li><a href="../id416149/index.html">Pertanyaan dan Jawaban Energi Terbarukan, Bagian 1</a></li>
<li><a href="../id416151/index.html">Balon tanpa dimensi. Sihir Analisis Dimensi Utilitarian</a></li>
<li><a href="../id416153/index.html">Akankah pesawat terbang menjadi lebih andal? Pabrikan pesawat terbang memperkenalkan robot ke perusahaan</a></li>
<li><a href="../id416155/index.html">WebSockets di Angular: buat Layanan Angular untuk bekerja dengan soket web</a></li>
<li><a href="../id416157/index.html">Di lengan Python (khusus wanita)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>