<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👴🏾 🚁 🌐 Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten? 👊🏼 👨🏻‍🔬 🖕🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten? Die traditionelle Antwort auf diese Frage lautet seit einiger Z...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/444348/">  Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten?  Die traditionelle Antwort auf diese Frage lautet seit einiger Zeit: „Durch die Verwendung von Klassen können Sie eine große Anzahl von Funktionen von Komponenten verwenden, z. B. den Status.“  Mit dem Aufkommen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Haken</a> spiegelt diese Antwort nicht mehr den wahren Stand der Dinge wider. <br><br>  Möglicherweise haben Sie gehört, dass eine dieser Arten von Komponenten eine bessere Leistung als die andere aufweist.  Aber welches?  Die meisten Benchmarks, die dies testen, weisen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mängel auf</a> , daher würde ich aufgrund ihrer Ergebnisse mit großer Vorsicht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schlussfolgerungen ziehen</a> .  Die Leistung hängt hauptsächlich davon ab, was im Code geschieht, und nicht davon, ob Funktionskomponenten oder klassenbasierte Komponenten ausgewählt werden, um bestimmte Funktionen zu implementieren.  Unsere Studie hat gezeigt, dass der Leistungsunterschied zwischen verschiedenen Arten von Komponenten vernachlässigbar ist.  Es ist jedoch zu beachten, dass sich die Optimierungsstrategien für die Arbeit mit ihnen geringfügig <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unterscheiden</a> . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/x-/vn/je/x-vnjetrulggl4xjpo2jmitqjvg.jpeg"></a> <br><br>  Auf jeden Fall <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">empfehle</a> ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nicht</a> , vorhandene Komponenten mit neuen Technologien neu zu schreiben, wenn es keine guten Gründe dafür gibt und wenn es Ihnen nichts ausmacht, zu denen zu gehören, die diese Technologien vor allen anderen eingesetzt haben.  Hooks sind immer noch eine neue Technologie (genau wie die React-Bibliothek im Jahr 2014), und einige „Best Practices“ für ihre Anwendung wurden noch nicht in die React-Handbücher aufgenommen. <br><a name="habracut"></a><br>  Wo sind wir endlich hingekommen?  Gibt es grundlegende Unterschiede zwischen den Funktionskomponenten von React und den auf Klassen basierenden Komponenten?  Natürlich gibt es solche Unterschiede.  Dies sind Unterschiede im mentalen Modell der Verwendung solcher Komponenten.  In diesem Artikel werde ich ihren schwerwiegendsten Unterschied betrachten.  Es existiert seit dem Erscheinen von Funktionskomponenten im Jahr 2015, wird aber oft übersehen.  Es besteht darin, dass Funktionskomponenten gerenderte Werte erfassen.  Sprechen wir darüber, was das wirklich bedeutet. <br><br>  Es ist zu beachten, dass dieses Material keinen Versuch darstellt, Komponenten unterschiedlicher Typen zu bewerten.  Ich beschreibe nur den Unterschied zwischen den beiden Programmiermodellen in React.  Wenn Sie mehr über den Einsatz von Funktionskomponenten im Lichte von Innovationen erfahren möchten, lesen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diese</a> Liste mit Fragen und Antworten zu Haken. <br><br><h2>  <font color="#3AC1EF">Was sind die Merkmale des Codes von Komponenten, die auf Funktionen und Klassen basieren?</font> </h2><br>  Betrachten Sie diese Komponente: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {    alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + props.user);  };  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {    setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>);  };  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>  ); }</code> </pre> <br>  Es wird eine Schaltfläche angezeigt, die durch Drücken der Funktion <code>setTimeout</code> eine Netzwerkanforderung simuliert und anschließend ein Meldungsfeld zur Bestätigung des Vorgangs anzeigt.  Wenn beispielsweise ' <code>props.user</code> <code>'Dan'</code> in <code>props.user</code> gespeichert <code>props.user</code> , wird im Nachrichtenfenster nach drei Sekunden <code>'Followed Dan'</code> angezeigt. <br><br>  Beachten Sie, dass es keine Rolle spielt, ob hier Pfeilfunktionen oder Funktionsdeklarationen verwendet werden.  Eine Konstruktion der Formularfunktion <code>function handleClick()</code> funktioniert genauso. <br><br>  Wie schreibe ich diese Komponente als Klasse um?  Wenn Sie den gerade untersuchten Code wiederholen und ihn in den Code einer Komponente konvertieren, die auf einer Klasse basiert, erhalten Sie Folgendes: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.user); }; handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; render() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre> <br>  Es ist allgemein anerkannt, dass zwei solche Codefragmente äquivalent sind.  Und Entwickler sind oft völlig frei, wandeln sich im Zuge des Code-Refactorings ineinander um, ohne über die möglichen Konsequenzen nachzudenken. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d3/c7a/341/1d3c7a341ee3fcadc79df00e7d872e4b.gif"></div><br>  <i><font color="#999999">Diese Codeteile scheinen gleichwertig zu sein</font></i> <br><br>  Es gibt jedoch einen kleinen Unterschied zwischen diesen Codefragmenten.  Schauen Sie sie sich genauer an.  Sehen Sie den Unterschied?  Zum Beispiel habe ich sie nicht sofort gesehen. <br><br>  Weiter werden wir diesen Unterschied daher für diejenigen betrachten, die die Essenz dessen verstehen wollen, was selbst geschieht, ein funktionierendes Beispiel für diesen Code. <br><br>  Bevor wir fortfahren, möchte ich betonen, dass der fragliche Unterschied nichts mit React-Hooks zu tun hat.  In den vorherigen Beispielen werden übrigens nicht einmal Haken verwendet.  Es geht um den Unterschied zwischen Funktionen und Klassen in React.  Wenn Sie vorhaben, viele Funktionskomponenten in Ihren React-Anwendungen zu verwenden, möchten Sie diesen Unterschied möglicherweise verstehen. <br><br>  In der Tat werden wir den Unterschied zwischen Funktionen und Klassen am Beispiel eines Fehlers veranschaulichen, der in React-Anwendungen häufig auftritt. <br><br><h2>  <font color="#3AC1EF">Der Fehler, der in React-Anwendungen häufig auftritt.</font> </h2><br>  Öffnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Beispielseite</a> , auf der eine Liste angezeigt wird, in der Sie Benutzerprofile auswählen können, sowie zwei Schaltflächen zum <code>Follow</code> , die von den <code>ProfilePageClass</code> <code>ProfilePageFunction</code> und <code>ProfilePageClass</code> angezeigt werden. Sie funktionieren und basieren auf der Klasse, deren Code oben angezeigt wird. <br><br>  Versuchen Sie für jede dieser Schaltflächen, die folgende Abfolge von Aktionen auszuführen: <br><br><ol><li>  Klicken Sie auf die Schaltfläche. </li><li>  Ändern Sie das ausgewählte Profil vor Ablauf von 3 Sekunden, nachdem Sie auf die Schaltfläche geklickt haben. </li><li>  Lesen Sie den im Meldungsfeld angezeigten Text. </li></ol><br>  Nachdem Sie dies getan haben, werden Sie die folgenden Funktionen bemerken: <br><br><ul><li>  Wenn Sie auf die Schaltfläche klicken, die von der Funktionskomponente mit dem ausgewählten <code>Dan</code> Profil gebildet wird, und dann zum <code>Sophie</code> Profil wechseln, wird im Meldungsfeld <code>'Followed Dan'</code> angezeigt. </li><li>  Wenn Sie dasselbe mit einer Schaltfläche tun, die von einer Komponente basierend auf einer Klasse gebildet wird, wird <code>'Followed Sophie'</code> angezeigt. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/386/a44/911/386a449110202d5140d67336a0ade5a0.gif"></div><br>  <i><font color="#999999">Klassenbasierte Komponentenfunktionen</font></i> <br><br>  In diesem Beispiel ist das Verhalten der Funktionskomponente korrekt.  Wenn ich das Profil einer Person abonniert und dann zu einem anderen Profil gewechselt habe, sollte meine Komponente nicht daran zweifeln, wessen Profil ich abonniert habe.  Offensichtlich enthält die Implementierung des fraglichen Mechanismus basierend auf der Verwendung von Klassen einen Fehler (Sie sollten übrigens definitiv ein Abonnent von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sofia werden</a> ). <br><br><h2>  <font color="#3AC1EF">Ursachen für Fehlfunktionen klassenbasierter Komponenten</font> </h2><br>  Warum verhält sich eine klassenbasierte Komponente so?  Um dies zu verstehen, werfen wir einen Blick auf die <code>showMessage</code> Methode in unserer Klasse: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.user); };</code> </pre> <br>  Diese Methode liest Daten aus <code>this.props.user</code> .  Die Eigenschaften in React sind unveränderlich und ändern sich daher nicht.  Dies ist jedoch wie immer eine veränderbare Einheit. <br><br>  Tatsächlich liegt der Zweck, <code>this</code> in einer Klasse zu haben, in der Fähigkeit, <code>this</code> zu ändern.  Die React-Bibliothek selbst führt <code>this</code> Mutationen regelmäßig durch, sodass mit den neuesten Versionen der <code>render</code> und der Komponentenlebenszyklusmethoden gearbeitet werden kann. <br><br>  Wenn sich unsere Komponente während der Ausführung der Anforderung erneut rendert, <code>this.props</code> sich <code>this.props</code> .  Danach liest die <code>showMessage</code> Methode den <code>user</code> aus der "zu neuen" <code>props</code> . <br><br>  Auf diese Weise können Sie interessante Beobachtungen zu Benutzeroberflächen machen.  Wenn wir sagen, dass die Benutzeroberfläche konzeptionell eine Funktion des aktuellen Status der Anwendung ist, sind die Ereignishandler Teil der Rendering-Ergebnisse - genau wie die sichtbaren Rendering-Ergebnisse.  Unsere Event-Handler gehören zusammen mit bestimmten Eigenschaften und Zuständen zu einem bestimmten Rendering-Vorgang. <br><br>  Das Planen eines Timeouts, dessen Rückruf <code>this.props</code> liest, verletzt jedoch diese Verbindung.  Der showMessage- <code>showMessage</code> nicht an einen bestimmten Rendering-Vorgang gebunden, sondern verliert die richtigen Eigenschaften.  Das Lesen von Daten <code>this</code> unterbricht diese Verbindung. <br><br><h2>  <font color="#3AC1EF">Wie kann das Problem mithilfe klassenbasierter Komponenten gelöst werden?</font> </h2><br>  Stellen Sie sich vor, dass React keine funktionalen Komponenten enthält.  Wie kann man dieses Problem dann lösen? <br><br>  Wir benötigen einen Mechanismus, um die Verbindung zwischen der Rendermethode mit den richtigen Eigenschaften und dem showMessage- <code>showMessage</code> , der Daten aus den Eigenschaften liest, "wiederherzustellen".  Dieser Mechanismus sollte sich irgendwo befinden, wo die Essenz von <code>props</code> mit den richtigen Daten verloren geht. <br><br>  Eine Möglichkeit, dies zu tun, besteht darin, <code>this.props</code> im Voraus im Ereignishandler zu lesen und dann das Gelesene explizit an die in <code>setTimeout</code> verwendete Rückruffunktion zu <code>setTimeout</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ showMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function">) =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + user); }; handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {user} = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props;   setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage(user), <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; render() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre> <br>  Dieser Ansatz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">funktioniert</a> .  Die hier verwendeten zusätzlichen Konstruktionen führen jedoch im Laufe der Zeit zu einer Zunahme des Codevolumens und zu der Tatsache, dass die Wahrscheinlichkeit von Fehlern darin zunimmt.  Was ist, wenn wir mehr als eine einzelne Immobilie benötigen?  Was ist, wenn wir auch mit dem Staat zusammenarbeiten müssen?  Wenn die <code>showMessage</code> Methode <code>showMessage</code> andere Methode <code>showMessage</code> und diese Methode <code>this.props.something</code> oder <code>this.state.something</code> liest, <code>this.props.something</code> das gleiche Problem erneut auf.  Und um es zu lösen, müssten wir <code>this.props</code> und <code>this.state</code> als Argumente an alle von <code>showMessage</code> aufgerufenen Methoden <code>showMessage</code> . <br><br>  Wenn dies zutrifft, werden alle Annehmlichkeiten zerstört, die die Verwendung von auf Klassen basierenden Komponenten bietet.  Es ist schwer zu merken, dass die Arbeit mit Methoden auf diese Weise schwierig und schwer zu automatisieren ist. Daher sind sich Entwickler häufig einig, dass ihre Projekte Fehler enthalten, anstatt ähnliche Methoden zu verwenden. <br><br>  Ebenso <code>handleClick</code> das Einbetten von <code>handleClick</code> in <code>handleClick</code> kein globaleres Problem.  Wir müssen den Code so strukturieren, dass er in viele Methoden unterteilt werden kann, aber auch, damit wir die Eigenschaften und den Status lesen können, die der mit einem bestimmten Aufruf verbundenen Renderoperation entsprechen.  Dieses Problem betrifft übrigens nicht einmal ausschließlich React.  Sie können es in jeder Bibliothek abspielen, um Benutzeroberflächen zu entwickeln, die Daten in solche veränderlichen Objekte einfügen. <br><br>  Vielleicht können Sie, um dieses Problem zu lösen, Methoden im Konstruktor daran binden? <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {   <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props);   <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>);   <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleClick = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleClick.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } showMessage() {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.user); } handleClick() {   setTimeout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); } render() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre> <br>  Dies löst unser Problem jedoch nicht.  Denken Sie daran, dass wir Daten aus <code>this.props</code> zu spät lesen und nicht in der verwendeten Syntax!  Dieses Problem wird jedoch behoben, wenn wir uns auf JavaScript-Schließungen verlassen. <br><br>  Entwickler versuchen oft, Schließungen zu vermeiden, da es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nicht einfach ist,</a> über Werte nachzudenken, die im Laufe der Zeit nicht mutieren können.  Aber die Eigenschaften in React sind unveränderlich!  (Oder zumindest wird dies dringend empfohlen).  Auf diese Weise können Sie aufhören, Verschlüsse als etwas wahrzunehmen, aufgrund dessen der Programmierer, wie er sagt, „sich selbst in den Fuß schießen kann“. <br><br>  Dies bedeutet, dass Sie sich immer darauf verlassen können, dass sich die Eigenschaften oder der Status eines bestimmten Rendervorgangs beim Schließen nicht ändern, wenn Sie sie sperren. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() {   <span class="hljs-comment"><span class="hljs-comment">//  !   const props = this.props;   //    ,      render.   //   -   .   const showMessage = () =&gt; {     alert('Followed ' + props.user);   };   const handleClick = () =&gt; {     setTimeout(showMessage, 3000);   };   return &lt;button onClick={handleClick}&gt;Follow&lt;/button&gt;; } }</span></span></code> </pre> <br>  Wie Sie sehen können, haben wir hier die Eigenschaften während des Aufrufs der <code>render</code> „erfasst“. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa4/83d/d56/fa483dd5699aac1350c57591770a49be.gif"></div><br>  <i><font color="#999999">Vom Renderaufruf erfasste Eigenschaften</font></i> <br><br>  Bei diesem Ansatz wird für jeden Code in der <code>showMessage</code> (einschließlich <code>showMessage</code> ) garantiert, dass Eigenschaften <code>showMessage</code> werden, die während eines bestimmten Aufrufs dieser Methode erfasst wurden.  Infolgedessen kann React uns nicht mehr davon abhalten, das zu tun, was wir brauchen. <br><br>  In der <code>render</code> können Sie so viele Hilfsfunktionen beschreiben, wie Sie möchten, und alle können die "erfassten" Eigenschaften und den Status verwenden.  So haben Verschlüsse unser Problem gelöst. <br><br><h2>  <font color="#3AC1EF">Analyse der Problemlösung mittels Verschluss</font> </h2><br>  Was wir gerade erreicht haben, ermöglicht es uns <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, das Problem</a> zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lösen</a> , aber ein solcher Code sieht seltsam aus.  Warum wird eine Klasse überhaupt benötigt, wenn Funktionen innerhalb der <code>render</code> deklariert sind und nicht als Klassenmethoden? <br><br>  Tatsächlich können wir diesen Code vereinfachen, indem wir die „Shell“ in Form einer Klasse, die sie umgibt, entfernen: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + props.user); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br>  Hier werden wie im vorherigen Beispiel die Eigenschaften in der Funktion erfasst, da React sie als Argument an sie übergibt.  Im Gegensatz <code>this</code> <code>props</code> React niemals <code>props</code> . <br><br>  Dies wird etwas offensichtlicher, wenn die <code>props</code> in der Funktionsdeklaration zerstört werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + user); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br>  Wenn die übergeordnete Komponente <code>ProfilePage</code> mit anderen Eigenschaften <code>ProfilePage</code> , ruft React die <code>ProfilePage</code> Funktion <code>ProfilePage</code> .  Der Ereignishandler, der bereits als "gehört" zum vorherigen Aufruf dieser Funktion gehört, verwendet jedoch einen eigenen <code>user</code> und einen eigenen showMessage- <code>showMessage</code> , der diesen Wert liest.  All dies bleibt unberührt. <br><br>  Aus diesem Grund ändert sich in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalversion</a> unseres Beispiels nichts, wenn Sie mit einer Funktionskomponente arbeiten und ein anderes Profil auswählen, nachdem Sie auf die entsprechende Schaltfläche geklickt haben, bevor die Nachricht angezeigt wird.  Wenn vor dem Klicken auf die Schaltfläche ein <code>Sophie</code> Profil ausgewählt wurde, wird im Nachrichtenfenster <code>'Followed Sophie'</code> angezeigt, unabhängig davon, was passiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/843/96c/4b3/84396c4b3982827bead96912a947904e.gif"></div><br>  <i><font color="#999999">Verwendung einer Funktionskomponente</font></i> <br><br>  Dieses Verhalten ist korrekt (möglicherweise möchten Sie sich auch für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sunil</a> anmelden). <br><br>  Jetzt haben wir herausgefunden, was der große Unterschied zwischen Funktionen und Klassen in React ist.  Wie bereits erwähnt, handelt es sich um die Tatsache, dass Funktionskomponenten Werte erfassen.  Lassen Sie uns jetzt über Haken sprechen. <br><br><h2>  <font color="#3AC1EF">Haken</font> </h2><br>  Bei der Verwendung von Hooks erstreckt sich das Prinzip der "Erfassung von Werten" auf den Status.  Betrachten Sie das folgende Beispiel: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [message, setMessage] = useState(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'You said: '</span></span> + message); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleSendClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleMessageChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) =&gt;</span></span> {   setMessage(e.target.value); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   &lt;&gt;     &lt;input value={message} onChange={handleMessageChange} /&gt;     &lt;button onClick={handleSendClick}&gt;Send&lt;/button&gt;   &lt;/&gt; ); }</code> </pre> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier können</a> Sie mit ihm experimentieren <br><br>  Obwohl dies kein beispielhaftes Beispiel für eine Messaging-Anwendungsschnittstelle ist, veranschaulicht dieses Projekt dieselbe Idee: Wenn ein Benutzer eine Nachricht gesendet hat, sollte die Komponente nicht verwechselt werden, welche Nachricht gesendet wurde.  Die <code>message</code> dieser Funktionskomponente erfasst den Status, der zu der Komponente "gehört", die den Browser zum Klick-Handler für die aufgerufene Schaltfläche macht.  Infolgedessen speichert die <code>message</code> , was sich zum Zeitpunkt des Klickens auf die Schaltfläche <code>Send</code> im Eingabefeld befand. <br><br><h2>  <font color="#3AC1EF">Das Problem der Erfassung von Eigenschaften und Zuständen durch Funktionskomponenten</font> </h2><br>  Wir wissen, dass Funktionskomponenten in React standardmäßig Eigenschaften und Status erfassen.  Was aber, wenn wir die neuesten Daten aus Eigenschaften oder Zuständen lesen müssen, die nicht zu einem bestimmten Funktionsaufruf gehören?  Was ist, wenn wir sie „ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aus der Zukunft lesen</a> “ wollen? <br><br>  In klassenbasierten Komponenten kann dies einfach durch Verweisen auf <code>this.props</code> oder <code>this.state</code> , da <code>this</code> eine veränderbare Entität ist.  Ihre Veränderung beschäftigt sich mit Reagieren.  Funktionskomponenten können auch mit veränderlichen Werten arbeiten, die von allen Komponenten gemeinsam genutzt werden.  Diese Werte heißen <code>ref</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ref = useRef(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     `ref.current`. // ... }</span></span></code> </pre> <br>  Der Programmierer muss diese Werte jedoch unabhängig verwalten. <br><br>  Das Wesen von <code>ref</code> spielt die gleiche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rolle</a> wie die Felder einer Instanz einer Klasse.  Dies ist ein „Notausgang“ in eine veränderliche imperative Welt.  Sie kennen vielleicht das Konzept der DOM-Refs, aber diese Idee ist viel allgemeiner.  Es kann mit einer Box verglichen werden, in die ein Programmierer etwas stecken kann. <br><br>  Sogar äußerlich sieht eine Konstruktion der Form so <code>this.something</code> wie ein Spiegelbild der Konstruktion von <code>something.current</code> <code>this.something</code> aus.  Sie sind eine Darstellung des gleichen Konzepts. <br><br>  Standardmäßig erstellt React keine <code>ref</code> in den Funktionskomponenten für die neuesten Eigenschafts- oder Statuswerte.  In vielen Fällen benötigen Sie sie nicht, und ihre automatische Erstellung wäre Zeitverschwendung.  Die Arbeit mit ihnen kann jedoch bei Bedarf selbst organisiert werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [message, setMessage] = useState(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> latestMessage = useRef(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'You said: '</span></span> + latestMessage.current); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleSendClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleMessageChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) =&gt;</span></span> {   setMessage(e.target.value);   latestMessage.current = e.target.value; };</code> </pre> <br>  Wenn wir die <code>message</code> in <code>showMessage</code> lesen, wird die <code>message</code> <code>showMessage</code> , die sich zum Zeitpunkt des Klickens auf die Schaltfläche <code>Send</code> im Feld befand.  Wenn Sie jedoch <code>latestMessage.current</code> lesen, können Sie den neuesten Wert <code>latestMessage.current</code> - auch wenn wir nach dem Klicken auf die Schaltfläche <code>Send</code> weiterhin Text in das Feld eingeben. <br><br>  Sie können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses</a> Beispiel vergleichen, um den Unterschied unabhängig zu bewerten.  Der Wert von <code>ref</code> ist ein Weg, um die Einheitlichkeit des Renderns zu „vermeiden“. In einigen Fällen kann er sehr nützlich sein. <br><br>  Im Allgemeinen sollten Sie das Lesen oder Schreiben von <code>ref</code> während des Rendervorgangs vermeiden, da diese Werte veränderbar sind.  Wir bemühen uns, das Rendering vorhersehbar zu machen.  Wenn wir jedoch den neuesten Wert von etwas abrufen müssen, das in Eigenschaften oder im Status gespeichert ist, kann das manuelle Aktualisieren des <code>ref</code> eine mühsame Aufgabe sein.  Es kann mit folgendem Effekt automatisiert werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [message, setMessage] = useState(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    . const latestMessage = useRef(''); useEffect(() =&gt; {   latestMessage.current = message; }); const showMessage = () =&gt; {   alert('You said: ' + latestMessage.current); };</span></span></code> </pre> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier ist</a> ein Beispiel, das diesen Code verwendet <br><br>  Wir weisen dem Effekt einen Wert zu. Infolgedessen ändert sich der Wert von <code>ref</code> erst, nachdem das DOM aktualisiert wurde.  Dies stellt sicher, dass unsere Mutation Funktionen wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Time Slicing und Suspense</a> nicht stört, die auf der Kontinuität der Rendering-Vorgänge beruhen. <br><br>  Die Verwendung von <code>ref</code> auf diese Weise ist nicht oft erforderlich.  Das Erfassen von Eigenschaften oder Zuständen scheint normalerweise ein viel besseres Muster des Standardsystemverhaltens zu sein.  Dies kann jedoch praktisch sein, wenn Sie mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wichtigen APIs arbeiten</a> , z. B. solchen, die Intervalle oder Abonnements verwenden.  Denken Sie daran, dass Sie auf diese Weise mit jedem Wert arbeiten können - mit Eigenschaften, mit im Status gespeicherten Variablen, mit dem gesamten <code>props</code> oder sogar mit einer Funktion. <br><br>  Dieses Muster kann außerdem für Optimierungszwecke nützlich sein.  Zum Beispiel, wenn sich so etwas wie <code>useCallback</code> zu oft ändert.  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bevorzugte Lösung ist</a> häufig die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verwendung eines Reduzierers</a> . <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  In diesem Artikel haben wir uns eines der falschen Muster für die Verwendung klassenbasierter Komponenten angesehen und darüber gesprochen, wie dieses Problem mit Verschlüssen gelöst werden kann.  Möglicherweise stellen Sie jedoch fest, dass beim Versuch, Hooks durch Angabe eines Arrays von Abhängigkeiten zu optimieren, Fehler im Zusammenhang mit veralteten Abschlüssen auftreten können.  Bedeutet dies, dass die Fehler selbst ein Problem sind?  Ich glaube nicht. <br><br>  Wie oben gezeigt, helfen uns Verschlüsse tatsächlich dabei, kleine Probleme zu beheben, die schwer zu bemerken sind.  Sie erleichtern ebenfalls das Schreiben von Code, der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">parallel</a> korrekt funktioniert.  Dies ist möglich, weil die korrekten Eigenschaften und der Status, mit dem diese Komponente gerendert wurde, innerhalb der Komponente „gesperrt“ sind. <br><br>  In allen Fällen, die ich bisher gesehen habe, trat das Problem der „veralteten Schließungen“ aufgrund der falschen Annahme auf, dass sich „Funktionen nicht ändern“ oder dass „Eigenschaften immer gleich bleiben“.  Ich hoffe, dass Sie nach dem Lesen dieses Materials davon überzeugt sind, dass dies nicht der Fall ist. <br><br>  Funktionen „erfassen“ ihre Eigenschaften und ihren Zustand - und daher ist es auch wichtig zu verstehen, welche Funktionen in Frage kommen.  Dies ist kein Fehler, sondern ein Merkmal von Funktionskomponenten.  Funktionen sollten beispielsweise nicht aus dem "Array von Abhängigkeiten" für <code>useEffect</code> oder <code>useCalback</code> werden.  (Ein geeignetes Werkzeug zur Lösung des Problems ist normalerweise entweder <code>useReducer</code> oder <code>useRef</code> . Wir haben oben darüber gesprochen und werden in Kürze Materialien vorbereiten, die der Wahl dieses oder jenes Ansatzes gewidmet sind.) <br><br>  Wenn der größte Teil des Codes in unseren Anwendungen auf Funktionskomponenten basiert, müssen wir mehr über die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codeoptimierung</a> wissen und wissen, welche Werte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sich im</a> Laufe der Zeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ändern</a> können. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>     : «  ,   ,    ,   ,    ,         ». <br><br>          .  ,        React    ,   .     ,    « »,     . ,         React  . <br><br>      ,      ,   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc3/bdd/f6d/fc3bddf6d4ca14bc77917ac0cfad3608.gif"></div><br> <i><font color="#999999">  React —    </font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de444348/">https://habr.com/ru/post/de444348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de444338/index.html">Kapselung in Python 3</a></li>
<li><a href="../de444340/index.html">Funktionen zur Verwendung des Symboldatentyps in JavaScript</a></li>
<li><a href="../de444342/index.html">Entwicklung einfacher, moderner JavaScript-Anwendungen mit Webpack und fortschrittlichen Webtechnologien</a></li>
<li><a href="../de444344/index.html">10 Schritte zu einem erfolgreichen Python-Projekt</a></li>
<li><a href="../de444346/index.html">GraphQL und Golang</a></li>
<li><a href="../de444350/index.html">Aus irgendeinem Grund startet MVP (Minimum Viable Product) nicht</a></li>
<li><a href="../de444352/index.html">Kontur.Kampus: Wir laden Sie zu einem kostenlosen Studentenlager für industrielle Entwicklung in der Nähe von St. Petersburg ein</a></li>
<li><a href="../de444356/index.html">React Tutorial Teil 24: Lektion für zweite Formen</a></li>
<li><a href="../de444358/index.html">Aufzählbar: So erzielen Sie einen Geschäftswert</a></li>
<li><a href="../de444360/index.html">Ungerechtigkeit Google Play als eine gute Lebenserfahrung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>