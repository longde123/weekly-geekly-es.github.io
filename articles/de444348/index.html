<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¥üèæ üöÅ üåê Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten? üëäüèº üë®üèª‚Äçüî¨ üñïüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten? Die traditionelle Antwort auf diese Frage lautet seit einiger Z...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/444348/">  Wie unterscheiden sich funktionale React-Komponenten von klassenbasierten Komponenten?  Die traditionelle Antwort auf diese Frage lautet seit einiger Zeit: ‚ÄûDurch die Verwendung von Klassen k√∂nnen Sie eine gro√üe Anzahl von Funktionen von Komponenten verwenden, z. B. den Status.‚Äú  Mit dem Aufkommen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Haken</a> spiegelt diese Antwort nicht mehr den wahren Stand der Dinge wider. <br><br>  M√∂glicherweise haben Sie geh√∂rt, dass eine dieser Arten von Komponenten eine bessere Leistung als die andere aufweist.  Aber welches?  Die meisten Benchmarks, die dies testen, weisen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">M√§ngel auf</a> , daher w√ºrde ich aufgrund ihrer Ergebnisse mit gro√üer Vorsicht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schlussfolgerungen ziehen</a> .  Die Leistung h√§ngt haupts√§chlich davon ab, was im Code geschieht, und nicht davon, ob Funktionskomponenten oder klassenbasierte Komponenten ausgew√§hlt werden, um bestimmte Funktionen zu implementieren.  Unsere Studie hat gezeigt, dass der Leistungsunterschied zwischen verschiedenen Arten von Komponenten vernachl√§ssigbar ist.  Es ist jedoch zu beachten, dass sich die Optimierungsstrategien f√ºr die Arbeit mit ihnen geringf√ºgig <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unterscheiden</a> . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/x-/vn/je/x-vnjetrulggl4xjpo2jmitqjvg.jpeg"></a> <br><br>  Auf jeden Fall <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">empfehle</a> ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nicht</a> , vorhandene Komponenten mit neuen Technologien neu zu schreiben, wenn es keine guten Gr√ºnde daf√ºr gibt und wenn es Ihnen nichts ausmacht, zu denen zu geh√∂ren, die diese Technologien vor allen anderen eingesetzt haben.  Hooks sind immer noch eine neue Technologie (genau wie die React-Bibliothek im Jahr 2014), und einige ‚ÄûBest Practices‚Äú f√ºr ihre Anwendung wurden noch nicht in die React-Handb√ºcher aufgenommen. <br><a name="habracut"></a><br>  Wo sind wir endlich hingekommen?  Gibt es grundlegende Unterschiede zwischen den Funktionskomponenten von React und den auf Klassen basierenden Komponenten?  Nat√ºrlich gibt es solche Unterschiede.  Dies sind Unterschiede im mentalen Modell der Verwendung solcher Komponenten.  In diesem Artikel werde ich ihren schwerwiegendsten Unterschied betrachten.  Es existiert seit dem Erscheinen von Funktionskomponenten im Jahr 2015, wird aber oft √ºbersehen.  Es besteht darin, dass Funktionskomponenten gerenderte Werte erfassen.  Sprechen wir dar√ºber, was das wirklich bedeutet. <br><br>  Es ist zu beachten, dass dieses Material keinen Versuch darstellt, Komponenten unterschiedlicher Typen zu bewerten.  Ich beschreibe nur den Unterschied zwischen den beiden Programmiermodellen in React.  Wenn Sie mehr √ºber den Einsatz von Funktionskomponenten im Lichte von Innovationen erfahren m√∂chten, lesen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diese</a> Liste mit Fragen und Antworten zu Haken. <br><br><h2>  <font color="#3AC1EF">Was sind die Merkmale des Codes von Komponenten, die auf Funktionen und Klassen basieren?</font> </h2><br>  Betrachten Sie diese Komponente: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {    alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + props.user);  };  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {    setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>);  };  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>  ); }</code> </pre> <br>  Es wird eine Schaltfl√§che angezeigt, die durch Dr√ºcken der Funktion <code>setTimeout</code> eine Netzwerkanforderung simuliert und anschlie√üend ein Meldungsfeld zur Best√§tigung des Vorgangs anzeigt.  Wenn beispielsweise ' <code>props.user</code> <code>'Dan'</code> in <code>props.user</code> gespeichert <code>props.user</code> , wird im Nachrichtenfenster nach drei Sekunden <code>'Followed Dan'</code> angezeigt. <br><br>  Beachten Sie, dass es keine Rolle spielt, ob hier Pfeilfunktionen oder Funktionsdeklarationen verwendet werden.  Eine Konstruktion der Formularfunktion <code>function handleClick()</code> funktioniert genauso. <br><br>  Wie schreibe ich diese Komponente als Klasse um?  Wenn Sie den gerade untersuchten Code wiederholen und ihn in den Code einer Komponente konvertieren, die auf einer Klasse basiert, erhalten Sie Folgendes: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.user); }; handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; render() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre> <br>  Es ist allgemein anerkannt, dass zwei solche Codefragmente √§quivalent sind.  Und Entwickler sind oft v√∂llig frei, wandeln sich im Zuge des Code-Refactorings ineinander um, ohne √ºber die m√∂glichen Konsequenzen nachzudenken. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d3/c7a/341/1d3c7a341ee3fcadc79df00e7d872e4b.gif"></div><br>  <i><font color="#999999">Diese Codeteile scheinen gleichwertig zu sein</font></i> <br><br>  Es gibt jedoch einen kleinen Unterschied zwischen diesen Codefragmenten.  Schauen Sie sie sich genauer an.  Sehen Sie den Unterschied?  Zum Beispiel habe ich sie nicht sofort gesehen. <br><br>  Weiter werden wir diesen Unterschied daher f√ºr diejenigen betrachten, die die Essenz dessen verstehen wollen, was selbst geschieht, ein funktionierendes Beispiel f√ºr diesen Code. <br><br>  Bevor wir fortfahren, m√∂chte ich betonen, dass der fragliche Unterschied nichts mit React-Hooks zu tun hat.  In den vorherigen Beispielen werden √ºbrigens nicht einmal Haken verwendet.  Es geht um den Unterschied zwischen Funktionen und Klassen in React.  Wenn Sie vorhaben, viele Funktionskomponenten in Ihren React-Anwendungen zu verwenden, m√∂chten Sie diesen Unterschied m√∂glicherweise verstehen. <br><br>  In der Tat werden wir den Unterschied zwischen Funktionen und Klassen am Beispiel eines Fehlers veranschaulichen, der in React-Anwendungen h√§ufig auftritt. <br><br><h2>  <font color="#3AC1EF">Der Fehler, der in React-Anwendungen h√§ufig auftritt.</font> </h2><br>  √ñffnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Beispielseite</a> , auf der eine Liste angezeigt wird, in der Sie Benutzerprofile ausw√§hlen k√∂nnen, sowie zwei Schaltfl√§chen zum <code>Follow</code> , die von den <code>ProfilePageClass</code> <code>ProfilePageFunction</code> und <code>ProfilePageClass</code> angezeigt werden. Sie funktionieren und basieren auf der Klasse, deren Code oben angezeigt wird. <br><br>  Versuchen Sie f√ºr jede dieser Schaltfl√§chen, die folgende Abfolge von Aktionen auszuf√ºhren: <br><br><ol><li>  Klicken Sie auf die Schaltfl√§che. </li><li>  √Ñndern Sie das ausgew√§hlte Profil vor Ablauf von 3 Sekunden, nachdem Sie auf die Schaltfl√§che geklickt haben. </li><li>  Lesen Sie den im Meldungsfeld angezeigten Text. </li></ol><br>  Nachdem Sie dies getan haben, werden Sie die folgenden Funktionen bemerken: <br><br><ul><li>  Wenn Sie auf die Schaltfl√§che klicken, die von der Funktionskomponente mit dem ausgew√§hlten <code>Dan</code> Profil gebildet wird, und dann zum <code>Sophie</code> Profil wechseln, wird im Meldungsfeld <code>'Followed Dan'</code> angezeigt. </li><li>  Wenn Sie dasselbe mit einer Schaltfl√§che tun, die von einer Komponente basierend auf einer Klasse gebildet wird, wird <code>'Followed Sophie'</code> angezeigt. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/386/a44/911/386a449110202d5140d67336a0ade5a0.gif"></div><br>  <i><font color="#999999">Klassenbasierte Komponentenfunktionen</font></i> <br><br>  In diesem Beispiel ist das Verhalten der Funktionskomponente korrekt.  Wenn ich das Profil einer Person abonniert und dann zu einem anderen Profil gewechselt habe, sollte meine Komponente nicht daran zweifeln, wessen Profil ich abonniert habe.  Offensichtlich enth√§lt die Implementierung des fraglichen Mechanismus basierend auf der Verwendung von Klassen einen Fehler (Sie sollten √ºbrigens definitiv ein Abonnent von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sofia werden</a> ). <br><br><h2>  <font color="#3AC1EF">Ursachen f√ºr Fehlfunktionen klassenbasierter Komponenten</font> </h2><br>  Warum verh√§lt sich eine klassenbasierte Komponente so?  Um dies zu verstehen, werfen wir einen Blick auf die <code>showMessage</code> Methode in unserer Klasse: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.user); };</code> </pre> <br>  Diese Methode liest Daten aus <code>this.props.user</code> .  Die Eigenschaften in React sind unver√§nderlich und √§ndern sich daher nicht.  Dies ist jedoch wie immer eine ver√§nderbare Einheit. <br><br>  Tats√§chlich liegt der Zweck, <code>this</code> in einer Klasse zu haben, in der F√§higkeit, <code>this</code> zu √§ndern.  Die React-Bibliothek selbst f√ºhrt <code>this</code> Mutationen regelm√§√üig durch, sodass mit den neuesten Versionen der <code>render</code> und der Komponentenlebenszyklusmethoden gearbeitet werden kann. <br><br>  Wenn sich unsere Komponente w√§hrend der Ausf√ºhrung der Anforderung erneut rendert, <code>this.props</code> sich <code>this.props</code> .  Danach liest die <code>showMessage</code> Methode den <code>user</code> aus der "zu neuen" <code>props</code> . <br><br>  Auf diese Weise k√∂nnen Sie interessante Beobachtungen zu Benutzeroberfl√§chen machen.  Wenn wir sagen, dass die Benutzeroberfl√§che konzeptionell eine Funktion des aktuellen Status der Anwendung ist, sind die Ereignishandler Teil der Rendering-Ergebnisse - genau wie die sichtbaren Rendering-Ergebnisse.  Unsere Event-Handler geh√∂ren zusammen mit bestimmten Eigenschaften und Zust√§nden zu einem bestimmten Rendering-Vorgang. <br><br>  Das Planen eines Timeouts, dessen R√ºckruf <code>this.props</code> liest, verletzt jedoch diese Verbindung.  Der showMessage- <code>showMessage</code> nicht an einen bestimmten Rendering-Vorgang gebunden, sondern verliert die richtigen Eigenschaften.  Das Lesen von Daten <code>this</code> unterbricht diese Verbindung. <br><br><h2>  <font color="#3AC1EF">Wie kann das Problem mithilfe klassenbasierter Komponenten gel√∂st werden?</font> </h2><br>  Stellen Sie sich vor, dass React keine funktionalen Komponenten enth√§lt.  Wie kann man dieses Problem dann l√∂sen? <br><br>  Wir ben√∂tigen einen Mechanismus, um die Verbindung zwischen der Rendermethode mit den richtigen Eigenschaften und dem showMessage- <code>showMessage</code> , der Daten aus den Eigenschaften liest, "wiederherzustellen".  Dieser Mechanismus sollte sich irgendwo befinden, wo die Essenz von <code>props</code> mit den richtigen Daten verloren geht. <br><br>  Eine M√∂glichkeit, dies zu tun, besteht darin, <code>this.props</code> im Voraus im Ereignishandler zu lesen und dann das Gelesene explizit an die in <code>setTimeout</code> verwendete R√ºckruffunktion zu <code>setTimeout</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ showMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function">) =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + user); }; handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {user} = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props;   setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage(user), <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; render() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre> <br>  Dieser Ansatz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">funktioniert</a> .  Die hier verwendeten zus√§tzlichen Konstruktionen f√ºhren jedoch im Laufe der Zeit zu einer Zunahme des Codevolumens und zu der Tatsache, dass die Wahrscheinlichkeit von Fehlern darin zunimmt.  Was ist, wenn wir mehr als eine einzelne Immobilie ben√∂tigen?  Was ist, wenn wir auch mit dem Staat zusammenarbeiten m√ºssen?  Wenn die <code>showMessage</code> Methode <code>showMessage</code> andere Methode <code>showMessage</code> und diese Methode <code>this.props.something</code> oder <code>this.state.something</code> liest, <code>this.props.something</code> das gleiche Problem erneut auf.  Und um es zu l√∂sen, m√ºssten wir <code>this.props</code> und <code>this.state</code> als Argumente an alle von <code>showMessage</code> aufgerufenen Methoden <code>showMessage</code> . <br><br>  Wenn dies zutrifft, werden alle Annehmlichkeiten zerst√∂rt, die die Verwendung von auf Klassen basierenden Komponenten bietet.  Es ist schwer zu merken, dass die Arbeit mit Methoden auf diese Weise schwierig und schwer zu automatisieren ist. Daher sind sich Entwickler h√§ufig einig, dass ihre Projekte Fehler enthalten, anstatt √§hnliche Methoden zu verwenden. <br><br>  Ebenso <code>handleClick</code> das Einbetten von <code>handleClick</code> in <code>handleClick</code> kein globaleres Problem.  Wir m√ºssen den Code so strukturieren, dass er in viele Methoden unterteilt werden kann, aber auch, damit wir die Eigenschaften und den Status lesen k√∂nnen, die der mit einem bestimmten Aufruf verbundenen Renderoperation entsprechen.  Dieses Problem betrifft √ºbrigens nicht einmal ausschlie√ülich React.  Sie k√∂nnen es in jeder Bibliothek abspielen, um Benutzeroberfl√§chen zu entwickeln, die Daten in solche ver√§nderlichen Objekte einf√ºgen. <br><br>  Vielleicht k√∂nnen Sie, um dieses Problem zu l√∂sen, Methoden im Konstruktor daran binden? <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {   <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props);   <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>);   <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleClick = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleClick.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } showMessage() {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.user); } handleClick() {   setTimeout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); } render() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre> <br>  Dies l√∂st unser Problem jedoch nicht.  Denken Sie daran, dass wir Daten aus <code>this.props</code> zu sp√§t lesen und nicht in der verwendeten Syntax!  Dieses Problem wird jedoch behoben, wenn wir uns auf JavaScript-Schlie√üungen verlassen. <br><br>  Entwickler versuchen oft, Schlie√üungen zu vermeiden, da es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nicht einfach ist,</a> √ºber Werte nachzudenken, die im Laufe der Zeit nicht mutieren k√∂nnen.  Aber die Eigenschaften in React sind unver√§nderlich!  (Oder zumindest wird dies dringend empfohlen).  Auf diese Weise k√∂nnen Sie aufh√∂ren, Verschl√ºsse als etwas wahrzunehmen, aufgrund dessen der Programmierer, wie er sagt, ‚Äûsich selbst in den Fu√ü schie√üen kann‚Äú. <br><br>  Dies bedeutet, dass Sie sich immer darauf verlassen k√∂nnen, dass sich die Eigenschaften oder der Status eines bestimmten Rendervorgangs beim Schlie√üen nicht √§ndern, wenn Sie sie sperren. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() {   <span class="hljs-comment"><span class="hljs-comment">//  !   const props = this.props;   //    ,      render.   //   -   .   const showMessage = () =&gt; {     alert('Followed ' + props.user);   };   const handleClick = () =&gt; {     setTimeout(showMessage, 3000);   };   return &lt;button onClick={handleClick}&gt;Follow&lt;/button&gt;; } }</span></span></code> </pre> <br>  Wie Sie sehen k√∂nnen, haben wir hier die Eigenschaften w√§hrend des Aufrufs der <code>render</code> ‚Äûerfasst‚Äú. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa4/83d/d56/fa483dd5699aac1350c57591770a49be.gif"></div><br>  <i><font color="#999999">Vom Renderaufruf erfasste Eigenschaften</font></i> <br><br>  Bei diesem Ansatz wird f√ºr jeden Code in der <code>showMessage</code> (einschlie√ülich <code>showMessage</code> ) garantiert, dass Eigenschaften <code>showMessage</code> werden, die w√§hrend eines bestimmten Aufrufs dieser Methode erfasst wurden.  Infolgedessen kann React uns nicht mehr davon abhalten, das zu tun, was wir brauchen. <br><br>  In der <code>render</code> k√∂nnen Sie so viele Hilfsfunktionen beschreiben, wie Sie m√∂chten, und alle k√∂nnen die "erfassten" Eigenschaften und den Status verwenden.  So haben Verschl√ºsse unser Problem gel√∂st. <br><br><h2>  <font color="#3AC1EF">Analyse der Probleml√∂sung mittels Verschluss</font> </h2><br>  Was wir gerade erreicht haben, erm√∂glicht es uns <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, das Problem</a> zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">l√∂sen</a> , aber ein solcher Code sieht seltsam aus.  Warum wird eine Klasse √ºberhaupt ben√∂tigt, wenn Funktionen innerhalb der <code>render</code> deklariert sind und nicht als Klassenmethoden? <br><br>  Tats√§chlich k√∂nnen wir diesen Code vereinfachen, indem wir die ‚ÄûShell‚Äú in Form einer Klasse, die sie umgibt, entfernen: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + props.user); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br>  Hier werden wie im vorherigen Beispiel die Eigenschaften in der Funktion erfasst, da React sie als Argument an sie √ºbergibt.  Im Gegensatz <code>this</code> <code>props</code> React niemals <code>props</code> . <br><br>  Dies wird etwas offensichtlicher, wenn die <code>props</code> in der Funktionsdeklaration zerst√∂rt werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'Followed '</span></span> + user); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleClick}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Follow</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br>  Wenn die √ºbergeordnete Komponente <code>ProfilePage</code> mit anderen Eigenschaften <code>ProfilePage</code> , ruft React die <code>ProfilePage</code> Funktion <code>ProfilePage</code> .  Der Ereignishandler, der bereits als "geh√∂rt" zum vorherigen Aufruf dieser Funktion geh√∂rt, verwendet jedoch einen eigenen <code>user</code> und einen eigenen showMessage- <code>showMessage</code> , der diesen Wert liest.  All dies bleibt unber√ºhrt. <br><br>  Aus diesem Grund √§ndert sich in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalversion</a> unseres Beispiels nichts, wenn Sie mit einer Funktionskomponente arbeiten und ein anderes Profil ausw√§hlen, nachdem Sie auf die entsprechende Schaltfl√§che geklickt haben, bevor die Nachricht angezeigt wird.  Wenn vor dem Klicken auf die Schaltfl√§che ein <code>Sophie</code> Profil ausgew√§hlt wurde, wird im Nachrichtenfenster <code>'Followed Sophie'</code> angezeigt, unabh√§ngig davon, was passiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/843/96c/4b3/84396c4b3982827bead96912a947904e.gif"></div><br>  <i><font color="#999999">Verwendung einer Funktionskomponente</font></i> <br><br>  Dieses Verhalten ist korrekt (m√∂glicherweise m√∂chten Sie sich auch f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sunil</a> anmelden). <br><br>  Jetzt haben wir herausgefunden, was der gro√üe Unterschied zwischen Funktionen und Klassen in React ist.  Wie bereits erw√§hnt, handelt es sich um die Tatsache, dass Funktionskomponenten Werte erfassen.  Lassen Sie uns jetzt √ºber Haken sprechen. <br><br><h2>  <font color="#3AC1EF">Haken</font> </h2><br>  Bei der Verwendung von Hooks erstreckt sich das Prinzip der "Erfassung von Werten" auf den Status.  Betrachten Sie das folgende Beispiel: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [message, setMessage] = useState(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'You said: '</span></span> + message); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleSendClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleMessageChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) =&gt;</span></span> {   setMessage(e.target.value); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   &lt;&gt;     &lt;input value={message} onChange={handleMessageChange} /&gt;     &lt;button onClick={handleSendClick}&gt;Send&lt;/button&gt;   &lt;/&gt; ); }</code> </pre> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier k√∂nnen</a> Sie mit ihm experimentieren <br><br>  Obwohl dies kein beispielhaftes Beispiel f√ºr eine Messaging-Anwendungsschnittstelle ist, veranschaulicht dieses Projekt dieselbe Idee: Wenn ein Benutzer eine Nachricht gesendet hat, sollte die Komponente nicht verwechselt werden, welche Nachricht gesendet wurde.  Die <code>message</code> dieser Funktionskomponente erfasst den Status, der zu der Komponente "geh√∂rt", die den Browser zum Klick-Handler f√ºr die aufgerufene Schaltfl√§che macht.  Infolgedessen speichert die <code>message</code> , was sich zum Zeitpunkt des Klickens auf die Schaltfl√§che <code>Send</code> im Eingabefeld befand. <br><br><h2>  <font color="#3AC1EF">Das Problem der Erfassung von Eigenschaften und Zust√§nden durch Funktionskomponenten</font> </h2><br>  Wir wissen, dass Funktionskomponenten in React standardm√§√üig Eigenschaften und Status erfassen.  Was aber, wenn wir die neuesten Daten aus Eigenschaften oder Zust√§nden lesen m√ºssen, die nicht zu einem bestimmten Funktionsaufruf geh√∂ren?  Was ist, wenn wir sie ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aus der Zukunft lesen</a> ‚Äú wollen? <br><br>  In klassenbasierten Komponenten kann dies einfach durch Verweisen auf <code>this.props</code> oder <code>this.state</code> , da <code>this</code> eine ver√§nderbare Entit√§t ist.  Ihre Ver√§nderung besch√§ftigt sich mit Reagieren.  Funktionskomponenten k√∂nnen auch mit ver√§nderlichen Werten arbeiten, die von allen Komponenten gemeinsam genutzt werden.  Diese Werte hei√üen <code>ref</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ref = useRef(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     `ref.current`. // ... }</span></span></code> </pre> <br>  Der Programmierer muss diese Werte jedoch unabh√§ngig verwalten. <br><br>  Das Wesen von <code>ref</code> spielt die gleiche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rolle</a> wie die Felder einer Instanz einer Klasse.  Dies ist ein ‚ÄûNotausgang‚Äú in eine ver√§nderliche imperative Welt.  Sie kennen vielleicht das Konzept der DOM-Refs, aber diese Idee ist viel allgemeiner.  Es kann mit einer Box verglichen werden, in die ein Programmierer etwas stecken kann. <br><br>  Sogar √§u√üerlich sieht eine Konstruktion der Form so <code>this.something</code> wie ein Spiegelbild der Konstruktion von <code>something.current</code> <code>this.something</code> aus.  Sie sind eine Darstellung des gleichen Konzepts. <br><br>  Standardm√§√üig erstellt React keine <code>ref</code> in den Funktionskomponenten f√ºr die neuesten Eigenschafts- oder Statuswerte.  In vielen F√§llen ben√∂tigen Sie sie nicht, und ihre automatische Erstellung w√§re Zeitverschwendung.  Die Arbeit mit ihnen kann jedoch bei Bedarf selbst organisiert werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [message, setMessage] = useState(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> latestMessage = useRef(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> showMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   alert(<span class="hljs-string"><span class="hljs-string">'You said: '</span></span> + latestMessage.current); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleSendClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   setTimeout(showMessage, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handleMessageChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) =&gt;</span></span> {   setMessage(e.target.value);   latestMessage.current = e.target.value; };</code> </pre> <br>  Wenn wir die <code>message</code> in <code>showMessage</code> lesen, wird die <code>message</code> <code>showMessage</code> , die sich zum Zeitpunkt des Klickens auf die Schaltfl√§che <code>Send</code> im Feld befand.  Wenn Sie jedoch <code>latestMessage.current</code> lesen, k√∂nnen Sie den neuesten Wert <code>latestMessage.current</code> - auch wenn wir nach dem Klicken auf die Schaltfl√§che <code>Send</code> weiterhin Text in das Feld eingeben. <br><br>  Sie k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses</a> Beispiel vergleichen, um den Unterschied unabh√§ngig zu bewerten.  Der Wert von <code>ref</code> ist ein Weg, um die Einheitlichkeit des Renderns zu ‚Äûvermeiden‚Äú. In einigen F√§llen kann er sehr n√ºtzlich sein. <br><br>  Im Allgemeinen sollten Sie das Lesen oder Schreiben von <code>ref</code> w√§hrend des Rendervorgangs vermeiden, da diese Werte ver√§nderbar sind.  Wir bem√ºhen uns, das Rendering vorhersehbar zu machen.  Wenn wir jedoch den neuesten Wert von etwas abrufen m√ºssen, das in Eigenschaften oder im Status gespeichert ist, kann das manuelle Aktualisieren des <code>ref</code> eine m√ºhsame Aufgabe sein.  Es kann mit folgendem Effekt automatisiert werden: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [message, setMessage] = useState(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    . const latestMessage = useRef(''); useEffect(() =&gt; {   latestMessage.current = message; }); const showMessage = () =&gt; {   alert('You said: ' + latestMessage.current); };</span></span></code> </pre> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier ist</a> ein Beispiel, das diesen Code verwendet <br><br>  Wir weisen dem Effekt einen Wert zu. Infolgedessen √§ndert sich der Wert von <code>ref</code> erst, nachdem das DOM aktualisiert wurde.  Dies stellt sicher, dass unsere Mutation Funktionen wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Time Slicing und Suspense</a> nicht st√∂rt, die auf der Kontinuit√§t der Rendering-Vorg√§nge beruhen. <br><br>  Die Verwendung von <code>ref</code> auf diese Weise ist nicht oft erforderlich.  Das Erfassen von Eigenschaften oder Zust√§nden scheint normalerweise ein viel besseres Muster des Standardsystemverhaltens zu sein.  Dies kann jedoch praktisch sein, wenn Sie mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wichtigen APIs arbeiten</a> , z. B. solchen, die Intervalle oder Abonnements verwenden.  Denken Sie daran, dass Sie auf diese Weise mit jedem Wert arbeiten k√∂nnen - mit Eigenschaften, mit im Status gespeicherten Variablen, mit dem gesamten <code>props</code> oder sogar mit einer Funktion. <br><br>  Dieses Muster kann au√üerdem f√ºr Optimierungszwecke n√ºtzlich sein.  Zum Beispiel, wenn sich so etwas wie <code>useCallback</code> zu oft √§ndert.  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bevorzugte L√∂sung ist</a> h√§ufig die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verwendung eines Reduzierers</a> . <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  In diesem Artikel haben wir uns eines der falschen Muster f√ºr die Verwendung klassenbasierter Komponenten angesehen und dar√ºber gesprochen, wie dieses Problem mit Verschl√ºssen gel√∂st werden kann.  M√∂glicherweise stellen Sie jedoch fest, dass beim Versuch, Hooks durch Angabe eines Arrays von Abh√§ngigkeiten zu optimieren, Fehler im Zusammenhang mit veralteten Abschl√ºssen auftreten k√∂nnen.  Bedeutet dies, dass die Fehler selbst ein Problem sind?  Ich glaube nicht. <br><br>  Wie oben gezeigt, helfen uns Verschl√ºsse tats√§chlich dabei, kleine Probleme zu beheben, die schwer zu bemerken sind.  Sie erleichtern ebenfalls das Schreiben von Code, der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">parallel</a> korrekt funktioniert.  Dies ist m√∂glich, weil die korrekten Eigenschaften und der Status, mit dem diese Komponente gerendert wurde, innerhalb der Komponente ‚Äûgesperrt‚Äú sind. <br><br>  In allen F√§llen, die ich bisher gesehen habe, trat das Problem der ‚Äûveralteten Schlie√üungen‚Äú aufgrund der falschen Annahme auf, dass sich ‚ÄûFunktionen nicht √§ndern‚Äú oder dass ‚ÄûEigenschaften immer gleich bleiben‚Äú.  Ich hoffe, dass Sie nach dem Lesen dieses Materials davon √ºberzeugt sind, dass dies nicht der Fall ist. <br><br>  Funktionen ‚Äûerfassen‚Äú ihre Eigenschaften und ihren Zustand - und daher ist es auch wichtig zu verstehen, welche Funktionen in Frage kommen.  Dies ist kein Fehler, sondern ein Merkmal von Funktionskomponenten.  Funktionen sollten beispielsweise nicht aus dem "Array von Abh√§ngigkeiten" f√ºr <code>useEffect</code> oder <code>useCalback</code> werden.  (Ein geeignetes Werkzeug zur L√∂sung des Problems ist normalerweise entweder <code>useReducer</code> oder <code>useRef</code> . Wir haben oben dar√ºber gesprochen und werden in K√ºrze Materialien vorbereiten, die der Wahl dieses oder jenes Ansatzes gewidmet sind.) <br><br>  Wenn der gr√∂√üte Teil des Codes in unseren Anwendungen auf Funktionskomponenten basiert, m√ºssen wir mehr √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codeoptimierung</a> wissen und wissen, welche Werte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sich im</a> Laufe der Zeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√§ndern</a> k√∂nnen. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>     : ¬´  ,   ,    ,   ,    ,         ¬ª. <br><br>          .  ,        React    ,   .     ,    ¬´ ¬ª,     . ,         React  . <br><br>      ,      ,   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc3/bdd/f6d/fc3bddf6d4ca14bc77917ac0cfad3608.gif"></div><br> <i><font color="#999999">  React ‚Äî    </font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de444348/">https://habr.com/ru/post/de444348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de444338/index.html">Kapselung in Python 3</a></li>
<li><a href="../de444340/index.html">Funktionen zur Verwendung des Symboldatentyps in JavaScript</a></li>
<li><a href="../de444342/index.html">Entwicklung einfacher, moderner JavaScript-Anwendungen mit Webpack und fortschrittlichen Webtechnologien</a></li>
<li><a href="../de444344/index.html">10 Schritte zu einem erfolgreichen Python-Projekt</a></li>
<li><a href="../de444346/index.html">GraphQL und Golang</a></li>
<li><a href="../de444350/index.html">Aus irgendeinem Grund startet MVP (Minimum Viable Product) nicht</a></li>
<li><a href="../de444352/index.html">Kontur.Kampus: Wir laden Sie zu einem kostenlosen Studentenlager f√ºr industrielle Entwicklung in der N√§he von St. Petersburg ein</a></li>
<li><a href="../de444356/index.html">React Tutorial Teil 24: Lektion f√ºr zweite Formen</a></li>
<li><a href="../de444358/index.html">Aufz√§hlbar: So erzielen Sie einen Gesch√§ftswert</a></li>
<li><a href="../de444360/index.html">Ungerechtigkeit Google Play als eine gute Lebenserfahrung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>