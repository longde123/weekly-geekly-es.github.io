<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôíÔ∏è ‚òØÔ∏è ü§òüèø Tipps der Natur - Bew√∂lktes Nachtlicht üë©üèæ‚Äçü§ù‚Äçüë©üèº üéª üöÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Community! 

 Ich pr√§sentiere meine eigene Implementierung einer Nachtlampe in Form einer Wolke. Die Hauptidee ist es, ein Nachtlicht mit Simula...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tipps der Natur - Bew√∂lktes Nachtlicht</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428988/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/mr/66/st/mr66stql1kimlmtxmkt2ycjyfue.jpeg" alt="Bild" width="75%"></div><br><br>  Hallo Community! <br><br>  Ich pr√§sentiere meine eigene Implementierung einer Nachtlampe in Form einer Wolke.  Die Hauptidee ist es, ein Nachtlicht mit Simulationen nat√ºrlicher Prozesse und einer Art Interaktivit√§t zu erzeugen.  Die Natur ist der beste Inspirator! <br><br>  Basierend auf dem billigen Mikrocontroller ATmega8-16PU.  Der Code ist in C ohne Arduino geschrieben und implementiert mehrere Lichteffekte mit Kontrolle √ºber die allgemeine Beleuchtung des Raums und mit Klangkontrolle. <br><br>  Details und Bilder - mehr ... <br><a name="habracut"></a><br><h3>  Elektronische Details </h3><br>  Die Schaltung verf√ºgt neben dem Mikrocontroller √ºber 6 einfarbige LEDs, eine RGB-LED, einen Lichtsensor (Fotowiderstand) und ein Mikrofon mit Verst√§rker und HF-Filter. <br><br>  Um die Helligkeit der LEDs reibungslos zu √§ndern, wird <abbr title="Pulsweitenmodulation">PWM</abbr> verwendet.  Die PWM-Frequenz betr√§gt 244 Hz bei 64 Pegeln, es kommt vor, dass einige Leute sie sehen.  Es ist unm√∂glich, die Frequenz zu erh√∂hen - Sie ben√∂tigen noch Prozessorzeit, um zu arbeiten.  Daher wird zum Gl√§tten der PWM-Impulse eine Transistor-Repeater-Schaltung mit einem Gl√§ttungskondensator verwendet.  Der Transistor wird mit einer gro√üen Verst√§rkung verwendet, um den Eingangswiderstand zu erh√∂hen und die erforderliche Kapazit√§t zu verringern.  Als Ergebnis erwies sich 1 ŒºF als ausreichend, die Impulse werden fast vollst√§ndig gegl√§ttet.  Die Vorteile sind billiger als der DAC und haben einen gro√üen Ausgangsstrom.  Der Nachteil dieses Schemas ist die nichtlineare Abh√§ngigkeit der Helligkeit vom PWM-Pegel bei niedrigen Pegeln (bis zu 15%). <br><br><div class="spoiler">  <b class="spoiler_title">Micro-Cap 9-Schaltung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9h/jx/m-/9hjxm-paag2rkjz7osorqlr_8ke.png" alt="Bild"><br>  <i>PWM-Gl√§ttungsschema.</i>  <i>4 Dioden ungef√§hr = 1 wei√üe LED gem√§√ü I-V-Charakteristik</i> <br><br><img src="https://habrastorage.org/webt/af/6f/g4/af6fg4lbpq8fxaenzaepivxw-ps.png" alt="Bild"><br>  <i>Diagramm von Strom und Spannung an der LED bei 56% PWM.</i> <br></div></div><br>  Ein Miniatur-Elektretmikrofon √ºber einen Verst√§rker an zwei Transistoren mit Impulsextraktion (Hochpassfilter) ist an den Digitaleingang des MK angeschlossen und f√§ngt sicher scharfe T√∂ne auf - Klatschen. <br><br>  Er zeichnete und verbreitete das Board in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DipTrace</a> , machte es LUT, die Details sind haupts√§chlich smd.  Das √Ñtzen erfolgte im ‚ÄûEisenchlorid-Killer‚Äú: Wasserstoffperoxid + Salz + Zitronens√§ure, es stellte sich heraus, dass es das erste Mal war, ich empfehle es.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alle Amateur-Wege sind hier geschrieben.</a> <br><br><img src="https://habrastorage.org/webt/6g/m-/05/6gm-05vizzaj1ew1l63b-b6kh5o.jpeg" alt="Bild"><br>  <i>Die Geb√ºhr von LUT gemacht</i> <br><br>  Ich habe die Stromversorgung √ºber einen USB-Anschluss hergestellt, √ºber den Sie eine Verbindung zu einem beliebigen USB-Anschluss herstellen k√∂nnen.  Maximaler Verbrauch 78 mA. <br><br>  In fr√ºheren Versionen hatte das Kabel einen Mikroknopf zum Einstellen der Modi, der dann jedoch entfernt wurde, da er nicht erreicht werden konnte, wenn sich die Wolke unter der Decke befand. <br><br>  Es gibt keine USB-Verbindung, der MK hat keinen USB-Anschluss und es scheint, dass er im fertigen Produkt nicht ben√∂tigt wird.  Zum Debuggen habe ich den UART-Controller verwendet, der Code implementiert einen Austausch mit einem Computer, aber dort ist er kitschig <s>auf das Knie geschrieben</s> . <br><br><img src="https://habrastorage.org/webt/7u/fy/h5/7ufyh5cpydbcvzj50ojtwibyeik.jpeg" width="75%"><br>  <i>Beim L√∂ten</i> <br><br>  LUT, L√∂ten, Schreiben eines Programms, Tests und √Ñnderungen, Anpassen von Timern und Koeffizienten dauerten 3 Wochen. <br><br><img src="https://habrastorage.org/webt/zk/t8/g9/zkt8g9wjyn7ujuyihfg32mn-bc0.jpeg" alt="Bild"><br>  <i>Gesamtansicht</i> <br><br>  Als Ergebnis realisierte er 3 Modi von Gl√ºh- und Lichteffekten.  Ich habe versucht, es interessanter zu machen als eine Lavalampe, bin aber auch keine Disco-Musik mit Faustpfeifen geworden. <br><br><h3>  Modi: </h3><br>  <b>Die wichtigste</b> ist eine Nachtlampe in Form einer Wolke.  Verschiedene Teile der Wolke √§ndern zuf√§llig die Helligkeit, die √Ñnderungsperiode ist ebenfalls zuf√§llig (4 ... 25 Sekunden), die Art der √Ñnderung ist eine exponentielle Gl√§ttung der Aufgabe (mehr kann ich Ihnen in den Kommentaren sagen).  Es sieht als Ganzes mit einem Bruchteil der Vorstellungskraft aus wie Licht√ºberl√§ufe in einer realen Wolke, wenn es die Sonne bedeckt.  Die maximale Helligkeit h√§ngt von der Beleuchtungsst√§rke gem√§√ü Zeitplan ab.  Ich habe verschiedene Abh√§ngigkeiten aufgegriffen, es gab eine Option mit der Auswahl der Abh√§ngigkeiten auf der Schaltfl√§che, aber ich habe mich nur f√ºr diese entschieden. <br><br><img src="https://habrastorage.org/webt/hw/hp/xo/hwhpxotfo5gyf9njb_64kkvdtps.png" alt="Bild"><br>  <i>Der Graph der Abh√§ngigkeit der Helligkeit der Wolke von der Au√üenbeleuchtung.</i> <br><br>  Da die Wolke bei √§u√üerer Dunkelheit (Nacht) fast nicht scheint und kurzfristig helles Licht ben√∂tigt werden kann (zum Beispiel um nachts aufzustehen), habe ich mir daf√ºr den Submodus Helle Wolke ausgedacht.  Er schaltet sich hier mit zwei Klatschen ein und benutzt ein Mikrofon, da die Tasten normalerweise nicht in Reichweite sind.  Die Wolke leuchtet eine Minute lang bei voller Helligkeit, auch bei √úberlauf, und kehrt dann je nach Beleuchtung sanft in den Hauptwolkenmodus zur√ºck. <br><br><img src="https://habrastorage.org/webt/cg/ha/dx/cghadxfnhu9zgmk0x-u3rx9xsp8.gif" alt="Bild"><br>  <i>Cloud-Modus, erste Beispiele.</i>  <i>Video 5-mal beschleunigt</i> <br><br>  <b>Gewitter</b> - schaltet sich mit einer starken Abnahme des Umgebungslichts (jedoch erst bei v√∂lliger Dunkelheit, um die Augen im Dunkeln nicht zu treffen) oder drei Knallen ein.  Zuf√§llige LEDs blinken (von eins bis viermal), mit einer zuf√§lligen Pause zwischen den Blitzen.  Ich war ein bisschen verwirrt und machte Blitze in der Wolke, als die LEDs entlang der Zeitkette blinkten.  Es sieht auch ganz nach einem Gewitter aus.  Aufgrund des Gewitterregimes musste ein PWM-Filterkompromiss gefunden werden, damit die Blitze scharf waren (77 ms).  Die Dauer des ‚ÄûGewitters‚Äú h√§ngt vom Umgebungslicht ab - je dunkler, desto l√§nger, 4 bis 12 Blitze. <br><br>  <b>Morgend√§mmerung</b> - schaltet sich mit einem starken Anstieg des Umgebungslichts ein.  Der am schwierigsten einzurichtende Modus, ‚Äûeine nat√ºrliche Ver√§nderung der Farben der Sonne im Morgengrauen in einem leichten Dunst‚Äú zu erreichen, war nicht einfach.  Es war notwendig, die RGB-LED auf fast jeder PWM-Ebene manuell auszugleichen und Abh√§ngigkeiten auszuw√§hlen.  Aber am Ende erhielt ich eine mehr oder weniger Interpolationsformel.  Die Morgend√§mmerung dauert 40 Sekunden und wechselt dann in den normalen Modus. <br><br><img src="https://habrastorage.org/webt/c_/fl/6b/c_fl6baslbfbbxsagw5bpnou39c.jpeg" alt="Bild" width="75%"><br>  <i>Morgend√§mmerung</i> <br><br>  Elektronik und Software f√ºr Interessierte: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Archiv mit Quelle</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schema im pdf</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Board Layout, eine Seite</a> <br><br><h3>  Konstruktiv </h3><br>  Das Design der Wolke ist recht einfach, ich bin aus Sintepuha (ein Kissen 40x40 cm), das Brett befindet sich innen an den Aufh√§ngungen der F√§den.  Die Lautst√§rke der LEDs ist so gleichm√§√üig wie m√∂glich angeordnet. Die RGB-LED befindet sich unten und der Fotosensor oben. <br><br><img src="https://habrastorage.org/webt/n8/yf/qm/n8yfqmg3dbmhm9oqpelqvnt4xxa.jpeg" width="75%"><br>  <i>Im Prozess des Fuzzing</i> <br><br>  Es gab Schwierigkeiten beim Fixieren der Synthech, da sie mit Silikon beschichtet ist, um ein Zusammenbacken zu verhindern.  Der untere Teil der Wolke wird von schmalen Klebebandstreifen am Drahtrahmen getragen. <br><br>  Fragen, Kommentare, Vorschl√§ge schreiben Sie in die Kommentare. <br><br>  Sch√∂nes Wetter! <br><br><img src="https://habrastorage.org/webt/k2/jp/ia/k2jpiamrczanxcsod6-l-rh-nmi.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428988/">https://habr.com/ru/post/de428988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428976/index.html">Ameisenh√ºgel oder Festung? Ich baue ein Haus zum Preis einer Wohnung. Teil 2: Heizen</a></li>
<li><a href="../de428980/index.html">Offline JavaScript Broker</a></li>
<li><a href="../de428982/index.html">Wie schreibe ich D auf ARM</a></li>
<li><a href="../de428984/index.html">Julia und Phasenportr√§ts dynamischer Systeme</a></li>
<li><a href="../de428986/index.html">ThinkJava-Konferenz Nr. 8 in Charkow</a></li>
<li><a href="../de428990/index.html">Konfigurationsbeispiele f√ºr UIViewController mit RouteComposer</a></li>
<li><a href="../de428992/index.html">Selektiver Bypass von Sperren auf Routern mit Padavan- und Keenetic OS-Firmware</a></li>
<li><a href="../de428994/index.html">Vernetzung in Android mit Corutin und Retrofit</a></li>
<li><a href="../de428996/index.html">Club der anonymen Weihnachtsm√§nner 2018-2019 auf Habrahabr</a></li>
<li><a href="../de428998/index.html">Verwendung der neuen experimentellen Profiler-Funktion in React</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>