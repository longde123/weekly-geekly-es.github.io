<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЪС ЁЯЪГ ЁЯШп рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЛ рдПрдХ рдирдпрд╛ рдЖрд╡реЗрджрди рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджреМрдбрд╝рдиреЗ рд╡рд╛рд▓реА рдЯреАрдореЗрдВ ЁЯШг ЁЯТЪ ЁЯСитАНЁЯФз</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рдорд╛рд░реЗ рдЕрднреНрдпрд╛рд╕ рдореЗрдВ, рд╣рдо рдЕрдХреНрд╕рд░ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдкрд░ рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдирд╛рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЕрдВрдЬрд╛рдо рджреЗрддреЗ рд╕рдордп, рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЛ рдПрдХ рдирдпрд╛ рдЖрд╡реЗрджрди рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджреМрдбрд╝рдиреЗ рд╡рд╛рд▓реА рдЯреАрдореЗрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/476320/"><img src="https://habrastorage.org/webt/bl/a1/wq/bla1wqhxnafiftfwcg0s3vsyvxe.png"><br><br>  рд╣рдорд╛рд░реЗ рдЕрднреНрдпрд╛рд╕ рдореЗрдВ, рд╣рдо рдЕрдХреНрд╕рд░ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдкрд░ рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдирд╛рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред  рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЕрдВрдЬрд╛рдо рджреЗрддреЗ рд╕рдордп, рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдорд╕реНрдпрд╛рдПрдВ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВред  рд╣рдордиреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд▓реЗрдЦ рдореЗрдВ рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рдХрд╡рд░ рдХрд┐рдпрд╛ рд╣реИ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬрдм рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрд╡реЗрджрди рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╕рдордп рд╕реНрдерд╛рдиреАрдп рдлрд╛рдЗрд▓реЗрдВ</a> , рдФрд░ рджреВрд╕рд░рд╛, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕реАрдЖрдИ / рд╕реАрдбреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ, рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><h2>  Helm рдФрд░ werf рдХреЗ рд╕рд╛рде рдордирдорд╛рдирд╛ рдЖрджреЗрд╢ </h2><br>  рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рди рдХреЗрд╡рд▓ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рдФрд░ рдбреЗрдЯрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рдПрдХ рдордирдорд╛рдирд╛ рдЖрджреЗрд╢реЛрдВ рдХрд╛ рдПрдХ рд╕реЗрдЯ рд╣реИ рдЬрд┐рд╕реЗ рдПрдХ рд╕рдлрд▓ рдЕрдкрдбреЗрдЯ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпреЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдорд╛рдЗрдЧреНрд░реЗрд╢рди, рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреЗ рд▓рд┐рдП "рд╡реЗрдЯрд░", рдХреБрдЫ рдЯреНрд░рд╛рдВрд╕рдХреЛрдбрд░реНрд╕ рдпрд╛ рдЕрдирдкреИрдХрд░реНрд╕, рдмрд╛рд╣рд░реА рд╕реЗрд╡рд╛ рдбрд┐рд╕реНрдХрд╡рд░реА рдореЗрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░рд╛рд░ - рдЖрдк рд╡рд┐рднрд┐рдиреНрди рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдРрд╕реА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ? <a name="habracut"></a>  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдХрдВрдЯреЗрдирд░ рдХреЛ рдлрд▓реА рдХреЗ рд░реВрдк рдореЗрдВ рдХреИрд╕реЗ рдЪрд▓рд╛рдирд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдорд╛рдирдХ рд╕рдорд╛рдзрд╛рди рдПрдХ рдЫрд╡рд┐ рд╕реЗ рдПрдХ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдирд╛ рд╣реИред  рдЗрд╕рдХреЗ рд▓рд┐рдП, рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рдиреМрдХрд░реА рдЖрджрд┐рдо</b></a> рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЗ рд╕рд╛рде рдкреЙрдб рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдкреЙрдб рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рддрд╛ рд╣реИред <br><br>  <b>рд╣реЗрд▓реНрдо</b> рдереЛрдбрд╝рд╛ рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд╣реИ рдФрд░ рддреИрдирд╛рддреА рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рдгреЛрдВ рдореЗрдВ рдЕрдпреНрдпреВрдм рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИред  рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реЗрд▓реНрдо рд╣реБрдХ рдХреЗ</a> рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдЖрдк рд╕рдВрд╕рд╛рдзрди рдореИрдирд┐рдлрд╝реЗрд╕реНрдЯ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╛ рдмрд╛рдж рдореЗрдВ рдЬреЙрдм рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рдЕрдиреБрднрд╡ рдореЗрдВ, рдпрд╣ рдПрдХ рдорд╣рд╛рди рд╣реЗрд▓реНрдо рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рддреИрдирд╛рддреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣реЗрд▓рдо рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рд░реЛрд▓рдЖрдЙрдЯ рдХреЗ</b></a> рджреМрд░рд╛рди рд╡рд╕реНрддреБрдУрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдк-рдЯреВ-рдбреЗрдЯ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рд╡реЗрдпрд░рдл</b></a> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╕реАрдЖрдИ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╕реАрдзреЗ рд░реЛрд▓рдЖрдЙрдЯ рдХреЗ рджреМрд░рд╛рди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдирд╛ рдФрд░ рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рддреЗрдЬреА рд╕реЗ рдЯреВрдЯрдиреЗ рдХрд╛ рдирд┐рджрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред <br><br>  рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рдирд┐рдХрд▓рд╛, рдпреЗ рдЙрдкрдпреЛрдЧреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реЗрд▓реНрдо рдФрд░ рд╣рд░реНрдл рдХрднреА-рдХрднреА рдкрд╛рд░рд╕реНрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ рдЕрдирдиреНрдп рд╣реЛрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрд╢рд╛ рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реЛрддрд╛ рд╣реИред  рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдЖрдк рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ рдордирдорд╛рдиреА рдХрдорд╛рдВрдб рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред <cut></cut><br><br><h2>  рд░рд┐рд╣рд╛рдИ рд╕реЗ рдкрд╣рд▓реЗ рдкрд▓рд╛рдпрди </h2><br>  рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛рдмреЗрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░рд┐рд▓реАрдЬ рдХрд╛ рдПрдХ рдЕрднрд┐рдиреНрди рд╣рд┐рд╕реНрд╕рд╛ рдбреЗрдЯрд╛ рд╕реНрдХреАрдорд╛ рдХреЛ рдЕрджреНрдпрддрди рдХрд░ рд░рд╣рд╛ рд╣реИред  рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдХрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рд▓рд╛рдЧреВ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рдкрд░рд┐рдирд┐рдпреЛрдЬрди рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ: <br><br><ol><li>  рдХреЛрдб рдЖрдзрд╛рд░ рдЕрдкрдбреЗрдЯ; </li><li>  рдкреНрд░рд╡рд╛рд╕ рдХреА рд╢реБрд░реБрдЖрдд; </li><li>  рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЯреНрд░реИрдлрд╝рд┐рдХ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛ред </li></ol><br>  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ рднреАрддрд░, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдорд╛рди рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЬреЛ рдЪрд╛рд╣рд┐рдП рдЙрд╕рдХреЗ рд▓рд┐рдП рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><ol><li>  рдПрдХ рдирдП рдХреЛрдб рдХреЗ рд╕рд╛рде рдПрдХ рдХрдВрдЯреЗрдирд░ рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ, рдЬрд┐рд╕рдореЗрдВ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХрд╛ рдПрдХ рдирдпрд╛ рд╕реЗрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ; </li><li>  рдЗрд╕рдореЗрдВ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░реЗрдВ, рдЖрд╡реЗрджрди рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдРрд╕рд╛ рдХрд░реЗрдВред </li></ol><br>  рдЙрд╕ рд╡рд┐рдХрд▓реНрдк рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬрдм <b>рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЪрд▓ рд░рд╣рд╛ рд╣реЛ</b> рдФрд░ рд╣рдореЗрдВ <b>рдПрдкреНрд▓рд┐рдХреЗрд╢рди</b> рдХреЛ рддреИрдирд╛рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд░рд┐рд▓реАрдЬ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реЗ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдорд╛рдЗрдЧреНрд░реЗрд╢рди рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рд╣реБрдХ рдЙрдкрдпреБрдХреНрдд рд╣реИрдВ: <br><br><ul><li>  <code>pre-install</code> - рдпрд╣ рд╕рднреА рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд▓реЗрдХрд┐рди рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рд╕рдВрд╕рд╛рдзрди рдмрдирд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрд╡реЗрджрди рдХреЗ рдкрд╣рд▓реЗ рд╣реЗрд▓-рд░рд┐рд▓реАрдЬрд╝ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ; </li><li>  <code>pre-upgrade</code> - рд╣реЗрд▓реНрдо рд░рд┐рд▓реАрдЬ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ <code>pre-install</code> рдХреЗ рдмрд╛рдж, <code>pre-install</code> рддрд░рд╣ рдЪрд▓рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреБрдмреЗрд░рдиреЗрдЯ рдореЗрдВ рд╕рдВрд╕рд╛рдзрди рдмрдирд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред </li></ul><br>  рд╣реЗрд▓реНрдо рдФрд░ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рджреЛ рд╣реБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреМрдХрд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг: <br><br><pre> <code class="plaintext hljs">--- apiVersion: batch/v1 kind: Job metadata: name: {{ .Chart.Name }}-apply-migrations annotations: "helm.sh/hook": pre-install,pre-upgrade spec: activeDeadlineSeconds: 60 backoffLimit: 0 template: metadata: name: {{ .Chart.Name }}-apply-migrations spec: imagePullSecrets: - name: {{ required ".Values.registry.secret_name required" .Values.registry.secret_name }} containers: - name: job command: ["/usr/bin/php7.2", "artisan", "migrate", "--force"] {{ tuple "backend" . | include "werf_container_image" | indent 8 }} env: {{ tuple "backend" . | include "werf_container_env" | indent 8 }} - name: DB_HOST value: postgres restartPolicy: Never</code> </pre> <br>  <i><b>рдиреЛрдЯ</b> : рдЙрдкрд░реЛрдХреНрдд YAML рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдХреЛ werf рдХреА рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред</i>  <i>рдЗрд╕реЗ "рд╕реНрд╡рдЪреНрдЫ" рд╣реЗрд▓реНрдо рдХреЗ рдЕрдиреБрдХреВрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ:</i> <br><br><ul><li>  <i><code>{{ tuple "backend" . | include "werf_container_image" | indent 8 }}</code> рдмрджрд▓реЗрдВ <code>{{ tuple "backend" . | include "werf_container_image" | indent 8 }}</code></i> <i><code>{{ tuple "backend" . | include "werf_container_image" | indent 8 }}</code></i>  <i><code>{{ tuple "backend" . | include "werf_container_image" | indent 8 }}</code> рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐ рдХреЗ рд▓рд┐рдП;</i> </li><li>  <i>рд▓рд╛рдЗрди <code>{{ tuple "backend" . | include "werf_container_env" | indent 8 }}</code> рд╣рдЯрд╛рдПрдВ <code>{{ tuple "backend" . | include "werf_container_env" | indent 8 }}</code></i> <i><code>{{ tuple "backend" . | include "werf_container_env" | indent 8 }}</code></i>  <i><code>{{ tuple "backend" . | include "werf_container_env" | indent 8 }}</code> , рдЬреЛ <code>env</code> рдХреБрдВрдЬреА рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИред</i> </li></ul><br>  рддреЛ, рдЗрд╕ рд╣реЗрд▓реНрдо рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ <code>.helm/templates</code> рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ <code>.helm/templates</code> , рдЬрд┐рд╕рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░рд┐рд▓реАрдЬ рдХреЗ рдмрд╛рдХреА рд╕рдВрд╕рд╛рдзрди рд╣реИрдВред  рдЬрдм <code>werf deploy --stages-storage :local</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рднреА рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдХреЛ рдкрд╣рд▓реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><h2>  рд░рд┐рд▓реАрдЬ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдорд╛рдЗрдЧреНрд░реЗрд╢рди рд╢реБрд░реВ рдХрд░рдирд╛ </h2><br>  рдЙрдкрд░реЛрдХреНрдд рд╡рд┐рдХрд▓реНрдк рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рд╣реИ рдЬрдм рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЪрд▓ рд░рд╣рд╛ рд╣реЛ рддреЛ рдХреЗрд╕ рдХреЗ рд▓рд┐рдП рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧред  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдореЗрдВ рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП рд╢рд╛рдЦрд╛ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ <b>рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ</b> рдПрдХ рд░рд┐рд▓реАрдЬ рдореЗрдВ <b>рдЖрд╡реЗрджрди рдХреЗ рд╕рд╛рде рд░реЛрд▓ рдЖрдЙрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдП</b> ? <br><br>  <i><b>NB</b> : рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ IP рдкрддрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рддреЛ рдЙрддреНрдкрд╛рджрди рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рд░реЛрд▓ рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдПрдХ рд╕рдорд╛рди рд╕рдорд╕реНрдпрд╛ рдЖ рд╕рдХрддреА рд╣реИред</i> <br><br>  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, <code>pre-install</code> рдФрд░ <code>pre-upgrade</code> рд╣реБрдХ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдирд╣реАрдВ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЙрди рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдЬреЛ <i>рдЕрднреА рддрдХ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИрдВ</i> ред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд░рд┐рд╣рд╛рдИ рдХреЗ <i>рдмрд╛рдж</i> рдкрд▓рд╛рдпрди рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред <br><br>  рд╣реЗрд▓реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдРрд╕рд╛ рдХрд╛рд░реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ <i>рдХреА</i> рд╕реНрдерд┐рддрд┐ рдХреА <i>рдирд┐рдЧрд░рд╛рдиреА рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ</i> ред  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдкреЛрд╕реНрдЯ рд╣реБрдХ <i>рд╣рдореЗрд╢рд╛</i> рдЖрдЧ рд▓рдЧрд╛рддреЗ рд╣реИрдВ: <br><br><ul><li>  рдкрд╣рд▓реЗ рд░рд┐рд▓реАрдЬ рдкрд░ K8s рдореЗрдВ рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб <code>post-install</code> рдмрд╛рдж <code>post-install</code> ; </li><li>  <code>post-upgrade</code> рдмрд╛рдж - рд░рд┐рд▓реАрдЬ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╕рдордп K8 рдореЗрдВ рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рджред </li></ul><br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдКрдкрд░ рдмрддрд╛рдпрд╛ рд╣реИ, рд░рд┐рд▓реАрдЬрд╝ рдХреЗ рджреМрд░рд╛рди <b>рд╡реЗрдпрд░рдлрд╝ рдХреЗ рдкрд╛рд╕ рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ рдкреНрд░рдгрд╛рд▓реА рд╣реИ</b> ред  рдореИрдВ рдЗрд╕ рдкрд░ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдереЛрдбрд╝рд╛ рдФрд░ рдзреНрдпрд╛рди рджреВрдВрдЧрд╛: <br><br><ul><li>  рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП, werf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">kubedog</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдмрд╛рд░реЗ</a> рдореЗрдВ рд╣рдо рдкрд╣рд▓реЗ рд╣реА рдмреНрд▓реЙрдЧ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдмрд╛рдд</a> рдХрд░ рдЪреБрдХреЗ рд╣реИрдВред </li><li>  рд╡реЗрдпрд░рдл рдореЗрдВ рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рд╣рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд░реВрдк рд╕реЗ рд░рд┐рд▓реАрдЬ рдХреА рд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдФрд░ рд╕реАрдЖрдИ / рд╕реАрдбреА-рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдореЗрдВ рддреИрдирд╛рддреА рдХреЗ рд╕рдлрд▓ рдпрд╛ рдЕрд╕рдлрд▓ рд╕рдорд╛рдкрди рдкрд░ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред </li><li>  рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдмрд┐рдирд╛, рдХреЛрдИ рднреА рд░рд┐рд▓реАрдЬрд╝ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдХрд┐рд╕реА рднреА рд╕реНрд╡рдЪрд╛рд▓рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛, рдХреНрдпреЛрдВрдХрд┐ рдХреБрдмреЗрд░рдиреЗрдЯ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рд╕рдлрд▓ рдирд┐рд░реНрдорд╛рдг рдЪрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдХрд╛рд░рдг рдпрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕рдорд╕реНрдпрд╛ рдХреЗ рдХрд╛рд░рдг рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди <code>helm upgrade</code> рдмрд╛рдж рдЗрд╕реЗ рджреЗрдЦрдиреЗ рдХреЗ <code>helm upgrade</code> , рдЖрдкрдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдЪрд░рдг рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗред </li></ul><br>  рдЕрдм рд╣реЗрд▓реНрдо рдкреЛрд╕реНрдЯ-рд╣реБрдХ рдкрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЗ рдЖрд╡реЗрджрди рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдВред  рд╣рдордиреЗ рдЬрд┐рди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛: <br><br><ul><li>  рдПрдХ рдпрд╛ рджреВрд╕рд░реЗ рддрд░реАрдХреЗ рд╕реЗ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рд░реНрдХрд┐рдЯ рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рддрд╛рдЬрд╛ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЗ рдмрд┐рдирд╛, рдЖрд╡реЗрджрди рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </li><li>  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╡реЗрдпрд░рдл, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рднреА рдСрдмреНрдЬреЗрдХреНрдЯ <code>Ready</code> рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реИрдВ, рдкреЛрд╕реНрдЯ рд╣реБрдХ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдФрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </li><li>  рдЯреНрд░реИрдХрд┐рдВрдЧ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдПрдиреЛрдЯреЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рддреИрдирд╛рддреА рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИред </li></ul><br>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдП: <br><br><ul><li>  рдиреМрдХрд░рд┐рдпрд╛рдВ рдореБрдЦреНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдкрд╣рд▓реЗ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП <b>рдкрд▓рд╛рдпрди рдХреЗ рд▓рд┐рдП рд╣реЗрд▓реНрдо рд╣реБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ</b> ред </li><li>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рд░ рддреИрдирд╛рддреА рдкрд░ рдкрд▓рд╛рдпрди рдХреЗ рд╕рд╛рде рдПрдХ рдиреМрдХрд░реА рдЪрд▓рдиреА рдЪрд╛рд╣рд┐рдПред  рдРрд╕рд╛ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, <b>рдЕрдпреНрдпреВрдм рдХреЗ рдкрд╛рд╕ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдирд╛рдо</b> (рдпрд╛рджреГрдЪреНрдЫрд┐рдХ) <b>рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП</b> : рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣реЗрд▓реНрдо рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╣рд░ рдмрд╛рд░ рд░рд┐рд▓реАрдЬ рдореЗрдВ рдПрдХ рдирдИ рд╡рд╕реНрддреБ рд╣реИ, рдЬреЛ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдмрдирд╛рдИ рдЬрд╛рдПрдЧреАред </li><li>  рдЗрд╕ рддрд░рд╣ рдХреЗ рд▓реЙрдиреНрдЪ рдХреЗ рд╕рд╛рде, рдпрд╣ рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдорддрд▓рдм рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЕрдпреНрдпреВрдм рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЗ рд╕рд╛рде рдЬрдорд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЙрди рд╕рднреА рдХреЗ рдкрд╛рд╕ рдЕрджреНрд╡рд┐рддреАрдп рдирд╛рдо рд╣реЛрдВрдЧреЗ, рдФрд░ рдкрд┐рдЫрд▓реА рдЬреЙрдм рдХреЛ рдПрдХ рдирдП рд░рд┐рд▓реАрдЬ рдХреЗ рд╕рд╛рде рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </li><li>  <b>рдорд╛рдЗрдЧреНрд░реЗрд╢рди рд╡рд╛рд▓реА рдиреМрдХрд░реА рдореЗрдВ рдПрдХ init рдХрдВрдЯреЗрдирд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ</b> рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ - рдЕрдиреНрдпрдерд╛ рд╣рдореЗрдВ рдПрдХ рдЧрд┐рд░рд╛ рд╣реБрдЖ рддреИрдирд╛рддреА рдорд┐рд▓рддреА рд╣реИ (рдиреМрдХрд░реА init рдХрдВрдЯреЗрдирд░ рдкрд░ рдЧрд┐рд░ рдЬрд╛рдПрдЧреА)ред </li></ul><br>  рдкрд░рд┐рдгрд╛рдореА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: <br><br><pre> <code class="plaintext hljs">--- apiVersion: batch/v1 kind: Job metadata: name: {{ printf "%s-apply-migrations-%s" .Chart.Name (now | date "2006-01-02-15-04-05") }} spec: activeDeadlineSeconds: 60 backoffLimit: 0 template: metadata: name: {{ printf "%s-apply-migrations-%s" .Chart.Name (now | date "2006-01-02-15-04-05") }} spec: imagePullSecrets: - name: {{ required ".Values.registry.secret_name required" .Values.registry.secret_name }} initContainers: - name: wait-db image: alpine:3.6 ommand: ["/bin/sh", "-c", "while ! nc -z postgres 5432; do sleep 1; done;"] containers: - name: job command: ["/usr/bin/php7.2", "artisan", "migrate", "--force"] {{ tuple "backend" . | include "werf_container_image" | indent 8 }} env: {{ tuple "backend" . | include "werf_container_env" | indent 8 }} - name: DB_HOST value: postgres restartPolicy: Never</code> </pre> <br>  <i><b>NB</b> : рдХрдбрд╝рд╛рдИ рд╕реЗ рдмреЛрд▓рдирд╛, рдбреЗрдЯрд╛рдмреЗрд╕ рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП init рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рд╡реИрд╕реЗ рднреА рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</i> <br><br><h2>  рд╕рднреА рддреИрдирд╛рдд рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг </h2><br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рд░рд┐рд▓реАрдЬрд╝ рдХреЗ рджреМрд░рд╛рди рдЬрд┐рди рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд╡реЗ рдкрд╣рд▓реЗ рд╕реЗ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЗ рд▓реЙрдиреНрдЪ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред  рдЖрдк рди рдХреЗрд╡рд▓ рд╣реБрдХ рдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдмрд▓реНрдХрд┐ <b>рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рд╡рдЬрд╝рди рдЕрд╕рд╛рдЗрди</b> рдХрд░рдХреЗ рднреА - рдЕрдпреНрдпреВрдм рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдЖрджреЗрд╢ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ <b>рд╣реИрдВ</b> - рдПрдиреЛрдЯреЗрд╢рди <code>helm.sh/hook-weight</code> рдорд╛рдзреНрдпрдо рд╕реЗред  рд╣реБрдХ рдХреЛ рдЖрд░реЛрд╣реА рдХреНрд░рдо рдореЗрдВ рд╡рдЬрди рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рд╡рдЬрди рд╕рдорд╛рди рд╣реИ, рддреЛ рд╕рдВрд╕рд╛рдзрди рдирд╛рдо рд╕реЗред <br><br>  рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдиреМрдХрд░рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдпрд╣ рдЬреЙрдмреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдЯреЗрдореНрдкрд▓реЗрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ <code>values.yaml</code> рдореЗрдВ рдбрд╛рд▓ рджрд┐рдпрд╛ рд╣реИред  рдЙрддреНрддрд░рд╛рд░реНрджреНрдз рдЗрд╕ рддрд░рд╣ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="plaintext hljs">deploy_jobs: - name: migrate command: '["/usr/bin/php7.2", "artisan", "migrate", "--force"]' activeDeadlineSeconds: 120 when: production: 'pre-install,pre-upgrade' staging: 'pre-install,pre-upgrade' _default: '' - name: cache-clear command: '["/usr/bin/php7.2", "artisan", "responsecache:clear"]' activeDeadlineSeconds: 60 when: _default: 'post-install,post-upgrade'</code> </pre> <br>  ... рдФрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рд╕реНрд╡рдпрдВ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: <br><br><pre> <code class="plaintext hljs">{{- range $index, $job := .Values.deploy_jobs }} --- apiVersion: batch/v1 kind: Job metadata: name: {{ $.Chart.Name }}-{{ $job.name }} annotations: "helm.sh/hook": {{ pluck $.Values.global.env $job.when | first | default $job.when._default }} "helm.sh/hook-weight": "1{{ $index }}" spec: activeDeadlineSeconds: {{ $job.activeDeadlineSeconds }} backoffLimit: 0 template: metadata: name: {{ $.Chart.Name }}-{{ $job.name }} spec: imagePullSecrets: - name: {{ required "$.Values.registry.secret_name required" $.Values.registry.secret_name }} initContainers: - name: wait-db image: alpine:3.6 ommand: ["/bin/sh", "-c", "while ! nc -z postgres 5432; do sleep 1; done;"] containers: - name: job command: {{ $job.command }} {{ tuple "backend" $ | include "werf_container_image" | indent 8 }} env: {{ tuple "backend" $ | include "werf_container_env" | indent 8 }} - name: DB_HOST value: postgres restartPolicy: Never {{- end }}</code> </pre> <br>  рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЖрдкрдХреЛ рд░рд┐рд▓реАрдЬ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдирдП рдХрдорд╛рдВрдб рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХрдорд╛рдВрдб рдХреА рд╕реВрдЪреА рдХреЛ рдЕрдзрд┐рдХ рджреГрд╢реНрдп рдмрдирд╛рддрд╛ рд╣реИред <br><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рд▓реЗрдЦ рдЙрди рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЙрди рд╕рд╛рдорд╛рдиреНрдп рдСрдкрд░реЗрд╢рдиреЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдкрдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд░рд┐рд▓реАрдЬрд╝ рдХреЗ рджреМрд░рд╛рди рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдпрджреНрдпрдкрд┐ рд╡реЗ рджрд░реНрдЬрдиреЛрдВ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд╕реАрдЖрдИ / рд╕реАрдбреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рдЕрдиреБрднрд╡ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдереЗ, рд╣рдо рдЗрд╕ рдмрд╛рдд рдкрд░ рдЬреЛрд░ рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рд╕рд╣реА рд╕рдорд╛рдзрд╛рди рд╣реИред  рдпрджрд┐ рд▓реЗрдЦ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдЙрджрд╛рд╣рд░рдг рдЖрдкрдХреА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдЬрд░реВрд░рддреЛрдВ рдХреЛ рдкреВрд░рд╛ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рджреЗрдЦрдХрд░ рдЦреБрд╢реА рд╣реЛрдЧреА рдЬреЛ рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЗ рдкреВрд░рдХ рдореЗрдВ рдорджрдж рдХрд░реЗрдВрдЧреЗред <br><br>  рд╡реЗрдпрд░рдл рдбреЗрд╡рд▓рдкрд░реНрд╕ рд╕реЗ рдЯрд┐рдкреНрдкрдгреА: <br><blockquote>  <i>рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рд╡реЗрдпрд░рдл рдиреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рдиреНрдпрд╛рд╕ рдпреЛрдЧреНрдп рддреИрдирд╛рддреА рдЪрд░рдгреЛрдВ рдХреЛ рдкреЗрд╢ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рд╣реИред</i>  <i>рдРрд╕реЗ рдЪрд░рдгреЛрдВ рдХреА рдорджрдж рд╕реЗ рджреЛрдиреЛрдВ рдорд╛рдорд▓реЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ рдФрд░ рди рдХреЗрд╡рд▓ред</i> </blockquote><br><h2>  рдкреБрдирд╢реНрдЪ </h2><br>  рд╣рдорд╛рд░реЗ рдмреНрд▓реЙрдЧ рдореЗрдВ рднреА рдкрдврд╝реЗрдВ: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬрдЯрд┐рд▓ рд╣реЗрд▓ рдЪрд╛рд░реНрдЯ рдХреЛ рд░реЛрд▓ рдЖрдЙрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЗрдпрд░рдлрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрд╕реЗрдВрдмрд▓реА рдФрд░ рдЧреАрддрд╛рд▓рд╛рдм рд╕реАрдЖрдИ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рдкреНрд░рдХрд╛рд░ рдХреЗ рдорд╛рдЗрдХреНрд░реЛрд╕рд┐рд╕реНрдЯрд░реНрд╕ рдХреА рдЕрд╕реЗрдВрдмрд▓реА рдФрд░ рддреИрдирд╛рддреА</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">3-рд╡реЗрдЬрд╝ рдореЗрдВ рдорд░реНрдЬ: рд╣реЗрд▓реНрдо рдХреЗ рд╕рд╛рде рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рддреИрдирд╛рддреА" рд╕реНрдЯреЗрд░реЙрдпрдб рдкрд░ "</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдЯрд┐рдкреНрд╕ рдПрдВрдб рдЯреНрд░рд┐рдХреНрд╕: рдмрдбрд╝реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдмреВрдЯрд╕реНрдЯреНрд░реИрдк рдХреЛ рддреЗрдЬ рдХрд░рддрд╛ рд╣реИред</a> " </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi476320/">https://habr.com/ru/post/hi476320/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi476308/index.html">2020 рдореЗрдВ рдЯреЙрдк 5 рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдлреЙрд▓реЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП</a></li>
<li><a href="../hi476310/index.html">рдорд╛рдирд╡ рдЪреЗрд╣рд░рд╛ CRM</a></li>
<li><a href="../hi476312/index.html">рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдпрд╛ рдХреЛрдгреАрдп рдпрд╛ Vue.js - рдХреНрдпрд╛ рдЪреБрдирдирд╛ рд╣реИ?</a></li>
<li><a href="../hi476316/index.html">Vue Storefront: ES рдореЗрдВ рдбреЗрдЯрд╛ рднрд░реЗрдВ</a></li>
<li><a href="../hi476318/index.html">рд╣рдо рдЬреЛрдХрд░ 2019 рдкрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╣рдорд▓рд╛ рдХрд░рддреЗ рд╣реИрдВ: рд░реВрд╕ рдореЗрдВ рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рдЬрд╛рд╡рд╛ рд╕рдореНрдореЗрд▓рди рдХреИрд╕реЗ рд╣реБрдЖ</a></li>
<li><a href="../hi476322/index.html">рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдХреЗрдВрджреНрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рдореБрдЦ рд╡рд┐рддрд░рдг рдпреЛрдЬрдирд╛рдПрдВ: рдЧрд┐рд░реМрдж рдФрд░ рдмреНрд▓реЛрдорд╛ рдпреЛрдЬрдирд╛рдПрдВ</a></li>
<li><a href="../hi476324/index.html">рдЕрдХреНрдЯреВрдмрд░ рдЙрддреНрдкрд╛рдж рдкреНрд░рдмрдВрдзрди рдбрд╛рдЗрдЬреЗрд╕реНрдЯ</a></li>
<li><a href="../hi476328/index.html">рд╕реНрдЯрд╛рд░рд▓рд┐рдВрдХ рдПрдХ рдмрдбрд╝реА рдмрд╛рдд рд╣реИ</a></li>
<li><a href="../hi476330/index.html">рдореИрдВрдиреЗ рдкреЗрдирдЬрд╝рд╛ рдХреЗ рд▓рд┐рдП рд╕реЗрдВрдЯ рдкреАрдЯрд░реНрд╕рдмрд░реНрдЧ рдХреНрдпреЛрдВ рдЫреЛрдбрд╝ рджрд┐рдпрд╛</a></li>
<li><a href="../hi476332/index.html">рдХреНрд▓рд╛рд╕рд┐рдХ рдорд╢реАрди рд╕реАрдЦрдиреЗ рдХреЗ рд╕рд╛рде рдХреНрд╡рд╛рдВрдЯрдо рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рдореЗрдВ рд╕реБрдзрд╛рд░</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>