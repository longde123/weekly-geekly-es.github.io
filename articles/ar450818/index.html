<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฑ ๐ ๐ผ๏ธ ูู ุงุฑุชูุงุน ุฒูู ุงูุงูุชูุงู ุฅูู ุชุตุญูุญ Kernel ุจุงุณุชุฎุฏุงู eBPF / BCC ๐ฐ ๐ธ โ๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุงู ุงููุซูุฑ ูู ุงูุฃุฏูุงุช ูุชุตุญูุญ ุฃุฎุทุงุก ุจุฑุงูุฌ kernel ู userpace ูู Linux. ูุนุธููุง ูู ุชุฃุซูุฑ ูู ุงูุฃุฏุงุก ููุง ูููู ุชุดุบููู ุจุณูููุฉ ูู ุจูุฆุงุช ุงูุฅูุชุงุฌ. ูุจู ุจุถุน ุณููุงุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูู ุงุฑุชูุงุน ุฒูู ุงูุงูุชูุงู ุฅูู ุชุตุญูุญ Kernel ุจุงุณุชุฎุฏุงู eBPF / BCC</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/450818/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-8/ok/na/-8okna9qfyroicvgoz-zenv7-si.png"><br><br>  ููุงู ุงููุซูุฑ ูู ุงูุฃุฏูุงุช ูุชุตุญูุญ ุฃุฎุทุงุก ุจุฑุงูุฌ kernel ู userpace ูู Linux.  ูุนุธููุง ูู ุชุฃุซูุฑ ูู ุงูุฃุฏุงุก ููุง ูููู ุชุดุบููู ุจุณูููุฉ ูู ุจูุฆุงุช ุงูุฅูุชุงุฌ.  ูุจู ุจุถุน ุณููุงุช ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชู ุชุทููุฑ</a> eBPF ุ ูุงูุฐู ูููุฑ ุงููุฏุฑุฉ ุนูู ุชุชุจุน kernel ููุณุงุญุฉ ุงููุณุชุฎุฏููู ูุน ุงูุฎูุงุถ ุงูุญูู ุ ุฏูู ุงูุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุชุฑุฌูุฉ ุงูุจุฑุงูุฌ ุฃู ุชุญููู ุงููุญุฏุงุช ุงูููุทูุฉ kernel. <br><br>  ููุฌุฏ ุงูุขู ุงููุซูุฑ ูู ุงูุฃุฏูุงุช ุงูุชู ุชุณุชุฎุฏู eBPF ููู ูุฐู ุงูููุงูุฉ ุ ุณูุดุฑุญ ููููุฉ ูุชุงุจุฉ ุฃุฏุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชูุตูู</a> ุงูุฎุงุตุฉ ุจู ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุจุฉ PythonBCC</a> .  ุชุณุชูุฏ ูุฐู ุงูููุงูุฉ ุฅูู ูุดููุฉ ุญููููุฉ ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ.  ุณูุชุนุฑู ุนูู ุญู ุงููุดููุฉ ููุจูู ููู ูููู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงููุณุฎุฉ ุงููุฎููุฉ ุงูููุฌูุฏุฉ ูู ุจุนุถ ุงูุญุงูุงุช. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  Ceph ุจุทูุก </h2><br>  ุชูุช ุฅุถุงูุฉ ูุธุงู ุฃุณุงุณู ุฌุฏูุฏ ุฅูู ูุชูุฉ ceph.  ุจุนุฏ ุชุฑุญูู ุจุนุถ ุงูุจูุงูุงุช ุฅูู ุงููุธุงู ุงูุฃุณุงุณู ุ ูุงู ุฒูู ุงููุตูู ูุทูุจุงุช ุงููุชุงุจุฉ ุฃุนูู ูู ุงูุฎูุงุฏู ุงูุฃุฎุฑู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uk/de/-l/ukde-lsu9sjqnmci1ix942xzgie.png"></div><br><br>  ูุญุชูู ูุฐุง ุงููุธุงู ุงูุฃุณุงุณู ุนูู ุฌูุงุฒ ุธุงูุฑู ุฌุฏูุฏ ููุชุฎุฒูู ุงููุคูุช - bcache ุ ูู ูุณุชุฎุฏูู ูู ูุฐู ุงููุฌููุนุฉ ูู ูุจู - ูููุงุฉ ุฌุฏูุฏุฉ - 4.15 ุ ูุงูุชู ูุง ุชุฒุงู ุบูุฑ ูุณุชุฎุฏูุฉ ูู ุฃู ููุงู ุขุฎุฑ ูู ูุฐู ุงููุฌููุนุฉ.  ูููู ุฃู ูููู ุฌุฐุฑ ุงููุดููุฉ ูู ุฃู ููุงู ุ ูุฐูู ุฏุนููุง ูููู ูุธุฑุฉ ุฃุนูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุญููู ูู ุงููุถูู </h3><br>  ุฏุนููุง ููุธุฑ ุฅูู ูุง ูุฌุฑู ุฏุงุฎู ุนูููุฉ ceph-osd.  ูุณุชุฎุฏู ุฃุฏุงุฉ ุงูุชุชุจุน ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">flamescope</a> ูู ุจูุงุก flamegraphs: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ch/5k/nn/ch5knn22cmukd1oldmcozpxe98i.png"></div><br><br>  ููุง ูุฑู ูู flamegraph ุ ูุถู <b>fdatasync ()</b> ุงููุซูุฑ ูู ุงูููุช ูู ุชูุฏูู bio ูู <b>ุฏุงูุฉ generic_make_request ()</b> .  ูุจุงูุชุงูู ุ ูุฅู ุฌุฐุฑ ูุดููุชูุง ูู ูู ููุงู ูุง ุฎุงุฑุฌ ุงูุฎูู ceph.  ูุฏ ุชููู ูุดููุฉ kernel ุฃู bcache ุฃู ูุฑุต.  ุฃุธูุฑ ุฅุฎุฑุงุฌ iostat ุฒูู ุงูุชูุงู ุนุงูู ูุฃุฌูุฒุฉ bcache. <br><br>  ุงูุชุดุงู ุขุฎุฑ ูุดุจูู ูู ุฃู ุงูุจุฑูุงูุฌ ุงูุฎูู systemd-udevd ูุณุชููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ  ุญูุงูู 20 ูช ุนูู ูุญุฏุงุช ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ูุชุนุฏุฏุฉ.  ูุฐุง ุณููู ุบุฑูุจ ุ ูุฐูู ุนูููุง ุฃู ูุนุฑู ูุง ุงูุฐู ูุญุฏุซ.  ูุธุฑูุง ูุฃู systemd-udevd ูุนูู ูุน uevents ุ ูุชุนูู ุนูููุง ุงุณุชุฎุฏุงู <b>ุดุงุดุฉ udevadm</b> ููุนุฑูุฉ ูุง ุฅุฐุง ูุงู ููุงู ุฃู uevents ูู ุงููุธุงู.  ุจุนุฏ ุงูุชุญูู ุ ุฑุฃููุง ุฃูู ุชู ุฅูุดุงุก ุงููุซูุฑ ูู ุฃุฏูุงุช ุงูุชุบููุฑ "ุงูุชุบููุฑ" ููู ุฌูุงุฒ ูุชูุฉ ูู ุงููุธุงู. <br><br>  ูุฐุง ุฃูุฑ ุบูุฑ ูุนุชุงุฏ ุ ูุฐูู ุณููุชุดู ุณุจุจ ุฅุฑุณุงู ูู ูุฐู ุงูุฅูุงูุงุช. <br><br>
<h3 style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ุฃุฏูุงุช BCC </h3><br>  ููุง ูุนูู ุจุงููุนู ุ ููุถู kernel (ู ceph daemon) ุงููุซูุฑ ูู ุงูููุช ูู ุฃุฏุงุก ูุธุงุฆู <b>generic_make_requst ()</b> .  ุฏุนูุง ูููุณ ุฒูู ุงููุตูู ุจุงุณุชุฎุฏุงู <b>funclatency</b> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฌููุนุฉ ุฃุฏูุงุช BCC</a> ุ ููุท ููุชุฃูุฏ ูู ุฃููุง ูุณูุฑ ุนูู ุงูุทุฑูู ุงูุตุญูุญ.  ุณูููู ุจุชุชุจุน ูุนุฑู PID ุงูุฎุงุต ุจู ceph (ูุณูุทุฉ -p) ูู ููุงุตู ุฒูููุฉ ูุฏุชูุง ุซุงููุฉ ูุงุญุฏุฉ (-i) ูุทุจุงุนุฉ ุงููููู ุจุงููููู ุซุงููุฉ (-m). <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/4c/cj/za/4ccjza8x8bq0vqkxfol2j5d9sva.png"></div><br><br>  ูุฐู ุงููุธููุฉ ุนุงุฏุฉ ูุง ุชุนูู ุจุณุฑุนุฉ ูุจูุฑุฉ.  ูู ูุง ุชูุนูู ูู ุฅุฑุณุงู ุงูุจููุฉ ุงูุญูููุฉ ุฅูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุจุฑูุงูุฌ ุชุดุบูู ุงูุฌูุงุฒ. <br><br>  <b>Bcache</b> ูู ุฌูุงุฒ ูุนูุฏ.  ูู ุงููุงูุน ุ ูุชููู ูู 3 ุฃุฌูุฒุฉ: ุฌูุงุฒ ุฏุนู ุ ููู ูุญุฑู ุฃูุฑุงุต ุซุงุจุช ุจุทูุก ูู ุญุงูุชูุง ุ  ุฌูุงุฒ ุชุฎุฒูู ูุคูุช ุ ููู ูุณู ูุญุฑู NVMe ุ  ูุฌูุงุฒ bcache ุงูุธุงูุฑู ุ ูุงูุฐู ูุณุชุฎุฏูู ุงูุชุทุจูู.  ูุญู ูุนูู ุฃู ุงูุชูุฏูู ุจุทูุก ุ ููู ูุฃู ุฌูุงุฒ  ูุฐุง ุดูุก ุณููุธุฑ ุฅููู ูุงุญููุง. <br><br>  ูู ุงูููุช ุงูุญุงูู ุ ูุนูู ุฃู uevents ุชุชุณุจุจ ูู ุญุฏูุซ ูุดููุงุช ูู cememons ูุนูููุง ุฃู ูุฌุฏ ุงูุจุฑูุงูุฌ ุงูุฐู ูุญูุฒ uevents. ููุณ ูู ุงูุณูู ุงูุนุซูุฑ ุนูู ุงูุฃุณุจุงุจ ุงูุชู ุชุคุฏู ุฅูู ุฅูุดุงุก uevents.  ูุญู ููุชุฑุถ ุฃูู ุจุฑูุงูุฌ ูุนูู ุจุดูู ุฏูุฑู ููุท.  ููุนุฑูุฉ ูุง ูุชู ุชูููุฐู ุนูู ุงููุธุงู ุ ูุณุชุฎุฏู <b>execsnoop</b> ูู ูุฌููุนุฉ ุฃุฏูุงุช BCC.  ูููููุง ุชุดุบููู ูุฅุนุงุฏุฉ ุชูุฌูู <b>stdout</b> ุฅูู ููู. <br><br>  ุนูู ุณุจูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">/usr/share/bcc/tools/execsnoop | tee ./execdump</code> </pre> <br>  ูู ูุนุทู ุงูุฅุฎุฑุงุฌ execsnoop ุงููุงูู ููุง ุ ูููู ุณูุณูุฉ ูุงุญุฏุฉ ูุซูุฑุฉ ููุงูุชูุงู ูุฌุฏูุง ุฃู ููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sh 1764905 5802 0 sudo arcconf getconfig 1 AD | grep Temperature | awk -F <span class="hljs-string"><span class="hljs-string">'[:/]'</span></span> <span class="hljs-string"><span class="hljs-string">'{print $2}'</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/^ \([0-9]*\) C.*/\1/'</span></span></code> </pre> <br>  ุงูุนููุฏ ุงูุซุงูุซ ูู PPID ุงูุนูููุฉ.  ููุฏ ูุญุตูุง ูุง ูุงู 5802 ูุฑุฃููุง ุฃูู ุฃุญุฏ ุฎููุท ุงููุฑุงูุจุฉ ุงูุฎููุฉ ูุฏููุง.  ุฅุฐุง ูุธุฑูุง ุฅูู ุฃุจุนุฏ ูู ุฐูู ูู ุชูููู ูุธุงู ุงููุฑุงูุจุฉ ุ ูุฌุฏูุง ูุนููุฉ ุฎุงุทุฆุฉ.  ูุชู ุงุณุชุฑุฏุงุฏ ุฏุฑุฌุฉ ุญุฑุงุฑุฉ HBA ูู 30 ุซุงููุฉ ุ ููู ูุซูุฑ ูู ุงูุฃุญูุงู.  ุจุนุฏ ุชุบููุฑ ุงููุงุตู ุงูุฒููู ููุชุญูู ุฅูู ูููุฉ ุฃูุซุฑ ููุงุกูุฉ ุ ุฑุฃููุง ุฃู ุงููููู ูุฏููุง ceph ูุชุทุงุจู ูุน ููุตุงุช ุฃุฎุฑู. <br><br>  ููููุง ูุง ุฒููุง ูุง ูุนุฑู ููุงุฐุง ูุงู ุฒูู ุงูุชูุงู bcache ูุฑุชูุนูุง.  ููุฏ ุฃูุดุฃูุง ููุตุฉ ุงุฎุชุจุงุฑ ุจููุณ ุงูุชูููู ูุญุงูููุง ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุดููุฉ ุจุงุณุชุฎุฏุงู fio ุนูู ุฌูุงุฒ bcache ุฃุซูุงุก ุชุดุบูู udev ูู ููุณ ุงูููุช ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ udevadm trigger. <br><br><h3 style=";text-align:right;direction:rtl">  ูุชุงุจุฉ ุงูุฃุฏูุงุช ุงููุณุชูุฏุฉ ุฅูู BCC </h3><br>  ูุง ุณููุนูู ููุง ูู ูุชุงุจุฉ ุฃุฏุงุฉ ุจุณูุทุฉ ุชุชุชุจุน ุฃุจุทุฃ ููุงููุงุช generic_make_request () ูุชุทุจุน ุงุณู ุงููุฑุต ุงูุฐู ุชู ุงุณุชุฏุนุงุก ุงููุธููุฉ ูู. <br><br>  ุงูุฎุทุฉ ุจุณูุทุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุณุฌูู <b>kprobe</b> ุนูู <b>generic_make_request ()</b> : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุญูุธ ุงุณู ุงููุฑุต ุงููุชุงุญ ูู ูุณูุทุฉ ุงููุธููุฉ </li><li style=";text-align:right;direction:rtl">  ุญูุธ ุงูุทุงุจุน ุงูุฒููู ุงูุญุงูู </li></ul></li><li style=";text-align:right;direction:rtl">  ุชุณุฌูู <b>kretprobe</b> ูู ุจูุงู ุงูุฅุฑุฌุงุน <b>generic_make_request ()</b> : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุฑุฏุงุฏ ุงูุทุงุจุน ุงูุฒููู ุงูุญุงูู </li><li style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงูุทูุงุจุน ุงูุฒูููุฉ ุงููุญููุธุฉ ุณุงุจูุง ูููุงุฑูุชูุง ูุน ุงูุญุงููุฉ </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ุงููุชูุฌุฉ ุฃุนูู ูู ุงูุนุชุจุฉ ุ ูุงุจุญุซ ุนู ุฃุณูุงุก ุงูุฃูุฑุงุต ุงููุญููุธุฉ ูุณุจููุง ููู ุจุทุจุงุนุชูุง ุนูู ุงูุฌูุงุฒ ุงูุทุฑูู ุจูุนูููุงุช ุฅุถุงููุฉ </li></ul></li></ul><br>  <b>Kprobes</b> ู <b>kretprobes</b> ุงุณุชุฎุฏุงู ููุงุท ุงูุชููู ูุชุบููุฑ ุฑูุฒ ุฏุงูุฉ ูู ููุช ุงูุชุดุบูู.  ููููู ุงูุนุซูุฑ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ููุฐูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู</a> ุฌูุฏ ุญูู ูุฐุง ุงูููุถูุน.  ุฅุฐุง ุฃูููุช ูุธุฑุฉ ุนูู ุงูููุฏ ุงูุฎุงุต <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฃุฏูุงุช BCC</a> ุงููุฎุชููุฉ ุ ูุณุชุฑู ุฃู ูุฏููู ุฌููุนูุง ุจููุฉ ูุชุทุงุจูุฉ.  ุณูููู ุจุชุฎุทู ุชุญููู ุงูุญุฌุฌ ูุงูุชุฑููุฒ ุนูู ุจุฑูุงูุฌ BPF ููุณู. <br><br>  ุณูุชู ุชุนุฑูู ูุต ุจุฑูุงูุฌูุง ูู ุจูุซูู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">bpf_text = โโโ <span class="hljs-comment"><span class="hljs-comment"># Here will be the bpf program code โโโ</span></span></code> </pre> <br>  ุชุณุชุฎุฏู ุจุฑุงูุฌ BPF <a href="">hashmaps</a> ููุดุงุฑูุฉ ุงูุจูุงูุงุช ุจูู ุงููุธุงุฆู ุงููุฎุชููุฉ.  ุณูุณุชุฎุฏู PID ููููู ุฃุณุงุณู ููุนุฑูู ุฐุงุชู ููููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">struct data_t { u64 pid; u64 ts; char comm[TASK_COMM_LEN]; u64 lat; char disk[DISK_NAME_LEN]; }; BPF_HASH(p, u64, struct data_t); BPF_PERF_OUTPUT(events);</code> </pre> <br>  ูุญู ููุง ูุณุฌู hashmap ูุณูู <b>p</b> <b>ุจููุน</b> ููุชุงุญ <b>u64</b> ูููุน ูููุฉ <b>data_t</b> .  ูููู ุงููุตูู ุฅูู ูุฐู ุงูุฎุฑูุทุฉ ูู ุณูุงู ุจุฑูุงูุฌ BPF ุงูุฎุงุต ุจูุง.  <b>ูุณุฌู</b> ุงููุงูุฑู <b>BPF_PERF_OUTPUT</b> ุฎุฑูุทุฉ ุฃุฎุฑู ุชุณูู <b>ุงูุฃุญุฏุงุซ</b> ุ ูุงูุชู ูุชู ุงุณุชุฎุฏุงููุง <a href="">ูุฏูุน ุงูุจูุงูุงุช</a> ุฅูู ูุณุงุญุฉ ุงููุณุชุฎุฏููู. <br><br>  ุนูุฏ ููุงุณ ุฒูู ุงููุตูู ุจูู ุงุณุชุฏุนุงุก ุงููุธููุฉ ูุฑุฌูุนูุง ุฃู ุจูู ุงุณุชุฏุนุงุก ุฏุงูุฉ ูุขุฎุฑ ุ ูุฌุจ ุฃู ุชุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ุงูุชู ููุช ุจุญูุธูุง ูุงููุตูู ุฅูููุง ุชุชุนูู ูู ููุณ ุงูุณูุงู.  ุจูุนูู ุขุฎุฑ ุ ูุฌุจ ุฃู ุชููู ุนูู ุฏุฑุงูุฉ ุจุฃู ุนูููุงุช ุฅุนุฏุงู ููุงุฒูุฉ ุฃุฎุฑู ูููุณ ุงููุธููุฉ.  ูู ุงููููู ุชุชุจุน ุฒูู ุงูุงูุชูุงู ุจูู ุงุณุชุฏุนุงุก ุฏุงูุฉ ุฅุญุฏู ุงูุนูููุงุช ูุฅุฑุฌุงุน ููุณ ุงููุธููุฉ ูู ุนูููุฉ ุฃุฎุฑู ุ ููู ูุฐุง ูุง ูุณุงุนุฏูุง.  ูุซุงู ุฌูุฏ ุนูู ุฐูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฏุงุฉ biolatency</a> ุญูุซ ูุชู ุงุณุชุฎุฏุงู ูุคุดุฑ <b>ุจููุฉ ุงูุทูุจ</b> ูููุชุงุญ ูุงุดูุงุจ. <br><br>  ุจุนุฏ ุฐูู ุ ูุชุนูู ุนูููุง ูุชุงุจุฉ ุฑูุฒ ุณูุชู ุชูููุฐู ุนูู ุงูููุงููุงุช ุงููุธูููุฉ ุนุจุฑ ุขููุฉ kprobe: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">void start(struct pt_regs *ctx, struct bio *bio) { u64 pid = bpf_get_current_pid_tgid(); struct data_t data = {}; u64 ts = bpf_ktime_get_ns(); data.pid = pid; data.ts = ts; bpf_probe_read_str(&amp;data.disk, sizeof(data.disk), (void*)bio-&gt;bi_disk-&gt;disk_name); p.update(&amp;pid, &amp;data); }</code> </pre> <br>  ูุฏููุง ููุง <a href="">ุงููุณูุทุฉ generic_make_request ()</a> ุงูุฃููู ุจุงุนุชุจุงุฑูุง ุงููุณูุทุฉ ุงูุซุงููุฉ <a href="">ููุธุงุฆููุง</a> .  ุซู ูุญุตู ุนูู PID ูุงูุทุงุจุน ุงูุฒููู ุงูุญุงูู <b>ุจุงููุงูู ุซุงููุฉ ูููุชุจู ุนูู ุจูุงูุงุช data_t ุงููููููุฉ</b> ุงููุฎุตุตุฉ ุญุฏูุซูุง.  ูุญุตู ุนูู ุงุณู ุงููุฑุต ูู ุงููููู ุงูุญููู ุ ูุงูุฐู ูุชู ุชูุฑูุฑู ุฅูู <b>generic_make_request ()</b> ุ <b>ููุญูุธู</b> ูู ุจูุงูุงุชูุง.  ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ ูู ุฅุถุงูุฉ ุฅุฏุฎุงู ุฅูู hashmap ุงูุชู ูุตููุงูุง ุณุงุจููุง. <br><br>  ุณูุชู ุชูููุฐ ูุฐู ุงููุธููุฉ ุนูุฏ ุฅุฑุฌุงุน <b>generic_make_request ()</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">void stop(struct pt_regs *ctx) { u64 pid = bpf_get_current_pid_tgid(); u64 ts = bpf_ktime_get_ns(); struct data_t* data = p.lookup(&amp;pid); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data != <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; data-&gt;ts &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { bpf_get_current_comm(&amp;data-&gt;comm, sizeof(data-&gt;comm)); data-&gt;lat = (ts - data-&gt;ts)/<span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data-&gt;lat &gt; MIN_US) { FACTOR data-&gt;pid &gt;&gt;= <span class="hljs-number"><span class="hljs-number">32</span></span>; events.perf_submit(ctx, data, sizeof(struct data_t)); } p.delete(&amp;pid); } }</code> </pre> <br>  ูุญุตู ุนูู PID ูุงูุทุงุจุน ุงูุฒููู ูู ุงูุฅุฎุฑุงุฌ ุงูุณุงุจู ููุจุญุซ ุนู hashmap ูููููุฉ ุญูุซ <b>key == PID ุงูุญุงูู</b> .  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนููู ุ ูุณูุญุตู ุนูู ุงุณู ุงูุนูููุฉ ุงูุฌุงุฑูุฉ ููุถูููุง ุฅูู ุจููุฉ <b>ุงูุจูุงูุงุช</b> .  ูุง ูููู ุจู ูุน <b>ุงูุจูุงูุงุช&gt; ูุนุฑู ุงูููุชุฌ</b> ููุง ูููุญูุง ูุนุฑู ูุฌููุนุฉ ุณูุงุณู ุงูุฑุณุงุฆู.  ุชุฑุฌุน <a href="">ุงูุฏุงูุฉ bpf_get_current_pid_tgid () ุงูุชู</a> ูุงูุช ุชุณูู ุณุงุจููุง ูุคุดุฑ ุชุฑุงุจุท GID ู PID ููุนูููุฉ ุจููุณ ูููุฉ 64 ุจุช. <br><br>  ูุญู ูุณูุง ููุชููู ุจูุนุฑู ูู ุณูุณูุฉ ุฑุณุงุฆู ุ ููููุง ูุฑูุฏ ุฃู ูุนุฑู ูุนุฑู ุงูููุชุฌ ุงูุฎุงุต ุจุงูููุถูุน ุงูุฑุฆูุณู.  ุจุนุฏ ุงูุชุญูู ูู ุฃู ุฒูู ุงููุตูู ุฃุนูู ูู ุงูุนุชุจุฉ ุ ูุฑุณู ุจููุฉ <b>ุงูุจูุงูุงุช ุงูุฎุงุตุฉ</b> ุจูุง ุฅูู ูุณุงุญุฉ ุงููุณุชุฎุฏููู ุนุจุฑ ุฎุฑูุทุฉ <b>ุงูุฃุญุฏุงุซ</b> ุ ุซู ูููู ุจุญุฐู ุฅุฏุฎุงู hashmap ูู ุงูููุงูุฉ. <br><br>  ูู ุจุฑูุงูุฌูุง ุงููุตู ุงูุซุนุจุงู ุ ูุชุนูู ุนูููุง ุงุณุชุจุฏุงู <b>MIN_US</b> ู <b>FACTOR</b> ููููุง ููุนุชุจุฉ ุงูุชู ูุฑูุฏูุง ููุญุฏุฉ ุงูููุช ุงูุชู ูุฑูุฏ ุฃู ูุฑุงูุง ูู ุงููุชูุฌุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">bpf_text = bpf_text.replace(<span class="hljs-string"><span class="hljs-string">'MIN_US'</span></span>,str(min_usec)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> args.milliseconds: bpf_text = bpf_text.replace(<span class="hljs-string"><span class="hljs-string">'FACTOR'</span></span>,<span class="hljs-string"><span class="hljs-string">'data-&gt;lat /= 1000;'</span></span>) label = <span class="hljs-string"><span class="hljs-string">"msec"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: bpf_text = bpf_text.replace(<span class="hljs-string"><span class="hljs-string">'FACTOR'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>) label = <span class="hljs-string"><span class="hljs-string">"usec"</span></span></code> </pre><br>  ุซู ูุชุนูู ุนูููุง ุฅุนุฏุงุฏ ุจุฑูุงูุฌ BPF ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุฑู BPF ()</a> ูุชุณุฌูู ุงูุชุญูููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">b = BPF(text=bpf_text) b.attach_kprobe(event=<span class="hljs-string"><span class="hljs-string">"generic_make_request"</span></span>,fn_name=<span class="hljs-string"><span class="hljs-string">"start"</span></span>) b.attach_kretprobe(event=<span class="hljs-string"><span class="hljs-string">"generic_make_request"</span></span>,fn_name=<span class="hljs-string"><span class="hljs-string">"stop"</span></span>)</code> </pre><br>  ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุชุญุฏูุฏ ููุณ ุจููุฉ <b>struct data_t</b> ูู ุจุฑูุงูุฌูุง ุงููุตู ููุฑุงุกุฉ ุงูุจูุงูุงุช ูู ุจุฑูุงูุฌ BPF: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">TASK_COMM_LEN = <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-comment"><span class="hljs-comment"># linux/sched.h DISK_NAME_LEN = 32 # linux/genhd.h class Data(ct.Structure): _fields_ = [("pid", ct.c_ulonglong), ("ts", ct.c_ulonglong), ("comm", ct.c_char * TASK_COMM_LEN), ("lat", ct.c_ulonglong), ("disk",ct.c_char * DISK_NAME_LEN)]</span></span></code> </pre> <br>  ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ ูู ุทุจุงุนุฉ ุงูุจูุงูุงุช ุงูุชู ูุฑูุฏูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print_event</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cpu, data, size)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> start event = ct.cast(data, ct.POINTER(Data)).contents <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> start == <span class="hljs-number"><span class="hljs-number">0</span></span>: start = event.ts time_s = (float(event.ts - start)) / <span class="hljs-number"><span class="hljs-number">1000000000</span></span> print(<span class="hljs-string"><span class="hljs-string">"%-18.9f %-16s %-6d %-1s %s %s"</span></span> % (time_s, event.comm, event.pid, event.lat, label, event.disk)) b[<span class="hljs-string"><span class="hljs-string">"events"</span></span>].open_perf_buffer(print_event) <span class="hljs-comment"><span class="hljs-comment"># format output start = 0 while 1: try: b.perf_buffer_poll() except KeyboardInterrupt: exit()</span></span></code> </pre><br>  ุงููุต ุงููุงูู ูุชุงุญ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุซุจ</a> .  ูููู ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูุชุดุบูู ุฃุญุฏุงุซ udev ุจูููุง ููุชุจ fio ุฅูู ุฌูุงุฒ bcache: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/tk/ly/vf/tklyvf6i8rws0xu4gy3jothbxbi.png"></div><br><br>  ุงููุฌุงุญ!  ุงูุขู ูุฑู ุฃู ูุง ุจุฏุง ููุฃูู ุฒูู ุงูุชูุงู ุนุงูู ู bcache ูู ุญููุง ุฒูู ุงูุชูุงู ุนุงู ูุฌูุงุฒ ุงููุณุฎ <b>ุงูุงุญุชูุงุทู</b> ุงูุฎุงุต ุจู. <br><br><h3 style=";text-align:right;direction:rtl">  ุญูุฑ ูู ุงูููุงุฉ </h3><br>  ูุง ุงูุฐู ูุณุชูุฑ ุนูุฏ ุชูุฏูู ุงูุทูุจุงุชุ  ูุฑู ุญุฏูุซ ุทูุฑุฉ ุงุณุชุชุงุฑ ูุจู ุจุฏุก ุทูุจ ุงูุทูุจ.  ูููู ุงูุชุญูู ูู ุฐูู ุจุณูููุฉ ุนู ุทุฑูู ุชุดุบูู iostat ุฃุซูุงุก ุงููุดููุฉ ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฑูุงูุฌ ุงููุตู BCC ููุบุฉ biolatency</a> ุ ูุงูุชู ุชุณุชูุฏ ุฅูู ุจุฏุงูุฉ ุทูุจ ุงููุญุงุณุจุฉ ุ ูุฐูู ูู ุชูุธูุฑ ุฃู ุฃุฏุงุฉ ูุดููุฉ ุงููุฑุต. <br><br>  ุฅุฐุง ุฃููููุง ูุธุฑุฉ ุนูู <b>generic_make_request ()</b> ุ ูุฑู ุฃู ููุงู ูุธููุชูู ุชุนููุงู ูุจู ุจุฏุก ุงููุญุงุณุจุฉ.  ุงูุฃูู ูู <b>generic_make_request_checks ()</b> ุ ููู ุฎููู ุงููุฒู ููุชุญูู ูู ุงูุญูููุฉ ููููุง ูุฅุนุฏุงุฏุงุช ุงูุฌูุงุฒ ุ ุฅูุฎ.  ูุงูุซุงูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">blk_queue_enter ()</a> ุ ูุงูุฐู ูุญุชูู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุณุชุฏุนุงุก wait_event_interruptible ()</a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">ret = wait_event_interruptible(q-&gt;mq_freeze_wq, (atomic_read(&amp;q-&gt;mq_freeze_depth) == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; (preempt || !blk_queue_preempt_only(q))) || blk_queue_dying(q));</code> </pre><br>  ููุง ุชูุชุธุฑ ุงูููุงุฉ ุญุชู ูุชู ุชุฌููุฏ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ.  ุฏุนูุง ูููุณ ูููู blk_queue_enter (): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># /usr/share/bcc/tools/funclatency blk_queue_enter -i 1 -m Tracing 1 functions for "blk_queue_enter"... Hit Ctrl-C to end. msecs : count distribution 0 -&gt; 1 : 341 |****************************************| msecs : count distribution 0 -&gt; 1 : 316 |****************************************| msecs : count distribution 0 -&gt; 1 : 255 |****************************************| 2 -&gt; 3 : 0 | | 4 -&gt; 7 : 0 | | 8 -&gt; 15 : 1 | |</span></span></code> </pre><br>  ูุจุฏู ุฃููุง ูุฑูุจูู.  ุงูุฏุงูุงุช ุงููุณุชุฎุฏูุฉ ูุชุฌููุฏ / ุฅูุบุงุก ุชุฌููุฏ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">blk_mq_freeze_queue</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">blk_mq_unfreeze_queue</a> .  ูุชู ุงุณุชุฎุฏุงููุง ูุชุบููุฑ ุฅุนุฏุงุฏุงุช ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูุงูุชู ูุฏ ุชุคุซุฑ ุนูู ุทูุจุงุช io ุงูููุฌูุฏุฉ ุญุงูููุง.  ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก <b>blk_mq_freeze_queue ()</b> ุ ูุชู ุฒูุงุฏุฉ <b>q-&gt; mq_freeze_depth</b> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">blk_freeze_queue_start ()</a> .  ุจุนุฏ ุฐูู ุ ุชูุชุธุฑ ุงูููุงุฉ ูุชููู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุงุฑุบุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">blk_mq_freeze_queue_wait ()</a> . <br><br>  ููุช ุงูุงูุชุธุงุฑ ูุฐุง ูุณุงูู ุฒูู ุงูุชูุงู ุงููุฑุต ุ ูุฃู ุนูู kernel ุงูุชุธุงุฑ ุงูุชูุงุก ุฌููุน ุนูููุงุช io.  ุนูุฏูุง ุชููู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุงุฑุบุฉ ุ ูููู ุฅุฌุฑุงุก ุชุบููุฑุงุช.  ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ ูู ุงุณุชุฏุนุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">blk_mq_unfreeze_queue ()</a> ุ ููุง ูููู ุนุฏุงุฏ <b>freeze_depth</b> . <br><br>  ุงูุขู ูุญู ูุนุฑู ูุง ูููู ูุฅุตูุงุญ ุงููุดููุฉ.  ูุบูุฑ ุงูุฃูุฑ ุงููุดุบู udevadm ุฅุนุฏุงุฏุงุช ุฃุฌูุฒุฉ ุงููุชูุฉ.  ูุฐู ุงูุฅุนุฏุงุฏุงุช ููุตููุฉ ูู ููุงุนุฏ udev.  ูููููุง ูุนุฑูุฉ ุงูุฅุนุฏุงุฏุงุช ุงูุชู ุชุฌูุฏ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุนู ุทุฑูู ุชุบููุฑูุง ุนุจุฑ sysfs ุฃู ูู ุฎูุงู ุงููุธุฑ ูู ุดูุฑุฉ ูุตุฏุฑ kernel.  ุจุฏูุงู ูู ุฐูู ุ ูููููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุณุชุฏุนุงุก ุงูุชุชุจุน</a> ูู ูุฌููุนุฉ ุฃุฏูุงุช BCC ูุทุจุงุนุฉ kernel <b>ููููุฉ</b> ุงููุณุชุฎุฏู ููู ููุงููุฉ <b>blk_freeze_queue</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># /usr/share/bcc/tools/trace blk_freeze_queue -K -U PID TID COMM FUNC 3809642 3809642 systemd-udevd blk_freeze_queue blk_freeze_queue+0x1 [kernel] elevator_switch+0x29 [kernel] elv_iosched_store+0x197 [kernel] queue_attr_store+0x5c [kernel] sysfs_kf_write+0x3c [kernel] kernfs_fop_write+0x125 [kernel] __vfs_write+0x1b [kernel] vfs_write+0xb8 [kernel] sys_write+0x55 [kernel] do_syscall_64+0x73 [kernel] entry_SYSCALL_64_after_hwframe+0x3d [kernel] __write_nocancel+0x7 [libc-2.23.so] [unknown] 3809631 3809631 systemd-udevd blk_freeze_queue blk_freeze_queue+0x1 [kernel] queue_requests_store+0xb6 [kernel] queue_attr_store+0x5c [kernel] sysfs_kf_write+0x3c [kernel] kernfs_fop_write+0x125 [kernel] __vfs_write+0x1b [kernel] vfs_write+0xb8 [kernel] sys_write+0x55 [kernel] do_syscall_64+0x73 [kernel] entry_SYSCALL_64_after_hwframe+0x3d [kernel] __write_nocancel+0x7 [libc-2.23.so] [unknown]</span></span></code> </pre> <br>  ูุง ุชุชุบูุฑ ููุงุนุฏ Udev ุจุดูู ูุชูุฑุฑ ุ ูุฐุง ุญุชู ุชุนููู ููู ููุฌูุฏุฉ ุจุงููุนู ููุนููุงุช ูุนููุฉ ูุคุฏู ุฅูู ุงุฑุชูุงุน ูู ุฒูู ุงูุชูุงู ุงูุชุทุจูู.  ุจุงูุทุจุน ุฅูุดุงุก ุฃุญุฏุงุซ udev ุนูุฏูุง ูุง ุชููู ููุงู ุฃู ุชุบููุฑุงุช ูู ุชูููู ุงูุฌูุงุฒ (ูุง ููุฌุฏ ุฃู ุฌูุงุฒ ูุชุตู ุฃู ูููุตู) ูุง ูุนุฏ ููุงุฑุณุฉ ุฌูุฏุฉ.  ููุน ุฐูู ุ ูููููุง ููุน ุงูููุงุฉ ูู ุชุฌููุฏ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฅุฐุง ูู ููู ููุงู ุณุจุจ ููููุงู ุจุฐูู.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุซูุงุซ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุฑุชูุงุจ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุตุบูุฑ</a> ุญู ุงููุดููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br>  eBPF ูู ุฃุฏุงุฉ ูุฑูุฉ ููููุฉ ููุบุงูุฉ.  ูู ูุฐู ุงูููุงูุฉ ุ ูุธุฑูุง ุฅูู ุญุงูุฉ ูุงุญุฏุฉ ููุท ูุฃุธูุฑูุง ููููุงู ูู ูุฏุฑุชูุง.  ุฅุฐุง ููุช ููุชููุง ุจุชุทููุฑ ุงูุฃุฏูุงุช ุงููุณุชูุฏุฉ ุฅูู BCC ุ ููุฌุจ ุฅููุงุก ูุธุฑุฉ ุนูู <a href="">ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุงูุฑุณูู</a> ุงูุฐู ูุตู ููุงูููู ุงูุฃุณุงุณูุฉ. <br><br>  ููุงู ุฃูุถูุง ุฃุฏูุงุช ุฃุฎุฑู ูุซูุฑุฉ ููุงูุชูุงู ุชุณุชูุฏ ุฅูู eBPF ูุชุงุญุฉ ููุชูุตูู ูุงูุชุตุญูุญ.  ุฃุญุฏููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">bpftrace</a> ุ ูุงูุฐู ูุชูุญ ูู ูุชุงุจุฉ ุนูุงุตุฑ ูุนุงูุฉ ูุจุฑุงูุฌ ุตุบูุฑุฉ ุจูุบุฉ ุชุดุจู ุงูููุงุช.  ูุงูุขุฎุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ebpf_exporter</a> ุ ูุงูุฐู ููููู ุฌูุน ููุงููุณ ุนุงููุฉ ุงูุฏูุฉ ููุฎูุถุฉ ุงููุณุชูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฎุงุฏู prometheus</a> ุงูุฎุงุต ุจู ูุน ุฅููุงูุงุชู ุงูุฑุงุฆุนุฉ ูุชูุจููู. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar450818/">https://habr.com/ru/post/ar450818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar450806/index.html">ุนูุฏูุง ูุณุฑุน ูุชุบูุฑ ุงูุจูุฆุฉ ุงูุนูููุฉ ุจูุณุจุฉ 40 ูุฑุฉ</a></li>
<li><a href="../ar450810/index.html">ุฃูู 7 ุทุฑู ููุชุญูู ุจุณุฑุนุฉ ูู ููุงุกุงุช ูุชุฎุตุตู ุชูููููุฌูุง ุงููุนูููุงุช ูุจู ุงูููุงุจูุฉ</a></li>
<li><a href="../ar450812/index.html">PSR-14 - ุงูุญุฏุซ ุงูุฑุฆูุณู ูู PHP</a></li>
<li><a href="../ar450814/index.html">ููู ูุนูู BGP</a></li>
<li><a href="../ar450816/index.html">ุฑุคูุณ HTTP ูููุทูุฑ ุงููุณุคูู</a></li>
<li><a href="../ar450820/index.html">ูุฌูุฉ ุจุฑูุงูุฌ FrontendConf: ุงูุฃุทุฑ ูุงูุขูุงู ูุงูุชุฌุฑุจุฉ ุงูุนุงูููุฉ ููููุฉ ุงููุคุชูุฑ</a></li>
<li><a href="../ar450822/index.html">ุงุฎุชูุงุก ุงูุฃุทุฑ</a></li>
<li><a href="../ar450824/index.html">ุญุงูุฉ ุงููุบูู</a></li>
<li><a href="../ar450826/index.html">ููููุฉ ุงูุชุญุฏุซ ูุน ูุชุญูู ูู JS</a></li>
<li><a href="../ar450828/index.html">ุนูุฏูุง ุชุบูู ุงููุฏููุฉ ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>