<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚óæÔ∏è üóÑÔ∏è ü§≥üèª Cryptographie en langage simple: nous analysons le cryptage sym√©trique et asym√©trique en utilisant l'exemple de l'intrigue Star Wars (Mise √† jour) üö∂üèΩ ‚ö∞Ô∏è üêÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous les lecteurs de Habr! Il n'y a pas si longtemps, j'ai d√©cid√© de m'occuper des algorithmes de chiffrement et des principes de la signatu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cryptographie en langage simple: nous analysons le cryptage sym√©trique et asym√©trique en utilisant l'exemple de l'intrigue Star Wars (Mise √† jour)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452042/"> Bonjour √† tous les lecteurs de Habr!  Il n'y a pas si longtemps, j'ai d√©cid√© de m'occuper des algorithmes de chiffrement et des principes de la signature √©lectronique.  Le sujet, je pense, est int√©ressant et pertinent.  En train d'√©tudier, j'ai essay√© plusieurs biblioth√®ques, mais la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PyCrypto</a> est la plus pratique de mon point de vue.  Elle a une excellente documentation, accompagn√©e d'exemples. <br><br><img src="https://habrastorage.org/webt/66/he/oz/66heoz7zb5m8gxup9igsegwjlog.png" alt="image"><br><br>  <b>Apr√®s avoir lu le mat√©riel, vous apprendrez les points suivants:</b> <br><br><ol><li>  Qu'est-ce que le chiffrement; </li><li>  Quelle est la diff√©rence entre un chiffrement sym√©trique et asym√©trique; </li><li>  Dans ce cas, il est plus efficace d'utiliser sym√©trique et dans quel chiffrement asym√©trique; </li><li>  Qu'est-ce qu'un hachage de donn√©es et pourquoi est-il utilis√© dans le chiffrement? </li></ol><br>  La pertinence du sujet est en constante augmentation.  L'utilisation de la cryptographie ne se limite pas depuis longtemps au cryptage des informations.  Sous une forme ou une autre, nous utilisons tous les jours des algorithmes de cryptage lors de la visite des sites via le protocole HTTPS, lors des achats par carte bancaire et lors de la communication via les messageries instantan√©es.  Au cours des derni√®res ann√©es, les technologies de la cha√Æne de blocs, √©galement bas√©es sur la cryptographie, ont attir√© une large attention. <br><br>  Le but de cet article est d'initier le lecteur aux algorithmes de chiffrement de base.  Lors de la r√©daction d'un article, j'ai essay√© d'accorder autant d'attention que possible √† la question de l'application pratique.  Pour la programmation, Python 3.6 a √©t√© utilis√©.  Lors de l'√©criture du code, j'ai essay√© de le diviser en parties distinctes et de commenter tous les points cl√©s. <br><a name="habracut"></a><br>  Dans cet article, je n'ai pas analys√© la signature num√©rique, mais apr√®s avoir compris le cryptage asym√©trique, le sens de cette technologie deviendra clair. <br><br><h3>  Terrain </h3><br>  Voyons mentalement dans l'univers de Star Wars avant les √©v√©nements de l'√©pisode 6, lorsque les forces de r√©sistance prennent conscience du d√©but de la construction d'une nouvelle √©toile de la mort.  Le commandement pr√©voit d'introduire un groupe de renseignement sous le couvert de constructeurs.  L'op√©ration est tr√®s dangereuse, la communication avec le si√®ge sera difficile.  En cas de situation d'urgence, chaque membre du groupe peut envoyer et recevoir des messages du si√®ge √† une fr√©quence non prot√©g√©e. <br><br>  Le but du groupe de reconnaissance est toute donn√©e pouvant √©clairer la configuration, les armes et le but de la future station.  Pour stocker les donn√©es, il est pr√©vu de d√©velopper des √©quipements et logiciels sp√©ciaux. <br><br>  <b>Le si√®ge a approuv√© deux options pour cette op√©ration:</b> <br><br>  Plan A - Retour d'agents avec des forces rebelles donn√©es; <br>  Plan B - transmission √† distance des plans de l'√©toile de la mort elle-m√™me en utilisant l'√©quipement de la station.  <i>Le transfert d'informations sera rapide, mais apr√®s le transfert, l'agent est le plus susceptible d'√™tre calcul√© et captur√©.</i> <br><br><div class="spoiler">  <b class="spoiler_title">Sch√©ma</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/cv/xz/or/cvxzormscazwyzscn90hvzrdmqq.png" alt="image"><br></div></div><br>  Vous √™tes programmeur dans une √©quipe responsable du d√©veloppement logiciel. <br><br>  <b>Lors de la planification d'une op√©ration, plusieurs sc√©narios n√©gatifs possibles sont pris en compte:</b> <br><br><ul><li>  L'ennemi va intercepter le signal, comprendre son contenu sur la planification de l'attaque et rapprocher l'objet des forces fid√®les √† l'Empire.  Dans ce cas, les pertes parmi la r√©sistance seront plus importantes; </li><li>  L'un des espions sera captur√© et r√©v√©lera au cours de l'interrogatoire le plan d'op√©ration, ce qui peut conduire √† la compromission des cl√©s de chiffrement (nous en parlerons plus loin); </li><li>  Un espion avec des donn√©es t√©l√©charg√©es peut √™tre intercept√© par les forces imp√©riales, qui apporteront des modifications au contenu, mal informant la r√©sistance sur les faiblesses de la station.  Dans ce cas, lors de l'attaque, la flotte rebelle sera envoy√©e dans une fausse direction et progressivement d√©truite; </li></ul><br>  <b>√Ä partir de ces sc√©narios, les t√¢ches sont formul√©es:</b> <br><br><ol><li>  Le contenu doit √™tre crypt√© en toute s√©curit√© et prot√©g√© contre les modifications; </li><li>  En cas de perte de cl√©s de chiffrement ou de leur compromission, il devrait √™tre possible d'obtenir de nouvelles cl√©s de chiffrement √† distance √† une fr√©quence pouvant √™tre exploit√©e par l'adversaire. </li></ol><br><h4>  Cryptage des informations </h4><br>  R√©solvons le probl√®me du cryptage des informations: <br><br>  Une cl√© de cryptage est utilis√©e pour crypter et d√©crypter des informations.  C'est la cl√© qui rend le chiffrement r√©versible.  Chaque agent recevra une cl√© de cryptage.  Apr√®s avoir t√©l√©charg√© les donn√©es, l'agent les chiffrera et les enverra au si√®ge de la r√©sistance. <br><br><div class="spoiler">  <b class="spoiler_title">Description du principe de cryptage</b> <div class="spoiler_text">  La m√©thode dans laquelle le message est chiffr√© et d√©chiffr√© √† l'aide d'une seule cl√© est appel√©e <i>chiffrement sym√©trique</i> . <br><br><img src="https://habrastorage.org/webt/or/pn/ar/orpnarkw6jyoz-vdtqwwf7ap4vi.png" alt="image"><br><br>  Le point faible du cryptage sym√©trique est la cl√© de cryptage, ou plut√¥t sa remise au destinataire.  Si la cl√© est compromise lors de la remise, un tiers peut facilement d√©coder le message.  La force du chiffrement sym√©trique est sa vitesse, qui permet de coder de grandes quantit√©s de donn√©es. <br><br>  <i>Le chiffrement asym√©trique</i> utilise deux cl√©s connect√©es l'une √† l'autre: publique et priv√©e. <br><br><img src="https://habrastorage.org/webt/vg/bo/i3/vgboi3dy5tbj3tbta36ul-ybdau.png" alt="image"><br><br>  <b>Le m√©canisme d'action est le suivant:</b> <br><br><ol><li>  le destinataire envoie la cl√© OUVERTE √† l'exp√©diteur; </li><li>  l'exp√©diteur code le message √† l'aide de la cl√© publique re√ßue.  Dans le m√™me temps, le message ne peut d√©sormais √™tre d√©cod√© qu'avec la cl√© priv√©e; </li><li>  √† la r√©ception du message crypt√©, le destinataire le d√©code avec la cl√© CLOSED (qui a √©t√© g√©n√©r√©e en tandem avec le public). </li></ol><br></div></div><br>  Commen√ßons par la programmation!  Pour d√©velopper le logiciel n√©cessaire, nous utiliserons la biblioth√®que Python appel√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pycrypto</a> .  Elle poss√®de une excellente documentation et pr√©sente tous les algorithmes de chiffrement courants. <br><br>  Tout d'abord, nous allons d√©velopper une fonctionnalit√© de chiffrement sym√©trique appel√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Advanced Encryption Standard (AES)</a> .  Il s'agit de l'un des algorithmes de chiffrement sym√©trique les plus courants. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Crypto.Cipher <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AES <span class="hljs-comment"><span class="hljs-comment">#   from Crypto.Hash import SHA256 #        SHA. from Crypto.Hash import MD5 #            32  from Crypto import Random def transform_password(password_str): """Transform the password string into 32 bit MD5 hash :param password_str: &lt;str&gt; password in plain text; :return: &lt;str&gt; Transformed password fixed length """ h = MD5.new() h.update(key.encode()) return h.hexdigest() def symmetric_encrypt(message, key, verbose = True): """Encripts the message using symmetric AES algorythm. :param message: &lt;str&gt; Message for encryption; :param key: &lt;object&gt; symmetric key; :return: &lt;object&gt; Message encrypted with key """ key_MD5 = transform_password(key) #      32  message_hash = SHA256.new(message.encode()) message_with_hash = message.encode() + message_hash.hexdigest().encode() #     .      iv = Random.new().read(AES.block_size) cipher = AES.new(key_MD5, AES.MODE_CFB, iv) #     . AES.MODE_CFB -   ,      iv. https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.blockalgo-module.html#MODE_CFB encrypted_message = iv + cipher.encrypt(message_with_hash) #       .  ,       ,       . if verbose: print(f'Message was encrypted into: {encrypted_message.hex()}') return encrypted_message def symmetric_decrypt(encr_message, key): """Decripts the message using private_key and check it's hash :param encrypted_message: &lt;object&gt; Encrypted message :param key: &lt;object&gt; symmetric key; :return: &lt;object&gt; Message decripted with key """ key_MD5 = transform_password(key) #   ,      bsize = AES.block_size dsize = SHA256.digest_size*2 iv = Random.new().read(bsize) cipher = AES.new(key_MD5, AES.MODE_CFB, iv) decrypted_message_with_hesh = cipher.decrypt(encr_message)[bsize:] #     ,      decrypted_message = decrypted_message_with_hesh[:-dsize] #   ,      digest = SHA256.new(decrypted_message).hexdigest() #    .     ,     . if digest==decrypted_message_with_hesh[-dsize:].decode(): #      ,      ,   print(f"Success!\nEncrypted hash is {decrypted_message_with_hesh[-dsize:].decode()}\nDecrypted hash is {digest}") return decrypted_message.decode() else: print(f"Encryption was not correct: the hash of decripted message doesn't match with encrypted hash\nEncrypted hash is {decrypted_message_with_hesh[-dsize:]}\nDecrypted hash is {digest}")</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">V√©rifions les performances du code √† l'aide d'un exemple</b> <div class="spoiler_text"><pre> <code class="python hljs">message = <span class="hljs-string"><span class="hljs-string">"""  120   120  / 120   10     30-5 (2)    4.0 """</span></span> key = <span class="hljs-string"><span class="hljs-string">'Traveling through hyperspace ain'</span></span>t like dusting crops, farm boy.<span class="hljs-string"><span class="hljs-string">' encr_message = symmetric_encrypt(message, key, verbose = True) print('</span></span>\n<span class="hljs-string"><span class="hljs-string">') print('</span></span>DECRIPTION<span class="hljs-string"><span class="hljs-string">') decr_message = symmetric_decrypt(encr_message, key) print(decr_message)</span></span></code> </pre><br><pre> <code class="plaintext hljs">Message was encrypted into: ed10e4c65358bb9e351c801c3b3200b21fa86a24021c317bb5c9d8b3f76bdf9f3a7d26781a22402f0e4f41ca831b6d2da9e1e6878c34c79ddc7959af3ae9fc2ba0cfff1c0180a7e0f637f1aa5b24507d552d5dfe7625e7b81d817b5882b2b19bb95f3988a03c78f850098dfc8e6089863deaa39b887eaea4c1d4ba006edaec90205d54b27ed4ac70ed75cdd01732e1176bf04218beb8ae742ff708a201a9d1cb57dd5f2e70dc3239208d23705f7a3aae3e315c4df6d73c871b66c4995cce5f19738f731cd58755d21ed92612c44197f875cddf3f7aa1d60e435ce1492679b9d60c4b8538f52408f321711ac1d2daa6dbbc33dc655abca10e2f5fd3ff27823995b9dcdb62c0bafc1963ab539ccb466f1c140479df34b0005f578f72fcdd76b17391332037b801f74f733a08 DECRIPTION Success! Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026 Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026  120   120  / 120   10     30-5 (2)    4.0</code> Le <code class="plaintext hljs">Message was encrypted into: ed10e4c65358bb9e351c801c3b3200b21fa86a24021c317bb5c9d8b3f76bdf9f3a7d26781a22402f0e4f41ca831b6d2da9e1e6878c34c79ddc7959af3ae9fc2ba0cfff1c0180a7e0f637f1aa5b24507d552d5dfe7625e7b81d817b5882b2b19bb95f3988a03c78f850098dfc8e6089863deaa39b887eaea4c1d4ba006edaec90205d54b27ed4ac70ed75cdd01732e1176bf04218beb8ae742ff708a201a9d1cb57dd5f2e70dc3239208d23705f7a3aae3e315c4df6d73c871b66c4995cce5f19738f731cd58755d21ed92612c44197f875cddf3f7aa1d60e435ce1492679b9d60c4b8538f52408f321711ac1d2daa6dbbc33dc655abca10e2f5fd3ff27823995b9dcdb62c0bafc1963ab539ccb466f1c140479df34b0005f578f72fcdd76b17391332037b801f74f733a08 DECRIPTION Success! Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026 Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026  120   120  / 120   10     30-5 (2)    4.0</code> </pre><br></div></div><br>  <i>Comme vous pouvez le voir, nous avons r√©ussi √† chiffrer le message √† l'aide de la cl√© publique.</i> <i><br></i>  <i>Ex√©cutez le code plusieurs fois.</i>  <i>Vous verrez que chaque fois que la partie chiffr√©e change.</i>  <i>En effet, lors du chiffrement, nous avons utilis√© le mode Cipher FeedBack (AES.MODECFB), dans lequel les blocs de texte en clair sont m√©lang√©s avec les blocs de texte chiffr√©.</i>  <i>iv - vecteur d'initialisation (en savoir plus sur le mode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ).</i>  <i>Lors du d√©cryptage du message, nous voyons que le hachage du message d√©crypt√© correspond au hachage que nous avons ajout√© lors du cryptage.</i>  <i>Cela signifie que le d√©chiffrement √©tait correct.</i> <i><br></i> <br><div class="spoiler">  <b class="spoiler_title">Qu'est-ce qu'un hachage</b> <div class="spoiler_text">  Un hachage de document est simplement une cha√Æne de caract√®res unique √† tout ensemble de donn√©es.  Avec tout changement de donn√©es, le hachage change beaucoup.  En d'autres termes, un hachage est une sorte ¬´d'empreinte digitale¬ª pour tout ensemble de donn√©es. <br><br><img src="https://habrastorage.org/webt/qn/tf/v3/qntfv3yr0oiaexp1o_jzekwsd1o.png"><br></div></div><br>  Mais que se passe-t-il si les cl√©s de chiffrement sont compromises pour une raison quelconque?  Ensuite, n'importe qui peut d√©crypter les informations. <br><br>  Dans ce cas, nous devons en quelque sorte changer les cl√©s de chiffrement √† distance √† une fr√©quence qui peut √™tre exploit√©e par l'adversaire.  Nous supposerons qu'ils l'√©coutent d√©j√†.  Alors, comment faisons-nous cela?  Ici, une autre m√©thode vient √† la rescousse, appel√©e cryptage asym√©trique (ou syst√®me cryptographique √† cl√© publique).  Contrairement au cryptage sym√©trique, il utilise deux cl√©s: publique et priv√©e.  Le message est chiffr√© avec la cl√© publique, apr√®s quoi il ne peut √™tre d√©chiffr√© qu'avec la cl√© priv√©e.  La cl√© publique de d√©chiffrement sera inutile.  Cependant, il y a un point important: la cl√© priv√©e doit certainement provenir de la paire publique g√©n√©r√©e.  La pr√©sence d'une cl√© publique est l'une des nombreuses propri√©t√©s importantes et int√©ressantes du chiffrement asym√©trique.  Autrement dit, nous pouvons transmettre la cl√© publique par n'importe quel canal et ne pas avoir peur qu'elle soit utilis√©e pour d√©crypter le message. <br><br>  En m√™me temps, en ce qui concerne notre t√¢che, il y a une nuance - le chiffrement asym√©trique convient aux petites donn√©es, par exemple les messages courts.  Nous ne pouvons que deviner la quantit√© de donn√©es obtenues par l'intelligence.  Bien s√ªr, nous pouvons diviser toutes les donn√©es re√ßues en petits fragments et les encoder chacune avec une cl√© priv√©e, mais il existe une meilleure solution.  (Le probl√®me est r√©gl√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ). <br><br>  <b>Solution</b> <br><br><blockquote>  <i>L'utilisateur Akela_wolf a fait remarquer √† juste titre que n'importe qui peut g√©n√©rer et envoyer la cl√© publique.</i>  <i>J'ai apport√© quelques ajustements au plan.</i> <br><br>  Il sera correct que, avant d'envoyer des agents, le si√®ge social g√©n√®re plusieurs paires de cl√©s et attribue une cl√© priv√©e √† chaque agent.  Il vaut mieux ne g√©n√©rer que quelques paires pour que chaque agent ait une cl√© individuelle.  Cela est n√©cessaire pour personnifier avec pr√©cision le propri√©taire de la cl√©. <br>  Ensuite, si les cl√©s sont compromises, le centre cr√©era une nouvelle cl√© SYMMETRIC, la codera pour chaque agent avec des cl√©s publiques et l'enverra sur le canal ouvert. <br><div class="spoiler">  <b class="spoiler_title">Sch√©ma de solution g√©n√©ral</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ge/uk/q3/geukq3vj-o8ab3bkta_i5y-8xsa.png"><br><img src="https://habrastorage.org/webt/5l/sn/fy/5lsnfygzrehgkfjlq6qzon-wbdw.png"><br></div></div><br><br></blockquote><br><br><div class="spoiler">  <b class="spoiler_title">Ancienne d√©cision</b> <div class="spoiler_text"><ol><li>  L'agent va g√©n√©rer une paire de cl√©s (publique et priv√©e) en place, puis envoyer la cl√© publique aux forces rebelles; </li><li>  Au si√®ge de la r√©sistance, ils cr√©eront une nouvelle cl√© de cryptage SYM√âTRIQUE; </li><li>  La cl√© sym√©trique est cod√©e √† l'aide de la cl√© publique envoy√©e par l'agent; </li><li>  La cl√© sym√©trique chiffr√©e sera envoy√©e √† l'agent, qui la d√©codera √† l'aide de la cl√© priv√©e. </li></ol><br>  <i>Faites attention √† notre √©mission sur la cha√Æne ouverte:</i> <i><br><br></i> <ol><li>  L'agent envoie la cl√© OUVERTE de la paire, la cl√© FERM√âE est en sa possession; </li><li>  Le quartier g√©n√©ral de la r√©sistance envoie une cl√© de chiffrement sym√©trique, chiffr√©e avec la cl√© publique envoy√©e par l'agent. </li></ol><br><br>  Ni le premier ni le deuxi√®me message n'ont de valeur dans l'interception. <br></div></div><br><br>  √âcrivons le code: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#          RSA. #        SHA256 from Crypto.PublicKey import RSA #      def generate_keys(bits = 2048): """Generates the pair of private and public keys. :param bits: &lt;int&gt; Key length, or size (in bits) of the RSA modulus (default 2048) :return: &lt;object&gt; private_key, &lt;object&gt; public_key """ private_key = RSA.generate(bits) public_key = private_key.publickey() return private_key, public_key private_key, public_key = generate_keys(bits = 2048)</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Voyons √† quoi ressemblent les cl√©s.</b> <div class="spoiler_text"><pre> <code class="python hljs">print(private_key.exportKey(format=<span class="hljs-string"><span class="hljs-string">'PEM'</span></span>).decode()) print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) print(<span class="hljs-string"><span class="hljs-string">'#'</span></span>*<span class="hljs-number"><span class="hljs-number">65</span></span>) print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) print(public_key.exportKey(format=<span class="hljs-string"><span class="hljs-string">'PEM'</span></span>).decode())</code> </pre> <br> <code>-----BEGIN RSA PRIVATE KEY----- <br> MIIEpAIBAAKCAQEA4JDLu7Vtvg2yqbH6Y0eJPfoEsOlKzgmOodqhA1CqkEG4OpKi <br> sGW7ciGP4v37GE6edHBCEy4UNkVQtnpPBjzTHvKd1pO70B84vD5OSrS7uNw2EYkj <br> d/ZwhrJMrcQKRwPkkM4OiewaaAaK0vPWJIKwlW61DY9X7LfNz7aOKMTbKnm1vdR0 <br> 919AV98FUmNoQBgka6nXFGmNbi7D43MtLwxBZIXfFupEiANSvOs+57hgaCho7OWM <br> GUOjLkG6HBscPhJ2W1H5DU9GjwL24ynTvKifgo1/2ue61MV1Pzh5CVaicJKNaRtg <br> Pd99gFhBGINsXV2X6Jh/W5nNsCddU4EI0AlO8wIDAQABAoIBAARM4YnjrIlSK9Sy <br> EtBp40frjMFyhjsx1ahlzmWI2utORt/gRPtJx3AlEmNPZ8qMXt5t8+X4IOz1INmN <br> uAuviH90N++O/q66mlSIgOlPUrT0ipiFXseCUZ9StMMzGNtJSMw5FfAwNEU/stLd <br> VoF2ezkxWIg88XsX/fn3Tfub4XKLvu4raJGcJ+Fo2GI9hYEGKnHhSuHvDHekTLlQ <br> z46O+cIwtehbFGcKesyK3zDD1uP5YLPIWpiqt1TgKjJzRF0l4ZJLk+RT7kU2pGIQ <br> mosOnr+06WyMIg724yQyAIwtS9X0czKBGUESrtTTb1HCXLeTwnncOTxh6q2z42LF <br> tn34+DECgYEA6EEp4oTvjfTQfUQPMByuAjF1hpdFHQqRymygiFgoF+Mg3QmL0w8j <br> /84H/q7s8FSx+3th8MK87bFq4lrry+h/mYwmvF5zZbhxcnl2uaX+KUPgpT6TgvAo <br> WOv2wc4BSaoo9DrxrZId86vpO2qbopw6gkBsvw47HSoQ+FSqXtZ0p8kCgYEA94Zj <br> b1ulctUjybiszO93TAjkzx3lU3yL+B1eZiQXtJa3mgG+ka1R/uMfr0NlT+Jzo0My <br> wHV30YRJDxziCrDol9OgSSU0sXwEcUxUIBLBwXLCp1EmMsYG9PB/x4OTWve35a8F <br> O+rMxuvWaZeIOfVCfL8UEcWweYaVdWIonJN+ltsCgYEAjeSZ2UlMLZce9RjqioNL <br> EA31dlfeoqJ9dYUuAn6RaB6cSk51vWlnnfXazo9CNIYaAsFbkcL3t+QHn+jaXEZc <br> BowocjbmG4Q20zBAB6XRBJbynSIA7yMYE1N9+uOHx+CMisGkO12krOUfZex4zzzR <br> RhhkF8ly9htoKL9ZIv20YXkCgYBzH3UF6PkVZJ5lhtgP5Nx2Z7iLwBrV7ppnBrnO <br> BcFkw6iXH3KT7KmzQ82LxWvMcMVZzLpBGyFkOAOG3OchE9DKNKpa+sv8NHMYguip <br> li+5mneAPFTozoOTznuPvtl9OLO2RuXHTVh6uFub9tdsJW8L+A8MiQagLwE6fDHp <br> SQxaewKBgQDIyzL1THpW3+AMNrOZuI/d3Em5wpGJiZbDSBRosvsfGm/sHaz4Ik5E <br> nWnftgktmsAD60eORTTh9/ww/nm7f3q9kzT8Sv1MmqeRXq9VFIOeP/+8SSE/7LzD <br> izlb5xEtVD8LuY54jHyiOxiZC++TQswMnOKKi0Gx26MDoO7Tx9akVw== <br> -----END RSA PRIVATE KEY----- <br> <br> ################################################################# <br> <br> -----BEGIN PUBLIC KEY----- <br> MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4JDLu7Vtvg2yqbH6Y0eJ <br> PfoEsOlKzgmOodqhA1CqkEG4OpKisGW7ciGP4v37GE6edHBCEy4UNkVQtnpPBjzT <br> HvKd1pO70B84vD5OSrS7uNw2EYkjd/ZwhrJMrcQKRwPkkM4OiewaaAaK0vPWJIKw <br> lW61DY9X7LfNz7aOKMTbKnm1vdR0919AV98FUmNoQBgka6nXFGmNbi7D43MtLwxB <br> ZIXfFupEiANSvOs+57hgaCho7OWMGUOjLkG6HBscPhJ2W1H5DU9GjwL24ynTvKif <br> go1/2ue61MV1Pzh5CVaicJKNaRtgPd99gFhBGINsXV2X6Jh/W5nNsCddU4EI0AlO <br> 8wIDAQAB <br> -----END PUBLIC KEY----- <br></code> <br>  Comme vous pouvez le voir, les cl√©s de chiffrement asym√©triques sont de longues s√©quences de caract√®res g√©n√©r√©es math√©matiquement. <br></div></div><br>  Nous avons donc g√©n√©r√© les cl√©s.  √âcrivons maintenant une fonction pour encoder les donn√©es: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Crypto.PublicKey <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RSA <span class="hljs-comment"><span class="hljs-comment">#        RSA. from Crypto.Hash import SHA256 #        SHA256.    #       from Crypto.Cipher import PKCS1_OAEP #   def encrypt_message(message, public_key, verbose = True): """Encripts the message using public_key. :param message: &lt;str&gt; Message for encryption :param public_key: &lt;object&gt; public_key :param verbose: &lt;bool&gt; Print description; :return: &lt;object&gt; Message encrypted with public_key """ message_hash = SHA256.new(message.encode()) #   . cipher = PKCS1_OAEP.new(public_key) message_with_hash = message.encode() + message_hash.hexdigest().encode() #      ,          encrypted_message = cipher.encrypt(message_with_hash) if verbose: print(f'Message: {message} was encrypted to\n{encrypted_message.hex()}') return encrypted_message def decrypt_message(encrypted_message, private_key): """Decripts the message using private_key and check it's hash :param encrypted_message: &lt;object&gt; Encrypted message :param private_key: &lt;object&gt; private_key :return: &lt;object&gt; Message decripted with private_key """ dsize = SHA256.digest_size*2 cipher = PKCS1_OAEP.new(private_key) decrypted_message_with_hesh = cipher.decrypt(encrypted_message) #   (  ) decrypted_message = decrypted_message_with_hesh[:-dsize] #      digest = SHA256.new(decrypted_message).hexdigest() #     if digest==decrypted_message_with_hesh[-dsize:].decode(): #      ,      ,   print(f"Success!\nEncrypted hash is {decrypted_message_with_hesh[-dsize:].decode()}\nDecrypted hash is {digest}") return decrypted_message.decode() else: print(f"Encryption was not correct: the hash of decripted message doesn't match with encrypted hash\nEncrypted hash is {decrypted_message_with_hesh[-dsize:]}\nDecrypted hash is {digest}")</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">√âtapes du workflow</b> <div class="spoiler_text"><ol><li>  L'agent g√©n√®re une paire de cl√©s: <br><pre> <code class="python hljs">private_key, public_key = generate_keys()</code> </pre> <br></li><li>  Envoie la cl√© OUVERTE au si√®ge; </li><li>  Au si√®ge, √† l'aide de la cl√© publique, encodez la cl√© pour le chiffrement sym√©trique: <br><pre> <code class="python hljs">new_symmetric_key = <span class="hljs-string"><span class="hljs-string">'SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt'</span></span> encr_msg = encrypt_message(new_symmetric_key, public_key)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Conclusion</b> <div class="spoiler_text"> <code>Message: SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt was encrypted to <br> 41e940507c96397e3feb4a53390c982633bb1775a52957996a8069bd22063086a0e831bf775a17909276aba0d0478ee6c953837c8ea5d20d40e1c8eb463aaa1bc5c93c71677b1a85e90439c9dbda8a98ce168acb38368155437c66815b84aa2fbdda0eb909e4e6079b4410c720eddd955ed048193bf87f8f9976a17ee32a58a71dfddf3db116343d949d29c25f72c511a440a50a5d4f1e01c37b24a1cb4127e191d3231328b2f120c7dbd0cb5bf19823f0978b8ed17d25952de4b146ef9724fff359eb2af503fdfd72b91525a5503b076ba9aaaeac55af3f8d210c12d579d45dd70362123c0b4b36ef9c2f7705e6f884a25553eb0e11e5077f11fa986d0ff280</code> <br> </div></div><br></li><li>  Cette longue s√©quence est renvoy√©e √† l'agent; </li><li>  L'agent d√©chiffre le message re√ßu √† l'aide de la cl√© priv√©e: <br><pre> <code class="python hljs">recieved_symmetric_key = decrypt_message(encr_msg, private_key) print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) print(<span class="hljs-string"><span class="hljs-string">f"New symmetric key is: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{recieved_symmetric_key}</span></span></span><span class="hljs-string">"</span></span>)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Conclusion</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Success! Encrypted hash is 42ad66445a05ac09e684bb21f9b487d95b9cfa11d02e0b459931321ee02f7c1c Decrypted hash is 42ad66445a05ac09e684bb21f9b487d95b9cfa11d02e0b459931321ee02f7c1c New symmetric key is: SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt</code> </pre> <br></div></div><br></li><li>  Ensuite, √† l'aide d'une nouvelle cl√© sym√©trique, l'agent crypte les donn√©es re√ßues: <br><br><pre> <code class="python hljs">message = <span class="hljs-string"><span class="hljs-string">"""  120   120  / 120   10     30-5 (2)    4.0 """</span></span> encr_message = symmetric_encrypt(message, recieved_symmetric_key, verbose = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Conclusion</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Message was encrypted into:</code> </pre><br></div></div><br></li><li>  Le si√®ge d√©crypte: <br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'DECRIPTION'</span></span>) decr_message = symmetric_decrypt(encr_message, new_symmetric_key) print(decr_message)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Conclusion</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">DECRIPTION Success! Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026 Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026  120   120  / 120   10     30-5 (2)    4.0</code> </pre><br></div></div><br></li></ol><br></div></div><br>  <b>Voila!</b> <br><br>  Dans cet exemple abstrait, nous avons vu le travail d'algorithmes de chiffrement courants.  Le chiffrement sym√©trique et asym√©trique, ainsi que le hachage, sont utilis√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans le travail sur le Web</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la signature √©lectronique</a> , la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">blockchain et les crypto-monnaies</a> .  J'esp√®re que le mat√©riel a √©t√© utile pour comprendre le fonctionnement de ces technologies. <br><br><h3>  Postface </h3><br>  En cons√©quence, les renseignements rebelles ont r√©ussi √† obtenir des informations pr√©cises sur la vuln√©rabilit√© de la station et son cheminement, la pr√©sence de l'empereur pour inspection, la pr√©sence d'un bouclier √©nerg√©tique et sa source sur Endor.  L'empire a rep√©r√© les espions, les a mal inform√©s sur la capacit√© de combat de la station.  La station a √©galement √©t√© attribu√©e au satellite d'Endor, d'o√π il √©tait prot√©g√© par un bouclier. <br><br><div class="spoiler">  <b class="spoiler_title">Mais nous savons comment tout cela s'est termin√©;)</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452042/">https://habr.com/ru/post/fr452042/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452030/index.html">Histoire d'Internet: d√©couvrir l'interactivit√©</a></li>
<li><a href="../fr452034/index.html">Ma√Ætrise de soi du temps pour l'auto-√©ducation et du temps pour lire des livres</a></li>
<li><a href="../fr452036/index.html">Radio d√©finie par logiciel - comment √ßa marche? 2e partie</a></li>
<li><a href="../fr452038/index.html">Accord dangereux</a></li>
<li><a href="../fr452040/index.html">M√©t√©orite de Tunguska et ses jeunes fr√®res</a></li>
<li><a href="../fr452046/index.html">T√©l√©commande √† faible courant de repos sur l'ATmega328P</a></li>
<li><a href="../fr452052/index.html">Comment nous avons r√©duit de moiti√© le co√ªt d'une le√ßon d'introduction en examinant une solution des compagnies a√©riennes</a></li>
<li><a href="../fr452054/index.html">Pourquoi WhatsApp ne sera jamais s√ªr</a></li>
<li><a href="../fr452056/index.html">Golang DevDay: 31 mai, Novossibirsk + √©mission</a></li>
<li><a href="../fr452060/index.html">Informations sur les pr√©dicats d'espoir</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>