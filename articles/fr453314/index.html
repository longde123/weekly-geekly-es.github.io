<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐧 🏴󠁧󠁢󠁳󠁣󠁴󠁿 🎀 DIY Black Mirror - enseignez un bot basé sur son historique de chat ↩️ 👨🏿‍🎓 👗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le «Black Mirror», il y avait une série (S2E1), dans laquelle ils ont créé des robots similaires à des morts, en utilisant l'histoire de la corre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DIY Black Mirror - enseignez un bot basé sur son historique de chat</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453314/"><p>  Dans le «Black Mirror», il y avait une série (S2E1), dans laquelle ils ont créé des robots similaires à des morts, en utilisant l'histoire de la correspondance sur les réseaux sociaux pour la formation.  Je veux vous dire comment j'ai essayé de faire quelque chose de similaire et ce qui en est ressorti.  Il n'y aura pas de théorie, seulement de la pratique. </p><br><p><img src="https://habrastorage.org/webt/ht/n2/tn/htn2tnbybsvgaidwif-bspo2rtm.gif" alt="image"></p><br><p>  L'idée était simple: reprendre l'historique de leurs conversations de Telegram et, sur leur base, former le réseau seq2seq, qui est capable de prédire son achèvement au début du dialogue.  Un tel réseau peut fonctionner en trois modes: </p><br><ul><li>  Prédire l'achèvement de la phrase utilisateur en fonction de l'historique des conversations </li><li>  Travailler en mode chatbot </li><li>  Synthétisez des journaux de conversation entiers </li></ul><br><h2 id="vot-chto-poluchilos-u-menya">  Voilà ce que j'ai </h2><br><h4 id="bot-predlagaet-zavershenie-frazy">  Le robot offre une complétion de phrase </h4><br><p><img src="https://habrastorage.org/webt/me/u1/go/meu1gotqs3fz3kpgayxmmcpos2e.png" alt="image"></p><br><h4 id="bot-predlagaet-zavershenie-dialoga">  Le robot offre l'achèvement du dialogue </h4><br><p><img src="https://habrastorage.org/webt/ji/47/pi/ji47pijmaqoiham5zllz19enymc.png" alt="image"></p><br><h4 id="bot-obschaetsya-s-zhivym-chelovekom">  Le robot communique avec une personne vivante </h4><br><pre><code class="plaintext hljs">User:  Bot:  User:  ? Bot:  User:  ? Bot:  User: ? Bot:    User:     ? Bot:    User:  ? Bot:   </code> </pre> <br><p>  Ensuite, je vais vous expliquer comment préparer les données et entraîner vous-même un tel robot. </p><a name="habracut"></a><br><h2 id="kak-obuchit-samomu">  Comment vous apprendre </h2><br><h4 id="podgotovka-dannyh">  Préparation des données </h4><br><p>  Tout d'abord, vous devez obtenir beaucoup de conversations quelque part.  J'ai pris toute ma correspondance dans Telegram, car le client pour le bureau permet de télécharger l'archive complète au format JSON.  Ensuite, j'ai jeté tous les messages qui contiennent des citations, des liens et des fichiers, et j'ai transféré les textes restants en minuscules et jeté tous les caractères rares à partir de là, ne laissant qu'un simple ensemble de lettres, de chiffres et de signes de ponctuation - il est plus facile d'apprendre le réseau. </p><br><p>  Ensuite, j'ai apporté les chats à ce formulaire: </p><br><pre> <code class="plaintext hljs">=== &gt;  &lt;    &gt;  &lt;  ! === &gt;  ? &lt; </code> </pre> <br><p>  Ici, les messages qui commencent par le symbole "&gt;" sont une question pour moi, le symbole "&lt;" marque ma réponse en conséquence et la ligne "===" sert à séparer les dialogues entre eux.  Le fait qu'un dialogue se soit terminé et que l'autre a commencé, j'ai déterminé par le temps (si plus de 15 minutes se sont écoulées entre les messages, alors nous pensons que c'est une nouvelle conversation. Vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pouvez voir le</a> script pour convertir l'histoire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur github</a> . </p><br><p>  Depuis que j'utilise activement les télégrammes depuis longtemps, il y a eu beaucoup de messages à la fin - il y avait 443 000 lignes dans le fichier final. </p><br><h4 id="vybor-modeli">  Sélection du modèle </h4><br><p>  J’ai promis qu’il n’y aurait pas de théorie aujourd’hui, je vais donc essayer de l’expliquer le plus brièvement possible sur mes doigts. </p><br><p>  J'ai choisi le classique seq2seq basé sur GRU.  Un tel modèle d'entrée reçoit le texte lettre par lettre et génère également une lettre à la fois.  Le processus d'apprentissage est basé sur le fait que nous apprenons au réseau à prédire la dernière lettre du texte, par exemple, nous donnons <em>«plomb»</em> à l'entrée et attendons que <em>«rivet»</em> soit sorti. </p><br><p>  Pour générer des textes longs, une astuce simple est utilisée - le résultat de la prédiction précédente est renvoyé au réseau et ainsi de suite jusqu'à ce que la longueur de texte nécessaire soit générée. </p><br><p>  Les modules GRU peuvent être très, très simplifiés comme un "perceptron rusé avec de la mémoire et de l'attention", plus de détails à leur sujet peuvent être trouvés, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><p>  Le modèle était basé sur l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exemple</a> bien connu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de la</a> tâche de générer des textes de Shakespeare. </p><br><h4 id="obuchenie">  La formation </h4><br><p>  Quiconque a déjà rencontré des réseaux de neurones sait probablement que les apprendre sur le CPU est très ennuyeux.  Heureusement, Google vient à la rescousse avec son service <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Colab</a> - vous pouvez y exécuter gratuitement votre code dans le cahier jupyter en utilisant un CPU, un GPU et même un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TPU</a> .  Dans mon cas, la formation sur la carte vidéo tient en 30 minutes, bien que des résultats raisonnables soient disponibles après 10. L'essentiel est de se rappeler de changer le type de matériel (dans le menu Runtime -&gt; Changer le type d'exécution). </p><br><h4 id="testirovanie">  Test </h4><br><p>  Après la formation, vous pouvez procéder à la vérification du modèle - j'ai écrit plusieurs exemples qui vous permettent d'accéder au modèle dans différents modes - de la génération de texte au chat en direct.  Tous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sont sur github</a> . </p><br><p>  La méthode pour générer du texte a un paramètre de température - plus il est élevé, plus le texte (et vide de sens) produira un bot.  Ce paramètre est logique pour configurer les mains pour une tâche spécifique. </p><br><h4 id="dalneyshee-ispolzovanie">  Utilisation ultérieure </h4><br><p>  Pourquoi un tel réseau peut-il être utilisé?  La chose la plus évidente est de développer un bot (ou clavier intelligent) qui peut offrir à l'utilisateur des réponses toutes faites avant même qu'il ne les écrive.  Une fonctionnalité similaire existe depuis longtemps dans Gmail et la plupart des claviers, mais elle ne prend pas en compte le contexte de la conversation et la façon dont un utilisateur particulier conduit la correspondance.  Disons que le G-Keyboard me propose de manière stable des options complètement dénuées de sens, par exemple, "Je vais avec ... respect" à l'endroit où je voudrais obtenir l'option "Je vais de la datcha", que j'ai certainement utilisée à plusieurs reprises. </p><br><p>  Le bot de chat a-t-il un avenir?  Dans sa forme pure, il n'est définitivement pas là, il a trop de données personnelles, personne ne sait à quel moment il donnera à l'interlocuteur le numéro de votre carte bancaire que vous avez jeté une fois à un ami.  De plus, un tel bot n'est pas du tout réglé, il est très difficile de le faire effectuer des tâches spécifiques ou de répondre correctement à une question spécifique.  Au contraire, un tel chatbot pourrait fonctionner en conjonction avec d'autres types de bots, fournissant un dialogue plus connecté "sur rien" - il s'en sort bien.  (Et pourtant, un expert externe en la personne de sa femme a dit que le style de communication du bot était très similaire à moi. Et les sujets qui l'intéressent sont clairement les mêmes - les bugs, les corrections, les commits et autres joies et chagrins du développeur apparaissent constamment dans les textes). </p><br><p>  Quoi d'autre vous conseille d'essayer si ce sujet vous intéresse? </p><br><ul><li>  Transfert d'apprentissage (pour vous entraîner sur un grand nombre de dialogues avec d'autres personnes, puis terminer par vous-même) </li><li>  Changer de modèle - augmenter, changer de type (par exemple, sur LSTM). </li><li>  Essayez de travailler avec TPU.  Dans sa forme pure, ce modèle ne fonctionnera pas, mais il peut être adapté.  L'accélération théorique de l'apprentissage devrait être dix fois supérieure. </li><li>  Portez vers une plate-forme mobile, par exemple en utilisant Tensorflow mobile. </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien</a> PS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vers github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453314/">https://habr.com/ru/post/fr453314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr453302/index.html">La première heure de vie avec Yandex.Module</a></li>
<li><a href="../fr453304/index.html">Avantages clés de Zextras PowerStore</a></li>
<li><a href="../fr453306/index.html">Kubernetes prendra le contrôle du monde. Quand et comment?</a></li>
<li><a href="../fr453310/index.html">Échangez des données entre les composants React à l'aide de la bibliothèque RxJS</a></li>
<li><a href="../fr453312/index.html">Générateur d'e-mails professionnels PDF basé sur des données XML</a></li>
<li><a href="../fr453316/index.html">Le fabricant de puces britannique ARM cesse sa coopération avec Huawei</a></li>
<li><a href="../fr453318/index.html">5 erreurs dans l'implémentation des notifications push pour les applications mobiles</a></li>
<li><a href="../fr453322/index.html">Configurer le cluster nomade avec Consul et l'intégrer avec Gitlab</a></li>
<li><a href="../fr453324/index.html">Diode comme redresseur</a></li>
<li><a href="../fr453326/index.html">Comment automatiser la gestion de l'infrastructure informatique - discutez de trois tendances</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>