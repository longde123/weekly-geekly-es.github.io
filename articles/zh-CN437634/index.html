<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â–¶ï¸ ğŸ˜‰ ğŸ½ DIYæ— çº¿è·¯ç”±å™¨ ğŸ‘¨ğŸ¾â€âš–ï¸ ğŸ ğŸ”¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. å…ƒä»¶é€‰æ‹© 
2. å¯åŠ¨ç½‘ç»œæ¥å£ 
3. è®¾ç½®802.11acæ¥å…¥ç‚¹ï¼ˆ5 GHzï¼‰ 
4. ä½¿ç”¨hostapdé…ç½®è™šæ‹ŸSSID 
 åœ¨è¿‡å»çš„åå¹´ä¸­ï¼Œæˆ‘è´­ä¹°äº†å»‰ä»·çš„ç½‘ç»œè®¾å¤‡ï¼Œå¹¶åœ¨å…¶ä¸Šå®‰è£…äº†DD-WRT ï¼Œä»¥ä½¿â€œåŠŸèƒ½â€ä»¥è¶…è¿‡500ç¾å…ƒçš„ä»·æ ¼ä»Linuxå†…æ ¸ä¸­åˆ é™¤ï¼Œè€Œåè€…æ˜¯åŸºç¡€å›ºä»¶ã€‚ 

 å°½ç®¡å­˜åœ¨ä¸...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DIYæ— çº¿è·¯ç”±å™¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437634/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/967/b65/9d2/967b659d291d3021a9a93f68b4b305b2.jpg"></div><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…ƒä»¶é€‰æ‹©</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯åŠ¨ç½‘ç»œæ¥å£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è®¾ç½®802.11acæ¥å…¥ç‚¹ï¼ˆ5 GHzï¼‰</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨hostapdé…ç½®è™šæ‹ŸSSID</a> </li></ol><br> åœ¨è¿‡å»çš„åå¹´ä¸­ï¼Œæˆ‘è´­ä¹°äº†å»‰ä»·çš„ç½‘ç»œè®¾å¤‡ï¼Œå¹¶åœ¨å…¶ä¸Šå®‰è£…äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DD-WRT</a> ï¼Œä»¥ä½¿â€œåŠŸèƒ½â€ä»¥è¶…è¿‡500ç¾å…ƒçš„ä»·æ ¼ä»Linuxå†…æ ¸ä¸­åˆ é™¤ï¼Œè€Œåè€…æ˜¯åŸºç¡€å›ºä»¶ã€‚ <br><br> å°½ç®¡å­˜åœ¨ä¸ç¨³å®šçš„ç‰ˆæœ¬ï¼Œæœªçº æ­£çš„é”™è¯¯å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://web.archive.org/web/20160303173311/">çº çº·</a> ï¼Œä½†DD-WRTä»ç„¶æ¯”åº“å­˜å›ºä»¶æ›´å¯å–ã€‚ ä½†æ˜¯ç°åœ¨æœ‰ä»·å€¼çš„ç»„ä»¶æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´ä¾¿å®œï¼Œå¹¶ä¸”DIYç¤¾åŒºå·²ç»å®Œå…¨è½¬æ¢ä¸ºLinuxï¼ˆæˆ‘æ­£åœ¨æ‰¾æ‚¨ï¼ŒRaspberryå…ˆç”Ÿï¼‰ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸ä¸€åŠ³æ°¸é€¸åœ°æ„å»ºè‡ªå·±çš„æ— çº¿è·¯ç”±å™¨å‘¢ï¼Ÿ <br><a name="habracut"></a><br><a name="1"></a><h1> å…ƒä»¶é€‰æ‹© </h1><br> é¦–å…ˆï¼Œæ‚¨éœ€è¦ç¡®å®šå¹³å°ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">x86</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ARM</a> ï¼Ÿ æˆ‘ä¸ä¼š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯¦ç»†è®¨è®ºä¸»è¦çš„åŒºåˆ«</a> ï¼Œè€Œæ˜¯ç®€è¦åœ°ä»‹ç»ä¸€ä¸‹ï¼šå‰è€…å…·æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œè€Œåè€…åˆ™æ›´ä¾¿å®œä¸”æ›´èŠ‚èƒ½ã€‚  Raspberry Piæ¿ï¼ˆå’Œç­‰æ•ˆäº§å“ï¼‰éå¸¸ä¾¿å®œï¼Œå¹¶ä¸”å¯èƒ½æ¯”å¤§å¤šæ•°æ— çº¿å•†ç”¨è·¯ç”±å™¨åŠŸèƒ½æ›´å¼ºå¤§ï¼Œä½†æ˜¯x86å¹³å°å·²æ™®åŠå¹¶ä¸”å…·æœ‰æ ‡å‡†åŒ–çš„å¤–å½¢å°ºå¯¸å’Œæ‰©å±•ç«¯å£çš„ä¼˜åŠ¿ã€‚ <br><br> å½“ç„¶ï¼Œæœ€é‡è¦çš„ç»†èŠ‚æ˜¯èŠ¯ç‰‡ç»„ã€‚ ä»Šå¤©ï¼Œäº‹å®ä¸Šçš„æ ‡å‡†æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">802.11n</a> ï¼ˆ2.4 GHzï¼‰å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">802.11ac</a> ï¼ˆ5 GHzï¼‰ï¼Œä½†æ˜¯ä¸ºLinuxé€‰æ‹©é©±åŠ¨ç¨‹åº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜</a> ï¼Œå°¤å…¶æ˜¯åœ¨æ”¯æŒAPï¼ˆæ¥å…¥ç‚¹ï¼‰æ¨¡å¼çš„æƒ…å†µä¸‹ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœæ‚¨ä¸å¸Œæœ›å‡ºç°é—®é¢˜ï¼Œè¯·é€‰æ‹©<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Atheros</a>èŠ¯ç‰‡ç»„ã€‚ å¾ˆå¥½åœ°æ”¯æŒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ath9k</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ath10ké©±åŠ¨ç¨‹åº</a> ï¼Œæ‚¨å¯ä»¥é€šè¿‡USBå’Œ/æˆ–mini-PCIeæ¥å£è½»æ¾æ‰¾åˆ°å®ƒä»¬ã€‚ <br><br> è‡³å°‘éœ€è¦ä¸€ä¸ªç½‘ç»œæ¥å£æ§åˆ¶å™¨ï¼ˆNICï¼‰ï¼Œå¹¶æ ¹æ®æ‚¨çš„å–œå¥½é€‰æ‹©RAMå’Œå­˜å‚¨ã€‚ <br><br><h2> ææ–™æ¸…å• </h2><br> ç‰ºç‰²äº†ä»·æ ¼å’ŒåŠŸè€—ä¹‹åï¼Œæˆ‘é€‰æ‹©äº†x86å¹³å°æ¥è¿›è¡Œæ¨¡å—åŒ–ï¼Œç›¸å¯¹å¼ºå¤§çš„é…ç½®ä»¥è¿›è¡Œå‡çº§ã€‚ <br><br>  <i>å¦‚æœä¸éœ€è¦ARMï¼Œåˆ™ä¸éœ€è¦é£æ‰‡ã€‚</i> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">æŠ€å˜‰GA-J1900N-D3V</a> ï¼ˆJ1900å››æ ¸2 GHzèµ›æ‰¬å¤„ç†å™¨ï¼Œä¸¤ä¸ªNICï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">Airetos AEX-QCA9880-NX</a> ï¼ˆåŒé¢‘802.11acï¼ŒMIMOï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">4 GB RAM</a> ï¼ˆDDR3-LPï¼Œ1333 MHzï¼Œ1.35 Vï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">æ‰©å±•mPCIe</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">MX500 mini-ITXæœºç®±</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">ä¸‰ä¸ª6dBi RP-SMAåŒé¢‘æ®µå¤©çº¿+ RP-SMA</a>ç”µç¼† </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener">ç¬”å…‹PSU-90</a> </li><li> å¤‡ç”¨ç¡¬ç›˜2.5è‹±å¯¸ </li></ul><br> å¤–å£³å¾ˆå®½æ•ï¼Œæœ‰ä¸¤ä¸ªå‡†å¤‡å¥½çš„äº¤æµ/ç›´æµæ’å¤´å­”ã€‚ é¡ºåˆ©å®‰è£…ä¸»æ¿ï¼ŒRAMå’ŒPico-PSUï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ad/455/84b/7ad45584b277d11fa3f1a7b119759ebc.jpg"><br>  <i><font color="gray">é“è‰²æƒ…</font></i> <br><br> äº‹å®è¯æ˜ï¼Œå®‰è£…mini-PCIe WiFiæœ€å›°éš¾ï¼Œå› ä¸ºè¯¥æ¿ä»…æ”¯æŒä¸€åŠå¤§å°çš„å¡ï¼šåœ¨è¿™é‡Œï¼ŒmPCIeæ‰©å±•ç”µç¼†å¯ç”¨äºæ•‘æ´ã€‚ æˆ‘ç”¨20å˜ç±³FFCç”µç¼†ï¼ˆéšé™„ï¼‰è¿æ¥é€‚é…å™¨çš„ä¸¤ä¾§ï¼Œå¹¶ä½¿ç”¨åŒé¢èƒ¶å¸¦å°†mini-PCIeå›ºå®šè‡³æœºç®±ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db1/c7a/8f7/db1c7a8f756c70176d86ce9441d5cf7a.jpg"><img src="https://habrastorage.org/getpro/habr/post_images/5bb/b09/5c7/5bbb095c759ac5cd9be3cf316070ab22.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a4/e91/9b8/3a4e919b817344fdc03d98bb1e9d001f.jpg"><br>  <i><font color="gray">Mini-PCIeæ‰©å±•å™¨</font></i> <br><br> å¹¸è¿çš„æ˜¯ï¼Œæœºç®±å¸¦æœ‰ä¸‰ä¸ªé¢„å…ˆåˆ‡å‰²çš„å¤©çº¿å­”ã€‚ è¿™æ˜¯æœ€ç»ˆç»“æœï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/967/b65/9d2/967b659d291d3021a9a93f68b4b305b2.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3d/82d/a98/c3d82da9842de641d8d3a4dec3cfe517.jpg"><br><br><a name="2"></a><h1> è½¯ä½“ç±» </h1><br> æ˜¾ç„¶ï¼Œæˆ‘ä»¬å®‰è£…äº†Linuxã€‚ æ ¹æ®ç¡¬ä»¶çš„ä¸åŒï¼Œå®ƒå¯èƒ½æ˜¯ç»è¿‡ä¼˜åŒ–çš„å‘è¡Œç‰ˆï¼Œå¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Raspbian</a> ï¼ˆé’ˆå¯¹Raspberry Piï¼‰æˆ–æ‚¨å–œæ¬¢çš„ä»»ä½•å…¶ä»–Linuxå‘è¡Œç‰ˆã€‚ è‡ªä»æˆ‘ä½¿ç”¨Ubuntuå¤šå¹´ä»¥æ¥ï¼Œæˆ‘é€‰æ‹©äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ubuntu Server 18.04 LTS</a> ï¼Œæˆ‘æ›´ä¹ æƒ¯ä¸ä¹‹åˆä½œå¹¶è·å¾—é•¿æœŸæ”¯æŒã€‚ <br><br>  <i>æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†å‡å®šæ‚¨æ­£åœ¨ä½¿ç”¨åŸºäºDebiançš„å‘è¡Œç‰ˆã€‚</i> <br><br> å¦‚æœå®‰è£…æ­£å¸¸ï¼Œç„¶åè½¬åˆ°æ§åˆ¶å°ï¼Œè¯·å®šä¹‰æ¥å£åç§°ï¼š <br><br><pre><code class="bash hljs">$ ip -br a | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span> lo enp1s0 enp2s0 wlp5s0</code> </pre> <br> ä¸»æ¿ä¸Šæœ‰ä¸¤ä¸ªå†…ç½®NICï¼š <code>enp1s0</code>å’Œ<code>enp2s0</code> ã€‚ æ— çº¿ç½‘å¡æ˜¾ç¤ºä¸º<code>wlp5s0</code>å¹¶æŒ‰é¢„æœŸæ”¯æŒAPæ¨¡å¼ï¼š <br><br><pre> <code class="bash hljs">$ iw list ... Supported interface modes: * managed * AP * AP/VLAN * monitor * mesh point</code> </pre> <br> ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¦‚è¿°æ‰€éœ€çš„å†…å®¹ï¼šæˆ‘ä»¬å°†ç¬¬ä¸€ä¸ªNICç”¨ä½œWANç«¯å£ï¼Œç„¶åå°†ç¬¬äºŒä¸ªNICè¿æ¥åˆ°æ— çº¿æ¥å£ï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e6/f00/dd4/5e6f00dd4994b5dc252d70dda1d325ec.png"><br><br><h2> è”æ’­ç½‘ </h2><br> å¦‚æœæ‚¨å…·æœ‰Ubuntu 18.04ï¼Œåˆ™ç«‹å³æ‘†è„±netplanï¼Œä»¥è¿”å›å¯¹/ etc / network / interfacesçš„æ”¯æŒï¼š <br><br><pre> <code class="bash hljs">$ sudo apt-get install ifupdown bridge-utils $ sudo systemctl stop networkd-dispatcher $ sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> networkd-dispatcher $ sudo systemctl mask networkd-dispatcher $ sudo apt-get purge nplan netplan.io</code> </pre> <br> ä½œä¸ºDHCP / DNSæœåŠ¡å™¨ï¼Œé€‰æ‹©<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">dnsmasq</a> ï¼š <br><br><pre> <code class="bash hljs">$ sudo apt-get install dnsmasq</code> </pre> <br> ç”±äºæˆ‘ä»¬å°†é€šè¿‡<code>post-up</code>æŒ‚é’©å¯åŠ¨å’Œé…ç½®<code>dnsmasq</code>è¿›ç¨‹ï¼Œå› æ­¤è¯·è®°ä½åœ¨å¼•å¯¼æ—¶ç¦ç”¨å®ˆæŠ¤ç¨‹åºï¼š <br><br><pre> <code class="bash hljs">$ sudo sed -i <span class="hljs-string"><span class="hljs-string">"s/^ENABLED=1$/ENABLED=0/g"</span></span> /etc/default/dnsmasq</code> </pre> <br> æˆ‘ä»¬å°†æ ¹æ®è¯¥å›¾ç¼–å†™ç½‘ç»œæ¥å£çš„<b>åˆæ­¥</b>é…ç½®ï¼ŒåŒ…æ‹¬<code>dnsmasq</code>çš„æœ€ä½é…ç½®ï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/network/interfaces <span class="hljs-comment"><span class="hljs-comment"># Loopback auto lo iface lo inet loopback # WAN interface auto enp1s0 iface enp1s0 inet dhcp # Bridge (LAN) auto br0 iface br0 inet static address 192.168.1.1 network 192.168.1.0 netmask 255.255.255.0 broadcast 192.168.1.255 bridge_ports enp2s0 post-up /usr/sbin/dnsmasq \ --pid-file=/var/run/dnsmasq.$IFACE.pid \ --dhcp-leasefile=/var/lib/misc/dnsmasq.$IFACE.leases \ --conf-file=/dev/null \ --interface=$IFACE --except-interface=lo \ --bind-interfaces \ --dhcp-range=192.168.1.10,192.168.1.150,24h pre-down cat /var/run/dnsmasq.$IFACE.pid | xargs kill</span></span></code> </pre> <br>  <i>æ–‡æ¡£<code>/etc/network/interfaces</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨è¿™é‡Œ</a></i> <br><br> å¦‚æ‚¨åœ¨<code>post-up</code>éƒ¨åˆ†ä¸­æ‰€è§ï¼Œä¸€æ—¦æ¡¥å‡èµ·ï¼Œdnsmasqå°±å¼€å§‹å¯åŠ¨ã€‚ å®ƒçš„é…ç½®ä»…ç”±å‘½ä»¤è¡Œå‚æ•°ï¼ˆ <code>--conf-file=/dev/null</code> ï¼‰æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨å…³é—­æ¥å£æ—¶è¯¥è¿‡ç¨‹å°†åœæ­¢ã€‚ <br><br> åœ¨<code>wlp5s0</code>æœªç‰¹åˆ«æŒ‡å®š<code>bridge_ports</code>æ¥å£ï¼Œå› ä¸º<code>hostapd</code>ä¼šè‡ªåŠ¨å°†å…¶æ·»åŠ åˆ°ç½‘æ¡¥ï¼ˆåœ¨å¯åŠ¨hostapdæ›´æ”¹æ¥å£æ¨¡å¼ä¹‹å‰ï¼Œbrctlå¯èƒ½ä¼šæ‹’ç»è¿™æ ·åšï¼‰ã€‚ <br><br>  <i>è¯·å‚é˜…<code>dnsmasq</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£</a> ã€‚</i> <br><br> ç°åœ¨ï¼Œæ‚¨å¯ä»¥é‡æ–°å¯åŠ¨ç½‘ç»œï¼ˆ <code>sudo service networking restart</code> ï¼‰ï¼Œæˆ–è€…ç®€å•åœ°é‡æ–°å¯åŠ¨ä»¥ç¡®è®¤ç½‘ç»œé…ç½®æ­£ç¡®ã€‚ <br><br> è¯·æ³¨æ„ï¼šå°½ç®¡æˆ‘ä»¬ç›®å‰å¯ä»¥ä»<code>enp2s0</code>æ¥æ”¶DHCPï¼Œ <code>enp2s0</code>æˆ‘ä»¬å°†æ— æ³•<b>è¿›è¡Œæ— çº¿è¿æ¥</b> ï¼ˆç¨åä¼šè¯¦ç»†ä»‹ç»ï¼‰ <b>æˆ–è®¿é—®Internet</b> ï¼ˆè¯·å‚è§ä¸‹æ–‡ï¼‰ã€‚ <br><br><h2> è·¯ç”±é€‰æ‹© </h2><br> æ­¤æ—¶ï¼Œæ‚¨éœ€è¦åœ¨LANï¼ˆ <code>enp2s0</code> ï¼‰å’ŒWANï¼ˆ <code>enp1s0</code> ï¼‰ <code>enp1s0</code>ä¹‹é—´è·¯ç”±æ•°æ®åŒ…ï¼Œå¹¶å¯ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç½‘ç»œåœ°å€è½¬æ¢</a> ã€‚ <br><br> å¯ç”¨æ•°æ®åŒ…è½¬å‘å¾ˆå®¹æ˜“ï¼š <br><br><pre> <code class="bash hljs">$ sudo sysctl -w net.ipv4.ip_forward=1 $ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"net.ipv4.ip_forward=1"</span></span> | sudo tee -a /etc/sysctl.conf</code> </pre> <br>  <i>æœ€åä¸€æ¡å‘½ä»¤ç¡®ä¿åœ¨ä¸‹æ¬¡é‡æ–°å¯åŠ¨ä¹‹å‰ä¿å­˜é…ç½®ã€‚</i> <br><br> ç½‘ç»œåœ°å€è½¬æ¢æ˜¯å¦ä¸€å›äº‹ï¼Œé€šå¸¸æ‚¨å¿…é¡»å¤„ç†ï¼ˆæˆ–æ›´ç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯å¯¹ä»˜ï¼‰ <code>iptables</code> ã€‚ å¹¸è¿çš„æ˜¯ï¼Œâ€œçŸ³å™¨æ—¶ä»£â€å·²ç»è¿‡å»äº†ï¼ŒFireHolçš„å›¢é˜Ÿä»˜å‡ºäº†å¾ˆå¤šåŠªåŠ›æ¥æ·»åŠ å¿…è¦çš„æŠ½è±¡çº§åˆ«ï¼š <br><br><pre> <code class="bash hljs">$ sudo apt-get install firehol</code> </pre> <br>  FireHOLæ˜¯ä¸€ç§æœ€æ–°çš„å®‰å…¨é˜²ç«å¢™è¯­è¨€ï¼Œå…¶é…ç½®æ˜“äºç†è§£å’Œè®¿é—®ã€‚ æ‚¨ä¸å†éœ€è¦ç¼–å†™<code>iptables</code>è¯­å¥ï¼šé…ç½®æ–‡ä»¶æœ¬èº«å°†è½¬æ¢ä¸º<code>iptables</code>è¯­å¥å¹¶æ ¹æ®éœ€è¦åº”ç”¨ã€‚ åå°æ— å®ˆæŠ¤ç¨‹åºã€‚ <br><br> å¯ç”¨LANçš„ç½‘ç»œåœ°å€è½¬æ¢å¹¶æ·»åŠ æœ€å°é˜²ç«å¢™è§„åˆ™çš„æ­¥éª¤åŸºæœ¬å®Œæˆï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/firehol/firehol.conf version 6 <span class="hljs-comment"><span class="hljs-comment"># Accept all client traffic on WAN interface enp1s0 wan client all accept # Accept all traffic on LAN interface br0 lan server all accept client all accept # Route packets between LAN and WAN router lan2wan inface br0 outface enp1s0 masquerade route all accept</span></span></code> </pre> <br>  <i>FireHOLæ˜¯äººä»¬ä¸ºäººä»¬ç¼–å†™çš„ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æ˜¯æ–‡æ¡£ã€‚</i> <br><br> æ‚¨å¯ä»¥é€šè¿‡æ‰‹åŠ¨å¯åŠ¨<code>firehol</code> ï¼ˆ <code>sudo firehol start</code> ï¼‰å¹¶å°†ä¾¿æºå¼è®¡ç®—æœºè¿æ¥åˆ°LANç«¯å£æ¥æ£€æŸ¥è®¾ç½®ï¼š <b>ç°åœ¨ï¼Œ</b>å¦‚æœå·²è¿æ¥WANç«¯å£ï¼Œåˆ™<b>å¯ä»¥è”æœº</b> ã€‚ <br><br> é‡æ–°å¼•å¯¼ä¹‹å‰ï¼Œè¯·<b>ç¡®ä¿</b>ç¼–è¾‘<code>/etc/default/firehol</code>ä»¥å…è®¸FireHolåœ¨å¼•å¯¼æ—¶å¯åŠ¨ï¼š <br><br><pre> <code class="bash hljs">$ sudo sed -i -E <span class="hljs-string"><span class="hljs-string">"s/^START_FIREHOL=.+$/START_FIREHOL=YES/g"</span></span> /etc/default/firehol</code> </pre> <br>  <i>æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»æ•´ä¸ª<code>firehol</code>è¯­æ³•ï¼Œé…ç½®æ–‡ä»¶ä¼šè‡ªè¡Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯´æ˜</a> ï¼Œå¦‚æœé…ç½®æ›´å¤æ‚ï¼Œå»ºè®®æ‚¨<code>firehol</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£</a> ã€‚</i>  <i>å¦‚æœæ‚¨çœŸçš„å¯¹<code>firehol</code>å¯¹<code>iptables</code>åšäº†ä»€ä¹ˆæ„Ÿå…´è¶£ï¼Œåªéœ€åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>sudo firehol status</code> ã€‚</i> <br><br><h2> æ— çº¿çƒ­ç‚¹ </h2><br> æ˜¾ç„¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">hostapd</a>ç®¡ç†è®¿é—®ç‚¹ï¼š <br><br><pre> <code class="bash hljs">$ sudo apt-get install hostapd</code> </pre> <br> åœ¨ä¸‹é¢ï¼Œæ‚¨å°†æ‰¾åˆ°æœ€å°ä¸”å‡ ä¹æ— æ³•è§£é‡Šçš„802.11 n / 2.4 Ghz / WPA2-AESé…ç½®æ–‡ä»¶ï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/hostapd/hostapd-simple.conf <span class="hljs-comment"><span class="hljs-comment">#### Interface configuration #### interface=wlp5s0 bridge=br0 driver=nl80211 ##### IEEE 802.11 related configuration ##### ssid=iCanHearYouHavingSex hw_mode=g channel=1 auth_algs=1 wmm_enabled=1 ##### IEEE 802.11n related configuration ##### ieee80211n=1 ##### WPA/IEEE 802.11i configuration ##### wpa=2 wpa_key_mgmt=WPA-PSK rsn_pairwise=CCMP wpa_passphrase=YouCantGuess</span></span></code> </pre> <br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯·å‚é˜…</a> <code>hostpad.conf</code> <code>/usr/share/doc/hostapd/examples/hostapd.conf</code>æ–‡æ¡£</i> ã€‚ <br><br> å¯ä»¥æ‰‹åŠ¨æµ‹è¯•æè¿°çš„é…ç½®ï¼š <br><br><pre> <code class="bash hljs">$ sudo hostapd /etc/hostapd/hostapd-simple.conf</code> </pre> <br> å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œ <b>å°†å‡ºç°æ— çº¿è¿æ¥</b> ã€‚ å¦‚æœæ‚¨å¯¹ç»“æœæ„Ÿåˆ°æ»¡æ„ï¼Œ <b>è¯·ä¸è¦å¿˜è®°</b>æ›´æ”¹é…ç½®ä»¥åœ¨æ¥å£ä¸Šå‡åç«‹å³å¯åŠ¨<code>hostapd</code> ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ã€‚ <br><br>  <b>è¿™æ˜¯æ‚¨çš„æœ€ç»ˆ<code>/etc/network/interfaces:</code></b> <br><br><pre> <code class="bash hljs">$ cat /etc/network/interfaces <span class="hljs-comment"><span class="hljs-comment"># Loopback auto lo iface lo inet loopback # WAN interface auto enp1s0 iface enp1s0 inet dhcp # Bridge (LAN) auto br0 iface br0 inet static address 192.168.1.1 network 192.168.1.0 netmask 255.255.255.0 broadcast 192.168.1.255 bridge_ports enp2s0 post-up /usr/sbin/hostapd \ -P /var/run/hostapd.$IFACE.pid \ -B /etc/hostapd/hostapd-simple.conf post-up /usr/sbin/dnsmasq \ --pid-file=/var/run/dnsmasq.$IFACE.pid \ --dhcp-leasefile=/var/lib/misc/dnsmasq.$IFACE.leases \ --conf-file=/dev/null \ --interface=$IFACE --except-interface=lo \ --bind-interfaces \ --dhcp-range=192.168.1.10,192.168.1.150,24h pre-down cat /var/run/dnsmasq.$IFACE.pid | xargs kill pre-down cat /var/run/hostapd.$IFACE.pid | xargs kill</span></span></code> </pre> <br><a name="3"></a><h1> è®¾ç½®802.11acæ¥å…¥ç‚¹ï¼ˆ5 GHzï¼‰ </h1><br><h2> è¢«åŠ¨æ‰«æ </h2><br> æ ¹æ®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Airetos AEX-QCA9880-NX</a>æ–‡æ¡£ï¼Œè¯¥èŠ¯ç‰‡ç»„æ”¯æŒ802.11acï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ‹¥æŒ¤çš„2.4 GHzä¿¡é“ç•™ç»™å¤©å ‚5 GHzã€‚ <br><br> è®©æˆ‘ä»¬çœ‹çœ‹æ”¯æŒå“ªäº›é¢‘ç‡ï¼š <br><br><pre> <code class="plaintext hljs">$ iw list ... Frequencies: * 2412 MHz [1] (20.0 dBm) * 2417 MHz [2] (20.0 dBm) * 2422 MHz [3] (20.0 dBm) * 2427 MHz [4] (20.0 dBm) * 2432 MHz [5] (20.0 dBm) * 2437 MHz [6] (20.0 dBm) * 2442 MHz [7] (20.0 dBm) * 2447 MHz [8] (20.0 dBm) * 2452 MHz [9] (20.0 dBm) * 2457 MHz [10] (20.0 dBm) * 2462 MHz [11] (20.0 dBm) * 2467 MHz [12] (disabled) * 2472 MHz [13] (disabled) * 2484 MHz [14] (disabled) ... Frequencies: * 5180 MHz [36] (17.0 dBm) (no IR) * 5200 MHz [40] (17.0 dBm) (no IR) * 5220 MHz [44] (17.0 dBm) (no IR) * 5240 MHz [48] (17.0 dBm) (no IR) * 5260 MHz [52] (23.0 dBm) (no IR, radar detection) * 5280 MHz [56] (23.0 dBm) (no IR, radar detection) * 5300 MHz [60] (23.0 dBm) (no IR, radar detection) * 5320 MHz [64] (23.0 dBm) (no IR, radar detection) * 5500 MHz [100] (23.0 dBm) (no IR, radar detection) * 5520 MHz [104] (23.0 dBm) (no IR, radar detection) * 5540 MHz [108] (23.0 dBm) (no IR, radar detection) * 5560 MHz [112] (23.0 dBm) (no IR, radar detection) * 5580 MHz [116] (23.0 dBm) (no IR, radar detection) * 5600 MHz [120] (23.0 dBm) (no IR, radar detection) * 5620 MHz [124] (23.0 dBm) (no IR, radar detection) * 5640 MHz [128] (23.0 dBm) (no IR, radar detection) * 5660 MHz [132] (23.0 dBm) (no IR, radar detection) * 5680 MHz [136] (23.0 dBm) (no IR, radar detection) * 5700 MHz [140] (23.0 dBm) (no IR, radar detection) * 5720 MHz [144] (23.0 dBm) (no IR, radar detection) * 5745 MHz [149] (30.0 dBm) (no IR) * 5765 MHz [153] (30.0 dBm) (no IR) * 5785 MHz [157] (30.0 dBm) (no IR) * 5805 MHz [161] (30.0 dBm) (no IR) * 5825 MHz [165] (30.0 dBm) (no IR) ...</code> </pre> <br> åœ¨ä¸Šé¢çš„åˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°èŠ¯ç‰‡ç»„æ”¯æŒé€šé“1-14ï¼ˆ2.4 GHzï¼‰å’Œé€šé“36-165ï¼ˆ5 GHzï¼‰ï¼Œä½†æ˜¯æ‚¨æ˜¯å¦æ³¨æ„åˆ°<code>no IR</code>æ ‡å¿—ï¼Ÿ <br><br>  <code>no IR</code>æ ‡å¿—è¡¨ç¤º<i>æ— è¾å°„</i> ï¼ˆå³<i>è¢«åŠ¨æ‰«æ</i> ï¼‰ã€‚ è¿™æ„å‘³ç€åœ¨è®¾å¤‡é¦–æ¬¡å¯åŠ¨è¾å°„ï¼ˆåŒ…æ‹¬<b>ä¿¡æ ‡</b> ï¼‰çš„æƒ…å†µä¸‹ï¼Œç¦æ­¢ä½¿ç”¨æ­¤æ¨¡å¼ã€‚ æ¢å¥è¯è¯´ï¼Œ <b>æ‚¨ä¸èƒ½åœ¨è¿™äº›é€šé“ä¸Šè¿è¡Œæ¥å…¥ç‚¹</b> ï¼ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/03f/743/e75/03f743e7505714ae9864dcce2b5b4964.gif"></div><br><br><h2> æ³•è§„è¦æ±‚ </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Linux</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ³•è§„è¦æ±‚</a>è§£é‡Šäº†ä¸Šè¿°æƒ…å†µï¼Œè¯¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ³•è§„è¦æ±‚</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ ¹æ®å›½å®¶/åœ°åŒº</a>æ¥è§„èŒƒå°„é¢‘é¢‘è°±çš„ä½¿ç”¨ã€‚ <br><br> ä½†æ˜¯ï¼Œå˜¿ï¼ <br><br> æˆ‘ä½åœ¨ç¾å›½ï¼Œè¯¥é“¾æ¥è¯´æˆ‘æœ‰æƒåœ¨36-48é¢‘é“ä¸Šå‘èµ·è¾å°„ï¼Œé‚£æ€ä¹ˆå›äº‹ï¼Ÿ è®©æˆ‘ä»¬çœ‹çœ‹å½“å‰æ­£åœ¨ä½¿ç”¨å“ªä¸ªç›‘ç®¡åŸŸï¼š <br><br><pre> <code class="plaintext hljs">$ iw reg get country 00: DFS-UNSET (2402 - 2472 @ 40), (N/A, 20), (N/A) (2457 - 2482 @ 40), (N/A, 20), (N/A), NO-IR (2474 - 2494 @ 20), (N/A, 20), (N/A), NO-OFDM, NO-IR (5170 - 5250 @ 80), (N/A, 20), (N/A), NO-IR (5250 - 5330 @ 80), (N/A, 20), (0 ms), DFS, NO-IR (5490 - 5730 @ 160), (N/A, 20), (0 ms), DFS, NO-IR (5735 - 5835 @ 80), (N/A, 20), (N/A), NO-IR (57240 - 63720 @ 2160), (N/A, 0), (N/A)</code> </pre> <br> é—®é¢˜æ˜¾ç¤ºè¯¥<i>ä¸–ç•Œ</i>åŸŸå½“å‰å¤„äºæ´»åŠ¨çŠ¶æ€ï¼ˆæˆ–æœªå®‰è£…ï¼‰ï¼Œå³<b>æ¯ä¸ªå›½å®¶/åœ°åŒºå…è®¸</b>çš„<b>æœ€å°å€¼</b> ã€‚ <br><br> ä¸å¹¸çš„æ˜¯ï¼Œæ‚¨ä¸èƒ½æ‰‹åŠ¨å®‰è£…<code>sudo iw reg set</code>åŸŸï¼Œå› ä¸ºè¯¥åŸŸåœ¨EEPROMä¸­å—ä¿æŠ¤ï¼š <br><br><pre> <code class="plaintext hljs">$ dmesg | grep EEPROM [ 12.123068] ath: EEPROM regdomain: 0x6c</code> </pre> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5de/5a9/ae2/5de5a9ae216cf2c3f2f9416b4ffa54bc.gif"></div><br><h2> è¡¥ä¸ï¼ </h2><br> å¹¸è¿çš„æ˜¯ï¼Œæ³•è§„è¦æ±‚æ˜¯åœ¨é©±åŠ¨ç¨‹åºçº§åˆ«å¤„ç†çš„ï¼Œå› æ­¤å¯ä»¥è½»æ¾æ›´æ”¹å®ƒä»¬ï¼šæˆ‘ä»¬åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Open-WRTæºä»£ç ä¸­</a>æ‰¾åˆ°äº†è¡¥ä¸ã€‚ <br><br> é¦–å…ˆï¼Œä¸è¦å¿˜è®°ä»<code>/etc/apt/sources.list</code>è¿æ¥æºä»£ç å­˜å‚¨åº“ï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/apt/sources.list ... deb-src http://us.archive.ubuntu.com/ubuntu/ bionic main restricted ...</code> </pre> <br> ç„¶åé€šè¿‡å®‰è£…å¿…è¦çš„ä¾èµ–é¡¹æ¥å‡†å¤‡ç¯å¢ƒï¼š <br><br><pre> <code class="bash hljs">$ sudo apt-get install build-essential fakeroot $ sudo apt-get build-dep linux</code> </pre> <br> ä¸‹è½½æ‚¨çš„å†…æ ¸æºä»£ç ï¼š <br><br><pre> <code class="bash hljs">$ apt-get <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> linux</code> </pre> <br> ç”±äºæ„å»ºç³»ç»Ÿä¸­çš„ç»†å¾®å·®å¼‚ï¼Œç”±äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸå§‹çš„</a> Open-WRTè¡¥ä¸æ— æ³•â€œæŒ‰åŸæ ·â€åº”ç”¨äºUbuntuå†…æ ¸æ ‘ï¼Œå› æ­¤æˆ‘å¿…é¡»å¯¹å…¶è¿›è¡Œä¿®å¤ï¼š <br><br><pre> <code class="bash hljs">$ VERSION=$(uname -r) $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> linux-<span class="hljs-variable"><span class="hljs-variable">${VERSION%%-*}</span></span> $ wget -O - https://gist.github.com/renaudcerrato/02de8b2e8dc013bc71326defd2ef062c/raw/a2db325e520e6442c8c12f7599d64ac1b7596a3e/402-ath_regd_optional.patch | patch -p1 -b</code> </pre> <br> ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥è¿›è¡Œç»„è£…ï¼š <br><br><pre> <code class="bash hljs">$ fakeroot debian/rules clean $ fakeroot debian/rules binary-generic</code> </pre> <br> å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œç°åœ¨æ‚¨å¯ä»¥åœ¨å‰ä¸€ä¸ªå†…æ ¸ä¹‹ä¸Šå®‰è£…å›ºå®šå†…æ ¸ï¼š <br><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .. $ sudo dpkg -i linux*.deb</code> </pre> <br> é‡æ–°å¯åŠ¨ï¼Œç§ï¼š <br><br><pre> <code class="bash hljs">$ sudo iw reg <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> US $ iw list ... Frequencies: * 5180 MHz [36] (17.0 dBm) * 5200 MHz [40] (17.0 dBm) * 5220 MHz [44] (17.0 dBm) * 5240 MHz [48] (17.0 dBm) * 5260 MHz [52] (23.0 dBm) (radar detection) * 5280 MHz [56] (23.0 dBm) (radar detection) * 5300 MHz [60] (23.0 dBm) (radar detection) * 5320 MHz [64] (23.0 dBm) (radar detection) * 5500 MHz [100] (23.0 dBm) (radar detection) * 5520 MHz [104] (23.0 dBm) (radar detection) * 5540 MHz [108] (23.0 dBm) (radar detection) * 5560 MHz [112] (23.0 dBm) (radar detection) * 5580 MHz [116] (23.0 dBm) (radar detection) * 5600 MHz [120] (23.0 dBm) (radar detection) * 5620 MHz [124] (23.0 dBm) (radar detection) * 5640 MHz [128] (23.0 dBm) (radar detection) * 5660 MHz [132] (23.0 dBm) (radar detection) * 5680 MHz [136] (23.0 dBm) (radar detection) * 5700 MHz [140] (23.0 dBm) (radar detection) * 5720 MHz [144] (23.0 dBm) (radar detection) * 5745 MHz [149] (30.0 dBm) * 5765 MHz [153] (30.0 dBm) * 5785 MHz [157] (30.0 dBm) * 5805 MHz [161] (30.0 dBm) * 5825 MHz [165] (30.0 dBm) ...</code> </pre> <br>  <i>ä¸ºäº†é¿å…è‡ªåŠ¨æ›´æ–°ï¼Œæ‚¨å¯èƒ½éœ€è¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿®å¤Linuxå†…æ ¸ç‰ˆæœ¬</a> ã€‚</i> <br><br><h2> æ„å‹ </h2><br> æ–°çš„<code>hostapd</code>é…ç½®<code>hostapd</code>å°†éå¸¸ç®€å•ï¼š <code>hw_mode=a</code>åŒ…æ‹¬5 GHzé¢‘å¸¦ï¼Œè€Œ<code>ieee80211ac=1</code>åŒ…æ‹¬802.11acï¼ˆVHTï¼‰ã€‚  <code>country_code=US</code>çš„<code>ieee80211d=1</code>é€‰é¡¹æŒ‡å®šäº†æˆ‘ä»¬è¿è¥æ‰€åœ¨çš„ç›‘ç®¡åŸŸã€‚ <br><br> ä¸ºäº†å……åˆ†åˆ©ç”¨å¸¦å®½ï¼Œ <code>ht_capab</code>å’Œ<code>vht_capab</code>åº”è¯¥åæ˜ ç¡¬ä»¶åŠŸèƒ½ï¼š <br><br><pre> <code class="bash hljs">$ iw list ... Band 1: Capabilities: 0x19e3 RX LDPC HT20/HT40 Static SM Power Save RX HT20 SGI RX HT40 SGI TX STBC RX STBC 1-stream Max AMSDU length: 7935 bytes DSSS/CCK HT40 ... Band 2: VHT Capabilities (0x338001b2): Max MPDU length: 11454 Supported Channel Width: neither 160 nor 80+80 RX LDPC short GI (80 MHz) TX STBC RX antenna pattern consistency TX antenna pattern consistency</code> </pre> <br> è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œ <b>è¿™æ˜¯æœ€ç»ˆçš„</b> <code>hostapd.conf</code> ï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/hostapd/hostapd.conf <span class="hljs-comment"><span class="hljs-comment">#### Interface configuration #### interface=wlp5s0 bridge=br0 driver=nl80211 ##### IEEE 802.11 related configuration ##### ssid=iCanHearYouHavingSex hw_mode=a channel=0 auth_algs=1 wmm_enabled=1 country_code=US ieee80211d=1 ieee80211h=0 ##### IEEE 802.11n related configuration ##### ieee80211n=1 ht_capab=[HT40+][SHORT-GI-20][SHORT-GI-40][TX-STBC][RX-STBC1][DSSS_CK-40][LDPC][MAX-AMSDU-7935] ##### IEEE 802.11ac related configuration ##### ieee80211ac=1 vht_capab=[MAX-MPDU-11454][RXLDPC][SHORT-GI-80][TX-STBC-2BY1][RX-STBC-1][MAX-A-MPDU-LEN-EXP7][TX-ANTENNA-PATTERN][RX-ANTENNA-PATTERN] vht_oper_chwidth=1 ##### WPA/IEEE 802.11i configuration ##### wpa=2 wpa_key_mgmt=WPA-PSK rsn_pairwise=CCMP wpa_passphrase=YouCantGuess</span></span></code> </pre> <br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯·å‚é˜…</a> <code>hostpad.conf</code> <code>/usr/share/doc/hostapd/examples/hostapd.conf</code>æ–‡æ¡£</i> ã€‚ <br><br> è‡³æ­¤ï¼Œæ— çº¿è·¯ç”±å™¨å·²å®Œå…¨è¿è¡Œï¼Œå¦‚æœæ‚¨éœ€è¦æ›´å¤æ‚çš„é…ç½®ï¼Œåˆ™å¯ä»¥æ·±å…¥ç ”ç©¶é…ç½®æ–‡ä»¶ã€‚ <br><br><a name="4"></a><h1> ä½¿ç”¨hostapdé…ç½®è™šæ‹ŸSSID </h1><br> æ— è®ºæ‚¨æ˜¯è¦ä¸ºVPNé…ç½®è®¿å®¢è®¿é—®ç‚¹è¿˜æ˜¯ä¸“ç”¨æ— çº¿ç½‘ç»œï¼Œéƒ½å¿…é¡»åœ¨æŸä¸ªæ—¶å€™é…ç½®è™šæ‹ŸSSIDã€‚ <br><br><h2> å›¾è¡¨ </h2><br> æ ¹æ®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å½“å‰é…ç½®</a> ï¼Œè¿™æ˜¯æˆ‘ä»¬æƒ³è¦è·å¾—çš„æ›´æ–°å›¾ã€‚ å‡è®¾<code>wlp5s0</code>æ˜¯ç‰©ç†æ— çº¿æ¥å£ï¼Œåˆ™è™šæ‹ŸSSIDå°†ä½¿ç”¨è‡ªå·±çš„<code>192.168.2.0/24</code>å­ç½‘åœ¨<code>wlan0</code>è™šæ‹Ÿæ¥å£ä¸Šè¿è¡Œï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/096/450/32b/09645032b28e7310ad93b2109efb0860.png"><br><br><h2> å‡†å¤‡å·¥ä½œ </h2><br> é¦–å…ˆï¼Œæ£€æŸ¥æ‚¨çš„æ— çº¿è®¾å¤‡æ˜¯å¦æ”¯æŒå¤šä¸ªSSIDï¼š <br><br><pre> <code class="bash hljs">$ iw list ... valid interface combinations: * <span class="hljs-comment"><span class="hljs-comment">#{ AP, mesh point } &lt;= 8, total &lt;= 8, #channels &lt;= 1, STA/AP BI must match ...</span></span></code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œè¯¥èŠ¯ç‰‡ç»„åœ¨ä¸€ä¸ªé€šé“ä¸Šæœ€å¤šæ”¯æŒå…«ä¸ªæ¥å…¥ç‚¹ã€‚ è¿™æ„å‘³ç€æ‚¨æœ€å¤šå¯ä»¥é…ç½®ä¸ƒä¸ªè™šæ‹ŸSSIDï¼Œå¹¶ä¸”å®ƒä»¬éƒ½å°†åœ¨åŒä¸€é€šé“ä¸Šå·¥ä½œã€‚ <br><br><h2> ç½‘ç»œæ¥å£ </h2><br> æ ¹æ®hostapd.confä¸­çš„æ–‡æ¡£ï¼Œç‰©ç†æ¥å£çš„MACåœ°å€ä¸è™šæ‹Ÿæ¥å£çš„BSSIDä¹‹é—´å­˜åœ¨ä¸¥æ ¼çš„è¿æ¥ï¼š <br><br><blockquote>  hostapdå°†åŸºäºé…ç½®çš„BSSIDç”ŸæˆBSSIDæ©ç ã€‚  <b>hostapdå°†éªŒè¯dev_addrå’ŒMASK == dev_addr</b> ã€‚ å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œåˆ™å¿…é¡»åœ¨å¯åŠ¨hostapdä¹‹å‰æ›´æ”¹æ— çº¿ç”µçš„MACåœ°å€ã€‚ å¦‚æœä¸ºæ¯ä¸ªè¾…åŠ©BSSé…ç½®äº†BSSIDï¼Œåˆ™æ­¤é™åˆ¶ä¸é€‚ç”¨äºhostapdï¼Œå¹¶ä¸”å¦‚æœé©±åŠ¨ç¨‹åºæ”¯æŒï¼Œåˆ™å¯ä»¥ä½¿ç”¨å…¶ä»–æ©ç ï¼ˆä¾‹å¦‚ï¼Œäº¤æ¢æœ¬åœ°ç®¡ç†çš„ä½ï¼‰ <br><br> é™¤éä½¿ç”¨'bssid'å‚æ•°æŒ‡å®šäº†æ˜ç¡®çš„BSSIDï¼Œå¦åˆ™å°†æŒ‰é¡ºåºå°†BSSIDåˆ†é…ç»™æ¯ä¸ªBSSã€‚ <br><br> å¦‚æœæŒ‡å®šäº†æ˜¾å¼çš„BSSIDï¼Œåˆ™å¿…é¡»è¿™æ ·é€‰æ‹©å®ƒï¼š <br>  -ç”Ÿæˆè¦†ç›–å®ƒå’Œdev_addrçš„æœ‰æ•ˆMASK <br>  -ä¸ç”µå°çš„MACåœ°å€ä¸åŒ <br>  -ä¸ä»»ä½•å…¶ä»–æ˜ç¡®æŒ‡å®šçš„BSSIDä¸åŒ </blockquote><br> ä¸ºäº†æ»¡è¶³è¿™äº›è¦æ±‚å¹¶å…è®¸<code>hostapd</code>è‡ªåŠ¨åˆ†é…è™šæ‹Ÿæ¥å£çš„BSSIDï¼Œæˆ‘ä»¬é€šè¿‡å°†å››ä¸ªæœ€ä½æœ‰æ•ˆä½æ¸…é›¶æ¥æ›´æ–°ç‰©ç†æ— çº¿æ¥å£çš„MACåœ°å€ã€‚ è¿™å¯¹äº15ä¸ªè™šæ‹ŸBSSIDè€Œè¨€å·²è¶³å¤Ÿ-è¿œè¿œè¶…å‡ºäº†å¿…è¦ã€‚ <br><br> é¦–å…ˆï¼Œç¡®å®šå½“å‰çš„MACåœ°å€ï¼š <br><br><pre> <code class="bash hljs">$ ip addr show wlp5s0 | grep link | awk <span class="hljs-string"><span class="hljs-string">'{print $2}'</span></span> 44:c3:06:00:03:eb</code> </pre> <br> å¦‚æœæ¸…é™¤æœ€åå››ä½å¹¶è®¾ç½®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">U / Lä½</a> ï¼Œåˆ™å°†è·å¾—MACåœ°å€<code>46:c3:06:00:03:e0</code> ã€‚ <br><br> ç°åœ¨ï¼Œæˆ‘ä»¬å°†åœ¨åŠ è½½æ¥å£ä¹‹å‰æ›´æ–°é…ç½®ä»¥è®¾ç½®æ­£ç¡®çš„MACåœ°å€ï¼Œå¹¶æ ¹æ®æˆ‘ä»¬çš„ç¤ºæ„å›¾å£°æ˜ä¸€ä¸ªè™šæ‹Ÿæ— çº¿æ¥å£ï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/network/interfaces ... <span class="hljs-comment"><span class="hljs-comment"># Physical Wireless auto wlp5s0 iface wlp5s0 inet manual pre-up ip link set dev wlp5s0 address 46:c3:06:00:03:e0 # Virtual Wireless allow-hotplug wlan0 iface wlan0 inet static address 192.168.2.1 network 192.168.2.0 netmask 255.255.255.0 broadcast 192.168.2.255 post-up /usr/sbin/dnsmasq \ --pid-file=/var/run/dnsmasq-wlan0.pid \ --conf-file=/dev/null \ --interface=wlan0 --except-interface=lo \ --bind-interfaces \ --dhcp-range=192.168.2.10,192.168.2.150,24h post-down cat /var/run/dnsmasq-wlan0.pid | xargs kill ...</span></span></code> </pre> <br> å¤ªå¥½äº† æˆ‘å°†<code>dnsmasq</code>ç”¨ä½œDHCPæœåŠ¡å™¨-éšæ—¶æ›¿æ¢ä¸ºæ‚¨å–œæ¬¢çš„ä»»ä½•å†…å®¹ã€‚ è¯·æ³¨æ„ï¼Œä¸ºä½¿è™šæ‹Ÿæ¥å£æ­£å¸¸å·¥ä½œï¼Œéœ€è¦<code>allow-hotplug</code> ã€‚ <br><br><h2> æ¥å…¥ç‚¹é…ç½® </h2><br> ç°åœ¨æœ€ç®€å•çš„äº‹æƒ…æ˜¯ï¼šå°†è™šæ‹ŸSSIDæ·»åŠ åˆ°å½“å‰çš„<code>hostapd</code>é…ç½®ä¸­ã€‚ åªéœ€å°†å…¶æ·»åŠ <b>åˆ°</b>ç°æœ‰<code>hostapd.conf</code>æ–‡ä»¶çš„æœ«å°¾ï¼š <br><br><pre> <code class="bash hljs">$ cat /etc/hostapd/hostapd.conf ... <span class="hljs-comment"><span class="hljs-comment">### Virtual SSID(s) ### bss=wlan0 ssid=MyVirtualSSID wpa=2 wpa_key_mgmt=WPA-PSK rsn_pairwise=CCMP wpa_passphrase=you_cant_guess</span></span></code> </pre> <br> åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†WPA2åŠ å¯†ï¼Œä½†æ˜¯å¤§å¤šæ•°æ— çº¿æ¥å£é€‰é¡¹éƒ½å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼Œ <code>channel</code> ï¼‰ã€‚ æ‚¨åªéœ€æ ¹æ®å·²å£°æ˜å¹¶æ­£ç¡®é…ç½®çš„è™šæ‹Ÿæ¥å£åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ è¡Œå³å¯æ·»åŠ æ›´å¤šè™šæ‹ŸSSIDã€‚ <br><br> ç°åœ¨é‡æ–°å¯åŠ¨-å¹¶æŸ¥çœ‹æ–°çš„SSIDå’Œæ–°çš„æ— çº¿æ¥å£ï¼ˆæ³¨æ„MACåœ°å€ï¼‰ï¼š <br><br><pre> <code class="bash hljs">$ ip addr show wlan0 | grep link | awk <span class="hljs-string"><span class="hljs-string">'{print $2}'</span></span> 46:c3:06:00:03:e1</code> </pre> <br>  <b>å°±æ˜¯è¿™æ ·ï¼</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN437634/">https://habr.com/ru/post/zh-CN437634/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN437622/index.html">Azureæœºå™¨å­¦ä¹ æœåŠ¡å…¥é—¨</a></li>
<li><a href="../zh-CN437624/index.html">OpenSceneGraphï¼šçº¹ç†åŸºç¡€</a></li>
<li><a href="../zh-CN437626/index.html">ä¸€ä¸ªç®€å•ä¾‹å­çš„äº¤æ˜“å¹³å°æ€§èƒ½</a></li>
<li><a href="../zh-CN437630/index.html">BETTä¼šè®®ä¸ŠMicrosoftçš„ä¸»è¦å…¬å‘Š</a></li>
<li><a href="../zh-CN437632/index.html">æ··æ­ï¼Œè¯­è¨€çš„åŸºç¡€</a></li>
<li><a href="../zh-CN437636/index.html">åœ¨Microsoft Storeä¸Šå‘å¸ƒåº”ç”¨ç¨‹åºï¼šä¸€å¹´ä¸­çš„ä¸€äº›æ›´æ”¹</a></li>
<li><a href="../zh-CN437638/index.html">â€œç­”æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿâ€ éå®¡ç¨¿äºº å¤§æ°”å‹ç®¡å’Œç„Šæ¥</a></li>
<li><a href="../zh-CN437640/index.html">å“ç‰Œå¦‚ä½•çªç ´ç§‘æŠ€åª’ä½“æ³¡æ²«</a></li>
<li><a href="../zh-CN437642/index.html">å¦‚æœçª—æˆ·æ‰“å¼€ï¼Œé‚£ä¹ˆæœ‰äººéœ€è¦</a></li>
<li><a href="../zh-CN437646/index.html">3Dæ‰“å°æœºçš„æœ‰ç”¨å’Œéæ˜¾è€Œæ˜“è§çš„äº‹ç‰©ï¼š3Dæ‰“å°æœºçš„å°äº‹ç‰©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>