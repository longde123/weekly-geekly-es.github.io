<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîñ ‚å®Ô∏è ‚öΩÔ∏è Exploration mobile d'ex√©cution iOS avec Objection, ou pirater notre propre application üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø üîè ü§õüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publi√© par Andrey Batutin, d√©veloppeur iOS senior, DataArt. 

 Plus d'une ou deux fois, quand je suis arriv√© au travail (ou que je suis juste sorti du...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Exploration mobile d'ex√©cution iOS avec Objection, ou pirater notre propre application</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/429196/"><img src="https://habrastorage.org/webt/l1/_s/ly/l1_slyrmahxsxmkciorh7werir8.jpeg"><br><br>  <i>Publi√© par Andrey Batutin, d√©veloppeur iOS senior, DataArt.</i> <br><br>  Plus d'une ou deux fois, quand je suis arriv√© au travail (ou que je suis juste sorti du lit), j'ai trouv√© une lettre en col√®re dans le courrier, dont l'essence √©tait que rien ne fonctionne dans l'assemblage de l'application par l'appstor, et que tout doit √™tre r√©par√© de toute urgence. <br><br>  Parfois, la raison en √©tait mes bancs.  Parfois mes coll√®gues.  Et parfois m√™me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apple Inc lui-m√™me</a> . <br><br>  Mais les sc√©narios les plus meurtriers √©taient li√©s √† des bogues qui n'√©taient reproduits que sur les versions d'application / version.  Rien ne d√©route et vous fait hurler devant un macbook, comme l'impossibilit√© de connecter un d√©bogueur √† votre propre application et de voir ce qui s'y passe. <a name="habracut"></a><br><br>  Des probl√®mes similaires sont cr√©√©s par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">APNS</a> et son d√©pannage sur les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">assemblys</a> de version / ad-hoc. <br>  Sur les assemblys o√π existe un environnement APNS de production, vous ne pouvez pas connecter un d√©bogueur. <br>  Sur les assemblys o√π il y a un d√©bogueur, il n'y a pas de push de production APNS.  Mais ils tombent g√©n√©ralement. <br><br>  Apple, comme le dieu de l'Ancien Testament, donne d'une part une plate-forme o√π le jailbreak va bient√¥t entrer dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">histoire</a> (et le piratage dans l'App Store reste au niveau d'erreur statistique), et l'autre fait que le d√©veloppeur se sent comme un pauvre parent, le petit Oliver Twist, qui a os√© demander plus de bouillie. <br><br><img src="https://habrastorage.org/webt/ru/h5/6x/ruh56xq-zncwzkfg1utdqp3c0xw.gif"><br>  <i>Voix off: "Oncle Apple, donnez-moi un autre certificat de distribution ..."</i> <br><br>  Pour le programmeur moyen, faire quelque chose avec la version release / appstore d'une application iOS √©tait presque impossible.  Il √©tait plus facile de quitter avant la sortie. <br><br>  En bref: <br><br>  La version finale est sign√©e par le certificat de distribution et utilise le profil d'approvisionnement de distribution.  Le droit interdit d‚Äôattacher un d√©bogueur au processus de demande.  De plus, lors du t√©l√©chargement de l'ipa sur l'App Store, le binaire est √©galement crypt√©.  Les extensions d'application sont sign√©es s√©par√©ment. <br><br>  Autrement dit, l'auteur de l'application semble √™tre en mesure de prendre et de signer √† nouveau l'assembly App Store avec un certificat √† l'aide du profil d'approvisionnement.  Mais vous devez toujours savoir comment le faire.  Mais m√™me apr√®s cela, la question de savoir comment connecter le d√©bogueur au processus d'application reste ouverte. <br><br>  Par cons√©quent, nous devons nous concentrer exclusivement sur la non-adaptation au stade du d√©veloppement.  Et attrapez tous les bugs avant que l'application ne quitte l'App Store.  Et les journaux, plus de journaux pour le dieu des journaux! <br><br><img src="https://habrastorage.org/webt/ro/0t/pc/ro0tpcf-d0z-jbinkdtm2tcawg4.gif"><br><br>  Mais r√©cemment, un nouvel espoir se profile √† l'horizon. <br><br><img src="https://habrastorage.org/webt/o7/je/vz/o7jevzl9q-oyhytrykl3rilt0ie.gif"><br><br>  Dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie</a> pr√©c√©dente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">,</a> nous avons rencontr√© Frida, un merveilleux framework pour l'injection de code dynamique.  Et contourn√© avec lui l'√©pinglage SSL dans l'excellent projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FoodSniffer</a> . <br><br>  Dans cet article, nous allons nous familiariser avec un framework cr√©√© sur la base de Frida, qui facilite grandement la manipulation des versions de versions des applications iOS. <br><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Objection</a> </h2><br>  L'objection <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vous</a> permet d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">injecter</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FridaGadget</a> dans une version iOS et de la signer √† nouveau avec le certificat et le profil d'approvisionnement souhait√©s. <br><br><h3>  La pr√©paration </h3><br>  Nous avons d'abord besoin de la version Release de FoodSniffer. <br><br>  Remarque importante - lors de la cr√©ation d'un ipa, d√©sactivez ¬´Inclure le code bit pour le contenu iOS¬ª. <br><br><img src="https://habrastorage.org/webt/5w/du/b2/5wdub2c1inuc66_xkxgadrkqnti.png"><br><br>  Ensuite, nous avons besoin d'un profil d'approvisionnement pour la g√©n√©ration de build. <br><br>  Pour l'obtenir: <br><br><ol><li>  Installez l'application via Xcode sur l'appareil. </li><li>  Recherchez FoodSniffer.app dans le Finder. <br><br><img src="https://habrastorage.org/webt/q1/xd/tt/q1xdtt4k8aig7-7qls--eva7lhk.png"></li><li>  Acc√©dez au pack FoodSniffer. <br><br><img src="https://habrastorage.org/webt/fg/ww/rc/fgwwrcpp98jrz8gorivzi8wjanc.png"></li><li>  Copiez <b>embedded.mobileprovision</b> de l√† dans le dossier avec votre version ipa. <br><br><img src="https://habrastorage.org/webt/dc/fa/ix/dcfaixrevudcaj1fiwexmkbshn8.png"></li></ol><br>  Vous devriez obtenir quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/lo/py/4k/lopy4kzw1olxcv-4lv18wmpmlp0.png"><br><br>  Apr√®s cela, installez l'objection conform√©ment aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instructions</a> .  Je recommande fortement d'utiliser l'option virtualenv. <br><br>  En plus de l'objection, nous aurons besoin d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ios-deploy</a> pour ex√©cuter l'application corrig√©e sur l'appareil. <br><br><h3>  Re-signez l'application! </h3><br>  Dans le terminal, d√©couvrez le hachage de l'identit√© de signe de code dont nous avons besoin: <br><br>  <b>s√©curit√© trouver-identit√© -p codesigning -v</b> <br><br><img src="https://habrastorage.org/webt/e4/6a/0y/e46a0yut-b-fje1qml7nk_b9a7o.png"><br><br>  Nous sommes int√©ress√©s par l'identit√© 386XXX, car elle correspond au certificat de lot avec lequel l'application a √©t√© sign√©e lors de l'installation via Xcode, √† partir de laquelle nous avons obtenu le profil d'approvisionnement. <br><br>  Injectez FridaGadget et re-signez notre application: <br><br>  <b>objection patchipa --source FoodSniffer / FoodSniffer.ipa --codesign-signature 386XXX --provision-file embedded.mobileprovision</b> <br><br><img src="https://habrastorage.org/webt/vu/oe/f3/vuoef3bipuclzxznuvpffj0x6oc.png"><br><br>  Par cons√©quent, nous devrions obtenir <b>FoodSniffer-frida-codesigned.ipa</b> . <br><br>  Maintenant, nous avons besoin d' <b>ios-deploy</b> pour installer et nous connecter √† FridaGadget.  Il s'agit d'une √©tape importante - si vous installez simplement ipa sur votre appareil via iTunes ou Xcode, cela ne fonctionnera pas pour se connecter √† FridaGadget. <br><br>  <b>Apr√®s avoir d√©ball√© FoodSniffer-frida-codesigned.ipa</b> : <br><br>  <b>d√©compressez FoodSniffer-frida-codesigned.ipa</b> <br><br>  Nous lan√ßons notre application corrig√©e sur l'appareil: <br><br>  <b>ios-deploy --bundle Payload / FoodSniffer.app -W -d</b> <br><br>  Si tout s'est bien pass√©, l'application devrait d√©marrer sur l'appareil, et dans le terminal, nous verrons: <br><br><img src="https://habrastorage.org/webt/jo/uh/mj/jouhmjurtt0g-czuzoiy9iorgqg.png"><br><br>  Maintenant, dans un autre onglet de terminal, connectez l'objection au FridaGadget: <br><br>  <b>objection explorer</b> <br><br><img src="https://habrastorage.org/webt/7m/xf/8j/7mxf8jh_92cwac9c47nbkm619kg.png"><br><br>  Profit! <br><br><h3>  Les petits pains que l'objection fournit </h3><br><h4>  Contournement de l'√©pinglage SSL </h4><br>  Ici, tout est simple: <br><br>  <b>ios sslpinning disable</b> <br><br><img src="https://habrastorage.org/webt/u4/yk/os/u4ykos2slu-abpk3be2zchia81q.png"><br><br>  Maintenant, vous pouvez facilement utiliser Proxy Server pour surveiller le trafic de notre application, comme d√©crit dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premi√®re partie</a> . <br><br><h4>  Dump UserDefaults </h4><br>  <b>ios nsuserdefaults get</b> <br><br>  √Ä la fin du vidage, nous devrions voir <b>¬´mood_state¬ª = ¬´J'ai faim¬ª</b> <br><br><img src="https://habrastorage.org/webt/xi/t9/qe/xit9qecm1w6bbllk6kiwxbhdy6o.png"><br><br><h4>  Vider le trousseau de l'application </h4><br>  <b>vidage du trousseau ios</b> <br><br><img src="https://habrastorage.org/webt/-i/ea/pn/-ieapnuhfqegrgvwhmfa-jgiz_o.png"><br><br>  Et voici notre mot de passe super secret. <br><br>  <i>R√©cup√©ration des donn√©es d'une base de donn√©es SQLite.</i> <br>  Dans l'application, j'ai ajout√© la base de donn√©es sqlite <b>chinook.db</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d'ici</a> . <br><br>  L'objection vous permet d'effectuer des requ√™tes directement dans la base de donn√©es comme suit. <br><br><ol><li>  Connexion √† la base de donn√©es: <br><br>  <b>sqlite connect chinook.db</b> <br><br><img src="https://habrastorage.org/webt/w5/q7/ev/w5q7evj5ekk3ac2i6-aislbaouq.png"></li><li>  Demande-lui: <br><br>  <b>sqlite execute query select * from albums</b> <br><br><img src="https://habrastorage.org/webt/vr/jb/ma/vrjbma1nqr5vgqrqxx_4bpje_hm.png"></li></ol><br><h2>  Conclusion </h2><br>  Objection et Frida permettent enfin un travail relativement normal et simple avec les builds Ad Hoc et Distribution des applications iOS.  Ils redonnent au programmeur le pouvoir sur leur propre application, cach√©e derri√®re les couches de protection avec lesquelles Apple enveloppe si soigneusement les applications iOS.  De plus, Objection et Frida fonctionnent sur des appareils non jailbreak√©s.  De plus, ils sont relativement faciles √† utiliser. <br><br>  Avec eux, j'ai l'espoir de rendre √† nouveau le d√©veloppement iOS formidable.  √âvitez en toute s√©curit√© de saper le nouveau si√®ge social d'Apple de l'int√©rieur. <br><br><img src="https://habrastorage.org/webt/ob/uu/d5/obuud5qapsvakfmb_gkmgr35v2g.gif"><br><br><h2>  Liens hyper (utiles) </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un √©tudiant d'Amsterdam sur le th√®me du code iOS</a> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://labs.mwrinfosecurity.com/blog/repacking-and-resigning-ios-applications/</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2016/october/ios-instrumentation-without-jailbreak/</a> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code source de l'application iOS FoodSniffer</a> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√©l√©gramme Frida</a> <br><br>  Un merci sp√©cial √† <b>@manishrhll</b> . <br><br>  <i>Remarque</i>  Tout ce qui pr√©c√®de doit √™tre appliqu√© uniquement √† leurs applications et ne pas essayer de briser le "Tinder" ou autre chose.  √áa ne marchera toujours pas! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429196/">https://habr.com/ru/post/fr429196/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429186/index.html">@Pythonetc octobre 2018</a></li>
<li><a href="../fr429188/index.html">Pr√©sentation de PICASO 3D Designer XL</a></li>
<li><a href="../fr429190/index.html">Fabriquer son propre implant pour l'√©lectronique</a></li>
<li><a href="../fr429192/index.html">Ces nouvelles astuces sont toujours capables de d√©jouer les vid√©os Deepfake.</a></li>
<li><a href="../fr429194/index.html">7 biblioth√®ques pour le d√©veloppement Android sur Kotlin</a></li>
<li><a href="../fr429198/index.html">Le framework Kernel-Bridge: Bridge in Ring0</a></li>
<li><a href="../fr429202/index.html">Cours co√ªteux: √ßa vaut le coup?</a></li>
<li><a href="../fr429204/index.html">Les id√©es fausses les plus importantes sur le d√©veloppement de jeux</a></li>
<li><a href="../fr429210/index.html">R√©alit√© difficile: vos parties prenantes ne veulent pas d'une analyse commerciale</a></li>
<li><a href="../fr429212/index.html">Microsoft a confirm√© la pr√©sence de probl√®mes (de masse) avec l'activation de Windows 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>