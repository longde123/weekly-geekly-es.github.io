<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßü üîî üëãüèø Der Kampf um Ressourcen, Teil 1: Die Grundlagen von Cgroups üò∏ üíáüèΩ üçì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Computer sind Hardware. Und heute sind wir zum Ausgangspunkt zur√ºckgekehrt, in dem Sinne, dass Sie jetzt selten einen physischen Host finden, auf dem ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Der Kampf um Ressourcen, Teil 1: Die Grundlagen von Cgroups</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redhatrussia/blog/423051/">  Computer sind Hardware.  Und heute sind wir zum Ausgangspunkt zur√ºckgekehrt, in dem Sinne, dass Sie jetzt selten einen physischen Host finden, auf dem eine einzelne Aufgabe ausgef√ºhrt wird.  Selbst wenn nur eine Anwendung auf dem Server ausgef√ºhrt wird, besteht sie h√∂chstwahrscheinlich aus mehreren Prozessen, Containern oder sogar virtuellen Maschinen (VMs), die alle auf demselben Server arbeiten.  Red Hat Enterprise Linux 7 kommt in solchen Situationen gut mit der Verteilung von Systemressourcen zurecht, verh√§lt sich jedoch standardm√§√üig wie eine freundliche Gro√ümutter, die ihre Enkelkinder mit hausgemachtem Kuchen behandelt und sagt: "Gleich f√ºr alle, gleich f√ºr alle." <br><br><img src="https://habrastorage.org/webt/l2/wn/bp/l2wnbpxkcho_2zulxgbifsvkg3y.png" width="100%"><br><br>  Theoretisch ist das Prinzip "gleichm√§√üig aufgeteilt" nat√ºrlich sch√∂n, aber in der Praxis sind einige Prozesse, Container oder VMs wichtiger als andere und sollten daher mehr erhalten. <br><a name="habracut"></a><br>  Linux verf√ºgt seit langem √ºber Ressourcenverwaltungstools (nett, ulimit usw.), aber mit dem Aufkommen von Red Hat Enterprise Linux 7 und systemd haben wir endlich einen leistungsstarken Satz solcher Tools in das Betriebssystem selbst integriert.  Tatsache ist, dass die Schl√ºsselkomponente von systemd eine vorgefertigte, angepasste Gruppe von Gruppen ist, die auf Betriebssystemebene vollst√§ndig genutzt wird. <br><br>  Nun, welche Art von Gruppen sind das und wohin geht das Ressourcen- oder Leistungsmanagement? <br><br><h3>  Steuerung der Kernel-Ebene </h3><br>  Ab der im Januar 2008 ver√∂ffentlichten Version 2.6.24 erschien der Linux-Kernel, der urspr√ºnglich in Google unter dem Namen "Prozesscontainer" erfunden und erstellt wurde. Unter Linux wurde er als "Kontrollgruppen", abgek√ºrzt "cgroups", bekannt.  Kurz gesagt, cgroups ist ein Kernel-Mechanismus, mit dem Sie die Verwendung einschr√§nken, Aufzeichnungen f√ºhren und den Verbrauch von Systemressourcen (CPU, Speicher, Festplatten-E / A, Netzwerk usw.) auf der Ebene der Prozesssammlungen isolieren k√∂nnen.  Cgroups k√∂nnen auch Prozesse zum √úberpr√ºfen und Neustarten einfrieren.  Cgroups-Controller wurden zuerst in Version 6 von Red Hat Enterprise Linux angezeigt, mussten dort jedoch manuell konfiguriert werden.  Mit dem Aufkommen von Red Hat Enterprise Linux 7 und systemd wird der vorkonfigurierte Satz von cgroups mit dem Betriebssystem geb√ºndelt. <br><br>  All dies funktioniert auf Kernel-Ebene des Betriebssystems und garantiert daher eine strikte Kontrolle √ºber jeden Prozess.  Daher ist es f√ºr Malware √§u√üerst schwierig, das System so zu laden, dass es nicht mehr reagiert und einfriert.  Obwohl fehlerhafter Code mit direktem Zugriff auf Hardware (z. B. Treiber) dies nat√ºrlich immer noch kann.  Gleichzeitig bietet Red Hat Enterprise Linux 7 eine Schnittstelle f√ºr die Interaktion mit cgroups, und die gesamte Arbeit mit ihnen erfolgt haupts√§chlich √ºber den Befehl systemd. <br><br><h3>  Dein St√ºck Kuchen </h3><br>  Das folgende Diagramm, das an einen geschnittenen Kuchen erinnert, zeigt drei Gruppen, die sich standardm√§√üig auf dem Red Hat Enterprise Linux 7-Server befinden - System, Benutzer und Maschine.  Jede dieser Gruppen wird als "Slice" (Slice-Sektor) bezeichnet.  Wie Sie in der Abbildung sehen k√∂nnen, kann jedes Slice untergeordnete Slicing-Sektoren haben.  Und wie beim Kuchen ergeben alle Scheiben insgesamt 100% der entsprechenden Ressource. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/z1/xj/uk/z1xjukef06hg4do7_0iyaffbfv8.png"></div><br><br>  Betrachten wir nun einige cgroups-Konzepte am Beispiel von Prozessorressourcen. <br><br>  Die obige Abbildung zeigt, dass die Prozessorzeit gleichm√§√üig auf die drei Slices der oberen Ebene (System, Benutzer und Maschine) aufgeteilt ist.  Dies geschieht aber nur unter Last.  Wenn ein Prozess aus dem Benutzer-Slice 100% der Prozessorressourcen anfordert und derzeit niemand diese Ressourcen ben√∂tigt, erh√§lt er alle 100% der Prozessorzeit. <br><br>  Jedes der drei Slices der obersten Ebene ist f√ºr die Art der Arbeitslast ausgelegt, mit der die untergeordneten Sektoren innerhalb des √ºbergeordneten Slice aufgeteilt werden: <br><br><ul><li>  <b>System</b> - D√§monen und Dienste. </li><li>  <b>Benutzer</b> - Benutzersitzungen.  Jeder Benutzer erh√§lt ein untergeordnetes Slice, und alle Sitzungen mit derselben UID "leben" in demselben Slice, sodass besonders listige Weisheiten nicht mehr Ressourcen erhalten k√∂nnen, als sie sollten. </li><li>  <b>Maschine</b> - virtuelle Maschinen wie KVM-G√§ste. </li></ul><br>  Dar√ºber hinaus wird das Konzept des sogenannten ‚ÄûBalls‚Äú (Share) verwendet, um den Ressourceneinsatz zu steuern.  Ein Ball ist ein relativer numerischer Parameter;  Sein Wert ist nur im Vergleich zu den Werten anderer B√§lle in derselben Gruppe sinnvoll.  Standardm√§√üig haben alle Slices einen Ball gleich 1024. In dem System-Slice in der obigen Abbildung sind CPU-B√§lle gleich 1024 f√ºr httpd, sshd, crond und gdm festgelegt. Die Ballwerte f√ºr System-, Benutzer- und Maschinen-Slices sind ebenfalls 1024. Ist das etwas verwirrend?  In der Tat kann dies als Baum dargestellt werden: <br><br><ul><li>  System - 1024 <ul><li>  httpd - 1024 </li><li>  sshd - 1024 </li><li>  crond - 1024 </li><li>  GDM - 1024 </li></ul></li><li>  Benutzer - 1024 <ul><li>  Bash (Richter) - 1024 </li><li>  Bash (Dorf) - 1024 </li></ul></li><li>  Maschine - 1024 <ul><li>  testvm - 1024 </li></ul></li></ul><br>  In dieser Liste haben wir mehrere laufende Daemons, einige Benutzer und eine virtuelle Maschine.  Stellen Sie sich nun vor, dass alle gleichzeitig die gesamte Prozessorzeit anfordern, die erhalten werden kann. <br><br>  Zusammenfassend: <br><br><ul><li>  Das Slice-System erh√§lt 33,333% der Prozessorzeit und teilt sie zu gleichen Teilen auf vier D√§monen auf, wodurch jeder von ihnen 8,25% der CPU-Ressourcen erh√§lt. </li><li>  Das Benutzer-Slice empf√§ngt 33,333% der Prozessorzeit und teilt sie zwischen zwei Benutzern auf, von denen jeder 16,5% der CPU-Ressourcen besitzt.  Wenn sich der Benutzer mrichter abmeldet oder alle laufenden Prozesse stoppt, hat dorf Zugriff auf 33% der CPU-Ressourcen. </li><li>  Slice Machine erh√§lt 33,333% der Prozessorzeit.  Wenn Sie die VM ausschalten oder in den Leerlaufmodus versetzen, erhalten System- und Benutzer-Slices ungef√§hr 50% der CPU-Ressourcen, die dann von ihren untergeordneten Slices gemeinsam genutzt werden. </li></ul><br>  Dar√ºber hinaus k√∂nnen Sie f√ºr jeden Daemon, Benutzer oder jede virtuelle Maschine nicht nur relative, sondern auch absolute Einschr√§nkungen f√ºr den Prozessorverbrauch eingeben, nicht nur f√ºr einen, sondern auch f√ºr mehrere Prozessoren.  Beispielsweise verf√ºgt der Benutzer-Slice-Richter √ºber die Eigenschaft CPUQuota.  Wenn Sie 20% festlegen, erh√§lt mrichter unter keinen Umst√§nden mehr als 20% der Ressourcen einer CPU.  Auf Multi-Core-Servern kann die CPUQuota mehr als 100% betragen, sodass das Slice die Ressourcen von mehr als einem Prozessor verwenden kann.  Beispielsweise kann mit CPUQuota = 200% ein Slice zwei Prozessorkerne vollst√§ndig nutzen.  Es ist wichtig zu verstehen, dass CPUQuota nicht reserviert, dh keinen bestimmten Prozentsatz der Prozessorzeit f√ºr eine Systemlast garantiert - dies ist nur das Maximum, das einem Slice unter Ber√ºcksichtigung aller anderen Slices und Einstellungen zugewiesen werden kann. <br><br><h3>  In vollem Umfang drehen! </h3><br>  Wie kann ich die Slice-Einstellungen √§ndern? <br><br>  Zu diesem Zweck verf√ºgt jedes Slice √ºber benutzerdefinierte Eigenschaften.  Und da es sich um Linux handelt, k√∂nnen wir die Einstellungen manuell in die Konfigurationsdateien schreiben oder √ºber die Befehlszeile festlegen. <br><br>  Im zweiten Fall wird der Befehl systemctl set-property verwendet.  Folgendes passiert auf dem Bildschirm, wenn Sie diesen Befehl eingeben, den Namen des Slice am Ende hinzuf√ºgen (in unserem Fall Benutzer) und dann die Tabulatortaste dr√ºcken, um die Optionen anzuzeigen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2j/2v/k6/2j2vk6tp9lq16jnovtw5lst6zck.png"></div><br><br>  Nicht alle Eigenschaften in diesem Screenshot sind Gruppeneinstellungen.  Wir sind haupts√§chlich an solchen interessiert, die mit Block, CPU und Speicher beginnen. <br><br>  Wenn Sie nicht die Befehlszeile, sondern Konfigurationsdateien bevorzugen (z. B. f√ºr die automatisierte Bereitstellung auf mehreren Hosts), m√ºssen Sie sich mit den Dateien im Ordner / etc / systemd / system befassen.  Diese Dateien werden automatisch erstellt, wenn Sie Eigenschaften mit dem Befehl systemctl festlegen. Sie k√∂nnen jedoch auch in einem Texteditor erstellt, √ºber Puppet gestempelt oder sogar von Skripten im laufenden Betrieb generiert werden. <br><br>  Mit den Grundkonzepten von cgroups sollte also alles klar sein.  Beim n√§chsten Mal werden wir einige Szenarien durchgehen und sehen, wie sich √Ñnderungen an bestimmten Eigenschaften auf die Leistung auswirken. <br><br>  <b>Und buchst√§blich morgen laden wir alle zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Red Hat Forum Russia 2018 ein</a> - es besteht die M√∂glichkeit, Fragen direkt an die Red Hat-Ingenieure zu stellen.</b> <br><br>  Weitere Beitr√§ge von cgroups aus unserer Resource Fight-Reihe finden Sie unter: <br><br><ul><li>  Teil 2 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habr.com/company/redhatrussia/blog/424367</a> </li><li>  Teil 3 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habr.com/company/redhatrussia/blog/425803</a> </li><li>  Teil 4 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habr.com/company/redhatrussia/blog/427413</a> </li><li>  Teil 5 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habr.com/company/redhatrussia/blog/429064</a> </li><li>  Teil 6 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habr.com/company/redhatrussia/blog/430748</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de423051/">https://habr.com/ru/post/de423051/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de423041/index.html">Bizarre Geschichte Super NES CD-ROM</a></li>
<li><a href="../de423043/index.html">Aufgrund einer Sicherheitsl√ºcke im Tesla-Schutzsystem f√ºr Elektrofahrzeuge kann ein Auto in wenigen Sekunden gestohlen werden</a></li>
<li><a href="../de423045/index.html">Welchen 3D-Drucker w√§hlen? 3Dtool Video Review</a></li>
<li><a href="../de423047/index.html">Wir reservieren IT-Systeme f√ºr angemessenes Geld</a></li>
<li><a href="../de423049/index.html">Lernprozesse unter Linux</a></li>
<li><a href="../de423053/index.html">Struktur und schreibgesch√ºtzt: So vermeiden Sie Leistungseinbu√üen</a></li>
<li><a href="../de423055/index.html">Wall Street Analysten: "Apple hat uns dazu gebracht, unsere H√ºte zu essen"</a></li>
<li><a href="../de423057/index.html">Python lehnt auch die Begriffe Master / Slave teilweise ab</a></li>
<li><a href="../de423059/index.html">Besser als sie sagen: Drei Grundlagen f√ºr das n√§chste MacBook als eines der besten Laptops von Apple</a></li>
<li><a href="../de423061/index.html">ref Einheimische und ref kehrt in C # zur√ºck: Leistungsprobleme</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>