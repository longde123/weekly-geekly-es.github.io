<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👂🏽 👦🏻 🐞 Rapide et furieux: Forza Horizon 4 accélère avec les shaders de fenêtre 🏥 ✋🏽 🛢️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gareth Harwood - Directeur artistique technique, Playground Games 

 L'action de Forza Horizon 4 se déroule dans la belle Grande-Bretagne, remplie de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rapide et furieux: Forza Horizon 4 accélère avec les shaders de fenêtre</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433164/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/33d/7eb/d63/33d7ebd6329f3c8d50c3f25d84501c06.jpg" alt="image"></div><br>  <em><strong>Gareth Harwood - Directeur artistique technique, Playground Games</strong></em> <br><br>  L'action de <em>Forza Horizon 4</em> se déroule dans la belle Grande-Bretagne, remplie de lieux et d'attractions immédiatement reconnaissables, y compris le modèle de la ville d'Édimbourg dans la version de Playground Games. <br><br>  Dans la plupart des jeux en monde ouvert, une attention particulière doit être accordée à la vitesse de diffusion des données, et <em>Forza Horizon 4</em> avec sa ville détaillée et colorée n'a pas fait exception.  Pour dessiner les bâtiments d'Édimbourg, de nouvelles capacités étaient nécessaires pour assembler les ressources, le rendu, ainsi qu'un moteur fonctionnel qui permettait de charger des modèles lors de leur déplacement à une vitesse de 300 miles par heure. <br><a name="habracut"></a><br><h1>  Solution modulaire qui réduit la charge mémoire </h1><br>  Les bâtiments ont été créés selon les références du monde réel.  Pour ce faire, il a fallu photographier et réaliser de nombreuses maisons, mais on peut créer et stocker physiquement un nombre limité de bâtiments sur disque.  Pour faire face à cette limitation, tout en conservant la variabilité, <strong>nous avons créé un ensemble modulaire interchangeable d'objets qui sont ajoutés aux bâtiments</strong> ;  il s'agit notamment d'objets tels que des cadres de fenêtres, des porches, des antennes et des alarmes antivol.  Nous avons également fourni la possibilité de changer les couleurs et les nuances des parties de ces objets.  Un tel système était idéalement adapté pour créer une série de maisons avec terrasses, chacune ayant une porte de sa propre couleur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d2/bcb/fc0/9d2bcbfc023261b85c8a76d53c48f8b5.jpg"></div><br>  À Édimbourg, nous devions créer un grand nombre de bâtiments dans une zone relativement petite.  Le téléchargement de ces bâtiments pour une petite partie de notre monde ouvert a considérablement augmenté la quantité de mémoire requise.  Pour y faire face, nous avons construit des bâtiments à partir de modules provenant des bibliothèques des premiers étages, des étages supérieurs et des toits, qui pouvaient être connectés de différentes manières, obtenant ainsi une variabilité et une image intéressante avec de faibles besoins en mémoire. <br><br>  De plus, cela nous a permis de déplacer la complexité des modèles plus près des premiers étages;  les fenêtres à côté desquelles passe le joueur ont plus de détails que les toits qui ne sont visibles qu'à distance.  Des bâtiments uniques comme le Scottish Monument et la National Gallery combinés à des bâtiments modulaires <strong>réduisent la monotonie de l'image, tout en maximisant la réutilisation des ressources et la variabilité</strong> . <br><br><h1>  Mettre en œuvre des textures de parallaxe </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/710/9b0/506/7109b05063cf8eeff856b8b8e2fff196.jpg"></div><br>  Les mondes réalistes ont toujours été une caractéristique forte des jeux <em>Forza Horizon</em> , et une façon de les créer était d'ajouter des intérieurs aux bâtiments. <br><br>  Nous savions que dans <em>Forza Horizon 4,</em> Édimbourg serait si densément construit et détaillé que les intérieurs physiquement modélisés mettraient un stress inutile.  Par conséquent, nous avons décidé d'utiliser une autre technique appelée «textures de parallaxe».  <strong>Ils nous ont donné un énorme avantage dans la création d'intérieurs.</strong>  <strong>Lors de leur cuisson dans une texture, ils ne sont pas limités par le nombre de polygones et la complexité des matériaux</strong> .  Le rendu de telles textures est moins coûteux que la création de géométrie, il peut donc y avoir plus d'intérieurs dans le jeu.  Auparavant, il était nécessaire de couvrir les fenêtres avec des rideaux ou de les ombrer, mais maintenant nous avons des intérieurs complètement parallaxe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/029/05f/5ef/02905f5ef40802b0ebaf3e722d186834.jpg"></div><br>  Les matériaux des intérieurs de parallaxe se composent de trois couches, chacune étant sélectionnée individuellement par des artistes pour chacune des fenêtres.  Étant donné que chaque couche a plusieurs variantes différentes, elles créent des centaines d'apparences possibles pour chaque fenêtre, même si un petit nombre d'atlas de texture est utilisé. <br><br>  La première couche est simple, elle ne contient qu'un cadre de fenêtre et du verre.  Il ajoute des nuances telles que le vitrail et le verre au plomb, caractéristiques de l'ancienne architecture britannique.  Cette couche a diffus, alpha, rugosité, métal et passe normale.  Le passage normal contient une variation de chaque vitrail pour ajouter une variabilité réaliste des angles de réflexion du verre, ce qui est particulièrement visible dans les vieux vitraux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/0dd/fd8/35d0ddfd863eebaad7e5d2a279750a52.jpg"></div><br>  La deuxième couche est utilisée pour les rideaux ou les rideaux.  Ils ont diffus et alpha, ainsi qu'une texture de transmission de lumière qui est utilisée la nuit pour montrer l'épaisseur des rideaux.  Nous avons des rideaux denses qui ne permettent pas la lumière, des rideaux translucides et même des rideaux avec des décorations que nous avons créées à partir d'ouvertures qui transmettent partiellement la lumière. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/162/91c/fde/16291cfde7ef2bc0842a9e4d084f2c4a.jpg"></div><br>  Dans la dernière couche, toute la magie du shader est créée - elle consiste en une texture plate qui imite un intérieur en trois dimensions.  Les intérieurs sont d'abord modélisés en 3D à la même échelle, puis rendus dans un format de texture unique pris en charge par nos shaders intérieurs parallaxe.  Comme dans tous les autres calques, dans ce calque, nous créons des atlas contenant jusqu'à huit intérieurs différents du même style pour réduire le nombre d'appels de tirage. <br><br>  Nous avons plusieurs atlas de village qui sont rendus sur des maisons de village, des atlas pour des maisons de ville, ainsi que plusieurs atlas d'établissements commerciaux qui chevauchent des magasins, des restaurants et des pubs britanniques classiques.  Nous avons également deux profondeurs principales des intérieurs.  Un pour les chambres standard, l'autre pour les vitrines peu profondes.  Les artistes peuvent choisir la partie de l'atlas qu'ils souhaitent utiliser pour chaque fenêtre du bâtiment, puis spécifier les matériaux en utilisant les propriétés du modèle polygonal de chaque fenêtre. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f22/9d5/380/f229d53800397bbb5c05f54ba5078ef5.jpg"></div><br>  <strong>Le shader calcule l'angle sous lequel le joueur regarde dans la pièce et modifie les coordonnées UV de sorte qu'il ne voit que la partie de l'intérieur qui serait visible sous cet angle.</strong>  Cette technique a plusieurs limites que nous avons traitées. <br><br>  Premièrement, l'astuce du shader devient perceptible dans les coins très pointus.  Dans de tels cas limites, nous avons amélioré l'effet Fresnel naturel du verre pour montrer une image plus réfléchie que l'intérieur.  Deuxièmement, à mesure que les angles augmentent, les détails au centre de la pièce commencent à se déformer.  Nous avons réduit cet effet en déplaçant l'accent sur les murs et les coins, assombrissant le sol.  Comme dans la vraie vie, l'effet de parallaxe vous permet de combiner des lignes tombant dans un point focal.  Dans nos images, nous en avons profité, en utilisant autant que possible des lignes parallèles: dans les carreaux, les étagères, le parquet et les motifs de papier peint. <br><br>  Chaque texture intérieure a également une texture d'éclairage pour la lumière du soir.  En raison des avantages de la cuisson de texture, nous pourrions utiliser n'importe quel nombre de sources de lumière, car en conséquence, toutes s'avèrent être enregistrées dans la texture.  Chaque bâtiment a des variations de lumière allumée et éteinte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/33d/7eb/d63/33d7ebd6329f3c8d50c3f25d84501c06.jpg"></div><br>  Les artistes étaient libres de choisir n'importe quelle combinaison de types de fenêtres, rideaux et intérieurs, mais ils ont suivi des règles simples: les chambres sont généralement situées aux étages supérieurs, vous ne pouvez pas utiliser les mêmes pièces dans chaque fenêtre et aux étages supérieurs, il ne peut y avoir aucun escalier menant.  Nous avons également examiné à quel point chaque pièce est convaincante.  Par exemple, nous ne pouvions pas avoir un petit chalet avec deux chambres, dans lequel dix fenêtres ou plus mènent à des pièces différentes, alors les artistes ont créé les fenêtres pour qu'elles ressemblent à différentes parties de la même pièce. <br><br>  Enfin, pour améliorer les performances lors de l'éloignement du joueur du bâtiment, nous devions réduire non seulement la complexité du maillage, mais également la complexité des shaders et des matériaux.  Pour ce faire, nous avons désactivé l'effet de parallaxe et remplacé la fenêtre par une image plate contenant dans une couche une fenêtre, des rideaux et un intérieur.  Le remplacement se produit lorsque la fenêtre occupe peu d'espace sur l'écran et est invisible pour le lecteur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e10/1e3/58b/e101e358be34bbcb93d21fcbc2fc96d5.jpg"></div><br>  Que vous voyagiez tranquillement autour d'Édimbourg dans votre roadster vintage, que vous examiniez chaque vitrine ou que vous vous précipitiez à une vitesse de 300 miles par heure dans une supercar pour un million de livres, <em>Forza Horizon 4</em> recréera un environnement magnifique, réaliste et intéressant.  Chaque technologie, méthode de rendu, shader et texture fonctionne en harmonie, créant l'une des parties les plus complexes sur le plan technique de la carte <em>Forza Horizon 4</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8cc/3ca/a08/8cc3caa080fa7f58fa6507c8a3fc2457.jpg"></div><br><br>  <i>D'un traducteur: pour plus de clarté, j'ai trouvé une vidéo qui montre les intérieurs du jeu.</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/J77tEV369G4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433164/">https://habr.com/ru/post/fr433164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433146/index.html">[compétition] Top 25 des consoles de jeux (secouez les temps anciens)</a></li>
<li><a href="../fr433152/index.html">Nous transférons Zimbra d'une infrastructure à serveur unique vers une infrastructure à serveurs multiples</a></li>
<li><a href="../fr433154/index.html">Expérience utilisateur 5G NR attendue dans le monde réel</a></li>
<li><a href="../fr433156/index.html">Dell devient public et se dirige vers le cloud hybride</a></li>
<li><a href="../fr433158/index.html">Parodies musicales de SUSE sur Kubernetes, Linus Torvalds et autres</a></li>
<li><a href="../fr433166/index.html">Prédire le temps de solution de ticket à l'aide du Machine Learning</a></li>
<li><a href="../fr433168/index.html">Pourquoi un programmeur fait-il un stage en cuisine - une conversation avec Dodo Pizza sur le gemba, .NET et l'ouverture</a></li>
<li><a href="../fr433172/index.html">Nous attachons le multijoueur au jeu mobile "Make words from words" sur iOS et Android, écrit en C ++</a></li>
<li><a href="../fr433174/index.html">Tous les correctifs ne sont pas également utiles.</a></li>
<li><a href="../fr433178/index.html">Comment nous avons restauré un fichier .wav endommagé</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>