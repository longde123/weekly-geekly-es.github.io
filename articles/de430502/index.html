<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèº üå®Ô∏è üåÇ Lastpr√ºfung mit Heuschrecke ü§ôüèº üò¥ üèáüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lasttests sind nicht so gefragt und weit verbreitet wie andere Testarten - es gibt nicht so viele Tools, mit denen Sie solche Tests durchf√ºhren k√∂nnen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lastpr√ºfung mit Heuschrecke</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/infopulse/blog/430502/">  Lasttests sind nicht so gefragt und weit verbreitet wie andere Testarten - es gibt nicht so viele Tools, mit denen Sie solche Tests durchf√ºhren k√∂nnen, aber einfache und bequeme Tests k√∂nnen im Allgemeinen an den Fingern einer Hand gez√§hlt werden. <br><br>  Wenn es um Leistungstests geht - zun√§chst einmal denkt jeder an JMeter -, bleibt es zweifellos das bekannteste Tool mit der gr√∂√üten Anzahl von Plugins.  Ich habe JMeter wegen seiner nicht offensichtlichen Benutzeroberfl√§che und der hohen Einstiegsschwelle nie gemocht, sobald es notwendig wird, eine Nicht-Hello World-Anwendung zu testen. <br><br>  Und jetzt, inspiriert vom Erfolg des Testens in zwei verschiedenen Projekten, beschloss ich, Informationen √ºber eine relativ einfache und bequeme Software - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Locust</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auszutauschen</a> <br><br>  F√ºr diejenigen, die zu faul sind, um unter den Schnitt zu gehen, habe ich ein Video aufgenommen: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZYKIyyY1qvY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><h2>  Was ist das? </h2><br>  Open-Source-Tool, mit dem Sie Ladeszenarien mit Python-Code angeben k√∂nnen, der verteiltes Laden unterst√ºtzt und, wie die Autoren behaupten, f√ºr Lasttests von Battlelog f√ºr eine Reihe von Battlefild-Spielen verwendet wurde (sofort fesselnd) <br><br>  Von den Profis: <br><br><ul><li>  einfache Dokumentation inklusive Copy-Paste-Beispiel.  Sie k√∂nnen mit dem Testen beginnen, auch ohne Programmierkenntnisse. </li><li>  "Under the Hood" verwendet die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anforderungsbibliothek</a> (HTTP f√ºr Personen).  Die Dokumentation kann als erweiterter Spickzettel und Lastschrifttest verwendet werden </li><li>  Python-Unterst√ºtzung - Ich mag nur die Sprache </li><li>  Der vorherige Absatz enth√§lt eine plattform√ºbergreifende Funktion zum Ausf√ºhren von Tests </li><li>  Eigener <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flask</a> -Webserver zur Anzeige von Testergebnissen </li></ul><br>  Von den Minuspunkten: <br><br><ul><li>  Kein Capture &amp; Replay - alle H√§nde </li><li>  Das Ergebnis des vorherigen Absatzes - Sie brauchen ein Gehirn.  Wie bei Postman m√ºssen Sie verstehen, wie HTTP funktioniert. </li><li>  Minimale Programmierkenntnisse erforderlich </li><li>  Lineares Lastmodell - das die Fans sofort aufregt, Benutzer ‚Äûnach Gau√ü‚Äú zu generieren </li></ul><br><h2>  Testprozess </h2><br>  Jedes Testen ist eine komplexe Aufgabe, die die Planung, Vorbereitung, √úberwachung der Implementierung und Analyse der Ergebnisse erfordert.  Wenn m√∂glich, ist es bei Stresstests m√∂glich und notwendig, alle m√∂glichen Daten zu sammeln, die das Ergebnis beeinflussen k√∂nnen: <br><br><ul><li>  Serverhardware (CPU, RAM, ROM) </li><li>  Serversoftware (Betriebssystem, Serverversion, JAVA, .NET usw., Datenbank und Datenmenge selbst, Server- und Testanwendungsprotokolle) </li><li>  Netzwerkbandbreite </li><li>  Das Vorhandensein von Proxyservern, Load Balancern und DDOS-Schutz </li><li>  Testdaten laden (Anzahl der Benutzer, durchschnittliche Antwortzeit, Anzahl der Anforderungen pro Sekunde) </li></ul><br>  Die nachfolgend beschriebenen Beispiele k√∂nnen als Black-Box-Funktionslasttests klassifiziert werden.  Auch ohne etwas √ºber die zu testende Anwendung zu wissen und ohne Zugriff auf die Protokolle k√∂nnen wir deren Leistung messen. <br><br><h2>  Bevor Sie anfangen </h2><br>  Um Lasttests in der Praxis zu testen, habe ich einen lokal einfachen Webserver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/typicode/json-server</a> bereitgestellt.  Ich werde fast alle der folgenden Beispiele f√ºr ihn geben.  Ich habe die Daten f√ºr den Server einem bereitgestellten Online-Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">entnommen</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://jsonplaceholder.typicode.com/</a> <br>  Zum Ausf√ºhren ist nodeJS erforderlich. <br><br>  <b>Offensichtlicher Spoiler</b> : Wie bei Sicherheitstests ist es besser, Experimente mit Stresstests an Katzen vor Ort durchzuf√ºhren, ohne Online-Dienste zu laden, damit Sie nicht gebannt werden <br><br>  Zum Starten ist auch Python erforderlich - in allen Beispielen verwende ich Version 3.6 sowie Locust selbst (zum Zeitpunkt des Schreibens Version 0.9.0).  Es kann mit dem Befehl installiert werden <br><br><pre><code class="bash hljs">python -m pip install locustio</code> </pre> <br>  Installationsdetails finden Sie in der offiziellen Dokumentation. <br><br><h2>  Ein Beispiel analysieren </h2><br>  Als n√§chstes brauchen wir eine Testdatei.  Ich habe ein Beispiel aus der Dokumentation genommen, da es sehr einfach und unkompliziert ist: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.post(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.post(<span class="hljs-string"><span class="hljs-string">"/logout"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.get(<span class="hljs-string"><span class="hljs-string">"/profile"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> tasks = {index: <span class="hljs-number"><span class="hljs-number">2</span></span>, profile: <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> login(self) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> logout(self) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">5000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">9000</span></span></code> </pre> <br>  Das ist alles!  Dies ist wirklich genug, um den Test zu starten!  Schauen wir uns ein Beispiel an, bevor wir anfangen. <br><br>  Beim √úberspringen von Importen sehen wir ganz am Anfang zwei nahezu identische Anmelde- und Abmeldefunktionen, die aus einer Zeile bestehen.  <b>l.client</b> - ein HTTP-Sitzungsobjekt, mit dem wir eine Last erstellen.  Wir verwenden die POST-Methode, die fast identisch mit der in der Anforderungsbibliothek ist.  Fast - weil wir in diesem Beispiel als erstes Argument keine vollst√§ndige URL, sondern nur einen Teil davon √ºbergeben - einen bestimmten Dienst. <br><br>  Das zweite Argument √ºbergibt die Daten - und ich kann nicht anders, als zu bemerken, dass es sehr praktisch ist, Python-W√∂rterb√ºcher zu verwenden, die automatisch in json konvertiert werden <br><br>  Sie k√∂nnen auch feststellen, dass wir das Ergebnis der Anfrage in keiner Weise verarbeiten. Wenn dies erfolgreich ist, werden die Ergebnisse (z. B. Cookies) in dieser Sitzung gespeichert.  Wenn ein Fehler auftritt, wird er aufgezeichnet und der Statistik √ºber die Last hinzugef√ºgt. <br><br>  Wenn wir wissen m√∂chten, ob wir die Anfrage richtig geschrieben haben, k√∂nnen wir sie jederzeit wie folgt √ºberpr√ºfen: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> r response=r.post(base_url+<span class="hljs-string"><span class="hljs-string">"/login"</span></span>,{<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>,<span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) print(response.status_code)</code> </pre> <br>  Ich habe nur die Variable <b>base_url</b> hinzugef√ºgt, die die vollst√§ndige Adresse der zu testenden Ressource enthalten sollte. <br><br>  Die n√§chsten Funktionen sind Abfragen, die eine Last erzeugen.  Auch hier m√ºssen wir die Serverantwort nicht verarbeiten - die Ergebnisse werden sofort in die Statistik √ºbernommen. <br><br>  Als n√§chstes folgt die <b>UserBehavior-</b> Klasse (der Name der Klasse kann beliebig sein).  Wie der Name schon sagt, wird das Verhalten eines sph√§rischen Benutzers im Vakuum der zu testenden Anwendung beschrieben.  Wir √ºbergeben an die <b>Task-</b> Eigenschaft ein W√∂rterbuch mit Methoden, die der Benutzer aufruft, und deren H√§ufigkeit.  Obwohl wir nicht wissen, welche Funktion und in welcher Reihenfolge jeder Benutzer aufruft - sie werden zuf√§llig ausgew√§hlt -, garantieren wir, dass die <b>Indexfunktion</b> im Durchschnitt zweimal h√§ufiger aufgerufen wird als die <b>Profilfunktion</b> . <br><br>  Zus√§tzlich zum Verhalten k√∂nnen Sie in der √ºbergeordneten Klasse TaskSet 4 Funktionen angeben, die vor und nach den Tests ausgef√ºhrt werden k√∂nnen.  Die Reihenfolge der Anrufe ist wie folgt: <br><br><ol><li>  <b>setup</b> - wird zu Beginn von <b>UserBehavior (TaskSet) einmal aufgerufen</b> - ist nicht im Beispiel enthalten </li><li>  <b>on_start</b> - wird von jedem neuen Benutzer der Last beim Start <b>einmal</b> aufgerufen </li><li>  <b>Aufgaben</b> - Ausf√ºhrung der Aufgaben selbst </li><li>  <b>on_stop</b> - wird von jedem Benutzer einmal aufgerufen, wenn der Test beendet ist </li><li>  <b>Teardown</b> - wird beim <b>Beenden</b> des <b>TaskSet einmal aufgerufen</b> - ist auch nicht im Beispiel enthalten </li></ol><br>  Erw√§hnenswert ist hier, dass es zwei M√∂glichkeiten gibt, das Benutzerverhalten zu deklarieren: Die erste ist bereits im obigen Beispiel angegeben - Funktionen werden im Voraus angek√ºndigt.  Die zweite M√∂glichkeit besteht darin, Methoden direkt in der <b>UserBehavior-</b> Klasse zu deklarieren: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.post(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.post(<span class="hljs-string"><span class="hljs-string">"/logout"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/profile"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">5000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">9000</span></span></code> </pre> <br>  In diesem Beispiel werden Benutzerfunktionen und die H√§ufigkeit ihres Anrufs mithilfe der <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Aufgabenanmerkung festgelegt</a></b> .  Funktionell hat sich nichts ge√§ndert. <br><br>  Die letzte Klasse aus dem Beispiel ist <b>WebsiteUser</b> (der Name der Klasse kann beliebig sein).  In dieser Klasse definieren wir das Benutzerverhaltensmodell <b>UserBehavior</b> *** + sowie die minimalen und maximalen Wartezeiten zwischen Aufrufen einzelner Aufgaben durch jeden Benutzer.  Um es klarer zu machen, gehen Sie wie folgt vor, um es zu visualisieren: <br><br><img src="https://habrastorage.org/webt/mv/ss/7j/mvss7jfvob_tufawwbx-41w6i8y.png"><br><br><h2>  Erste Schritte </h2><br>  F√ºhren Sie den Server aus, dessen Leistung wir testen werden: <br><br><pre> <code class="bash hljs">json-server --watch sample_server/db.json</code> </pre> <br>  Wir √§ndern auch die Beispieldatei, damit sie den Dienst testen, die An- und Abmeldung entfernen und das Benutzerverhalten festlegen kann: <br><br><ol><li>  √ñffnen Sie die Hauptseite 1 Mal zu Beginn der Arbeit </li><li>  Holen Sie sich eine Liste aller x2 Beitr√§ge </li><li>  Schreibe einen Kommentar zum ersten Beitrag x1 </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">posts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/posts"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">comment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> data = { <span class="hljs-string"><span class="hljs-string">"postId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"my comment"</span></span>, <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"test@user.habr"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"Author is cool. Some text. Hello world!"</span></span> } self.client.post(<span class="hljs-string"><span class="hljs-string">"/comments"</span></span>, data) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">1000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre><br>  F√ºhren Sie den Befehl aus, um an der Eingabeaufforderung zu beginnen <br><br><pre> <code class="bash hljs">locust -f my_locust_file.py --host=http://localhost:3000</code> </pre> <br>  Dabei ist Host die Adresse der getesteten Ressource.  Ihm werden die im Test angegebenen Serviceadressen hinzugef√ºgt. <br><br>  Wenn der Test keine Fehler enth√§lt, wird der Ladeserver gestartet und ist unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http: // localhost: 8089 /</a> verf√ºgbar. <br><br><img src="https://habrastorage.org/webt/p9/km/lc/p9kmlc3hqgi3_gupjrvkhduhl2a.png"><br><br>  Wie Sie sehen k√∂nnen, wird hier der Server angezeigt, den wir testen werden. Unter dieser URL werden die Adressen der Dienste aus der Testdatei hinzugef√ºgt. <br><br>  Auch hier k√∂nnen wir die Anzahl der Benutzer f√ºr die Last und deren Wachstum pro Sekunde angeben. <br>  Auf den Button starten wir den Ladevorgang! <br><br><img src="https://habrastorage.org/webt/di/d8/xt/did8xtea9mlpfzzxwlfq1lcofne.png"><br><br><h2>  Ergebnisse </h2><br>  Nach einer gewissen Zeit beenden wir den Test und sehen uns die ersten Ergebnisse an: <br><br><ol><li>  Wie erwartet ging jeder der 10 zu Beginn erstellten Benutzer zur Hauptseite </li><li>  Die Liste der Beitr√§ge wurde im Durchschnitt zweimal h√§ufiger ge√∂ffnet als ein Kommentar geschrieben wurde </li><li>  Es gibt eine durchschnittliche und mittlere Antwortzeit f√ºr jede Operation. Die Anzahl der Operationen pro Sekunde ist bereits ein n√ºtzliches Datenelement, obwohl Sie es jetzt nehmen und mit dem erwarteten Ergebnis aus den Anforderungen vergleichen </li></ol><br>  Auf der zweiten Registerkarte k√∂nnen Sie die Lastdiagramme in Echtzeit anzeigen.  Wenn der Server bei einer bestimmten Last abst√ºrzt oder sich sein Verhalten √§ndert, wird dies sofort in der Grafik angezeigt. <br><br><img src="https://habrastorage.org/webt/qm/ym/pd/qmympdj2picpcms6mkdb7eonenu.png"><br><br>  Auf der dritten Registerkarte sehen Sie die Fehler - in meinem Fall handelt es sich um einen Clientfehler.  Wenn der Server jedoch einen 4XX- oder 5XX-Fehler zur√ºckgibt, wird sein Text hier geschrieben <br>  Wenn im Code Ihres Textes ein Fehler auftritt, f√§llt dieser in die Registerkarte Ausnahmen.  Bisher habe ich den h√§ufigsten Fehler im Zusammenhang mit der Verwendung des Befehls print () im Code - dies ist nicht die beste Methode zum Protokollieren :) <br><br>  Auf der letzten Registerkarte k√∂nnen Sie alle Testergebnisse im CSV-Format herunterladen <br><br>  Sind diese Ergebnisse relevant?  Lass es uns herausfinden.  In den meisten F√§llen klingen die Leistungsanforderungen (falls √ºberhaupt angegeben) ungef√§hr so: Die durchschnittliche Ladezeit der Seite (Serverantwort) sollte bei einer Last von M Benutzern weniger als N Sekunden betragen.  Nicht wirklich spezifizieren, was Benutzer tun sollen.  Und ich mag Locust daf√ºr - es erzeugt Aktivit√§ten einer bestimmten Anzahl von Benutzern, die zuf√§llig die erwarteten Aktionen ausf√ºhren, die sie von Benutzern erwarten. <br><br>  Wenn wir einen Benchmark durchf√ºhren m√ºssen, um das Verhalten des Systems bei verschiedenen Lasten zu messen, k√∂nnen wir mehrere Verhaltensklassen erstellen und mehrere Tests bei verschiedenen Lasten durchf√ºhren. <br><br>  Das reicht f√ºr den Anfang.  Wenn Ihnen der Artikel gefallen hat, habe ich vor, dar√ºber zu schreiben: <br><br><ul><li>  komplexe Testszenarien, in denen die Ergebnisse eines Schritts im Folgenden verwendet werden </li><li>  Serverantwortverarbeitung, as  Es kann falsch sein, auch wenn HTTP 200 OK angekommen ist </li><li>  nicht offensichtliche Schwierigkeiten, die auftreten k√∂nnen, und wie man sie umgeht </li><li>  Testen ohne Verwendung der Benutzeroberfl√§che </li><li>  verteilte Lasttests </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430502/">https://habr.com/ru/post/de430502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430492/index.html">Intel Neural Compute Stick. K√ºnstlicher Geist auf einem USB-Stick - 2</a></li>
<li><a href="../de430494/index.html">InfoWatch Traffic Monitor. Am Rande von Fehlern und Funktionen</a></li>
<li><a href="../de430496/index.html">NB-IoT: Wie funktioniert es? Teil 1</a></li>
<li><a href="../de430498/index.html">Umgehen Sie die Benutzerkontensteuerung (User Account Control, UAC), indem Sie vertrauensw√ºrdige Verzeichnisse nachahmen</a></li>
<li><a href="../de430500/index.html">Vermeiden von Chaos in der Wissensdatenbank von Unternehmen: Unsere Confluence-Erfahrung</a></li>
<li><a href="../de430504/index.html">Junior und rationale Denkmethoden</a></li>
<li><a href="../de430506/index.html">Dunkle Kunst der Auferstehung: Wie man Daten von besch√§digten Medien wiederherstellt</a></li>
<li><a href="../de430508/index.html">DevOps: Was ist das wirklich?</a></li>
<li><a href="../de430510/index.html">Wie schreibe ich Code, den jeder verstehen wird?</a></li>
<li><a href="../de430512/index.html">Wie Freiberufler leben: Arbeiten Sie nicht mit allwissenden Kunden zusammen und lassen Sie sich z√∂gern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>