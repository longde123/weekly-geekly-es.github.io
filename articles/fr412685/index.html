<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖐🏿 👨‍👨‍👧 🤳🏽 Suivi de chemin GPU Unity - Partie 2 📠 👼🏻 💅🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Il n'y a rien de pire qu'une image claire d'un concept flou." - photographe Ansel Adams 
 Dans la première partie de l'article, nous avons créé un tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Suivi de chemin GPU Unity - Partie 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412685/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/209/d23/f12/209d23f129b3a20b6bf0f9c2e06d9633.png" alt="image"></div><br><blockquote>  <em>"Il n'y a rien de pire qu'une image claire d'un concept flou."</em>  <em>- photographe Ansel Adams</em> </blockquote><br>  Dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">première partie de l'article,</a> nous avons créé un traceur de rayons Whited, capable de tracer des reflets parfaits et des ombres nettes.  Mais il nous manque les effets de flou: réflexion diffuse, reflets brillants et ombres douces. <br><br>  Sur la base du <a href="">code que</a> nous avons <a href="">déjà</a> , nous allons résoudre de manière itérative <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'équation de rendu</a> formulée par James Cajia en 1986 et transformer notre moteur de rendu en un <em>traceur de chemin</em> capable de transmettre les effets ci-dessus.  Nous utiliserons à nouveau C # pour les scripts et HLSL pour les shaders.  Le code est téléchargé sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bitbucket</a> . <br><a name="habracut"></a><br>  Cet article est beaucoup plus mathématique que le précédent, mais ne vous inquiétez pas.  Je vais essayer d'expliquer chaque formule aussi clairement que possible.  Les formules sont nécessaires ici pour voir ce qui se passe et <em>pourquoi</em> notre moteur de rendu fonctionne, donc je recommande d'essayer de les comprendre et si quelque chose n'est pas clair, posez des questions dans les commentaires de l'article d'origine. <br><cut></cut><br>  L'image ci-dessous est rendue à l'aide de la carte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Graffiti Shelter</a> du site Web HDRI Haven.  Les autres images de cet article ont été rendues à l'aide de la carte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kiara 9 Dusk</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/927/3c6/10d/9273c610dca750b85f8c3ad9a6655897.jpg" alt="image"></div><br><h1>  Équation de rendu </h1><br>  D'un point de vue formel, la tâche du rendu photoréaliste est de résoudre l'équation de rendu, qui s'écrit comme suit: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">L</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">x</span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-6" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-7">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">c</span><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">g</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23" style="margin-right: 0.05em;">L</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-24" style="vertical-align: -0.4em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">x</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-28" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-29">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">c</span><span class="MJXp-mtext" id="MJXp-Span-33">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">g</span><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-44">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">n</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-50">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">a</span></span></span><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-msubsup" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-59" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">x</span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-63" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-64">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">c</span><span class="MJXp-mtext" id="MJXp-Span-68">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">g</span><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-75" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-78" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">c</span><span class="MJXp-mtext" id="MJXp-Span-83">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">g</span><span class="MJXp-msubsup" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-90" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-93" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">c</span><span class="MJXp-mtext" id="MJXp-Span-99">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">g</span><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">t</span><span class="MJXp-mtext" id="MJXp-Span-113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">n</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-119" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">L</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">x</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-124" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">c</span><span class="MJXp-mtext" id="MJXp-Span-129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">g</span><span class="MJXp-msubsup" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-136" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-139" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">d</span><span class="MJXp-mtext" id="MJXp-Span-141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">c</span><span class="MJXp-mtext" id="MJXp-Span-145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">g</span><span class="MJXp-msubsup" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-152" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">i</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="140.286ex" height="2.78ex" viewBox="0 -832 60400.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="1071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="1643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="2505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="2990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="3457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="4140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="4626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="5504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="5971" y="0"></use><g transform="translate(6451,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="7424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-3D" x="8091" y="0"></use><g transform="translate(9148,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="963" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="10259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="10649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="11221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="12083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="12568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="13035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="13718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="14204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="15082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="15549" y="0"></use><g transform="translate(16029,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="17002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2B" x="17614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-69" x="18865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6E" x="19210" y="0"></use><g transform="translate(19811,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4F" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="1117" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="1995" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="2462" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="2942" y="0"></use></g></g><g transform="translate(22727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-72" x="693" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="1299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="1871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="2733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="3219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="3685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="4369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="4854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="5733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="6199" y="0"></use><g transform="translate(6680,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="7553" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="8415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="8901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="9367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="10051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="10536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="11415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="11881" y="0"></use><g transform="translate(12362,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="13335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="13891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="14530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="15016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="15482" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="16166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="16651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="17530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="17996" y="0"></use><g transform="translate(18477,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="19601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-64" x="20034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="20558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-74" x="21043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="21655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="22140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="22607" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6E" x="23040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="23641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4C" x="24197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="24878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="25268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="25840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="26702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="27188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="27654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="28338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="28823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="29702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="30168" y="0"></use><g transform="translate(30649,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="31522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-64" x="32078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="32852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="33337" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="33804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="34487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="34973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="35851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="36318" y="0"></use><g transform="translate(36798,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-69" x="748" y="-213"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> L (x, \, \ vec \ omega_ {o}) = L_e (x, \, \ vec \ omega_ {o}) + \ int _ {\ Omega} {f_r (x, \, \ vec \ omega_ {i }, \, \ vec \ omega_ {o}) \, (\ vec \ omega_ {i} \ cdot \ vec n) \, L (x, \, \ vec \ omega_ {i}) \, d \ vec \ omega_ {i}} </script></p><br>  Analysons-le.  Notre objectif ultime est de déterminer la luminosité du pixel de l'écran.  L'équation de rendu nous donne la quantité d'éclairage <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">L</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">x</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-159" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-160">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">c</span><span class="MJXp-mtext" id="MJXp-Span-164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">g</span><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-171" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.149ex" height="2.66ex" viewBox="0 -832 7814.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="1071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="1643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="2505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="2990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="3457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="4140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="4626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="5504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="5971" y="0"></use><g transform="translate(6451,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="7424" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> L (x, \, \ vec \ omega_ {o}) </script>  venant d'un point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> x </script>  (point d'incidence du faisceau) dans la direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-mtext" id="MJXp-Span-177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">c</span><span class="MJXp-mtext" id="MJXp-Span-181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">g</span><span class="MJXp-msubsup" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-188" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">o</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.006ex" height="1.817ex" viewBox="0 -520.7 5169.3 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="1885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="2371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="3249" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="3716" y="0"></use><g transform="translate(4196,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="748" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ vec \ omega_ {o} </script>  (la direction dans laquelle le faisceau tombe).  La surface elle-même peut être une source de lumière émettant de la lumière <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-msubsup" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192" style="margin-right: 0.05em;">L</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-193" style="vertical-align: -0.4em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">x</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-197" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">c</span><span class="MJXp-mtext" id="MJXp-Span-202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">g</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.147ex" height="2.66ex" viewBox="0 -832 8244 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="963" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-28" x="1111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-78" x="1500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-2C" x="2073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-76" x="2935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="3420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-63" x="3887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="4570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="5056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="5934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="6401" y="0"></use><g transform="translate(6881,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6F" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMAIN-29" x="7854" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> L_e (x, \, \ vec \ omega_ {o}) </script>  dans notre direction.  La plupart des surfaces ne le font pas, elles ne réfléchissent donc que la lumière de l'extérieur.  C'est pourquoi l'intégrale est utilisée.  Il accumule l'éclairage provenant de toutes les directions possibles de l'hémisphère. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-mtext" id="MJXp-Span-213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.824ex" height="2.419ex" viewBox="0 -780.1 3368.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-4F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-6D" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-65" x="1892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-67" x="2358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-61" x="2839" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ Omega </script>  autour de la normale (donc, si l'on tient compte de l'éclairage tombant sur la surface <em>par le haut</em> , et non <em>de l'intérieur</em> , ce qui peut être nécessaire pour les matériaux translucides). <br><br>  La première partie est <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-msubsup" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-222" style="vertical-align: -0.4em;">r</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.113ex" height="2.419ex" viewBox="0 -780.1 909.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/412685/&amp;usg=ALkJrhgubXN7QNL1fObLjnYupkNOZxuBkQ#MJMATHI-72" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> f_r </script>  est appelée fonction de distribution de réflectance bidirectionnelle (BRDF).  Cette fonction décrit visuellement le type de matériau auquel nous avons affaire: métal ou diélectrique, sombre ou brillant, brillant ou mat.  BRDF détermine la proportion d'éclairage provenant de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mtext" id="MJXp-Span-224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">c</span><span class="MJXp-mtext" id="MJXp-Span-228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">g</span><span class="MJXp-msubsup" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-235" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ vec \ omega_ {i} </script>  qui se reflète dans la direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-237"><span class="MJXp-mtext" id="MJXp-Span-238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">c</span><span class="MJXp-mtext" id="MJXp-Span-242">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">g</span><span class="MJXp-msubsup" id="MJXp-Span-247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-249" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">o</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ vec \ omega_ {o} </script>  .  En pratique, cela est mis en œuvre en utilisant un vecteur à trois composantes avec des valeurs de rouge, vert et bleu dans l'intervalle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-253">0</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-255">1</span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> [0,1] </script>  . <br><br>  Deuxième partie - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-257"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">c</span><span class="MJXp-mtext" id="MJXp-Span-263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">g</span><span class="MJXp-msubsup" id="MJXp-Span-268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-270" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">t</span><span class="MJXp-mtext" id="MJXp-Span-277">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">n</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> (\ vec \ omega_ {i} \ cdot \ vec n) </script>  Est l'équivalent de <sup>1</sup> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">s</span><span class="MJXp-mtext" id="MJXp-Span-287">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> cos \ theta </script>  où <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ theta </script>  - angle entre la lumière incidente et la normale à la surface <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> \ vec n </script>  .  Imaginez une colonne de rayons de lumière parallèles tombant à la surface perpendiculairement.  Imaginez maintenant le même rayon tombant à la surface à un angle plat.  La lumière sera distribuée sur une plus grande zone, mais cela signifie également que chaque point de cette zone sera plus sombre.  Le cosinus est nécessaire pour en tenir compte. <br><br>  Enfin, l'éclairage lui-même obtenu à partir de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mtext" id="MJXp-Span-307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">c</span><span class="MJXp-mtext" id="MJXp-Span-311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">g</span><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-318" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> \ vec \ omega_ {i} </script>  est déterminé récursivement en utilisant la même équation.  Autrement dit, l'éclairage au point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> x </script>  Dépend de la lumière incidente de toutes les directions possibles dans l'hémisphère supérieur.  Dans chacune de ces directions à partir d'un point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> x </script>  il y a un autre point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">x</span><span class="MJXp-mtext" id="MJXp-Span-326">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> x \ prime </script>  , dont la luminosité dépend à nouveau de la lumière tombant de toutes les directions possibles de l'hémisphère supérieur de ce point.  Tous les calculs sont répétés. <br><br>  Voici ce qui se passe ici, c'est une équation intégrale infiniment récursive avec un nombre infini de régions hémisphériques d'intégration.  Nous ne pouvons pas résoudre cette équation directement, mais il existe une solution assez simple. <br><br><hr><br>  <sup>1</sup> N'oubliez pas!  Nous parlerons souvent de cosinus, et nous garderons toujours à l'esprit le produit scalaire.  Depuis <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mtext" id="MJXp-Span-333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">c</span><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">a</span></span><span class="MJXp-mtext" id="MJXp-Span-339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">t</span><span class="MJXp-mtext" id="MJXp-Span-344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">c</span><span class="MJXp-mrow" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">b</span></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-351">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-354">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">c</span><span class="MJXp-mrow" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">a</span></span><span class="MJXp-mtext" id="MJXp-Span-360">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-361"><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-363">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-364">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-365"><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">c</span><span class="MJXp-mrow" id="MJXp-Span-371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">b</span></span><span class="MJXp-mtext" id="MJXp-Span-373">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-374"><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-376">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">s</span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-381">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">a</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ vec {a} \ cdot \ vec {b} = \ | \ vec {a} \ | \ \ | \ vec {b} \ | \ cos (\ theta) </script>  , et nous avons affaire à des <em>directions</em> (vecteurs unitaires), alors le produit scalaire <em>est le</em> cosinus dans la plupart des tâches d'infographie. <br><br><h2>  Monte Carlo vient à la rescousse </h2><br>  L'intégration de Monte Carlo est une technique d'intégration numérique qui nous permet de calculer approximativement toute intégrale à l'aide d'un nombre fini d'échantillons aléatoires.  De plus, Monte Carlo garantit la convergence vers la bonne décision - plus nous prélevons d'échantillons, mieux c'est.  Voici sa forme généralisée: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-388"><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">x</span><span class="MJXp-mtext" id="MJXp-Span-399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">c</span><span class="MJXp-mrow" id="MJXp-Span-404"><span class="MJXp-mn" id="MJXp-Span-405">1</span></span><span class="MJXp-mrow" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">N</span></span><span class="MJXp-mtext" id="MJXp-Span-408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">u</span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">n</span><span class="MJXp-mo" id="MJXp-Span-415">=</span><span class="MJXp-mn" id="MJXp-Span-416">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-419"><span class="MJXp-mtext" id="MJXp-Span-420">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">c</span><span class="MJXp-mrow" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">f</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-430" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">p</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-437" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-20"> F_N \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {\ frac {f (x_n)} {p (x_n)}} </script></p><br>  Par conséquent, l'intégrale de la fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">f</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-444" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> f (x_n) </script>  peut être calculé approximativement en faisant la moyenne des échantillons aléatoires dans le domaine d'intégration.  Chaque échantillon est divisé par la probabilité de sa sélection. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">p</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-451" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> p (x_n) </script>  .  Pour cette raison, l'échantillon le plus souvent choisi aura plus de poids que l'échantillon le moins souvent choisi. <br><br>  Dans le cas d'échantillons uniformes dans l'hémisphère (chaque direction a la même probabilité d'être sélectionnée), la probabilité d'échantillons est constante: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">p</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">a</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">c</span><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mn" id="MJXp-Span-470">1</span></span><span class="MJXp-mrow" id="MJXp-Span-471"><span class="MJXp-mn" id="MJXp-Span-472">2</span><span class="MJXp-mtext" id="MJXp-Span-473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> p (\ omega) = \ frac {1} {2 \ pi} </script>  (car <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-mn" id="MJXp-Span-477">2</span><span class="MJXp-mtext" id="MJXp-Span-478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> 2 \ pi </script>  Est la surface d'un seul hémisphère).  Si nous mettons tout cela ensemble, nous obtenons ce qui suit: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">L</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">x</span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-486" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-487">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">c</span><span class="MJXp-mtext" id="MJXp-Span-491">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">g</span><span class="MJXp-msubsup" id="MJXp-Span-496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-498" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">x</span><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;">L</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-510" style="vertical-align: -0.4em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">x</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-514" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-515">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">c</span><span class="MJXp-mtext" id="MJXp-Span-519">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">g</span><span class="MJXp-msubsup" id="MJXp-Span-524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-526" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">c</span><span class="MJXp-mrow" id="MJXp-Span-535"><span class="MJXp-mn" id="MJXp-Span-536">1</span></span><span class="MJXp-mrow" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">N</span></span><span class="MJXp-mtext" id="MJXp-Span-539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">u</span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">n</span><span class="MJXp-mo" id="MJXp-Span-546">=</span><span class="MJXp-mn" id="MJXp-Span-547">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-550"><span class="MJXp-mtext" id="MJXp-Span-551">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">r</span><span class="MJXp-mrow" id="MJXp-Span-557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">t</span></span><span class="MJXp-mrow" id="MJXp-Span-562"><span class="MJXp-mn" id="MJXp-Span-563">2</span><span class="MJXp-mtext" id="MJXp-Span-564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">i</span><span class="MJXp-mspace" id="MJXp-Span-567" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">x</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-574" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-575">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">c</span><span class="MJXp-mtext" id="MJXp-Span-579">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">g</span><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-589" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-590">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">c</span><span class="MJXp-mtext" id="MJXp-Span-594">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">g</span><span class="MJXp-msubsup" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-604" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-606">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">c</span><span class="MJXp-mtext" id="MJXp-Span-610">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">g</span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-617" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">t</span><span class="MJXp-mtext" id="MJXp-Span-624">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">n</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mspace" id="MJXp-Span-630" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">L</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">x</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-635" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">c</span><span class="MJXp-mtext" id="MJXp-Span-640">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">g</span><span class="MJXp-msubsup" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-647" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-25"> L (x, \, \ vec \ omega_ {o}) \ approx L_e (x, \, \ vec \ omega_ {o}) + \ frac {1} {N} \ sum_ {n = 0} ^ {N } {\ color {Vert} {2 \ pi \, f_r (x, \, \ vec \ omega_ {i}, \, \ vec \ omega_ {o}) \, (\ vec \ omega_ {i} \ cdot \ vec n)} \, L (x, \, \ vec \ omega_ {i})} </script></p><br>  Le rayonnement <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-msubsup" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652" style="margin-right: 0.05em;">L</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-653" style="vertical-align: -0.4em;">e</span></span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">x</span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-657" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-658">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">c</span><span class="MJXp-mtext" id="MJXp-Span-662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">g</span><span class="MJXp-msubsup" id="MJXp-Span-667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-669" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> L_e (x, \, \ vec \ omega_ {o}) </script>  Est juste la valeur retournée par notre fonction <code>Shade</code> . <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-mtext" id="MJXp-Span-673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">c</span><span class="MJXp-mrow" id="MJXp-Span-678"><span class="MJXp-mn" id="MJXp-Span-679">1</span></span><span class="MJXp-mrow" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ frac {1} {N} </script>  déjà en cours d'exécution dans notre fonction <code>AddShader</code> .  Multiplication par <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">L</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">x</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-687" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-688">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">c</span><span class="MJXp-mtext" id="MJXp-Span-692">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">g</span><span class="MJXp-msubsup" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-699" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> L (x, \, \ vec \ omega_ {i}) </script>  se produit lorsque nous réfléchissons le rayon et le traçons plus loin.  Notre tâche est de donner vie à la partie verte de l'équation. <br><br><h1>  Prérequis </h1><br>  Avant de se lancer dans un voyage, prenons soin de certains aspects: accumulation d'échantillons, scènes déterministes et aléatoire des shaders. <br><br><h2>  Accumulation </h2><br>  Pour une raison quelconque, Unity ne me transmet pas la texture HDR comme <code>destination</code> dans <code>OnRenderImage</code> .  Le format <code>R8G8B8A8_Typeless</code> a fonctionné pour moi, donc la précision devient rapidement trop faible pour accumuler un grand nombre d'échantillons.  Pour gérer cela, ajoutons <code>private RenderTexture _converged</code> au <code>private RenderTexture _converged</code> C # <code>private RenderTexture _converged</code> .  Ce sera notre tampon, accumulant avec une grande précision les résultats avant de les afficher à l'écran.  Nous initialisons / libérons la texture de la même manière que <code>_target</code> dans la fonction <code>InitRenderTexture</code> .  Dans la fonction <code>Render</code> , doublez le blitting: <br><br><pre> <code class="cs hljs">Graphics.Blit(_target, _converged, _addMaterial); Graphics.Blit(_converged, destination);</code> </pre> <br><h2>  Scènes déterministes </h2><br>  Lorsque vous modifiez le rendu pour évaluer l'effet, il est utile de comparer avec les résultats précédents.  Jusqu'à présent, à chaque redémarrage du mode Play ou recompilation du script, nous aurons une nouvelle scène aléatoire.  Pour éviter cela, ajoutez le <code>public int SphereSeed</code> au <code>public int SphereSeed</code> C # et la ligne suivante au début de <code>SetUpScene</code> : <br><br><pre> <code class="cs hljs">Random.InitState(SphereSeed);</code> </pre> <br>  Maintenant, nous pouvons définir manuellement les scènes de départ.  Entrez un nombre et activez / <code>RayTracingMaster</code> jusqu'à ce que vous obteniez la bonne scène. <br><br>  Les paramètres suivants ont été utilisés pour des exemples d'images: Sphere Seed 1223832719, Sphere Radius [5, 30], Spheres Max 10000, Sphere Placement Radius 100. <br><br><h2>  Aléatoire du shader </h2><br>  Avant de commencer l'échantillonnage stochastique, nous devons ajouter un caractère aléatoire au shader.  J'utiliserai la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chaîne canonique que</a> j'ai trouvée sur le réseau, modifiée pour plus de commodité: <br><br><pre> <code class="cs hljs">float2 _Pixel; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _Seed; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rand</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> result = frac(sin(_Seed / <span class="hljs-number"><span class="hljs-number">100.0f</span></span> * dot(_Pixel, float2(<span class="hljs-number"><span class="hljs-number">12.9898f</span></span>, <span class="hljs-number"><span class="hljs-number">78.233f</span></span>))) * <span class="hljs-number"><span class="hljs-number">43758.5453f</span></span>); _Seed += <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  Initialisez <code>_Pixel</code> directement dans <code>CSMain</code> comme <code>_Pixel = id.xy</code> afin que chaque pixel puisse utiliser différentes valeurs aléatoires.  <code>_Seed</code> initialisé à partir de C # dans la fonction <code>SetShaderParameters</code> . <br><br><pre> <code class="cs hljs">RayTracingShader.SetFloat(<span class="hljs-string"><span class="hljs-string">"_Seed"</span></span>, Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>);</code> </pre> <br>  La qualité des nombres aléatoires générés ici est instable.  À l'avenir, il serait intéressant d'explorer et de tester cette fonction en analysant l'influence des paramètres et en la comparant à d'autres approches.  Mais pour l'instant, nous allons simplement l'utiliser et espérer pour le mieux. <br><br><h1>  Échantillonnage hémisphérique </h1><br>  Commençons encore: nous avons besoin de directions aléatoires uniformément réparties dans l'hémisphère.  Cette tâche non triviale pour l'étendue complète est décrite en détail dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article par</a> Corey Simon.  Il est facile de s'adapter à l'hémisphère.  Voici à quoi ressemble le code du shader: <br><br><pre> <code class="hljs pgsql">float3 SampleHemisphere(float3 normal) { //     <span class="hljs-type"><span class="hljs-type">float</span></span> cosTheta = rand(); <span class="hljs-type"><span class="hljs-type">float</span></span> sinTheta = sqrt(max(<span class="hljs-number"><span class="hljs-number">0.0</span></span>f, <span class="hljs-number"><span class="hljs-number">1.0</span></span>f - cosTheta * cosTheta)); <span class="hljs-type"><span class="hljs-type">float</span></span> phi = <span class="hljs-number"><span class="hljs-number">2</span></span> * PI * rand(); float3 tangentSpaceDir = float3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta); //      <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mul(tangentSpaceDir, GetTangentSpace(normal)); }</code> </pre> <br>  Les directions sont générées pour un hémisphère centré sur l'axe Z positif, nous devons donc les transformer pour qu'elles soient centrées sur la normale souhaitée.  Nous générons une tangente et binormale (deux vecteurs orthogonaux à la normale et orthogonaux l'un à l'autre).  Tout d'abord, nous sélectionnons un vecteur auxiliaire pour générer la tangente.  Pour ce faire, nous prenons l'axe X positif et ne revenons au Z positif que s'il est normalement (approximativement) aligné avec l'axe X. Ensuite, nous pouvons utiliser le produit vectoriel pour générer la tangente, puis le binormal. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">float3x3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTangentSpace</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">float3 normal</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       float3 helper = float3(1, 0, 0); if (abs(normal.x) &gt; 0.99f) helper = float3(0, 0, 1); //   float3 tangent = normalize(cross(normal, helper)); float3 binormal = normalize(cross(normal, tangent)); return float3x3(tangent, binormal, normal); }</span></span></code> </pre> <br><h1>  Diffusion de Lambert </h1><br>  Maintenant que nous avons des directions aléatoires uniformes, nous pouvons procéder à la mise en œuvre du premier BRDF.  Pour la réflexion diffuse, le plus couramment utilisé est le Lambert BRDF, qui est étonnamment simple: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-msubsup" id="MJXp-Span-703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-705" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">x</span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-709" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-710">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">c</span><span class="MJXp-mtext" id="MJXp-Span-714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">g</span><span class="MJXp-msubsup" id="MJXp-Span-719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-721" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-724" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">c</span><span class="MJXp-mtext" id="MJXp-Span-729">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">g</span><span class="MJXp-msubsup" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-736" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-740">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">c</span><span class="MJXp-mrow" id="MJXp-Span-745"><span class="MJXp-msubsup" id="MJXp-Span-746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-748" style="vertical-align: -0.4em;">d</span></span></span><span class="MJXp-mrow" id="MJXp-Span-749"><span class="MJXp-mtext" id="MJXp-Span-750">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> f_r (x, \, \ vec \ omega_ {i}, \, \ vec \ omega_ {o}) = \ frac {k_d} {\ pi} </script>  où <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-msubsup" id="MJXp-Span-754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-756" style="vertical-align: -0.4em;">d</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> k_d </script>  - C'est la surface de l'albédo.  Insérons-le dans notre équation de rendu Monte Carlo (je ne prendrai pas encore en compte l'émissivité) et voyons ce qui se passe: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">L</span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">x</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-762" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-763">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">c</span><span class="MJXp-mtext" id="MJXp-Span-767">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">g</span><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-777">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">x</span><span class="MJXp-mtext" id="MJXp-Span-784">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">c</span><span class="MJXp-mrow" id="MJXp-Span-789"><span class="MJXp-mn" id="MJXp-Span-790">1</span></span><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">N</span></span><span class="MJXp-mtext" id="MJXp-Span-793">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">u</span><span class="MJXp-msubsup" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">n</span><span class="MJXp-mo" id="MJXp-Span-800">=</span><span class="MJXp-mn" id="MJXp-Span-801">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-804"><span class="MJXp-mtext" id="MJXp-Span-805">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">r</span><span class="MJXp-mrow" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">t</span></span><span class="MJXp-mrow" id="MJXp-Span-822"><span class="MJXp-mn" id="MJXp-Span-823">2</span><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;">d</span></span></span><span class="MJXp-mspace" id="MJXp-Span-827" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-829">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">c</span><span class="MJXp-mtext" id="MJXp-Span-833">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">g</span><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-840" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">t</span><span class="MJXp-mtext" id="MJXp-Span-847">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">n</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-853" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">L</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">x</span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-858" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-859">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">c</span><span class="MJXp-mtext" id="MJXp-Span-863">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">g</span><span class="MJXp-msubsup" id="MJXp-Span-868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-870" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> L (x, \, \ vec \ omega_ {o}) \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {\ color {BlueViolet} {2 k_d} \, (\ vec \ omega_ {i} \ cdot \ vec n) \, L (x, \, \ vec \ omega_ {i})} </script></p><br>  Insérons immédiatement cette équation dans le shader.  Dans la fonction <code>Shade</code> , remplacez le code à l'intérieur de la construction <code>if (hit.distance &lt; 1.#INF)</code> par les lignes suivantes: <br><br><pre> <code class="hljs markdown">//   ray.origin = hit.position + hit.normal <span class="hljs-bullet"><span class="hljs-bullet">* 0.001f; ray.direction = SampleHemisphere(hit.normal); ray.energy *</span></span>= 2 <span class="hljs-bullet"><span class="hljs-bullet">* hit.albedo *</span></span> sdot(hit.normal, ray.direction); return 0.0f;</code> </pre> <br>  La nouvelle direction du faisceau réfléchi est déterminée en utilisant notre fonction d'échantillons d'hémisphère homogènes.  L'énergie du faisceau est multipliée par la partie correspondante de l'équation ci-dessus.  Étant donné que la surface n'émet aucun éclairage (elle ne reflète que la lumière reçue directement ou indirectement du ciel), nous <code>AddShader</code> 0. Ici, n'oubliez pas que <code>AddShader</code> fait la moyenne des échantillons, donc nous n'avons pas à nous soucier de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mtext" id="MJXp-Span-874">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">c</span><span class="MJXp-mrow" id="MJXp-Span-879"><span class="MJXp-mn" id="MJXp-Span-880">1</span></span><span class="MJXp-mrow" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">N</span></span><span class="MJXp-mtext" id="MJXp-Span-883">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> \ frac {1} {N} \ sum </script>  .  <code>CSMain</code> contient déjà la multiplication par <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">L</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">x</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-892" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">c</span><span class="MJXp-mtext" id="MJXp-Span-897">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">g</span><span class="MJXp-msubsup" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-904" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> L (x, \, \ vec \ omega_ {i}) </script>  (le prochain faisceau réfléchi), nous n'avons donc plus beaucoup de travail. <br><br>  <code>sdot</code> est une fonction d'aide que j'ai définie pour moi-même.  Il renvoie simplement le résultat du produit scalaire avec un coefficient supplémentaire, puis le limite à l'intervalle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-907"><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-909">0</span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-911">1</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> [0,1] </script>  : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sdot</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">float3 x, float3 y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> f = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.0f</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> saturate(dot(x, y) * f); }</code> </pre> <br>  Résumons ce que notre code fait jusqu'à présent.  <code>CSMain</code> génère les rayons primaires de la caméra et appelle <code>Shade</code> .  En traversant la surface, cette fonction génère à son tour un nouveau faisceau (uniformément aléatoire dans l'hémisphère autour de la normale) et prend en compte le BRDF du matériau et le cosinus dans l'énergie du faisceau.  À l'intersection du rayon avec le ciel, nous échantillonnons HDRI (notre seule source d'éclairage) et renvoyons l'illumination, qui est multipliée par l'énergie du rayon (c'est-à-dire le résultat de toutes les intersections précédentes, à partir de la caméra).  Il s'agit d'un échantillon simple qui se mélange à un résultat convergent.  Par conséquent, l'impact est pris en compte dans chaque échantillon. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mtext" id="MJXp-Span-914">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">c</span><span class="MJXp-mrow" id="MJXp-Span-919"><span class="MJXp-mn" id="MJXp-Span-920">1</span></span><span class="MJXp-mrow" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> \ frac {1} {N} </script>  . <br><br>  Il est temps de tout vérifier au travail.  Étant donné que les métaux n'ont pas de réflexion diffuse, désactivons-les pour l'instant dans la fonction <code>SetUpScene</code> d'un script C # (mais appelez toujours <code>Random.value</code> ici pour préserver le déterminisme de la scène): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> metal = Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0.0f</span></span>;</code> </pre> <br>  Lancez le mode Lecture et voyez comment l'image initialement bruyante est effacée et converge vers un beau rendu: <br><br><h1>  Image miroir de Phong </h1><br>  Pas mal pour seulement quelques lignes de code (et une petite fraction des calculs).  Affinons l'image en ajoutant des reflets miroir à l'aide du BRDF de Phong.  La formulation originale de Fong avait ses problèmes (manque de relations et de conservation d'énergie), mais heureusement, d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">autres personnes les ont éliminés</a> .  Le BRDF amélioré est illustré ci-dessous. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mtext" id="MJXp-Span-924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">c</span><span class="MJXp-mtext" id="MJXp-Span-928">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">g</span><span class="MJXp-msubsup" id="MJXp-Span-933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-935" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> \ vec \ omega_ {r} </script>  Est la direction de la lumière parfaitement réfléchie, et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-mtext" id="MJXp-Span-938">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> \ alpha </script>  Est un indicateur Phong qui contrôle la rugosité: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-944"><span class="MJXp-msubsup" id="MJXp-Span-945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-947" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">x</span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-951" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-952">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">c</span><span class="MJXp-mtext" id="MJXp-Span-956">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">g</span><span class="MJXp-msubsup" id="MJXp-Span-961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-963" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-966" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">c</span><span class="MJXp-mtext" id="MJXp-Span-971">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">g</span><span class="MJXp-msubsup" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-978" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-984" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mspace" id="MJXp-Span-985" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-986">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">c</span><span class="MJXp-mrow" id="MJXp-Span-991"><span class="MJXp-mtext" id="MJXp-Span-992">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">a</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-999">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1000"><span class="MJXp-mn" id="MJXp-Span-1001">2</span><span class="MJXp-mtext" id="MJXp-Span-1002">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">i</span></span><span class="MJXp-mspace" id="MJXp-Span-1005" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1007">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">c</span><span class="MJXp-mtext" id="MJXp-Span-1011">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">g</span><span class="MJXp-msubsup" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1018" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">r</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1020">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">t</span><span class="MJXp-mtext" id="MJXp-Span-1025">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">c</span><span class="MJXp-mtext" id="MJXp-Span-1029">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">g</span><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1036" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">o</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1038"><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1040" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">a</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> f_r (x, \, \ vec \ omega_ {i}, \, \ vec \ omega_ {o}) = k_s \, \ frac {\ alpha + 2} {2 \ pi} \, (\ vec \ omega_ { r} \ cdot \ vec \ omega_ {o}) ^ \ alpha </script></p><br>  Un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">graphique</a> interactif à deux dimensions montre à quoi ressemble le BRDF pour Phong lorsque <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mtext" id="MJXp-Span-1047">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">a</span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1054">15</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ alpha = 15 </script>  pour un faisceau incident à un angle de 45 °.  Essayez de modifier la valeur. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-mtext" id="MJXp-Span-1056">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> \ alpha </script>  . <br><br>  Collez ceci dans notre équation de rendu Monte Carlo: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">L</span><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">x</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1067" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1068">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">c</span><span class="MJXp-mtext" id="MJXp-Span-1072">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">g</span><span class="MJXp-msubsup" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1079" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1082">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">x</span><span class="MJXp-mtext" id="MJXp-Span-1089">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">c</span><span class="MJXp-mrow" id="MJXp-Span-1094"><span class="MJXp-mn" id="MJXp-Span-1095">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1098">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">u</span><span class="MJXp-msubsup" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">n</span><span class="MJXp-mo" id="MJXp-Span-1105">=</span><span class="MJXp-mn" id="MJXp-Span-1106">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1109"><span class="MJXp-mtext" id="MJXp-Span-1110">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">r</span><span class="MJXp-mrow" id="MJXp-Span-1116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1122"><span class="MJXp-msubsup" id="MJXp-Span-1123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1125" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mspace" id="MJXp-Span-1126" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">a</span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1135">2</span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1137" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">c</span><span class="MJXp-mtext" id="MJXp-Span-1143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">g</span><span class="MJXp-msubsup" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1150" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">r</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">t</span><span class="MJXp-mtext" id="MJXp-Span-1157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">c</span><span class="MJXp-mtext" id="MJXp-Span-1161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">g</span><span class="MJXp-msubsup" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1168" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">o</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1170"><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1172" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">a</span></span><span class="MJXp-mspace" id="MJXp-Span-1178" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">c</span><span class="MJXp-mtext" id="MJXp-Span-1184">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">g</span><span class="MJXp-msubsup" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1191" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">t</span><span class="MJXp-mtext" id="MJXp-Span-1198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">n</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1204" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">L</span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">x</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1209" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1210">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">c</span><span class="MJXp-mtext" id="MJXp-Span-1214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">g</span><span class="MJXp-msubsup" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1221" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> L (x, \, \ vec \ omega_ {o}) \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {\ color {brown} {k_s \, (\ alpha + 2) \, (\ vec \ omega_ {r} \ cdot \ vec \ omega_ {o}) ^ \ alpha} \, (\ vec \ omega_ {i} \ cdot \ vec n) \, L (x, \, \ vec \ omega_ {i})} </script></p><br>  Et enfin, ajoutons ceci au Lambert BRDF existant: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">L</span><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">x</span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1229" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1230">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">c</span><span class="MJXp-mtext" id="MJXp-Span-1234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">g</span><span class="MJXp-msubsup" id="MJXp-Span-1239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1241" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1244">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">x</span><span class="MJXp-mtext" id="MJXp-Span-1251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">c</span><span class="MJXp-mrow" id="MJXp-Span-1256"><span class="MJXp-mn" id="MJXp-Span-1257">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1260">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">u</span><span class="MJXp-msubsup" id="MJXp-Span-1263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">n</span><span class="MJXp-mo" id="MJXp-Span-1267">=</span><span class="MJXp-mn" id="MJXp-Span-1268">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1271"><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">r</span><span class="MJXp-mrow" id="MJXp-Span-1279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1290"><span class="MJXp-mn" id="MJXp-Span-1291">2</span><span class="MJXp-msubsup" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1294" style="vertical-align: -0.4em;">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">r</span><span class="MJXp-mrow" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1308"><span class="MJXp-msubsup" id="MJXp-Span-1309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1311" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mspace" id="MJXp-Span-1312" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">a</span><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1321">2</span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1323" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1325">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">c</span><span class="MJXp-mtext" id="MJXp-Span-1329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">g</span><span class="MJXp-msubsup" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1336" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">r</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1338">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">t</span><span class="MJXp-mtext" id="MJXp-Span-1343">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">c</span><span class="MJXp-mtext" id="MJXp-Span-1347">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">g</span><span class="MJXp-msubsup" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1354" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">o</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1356"><span class="MJXp-mo" id="MJXp-Span-1357" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1358" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">a</span></span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mspace" id="MJXp-Span-1365" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">c</span><span class="MJXp-mtext" id="MJXp-Span-1371">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">g</span><span class="MJXp-msubsup" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1378" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1380">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">t</span><span class="MJXp-mtext" id="MJXp-Span-1385">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">n</span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1391" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">L</span><span class="MJXp-mo" id="MJXp-Span-1393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">x</span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1396" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">c</span><span class="MJXp-mtext" id="MJXp-Span-1401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">g</span><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1408" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> L (x, \, \ vec \ omega_ {o}) \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {[\ color {BlueViolet} {2 k_d} + \ color {brown} {k_s \, (\ alpha + 2) \, (\ vec \ omega_ {r} \ cdot \ vec \ omega_ {o}) ^ \ alpha}] \, (\ vec \ omega_ {i} \ cdot \ vec n) \, L (x, \, \ vec \ omega_ {i})} </script></p><br>  Et voici à quoi ils ressemblent dans le code avec la diffusion Lambert: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    ray.origin = hit.position + hit.normal * 0.001f; float3 reflected = reflect(ray.direction, hit.normal); ray.direction = SampleHemisphere(hit.normal); float3 diffuse = 2 * min(1.0f - hit.specular, hit.albedo); float alpha = 15.0f; float3 specular = hit.specular * (alpha + 2) * pow(sdot(ray.direction, reflected), alpha); ray.energy *= (diffuse + specular) * sdot(hit.normal, ray.direction); return 0.0f;</span></span></code> </pre> <br>  Notez que nous avons remplacé le produit scalaire par un produit légèrement différent, mais équivalent (reflété <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1411"><span class="MJXp-mtext" id="MJXp-Span-1412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">g</span><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1419" style="vertical-align: -0.4em;">o</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ omega_o </script>  au lieu de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-mtext" id="MJXp-Span-1421">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">g</span><span class="MJXp-msubsup" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1428" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ omega_i </script>  )  Maintenant, remettez les matériaux métalliques dans les fonctions <code>SetUpScene</code> et vérifiez comment cela fonctionne. <br><br>  Expérimenter avec différentes valeurs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1429"><span class="MJXp-mtext" id="MJXp-Span-1430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ alpha </script>  , vous pouvez remarquer un problème: même de faibles performances nécessitent beaucoup de temps pour la convergence, et à hautes performances, le bruit est particulièrement frappant.  Même après quelques minutes d'attente, le résultat est loin d'être idéal, ce qui est inacceptable pour une scène aussi simple. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mtext" id="MJXp-Span-1437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">a</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1444">15</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ alpha = 15 </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1445"><span class="MJXp-mtext" id="MJXp-Span-1446">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">a</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1453">300</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ alpha = 300 </script>  avec 8192 échantillons ressemblent à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/09e/966/17e/09e96617eb6f924b6b5d8e99dea941e4.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b6/689/981/1b668998123fb62dba1a3f110e2603f9.png"></div><br>  Pourquoi est-ce arrivé?  Après tout, avant d'avoir de si beaux reflets idéaux ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mtext" id="MJXp-Span-1455">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">a</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1462">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> \ alpha = \ infty </script>  )! .. Le problème est que nous générons <em>des</em> échantillons <em>homogènes</em> et leur attribuons des poids selon BRDF.  Avec des valeurs Phong élevées, le BRDF est petit pour tout le monde, mais ces directions sont très proches d'une réflexion parfaite, et il est très peu probable que nous les sélectionnions au hasard en utilisant nos échantillons <em>homogènes</em> .  D'un autre côté, <em>si</em> nous traversons réellement l'une de ces directions, alors le BRDF sera énorme pour compenser tous les autres petits échantillons.  Le résultat est une très grande dispersion.  Les chemins avec de multiples réflexions spéculaires sont encore pires et entraînent un bruit visible sur les images. <br><br><h1>  Échantillonnage amélioré </h1><br>  Pour rendre notre traceur de chemin pratique, nous devons changer le paradigme.  Au lieu de gaspiller des échantillons précieux sur des zones dans lesquelles ils finissent par être sans importance (car ils obtiennent une très faible valeur BRDF et / ou cosinus), <em>générons des échantillons importants</em> . <br><br>  Dans un premier temps, nous reviendrons sur nos réflexions idéales, puis verrons comment cette idée peut être généralisée.  Pour ce faire, nous divisons la logique d'ombrage en réflexion diffuse et spéculaire.  Pour chaque échantillon, nous choisirons au hasard l'un ou l'autre (en fonction du ratio <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1468"><span class="MJXp-msubsup" id="MJXp-Span-1469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1471" style="vertical-align: -0.4em;">d</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> k_d </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-msubsup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1475" style="vertical-align: -0.4em;">s</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> k_s </script>  )  Dans le cas d'une réflexion diffuse, nous adhérerons à des échantillons homogènes, mais pour le spéculaire, nous réfléchirons explicitement le faisceau dans la seule direction importante.  Étant donné que moins d'échantillons seront désormais dépensés pour chaque type de réflexion, nous devons augmenter l'influence en conséquence, afin d'obtenir la même valeur totale: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//       hit.albedo = min(1.0f - hit.specular, hit.albedo); float specChance = energy(hit.specular); float diffChance = energy(hit.albedo); float sum = specChance + diffChance; specChance /= sum; diffChance /= sum; //     float roulette = rand(); if (roulette &lt; specChance) { //   ray.origin = hit.position + hit.normal * 0.001f; ray.direction = reflect(ray.direction, hit.normal); ray.energy *= (1.0f / specChance) * hit.specular * sdot(hit.normal, ray.direction); } else { //   ray.origin = hit.position + hit.normal * 0.001f; ray.direction = SampleHemisphere(hit.normal); ray.energy *= (1.0f / diffChance) * 2 * hit.albedo * sdot(hit.normal, ray.direction); } return 0.0f;</span></span></code> </pre> <br>  <code>energy</code> est une petite fonction d'aide qui fait la moyenne des canaux de couleur: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">energy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">float3 color</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dot(color, <span class="hljs-number"><span class="hljs-number">1.0f</span></span> / <span class="hljs-number"><span class="hljs-number">3.0f</span></span>); }</code> </pre> <br>  Nous avons donc créé un traceur de rayons Whited plus beau à partir de la partie précédente, mais maintenant avec un véritable ombrage diffus (ce qui implique des ombres douces, une occlusion ambiante, un éclairage global diffus): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/674/f18/ee0/674f18ee0fdf1d734ba6272771e65b86.png" alt="image"></div><br><h1>  Échantillon d'importance </h1><br>  Jetons un autre regard sur la formule de base de Monte Carlo: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1476"><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1480">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">x</span><span class="MJXp-mtext" id="MJXp-Span-1487">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">c</span><span class="MJXp-mrow" id="MJXp-Span-1492"><span class="MJXp-mn" id="MJXp-Span-1493">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">u</span><span class="MJXp-msubsup" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">n</span><span class="MJXp-mo" id="MJXp-Span-1503">=</span><span class="MJXp-mn" id="MJXp-Span-1504">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1507"><span class="MJXp-mtext" id="MJXp-Span-1508">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">c</span><span class="MJXp-mrow" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">f</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1518" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">p</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1525" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-51"> F_N \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {\ frac {f (x_n)} {p (x_n)}} </script></p><br>  Comme vous pouvez le voir, nous divisons l'influence de chaque échantillon (échantillon) sur la probabilité de choisir cet échantillon particulier.  Jusqu'à présent, nous avons utilisé des échantillons d'hémisphère homogènes, nous avons donc eu une constante <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">p</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">a</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1538">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">c</span><span class="MJXp-mrow" id="MJXp-Span-1543"><span class="MJXp-mn" id="MJXp-Span-1544">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1545"><span class="MJXp-mn" id="MJXp-Span-1546">2</span><span class="MJXp-mtext" id="MJXp-Span-1547">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> p (\ omega) = \ frac {1} {2 \ pi} </script>  .  Comme nous l'avons vu plus haut, cela est loin d'être optimal, par exemple dans le cas du Phong BRDF, qui est grand dans un très petit nombre de directions. <br><br>  Imaginez que nous puissions trouver une distribution de probabilité correspondant exactement à la fonction intégrable: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">p</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">x</span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">f</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">x</span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> p (x) = f (x) </script>  .  Ensuite, les événements suivants se produiront: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1560"><span class="MJXp-msubsup" id="MJXp-Span-1561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562" style="margin-right: 0.05em;">F</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1563" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">x</span><span class="MJXp-mtext" id="MJXp-Span-1571">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">c</span><span class="MJXp-mrow" id="MJXp-Span-1576"><span class="MJXp-mn" id="MJXp-Span-1577">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1580">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">u</span><span class="MJXp-msubsup" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">n</span><span class="MJXp-mo" id="MJXp-Span-1587">=</span><span class="MJXp-mn" id="MJXp-Span-1588">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1591"><span class="MJXp-mn" id="MJXp-Span-1592">1</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-54"> F_N \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {1} </script></p><br>  Maintenant, nous n'avons plus d'échantillons qui apportent très peu de contribution.  Ces échantillons seront moins susceptibles d'être sélectionnés.  Cela réduira considérablement la variance du résultat et accélérera la convergence du rendu. <br><br>  En pratique, il est impossible de trouver une telle distribution idéale, car certaines parties de la fonction intégrable (dans notre cas BRDF × cosinus × lumière incidente) sont inconnues (c'est le plus évident pour la lumière incidente), mais la distribution des échantillons selon BRDF × cosinus ou même seulement selon BRDF aidera nous.  Ce principe est appelé échantillonnage par importance. <br><br><h2>  Échantillon de cosinus </h2><br>  Dans les étapes suivantes, nous devons remplacer notre distribution homogène d'échantillons par la distribution selon la règle du cosinus.  N'oubliez pas, au lieu de multiplier les échantillons homogènes par cosinus, en <em>réduisant</em> leur influence, nous voulons générer un nombre d'échantillons proportionnellement <em>plus petit</em> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cet article de</a> Thomas Poole décrit comment procéder.  Nous ajouterons le paramètre <code>alpha</code> à notre fonction <code>SampleHemisphere</code> .  La fonction détermine l'indice de sélection des cosinus: 0 pour un échantillon uniforme, 1 pour la sélection des cosinus, ou supérieur pour les valeurs supérieures de Phong.  En code, cela ressemble à ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SampleHemisphere</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">float3 normal, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> alpha</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  ,      float cosTheta = pow(rand(), 1.0f / (alpha + 1.0f)); float sinTheta = sqrt(1.0f - cosTheta * cosTheta); float phi = 2 * PI * rand(); float3 tangentSpaceDir = float3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta); //      return mul(tangentSpaceDir, GetTangentSpace(normal)); }</span></span></code> </pre> <br>  Maintenant, la probabilité de chaque échantillon est égale <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">p</span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1596">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">a</span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">c</span><span class="MJXp-mrow" id="MJXp-Span-1609"><span class="MJXp-mtext" id="MJXp-Span-1610">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">a</span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1617">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1618"><span class="MJXp-mn" id="MJXp-Span-1619">2</span><span class="MJXp-mtext" id="MJXp-Span-1620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">i</span></span><span class="MJXp-mspace" id="MJXp-Span-1623" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1625">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">c</span><span class="MJXp-mtext" id="MJXp-Span-1629">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">a</span><span class="MJXp-mtext" id="MJXp-Span-1635">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">t</span><span class="MJXp-mtext" id="MJXp-Span-1640">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">n</span><span class="MJXp-msubsup" id="MJXp-Span-1645"><span class="MJXp-mo" id="MJXp-Span-1646" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1647" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> p (\ omega) = \ frac {\ alpha + 1} {2 \ pi} \, (\ vec \ omega \ cdot \ vec n) ^ \ alpha </script>  .  La beauté de cette équation peut ne pas sembler immédiatement évidente, mais un peu plus tard, vous la comprendrez. <br><br><h2>  Échantillon Lambert par importance </h2><br>  Pour commencer, nous allons affiner le rendu de réflexion diffuse.  Dans notre distribution homogène, la constante de Lambert BRDF est déjà utilisée, mais nous pouvons l'améliorer en ajoutant le cosinus.  La distribution de probabilité de l'échantillon par cosinus (où <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1653"><span class="MJXp-mtext" id="MJXp-Span-1654">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">a</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1661">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ alpha = 1 </script>  ) est égal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1662"><span class="MJXp-mtext" id="MJXp-Span-1663">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">c</span><span class="MJXp-mrow" id="MJXp-Span-1668"><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1670">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">c</span><span class="MJXp-mtext" id="MJXp-Span-1674">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">g</span><span class="MJXp-msubsup" id="MJXp-Span-1679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1681" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">t</span><span class="MJXp-mtext" id="MJXp-Span-1688">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">n</span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1694"><span class="MJXp-mtext" id="MJXp-Span-1695">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ frac {(\ vec \ omega_ {i} \ cdot \ vec n)} {\ pi} </script>  , ce qui simplifie notre formule de Monte Carlo pour la réflexion diffuse: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">L</span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">x</span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1703" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1704">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">c</span><span class="MJXp-mtext" id="MJXp-Span-1708">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">g</span><span class="MJXp-msubsup" id="MJXp-Span-1713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1715" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">x</span><span class="MJXp-mtext" id="MJXp-Span-1725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">c</span><span class="MJXp-mrow" id="MJXp-Span-1730"><span class="MJXp-mn" id="MJXp-Span-1731">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1734">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">u</span><span class="MJXp-msubsup" id="MJXp-Span-1737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">n</span><span class="MJXp-mo" id="MJXp-Span-1741">=</span><span class="MJXp-mn" id="MJXp-Span-1742">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1745"><span class="MJXp-mtext" id="MJXp-Span-1746">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">r</span><span class="MJXp-mrow" id="MJXp-Span-1752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1763"><span class="MJXp-msubsup" id="MJXp-Span-1764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1766" style="vertical-align: -0.4em;">d</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1767" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">L</span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">x</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1772" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1773">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">c</span><span class="MJXp-mtext" id="MJXp-Span-1777">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">g</span><span class="MJXp-msubsup" id="MJXp-Span-1782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1784" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-58"> L (x, \, \ vec \ omega_ {o}) \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {\ color {BlueViolet} {k_d} \, L (x , \, \ vec \ omega_ {i})} </script></p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//   ray.origin = hit.position + hit.normal * 0.001f; ray.direction = SampleHemisphere(hit.normal, 1.0f); ray.energy *= (1.0f / diffChance) * hit.albedo;</span></span></code> </pre> <br>  Cela accélérera un peu notre ombrage diffus.  Passons maintenant au vrai problème. <br><br><h2>  Échantillonnage de Fongov par importance </h2><br>  Pour Phong BRDF, la procédure est similaire.  Cette fois, nous avons le produit de deux cosinus: le cosinus standard de l'équation de rendu (comme dans le cas de la réflexion diffuse), multiplié par le cosinus BRDF propre.  Nous ne traiterons que du dernier. <br><br>  Insérons la distribution de probabilité des exemples ci-dessus dans l'équation de Phong.  Une conclusion détaillée peut être trouvée dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lafortune et Willems: Using the Modified Phong Reflectance Model for Physically Based Rendering (1994)</a> : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">L</span><span class="MJXp-mo" id="MJXp-Span-1789" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">x</span><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1792" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1793">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">c</span><span class="MJXp-mtext" id="MJXp-Span-1797">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">g</span><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1804" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">o</span></span></span><span class="MJXp-mo" id="MJXp-Span-1806" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1807">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">x</span><span class="MJXp-mtext" id="MJXp-Span-1814">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">c</span><span class="MJXp-mrow" id="MJXp-Span-1819"><span class="MJXp-mn" id="MJXp-Span-1820">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1823">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">u</span><span class="MJXp-msubsup" id="MJXp-Span-1826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">n</span><span class="MJXp-mo" id="MJXp-Span-1830">=</span><span class="MJXp-mn" id="MJXp-Span-1831">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1834"><span class="MJXp-mtext" id="MJXp-Span-1835">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">r</span><span class="MJXp-mrow" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1847"><span class="MJXp-msubsup" id="MJXp-Span-1848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1850" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mspace" id="MJXp-Span-1851" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1852">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">c</span><span class="MJXp-mrow" id="MJXp-Span-1857"><span class="MJXp-mtext" id="MJXp-Span-1858">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">a</span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1865">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1866"><span class="MJXp-mtext" id="MJXp-Span-1867">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">a</span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1874">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1875" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1888" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889"><font style="vertical-align: inherit;">i</font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891"><font style="vertical-align: inherit;"> c </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-1877">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-1881">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-1886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1888" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1890">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-1895">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mspace" id="MJXp-Span-1901" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mo" id="MJXp-Span-1903" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mspace" id="MJXp-Span-1906" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1907">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-msubsup" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1916"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1918" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919"><font style="vertical-align: inherit;">i</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> )</font></span></font><span class="MJXp-mtext" id="MJXp-Span-1911">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1918" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-59"> L (x, \, \ vec \ omega_ {o}) \ approx \ frac {1} {N} \ sum_ {n = 0} ^ {N} {\ color {brown} {k_s \, \ frac {\ alpha + 2} {\ alpha + 1}} \, (\ vec \ omega_ {i} \ cdot \ vec n) \, L (x, \, \ vec \ omega_ {i})} </script></p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//   float alpha = 15.0f; ray.origin = hit.position + hit.normal * 0.001f; ray.direction = SampleHemisphere(reflect(ray.direction, hit.normal), alpha); float f = (alpha + 2) / (alpha + 1); ray.energy *= (1.0f / specChance) * hit.specular * sdot(hit.normal, ray.direction, f);</span></span></code> </pre> <br>  Ces changements sont suffisants pour éliminer tout problème de hautes performances dans Phong et faire converger notre rendu dans un délai beaucoup plus raisonnable. <br><br><h1>  Matériaux </h1><br>  Enfin, élargissons notre génération de scènes pour créer des valeurs changeantes pour la douceur et l'émissivité des sphères!  Dans la <code>struct Sphere</code> partir d'un script C #, ajoutez <code>public float smoothness</code> <code>public Vector3 emission</code> et <code>public Vector3 emission</code> .  Puisque nous avons changé la taille de la structure, nous devons changer l'étape lors de la création du tampon de calcul (4 × le nombre de nombres flottants, vous vous souvenez?).  Faites en <code>SetUpScene</code> fonction <code>SetUpScene</code> insère des valeurs de douceur et d' <code>SetUpScene</code> . <br><br>  Dans le shader, ajoutez les deux variables à <code>struct Sphere</code> et <code>struct RayHit</code> , puis initialisez-les dans <code>CreateRayHit</code> .  Et enfin, définissez les deux valeurs dans <code>IntersectGroundPlane</code> (codé en dur, collez toutes les valeurs) et <code>IntersectSphere</code> (obtention des valeurs de <code>Sphere</code> ). <br><br>  Je veux utiliser les valeurs de lissage de la même manière que dans le shader Unity standard, qui diffère d'un exposant de Fong plutôt arbitraire.  Voici une bonne conversion qui peut être utilisée dans la fonction <code>Shade</code> : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SmoothnessToPhongAlpha</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pow(<span class="hljs-number"><span class="hljs-number">1000.0f</span></span>, s * s); }</code> </pre> <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> alpha = SmoothnessToPhongAlpha(hit.smoothness);</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa9/7f8/88a/aa97f888aba1c109fdee1d2aa333672c.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f8/874/761/9f8874761f5433acdfdaebcf08d59a2e.png"></div><br>  L'utilisation de l'émissivité se fait en renvoyant une valeur dans <code>Shade</code> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hit.emission;</code> </pre> <br><h1>  Résultats </h1><br>  Respirez profondément.  détendez-vous et attendez que l'image se transforme en une si belle image: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/209/d23/f12/209d23f129b3a20b6bf0f9c2e06d9633.png" alt="image"></div><br>  <strong>Félicitations!</strong>  Vous avez réussi à traverser le fourré d'expressions mathématiques.  Nous avons implémenté un traceur de chemin qui effectue un ombrage diffus et miroir, a appris l'échantillonnage par importance, en appliquant immédiatement ce concept afin que le rendu converge en quelques minutes, pas en heures ou en jours. <br><br>  Par rapport au précédent, cet article a été une étape énorme en termes de complexité, mais a également considérablement amélioré la qualité du résultat.  Travailler avec des calculs mathématiques prend du temps, mais il se justifie car il peut approfondir considérablement votre compréhension de ce qui se passe et vous permettra d'étendre l'algorithme sans détruire la fiabilité physique. <br><br>  Merci d'avoir lu!  Dans la troisième partie, nous quitterons (pendant un certain temps) la jungle de l'échantillonnage et de l'ombrage, et retournerons dans la civilisation à la rencontre des messieurs Moller et Trumbor.  Nous devrons leur parler des triangles. <br><br>  <b>À propos de l'auteur:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David Curie</a> est le développeur de Three Eyed Games, programmeur du laboratoire d'ingénierie virtuelle de Volkswagen, chercheur en infographie et musicien de heavy metal. <br><br><div style="text-align:center;"><img width="20%" height="20%" src="https://habrastorage.org/getpro/habr/post_images/def/4d6/b93/def4d6b933ae1e274ee1c8c511fc0e7b.png" alt="image"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412685/">https://habr.com/ru/post/fr412685/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412675/index.html">Contrats et adresses multisig dans Bitcoin et Ethereum</a></li>
<li><a href="../fr412677/index.html">Matrice de traçabilité</a></li>
<li><a href="../fr412679/index.html">Création d'une application Android pour la reconnaissance de texte en 10 minutes. Mobile Vision CodeLab</a></li>
<li><a href="../fr412681/index.html">Calculs binaires pour l'arithmétique décimale</a></li>
<li><a href="../fr412683/index.html">Où et comment apprendre le machine learning?</a></li>
<li><a href="../fr412687/index.html">Implémentez IdM. Procédures et moyens techniques - du basique à l'IdM</a></li>
<li><a href="../fr412689/index.html">L'analyse informatique prédictive rationalise la surveillance des applications distribuées</a></li>
<li><a href="../fr412691/index.html">Blague de 5 ans sur Facebook ou histoire médico-légale</a></li>
<li><a href="../fr412693/index.html">Écrivez du code facile à supprimer et à déboguer</a></li>
<li><a href="../fr412695/index.html">L'image globale des tests unitaires</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>