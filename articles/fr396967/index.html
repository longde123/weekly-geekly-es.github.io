<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôáüèø üíà ü•™ Lecteur multim√©dia du placard üò£ ‚ôéÔ∏è ü§ûüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Auteur: Nikolai Khabarov
 
 Un beau vendredi soir, j'ai d√©cid√© de regarder un film √† la maison: j'ai allum√© l'ordinateur portable, connect√© le c√¢ble H...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lecteur multim√©dia du placard</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/396967/"><img src="https://habrastorage.org/files/454/fd7/d95/454fd7d9552b452cb8cc2f285fdc88bc.png"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auteur: Nikolai Khabarov</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un beau vendredi soir, j'ai d√©cid√© de regarder un film √† la maison: j'ai allum√© l'ordinateur portable, connect√© le c√¢ble HDMI via l'adaptateur DisplayPort, pris la t√©l√©commande, allum√© le t√©l√©viseur et commenc√© √† jouer sur l'ordinateur portable. Et je me suis rendu compte que le volume du t√©l√©viseur n'√©tait pas suffisant - j'ai d√ª chercher √† nouveau la t√©l√©commande pour l'augmenter ... Puis j'ai pens√©: "Ce processus peut-il √™tre simplifi√© d'une mani√®re ou d'une autre?" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le samedi matin a √©t√© extr√™mement fructueux. J'ai d√©cid√© de cr√©er mon propre lecteur multim√©dia r√©seau, comme je l'imagine. Presque tous les d√©tails ont √©t√© pris dans le garde-manger, le c≈ìur du joueur est le Raspberry Pi. Pour plus de d√©tails, ce qu'il y a √† l'int√©rieur et comment assembler un appareil similaire, voir sous la coupe.</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/files/a14/a2d/e46/a14a2de464df4a66bf1aa09eba6748ef.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir dans la description, mes exigences pour le lecteur sont extr√™mement simples: la capacit√© de lire du contenu depuis le r√©seau, le stockage de plusieurs centaines de gigaoctets, la possibilit√© de contr√¥ler la m√™me t√©l√©commande que le t√©l√©viseur; </font><font style="vertical-align: inherit;">un port USB est souhaitable, mais pas n√©cessaire. </font><font style="vertical-align: inherit;">Les joueurs Android achet√©s ont disparu imm√©diatement, car ces appareils sont principalement de la Chine pure, dans le pire sens du terme, et je n'avais aucune envie de lutter contre les bugs √† l'int√©rieur. </font><font style="vertical-align: inherit;">De plus, il n'est pas clair comment mettre en ≈ìuvre le contr√¥le d'un tel appareil √† partir d'une t√©l√©commande de t√©l√©vision, de plus, l'interface graphique Android n'est clairement pas destin√©e en principe √† la t√©l√©commande. </font><font style="vertical-align: inherit;">Par cons√©quent, la recherche a commenc√© pour les d√©chets √† partir desquels on peut faire quelque chose.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous s√©lectionnons les d√©tails</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, je voudrais juste essayer de comprendre la faisabilit√© de la fabrication du dispositif final. Par cons√©quent, pour commencer, nous allons prendre un minimum de d√©tails et essayer un lecteur multim√©dia potentiel en fonctionnement. Nous allons au garde-manger et creusons litt√©ralement les d√©tails dont nous avons besoin: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Un ordinateur avec une sortie HDMI. L'ancien Raspberry Pi 1 est tout √† fait adapt√© √† nos besoins, vous pouvez √©galement utiliser le Raspberry Pi 2. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Alimentation √©lectrique de la carte - La charge microUSB √† partir d'un ancien t√©l√©phone convient. Vous pouvez prendre n'importe quel "essayer", mais il est conseill√© de prendre une source fournissant un courant de sortie de 1A (un amp√®re pour les yeux suffit pour Pi 2, voir les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exigences</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Carte microSD de 4 Go ou plus.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Souris et / ou clavier USB (sans fil peut √™tre utilis√©) et, en option, r√©cepteur de signal infrarouge TSOP4836 ou similaire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Adaptateur Wi-Fi USB ou possibilit√© de connecter un c√¢ble Ethernet avec Internet √† la carte.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On met OpenElec, on essaie</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä ce stade, nous ex√©cuterons OpenElec de la mani√®re la plus petite possible. D√®s que j'ai pens√© au logiciel de mon lecteur multim√©dia, je me suis souvenu du XBMC, renomm√© plus tard </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kodi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mais il n'y avait aucune envie d'installer un syst√®me d'exploitation, puis de configurer Kodi. J'ai donc d√©cid√© de le rechercher sur Google et j'ai trouv√© cet assemblage du syst√®me d'exploitation GNU / Linux, sur lequel Kodi est d√©j√† install√©. Cet assemblage s'appelle OpenElec, c'est un projet open source. Son site officiel est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">openelec.tv.</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous t√©l√©chargeons donc l'image d'installation √† partir du site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">officiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous s√©lectionnons la version souhait√©e et la plateforme sur laquelle nous l'ex√©cuterons (dans mon cas, la version stable pour Rasberry Pi), et t√©l√©chargeons le 'Diskimage' (fichier avec l'extension .img.gz). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©ballez l'image: </font><font style="vertical-align: inherit;">
Et √©crivez sur la carte m√©moire:</font></font><br>
<code> $ gunzip -d &lt; &gt;.img.gz<br>
</code><br><font style="vertical-align: inherit;"></font><br>
 <code>$ sudo dd if= &lt; &gt;.img of=/dev/mmblck0 bs=4M<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corrigez / dev / mmblck0 - s'il y a plus d'une carte m√©moire dans votre syst√®me. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention! Le contenu de la carte m√©moire sera compl√®tement effac√©.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Les utilisateurs de Windows peuvent utiliser l'utilitaire gratuit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Win32 Disk Imager</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . L'utilitaire a une interface graphique - s√©lectionnez le fichier, la carte m√©moire et appuyez sur ¬´√âcrire¬ª. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assurez-vous maintenant que tout est √©crit sur la carte avec la commande</font></font><br>
<code>$ sync<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou retirez simplement la carte gr√¢ce au retrait s√ªr de l'appareil dans l'interface graphique du syst√®me d'exploitation. Nous l'obtenons physiquement et le mettons dans le Raspberry Pi. Ensuite, connectez le c√¢ble Ethernet √† Internet ou ins√©rez l'adaptateur Wi-Fi USB, connectez la souris, le c√¢ble HDMI au t√©l√©viseur. Si vous souhaitez utiliser une t√©l√©commande infrarouge, vous devez connecter le r√©cepteur IR au GPIO18 et la puissance du processeur (3,3 V). Le sch√©ma de connexion final est le suivant: </font></font><br>
<img src="https://habrastorage.org/files/6d3/6bf/259/6d36bf259da347bcb0a1e6818b949c99.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous d√©cidez d'utiliser un r√©cepteur infrarouge, soyez prudent avec lui </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- assurez-vous que la disposition des broches de votre r√©cepteur est correcte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout, maintenant vous pouvez regarder l'environnement lui-m√™me. Nous alimentons la carte √† partir de la source d'alimentation. Apr√®s le chargement, l'assistant de configuration initiale appara√Æt √† l'√©cran:</font></font><br>
<img src="https://habrastorage.org/files/143/7e8/037/1437e803748c4fc3a275a1a5cacbc1bb.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'installation, je recommande d'activer imm√©diatement l'acc√®s SSH. </font><font style="vertical-align: inherit;">Toutes les autres questions sont triviales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez maintenant jouer avec l'environnement m√™me du futur joueur √† l'aide de la souris et / ou du clavier. </font><font style="vertical-align: inherit;">Vous pouvez essayer de lire la vid√©o dans diff√©rents formats (vous pouvez connecter un lecteur flash USB √† des ports libres) et comprendre g√©n√©ralement ce qui est quoi. </font><font style="vertical-align: inherit;">Il existe diff√©rents cas pour la carte Raspberry Pi elle-m√™me, peut-√™tre que quelqu'un sera satisfait de tout d'une mani√®re si minimaliste, par exemple, vous pouvez connecter une souris USB sans fil et utiliser l'appareil. </font><font style="vertical-align: inherit;">Nous continuerons de l'am√©liorer.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connectez la t√©l√©commande infrarouge</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous d√©cidez de ne pas connecter de r√©cepteur IR, vous pouvez simplement ignorer cette section. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour utiliser la t√©l√©commande, nous devons configurer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIRC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tout d'abord, allumons le module, qui fonctionne directement avec le r√©cepteur via le port GPIO. Pour ce faire, ajoutez une ligne au fichier de configuration DeviceTree. Nous nous connectons via SSH √† votre appareil (avez-vous activ√© SSH lors de la configuration initiale? Sinon, vous pouvez le faire dans l'interface graphique du syst√®me lui-m√™me). </font><font style="vertical-align: inherit;">
Le mot de passe par d√©faut est openelec. Ajoutez la ligne dont nous avons besoin au fichier: </font><font style="vertical-align: inherit;">
√† la toute fin, nous ajoutons la ligne, puis rechargeons: </font><font style="vertical-align: inherit;">
Maintenant, nous devons nous assurer que tout fonctionne et que le LIRC peut recevoir des commandes de la t√©l√©commande, pour cela, nous arr√™tons le LIRC et essayons d'obtenir des donn√©es de la t√©l√©commande:</font></font><br>
<code>$ ssh root@ip_address<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<code># mount -o remount,rw /flash<br>
# nano /flash/config.txt<br>
</code><br><font style="vertical-align: inherit;"></font><br>
 <code> dtoverlay=lirc-rpi<br>
</code><br><font style="vertical-align: inherit;"></font><br>
 <code> # killall lircd<br>
 # mode2 -d /dev/lirc0<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous cliquons sur n'importe quel bouton de la t√©l√©commande et brillons sur le r√©cepteur - un texte d√©crivant les impulsions entrantes devrait s'ex√©cuter dans la console. Maintenant, nous sommes convaincus que tout fonctionne et nous pouvons former LIRC √† utiliser votre t√©l√©commande. Veuillez noter que lircd doit √™tre arr√™t√© pendant le processus de configuration, nous l'avons fait plus t√¥t en utilisant la commande kill. Il existe un utilitaire sp√©cial non enregistr√© pour la formation, nous ex√©cutons les commandes suivantes pour le lancer: </font><font style="vertical-align: inherit;">
Ensuite, suivez les instructions √† l'√©cran. Au d√©but, l'utilitaire vous demandera d'appuyer sur les diff√©rents boutons de la t√©l√©commande jusqu'√† ce que les points sur l'√©cran soient remplis pour apprendre le mod√®le de votre t√©l√©commande. Ensuite, vous devrez indiquer avec le texte le bouton que vous souhaitez apprendre au LIRC √† utiliser et faire briller le r√©cepteur. </font><font style="vertical-align: inherit;">
Je vous recommande d'enseigner au moins les boutons suivants: </font><font style="vertical-align: inherit;">
KEY_UP </font><font style="vertical-align: inherit;">
KEY_DOWN</font></font><br>
<code># cd /storage/.config<br>
# irrecord -d /dev/lirc0 lircd.conf<br>
</code><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_LEFT </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_RIGHT </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_OK </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_PLAY </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_EXIT </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_STOP </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_INFO </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KEY_EPG </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La liste compl√®te des boutons disponibles dans le syst√®me peut √™tre obtenue par la commande: </font><font style="vertical-align: inherit;">
Sur la t√©l√©commande, vous pouvez choisir n'importe quel bouton qui vous convient. La plupart des t√©l√©viseurs en mode HDMI, la plupart des boutons ne font rien, ce qui, bien s√ªr, est √† port√©e de main. Par cons√©quent, nous devrions obtenir le fichier lircd.conf avec les param√®tres de votre t√©l√©commande - nous red√©marrons la carte et essayons d'utiliser la t√©l√©commande. </font><font style="vertical-align: inherit;">
Vous pouvez √©galement allumer / √©teindre le lecteur. Pour ce faire, connectez le r√©cepteur √† la deuxi√®me broche du Raspberry PI GPIO1 pour Raspberry PI 1 ou GPIO3 pour Raspberry PI 2 - sur les deux cartes, ces broches sont situ√©es au m√™me endroit sur le connecteur de la carte:</font></font><br>
<code> # irrecord -list namespace<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<img src="https://habrastorage.org/files/f81/505/c34/f81505c3453242c6afaaa75e72237b19.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En connectant cette broche √† la terre, vous pouvez r√©veiller la carte √† l'√©tat d√©sactiv√©. Avec cette connexion, vous pouvez programmer le bouton KEY_POWER, et le lecteur s'√©teindra lorsque vous cliquez dessus, et il sera activ√© par n'importe quel signal provenant de n'importe quelle t√©l√©commande. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous collectons l'appareil plus au s√©rieux</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voulais cr√©er un appareil plus complet avec l'apparence de l'appareil d'usine et y ajouter un disque dur. J'ai regard√© dans le garde-manger et j'ai trouv√© un vieux r√©cepteur satellite. √Ä l'int√©rieur, il y a d√©j√† une alimentation suffisante pour tous les composants de l'alimentation, il y a un r√©cepteur de signal IR, un interrupteur de mise hors tension sur la paroi arri√®re. Il est √©galement possible de faire une montre sur le panneau avant en raison de l'indicateur √† sept segments d√©j√† install√©. Et bien s√ªr, le bo√Ætier lui-m√™me est parfait pour nos besoins. Le r√©cepteur satellite peut √™tre remplac√© par un ancien lecteur DVD ou VHS m√™me s'il ne fonctionne pas.</font></font><br>
<i>,         ‚Äî   ,        .    /     ‚Äî     ,       220 .</i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ouvrons le bo√Ætier du r√©cepteur / magn√©toscope. Pour commencer, nous devons nous assurer que l'alimentation a une sortie 5V qui peut fournir la puissance n√©cessaire. Pour ce faire, √† l'aide d'un multim√®tre, nous v√©rifions la pr√©sence d'une puissance de 5V puis nous tra√ßons √† travers quels composants ces 5V sont obtenus. Si la base de l'√©l√©ment du redresseur et le diam√®tre de l'enroulement du transformateur du bloc d'alimentation peuvent supporter 2 √† 3 amp√®res, nous avons de la chance - il y a une source, sinon vous devrez changer la source dans le bo√Ætier pour une plus puissante. Ensuite, nous sortons la carte principale / le lecteur de bande / le lecteur optique et le renvoyons au garde-manger - il vous sera utile. A l'int√©rieur, on ne laisse que la carte PSU et la carte avec un panneau avant sur lequel se trouve un r√©cepteur IR.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choisissez maintenant o√π installer le Raspberry Pi lui-m√™me. Le choix ici est assez simple: le c√¥t√© de la carte avec HDMI doit sortir du bo√Ætier, le c√¥t√© avec les ports USB doit √™tre mont√© √† l'int√©rieur pour connecter les composants internes, de plus, nous avons besoin d'au moins un acc√®s √† la carte microSD en cas de changement de firmware. Il y a des ouvertures pour les connecteurs RCA sur le bo√Ætier du r√©cepteur, nous allons mettre la carte de sorte que le connecteur HDMI soit aussi accessible que possible √† l'ext√©rieur. Du m√™me c√¥t√©, il y a des sorties de la carte son et du microUSB fonctionnant en mode p√©riph√©rique. Nous ne sommes pas int√©ress√©s par ces connecteurs, nous fournirons une alimentation de l'ext√©rieur via le connecteur GPIO principal de la carte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous indiquons o√π vous devez couper un peu afin que le connecteur HDMI soit ins√©r√© librement dans la carte depuis l'ext√©rieur du bo√Ætier et d√©crivons quatre trous pour l'installation de la carte. J'ai utilis√© les racks suivants:</font></font><br>
<img src="https://habrastorage.org/files/29f/6ab/6c5/29f6ab6c5f4b4e2daf092489d0ba57a7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les racks de la carte m√®re sont intervenus et je les ai retir√©s √† l'aide d'une pince. Les manipulations doivent √™tre effectu√©es avec soin, avec un mouvement maladroit, vous pouvez facilement plier le bo√Ætier lui-m√™me. Nous forons, scions, fixons le rack avec des boulons appropri√©s et la planche elle-m√™me. </font></font><br>
<img src="https://habrastorage.org/files/2bf/30d/ec7/2bf30dec733c4c6ca8db3c46d4beb367.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez maintenant trouver un emplacement pour le disque dur. Ici, l'exigence est assez simple - vous devez laisser quelques centim√®tres libres √† l'int√©rieur du bo√Ætier depuis le c√¥t√© du connecteur SATA, car un adaptateur y sera ins√©r√©. Le disque dur a des fils sur la surface inf√©rieure et les c√¥t√©s du disque dur. Winchester doit √™tre l√©g√®rement sur√©lev√© afin qu'il ne repose pas sur le m√©tal. J'ai r√©solu le probl√®me tr√®s simplement - j'ai pris des boulons adapt√©s au filetage inf√©rieur, mais un peu plus longtemps que n√©cessaire, et j'ai √©tabli la distance entre le bo√Ætier et le disque dur avec des √©crous plus gros.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous devons trouver un convertisseur USB SATA ou un ancien conteneur pour disque dur, d'o√π un tel convertisseur peut √™tre retir√©. J'avais un conteneur, mais malheureusement il s'est av√©r√© inop√©rant. J'ai d√ª courir au magasin pour le convertisseur USB SATA. Nous allons ins√©rer le connecteur USB dans le Raspberry PI, mais afin de ne pas charger la carte avec des courants assez graves dont le disque dur a besoin, en particulier lors de la rotation de la broche, vous devez effectuer une alimentation suppl√©mentaire directement √† partir du bloc d'alimentation. Dans mon cas, l'adaptateur avait un c√¢ble avec deux connecteurs USB, j'ai connect√© l'un d'entre eux directement au bloc d'alimentation en soudant le connecteur de r√©ponse USB pr√®s du bloc d'alimentation.</font></font><br>
<img src="https://habrastorage.org/files/f53/06a/235/f5306a2353de423592d7e82a33878e1c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deux choses de plus √† penser tout de suite. Le premier est o√π et comment le port USB externe sera situ√©. La seconde est o√π placer l'adaptateur Wi-Fi, ou si vous pr√©voyez de n'impl√©menter qu'une connexion Ethernet, comment placer le connecteur Ethernet sur le mur du bo√Ætier (si vous placez la carte avec le bord de ce connecteur sur le bo√Ætier, vous ne pouvez pas connecter de p√©riph√©riques USB de l'int√©rieur). Ethernet peut √™tre allong√© en pla√ßant une prise murale conventionnelle √† l'int√©rieur du bo√Ætier et en sertissant un fil court avec un connecteur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De tr√®s petits dongles Wi-Fi USB sont vendus maintenant, mais vous n'avez pas besoin de les mettre dans un bo√Ætier m√©tallique - le signal peut mal passer. Vous pouvez prendre un court c√¢ble d'extension USB, mettre le connecteur USB √† l'arri√®re du bo√Ætier et l'ins√©rer l√†. Il existe √©galement des adaptateurs USB avec des antennes amovibles, vous pouvez √©tendre le connecteur RMA √† l'arri√®re du bo√Ætier et y visser l'antenne. J'avais un adaptateur Wi-Fi USB assez ancien et, par cons√©quent, plut√¥t grand avec une antenne enveloppante et une entr√©e miniUSB. Je n'avais nulle part o√π le mettre √† cause de sa taille, et j'ai d√©cid√© de l'utiliser en entreprise. Il a retir√© le bo√Ætier - sa forme ne permettait pas de fixer l'antenne de l'ext√©rieur. Les frais √©taient assez √©lev√©s et je devais r√©fl√©chir soigneusement √† leur emplacement. Heureusement, il s'est av√©r√© √™tre tr√®s mince, et j'ai d√©cid√© de le mettre sur les connecteurs USB du Raspberry Pi. Le connecteur RMA est sortitordu sur un √©crou et √† l'int√©rieur du bo√Ætier, placez un support haut pour la carte. L'acc√®s √† l'USB est rest√© et l'antenne a √©t√© soulev√©e au-dessus du bo√Ætier. Super!</font></font><br>
<img src="https://habrastorage.org/files/c1d/ed1/7c7/c1ded17c77d24ba0b3f44aadb5e88ae9.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, vous devez en quelque sorte fixer le c√¢ble d'extension USB sur le panneau avant, en vous assurant qu'il n'interf√®re pas avec quoi que ce soit √† l'int√©rieur du bo√Ætier. Dans mon cas, le r√©cepteur avait une porte pour les cartes d'acc√®s, et j'ai d√©cid√© de mettre un connecteur derri√®re - pour ne pas accumuler de poussi√®re! Par cons√©quent, je ne l'ai pas coup√© trop soigneusement et je l'ai rempli de colle chaude √† l'arri√®re.</font></font><br>
<img src="https://habrastorage.org/files/800/d2b/468/800d2b46858841028fdacbd45c9eee9a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La situation avec la carte du panneau avant est plus int√©ressante - il existe de nombreuses options pour ce qu'elle comprend. J'ai d√ª impl√©menter l'indication dynamique des indicateurs √† sept segments en utilisant DMA (l'acc√®s direct √† la m√©moire, l'impl√©mentation directe de l'indication dynamique via les ports GPIO consommerait trop de ressources CPU et la luminosit√© des segments serait in√©gale en raison de l'activit√© du syst√®me d'exploitation). Mais c'est d√©j√† un sujet pour un article s√©par√©, et en outre, de tels tableaux peuvent diff√©rer radicalement.Par cons√©quent, nous donnerons ici le droit de montrer notre potentiel cr√©atif au lecteur. Vous pouvez √©tudier le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code source de l'impl√©mentation de ma carte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans le cas le plus simple, vous pouvez simplement couper les pistes allant vers le r√©cepteur IR et les souder directement avec trois fils. </font><font style="vertical-align: inherit;">Je note seulement que j'ai utilis√© un c√¢ble IDE pour se connecter au connecteur GPIO de la carte, il s'adapte parfaitement au connecteur Raspberry Pi et les fils peuvent √™tre facilement soud√©s avec d'autres composants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au final, j'ai eu un tel appareil:</font></font><br>
<img src="https://habrastorage.org/files/1fd/936/99e/1fd93699eee74e1888e1fd8476e10135.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personnaliser</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si, lorsque vous allumez, vous voyez un carr√© color√© dans le coin sup√©rieur droit de l'√©cran, cela signifie que l'alimentation du Raspberry Pi n'est pas suffisante - soit une alimentation faible, des fils trop fins ou des p√©riph√©riques USB prennent trop. Dans le premier cas, seul le remplacement du bloc d'alimentation par un bloc plus puissant vous aidera. Dans le second, le probl√®me peut √™tre facilement r√©solu en rempla√ßant les fils par des c√¢bles plus √©pais ou en utilisant plusieurs noyaux en parall√®le, dans le troisi√®me, le probl√®me est r√©solu en alimentant les p√©riph√©riques USB directement √† partir de l'alimentation, ou, par exemple, en installant un concentrateur USB avec la possibilit√© de connecter une source d'alimentation externe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous verrez √©galement probablement que votre disque dur est connect√© au syst√®me en tant que lecteur flash externe. Faisons-en le stockage principal du syst√®me d'exploitation. Au premier d√©marrage, OpenElec commence automatiquement √† utiliser tout l'espace libre sur la carte microSD pour la section de donn√©es, qui est ensuite mont√©e en tant que / stockage. La d√©cision la plus r√©ussie me semble utiliser l'int√©gralit√© du disque dur comme / stockage. Pour ce faire, formatez le disque dur et cr√©ez une partition dessus avec le syst√®me de fichiers ext3 / 4. Cela peut √™tre fait directement sur le lecteur √† l'aide des utilitaires parted et mkfs, les commandes ci-dessous effaceront l'int√©gralit√© du contenu du disque et cr√©eront une partition ext4: </font><font style="vertical-align: inherit;">
Pour cela, vous devrez vous connecter au lecteur via SSH. Montez ensuite la nouvelle partition quelque part:</font></font><br>
<br>
<code># umount /dev/sda1<br>
 # parted /dev/sda<br>
 GNU Parted 3.2<br>
 Using /dev/sda<br>
 Welcome to GNU Parted! Type 'help' to view a list of commands.<br>
 (parted) mklabel GPT <br>
 mklabel GPT<br>
 Warning: The existing disk label on /dev/sda will be destroyed and all data on<br>
 this disk will be lost. Do you want to continue?<br>
 Yes/No? yes <br>
 yes<br>
 (parted) mkpart primary 2048s 100% <br>
 mkpart primary 2048s 100%<br>
 (parted) q <br>
 q<br>
 Information: You may need to update /etc/fstab.<br>
 # mkfs.ext4 /dev/sda1<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<code># mkdir /tmp/hdd<br>
# mount /dev/sda1 /tmp/hdd<br>
</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez l'int√©gralit√© du contenu de / stockage sur une nouvelle partition afin de conserver l'√©tat actuel: </font><font style="vertical-align: inherit;">
d√©montez la partition et, si vous le souhaitez, supprimez le dossier: </font><font style="vertical-align: inherit;">
vous devez maintenant sp√©cifier le lecteur que nous devons monter au d√©marrage. Vous pouvez le faire en ajustant la ligne de commande des param√®tres du noyau, mais nous d√©couvrons d'abord l'UUID de la partition de notre disque dur: </font><font style="vertical-align: inherit;">
Copiez l'UUID de la partition dans le presse-papiers. Remontez maintenant le syst√®me de fichiers avec la configuration du noyau pour l'√©criture et corrigez-le: </font><font style="vertical-align: inherit;">
Dans le fichier, remplacez le param√®tre de disque par l'UUID de notre disque. Le contenu du fichier devrait ressembler √† ceci: </font><font style="vertical-align: inherit;">
Apr√®s le red√©marrage, le lecteur utilisera le disque dur comme / stockage, et la section sur la carte m√©moire peut √™tre supprim√©e afin qu'elle ne se monte pas automatiquement au d√©marrage:</font></font><br>
 <code># cp -rf /storage/. /tmp/hdd<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
 <code># umount /dev/sda1<br>
# rmdir /tmp/hdd<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<code># blkid /dev/sda1<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<code># mount -o rw,remount /flash<br>
# nano /flash/cmdline.txt<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<code>boot=/dev/mmcblk0p1 disk=UUID=95013338-89b1-43af-8471-9b30efc85d98 quiet<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<code># parted -s /dev/mmcblk0 rm 2<br>
</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un week-end si amusant que j'ai eu. </font><font style="vertical-align: inherit;">N'oubliez pas que le syst√®me d'exploitation GNU / Linux est √† bord de ce lecteur multim√©dia, et vous pouvez le modifier / compl√©ter vous-m√™me √† votre guise. </font><font style="vertical-align: inherit;">Vous pouvez √©galement r√©soudre certaines t√¢ches de domotique, en utilisant le m√™me appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et enfin, une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vid√©o du discours de l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auteur d'un article racontant l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonne visualisation!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr396967/">https://habr.com/ru/post/fr396967/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr396957/index.html">Achetez rapidement et simplement aux USA avec Pochtoy.com (+ cadeau pour les lecteurs)</a></li>
<li><a href="../fr396959/index.html">La physique dans le monde animal: l'anguille √©lectrique et sa "centrale"</a></li>
<li><a href="../fr396961/index.html">Qui construit un r√©acteur √† fusion</a></li>
<li><a href="../fr396963/index.html">Comment acheter un iPhone d'occasion</a></li>
<li><a href="../fr396965/index.html">Intercepter une conversation au t√©l√©phone ou comment faire une simple commande radio √† 39 MHz</a></li>
<li><a href="../fr396969/index.html">Intel Maintenant fr√®re dans les bras</a></li>
<li><a href="../fr396971/index.html">Il est propos√© de faire revivre un eider sans ailes √† l'aide du g√©nie g√©n√©tique.</a></li>
<li><a href="../fr396973/index.html">Aux √âtats-Unis, les fabricants n'ont pas le droit de refuser une garantie apr√®s avoir retir√© l'autocollant de garantie. Qu'est-ce qui se passe en Russie?</a></li>
<li><a href="../fr396975/index.html">Ordinateur dans la voiture, ann√©e 2016</a></li>
<li><a href="../fr396977/index.html">L'intelligence artificielle a des probl√®mes de langage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>