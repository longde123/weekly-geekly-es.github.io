<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😌 🙅🏾 ⚒️ Berapa data untuk pelatihan model (tidak) mirip dengan sampel uji? 🦔 📦 👨🏽‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pertimbangkan satu skenario di mana model pembelajaran mesin Anda mungkin tidak berharga. 

 Ada pepatah: "Jangan membandingkan apel dengan jeruk . " ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Berapa data untuk pelatihan model (tidak) mirip dengan sampel uji?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422185/">  Pertimbangkan satu skenario di mana model pembelajaran mesin Anda mungkin tidak berharga. <br><br>  Ada pepatah: <i>"Jangan membandingkan apel dengan jeruk</i> . <i>"</i>  Tetapi bagaimana jika Anda perlu membandingkan satu set apel dengan jeruk dengan yang lain, tetapi distribusi buah dalam dua set berbeda?  Bisakah Anda bekerja dengan data?  Dan bagaimana Anda akan melakukannya? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/0y/oi/lt0yoiaq5fua0l1gfpguoigfxfa.png"></div><a name="habracut"></a><br>  Dalam kasus nyata, situasi ini biasa terjadi.  Saat mengembangkan model pembelajaran mesin, kami dihadapkan pada situasi di mana model kami bekerja dengan baik dengan set pelatihan, tetapi kualitas model menurun tajam pada data uji. <br><br>  Dan ini bukan tentang pelatihan ulang.  Katakanlah kita telah membangun model yang memberikan hasil luar biasa pada validasi silang, tetapi menunjukkan hasil yang buruk pada pengujian.  Jadi dalam sampel uji ada informasi yang tidak kami perhitungkan. <br><br>  Bayangkan sebuah situasi di mana kita memprediksi perilaku pelanggan di toko.  Jika sampel pelatihan dan tes terlihat seperti gambar di bawah ini, ini merupakan masalah yang jelas: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vk/ki/j2/vkkij2n5rlshttroh8mqfse-zf4.png"></div><br>  <i>Dalam contoh ini, model dilatih pada data dengan nilai rata-rata dari atribut "usia pelanggan" lebih rendah dari nilai rata-rata dari atribut yang sama pada tes.</i>  <i>Dalam proses pembelajaran, model tidak pernah "melihat" nilai-nilai yang lebih besar dari atribut "usia".</i>  <i>Jika usia adalah fitur penting untuk model, maka orang seharusnya tidak mengharapkan hasil yang baik pada sampel uji.</i> <br><br>  Dalam teks ini, kita akan berbicara tentang pendekatan "naif" yang memungkinkan kita untuk mengidentifikasi fenomena seperti itu dan mencoba untuk menghilangkannya. <br><br><h3>  Pergeseran kovarian </h3><br>  Mari kita berikan definisi yang lebih akurat dari konsep ini.  <b>Kovarian</b> mengacu pada nilai-nilai karakteristik, dan <b>pergeseran kovarian</b> mengacu pada situasi di mana distribusi nilai-nilai karakteristik dalam pelatihan dan sampel uji memiliki karakteristik (parameter) yang berbeda. <br><br>  Dalam masalah dunia nyata dengan sejumlah besar variabel, pergeseran kovarian sulit dideteksi.  Artikel ini membahas metode untuk mengidentifikasi, serta memperhitungkan pergeseran kovarian dalam data. <br><br><img src="https://habrastorage.org/webt/no/ta/lj/notaljh1r3c8nimkt45_lp3yyco.png"><br><br><h3>  Ide utama </h3><br>  <i>Jika ada pergeseran dalam data, maka ketika mencampur dua sampel, kita dapat membangun classifier yang dapat menentukan apakah objek tersebut milik pelatihan atau sampel uji.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pw/v-/42/pwv-42li1_tl9jqyghnph6czcsg.png"></div><br>  Mari kita mengerti mengapa demikian.  Mari kita kembali ke contoh dengan pelanggan, di mana usia adalah tanda "bergeser" dari pelatihan dan sampel uji.  Jika kita mengambil classifier (misalnya, berdasarkan hutan acak) dan mencoba untuk membagi sampel campuran menjadi pelatihan dan tes, maka usia akan menjadi tanda yang sangat penting untuk klasifikasi ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j1/29/wf/j129wfqmbguam_2axs1h6liyt4e.png"></div><br><h3>  Implementasi </h3><br>  Mari kita coba menerapkan ide yang diuraikan ke dataset nyata.  Gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dataset</a> dari kompetisi Kaggle. <br><br><h4>  Langkah 1: persiapan data </h4><br>  Pertama, kami akan mengikuti serangkaian langkah standar: bersihkan, isi bagian yang kosong, lakukan penyandian label untuk tanda-tanda kategorikal.  Tidak diperlukan langkah untuk dataset yang dimaksud, jadi lewati deskripsinya. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-comment"><span class="hljs-comment">#  train  test train = pd.read_csv('train.csv',low_memory=True) test = pd.read_csv('test.csv',low_memory=True)</span></span></code> </pre> <br><h4>  Langkah 2: menambahkan indikator sumber data </h4><br>  Penting untuk menambahkan indikator indikator baru ke kedua bagian dataset - pelatihan dan tes.  Untuk sampel pelatihan dengan nilai "1", untuk tes, masing-masing, "0". <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,   test,   train test['is_train'] = 0 train['is_train'] = 1</span></span></code> </pre><br><h4>  Langkah 3: Menggabungkan Sampel Pembelajaran dan Tes </h4><br>  Sekarang Anda harus menggabungkan dua set data.  Karena dataset pelatihan berisi kolom nilai target 'target', yang tidak ada dalam dataset uji, kolom ini harus dihapus. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  train, test df_combine = pd.concat([train, test], axis=0, ignore_index=True) #  target df_combine = df_combine.drop('target', axis =1) y = df_combine['is_train'].values #  x = df_combine.drop('is_train', axis=1).values #  tst, trn = test.values, train.values</span></span></code> </pre><br><h4>  Langkah 4: membangun dan menguji classifier </h4><br>  Untuk tujuan klasifikasi, kami akan menggunakan Pengklasifikasi Hutan Acak, yang akan kami konfigurasikan untuk memprediksi label sumber data dalam kumpulan data gabungan.  Anda dapat menggunakan penggolong lain. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np rfc = RandomForestClassifier(n_jobs=<span class="hljs-number"><span class="hljs-number">-1</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">5</span></span>, min_samples_leaf = <span class="hljs-number"><span class="hljs-number">5</span></span>) predictions = np.zeros(y.shape) <span class="hljs-comment"><span class="hljs-comment">#    </span></span></code> </pre><br>  Kami menggunakan split acak bertingkat 4 lipatan.  Dengan cara ini kami akan menjaga rasio label 'is_train' di setiap lipatan seperti pada sampel gabungan asli.  Untuk setiap partisi kita latih classifier pada sebagian besar partisi dan prediksi label kelas untuk bagian yang lebih kecil ditangguhkan. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StratifiedKFold, cross_val_score skf = StratifiedKFold(n_splits=<span class="hljs-number"><span class="hljs-number">4</span></span>, shuffle=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fold, (train_idx, test_idx) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(skf.split(x, y)): X_train, X_test = x[train_idx], x[test_idx] y_train, y_test = y[train_idx], y[test_idx] rfc.fit(X_train, y_train) probs = rfc.predict_proba(X_test)[:, <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   predictions[test_idx] = probs</span></span></code> </pre><br><h4>  Langkah 5: interpretasikan hasilnya </h4><br>  Kami menghitung nilai metrik ROC AUC untuk classifier kami.  Berdasarkan nilai ini, kami menyimpulkan seberapa baik klasifikasi kami mengungkapkan perubahan kovarian dalam data. <br><br>  <i>Jika classifier c memisahkan objek dengan baik ke dalam set data pelatihan dan tes, maka nilai metrik ROC AUC harus secara signifikan lebih besar dari 0,5, idealnya mendekati 1. Gambar ini menunjukkan pergeseran kovarian yang kuat dalam data.</i> <br><br>  Cari nilai ROC AUC: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> roc_auc_score print(<span class="hljs-string"><span class="hljs-string">'ROC-AUC:'</span></span>, roc_auc_score(y_true=y, y_score=predictions)) <span class="hljs-comment"><span class="hljs-comment"># ROC-AUC: 0.49974692698385287</span></span></code> </pre><br>  Nilai yang dihasilkan mendekati 0,5.  Dan ini berarti bahwa classifier kualitas kami sama dengan prediktor tag acak.  Tidak ada bukti pergeseran kovarian dalam data. <br><br>  Karena dataset diambil dari Kaggle, hasilnya cukup dapat diprediksi.  Seperti dalam kompetisi pembelajaran mesin lainnya, data diverifikasi dengan cermat untuk memastikan tidak ada perubahan. <br><br>  Tetapi pendekatan ini dapat diterapkan dalam masalah lain dari ilmu data untuk memeriksa keberadaan pergeseran kovarian tepat sebelum dimulainya solusi. <br><br><h2>  Langkah selanjutnya </h2><br>  Jadi, apakah kita mengamati perubahan kovarian atau tidak.  Apa yang harus dilakukan untuk meningkatkan kualitas model dalam ujian? <br><br><ol><li>  Hapus fitur yang bias </li><li>  Gunakan bobot kepentingan objek berdasarkan estimasi koefisien kerapatan </li></ol><br><h3>  Menghapus fitur yang bias: </h3><br>  <i><b>Catatan:</b> metode ini berlaku jika ada pergeseran kovarian dalam data.</i> <br><br><ul><li>  Ekstrak pentingnya atribut dari Random Forest Classifier, yang kami bangun dan latih sebelumnya. </li><li>  Tanda-tanda yang paling penting adalah mereka yang bias dan menyebabkan pergeseran data. </li><li>  Dimulai dengan yang paling penting, hapus berdasarkan satu, bangun model target dan lihat kualitasnya.  Kumpulkan semua tanda yang kualitas modelnya tidak menurun. </li><li>  Buang karakteristik yang dikumpulkan dari data dan buat model akhir. </li></ul><br><img src="https://habrastorage.org/webt/oa/ga/08/oaga08t43dtyoazhcor8bk3mb8w.png"><br>  <i>Algoritma ini memungkinkan Anda untuk menghapus tanda-tanda dari keranjang merah dalam diagram.</i> <br><br><h3>  Menggunakan bobot kepentingan objek berdasarkan estimasi koefisien kerapatan </h3><br>  <i><b>Catatan:</b> metode ini berlaku terlepas dari apakah ada pergeseran kovarian dalam data.</i> <br><br>  Mari kita lihat prediksi yang kami terima di bagian sebelumnya.  Untuk setiap objek, prediksi berisi probabilitas bahwa objek ini milik pelatihan yang ditetapkan untuk classifier kami. <br><br><pre> <code class="python hljs">predictions[:<span class="hljs-number"><span class="hljs-number">10</span></span>] <span class="hljs-comment"><span class="hljs-comment">#array([0.39743827 ...</span></span></code> </pre><br>  Misalnya, untuk objek pertama, Pengklasifikasi Hutan Acak kami meyakini bahwa objek tersebut termasuk dalam rangkaian pelatihan dengan probabilitas 0,397.  Sebut nilai ini <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.051ex" height="2.66ex" viewBox="0 -832 4327.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-6B" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-65" x="1662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-72" x="2129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-65" x="2580" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-74" x="3047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-61" x="3408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-29" x="3938" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> P (kereta) </script>  .  Atau kita dapat mengatakan bahwa kemungkinan memiliki data uji adalah 0,603.  Demikian pula, kami menyebutnya probabilitas <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.408ex" height="2.66ex" viewBox="0 -832 3189.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-74" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-65" x="1502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-73" x="1969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-74" x="2438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-29" x="2800" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> P (test) </script>  . <br><br>  Sekarang sedikit trik: untuk setiap objek dataset pelatihan, kami menghitung koefisien <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.185ex" height="2.66ex" viewBox="0 -832 11274.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-3D" x="994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-66" x="2300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-72" x="2851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-61" x="3302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-63" x="3832" y="0"></use><g transform="translate(4265,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-74" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-65" x="1502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-73" x="1969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-74" x="2438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-29" x="2800" y="0"></use></g><g transform="translate(7455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-74" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-72" x="1502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-61" x="1954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-69" x="2483" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-6E" x="2829" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMAIN-29" x="3429" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mo stretchy="false">(</mo><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mo stretchy="false">(</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3"> w = \ frac {P (test)} {P (train)} </script>  . <br><br>  Koefisien <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.455ex" viewBox="0 -520.7 716.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-77" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> w </script>  memberitahu kita seberapa dekat suatu objek dari set pelatihan untuk menguji data.  Gagasan utama: <br><br>  <i>Kita bisa menggunakan</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.455ex" viewBox="0 -520.7 716.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhN866IN01Sf7WvsyWkpWYsU9XNaA#MJMATHI-77" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> w </script></i>   <i>seperti bobot dalam salah satu model untuk menambah bobot pengamatan yang terlihat mirip dengan sampel uji.</i>  <i>Secara intuitif, ini masuk akal, karena model kami akan lebih berorientasi pada data seperti pada test suite.</i> <br><br>  Bobot ini dapat dihitung menggunakan kode: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)) predictions_train = predictions[:len(trn)] weights = (<span class="hljs-number"><span class="hljs-number">1.</span></span>/predictions_train) - <span class="hljs-number"><span class="hljs-number">1.</span></span> weights /= np.mean(weights) <span class="hljs-comment"><span class="hljs-comment">#  plt.xlabel('  w') plt.ylabel(' ') sns.distplot(weights, kde=False)</span></span></code> </pre><br>  Koefisien yang diperoleh dapat ditransfer ke model, misalnya, sebagai berikut: <br><br><pre> <code class="python hljs">rfc = RandomForestClassifier(n_jobs=<span class="hljs-number"><span class="hljs-number">-1</span></span>,max_depth=<span class="hljs-number"><span class="hljs-number">5</span></span>) m.fit(X_train, y_train, sample_weight=weights)</code> </pre><br><br><img src="https://habrastorage.org/webt/_z/nw/rn/_znwrn70amqpw4xosahu1hgj6oa.png"><br><br>  Beberapa kata tentang histogram yang dihasilkan: <br><br><ul><li>  Nilai berat yang lebih besar sesuai dengan pengamatan yang lebih mirip dengan sampel uji. </li><li>  Hampir 70% dari objek dari set pelatihan memiliki bobot mendekati 1, dan, oleh karena itu, terletak di subruang yang mirip dengan set pelatihan dan set tes.  Ini sesuai dengan nilai AUC yang kami hitung sebelumnya. </li></ul><br><h2>  Kesimpulan </h2><br>  Kami berharap posting ini akan membantu Anda mengidentifikasi "pergeseran kovarian" dalam data dan memeranginya. <br><br><h2>  Referensi </h2><br>  [1] Shimodaira, H. (2000).  Meningkatkan inferensi prediktif di bawah pergeseran kovariat dengan memberi bobot fungsi log-likelihood.  Jurnal Perencanaan dan Inferensi Statistik, 90, 227-244. <br>  [2] Bickel, S. et al.  (2009).  Pembelajaran Diskriminatif Dalam Pergeseran Kovariat.  Jurnal Penelitian Pembelajaran Mesin, 10, 2137–2155 <br>  [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github.com/erlendd/covariate-shift-adaption</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tautan ke dataset yang digunakan</a> <br><br>  PS Laptop dengan kode dari artikel dapat dilihat di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id422185/">https://habr.com/ru/post/id422185/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id422175/index.html">Polusi lingkungan mengurangi kemampuan kognitif manusia</a></li>
<li><a href="../id422177/index.html">Mengapa Arduino begitu lambat dan apa yang bisa dilakukan untuk itu</a></li>
<li><a href="../id422179/index.html">Dari awan ke bumi: cara membuat Kubernet tingkat produksi di lingkungan apa pun</a></li>
<li><a href="../id422181/index.html">Cara mengumpulkan layanan perusahaan pada satu platform online: sejarah MegaFon. Bisnis</a></li>
<li><a href="../id422183/index.html">Dan apa, mungkinkah lebih murah?</a></li>
<li><a href="../id422187/index.html">Sberseason: bagaimana saya menghabiskan musim panas ini</a></li>
<li><a href="../id422189/index.html">Kebenaran Tentang Implementasi Portal Intranet</a></li>
<li><a href="../id422191/index.html">Bagaimana saya membuat aplikasi pengenalan teks Android yang menguntungkan</a></li>
<li><a href="../id422195/index.html">Penggunaan ACS dalam penambangan</a></li>
<li><a href="../id422197/index.html">Kami mengatakan sepatah kata pun tentang estafet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>