<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–ğŸ¼ â­ï¸ ğŸš´ğŸ¿ å¦‚ä½•ä½¿ç”¨systemd-nspawnè¿˜åŸLinuxç³»ç»Ÿ ğŸŠ ğŸ‘©â€ğŸ­ ğŸ™…ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬æ–‡çš„ç¿»è¯‘æ˜¯ä¸“é—¨ä¸ºLinux Administratorè¯¾ç¨‹çš„å­¦ç”Ÿå‡†å¤‡çš„ã€‚ 




 æˆ‘ä»¬å¤„ç†systemdè¿è¡Œå®¹å™¨ä»¥æ¢å¤å·²æŸåç³»ç»Ÿçš„æ ¹æ–‡ä»¶ç³»ç»Ÿçš„èƒ½åŠ›ã€‚ 

 åªè¦å­˜åœ¨GNU / Linuxç³»ç»Ÿï¼Œç³»ç»Ÿç®¡ç†å‘˜å°±éœ€è¦ä»æ ¹æ–‡ä»¶ç³»ç»Ÿçš„æŸåï¼Œæ„å¤–çš„é…ç½®æ›´æ”¹æˆ–å…¶ä»–é˜»æ­¢ç³»ç»ŸåŠ è½½åˆ°â€œæ­£å¸¸â€çŠ¶æ€çš„æƒ…å†µä¸­æ¢å¤ã€‚ 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¦‚ä½•ä½¿ç”¨systemd-nspawnè¿˜åŸLinuxç³»ç»Ÿ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/470497/">  <b><i>æœ¬æ–‡çš„ç¿»è¯‘æ˜¯ä¸“é—¨ä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Linux Administrator</a>è¯¾ç¨‹çš„å­¦ç”Ÿå‡†å¤‡çš„ã€‚</i></b> <br><br><img src="https://habrastorage.org/webt/89/hr/ul/89hrulhpdopce09kual8rabdjm4.png"><br><br><hr><br>  <i>æˆ‘ä»¬å¤„ç†<b>systemd</b>è¿è¡Œå®¹å™¨ä»¥æ¢å¤å·²æŸåç³»ç»Ÿçš„æ ¹æ–‡ä»¶ç³»ç»Ÿçš„èƒ½åŠ›ã€‚</i> <i><br><br></i>  <i>åªè¦å­˜åœ¨GNU / Linuxç³»ç»Ÿï¼Œç³»ç»Ÿç®¡ç†å‘˜å°±éœ€è¦ä»æ ¹æ–‡ä»¶ç³»ç»Ÿçš„æŸåï¼Œæ„å¤–çš„é…ç½®æ›´æ”¹æˆ–å…¶ä»–é˜»æ­¢ç³»ç»ŸåŠ è½½åˆ°â€œæ­£å¸¸â€çŠ¶æ€çš„æƒ…å†µä¸­æ¢å¤ã€‚</i> <br><a name="habracut"></a><br> é€šå¸¸ï¼ŒLinuxå‘è¡Œç‰ˆåœ¨å¯åŠ¨æ—¶ä¼šæä¾›ä¸€ä¸ªæˆ–å¤šä¸ªèœå•é€‰é¡¹ï¼ˆä¾‹å¦‚ï¼Œåœ¨GRUBèœå•ä¸­ï¼‰ï¼Œå¯ç”¨äºä¿®å¤æŸåçš„ç³»ç»Ÿã€‚ é€šå¸¸ï¼Œä»–ä»¬ä¼šåœ¨å¤§å¤šæ•°ç³»ç»ŸæœåŠ¡å…³é—­çš„æƒ…å†µä¸‹ä»¥å•ç”¨æˆ·æ¨¡å¼å¯åŠ¨ç³»ç»Ÿã€‚ åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥åœ¨å¼•å¯¼åŠ è½½ç¨‹åºä¸­æ›´æ”¹å†…æ ¸å‘½ä»¤è¡Œï¼Œä»¥å°†æ ‡å‡†å¤–å£³ç¨‹åºç”¨ä½œåˆå§‹åŒ–è¿›ç¨‹ï¼ˆPID 1ï¼‰ã€‚ è¿™ç§æ–¹æ³•æœ€å¤æ‚ï¼Œè€Œä¸”å……æ»¡å›°éš¾ï¼Œå¯èƒ½å¯¼è‡´æ—¶é—´æŸå¤±å’ŒæŒ«è´¥æ„Ÿï¼ŒåŒæ—¶è¿˜éœ€è¦æ¢å¤ç³»ç»Ÿã€‚ <br><br> æœ€é‡è¦çš„æ˜¯ï¼Œæ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½å‡å®šæŸåçš„ç³»ç»Ÿå…·æœ‰æŸç§ç‰©ç†æ§åˆ¶å°ï¼Œä½†æ˜¯åœ¨äº‘è®¡ç®—æ—¶ä»£ï¼Œè¿™ä¸å†å¯ä»¥ä¾é ã€‚ å¦‚æœæ²¡æœ‰ç‰©ç†æ§åˆ¶å°ï¼Œåªæœ‰å‡ ç§é€‰æ‹©ï¼ˆå¦‚æœå®ƒä»¬ä»ç„¶å¯ç”¨ï¼‰ä»¥è¿™ç§æ–¹å¼å½±å“å¼•å¯¼è¿‡ç¨‹ã€‚ å³ä½¿æ˜¯ç‰©ç†æœºä¹Ÿå¯èƒ½æ˜¯å°å‹çš„å†…ç½®è®¾å¤‡ï¼Œå®ƒä»¬æ²¡æœ‰æ˜“äºä½¿ç”¨çš„æ§åˆ¶å°ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†æ­£ç¡®çš„ç”µç¼†å’Œä¸²è¡Œç«¯å£é€‚é…å™¨å¹¶è®¾ç½®äº†ç»ˆç«¯ä»¿çœŸå™¨ï¼Œåœ¨ç´§æ€¥æƒ…å†µä¸‹åœ¨ä¸²è¡Œç«¯å£ä¸Šä½¿ç”¨æ§åˆ¶å°çš„ä¸€åˆ‡é€šå¸¸éƒ½éå¸¸å¤æ‚ã€‚ <br><br> å½“å¦ä¸€ä¸ªç³»ç»Ÿå¯ç”¨æ—¶ï¼ˆå…·æœ‰ç›¸åŒçš„ä½“ç³»ç»“æ„å’Œé€šå¸¸ç±»ä¼¼çš„é…ç½®ï¼‰ï¼Œç®€åŒ–æ¢å¤è¿‡ç¨‹çš„ä¸€èˆ¬æ–¹æ³•æ˜¯ä»æŸåçš„ç³»ç»Ÿä¸­åˆ é™¤å­˜å‚¨è®¾å¤‡ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºè¾…åŠ©è®¾å¤‡è¿æ¥åˆ°å·¥ä½œç³»ç»Ÿã€‚ åœ¨ç‰©ç†ç³»ç»Ÿä¸Šï¼Œè¿™é€šå¸¸å¾ˆç®€å•ï¼Œå¹¶ä¸”å¤§å¤šæ•°äº‘è®¡ç®—å¹³å°ä¹Ÿå¯ä»¥æ”¯æŒæ­¤åŠŸèƒ½ï¼Œå› ä¸ºå®ƒä»¬å…è®¸æ‚¨å°†æŸåå®ä¾‹çš„æ ¹å·æŒ‚è½½åˆ°å¦ä¸€ä¸ªå®ä¾‹ä¸­ã€‚ <br><br> å°†æ ¹æ–‡ä»¶ç³»ç»Ÿè¿æ¥åˆ°å¦ä¸€ä¸ªç³»ç»Ÿåï¼Œå¯ä»¥ä½¿ç”¨<b>fsck</b>å’Œå…¶ä»–å·¥å…·è§£å†³æ–‡ä»¶ç³»ç»ŸæŸåé—®é¢˜ã€‚ å¯¹é…ç½®é”™è¯¯ï¼ŒæŸåçš„ç¨‹åºåŒ…æˆ–å…¶ä»–é—®é¢˜è¿›è¡Œæ•…éšœæ’é™¤å¯èƒ½ä¼šæ›´åŠ å›°éš¾ï¼Œå› ä¸ºå®ƒä»¬è¦æ±‚æ‚¨æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿä»¥åŠæŸ¥æ‰¾å’Œä¿®æ”¹æ­£ç¡®çš„é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“ã€‚ <br><br><h3> ä½¿ç”¨systemd </h3><br> åœ¨<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">systemd</a></b>å‡ºç°ä¹‹å‰ï¼Œå®é™…ä¸Šä¿®å¤é…ç½®çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ç¼–è¾‘é…ç½®æ–‡ä»¶ã€‚ æŸ¥æ‰¾å¿…è¦çš„æ–‡ä»¶å¹¶äº†è§£å…¶å†…å®¹æ˜¯ä¸€é¡¹å•ç‹¬çš„ä»»åŠ¡ï¼Œä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´ä¹‹å†…ã€‚ <br><br> å½“GNU / Linuxç³»ç»Ÿä½¿ç”¨<b>systemdæ—¶</b> ï¼Œæœ€å¥½ä½¿ç”¨å®ƒæä¾›çš„å·¥å…·æ¥å®Œæˆè®¸å¤šé…ç½®æ›´æ”¹-ä¾‹å¦‚ï¼Œå¯ç”¨æˆ–ç¦ç”¨æœåŠ¡éœ€è¦åœ¨å„ä¸ªä½ç½®åˆ›å»ºæˆ–åˆ é™¤ç¬¦å·é“¾æ¥ã€‚  <b>systemctl</b>å·¥å…·ç”¨äºè¿›è¡Œè¿™äº›æ›´æ”¹ï¼Œä½†ä½¿ç”¨å®ƒéœ€è¦<b>systemd</b>å®ä¾‹å·¥ä½œå¹¶ä¾¦å¬è¯·æ±‚ï¼ˆé€šè¿‡D-Busï¼‰ã€‚ å½“æ ¹æ–‡ä»¶ç³»ç»Ÿä½œä¸ºé™„åŠ æ–‡ä»¶ç³»ç»Ÿå®‰è£…åœ¨å¦ä¸€å°è®¡ç®—æœºä¸Šæ—¶ï¼Œä¸èƒ½ä½¿ç”¨systemdçš„å·¥ä½œå®ä¾‹è¿›è¡Œè¿™äº›æ›´æ”¹ã€‚ <br><br> æ‰‹åŠ¨å¯åŠ¨ç›®æ ‡ç³»ç»Ÿçš„systemdä¹Ÿæ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå› ä¸ºå®ƒè¢«è®¾è®¡ä¸ºPID 1è¿›ç¨‹æ¥æ§åˆ¶æ‰€æœ‰å…¶ä»–è¿›ç¨‹ï¼Œè¿™å¯èƒ½ä¸ç”¨äºæ ¡æ­£çš„ç³»ç»Ÿä¸­å·²ç»è¿è¡Œçš„å®ä¾‹å‘ç”Ÿå†²çªã€‚ <br><br> å¹¸è¿çš„æ˜¯ï¼Œ <b>systemd</b>èƒ½å¤Ÿè¿è¡Œå®¹å™¨-å…·æœ‰è‡ªå·±çš„PID 1å’Œç¯å¢ƒçš„å®Œå…¨å°è£…çš„GNU / Linuxç³»ç»Ÿï¼Œè¯¥å®¹å™¨ä½¿ç”¨Linuxå†…æ ¸æä¾›çš„å„ç§åç§°ç©ºé—´åŠŸèƒ½ã€‚ ä¸Dockerå’ŒRocketä¹‹ç±»çš„å·¥å…·ä¸åŒï¼Œ <b>systemd</b>ä¸éœ€è¦å®¹å™¨æ˜ åƒå³å¯è¿è¡Œè¯¥å®¹å™¨ã€‚ ä»–å¯ä»¥åœ¨ç°æœ‰æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä»»ä½•ä½ç½®ä»¥rootç‰¹æƒè¿è¡Œå®ƒã€‚ è¿™æ˜¯ä½¿ç”¨<b>systemd-nspawnå·¥å…·å®Œæˆçš„</b> ï¼Œè¯¥<b>å·¥å…·</b>å°†åˆ›å»ºå¿…è¦çš„ç³»ç»Ÿåç§°ç©ºé—´ï¼Œå¹¶åœ¨å®¹å™¨ä¸­å¯åŠ¨åˆå§‹è¿‡ç¨‹ï¼Œç„¶åæä¾›æ§åˆ¶å°ã€‚ ä¸<b>chroot</b> ï¼ˆä»…æ›´æ”¹æ–‡ä»¶ç³»ç»Ÿçš„å¯è§æ ¹ï¼‰ä¸åŒï¼Œæ­¤ç±»å‹çš„å®¹å™¨å°†å…·æœ‰å•ç‹¬çš„æ–‡ä»¶ç³»ç»Ÿåç§°ç©ºé—´ï¼Œåœ¨<b>/ dev</b> ï¼Œ <b>/ run</b>å’Œ<b>/ procä¸­</b>å®‰è£…çš„åˆé€‚çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥åŠå•ç‹¬çš„è¿›ç¨‹åç§°ç©ºé—´å’ŒIPCã€‚ è®¿é—®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸»è¦çš„</a> <b>systemd-nspawn</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">èµ„æº</a>ä»¥äº†è§£æœ‰å…³å…¶åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ã€‚ <br><br><h3> æ¼”ç¤ºå…¶å·¥ä½œåŸç†çš„ç¤ºä¾‹ </h3><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒåŒ…å«å—æŸç³»ç»Ÿæ ¹æ–‡ä»¶ç³»ç»Ÿçš„å­˜å‚¨è®¾å¤‡å·²è¿æ¥è‡³æ­£åœ¨è¿è¡Œçš„ç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œå…¶æ˜¾ç¤ºä¸º<b>/ dev / vdc</b> ã€‚ è®¾å¤‡çš„åç§°å°†å–å†³äºç°æœ‰å­˜å‚¨è®¾å¤‡çš„æ•°é‡ï¼Œè®¾å¤‡çš„ç±»å‹ä»¥åŠç”¨äºå°†å…¶è¿æ¥åˆ°ç³»ç»Ÿçš„æ–¹æ³•ã€‚ æ ¹æ–‡ä»¶ç³»ç»Ÿå¯ä»¥ä½¿ç”¨æ•´ä¸ªå­˜å‚¨è®¾å¤‡ï¼Œä¹Ÿå¯ä»¥é©»ç•™åœ¨è®¾å¤‡å†…éƒ¨çš„åˆ†åŒºä¸­ã€‚ ç”±äºæœ€å¸¸è§ï¼ˆç®€å•ï¼‰çš„é…ç½®å°†æ ¹æ–‡ä»¶ç³»ç»Ÿæ”¾ç½®åœ¨è®¾å¤‡çš„ç¬¬ä¸€ä¸ªåˆ†åŒºä¸­ï¼Œå› æ­¤åœ¨æœ¬ç¤ºä¾‹ä¸­å°†ä½¿ç”¨<b>/ dev / vdc1</b> ã€‚  <i>ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç³»ç»Ÿè®¾å¤‡åç§°æ›¿æ¢ä»¥ä¸‹å‘½ä»¤ä¸­çš„è®¾å¤‡åç§°</i> ã€‚ <br><br> æŸåçš„æ ¹æ–‡ä»¶ç³»ç»Ÿä¹Ÿå¯èƒ½æ¯”è®¾å¤‡ä¸Šå•ç‹¬çš„æ–‡ä»¶ç³»ç»Ÿå¤æ‚ã€‚ å®ƒå¯ä»¥æ˜¯LVMä¸­çš„å·ï¼Œä¹Ÿå¯ä»¥æ˜¯RAIDé˜µåˆ—ä¸­ç»„åˆçš„ä¸€ç»„è®¾å¤‡ä¸Šçš„å·ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¿…é¡»å…ˆå®Œæˆå¿…è¦çš„æ­¥éª¤æ‰èƒ½åˆ›å»ºå’Œæ¿€æ´»åŒ…å«æ–‡ä»¶ç³»ç»Ÿçš„é€»è¾‘è®¾å¤‡ï¼Œç„¶åå†å°†å…¶å®‰è£…ã€‚ åŒæ ·ï¼Œè¿™äº›æ­¥éª¤è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚ <br><br><h3> å¿…è¦çš„å‡†å¤‡ </h3><br> é¦–å…ˆï¼Œç¡®ä¿å·²å®‰è£…systemd-nspawnå·¥å…·-å¤§å¤šæ•°GNU / Linuxå‘è¡Œç‰ˆé»˜è®¤éƒ½ä¸å®‰è£…å®ƒã€‚ å¤§å¤šæ•°å‘è¡Œç‰ˆä¸­çš„systemd-containerè½¯ä»¶åŒ…éƒ½æä¾›äº†æ­¤è½¯ä»¶åŒ…ï¼Œå› æ­¤è¯·ä½¿ç”¨å‘è¡Œç‰ˆçš„è½¯ä»¶åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ã€‚ æœ¬ç¤ºä¾‹ä¸­çš„æŒ‡ä»¤å·²ä½¿ç”¨Debian 9è¿›è¡Œäº†æµ‹è¯•ï¼Œä½†åœ¨ä»»ä½•ç°ä»£GNU / Linuxå‘è¡Œç‰ˆä¸­å‡åº”ç±»ä¼¼åœ°å·¥ä½œã€‚ <br><br> ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å‡ ä¹è‚¯å®šä¼šéœ€è¦rootç‰¹æƒï¼Œå› æ­¤æ‚¨è¦ä¹ˆéœ€è¦ä»¥rootèº«ä»½ç™»å½•ï¼Œè¦ä¹ˆä½¿ç”¨sudoè·å¾—å…·æœ‰rootç‰¹æƒçš„shellï¼Œè¦ä¹ˆå°†sudoå‰ç¼€æ·»åŠ åˆ°æ¯ä¸ªå‘½ä»¤ä¸­ã€‚ <br><br><h3> æ£€æŸ¥å¹¶æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ </h3><br> é¦–å…ˆä½¿ç”¨fsckæ£€æŸ¥ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å’Œå†…å®¹ï¼š <br><br><pre><code class="bash hljs">$ fsck /dev/vdc1</code> </pre> <br> å¦‚æœä»–å‘ç°æ–‡ä»¶ç³»ç»Ÿæœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ç›¸åº”åœ°å›ç­”é—®é¢˜ä»¥åŠ ä»¥è§£å†³ã€‚ å¦‚æœæ–‡ä»¶ç³»ç»Ÿä¸¥é‡æŸåï¼Œå°†æ— æ³•ä¿®å¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å°†ä¸å¾—ä¸å¯»æ‰¾å…¶ä»–æ–¹æ³•æ¥æå–å…¶å†…å®¹ã€‚ <br><br> ç°åœ¨åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•å¹¶å°†ç›®æ ‡æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°å…¶ä¸­ï¼š <br><br><pre> <code class="bash hljs">$ mkdir /tmp/target-rescue $ mount /dev/vdc1 /tmp/target-rescue</code> </pre> <br> æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿåï¼Œå°†å…¶ä½œä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿè¿è¡Œå®¹å™¨ï¼š <br><br><pre> <code class="bash hljs">$ systemd-nspawn --directory /tmp/target-rescue --boot -- --unit rescue.target</code> </pre> <br> ç”¨äºå¯åŠ¨å®¹å™¨çš„å‘½ä»¤è¡Œå‚æ•°ï¼š <br><br><ul><li>  <b>--directory / tmp / target-rescue</b>æä¾›äº†å®¹å™¨æ ¹æ–‡ä»¶ç³»ç»Ÿçš„è·¯å¾„ã€‚ </li><li>  <b>--boot</b>åœ¨å®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿä¸­å¯»æ‰¾åˆé€‚çš„åˆå§‹åŒ–ç¨‹åºå¹¶å¯åŠ¨å®ƒï¼Œå¹¶ä»å‘½ä»¤è¡Œå°†å‚æ•°ä¼ é€’ç»™å®ƒã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œç›®æ ‡ç³»ç»Ÿè¿˜ä½¿ç”¨<b>systemd</b>ä½œä¸ºè¿›ç¨‹çš„PID 1ï¼Œå› æ­¤å…¶ä½™å‚æ•°é€‚ç”¨äºè¯¥è¿›ç¨‹ã€‚ å¦‚æœè¦è¿˜åŸçš„ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å…¶ä»–å·¥å…·ä½œä¸ºè¿›ç¨‹çš„PID 1ï¼Œåˆ™éœ€è¦ç›¸åº”åœ°é…ç½®è®¾ç½®ã€‚ </li><li>  -å°†ç”¨äºå®¹å™¨è¿›ç¨‹PID 1çš„å‚æ•°ä¸<b>systemd-nspawn</b>åˆ†å¼€ã€‚ </li><li>  <b>--unit rescue.target</b>å‘Šè¯‰å®¹å™¨ä¸­çš„<b>systemd</b>åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­åº”å°è¯•å®ç°çš„ç›®æ ‡çš„åç§°ã€‚ ä¸ºäº†ç®€åŒ–ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ¢å¤æ“ä½œï¼Œè¯·ä»¥â€œæ¢å¤â€æ¨¡å¼è€Œä¸æ˜¯æ­£å¸¸çš„å¤šç”¨æˆ·æ¨¡å¼å¯åŠ¨å®ƒã€‚ </li></ul><br> å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„è¾“å‡ºï¼š <br><br><pre> <code class="bash hljs">Spawning container target-rescue on /tmp/target-rescue. Press ^] three <span class="hljs-built_in"><span class="hljs-built_in">times</span></span> within 1s to <span class="hljs-built_in"><span class="hljs-built_in">kill</span></span> container. systemd 232 running <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> system mode. (+PAM +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD +IDN) Detected virtualization systemd-nspawn. Detected architecture arm. Welcome to Debian GNU/Linux 9 (Stretch)! Set hostname to &lt;<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>&gt;. Failed to install release agent, ignoring: No such file or directory [ OK ] Reached target Swap. [ OK ] Listening on Journal Socket (/dev/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>). [ OK ] Started Dispatch Password Requests to Console Directory Watch. [ OK ] Reached target Encrypted Volumes. [ OK ] Created slice System Slice. Mounting POSIX Message Queue File System... [ OK ] Listening on Journal Socket. Starting Set the console keyboard layout... Starting Restore / save the current clock... Starting Journal Service... Starting Remount Root and Kernel File Systems... [ OK ] Mounted POSIX Message Queue File System. [ OK ] Started Journal Service. [ OK ] Started Remount Root and Kernel File Systems. Starting Flush Journal to Persistent Storage... [ OK ] Started Restore / save the current clock. [ OK ] Started Flush Journal to Persistent Storage. [ OK ] Started Set the console keyboard layout. [ OK ] Reached target Local File Systems (Pre). [ OK ] Reached target Local File Systems. Starting Create Volatile Files and Directories... [ OK ] Started Create Volatile Files and Directories. [ OK ] Reached target System Time Synchronized. Starting Update UTMP about System Boot/Shutdown... [ OK ] Started Update UTMP about System Boot/Shutdown. [ OK ] Reached target System Initialization. [ OK ] Started Rescue Shell. [ OK ] Reached target Rescue Mode. Starting Update UTMP about System Runlevel Changes... [ OK ] Started Update UTMP about System Runlevel Changes. You are <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rescue mode. After logging <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> <span class="hljs-string"><span class="hljs-string">"journalctl -xb"</span></span> to view system logs, <span class="hljs-string"><span class="hljs-string">"systemctl reboot"</span></span> to reboot, <span class="hljs-string"><span class="hljs-string">"systemctl default"</span></span> or ^D to boot into default mode. Give root password <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> maintenance (or press Control-D to <span class="hljs-built_in"><span class="hljs-built_in">continue</span></span>):</code> </pre> <br> åœ¨æ­¤è¾“å‡ºä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°<b>systemd</b>ä½œä¸ºå®¹å™¨ä¸­çš„initè¿›ç¨‹å¯åŠ¨ï¼Œå¹¶ç¡®å®šå®ƒåœ¨å®¹å™¨ä¸­è¿è¡Œï¼Œä»¥ä¾¿å¯ä»¥è‡ªå®šä¹‰å…¶è¡Œä¸ºã€‚ ä¸ºäº†ä½¿å®¹å™¨å·¥ä½œï¼Œå¯åŠ¨äº†å„ç§å•å…ƒæ–‡ä»¶ï¼Œç„¶åè¦æ±‚ç›®æ ‡ç³»ç»Ÿçš„æ ¹å¯†ç ã€‚ å¦‚æœè¦è¯·æ±‚å…·æœ‰rootç‰¹æƒçš„shellï¼Œåˆ™å¯ä»¥åœ¨æ­¤å¤„è¾“å…¥rootå¯†ç ï¼Œä¹Ÿå¯ä»¥æŒ‰<b>Ctrl + D</b>ç»§ç»­å¯åŠ¨è¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹å°†æ˜¾ç¤ºé€šå¸¸çš„æ§åˆ¶å°ç™»å½•æç¤ºã€‚ <br><br> å¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œå¿…è¦çš„æ›´æ”¹åï¼Œè¿ç»­æŒ‰<b>Ctrl +]</b> 3æ¬¡ã€‚ è¿™å°†å…³é—­å®¹å™¨ï¼Œå¹¶ä½¿æ‚¨è¿”å›åŸå§‹å¤–å£³ã€‚ ä»é‚£é‡Œï¼Œæ‚¨å¯ä»¥é€šè¿‡å¸è½½ç›®æ ‡ç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿå¹¶åˆ é™¤ä¸´æ—¶ç›®å½•æ¥æ‰§è¡Œæ¸…ç†ï¼š <br><br><pre> <code class="bash hljs">$ umount /tmp/target-rescue $ rmdir /tmp/target-rescue</code> </pre> <br> ä»…æ­¤è€Œå·²ï¼ ç°åœ¨ï¼Œæ‚¨å¯ä»¥åˆ é™¤ç›®æ ‡ç³»ç»Ÿçš„å­˜å‚¨è®¾å¤‡ï¼Œç„¶åå°†å…¶é€€å›ã€‚ <br><br> ä»¥è¿™ç§æ–¹å¼ä½¿ç”¨<b>systemd-nspawn</b>çš„æƒ³æ³•ï¼Œå°¤å…¶<b>æ˜¯--booté€‰é¡¹</b> ï¼Œæ¥è‡ªäº<b>StackExchange</b>ä¸Š<i>å‘å¸ƒçš„</i>ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é—®é¢˜</a> <i>ã€‚</i>  <i>æ„Ÿè°¢Shibumiå’Œkirbyfan64soså¯¹è¿™ä¸ªé—®é¢˜çš„æœ‰ç”¨ç­”æ¡ˆï¼</i> <br><br><h2> æ›´å¤šLinuxèµ„æº </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»€ä¹ˆæ˜¯Linuxï¼Ÿ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Linuxä¸Šçš„å®¹å™¨æ˜¯ä»€ä¹ˆï¼Ÿ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Linuxé«˜çº§å¤‡å¿˜å•</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Linuxå‘½ä»¤å¤‡å¿˜å•</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SELinuxé€ŸæŸ¥è¡¨</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Linuxç½‘ç»œå¤‡å¿˜å•</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘ä»¬æœ€æ–°çš„Linuxæ–‡ç« </a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN470497/">https://habr.com/ru/post/zh-CN470497/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN470479/index.html">å¦‚æœæ‚¨çœŸçš„æ²¡æœ‰è—èº«ä¹‹å¤„ï¼Œä¸ºä»€ä¹ˆè·Ÿè¸ªcookieä¼šå¾ˆå±é™©</a></li>
<li><a href="../zh-CN470483/index.html">è«æ–¯ç§‘çš„AzureæŠ€æœ¯å®éªŒå®¤</a></li>
<li><a href="../zh-CN470487/index.html">æŠ€æœ¯ç«èµ›Radiofest-2019</a></li>
<li><a href="../zh-CN470489/index.html">å®‰å…¨å‘¨41ï¼šSIMå¡ä¸­çš„æ›´å¤šæ¼æ´ï¼ŒPDFè§£å¯†</a></li>
<li><a href="../zh-CN470491/index.html">ä»è†æ£˜åˆ°æ¢¦çš„æ¸¸æˆ-ç”Ÿç‰©çš„è¿›æ­¥ä¸è¿›åŒ–</a></li>
<li><a href="../zh-CN470499/index.html">å¦‚ä½•å……åˆ†åˆ©ç”¨Unity Animatorä¸­çš„ä¸­æ–­</a></li>
<li><a href="../zh-CN470501/index.html">Monadâ€œ Readerâ€é€šè¿‡Cï¼ƒå¼‚æ­¥/ç­‰å¾…</a></li>
<li><a href="../zh-CN470503/index.html">Kubernetes RBACç”¨æˆ·å’Œæˆæƒ</a></li>
<li><a href="../zh-CN470513/index.html">æˆ‘å¦‚ä½•æ‰¾åˆ°ä»¥åƒµå°¸ç½‘ç»œä¸ºä¸»å¯¼çš„æ™ºèƒ½å®¶å±…</a></li>
<li><a href="../zh-CN470515/index.html">æµ‹è¯•äººå‘˜çš„ä¸€å°æ­¥ï¼šHeisenbug 2019 Piterçš„åå¤§æŠ¥å‘Š</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>