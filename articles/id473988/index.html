<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✨ 🧜🏽 😷 Mengoptimalkan distribusi server di rak 👌🏼 🕎 ⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Baru-baru ini, seorang kolega bertanya kepada saya dalam sebuah obrolan: 

 - Apakah ada artikel cara mengemas server ke dalam rak dengan benar? 

 Sa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mengoptimalkan distribusi server di rak</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473988/">  Baru-baru ini, seorang kolega bertanya kepada saya dalam sebuah obrolan: <br><br>  - Apakah ada artikel cara mengemas server ke dalam rak dengan benar? <br><br>  Saya menyadari bahwa saya tidak menyadarinya.  Jadi, saya memutuskan untuk menulis teks saya. <br><br>  Pertama, ini adalah artikel tentang server bare metal di fasilitas pusat data (DC).  Kedua, kami memperkirakan bahwa ada banyak server (ratusan atau ribuan);  artikel tidak masuk akal untuk jumlah yang lebih sedikit.  Ketiga, kami menganggap bahwa ada tiga kendala di rak: ruang fisik, daya listrik masing-masing, dan kabinet tetap berada di baris yang berdekatan satu sama lain, sehingga kami dapat menggunakan sakelar ToR tunggal untuk menghubungkan server di dalamnya. <br><a name="habracut"></a><br>  Jawaban atas pertanyaan awal sangat tergantung pada parameter yang kami optimalkan dan pada apa yang dapat kami ubah untuk mendapatkan hasil yang lebih baik.  Misalnya, kita perlu menggunakan lebih sedikit ruang untuk menyisakan lebih banyak untuk pertumbuhan di masa depan.  Atau mungkin kita memiliki kebebasan dalam pemilihan ketinggian kabinet, daya per rak, jumlah soket per PDU, jumlah kabinet per kelompok sakelar (sakelar per 1, 2, atau 3 rak), panjang kabel, dan pekerjaan pemasangan kabel.  Komponen terakhir sangat penting untuk baris akhir rak di mana kita perlu menarik kabel ke baris lain atau meninggalkan port yang kurang dimanfaatkan di sakelar.  Cerita yang sepenuhnya berbeda adalah pemilihan server dan pemilihan pusat data.  Kita harus mempertimbangkan bahwa kita sudah memilih mereka. <br><br>  Baik untuk memahami beberapa nuansa dan detail, khususnya, konsumsi daya server rata-rata / maksimum dan bagaimana vendor kami menyediakan listrik.  Jadi, jika kita memiliki catu daya 230V 1phase, maka pemutus sirkuit 32Amps dapat menyimpan hingga ~ 7kW.  Katakanlah kita membayar secara formal untuk 6kW per rak.  Jika vendor mengukur konsumsi daya kami per baris 10 kabinet, bukan per satu, dan jika pemutus sirkuit membatasi daya pada 7kW, maka kita dapat menggunakan 6,9kW di rak dan 5,1 kW di rak lainnya.  Itu akan ok dan tidak bisa dihukum. <br><br>  Biasanya, tujuan utama kami adalah untuk meminimalkan pengeluaran.  Kriteria pengukuran terbaik adalah pengurangan total biaya kepemilikan (TCO).  Ini terdiri dari bagian-bagian berikut: <br><br><ul><li>  CAPEX: membeli infrastruktur pusat data, server, perangkat jaringan, pemasangan kabel </li><li>  OPEX: Sewa DC, konsumsi listrik, pemeliharaan.  OPEX tergantung pada masa pakai.  Masuk akal untuk menganggap seumur hidup sama dengan 3 tahun. </li></ul><br><img src="https://habrastorage.org/webt/ub/ur/zi/uburzia_hkzpiosfd3k6i2agrwq.jpeg" alt="Grafik TCO"><br><br>  Kita harus mengoptimalkan bagian pie yang paling mahal.  Segala sesuatu yang lain harus menggunakan sumber daya yang tersisa seefektif mungkin. <br><br>  Seharusnya, kami memiliki DC yang ada, ketinggian rak unit H (misalnya H = 47), daya per rak, rak P ( <sub>rak</sub> P = 6kW), dan kami memutuskan untuk menggunakan server server dua unit h = 2U.  Mari kita lepaskan 2 hingga 4 unit dari rak untuk sakelar, panel tambalan, manajer kabel.  Kemudian kita dapat memasukkan server S <sub>h</sub> = rounddown ((H-2..4) / h) di rak (mis. S <sub>h</sub> = rounddown ((47-4) / 2) = 21 server per rak).  Mari menghafal S <sub>h</sub> . <br><br>  Dalam kasus sederhana, semua server adalah sama.  Jadi, jika kita mengisi rak dengan server kita dapat menghabiskan per server daya rata-rata P <sub>serv</sub> = P <sub>rack</sub> / S <sub>h</sub> (P <sub>serv</sub> = 6000W / 21 = 287W).  Kami mengabaikan beralih konsumsi daya di sini. <br><br>  Mari kita minggir dan tentukan berapa maksimum konsumsi daya server P <sub>max</sub> .  Cara langsung, sepenuhnya aman dan sangat tidak efisien adalah membaca apa yang tertulis pada label pada unit catu daya server.  Ini adalah <sub>Maks</sub> . <br><br>  Pendekatan yang lebih rumit dan efisien adalah dengan mengambil TDP dari semua komponen dan merangkumnya.  Itu tidak akurat, tetapi kita bisa melakukannya dengan cara ini. <br><br>  Biasanya, kita tidak tahu TDP komponen selain CPU.  Jadi, pendekatan yang paling benar dan paling rumit adalah dengan mengambil server yang dikonfigurasi secara eksperimental secara memadai, memuatnya, misalnya, dengan / Linpack / (CPU dan memori) dan / fio / (disk), dan mengukur konsumsi daya.  Kami membutuhkan laboratorium dalam hal ini.  Jika kita menanggapinya dengan serius, kita harus menciptakan lingkungan yang hangat di lorong yang dingin karena suhu yang lebih tinggi mempengaruhi kipas dan konsumsi daya CPU.  Jadi, kami mendapatkan konsumsi daya maksimum dari server sampel dengan konfigurasi khusus ini dalam lingkungan saat ini di bawah beban spesifik.  Perlu diingat bahwa firmware baru, versi perangkat lunak, dan kondisi lainnya dapat memengaruhi hasilnya. <br><br>  Sekarang, mari kita kembali ke P <sub>serv</sub> dan bagaimana kita membandingkannya dengan P <sub>max</sub> .  Ini adalah pertanyaan untuk memahami bagaimana layanan bekerja dan seberapa kuat saraf CTO kami. <br><br>  Jika kami tidak menerima risiko apa pun, kami harus berasumsi bahwa semua server mungkin mulai menggunakan potensi maksimumnya secara bersamaan.  Pada saat yang sama, salah satu umpan DC bisa gagal juga.  Infrastruktur masih harus menyediakan layanan.  Jadi, P <sub>serv</sub> ≡ P <sub>maks</sub> .  Ini adalah pendekatan ketika keandalan sangat penting. <br><br>  Jika CIO memperhitungkan tidak hanya keselamatan ideal tetapi juga uang perusahaan, jika dia cukup berani, maka dia dapat memutuskan hal itu <br><br><ul><li>  kami mulai mengelola vendor kami, khususnya, kami melarang pemeliharaan apa pun yang direncanakan dalam periode beban tinggi yang kami harapkan untuk meminimalkan kegagalan daya </li><li>  dan atau arsitektur kami memungkinkan kami kehilangan rak / baris / DC saat layanan melanjutkan operasi </li><li>  dan atau kami mendistribusikan beban di rak secara horizontal dengan sangat baik sehingga server kami dalam satu kabinet tidak akan pernah mengkonsumsi maksimum teoretis mereka secara bersamaan. </li></ul><br>  Sangat menguntungkan tidak hanya menebak di sini tetapi memantau konsumsi daya dan memahami bagaimana server mengkonsumsi daya selama beban biasa dan puncak.  Demikian dan setelah beberapa analisis, CIO bersusah payah dan berkata: <br>  "Saya perintahkan bahwa rata-rata maksimum yang dapat dicapai dari semua konsumsi daya maksimum server <b>jauh</b> lebih sedikit daripada konsumsi maksimum server tunggal."  Biarlah P <sub>serv</sub> = 0,8 * <sub>Paks</sub> <br><br>  Dan kemudian rak 6kW dapat menampung bukan 16 server P <sub>max</sub> = 375W tetapi 20 server P <sub>serv</sub> = 375W * 0,8 = 300W.  Yaitu 25% lebih banyak server.  Ini ekonomi nyata karena kita membutuhkan rak 25% lebih sedikit.  Dan kita bisa menghemat rak PDU, sakelar dan kabel.  Kerugian serius dari solusi ini adalah perlunya memeriksa terus-menerus bahwa asumsi kami masih valid.  Kami harus memastikan bahwa firmware baru tidak mengubah operasi kipas dan konsumsi daya secara signifikan, bahwa tim pengembangan tidak mulai menggunakan server jauh lebih efisien (itu berarti mereka berhasil meningkatkan pemanfaatan dan konsumsi daya).  Kemudian kedua asumsi awal dan kesimpulan menjadi salah.  Jadi, itu risiko untuk diterima secara bertanggung jawab.  Atau risikonya dapat dihindari dan kemudian perusahaan membayar untuk rak yang jelas-jelas kekurangan muatan. <br><br>  Catatan penting: ada baiknya mencoba mendistribusikan server layanan yang berbeda di rak secara horizontal jika memungkinkan.  Hal ini diperlukan untuk menghindari kasus ketika sekelompok server untuk layanan tiba dan dipasang ke dalam kabinet secara vertikal untuk meningkatkan "kepadatan" (hanya karena lebih mudah untuk melakukan cara ini).  Memang, itu mengarah ke situasi ketika satu rak diisi dengan server beban rendah yang sama sementara semua sangat dimuat berada di rak lain.  Ketika profil beban sama, dan semua server mulai mengkonsumsi secara bersamaan secara bersamaan karena beban tinggi, kemungkinan kehilangan rak kedua menjadi jauh lebih tinggi. <br><br>  Mari kita kembali ke distribusi server di rak.  Kami menganggap kendala fisik di lemari dan keterbatasan daya.  Sekarang mari kita pertimbangkan jaringan.  Seseorang dapat menggunakan N = 24/32/48-port switch (dengan asumsi 48-port ToR switch).  Untungnya, tidak ada banyak pilihan jika kita mengabaikan kabel break-out.  Kami mempertimbangkan opsi sakelar di setiap rak tunggal, sakelar per dua atau per tiga kabinet per grup (R <sub>net</sub> ).  Saya percaya bahwa kelompok itu tidak boleh tiga.  Kalau tidak, itu mengarah ke masalah pemasangan kabel. <br><br>  Jadi, kami mendistribusikan server di rak untuk setiap skenario jaringan (1, 2, atau 3 rak per grup): <br><br>  S <sub>rack</sub> = min (S <sub>h</sub> , rounddown ( <sub>rak</sub> P / P <sub>serv</sub> ), rounddown (N / R <sub>net</sub> )) <br><br>  Dengan demikian, sekelompok skenario dua rak adalah <br><br>  S <sub>rack</sub> <sup>2</sup> = min (21, rounddown (6000/300), rounddown (48/2)) = min (21, 20, 24) = 20 server per rak <br><br>  Demikian pula, kami menghitung skenario lain: <br><br>  S <sub>rak</sub> <sup>1</sup> = 20 <br><br>  <sub>Rak</sub> <sup>3</sup> = 16 <br><br>  Kami hampir selesai.  Kita harus menghitung jumlah total rak untuk mendistribusikan semua server S (misalkan ada 1000 server): <br><br>  R = roundup (S / (S <sub>rack</sub> * R <sub>net</sub> )) * R <sub>net</sub> <br><br>  R <sub>1</sub> = pengumpulan (1000 / (20 * 1)) * 1 = 50 * 1 = 50 rak <br><br>  R <sub>2</sub> = pembulatan (1000 / (20 * 2)) * 2 = 25 * 2 = 50 rak <br><br>  R <sub>2</sub> = pembulatan (1000 / (16 * 3)) * 3 = 21 * 3 = 63 rak <br><br>  Maka kita harus menghitung TCO untuk setiap opsi berdasarkan jumlah rak, sakelar yang dibutuhkan, kabel, dll.  Kami memilih skenario dengan TCO terendah.  Untung! <br><br>  Harap dicatat meskipun jumlah rak untuk skenario 1 dan 2 adalah sama, TCO berbeda karena jumlah sakelar dua kali lebih sedikit dan kabel yang lebih panjang untuk skenario ke-2. <br><br>  PS Jika daya per rak atau tinggi rak dapat bervariasi, maka variabilitas meningkat.  Tetapi pemilihan dapat dikurangi menjadi metode di atas dengan memaksa opsi.  Akan ada lebih banyak skenario, tetapi jumlahnya akan terbatas.  Kita dapat meningkatkan daya per rak dalam langkah 1kW, dan ada sejumlah tipe rak standar: dari 42U, 45U, 47U, 48U.  Mungkin bermanfaat untuk menggunakan analisis What-If Excel dalam mode Tabel Data.  Kita harus melihat tabel yang dihasilkan dan memilih opsi terbaik. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id473988/">https://habr.com/ru/post/id473988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id473978/index.html">Seperti rasa sakit, rasa sakit, kasir sebagai layanan 2: 0</a></li>
<li><a href="../id473980/index.html">Teknologi dan dunia nyata: 4 Start-up yang mengubah masa depan desain interior</a></li>
<li><a href="../id473982/index.html">NB-IoT: bagaimana cara kerjanya? Bagian 3: SCEF - jendela akses tunggal ke layanan operator</a></li>
<li><a href="../id473984/index.html">Intisari Ilmu Data (Oktober 2019)</a></li>
<li><a href="../id473986/index.html">“Impian saya adalah melihat seseorang melalui pepohonan” - pendiri Lisa Alert tentang teknologi pencarian modern</a></li>
<li><a href="../id473990/index.html">Pelajari OpenGL. Pelajaran 7.2 - Menggambar Teks</a></li>
<li><a href="../id473992/index.html">Tinjauan umum protokol modern dalam sistem otomasi industri</a></li>
<li><a href="../id473994/index.html">Memuat skrip modern</a></li>
<li><a href="../id473998/index.html">Belanda, atau di sana dan kembali</a></li>
<li><a href="../id474000/index.html">IQBX - desainer elektromekanis untuk kalangan dan pecinta DIY [ide konsep]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>