<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ù üßú üë∑ Uso de la aplicaci√≥n web WebAssembly 20x acelerada ‚öΩÔ∏è üà≥ üë©üèæ‚Äçü§ù‚Äçüë®üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este art√≠culo discute un caso para acelerar una aplicaci√≥n de navegador reemplazando JavaScript con WebAssembly. 

 WebAssembly: ¬øqu√© es? 
 En resumen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Uso de la aplicaci√≥n web WebAssembly 20x acelerada</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/452190/"><img src="https://habrastorage.org/getpro/habr/post_images/a4f/e5d/a03/a4fe5da03dbbf5ee42d599480e676428.png" alt="imagen"><br><br>  Este art√≠culo discute un caso para acelerar una aplicaci√≥n de navegador reemplazando JavaScript con WebAssembly. <br><a name="habracut"></a><br><h3>  WebAssembly: ¬øqu√© es? </h3><br>  En resumen, este es un formato de instrucciones binarias para una m√°quina virtual apilada.  Wasm (nombre corto) a menudo se llama un lenguaje de programaci√≥n, pero no lo es.  El formato de instrucciones se ejecuta en el navegador junto con JavaScript. <br><br>  Es importante que WebAssembly se pueda obtener compilando fuentes en lenguajes como C / C ++, Rust, Go.  Utiliza la escritura est√°tica y el llamado modelo de memoria plana.  El c√≥digo, como se mencion√≥ anteriormente, se almacena en un formato binario compacto, por lo que se ejecuta casi tan r√°pido como si la aplicaci√≥n se iniciara utilizando la l√≠nea de comandos.  Estas caracter√≠sticas han llevado a la creciente popularidad de WebAssembly. <br><br><blockquote>  <b>Le recordamos:</b> <i>para todos los lectores de "Habr": un descuento de 10.000 rublos al registrarse en cualquier curso de Skillbox con el c√≥digo de promoci√≥n "Habr".</i> <br><br>  <b>Skillbox recomienda:</b> Curso pr√°ctico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Mobile Developer PRO"</a> . <br></blockquote><br>  Wasm se usa actualmente en muchas aplicaciones, desde juegos como Doom 3 hasta aplicaciones web como Autocad y Figma.  Wasm tambi√©n se usa en √°reas como la inform√°tica sin servidor. <br><br>  Este art√≠culo proporciona un ejemplo del uso de Wasm para acelerar un servicio web anal√≠tico.  Para mayor claridad, tomamos una aplicaci√≥n de trabajo escrita en C, que se compila en WebAssembly.  El resultado se utilizar√° para reemplazar secciones de JS de baja productividad. <br><br><h3>  Transformaci√≥n de la aplicaci√≥n </h3><br>  El ejemplo utilizar√° el servicio de navegador fastq.bio, que est√° destinado a genetistas.  La herramienta le permite evaluar la calidad de la secuenciaci√≥n de ADN (decodificaci√≥n). <br><br>  Aqu√≠ hay una aplicaci√≥n de ejemplo en el trabajo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/815/b0e/9ea/815b0e9eaf7480d4e827762341c78a4a.jpg"><br><br>  No se deben proporcionar los detalles del proceso, ya que son bastante complicados para los no especialistas, pero en resumen, los cient√≠ficos de las infograf√≠as anteriores pueden entender si el proceso de secuenciaci√≥n del ADN se realiz√≥ sin problemas y qu√© problemas surgieron. <br><br>  Este servicio tiene alternativas, programas de escritorio.  Pero fastq.bio puede acelerar las cosas visualizando datos.  En la mayor√≠a de los otros casos, debe poder trabajar con la l√≠nea de comando, pero no todos los genetistas tienen la experiencia necesaria. <br><br>  Todo funciona de manera simple.  En la entrada: datos presentados en forma de archivo de texto.  Este archivo es generado por herramientas especializadas de secuenciaci√≥n.  El archivo contiene una lista de secuencias de ADN y una evaluaci√≥n de calidad para cada nucle√≥tido.  El formato del archivo es .fastq, por lo que el servicio obtuvo su nombre. <br><br><h3>  Implementaci√≥n de JavaScript </h3><br>  El primer paso del usuario cuando trabaja con fastq.bio es seleccionar el archivo apropiado.  Usando el objeto File, la aplicaci√≥n lee una selecci√≥n aleatoria de datos del archivo y procesa este paquete.  La tarea de JavaScript aqu√≠ es realizar operaciones de cadena simples e indicadores de conteo.  Uno de ellos es el n√∫mero de nucle√≥tidos A, C, G y T en diferentes fragmentos de ADN. <br><br>  Despu√©s de calcular los indicadores necesarios, se visualizan usando Plotly.js, y el servicio comienza a trabajar con una nueva selecci√≥n de datos.  La fragmentaci√≥n se realiza para mejorar la calidad de UX.  Si trabaja con todos los datos a la vez, el proceso se congelar√° por un tiempo, ya que los archivos con resultados de secuencia ocupan cientos de gigabytes de espacio de archivos.  El servicio toma datos de 0.5 a 1 Mb de tama√±o y trabaja con ellos paso a paso, construyendo datos gr√°ficos. <br><br>  As√≠ es como funciona: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/758/06a/eda/75806aeda6741781f9a10dc1a48f04f4.png"><br><br>  El rect√°ngulo rojo contiene el algoritmo de conversi√≥n de cadenas para renderizar.  Esta es la parte m√°s cargada del servicio en t√©rminos de computaci√≥n.  Vale la pena intentar reemplazarlo con Wasm. <br><br><h3>  Prueba de WebAssembly </h3><br>  Para evaluar la posibilidad de usar Wasm, el equipo del proyecto comenz√≥ a buscar soluciones listas para crear m√©tricas de CC (CC - control de calidad) basadas en archivos fastq.  La b√∫squeda se realiz√≥ entre las herramientas escritas en C, C ++ o Rust, de modo que fue posible portar el c√≥digo a WebAssembly.  Adem√°s, la herramienta no debe ser "en bruto", requiere un servicio ya verificado por los cient√≠ficos. <br><br>  Como resultado, la elecci√≥n se hizo a favor de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">seqtk</a> .  La aplicaci√≥n es bastante popular, es de c√≥digo abierto, el idioma de origen es C. <br><br>  Antes de convertir a Wasm, debe observar el principio de compilar seqtk para el escritorio.  Seg√∫n el Makefile, esto es lo que necesita: <br><br><pre><code class="plaintext hljs"># Compile to binary $ gcc seqtk.c \ -o seqtk \ -O2 \ -lm \ -lz</code> </pre> <br>  B√°sicamente, puede compilar seqtk con Emscripten.  Si no est√° all√≠, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">recorra la imagen de Docker</a> . <br><br><pre> <code class="plaintext hljs">$ docker pull robertaboukhalil/emsdk:1.38.26 $ docker run -dt --name wasm-seqtk robertaboukhalil/emsdk:1.38.26</code> </pre> <br>  Si lo desea, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puede recogerlo usted mismo</a> , pero lleva tiempo. <br><br>  Dentro del contenedor, puede tomar f√°cilmente emcc como alternativa a gcc: <br><br><pre> <code class="plaintext hljs"># Compile to WebAssembly $ emcc seqtk.c \ -o seqtk.js \ -O2 \ -lm \ -s USE_ZLIB=1 \ -s FORCE_FILESYSTEM=1</code> </pre> <br>  Cambios m√≠nimos: <br><br>  En lugar de enviar al archivo binario Emscripten, se utilizan .wasm y .js para generar los archivos, que se utilizan para iniciar el m√≥dulo WebAssemby. <br><br>  Para admitir la biblioteca zlib, se usa el indicador USE_ZLIB.  La biblioteca se distribuye y se transfiere a WebAssembly, y Emscripten la incluye en el proyecto. <br><br>  El sistema de archivos virtual Emscrippten est√° activado.  Este es un <a href="">FS similar a POSIX que</a> opera en RAM dentro del navegador.  Cuando la p√°gina se actualiza, la memoria se borra. <br><br>  Para comprender por qu√© se necesita un sistema de archivos virtual, vale la pena comparar la forma de iniciar seqtk desde la l√≠nea de comandos con la forma de ejecutar el m√≥dulo compilado WebAssembly. <br><br><pre> <code class="plaintext hljs"># On the command line $ ./seqtk fqchk data.fastq # In the browser console &gt; Module.callMain(["fqchk", "data.fastq"])</code> </pre> <br>  Es necesario obtener acceso al sistema de archivos virtual para no sobrescribir seqtk con cadena en lugar de entrada de archivo.  En este caso, el fragmento de datos se muestra como el archivo data.fastq en el FS virtual con el main () seqtk invocado en √©l. <br><br>  Aqu√≠ est√° la nueva arquitectura: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c10/bc9/d59/c10bc9d59f93b84eb5faf81a14415f54.png"><br><br>  La figura muestra que, en lugar de la inform√°tica, la secuencia principal del navegador utiliza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener noreferrer nofollow">WebWorkers</a> .  Este m√©todo permite realizar c√°lculos en el hilo de fondo sin afectar la capacidad de respuesta del navegador.  Bueno, el controlador WebWorker lanza Worker, controlando su interacci√≥n con el hilo principal. <br><br>  El comando seqtk se inicia utilizando Worker en el archivo montado.  Despu√©s de completar el trabajo, Trabajador muestra el resultado en forma de Promesa.  Cuando el hilo principal recibe un mensaje, el resultado se utiliza para actualizar las programaciones.  Y as√≠, en algunas iteraciones. <br><br><h3>  ¬øQu√© pasa con el rendimiento de WebAssembly? </h3><br>  Para evaluar el cambio en el rendimiento, el equipo del proyecto utiliz√≥ el par√°metro del n√∫mero de operaciones de lectura por segundo.  El tiempo de gr√°ficos interactivos no se tiene en cuenta, ya que ambas implementaciones usan JavaScript. <br><br>  Al usar la soluci√≥n lista para usar, la ganancia de rendimiento fue nueve veces. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/436/dc6/67b/436dc667b8b186146cb3bbef44f32e21.png"><br><br>  Este es un resultado excelente, pero result√≥ que existe la oportunidad de optimizarlo.  El hecho es que seqtk no utiliza una gran cantidad de resultados de an√°lisis de CC, por lo que puede eliminarlos.  Si hace esto, el resultado en comparaci√≥n con JS se mejora 13 veces. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/640/d78/56f/640d7856fd49ac45068a0a99474aa6b8.png"><br><br>  Fue posible lograrlo simplemente comentando los comandos printf (). <br><br>  Pero eso no es todo.  El hecho es que en esta etapa fastq.bio recibe los resultados del an√°lisis llamando a diferentes funciones de C. Cualquiera de ellos calcula su propio conjunto de caracter√≠sticas, de modo que cada fragmento del archivo se lee dos veces. <br><br>  Para solucionar este problema, se decidi√≥ combinar las dos funciones en una sola.  Como resultado, la productividad aument√≥ en 20 veces. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/730/cd7/342/730cd7342f45f12992506f111ca1b33f.jpg"><br><br>  Vale la pena se√±alar que un resultado tan sobresaliente no siempre se puede lograr.  En algunos casos, el rendimiento disminuye, por lo que vale la pena evaluar cada caso. <br><br>  Como conclusi√≥n, podemos decir que Wasm realmente hace posible mejorar el rendimiento de la aplicaci√≥n, pero debe usarlo sabiamente. <br><br><blockquote>  <b>Skillbox recomienda:</b> <br><br><ul><li>  Curso pr√°ctico de dos a√±os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Soy un desarrollador web PRO"</a> . </li><li>  Curso en l√≠nea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Desarrollador C # con 0"</a> . </li><li>  Curso pr√°ctico anual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Desarrollador PHP de 0 a PRO"</a> . <br></li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/452190/">https://habr.com/ru/post/452190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452180/index.html">Elevamos el rendimiento de SSD desde las rodillas, d√≥nde hacer clic y por qu√©</a></li>
<li><a href="../452182/index.html">Encuesta de empleados. El principal error</a></li>
<li><a href="../452184/index.html">Sobre el anonimato en blockchains basados ‚Äã‚Äãen cuentas</a></li>
<li><a href="../452186/index.html">Los lenguajes de programaci√≥n m√°s raros y caros</a></li>
<li><a href="../452188/index.html">Prueba de la unidad de serializaci√≥n Json en Spring Boot</a></li>
<li><a href="../452192/index.html">¬øQu√© es esto aqu√≠? Operaci√≥n interna de objetos JavaScript</a></li>
<li><a href="../452198/index.html">¬øQu√© debe saber todo ingeniero de control de calidad sobre Selenium 4?</a></li>
<li><a href="../452200/index.html">GOSTIM: P2P F2F E2EE IM en una noche con criptograf√≠a GOST</a></li>
<li><a href="../452202/index.html">Revisi√≥n de Sprint: Inferior - Inferior</a></li>
<li><a href="../452204/index.html">Mientras escrib√≠a mi primera IA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>