<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è™ üë≥üèø üç∫ PHP-Watcher: un outil qui simplifie le d√©veloppement d'applications √† longue dur√©e de vie üë®‚Äçüíº ü§∂üèª üï†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous aimons PHP pour sa simplicit√©: vous √©crivez le code, actualisez la page dans le navigateur et voyez imm√©diatement les changements. Mais s'il s'ag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP-Watcher: un outil qui simplifie le d√©veloppement d'applications √† longue dur√©e de vie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skyeng/blog/475624/"><img src="https://habrastorage.org/webt/dt/ud/uz/dtuduzzyawnbnme7jeckvagoirs.gif"><br><br>  Nous aimons PHP pour sa simplicit√©: vous √©crivez le code, actualisez la page dans le navigateur et voyez imm√©diatement les changements.  Mais s'il s'agit de commandes de console, qui peuvent √™tre des processus de longue dur√©e - par exemple, si nous √©crivons un serveur HTTP asynchrone pour t√©l√©charger des fichiers - le d√©veloppement peut √™tre tr√®s douloureux. <br><br>  Il n'y avait pas de solution appropri√©e dans l'√©cosyst√®me PHP pour red√©marrer automatiquement les applications lorsque des modifications √©taient apport√©es au code source.  Par cons√©quent, j'ai d√©cid√© de faire mon outil - en PHP pur et avec acc√®s via Composer. <br><br><h2>  C'est comme Nodemon, mais en PHP </h2><a name="habracut"></a><br>  Pendant un certain temps, j'ai moi-m√™me utilis√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nodemon</a> .  C'est un outil du monde de Node.js, cependant, si vous le personnalisez un peu, vous pouvez l'utiliser avec des scripts PHP.  Mais en fait, je ne veux pas installer Node.js et faire glisser un tas de packages NPM que je ne connais pas dans mon application PHP asynchrone pour le red√©marrer. <br><br>  Comme je communique activement sur Twitter, j'ai demand√© √† qui d'autre avait ce probl√®me et j'aimerais obtenir une solution.  Voyant l'int√©r√™t, je me suis assis pour √©crire un outil qui fournit les m√™mes fonctionnalit√©s que Nodemon, <b><i>uniquement en PHP et pour PHP</i></b> . <br><br><img src="https://habrastorage.org/webt/wc/xh/n_/wcxhn_iy9g1nnngfj7rru7-e_ym.png"><br><br>  Un mois s'est √©coul√©: avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PHP-Watcher,</a> vous n'avez plus besoin d'installer Nodemon ou tout autre package NPM pour d√©velopper votre application PHP longue dur√©e. <br><br><h2>  Voil√† comment √ßa marche </h2><br>  La biblioth√®que peut √™tre install√©e via Composer: <br><br><pre><code class="php hljs">composer <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> seregazhuk/php-watcher</code> </pre> <br>  Imaginez que nous travaillons sur une application de longue dur√©e bas√©e sur Symfony.  Le point d'entr√©e de notre application est le fichier public / index.php.  Nous voulons suivre les changements dans les dossiers src et config.  Nous souhaitons √©galement que l'application red√©marre automatiquement d√®s que nous modifions le code source ou les param√®tres de configuration.  Voici comment r√©soudre ce probl√®me: <br><br><pre> <code class="php hljs">php-watcher <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/index.php --watch src --watch config</code> </pre> <br>  La commande ex√©cutera le script public / index.php, qui commencera √† suivre les modifications dans les r√©pertoires src et config.  D√®s que le fichier change dans l'un d'eux, PHP-Watcher red√©marrera le script. <br><br>  Par d√©faut, il ne suit que les modifications apport√©es aux fichiers PHP.  Mais Symfony stocke ses configs dans yaml.  Par cons√©quent, nous devons dire explicitement √† la montre qu'elle suit les fichiers PHP et yaml.  Cela se fait en utilisant l'option --ext: <br><br><pre> <code class="php hljs">php-watcher <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/index.php --watch src --watch config --ext php,yaml</code> </pre> <br>  Supposons que nous comprenions que nous n'avons pas besoin de red√©marrer les applications avec des modifications dans le r√©pertoire src.  Par exemple, nous aimerions ignorer les modifications du sous-r√©pertoire src / Migrations.  Dans ce cas, vous pouvez utiliser l'option --ignore: <br><br><pre> <code class="php hljs">php-watcher <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/index.php --watch src --watch config --ext php,yaml --ignore Migrations</code> </pre> <br>  PHP-Watcher va maintenant commencer √† suivre les modifications dans les r√©pertoires src et config, mais ignorera toutes les modifications dans le sous-r√©pertoire Migrations.  De plus, il ignore par d√©faut les modifications dans tous les fichiers dot et VCS. <br><br>  <b>Watcher prend en charge la personnalisation de son comportement non seulement via les options de ligne de commande, mais √©galement via les fichiers de configuration.</b>  Si vous ne voulez pas passer un tas d'options et de param√®tres √† chaque fois sur la ligne de commande, vous pouvez cr√©er un fichier de configuration .php-watcher.yml.  Par exemple, la commande pr√©c√©dente peut √™tre remplac√©e par le fichier de configuration suivant: <br><br><pre> <code class="php hljs">watch: - src - config extensions: - php - yaml ignore: - Migrations</code> </pre><br>  Ayant un tel fichier, on peut simplement activer la "watch" en sp√©cifiant uniquement le script PHP qui doit √™tre red√©marr√©.  Tous les autres param√®tres seront extraits du fichier: <br><br><pre> <code class="php hljs">php-watcher <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/index.php</code> </pre> <br>  Que se passe-t-il si nous avons √† la fois un fichier de configuration et des arguments de ligne de commande?  Dans ce cas, tous les arguments pass√©s depuis la ligne de commande √©craseront les valeurs correspondantes du fichier de configuration. <br><br>  Par d√©faut, PHP-Watcher utilise l'ex√©cutable PHP pour ex√©cuter le script.  Nous √©crivons la commande dans le terminal: <br><br><pre> <code class="php hljs">php-watcher <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/index.php</code> </pre> <br>  Sous le capot, un processus enfant est cr√©√© avec la commande php public / index.php.  Dans la plupart des cas, c'est ce dont vous avez besoin.  Cependant, si votre environnement a un fichier ex√©cutable diff√©rent, vous pouvez sp√©cifier explicitement la commande √† ex√©cuter.  Par exemple, lorsque nous avons plusieurs versions de PHP sur le m√™me syst√®me, et que nous voulons ex√©cuter notre application avec l'ex√©cutable php7.4, vous pouvez utiliser l'option --exec et sp√©cifier votre fichier ex√©cutable: <br><br><pre> <code class="php hljs">php-watcher <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/index.php --exec php7<span class="hljs-number"><span class="hljs-number">.4</span></span></code> </pre> <br>  La m√™me chose √† travers le fichier de configuration: <br><br><pre> <code class="php hljs">watch: - src - config executable: php7<span class="hljs-number"><span class="hljs-number">.4</span></span></code> </pre> <br>  PHP-Watcher ne red√©marre pas automatiquement l'application en cas de panne.  Dans l'environnement de d√©veloppement, cela n'est pas particuli√®rement n√©cessaire - car pendant que nous d√©veloppons une nouvelle application, il est normal qu'elle se bloque parfois.  Si l'application plante (termin√©e par un code diff√©rent de 0), la "montre" nous le fera savoir.  D√®s que nous corrigeons le code, les modifications seront d√©tect√©es dans les sources - et l'application red√©marrera. <br><br>  <b>Merci de votre attention!</b>  Vous trouverez plus d'informations sur PHP-Watcher sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page d'accueil du projet sur GitHub</a> .  La documentation d√©crit les sch√©mas d'utilisation de base.  Le projet est encore en d√©veloppement, mais l'API est d√©j√† assez stable.  Je serai heureux si vous l'utilisez. <br><br>  <b>PS</b> N'h√©sitez pas √† laisser vos commentaires et suggestions √† travers le num√©ro sur GitHub. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr475624/">https://habr.com/ru/post/fr475624/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr475610/index.html">Lampes de table LED s√ªres qui conservent la vision</a></li>
<li><a href="../fr475612/index.html">√âtant donn√©, quand, les affirmations et la confiance dans la mise en ≈ìuvre</a></li>
<li><a href="../fr475614/index.html">Automatisation pour les plus petits. Deuxi√®me partie. Conception du r√©seau</a></li>
<li><a href="../fr475618/index.html">Comment √©crire un contrat Python intelligent sur le r√©seau Ontology. Partie 2: API de stockage</a></li>
<li><a href="../fr475622/index.html">Extension d'UObject dans Unreal Engine 4</a></li>
<li><a href="../fr475626/index.html">Les autotests peuvent-ils remplacer une personne √† la recherche de vuln√©rabilit√©s: entretien avec Alexandra Svatikova</a></li>
<li><a href="../fr475630/index.html">Knative - une plate-forme bas√©e sur k8s en tant que service avec prise en charge sans serveur</a></li>
<li><a href="../fr475636/index.html">Incr√©menter les √©l√©ments vectoriels</a></li>
<li><a href="../fr475640/index.html">Si vous cr√©ez quelque chose, √©vitez le calendrier du responsable.</a></li>
<li><a href="../fr475642/index.html">M√©canisme de tas uniquement de tuples dans PostgreSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>