<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💳 📜 🤾🏿 Interfaces para dispositivos de oscilación de cuna: desde llavero a web 🎍 ⚾️ 🥟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ha pasado poco más de un año desde la redacción de mi primer artículo sobre un dispositivo para mecer una cuna. Durante este tiempo, desarrollé un nue...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interfaces para dispositivos de oscilación de cuna: desde llavero a web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/386293/"><div style="text-align:center;"><img src="https://habrastorage.org/files/a17/b69/b13/a17b69b1341b4ba38455428341654685.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ha pasado poco más de un año desde la redacción de mi primer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artículo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre un dispositivo para mecer una cuna. </font><font style="vertical-align: inherit;">Durante este tiempo, desarrollé un nuevo panel de control con una pantalla y luego una interfaz web para este dispositivo. </font><font style="vertical-align: inherit;">Si está interesado en aprender más, bienvenido a cat.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, algunas palabras sobre el dispositivo en sí, un breve resumen de la serie anterior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, el dispositivo está diseñado para balancear una cuna con un mecanismo de péndulo. Se instala una unidad de accionamiento con un electroimán y componentes electrónicos en la parte fija de la cuna. Un imán de neodimio se fija en la parte móvil. Al volar sobre un electroimán, un imán permanente induce un EMF, cuya forma determina el momento de conectar el mismo electroimán a una fuente de energía. Por lo tanto, el electroimán en el momento adecuado empuja el imán permanente y, por lo tanto, la parte móvil de la cuna. Al mismo tiempo, cuando el electroimán no está alimentado, desempeña el papel de un sensor de posición para la parte móvil de la cuna.</font></font><br>
<br>
<img src="https://habrastorage.org/files/79a/544/62a/79a54462afb845d7b06548478ca65f9e.gif" height="350" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/e80/6e9/0bd/e806e90bd42d464c72d0cef045499ea0.jpg" alt="imagen" height="350"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hice la primera copia del dispositivo para mí. Luego resultó que tales dispositivos pueden venderse, y durante más de tres años he estado haciendo esto con diversos grados de éxito. Ahora en pequeños lotes, cuatro modelos del dispositivo se fabrican y venden a través de uno de los mayores fabricantes rusos de muebles para niños. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el primer modelo del dispositivo para mecer una cuna, dicho control remoto se usa como panel de control. Tiene cuatro botones con la funcionalidad de "Inicio", "Detener", "Más fuerte" y "Más débil". En consecuencia, con este control remoto, puede iniciar y detener el swing, así como cambiar su intensidad: elija uno de los seis niveles posibles. El llavero funciona a una frecuencia de 433 MHz y no tiene retroalimentación.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/845/aa6/11b/845aa611b6ee4769bed8bd30d1f63f4c.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de un tiempo, se desarrolló una versión simplificada del dispositivo (modelo 0), generalmente sin un panel de control. Le estrecharon la cuna con la mano, y continúa balanceándose indefinidamente. Detenido - balanceo detenido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al desarrollar el próximo segundo modelo del dispositivo de columpio (modelo 2), la tarea principal era agregar un temporizador de mareo por movimiento y comenzar el columpio desde el llanto del niño. Y eso resultó ser un problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El hecho es que el tiempo de oscilación debe establecerse de alguna manera, en horas y minutos. Y la sensibilidad del micrófono también sería agradable de configurar de alguna manera. Pero todo esto requiere una interfaz, y un control remoto "ciego" con cuatro botones claramente no es suficiente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, el primer pensamiento fue hacer alguna indicación sobre la carcasa del dispositivo. Coloque allí algunos LED y / o una pequeña pantalla. Y controle también, con la ayuda de este pequeño control remoto. Sin embargo, la desventaja de esta solución es que el dispositivo generalmente se instala en un lugar inaccesible, en algún lugar de la pared posterior de la cuna contra la pared. Y las indicaciones sobre el caso en este caso simplemente no serán visibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces se decidió hacer un panel de control con una pantalla. Un poco menos de un año de desarrollo, ¡y el dispositivo con el control remoto está listo!</font></font><br>
<br>
<img src="https://habrastorage.org/files/6a7/2bd/a6e/6a72bda6ecfa4102917ccc6e36500b74.gif" align="left" height="350"><img src="https://habrastorage.org/files/c9d/5ad/290/c9d5ad290d064d5ababcf7b905b865cf.gif" height="350"><div style="text-align:center;"><img src="https://habrastorage.org/files/a5f/177/1dc/a5f1771dccce41aebe3815e49227f58c.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro de la consola está ATMega32A, la pantalla es una pantalla del Nokia 1202 y el transceptor es NRF24L01 +. El estuche es estándar, el teclado es de película. Desde el control remoto, puede configurar el tiempo de mareo, la sensibilidad del micrófono, la intensidad del swing, así como iniciar y detener el proceso. Para el caso de varias camas en la misma habitación, se proporciona la posibilidad de cambiar el canal de control, ya que el NRF24L01 + lo permite fácilmente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La consola y el dispositivo están en constante diálogo entre ellos. Esto se hace para obtener retroalimentación: el estado actual del dispositivo se muestra en la pantalla, es decir, si el proceso de oscilación está en curso o no (si es así, la imagen de la cuna en el control remoto también está oscilando), cuánto tiempo queda para bombear, cuáles son los ajustes actuales para la intensidad del mareo por movimiento y la sensibilidad del micrófono. Para que las baterías del panel de control no se agoten demasiado rápido, se proporciona un modo de suspensión: si nadie presiona los botones del control remoto durante media hora, el control remoto se "dormirá".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después del desarrollo y lanzamiento del "Modelo 2", aunque en una producción modesta pero aún así, seguí pensando en mejorar el dispositivo de oscilación. ¡Eso sería genial, pensé, si pudieras controlar el dispositivo desde un teléfono celular! O de una tableta. Por ejemplo, cuando duermo, pongo un teléfono celular a mi lado. Hay un reloj despertador y correo, y puede leer algo antes de acostarse. Y seguramente muchos padres jóvenes también lo hacen. ¿Por qué usar un control remoto separado para el dispositivo de oscilación cuando está aquí, algo universal, un teléfono inteligente o una tableta! Que sea el panel de control, pensé.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Qué interfaces de radio más o menos adecuadas hay en un teléfono inteligente moderno? Bluetooth y wifi. Al principio, consideré controlar el dispositivo oscilante a través de Bluetooth. De los profesionales: es fácil de implementar desde el lateral del dispositivo. Puede usar el módulo, el "puente" Bluetooth-UART, y este es el problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es cierto, desde el lado del teléfono inteligente: problemas continuos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comenzar con mantener Bluetooth en su teléfono todo el tiempo es una mala idea. Además, para cada sistema operativo tendrá que escribir su propio software, estas son al menos dos aplicaciones: para Android y para iPhone. Pero también hay teléfonos con Windows Phone ... Después de profundizar un poco más en el tema, descubrí que nada puede funcionar con el iPhone, parece que hay algunas limitaciones. Bueno, incluso si todo funciona. Las solicitudes deben primero ser escritas. Luego publíquelo en las tiendas apropiadas. Luego, deben mantenerse en buen estado de funcionamiento, para corregir errores y responder a los comentarios de los usuarios. El problema es que nunca hice nada de esto, para mí es un "bosque oscuro con partidarios" y, en el buen sentido, para esta parte del trabajo necesitas contratar a una persona con conocimientos. Y contratar no una sola vez, y luego colaborar constantemente con él en términos de apoyo al programa.Bueno, o aprende todo por ti mismo. Resulta de alguna manera costoso y técnicamente feo. Por lo tanto, Bluetooth desaparece.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y luego me enteré de la existencia del ESP8266. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sí, ya se ha escrito mucho sobre estos módulos, además, hay un excelente foro en ruso sobre ellos. Hace poco menos de un año, después de haber comenzado a considerar este módulo para mi aplicación, durante mucho tiempo no pude formar una opinión sobre sus capacidades. Y ahora, a juzgar por las preguntas de los recién llegados al mismo foro, veo que muchos no saben de qué es capaz este módulo (chip). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una cosa importante que decir aquí es que el ESP8266 estaba originalmente "equipado" con un SDK chino muy "crudo" y "defectuoso", y por lo tanto el chip no podía usarse para resolver tareas reales de "combate". Entonces, por supuesto, era posible jugar, parpadear el LED, pero era imposible hacer algo que funcionara de manera estable.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante el año pasado, sin embargo, la situación ha cambiado fundamentalmente. En un foro en ruso dedicado a este chip, uno de sus participantes implementó un proyecto: "Desarrollo de una 'biblioteca' de un pequeño servidor web en ESP8266". Una increíble persona de incógnito que se esconde bajo el apodo pvvx creó el firmware casi solo para ESP8266, lo que le permite revelar completamente las capacidades de este chip. Los códigos fuente del proyecto están disponibles para el acceso público, el autor permite que se usen como desee, incluso con fines comerciales. Además, pvvx continúa complementando el ensamblaje con nuevas características y, lo que es más importante, está presente activamente en el foro y no se cansa (bueno, probablemente) de aconsejar a los recién llegados (y no a los recién llegados también).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado de esto, no le tengo miedo al patetismo, un trabajo sobresaliente, se hizo posible (entre muchas otras cosas) proporcionar a cualquier dispositivo una interfaz web funcional y estable. Las capacidades del chip y el firmware no se limitan a esta aplicación, pero necesitaba resolver este mismo problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las ventajas de usar el ESP8266 son obvias, y además, actualmente no hay otras opciones comparables en precio y funcionalidad.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De hecho, a un precio de aproximadamente 170 rublos en el módulo ESP8266, puede organizar un servidor web con una interfaz de control del dispositivo, lo que le permite no escribir ningún programa bajo ningún sistema operativo, solo haga una interfaz web una vez. El módulo puede funcionar como un punto de acceso y como una estación, así como simultáneamente en estos dos modos. Por ejemplo, conectándose al módulo como punto de acceso, puede configurar sus parámetros de comunicación y luego, si lo desea, conectar el módulo como estación a la red Wi-Fi de su hogar. El ensamblaje ("volcado", como lo llama respetuosamente el autor) tiene muchas configuraciones (más de 250) disponibles desde la interfaz web.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, hay otros firmware para ESP8266, pero ninguno de ellos tiene capacidades, estabilidad y calidad de trabajo como el ensamblado de pvvx (esta es mi opinión subjetiva, con respecto a mi tarea). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basado en este firmware, se desarrolló una interfaz web para un dispositivo de balanceo de cuna. El elemento web en sí fue escrito de tal manera que el sitio se mostraba correctamente en varias pantallas con diferentes tamaños y resoluciones. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/e3b/b52/a67/e3bb52a67c6cf9fdf15a8298999d67c2.jpg" alt="imagen" height="800" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/f57/0b3/440/f570b344063bba844ebf23a8394eb634.jpg" alt="imagen" height="397" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/4a6/8db/1f4/4a68db1f4fad6a2bfaea052ef086adaa.jpg" alt="imagen" height="397"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, el hardware del dispositivo tuvo que ser rehecho (de hecho, hecho de nuevo). El algoritmo de swing ahora se implementa en el microcontrolador Attiny441, interactuando con el ESP8266 a través de UART. El suministro de 3,3 voltios se realiza con el ST1S10. Tarjeta opcional con un error (fijado por montaje en superficie):</font></font><br>
<br>
<img src="https://habrastorage.org/files/469/e9d/477/469e9d477ad747f39a40291cfad1b0fa.gif" height="350" align="left"><img src="https://habrastorage.org/files/595/0b9/378/5950b9378053444ba6b86cdf831d5ad6.gif" height="350"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, ahora se ha vuelto más fácil que nunca "vincular" Wi-Fi y una interfaz web a cualquier cosa. </font><font style="vertical-align: inherit;">Al mismo tiempo, el sistema funcionará de manera bastante estable y el costo de los componentes será de solo unos 250 rublos (si calcula la encuadernación completa, no solo el módulo ESP8266). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y así apareció la interfaz web del dispositivo para mecer una cuna.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es386293/">https://habr.com/ru/post/es386293/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es386281/index.html">Recaudación de fondos para un escáner inusual que puede hacer frente rápidamente incluso a los libros</a></li>
<li><a href="../es386283/index.html">5 casos originales de marcas que se promocionan a través de juegos</a></li>
<li><a href="../es386285/index.html">Presentamos la mini PC LXBOX 3</a></li>
<li><a href="../es386287/index.html">Se ha creado el sistema de rescate colectivo de aviones. Esto no es rentable: respuesta en aerolíneas</a></li>
<li><a href="../es386291/index.html">¿De qué, de qué, de qué están hechos nuestros robots?</a></li>
<li><a href="../es386295/index.html">Google Inbox ahora ayuda a responder correos electrónicos con alta tecnología</a></li>
<li><a href="../es386297/index.html">Esperando un infospace compartido</a></li>
<li><a href="../es386299/index.html">Samsung ha anunciado un nuevo bioprocesador para dispositivos portátiles</a></li>
<li><a href="../es386301/index.html">Virgin Galactic mostrará la nueva versión de SpaceShipTwo en febrero de 2016</a></li>
<li><a href="../es386303/index.html">Lámpara inteligente que salvará a los ladrones. Los envíos de Beon comenzaron</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>