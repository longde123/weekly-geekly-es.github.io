<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>#⃣ 👴🏾 🆓 Comment utiliser la nouvelle fonctionnalité Profiler expérimentale dans React 👩🏽‍🤝‍👨🏻 🤷🏻 ⬛️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alors React 16.4.0 est sorti! (Remarque traducteur - cette fonctionnalité a été ajoutée dans la version 16.4.0, puis ce message a été écrit). Et à de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment utiliser la nouvelle fonctionnalité Profiler expérimentale dans React</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428998/"> Alors React 16.4.0 est sorti!  (Remarque traducteur - cette fonctionnalité a été ajoutée dans la version 16.4.0, puis ce message a été écrit).  Et à de tels moments, vous comprenez à quel point vous êtes JavaScript - un geek si vous suivez des mises à jour mineures de votre framework préféré.  Super! <br><br><img src="https://habrastorage.org/webt/-l/45/od/-l45od2gcnwddvbaqcsqmzasbha.gif"><br><br>  Si vous lisez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les notes de publication de la</a> version 16.4 publiées par l'équipe React, cette mise à jour aurait dû être considérée comme plutôt ennuyeuse.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les événements de pointeur</a> semblent attrayants, mais pour être honnête, j'en ai peu entendu parler auparavant. <br><br>  De plus, il existe un correctif pour une sorte de nouvelle méthode <code>getDerivedStateFromProps</code> (maintenant elle sera appelée à chaque rendu).  Je ne l'ai pas encore assez utilisé, donc pour moi cette mise à jour n'était pas très importante. <br><br>  Puis j'ai vu l'annonce, enterrée sous les titres, qu'ils avaient ajouté un nouveau composant expérimental, <code>unstable_Profiler</code> .  Voyant que ma vie est maintenant assez instable ( <code>unstable_</code> ), j'ai décidé de lire le <a href="">RFC</a> et de l'essayer. <br><a name="habracut"></a><br><h3>  TLDR </h3><br>  Des membres de l'équipe React <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">essaient de rendre le rendu asynchrone</a> .  Cela peut rendre difficile la détermination du moment du rendu des composants lors du montage / de la mise à jour.  Par conséquent, ils jouent avec ce nouveau composant <code>Profiler</code> brillant. <br><br>  <i>Alors, que pouvez-vous utiliser aujourd'hui?</i> <br><br>  Donc, si vous êtes un pro du suivi des performances de vos applications React, ce sera certainement un autre bon outil dans votre arsenal.  Si cela ne vous concerne pas, vous ne pouvez plus lire et revenir à la création d'applications intéressantes. <br><br><h3>  Utilisation de &lt;Profiler /&gt; </h3><br>  <i><b>Attention</b> : vous ne devriez peut-être pas l'utiliser en production (enfin, en fait, c'est <code>unstable_</code> ).</i>  <i>Plus tard, ils termineront la capacité de profiler et de code de production.</i> <br><br>  Fondamentalement, <code>Profiler</code> est un composant qui peut être extrait du package React par défaut.  Puisqu'il a un nom souligné prudent sur lequel de nombreux linters jurent, vous pouvez contourner ce problème comme suit: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { unstable_Profiler <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Profiler } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; ... const Profiler = React.unstable_Profiler;</code> </pre> <br>  Maintenant que vous avez <code>Profiler</code> , profilons les composants!  Vous pouvez envelopper n'importe quelle partie de votre arborescence JSX dans <code>Profiler</code> pour voir ce qui lui arrive.  <code>Profiler</code> accepte la fonction <code>onRender</code> , qui capture des informations sur le temps de rendu.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Voici un simple exemple de compteur</a> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { unstable_Profiler <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Profiler } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ComponentWithProfiling</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ state = { <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }; logProfile = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, phase, actualTime, baseTime, startTime, commitTime</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">'s </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${phase}</span></span></span><span class="hljs-string"> phase:`</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Actual time: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${actualTime}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Base time: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${baseTime}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Start time: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${startTime}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Commit time: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${commitTime}</span></span></span><span class="hljs-string">`</span></span>); }; go = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">direction</span></span></span><span class="hljs-function"> =&gt;</span></span> () =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ count }</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">count</span></span>: direction === <span class="hljs-string"><span class="hljs-string">"up"</span></span> ? count + <span class="hljs-number"><span class="hljs-number">1</span></span> : count - <span class="hljs-number"><span class="hljs-number">1</span></span> })); render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Profiler</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onRender</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.logProfile}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.go(</span></span></span></span><span class="xml"><span class="hljs-tag">"</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">up</span></span></span></span><span class="xml"><span class="hljs-tag">")}&gt;</span></span></span><span class="xml">️</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">The count is {this.state.count}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.go(</span></span></span></span><span class="xml"><span class="hljs-tag">"</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">down</span></span></span></span><span class="xml"><span class="hljs-tag">")}&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Profiler</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } }</code> </pre> <br>  Notez que vous devez donner un <code>id</code> chaque fragment que vous <code>onRender</code> . Comme vous pouvez le voir ci-dessous, <code>onRender</code> accepte un tas de mesures intéressantes: <br><br><img src="https://habrastorage.org/webt/9g/za/bl/9gzablghxnsytggtfvmb9xkvehy.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7jroojkv30.codesandbox.io</a> <br><br>  Tout d'abord, vous pouvez voir quelle était la phase de rendu ( <code>mount</code> ou <code>update</code> ), qui peut être utilisée pour identifier les parties du code qui sont mises à jour de manière inattendue (tout comme l'excellent package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pourquoi-avez-vous-mis à jour</a> que j'ai utilisé plusieurs fois et recommande vivement). <br><br>  Ensuite, nous obtenons <code>actualTime</code> et <code>baseTime</code> .  Ils sont liés au temps réel que React consacre aux calculs de rendu;  c'est-à-dire  comprendre ce qui a changé.  Veuillez noter que l'heure réelle (heure initiale) de la connexion initiale (montage) est plus longue que l'heure de mise à jour (mise à jour).  En effet, à la connexion initiale, techniquement tout est «nouveau».  Lors de la mise à jour, les calculs <i>devraient</i> être plus simples, car, j'espère, les composants de l'arborescence ne sont mis à jour que s'ils ont vraiment changé (c'est-à-dire lorsque les valeurs de prop / states ont changé). <br><br>  Dans les applications volumineuses / réelles, ces données vous aideront à comprendre où <code>shouldComponentUpdate</code> utilisé de manière incorrecte ou pas du tout, les endroits où les accessoires avec les types de référence changent souvent ou de nouveaux accessoires sont envoyés, ou simplement les endroits où vous ne vous attendiez pas à ce que les mises à jour prennent si longtemps. <br><br>  Les dernières valeurs que nous obtenons dans <code>onRender</code> sont <code>startTime</code> et <code>commitTime</code> .  Il s'agit en fait d'horodatages depuis le lancement initial.  <code>startTime</code> est l'heure à partir de laquelle le composant sélectionné a commencé à effectuer des calculs pour le rendu, tandis que <code>commitTime</code> est l'heure à laquelle React a réellement <code>commitTime</code> ces modifications pendant le rendu. <br><br>  Si vous suivez d'autres événements avec des horodatages (tels que des clics ou des frappes de touches), ces mesures peuvent aider à identifier les deltas entre le moment où les événements utilisateur se produisent et le moment où le rendu se produit.  Si l'écart est important, ce délai peut être palpable pour les utilisateurs et doit être soigneusement examiné. <br><br><h3>  Conclusion </h3><br>  Pour moi personnellement, cet outil n'est pas encore très utile.  Mais c'est une de ces choses qu'il est bon de connaître, car si jamais je rencontre ces goulots d'étranglement en matière de performances, ce sera un bon moyen de les mesurer. <br><br>  Il est important de mesurer d'abord vos problèmes de performances. Ainsi, lorsque vous apportez des «améliorations», vous pouvez savoir si cela améliore vraiment la situation ou ne fait qu'empirer.  J'ai trouvé que l'optimisation des performances est l'une de ces choses sur lesquelles vous pouvez passer beaucoup de temps.  Par conséquent, avant d'optimiser quelque chose., Assurez-vous qu'il est vraiment nécessaire. <br><br>  J'ai hâte de voir ce que l'équipe React fera avec <code>Profiler</code> à l'avenir.  Merci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@bvaughn d'</a> avoir ajouté cette fonctionnalité <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">astucieuse</a> ! <br><br>  <b>Du traducteur:</b> <br>  Pour le moment (version actuelle 16.6.0), Profiler ne fonctionne pas avec le rendu côté serveur.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La demande de fonctionnalité</a> existe déjà. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428998/">https://habr.com/ru/post/fr428998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428988/index.html">Conseils nature - Veilleuse nuageuse</a></li>
<li><a href="../fr428990/index.html">Exemples de configuration d'UIViewControllers utilisant RouteComposer</a></li>
<li><a href="../fr428992/index.html">Contournement sélectif des verrous sur les routeurs avec le firmware Padavan et Keenetic OS</a></li>
<li><a href="../fr428994/index.html">Mise en réseau sous Android avec Corutin et Retrofit</a></li>
<li><a href="../fr428996/index.html">Club de Santa Clauses anonymes 2018-2019 sur Habrahabr</a></li>
<li><a href="../fr429000/index.html">Pourquoi Bill Gates a inventé les toilettes pour 233 milliards de dollars</a></li>
<li><a href="../fr429006/index.html">Chine: «l'atelier de montage mondial» n'est pas aussi simple qu'il y paraît</a></li>
<li><a href="../fr429008/index.html">Alpha Zero, les échecs et l'apprentissage de l'anglais: le présent et l'avenir de l'intelligence artificielle</a></li>
<li><a href="../fr429010/index.html">Billets de tombola pour l'atelier Advanced React State Management With MobX</a></li>
<li><a href="../fr429014/index.html">Git sous-arbre en détail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>