<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👅 🧝🏼 😧 Composition versus héritage, modèle d'équipe et développement de jeux en général 👨‍❤️‍💋‍👨 👇🏽 👩🏻‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avertissement: À mon avis, un article sur l'architecture logicielle ne devrait pas et ne peut pas être idéal. Toute solution décrite peut ne pas couvr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Composition versus héritage, modèle d'équipe et développement de jeux en général</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438510/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/na/sz/bh/naszbh_usuh0jpozxmoiuqpdl1q.png"></div><br>  Avertissement: <i>À mon avis, un article sur l'architecture logicielle ne devrait pas et ne peut pas être idéal.</i>  <i>Toute solution décrite peut ne pas couvrir le niveau nécessaire pour un programmeur, et pour un autre programmeur, cela compliquera trop inutilement l'architecture.</i>  <i>Mais il doit apporter une solution aux tâches qu'il s'est fixées.</i>  <i>Et cette expérience, ainsi que tout le bagage de connaissances d'un programmeur qui apprend, organise des informations, affine les nouveaux arrivants et se critique ainsi que les autres - cette expérience se transforme en d'excellents produits logiciels.</i>  <i>L'article bascule entre l'art et la partie technique.</i>  <i>Il s'agit d'une petite expérience et j'espère qu'elle sera intéressante.</i> <br><blockquote>  - Écoutez, j'ai trouvé une excellente idée de jeu!  - le concepteur de jeu Vasya était échevelé et ses yeux étaient rouges.  J'ai encore bu du café et de l'holivar sur Habré pour tuer le temps avant le stand-up.  Il me regarda dans l'expectative jusqu'à ce que j'aie fini d'écrire dans les commentaires à l'homme ce qu'il avait tort.  Vasya savait que tant que la justice ne prévaudrait pas et que la vérité ne serait pas protégée, il était inutile de poursuivre la conversation avec moi.  J'ai ajouté la dernière phrase et je l'ai regardé. <br><br>  - En un mot - les magiciens avec du mana peuvent lancer des sorts, et les guerriers peuvent se battre au corps à corps et dépenser de l'endurance.  Les magiciens et les guerriers peuvent se déplacer.  Oui, il sera toujours possible de voler les vaches, mais nous le ferons déjà dans la prochaine version, en bref.  Allez-vous montrer le prototype après le stand-up, d'accord? <br><br>  Il s'est enfui dans son entreprise de conception de jeux et j'ai ouvert l'IDE. </blockquote><a name="habracut"></a><br>  En fait, le sujet «composition versus héritage», «problème banane-singe», «problème losange (héritage multiple)» sont des questions courantes lors des entretiens sous différents formats et pour une bonne raison.  Une mauvaise utilisation de l'héritage peut compliquer l'architecture et les programmeurs inexpérimentés ne savent pas comment y faire face et, par conséquent, commencent à critiquer la POO dans son ensemble et commencent à écrire du code procédural.  Par conséquent, les programmeurs expérimentés (ou ceux qui ont lu des choses intelligentes sur Internet) considèrent qu'il est de leur devoir de poser des questions à ce sujet lors d'une interview sous diverses formes.  La réponse universelle est «la composition est meilleure que l'héritage et aucune nuance de gris ne doit être appliquée».  Ceux qui viennent de lire chacune de ces réponses seront 100% satisfaits. <br><br>  Mais, comme je l'ai dit au début de l'article, chaque architecture conviendra à votre projet et si l'héritage est suffisant pour votre projet et tout ce qui est nécessaire pour résoudre le problème est de créer Monkey avec Banana - créez-le.  Notre programmeur était dans une situation similaire.  Cela n'a aucun sens de refuser l'héritage simplement parce que le FPS se moquera de vous. <br><br><pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ x = <span class="hljs-number"><span class="hljs-number">0</span></span>; y = <span class="hljs-number"><span class="hljs-number">0</span></span>; moveTo (x, y) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.x = x; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.y = y; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ mana = <span class="hljs-number"><span class="hljs-number">100</span></span>; castSpell () { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mana--; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Warrior</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ stamina = <span class="hljs-number"><span class="hljs-number">100</span></span>; meleeHit () { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamina--; } }</code> </pre> <br><blockquote>  Le stand-up, comme toujours, a traîné.  J'ai basculé sur une chaise et accroché au téléphone pendant que June Petya tentait de convaincre le testeur que l'impossibilité d'un contrôle rapide via le bouton droit de la souris n'est pas un bug, car il n'y avait aucune possibilité de ce type nulle part, ce qui signifie que vous devez abandonner la tâche au département de pré-production.  Le testeur a fait valoir que, puisque pour les utilisateurs, le contrôle via le bouton droit semble être obligatoire, alors c'est un bug, pas une fonctionnalité.  En fait, en tant que seul joueur de notre équipe à jouer à notre jeu sur des serveurs de combat, il voulait ajouter cette fonctionnalité dès que possible, mais il savait que si vous la déposiez dans le département de pré-production, la machine bureaucratique la laisserait sortir au plus tôt en 4. mois, et après l'avoir publié en tant que bogue - vous pouvez l'obtenir déjà dans la prochaine version.  Le chef de projet, comme toujours, était en retard, et les gars maudissaient si férocement qu'ils étaient déjà passés à des tapis et, probablement, les choses seraient bientôt arrivées à une bagarre si le directeur du studio n'avait pas rencontré la malédiction et n'avait pas emmené les deux dans son bureau.  Probablement à nouveau pour 300 dollars d'amende. <br><br>  Quand j'ai quitté la salle de rallye, un concepteur de jeu s'est précipité vers moi et a dit avec bonheur que tout le monde aimait le prototype, ils l'ont mis au travail et maintenant c'est notre nouveau projet pour les six prochains mois.  Alors que nous nous dirigions vers ma table, il a dit avec enthousiasme quelles nouvelles fonctionnalités seraient dans notre jeu.  Combien de sorts différents il a inventés et, bien sûr, qu'il y aura un paladin qui pourra à la fois combattre et lancer de la magie.  Et tout le département des artistes travaille déjà sur de nouvelles animations, et la Chine a déjà signé un accord en vertu duquel notre jeu sortira sur leur marché.  J'ai regardé en silence le code de mon prototype, réfléchi profondément, tout mis en évidence et supprimé. </blockquote>  Je crois qu'au fil du temps, chaque programmeur, sur la base de son expérience, commence à voir des problèmes évidents qu'il peut rencontrer.  Surtout si vous travaillez longtemps en équipe avec un seul game designer.  Nous avons un tas de nouvelles exigences et fonctionnalités.  Et notre ancienne "architecture" ne peut évidemment pas y faire face. <br><br>  Lorsqu'on vous demande une tâche similaire lors d'une entrevue, ils essaieront certainement de vous attraper.  Ils peuvent prendre de nombreuses formes différentes - les crocodiles, qui peuvent à la fois nager et courir.  Des chars qui peuvent tirer un canon ou une mitrailleuse et ainsi de suite.  La propriété la plus importante de ces tâches est que vous avez un objet qui peut faire plusieurs choses différentes.  Et votre héritage ne peut en aucun cas faire face, car il est impossible d'hériter à la fois de FlyingObject et de SwimmingObject. Et différents objets peuvent effectuer différentes actions.  À ce stade, nous abandonnons l'héritage et passons à la composition: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ abilities = []; addAbility (...abilities) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> abilities) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.abilities.push(a); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } getAbility (AbilityClass) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.abilities) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> AbilityClass) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } <span class="hljs-comment"><span class="hljs-comment">/////////////////////////////////////// // //    ,      //       // /////////////////////////////////////// class Ability {} class HealthAbility extends Ability { health = 100; maxHealth = 100; } class MovementAbility extends Ability { x = 0; y = 0; moveTo(x, y) { this.x = x; this.y = y; } } class SpellCastAbility extends Ability { mana = 100; maxMana = 100; cast () { this.mana--; } } class MeleeFightAbility extends Ability { stamina = 100; maxStamina = 100; constructor (power) { this.power = power; } hit () { this.stamina--; } } /////////////////////////////////////// // //        // /////////////////////////////////////// class CharactersFactory { createMage () { return new Character().addAbility( new MovementAbility(), new HealthAbility(), new SpellCastAbility() ); } createWarrior () { return new Character().addAbility( new MovementAbility(), new HealthAbility(), new MeleeFightAbility(3) ); } createPaladin () { return new Character().addAbility( new MovementAbility(), new HealthAbility(), new SpellCastAbility(), new MeleeFightAbility(2) ); } }</span></span></code> </pre><br>  Chaque action possible est maintenant une classe distincte avec son propre état, et si nécessaire, nous pouvons créer des personnages uniques en leur jetant le nombre de capacités requis.  Par exemple, il est très facile de créer un arbre magique immortel: <br><br><pre> <code class="javascript hljs">createMagicTree () { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Character().addAbility( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpellCastAbility() ); }</code> </pre> <br>  Nous avons perdu l'héritage et une composition est apparue à la place.  Maintenant, nous créons un personnage et listons ses capacités possibles.  Mais cela ne signifie pas que l'héritage est toujours mauvais, mais dans ce cas, il ne convient pas.  La meilleure façon de comprendre si l'héritage est juste est de répondre vous-même à la question de savoir quelle relation cela représente.  Si cette connexion est "is-a", c'est-à-dire que vous indiquez que MeleeFightAbility est une capacité, alors elle est parfaite.  Si la connexion est créée uniquement parce que vous souhaitez ajouter une action et affiche "has-a", vous devez penser à la composition. <br><blockquote>  J'ai aimé regarder un excellent résultat.  Il fonctionne intelligemment et sans bugs, architecture de rêve!  Je suis sûr qu'il passera plus d'une épreuve du temps et pendant longtemps nous n'aurons pas à le réécrire.  J'étais tellement enthousiaste à propos de mon code que je n'ai même pas remarqué comment June Petya m'a approché. <br><br>  La rue était déjà sombre, ce qui rendait encore plus visible comment il brillait de bonheur.  Apparemment, il a réussi à repousser la tâche et à se débarrasser de la pénalité pour les tapis en direction de ses collègues, qui a été annoncée la semaine dernière. <br><br>  "Les artistes ont peint des animations simplement divines", a-t-il rapidement bavardé, "J'ai hâte de les faire baiser."  Des avantages volants particulièrement magnifiques lorsqu'un sort de soin est appliqué.  Ils sont tellement verts et quels avantages! <br><br>  Je me suis maudit, parce que j'avais complètement oublié qu'il nous restait à visser la vue.  Merde, il semble qu'il faille réécrire l'architecture. </blockquote>  Dans de tels articles, seul le modèle est généralement décrit, car il est abstrait et adulte, et vous pouvez également donner des «images à montrer» à June, quelle que soit l'architecture.  Néanmoins, notre modèle devrait fournir un maximum d'informations pour la vue afin qu'elle puisse faire son travail.  Dans GameDev, le motif «Team» est généralement utilisé pour cela.  En un mot - nous avons un état sans logique, et tout changement devrait se produire dans les équipes correspondantes.  Cela peut sembler compliqué, mais il offre de nombreux avantages: <br>  - Ils se combinent très bien quand une équipe en appelle une autre <br>  - Chaque commande, une fois exécutée, est en fait un événement auquel vous pouvez vous abonner <br>  - Nous pouvons facilement les sérialiser. <br><br>  Par exemple, une commande damage peut ressembler à ceci.  C'est alors que le guerrier l'utilisera lorsqu'il sera frappé avec une épée et le magicien lorsqu'il sera frappé par un sort de feu.  Maintenant, pour plus de simplicité, j'ai implémenté la validation des commandes via des exceptions, mais elles peuvent ensuite être réécrites sous forme de codes retour. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DealDamageCommand</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> (target, damage) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target = target; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.damage = damage; } execute () { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> healthAbility = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.getAbility(HealthAbility); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (healthAbility == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'NoHealthAbility'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> resultHealth = healthAbility.health - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.damage; healthAbility.health = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max( <span class="hljs-number"><span class="hljs-number">0</span></span>, resultHealth ); } }</code> </pre> <br>  J'aime faire des commandes hiérarchiques - lorsqu'une est exécutée, elle <s>donne naissance à de</s> nombreux enfants, que le moteur exécute ensuite.  Alors maintenant que nous avons la possibilité d'infliger des dégâts, nous pouvons essayer de mettre en œuvre une frappe de mêlée <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MeleeHitCommand</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> (source, target, damage) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.source = source; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target = target; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.damage = damage; } execute () { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fightAbility = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.source.getAbility(MeleeFightAbility); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fightAbility == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'NoFightAbility'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addChildren([ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DealDamageCommand(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target, fightAbility.power); ]); } }</code> </pre> <br>  Ces deux équipes ont tout ce dont vous avez besoin pour nos animations.  Un moteur de rendu peut simplement s'abonner à des événements et afficher tout ce que les artistes désirent avec le code suivant: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> onMeleeHit (meleeHitCommand) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> view.drawMeleeHit( meleeHitCommand.source, meleeHitCommand.target ); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> onDealDamage (dealDamageCommand) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> view.showDamageNumbers( dealDamageCommand.target, dealDamageCommand.damage ); }</code> </pre> <br><blockquote>  J'ai perdu le compte, qui une fois de suite je reste au travail jusqu'à la tombée de la nuit.  Depuis l'enfance, le développement des jeux m'attire, il me semble quelque chose de magique, et même maintenant, alors que je fais ça depuis de nombreuses années, j'en suis inquiet.  Malgré le fait que j'ai appris un secret sur la façon dont ils sont créés - je n'ai pas perdu confiance en la magie.  Et cette magie me fait m'asseoir avec une telle inspiration la nuit et écrire mon code.  Vasya est venu vers moi.  Il ne sait absolument pas comment programmer, mais partage mon attitude envers les jeux. <br><br>  - Ici - le game designer a mis devant moi un Talmud de 200 pages imprimé sur des feuilles A4.  Bien que le document de conception ait été réalisé en confluence, nous avons aimé l'imprimer à des étapes importantes afin de ressentir ce travail dans l'incarnation physique.  Je l'ai ouvert sur une page aléatoire et j'ai obtenu une liste énorme d'une variété de sorts qu'un mage et un paladin peuvent faire, une description de leurs effets, des besoins en intelligence, du prix du mana et une description approximative pour les artistes comment les afficher.  Travailler pendant plusieurs mois, car aujourd'hui je vais de nouveau rester au travail. </blockquote>  Notre architecture facilite la création de combinaisons complexes de sorts.  C'est juste que chaque sort peut renvoyer une liste de commandes qui doivent être exécutées pendant le lancement <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CastSpellCommand</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> (source, target, spell) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.source = source; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target = target; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.spell = spell; } execute () { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> spellAbility = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.source.getAbility(SpellCastAbility); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (spellAbility == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'NoSpellCastAbility'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addChildren(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PayManaCommand(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.source, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.spell.manaCost)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addChildren(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.spell.getCommands(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.source, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target)); } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spell</span></span></span><span class="hljs-class"> </span></span>{ manaCost = <span class="hljs-number"><span class="hljs-number">0</span></span>; getCommands (source, target) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> []; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DamageSpell</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spell</span></span></span><span class="hljs-class"> </span></span>{ manaCost = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> (damageValue) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.damageValue = damageValue; } getCommands (source, target) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DealDamageCommand(target, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.damageValue) ]; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealSpell</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spell</span></span></span><span class="hljs-class"> </span></span>{ manaCost = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> (healValue) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.healValue = healValue; } getCommands (source, target) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HealDamageCommand(target, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.healValue) ]; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VampireSpell</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spell</span></span></span><span class="hljs-class"> </span></span>{ manaCost = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> (value) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } getCommands (source, target) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DealDamageCommand(target, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HealDamageCommand(source, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value) ]; } }</code> </pre><br><blockquote>  <i>Un an et demi plus tard</i> <br><br>  Le stand-up, comme toujours, a traîné.  Je me suis balancé sur la chaise et j'ai accroché l'ordinateur portable pendant que Middle Petya se disputait avec le testeur au sujet du bug qui avait été déclenché.  En toute sincérité, il a essayé de convaincre le testeur que le manque de contrôle via le bouton droit de la souris dans notre nouveau jeu ne devrait pas être marqué comme un bug, car une telle tâche n'a jamais été maintenue et n'a pas été élaborée par des concepteurs de jeux ou des bouffons.  J'avais un sentiment de déjà-vu, mais un nouveau message dans la discorde m'a distrait: <br><br>  - Écoutez - le concepteur du jeu a écrit - J'ai une excellente idée ... </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr438510/">https://habr.com/ru/post/fr438510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr438496/index.html">Python + Raspberry Pi + Pixhawk et quadricoptère. Ou comment ne pas faire de robots</a></li>
<li><a href="../fr438498/index.html">Comment se préparer rapidement à un entretien, qui posera des questions sur les algorithmes et les technologies de traitement de l'information?</a></li>
<li><a href="../fr438500/index.html">Du bon côté: comment Optimus Prime a amené Kingston et HyperX au CES 2019</a></li>
<li><a href="../fr438506/index.html">Mon deuxième hiver sans neige ni magistrature en Belgique</a></li>
<li><a href="../fr438508/index.html">L'activité du cerveau humain a d'abord été traduite en un discours clair</a></li>
<li><a href="../fr438512/index.html">Compression de données Huffman</a></li>
<li><a href="../fr438514/index.html">Comment je n'ai pas travaillé depuis un an chez Sberbank</a></li>
<li><a href="../fr438516/index.html">Quand enregistrer la longueur d'un tableau dans une variable locale en C #</a></li>
<li><a href="../fr438518/index.html">Création de votre jsfiddle, partie 2</a></li>
<li><a href="../fr438522/index.html">Égaliseur stratégique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>