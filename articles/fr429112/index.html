<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎧 🧛🏾 🕸️ Comment réussir un cyber-test à Checkpoint 💔 🔊 🗺️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous, je suis Nikita Kurtin , conservatrice de l’école supérieure israélienne d’informatique et de sécurité HackerU 

 Checkpoint , la princ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment réussir un cyber-test à Checkpoint</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/"> Bonjour à tous, je suis <b>Nikita Kurtin</b> , conservatrice de l’école supérieure israélienne d’informatique et de sécurité <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>HackerU</b></a> <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Checkpoint</a></b> , la principale société israélienne de sécurité de l'information, a publié une série de cyber-tests cet été. <br><br>  Les tâches étaient divisées en six catégories: <br><br>  • Logique <br>  • Web <br>  • Programmation <br>  • Réseautage <br>  • Inverser <br>  • Surprise <br><br>  Deux tâches pour chaque direction.  Dans cet article, je vais vous dire comment j'ai passé seulement quatre tests, dans les trois autres suivants: <br><br>  <b>Checkpoint</b> avait déjà réussi à gagner le respect et l'intérêt de ma part, j'ai donc décidé d'accepter ces défis.  Cependant, en raison de mon emploi, je n'ai pu me permettre que 8 des 12 tâches (de quatre catégories différentes).  Et j'ai réussi à en résoudre 7. <br><br>  Le défi a officiellement pris fin fin septembre 2018. <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="image"><br><br>  Alors maintenant, avec une conscience claire, je peux vous expliquer étape par étape comment j'ai réussi à résoudre les problèmes suivants: <br><br>  • Défi logique "PNG ++" <br>  • Défi Web «Les robots sont de retour» <br>  • Défi Web "Galerie Diego" <br>  • Tâche de programmation «étapes prudentes» <br>  • La tâche de programmation "Puzzle" <br>  • Défi de réseautage «Ping Pong» <br>  • «Protocole» du défi de réseautage <br><br>  <u><b>Défi: PNG ++</b></u> <u><br></u> <br>  Description: <br><br>  Cette image (lien vers un fichier PNG chiffré) a <i>été encodée à l'aide d'un chiffrement personnalisé.</i> <i><br><br></i>  <i>Nous avons réussi à lire la plupart de ce code ici (lien vers le code python).</i> <i><br></i>  <i>Malheureusement, quelqu'un a renversé du café lentement sur tout le fichier key_transformator.py.</i> <i><br><a name="habracut"></a></i>  <i>Pourriez-vous nous aider à décrypter cette image?</i> <br><br>  Code Python: <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="image"><br><br>  La logique de chiffrement est la suivante: <br><br>  1. Définissez la longueur de la clé (taille de la clé) sur 4 octets <br><br>  2. Lisez les octets du fichier "flag.png" dans la variable "img" <br><br>  3. Ajoutez un remplissage au fichier, au premier multiple de quatre le plus proche.  Le remplissage est égal au nombre d'octets manquants.  Par exemple, si la longueur du fichier est de 29 octets (3 manquants), ajoutez trois octets avec la valeur décimale 3 (ASCII 0x03).  Ou, en d'autres termes, les octets de remplissage ne peuvent pas être vides (ASCII 0x00), car sa valeur décimale est zéro, ce qui n'implique pas. <br><br>  4. Définissez la clé de départ avec quatre lettres majuscules aléatoires ([AZ]). <br><br>  5. Faites de même avec tous les octets du fichier, en chiffrant des chaînes de quatre octets à la fois. <br><br>  a.  Chaque octet du fichier est disputé par octet de la clé <br>  b.  La clé est constamment convertie en une autre clé, key_transformator.transform (key) en est responsable <br>  c.  Des octets chiffrés sont ajoutés à enc_data <br><br>  6. Entrez enc_data (octets chiffrés) dans encrypted.png <br><br>  Pour commencer, j'ai vérifié l'en-tête du format PNG et constaté que les huit premiers octets sont les suivants: <br><br>  [137, 80, 78, 71, 13, 10, 26, 10] <br><br>  J'ai pris les huit premiers octets du fichier crypté et les ai tordus avec ces huit octets: <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="image"><br><br>  La clé du premier bloc s'est avérée comme ceci: <br>  [85, 80, 82, 81] <br><br>  Et le deuxième bloc - comme ceci: <br>  [86, 81, 83, 82] <br><br>  Étant donné que chaque clé suivante est générée dynamiquement à l'aide de la clé précédente (key = key_transformator.transform (key), j'ai compris l'algorithme: ajoutez un à chaque octet dans la clé précédente: <br>  85 -&gt; 86 <br>  80 -&gt; 81 <br>  82 -&gt; 83 <br>  81 -&gt; 82 <br><br>  Et puis j'ai réalisé que le nom du défi cachait un soupçon maladif. <br><br>  J'ai écrit deux «fonctions d'aide»: <br><br>  • «nextKey», qui restaure la clé suivante en fonction du dernier <br>  • "nextChar", qui restaure la lettre suivante, et dans la plupart des cas, augmente simplement d'une unité si elle tombe dans les limites d'octets (255) <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="image"><br><br>  J'ai converti les 4 octets d'origine [85, 80 82, 81] en lettres: «UPRQ» et j'ai exécuté l'algorithme <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="image"><br><br>  L'indicateur a été spécifié dans le fichier déchiffré: <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="image"><br><br>  <u><b>Défi: le retour des robots</b></u> <u><br></u> <br><br>  Description: <br><br>  <i>Les robots sont cool, mais croyez-moi: leur accès devrait être limité!</i>  Découvrez-le (lien) <br><br>  Après avoir suivi le lien, vous voyez une certaine page consacrée aux robots.  Fondamentalement, tout suggère de vérifier la présence du fichier "robots.txt". <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="image"><br><br>  En ajoutant ./robots.txt à l'url, nous obtenons ce qui suit: <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="image"><br><br>  J'ai vérifié ./secret_login.html et suis tombé sur une page d'enregistrement <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="image"><br><br>  Ensuite, j'ai vérifié le code source du formulaire pour trouver la confirmation du mot de passe et j'ai vu ce Javascript: <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="image"><br><br>  Il semble que lorsque la valeur est confirmée, elle est envoyée à la fonction d'autorisation, qui décode la valeur transmise à l'aide de la fonction btoa (fonction de décodage base64 en Javascript), puis la compare avec la chaîne: «SzMzcFQjM1IwYjB0JDB1dA ==». <br><br>  J'ai décodé cette ligne <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="image"><br><br>  J'ai inséré la valeur résultante dans la chaîne de mot de passe.  Bingo! <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="image"><br><br><br>  <b><u>Défi: Diego Gallery</u></b> <b><br></b> <br>  Description: <br><br>  <i>J'ai récemment commencé à développer une plateforme pour gérer les photos de mon chat et sécuriser mon flag.txt.</i>  <i>Veuillez vérifier mon système (lien vers le formulaire d'inscription).</i> <i><br><br></i>  <i>Afin d'éviter les bourrages dans le système de sécurité, tels que la possibilité d'incorporer du code SQL, j'ai créé mon propre schéma.</i> <i><br><br></i>  <i>Sa brève description est disponible ici (lien vers le schéma)</i> <br><br>  Formulaire d'inscription: <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="image"><br><br>  Circuit préréglé: <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="image"><br><br>  Après avoir défini le nom d'utilisateur et le mot de passe de test, j'ai eu accès à la galerie publique du chat "Diego". <br><br>  Depuis que je me suis enregistré en tant qu'utilisateur régulier, je me suis dit que je devrais peut-être trouver un moyen d'escalader les privilèges PE (Privilege Escalation).  En parcourant le schéma pour les utilisateurs enregistrés, j'ai vu que la différence entre l'utilisateur régulier et l'administrateur se trouve dans la troisième section du schéma, séparée par trois tirets. <br><br>  Après avoir estimé que si la première valeur (nom d'utilisateur) se réfère à la première section et la seconde (mot de passe) se réfère à la seconde, le rôle est attribué par le système immédiatement après l'entrée de l'utilisateur avec les droits actuels. <br><br>  Par exemple: <br><br>  START ||| Première valeur ||| Deuxième valeur ||| utilisateur (ajouté par le service Web) ||| END <br><br>  Ma charge utile était la suivante: <br><br>  • Première valeur: "niki ||| niki ||| admin ||| END \ nSTART ||| autre" <br>  • Deuxième valeur: «autre» <br><br>  Cela a probablement généré les lignes de journal suivantes: <br><br>  START ||| niki ||| niki ||| admin ||| END <br>  START ||| autre ||| autre ||| utilisateur ||| FIN <br><br>  Après cela, j'ai pu me connecter en tant qu'administrateur et obtenir tous les droits: <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="image"><br><br>  Appuyer sur les boutons active uniquement un avertissement indiquant que le drapeau est sûr. <br>  Cependant, à l'intérieur de l'URL, vous pouvez lire: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a> ?  view = log.txt <br><br>  Qui fait très explicitement référence à <i>LFI (Local File Inclusion) via URL</i> <br><br>  J'ai essayé: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br>  Et le drapeau était à moi. <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="image"><br><br>  <b><u>Défi: étapes prudentes</u></b> <b><br></b> <br>  Description: <br><br>  <i>Ce (lien de fichier) est un tas d'archives que nous avons trouvées.</i>  <i>Nous sommes sûrs que le drapeau secret est caché quelque part en eux.</i> <i><br></i>  <i>Nous sommes absolument sûrs que les données que nous recherchons sont cachées dans la section commentaires de chaque fichier.</i> <i><br></i>  <i>Pourriez-vous parcourir soigneusement les fichiers et trouver le drapeau?</i> <i><br></i>  <i>Bonne chance</i> <br><br>  Après avoir extrait le fichier, vous obtenez un répertoire appelé "archives" avec deux mille fichiers à l'intérieur, intitulé "unzipme. [Number]". <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="image"><br><br>  J'ai utilisé le programme binwalk pour vérifier le premier fichier.  Et voici ce que le programme m'a donné: <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="image"><br><br>  Oui, donc dans la section des commentaires, nous avons à la fois des lettres et des chiffres.  Encore des indices? <br><br>  Au début, je me suis demandé si je devais connecter les lettres avec les index donnés de ce fichier zip et vérifier le fichier suivant déjà avec l'index 245. <br><br>  Mais voici une surprise: le deuxième fichier n'était pas au format zip, mais au format rar. <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="image"><br><br>  Par conséquent, j'ai dû «l'anrarn» pour arriver aux commentaires: <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="image"><br><br>  Ma logique était d'exécuter le fichier via binwalk, et si je tombais sur un RAR, décompressez-le pour accéder aux commentaires.  Sinon, consultez directement la section des commentaires pour comprendre d'autres actions. <br><br>  Ma première supposition: le numéro est l'index du fichier (chacun a été numéroté de 0 à 1999).  Cependant, j'ai trouvé que certains chiffres sont négatifs, ce qui signifie qu'ils ne peuvent pas être un indice. <br><br>  Deuxième hypothèse: le nombre est un saut, qui pourrait bien être négatif.  Pour chaque numéro, j'avais besoin d'un saut au fichier suivant.  Je savais que si mon code saute constamment au fichier calculé suivant, cela peut créer un petit piège sous la forme d'un cycle et mon code restera coincé dans une boucle sans fin.  J'ai donc écrit un code python avec une limite de compte.  Et après plusieurs tests, j'ai découvert que le nombre 120 serait bien suffisant: <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="image"><br><br>  Et le drapeau était à moi: <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="image"><br><br>  Les trois autres que j'ai décrits dans le prochain post, lisez, essayez, je serai heureux de vos commentaires </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429112/">https://habr.com/ru/post/fr429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429102/index.html">Ventes de véhicules électriques au Canada</a></li>
<li><a href="../fr429104/index.html">Données élevées</a></li>
<li><a href="../fr429106/index.html">CIS pour les infrastructures</a></li>
<li><a href="../fr429108/index.html">Google: la suppression des liens "piratés" de l'émission ne résoudra pas le problème du contenu illégal</a></li>
<li><a href="../fr429110/index.html">Conseils CSS que vous ne trouverez probablement pas dans les didacticiels</a></li>
<li><a href="../fr429114/index.html">Comment réussir un cyber-test à Checkpoint Partie 2</a></li>
<li><a href="../fr429116/index.html">Créez des images réactives</a></li>
<li><a href="../fr429118/index.html">Analyste d'aéroport</a></li>
<li><a href="../fr429120/index.html">Java Challengers # 3: Polymorphisme et héritage</a></li>
<li><a href="../fr429122/index.html">L'avenir proche de NetApp</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>