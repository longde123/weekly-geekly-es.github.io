<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéß üßõüèæ üï∏Ô∏è Comment r√©ussir un cyber-test √† Checkpoint üíî üîä üó∫Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous, je suis Nikita Kurtin , conservatrice de l‚Äô√©cole sup√©rieure isra√©lienne d‚Äôinformatique et de s√©curit√© HackerU 

 Checkpoint , la princ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment r√©ussir un cyber-test √† Checkpoint</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/"> Bonjour √† tous, je suis <b>Nikita Kurtin</b> , conservatrice de l‚Äô√©cole sup√©rieure isra√©lienne d‚Äôinformatique et de s√©curit√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>HackerU</b></a> <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Checkpoint</a></b> , la principale soci√©t√© isra√©lienne de s√©curit√© de l'information, a publi√© une s√©rie de cyber-tests cet √©t√©. <br><br>  Les t√¢ches √©taient divis√©es en six cat√©gories: <br><br>  ‚Ä¢ Logique <br>  ‚Ä¢ Web <br>  ‚Ä¢ Programmation <br>  ‚Ä¢ R√©seautage <br>  ‚Ä¢ Inverser <br>  ‚Ä¢ Surprise <br><br>  Deux t√¢ches pour chaque direction.  Dans cet article, je vais vous dire comment j'ai pass√© seulement quatre tests, dans les trois autres suivants: <br><br>  <b>Checkpoint</b> avait d√©j√† r√©ussi √† gagner le respect et l'int√©r√™t de ma part, j'ai donc d√©cid√© d'accepter ces d√©fis.  Cependant, en raison de mon emploi, je n'ai pu me permettre que 8 des 12 t√¢ches (de quatre cat√©gories diff√©rentes).  Et j'ai r√©ussi √† en r√©soudre 7. <br><br>  Le d√©fi a officiellement pris fin fin septembre 2018. <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="image"><br><br>  Alors maintenant, avec une conscience claire, je peux vous expliquer √©tape par √©tape comment j'ai r√©ussi √† r√©soudre les probl√®mes suivants: <br><br>  ‚Ä¢ D√©fi logique "PNG ++" <br>  ‚Ä¢ D√©fi Web ¬´Les robots sont de retour¬ª <br>  ‚Ä¢ D√©fi Web "Galerie Diego" <br>  ‚Ä¢ T√¢che de programmation ¬´√©tapes prudentes¬ª <br>  ‚Ä¢ La t√¢che de programmation "Puzzle" <br>  ‚Ä¢ D√©fi de r√©seautage ¬´Ping Pong¬ª <br>  ‚Ä¢ ¬´Protocole¬ª du d√©fi de r√©seautage <br><br>  <u><b>D√©fi: PNG ++</b></u> <u><br></u> <br>  Description: <br><br>  Cette image (lien vers un fichier PNG chiffr√©) a <i>√©t√© encod√©e √† l'aide d'un chiffrement personnalis√©.</i> <i><br><br></i>  <i>Nous avons r√©ussi √† lire la plupart de ce code ici (lien vers le code python).</i> <i><br></i>  <i>Malheureusement, quelqu'un a renvers√© du caf√© lentement sur tout le fichier key_transformator.py.</i> <i><br><a name="habracut"></a></i>  <i>Pourriez-vous nous aider √† d√©crypter cette image?</i> <br><br>  Code Python: <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="image"><br><br>  La logique de chiffrement est la suivante: <br><br>  1. D√©finissez la longueur de la cl√© (taille de la cl√©) sur 4 octets <br><br>  2. Lisez les octets du fichier "flag.png" dans la variable "img" <br><br>  3. Ajoutez un remplissage au fichier, au premier multiple de quatre le plus proche.  Le remplissage est √©gal au nombre d'octets manquants.  Par exemple, si la longueur du fichier est de 29 octets (3 manquants), ajoutez trois octets avec la valeur d√©cimale 3 (ASCII 0x03).  Ou, en d'autres termes, les octets de remplissage ne peuvent pas √™tre vides (ASCII 0x00), car sa valeur d√©cimale est z√©ro, ce qui n'implique pas. <br><br>  4. D√©finissez la cl√© de d√©part avec quatre lettres majuscules al√©atoires ([AZ]). <br><br>  5. Faites de m√™me avec tous les octets du fichier, en chiffrant des cha√Ænes de quatre octets √† la fois. <br><br>  a.  Chaque octet du fichier est disput√© par octet de la cl√© <br>  b.  La cl√© est constamment convertie en une autre cl√©, key_transformator.transform (key) en est responsable <br>  c.  Des octets chiffr√©s sont ajout√©s √† enc_data <br><br>  6. Entrez enc_data (octets chiffr√©s) dans encrypted.png <br><br>  Pour commencer, j'ai v√©rifi√© l'en-t√™te du format PNG et constat√© que les huit premiers octets sont les suivants: <br><br>  [137, 80, 78, 71, 13, 10, 26, 10] <br><br>  J'ai pris les huit premiers octets du fichier crypt√© et les ai tordus avec ces huit octets: <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="image"><br><br>  La cl√© du premier bloc s'est av√©r√©e comme ceci: <br>  [85, 80, 82, 81] <br><br>  Et le deuxi√®me bloc - comme ceci: <br>  [86, 81, 83, 82] <br><br>  √âtant donn√© que chaque cl√© suivante est g√©n√©r√©e dynamiquement √† l'aide de la cl√© pr√©c√©dente (key = key_transformator.transform (key), j'ai compris l'algorithme: ajoutez un √† chaque octet dans la cl√© pr√©c√©dente: <br>  85 -&gt; 86 <br>  80 -&gt; 81 <br>  82 -&gt; 83 <br>  81 -&gt; 82 <br><br>  Et puis j'ai r√©alis√© que le nom du d√©fi cachait un soup√ßon maladif. <br><br>  J'ai √©crit deux ¬´fonctions d'aide¬ª: <br><br>  ‚Ä¢ ¬´nextKey¬ª, qui restaure la cl√© suivante en fonction du dernier <br>  ‚Ä¢ "nextChar", qui restaure la lettre suivante, et dans la plupart des cas, augmente simplement d'une unit√© si elle tombe dans les limites d'octets (255) <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="image"><br><br>  J'ai converti les 4 octets d'origine [85, 80 82, 81] en lettres: ¬´UPRQ¬ª et j'ai ex√©cut√© l'algorithme <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="image"><br><br>  L'indicateur a √©t√© sp√©cifi√© dans le fichier d√©chiffr√©: <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="image"><br><br>  <u><b>D√©fi: le retour des robots</b></u> <u><br></u> <br><br>  Description: <br><br>  <i>Les robots sont cool, mais croyez-moi: leur acc√®s devrait √™tre limit√©!</i>  D√©couvrez-le (lien) <br><br>  Apr√®s avoir suivi le lien, vous voyez une certaine page consacr√©e aux robots.  Fondamentalement, tout sugg√®re de v√©rifier la pr√©sence du fichier "robots.txt". <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="image"><br><br>  En ajoutant ./robots.txt √† l'url, nous obtenons ce qui suit: <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="image"><br><br>  J'ai v√©rifi√© ./secret_login.html et suis tomb√© sur une page d'enregistrement <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="image"><br><br>  Ensuite, j'ai v√©rifi√© le code source du formulaire pour trouver la confirmation du mot de passe et j'ai vu ce Javascript: <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="image"><br><br>  Il semble que lorsque la valeur est confirm√©e, elle est envoy√©e √† la fonction d'autorisation, qui d√©code la valeur transmise √† l'aide de la fonction btoa (fonction de d√©codage base64 en Javascript), puis la compare avec la cha√Æne: ¬´SzMzcFQjM1IwYjB0JDB1dA ==¬ª. <br><br>  J'ai d√©cod√© cette ligne <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="image"><br><br>  J'ai ins√©r√© la valeur r√©sultante dans la cha√Æne de mot de passe.  Bingo! <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="image"><br><br><br>  <b><u>D√©fi: Diego Gallery</u></b> <b><br></b> <br>  Description: <br><br>  <i>J'ai r√©cemment commenc√© √† d√©velopper une plateforme pour g√©rer les photos de mon chat et s√©curiser mon flag.txt.</i>  <i>Veuillez v√©rifier mon syst√®me (lien vers le formulaire d'inscription).</i> <i><br><br></i>  <i>Afin d'√©viter les bourrages dans le syst√®me de s√©curit√©, tels que la possibilit√© d'incorporer du code SQL, j'ai cr√©√© mon propre sch√©ma.</i> <i><br><br></i>  <i>Sa br√®ve description est disponible ici (lien vers le sch√©ma)</i> <br><br>  Formulaire d'inscription: <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="image"><br><br>  Circuit pr√©r√©gl√©: <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="image"><br><br>  Apr√®s avoir d√©fini le nom d'utilisateur et le mot de passe de test, j'ai eu acc√®s √† la galerie publique du chat "Diego". <br><br>  Depuis que je me suis enregistr√© en tant qu'utilisateur r√©gulier, je me suis dit que je devrais peut-√™tre trouver un moyen d'escalader les privil√®ges PE (Privilege Escalation).  En parcourant le sch√©ma pour les utilisateurs enregistr√©s, j'ai vu que la diff√©rence entre l'utilisateur r√©gulier et l'administrateur se trouve dans la troisi√®me section du sch√©ma, s√©par√©e par trois tirets. <br><br>  Apr√®s avoir estim√© que si la premi√®re valeur (nom d'utilisateur) se r√©f√®re √† la premi√®re section et la seconde (mot de passe) se r√©f√®re √† la seconde, le r√¥le est attribu√© par le syst√®me imm√©diatement apr√®s l'entr√©e de l'utilisateur avec les droits actuels. <br><br>  Par exemple: <br><br>  START ||| Premi√®re valeur ||| Deuxi√®me valeur ||| utilisateur (ajout√© par le service Web) ||| END <br><br>  Ma charge utile √©tait la suivante: <br><br>  ‚Ä¢ Premi√®re valeur: "niki ||| niki ||| admin ||| END \ nSTART ||| autre" <br>  ‚Ä¢ Deuxi√®me valeur: ¬´autre¬ª <br><br>  Cela a probablement g√©n√©r√© les lignes de journal suivantes: <br><br>  START ||| niki ||| niki ||| admin ||| END <br>  START ||| autre ||| autre ||| utilisateur ||| FIN <br><br>  Apr√®s cela, j'ai pu me connecter en tant qu'administrateur et obtenir tous les droits: <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="image"><br><br>  Appuyer sur les boutons active uniquement un avertissement indiquant que le drapeau est s√ªr. <br>  Cependant, √† l'int√©rieur de l'URL, vous pouvez lire: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a> ?  view = log.txt <br><br>  Qui fait tr√®s explicitement r√©f√©rence √† <i>LFI (Local File Inclusion) via URL</i> <br><br>  J'ai essay√©: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br>  Et le drapeau √©tait √† moi. <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="image"><br><br>  <b><u>D√©fi: √©tapes prudentes</u></b> <b><br></b> <br>  Description: <br><br>  <i>Ce (lien de fichier) est un tas d'archives que nous avons trouv√©es.</i>  <i>Nous sommes s√ªrs que le drapeau secret est cach√© quelque part en eux.</i> <i><br></i>  <i>Nous sommes absolument s√ªrs que les donn√©es que nous recherchons sont cach√©es dans la section commentaires de chaque fichier.</i> <i><br></i>  <i>Pourriez-vous parcourir soigneusement les fichiers et trouver le drapeau?</i> <i><br></i>  <i>Bonne chance</i> <br><br>  Apr√®s avoir extrait le fichier, vous obtenez un r√©pertoire appel√© "archives" avec deux mille fichiers √† l'int√©rieur, intitul√© "unzipme. [Number]". <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="image"><br><br>  J'ai utilis√© le programme binwalk pour v√©rifier le premier fichier.  Et voici ce que le programme m'a donn√©: <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="image"><br><br>  Oui, donc dans la section des commentaires, nous avons √† la fois des lettres et des chiffres.  Encore des indices? <br><br>  Au d√©but, je me suis demand√© si je devais connecter les lettres avec les index donn√©s de ce fichier zip et v√©rifier le fichier suivant d√©j√† avec l'index 245. <br><br>  Mais voici une surprise: le deuxi√®me fichier n'√©tait pas au format zip, mais au format rar. <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="image"><br><br>  Par cons√©quent, j'ai d√ª ¬´l'anrarn¬ª pour arriver aux commentaires: <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="image"><br><br>  Ma logique √©tait d'ex√©cuter le fichier via binwalk, et si je tombais sur un RAR, d√©compressez-le pour acc√©der aux commentaires.  Sinon, consultez directement la section des commentaires pour comprendre d'autres actions. <br><br>  Ma premi√®re supposition: le num√©ro est l'index du fichier (chacun a √©t√© num√©rot√© de 0 √† 1999).  Cependant, j'ai trouv√© que certains chiffres sont n√©gatifs, ce qui signifie qu'ils ne peuvent pas √™tre un indice. <br><br>  Deuxi√®me hypoth√®se: le nombre est un saut, qui pourrait bien √™tre n√©gatif.  Pour chaque num√©ro, j'avais besoin d'un saut au fichier suivant.  Je savais que si mon code saute constamment au fichier calcul√© suivant, cela peut cr√©er un petit pi√®ge sous la forme d'un cycle et mon code restera coinc√© dans une boucle sans fin.  J'ai donc √©crit un code python avec une limite de compte.  Et apr√®s plusieurs tests, j'ai d√©couvert que le nombre 120 serait bien suffisant: <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="image"><br><br>  Et le drapeau √©tait √† moi: <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="image"><br><br>  Les trois autres que j'ai d√©crits dans le prochain post, lisez, essayez, je serai heureux de vos commentaires </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429112/">https://habr.com/ru/post/fr429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429102/index.html">Ventes de v√©hicules √©lectriques au Canada</a></li>
<li><a href="../fr429104/index.html">Donn√©es √©lev√©es</a></li>
<li><a href="../fr429106/index.html">CIS pour les infrastructures</a></li>
<li><a href="../fr429108/index.html">Google: la suppression des liens "pirat√©s" de l'√©mission ne r√©soudra pas le probl√®me du contenu ill√©gal</a></li>
<li><a href="../fr429110/index.html">Conseils CSS que vous ne trouverez probablement pas dans les didacticiels</a></li>
<li><a href="../fr429114/index.html">Comment r√©ussir un cyber-test √† Checkpoint Partie 2</a></li>
<li><a href="../fr429116/index.html">Cr√©ez des images r√©actives</a></li>
<li><a href="../fr429118/index.html">Analyste d'a√©roport</a></li>
<li><a href="../fr429120/index.html">Java Challengers # 3: Polymorphisme et h√©ritage</a></li>
<li><a href="../fr429122/index.html">L'avenir proche de NetApp</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>