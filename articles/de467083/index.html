<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçü§ù‚Äçüë®üèº üìê üë®üèΩ‚Äçüè´ Wie die seltsame Popcount-Anweisung in modernen Prozessoren verwendet wird üìì ü§òüèº üßòüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist die Pseudodekodierung meiner Pr√§sentation auf der !! Con 2019 . 

 Die meisten heute verwendeten Prozessorarchitekturen verf√ºgen √ºber Anweisu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie die seltsame Popcount-Anweisung in modernen Prozessoren verwendet wird</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467083/"> <i>Dies ist die Pseudodekodierung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">meiner Pr√§sentation auf der !! Con 2019</a> .</i> <br><br>  Die meisten heute verwendeten Prozessorarchitekturen verf√ºgen √ºber Anweisungen namens <code>popcount</code> , kurz f√ºr "Population Count".  Sie macht Folgendes: Z√§hlt die Anzahl der in einem Maschinenwort gesetzten Bits.  Beispiel: Nehmen wir zur Vereinfachung 8-Bit-W√∂rter. <code>popcount(00100110)</code> ist 3 und <code>popcount(01100000)</code> ist 2. <br><br>  Es mag dich sehr √ºberraschen, genau wie ich, aber das ist alles, was sie tut!  Scheint nicht sehr hilfreich, oder? <br><a name="habracut"></a><br>  Ich dachte, dies sei eine neue Erg√§nzung zu einigen hyperspezialisierten Anwendungsf√§llen, aber es ist tats√§chlich seit mindestens 1961 in Prozessorarchitekturen vorhanden: <br><br><ul><li>  1961: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IBM Stretch</a> <br></li><li>  1964: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CDC 6000</a> <br></li><li>  1975: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cray-1</a> <br></li><li>  2005: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SPARC</a> <br></li><li>  2005: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ARM NEON</a> <br></li><li>  2007: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AMD K10</a> <br></li><li>  2008: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Intel Nehalem</a> </li></ul><br>  Also, was ist los? <br><h4>  NSA-Anweisung </h4><br>  <code>popcount</code> auch als "NSA-Anweisung" bekannt, und ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sehr interessanter Thread auf comp.arch</a> diskutiert seine Verwendung in der Kryptographie.  Ger√ºchten zufolge wurde es urspr√ºnglich auf Anfrage der NSA zum CPU-Befehlssatz hinzugef√ºgt.  Wie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem archivierten Mail-Thread angegeben</a> : <br><br><blockquote>  Es war fast Tradition, eines von jeder Charge schnellerer CDC-Autos an einen ‚Äûguten Kunden‚Äú zu senden - ein unbekannter LKW kam an und wurde nie wieder geh√∂rt. </blockquote><br>  Eine gro√üartige Legende, aber warum haben sie sie benutzt? <br><br>  Ein Ma√ü f√ºr den Inhalt ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hammings Gewicht</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dh</a> die Anzahl der Zeichen ungleich Null in einer Zeichenfolge.  F√ºr eine bin√§re Zeichenfolge ist dies <code>popcount</code> ! <br><br>  Wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier erl√§utert</a> , erforderte die NSA eine Kryptoanalyse abgefangener Nachrichten, und da der CDC 6000 mit 60-Bit-W√∂rtern arbeitete, reichte ein Wort aus, um die meisten Alphabete zu speichern, die sie interessierten.  Sie konnten: <br><br><ol><li>  Nachricht in Zeilen aufteilen <br></li><li>  Setzen Sie ein Bit f√ºr jedes eindeutige Zeichen in einer Zeichenfolge <br></li><li>  Verwenden Sie <code>popcount</code> um die Anzahl der verschiedenen Zeichen zu z√§hlen <br></li><li>  Verwenden Sie den Z√§hler als Hash f√ºr die weitere Kryptoanalyse </li></ol><br>  <code>popcount</code> scheint <code>popcount</code> zwischen Mitte der 1970er und Mitte der 2000er Jahre aus den Befehlss√§tzen verschwunden zu sein, daher sollte die R√ºckkehr durch etwas anderes als kryptografische Anwendungen erkl√§rt werden.  Wof√ºr kann es noch verwendet werden? <br><br><h4>  Fehlerbehebung </h4><br>  Das Konzept des Hamming-Gewichts bezieht sich auf den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hamming-Abstand</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dh</a> die Anzahl der verschiedenen Positionen zwischen zwei Linien gleicher L√§nge.  F√ºr zwei bin√§re Zeichenfolgen <code>x</code> und <code>y</code> ist dies nur <code>popcount</code> nach XOR.  Zum Beispiel: <br><br><pre>  00100110
 01100000 ^
 --------
 01000110<font></font>
<font></font>
 Popcount (01000110) = 3 </pre><br>  In Telekommunikationsanwendungen hilft dies bei der Berechnung der Signalentfernung, bei der ein bekanntes Wort entlang der Leitung √ºbertragen wird und die Anzahl der ge√§nderten Bits gez√§hlt wird, um den √úbertragungsfehler abzusch√§tzen. <br><br>  Dann k√∂nnen wir den entsprechenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehlerkorrekturcode</a> entwerfen.  Wenn eine √úbertragung beispielsweise bis zu zwei modifizierten Bits standhalten muss, sollten sich die Codew√∂rter in der Hamming-Entfernung um mindestens 5 unterscheiden. <br><br><h4>  Bin√§re Faltungs-Neuronale Netze </h4><br>  Und jetzt etwas ganz anderes: bin√§re Faltungs-Neuronale Netze!  Aber zuerst, was ist es? <br><br><ul><li>  Bin√§r bedeutet, dass wir im Gegensatz zu 32-Bit-Gleitkommawerten nur Matrizen mit den Werten +1 (als 1 codiert) und -1 (als 0 codiert) verwenden. <br></li><li>  Bedeutet Faltung Matrixmultiplikation? <br></li><li>  Neuronale Netze sind Systeme, die vom Gehirn von Tieren inspiriert sind (hier schwimme ich ein wenig). </li></ul><br>  Wir m√ºssen also die Multiplikation von Bin√§rmatrizen durchf√ºhren.  Aber was ist das Besondere an bin√§ren Matrizen? <br><br>  Die konventionelle Matrixmultiplikation mit 32-Bit-Werten eignet sich gut f√ºr Desktop-Computer mit leistungsstarken CPUs und GPUs. Immer h√§ufiger m√∂chten wir jedoch n√ºtzliche Arbeiten an kleinen und einfachen Ger√§ten wie Smartphones, Routern, Smartwatches usw. ausf√ºhren. Wir k√∂nnen diese zerlegen komplexere Matrizen f√ºr Schichten von Bin√§rmatrizen, und es ist so einfacher, mit ihnen zu arbeiten und sie zu speichern, dass wir trotz der Zunahme der Anzahl der Schichten davon profitieren. <br><br>  Hier kommt <code>popcount</code> ins Spiel.  Es wird verwendet, um das Skalarprodukt zweier bin√§rer Matrizen zu berechnen: <br><br><pre>  a = xnor (x, y)
 b = Popcount (a)
 c = len (a)
 Punkt (x, y) = 2 √ó b - c </pre><br>  Weitere Details finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br><h4>  Schachprogrammierung </h4><br>  Viele Schachprogramme speichern Daten in einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bitboard-</a> Darstellung, die bequem in ein 64-Bit-Wort passt.  Die Operation " <code>Population Count</code> wurde f√ºr sinnvolle Operationen mit dieser Ansicht verwendet, z. B. zur Berechnung der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mobilit√§t einer</a> Figur. <br><br><h4>  Molekularer Fingerabdruck </h4><br>  Dies h√§ngt auch mit der Hamming-Distanz zusammen: Die Molek√ºle werden irgendwie gehasht und verglichen (unter Verwendung von <code>popcount</code> ), um festzustellen, wie √§hnlich sie sind.  Weitere Details finden Sie hier. <br><br><h4>  Hash-Array-Mapping-Versuche (HAMT) </h4><br>  Hier habe ich zum ersten Mal etwas √ºber <code>popcount</code> gelernt!  HAMT ist eine Datenstruktur ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zuerst von Phil Bagwell erstellt</a> ), die eine sehr gro√üe Anzahl von Werten (normalerweise 32 oder 64) in einem Array auf jedem Trie-Knoten speichern kann.  Das Zuweisen von Speicher f√ºr ein Array mit 32 oder 64 Elementen kann jedoch jedes Mal unglaublich verschwenderisch sein, insbesondere wenn das Array tats√§chlich nur wenige Elemente enth√§lt.  Die L√∂sung besteht darin, eine Bitmaske hinzuzuf√ºgen, bei der die Anzahl der gesetzten Bits der Anzahl der Elemente im Array entspricht, wodurch das Array nach Bedarf wachsen und sich zusammenziehen kann.  Die Indexberechnung f√ºr ein bestimmtes Element kann effektiv mit <code>popcount</code> .  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">meinem Blogbeitrag</a> zur Implementierung von HAMT-Strukturen erfahren Sie mehr √ºber deren Funktionsweise. <br><br><h4>  Komprimierte Datenstrukturen </h4><br>  Dies ist ein aufregendes neues Forschungsgebiet, das sich darauf konzentriert, wie Daten auf kleinstem Raum gespeichert werden k√∂nnen, ohne sie f√ºr n√ºtzliche Arbeiten auszupacken.  Eine der Methoden besteht darin, in Arrays von Bits (Bitvektoren) zu denken, die in zwei Operationen angefordert werden k√∂nnen: <br><br><ul><li>  <code>rank(i)</code> z√§hlt die Anzahl der Bits, die bis zum i-ten Index im Bitvektor abgegeben wurden <br></li><li>  <code>select(i)</code> findet den Index, an dem das i-te Bit gesetzt ist </li></ul><br>  Um diese Operationen f√ºr gro√üe Bitvektoren effizient zu gestalten, m√ºssen Sie einen Index erstellen und effektiv verwenden, in beiden F√§llen mit <code>popcount</code> .  Hier ist eine gute √úbersicht √ºber den RRR-Index.  Und soweit ich das beurteilen kann, wird der fortschrittlichste moderne Ansatz im Artikel <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Platzsparende, leistungsstarke Rank &amp; Select-Strukturen f√ºr unkomprimierte Bitsequenzen beschrieben</a></i> . <br><br><h4>  Compiler-Optimierungen </h4><br>  <code>popcount</code> ist so weit verbreitet, dass sowohl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GCC</a> als auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Clang</a> es erkennen und durch eine integrierte Anweisung ersetzen k√∂nnen.  Stellen Sie sich diesen Clippy vor: "Oh, ich sehe, dass Sie versuchen, Popcount zu implementieren, lassen Sie mich rausgehen und es f√ºr Sie reparieren!"  Der entsprechende LLVM-Code ist <a href="">hier</a> .  Daniel Lemyr f√ºhrt es als Beispiel f√ºr den erstaunlichen Geist moderner Compiler an. <br><br><h4>  Fazit </h4><br>  Der zu Beginn seiner Geschichte geheimnisvolle Popcount-Befehl wurde √ºberall verwendet, obwohl er ein etwas ungew√∂hnlicher CPU-Befehl blieb.  Ich mag die Art und Weise, wie es so unterschiedliche Bereiche der Informatik verbindet, und ich frage mich, wie viele andere so seltsame Anweisungen existieren.  Wenn Sie Ihren eigenen Favoriten haben, w√ºrde ich gerne von ihr h√∂ren! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467083/">https://habr.com/ru/post/de467083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467063/index.html">Kraftstoff√ºberwachung f√ºr Dieselgeneratoren im Rechenzentrum - wie und warum ist das so wichtig?</a></li>
<li><a href="../de467065/index.html">Archiv der Olympiadenprobleme in der Physik f√ºr Sch√ºler</a></li>
<li><a href="../de467073/index.html">‚ÄûIm Westen gibt es keine Art Direktoren unter 40 Jahren. Bei uns kann es bis zu 30 sein. " Wie ist es, Designer in der IT zu sein?</a></li>
<li><a href="../de467079/index.html">CSS und Javascript Ant Carousel</a></li>
<li><a href="../de467081/index.html">Analyse der emotionalen F√§rbung von Rezensionen von Kinopoisk</a></li>
<li><a href="../de467085/index.html">C-, C ++ - und DotNet-Dekompilierung sind die Grundlagen der Umkehrung. L√∂sen von Problemen beim Umkehren mit r0ot-mi. Teil 1</a></li>
<li><a href="../de467087/index.html">Wie ich mich auf die Oracle Database SQL-Zertifizierung (1Z0-071) vorbereitet und diese bestanden habe</a></li>
<li><a href="../de467089/index.html">Patched Exim - Patch erneut. Neue Remote-Befehlsausf√ºhrung in Exim 4.92 in einer Anforderung</a></li>
<li><a href="../de467091/index.html">Eine kurze Einf√ºhrung in Svelte aus der Perspektive eines Angular-Entwicklers</a></li>
<li><a href="../de467093/index.html">Spionieren Sie Ihre Programme mit Strace aus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>