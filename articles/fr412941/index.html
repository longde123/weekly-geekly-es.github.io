<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úùÔ∏è üê™ üîµ Conf√©rence de l'Europe de l'Est de Java 2018: rapports et impressions üîç üóº üéµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publi√© par Igor Masternaya, D√©veloppeur principal, DataArt Java Community Leader 

 Du 18 au 19 mai, JEEonf s'est tenu √† Kiev, l'un des √©v√©nements les...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conf√©rence de l'Europe de l'Est de Java 2018: rapports et impressions</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/412941/"><img src="https://habrastorage.org/webt/yg/-q/5j/yg-q5j1vqjcwmaqigggiuqll1yk.jpeg"><br><br>  <i>Publi√© par Igor Masternaya, D√©veloppeur principal, DataArt Java Community Leader</i> <br><br>  Du 18 au 19 mai, JEEonf s'est tenu √† Kiev, l'un des √©v√©nements les plus attendus pour toute la communaut√© Java de l'Europe de l'Est.  DataArt s'est associ√© √† la conf√©rence.  Des intervenants du monde entier se sont exprim√©s sur quatre √©tapes: Volker Simonis, repr√©sentant SAP chez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JCP</a> et contributeur OpenJDK, J√ºrgen H√∂ller, ing√©nieur en chef Pivotal, p√®re de la bien-aim√©e Spring Framework, Klaus Ibsen, cr√©ateur d'Apache Camel, et Hugh McKee, √©vang√©liste chez Lightbend. <br><br>  Le programme √©tait tr√®s charg√©: en deux jours plus de 50 repr√©sentations, 45 minutes chacune.  Pause de 10 minutes - et ex√©cutez un nouveau rapport.  Il faudra beaucoup de temps pour regarder toutes les vid√©os lorsqu'elles apparaissent sur le r√©seau.  Je d√©crirai donc bri√®vement les rapports que j'ai trouv√©s les plus int√©ressants et que j'ai visit√©s personnellement. <a name="habracut"></a><br><br><h3>  15 ans de printemps </h3><br>  La conf√©rence a √©t√© ouverte par J√ºrgen H√∂ller.  Il a parl√© de l'histoire de Spring Framework pendant 15 ans (!), Des configurations XML ¬´pr√©f√©r√©es¬ª dans la version 0.9 au Spring WebFlux r√©actif, issu de projets de recherche influenc√©s par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reactive Manifesto</a> .  J√ºrgen a parl√© de la coexistence de Spring MVC et Spring WebFlux dans Spring WEB, a expliqu√© pourquoi ils ont d√©cid√© de ne pas les int√©grer en un seul.  Le fait est que l'abstraction principale de Spring MVC est l'API Servlet 3.0 et le blocage des E / S, tandis que Spring WebFlux utilise l'abstraction des flux r√©actifs et des E / S non bloquantes.  Vous pouvez ex√©cuter votre service sur SpringWebFlux sur n'importe quel serveur prenant en charge les E / S non bloquantes: Netty, nouvelles versions de Tomcat (&gt; 8.5), Jetty.  La cr√©ation de contr√¥leurs WebFlux r√©actifs n'est pas tr√®s diff√©rente de leur cr√©ation √† l'aide de Spring MVC, mais il existe encore des diff√©rences.  En traitant une demande utilisateur, le contr√¥leur r√©actif ne la traite pas dans le sens habituel, mais cr√©e un pipeline pour traiter la demande.  Dispatcher appelle la m√©thode du contr√¥leur, qui cr√©e un pipeline et le donne imm√©diatement en tant que flux d'√©diteur.  Le flux de l'√©diteur dans Reactive Spring est pr√©sent√© sous la forme de deux abstractions: Flux / Mono.  Flux renvoie un flux d'objets, tandis que Mono renvoie toujours un seul objet. <br><br>  J√ºrgen a √©galement mentionn√© la commodit√© d'utiliser le style Java 8 lorsque vous travaillez avec Spring 5.0 et a promis une version candidate Spring 5.1 en juillet 2018 et une version en septembre, qui prendront en charge Java 11 et travailleront sur le r√©glage fin des nouvelles fonctionnalit√©s de Spring 5.0. <br><br><h3>  Int√©gration Python / Java </h3><br>  Il y avait beaucoup de rapports, et choisir le plus int√©ressant dans le cr√©neau suivant √©tait difficile.  Les descriptions √©taient tout aussi int√©ressantes, alors j'ai fait confiance √† mon instinct et j'ai d√©cid√© d'√©couter Tamas Rozman, le vice-pr√©sident de BlackRock de Hongrie.  Mais il vaudrait mieux que j'√©coute √† nouveau sur Events Sourcing et CQRS.  √Ä en juger par la description, la soci√©t√© est engag√©e dans la science des donn√©es pour un grand fonds d'investissement.  L'objectif du rapport √©tait de montrer comment ils ont cr√©√© un syst√®me √©volutif et stable, tout aussi pratique pour les analystes de donn√©es avec leur Python que pour les d√©veloppeurs Java du syst√®me principal.  Cependant, il me semblait douteux que le syst√®me construit se soit av√©r√© vraiment pratique.  Pour se lier d'amiti√© avec Python et Java, les ing√©nieurs de BlackRock ont ‚Äã‚Äãeu l'id√©e de d√©marrer un interpr√©teur Python en tant que processus √† partir d'une application Java.  Ils y sont arriv√©s pour plusieurs raisons: <br><ul><li>  Jython (Python sur la JVM) ne convenait pas en raison de la base de code obsol√®te 2.7 vs CPython 3.6. </li><li>  Ils ont consid√©r√© l'option de r√©√©crire la logique de la Data Science en Java comme un processus trop long. </li><li>  Apache Spark a d√©cid√© de ne pas l'accepter, car, comme l'a expliqu√© le conf√©rencier, vous ne pouvez pas m√©langer des charges de travail √©crites en Java et en Python.  Bien qu'il ne soit pas clair pourquoi UDF et UDFA ne correspondaient pas [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2</a> ].  De plus, Spark ne convenait pas, car ils avaient d√©j√† une sorte de cadre de travail et ils ne voulaient pas vraiment en introduire un nouveau.  Et, en fin de compte, ils n'ont pas non plus de Big Data, et tout le traitement se r√©sume √† des statistiques sur des fichiers path√©tiques de 100 Mo. </li></ul><br><br>  La communication de Java avec le processus Python a √©t√© organis√©e √† l'aide de fichiers mapp√©s en m√©moire (un fichier est utilis√© comme fichier de donn√©es d'entr√©e) et de commandes (le deuxi√®me fichier est la sortie du processus Python).  Ainsi, la communication √©tait quelque chose sous la forme de: <br><br><pre>  Java: calcExr |  1 + javaFunc (sqrt (36))
 Python: 1 + javaFunct | 6
 Java: 1 + succ√®s | 64
 Python: succ√®s |  65 </pre><br><br>  Les principaux probl√®mes d'une telle int√©gration, Tamas a appel√© la surcharge lors de la s√©rialisation et la d√©s√©rialisation des param√®tres d'entr√©e / sortie. <br><br><img src="https://habrastorage.org/webt/zz/l9/vt/zzl9vtuqxaff5kn7rvdqtpgsbey.jpeg"><br><br><h3>  Java 10 App CDS </h3><br>  Apr√®s une pr√©sentation sur les subtilit√©s de l'ex√©cution de Python, je voulais vraiment √©couter quelque chose de profond√©ment technique du monde Java.  Je suis donc all√© au rapport de Volker Simonis, dans lequel il a parl√© de la fonction de partage de donn√©es de classe Application de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Java 10+</a> .  Dans le monde moderne construit sur des microservices dans Docker, la possibilit√© de partager Java Codecache et Metaspace acc√©l√®re le lancement de l'application et √©conomise de la m√©moire.  L'image montre les r√©sultats du lancement de tomates dock√©es avec une archive partag√©e / partag√©e des classes Tomcat.  Comme vous pouvez le voir, pour le deuxi√®me processus, certaines pages en m√©moire sont d√©j√† marqu√©es comme shared_clean - ce qui signifie que le processus actuel et au moins un (le deuxi√®me tomcat en cours d'ex√©cution) s'y r√©f√®rent. <br><br><img src="https://habrastorage.org/webt/4b/wf/hc/4bwfhctgsicnp_ulp-r0fo08opm.png"><br><br>  Les d√©tails sur la fa√ßon de jouer avec CDS dans OpenJDK 10 peuvent √™tre trouv√©s sur: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">App CDS</a> .  En plus de diviser les classes d'applications entre les processus, il est pr√©vu √† l'avenir de partager les cha√Ænes internes dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JEP-250</a> . <br>  Principales limitations d'AppCDS: <br><br>  Ne fonctionne pas avec des classes jusqu'√† 1,5. <br><ul><li>  Vous ne pouvez pas utiliser des classes charg√©es √† partir de fichiers (uniquement les archives .jar). </li><li>  Les classes modifi√©es par le chargeur de classe ne peuvent pas √™tre utilis√©es. </li><li>  Les classes charg√©es par plusieurs chargeurs de classe ne peuvent √™tre r√©utilis√©es qu'une seule fois. </li><li>  La r√©√©criture de code octet ne fonctionne pas, ce qui peut entra√Æner une baisse des performances allant jusqu'√† 2%.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JDK-8074345</a> </li></ul><br><br><img src="https://habrastorage.org/webt/ql/id/ll/qlidll3gw8_b91uclq8onav6s3g.jpeg"><br><br><h3>  Pipeline de traitement du langage naturel avec Apache Spark </h3><br>  Le rapport sur la PNL et Apache Spark a √©t√© pr√©sent√© par Vitaliy Kotlyarenko - ing√©nieur de Grammarly.  Vitaliy a montr√© comment le prototype NLP-Jobs Grammarly sur Apache Zeppelin.  Un exemple a √©t√© la construction d'un pipeline simple pour la mod√©lisation th√©matique bas√©e sur l'algorithme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LDA</a> de l'archive Internet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">crawl commune</a> .  Les r√©sultats de la mod√©lisation des sujets ont √©t√© utilis√©s pour filtrer les sites avec un contenu inappropri√© comme exemple de la fonction de contr√¥le parental.  Pour cr√©er le pipeline, nous avons utilis√© des scripts Terraform et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AWS EMR</a> Spark cluster, qui vous permettent de d√©ployer Spark Cluster avec YARN sur Amazon.  Sch√©matiquement, le pipeline ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/p6/m7/wp/p6m7wpmj43z9dyesvyjfptjf3z4.png"><br><br>  L'objectif du rapport √©tait de montrer que l'utilisation de cadres modernes pour cr√©er un prototype pour les t√¢ches ML est assez simple, cependant, en utilisant des biblioth√®ques standard, vous rencontrez toujours des difficult√©s.  Par exemple: <br><ul><li>  Lors de la premi√®re √©tape de lecture des fichiers WARC √† l'aide de la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HadoopInputFormat</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IllegalStateExceptions</a> s'est parfois <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bloqu√© en</a> raison d'en-t√™tes de fichier incorrects, la biblioth√®que a d√ª √™tre r√©√©crite et les fichiers incorrects ignor√©s. </li><li>  Les d√©pendances sur la goyave - la biblioth√®que de d√©finitions de langage - se heurtaient aux d√©pendances que Spark tra√Æne sur lui-m√™me.  Java 8 a aid√©, avec l'aide duquel il √©tait possible de jeter des d√©pendances sur la goyave dans la biblioth√®que utilis√©e. </li></ul><br><br>  Au cours de la d√©monstration, nous avons surveill√© l'ex√©cution du travail √† l'aide de l'interface utilisateur Spark standard et du sous-syst√®me de surveillance <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ganglia</a> , qui est automatiquement disponible lors du d√©ploiement sur AWS EMR.  L'auteur s'est concentr√© sur la carte thermique Server Load Distribution, qui montre la r√©partition de la charge entre les n≈ìuds du cluster, et a donn√© des conseils g√©n√©raux sur l'optimisation du travail de Spark Job: augmentation du nombre de partitions, optimisation de la s√©rialisation des donn√©es, analyse des journaux GC.  Vous pouvez en savoir plus sur l'optimisation des travaux Spark <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Les fichiers source de la d√©mo se trouvent dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github de l'</a> auteur du rapport. <br><br><h3>  Graal, Truffle, SubstrateVM et autres avantages: quels sont-ils et pourquoi en avez-vous besoin </h3><br>  Le plus attendu pour moi √©tait un rapport d'Oleg Chirukhin de JUG.ru.  Il a expliqu√© comment optimiser le code fini √† l'aide du Graal.  Qu'est-ce que le Graal?  The Grail est une marque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Oracle Labs</a> qui combine le compilateur JIT (juste √† temps), le cadre pour l'√©criture de langages DSL - Truffle - et la JVM sp√©ciale ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SubstrateVM</a> ) - une machine virtuelle universelle <a href="">√† monde ferm√©</a> pour laquelle vous pouvez √©crire en JavaScript, Rubis, Python, Java, Scala.  Le rapport s'est concentr√© sur le compilateur JIT et ses tests en production. <br><br>  Tout d'abord, rappelez le processus d'ex√©cution du code par la machine Java et notez que Java poss√®de d√©j√† deux compilateurs: C1 (compilateur client) et C2 (compilateur serveur).  Grail peut √™tre utilis√© comme compilateur C2. <br><br><img src="https://habrastorage.org/webt/3k/qk/lt/3kqklt1q02gtnej89a0wa2ttou0.png"><br><br>  Lorsqu'on lui a demand√© pourquoi nous avions besoin d'un autre compilateur, l'un des employ√©s d'Oracle Labs, le Dr Chris Seaton, a tr√®s bien r√©pondu dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comprendre le fonctionnement de Graal</a> .  En bref, l'id√©e originale du projet Graal, ainsi que du projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Metropolis</a> , est de r√©√©crire des parties du code JVM √©crit en C ++ en Java.  Cela permettra √† l'avenir de compl√©ter commod√©ment le code.  Par exemple, l'une des optimisations - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Analyse d'√©vasion sp√©ciale</a> - est d√©j√† dans le Graal, mais pas dans Hotspot - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">car d√©velopper le code Graal est beaucoup plus facile que le code C2</a> . <br><br>  Cela semble g√©nial, mais comment cela fonctionnera-t-il dans la pratique dans mon projet, demandez-vous?  Graal convient aux projets: <br><br><ul><li>  Ce qui jette beaucoup, cr√©ant beaucoup de petits objets. </li><li>  √âcrit dans le style de Java 8, avec un tas de ruisseaux et de lambdas. </li><li>  Utilisation de diff√©rents langages: Ruby, Java, R. </li></ul><br><br>  L'un des premiers en production, le Graal a commenc√© √† √™tre utilis√© sur Twitter.  Vous pouvez en savoir plus √† ce sujet dans une interview avec Christian Talinger, publi√©e sur Habr√© ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">interview_1</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">interview_2</a> ).  L√†, il explique qu'en rempla√ßant C2 par Graal, Twitter a commenc√© √† √©conomiser environ 8% de l'utilisation du processeur, ce qui est assez bon compte tenu de la taille de l'organisation. <br><br>  Lors de la conf√©rence, nous avons √©galement pu v√©rifier la vitesse de Graal en lan√ßant l'une des r√©f√©rences Scala en dessous - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scala DaCapo</a> .  En cons√©quence, sur Graal, l'indice de r√©f√©rence est pass√© en ~ 7000 ms, et sur une JVM r√©guli√®re en ~ 14000 ms!  Pourquoi cela est arriv√©, vous pouvez le voir en regardant les tests gclog.  Le nombre d'√©chec d'allocation lors de l'utilisation de Graal est nettement inf√©rieur √† celui de Hotspot.  Cependant, vous ne pouvez toujours pas dire que le Graal sera la solution aux probl√®mes de performances de votre application Java.  Oleg a √©galement montr√© une histoire d'√©chec dans son rapport, comparant le travail d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apache Ignite</a> sous le Graal et sans lui - il n'y a eu aucun changement de performance notable. <br><br><img src="https://habrastorage.org/webt/wg/a9/9i/wga99iykqcg8ubellwz6_upyy9o.jpeg"><br><br><h3>  Conception de microservices tol√©rants aux pannes </h3><br>  Un autre rapport sur l'architecture de microservice √† s√©curit√© int√©gr√©e a √©t√© lu par Orkhan Gasimov d'AppsFlyer.  Il a introduit des mod√®les de conception populaires pour la cr√©ation d'applications distribu√©es.  Nous en connaissons peut-√™tre beaucoup, mais se promener et se souvenir de chacun d'eux ne fera pas de mal du tout. <br><br>  Les principaux probl√®mes de tol√©rance aux pannes des services avec lesquels les sch√©mas d√©crits dans le rapport sont appel√©s √† lutter sont: le r√©seau, les charges de pointe, les m√©canismes RPC de communication entre les services. <br>  Pour r√©soudre les probl√®mes avec le r√©seau, lorsque l'un des services n'est plus disponible, nous devons pouvoir le remplacer rapidement par un autre du m√™me.  En pratique, cela peut √™tre r√©alis√© avec plusieurs instances du m√™me service et une description des chemins alternatifs vers ces instances, qui est un mod√®le de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©couverte de service</a> .  S'engager dans des services de <b>pulsation</b> et enregistrer de nouveaux services sera une instance distincte - Service Registry.  Il est de coutume d'utiliser le c√©l√®bre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gardien de zoo</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consul</a> comme registre de service.  Qui, √† leur tour, ont √©galement une nature distribu√©e et un support pour la tol√©rance aux pannes. <br><br>  Apr√®s avoir r√©solu les probl√®mes de r√©seau, nous nous tournons vers le probl√®me des pics de charge lorsque certains services sont en charge et traitent les demandes beaucoup plus lentement qu'en mode normal.  Pour le r√©soudre, vous pouvez utiliser le mod√®le de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mise</a> √† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©chelle automatique</a> .  Il assumera non seulement la t√¢che de faire √©voluer automatiquement les services fortement charg√©s, mais arr√™tera √©galement les instances apr√®s la p√©riode de charge de pointe. <br><br>  Le dernier chapitre du rapport de l'auteur √©tait une description des probl√®mes possibles de communication interne RPC interservices.  Urahan a accord√© une attention particuli√®re √† la th√®se "L'utilisateur ne devrait pas attendre un message d'erreur pendant longtemps."  Une telle situation peut se produire si sa demande est trait√©e par la cha√Æne de service et que le probl√®me se situe en bout de cha√Æne: en cons√©quence, l'utilisateur peut attendre que la demande soit trait√©e par chacun des services de la cha√Æne et ne re√ßoit une erreur qu'√† la derni√®re √©tape.  Pire encore, si le service final est surcharg√© et apr√®s une longue attente, le client recevra une erreur HTTP-ERROR: 500. <br><br>  Pour lutter contre de telles situations, vous pouvez utiliser <b>Timeout</b> s, cependant, les requ√™tes qui peuvent toujours √™tre trait√©es correctement peuvent tomber dans le timeout.  Pour ce faire, la logique de temporisation peut √™tre compliqu√©e et une valeur de seuil sp√©ciale pour le nombre d'erreurs de service par intervalle de temps peut √™tre ajout√©e.  Lorsque le nombre d'erreurs d√©passe la valeur seuil, nous comprenons que le service est sous charge et le consid√©rons comme indisponible, ce qui lui donne le temps n√©cessaire pour faire face aux t√¢ches en cours.  Cette approche d√©crit le mod√®le de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">disjoncteur</a> .  Vous pouvez √©galement utiliser CircuitBreaker.html "&gt; Circuit Beaker comme mesure suppl√©mentaire pour la surveillance, ce qui vous permet de r√©pondre rapidement aux probl√®mes possibles et d'identifier clairement les cha√Ænes de service qui les rencontrent. Pour ce faire, chaque appel de service doit √™tre encapsul√© dans Circuit Breaker. <br><br>  Toujours dans le rapport, l'auteur a rappel√© le mod√®le de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">redondance N-Modular</a> , con√ßu pour "traiter les demandes plus rapidement si possible", et a fourni un bel exemple de son utilisation pour valider l'adresse d'un client.  La demande dans leur syst√®me via le cache d'adresses a √©t√© envoy√©e imm√©diatement √† plusieurs fournisseurs de Geo Map, ce qui a remport√© la r√©ponse la plus rapide. <br><br>  En plus des mod√®les d√©crits, les √©l√©ments suivants ont √©t√© mentionn√©s: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mod√®le <b>Fast Path</b></a> , qui peut √™tre appliqu√©, par exemple, lors de la mise en cache des r√©sultats de requ√™te.  L'acc√®s au cache est alors un chemin rapide. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mod√®le de <b>noyau d'erreur</b></a> - un mod√®le du monde d'Akka qui implique de diviser une t√¢che en sous-t√¢ches et de d√©l√©guer des sous-t√¢ches aux acteurs en aval.  De cette fa√ßon, la flexibilit√© de gestion des erreurs d'ex√©cution de sous-t√¢che est obtenue. </li><li>  <b>Instance Healer</b> , qui suppose l'existence d'un service sp√©cial - un superviseur qui g√®re d'autres services et r√©pond aux changements de leur √©tat.  Par exemple, en cas d'erreur dans le service, le superviseur peut red√©marrer le service probl√©matique. </li></ul><br><br><img src="https://habrastorage.org/webt/am/ik/kr/amikkrgoxhuaajndqk1zgfhv12u.jpeg"><br><br><h3>  Sourcing d'√©v√©nements en cluster et CQRS avec Akka et Java </h3><br>  Le dernier rapport sur lequel je veux attirer votre attention a √©t√© lu par l'un des √©vang√©listes et architectes Lightbend Hugh McKee.  Lightbend (anciennement Typesafe) est quelque chose comme Oracle, mais pour le langage Scala.  La soci√©t√© d√©veloppe √©galement activement le cadre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Akka.io.</a>  Dans un rapport, Hugh a parl√© de la mise en ≈ìuvre de l'approche populaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CQRS</a> (Command Query Responsibility Commands / SEGREGATION) sur le cadre Akka.  Sch√©matiquement, l'architecture du syst√®me CQRS ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/n-/jy/in/n-jyin0xfhmrsqxlixxwh478ot0.png"><br><br>  Hugh a pris un prototype de banque comme exemple de syst√®me fonctionnel.  Un client dans l'architecture CQRS effectue deux op√©rations: requ√™te, commande.  Chaque √©quipe (par exemple, une transaction bancaire transf√©rant de l'argent d'un compte √† un autre) g√©n√®re un √©v√©nement (un fait accompli) qui sera enregistr√© dans l'EventStore (par exemple: Cassandra).  L'agr√©gation de la cha√Æne (d√©p√¥t d'argent sur un compte, transfert de compte √† compte, retrait √† un guichet automatique) d'√©v√©nements forme l'√©tat actuel du client, son solde d'argent sur le compte.  Les demandes pour l'√©tat actuel vont √† un r√©f√©rentiel s√©par√©, un instantan√© du r√©f√©rentiel d'√©v√©nements, car il est inutile de conserver un historique complet d'un compte bancaire.  Il suffit de mettre √† jour p√©riodiquement le statut cast pour chaque utilisateur. <br><br>  Cette approche permet de r√©cup√©rer automatiquement lorsque des erreurs se produisent: pour cela, nous devons obtenir la derni√®re distribution de l'√©tat de l'utilisateur et lui appliquer tous les √©v√©nements qui se sont produits avant que l'erreur ne se produise.  En raison de la pr√©sence de deux stockages, l'architecture CQRS tol√®re bien les charges de pointe (pointes) √©mergentes.  Un grand nombre d'√©v√©nements chargera le magasin d'√©v√©nements, mais n'affectera pas le magasin de lecture, et les utilisateurs pourront toujours r√©pondre aux requ√™tes dans la base de donn√©es. <br><br>  Revenons au prototypage du syst√®me bancaire sur Akka et CQRS.  Chaque client de la banque / compte / √©quipe √©ventuelle du syst√®me sera repr√©sent√© par un (!) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Acteur</a> .  Une grande banque peut prendre en charge des centaines de milliers de comptes, et cela ne sera pas un probl√®me pour Akka.  La structure pr√™te √† l'emploi prend en charge le clustering et peut √™tre ex√©cut√©e sur des centaines de machines virtuelles Java.  Si l'une des machines du cluster tombe en panne, Akka fournit des m√©canismes sp√©ciaux qui r√©pondent automatiquement √† de telles situations: dans notre cas, l'acteur du client peut √™tre recr√©√© √† nouveau sur n'importe quelle machine disponible dans le cluster, et son √©tat sera relu √† partir du r√©f√©rentiel. <br><br>  Un thread s√©par√© n'est pas cr√©√© pour un acteur - cela permet de prendre en charge des dizaines de milliers d'acteurs au sein d'une m√™me machine virtuelle Java.  Dans le m√™me temps, l'acteur garantit que chaque demande sera trait√©e s√©par√©ment (!) Dans l'ordre de r√©ception des demandes.  Cette garantie √©limine automatiquement les √©ventuelles conditions de concurrence lors du traitement des demandes.  Vous pouvez comprendre le prototype du syst√®me plus en d√©tail en ouvrant son code √† l'aide des liens dans GitHub.  Chaque sous-projet montre la mise en ≈ìuvre des √©tapes les plus complexes de la construction d'un prototype: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les acteurs distribu√©s akka clustering</a> est un exemple simple de cr√©ation d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Akka cluster '</a> a. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Akka cluster singleton</a> montre comment impl√©menter un mod√®le singleton dans un environnement Akka distribu√©. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partage distribu√© d'entit√©s Le partage de cluster akka</a> est un exemple de gestion de la distribution d'entit√©s dans un cluster et du routage des demandes des clients. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CQRS - Write side akka persistence</a> - enregistre les √©v√©nements dans le r√©f√©rentiel. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CQRS - Requ√™te de persistance akka c√¥t√© lecture</a> - traitement des demandes des clients </li></ul>  gu√™pes. <br><br>  Les enregistrements de tous les rapports appara√Ætront en ligne dans quelques semaines.  J'esp√®re que cet article vous aidera √† d√©terminer l'ordre de visionnage, d'autant plus que je pense qu'il vaut la peine de regarder les performances. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412941/">https://habr.com/ru/post/fr412941/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412927/index.html">Que voir le week-end: 5 films sur les hackers</a></li>
<li><a href="../fr412929/index.html">Fintech digest: les lois approuv√©es par la DG sur les crypto-monnaies ne sont pas coh√©rentes avec les experts, les solutions fintech deviennent plus populaires</a></li>
<li><a href="../fr412933/index.html">Tesla a partiellement ouvert le code source du mod√®le S / X 2018.12</a></li>
<li><a href="../fr412937/index.html">Piratage de d√©monstration: PenTest Show montrera √† quel point il est facile de pirater le r√©seau du bureau et les syst√®mes de s√©curit√© pour voler quoi que ce soit</a></li>
<li><a href="../fr412939/index.html">Testeurs contre les tests</a></li>
<li><a href="../fr412945/index.html">Gestionnaires de d√©pendance</a></li>
<li><a href="../fr412947/index.html">Test de charge dans le cloud Azure. Comment tester une grande boutique en ligne dans des conditions proches de la r√©alit√©?</a></li>
<li><a href="../fr412949/index.html">Les astrologues annoncent une semaine de d√©veloppement iOS dans Avito</a></li>
<li><a href="../fr412951/index.html">DotVVM - Communication entre client et serveur</a></li>
<li><a href="../fr412953/index.html">√âtalonnage de la cam√©ra Intel RealSense d435 √† l'aide d'OpenCV2 et de ROS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>