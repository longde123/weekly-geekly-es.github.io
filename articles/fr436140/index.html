<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥕 😳 👨🏽‍🎓 «Sous le capot» du stockage Huawei: les technologies propriétaires et ce que les autres n'ont pas 🥐 😲 👨🏽‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La majorité des systèmes de stockage disponibles sur le marché ne sont pas très différents les uns des autres, car de nombreux fournisseurs commandent...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>«Sous le capot» du stockage Huawei: les technologies propriétaires et ce que les autres n'ont pas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/huawei/blog/436140/">  La majorité des systèmes de stockage disponibles sur le marché ne sont pas très différents les uns des autres, car de nombreux fournisseurs commandent des équipements auprès des mêmes fabricants d'ODM.  Nous avons presque tout ce qui nous est propre, du châssis aux contrôleurs, en passant par les technologies telles que RAID 2.0+ et les logiciels. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/322/998/10b/32299810bc9bd9ada307791b87ed4399.jpg"><br><br>  Sous la coupe, il y a quelques détails sur ce qui pourrait être si inhabituel dans chacun des nœuds du système de stockage de données. <br><a name="habracut"></a><br><h2>  Ce qui est intéressant au niveau du module </h2><br>  Structurellement, tous les systèmes de stockage modernes de n'importe quel fabricant se ressemblent: les contrôleurs sont installés à l'avant du châssis du boîtier en acier et les modules d'interface à l'arrière.  Il y a aussi des alimentations et une ventilation.  Il semblerait que tout soit familier et standard.  Mais en fait, nous avons introduit beaucoup de choses intéressantes dans ce paradigme. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba1/c23/fa6/ba1c23fa68f9c8598b0834d1ccddeeb4.png"><br><br>  Commençons par monter les éléments du système de stockage dans le châssis.  Il y a moins de lecteurs magnétiques de 3,5 pouces dans le système de stockage; les systèmes hybrides et tout flash commencent à dominer.  Mais même plusieurs disques durs avec une vitesse de rotation pouvant atteindre 15 000 tours par minute créent une vibration qui ne peut être ignorée.  Nous avons développé un ensemble de recommandations pour ce cas - comment répartir les lecteurs magnétiques avec différents paramètres entre les étagères de disques. <br><br>  Même à une fraction de pour cent, mais cela affecte la fiabilité.  Et à l'échelle d'un grand centre de données, les pourcentages par lecteur se transforment en indicateurs tangibles de pannes et de dysfonctionnements.  Pour garantir que les vibrations des disques individuels soient moins transmises à travers la structure rigide du châssis, nous équipons les disques sous les disques d'amortisseurs en caoutchouc ou en métal.  Pour neutraliser une autre source de vibration dans le système de stockage - les modules de ventilation - nous mettons des ventilateurs bidirectionnels et isolons tous les éléments rotatifs du châssis. <br><br>  Pour les entraînements de broche, un tremblement minimal est déjà un problème: les têtes commencent à s'égarer, les performances chutent considérablement.  Les SSD sont une autre affaire, ils n'ont pas peur des vibrations.  Mais la fixation sécurisée des composants est toujours importante.  Prenez le processus de livraison: la boîte peut être lâchée ou jetée avec désinvolture, mise de côté ou à l'envers.  Par conséquent, nous avons tous les composants du système de stockage qui sont fixés strictement en trois dimensions.  Cela élimine la possibilité de leur déplacement pendant le transport, protège les connecteurs de sauter hors des prises en cas de choc accidentel. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/222/452/b71/222452b713906c3b059a782df1df8778.png"><br><br>  Il était une fois, nous avons commencé avec le développement de la technologie informatique pour l'industrie des télécommunications, où les normes d'opérabilité en température et en humidité sont traditionnellement élevées.  Et nous les avons déplacés dans d'autres directions: les parties métalliques des systèmes de stockage ne s'oxydent pas même à une humidité élevée - en raison de l'utilisation du nickelage et de la galvanisation. <br><br>  La conception thermique de nos systèmes de stockage a été développée en mettant l'accent sur la distribution uniforme de la température à travers le châssis - pour éviter une surchauffe ou un refroidissement trop important de n'importe quel coin de l'étagère à disques.  Sinon, la déformation physique ne peut pas être évitée - même si elle est insignifiante, mais viole toujours la géométrie et peut raccourcir la durée de vie de l'équipement.  Ainsi, certaines fractions d'un pour cent sont gagnées, mais cela affecte toujours la fiabilité globale du système. <br><br><h2>  Les subtilités des semi-conducteurs </h2><br>  Nous dupliquons les composants importants des systèmes de stockage: en cas de défaillance, il existe toujours un filet de sécurité.  Par exemple, les modules de puissance pour les modèles plus jeunes fonctionnent selon le schéma 1 + 1, pour les plus solides - 2 + 1 et même 3 + 1. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6a6/205/63c/6a620563cf83f69d7107cf71c734045a.png"><br><br>  Les contrôleurs, dont il y a au moins deux dans le système de stockage (nous ne fournissons pas de systèmes à contrôleur unique) sont également réservés.  Dans le système de stockage de la série 6800e et plus ancienne, la redondance est effectuée selon le schéma 3 + 1, dans les modèles plus jeunes - 1 + 1. <br><br>  Même une carte de gestion est réservée, ce qui n'affecte pas directement le fonctionnement du système, mais n'est nécessaire que pour les changements de configuration et la surveillance.  De plus, toutes les cartes d'extension d'interface pour les systèmes de stockage sont vendues par paires uniquement, de sorte que le client dispose d'une réserve. <br><br>  Tous les composants - blocs d'alimentation, ventilateurs, contrôleurs, modules de gestion, etc.  - équipé de microcontrôleurs capables de répondre à certaines situations.  Par exemple, si le ventilateur commence à ralentir de lui-même, une alarme est envoyée au module de contrôle.  En conséquence, le client a une image complète de l'état du système de stockage - et, si nécessaire, peut remplacer certains composants par lui-même, sans attendre l'arrivée de notre ingénieur de service.  Et si la politique de sécurité du client le permet, nous configurons les contrôleurs afin qu'ils transmettent des informations sur l'état du fer à repasser à notre support technique. <br><br><h2>  Ses puces sont meilleures et plus compréhensibles. </h2><br>  Nous sommes la seule entreprise à développer ses propres processeurs, puces et contrôleurs de disques SSD pour ses systèmes de stockage. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b7/4b5/cd7/3b74b5cd764590f64381ddedac4e61f4.png"><br><br>  Ainsi, dans certains modèles en tant que processeur principal du système de stockage (puce de contrôleur de stockage), nous n'utilisons pas le classique Intel x86, mais le processeur ARM de HiSilicon, notre filiale.  Le fait est que l'architecture ARM en stockage - pour calculer le même RAID et la même déduplication - se montre mieux que le x86 standard. <br><br>  Notre fierté particulière est les puces pour les contrôleurs SSD.  Et si nos serveurs peuvent être équipés de disques semi-conducteurs tiers (Intel, Samsung, Toshiba, etc.), dans les systèmes de stockage de données, nous installons uniquement des SSD de notre propre conception. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d0/50d/072/3d050d0726471a2fd88d4bb12df5d001.png"><br><br>  Le microcontrôleur du module d'entrée-sortie (puce d'E / S intelligente) dans les systèmes de stockage est également un développement HiSilicon, ainsi que la puce de gestion intelligente pour la gestion du stockage à distance.  L'utilisation de nos propres puces nous aide à mieux comprendre ce qui se passe à chaque instant dans le temps avec chaque cellule de mémoire.  C'est ce qui nous a permis de minimiser les retards lors de l'accès aux données dans les mêmes systèmes de stockage Dorado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc4/d92/d3e/bc4d92d3ecad08047aff3dff031ecdab.png"><br><br>  Pour les disques magnétiques, la surveillance continue est extrêmement importante en termes de fiabilité.  Nos systèmes de stockage prennent en charge le DHA (Disk Health Analyzer): le disque lui-même enregistre en continu ce qui lui arrive, comment il se sent.  Grâce à l'accumulation de statistiques et à la construction de modèles prédictifs intelligents, il est possible de prédire la transition du lecteur vers un état critique en 2-3 mois, et non en 5-10 jours.  Le disque est toujours «actif», les données qu'il contient sont totalement sécurisées - mais le client est prêt à le remplacer dès les premiers signes d'une éventuelle défaillance. <br><br><h2>  RAID 2.0+ </h2><br>  Conception à sécurité intégrée dans les systèmes de stockage, nous avons pensé au niveau du système.  Notre technologie Smart Matrix est un complément au dessus de PCIe - ce bus, sur la base duquel les connexions intercontrôleurs sont implémentées, est particulièrement adapté aux SSD. <br><img src="https://habrastorage.org/getpro/habr/post_images/698/6b6/77b/6986b677b32270689efb4227ac50c0ba.png"><br><br>  Smart Matrix fournit, en particulier, le maillage complet à 4 contrôleurs de notre stockage Ocean Store 6800 v5.  Afin que chaque contrôleur ait accès à tous les disques du système, nous avons développé un backend SAS spécial.  Le cache, bien sûr, est mis en miroir entre tous les contrôleurs actuellement actifs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65c/8d3/02d/65c8d302d80df3ddb29db0875e6df968.png"><br><br>  Lorsque le contrôleur tombe en panne, les services de celui-ci basculent rapidement vers le contrôleur miroir et les contrôleurs restants restaurent la relation pour se refléter.  Dans le même temps, les données enregistrées dans le cache ont une réserve de miroir pour garantir la fiabilité du système. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/584/b22/f68/584b22f687f063043728ab0db9ed8392.png"><br><br>  Le système résiste à la défaillance de trois contrôleurs.  Comme le montre la figure, si le contrôle A échoue, les données de cache du contrôleur B sélectionneront le contrôleur C ou D pour refléter le cache.  En cas de défaillance du contrôleur D, les contrôleurs B et C reflètent le cache. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a93/e1d/cdc/a93e1dcdc50efd90618de7857e1d7583.png"><br><br>  Le système de distribution de données RAID 2.0 est la norme pour nos systèmes de stockage: la virtualisation au niveau du disque a longtemps remplacé la copie artificielle bloc par bloc de contenu d'un support à un autre.  Tous les disques sont regroupés en blocs, ils sont combinés en plus grands conglomérats d'une structure à deux niveaux, et déjà au-dessus de son niveau supérieur se trouvent les volumes logiques qui composent les matrices RAID. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e66/080/8bf/e660808bfa5e8e4599fecf7e8ad99dcd.png"><br><br>  Le principal avantage de cette approche est le temps de reconstruction réduit de la baie.  De plus, en cas de défaillance d'un disque, la reconstruction est effectuée non pas sur le disque «hot spare» qui a été maintenu pendant tout ce temps, mais sur l'espace libre de tous les disques utilisés.  La figure ci-dessous montre neuf disques durs RAID5 à titre d'exemple.  Lorsque le disque dur 1 tombe en panne, les données CKG0 et CKG1 sont corrompues.  Le système sélectionne CK pour la reconstruction au hasard. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0fb/fe1/675/0fbfe16756f70b8249910219069942fe.png"><br><br>  La vitesse de récupération RAID normale est de 30 Mo / s, il faut donc 10 heures pour récupérer 1 To de données.  RAID 2.0+ réduit ce temps à 30 minutes. <img src="https://habrastorage.org/getpro/habr/post_images/1bb/3c2/84f/1bb3c284f588667973debf1fe2713093.png"><br><br>  Nos développeurs ont réussi à obtenir une répartition uniforme de la charge entre tous les lecteurs de broche et les SSD du système.  Cela vous permet de libérer le potentiel des systèmes de stockage hybrides bien mieux que l'utilisation habituelle de disques SSD comme cache. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/44c/e59/06e/44ce5906eb4c867c8fed0db763df36f5.png"><br><br>  Dans les systèmes de la classe Dorado, nous avons implémenté le soi-disant RAID-TP, un tableau à triple parité.  Un tel système continuera de fonctionner pendant que trois disques tombent en panne.  Cela augmente la fiabilité par rapport au RAID 6 de deux ordres décimaux, avec le RAID 5 de trois. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/624/59d/618/62459d61809ed563a11e0d8fbd7ec173.png"><br><br>  Nous recommandons RAID-TP pour les données particulièrement critiques, d'autant plus qu'en raison du RAID 2.0 et des lecteurs flash haute vitesse, cela n'a pas d'impact significatif sur les performances.  Vous avez juste besoin de plus d'espace libre pour réserver. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f09/0f1/5c1/f090f15c1b0772e6145a8a2be38a9b30.png"><br><br>  En règle générale, les systèmes 100% flash sont utilisés pour les SGBD avec de petits blocs de données et des IOPS élevés.  Ce dernier n'est pas très bon pour les SSD: les cellules de mémoire NAND manquent rapidement de puissance.  Dans notre implémentation, le système collecte d'abord un bloc de données relativement important dans le cache du lecteur, puis l'écrit complètement dans les cellules.  Cela vous permet de réduire la charge sur les disques, ainsi que dans un mode plus économe, de "garbage collection" et de libérer de l'espace sur le SSD. <br><br><h2>  Six neuf </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/176/aef/c41/176aefc417106ccbc2320bd0cb7e7fcd.png"><br><br>  Ce qui précède nous permet de parler de la tolérance aux pannes de nos systèmes au niveau de la solution entière.  La validation est implémentée au niveau de l'application (par exemple, Oracle DBMS), du système d'exploitation, de l'adaptateur, du stockage, etc. jusqu'au disque.  Cette approche garantit que le bloc de données provenant des ports externes sera écrit sur les disques internes du système sans aucun dommage ni perte.  Cela implique un niveau d'entreprise. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e94/ffb/4d8/e94ffb4d8afa053872de75a76ff78861.png"><br><br>  Pour un stockage, une protection et une récupération fiables des données, ainsi qu'un accès rapide à celles-ci, nous avons développé un certain nombre de technologies propriétaires. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d6/84f/78a/5d684f78a76b0210bfc47eaa1cf933c8.png"><br><br>  HyperMetro est probablement le développement le plus intéressant de l'année et demie écoulée.  Une solution clé en main basée sur nos systèmes de stockage pour la construction d'un cluster de métro à sécurité intégrée est en cours de mise en œuvre au niveau du contrôleur; elle ne nécessite aucune passerelle ou serveur supplémentaire, à l'exception de l'arbitre.  Il est implémenté simplement par une licence: deux systèmes de stockage Huawei plus une licence - et cela fonctionne. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27b/034/cd0/27b034cd082f3275da66b2444c0e57fb.png"><br><br>  La technologie HyperSnap offre une protection continue des données sans perte de performances.  Le système prend en charge RoW.  Pour éviter à tout moment la perte de données sur le stockage, de nombreuses technologies sont utilisées: divers snapshots, clones, copies. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a13/880/a78/a13880a7899505127f17c3d5184372ce.png"><br><br>  Sur la base de nos systèmes de stockage, au moins quatre solutions de reprise après sinistre ont été développées et testées dans la pratique. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a3e/ffc/cbf/a3effccbfe265b951f2d154285156e29.png"><br><br>  Nous avons également une solution pour trois centres de données 3DC Ring DR Solution: deux centres de données dans le cluster et le troisième est en cours de réplication.  Nous pouvons organiser la réplication ou la migration asynchrone à partir de baies tierces.  Il existe une licence de virtualisation intelligente, vous pouvez donc utiliser des volumes de la plupart des baies standard avec accès FC: Hitachi, DELL EMC, HPE, etc.  La solution est vraiment élaborée, il existe des analogues sur le marché, mais ils coûtent plus cher.  Il existe des exemples d'utilisation en Russie. <br><br>  Par conséquent, au niveau de l'ensemble de la solution, vous pouvez obtenir la fiabilité de six neuf, et au niveau du stockage local - cinq neuf.  En général, nous avons essayé. <br><br>  <i>Publié par Vladimir Svinarenko, directeur principal des solutions informatiques, Huawei Enterprise en Russie</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436140/">https://habr.com/ru/post/fr436140/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436128/index.html">Entretien avec le chasseur de bagages Artyom Moscou. Il a piraté Steam et a reçu le plus grand prix de l'histoire de Valve.</a></li>
<li><a href="../fr436130/index.html">Le projet du ministère des télécommunications et des communications de masse sur le transfert du trafic Internet via les stations russes complique la légalisation de OneWeb en Russie</a></li>
<li><a href="../fr436132/index.html">12 choses étranges qui peuvent arriver après l'installation du paquet npm</a></li>
<li><a href="../fr436134/index.html">Jusqu'à 20% de droits de barrage seront imposés sur les routeurs d'importation</a></li>
<li><a href="../fr436136/index.html">OceanLotus: attaque d'un point d'eau en Asie du Sud-Est</a></li>
<li><a href="../fr436144/index.html">Patrons suceurs de sang dans le contexte d'une biocénose: pourquoi une équipe autonome se désagrège si elle n'est pas centralisée</a></li>
<li><a href="../fr436148/index.html">L'histoire d'un junior - comment commencer à travailler et ne pas avoir peur de tout</a></li>
<li><a href="../fr436150/index.html">Configurer le transfert de données d'appareil vers AWS IoT Core</a></li>
<li><a href="../fr436152/index.html">L'erreur qui m'a appris le design orienté business</a></li>
<li><a href="../fr436154/index.html">L'histoire d'un problème avec le compteur de vitesse ou comment Chromium gère la mémoire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>