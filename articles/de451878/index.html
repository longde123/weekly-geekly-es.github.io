<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîΩ üñåÔ∏è üçë Live-Streaming von Stereovideos auf VR-Brillen (Oculus Go) ‚úàÔ∏è üíÜüèº üï∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir werden keinen langen Einf√ºhrungsteil machen, wir werden direkt zum Punkt kommen. 

 Es gibt also eine Stereokamera, die H264-Video √ºber verschiede...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Live-Streaming von Stereovideos auf VR-Brillen (Oculus Go)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451878/">  Wir werden keinen langen Einf√ºhrungsteil machen, wir werden direkt zum Punkt kommen. <br><br>  Es gibt also eine Stereokamera, die H264-Video √ºber verschiedene Protokolle liefern kann.  Es gibt Gl√§ser Oculus Go.  Wie kann man einen Stereo-Live-Stream von einer Kamera in einer VR-Brille sehen?  Es ist w√ºnschenswert, mit einer minimalen Verz√∂gerung und lokal, damit Youtube und andere RTMP-Videodienste verschwinden. <br><br>  Mit Blick auf die Zukunft ist genau das passiert.  Zu Beginn - Wiedergabe einer zuvor aufgenommenen Videodatei aus Stereo, dann Wiedergabe eines Live-Streams mit StereoPi (MPEG-TS √ºber UDP). <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MLPNXmZI8-8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><blockquote>  Die von mir verwendete Stereokamera ist StereoPi, daher werde ich diesbez√ºglich konkrete Beispiele nennen.  In der Tat ist dies eine gew√∂hnliche Himbeere, aber mit zwei Kameras, so dass die beschriebenen Beispiele an gew√∂hnlichen Himbeeren probiert werden k√∂nnen, wenn Sie wirklich wollen.  Richtig, Sie m√ºssen die Firmware von StereoPi installieren. </blockquote>  Das erste war der Versuch, eine regul√§re Android-Anwendung zu erstellen, die den Stream von der Kamera auf den Vollbildmodus abspielt und ihn mit der Seitenlademethode (√ºber adb) in das Okulus f√ºllt. <br><br>  Nach einigem Hin und Her mit dem Manifest stimmten die Brillen zu, diese Anwendung als nativ zu betrachten.  Es erschien in den "Unbekannten Quellen" in der Bibliothek, startete, zeigte alles, was ben√∂tigt wurde, aber es gab ein Problem - Kopfbewegungen wurden nicht ber√ºcksichtigt, das Video von der Kamera wurde einfach dumm im Vollbildmodus mit Brille angezeigt.  Der Stereoeffekt war, ja, aber sobald Sie Ihren Kopf ein wenig bewegen, wird der Moskauer verr√ºckt, was ein sehr, sehr unangenehmes Gef√ºhl verursachte. <br><br>  In diesem Fall ist hier die .apk-Anwendung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">StereoPi f√ºr Oculus Go</a> Zur gleichen Zeit im Archiv und adb liegt, sodass Sie sofort versuchen k√∂nnen, die Brille auszuf√ºllen.  Befehl einfach <br><br><pre><code class="bash hljs">adb install StereoPi.apk</code> </pre> <br>  Gehen Sie danach zu Bibliothek -&gt; Unbekannte Quellen. Dort sollte die Anwendung com.virt2real.stereopi angezeigt werden <br><br><img src="https://habrastorage.org/webt/q6/gi/zf/q6gizfqbbj_cftbnek3l8aqupno.png"><br><br>  Wir starten es und wenn sich StereoPi im selben lokalen Netzwerk wie die Brille befindet, sehen wir sofort das Stereobild von der Kamera. <br><br>  Aber das ist M√ºll ... Ich m√∂chte, dass eine normale native Anwendung f√ºr das Oculus das Video ansieht.  Damit es einen bewegungslosen Bildschirm gab und um nicht zu st√ºrmen, wenn Sie Ihren Kopf bewegen.  Ich bin noch nicht bereit, Unity f√ºr das Oculus zu lernen, daher kam mir die Idee, die bereits im Oculus Store vorhandenen Video-Player-Anwendungen zu verwenden.  Normalerweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">schaue</a> ich 3D-Filme in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skybox</a> , also habe ich versucht, sie zu verwenden. <br><br>  Neben der √ºblichen Anzeige von Mediendateien vom eingebauten Flash-Laufwerk und von Netzwerkger√§ten wurde in Skybox ein interessantes Element ‚ÄûAirscreen‚Äú gefunden.  Es stellte sich heraus, dass Sie die Skybox-Anwendung auf einem Computer mit Windows (also auf einem Mac) installieren, ihm Videodateien zuf√ºhren und diese Videodateien dann mit einer Brille ansehen k√∂nnen.  Das hei√üt,  Die Windows-Anwendung ist ein Videoserver und eine Brille - ein Client.  Ich habe das Kommunikationsprotokoll nirgendwo gefunden, also musste ich tcpdump aufdecken. <br><br>  Nach einer kurzen Ausgrabung stellte sich heraus, dass Skybox UDP-Broadcast-Nachrichten verwendet, um nach einem Server im LAN zu suchen.  Die Nachricht sieht ungef√§hr so ‚Äã‚Äãaus: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"search"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"project"</span></span>:<span class="hljs-string"><span class="hljs-string">"direwolf"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceType"</span></span>:<span class="hljs-string"><span class="hljs-string">"vr"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"udpPort"</span></span>:<span class="hljs-string"><span class="hljs-string">"6881"</span></span>}</code> </pre> <br><br>  Alle Nachrichten in JSON sind sehr praktisch. <br><br>  Auf diese Nachricht m√ºssen wir eine Antwort an den in der Nachricht angegebenen Host und Port des Absenders senden, d. H.  6881 <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"udp"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"project"</span></span>:<span class="hljs-string"><span class="hljs-string">"direwolf server"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"searchResult"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"computerId"</span></span>:<span class="hljs-string"><span class="hljs-string">"53709de962eba2f9695c8a926562486c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"computerName"</span></span>:<span class="hljs-string"><span class="hljs-string">"STEREO-PI"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"ip"</span></span>:<span class="hljs-string"><span class="hljs-string">"192.168.1.51"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"ips"</span></span>:[<span class="hljs-string"><span class="hljs-string">"192.168.1.51"</span></span>],<span class="hljs-attr"><span class="hljs-attr">"port"</span></span>:<span class="hljs-number"><span class="hljs-number">6888</span></span>}</code> </pre><br>  Hier geben wir unseren Host und Port an, auf dem der WebSockets-Server ausgef√ºhrt wird.  Die gesamte weitere Kommunikation erfolgt √ºber Websockets. <br><br>  Die erste Nachricht √ºber Web-Sockets lautet beispielsweise wie folgt: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"addDevice"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Oculus Pacific"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceType"</span></span>:<span class="hljs-string"><span class="hljs-string">"vr"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"showLoginCode"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}</code> </pre> <br>  Wir antworten darauf: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"addDevice"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Oculus Pacific"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceType"</span></span>:<span class="hljs-string"><span class="hljs-string">"vr"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"showLoginCode"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}</code> </pre> <br>  Und danach sehen wir in der Skybox mit Brille unser StereoPi.  Als n√§chstes folgen eine Reihe von Anfragen, f√ºr die Sie Antworten senden m√ºssen.  Zum Beispiel Inhalte von Wiedergabelisten. <br><br><div class="spoiler">  <b class="spoiler_title">Playlist-Beispiel f√ºr Skybox</b> <div class="spoiler_text">  [{id: 'livestream-rtsp', <br>  Name: 'Live Stream RTSP', <br>  Dauer: 0, <br>  Gr√∂√üe: 0, <br>  URL: 'rtsp: //192.168.1.51: 554 / h264', <br>  Vorschaubild: 'http://192.168.1.51/thumbnail/livestream.png', <br>  thumbnailWidth: 186, <br>  thumbnailHeight: 120, <br>  lastModified: 1, <br>  defaultVRSetting: 1, <br>  userVRSetting: 2, <br>  Breite: 1280, <br>  H√∂he: 720, <br>  orientDegree: '0', <br>  Untertitel: [], <br>  ratioTypeFor2DScreen: 'default', <br>  RotationFor2DScreen: 0, <br>  existiert: wahr <br>  isBadMedia: false, <br>  addierte Zeit: 1}, <br>  {id: 'livestream-mpegts', <br>  Name: 'Live Stream MPEG-TS', <br>  Dauer: 0, <br>  Gr√∂√üe: 0, <br>  url: 'udp: // @: 3001', <br>  Vorschaubild: 'http://192.168.1.51/thumbnail/livestream.png', <br>  thumbnailWidth: 186, <br>  thumbnailHeight: 120, <br>  lastModified: 1, <br>  defaultVRSetting: 1, <br>  userVRSetting: 2, <br>  Breite: 1280, <br>  H√∂he: 720, <br>  orientDegree: '0', <br>  Untertitel: [], <br>  ratioTypeFor2DScreen: 'default', <br>  RotationFor2DScreen: 0, <br>  existiert: wahr <br>  isBadMedia: false, <br>  addierte Zeit: 1}] <br></div></div><br>  Dies ist seitdem besonders interessant  In der Wiedergabeliste der Windows-Anwendung wurde die begehrte Abk√ºrzung RTSP entdeckt.  Es stellte sich heraus, dass die Serveranwendung Videodateien √ºber RTSP √ºbertr√§gt, was bereits f√ºr das Live-Video-Streaming geeignet ist, das wir nat√ºrlich ben√∂tigen.  Genauer gesagt stellte sich heraus, dass die Wiedergabeliste ‚ÄûRTSP‚Äú enth√§lt, die Links zu den Videodateien jedoch regul√§r http sind.  Das hei√üt,  Die Serveranwendung sendet weiterhin Dateien √ºber HTTP, dies passt jedoch nicht zu uns.  Zu diesem Zeitpunkt war ich bereits ver√§rgert, aber ich dachte, warum nicht versuchen, einen Link in der Wiedergabeliste in einem Format anzugeben, das VLC normalerweise versteht, d. H.  rtsp: //192.168.1.51: 554 / h264 Und Prost, Skybox begann, den Videostream vom RTSP-Server auf der Stereoanlage abzuspielen.  Die Verz√∂gerung ist sehr gro√ü, 20 Sekunden.  Wir versuchen, den UDP-Stream an MPEG-TS weiterzuleiten.  Wiederum isst VLC dies normalerweise √ºber den Link udp: // @: 3001, f√ºr Skybox habe ich versucht, den gleichen Weg anzugeben.  Dann muss nur noch der MPEG-TS-Stream zum Host der Brille und zum angegebenen UDP-Port geleitet werden.  GStreamer ist daran beteiligt: <br><br><pre> <code class="bash hljs">raspivid -3d sbs -w 1280 -h 720 -o - | gst-launch-1.0 -q fdsrc ! h264parse ! mpegtsmux alignment=7 name=muxer ! rndbuffersize max=1316 min=1316 ! multiudpsink clients=<span class="hljs-string"><span class="hljs-string">"192.168.1.60:3001"</span></span> sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  In der Skybox klicken wir auf das Wiedergabelistenelement ‚ÄûLive Stream MPEG-TS‚Äú und voila, wir sehen einen Live MPMP-TS-Stream auf der gro√üen Leinwand in einem virtuellen Kino.  Die Verz√∂gerung ist viel geringer als bei RTSP, 2-3 Sekunden, aber immer noch viel gr√∂√üer als bei meiner einfachen Anwendung, die einen rohen H264-Stream √ºber UDP empf√§ngt (normalerweise gibt es eine Verz√∂gerung von 100-150 ms bei einer Aufl√∂sung von 720p). <br><br>  Dann bin ich in eine Sackgasse geraten, bisher ist es mir nicht gelungen, die Verz√∂gerung zu reduzieren.  Vielleicht m√ºssen Sie die Pufferung in Skybox selbst deaktivieren, ich werde versuchen, an Entwickler zu schreiben, vielleicht werden sie die Option "Pufferung deaktivieren" w√§hlen :-) <br><br><h3>  Abschlie√üend </h3><br>  Im Allgemeinen k√∂nnen Sie die von mir beschriebene Methode ausprobieren, wenn Sie pl√∂tzlich aus irgendeinem Grund pl√∂tzlich einen Live-Videostream im Okuli oder in einer anderen VR-Brille ansehen m√ºssen (Skybox ist auf vielen Plattformen verf√ºgbar).  Ich wei√ü nicht, ob dies mit anderen Stereokameras funktioniert, aber wenn StereoPi aktiviert ist, pfl√ºgt es. <br><br><h3>  Referenzen </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Serverquelle f√ºr Skybox</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Forenthread mit Diskussion</a> <br><br>  Vielen Dank an alle, jeder ist frei. <br><br>  Oh ja, ich h√§tte es fast vergessen.  Wenn pl√∂tzlich jemand mit der nativen App f√ºr das Oculus helfen kann (so dass es wie Skybox aussieht) - schreiben Sie eine pers√∂nliche Nachricht, wir werden die Details besprechen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451878/">https://habr.com/ru/post/de451878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451866/index.html">W√§hlen Sie die n√§chsten Knoten im Netzwerk</a></li>
<li><a href="../de451870/index.html">Moderne C ++ - Funktionen, die alle Programmierer kennen m√ºssen</a></li>
<li><a href="../de451872/index.html">Python ist ein Assistent bei der Suche nach g√ºnstigen Fl√ºgen f√ºr diejenigen, die gerne reisen</a></li>
<li><a href="../de451874/index.html">Top SEO Trends bei Google</a></li>
<li><a href="../de451876/index.html">Rechenzentrum Frankfurt: Rechenzentrum Telehouse</a></li>
<li><a href="../de451880/index.html">DevPRO'19: Blick vom Wrike-Stand</a></li>
<li><a href="../de451884/index.html">Sieben Jahre als Entwickler gearbeitet: Welche Lektionen habe ich gelernt?</a></li>
<li><a href="../de451886/index.html">Verwenden diskreter Mathematik beim Testen</a></li>
<li><a href="../de451890/index.html">Delegierung einer Reverse-Subnetzzone von weniger als / 24 in BIND. Wie funktioniert es?</a></li>
<li><a href="../de451894/index.html">Ein kurzer und √ºbersichtlicher √úberblick √ºber die Compiler-Architektur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>