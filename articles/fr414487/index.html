<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤘🏽 🙇🏾 🌀 Un rare représentant du type force brute: l'histoire d'une attaque 👨🏼‍🎨 🅾️ 🔸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En travaillant pour protéger la boutique en ligne de l'un de nos clients, nous avons rencontré à plusieurs reprises une curieuse attaque par force bru...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un rare représentant du type force brute: l'histoire d'une attaque</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/414487/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vo/kn/q9/voknq91nj_iua4hv4kjg-vekpww.jpeg" width="500"></div><br><br>  En travaillant pour protéger la boutique en ligne de l'un de nos clients, nous avons rencontré à plusieurs reprises une curieuse attaque par force brute, qui n'était pas si facile à contrer.  Il était basé sur une solution simple à utiliser qui distinguait l'attaque des rangs de son espèce.  Ce qu'elle était et comment nous nous défendions encore d'elle, lisez sous la coupe. <br><a name="habracut"></a><br>  Comme vous le savez, la force brute «classique» est une attaque par force brute de données.  Par exemple, des comptes bien connus sont pris et des mots de passe sont sélectionnés pour eux selon certains critères, soit générés à la volée, soit sur la base de dictionnaires volés.  Il s'agit de la méthode de base pour pirater des comptes. <br><br>  Et dans le cas que j'ai décrit, les assaillants ont agi un peu différemment.  Tout d'abord, ils ont utilisé un grand botnet distribué entre différents pays à partir de plusieurs centaines d'ordinateurs infectés.  Dans le système de surveillance, tout semblait être des ordinateurs complètement différents, ou des procurations auxquelles de vraies personnes étaient assises et accédaient au site.  Une telle attaque peut passer longtemps inaperçue. <br><br>  La deuxième caractéristique de l'attaque, en plus de sa forte répartition géographique, était une énumération non pas des connexions, mais des connexions.  Les attaquants ont probablement utilisé des dictionnaires de mots de passe populaires et des listes de connexion volées.  Et une première connexion a été effectuée sur le mot de passe connu, puis une autre, une troisième, etc.  C'était très similaire à la situation où les utilisateurs ordinaires connectés via un seul fournisseur ne peuvent pas se connecter avec leurs mots de passe.  Ce n'est, à première vue, rien de criminel.  De plus, l'accès à la ressource était très rare - un ou deux par minute. <br><br>  La troisième caractéristique de l'attaque était que le botnet avait un comportement très «humain»: les clients traitaient JavaScript, acceptaient les cookies. <br><br>  En raison de ce complexe de facteurs, l'attaque est restée longtemps inaperçue.  Quand on l'a quand même découvert, on s'est posé une question non triviale: comment se défendre?  Tous les ordinateurs de botnet n'avaient pas de caractéristiques distinctives spéciales, à l'exception d'une certaine erreur dans l'agent utilisateur.  Mais nous n'avons pas bloqué l'attaque sur la base de ce signe, car dans ce cas nous cesserions de voir les actions de l'attaquant.  Il a fallu mettre en évidence d'autres anomalies.  Rien de spécial ne s'est produit en termes d'adresses IP.  Il est également impossible de bloquer les connexions qui effectuent un grand nombre de tentatives de connexion infructueuses, car la fréquence est très faible et la connexion n'est pas brouillée.  Il n'y avait qu'une seule façon: introduire le captcha.  Mais le client ne voulait vraiment pas faire cela, car il pensait que le captcha pouvait aliéner de nombreux clients.  Pendant ce temps, les attaquants ont déjà réussi à choisir les bonnes combinaisons pour certains comptes. <br><br>  Vous êtes sûrement perplexe: pourquoi quelqu'un pénétrerait-il dans les comptes des clients d'une boutique en ligne?  Le fait est que dans votre compte, des points bonus sont accumulés, qui peuvent être utilisés pour recevoir des remises sur les marchandises.  Probablement, quelqu'un voulait vraiment acheter ou vendre des points bonus sur Internet. <br><br>  En conséquence, nous avons persuadé le client d'implémenter le captcha à l'aide des outils F5: il aurait dû apparaître après un nombre donné d'entrées infructueuses.  Mais d'abord, il était nécessaire de configurer les critères de connexion réussie dans le système.  Cela s'est avéré être un peu plus compliqué qu'il n'y paraissait, car dans certains cas, la ressource donne le même code de réponse pour toutes les tentatives de connexion.  Comme critère de succès de la connexion, nous avons choisi d'envoyer les cookies du domaine client. <br><br>  Dans la dernière version de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F5 ASM</a> , il est devenu possible de répondre aux tentatives de sélection en termes d'ID de périphérique - un identifiant de navigateur unique.  Un code JS est ajouté à la page et lorsque la machine infectée ouvre cette page, il signale son identifiant unique.  Dans le cas de nos attaquants, il s'est avéré que l'ID de périphérique du navigateur était le même pour chaque adresse IP.  Il s'agit en fait d'un navigateur accessible à partir d'une seule adresse IP. <br><br><img src="https://habrastorage.org/webt/kj/xo/qo/kjxoqoyue5-dnap-kxvqyxmmnfy.png"><br><br>  Par conséquent, vous pouvez définir le critère suivant: si plus de 5 tentatives de connexion infructueuses sont effectuées à partir d'un navigateur en 15 minutes, un captcha sera affiché pour ce client.  S'il s'agit d'un utilisateur vraiment normal, il le résoudra et se connectera calmement.  Dans le cas où le navigateur ne prend pas en charge JavaScript, nous avons ajouté des exceptions.  Mais, afin de ne pas affaiblir la protection, nous avons utilisé un critère différent: si plus de 20 tentatives de connexion infructueuses sont effectuées à partir d'une seule adresse IP, un captcha est à nouveau proposé.  Encore une fois: pour un utilisateur normal, cela ne posera pas de problème. <br><br>  Mais aujourd'hui, il existe déjà des méthodes pour contourner la protection en utilisant le captcha.  Par exemple, les botnets envoient des captchas à "l'externalisation" - en Chine ou en Inde, où les habitants qui travaillent dur pour une somme modique résolvent les captchas et renvoient des valeurs de texte.  Mais dans ce cas, vous pouvez prendre les mesures appropriées: même si les tentatives de connexion échouent, les tentatives de connexion peuvent être bloquées à partir d'une adresse IP ou d'un ID de périphérique spécifique si le nombre spécifié de tentatives infructueuses est dépassé. <br><br>  La dernière fois que la boutique en ligne a été attaquée de cette manière, nous avons géré le captcha, et cela a fonctionné.  Après son introduction, l'attaque par force brute a progressivement commencé à s'estomper et a finalement cessé.  Depuis, environ un an s'est écoulé - il n'y a pas eu de rechute. <br><br>  <i>Andrei Chernykh, expert au Centre de sécurité de l'information Jet Infosystems</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414487/">https://habr.com/ru/post/fr414487/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414477/index.html">Les pièges du choix d'un écran LED pour une salle de réunion ou une salle de conférence au lieu d'un projecteur</a></li>
<li><a href="../fr414479/index.html">Le D-panthénol: un médicament pour de bon</a></li>
<li><a href="../fr414481/index.html">Le quiz PHP de vendredi: quelques aventures du programmeur Brad, une séquence étrange et des prix</a></li>
<li><a href="../fr414483/index.html">Tapez Safe SQL sur Kotlin</a></li>
<li><a href="../fr414485/index.html">GNMT, échec épique ou subtilités de la traduction automatique</a></li>
<li><a href="../fr414489/index.html">Les États-Unis envisagent de s'attaquer sérieusement à la question des débris spatiaux</a></li>
<li><a href="../fr414493/index.html">Comment rédiger un contrat intelligent pour ICO en 5 minutes</a></li>
<li><a href="../fr414495/index.html">toString: grand et terrible</a></li>
<li><a href="../fr414497/index.html">API Consulo UI de l'idée au prototype</a></li>
<li><a href="../fr414499/index.html">Rapport du Club de Rome 2018, chapitre 1.1.3: «Un monde vide contre une paix totale»</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>