<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì© üö° üí™ Tal dolor, tal dolor, infraestructura como servicio 1: 0 üëÇüèΩ üë©üèª‚Äç‚öñÔ∏è üç§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Estamos haciendo el mejor sistema de detecci√≥n de pr√©stamos en Rusia y pa√≠ses vecinos. En un mundo ideal, solo nos ocupar√≠amos del dise√±o y desarrollo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tal dolor, tal dolor, infraestructura como servicio 1: 0</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/antiplagiat/blog/440912/"><p>  Estamos haciendo el mejor sistema de detecci√≥n de pr√©stamos en Rusia y pa√≠ses vecinos.  En un mundo ideal, solo nos ocupar√≠amos del dise√±o y desarrollo del sistema.  Pero, por desgracia, el antiplagio no funciona en el vac√≠o, y para que nuestros usuarios utilicen nuestros desarrollos de manera conveniente y c√≥moda, tambi√©n necesitamos desarrollar el entorno que rodea nuestro servicio.  Nuestro software a√∫n no funciona sin hierro, los usuarios deben proporcionar asistencia t√©cnica, es necesario recibir el pago de los usuarios sin violar la ley, etc.  En resumen, la rutina es suficiente. </p><br><p>  Este art√≠culo es el primero de una serie de <strike>dramas</strike> de <strike>producci√≥n</strike> sobre c√≥mo mejoramos nuestro servicio con la subcontrataci√≥n.  Compartimos problemas reales y conclusiones. </p><br><h1>  Nubes, caballos de pelo rubio ... </h1><br><img src="https://habrastorage.org/webt/zv/gk/jj/zvgkjjsz7yiiggzxydco6uvippi.png"><br>  <sup><em>(Desde alg√∫n lugar de Internet, lo vi por primera vez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ).</em></sup> <br><p>  La carga en nuestro sistema es muy desigual: en primer lugar, durante el d√≠a la carga cambia 5 veces.  En segundo lugar, hay una estacionalidad pronunciada.  ¬°El m√°ximo diario de controles despu√©s del final de la sesi√≥n de verano se reduce en 10 veces!  La sesi√≥n de invierno no es tan brillante, pero tampoco es un regalo.  Adem√°s, cada sesi√≥n de verano posterior es m√°s pesada (en t√©rminos del n√∫mero de controles) y m√°s dif√≠cil (nuevas tecnolog√≠as de b√∫squeda y funcionalidad) de la anterior.  Por lo tanto, por un lado, quiero tener un buen suministro de recursos, por otro lado, no pagar demasiado durante una disminuci√≥n de la actividad.  En una sesi√≥n, puede implementar m√°s servidores y, en verano, reducir la cantidad de recursos consumidos.  Obviamente, este es solo el caso con los proveedores de la nube.  En este art√≠culo, hablar√© sobre varios aspectos de la interacci√≥n con varios proveedores de la nube (AWS, IT Grad, MCS, YC).  Si a alguien le parece que esto es un grito del alma, no se equivocar√° mucho.  ¬°Entonces vamos! <br></p><a name="habracut"></a><br><h2>  Aws </h2><br><p>  Comenzamos a usar recursos en la nube en febrero de 2013 cuando alquilamos nuestro primer servidor en AWS.  De hecho, Amazon es la primera y m√°s antigua experiencia de lucha contra el plagio con las nubes.  Luego comenzamos con una m√°quina, y ahora nuestro presupuesto en AWS es un orden de magnitud m√°s alto que el presupuesto para todas las nubes rusas.  El primer amor, como sabes, nunca se olvida.  Todos los problemas y oportunidades con otras nubes en este art√≠culo lo consider√© en funci√≥n de la experiencia con AWS. </p><br><p>  Es cierto que tambi√©n hubo una mosca en el ung√ºento en las relaciones con Amazon.  Las siguientes son las caracter√≠sticas o inconvenientes que tenemos con Amazon: <br><br></p><ol><li>  No puede acceder a la consola de una m√°quina virtual a trav√©s de un navegador.  ¬°Y a veces es justo aqu√≠ realmente necesario!  Una vez que eliminamos por error la interfaz de red, se perdi√≥ el acceso en una de las m√°quinas.  Fue una suerte que alguien ya se hubiera encontrado con ese problema, en media hora encontramos y aplicamos con √©xito la soluci√≥n.  A trav√©s de la consola, tal operaci√≥n podr√≠a hacerse en un minuto. </li><li>  Los costos est√°n en d√≥lares y nosotros ganamos en rublos.  En consecuencia, la rentabilidad depende del d√≥lar. </li><li>  No hay un centro de datos en Rusia, el m√°s cercano cuando comenzamos fue en Irlanda.  Esto significa un gran ping y algunas restricciones en el almacenamiento de datos que surgen debido a los requisitos de la ley rusa. </li><li>  Roskomnadzor bloquea regularmente las direcciones de AWS.  Actualmente, hay diferentes servidores disponibles en AWS de diferentes sitios.  Por razones desconocidas, la conexi√≥n a la m√°quina puede caerse.  Por lo general, cambiar la direcci√≥n IP, VPN y proxy ayuda. </li><li>  Amazon es significativamente m√°s caro que las nubes rusas.  Es cierto que puede reducir el costo a trav√©s de un programa de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">respaldo</a> flexible y el uso de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instancias puntuales</a> .  Y estamos usando activamente ambos.  Por desgracia, a√∫n no hemos visto dicha funcionalidad en las nubes dom√©sticas (upd: YC anunci√≥ "VM interrumpidas" en el bolet√≠n del 18 de febrero, estamos esperando detalles). </li><li>  El problema con mensajes insuficientemente informativos.  Durante la transici√≥n de la 3ra generaci√≥n de m√°quinas a la 4ta o 5ta, el hardware virtual cambi√≥ seriamente, en particular, el m√©todo de conexi√≥n de unidades, y las m√°quinas simplemente no comenzaron despu√©s del cambio de tipo.  La interfaz de administraci√≥n de instancias devolvi√≥ un mensaje conciso: capacidad insuficiente.  Hab√≠a suficientes l√≠mites para crear los tipos necesarios de m√°quinas con un margen, y durante aproximadamente seis meses probamos sin √©xito el soporte t√©cnico gratuito para cambiar los l√≠mites.  No sirvi√≥ de nada.  Como resultado, buscaron en Google la soluci√≥n: una recreaci√≥n banal de las m√°quinas ayuda. </li><li>  Un par de veces borramos los SSD en los agujeros: los discos simplemente desaparecieron del sistema junto con todos los datos.  Dado que estos eran <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">discos ef√≠meros</a> , es decir  los datos se pierden cuando la m√°quina se detiene, no almacenamos algo irremplazable en ellos. </li></ol><br><p>  En principio, era posible vivir con estas deficiencias.  Sin embargo, exactamente en el momento en que Amazon finalmente not√≥ el mercado ruso, nuestra cuenta se volvi√≥ poco conveniente para el pago con tarjeta.  Afortunadamente, Amazon corrigi√≥ r√°pidamente la situaci√≥n y nos proporcion√≥ un administrador de cuentas que nos ayud√≥ a pasar de pagar con una tarjeta a un contrato directo y pagar una factura y elaborar varios tipos de acuerdos.  En general, √©l viene regularmente a Rusia, y cuando viene a nosotros, habla sobre oportunidades para optimizar la infraestructura y el pago.  Algunas veces trae consigo un Arquitecto de Soluciones, con quien puede discutir la arquitectura actual de nuestra soluci√≥n, hablar sobre "Lista de Deseos" y problemas, y obtener varias soluciones, no solo a trav√©s de los servicios de AWS.  Los empleados de Amazon declaran que su objetivo no es proporcionar m√°s servicios, sino garantizar que los servicios adquiridos beneficien a la empresa.  Parece que esto es realmente cierto.  La cantidad de servicios, la velocidad de su desarrollo y la profundidad de la integraci√≥n mutua son impresionantes.  AWS tiene todo para organizar tanto el proceso de desarrollo como la operaci√≥n de sistemas altamente cargados de cualquier escala.  Hasta ahora, ¬°solo un problema global es caro! </p><br><h2>  IT Grad 2016 </h2><br><p>  En 2015, decidimos que era hora de abandonar completamente nuestro propio hierro.  Quer√≠a poner los problemas en la confiabilidad del equipo espec√≠ficamente en otros y concentrarme m√°s en mejorar los procesos de nuestro propio desarrollo.  Seg√∫n nuestras previsiones, en 2016 habr√≠amos tenido suficiente del equipo que ten√≠amos ahora, y nos gustar√≠a tener una reserva para cada evento de incendio.  Nos acercamos a la elecci√≥n del proveedor a fondo: preparamos una prueba de carga y un cuestionario con preguntas importantes para nosotros y elegimos meticulosamente entre cinco proveedores: ActiveCloud, Cloud4Y, CloudOne, IT Grad, Softline. </p><br><p>  Como resultado, optamos por las nubes IT Grad.  Sus ventajas: <br></p><ol><li>  Posici√≥n de vida activa, las respuestas a nuestras preguntas se dieron r√°pidamente, fue f√°cil comunicarse. </li><li>  La presencia de unidades SSD r√°pidas, hasta 30 IOPS por GB.  El n√∫mero de operaciones de lectura aleatorias es un indicador muy importante para nosotros, ya que los valores altos nos permiten colocar nuestros m√≥dulos de escaneo en la nube. </li><li>  Plataforma VCloud con la capacidad de controlar m√°quinas y la presencia de una consola para cada m√°quina. </li><li>  La capacidad de aumentar los recursos de una m√°quina virtual sin reiniciar. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Facturaci√≥n flexible</a> : el pago se realiza por los recursos que estaban en uso el d√≠a en el medio del per√≠odo del informe (del 14 al 15 de cada mes).  Adem√°s, existe una opci√≥n de "Pago por uso", sin embargo, es m√°s costosa y el c√°lculo de la cantidad de recursos consumidos se realiza por la carga promedio de CPU y RAM cada 2 horas. </li></ol><br><p>  En 2016, nos mudamos a IT Grad.  Esto es lo que sucedi√≥ en los tres a√±os incompletos de nuestra vida juntos: <br><br></p><ol><li>  Una vez tuvimos un problema.  Exactamente a las 21:00 comenz√≥ un extra√±o descenso en el rendimiento.  La cantidad de verificaciones que el sistema pod√≠a hacer disminuy√≥ de 150 a 20-30 por minuto, mientras que despu√©s de un par de horas todo se restableci√≥ y resolvi√≥ a una velocidad de 600 verificaciones por minuto.  Buscamos durante una semana en casa, verificamos usuarios, atrapamos bots y DDoS, pero no encontramos nada.  Nos dirigimos al soporte de IT-Grad, descubrimos que "oh, y estamos haciendo copias de seguridad aqu√≠".  Como resultado, nos aplastaron con una fuente de problemas para diferentes sistemas de discos y configuraron el trabajo. </li><li>  Por lo general (caracter√≠sticas del uso del producto), durante una sesi√≥n, nuestro tr√°fico supera los 100 megabits por segundo.  Este valor, por cierto, a menudo se establece de manera predeterminada para el canal no reservado en muchos proveedores de la nube.  Cuando cruzamos esta frontera por primera vez, surgieron una serie de problemas: el Edge integrado no pod√≠a hacer frente a la VPN entre el punto de entrada ubicado en nuestro equipo y la m√°quina virtual del servidor web ubicado en la nube.  Como se esperaba, recurrieron al soporte, donde se nos ofreci√≥ aumentar los recursos en Edge.  Ok, no hay duda, reemplazamos su configuraci√≥n de peque√±a a grande, y tambi√©n expandimos el canal al tama√±o de nuestro tr√°fico pico con un margen.  No sirvi√≥ de nada.  En general, no pudimos encontrar la soluci√≥n √≥ptima, tuve que reducir el volumen de tr√°fico trasladando parte de la producci√≥n a otros sitios. </li><li>  La conexi√≥n VPN al sitio IT Grad a veces se rompe durante 1-2 minutos.  A la pregunta de por qu√© sucede esto, ni nosotros ni el soporte t√©cnico podemos encontrar la respuesta.  Hasta ahora tengo que vivir con este problema. </li><li>  El mecanismo para cambiar el tama√±o de los recursos funciona mal, tanto sobre la marcha como en estado apagado.  Sin embargo, me parece que esto es m√°s bien un problema con el proveedor de la plataforma (VMware).  Sin embargo, ya nos hemos encontrado con el hecho de que para aplicar de manera confiable todas las extensiones, era necesario reiniciar la m√°quina invitada (Windows Server 2012 R2).  Despu√©s de cambiar el tama√±o, la m√°quina en s√≠ no arranc√≥ varias veces.  Una vez que el soporte solucion√≥ este problema de 2 a 4 de la ma√±ana durante la sesi√≥n, nuestra propia temporada.  ¬°Hac√≠a calor incluso de noche! </li><li>  En 2016, tuvimos un gran monolito, como el Everest, que requiri√≥ muchos recursos.  Tantos que a veces necesit√°bamos superar el tama√±o m√°ximo de m√°quinas invitadas recomendadas para un host determinado.  El soporte t√©cnico nos solicit√≥ persistentemente reducir el tama√±o de las m√°quinas virtuales a al menos la mitad del tama√±o del host.  Debemos rendir homenaje a IT Grad: se nos ofreci√≥ usar un hardware separado con la capacidad de usarlo por completo, sin embargo, por unos pocos grandes sumas de dinero, y se perdi√≥ la flexibilidad de la nube. </li><li>  Facturar una vez al mes para medir la cantidad de recursos consumidos nos ha enga√±ado dos veces.  Al principio, preguntamos directamente sobre la oportunidad de reducir los recursos del 14 al 15 de un mes para pagar menos.  Nos respondieron directamente que as√≠ es como funciona.  La primera vez nos golpe√≥ dolorosamente durante la transferencia de una parte de la venta a nuestra nube.  El factor humano funcion√≥: trataron de terminar r√°pidamente todo antes del 14, luego lo rastrearon notablemente.  La segunda vez aprovechamos esta oportunidad despu√©s de casi 3 a√±os de cooperaci√≥n, despu√©s de lo cual se nos factur√≥ en promedio los d√≠as 5, 15 y 20.  Luego, el factor humano funcion√≥ para ellos: despu√©s de la llamada result√≥ que cometieron un error a su favor (el rec√°lculo se realiz√≥ manualmente), se disculp√≥ y dio un descuento. </li><li>  El rendimiento de los discos y las m√°quinas en su conjunto cumpli√≥ con las caracter√≠sticas declaradas.  Sin embargo, varias veces no pudimos entender por qu√© todo funcionaba tan lentamente, incluso la interfaz se desaceler√≥ sin piedad.  El soporte asegur√≥ que todo estaba en orden y que no ten√≠an problemas con el equipo.  Lo que sucedi√≥ all√≠ (nuestro servidor en ese momento migr√≥ a un host vecino o alguien hizo una copia de seguridad del subsistema de disco) sigue siendo un misterio para nosotros. </li><li>  Los discos se pueden cambiar entre m√°quinas de forma independiente solo a trav√©s del soporte.  Al comienzo del uso, era imposible tener discos de diferentes tipos en la m√°quina, ten√≠a que salir (iSCSI, Samba y NFS).  Despu√©s de alg√∫n tiempo, el uso de diferentes tipos de discos en una m√°quina se hizo posible primero a trav√©s del soporte y luego por su cuenta (aparentemente hecho en vCloudDirector).  Por cierto, la actualizaci√≥n del sistema de administraci√≥n de virtualizaci√≥n ocurre regularmente.  Recibimos una carta 1-2 veces al mes que indica que durante una o dos horas el sistema de control de la m√°quina virtual toma trabajo t√©cnico y no estar√° disponible por alg√∫n tiempo, las m√°quinas mismas contin√∫an funcionando en este momento. </li><li>  El 16 de febrero de 2018, una parte de nuestras ventas ubicadas en IT Grad se debi√≥ a problemas de suministro de energ√≠a del centro de datos en el que se encontraba el equipo.  Nos enteramos del incidente de facto; no pudimos contactar al soporte t√©cnico.  Tuve que llamar a nuestro gerente de cuenta, √©l dijo inmediatamente en un minuto qu√© y c√≥mo, y se desconect√≥, aparentemente cont√°ndole el resto.  Desde lo agradable, est√°bamos acostados al lado de VKontakte. </li></ol><br><p>  Despu√©s de pasar un tiempo en una casa alquilada y enfrentar todo lo anterior, en 2017 decidimos que era bueno visitarlo, pero mejor en casa, y comenzamos a hacer una nube con discos NVMe r√°pidos y la capacidad de controlar completamente todo.  Tan pronto como lo dijo: traslad√≥ las ventas a su nube de clientes corporativos y m√≥dulos de b√∫squeda (en total m√°s del 90% de la carga), dejando monitoreo, estad√≠sticas y clientes privados en IT Grad.  En 2018, todos calcularon nuevamente y result√≥ que era m√°s rentable dividir la producci√≥n: mantener parte en la nube arrendada y parte en la suya.  Lo que vino de esto, lo contamos m√°s. </p><br><h2>  Soluciones de nube de correo </h2><br><p>  Honestamente, quer√≠a hacerlo, como en AWS, pero en Rusia.  Por lo tanto, comenzamos a mirar hacia las nubes con conjuntos de servicios similares (a quienes estoy enga√±ando, al menos con el an√°logo de EC2 y S3).  La b√∫squeda fue de corta duraci√≥n: encontramos la "Amazon√≠a rusa" en la persona de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MCS</a> .  ¬°Una gran empresa con una amplia gama de servicios diversos, seg√∫n todas las indicaciones, deber√≠an ser capaces de preparar las nubes! </p><br><p>  El comienzo del conocido fue maravilloso.  Un gerente de cuentas vino a nuestra oficina, cont√≥ todo en detalle, describi√≥ las oportunidades actuales y los planes para el futuro cercano.  El resultado fue una imagen maravillosa: precios bajos para los recursos inform√°ticos, hay un almacenamiento de objetos y una salida temprana a la producci√≥n de la base de datos (similar a RDS).  Tambi√©n nos dieron un l√≠mite de efectivo s√≥lido para las pruebas (incluso m√°s de lo que ofrece Azure). </p><br><p>  Para ese momento, ya ten√≠amos la parte de IaC lista para desplegar todas las m√°quinas a trav√©s de terraform.  MCS ten√≠a OpenStack y fue bien soportado!  Por cierto, el soporte t√©cnico se lleva a cabo a trav√©s de un canal de telegramas: comunicaci√≥n "en vivo" y est√° claro que quieren ayudar.  Hay un sistema de tickets, pero a√∫n no lo hemos usado.  Soporte t√©cnico SLA se refiere a las solicitudes creadas en el sistema de tickets. </p><br><p>  Para diciembre de 2018, ten√≠amos escritos scripts de implementaci√≥n de infraestructura a trav√©s de terraform.  Es hora de moverse.  Para empezar, decidimos transferir el sistema con clientes privados, que durante todo este tiempo vivieron con equipos en IT Grad.  Entonces todo es como en una pel√≠cula: <br></p><blockquote><code>7  (), 18:00     .  ,          . <br> 10  (), 10:00   ‚Äì     . <br> 12  () ‚Äì  . <br> 10:00     terraform.     ,   ,    . <br> 12:00   ansible'.   .   ! <br> 15:30  .         30 ,            16:30. <br> 15:45      .      . <br> 15:55     .     :  ,     . <br> 16:20 ,       .   ,    . ,     -            . <br> 17:30     ,    ,    . <br> 18:00        .       1,5 . <br></code> </blockquote><br><p>  El problema identificado con diferentes formatos con un nuevo intento no deber√≠a haber aparecido, pero lo encontramos y por si acaso lo solucionamos. <br></p><blockquote> <code>17  (),   . <br> 15:30    .      ,      . <br> 16:00        .   . <br> 16:30      ,      100%.   -?   ! <br> 17:00       ,   ,  , , iotop, top, ProcessExplorer, PerformanceMonitor.  . <br> 21:45    ,   ,  ,    2000 . <br> 22:00  ,  . <br></code> </blockquote><br><p>  El viejo producto de IT Grad satisfizo f√°cilmente la demanda diferida de cheques de usuarios, no hay problema. </p>  Al d√≠a siguiente (18 de diciembre), nos dimos cuenta de lo siguiente: <br><br><ol><li>  No sab√≠amos qu√© ralentizaba espec√≠ficamente el sistema.  Antes del friso, pr√°cticamente no hab√≠a carga en ninguna parte.  S√≠, todav√≠a tenemos llamadas de bloqueo profundo dentro del sistema y lo m√°s probable es que haya un bloqueo en alguna parte, pero donde exactamente, no pudimos encontrarlo, fue necesario investigar m√°s a fondo. </li><li>  Nuestra prueba de carga actual no coincid√≠a con el perfil de carga del producto.  Fue asombroso porque  Gracias a esta prueba, nos preparamos para la √∫ltima sesi√≥n, identificamos y eliminamos una gran cantidad de cuellos de botella.  Pero tal es la realidad: es necesario rehacer la prueba teniendo en cuenta la experiencia adquirida. </li><li>  Producido en IT Grade con recursos comparables de CPU y RAM, puede hacer frente f√°cilmente al doble de la carga. </li></ol><br>  Entonces, creamos r√°pidamente una prueba que logra el mismo resultado que vimos de primera mano.  Acudimos al soporte de MCS para averiguar si estamos consumiendo alg√∫n l√≠mite de CPU, pero en general es completamente nuestro o no, y todo est√° bien con la red.  Todav√≠a no han respondido a la segunda pregunta, encontraron algo en la tercera y nos recomendaron que hici√©ramos cambios en los sistemas de m√∫ltiples n√∫cleos.  En general, hemos desarrollado una actividad vibrante, el fin de a√±o est√° cerca y todos quieren irse de vacaciones con una sensaci√≥n de logro. <br><p>  Esto es lo que terminamos trabajando con MCS: <br><br></p><ol><li>  Incluso en la etapa de selecci√≥n, nos enviaron una tabla con las caracter√≠sticas de hardware virtual y SLA por disco.  Una de las ventajas fue que prometieron 50 IOPS / GB (IT Grad: 30 IOPS / GB) para el SSD.  El contrato result√≥ ser diferente: "lectura: 5000 IOPS, escritura: 2000 IOPS", y nos perdimos esto, no esper√°bamos esto.  Las tablas son id√©nticas, ¬°la diferencia es solo en un lugar!  Por cierto, no vimos las dependencias de rendimiento en el tama√±o del disco.  Cuando probamos, incluso result√≥ que con un disco m√°s grande, la velocidad disminuye.  El secreto de estos peque√±os indicadores es que MCS tiene ceph geo-distribuido, lo que significa que hasta que el nodo remoto diga que los datos han sido escritos, no se le dir√° al cliente que la grabaci√≥n est√° completa.  Por cierto, nadie parece tener esa fiabilidad "fuera de la caja" entre los proveedores con los que hablamos.  ¬°Pero para nosotros tal confiabilidad solo pone palos en las ruedas!  Si sucede algo, debemos movernos r√°pidamente a otro DC cuando surgen problemas y, por lo tanto, tenemos nuestra propia replicaci√≥n asincr√≥nica.  Tenemos <abbr title="Plan de recuperaci√≥n ante desastres">DRP</abbr> y estamos preparados para la p√©rdida de una peque√±a cantidad de datos en caso de accidente.  Debemos rendir homenaje a MCS, que aceleraron la puesta en marcha de una matriz SSD local, cuyo rendimiento fue mucho mayor. </li><li>  En cuanto a los par√°metros de las m√°quinas, no son arbitrarios.  Hay un cierto conjunto de CPU-RAM- {SSD / HDD} (casi como en AWS), y otros tipos de m√°quinas solo se pueden crear a trav√©s del soporte.  Todo el proceso dura aproximadamente 2 horas, no hay l√≠mite en el n√∫mero de tipos, lo principal es que el n√∫mero de n√∫cleos no debe ser m√°s de la mitad del hipervisor ~ 40-48 procesadores.  Durante la creaci√≥n de la m√°quina, puede agregar discos usted mismo y cambiarlos entre m√°quinas. </li><li>  Despu√©s de encender el SSD local, cambiar los par√°metros de la m√°quina hizo imposible iniciarlo.  Solo pod√≠an lanzarse a trav√©s del soporte.  En alg√∫n lugar en un mes resolvieron el problema. </li><li>  Por primera vez ante el soporte t√©cnico por telegrama.  En general, es conveniente, especialmente al comienzo, cuando hay muchas preguntas y el servicio se est√° complicando.  Pero cuanto m√°s lejos, m√°s dif√≠ciles resultaron las preguntas y la velocidad de respuesta y el contenido de la informaci√≥n disminuyeron lentamente.  A finales de a√±o, cuando, por supuesto, los plazos de todos estaban en marcha, la baja velocidad de las respuestas me enfureci√≥ terriblemente.  En alg√∫n momento, incluso preguntaron sobre los SLA.  ¬°Aqu√≠ es donde se entendi√≥ que el SLA est√° en el sistema de tickets, y no en el telegrama!  En el momento del 19 de febrero, varias de nuestras preguntas sin respuesta formuladas el 24 de diciembre cuelgan en este canal ... </li><li>  El soporte t√©cnico a trav√©s del sistema de tickets no tiene en cuenta que hemos iniciado sesi√≥n y requiere una notificaci√≥n adicional del n√∫mero de contrato.  En respuesta, env√≠a una carta "nos pondremos en contacto con usted", pero no indica el n√∫mero de boleto o el estado. </li></ol><br><p>  Mientras trabajaba con MCS, otra nube comenz√≥ a verse en paralelo. </p><br><h2>  Sin embargo, otra nube (Yandex Cloud) </h2><br><p>  El primero de los otros fue Yandex.  A finales de 2018, solo ten√≠an m√°quinas virtuales y almacenamiento de objetos, su propio sistema de virtualizaci√≥n, API abierta.  El complemento de terraform estaba en alfa y fue aceptado por HashiCorp.  El soporte, como de costumbre, es a trav√©s de telegrama, pero es menos activo que en MCS.  El l√≠mite de dinero de la prueba es lo suficientemente peque√±o y no nos permiti√≥ realizar pruebas normales.  Tuve que concluir r√°pidamente un acuerdo (3 d√≠as h√°biles) y pagar las pruebas.  Seg√∫n los resultados de la prueba, obtuvimos lo mismo que en el MCS.  Comenz√≥ a parecernos que hab√≠a dos problemas: todos tenemos unidades demasiado lentas y tenemos una prueba demasiado severa. </p><br><h2>  IT Grad 2019 </h2><br><p>  En general, fijamos una fecha l√≠mite para mudarse ya el 22 de diciembre, para que haya otra semana para identificar y resolver los problemas ocultos de una nueva residencia.  Habiendo perdido la esperanza de pasar a la fecha l√≠mite y un poco cansado de la abundancia de nueva informaci√≥n en la persona de MCS e YC, decidimos que IT Grad no es tan malo en su contexto.  Incluso nos sentimos un poco nost√°lgicos y pensamos que todo lo nuevo est√° bien establecido.  Ya en IT Grad definitivamente trabajaremos bien, hay un precedente.  Adem√°s, IT-Grad aument√≥: hab√≠a un centro de datos de Mosc√∫, Tier III, tiempo de actividad en el momento en que todav√≠a tiene el 100% (nunca fall√≥), y el equipo en el interior: 4 z√≥calos Intel Xeon escalables (hasta 42 n√∫cleos x 3 GHz Xeon Gold 6154).  ¬°Qu√© diablos no es broma, daremos una segunda oportunidad! <br></p><blockquote> <code>28  (), 18:10   -     vDC      ,    ,          . <br> 29  ( ), 17:04    ,   .   .iso  ,          .           ,   .  ,    .   ,    . <br> 30  (), 22:00 ,            .iso,             .       ,   - . <br> 31  (), 3:15    Edge   vDC    vDC. ,              .      . <br> <br>  ,   . <br> <br> 2  (), 15:30       . <br> 2  (), 21:50 ,   Guest OS Customization  . <br> 3  (), 18:05   !</code> </blockquote> <br><p></p><ol><li>  Ahora, en la preparaci√≥n del art√≠culo, descubrieron que el tiempo exacto de las solicitudes y respuestas no se refleja en el sistema de tickets.  En cambio, dice "hace aproximadamente 2 meses", el tiempo exacto se muestra solo en una informaci√≥n sobre herramientas.  Por correo, tambi√©n es dif√≠cil restaurar la secuencia de eventos.  Los mensajes al correo vienen en una l√≥gica no obvia y no contienen una descripci√≥n de la acci√≥n.  Los tickets se crean en el sistema despu√©s de un tiempo en nombre de un empleado de soporte t√©cnico de IT Grad. </li><li>  Despu√©s de mirar m√°s de cerca el equipo despu√©s de las vacaciones, vimos Xeon v2 all√≠.  Eso no es lo que acordamos.  Bien, decidimos esta pregunta con el administrador de la cuenta.  Hubo algunas dificultades debido al hecho de que en el nuevo a√±o 2019 IT Grad se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">incluy√≥ en el MTS</a> , y justo despu√©s de las vacaciones hubo un peque√±o desastre.  Desde vDC en adelante, el nuevo equipo en Mosc√∫ DC no era visible vDC creado antes del a√±o nuevo.  Solo a trav√©s de Internet abierto, el soporte t√©cnico nos "complaci√≥" de que la velocidad de movimiento no exceda 1TB / d√≠a.  ¬°Y ya hemos subido 7 TB de datos!  Como resultado, crearon una aplicaci√≥n para mudarse el jueves por la noche.  Un d√≠a despu√©s, el viernes por la noche, pregunt√© c√≥mo est√°s y cu√°ndo planean comenzar (¬°espera casi una semana!)?  Un d√≠a despu√©s, el s√°bado por la noche, nos dijeron que todos los autos se hab√≠an movido.  No me gust√≥ que 2.5 d√≠as no hubo informaci√≥n sobre el progreso del trabajo y que las estimaciones sobre la mudanza eran demasiado pesimistas. </li><li>  En septiembre de 2018, cuando comenzamos a implementar IaC, nos dimos cuenta de que Terraform funciona muy mal con vCloudDirector (upd: al momento de escribir esto, nos enteramos de que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VMware vCloud Director Provider 2.0 apareci√≥</a> , pero a√∫n no lo he probado).  Al principio, ni siquiera pod√≠amos crear una m√°quina debido a que vCloud nos inform√≥ de un error en el esp√≠ritu de "algo sali√≥ mal, tienes un error de 512 caracteres 136 l√≠neas (¬°la l√≠nea era m√°s corta!) Xml de la configuraci√≥n de la m√°quina".  Pedimos apoyo.  La pregunta fue redirigida a los ingenieros, al final nos dijeron que Terraform no es compatible, resu√©lvelo t√∫ mismo.  De todos modos, descubrimos que el culpable era el empaquetador, con el que recopilamos la imagen de la m√°quina, no pod√≠a hacer frente al formato de configuraci√≥n de VMware patentado.  Terraform es muy malo con vCloudDirector, todo se enhebra lentamente y el conector ha estado abandonado durante mucho tiempo y no se desarrolla.  Nadie nos dar√≠a acceso a vSphere.  Si permanece en VMware, entonces necesita ver su automatizaci√≥n a trav√©s de su API. </li></ol><br><p>  Organizamos un banco de pruebas en una nueva ubicaci√≥n.  El resultado fue sorprendente: la prueba fall√≥, los s√≠ntomas son los mismos que en el MCS.  Probablemente, en la producci√≥n actual en el fragor de la batalla por la sesi√≥n, se cambiaron algunas configuraciones del sistema operativo que evitan que el sistema se congele, pero que ahora no se puede restaurar.  Para evitar que esto vuelva a suceder, presentamos IaC.  Llevamos a cabo 2 pruebas m√°s: creamos m√°quinas nuevas a partir de im√°genes limpias de los sistemas operativos de la venta actual: falla;  en m√°quinas de producci√≥n existentes: √©xito.  Por lo tanto, se confirm√≥ que hicimos algunos ajustes en el sistema operativo o la base de datos, pero no recordamos cu√°l.  En este punto, la soluci√≥n de nuestro desarrollo lleg√≥ a tiempo: los frisos se detienen cuando las sesiones confiables est√°n deshabilitadas en WCF. </p><br><p>  Realizamos una prueba de carga con la configuraci√≥n recomendada por los desarrolladores en paralelo en MCS (2 GHz, Xeon v4) e IT Grad (3 GHz, Xeon v2): la cantidad de n√∫cleos y memoria es la misma.  En MCS, la prueba pas√≥ m√°s r√°pido (por un cuarto) y m√°s suave (en IT Grad, la prueba se volvi√≥ irregular, luego m√°s r√°pida y luego m√°s lenta). </p><br><h2>  Comparaci√≥n de rendimiento de disco </h2><br><p>  Est√°bamos m√°s preocupados por el rendimiento de los discos para bases de datos e √≠ndices, raz√≥n por la cual probamos principalmente SSD.  No juzgue estrictamente las pruebas, cuando necesit√°bamos comprender el rendimiento de las nubes, en habr.com todav√≠a no hab√≠a varias pruebas de discos, procesadores, proveedores de nube de memoria ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una vez</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dos</a> ).  Ten√≠amos un tiempo limitado y necesit√°bamos comparar r√°pidamente el rendimiento para tener una idea de la diferencia en el rendimiento.  Por lo tanto, el requisito para la prueba era uno: puede repetirse r√°pidamente en cualquier sitio.  Utilizamos las m√°quinas lo m√°s cerca posible de los par√°metros que ya hab√≠amos implementado, fio, para probar el rendimiento de los discos, y pgbench, para evaluar el rendimiento de la base de datos en este disco.  Como est√°ndar, tomamos medidas de la producci√≥n actual: MARS (porque nuestro equipo lleva el nombre de los h√©roes de la serie animada sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ratones rockeros de Marte</a> ). </p><br><p>  Por lo general, el rendimiento del disco depende de su tama√±o.  Observamos este comportamiento en IT City y en AWS, pero en MCS no vimos tal dependencia, tampoco existe en SLA, y las pruebas dieron un resultado parad√≥jico (y posiblemente inexacto): el rendimiento disminuye al aumentar el disco. </p><br><p>  Contamos iops para discos HDD y SSD, as√≠ como tps (transacciones por segundo) para la base de datos postgres en discos SSD.  Hay dos tipos de discos en MCS: SSD y HDD ceph geo-distribuidos regulares y SSD locales (solo en un DC) (su rendimiento se muestra entre par√©ntesis).  Tambi√©n en enero de 2019, en el env√≠o de correos de MCS, leemos que aumentaron el rendimiento del disco en un 20%, el resultado de la prueba tambi√©n est√° en la tabla (MCS 2019).  En febrero, se inform√≥ otra aceleraci√≥n, pero no realizamos pruebas aqu√≠. </p><br><p>  Resultados: </p><div class="scrollable-table"><table><tbody><tr><th><br></th><th colspan="2">  HDD, iops </th><th colspan="2">  SSD, iops </th><th>  SSD, tps </th></tr><tr><th><br></th><th>  leer </th><th colspan="1">  escribir </th><th>  leer </th><th colspan="1">  escribir </th><th>  leer escribir </th></tr><tr><th><p>  Marte </p></th><td>  1336 </td><td colspan="1">  445 </td><td>  17196 </td><td colspan="1">  5729 </td><td>  2000 </td></tr><tr><th><p>  Graduado de TI <br></p></th><td>  4544 </td><td colspan="1">  1515 </td><td>  13231 </td><td colspan="1">  4407 </td><td>  3063 </td></tr><tr><th colspan="1">  Mcs </th><td colspan="1">  1185 </td><td colspan="1">  395 </td><td colspan="1">  8931 (22857) </td><td colspan="1">  2980 (7637) </td><td colspan="1">  497 (1.402) </td></tr><tr><th colspan="1">  MCS 2019 </th><td colspan="1">  3229 </td><td colspan="1">  1080 </td><td colspan="1">  9334 (22270) </td><td colspan="1">  3113 (7418) </td><td colspan="1">  463 (1342) </td></tr><tr><th colspan="1">  Yc </th><td colspan="1">  2202 </td><td colspan="1">  735 </td><td colspan="1">  5522 </td><td colspan="1">  1843 </td><td colspan="1">  1824 </td></tr></tbody></table></div><br><h3>  Metodolog√≠a de prueba </h3><br><p>  <strong>iops se</strong> calcul√≥ como el promedio de 4 ejecuciones de fio: <br> <code>/root/fio-2.0.9/fio --randrepeat=1 --ioengine=libaio --direct=1 --gtod_reduce=1 --name=test --filename=test --bs=4k --iodepth=64 --size=4G --readwrite=randrw --rwmixread=75</code> </p> <br><p>  <strong>tps</strong> , como un promedio de 3 ejecuciones de pgbench: <br> <code>pgbench -c 10 -j 2 -t 10000 example</code> </p> <br><h3>  Descripci√≥n de stands </h3><br><h4>  Marte </h4><br><p>  Xeon v4, 2 GHz <strong>;</strong>  <strong>HDD:</strong> ceph, 3 nodos de 9x 2Tb ST2000NX0253, r√©plica 2;  <strong>SSD:</strong> ceph, 3 nodos en 2Tb NVMe Intel DC P4600, r√©plica 2 </p><p>  <strong>CPU</strong> : 4, <strong>RAM</strong> : 8 GB, <strong>HDD</strong> : 32 GB, <strong>SSD</strong> : 150 GB;  La producci√≥n paralela est√° girando. </p><br><h4>  Graduado de TI </h4><br><p>  Xeon v4 / v2, 2 GHz <strong>;</strong>  <strong>HDD</strong> : 0.1 IOPS / GB <strong>;</strong>  <strong>SSD:</strong> 30 IOPS / GB </p><p>  <strong>CPU</strong> : 4, <strong>RAM</strong> : 4 GB, <strong>HDD</strong> : 250 GB, <strong>SSD</strong> : 200 GB </p><br><h4>  Mcs </h4><br><p>  Xeon v4;  HDD: r / w: 1500/1000 IOPS;  SSD: r / w: 5000/2000 IOPS </p><p>  Para probar <strong>HDD: CPU</strong> : 2, <strong>RAM</strong> : 4GB, <strong>HDD</strong> : 50GB </p><p>  Para probar <strong>SSD, TPS</strong> : <strong>CPU</strong> : 8, <strong>RAM</strong> : 16 GB, <strong>SSD</strong> : 600 GB </p><br><h4>  Y </h4><br><p>  Xeon v4, 2GHz <strong><br></strong> </p><p>  <strong>CPU</strong> : 8, <strong>RAM</strong> : 8GB, <strong>HDD</strong> : 20GB, <strong>SSD</strong> : 50GB </p><br><h2>  Comparaci√≥n de las estimaciones de TCO para el a√±o </h2><br><p>  Contamos <abbr title="Costo total de propiedad">TCO</abbr> para cuatro opciones.  Los valores relativos se muestran en la tabla a continuaci√≥n.  Debo decir que este es un c√°lculo para nuestro caso espec√≠fico y que todo puede resultar diferente para usted. <br></p><div class="scrollable-table"><table><tbody><tr><th>  Mcs </th><th>  Yc </th><th>  Graduado de TI </th><th>  Aws </th></tr><tr><td>  1 </td><td>  1,23 </td><td>  1,37 </td><td>  2,28 </td></tr></tbody></table></div><br><p>  Hicimos el c√°lculo de la siguiente manera.  El a√±o se dividi√≥ en dos partes: sesiones (con mayor carga de trabajo) y el resto del tiempo.  Para cada parte, se calcul√≥ la cantidad requerida de recursos de CPU y RAM.  El volumen de disco requerido, debido al crecimiento constante del servicio, solo crece con el tiempo, por lo tanto, tomamos el promedio entre el comienzo y el final del a√±o para la evaluaci√≥n. </p><br><p>  Hubo poca dificultad para evaluar con AWS, ya que  no hay costo directo para el kernel y los gigabytes de memoria.  Tomamos 3 m√°quinas m√≠nimas c5.large, r5.large y m5.large y calculamos su costo a precios MCS (cambiando proporcionalmente el costo del n√∫cleo de la CPU, ya que MCS tiene una frecuencia de 2 GHz).  Result√≥ as√≠: en promedio, el costo de las instancias simples de AWS es 2.5-2.8 veces mayor que el costo de MCS.  AWS publica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">precios</a> sin IVA.  Por lo tanto, para el costo de AWS agregamos 20%, la tasa anual promedio en d√≥lares es de 70 rublos.  Los discos se consideran simplemente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">precios de EBS</a> (utilizamos diferentes tipos de gp2, sc1, st1).  En algunos lugares necesitamos unidades NVMe de instancias de la familia i3.  Su precio por gigabyte se calcula de manera muy simple: la diferencia de costo entre i3 y un procesador an√°logo y una instancia de memoria de la familia r4, dividido por la cantidad de NVMe.  Resulta 3.1 rublos por gigabyte en 30 d√≠as. </p><br><p>  Incluso en la conversaci√≥n sobre presupuestos, me gustar√≠a notar la diferencia en el costo de una licencia de Windows por un n√∫cleo por mes para todos los proveedores de la nube.  En AWS, la diferencia entre el costo de las instancias de Linux OnDemand y Windows OnDemand dividido por el n√∫mero de n√∫cleos es una constante de aproximadamente 2.800 rublos por mes.  En YC, la licencia de Windows para el n√∫cleo es 3 veces m√°s barata, alrededor de 900 rublos al mes, y en MCS, casi 9 (!) Veces m√°s barata, alrededor de 300 rublos al mes.  Todav√≠a dependemos mucho de Windows: ahora, gracias a .net core, estamos comenzando a hacer una plataforma multiplataforma contra el plagio, incluso para reducir el costo de mantenimiento. </p><p>  El costo agregado de YC tambi√©n incluye el costo del tr√°fico. </p><br><h2>  Conclusiones </h2><br><h3>  A trav√©s de las nubes </h3><br><p>  <strong>AWS</strong>  Dicen que en Rusia hay 4 buenos proveedores de nube: AWS, GCP, Azure y DO, y todos ellos no est√°n en Rusia. <br>  <em><u>Pros:</u></em> gran servicio, equipos modernos de alta calidad, buenas configuraciones en EC2, una gran cantidad de servicios. <br>  <em><u>Contras:</u></em> caro (m√°s riesgos de tipo de cambio) y no en Rusia (ILV, el gran firewall ruso en el horizonte).  Realmente quiero que nuestras nubes sigan este ejemplo a seguir. <br>  <em><u>Caracter√≠sticas:</u></em> El soporte t√©cnico gratuito puede resolver un m√≠nimo de problemas, pero, para ser sincero, lo contactamos solo para ampliar los l√≠mites de uso.  Pagado, por cierto, cuesta alrededor del 10% de la cuenta. </p><br><p>  <strong>IT Grad</strong> .  Buen servicio para la nube corporativa.  Hay an√°logos de EC2 y S3 basados ‚Äã‚Äãen Swift. <br>  <em><u>Pros:</u></em> buen rendimiento (CPU de 1-2-3 GHz, SSD, HDD), equipo nuevo (en uno de los DC) entre nubes dom√©sticas, configuraciones arbitrarias de la m√°quina. <br>  <em><u>Contras:</u></em> facturaci√≥n incomprensible, VMware (pobremente automatizado, interfaz flash), un poco de caos y gran cantidad de soporte t√©cnico. <br>  <em><u>Caracter√≠sticas: se</u></em> agudiza m√°s bajo uso corporativo (una vez configurado, luego cambios raros) que bajo un sistema p√∫blico altamente cargado (actualizaciones frecuentes, cambios constantes).  Desde 2019, el negocio de IaaS se ha vendido junto con personas y equipos en MTS, ahora todo puede cambiar en cualquier direcci√≥n.  Comunicaci√≥n a trav√©s del sistema de tickets y tel√©fono, me gustar√≠a una reacci√≥n m√°s r√°pida y un mensaje de los plazos previstos. </p><br><p>  <strong>MCS</strong>  Hay an√°logos de los servicios EC2 (hay GPU), S3, ECS, RDS, EMR, sus propios servicios: aprendizaje autom√°tico, recuperaci√≥n ante desastres en la nube, copia de seguridad en la nube <br>  <em><u>Pros:</u></em> econ√≥mico, en desarrollo activo, hay GPU (Tesla V100 y Grid K2). <br>  <em><u>Contras:</u></em> unidades lentas, humedad, mal karma de la empresa matriz. <br>  <em><u>Caracter√≠sticas:</u></em> el soporte t√©cnico al principio es √∫til, se activa una gran cantidad de empleados, se siente ayuda, pero luego hay una disminuci√≥n notable en la actividad (no respondieron nada desde el 24 de diciembre, incluso estoy preocupado por los muchachos). </p><br><p>  <strong>YC</strong> .  Tenemos muy poca experiencia trabajando con este proveedor, es dif√≠cil decir algo espec√≠fico.  Hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">an√°logos de</a> EC2, S3, RDS, DS, SQS (alfa), ELB (alfa), sus servicios √∫nicos: SpeechKit, Translate. <br>  <em><u>Pros: las</u></em> unidades son m√°s r√°pidas que MCS. <br>  <em><u>Contras: el</u></em> proveedor de terraformaci√≥n est√° h√∫medo;  El software del shell de virtualizaci√≥n con API abierta no es muy grande para la comunidad, lo que significa que hasta ahora solo puede confiar en las fortalezas del equipo de YC en el desarrollo del proveedor de Terraform. <br>  <em><u>Caracter√≠sticas:</u></em> pagar por el tr√°fico. </p><br><br><h3>  Lecciones aprendidas </h3><br><ol><li>  Nos dimos cuenta de que las pruebas de estr√©s son moralmente obsoletas.  Actualizaron la prueba, encontraron nuevos cuellos de botella, los arreglaron y mejoraron el producto.  Recordamos que la prueba de carga debe ser adecuada y debe haber configuraciones en las que definitivamente no pase para que pueda ver el l√≠mite de su aplicabilidad. </li><li>  A pesar de la creencia generalizada de que el software no se est√° optimizando en este momento y de que todos los cuellos de botella se est√°n inundando de recursos, tuvimos que descubrir y optimizar nuestro sistema.  Result√≥ mejor de lo que era, la nueva versi√≥n de Anti-Plagiarism requiere menos recursos y funciona m√°s r√°pido.  Ya describ√≠ varios lugares m√°s donde puede reducir el consumo de recursos. </li><li>  Hicimos IaC, implementamos y actualizamos a trav√©s de ansible, aprendimos c√≥mo pasar de una nube a otra (con replicaci√≥n de datos preliminar) en casi 10-15 minutos.  Si los datos se copian y se configura la replicaci√≥n regular, aqu√≠ est√° el Plan de recuperaci√≥n ante desastres: moverse en media hora con p√©rdida de datos en los √∫ltimos 15 minutos. </li></ol><br><h3>  Lo que queremos de las nubes </h3><br><ol><li>  Respuestas r√°pidas del soporte t√©cnico.  Desafortunadamente, hasta ahora no podemos usarlo como en AWS: hay muy poca informaci√≥n disponible. </li><li>  Soporte para la automatizaci√≥n del despliegue de infraestructura mediante fondos gratuitos (terraform). </li><li>  Previsibilidad en el rendimiento.  Esto se aplica a la facturaci√≥n, rendimiento de la CPU, RAM, discos. </li><li>  La presencia de an√°logos funcionales EC2, S3, RDS ahora.  En el futuro cercano, necesitamos soporte para k8s y c√°lculos de GPU (ya lo usamos en AWS). </li></ol><br><p>  Adem√°s de pasar a las nubes, en los √∫ltimos meses hemos logrado tocar el rastrillo en otras √°reas.  C√≥mo fue, lo contaremos un poco m√°s tarde. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/440912/">https://habr.com/ru/post/440912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../440902/index.html">La mitad del reino para la IA: cu√°nto ahorran los bancos en aprendizaje autom√°tico, redes neuronales y bots de chat</a></li>
<li><a href="../440904/index.html">Comparaci√≥n de las arquitecturas Viper y MVVM: c√≥mo aplicar ambas</a></li>
<li><a href="../440906/index.html">Seminario web "167-–§–ó. C√≥mo los bancos pueden cumplir los requisitos del Banco Central para los sistemas antifraude ‚Äù- 26 de febrero de 2019, 11:00 hora de Mosc√∫</a></li>
<li><a href="../440908/index.html">Servir todo</a></li>
<li><a href="../440910/index.html">¬øPor qu√© los bancos monopolizan blockchain?</a></li>
<li><a href="../440914/index.html">Perd√≠ la fe en la industria, me quem√©, pero el culto a la herramienta me salv√≥</a></li>
<li><a href="../440916/index.html">Radiaci√≥n: unidades</a></li>
<li><a href="../440918/index.html">Semana de la seguridad 08: pirateo de VFEMail en vivo</a></li>
<li><a href="../440920/index.html">Implementaci√≥n de la interfaz de usuario en iOS: mejor, m√°s r√°pido y escala</a></li>
<li><a href="../440922/index.html">C√≥mo funciona Level Flow en Uncharted 4 y The Last Of Us</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>