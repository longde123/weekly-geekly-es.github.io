<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õëÔ∏è ü§î üëåüèª SportIduino - Arduino Orienteering Electronic Marking System ü§æ üò® üëßüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sortir √† la campagne est toujours merveilleux, mais avec une carte en main et un objectif conscient est toujours plus int√©ressant. Il existe des types...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SportIduino - Arduino Orienteering Electronic Marking System</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404565/"><img src="https://habrastorage.org/web/6e5/049/cd8/6e5049cd8c2c4ec6907532fd1ab6a8ac.JPG"><br><br>  Sortir √† la campagne est toujours merveilleux, mais avec une carte en main et un objectif conscient est toujours plus int√©ressant.  Il existe des types d'activit√©s de plein air comme la course d'orientation, les rogains, les multi-courses, auxquelles vous pouvez vous amuser.  La t√¢che de l'orienteur est de visiter les points de contr√¥le indiqu√©s sur la carte en un minimum de temps.  Afin de prouver le fait de leur visite, ils sont utilis√©s comme les soi-disant  Syst√®mes de marquage ¬´traditionnels¬ª: crayons de couleur, symboles cod√©s, composteurs, etc., ainsi que syst√®mes √©lectroniques.  Malgr√© la commodit√© de ce dernier, les m√©thodes traditionnelles sont encore largement utilis√©es dans les comp√©titions amateurs.  Cela est d√ª au co√ªt du mat√©riel (de 3500 roubles par marque de gare et de 450 roubles par puce), avec la possibilit√© de vol de stations install√©es dans les lieux publics, la n√©cessit√© de prendre une caution pour la puce.  Par cons√©quent, je me suis fix√© comme objectif de cr√©er une alternative plus abordable.  Son impl√©mentation dans l'environnement Arduino est d√©crite ci-dessous. <br><a name="habracut"></a><br>  Un syst√®me d'√©tiquetage √©lectronique se compose g√©n√©ralement de puces et de stations RFID - des dispositifs sp√©ciaux pour leur enregistrement et leur lecture.  Le syst√®me fonctionne comme suit.  Au d√©part, l'athl√®te d'orientation re√ßoit une puce, prend une carte et d√©marre.  En courant vers le CP, il met sa puce √† la station de marquage, elle enregistre l'heure actuelle sur la puce et donne un signal, apr√®s quoi l'athl√®te peut continuer.  √Ä la ligne d'arriv√©e, l'athl√®te remet la puce au juge, qui lit les informations √† l'aide de la passerelle et annonce le r√©sultat √† l'athl√®te - son temps √† distance, le nombre de CP visit√©s, le respect d'une direction donn√©e.  Il peut √©galement imprimer des fractionnements - des p√©riodes de temps pass√©es sur le chemin entre le CP, ce qui permet √† l'athl√®te d'analyser son chemin et de se comparer aux autres sur un segment particulier de la distance. <br><br>  Pour travailler avec des puces RFID, il existe un module largement disponible RFID-RC522, pour lequel il existe une excellente biblioth√®que pour Arduino, √† bien des √©gards, ce fait a d√©termin√© son utilisation.  Le module fonctionne √† une fr√©quence de 13,56 MHz et prend en charge la norme ISO 14443, fonctionne avec diff√©rentes puces, la lecture et l'√©criture s'effectuent √† une distance de plusieurs centim√®tres, ce qui est bien adapt√© √† nos besoins. <br><br><img src="https://habrastorage.org/web/1fa/1a4/186/1fa1a4186195442bba96b58d0405324e.JPG"><br><br>  <b>Chips</b> <br><br>  Pour cr√©er un syst√®me de marquage, j'ai utilis√© la puce Mifare Classic 1K (S50) en raison de sa large disponibilit√© dans diff√©rents mod√®les et de son faible co√ªt (11 roubles par puce sous la forme d'un porte-cl√©s).  La puce vous permet de lire et d'√©crire des informations rapidement et de mani√®re fiable.  La m√©moire de la puce est structurellement divis√©e en 16 secteurs, chacun contenant 4 blocs de 16 octets.  Le 4√®me bloc de chaque secteur contient des cl√©s qui peuvent √™tre utilis√©es pour √©crire / lire des blocs dans le secteur.  De plus, dans le secteur z√©ro, le bloc z√©ro contient l'UID et des informations sur le fabricant.  Ainsi, il reste 3 blocs de 16 octets pour l'√©criture dans les secteurs du 1er au 15e et deux blocs dans le 0e secteur.  La structure d'enregistrement est pr√©sent√©e dans le tableau ci-dessous, toutes les donn√©es sont enregistr√©es en triple pour plus de fiabilit√©. <br><br><img src="https://habrastorage.org/web/7db/d8d/587/7dbd8d5873ba4e6b9c729b9ba17dd39b.png"><br><br>  Ce syst√®me d'enregistrement vous permet d'enregistrer 45 points en m√©moire, y compris le d√©but et la fin, pour la plupart des comp√©titions, cela suffit.  Mais si vous optimisez l'utilisation de la m√©moire et mettez un peu plus de temps sur la marque, la capacit√© peut √™tre consid√©rablement augment√©e. <br><br><img src="https://habrastorage.org/web/2dd/01a/6b6/2dd01a6b642c40639634811fa5f71e22.JPG"><br><br>  <b>Station Stations</b> <br><br>  <i>Sch√©ma et installation</i> <br><br>  Les principaux composants des stations de la marque: microcontr√¥leur - Atmega328p-au, module RF522, horloge DS3231.  Aliment√© par 3 piles AA via le stabilisateur lin√©aire MCP1700T-33. <br><br><img src="https://habrastorage.org/web/614/c46/d8e/614c46d8e4bf4617b6ba02a2b69e5106.jpg"><br><br>  J'ai install√© les composants sur une carte de circuit imprim√©, tous les composants SMD, avec la carte RFID, j'ai fait la connexion en soudant √† travers le connecteur √† broches.  Les panneaux ont √©t√© fabriqu√©s √† l'aide de photor√©sist, des pistes de 0,5 mm.  Pendant que je perfectionnais la m√©thode, j'avais fait pas mal de mariage, il est probablement plus judicieux de faire des fichiers gerber et de commander leur production √† part, car ce n'est pas tr√®s cher. <br><br><img src="https://habrastorage.org/web/887/6a0/176/8876a017695846c184bf5aaac77b5e55.JPG"><br><br>  J'utilise le g1020BF abordable comme le cas.  J'ai perc√© un trou dans la bo√Æte pour la LED et j'ai coup√© l'exc√®s de plastique pour entrer dans le compartiment des piles.  Le trou pour la LED a √©t√© trait√© avec de l'√©poxy, puis il a ins√©r√© une carte de circuit imprim√© soud√©e.  Apr√®s durcissement de l'√©poxy, il a inject√© 30 millilitres de compos√© PK-68, ce qui √©tait juste suffisant pour couvrir la planche.  J'ai ins√©r√© des piles dans le compartiment √† piles et tout enduit de graisse pour l'√©tanch√©it√©.  Apr√®s avoir serr√© le couvercle, la station est pr√™te √† l'emploi. <br><br><img src="https://habrastorage.org/web/dab/19f/14e/dab19f14e7fa4c5b9f56fce173c95b70.jpg"><br><br>  Le co√ªt des composants et des mat√©riaux de la station pour sa fabrication est d'environ 500 roubles.  Il me faut environ une heure et demie de temps pur pour cr√©er et configurer une station. <br><br>  <i>Micrologiciel de la station</i> <br><br>  Pendant le fonctionnement de la station, diff√©rents types de dysfonctionnements sont possibles, il √©tait n√©cessaire de mettre en ≈ìuvre le travail de chien de garde, vous devez donc utiliser un Bootloader compatible pour qu'il fonctionne correctement.  Une bonne version du chargeur de d√©marrage pour Atmega328p et des instructions pour l'installer sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Vous devez √©galement modifier la biblioth√®que de fils standard en non bloquante afin que la station continue de fonctionner lorsque la ligne i2c se casse et n'entre pas dans une boucle sans fin.  J'ai charg√© le chargeur de d√©marrage en utilisant un autre arduino via l'Arduino en tant que firmware isp, connect√© les contacts SPI via les broches menant au module RFID, que j'ai mordu apr√®s un d√©marrage r√©ussi.  Apr√®s quoi j'ai install√© le firmware principal. <br><br>  Avec le micrologiciel principal, lorsque le plateau est ins√©r√©, la station lit un bloc d'informations √† partir duquel elle apprend les num√©ros du dernier bloc enregistr√© et la station sur laquelle la marque s'est produite.  Si le num√©ro de station est diff√©rent, le bloc d'informations est mis √† jour et le num√©ro de station et l'heure actuelle sont enregistr√©s dans le bloc libre suivant.  L'heure et le num√©ro de station peuvent √™tre ajust√©s √† l'aide de puces sp√©ciales et de la station passerelle. <br><br>  <i>La nutrition</i> <br><br>  L'un des probl√®mes les plus importants qui m√©ritait d'√™tre r√©solu √©tait de savoir comment maximiser la dur√©e de vie des stations √† partir d'un ensemble de batteries.  Ceci est particuli√®rement critique pour l'orientation touristique, lorsqu'il arrive que les stations soient install√©es bien avant la comp√©tition et qu'il est n√©cessaire qu'elles soient garanties de fonctionner pendant plus d'un mois. <br><br>  Pour r√©duire la consommation, les modes veille sont utilis√©s pour le contr√¥leur, ainsi que pour le RC522.  En mode veille, la station ne consomme que 0,02 mA contre 20 mA en fonctionnement.  Pour utiliser l'√©nergie plus √©conomiquement, trois modes de fonctionnement de la station avec diff√©rents intervalles de temps de sommeil ont √©t√© mis en ≈ìuvre. <br><br>  Par d√©faut, la station d√©marre en mode veille.  Dans le m√™me temps, la puce est recherch√©e toutes les secondes, la capacit√© de la batterie est suffisante pour 160 jours.  Lorsque la puce est en plateau (ceci est fait par le juge de production ou le premier athl√®te qui a accouru √† la station), la station passe en mode de fonctionnement.  En mode de fonctionnement, une recherche de puce est impl√©ment√©e toutes les 250 ms.  Les nouvelles piles durent 45 jours d'utilisation continue.  Apr√®s 6 heures d'inactivit√©, la station revient en mode veille. <br><br>  Lorsque la puce de sommeil principale (puce d'arbitre sp√©ciale avec param√®tres de station) est introduite, la station passe en mode de stockage (recherchez la puce toutes les 25 secondes), s√©lectionne 3 fois et red√©marre.  Les nouvelles batteries dans ce mode dureront 5 ans.  Lorsqu'un plateau est plac√© sur une puce, la station passe en mode veille et la charge restante de la batterie est mesur√©e.  Si la tension chute en dessous de 3,1 V, ce qui indique qu'il reste environ 15% de la charge, la station le signale. <br><br>  <b>Interface et traitement des donn√©es</b> <br><br>  Une station d'interface est pr√©vue pour travailler avec des puces et des stations de marquage.  √Ä l'aide de la station passerelle, vous pouvez d√©finir et r√©gler l'heure et les num√©ros de station √† l'aide de puces principales sp√©ciales.  En outre, la station passerelle effectue le nettoyage et la v√©rification des puces avant le lancement, les saisit avec les informations initiales et un num√©ro individuel.  Eh bien, bien s√ªr, il lit les puces et obtient les r√©sultats. <br><br>  Au circuit, j'ai √©galement ajout√© un module SD pour l'enregistrement des splits et un module Bluetooth afin que la station puisse √™tre connect√©e √† un t√©l√©phone ou un ordinateur pour recevoir ou transmettre des donn√©es. <br><br><img src="https://habrastorage.org/web/311/76a/72a/31176a72ae274e089e98e8f28b6caca1.PNG"><br><br>  Alors que le circuit et le firmware ne sont pas encore suffisamment optimis√©s et mis en ≈ìuvre si loin des modules, √† genoux.  √Ä l'avenir, il est pr√©vu de finaliser pour une utilisation plus pratique. <br><br><img src="https://habrastorage.org/web/26b/aa9/e93/26baa9e935164e8f8bc0e44d5482856e.JPG"><br><br>  √Ä l'heure actuelle, le traitement des donn√©es est effectu√© de mani√®re semi-manuelle en triant les fichiers CSV r√©sultants.  Le syst√®me est tr√®s flexible et peut √™tre facilement configur√© pour n'importe quelle comp√©tition, pour mettre en ≈ìuvre le pr√©traitement des donn√©es dans la passerelle de mani√®re pratique dans diff√©rents cas.  Pour l'avenir, il est pr√©vu d'√©crire un logiciel pour automatiser le traitement des donn√©es. <br><br>  <b>Conclusion</b> <br><br>  Je suis nouveau dans la programmation et le d√©veloppement d'appareils √©lectroniques et je le fais depuis moins d'un an.  Par cons√©quent, les solutions de code et de circuits sont tr√®s probablement loin d'√™tre optimales ou compl√®tement incorrectes.  Je serai tr√®s heureux de critiquer, l'ensemble du projet est disponible gratuitement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le github</a> . <br><br>  Je veux √©galement exprimer ma gratitude √† ceux qui ont d√©j√† aid√© avec des conseils et int√©ress√©s par le d√©veloppement. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr404565/">https://habr.com/ru/post/fr404565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr404555/index.html">√âvaluation du t√©l√©phone IP Yealink SIP-T27G</a></li>
<li><a href="../fr404557/index.html">Ce que le camion Progress MS-06 livrera √† l'ISS le 16 juin 2017: examen des cargaisons, des exp√©riences et des t√¢ches</a></li>
<li><a href="../fr404559/index.html">Le d√©fi des cinq ans devenu "viral"</a></li>
<li><a href="../fr404561/index.html">Bureau dans le style de Canon. Pr√©sentation des appareils et des solutions pour les entreprises</a></li>
<li><a href="../fr404563/index.html">Radius Alternative pour les petits r√©seaux</a></li>
<li><a href="../fr404567/index.html">Editeur Peter. Soldes d'√©t√©</a></li>
<li><a href="../fr404569/index.html">Particules, antiparticules et leur annihilation</a></li>
<li><a href="../fr404571/index.html">Les r√©seaux sociaux - une nouvelle source s√©rieuse de cybermenaces</a></li>
<li><a href="../fr404573/index.html">Gagner le ¬´monstre math√©matique¬ª: ce n'est pas une question de nombres, mais d'apprendre √† penser</a></li>
<li><a href="../fr404575/index.html">L'IA de Microsoft a battu le record d'un homme chez Mme Pac-man</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>