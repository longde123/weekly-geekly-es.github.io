<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíáüèº üë©üèª‚Äçüé® üñïüèº Eu escrevi uma extens√£o entre navegadores para guias, mas voc√™ n√£o faz isso üé≠ ü§úüèº üò∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Uma introdu√ß√£o longa e tediosa com uma reivindica√ß√£o de megalomania 
 Depois que descobri que, como sempre, algo n√£o me agradava muito neste mundo. Ou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eu escrevi uma extens√£o entre navegadores para guias, mas voc√™ n√£o faz isso</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427773/"><h3>  Uma introdu√ß√£o longa e tediosa com uma reivindica√ß√£o de megalomania </h3><br>  Depois que descobri que, como sempre, algo n√£o me agradava muito neste mundo.  Ou seja, inserindo algum tipo de consulta longa em um mecanismo de pesquisa em um computador desktop e depois alternando para um tablet, n√£o consegui recuperar o texto da consulta literalmente para obter exatamente os mesmos resultados.  Tudo come√ßou t√£o bem.  Vi no mecanismo de pesquisa um link para a resposta √† minha pergunta e percebi que ele promete um longo assunto de leitura.  Ent√£o desliguei o computador e me sentei no sof√° com o tablet com o pensamento de que agora vou digitar tudo novamente no mecanismo de pesquisa, vou abrir esse link agora no tablet e deitar-me calmamente em uma posi√ß√£o mais confort√°vel, vou ler ... Mas n√£o aqui foi.  Algumas pequenas discrep√¢ncias no texto - e meu link n√£o est√° mais no mecanismo de busca.  Reproduzir o link em si tamb√©m n√£o √© uma op√ß√£o: √© muito longo.  Confundindo as op√ß√µes para o texto da consulta, eu estava quase furiosa por quebrar o tablet.  Droga, eu tive que me levantar, ligar o computador novamente, iniciar o navegador e mergulhar na hist√≥ria para encontrar o texto exato da minha solicita√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/96/4d/2c/964d2c1pum-7mihsz15k_6r1ayu.jpeg"></div><br>  <i>Extens√£o instalada no Chrome e Firefox</i> <br><a name="habracut"></a><br><h3>  Id√©ia </h3><br>  Pensei, mas seria bom escrever uma extens√£o para o navegador que permitisse transferir qualquer uma das guias abertas pelo servidor para qualquer outro computador e continuar trabalhando com elas l√°.  Sim, alguns navegadores j√° possuem um recurso de nuvem - voc√™ s√≥ precisa fazer login nos dois dispositivos e ... Mas esse √© o problema.  Mas e se eu tiver o Chrome no meu computador e o Firefox no meu tablet?  E ent√£o ... Basta fazer login, sim.  Se ainda me lembrava da minha senha da conta do Google.  E eu simplesmente n√£o tenho uma conta no Firefox.  Eu nem sei se existem contas l√°?  Obviamente, existem servi√ßos em nuvem de terceiros nos quais voc√™ pode se registrar e, provavelmente, de alguma forma lan√ßar o link desejado para si mesmo.  Mas ainda √© necess√°rio registrar-se e memorizar firmemente outra senha ... N√£o, isso √© completamente irreal.  No final, voc√™ pode lan√ßar um link para si mesmo pelo correio.  Mas tudo isso leva muito tempo, copie e cole de e depois na barra de endere√ßos, o que, por exemplo, em um tablet √© extremamente inconveniente.  N√£o, tudo isso √© algum tipo de bobagem ... <br><br>  Deitada no sof√°, percebi lentamente que todas essas a√ß√µes exigem muito movimento ... N√£o, pessoal, isso n√£o √© necess√°rio.  E quando eu entendo que algo n√£o combina comigo neste mundo, ent√£o me sento para escrever c√≥digo para fazer tudo do meu jeito.  Eu pensei que estava autorizado nas redes sociais, tanto no tablet quanto no computador desktop.  E em navegadores diferentes, por exemplo, no mesmo computador - tamb√©m.  Em geral, a solu√ß√£o para mim era √≥bvia - autenticar o usu√°rio atrav√©s das redes sociais. <br><br><h3>  Digress√£o l√≠rica </h3><br>  A prop√≥sito, quando escrevo algo pr√≥prio, tamb√©m o fa√ßo do meu jeito.  Escrevo em javaScript puro em um bloco de anota√ß√µes avan√ßado, n√£o uso o github, n√£o uso bibliotecas de terceiros, nem uso o jquery.  Portanto, n√£o haver√° tutorial sobre como escrever uma extens√£o do navegador.  Eu n√£o vou te ensinar isso.  N√£o fa√ßa como eu fa√ßo.  Eu te aviso - este √© um mau exemplo.  Tamb√©m quero contar a todos os cr√≠ticos em potencial, antecipando a rea√ß√£o deles - sim, concordo plenamente com toda a sua raiva justa.  Sim, n√£o √© poss√≠vel colocar o script inteiro em um ou dois arquivos, mas √© preciso dividir tudo, como uma salada, em v√°rios peda√ßos pequenos, para que ele possa ser coletado por 3 horas em um comando longo e inteligente na linha de comando.  Sim, voc√™ n√£o pode combinar c√≥digo javascript e c√≥digo html em um arquivo - √© melhor estragar outro n√≠vel de abstra√ß√£o que os combinar√°.  Sim, voc√™ n√£o pode usar o layout da tabela, mas droga, √© ferro!  E ainda mais - agora eles v√£o me queimar - voc√™ n√£o pode usar o innerHtml e criar uma estrutura html complexa de uma s√≥ vez, mas voc√™ precisa anexar e desanexar todos os filhos em um loop, anexar cuidadosamente e excluir cada manipulador ... Sim, estou fazendo tudo errado.  Pecador, eu me arrependo.  Mas eu fa√ßo conscientemente, porque √© mais f√°cil.  E quem vai me proibir?  No final, n√£o √© ilegal, √©?  N√£o sei programar como o mod moderno exige, e nem quero tentar, porque acredito que o diagrama do processo de desenvolvimento √© desnecessariamente complicado.  Sou a favor de escrever c√≥digo com as m√£os e n√£o constru√≠-lo a partir das pe√ßas de outra pessoa sem escrever uma √∫nica linha.  No entanto, meu c√≥digo √© leve, n√£o precisa ser montado por uma equipe especial e funciona rapidamente.  Estou escrevendo c√≥digo usando a tecnologia F5.  √â quando, para ver como a vers√£o atual funciona a qualquer momento do processo de desenvolvimento, basta clicar no navegador F5. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rl/hq/rs/rlhqrsc-7sjls6fju4o6lmawsto.jpeg"></div><br><br>  No entanto, eu ainda tinha que desligar os manipuladores em um loop, porque, caso contr√°rio, a extens√£o n√£o passaria no teste.  Tamb√©m em extens√µes, apenas no caso, no arquivo de √≠ndice html - de repente - scripts dinamicamente conectados s√£o proibidos.  Ent√£o eu os conectei atrav√©s da tag de script. <br><br><h3>  Armazenamento da guia </h3><br>  Por isso, decidi que as guias abertas no navegador deveriam ser salvas em determinadas listas, que ser√£o chamadas de computadores - Computador dom√©stico, Computador comercial, Computador local.  Local - √© quando a lista n√£o est√° armazenada no servidor, mas no banco de dados do navegador e, portanto, voc√™ pode us√°-la apenas no navegador em que est√° salva.  Isso √© para aquelas guias que n√£o precisam ser lan√ßadas entre computadores diferentes.  Bem, o restante das listas pode ser visualizado em qualquer computador e navegador dentre os suportados pela extens√£o. <br><br>  Para cada guia, o usu√°rio pode deixar um coment√°rio de texto arbitr√°rio.  Por exemplo, √© conveniente me lembrar de quais s√©ries parei ao assistir √† s√©rie e tamb√©m marcar por mim o que est√° na p√°gina, se n√£o estiver claro por seu t√≠tulo e tipo de link. <br><br>  De acordo com a documenta√ß√£o para a cria√ß√£o de extens√µes para Chrome e Firefox, o c√≥digo de extens√£o deve estar localizado em dois arquivos - o principal e o segundo plano.  O script principal lida com a exibi√ß√£o da interface do usu√°rio, e o script em segundo plano pode controlar as guias do navegador e trocar dados com o servidor.  Gerenciar guias no Chrome e Firefox √© muito semelhante.  Por exemplo, o manipulador de eventos para abrir ou fechar guias no Chrome √© assim: <br><br><pre><code class="plaintext hljs">chrome.tabs.onUpdated.addListener( function(tabId, changeInfo) { });</code> </pre> <br>  E no Firefox assim: <br><br><pre> <code class="plaintext hljs">browser.tabs.onUpdated.addListener( function(tabId, changeInfo, tabInfo) { });</code> </pre> <br>  E a fun√ß√£o que exibe uma lista de todas as guias abertas √© escrita exatamente da mesma forma para os dois navegadores: <br><br><pre> <code class="plaintext hljs">chrome.tabs.query({},function(data){ });</code> </pre> <br>  Sim, sim, o Chrome tamb√©m grava o Chrome no Firefox ... etc.  Isso √© um pouco estranho, no entanto, o fato de os navegadores estarem caminhando para padronizar suas APIs √© muito encorajador. <br><br>  Na verdade, toda a funcionalidade da extens√£o √© alcan√ßada usando v√°rias fun√ß√µes - abra a janela da extens√£o clicando em seu √≠cone, leia abas abertas, feche a aba, crie uma nova aba, ou√ßa os eventos da aba e troque dados com a janela da extens√£o.  S√≥ isso.  Esses m√©todos est√£o dispon√≠veis apenas no script em segundo plano. <br><br>  Ap√≥s a leitura, as guias abertas no navegador s√£o enviadas ao meu servidor e salvas em um banco de dados SQL regular.  O script do servidor est√° escrito em PHP.  H√° uma tabela de usu√°rio que armazena links para linhas em outra tabela - a tabela de dados.  Esses dados s√£o os endere√ßos das p√°ginas, seus nomes e coment√°rios de texto do usu√°rio, armazenados no formato de cadeias de texto em um campo de tipo de texto com cerca de um kilobyte.  Os dados s√£o armazenados em forma n√£o criptografada.  Cerca de 1.000 guias podem ser salvas por megabyte.  Um m√°ximo de 25 desses armazenamentos ("Computadores") √© fornecido para cada usu√°rio. <br><br>  No entanto, a vers√£o gratuita da extens√£o limita o usu√°rio a dois armazenamentos - Computador dom√©stico e Computador comercial, e cada um deles pode armazenar n√£o mais que 10 guias.  Ainda estou trabalhando na vers√£o paga e nos m√©todos de pagamento.  Haver√° at√© 25 "computadores" e at√© cerca de 1000 guias em cada um, al√©m de op√ß√µes de imagens de fundo, √≠cones e nomes para cada computador, listas hier√°rquicas e muito mais. <br><br>  H√° outro reposit√≥rio - computador local.  N√£o h√° restri√ß√µes aqui, pois os dados da guia s√£o armazenados no banco de dados do navegador local no computador do usu√°rio.  Aqui voc√™ pode armazenar quantas guias quiser, mas n√£o mais do que o disco r√≠gido permite.  Al√©m disso, como os dados n√£o s√£o armazenados no Armazenamento Local, mas no DB indexado, n√£o h√° limite de 5 ou alguns megabytes.  √â importante n√£o limpar acidentalmente este reposit√≥rio junto com o hist√≥rico do navegador.  Tamb√©m pretendo exportar e importar guias para um arquivo de texto. <br><br>  Para trabalhar com o indexedDB, escrevi uma pequena sub-biblioteca com apenas 106 linhas de comprimento.  Ao contr√°rio do banco de dados no servidor, aqui todos os dados n√£o precisam ser destilados em uma sequ√™ncia de texto, mas podem ser salvos imediatamente na matriz associativa como est√£o.  O princ√≠pio do armazenamento existe: a chave √© o valor.  E o valor pode ser uma enorme matriz associativa. <br><br><h3>  Autentica√ß√£o de usu√°rio </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n_/q-/iy/n_q-iys59c4pqcmjfcps0r3v-xw.jpeg"></div><br>  <i>Firefox</i> <br><br>  A autoriza√ß√£o, como j√° observei, ocorre por meio de redes sociais e, no servidor, usando o protocolo OAuth.  Ele ainda √© suportado pelo Facebook e pelo VKontakte, mas pretendo aumentar o n√∫mero de m√©todos de autentica√ß√£o do usu√°rio.  O esquema de autoriza√ß√£o do servidor OAuth √© descrito em detalhes na documenta√ß√£o das duas redes sociais, portanto, n√£o faz sentido insistir nele em detalhes.  Observo apenas que n√£o gostei do fato de que, durante a autoriza√ß√£o, uma nova guia do navegador √© aberta, mesmo que o usu√°rio j√° esteja conectado √† rede social e j√° tenha concedido os direitos de extens√£o.  Essa guia deve ser capturada pelo script de extens√£o em segundo plano e for√ßada a fechar e, em geral, n√£o parece esteticamente agrad√°vel, se encaixa nas outras guias e pisca quando aparece e √© destru√≠da. <br><br>  Para fech√°-lo, no VKontakte, voc√™ precisa verificar a presen√ßa do endere√ßo no manipulador de eventos da guia: <br><br><pre> <code class="plaintext hljs">oauth.vk.com/blank.html</code> </pre> <br>  E para o Facebook: <br><br><pre> <code class="plaintext hljs">https://www.facebook.com/connect/blank.html</code> </pre> <br>  E apenas no caso: <br><br><pre> <code class="plaintext hljs">facebook.com/connect/login_success.html</code> </pre> <br>  Portanto, no in√≠cio, enviei um assembly de extens√£o para a Google Web Store, no qual a autoriza√ß√£o foi realizada no cliente com uma solicita√ß√£o preliminar da rede social da API javascript do cliente correspondente.  Al√©m disso, como a extens√£o est√° instalada no usu√°rio e preciso autorizar no meu servidor, eu tamb√©m extra√≠ o html do meu servidor no script de extens√£o no i-frame, mas j√° puxei a API da rede social nele ... <br><br>  E o esquema de troca de dados com o servidor era assim.  Uma p√°gina de √≠ndice de extens√£o envia um comando (informa√ß√µes de clique, por exemplo) para um script de extens√£o em segundo plano.  O script de segundo plano usando postMessage envia dados para o h-frame i-frame.  O I-frame envia dados para o script php no servidor.  O servidor responde no i-frame, o i-frame responde no script em segundo plano, o script em segundo plano responde no √≠ndice, o usu√°rio v√™ a resposta.  Ufa ... E o mais importante - tudo funcionou! <br><br>  Em geral, isso n√£o funcionou.  O Google envolveu minha extens√£o com v√°rios formul√°rios, entre os quais havia algo vago que, dizem eles, sua extens√£o n√£o est√° de acordo com nossa pol√≠tica de seguran√ßa.  Atrav√©s da correspond√™ncia com suporte, consegui obter detalhes.  Ou seja, eles n√£o gostaram do fato de a extens√£o extrair html e js de servidores de terceiros ... Em geral, eu tive que terminar com a autoriza√ß√£o do cliente e retornar ao servidor.  Sim, enviando uma solicita√ß√£o de postagem http a partir de um script de extens√£o em segundo plano diretamente para o servidor, no entanto, acabou sendo permitido.  Bem, tudo bem.  Isso √© ainda melhor.  Descobriu-se mais curto e n√£o h√° necessidade de extrair API javascript das redes sociais - este √© um tempo de espera extra para o usu√°rio. <br><br><h3>  Exibir guias </h3><br>  Voltar para as op√ß√µes de expans√£o.  A lista de guias em si √© uma s√©rie de linhas em que primeiro vem o √≠cone da imagem, depois o t√≠tulo da p√°gina e, finalmente, o link.  O que n√£o couber no tamanho da linha designado na tela √© cortado.  Mas o banco de dados √© salvo completamente.  Al√©m disso, qualquer linha pode ser movida para cima da tela na forma de um ladrilho colorido.  Isto √© para os sites mais importantes que devem estar diante de seus olhos em primeiro lugar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9v/7_/7q/9v7_7qc9d8rbacokyuyloyuxths.jpeg"></div><br>  <i>Lista de guias do Chrome</i> <br><br>  As cores dos ladrilhos s√£o selecionadas automaticamente com base no nome de dom√≠nio do site.  A fun√ß√£o aceita o URL.  O nome do dom√≠nio √© dividido em tr√™s grupos aproximadamente iguais de caracteres.Os primeiros caracteres de cada grupo s√£o convertidos nos valores dos componentes de cores: R, G, B. Essa convers√£o √© realizada da seguinte maneira.  Os c√≥digos desses tr√™s caracteres s√£o reduzidos para o intervalo d1, de 0 a 25, levando o restante da divis√£o em 26. At√© os caracteres do alfabeto russo ser√£o reduzidos para esse intervalo.  N√£o importa que a 27¬™ letra se torne a primeira l√°: n√£o precisamos que os componentes de cores de todas as letras do alfabeto sejam necessariamente diferentes, que sejam repetidos.  Em seguida, os tr√™s n√∫meros obtidos no intervalo d1 (0 ... 25) s√£o reduzidos proporcionalmente no intervalo d2 (150 ... 255).  Em geral, esses intervalos s√£o definidos no in√≠cio da fun√ß√£o e podem ser alterados para outros.  Peguei 150 ... 255 para que os componentes da cor sejam brilhantes.  Se voc√™ definir, por exemplo, 0 ... 100, os ladrilhos ficar√£o escuros.  Assim, tr√™s caracteres do nome de dom√≠nio s√£o convertidos em 3 n√∫meros do intervalo 150 ... 255.  E ent√£o, como voc√™ provavelmente adivinhou, eles s√£o interpretados como os componentes de cores dos ladrilhos R, G e B. Tudo √© muito simples. <br><br><pre> <code class="javascript hljs">getSiteColor=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d1=[<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>], d2=[<span class="hljs-number"><span class="hljs-number">150</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> code=<span class="hljs-number"><span class="hljs-number">0</span></span>, codep=<span class="hljs-number"><span class="hljs-number">0</span></span>, color=<span class="hljs-number"><span class="hljs-number">0</span></span>, str=<span class="hljs-string"><span class="hljs-string">''</span></span>, domen=<span class="hljs-string"><span class="hljs-string">''</span></span>, ar=[], inc=<span class="hljs-number"><span class="hljs-number">0</span></span>; ar=url.split(<span class="hljs-string"><span class="hljs-string">'//'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ar.length&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>) {str=ar[<span class="hljs-number"><span class="hljs-number">1</span></span>];} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {str=ar[<span class="hljs-number"><span class="hljs-number">0</span></span>];}; str=str.split(<span class="hljs-string"><span class="hljs-string">'www.'</span></span>).join(<span class="hljs-string"><span class="hljs-string">''</span></span>); domen=str.split(<span class="hljs-string"><span class="hljs-string">'/'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; str=domen.split(<span class="hljs-string"><span class="hljs-string">'.'</span></span>).join(<span class="hljs-string"><span class="hljs-string">''</span></span>); ar=[]; inc=<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(str.length/<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str.length % <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) {inc++;}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;str.length; i+=inc) { code=str.slice(i, i+<span class="hljs-number"><span class="hljs-number">1</span></span>).charCodeAt(<span class="hljs-number"><span class="hljs-number">0</span></span>); codep=code % (d1[<span class="hljs-number"><span class="hljs-number">1</span></span>]-d1[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>); color=<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.round( codep * (d2[<span class="hljs-number"><span class="hljs-number">1</span></span>]-d2[<span class="hljs-number"><span class="hljs-number">0</span></span>]) / (d1[<span class="hljs-number"><span class="hljs-number">1</span></span>]-d1[<span class="hljs-number"><span class="hljs-number">0</span></span>]) ) + d2[<span class="hljs-number"><span class="hljs-number">0</span></span>]; ar.push(color); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">r</span></span>:ar[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-attr"><span class="hljs-attr">g</span></span>:ar[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-attr"><span class="hljs-attr">b</span></span>:ar[<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-attr"><span class="hljs-attr">domen</span></span>:domen}; }</code> </pre> <br><h3>  Estrutura de documento HTML </h3><br>  Um documento html consiste em v√°rios elementos de tela com posicionamento absoluto, combinados por sobreposi√ß√£o e um bloco div no qual a lista √© exibida.  Uma fun√ß√£o √© pendurada no redimensionamento da janela do navegador que redimensiona todos esses elementos, ajustando-os √† nova altura e largura.  Tamb√©m h√° um tamanho m√≠nimo de supera√ß√£o que causa o aparecimento de barras de rolagem.  A imagem de fundo √© exibida na tela inferior.  Decidi que, para listas diferentes (computadores), diferentes planos de fundo devem ser configurados para facilitar a navega√ß√£o do usu√°rio.  A imagem de fundo enche a janela com a preserva√ß√£o de suas propor√ß√µes e √© levemente iluminada para n√£o chamar a aten√ß√£o para si mesma - um ret√¢ngulo transl√∫cido branco √© desenhado em cima dela.  Acima da tela de fundo, encontra-se a tela do menu principal, ela preenche apenas a parte superior da tela.  Bem e ainda mais alto est√° o bloco div, no qual a lista de guias √© formada.  A navega√ß√£o no menu Canvas √© feita atrav√©s da minha mini-biblioteca. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hf/yo/7z/hfyo7zhfazg4zngh50ulh7mibte.jpeg"></div><br>  <i>Navegador Opera e Yandex</i> <br><br><h3>  Localiza√ß√£o </h3><br>  Na tela principal, h√° uma bandeira, clicando no qual a interface alterna entre russo e ingl√™s.  Aqui a p√°gina √© redirecionada para o mesmo endere√ßo, mas com um par√¢metro na linha de comando.  Este par√¢metro √© lido antes de carregar todos os outros elementos.  E com base em seu valor, este ou aquele arquivo js com frases em russo ou ingl√™s √© carregado na matriz associativa para frases: lng_en.js ou lng_ru.js.  E no pr√≥prio aplicativo, para exibir frases de interface, j√° s√£o usados ‚Äã‚Äãlinks para cadeias de texto desse array associativo.  Al√©m disso, dependendo do valor na barra de endere√ßo, √© carregado um arquivo contendo os elementos da interface gr√°fica - bot√µes: buttons_en.png ou buttons_ru.png.  Decidi que √© melhor criar bot√µes junto com os √≠cones e inscri√ß√µes em cada idioma no editor de gr√°ficos do que criar um bot√£o vazio e sobrepor √≠cones e inscri√ß√µes nele, especialmente porque n√£o existem muitos deles e toda essa lista de sprites pesa apenas 50 Kb  Eu pretendo continuar trabalhando no design e tornar todos os bot√µes diferentes em forma. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4j/42/i8/4j42i89k06pbdosro4pe1ytjm50.jpeg"></div><br><br>  O arquivo geral com sprites main.png, que cont√©m elementos gr√°ficos que n√£o est√£o vinculados a uma localiza√ß√£o espec√≠fica, √© carregado de qualquer maneira. <br><br><h3>  Vers√£o Web </h3><br>  Eu pensei que seria bom se os links armazenados com cuidado a partir do computador de casa ou do trabalho pudessem ser visualizados a partir do telefone.  Mas nem todos os navegadores de sistemas operacionais m√≥veis oferecem suporte a extens√µes.  Ent√£o eu criei uma montagem da web.  Ao visitar o site em um endere√ßo espec√≠fico, voc√™ ainda pode fazer login usando uma das redes sociais e visualizar suas guias. <br><br>  Sim, n√£o h√° como adicionar guias √† lista ou editar.  Mas voc√™ pode pelo menos abrir abas da lista e visualizar as p√°ginas.  Acho que vale a pena trabalhar na vers√£o m√≥vel deste site e exibir listas maiores de guias. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vh/h8/3p/vhh83pbba9_0rje4wdcjtye33ve.jpeg"></div><br>  <i>Vers√£o da Web no IE 11</i> <br><br><h3>  Publicidade </h3><br>  At√© agora, n√£o trabalhei na promo√ß√£o da minha expans√£o.  Ele acabou de criar grupos nas redes sociais e convidou todos os seus amigos para l√°.  Sim, ele lan√ßou uma campanha publicit√°ria no Yandex Direct por 1.500 rublos.  Ela n√£o deu nenhum resultado especial, mas talvez eu n√£o tenha feito o an√∫ncio corretamente.  Ou talvez o problema seja que eu indiquei um link para a vers√£o em ingl√™s da p√°gina inicial da extens√£o.  E talvez valesse a pena dar um link n√£o para a p√°gina inicial, mas imediatamente para uma das lojas de extens√£o.  Como voc√™ sabe, eu n√£o sou um g√™nio do marketing.  Em geral, tentarei novamente com outros par√¢metros.  A campanha deu 39 cliques.  √â dif√≠cil dizer se eu adquiri alguns novos usu√°rios como resultado disso. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/89/sb/dg/89sbdgtfmp59-vykztuj4i-z3li.jpeg"></div><br>  Havia uma singularidade com a vers√£o no Firefox. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k5/ku/so/k5kuso8qgka09q2ahx76mettkmo.jpeg"></div><br>  As estat√≠sticas de 17 de outubro mostram at√© 227 downloads.  N√£o sei se a campanha no Yandex.Direct contribuiu para isso ou n√£o, mas por algum motivo, 1-2 downloads por dia continuam novamente.  Ao mesmo tempo, para a extens√£o do Firefox, existe o conceito de usu√°rios di√°rios: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h2/8j/2c/h28j2cd3ylazbx7nnqflnqghsmu.jpeg"></div><br>  Por que houve 227 downloads, mas havia apenas 1-2 usu√°rios di√°rios, n√£o est√° claro.  Talvez tenha sido algum tipo de falha.  Em geral, eu ainda n√£o entendi o que era, e onde est√£o todas essas pessoas ... <br><br>  As estat√≠sticas na loja de extens√µes da Chrome Web Store agradaram a uma programa√ß√£o eternamente sem carregamento - foi o que eu n√£o vi - e a 5 a 10 usu√°rios di√°rios. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dt/2u/zt/dt2uzt-5i74e8m947qxfntmuhgs.jpeg"></div><br>  Al√©m disso, enviei a montagem para a loja de extens√µes Opera.  No entanto, tendo apresentado duas vers√µes e sem esperar a modera√ß√£o de nenhuma delas, em algum momento cuspi em espalhar novas por l√°.  E, de fato, por que isso √© necess√°rio se o Opera instala perfeitamente extens√µes da loja do Chrome. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/or/6l/kt/or6lkthk4ovyqbuv3_hsyf8ypny.jpeg"></div><br><h3>  Sum√°rio </h3><br>  Criei tr√™s compila√ß√µes de extens√£o - para Chrome, Firefox e a vers√£o da web.  Na verdade, todos os tr√™s conjuntos s√£o um e o mesmo conjunto, o que simplesmente indica na configura√ß√£o qual mecanismo do navegador est√° sendo usado no momento.  E as fun√ß√µes correspondentes para trabalhar com guias s√£o inicializadas.  Altero esse valor antes de embalar em zip e enviar o pacote para o armazenamento de extens√µes apropriado. <br><br>  As vers√µes para Chrome e Firefox foram testadas e colocadas em suas respectivas lojas oficiais de extens√£o.  Al√©m disso, o registro como desenvolvedor de extens√µes no Google custa US $ 5.  Mozilla tem de gra√ßa.  A vers√£o web da extens√£o est√° localizada no servidor.  A montagem da loja do Chrome funciona bem em navegadores compat√≠veis: tamb√©m pode ser instalada no Yandex Browser e no Opera.  Eu pretendo lan√ßar novas vers√µes com recursos ainda mais avan√ßados. <br><br>  Em geral, as extens√µes do navegador s√£o poder.  Agora n√£o preciso me levantar do sof√° e tamb√©m n√£o h√° necessidade de raiva para quebrar o tablet.  Este √© o Zen completo.  Bom para todos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427773/">https://habr.com/ru/post/pt427773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427759/index.html">Sobre a resolubilidade de problemas na via em tempo polinomial</a></li>
<li><a href="../pt427761/index.html">Implementa√ß√£o do algoritmo k-means (k-means) usando o exemplo de trabalho com pixels</a></li>
<li><a href="../pt427763/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 1</a></li>
<li><a href="../pt427767/index.html">Situa√ß√£o: no Canad√°, eles propuseram a introdu√ß√£o de um imposto sobre streaming - estamos discutindo qual √© o problema.</a></li>
<li><a href="../pt427771/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 2</a></li>
<li><a href="../pt427775/index.html">Um bot disfar√ßado de programador corrige erros no c√≥digo</a></li>
<li><a href="../pt427779/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 3</a></li>
<li><a href="../pt427781/index.html">Por que a ci√™ncia de dados das organiza√ß√µes de cr√©dito</a></li>
<li><a href="../pt427783/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 14: ‚ÄúSSL e HTTPS‚Äù, parte 1</a></li>
<li><a href="../pt427785/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 14: ‚ÄúSSL e HTTPS‚Äù, parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>