<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéå üé≠ ü•° Gui√≥n: no es un objeto de p√°gina üë©üèæ‚Äçüé® üèéÔ∏è üÖ∞Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Con el tiempo, hacer cambios en cualquier producto se vuelve m√°s dif√≠cil, y existe un riesgo creciente de no solo lanzar nuevas funciones, sino tambi√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gui√≥n: no es un objeto de p√°gina</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/arcadia/blog/434122/"><p>  Con el tiempo, hacer cambios en cualquier producto se vuelve m√°s dif√≠cil, y existe un riesgo creciente de no solo lanzar nuevas funciones, sino tambi√©n romper las antiguas.  A menudo, en lugar de verificar manualmente todo el proyecto, intentan automatizar este proceso.  Si habla con personas que prueban interfaces y recorren conferencias, queda claro que Selenium gobierna en el mundo de las pruebas web, y la gran mayor√≠a usa Page Object como la organizaci√≥n del c√≥digo. </p><br><p>  Pero para m√≠, como programador, por alguna raz√≥n nunca me gust√≥ este patr√≥n y el c√≥digo que vi con diferentes equipos: las letras SOLID sonaron en mi cabeza.  Pero estaba listo para aceptar el hecho de que los evaluadores escriben el c√≥digo que quieran, debido a la falta de alternativas, como hace aproximadamente un a√±o, en Angular Connect, escuch√© un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe</a> sobre la prueba de aplicaciones angulares usando el patr√≥n Screenplay.  Ahora quiero compartir. </p><br><p><img src="https://habrastorage.org/webt/or/lk/kp/orlkkp4zbclrby1wg1sudwl64cm.jpeg"></p><a name="habracut"></a><br><h1 id="podopytnyy-krolik">  Conejo experimental </h1><br><p>  Primero, una breve descripci√≥n de las herramientas utilizadas.  Como ejemplo de implementaci√≥n, tomar√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SerenityJS</a> del informe original, con TypeScript como el lenguaje de los scripts de prueba. </p><br><p> Pondremos experimentos sobre la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aplicaci√≥n TODO</a> , una aplicaci√≥n para crear una lista simple de tareas.  Como ejemplos, utilizaremos el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jan Molak</a> , el creador de la biblioteca (c√≥digo TypeScript, por lo que el resaltado fue un poco). </p><br><h1 id="nachnyom-v-2009-m-godu">  Comencemos en 2009 </h1><br><p>  En este momento, apareci√≥ Selenium WebDriver, y la gente comenz√≥ a usarlo.  Desafortunadamente, en una gran cantidad de casos, debido a la novedad de la tecnolog√≠a y la falta de experiencia en programaci√≥n, est√° mal.  Las pruebas resultaron ser completas de copiar y pegar, sin soporte y "fr√°gil". </p><br><p>  El resultado es una retroalimentaci√≥n negativa y una mala reputaci√≥n con las pruebas autom√°ticas.  Al final, Simon Stewart, creador de Selenium WebDriver, respondi√≥ en ausencia en su art√≠culo ¬° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mis pruebas de selenio no son estables!</a>  .  El mensaje general: "si sus pruebas son fr√°giles y no funcionan bien, esto no se debe a Selenium, sino a que las pruebas en s√≠ mismas no est√°n muy escritas". </p><br><p>  Para comprender lo que est√° en juego, echemos un vistazo al siguiente escenario de usuario: </p><br><pre><code class="plaintext hljs">Feature: Add new items to the todo list In order to avoid having to remember things that need doing As a forgetful person I want to be able to record what I need to do in a place where I won't forget about them Scenario: Adding an item to a list with other items Given that James has a todo list containing Buy some cookies, Walk the dog When he adds Buy some cereal to his list Then his todo list should contain Buy some cookies, Walk the dog, Buy some cereal</code> </pre> <br><p>  La implementaci√≥n ingenua "en la frente" se ver√° as√≠: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoUserSteps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, (name: string, <span class="hljs-attr"><span class="hljs-attr">items</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { browser.get(<span class="hljs-string"><span class="hljs-string">'http://todomvc.com/examples/angularjs/'</span></span>); browser.driver.manage().window().maximize(); listOf(items).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> { element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)).sendKeys(item, protractor.Key.ENTER); }); browser.driver.controlFlow().execute(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, (itemName: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)) .sendKeys(itemName, protractor.Key.ENTER) .then(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, (items: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { expect(element.all(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)).getText()) .to.eventually.eql(listOf(items)) .and.notify(callback); }); };</code> </pre> <br><p>  Como puede ver, aqu√≠ se usa una API de bajo nivel, manipulaciones con el DOM, copiar y pegar los selectores css.  Est√° claro que en el futuro, incluso con un peque√±o cambio en la interfaz de usuario, tendr√° que cambiar el c√≥digo en muchos lugares. </p><br><p>  Como soluci√≥n, Selenium ten√≠a que ofrecer algo lo suficientemente bueno como para deshacerse de tales problemas, y al mismo tiempo accesible para personas con poca o ninguna experiencia en programaci√≥n orientada a objetos.  Tal soluci√≥n fue Page Object, un patr√≥n para organizar el c√≥digo. </p><br><p>  Martin Fowler lo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">describe</a> como un objeto de abstracci√≥n alrededor de una p√°gina HTML o su fragmento, lo que le permite interactuar con los elementos de la p√°gina sin tocar el propio HTML.  Idealmente, dicho objeto deber√≠a permitir que el c√≥digo del cliente haga y vea todo lo que una persona puede hacer y ver. <br><img src="https://habrastorage.org/getpro/habr/post_images/89d/8a5/9b0/89d8a59b079f3dff71831e7f758d4e8e.png"></p><br><p>  Habiendo reescrito nuestro ejemplo de acuerdo con este patr√≥n, tenemos lo siguiente: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoList</span></span></span><span class="hljs-class"> </span></span>{ What_Needs_To_Be_Done = element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)); Items = element.all(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)); addATodoItemCalled(itemName: string): PromiseLike&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.What_Needs_To_Be_Done.sendKeys(itemName, protractor.Key.ENTER); } displayedItems(): PromiseLike&lt;string[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Items.getText(); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoUserSteps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> todoList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TodoList(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, (name: string, <span class="hljs-attr"><span class="hljs-attr">items</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { browser.get(<span class="hljs-string"><span class="hljs-string">'http://todomvc.com/examples/angularjs/'</span></span>); browser.driver.manage().window().maximize(); listOf(items).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> { todoList.addATodoItemCalled(item); }); browser.driver.controlFlow().execute(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, (itemName: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { todoList.addATodoItemCalled(itemName).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> callback()); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, (items: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { expect(todoList.displayedItems()) .to.eventually.eql(listOf(items)) .and.notify(callback); }); };</code> </pre> <br><p>  A primera vista, se ve bien: nos deshicimos de la duplicaci√≥n y agregamos encapsulaci√≥n.  Pero hay un problema: muy a menudo tales clases en el proceso de desarrollo crecen a tama√±os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enormes</a> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/895/cea/563/895cea563685efb4c86613c9ee17d9f9.jpg"></p><br><p>  Puede intentar descomponer este c√≥digo en componentes independientes, pero si el c√≥digo alcanza dicho estado, ya est√° tan estrechamente acoplado que puede ser muy dif√≠cil y requerir√° reescribir tanto la clase en s√≠ como el c√≥digo completo del cliente (casos de prueba) que usan esto El objeto.  De hecho, una gran clase no es una enfermedad, sino un s√≠ntoma ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">olor a c√≥digo</a> ).  El principal problema es la violaci√≥n del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Principio de Responsabilidad √önica</a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Principio Abierto Cerrado</a> .  El objeto de p√°gina implica una descripci√≥n de la p√°gina y todas las formas de interactuar con ella en una entidad, que no se puede expandir sin cambiar su c√≥digo. </p><br><p>  Para nuestra clase TODO, las aplicaciones de responsabilidad son las siguientes (im√°genes del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/e10/92b/0d6/e1092b0d68097724e550dd2f271cf7a3.jpg" alt="Responsabilidad"></p><br><p>  Si intenta separar esta clase seg√∫n los principios de SOLID, obtendr√° algo como lo siguiente: <br><img src="https://habrastorage.org/getpro/habr/post_images/a86/9e3/d57/a869e3d571152689f7c4fd543b214057.jpg"></p><br><h1 id="domennaya-model">  Modelo de dominio </h1><br><p>  El siguiente problema que tenemos con Page Object es que opera en p√°ginas.  En cualquier prueba de aceptaci√≥n, es com√∫n usar historias de usuarios.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Behavior Driven Development (BDD)</a> y el lenguaje <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gherkin</a> se ajustan perfectamente a este modelo.  Se entiende que la ruta del usuario hacia el objetivo (escenario) es m√°s importante que la implementaci√≥n espec√≠fica.  Por ejemplo, si utiliza un widget de inicio de sesi√≥n en todas las pruebas, al cambiar el m√©todo de inicio de sesi√≥n (el formulario se movi√≥, cambi√≥ a Inicio de sesi√≥n √∫nico), tendr√° que cambiar <em>todas las</em> pruebas.  En proyectos particularmente din√°micos, esto puede llevar mucho tiempo y mucho tiempo y alentar al equipo a posponer las pruebas de escritura hasta que las p√°ginas se estabilicen (incluso si todo est√° claro con los casos de uso). </p><br><p>  Para resolver este problema, vale la pena mirarlo desde el otro lado.  Introducimos los siguientes conceptos: </p><br><ol><li>  Roles: ¬øpara qui√©n es todo? </li><li>  Objetivos: ¬øpor qu√© est√°n (usuarios) aqu√≠ y qu√© quieren lograr? </li><li>  Tareas: ¬øqu√© necesitan hacer para lograr estos objetivos? </li><li>  Acciones: ¬øc√≥mo debe interactuar exactamente un usuario con una p√°gina para completar una tarea? </li></ol><br><p>  Por lo tanto, cada script de prueba se convierte, de hecho, en un <em>script</em> para el usuario, dirigido a la ejecuci√≥n de una historia de usuario espec√≠fica.  Si combina este enfoque con los principios de programaci√≥n orientada a objetos descritos anteriormente, el resultado ser√° un patr√≥n de <em>Gui√≥n</em> (o <em>Viaje del usuario</em> ).  Sus ideas y principios se expresaron por primera vez en 2007, incluso antes de PageObject. </p><br><h1 id="screenplay">  Guion </h1><br><p>  Reescribimos nuestro c√≥digo usando los principios resultantes. </p><br><p>  James es el actor que interpretar√° a nuestro usuario en este escenario.  √âl sabe c√≥mo usar un navegador. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> james = Actor.named(<span class="hljs-string"><span class="hljs-string">'James'</span></span>).whoCan(BrowseTheWeb.using(protractor.browser));</code> </pre> <br><p>  El objetivo de James es agregar el primer elemento a su lista: </p><br><pre> <code class="plaintext hljs"> Scenario: Adding an item to a list with other items</code> </pre> <br><p>  Para lograr este objetivo, James necesita lo siguiente: </p><br><ol><li>  comienza con una lista que contiene varios elementos, </li><li>  A√±adir nuevo elemento. </li></ol><br><p>  Podemos dividir esto en dos clases: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PerformsTasks, Task } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Open } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AddATodoItem } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./add_a_todo_item'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Start</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> withATodoListContaining(items: string[]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Start(items); } performAs(actor: PerformsTasks) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( Open.browserOn(<span class="hljs-string"><span class="hljs-string">'/examples/angularjs/'</span></span>), ...this.addAll(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items) ); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private items: string[]) { } private addAll(items: string[]): Task[] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> AddATodoItem.called(item)); } }</code> </pre> <br><p>  La interfaz de la <code>Task</code> requiere la definici√≥n del m√©todo <code>performAs</code> , donde se transferir√° al actor durante la ejecuci√≥n.  <code>attemptsTo</code> - funci√≥n combinador, acepta cualquier n√∫mero de barajaduras.  Por lo tanto, puede construir una variedad de secuencias.  De hecho, todo lo que hace esta tarea es abrir un navegador en la p√°gina deseada y agregar elementos all√≠.  Ahora veamos la tarea de agregar un elemento: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PerformsTasks, Task } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Enter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { TodoList } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/todo_list'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddATodoItem</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> called(itemName: string) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AddATodoItem(itemName); } <span class="hljs-comment"><span class="hljs-comment">// required by the Task interface performAs(actor: PerformsTasks): PromiseLike&lt;void&gt; { // delegates the work to lower-level tasks return actor.attemptsTo( Enter.theValue(this.itemName) .into(TodoList.What_Needs_To_Be_Done) .thenHit(protractor.Key.ENTER) ); } constructor(private itemName: string) } }</span></span></code> </pre> <br><p>  Aqu√≠ es m√°s interesante, aparecen acciones de bajo nivel: ingrese el texto en el elemento de la p√°gina y presione Entrar.  <code>TodoList</code> es todo lo que queda de la parte "descriptiva" del Objeto de p√°gina, aqu√≠ tenemos selectores css: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Target, Question, Text } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { by } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoList</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> What_Needs_To_Be_Done = Target .the(<span class="hljs-string"><span class="hljs-string">'"What needs to be done?" input box'</span></span>) .located(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Items = Target .the(<span class="hljs-string"><span class="hljs-string">'List of Items'</span></span>) .located(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Items_Displayed = Text.ofAll(TodoList.Items); }</code> </pre> <br><p>  Ok, queda por verificar que despu√©s de todas las manipulaciones se muestre la informaci√≥n correcta.  SerenityJS ofrece la interfaz <code>Question&lt;T&gt;</code> , una entidad que devuelve un valor mostrado o una lista de valores ( <code>Text.ofAll</code> en el ejemplo anterior).  ¬øC√≥mo podr√≠a uno implementar una <em>pregunta</em> que devuelve el texto de un elemento HTML: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Text</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Question</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">&gt; </span></span>{ public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>(target: Target): Text { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text(target); } answeredBy(actor: UsesAbilities): PromiseLike&lt;string[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BrowseTheWeb.as(actor).locate(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target).getText(); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private target: Target) { } }</code> </pre> <br><p>  Lo que es importante, el enlace del navegador es opcional.  <code>BrowseTheWeb</code> es solo <em>Ability</em> , que le permite interactuar con el navegador.  Puede implementar, por ejemplo, la capacidad <code>RecieveEmails</code> , que le permite al actor leer cartas (para registrarse en el sitio). </p><br><p>  Poniendo todo junto, obtenemos este esquema (de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jan Molak</a> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/c7c/1c1/ac3/c7c1c1ac30c645ca0d6987348274e419.png"></p><br><p>  y el siguiente escenario: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> actor: Actor; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name: string, items: string</span></span></span><span class="hljs-function">) </span></span>{ actor = Actor.named(name).whoCan(BrowseTheWeb.using(protractor.browser)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( Start.withATodoListContaining(listOf(items)) ); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">itemName: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( AddATodoItem.called(itemName) ) }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> expect(actor.toSee(TodoList.Items_Displayed)).eventually.deep.equal(listOf(items)) });</code> </pre> <br><p>  Al principio, el resultado parece un poco masivo, pero a medida que el sistema crece, la cantidad de c√≥digo reutilizado aumentar√°, y los cambios de dise√±o y p√°gina solo afectar√°n a los selectores css y las tareas / preguntas de bajo nivel, dejando los scripts y las tareas de alto nivel pr√°cticamente sin cambios. </p><br><h2 id="realizacii">  Implementaciones </h2><br><p>  Si hablamos de bibliotecas, y no de intentos de peque√±as ciudades de aplicar este patr√≥n, el m√°s popular es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Serenity BDD</a> para Java.  Javascript / TypeScript utiliza su propio puerto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SerenityJS</a> .  Fuera de la caja, ella sabe c√≥mo trabajar con Pepino y Mocha. </p><br><p>  Una b√∫squeda r√°pida tambi√©n produjo una biblioteca para .NET: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tranquilidad</a> .  No puedo decir nada sobre ella, ya que no la he visto antes. </p><br><p>  Al usar Serenity y SerenityJS, puede usar la utilidad de generaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informes</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Informe con fotos</b> <div class="spoiler_text"><p>  Toma el c√≥digo usando Mocha: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'Finding things to do'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'James can'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'remove filters so that the list'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'shows all the items'</span></span>, () =&gt; Actor.named(<span class="hljs-string"><span class="hljs-string">'James'</span></span>).attemptsTo( Start.withATodoListContaining([ <span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Walk the dog'</span></span> ]), CompleteATodoItem.called(<span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>), FilterItems.toShowOnly(<span class="hljs-string"><span class="hljs-string">'Active'</span></span>), FilterItems.toShowOnly(<span class="hljs-string"><span class="hljs-string">'All'</span></span>), Ensure.theListOnlyContains(<span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Walk the dog'</span></span>), )); }); }); });</code> </pre> <br><p>  El informe contendr√° como estad√≠sticas generales: <br><img src="https://habrastorage.org/getpro/habr/post_images/dd0/8fa/f09/dd08faf09e56d3fc272d7fab91be3d8d.png"></p><br><p>  y un desglose de los pasos con capturas de pantalla: <br><img src="https://habrastorage.org/getpro/habr/post_images/3c8/19f/c52/3c819fc528d5f1af31d969af7ebbbe6e.png"></p></div></div><br><h1 id="ssylki">  Referencias </h1><br><p>  Algunos art√≠culos relacionados: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Objetos de p√°gina refactorizados: pasos s√≥lidos al gui√≥n / patr√≥n de viaje</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">M√°s all√° de los objetos de p√°gina: Automatizaci√≥n de pruebas de pr√≥xima generaci√≥n con serenidad y el patr√≥n de gui√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Serenity BDD y el patr√≥n de gui√≥n</a> </li></ol><br><p>  Papeles </p><br><ol><li><iframe width="560" height="315" src="https://www.youtube.com/embed/8f8tdZBvAbI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li><li><iframe width="560" height="315" src="https://www.youtube.com/embed/CocG0FBFJLU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li></ol><br><p>  Bibliotecas: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Serenity BDD</a> - Java </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Serenity JS</a> - JavaScript / TypeScript </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tranquilidad</a> - .NET </li></ol><br><p>  Escriba en los comentarios si utiliza otros patrones / formas de organizar el c√≥digo de las pruebas autom√°ticas. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es434122/">https://habr.com/ru/post/es434122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es434112/index.html">Principios de programaci√≥n funcional en JavaScript.</a></li>
<li><a href="../es434114/index.html">19 ideas para los desarrolladores de Node.js que buscan crecer por encima de s√≠ mismos en 2019</a></li>
<li><a href="../es434116/index.html">La historia de la escandalosa facilidad de piratear la infraestructura moderna de desarrollo de software</a></li>
<li><a href="../es434118/index.html">Tutorial React Parte 4: Componentes principales y secundarios</a></li>
<li><a href="../es434120/index.html">Tutorial de React, Parte 5: Introducci√≥n a una aplicaci√≥n TODO, estilo b√°sico</a></li>
<li><a href="../es434124/index.html">Active la aceleraci√≥n de GPU en Photoshop en Wine</a></li>
<li><a href="../es434126/index.html">Reproduzca medios usando la biblioteca VLCj</a></li>
<li><a href="../es434128/index.html">PHP Digest No. 146 (10-24 de diciembre de 2018) + Resultados 2018</a></li>
<li><a href="../es434130/index.html">Interfaz reactiva. Conferencia de Artyom Belov en FrontTalks 2018</a></li>
<li><a href="../es434132/index.html">Compre un televisor y enr√≥llelo: LG planea comenzar a vender televisores flexibles en el pr√≥ximo a√±o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>